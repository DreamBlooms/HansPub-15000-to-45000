"惯性导航作为一种战时能全面提供导航信息的可靠手段在一定时段内能保证精度，但由于惯性器件漂移的影响，其导航精度难以满足舰载武器长航时需求；星光导航以宇宙中具有精确空间位置的天体作为导航信标，其精度主要取决于光轴测量精度，无时间累积误差。本文讨论惯性/星光导航技术中，利用星光导航误差有界性特点克服惯性导航误差随时间发散的缺点；同时惯导将持续提供高精度水平基准给星光导航系统，采用基于星光系统位置和姿态信息的互补手段，解决星光导航精度受制于惯性水平基准的问题，构造高精度水平基准，保证星光误差的有界性，从而保障星光量测信息的准确性。"
"惯性导航设备以完全自主、隐蔽性好、导航信息完备、短时精度高、数据输出连续等优点，已作为主要的关键设备广泛应用于我国水面舰艇、潜艇。但由于惯性元器件误差所引起的导航结果误差，随时间积累，在舰船长时间航行的条件下，惯导设备的导航精度逐渐降低。惯性导航设备属于精度保持时间受限的自主导航设备。星光定向仪是一种以恒星为参照系，以星空为工作对象的高精度的空间姿态测量装置，能提供不随时间变化的姿态信息。星光定向仪具有精度高、体积小、质量轻、功耗低的优点；缺点为数据输出率低，仪器使用受天气影响较大。星光定向仪属于与工作时间无关但受天气条件限制的自主导航设备 [ 1 ]。 星敏感器截止到目前经历了3个阶段的发展历程：第一代小视场CCD星敏感器，第二代大视场CCD星敏感器和第三代基于CMOS APS的星敏感器 [ 2 ] [ 3 ]。第一代星载星敏感器是在CCD图像传感器研制成功后出现的CCD星敏感器，其典型代表有美国喷气动力试验室(JPL)研制的ASTROS星敏感器。第一代CCD星敏感器具有如下特点： 1) 视场较小，如JPL的ASTROS星敏感器视场为2.2˚ × 3.3˚；2) 姿态精度较低，如JPL的ASTROS星敏感器纵摇和航行精度为4″，横摇精度为50″；3) 更新率较低，小于≤10 Hz；4) 星敏感器的体积、质量和功耗较大；5) 不具备独立自主获取载体惯性系姿态的能力。 第二代星敏感器出现在20世纪80年代中期后，第二代星敏感器采用大面阵CCD作为图像传感器，其具有如下特点 [ 4 ]： 1) 视场较大，德国Jena-Optronik的ASTRO15星敏感器视场为13.3˚ × 13.3˚；2) 姿态精度较高，如德国Jena-Optronik的ASTRO15星敏感器纵摇和航行精度为1″，横摇精度为10″；3) 更新率较低，小于≤10 Hz；4) 体积小，重量轻，功耗低；5) 具有独立自主获取载体惯性系姿态的能力。 第三代CMOS APS星敏感器是20世纪90年代美国喷气动力实验室(JPL)研发的一种CMOS图像传感器，CMOS星敏感器已成为目前主流的星敏感器。与CCD星敏感器相比，CMOS APS星敏感器具有明显的不同 [ 5 ]，主要表现为： 1) 更大的视场，德国Jena-Optronik的ASTRO APS星敏感器视场为20˚ × 20˚；2) 较高的姿态精度，如德国Jena-Optronik的ASTRO APS星敏感器纵摇和航行精度为1″，横摇精度为8″；3) 更新率较高，德国Jena-Optronik的ASTRO APS星敏感器的更新率高达104 Hz；4) CMOS APS探测器集成度较高，因此具有极低的功耗、更小的体积和重量；5) 可实现红外波段探测功能。 第一代星敏感器通常采用多框架伺服机构，依靠惯导平台的控制提供的水平基准，从而实现星光通过高度角差分法实现定位，校正惯导系统输出导航位置信息，通常应用于早期的机载平台和舰载平台。第一代惯性/星光组合系统的水平基准的构建依赖于惯导的水平姿态以及伺服框架的控制精度。第二代、第三代星敏采用星图匹配的方式，因此这类惯性/星光的高精度水平基准的建立通过卡尔曼滤波的方式进行“数学平台”构建。 在利用惯性导航系统“数学平台”建立水平基准时，采用的组合方式有三种，第一种方式是姿态组合模式，在已知准确位置的前提下，通过天文系统测量载体的航向和水平姿态，利用此信息与惯导的姿态信息比较进行滤波组合，主要用于修正载体的航向和水平姿态。第二种方式是位置组合模式，天文系统接收惯导提供的水平姿态信息，输出载体当前的位置信息，天文/惯性组合系统利用位置信息进行组合。本文采用第三种即基于陀螺漂移校正的组合模式，本文根据天文系统测量得到的载体坐标系相对于惯性坐标系高精度的姿态信息、通过姿态信息(四元数表示)这一物理量，构建了惯性基准误差与陀螺漂移之间的关系。建立天文导航系统和惯导系统以四元数误差的量测方程，并分析了两者之间的关联性，实现对惯性元件的补偿 [ 6 ]。"
"相关坐标系 星光/惯导组合导航系统机械编排所涉及到的坐标系有： 1) 地心惯性坐标系(i系) 2) 地球坐标系(e系) 3) 地理坐标系(t系) 4) 载体坐标系(b系) 5) 平台坐标系(p系) 6) 导航坐标系(n系) 7) 星敏感器坐标系(s系) 对各坐标系的具体说明如下： 地心惯性坐标系(i系， O - X i Y i Z i )：以地球球心O为原点， O Z i 轴沿地轴方向， O X i 轴指向春分点， O Y i 轴在赤道面内与 O X i 轴、 O Z i 轴构成右手直角坐标系。i系的三轴相对惯性空间指向不变，地心惯性坐标系又称为惯性坐标系。 地球坐标系(e系， O - X e Y e Z e )：以地球球心O为原点， O Z e 轴沿地轴方向， O X e 轴指向格林威治子午线， O Y e 轴在赤道面内与 O X e 轴、 O Z e 轴构成右手直角坐标系。e系的三轴与地球固连，随地球自转而转动。其关系如图1所示。 地理坐标系(t系， O - X t Y t Z t )：原点为载体的中心， O X t 轴、 O Y t 轴、 O Z t 轴分别指向当地东、北、天方向构成右手坐标系。也可按“北、西、天”、“东、北、地”为顺序构成右手坐标系，选取“东、北、天”为顺序构成的地理坐标系。 载体坐标系(b系， O - X b Y b Z b )：原点为载体的中心， O X b 轴、 O Y b 轴、 O Z b 轴在甲板平面内且相互垂直， O X b 轴指向右舷方向， O Y b 轴指向载体艏向， O Z b 轴与甲板垂直向上； 平台坐标系(p系， O - X p Y p Z p )：是惯性导航系统用来复现导航坐标系时所获得的坐标系，平台坐标系是通过储存在计算机中的方向余弦阵来实现。由于惯性器件是捷联安装在载体上当惯性导航系统不存在误差时，平台坐标系(p系)与载体坐标系(b系)重合；当惯导系统有误差时，两坐标系之间的夹角，即为失调角； 导航坐标系(n系， O - X n Y n Z n )：是用于导航解算的坐标系，在不同场合下可选取不同坐标系作为导航坐标系。在舰船导航研究中常采用地理坐标系为导航坐标系。 星敏感器坐标系(s系)：星敏感器测量坐标系定义为沿光轴方向为 O s Z s ，接插件面向外为 O s Y s ， O s X s 与 O s Y s ， O s Z s 构成右手坐标系，如图2所示。 图1. 地球坐标系与地心惯性坐标系关系示意图 图2. 星敏感器测量坐标系(s系)"
"基于星敏感器技术的星光定向仪，其导航原理是以恒星为参照物，利用摄像探测单元对天空进行拍摄直接捕获星图，经过数据处理单元对星图进行恒星质点提取、星图识别、星图跟踪等一系列的计算，确定出星体跟踪器光轴在惯性空间的瞬时指向。星光定向仪不需要任何外部信息自主的确定运载体相对于惯性空间的姿态；通过外部提供水平基准信息进行进一步的坐标变化，即可确定运载体的位置和航向。星光导航的机械编排原理如图3所示： 图3. 星光导航的机械编排原理图 根据国外天文导航的研究现状，CMOS APS星敏感器已经成为主流的星敏感器，通过美国的Daystar系统和Daytime Stellarimager系统可以发现，船舶平台星光系统具有如下特点： 1) 采用多孔径星体敏感器技术，Daystar和Daytime Stellarimager均通过三个独立的星体捕获、成像与检测单元增强观星效果； 2) 采用红外探测器，满足白天海上观星导航的要求； 3) 具有较强的白天测星能力，最高白天测星能力达到+7.1等； 4) 定位精度高，Daytime Stellarimager定位精度优于200 m； 5) 采用固态形式，捷联系统的组合方式，提高系统的可靠性。 因此船用惯性/天文导航的发展趋势是：全天时、全固态、捷联组合、多视场方向发展，但是惯性/星光的发展趋势也对支撑星光观测的水平基准补偿技术的准确性、高效性、实时性提出了更高的要求。本文提出的基于陀螺漂移校正的水平基准构建技术以适应惯性/星光组合发展需求。  由于船舶惯性导航系统运行时间长，需要在几十天甚至上百天保证惯性元件的稳定性，这样无疑对惯性元件提出了苛刻的筛选条件。为了降低对惯性元件的要求，船舶平台的惯导通常采用系统技术调制元件误差，常用的技术手段如旋转调制技术，通过旋转调制技术加速度计零位可观测性较好，对准期间可以较快的估计出加速度计零位，系统长时间运行的情况下可以重新估计加表零位，补偿加表零位误差；从而达到提高惯导系统的导航精度的目的。因此在船舶平台惯性/星光组合中采用的是具有旋转调制功能的惯性导航系统与星光组合。 捷联式惯性导航设备(简称捷联惯导)的惯性测量单元(IMU)中，正交安装三个敏感载体角速度的激光陀螺仪和三个敏感线加速度的加速度计。设备与船体固联，载体坐标系以右舷为X轴，艏向为Y轴，Z轴与X、Y轴形成右手坐标系，以当地地理坐标系为导航坐标系，进行固定指北式导航解算。陀螺仪测得载体坐标系相对于惯性坐标系的姿态角速度，加速度计测得载体沿坐标系各轴向的加速度分量，利用陀螺测得的角速度信息计算出姿态矩阵并提取姿态角，利用姿态矩阵将加速度计的测量信息变换到导航坐标系上，然后在导航坐标系中进行加速度到速度的积分以及速度到位置的积分。 单轴旋转激光陀螺捷联惯导设备，是在捷联式惯导系统工作原理的基础上，通过方位轴的正反往复的旋转，对水平陀螺仪和加速度计的误差进行调制，从而达到提高系统精度的目的。其机械编排原理框图如图4所示： 图4. 单轴旋转捷联式惯导的机械编排原理图  惯性/星光组合系统组合模式基本原理是：将两套系统输出参数进行组合，应用卡尔曼滤波技术，将惯性导航系统的误差方程作为组合系统的状态方程，根据星光导航系统得到载体导航信息，将惯性导航系统与星光导航的导航参数误差作为系统量测，通过滤波估计并补偿惯性导航系统误差如图5所示。该组合模式实质上是为星光定向系统提供阻尼后的水平姿态的基础上进行位置组合，该模式下既可有效补偿惯性导航系统中由于陀螺漂移而引起的导航误差累积，还能有效地估计惯性导航中航向误差，从而提高组合导航的精度 [ 7 ]。 图5. 惯性/星光组合模式"
"由星光定向仪工作原理可知，在不需要任何外部基准信息的前提下，星敏感器可提供载体相对惯性系下的姿态信息，且精度保持稳定，误差不会积累；惯导系统的陀螺组件是直接敏感载体相对惯性系下的角速度，通过积分求出载体相对惯性系下的姿态，其精度随着时间增长而降低惯导系统平基准。通过比较星敏感器输出的惯性姿态和惯性导航系统输出的惯性姿态之间的误差，就可以估计陀螺漂移，进而修正捷联惯导的姿态信息 [ 8 ]，从而避免引入惯性导航系统本身的累计误差。 本文采用姿态四元数来描述载体在惯性系下的姿态，由于星敏感器得出的姿态四元数 q ˜ i / b 精度相对较高，可作为姿态四元数的真值，惯性导航系统输出的四元数 q ˜ i / b 为估计值，姿态四元数误差为： δ q i / b = q ˜ i / b − q ^ i / b 。具体高精度虚拟水平姿态基准构造方案如下图6所示 [ 9 ]： 图6. 高精度水平姿态基准构造方案 通过图6可知，高精度虚拟水平基准的构造实质上是通过星敏/惯导姿态组合(惯性系下)，利用高精度星敏定姿修正惯导姿态，有效抑制惯导姿态漂移，保证星光定向仪对水平姿态基准精度的要求。 构造高精度水平姿态基准的算法如下 [ 10 ] [ 11 ]： 第一步，建立以四元数误差和陀螺漂移为状态变量的状态方程。 捷联式惯性导航系统中陀螺仪固联于载体之上，其敏感到的为载体在惯性系下的运动角速度，设角速度矢量为 ω i b b = [ ω i b x b ω i b y b ω i b z b ] ，四元数表示形式为 ω i / b b = [ 0 ω i b x b ω i b y b ω i b z b ] ，姿态四元数为 q i / b = [ q 0 q 1 q 2 q 3 ] ，则姿态转换矩阵 C i b 与载体在惯性下的姿态四元数 q i / b 之间具有如下关系： q ˙ i / b = 0.5 q i / b ⊗ ω i / b b (1) 相应的等效矩阵矢量形式为： Q ( q ˙ i / b ) = 0.5 M ( q i / b ) ⊗ Q ( ω i / b b ) = 0.5 M ∗ ( ω i / b b ) Q ( q i / b ) (2) 式中： M ∗ ( ω i / b b ) = [ 0 − ω i b x − ω i b y − ω i b z ω i b x 0 ω i b z − ω i b y ω i b y − ω i b z 0 ω i b x ω i b z ω i b y − ω i b x 0 ] , Q ( q i / b ) = [ q 0 − q 1 − q 2 − q 3 q 1 q 0 − q 3 q 2 q 2 q 3 q 0 − q 1 q 3 − q 2 q 1 q 0 ] 。 将 Q ( q ˙ i / b ) = 0.5 M ∗ ( ω i / b b ) Q ( q i / b ) 两边同时微分，得四元数为状态变量的误差方程： Q ( δ q ˙ i / b ) = 0.5 M ∗ ( ω i / b b ) Q ( δ q i / b ) + 0.5 M ∗ ( q i / b ) Q ( δ ω i / b b ) (3) 式中： δ q i / b ——姿态四元数误差： δ q i / b = q ˜ i / b − q ^ i / b (4) δ ω i / b b ——陀螺角速度误差： δ ω i / b b = ε b + ε r + ε g { ε ˙ b = 0 ε ˙ r = − 1 T g ε r + w r (5) 式中： ε b ——随机常数； ε r ——一阶马尔可夫过程随机噪声； ω g ——白噪声； T g ——陀螺漂移的一阶马尔柯夫过程的相关时间。 将式(4)代入式(3)中，并联立式(5)，可得以四元数误差、陀螺误差为状态变量的状态方程： X ˙ = F ( t ) X ( t ) + G ( t ) W ( t ) (6) 其中系统状态变量为： X = [ δ q i / b 0 , δ q i / b 1 , δ q i / b 2 , δ q i / b 3 , ε b x , ε b y , ε b z , ε r x , ε r y , ε r z ] T ； 量测噪声为： W ( t ) = [ ω g x , ω g y , ω g z , ω r x , ω r y , ω r z ] T 。 F ( t ) 为系统状态矩阵， G ( t ) 为系统噪声矩阵，定义分别如下： F ( t ) = ( 0.5 M ∗ ( ω i b b ) 4 × 4 0.5 M ′ ( q i / b ) 4 × 3 0.5 M ′ ( q i / b ) 4 × 3 0 3 × 10 0 3 × 7 F M 3 × 3 ) 10 × 10 G ( t ) = ( 0.5 M ′ ( q i / b ) 4 × 3 ⋯ 0 4 × 7 ⋮ ⋱ ⋮ 0 6 × 7 ⋯ I 6 × 3 ) 10 × 10 其中， M ′ ( q i / b ) 4 × 3 = [ − q i / b 1 − q i / b 2 − q i / b 3 q i / b 0 − q i / b 3 q i / b 2 q i / b 3 q i / b 0 − q i / b 1 − q i / b 2 q i / b 1 q i / b 0 ] 4 × 3 , F M = d i a g [ − 1 T g x , − 1 T g y , − 1 T g z ] 。 第二步，建立量测方程。 若星敏感器解算出的姿态四元数为 q ˜ i / b ，惯性导航系统解算出的姿态四元数为 q ^ i / b ，将两者之差作为量测量 [ 12 ]，可建立量测方程为： Z = q ˜ i / b − q ^ i / b = δ q i / b = H X + V (7) 式中： H = [ I 4 × 4 0 4 × 6 ] ，V为系统量测噪声。 根据惯性/星光高精度水平姿态算法建立仿真验证对比其姿态精度，设仿真时间总共24 h，卡尔曼滤波周期为1 s。初始位置设为北纬39˚11'，东经117˚8'，初始速度为0 m/s。加速度计零偏1 × 10 −4 g，加速度计白噪声1 × 10 −4 g。三个陀螺漂移变化用一阶马尔科夫过程表示如图7、图8所示。横摇误差对比如图9所示、纵摇误差对比如图10所示、航向误差对比如图11所示。 图7. 水平陀螺(X, Y)的一阶马氏过程描述 图8. 垂向陀螺(Z)的一阶马氏过程描述 图9. 纯惯导与星光/惯导姿态组合横摇误差对比 图10. 纯惯导与星光/惯导姿态组合纵摇误差对比 图11. 纯惯导与星光/惯导姿态组合航向误差对比"
"惯性/星光水平姿态补偿技术通过组合系统的迭代修正，在星光设备持续寻星过程中为惯导提供参考基准实现组合，使其惯导系统的姿态误差长时间处于收敛状态，达到提高惯导水平姿态的目的，水平基准补偿技术提高后的惯导系统的水平姿态精度约为47%。从而实现为组合系统星光设备提供高精度的姿态基准创造了条件，同时为组合系统中惯导元件误差的精确估计奠定了基础。"
