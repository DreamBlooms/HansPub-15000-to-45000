"本文阐述了长江流域水利综合站网展示系统建设的目标和意义，在需求分析的基础上提出系统设计的总体架构和技术路线，并从数据组织、数据访问、缓存技术以及瓦片金字塔和GIS服务技术等方面分析了系统实现的关键支撑技术，最后就系统的功能结构和主要实现的功能模块进行了介绍。 关键词 :长江，水利，站网，GIS技术，展示系统"
"长江水利委员会不同单位按照相关职能和业务需要，在长江流域设立并管辖着不同类型站网，包括水文、水质、水土保持、水生态监测、科学实验以及专门为规划、设计等方面而设立的站点，承担着水文、水质、水土保持、水生态监测、科学实验等各方面的水利综合监测业务。由于长江流域片水利综合监测站网的布设范围广、站点多、测验项目多、信息量大，传统的管理方式无法满足展现与管理需要。为满足决策者对站网的分布状况的掌握、对测站基本信息的了解，对站网基本情况的分析和功能的评价，建设长江流域水利综合站网展示系统以辅助站网综合规划和管理是十分必要的。"
"根据长江流域片流域管理水利综合监测站网规划[ 1 ] 要求，长江流域水利综合站网展示系统建设的主要目标就是充分利用长江流域地理信息数据、3D模型数据，并集合长江流域相关业务数据库，基于计算机技术、数据库技术和GIS技术，构建站网管理和展示模型，实现全流域地理资源、水网资源、站网数据的管理以及各类站网信息的动态可视化展示和查询，及时掌握各类站网信息，为综合站网的规划设计、建设运行提供技术支撑。其具体意义主要体现在以下几个方面： 1) 通过系统对综合站网信息进行科学的管理，从而有效避免信息传递效率低、信息更新周期长等缺点，实现站网信息管理数字化、查询可视化、更新迅速化以及信息可扩展化[ 2 ] ，并为实现优势互补、资源共享，优化站网功能，避免重复建设提供决策依据。 2) 通过系统建设，构建一数一源、一点更新的站网基础信息数据源，并以此为基础对现有数据组织存储体系进行升级与完善，与相关业务数据资源进行整合，构建各个数据资源之间关联关系和层次关系。促进长江流域各类水利信息资源的整合与共享以及综合利用与服务。 3) 通过系统建设，将长江流域站网信息与长江流域地理信息相结合，依托三维仿真技术实现可视化管理与服务，并支持与现有防汛抗旱决策支持系统等信息化系统高度集成，为长江流域防汛抗旱、水资源管理、水资源保护、河势稳定等提供决策支持服务，从而推进了长江水利信息化的整体发展。"
"根据系统建设目标，并结合长江委信息化建设现状，长江流域水利综合站网展示系统要求在对现有全流域地形数据、晕渲图数据、影像数据，站网数据科学化管理和组织的基础上，实现长江流域片各类监测站点的可视化展示和查询，并通过GIS空间分析功能，提供多种模式的站网规划分析、计算和统计功能，为站网的综合规划和建设管理提供支撑。 其主要需求为： 1) 利用长江流域地形DEM数据，影像DOM数据，制作全流域渲染底图，实现行政区划数据(省、市界)、地名数据、河流湖泊数据的组织、加载和显示控制。 2) 构建长江流域站网信息数据库，实现站网信息分层、分类标识。并与相关业务数据库实现数据关联。 3) 实现现有的和规划的各类测站、断面的组织与管理，以及站网信息的分层、分类展示。 4) 实现测站站点可视化“捕捉”和站点基本信息查询和业务数据查询。 5) 提供重叠分析，密度分析等多种模式的站网规划分析、计算和统计功能。 6) 实现重要站点或水利设施工程的模拟展示，在叠加全江河道地形监测信息的情况下，支持流域内重要站点或水利设施工程的仿真模拟展示。 7) 支持相关业务的可视化分析计算及决策辅助等功能，如水位流量关系、设计暴雨、设计洪水、径流年内年际分配及地区组成等，可以为防汛会商、调水调沙等提供可视化决策支撑。 8) 具备良好的开放性和扩展性，为后期的基于站网分布的GIS应用开发提供扩展接口。"
"按照建设目标和总体需求，长江流域水利综合站网展示系统在整合长江流域空间信息、站网信息和业务信息的基础上，利用三维仿真软件Gaea Explore作为GIS基础平台，通过Gaea Explorer平台提供的开发包开发客户端系统，实现站网管理、展示查询、分析统计等功能，为长江流域基于站网信息资源的信息共享、辅助规划、决策支持提供可视化技术支撑，系统的总体框架见图1。长江流域水利综合站网展示系统由三层架构搭建，分别为数据层、服务层和应用层。 1) 数据层：主要包括三维场景数据、矢量空间数据、站网信息数据以及业务数据资源。其中三维场景数据为DEM数据、DOM数据、三维数据等进行融合匹配后形成的三维金字塔瓦片数据库，采用文件方式存放在服务器端；水网水系、行政区划数据采用矢量空间数据格式存放在服务器端，通过Gaea Explorer平台调用和访问；站网信息数据是通过对业务数据库的抽取形成的索引型信息资源，除了存储测站基本信息外，还存储了与业务数据资源之间的关联关系，是站网展示，信息查询、统计分析的核心信息资源。 2) 服务层：主要由Gaea Explorer三维数字地球综合应用与虚拟仿真平台提供的各类服务支撑。数据组织管理服务主要用来管理三维场景金字塔结构和矢量数据匹配；数据瓦片服务主要向应用层提供各类数据服务， 图1. 长江流域水利综合站网展示系统总体架构图 以便系统方便快捷的访问和调度；应用功能服务主要提供平台内置的大量功能，如浏览、漫游、量算、放大、缩小、定位等；三维仿真服务主要提供各类动态逼真的三维虚拟现实仿真模拟。 3) 应用层：为基于Gaea Explorer三维数字地球综合应用与虚拟仿真平台提供的SDK开发包所搭建的应用功能，通过继承平台已有的功能和新开发的各项功能，对外提供良好的站网展示、查询、统计、符号化及制图等功能，并通过二次开发实现信息共享、辅助规划、决策支持等应用服务功能。  系统采用三维仿真软件Gaea Explore作为GIS基础平台，基于WebGIS技术，可在网络环境下实现海量数据无缝组织、管理和可视化。采用C/S架构搭建，所有的空间数据、属性数据、信息资料等存放于服务器端，通过Gaea Explorer平台提供的开发包开发客户端系统，实现在线数据访问和离线(缓存方式)数据访问。 系统利用网络计算机技术、空间信息分析技术、数理统计与模拟预测技术、虚拟现实技术等，借助数字化和信息化的手段，最大限度利用信息资源。系统设计开发以数据库技术、网络技术和地理信息系统技术为支撑，以空间数据和属性数据为基础，通过对空间数据和站网数据的存储和管理，建立数据管理、站网规划辅助分析和三维综合展示为一体的综合展示系统。在系统研发过程中采用以下总体技术路线和技术模式，使系统更具较好的实用性、可靠性、安全性和先进性。 1) 高效利用现代网络体系，充分适应系统各功能的工作特点，采用C/S模式建立系统总体构。 2) 采用模块化方式进行开发，各模块只处于低耦合状态，方便用户进行功能的扩充与更改，使系统功能实现更具灵活性与可塑性。 3) 利用空间数据引擎，实现对站网数据和流域地理数据进行多时相数据一体化存储、管理与调度，实现海量数据的快速查询、分析与计算。 4) 利用多种可视化方式实现站网数据的空间、属性信息联合展示、查询和统计。 5) 采用金字塔数据管理、多维索引机制、虚拟现实(VR)、LOD分块调度等技术实现大场景的三维可视化调度，真实再现现实景观。"
"长江流域设立并管辖着不同类型站网，包括水文、水质、水土保持、水生态监测、科学实验等，承担着水文、水质、水土保持、水生态监测、科学实验等各方面的水利综合监测业务，各自形成了各自的业务信息数据库系统。采用多源异构数据组织的方法，建立综合站网基础信息索引数据库，构建站网基础信息索引与业务数据库基础信息之间的关联，实现站网基础信息的统一组织。 多源异构数据组织的基本思路是认同各类站网信息可以具有自己独立的信息组织模式，为了将这些分散异构的信息，组织成统一的、整体的信息资源，又保持各类水文信息各自的独立性，根据“虚拟化”的基本原理，通过构造相应的信息资源统一组织架构，为用户提供虚拟化的信息资源开发利用条件。信息资源统一组织架构主要由存贮、描述和资源持久性与安全控制3个体系，以及数据源注册、数据抽取与转换、数据源动态配置、虚拟化信息资源组成和资源开发应用支撑5层处理构成[ 3 ] 。这3个体系和5个处理层次，有效保证了各类站网信息资源的原有形态，并可充分利用各类站网信息资源的计算资源，形成逻辑上完整的信息全集，为充分利用分散的、异构的水文数据集，提供基本参考模型。  采用Gaea Explorer平台提供海量影像数据发布能力，实现整个长江流域DEM、DOM数据快速、稳定的访问。数据的存储性能和访问性能对整个GIS应用的性能有着重要的影响作用，所以空间数据库引擎的功能和性能对GIS应用的功能完整性和运行效率具有重大的影响。通过Gaea Explorer平台，可以把GIS的空间几何对象数据和属性数据一体化存储到多种关系型数据库中，能够对数据进行索引维护、追加、更新、删除等维护操作，按属性条件或空间条件来对数据进行各种查询返回需要的数据，还具备提供长事务、版本、拓扑关系维护等高级功能。  平台的优劣不仅仅体现在架构、界面和操作深度上，提高系统响应速度来提升用户体验也是获得用户青睐的重要方法[ 4 ] 。Gaea平台通过采用缓存技术，来减少请求数据服务的次数，直接从内存中获取已经缓存的数据信息，来大大提高系统响应效率。Web应用大都将数据保存到RDBMS中，应用服务器从中读取数据并在浏览器中显示。但随着数据量的增大、访问的集中，就会出现RDBMS的负担加重、数据库响应恶化、网站显示延迟等重大影响。 应用缓存技术，就是为了解决上述问题，使系统能够基于高速运行的分布式缓存服务器，实现最佳的用户体验。第一次访问从数据库中取得数据存放到缓存中，第二次访问从缓存中取得数据进行页面显示，数据缓存结构示意图如图2所示。  金字塔图片引擎是将地图按照比例尺和图层进行地图图片切片，形成无数小文件图片后由图片引擎负责在客户端根据地图大小将多张图片拼接形成切片前的效果[ 5 ] 。ServiceGIS服务器软件平台将地图图片引擎统一集成在网络GIS服务器中，图片服务引擎是ServiceGIS平台提供服务器的关键组成部分，同时，将GIS图形引擎也集成在统一的平台中，在功能上实现对接。地图服务启动时，图片引擎按照预订的比例尺，自动切图为静态图片，并建立图片金字塔，统一对外。地图引擎的地图内容更新后，ServiceGIS软件平台将协同GIS图形引擎和图片引擎，按照实际更新范围进行动态更新，实现动态图片按需切片，从而保障切片效率。平台除了提供地图图片引擎服务以外，还提供GIS服务引擎进行深度GIS应用分析与空间表达和服务聚合。通过这种模式，不但可以满足平台本身需求，还可以将传统只能在C/S应用模式应用的空间分析功能在B/S应用模式中进行服务共享应用。"
"按照长江流域站网综合规划总体要求，结合需求分析，基于3DGIS的长江流域水利综合站网展示系统在功能上主要实现了流域影像三维展示、站网信息分类分级展示、站点信息可视化查询、站网规划分析以及基于3DGIS的长江流域水利综合站网平台的扩展支持功能。系统功能结构如图3所示。其中站网分类分级展示、站 图2. 数据缓存结构示意图 点信息可视化查询、站网规划分析是系统建设中的主要业务功能。 1) 站网信息分类分级展示 站网展示主要实现站网信息在地图上的特征标注，以及站网分级、分类展示。站网分级展示支持不同比例尺下的高密度站点的分级展示。站网分类展示主要是按照站点的类别在地图上实现分层控制展示。站网展示展示内容包括水文站网、河道站网、水质监测站网、水土保持监测站网、水生态保护监测站网、科学实验研究观测站网等站网信息的展示，可以通过叠加站网类别控制站网的展示效果。长江流域水文站网信息展示如图4所示。 2) 站点信息可视化查询 信息查询包括测站基本信息查询和站点业务数据查询。测站基本信息查询实现站点的可视化“捕捉”，可以查询并可显示站点的基本属性信息，包括站名、站码、位置、站类、站别、测验项目、测验方式、管理单位、坐标信息等字段信息。站点业务数据查询实现站点相关业务数据的可视化查询，可以查询其在某一时间段的业务观测数据，通过表格及统计图表的方式进行展示，如实时水雨情信息，历史水文数据、水环境监测数据等。站点的可视化“捕捉”，并查询该站点的水位、流量数据如图5所示。 3) 站网规划分析 站网规划分析能够主要是为站网规划提供决策支撑信息，包括站网密度分析和站点重叠分析两个主要模块。密度分析主要是实现某一区域内测站的密度分析，区域可以是水系、行政区域或自定义区域。重叠分析是根据设定的距离参数，计算在该参数内存在重叠的测站，予以提示。水文站监测与水质监测站点之间的重叠分析如图6所示。 图3. 长江流域水利综合站网展示系统功能结构示意图 图4. 长江流域水文站网信息展示 图5. 站点的可视化“捕捉”，并查询该站点的水位、流量数据 图6. 水文站监测与水质监测站点之间的重叠分析"
"长江流域水利综合站网展示系统是长江流域片流域管理水利综合监测站网规划项目的重要信息化支撑手段，也是规划成果的主要展示平台，系统建设内容涉及长江流域设立并管辖的不同类型站网，基于多源异构数据组织技术建立的统一站网信息展示体系和为站网规划提供决策支撑的不同类型站网之间的重叠分析功能是本系统的主要创新点。系统还在水流防真、洪峰演进等方面进行了研究性开发，充分展示了长江流域水利综合站网展示系统的可扩展性和能够为长江流域防汛抗旱、水资源管理、水资源保护、河势稳定等提供信息化决策支持服务的能力。"
