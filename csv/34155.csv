"针对航天器编队飞行协同机动任务，设计了一种基于一致性理论的编队航天器轨道机动协同最优控制律。采用适用于任意椭圆轨道的方程来描述编队航天器相对运动，考虑J2摄动项对编队航天器轨道运动的影响，针对Lambert问题，基于一阶一致性理论提出协同控制律，设计了多脉冲的轨道机动策略。采用遗传算法进行优化，结合机动过程中的编队构型保持，实现燃料最优的协同控制。仿真结果表明，该方法能够有效实现编队航天器的最优协同机动。 关键词 :编队航天器，Lambert机动，协同控制，一致性理论，遗传算法 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着航天技术的发展，航天器编队飞行越来越受到重视，单一大型航天器的功能可由航天器编队协同工作来实现。编队中多个航天器协同工作，共同完成同一任务目标，是编队航天器的本质特点，也是其与单平台航天系统相比的优势所在，因此自主协同控制是编队航天器正常工作的技术保证和实际应用的关键 [ 1 ]。 要保证航天器编队长期稳定工作，提出的控制律必须有较强的鲁棒性 [ 2 ]。协同控制不仅满足这一要求，并且具有良好的稳态特性和动态性能。王智鹏等 [ 3 ] 提出了一种基于事件驱动的相对姿态分布式自适应控制算法，在降低控制输入更新频次和星箭交互信息量的基础上，实现了卫星编队闭环协同控制。 协同控制方法包括一致性控制、编队控制、合围控制和跟踪控制等 [ 4 ]。信息交换是协同控制的必要条件和核心问题，一致性协议就是针对信息协同的需求而提出的。它的优势在于较少的信息交换以及允许动态、稀疏或间断的信息拓扑，使得系统能够满足较强鲁棒性及实用性需求。一致性问题现在越来越受到控制领域研究者的重视，尤其是对于编队任务的协同控制 [ 5 ] [ 6 ] [ 7 ]。 目前对于编队任务的一致性控制研究主要集中于机器人及无人机编队 [ 8 ]，或仅针对近圆轨道的航天器编队进行控制 [ 9 ]。本文将一致性理论应用于编队航天器的协同机动控制，通过邻接矩阵描述航天器之间的通信链，只需给出各航天器的期望状态，即可实现编队协同控制。采用任意椭圆轨道相对运动方程描述编队中航天器的相对运动，考虑J2项摄动项对编队轨道运动以及相对构型的长期影响，应用一阶一致性算法实现对编队航天器整体轨道机动的控制，并采用遗传算法进行最小燃料消耗的优化。"
"相对运动的两个航天器分别称为参考星和目标星。在参考星第二轨道坐标系S c 中，目标星相对于参考星的位置矢量为 δ r = ( x y z ) T 。假设两星的相对距离远小于参考星到地球球心的距离，在坐标系S c 中任意椭圆轨道相对运动方程为 [ 10 ] ： ( x ¨ y ¨ z ¨ ) = ( − k ω 3 / 2 x + 2 ω z ˙ + ω ˙ z + ω 2 x − k ω 3 / 2 y 2 k ω 3 / 2 z − 2 ω x ˙ − ω ˙ x + ω 2 z ) + ( u x u y u z ) (1) 其中 k = h / p 2 ，h和 ω 分别为参考星轨道动量矩和角速度， ( u x u y u z ) T 表示目标星和参考星的加速度之差，具体定义为： ( u x u y u z ) T = a f + a c d − a t d (2) 其中，a f 为目标星所受地球引力之外的力导致的加速度，a cd 为目标星所受控制力产生的加速度，a td 为参考星所受地球引力之外的力导致的加速度。在推导式(1)的过程中，唯一的假设是两星之间距离相对较小，因此式(1)可以适用于任意偏心率的轨道。  对于近地轨道的航天器编队，J2摄动是影响航天器轨道保持及编队构型保持的主要因素。在地心赤道惯性坐标系S i 中，J2摄动项产生的加速度为： { f X i = − 3 2 J 2 R E 2 μ X i r 5 ( 1 − 5 Z i 2 r 2 ) f Y i = − 3 2 J 2 R E 2 μ Y i r 5 ( 1 − 5 Z i 2 r 2 ) f Z i = − 3 2 J 2 R E 2 μ Z i r 5 ( 3 − 5 Z i 2 r 2 ) (3) 其中，r是航天器到地球中心的距离，R E 是地球半径， ( X i Y i Z i ) T 为航天器质心在惯性坐标系中的位置矢量，有： ( X i Y i Z i ) T = L i o ( r 0 0 ) T (4) 其中，L io 是地心轨道坐标系S o 到地心惯性坐标系S i 的转换矩阵。 在轨道坐标系S o 中，目标星相对于参考星的位置矢量为 δ r = ( x y z ) T ，则在惯性坐标系S i 中，相对位置矢量为： ( Δ X i Δ Y i Δ Z i ) T = L i c ( x y z ) T (5) 其中，L ic 是轨道坐标系到惯性坐标系的转换矩阵。在轨道坐标系中，相对位置导致的航天器加速度之差 ( Δ f x Δ f y Δ f z ) T 为 [ 11 ] ： [ Δ f x Δ f y Δ f z ] = L c i [ ∂ f X i ∂ X i ∂ f X i ∂ Y i ∂ f X i ∂ Z i ∂ f Y i ∂ X i ∂ f Y i ∂ Y i ∂ f Y i ∂ Z i ∂ f Z i ∂ X i ∂ f Z i ∂ Y i ∂ f Z i ∂ Z i ] [ Δ X i Δ Y i Δ Z i ] (6) 由式(3)和(6)可以得到J2摄动项导致的相对加速度。当 ( u x u y u z ) T = ( Δ f x Δ f y Δ f z ) T (7) 可得到航天器仅受J2摄动影响时的相对运动。"
"在实现编队构型时，参考虚拟结构(Virtual Structure) [ 5 ] 的概念，采用如下思路：在惯性坐标系中，假设期望的编队构型如图1(a)所示。选择某一点作为编队中心(可以是实际的航天器，也可以是空间中的虚拟点)，r F 是编队中心的状态参数，r i 是编队中第i个航天器的状态参数，r iF 是第i个航天器相对于编队中心的状态参数。显然，各参数之间的关系为： r F = r i − r i F (8) 在实现编队构型之前，各航天器r i 可能不满足期望状态，因此由式(8)计算出的编队中心可能得到不同的结果，记为 r o i , i = 1 , ⋯ , n ，如图1(b)。当 r o i → r o j → r F 时，即实现期望的编队构型。 图1. 虚拟结构编队实现  根据文献 [ 5 ] 中基于图论的一致性协议，采用虚拟结构的概念，惯性坐标系下的编队航天器一阶一致性控制协议如下： u i = r ˙ i F + r ˙ F − γ ( r i − r i F − r F d ) − ∑ j = 1 n a i j [ ( r i − r i F ) − ( r j − r j F ) ] (9) 其中， γ > 0 为给定的控制参数， A = [ a i j ] n × n 为邻接矩阵，其余参数含义与式(8)相同，上标d表示期望状态。当 r o i → r o j → r F d , r ˙ o i → r ˙ o j → r ˙ F d 时，系统达到一致。 定义如下参数 [ 9 ] ： e i = r i − r i F − r F d (10) e ˙ i = r ˙ i − r ˙ i F − r ˙ F d (11) 而式(9)可以改写为： ( r ˙ i − r ˙ i F − r ˙ F d ) + γ ( r i − r i F − r F d ) + ∑ j = 1 n a i j [ ( r i − r i F ) − ( r j − r j F ) ] = 0 (12) 将式(10)、(11)代入式(12)，得到： e ˙ i + γ e i + ∑ j = 1 n a i j ( e i − e j ) = 0 (13) 当 t → ∞ 时， e i → e j → 0 , e ˙ i → e ˙ j → 0 ，系统达到一致，实现并保持编队构型。 下面讨论系统的稳定性。由邻接矩阵A可定义系统的拉普拉斯矩阵 L = [ l i j ] ： l i j = − a i j , ∀ i ≠ j ; l i i = ∑ j = 1 , j ≠ i n a i j (14) μ i 是矩阵-L的第i个特征值。由-L的定义可知： Re ( μ i ) ≤ 0 (15) 根据文献 [ 5 ]，当且仅当： r a n k ( L ) = n − 1 (16) 邻接矩阵A表示的通信拓扑包含有向生成树，此时式(8)给出的一致性协议可以使系统达到渐进一致。"
"Lambert机动是最常用的快速变轨策略之一。Lambert问题可以概括为：给定空间中两点的位置矢量以及转移时间，寻找一条轨道来实现其中一点到另一点的过渡，转移时间方程为： Δ t μ / a 3 = ( α − sin α ) − ( β − sin β ) (17) 其中， Δ t 为转移时间，a为转移轨道半长轴， μ 为地球引力常数， α 和 β 为待求参数，由初始及目标轨道决定。 由于基于二体问题的相对运动模型误差、控制误差及摄动影响等，在远距离机动过程中，这些误差积累不容忽视，因此本文采用四次脉冲策略，以减小编队机动中的误差。求解时，以中间两次脉冲施加的时刻分别作为当前新的初始状态，目标轨道不变，求解Lambert问题，实现多脉冲机动。  对于n个航天器组成的编队，在进行轨道机动时，各成员施加与参考星相同的控制脉冲，且相对位置和相对速度在施加脉冲前后不变。因此用于轨道机动的燃料消耗为： Δ v t r a n = n Δ v t r a n , i (18) 由于在偏心率较大的转移轨道上，编队构型很难自主保持，因此在机动过程中需要施加N次控制以维持编队构型，燃料消耗为： Δ v m a i n = ∑ j = 1 N Δ v m a i n , j (19) 遗传算法优化变量为第二、三次脉冲的施加时间以及一致性控制协议的参数，即 [ t 2 , t 3 , γ ] 。优化性能指标，即遗传算法的适应度函数为： J = k 1 / Δ v t r a n + k 2 / Δ v m a i n (20) 通过对权重系数 k 1 、 k 2 的设计，可以实现对不同目标的优化 [ 12 ]。"
"采用式(9)中的控制律，对式(1)所表示的系统进行控制，针对近圆轨道上的编队Lambert机动进行仿真，通过式(1)来跟踪编队航天器的相对运动，右端加速度之差由J2摄动产生，即式(6)，以保证编队在椭圆轨道运行时相对状态的计算精度。 以某五星编队为例，编队初始构型为半径2000米的水平面圆，如图2；整个转移过程的时间为1884.4秒，编队虚拟中心初始轨道及目标轨道参数如表1，其中，a为轨道半长轴、e为轨道偏心率、i为轨道倾角、 ω 为近地点幅角、 Ω 为升交点赤经；M为平近点角。一致性控制协议(9)的邻接矩阵为： A = ( 0 I 4 0 0 ) (21) 图2. 编队初始构型 遗传算法运行参数如下：种群大小为80，终止代数为60，交叉概率为0.6，变异概率为0.001，优化变量的取值范围为： [ t f / 100 , t f / 2 , 0.01 ] ≤ [ t 2 , t 3 , γ ] ≤ [ t f / 2 , ( t f − 100 ) , 10 ] (22) 由于用来维持编队构型的燃料消耗远小于机动控制脉冲，因此权重系数选取为： k 1 = 10 4 ,   k 2 = 10 8 (23) 表2为经遗传算法优化得到的虚拟中心转移轨道参数，表3为优化前的任意给定的多脉冲Lambert机动参数以及优化后的最优变量及相应的最优性能指标对比，遗传算法优化过程如图3。可以看出，在燃料最优的机动目标下，编队整体机动的燃料消耗有所减少。 Table 1 轨道要素 a/(km) e i/(˚) Ω/(˚) ω/(˚) M/(˚) 初始轨道 7100 0.1 70 45 20 30 目标轨道 8700 0.1 70 45 20 130 表1. 机动航天器编队中心的初始轨道及目标轨道 Table 2 a/(km) e i/(˚) Ω/(˚) ω/(˚) θ/(˚) 8353.575 0.2392 70 45 2028.1 28.3 表2. 虚拟中心转移轨道参数 Table 3 t 2 / ( s ) t 3 / ( s ) γ Δ V t o t a l / ( m ⋅ s − 1 ) 多脉冲优化前 628.1 1256.3 1 8083 多脉冲优化后 663.6 1614.3 1.3 7458.75 表3. 最优变量和最优性能指标 图3. 遗传算法优化  根据遗传算法优化的结果，采用一致性协议(9)进行编队的多脉冲机动控制。图4为惯性坐标系中编队整体轨道机动的运行轨迹，图5和图6分别为不施加任何控制以及采用控制算法(9)进行编队构型保持控制时，编队机动过程中五个成员之间的相对距离变化，其中，Si-Sj表示第i，j个航天器之间的距离。 由仿真结果可以看出，控制算法可以有效实现编队整体的轨道机动，并且在机动过程中能够基本保持编队构型稳定，误差在10米以内。虽然在机动初始阶段存在震荡，但很快得到有效抑制，使得航天器相对位置偏移在可接受的小范围内。式(21)给出的邻接矩阵A描述了编队航天器通信链，体现了控制算法的协同性特点，另外由于仿真算例中A选取为稀疏矩阵，通信链结构简单，证明控制算法的通信需求相对较小。 图4. 编队轨道机动 图5. 无控状态下编队机动时的星间相对距离 图6. 施加控制后编队机动时的星间相对距离"
"一致性控制理论作为一种分布式控制方法，具有不依赖全局通信网络的高鲁棒性优势，是未来多目标编队协同控制技术的重要研究方向之一。本文设计了一种基于一致性理论的编队航天器协同机动控制系统，并采用遗传算法对编队多脉冲Lambert机动进行优化，得到编队轨道机动和构型保持的燃料最优机动控制方案。仿真结果表明，本文提出的编队航天器一致性协同控制方法简单、有效，且具有较高的精度，只需给出期望构型状态参数，即可实现对编队航天器轨道机动的协同控制并有效保持编队构型稳定。控制方法具有较强的独立性和鲁棒性，对编队航天器分布式协同控制策略的制定及研究具有一定指导意义。"
