"提出了一种光伏电站功率的主因隐藏型径向基神经网络(RBFNN)预测方法。先合理隐去影响光伏电站功率的主要气象因素“太阳辐射强度”，建立RBFNN预测模型。再按与预测时点气象因素记录的马氏距离从历史记录中筛选出相似样本集，对RBFNN模型进行学习训练。运用训练好的RBFNN实现短期光伏电站功率的预测。这种方法不仅合理隐去了预测中难以获取的地面太阳辐射强度、使光伏功率预测易于实现，而且运用马氏距离筛选样本、改进了预测精度。仿真结果验证了本文方法的有效性。 关键词 :光伏电站，功率预测，气象，马氏距离，径向基神经网络"
"光伏电源是未来能源无可替代的重要电源之一。光伏发电功率固有的波动性和间歇性严重影响电力网的安全稳定和经济性能 [ 1 ] - [ 3 ] 。开展短期光伏发电功率预测、以便采取应对措施极为重要。按与时间因素和空间因素的关系划分，光伏功率的预测方法有时–果关系预测法和因果关系预测法两大类。 时–果关系预测法以光伏电站功率的历史时间序列数据为基础，通过数学建模描述光伏功率随时间的变化规律，继而在时间坐标上延伸该变化规律、实现光伏功率的预测 [ 4 ] - [ 7 ] ，其实施的复杂度低。这类方法假定光伏功率随时间的过去发展变化规律会照样延续到未来，这是给定边界条件不变的封闭系统才具有的行为特征。但一个地区小气象的变化总是空间开放的，不属于封闭系统，其边界气象条件随时变化。因此，时–果关系预测法在原理上准确度低。因果关系预测法以光伏电站功率及其空间影响因素的历史数据为基础，通过建模描述光伏功率随影响因素的变化规律，继而运用未来的影响因素映射、实现光伏功率预测 [ 8 ] 。这类方法假定光伏功率随其影响因素变化的规律不变，符合光伏发电系统固有的光电转换物理规律。它不仅计入空间因素的影响，还自然计入时间因素的影响(因为空间因素描述的总是一个时间段面的状态)，适应地区小气象变化固有的开放特性。因此，因果关系预测法在原理上准确度高。 按是否需要地面的太阳辐射强度来划分，因果关系预测法又分为“直接”和“间接”因果关系预测法两种。直接因果关系法需要先预测直接影响光伏功率的最主要因素“地面太阳辐射强度”、再结合气象数据预测光伏功率 [ 9 ] - [ 12 ] ，其复杂度等同天气预报。间接因果关系法利用公共资源中已有的天气预报数据和气象学知识建立光伏功率随间接影响因素变化的规律关系，实现光伏功率预测 [ 13 ] [ 14 ] ，其复杂度低且所需数据易于获取、方法易于实施。因此，间接因果关系法是一种比直接因果关系法实施复杂度更低、更可取的方法。本文中RBFNN是一种智能预测算法，学习能力强，能适应较复杂的天气且在简单和复杂的天气中预测精度较高，在国外，日本东京农业技术大学采用RBFNN模型用于本校20 kW光伏发电系统 [ 15 ] 发电试验。在国内，华中科技大学采用RBFNN方法预测该校18 kW光伏发电系统并在此基础上建立了基于数值天气预测的神经网络光伏发电预测模型 [ 16 ] ，近几年上海、湖北等地也对该类方法开展了深入研究。 综上，从原理准确度和易实现性来讲，间接因果关系预测法是光伏功率预测的最可取方法。但已有的这些方法，有的一次映射就完成一天多时点光伏功率的预测，模型中需要显含大气上界的太阳辐射强度或隐含假定其一天不变(未反映早中晚太阳高度角从0增大再减小到0对光伏电站功率的影响)；有的只考虑气温和湿度两个影响因素 [ 17 ] ，没有计及风速和云量等重要因素对散热和漫反射的影响。为此，本文提出了一种预测光伏电站功率的主因隐藏型间接因果RBFNN方法，以弥补这些缺陷。"
"本文旨在实现白天15分钟一个点的光伏电站发电输出功率预测，供日前或实时电力调度使用。按光伏发电原理，光伏电站的发电输出功率 为： (1) 其中： 为光伏组件的个数； 为单个光伏组件的面积(m 2 )； 为光伏组件的额定转换效率； 为 时刻太阳对光伏电池板倾斜面的辐射强度(地面的辐射强度再考虑倾斜)、包括直达日射强度和漫射日射强度(kW/m 2 )； 为光伏电池板温度系数(通常在0.005左右)，光伏电池板温度影响光电转换效率； 为 时刻光伏电池板表面的温度(℃)。这些都是光伏电站输出功率的直接影响因素，式(1)具体体现了这种影响的直接因果形式关系。 称指定安装地点、安装容量、光伏电池板朝向(通常是正南)和倾斜角(通常是38˚左右)的正常运行光伏电站为指定电站。对指定电站，式(1)中的 、 、 、 是常量，光伏电站输出功率的直接影响因素缩减到只有太阳对光伏电池板倾斜面的辐射强度 和光伏电池板表面的温度 ，如图1所示。图1中间层2个方框是这两个直接影响因素，顶层的光伏输出功率是它们导致的结果。 按气象学知识，太阳对光伏电池板倾斜面的辐射强度 是大气上界的太阳辐射强度经大气衰减后的直达日射强度、与大气中空气分子和水蒸气及尘埃等对太阳辐射的吸收和反射及散射引起的漫射日射强度之和。因此，两者大小都取决于大气上界的太阳辐射强度和总云量、降水量、相对湿度、气压、气温、风速(后六项体现大气状态决定的漫射条件)等。对指定电站，其大气上界的太阳辐射强度取决于地球周期公转轨道和周期自转轨道上的位置，前者是以年为周期的日期 的函数、后者是以天为周期的时间 的函数。由于短期(如一个月)内地球公转轨道半径变化极小，可认为大气上界的太阳辐射强度只是时间 (简称时点 )的函数、用 表示。图1底层大气上界的太阳辐射强度和总云量、降水量、相对湿度、气压、气温、风速等，又是太阳对光伏电池板倾斜面的辐射强度的直接影响因素。用 表示这种影响的直接因果形式关系时有： (2) 其中 分别是白天 时刻大气上界太阳辐射强度、总云量、降水量、相对湿度、气压、气温、风速的大小(这7个影响因素用下标 区分)。 另外，由热力学原理，光伏电池板表面的温度 由其本身发热量、环境气温和风速等散热条件构成的热平衡方程决定。光伏电池板本身的发热量是其发电输出功率的复杂函数。因此，光伏电池板表面的温度也是大气上界的太阳辐射强度和总云量、降水量、相对湿度、气压、气温、风速(后六项体现大气状态决定的散热条件)等的函数。即，这7个因素也是光伏电池板表面温度的直接影响因素。用 表示这种影响的直接因果形式关系时有： (3) 对式(1)~(3)的三个直接因果形式关系，考虑因果关系的传递性、并去掉中继传递因素 和 ，对指 图1. 光伏电站输出功率的因果关系 定电站，总光伏电站功率是大气上界的太阳辐射强度和总云量、降水量、相对湿度、气压、气温、风速等因素的影响结果，用 表示这种因果形式关系时有： (4) 与式(1)~(3)的三个直接因果形式关系不同，式(4)描述了光伏电站输出功率的间接因果形式关系。之所以称之为间接因果形式关系，是因为六个气象因素是通过“光伏电池板倾斜面的辐射强度和光伏电池板表面的温度”间接影响光伏电站输出功率大小的。"
"式(4)给出了大气上界的太阳辐射强度、总云量、降水量、相对湿度、气压、气温、风速与光伏电站功率之间的间接因果形式关系。对其可建立网络模型，并通过学习历史记录获取网络模型参数，实现光伏电站功率预测。  由光伏发电原理，光伏电站输出功率的间接影响因素中最主要的影响因素(简称主因)的是大气上界的太阳辐射强度。表1给出了我国香港和澳门地区(其正午太阳高度角高达90˚)天空晴朗无云的白天不同时点太阳对光伏电池板倾斜面的辐射强度(约90%是大气上界太阳辐射的直达日射)。表1中的结果是以早晨7:00的太阳高度角为0˚、正午12:00光伏电池板倾斜面的辐射强度为单位1计算得到的。 从表1最后2列可见，比邻相对误差最大值达100%、太阳对光伏电池板倾斜面的辐射强度从早晨到正午的值从0变到1。式(4)含大气上界的太阳辐射强度，利用式(4)的间接因果形式关系构建7点到12点光伏电站输出功率的预测模型时，大气上界的太阳辐射强度不可忽略。 实际上，光伏电站输出功率的间接因果形式关系(4)，不仅从“同日不同时点”这一横向角度、而且从“异日同一时点”这一纵向角度反映了各种间接影响因素的作用。因此，像式(4)的间接因果形式那样，任何一次映射就完成一天多时点光伏功率向量预测的方法、或用于一天多个时点且一次映射完成一个时点光伏功率预测的方法 [ 13 ] [ 14 ] ，在获取具体映射函数结构及参数时，丢掉大气上界的太阳辐射强度这一主因是不可行的。  式(4)从横向和纵向两个角度同时反映了光伏电站输出功率的间接影响因素的作用，其代价是获取具体映射函数结构及参数时不能丢掉大气上界的太阳辐射强度这一主因的影响。这不仅使具体映射函数结 Table 1 时刻 太阳高度角(˚) 直达日射强度 比邻相对误差(%) 7:00 0.00 0.0000 - 7:15 3.75 0.0654 100 7:30 7.50 0.1305 49.89 … … … … 11:30 82.50 0.9914 - 11:45 86.25 0.9979 0.65 12:00 90.00 1.0000 0.21 表1. 不同时点的太阳高度角和直达日射强度 构复杂、非线性度高，而且使预测准确度难以提高。因此，式(4)的间接因果形式关系有待简化。 称某个光伏输出功率预测时点为特定时点。按气象学知识，对指定电站，近期30天特定时点(即：异日同一时点)的气象记录中，大气上界的太阳辐射强度不受地球周期自转轨道上的位置的影响(因为都对应每天的同一特定时点)、只受地球周期公转轨道上的位置的影响。但30天内地球周期公转轨道半径的相对变化极小。由函数理论，从异日同一时点这一纵向角度看，式(4)中“大气上界的太阳辐射强度”可视为常量。进一步将该常量标度为0，则式(4)中可隐藏(去掉)“大气上界的太阳辐射强度”、简化为： (5) 其中，时刻 换成了表示 日特定时点的 ， 是 日特定时点的光伏电站输出功率记录， 是气象因素 在 日特定时点的记录。式(5)的光伏电站输出功率的间接因果形式关系，合理隐藏(去掉)了“大气上界的太阳辐射强度”这一影响因素。当然，这种隐藏是从“异日同一时点”这一纵向角度考虑问题时才可行的。进一步构建映射函数的结构并获取其参数时，也需要从“异日同一时点”这一纵向角度考虑问题。  考虑到RBFNN具有传统神经网络无法比拟的学习收敛速度，且能逼近任意非线性函数、映射复杂系统难以解析的规律，此处选择广义RBFNN来描述式(5)的光伏电站功率的具体间接因果形式关系。 按式(5)，从“异日同一时点”这一纵向角度看，预测光伏电站输出功率的模型结构中有“总云量、降水量、相对湿度、气压、气温、风速”六个输入变量、“光伏电站输出功率”一个输出变量。因此，建立光伏电站输出功率预测模型的RBFNN函数如下： (6) 其中： 是 日特定时点光伏电站功率 的标准化值。为改善预测精度，式(6)中所有输入变量和输出变量都应标准化； 是指数函数运算符； 是 日特定时点六个气象因素记录向量 的标准化向量； 是 日特定时点气象因素记录向量的标准化向量，是模型(6)的正则化径向基函数的中心向量(对应中间层径向基函数)，其个数等于训练样本数； 是欧氏范数运算符。式(6)中， 和λ是待确定的模型结构参数。 式(6)中隐藏(去掉)了“大气上界的太阳辐射强度”，因此称之为预测光伏电站输出功率的主因隐藏型间接因果RBFNN模型的结构。它是一个有六个输入变量和一个输出变量的非线性多因果函数。"
"要实现光伏电站输出功率的预测建模，还要求出主因隐藏型间接因果RBFNN模型结构(6)中的待定参数 和λ。这需要基于历史气象因素和光伏电站功率的记录样本来完成。考虑到预测日特定时点的光伏电站输出功率是待预测量、事先未知，为提高预测模型的准确度，拟按与预测日特定时点气象因素的马氏距离从历史记录中筛选出相似样本集，再对RBFNN预测模型进行学习训练、获取模型参数。  用 表示预测日， (m取30)表示历史日， 依次表示六个气象因素(总云量、降水量、相对湿度、气压、气温、风速)， 表示气象因素 在 日特定时点的记录。 表示 日特定时点六个气象因素记录构成的列向量， 是气象因素 在预测日和历史日特定时点的记录构成的 维列向量。这些气象因素记录从天气预报信息中得到。 按下式计算各历史日 特定时点的气象因素记录与预测日 特定时点气象因素记录之间的马氏距离 ： (7) (8) 其中， 是预测日 特定时点六个气象因素记录构成的列向量， 是气象因素 在预测日和历史日特定时点的记录构成的 维列向量。 是列向量 和 的协方差； 是以 为元素的实对称协方差矩阵； 是气象因素 在 日特定时点的记录。 和 分别是列向量 和 中元素的统计学均值。 马氏距离是协方差距离。两向量之间的马氏距离与原始记录的测量单位无关；标准化记录和中心化记录(即原始记录与均值之差)计算出的马氏距离相同；马氏距离能排除变量之间的相关性干扰(欧氏距离不能)，且满足“非负性、自反性、对称性和三角不等式”等距离的公理。因此，马氏距离能有效描述两个样本记录的相似程度。距离 越小时， 日特定时点的气象因素记录与预测日特定时点的越相似。 按马氏距离 从小到大从历史气象因素及光伏输出功率记录中筛选出20个与预测日特定时点气象因素记录相似的样本、构成相似样本集，并对其中每一个样本对应的历史日按逆时顺序用下标 (m缩减到20)重新连续编号记录，即 日特定时点的气象因素向量记为 、光伏输出功率记录记为 ，两者一起表示一个相似样本。  相似样本的气象因素记录中，各因素的量纲和记录的数值范围不同，需要标准化。根据相似样本集的均值为0和方差为1的数据标准化方法，按下式对相似样本集中各个量值的记录数据进行标准化。 (9) (10) 是相似样本集中气象因素 在 日特定时点的记录； 是 的标准化值； 是相似样本集中气象因素 在预测日和所有历史日 ( 缩减到20)特定时点的记录构成的 维列向量； 和 分别是列向量 中元素的统计学均值和标准差； 是相似样本集中 日特定时点的光伏功率记录； 是 的标准化值； 是相似样本集中所有 日特定时点的光伏功率记录构成的 维列向量； 和 分别是列向量 中元素的统计学均值和标准差。标准化后，六个性质和量纲不同的气象因素记录大小可比、影响力同趋化。 再根据各个量值的记录数据标准化结果按下式构建标准化的相似样本集, (11) 是相似样本集中 日特定时点六个气象因素记录的标准化值构成的列向量。  运用上述标准化的相似样本集(11)对式(6)的主因隐藏型间接因果RBFNN模型结构参数进行学习训练，得下述预测模型结构参数 的算式。 (12) (13) 上标符号+是代数学中的加号广义逆运算符。 是正则化径向基函数网络的输出连接权值。然后，按 所有两两组合的欧氏范数最大值除以 的商确定参数 ， 是正则化径向基函数宽度。 将上述 和 代入式(6)，即得光伏电站输出功率预测的主因隐藏型间接因果RBFNN模型的具体函数式，称之为光伏电站输出功率的主因隐藏型RBFNN预测模型。  根据建立的光伏电站功率的主因隐藏型RBFNN预测模型、预测日特定时点的气象因素记录，按式(6)计算预测日 特定时点光伏电站输出功率预测值的标准化值。 (14) 是预测日特定时点光伏电站输出功率预测值的标准化值； 是预测日特定时点六个气象因素记录的标准化值构成的列向量。再按下式对光伏电站输出功率预测值的标准化值去标准化，得到预测日 特定时点光伏电站输出功率的预测值 。 (15)"
"以某15 MW容量的光伏电站为例，取某年7月31日至8月29日共30天、每天7至18点且时间间隔为15分钟的气象和光伏输出功率记录作历史样本，并预测8月30日7至18点、共45个点的光伏电站输出功率。 本文提出的基于马氏距离和RBFNN的主因隐藏型光伏电站输出功率的预测方法(简称“本文方法”)，其预测结果如图2中红色曲线所示。基于RBFNN的光伏电站输出功率的预测方法(显含主要影响因素且不筛选样本，简称“常规方法”)，其预测结果如图2中蓝色曲线所示。为便于比较两种方法的预测结果，所以把实际功率也放在图2中，光伏电站输出的实际功率如图2中黑色虚线所示。图2中，本文方法的光伏输出功率预测结果紧密跟踪真实光伏输出功率值曲线、波动很小。相比之下，常规方法的光伏输出功率预测结果曲线与真实光伏输出功率值曲线偏差大，本文方法的结果比常规方法更好。 选用标准绝对值平均误差(normalized mean absolute error, NMAE)、标准均方根误差(normalized root mean square error, NRMSE)、标准平均相对误差(normalized mean relative error, NMRE)作误差评价指标。表2给出了本文方法和常规方法两种预测方法的误差指标值。 从表2可见，与常规方法相比，本文方法的标准绝对值平均误差NMAE减少了3.06个百分点，标准均方根误差NRMSE减少了5.38个百分点，标准平均相对误差NMRE减少了1.91个百分点。本文方法的预测精度相对基于RBFNN的常规方法显著提高。这主要是因为，本文基于马氏距离做样本筛选使得 图2. 本文方法和基于RBFNN常规方法的光伏输出功率预测结果 Table 2 误差 常规方法 本文方法 NMAE 6.55% 3.49% NRMSE 9.81% 4.43% NMRE 3.11% 1.20% 最大平均相对误差 39.24% 9.21% 最小平均相对误差 0.01% 0.01% 表2. 两种方法的预测误差 训练样本的模式与预测时点的影响因素模式更接近；此外，本文方法通过异日同时点建模来隐藏影响光伏输出功率的太阳辐射强度因素，避免了常规方法需要的地面太阳辐射强度之样本值不准确时所产生的误差。"
"对指定的光伏电站，合理隐去影响光伏输出功率的主要因素“辐射强度”，并基于异日同时点的记录学习和预测光伏电站输出功率是可行的。这不仅使光伏电站输出功率的预测模型维度被简化，还使预测方法易于实施。光伏电站输出功率的主因隐藏型RBFNN预测方法，不仅使映射函数的非线性度降低，还避免了常规方法存在的地面太阳辐射强度样本值不准确所产生的预测误差，使预测精度显著提高。"
