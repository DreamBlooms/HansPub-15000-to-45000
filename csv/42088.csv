"目前水库中长期优化调度的研究主要集中在模型的构建和求解方面，对于最优调度结果的研究却很少。通过构建水库中长期发电优化调度数学模型，并采用离散微分动态规划法(DDDP)进行求解最优调度结果。以隔河岩为研究实例，提出4类水电站运行方式和6类水库运行方式，分析隔河岩水电站运行方式特性。结果表明，河岩水电站运行方式以最小出力和加大出力为主，而水库运行方式则是以“V型”和“上限水位型”为主；并且，“V型”和“蓄水型”运行方式中，不出现水电站的破坏出力运行方式，“上限水位型”运行方式中，不出现水电站的最小出力运行方式。"
"水电具有运行成本低廉、调节性能优良和负荷响应迅速等优点，是目前开发技术最成熟、开发规模最庞大的可再生能源，作为可再生能源电力中的中流砥柱，水电在我国能源发展与结构调整中占据重要地位，与水电能源密切相关的水库调度研究一直是热点领域。 Bellman [ 1 ] 针对多阶段最优决策问题的特点，创立了著名的动态规划(DP)方法。DP是一种全局搜索法，可求出状态变量给定离散精度下的全局最优解。然而随着离散精度和水库数的增加，遍历寻优的方式会导致“维数灾”问题 [ 2 ]。针对该问题，国内外学者相继提出了一系列改进措施，其改进思路主要有三种：其一，改进初始轨迹的选取方式，进而加快收敛速度，如冯仲恺等 [ 3 ] 结合均匀试验设计，提出了均匀动态规划。其二，分析各项约束间的关系，从而缩减搜索空间，如明波等 [ 4 ] 基于发电调度模型中水电站最小出力以及下泄流量约束，提出了搜索空间缩减法；其三，通过多核计算技术缓解维数灾难题，如张忠波等 [ 5 ] 将并行计算与动态规划相结合，用OpenMP编程模式实现动态规划的并行计算。同时，随着计算机科学的发展，现代智能算法也逐渐应用于水库优化调度问题中 [ 6 ] [ 7 ] [ 8 ] [ 9 ] [ 10 ]，但智能算法普遍存在优化机理不明晰、计算结果不稳定、泛化能力差等问题，因而目前还缺乏实用性。另一方面，部分学者基于最优调度结果开展了水库优化调度的研究，丰富了水库调度领域的研究思路和成果：Yoo等 [ 11 ] 采用线性规划计算水库优化调度结果，并基于最优调度结果分析了弃水和库容之间的影响和敏感性；周研来等 [ 12 ] 以大渡河梯级为研究对象，基于模拟调度结果采用非线性规划法修正调度函数。 综上所述，国内外学者在水库调度领域开展了大量研究，取得了丰硕的成果，为水电站安全稳定、高效运行和水资源充分利用提供了重要的技术保障，但目前针对水库中长期发电优化调度的研究，主要集中在优化调度模型的构建、模型求解的计算方法、调度规则的研制方式等方面，有关最优调度结果的研究较少。本文通过构建水库中长期优化调度数学模型，分析模型主要约束的影响，研究水库及水电站运行方式的特点，并以隔河岩为研究实例，采用DDDP法进行求解得到模型的最优调度结果，在此基础上分析隔河岩水库、水电站运行方式，揭示隔河岩最优调度结果所蕴含的规律和相关特性。"
"水库中长期发电优化调度的主要内容包括数学模型的构建和调度方法的选择，构建数学模型的主要工作是确定目标函数和约束，并选择合理的目标函数和约束的处理方法。  水库优化调度问题可通过数学建模的方法抽象为一个数值型函数的优化问题，根据有无约束条件又分为无约束优化问题和有约束优化问题。不失一般性，优化问题的数学模型如式(2-1)所定义： { max F ( X ) s .t . | h i ( X ) = 0 ( i = 1 , 2 , ⋯ , s ) g j ( X ) ≤ 0 ( j = 1 , 2 , ⋯ , m ) X = ( x 1 , x 2 , ⋯ , x n ) ∈ E n (2-1) 式中： X = ( x 1 , x 2 , ⋯ , x n ) 是n维欧几里得空间 E n 中的点(向量)，称为决策变量；目标函数 F ( X ) 和约束函数 h i ( X ) 、 g j ( X ) 为X的实函数，其中 h i ( X ) = 0 称为等式约束， g j ( X ) ≤ 0 称为不等式约束。 基于上述优化问题数学模型构建隔河岩中长期发电优化调度模型。 1) 选取发电量最大为目标函数 E T * = max { ∑ t = 1 T [ N t Δ t ] } = max { ∑ t = 1 T [ K Q t f d H t Δ t ] } (2-2) 式中：T为调度期总时段数； Δ t 为计算时段长，s。 2) 等式约束包括：水库水量平衡约束；库容曲线约束；下游水位流量关系约束；发电水头约束；水电站预想出力约束；初、末水位约束等。 { V t + 1 = V t + δ t ( Q t i n − Q t o u t ) Z t = f Z V ( V t ) Z t x y = f Z Q ( Q t o u t ) H t = ( Z t + Z t + 1 ) / 2 − Z t x y − h s s , t N t y x = f y x ( H t ) Z 0 = Z b e g , Z T = Z e n d (2-3) 式中： V t 、 V t + 1 分别为时段初、末库容，10 8 m 3 ； Q t i n 、 Q t o u t 分别为t时段的入库、出库流量，其中 Q t o u t = Q t f d + q t ， q t 为t时段的弃水流量，m 3 /s； δ t 为流量库容转换系数， δ t = Δ t ∗ 10 − 8 。 Z t 、 Z t x y 、 H t 、 h s s , t 分别为t时段的库水位、下游水位、发电水头和水头损失，m，其中水头损失一般取为定值或根据水头损失函数计算。 N t y x 为水电站t时段的预想出力，kW； f y x ( ∗ ) 为水电站的预想出力函数， f Z V ( ∗ ) 为库容曲线函数， f Z Q ( ∗ ) 为下游水位流量关系函数。 3) 不等式约束包括：水位约束；出力约束；非负约束等。 { Q t f d ≥ 0 Z t min ≤ Z t ≤ Z t max N t min ≤ N t ≤ N t max (2-4) 式中：非负约束是指模型中有实际物理意义的变量均不能为负数，此处只需考虑发电流量( Q t f d )非负。 Z t min 、 Z t max 分别为t时段的最低、最高库水位，m； Z t min 一般为死水位， Z t max 在汛期为汛限水位，枯水期则为正常蓄水位。 N t min 、 N t max 分别为t时段水电站的最小、最大出力，kW；一般情况下， N t min 取水电站保证出力， N t max 取水电站预想出力。 在水库中长期发电调度中，由于径流的不确定性，往往存在不可避免的破坏时段(即 N t < N min )，故对于最小出力约束一般采用“惩罚函数法”，当时段出力不满足最小出力要求时对其进行惩罚： N t = { N t + γ ( N t − N min )     ( N t < N min ) N t                                                 ( N t ≥ N min ) (2-5) 式中： γ 为罚系数。因此，实际上 N t ≥ N min 并非严格约束，极端枯水情况下，允许出现破坏。  离散微分动态规划(DDDP)是为了解决常规动态规划(DP)的“维数灾”问题而提出的改进算法，其原理是用迭代程序求解贝尔曼递推方程，即由一个满足给定约束条件和边界条件的初始轨迹开始，利用DP法在给定的初始轨迹的邻域内搜索出一条改善轨迹，待轨迹收敛之后进一步缩减廊道宽度，如此反复直至收敛到最优轨迹 [ 13 ] [ 14 ] [ 15 ]。该方法能够迅速计算出较为优质的调度结果，在水库中长期优化调度中得到广泛的运用，是目前最常用的求解方法之一。"
"水电站出力大小反映了水电站运行方式的特点，而水电站出力主要受最小出力和最大出力约束，根据t时段出力 N t 与水电站最小、最大出力( N t min 、 N t max )的相对大小，定义以下4类水电站运行方式： 1) 破坏运行方式：时段出力小于最小出力，称为破坏运行方式(图1(a))，记为 N d 。 N d :     N t < N t min (3-1) 2) 最小出力运行方式：时段出力等于最小出力，称为最小出力运行方式(图1(b))，记为 N min 。 N min :     N t = N t min (3-2) 3) 加大出力运行方式：时段出力介于最小、最大出力间，称为加大出力运行方式(图1(c))，记为 N c 。 N c :   N t min < N t < N t max (3-3) 4) 最大出力运行方式：时段出力等于最大出力，称为最大出力运行方式(图1(d))，记为 N max 。 N max :   N t = N t max (3-4) 以上所述4类水电站运行方式的示意图见图1。 图1. 水电站运行方式示意图  水位上、下限约束均属于强制约束，一般的优化调度问题中常将上、下限水位作为调度的起始和终止水位，本文依据水位上、下限的组合，定义以下6类水库运行方式(水位过程统一用 { Z b , Z b + 1 , ⋯ , Z e } 描述，其中 Z b 、 Z e 分别为相应的初、末水位)。 1) “V型”运行方式：水库由上限水位开始，经若干时段，最终回到上限水位，称为“V型”运行方式(如图2(a))，其水位过程满足式(3-5)。 { Z b = Z b max Z b + j min < Z b + j < Z b + j max , 0 < j < e − b Z e = Z e max (3-5) 2) “倒V型”运行方式：水库由下限水位开始，经若干时段，最终回到下限水位，称为“倒V型”运行方式(如图2(b))，其水位过程满足式(3-6)。 { Z b = Z b min Z b + j min < Z b + j < Z b + j max , 0 < j < e − b Z e = Z e min (3-6) 3) “消落型”运行方式：水库从上限水位开始，经若干时段，最终消落到下限水位，称为“消落型”运行方式(如图2(c))，其水位过程满足式(3-7)。 { Z b = Z b max Z b + j min < Z b + j < Z b + j max , 0 < j < e − b Z e = Z e min (3-7) 4) “蓄水型”运行方式：水库从下限水位开始，经若干时段，最终蓄水到上限水位，称为“蓄水型”运行方式(如图2(d))，其水位过程满足式(3-8)。 { Z b = Z b min Z b + j min < Z b + j < Z b + j max , 0 < j < e − b Z e = Z e max (3-8) 5) “上限水位型”运行方式：水库水位始终保持在上限水位，称为“上限水位型”运行方式(如图2(e))，其水位过程满足式(3-9)。 Z b + j = Z b + j max , 0 ≤ j ≤ e − b (3-9) 6) “下限水位型”运行方式：水库水位始终保持在下限水位，称为“下限水位型”运行方式(如图2(f))，其水位过程满足式(3-10)。 Z b + j = Z b + j min , 0 ≤ j ≤ e − b (3-10) 以上所述6类水库运行方式的示意图见图2。 图2. 水库运行方式示意图"
"本文选取清江流域隔河岩水电站作为研究对象。隔河岩水电站大坝全长653.5 m，坝顶高程206 m，最大坝高151 m。正常蓄水位200 m，总库容31.2亿m 3 ，死水位180 m，死库容16.42亿m 3 ，调节库容19.75亿m 3 ，水库库容系数0.18，具有年调节能力，是一座以发电为主，兼有防洪及航运等综合利用效益的大型水利枢纽工程。隔河岩水电站各项特性值如表1。 Table 1 项目 数值 项目 数值 控制流域面积(km 2 ) 14,430 校核洪水位(m) 204.57 多年平均径流量(亿m 3 ) 127 总库容(亿m 3 ) 31.2 多年平均流量(m 3 /s) 403 死库容(亿m 3 ) 16.42 正常蓄水位(m) 200 调节库容(亿m 3 ) 19.75 死水位(m) 180 防洪库容(亿m 3 ) 5 防洪限制水位(m) 193.6 水库调节性能 年调节 设计洪水位(m) 203.29 装机容量(万kW) 121.2 表1. 隔河岩水电站特性表 采用隔河岩1951~2016年共66年的历史径流资料，以旬为计算时段，综合出力系数按照经验取为8.5，水头损失按0.6 m考虑，最大出力按照隔河岩水电站的预想出力取值。最小出力和罚系数分别取为14万kW和500，对应的发电保证率为90.90%，符合大型水电站的可靠性要求。根据以上数据资料和相关参数构建隔河岩水库中长期优化调度数学模型。  采用离散微分动态规划(DDDP)求解隔河岩水库中长期优化调度数学模型，根据优化调度结果，基于上文中对于水电站运行方式及水库运行方式的分类，对隔河岩水电站、水库运行方式及其组合进行分析。 1) 隔河岩水电站运行方式分析 按照上文中水电站运行方式的分类，对隔河岩中长期优化调度结果的出力过程进行分析，统计得到各类水电站运行方式出现的时段数(旬)如图3。 图3. 隔河岩水电站运行方式统计 根据图3可知，隔河岩水电站调度方式以最小出力( N min )和加大出力运行方式( N c )为主，时段数占比分别为50.93%和41.62%；然后是最大出力运行方式( N max )，时段数占比为6.90%，破坏出力运行方式( N d )出现的时段数最少，占比仅为0.55%。 2) 隔河岩水库运行方式分析 按照上文中水库运行方式的分类，对隔河岩中长期优化调度结果的水位调度过程进行分析，可得隔河岩存在“V型”、“消落型”、“蓄水型”和“上限水位型”4种水库运行方式，各类水库运行方式出现的次数及持续的时段数如表2。 Table 2 水库运行方式类型 次数 次数占比 最短时段数 最长时段数 总时段数 时段数占比 “V型” 196 45.06% 2 30 1404 59.09% “消落型” 23 5.29% 1 24 150 6.31% “蓄水型” 23 5.29% 1 10 57 2.40% “上限水位型” 193 44.37% 1 19 765 32.20% 合计 435 — — — 2376 — 表2. 隔河岩水库运行方式统计 根据表2，隔河岩“V型”和“上限水位型”运行方式的次数占比最大，分别为45.06%、44.37%，相应的时段数占比则分别为59.09%、32.20%，说明隔河岩水库运行方式是以“V型”和“上限水位型”为主。“消落型”和“蓄水型”运行方式的次数占比最小，均为5.29%，相应的时段数占比分别为6.31%、2.40%，这是因为“消落型”运行方式后一定紧接“蓄水型”运行方式，因此两者的次数是相等的。另外，“蓄水型”运行方式持续的时段数一般较短，最长不超过10旬。 3) 隔河岩水库运行方式的出力特性 分别对隔河岩“V型”、“消落型”、“蓄水型”和“上限水位型”等4类水库运行方式的出力特性进行统计，得到隔河岩4类水库运行方式的出力特性情况如下： 图4. 隔河岩水库不同运行方式的出力特性 根据图4，隔河岩的“V型”和“蓄水型”运行方式中，不存在破坏出力运行方式( N d )的时段；而“上限水位型”运行方式中，不存在最小出力运行方式( N min )的时段。最小出力运行方式( N min )在“V型”、“消落型”和“蓄水型”运行方式中出现时段数均是最多的，占比分别为77.21%，66.0%和47.37%；加大出力运行方式( N c )在“上限水位型”运行方式出现时段数最多，占比达到98.17%。"
"本文构建了水库中长期发电优化调度数学模型，对模型的主要约束条件进行分析，在此基础上研究水库及水电站运行方式的特点，分别提出4类水电站运行方式(破坏出力、最小出力、加大出力和最大出力)和6类水库运行方式(V型、倒V型、消落型、蓄水型、上限水位型和下限水位型)。然后以隔河岩为实例，采用DDDP进行求解得到隔河岩的最优调度结果，通过对隔河岩水库及水电站运行方式的研究分析，得到以下结论： 1) 隔河岩水电站运行方式以最小出力( N min )和加大出力运行方式( N c )为主，两者总占比达到92.55%。 2) 隔河岩水库存在“V型”、“消落型”、“蓄水型”和“上限水位型”4种运行方式，其中以“V型”和“上限水位型”运行方式为主，两者出现次数总占比为89.43%。并且，“消落型”运行方式后一定接“蓄水型”运行方式，两者出现次数相等，而后者持续的时段数一般较短，最长不超过10旬。 3) 隔河岩的“V型”和“蓄水型”运行方式中，不存在水电站的破坏出力运行方式( N d )的时段；而“上限水位型”运行方式中，不存在最小出力运行方式( N min )的时段。"
