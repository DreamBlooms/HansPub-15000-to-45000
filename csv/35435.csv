"本文在时变汇率模型下，对挂钩单资产的外币理财产品进行了定价研究。考虑到该类理财产品的价格不光受挂钩风险资产价格的影响，还受汇率的影响，其定价更加复杂，定价解析式难以得到，故利用蒙特卡罗模拟方法对其进行定价研究。在用蒙特卡罗模拟方法进行定价研究的过程中，利用Cholesky分解释放风险资产和汇率间的相关性，并且选取了一款挂钩黄金的外币理财产品进行了实证分析。 关键词 :外币理财产品，汇率模型，蒙特卡罗模拟，Cholesky分解 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"在“新时代”、“新金融”的背景下，中国经济迎来了由高速增长到高质量发展的转变，金融市场逐渐步入成熟阶段。银行作为金融市场的主体机构，也在不断派生出新的金融理财产品以满足人们投资理财的需要，其中就包括区间理财产品。区间理财产品作为现代金融工程领域进行金融创新的产物，由于其类型多样化，设计人性化，可以满足人们的各种投资需求，所以其在金融市场中备受投资者青睐。如果投资者在分析理财产品过程中，认为其挂钩的风险资产价格在到期时会在某个区间内上下浮动，则可投资区间型理财产品。其中，不仅人民币理财产品受欢迎，外币理财产品也深受投资者追捧。基于此，本文对区间型外币理财产品的定价问题进行了研究。 理财产品定价的核心是其内嵌期权的定价。目前，对于期权及理财产品定价方法的理论研究日趋成熟。Satyayitdas在2001综合分析了结构性理财产品的基本原理、定价、构建等，对结构性理财产品做了一个比较全面的研究，这促进了结构性理财产品定价理论研究的发展 [ 1 ]。2006年，Carolyn W. Chang等人扩展了二项式期权定价模型，使其在保持计算简单性的同时，具有更精确的价格动态。结合杠杆效应得出了效用相关的估值结果，并对模型进行了实证检验 [ 2 ]。2007年，王文凡利用并行Monte-carlo方法对欧式期权定价问题进行模拟，有效地以较低的成本完成了复杂与大量的计算任务 [ 3 ]。2011年，Baule和Tallau用随机波动模型对一款红利证券进行了定价研究，发现发行商在设计这款债券时已经考虑了波动率的影响 [ 4 ]。之后在2016年，王国帅和赵佃立首先运用不确定理论推导了相应的不确定风险中性测度，然后对欧式期权进行了定价研究，并验证了涨跌期权价格之间的平价关系 [ 5 ]。2020年，杜伟和傅游等人在图形处理器(CPU)上使用最小二乘蒙特卡罗法(Least Squares Monte Carlo, LSM)分别实现了一维美式期权定价和四维美式期权定价的并行化，实现了整个定价过程的加速 [ 6 ]。 国外学者在期权定价方面的钻研起步较早，且研究的内容更为广泛和深入，为我国理财产品的发展提供了一定的参考和借鉴。而我国由于研究时间较短，因此相关研究相对浅显一点，随着时代的发展，对于理财产品的研究逐渐趋于成熟，但其中对区间型外币理财产品的定价研究较少，基于此，本文对区间型外币理财产品进行定价研究。"
"投资者购买外币理财产品时，需先将本国货币兑换成外国货币，到期时再将外国货币兑换成美国货币。这意味着，其到期收益将受到汇率的影响，故需先知道汇率所遵循的模型。 本节对汇率适合的随机模型进行统计推断。据此，在新浪财经网收集了2018年5月1日到2019年5月1日的美元兑人民币汇率历史收盘数据。本节利用R语言按照以下七个环节对汇率的历史数据的收盘价格进行分析建模。 a) 平稳性检验–时序图 绘制美元兑人民币汇率历史收盘价格的时序图，见图1。 图1. 原始数据时序图 由图1可以看出，该美元兑人民币汇率序列呈现先缓慢增长后急速下降的趋势，并伴随着上下波动，显著非平稳，可初步判断该组数据是非平稳的。 b) 平稳性检验–单位根检验 接下来采用统计方法明确该序列的平稳性，为了获得更为准确的平稳性结果，这里补充ADF单位根检验，即用ADF检验来检验含有高阶序列相关的序列是否存在单位根。 Table 1 Title: Augmentde Dickey-Fuller Test P-VALUE: 0.1685 表1. 原始数据ADF检验输出结果 由输出结果表1分析，单位根检验的p-value = 0.1685 > 0.05，从而不能拒绝序列存在单位根，故而说明该序列不平稳。 c) 平稳化处理 由于不平稳的数据不利于建模，故对2018年5月1日到2019年5月1日的美元兑人民币汇率历史收盘数据进行平稳化处理，将其分别取对数并差分，其趋势见图2。 图2. 数据对数并差分后的时序图 从图2上来看处理后的数据趋于平稳且在均值在0附近波动，进而再次对其进行ADF检验。 Table 2 Title: Augmentde Dickey-Fuller Test P-VALUE: 0.01 表2. ADF检验输出结果 由输出结果表2看到，该汇率序列进行ADF检验的p-value= 0.01 < 0.05，拒绝原假设，说明不存在单位根，故美元兑人民币汇率对数差分序列显著平稳，这和时序图的直观观察一致。 d) 相关性检验 数据趋于平稳，意味着美元兑人民币汇率对数差分序列的均值及方差为常数，且协方差仅与时间间隔有关，进一步刻画数据特征，进行相关性检验。 图3. 数据取对数并差分后的自相关图及偏自相关图 由图3可知，所有处理后的数据都在2倍标准差内，可以看出该序列不存在相关性，可初步判断该序列属于白噪声序列。相应Box检验的结果见表3。 Table 3 Title： Box-Pierce test X-squared = 5.7007 X-squared = 9.4197 Df = 6 Df = 12 p-value = 0.4575 p-value = 0.6667 表3. Box检验输出结果 得到Box检验结果的p-value = 0.4575 (延迟6期)，p-value = 0.6667 (延迟12期)，其p值均大于0.05，可以判定该序列为白噪声序列。 e) 正态一致性检验 由上文分析已得到平稳化后的汇率序列是白噪声序列，为了分析该白噪声序列的类型，还需用K-S检验进行正态性分析。 Table 4 Title: One-sample Kolmogorov-Smirnov test p-value = 0.1183 表4. K-S检验输出结果 由输出结果表4可以看到，K-S检验的p-value = 0.1183 > 0.05，因此可以判断该序列为正态白噪声序列。 f) 独立性检验 在上一环节中已经证实该美元兑人民币汇率对数差分序列遵循正态分布，加之序列不存在相关性，从而依据正态分布的统计特征，该美元兑人民币汇率对数差分序列相互独立。这里进一步验证独立性结果，进行BDS检验。 Table 5 Title: BDS test p-value = 0.0545 表5. BDS检验输出结果 由输出结果表5可知，p-value = 0.0545 > 0.05，故而认为该数据之间是独立的。 g) t检验 为了进一步判断汇率遵循的模型，还需进行t检验。 Table 6 Title: One Sample t-test p-value = 0.1782 表6. t检验输出结果 由t检验输出结果表6可知，p-value = 0.1782 > 0.05，从而对数差分汇率数据的均值为0。 根据以上分析，我们可以认为美元兑人民币汇率对数差分序列为正态白噪声序列，从而汇率在风险中性测度下应当遵循如下模型： d q t = σ q q t d W q (1) 其中 q t 表示t时刻的美元兑人民币的汇率， W q 为标准布朗运动， σ q 表示汇率的波动率，由文献 [ 7 ] 可知，其矩估计满足 σ ^ q = s ^ Δ t 这里 s ^ 是表示汇率的对数差分序列 u i q 的标准差 s ^ q = 1 n − 1 ∑ i = 1 n ( u i − u ¯ ) 2 ,   u i q = ln ( q i q i − 1 ) 本节已得到人民币兑美元汇率在未来时刻所遵循的随机模型，接下来，将考虑当理财产品价格受汇率波动影响时其收益情况。"
"对外币理财产品的定价研究之前，需要先做如下假设： 假设1市场是完全的，所有资产是完全可以无限细分，且没有卖空限制。 假设2在衍生证券生命期内，无风险利率采用连续复利的方式计算考虑我国区间理财产品大多期限较短的实际情况，因此假定利率为固定利率。 假设3市场是无套利的 [ 7 ]。 假设4黄金价格也遵循修正后的几何布朗运动模型。  外币区间理财产品收益函数较为复杂，其随机因素除了受挂钩风险资产价格的影响，还受到汇率因素的制约，获取解析定价结果是困难的。考察一种常见的区间外币理财产品，当理财产品不受汇率影响时，其到期日的收益 f ( S ) 为 f ( S ) = { F ⋅ ( 1 + r 1 T )                             min S i ≤ K F ⋅ ( 1 + r 2 T )                               min S i > K 其中， i = 1 , 2 , ⋯ , T ， S i 为观察期黄金价格，F是投资人的本金， r 1 和 r 2 为区间理财产品事先约定好的投资收益率，K为理财产品事先约定好的观察水平，T表示理财产品约定好的到期日。当理财产品的收益受汇率影响时，其到期日的收益 F ( S ) 可以表示为 F ( S ) = q 0 q T f ( S ) = { F ⋅ q 0 ⋅ ( 1 + r 1 T ) q T                             min S i ≤ K F ⋅ q 0 ⋅ ( 1 + r 2 T ) q T                               min S i > K (2) 其中， q 0 为期初汇率， q T 为到期时汇率，依据文献 [ 7 ]，本章假定黄金价格遵循几何Brown运动模型 d S t = μ t S t d t + σ t S t d W t 其中， W t 是标准布朗运动， μ t 表示黄金价格的收益率，这里用无风险利率r表示， σ t 表示黄金价格的波动率。  风险中性测度定价方法的一个优点是，它可以有效地把蒙特卡罗模拟思想引进来，尤其对一些结构比较复杂的理财产品。这时候利用蒙特卡罗模拟是比较方便的，并且由于蒙特卡罗模拟不受维度的影响，这使得其在对结构复杂的理财产品进行定价时颇受青睐。 考虑Girsanov测度变换，在在风险中性概率测度Q下，黄金价格和汇率适合随机微分方程组 { d S t = r S t d t + σ t S t d W t d q t = σ q q t d W q 其中r是无风险收益率，容易证明 ln S t ∼ N [ ln S t + ( r − σ t 2 2 ) , σ t 2 T ] ln q t ∼ N [ ln q t + ( − σ q 2 2 ) , σ q 2 T ] 即黄金价格 S t 和汇率过程 q t 服从对数正态分布，并且二者存在线性相关 d W t ⋅ d W q = ρ t q d t (3) 考虑到计算软件产生两个相互独立的白噪声序列更为容易，这里采用Cholesky分解方法将白噪声 d W t 和 d W q 进行分解 [ 8 ]。 假设 d z 1 , d z 2 为独立的随机变量，服从均值为0，标准差为 d t 的正态分布，则可以将 d W t 和 d W q 转换成以下随机过程 { d W 1 = a 11 d z 1 d W 2 = a 21 d z 1 + a 22 d z 2 d z 1 ⋅ d z 2 = 0 (4) 其中 a i j = ρ i j − ∑ k = 1 i − 1 a i k a j k a i i ,   a i i = 1 − ∑ k = 1 i − 1 a i k 2 再令 d z 1 = ε 1 T , d z 2 = ε 2 T ，其中 ε 1 , ε 2 是相互独立的正态随机变量， i , j = 1 , 2 ，根据前述假设条件可以得到 { S t = S 0 exp [ ( r − σ 1 2 2 ) T + σ 1 a 11 ε 1 T ] q t = q 0 exp [ ( − σ 2 2 2 ) T + σ 2 ( a 21 ε 1 + a 22 ε 2 ) T ] (5) 这里 A = ( a 11 a 21 a 22 ) 为下三角矩阵，使得 A A T = ∑ i j U ， i , j = 1 , 2 ， ∑ i j U 为协方差阵。以上即为Cholesky分解，在之后的实证分析中，将用R软件实现这一过程，Cholesky分解便于产生线性相关的多个过程。因此，可利用黄金价格、汇率信息得到矩阵A。具体模拟步骤如下。 1) 通过模拟过程，生成标准正态分布的随机数 ε 1 , ε 2 ； 2) 根据正态分布随机数计算出服从对数正态分布的黄金价格 S t 和汇率价格 q t ； 3) 再计算对应的收益函数值 f ( S t , q t ) ； 4) 重复以上过程 n + 1 次； f ( S 1 , q 1 ) , f ( S 2 , q 2 ) , ⋯ , f ( S n + 1 , q n + 1 ) 5) 利用收益样本计算 E [ f ( S ) ] 的无偏估计 1 n + 1 ∑ i = 1 n + 1 f ( S t ) ； 6) 最后在风险中性测度下对收益函数的均值进行折现即得到产品价格的矩估计值。 V ^ t = e − r T 1 n + 1 ∑ t = 1 n + 1 f ( S t ) (6) 考察数值模拟的误差，假设 f ( S t ) 的方差为 σ f 2 ，注意抽样过程是相互独立同分布的，容易证明 V ^ t 的方差满足 V ^ t = e − 2 r T 1 ( n + 1 ) 2 ∑ i = 1 n + 1 σ f 2 = 1 n + 1 e − 2 r T σ f 2 (7) 从上式可以看出Monte-Carlo的模拟次数越多， C ^ t 的估计结果越精确。"
"本节选取的理财产品为中国银行发行的汇聚宝系列某款理财产品，该理财产品业务自2010年以来均有发行，其挂钩的是黄金价格(以美元计)，当我国投资者购买该产品时需要将人民币换成美元进行购买，到期时，再换算成人民币，很明显其价值受到汇率影响，该理财产品信息如表7所示： Table 7 产品名称 汇聚宝 产品类型 保本浮动收益型 投资及理财收益币种 美元 认购起点金额 8000美元 观察期 90天 挂钩指标 名称 定盘价格 每盎司黄金价格(以美元计) 每盎司黄金买入价格 预期年化投资收益率 条件 预期年化投资收益率 如果在观察期内，挂钩指标曾经低于或者等于观察水平 2.50% 如果在观察期内，挂钩指标始终保持在观察水平之上 0.20% 观察水平 期初价格−55.00 表7. 理财产品说明书 此产品无提前赎回权，因此该产品其实满足欧式期权的假设，产品的起购价为8000美元，当我国投资者购买该产品时需要先将人民币兑换成美元，故该理财产品的收益是受美元/人民币汇率波动影响的。 为释放黄金与美元/人民币汇率之间的差距，将选取2018年5月1日到2019年5月1日的黄金价格作为样本数据，估算黄金价格及汇率相关参数，同时也将估算汇率的相关参数，如表8所示： Table 8  名称 收益率均值 收益率标准差 股价波动率 黄金参数估计 0.055187 0.005732 0.109499 汇率参数估计 −0.000237 0.002830 0.054063 表8. 黄金价格及汇率未知参数估计值表 进一步进行Cholesky分解，下三角矩阵A的估计结果如下： A = ( 0.002829779 − 0.003194001 0.004758992 ) 将2019年5月1日，黄金价格收盘价及美元/人民币汇率收盘价作为其分别的期初价格，黄金(以美元计)期初价格为 S 0 = 1276.6 ，美元/人民币汇率期初价格为 q 0 = 6 .7349 。收益期限为91天，以2019年六个月以内的商业贷款利率为无风险利率，即为4.35%， K = S 0 − 55 ， r 1 = 2.5 % ， r 2 = 0.2 % ，将以上各参数估计值代入所构造的蒙特卡罗模拟方案中，即可得到各股票期末值。 为了提高蒙特卡罗模拟精度，本节将其模拟次数设置为10,000次，其模拟价格如下所示： 图4. 理财产品价格模拟路径 Table 9 次数 2000 4000 6000 8000 10000 价格(美元) 7920.520 7920.529 7920.536 7920.534 7920.541 方差 0.383111 0.3757612 0.3725838 0.3656451 0.3616035 表9. 理财产品模拟价格及方差 由图4可看出，模拟次数在2000时，其每次模拟价格波动区间大致在区间[7920.50, 7920.58]上，但当模拟次数达到一万后，其模拟价格的波动区间基本稳定在了[7920.53, 7920.55]；由表9可看出，随着模拟路径的增加，模拟价格的方差逐渐减小，由此可见，增加模拟路径，可以缩小方差提高精度，模拟10,000次后的最终理论价格为 V ^ t ( q ) = e − r T E [ f ( S ) ] = 7920.541 (8) 溢价率 ( F − V ^ t ( q ) F ) × 100 % = 0.99325 % (9) 可以看出，在银行理财产品按面值发行的情况下，该理财产品定价偏高，理应定为7920.541美元，属于溢价发行，溢价率较低，为0.99325%，意味着，到期时的收益会比预期收益低。同时，我们也知道，当购买外币理财产品时，投资者还要承担汇率波动所带来的风险。"
"本文采用蒙特卡罗模拟方法研究了受汇率影响的外币区间理财产品的定价问题。为了模拟黄金价格和汇率的随机噪声这里引入了Cholesky分解方案。该方法仅对线性关联有效，其它方式的相关关联还有待于进一步的研究。未来外币理财产品将会受到更多投资者的关注，本文希望能为发行银行在产品设计定价方面提供思路，为丰富发行银行的理财产品种类提供参考，让普通投资者可以比较轻松地去正确评估区间理财产品的价值，方便其在规定的投资期限内面对多个选择时，对比选出最适合自己的理财产品。"
