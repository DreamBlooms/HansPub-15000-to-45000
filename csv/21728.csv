"本文简要介绍了国内外操作票现状及大型企业电网调度操作票急需解决的问题，阐述了关联图的重要性及生成方法。以操作票系统的总体结构为主线，论述了电网状态模型、电气设备模型、调度运行规则、调度操作规则，重点论述了操作票智能推理和可视化预演技术。 关键词 :电网调度操作票，规则，模型，推理 Copyright © 2017 by author and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"众所周知，操作票在各行各业均有使用，但赋予的具体含义却不尽相同，操作票这个词汇是由动词“操作”和名词“票”组成，就是指为了完成一项作业所进行的动作项要按一定格式的书面文件来执行，操作票在电力系统的应用最为广泛，发电厂、变电所、电网调度均依靠操作票来实现机组的启停及出力调整、变电所开关的拉合、电网运行方式改变的操作，大型企业电网调度目前采用的是计算机辅助编制操作票方式，每年编制下达各种操作令票近20,000余张。为此急需探讨、研究、开发基于电网调度自动化系统平台之上的电网调度智能操作票系统，使其更加科学、合理、规范，以满足电网安全经济调度操作开票的需要。  国内二十世纪80年代开始进行操作票专家系统的研究，已经取得较好的实际应用成果。从专家系统的实现方式来分析，主要是在认知模型系统、知识库和推理机几个方面不断发展，可以分为以下几类： 1) 典型票系统 [ 1 ] 。类似这种方式在特定变电所的操作票编制效果较好，但由于企业电网运行方式繁杂，不能满足调度操作票的需要。 2) 通用知识操作票系统 [ 2 ] 。系统中知识库按不同种类的电气设备定义规则，通用性得较好 [ 3 ] ，但是对操作对象的预先分类系统扩充较难。 3) 通用认知模型的专家系统 [ 4 ] 。建立在通用认知模型上，开发的操作票系统具有较好的智能性。  首先是调度自动化系统数据及模型共享。计算机辅助编票方式在自建的模型上运行，不能与调度自动化系统进行数据和模型共享，存在设备运行方式不统一的风险；其次是关联图操作界面。企业电网变电站数量大，操作图形星罗棋布，错综复杂，需智能优化界面，确保简洁清晰；三是各种规则及模型编制。计算机辅助编票是调度员把已经编制好的各种令票，凭经验手工编制组织令票，存在操作顺序错误的风险；四是可视化预演。目前操作票是调度员根据已经编制完成令票，对照模拟图逐项进行核对，费时费力，存在审核错误风险。"
"如图1所示，为智能操作票的总体架构图。 图1. 智能操作票架构图  智能操作票系统是基于调度自动化系统OPEN-3000平台开发的。实现了SCADA和PAS应用的无缝连接，解决了获取电网模型、图形和实时运行方式数据困难问题，智能操作票系统根据电网拓扑结构自动生成待操作设备和间隔，当电网SCADA模型变化后，系统能自动重新进行拓扑搜索更新设备和间隔，自动适应电网的变化。采用这种自动建模方式后，设备和间隔不需要人工维护，系统能自动生成并随电网模型变化实时更新，大大降低了系统维护的工作量。实时获取PAS应用系统实时数据，保证了操作票系统的制票环境与实时电网一致，不需要人工进行大量置位操作，同时也保证了数据的正确性，实现了图模数一体化功能。  电气设备模型主要包括：厂站、厂站间隔、线路、线路间隔原子、一次设备、二次设备及网络拓扑等七类模型，每一种模型在结构功能上或操作方式上具有共同属性的电网操作对象，与EMS系统有相同数量的开关、主变、母线、PT、PC (消弧线圈)、旁路母线和旁路开关、变电站整段(变电站的一半或一半中的2/3)、全站模型和110 kV、35 kV和10/6 kV电压等级，单回线、双回线、特殊双回线、充电线、T接线等，线路检修又分单纯线路检修、线路一侧或两侧开关结合线路检修、一侧或两侧线路刀闸和接地刀闸结合检修等线路模型。在使用的过程中，当电网中新出现了新的接线结构或运行方式，只需要在设备模型库中建立新的设备模型，就可以适应新的接线结构了，扩展过程中不需要增加或修改程序。  调度运行规则 [ 5 ] 主要描述企业电网的调度运行规程和电网运行方式，其条件为操作对象的调度任务，结论为具体变电站或电气间隔的操作任务。调度运行规则中集成了企业电网拓扑结构，并能够引用企业潮流计算作为调度规则的条件，当潮流计算的结果不同时，会触发不同的规则，产生合理的操作结果。调度运行规则主要描述电网在执行某些停电、检修或改变运行方式等调度任务时需要遵循的规则，这种规则是描述电网局部的线路和厂站进行调度时，涉及到的电气接线间隔以及对间隔所执行的操作任务，反映了调度员在宏观上对电网的分析，用通用的语言描述调度任务以及相关电气间隔的运行状态。  调度操作规则是线路和变电站调整运行方式的全过程用自然语言进行的总体描述，调度操作规则规范性差，方式复杂，难以用通用语言自动生成，为此建立调度操作规则库主要是描述各种调度指令的表述方法，即不同任务和不同电网运行状态下不同的调度操作规则，如“xx线路由运行转检修”就是常用的调度指令；针对具体的间隔，它代表了电气间隔从一个运行方式变化为另一个运行方式。如操作任务“停电”表示间隔从运行态转变为停电状态，这个过程一般需要分开关和刀闸，合接地刀闸或挂地线。可以根据间隔操作的各种方式，形成调度指令。"
"如图2所示由于企业电网调度指挥系统图很复杂庞大，电网调度在编制具体操作票时只关心与操作票直接的联接关系。为此，调度在操作任务操作的设备作为输入条件后，操作票系统对其将要操作的相关设备进行拓扑搜索，得到相关联设备和厂站的位置，通过图形重建，用合适的图形尺寸，进行动态智能布局，把操作票所涉及所有厂站的电网结构，按厂站之间线路连接拓扑连接关系显示出来的图形称为关联图如图3所示，可以清晰直观的编制操作票。  电网调度操作票是把调度操作任务按照规范的操作术语描述顺序拉合有关设备运行状态的操作指令集 [ 6 ] ，首先进行的是操作任务推理，将所有的待推理的调度操作任务送入操作序列缓冲区，然后开始循环推理。在循环推理中，会按照操作序列缓冲区的顺序，每次取出一条未推理的调度操作任务，从电网运行状态中匹配设备运行状态，然后从调度运行规则库依次取出规则进行匹配，选出合适的操作票类型规则的条件数量，选出最合适的一条规则，应用规则的结论，将推理生成的结论插入到当前推理的调度任务之后，送入缓冲区，并将正在推理的调度任务标记为已推理，推理一直循环下去，直道缓冲区中已经不存在未推理的调度任务。就可以得到操作任务序列。然后再进行调度指令推理时，对操作任务序列进行遍历，每次取出一条操作任务序列，从调度操作规则库依次取出所有规则进行匹配，首先会匹配规则的应用对象，如果执行操作任务的操作对象所属类型或所属类型的上层类型在规则的应用对象中，继续判断根据电气设备模型进行匹配，如果条件成立，则针对规则中的每一条字句，都会判断其条件，符合条件的字句，其文本内容经过变量代换后，就是最后的操作内容，送入操作票缓冲区，推理完成后，操作票缓冲区中就是最终的操作票。  对编写好的电网操作票，可视化动态模拟预演 [ 7 ] 。按照操作票内容依次在主接线图或站内接线图进行图上自动按照操作每一项时，有关设备在操作过程中的状态变化、电网的潮流动态变化均显示在屏幕上，同时操作票的任务和内容以文字方式在信息窗口中逐条显示。自动模拟过程具有开始、暂停、结束 图2. 电网调度部分主结线图 图3. 关联图 功能。可以单步模拟，也可以连续自动模拟，连续模拟时能设置模拟操作的速度。也可以在操作票中设置断点，模拟过程在断点处自动暂停。系统自动检查每个操作项目是否负荷设备操作规则，如果违反规则不能操作，对不能操作的设备闪烁显示报警，并给出该设备的操作规程。自动模拟过程暂停。能够自动计算每个操作前后电网潮流变化的过程，如果发生潮流过负荷、过电压的情况，对过负荷设备闪烁显示，给出报警。自动模拟过程暂停。能够操作票系统能经过推理和经济技术计算比较，完成自动合解环操作。"
"企业电网调度管辖变电所近300座，其主接线形式复杂多样；如普通户外式、户内小车开关式、内桥接线、外桥接线、户内小车开关改成SF6开关式(全微机综合自动化)、单电源、单主变等、线路有双回线、单回线、T接线、单电源、双电源、多电源。操作管理制度分两种，一种适用于区调管辖的35 kV变电站，另一种适用于供电公司管辖的变电站，前者倒闸操作和安全措施分开，采用《综合令》和《安措令》；后者和电业局相似，采用《操作综合令》。总体上说，变电所和线路的操作均由调度下令，具有企业电网自身的管理模式和特点。因此调度端的操作票采用的综合令、安措令、操作综合令、系统令、组织令全部实现了智能编制、打印、存档、查询。随着智能电网的建设的全面推进，电网调度操作票的智能化将是一项长期的课题。"
