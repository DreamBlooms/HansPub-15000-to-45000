"洪水给人们生活造成很大的不便。为了尽快恢复生产生活，及时获取洪水受灾区域的范围及受灾区域发生的变化，对于灾情分析和灾后重建至关重要。由于受到相干斑噪声和洪水受灾区域地形起伏较大的因素的影响，合成孔径雷达(SAR)探测到的洪水遥感图像存在噪点较多且灰度分布不均匀的缺点，成像效果不佳，因此很难对其实现准确地图像分割。为了解决这个问题，本文提出一种基于水平集方法的改进CV分割模型，以实现快速准确地分割洪水遥感图像。CV分割模型是一种在医学图像分割领域很常见的基于区域和边缘信息的图像分割模型，能够得到较为精确的分割曲线，但是存在对噪声敏感、过度依赖区域灰度均值的缺陷。对于存在大量的噪声且图像灰度分布不均匀的洪水遥感图像，CV分割模型效果不佳。为了减少噪声在分割曲线演化过程中的干扰，本文在CV分割模型的能量函数中加入一个整体控制项，以减少噪声的影响。此外，为了提升CV分割模型对灰度不均匀的洪水遥感图像的分割能力，对处于不同区域的像素点采用自适应动态权重的方法进行分割曲线拟合。实验结果表明，与传统的CV分割模型和其他的图像分割模型相比，本文提出的改进CV分割模型在灰度分布不均性较强的洪水遥感图像上有更出色的分割精度，证明了本文提出的改进CV分割模型的有效性。"
"合成孔径雷达(SAR)是一种先进的主动式微波对地观测设备，能够在各种波段下工作，具有较好的穿透力。通过对目标场景发射连续的无线电脉冲波(波长范围为1毫米至1米)，并接收和记录每个脉冲的回波，合成孔径雷达可以形成细节丰富、分辨率高的SAR遥感图像。SAR成像技术被广泛应用在军事侦察、环境探测、海洋勘测等多个军事和民用领域 [ 1 ]，涵盖图像分割、目标检测与识别、移动目标跟踪等技术 [ 2 ]。 目前图像分割方法主要分为基于阈值的分割方法、基于边缘信息的分割方法和基于区域信息的分割方法 [ 3 ] [ 4 ]。近年来，基于边缘信息和区域信息的图像分割方法受到学者的广泛关注。在基于边缘信息的图像分割方法中，常用的边缘检测算子有Prewitt算子和Canny算子等。其中Prewitt算子能够得到连续的精细边缘。许四祥等人 [ 5 ] 提出的基于Prewitt算子的目标检测算法能够较好地得到微小目标的精细边缘。Canny算子能够较精确地定位图像的边缘。胡高珍等人 [ 6 ] 采用基于Canny算子的MRF算法在精准提取图像的边缘信息方面取得了较好的效果。然而，基于边缘信息的图像分割方法对于混合复杂噪点的SAR图像分割效果欠佳。基于区域的图像分割方法从整块区域划分的层面对图像进行分割，对于复杂的场景或者拍摄到的自然景观的图像的分割效果较好 [ 7 ]，但是对于灰度分布不均匀的SAR图像容易产生过度分割等问题。 CV分割模型结合图像的边缘信息和区域信息，能一定程度上减少相干斑噪声对图像分割效果的影响，且对图像的拓扑结构的变化具有良好的适应性 [ 8 ]。但是对于噪点较多、灰度分布不均匀的洪水SAR图像，传统的CV分割模型依然很难达到理想的分割效果。近年来许多学者对CV分割模型做出了改进。Li Chunming等人 [ 9 ] 提出的基于图像局部区域的可变灰度拟合的RSF模型，一定程度上解决了CV分割模型对灰度不均匀图像分割效果不尽如人意的问题，但是由于过度依赖局部特征，对噪声依然较敏感。陈星等人 [ 10 ] 提出的LIFCGI模型结合全局信息进行局部图像拟合，在一定程度上解决了RSF模型对噪声较敏感的问题，但是依然无法出色地完成分割灰度分布不均匀图像的工作。 为了解决CV分割模型对于噪点较多、灰度分布不均匀的洪水SAR图像分割效果不佳的问题，本文结合图像的边缘信息和区域信息，提出一种基于水平集方法的改进CV图像分割模型。该模型在传统CV分割模型的分割曲线拟合函数中增加一个整体控制项，以减少噪声对分割效果的影响。此外，对不同区域的像素点采用自适应动态权值法进行分割曲线拟合，用于处理噪点较多、灰度分布不均匀的洪水遥感SAR图像。"
"水平集方法最初由Osher和Sethian提出，用于解决热力学方程中火苗的形状变化问题。目前水平集方法主要用于医学图像分割 [ 11 ]。水平集方法基于曲线演化理论，将二维曲线分割问题转换为三维曲面分割问题。根据曲线演化理论，任一曲线C沿任意方向的轨迹都可以表示为式(1)： ∂ C ∂ t = V ( C ) N (1) 其中 V ( C ) 代表曲线演化的速度， N 表示曲线的单位法矢。水平集方法将二维逻辑空间中的闭合曲线C变换成三维曲面 ϕ ( x , y , t ) 上的一个曲线(通常取 ϕ ( x , y , t ) = 0 )，将曲线的演化问题推演成曲面的演化问题。一般情况下，水平集方法取 ϕ ( x , y , t ) = 0 作为变化后的曲线C。水平集方法的演化方程一般表示为式(2)： ∂ ϕ ∂ t = V ( C ) | ∇ ϕ | (2) 曲线的曲率k可以用水平集函数 ϕ ( x , y , t ) 表示出来，如式(3)所示： k = d i v ( ∇ ϕ | ∇ ϕ | ) (3) 其中div是散度算子， ∇ 是梯度算子。这样，通过计算水平集函数的散度和梯度即可得到曲线C的演化过程，最终得到图像的分割曲线 [ 12 ] [ 13 ] [ 14 ]。  CV分割模型利用水平集方法得到的闭合曲线C用于分割图像，且令闭合曲线C内部的区域为目标区域，闭合曲线C外部的区域为背景区域 [ 15 ]。为了使闭合曲线C尽可能贴近分割区域的轮廓，在CV分割模型中引入一个能量函数，将闭合曲线C的演化问题转变成一个数学模型中的函数最小化问题 [ 16 ]。能量函数表达式如式(4)所示： E c v ( c 1 , c 2 , ϕ ) = μ ⋅ ∫ Ω δ ε ( ϕ ( x , y ) ) | ∇ ϕ ( x , y ) | d x d y   + λ 1 ⋅ ∫ Ω | u 0 ( x , y ) − c 1 | 2 H ε ( ϕ ( x , y ) ) d x d y   + λ 2 ⋅ ∫ Ω | u 0 ( x , y ) − c 2 | 2 ( 1 − H ε ( ϕ ( x , y ) ) ) d x d y (4) 其中 μ 、 λ 1 和 λ 2 为大于0的常数， Ω 代表整个图像； ϕ ( x , y ) 为水平集函数； δ ε ( ⋅ ) 为正则化脉冲函数； ∇ 为梯度算子； H ε ( z ) 和 δ ε ( z ) 分别是海氏(Heaviside)函数 H ( z ) 和狄拉克(Dirac)函数 δ ( z ) 的正则化形式。 H ( z ) 和 δ ( z ) 的计算公式如式(5)所示 [ 17 ] [ 18 ]： H ( z ) = { 1 , z ≥ 0 0 , z < 0 ， δ ( z ) = d d z H ( z ) (5) H ε ( z ) 和 δ ε ( z ) 的计算公式如式(6)： H ε ( z ) = 1 2 [ 1 + 2 π arctan ( z ε ) ] ， δ ε ( z ) = 1 π ε ε 2 + z 2 (6) c 1 和 c 2 分别是目标区域和背景区域的灰度均值， c 1 和 c 2 的计算方法如式(7)： c 1 = ∬ C u 0 ( x , y ) H ( ϕ ) d x d y ∬ C H ( ϕ ) d x d y ， c 2 = ∬ C u 0 ( x , y ) 1-H ( ϕ ) d x d y ∬ C 1-H ( ϕ ) d x d y (7) 能量函数中的第一项称为长度约束，用于保证拟合曲线长度最短；后面两项统称为保真项，可以使曲线C尽可能贴近到目标轮廓。在分割过程中，当能量函数达到最小值时，认为闭合曲线C已经最贴近目标的轮廓 [ 19 ]。"
"如前文所述，由于洪水遥感SAR图像具有细节丰富、特征复杂的特点，在对水平集轮廓进行演化的过程中容易被噪声所干扰从而影响轮廓形状 [ 20 ]。为了解决这一问题，本文在CV分割模型中加入了一个整体控制项，使得每一个像素点在演化的过程中都受到整体区域灰度均值的控制，从而能更准确地实现轮廓曲线的演化。加入整体控制项的能量函数如式(8)所示： E C V ( c 1 , c 2 , ϕ ) = μ ⋅ ∫ Ω δ ε ( ϕ ( x , y ) ) | ∇ ϕ ( x , y ) | d x d y + λ 1 ⋅ ∫ Ω | u 0 ( x , y ) − c 1 | 2 H ε ( ϕ ( x , y ) ) d x d y   + λ 2 ⋅ ∫ Ω | u 0 ( x , y ) − c 2 | 2 ( 1 − H ε ( ϕ ( x , y ) ) ) d x d y + λ 3 ( c 1 + c 2 ) 2 (8) 此外，由于CV分割模型依赖整体背景和目标灰度均值，在处理图像灰度分布不均匀的洪水遥感图像时，很难实现准确的分割。为了解决这个问题，本文进行了改进，在式(8)的基础上，提出基于自适应动态权值的方法，在能量函数(4)中加入自适应动态权值，可以有效地处理灰度分布不均匀的洪水遥感图像。加入自适应动态权值的能量函数如式(9)所示： E c v ( c 1 , c 2 , ϕ ) = μ ⋅ ∫ Ω δ ε ( ϕ ( x , y ) ) | ∇ ϕ ( x , y ) | d x d y + c 1 c 1 + c 2 ⋅ ∫ Ω | u 0 ( x , y ) − c 1 | 2 H ε ( ϕ ( x , y ) ) d x d y   + c 2 c 1 + c 2 ⋅ ∫ Ω | u 0 ( x , y ) − c 2 | 2 ( 1 − H ε ( ϕ ( x , y ) ) ) d x d y + λ 3 ⋅ ( c 1 + c 2 ) 2 (9) 利用变分法 [ 21 ]，可以计算得到能量函数的梯度方程，如式(10)所示： ∂ ϕ ∂ t = − δ ( ϕ ) [ μ d i v ( ∇ ϕ | ∇ ϕ | ) − c 1 c 1 + c 2 ( u 0 − c 1 ) 2 + c 2 c 1 + c 2 ( u 0 − c 2 ) 2 + λ 3 ( c 1 + c 2 ) 2 ] ϕ ( x , y , 0 ) = ϕ 0 ( x , y ) (10) 其中 d i v = ∇ ϕ | ∇ ϕ | 是水平集曲面的曲率，当能量函数的梯度值满足式(11)时，即认为能量函数已经达到了最小值。 ∂ ϕ ∂ t < 1 e − 5 (11) 本文提出的改进CV分割模型的实现步骤如下： 1) 根据像素点获得水平集函数 ϕ ( x , y , t ) ； 2) 初始化水平集函数 ϕ ( x , y , t ) = 0 ，获得闭合曲线C； 3) 计算目标区域灰度均值 c 1 和背景区域灰度均值 c 2 ，计算水平集函数 ϕ ( x , y , t ) = 0 的梯度值 ∇ 和散度值div； 4) 将 c 1 、 c 2 、 ∇ 和div代入加入整体控制项和自适应动态权值的能量函数的梯度方程中，计算并判断能量函数的梯度值是否满足式(11)，从而判定能量函数是否收敛到最小值； 5) 若能量函数没有收敛到最小值，曲线演化到下一个像素点，重新对水平集函数进行初始化，重复以上步骤，直到能量函数达到最小值； 6) 当能量函数达到最小值后，利用Kappa系数 [ 22 ] 判断分割图像是否精确。Kappa系数的计算公式为式(12)所示： Kappa = P 0 − P c 1 − P c (12) 其中 P 0 = p n ， P c = a 0 ∗ b 0 + a 1 ∗ b 1 n 2 ，p为正确分割的像素点个数， a 0 为洪水发生后拍摄到的遥感图像中灰度值为0的像素点的个数， a 1 为洪水发生后拍摄到的遥感图像中灰度值为1的像素点的个数； b 0 为参考图中灰度值为0的像素点的个数， b 1 为参考图中灰度值为1的像素点的个数，n为图像中的总的像素点个数。 本文提出的改进CV分割模型的整体流程图如图1所示。"
"实验的硬件环境为：CPU主频2.80 GHz，内存8.0 GB；软件环境为：操作系统为Windows 10，实验平台为MATLAB R2014b。 实验一分别使用传统CV分割模型与本文提出的改进CV分割模型对两幅洪水遥感图像进行分割并比较效果。在本文提出的改进CV分割模型中，为了与传统CV分割模型进行效果对比，模型中的参数取值参考李春等人的研究 [ 23 ]， μ 取值为0.00001 × 255 × 255， λ 3 取值为0.00044，规则化参数 ε 取1。实验结果如图2所示：图2(a)为灰度分布较均匀的印度尼西亚洪水遥感图，分辨率为256 × 256，大小为36 m × 36 m；图2(d)为灰度分布较不均匀的三宝垄爪哇岛洪水遥感图，分辨率为256 × 256，大小为20 m × 24 m；图2(b)和图2(e)展示了使用传统CV分割模型分割后的印度尼西亚洪水遥感图和三宝垄爪哇岛洪水遥感图；图2(c)和图2(f)为使用本文提出的改进CV分割模型分割后的印度尼西亚洪水遥感图和三宝垄爪哇岛洪水遥感图；表1对两幅SAR图像使用传统CV分割模型与本文提出的改进CV分割模型获得的Kappa值进行比较。 图1. 适用于洪水遥感图像的改进CV分割模型的整体流程图 图2. 传统CV分割模型与本文的改进CV分割模型分割效果对比图 Table 1 印度尼西亚洪水图 三宝垄爪哇岛洪水图 传统CV分割模型 Kappa: 0.6295 Kappa: 0.64584 改进CV分割模型 Kappa: 0.66479 Kappa: 0.73771 表1. 传统CV分割模型和改进CV分割模型对两幅洪水图分割效果的kappa值比较 从得到的分割结果图可以看出，本文提出的改进CV分割模型得到的结果图相对于传统CV分割模型得到的结果图有更少的碎点，获取的分割图像的轮廓更完整，Kappa值更高，显而易见，本文提出的改进CV分割模型相对于传统CV分割模型有更高的分割精度。 实验二分别使用本文的改进CV分割模型与其他常见的图像分割模型对印度尼西亚洪水遥感图和三宝垄爪哇岛洪水遥感图进行分割并比较效果。实验二结果如图3所示：图3(a)、图3(c)、图3(e)分别是对印度尼西亚洪水遥感图采用RSF模型、LIFCGI模型和改进CV分割模型得到的分割后的洪水轮廓图。图3(b)、图3(d)、图3(f)分别是对三宝垄爪哇岛洪水遥感图采用RSF模型、LIFCGI模型和改进CV分割模型得到的分割后的洪水轮廓图。表2是对印度尼西亚洪水遥感图进行分割，采用RSF模型、LIFCGI模型和本文的改进CV分割模型得到的Kappa值和运行时间的比较。表3是对三宝垄爪哇岛洪水遥感图进行分割，采用RSF模型、LIFCGI模型和本文的改进CV分割模型得到的Kappa值和运行时间的比较。 图3. 本文的改进CV分割模型与其他常见的图像分割模型的分割效果对比图 Table 2 Kappa值 运行时间/s RSF模型 0.58202 0.08043 LIFCGI模型 0.67485 0.17996 改进CV分割模型 0.66479 0.75827 表2. 三种模型对印度尼西亚洪水图的Kappa值和运行时间比较 Table 3 Kappa值 运行时间/s RSF模型 0.54749 0.08598 LIFCGI模型 0.57154 0.10310 改进CV分割模型 0.73771 0.81188 表3. 三种模型对三宝垄爪哇岛洪水图的Kappa值和运行时间比较 对比上述实验结果，可以发现，对于灰度分布较不均匀的三宝垄爪哇岛洪水遥感图，采用本文提出的基于水平集方法的改进CV分割模型，分割结果图的轮廓很清晰，碎点很少，相比于RSF模型和LIFCGI模型的分割结果图更清晰，同时Kappa值也明显高于采用RSF模型和LIFCGI模型的结果。虽然基于水平集方法的改进CV分割模型的耗时稍长，但是考虑到它得到的Kappa值明显高于其他两种模型，因此，在对灰度分布不均匀的洪水遥感图像进行分割时，本文提出的基于水平集方法的改进CV分割模型表现优秀，可以得到更精确的分割效果。对于灰度分布较均匀的印度尼西亚洪水遥感图，本文提出的改进CV分割模型的分割效果尚可，与采用RSF模型和LIFCGI模型的结果接近。这证明了本文提出的改进CV分割模型对灰度分布不均的洪水遥感图像表现优异，也适用于一般的洪水遥感图像。"
"本文提出了一种适用于洪水遥感SAR图像的改进CV分割模型，它在CV分割模型中增加了一个整体控制项，以强化整体灰度值对分割曲线演化过程的控制，从而减少噪声的影响。此外，针对CV分割模型在分割灰度不均的图像时效果不佳的缺陷，本文提出了基于自适应动态权值的方法，在CV分割模型的能量函数中加入自适应动态权值，从而可以有效地处理灰度分布不均匀的洪水遥感图像。实验结果表明，本文提出的改进CV分割模型相比于传统CV分割模型分割准确率提升较大，获得的分割图像有更少的碎点，轮廓更完整，具有明显的优势。相比其他图像分割模型，本文的改进CV分割模型对灰度分布不均匀的洪水遥感图像分割轮廓更加精确，Kappa值较高，并对一般的洪水遥感图像也具有一定的普遍适用性。"
