"本论文中，我们从拓扑动力系统的角度把细胞自动机看作是符号空间上的连续自映射，对细胞自动机的单射、满射、同胚性质进行研究。我们利用拓扑熵的一般性质证明了经典的Garden定理，即一维细胞自动机为同胚映射当且仅当它为单射。并且，利用该方法可以很方便地将Garden定理推广到高维情形，即任意维细胞自动机为同胚映射等价于它为单射。 关键词 :细胞自动机，有限型位移映射，拓扑熵，符号系统 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"细胞自动机(Cellular Automata，简称CA)是一种时间、空间和状态均离散的数学模型，由John Von Neumann于1951年正式提出，用于模拟20世纪50年代生命系统中的自我复制现象 [ 1 ] 。1969年，G. A. Hedlund首先从数学角度把细胞自动机看作符号空间上的位移映射的自同态，刻画了一维细胞自动机的一些动力学行为，开创了细胞自动机数学理论研究的先河 [ 2 ] 。20世纪70年代，数学家J. H. Conway提出了一种能够进行普适计算的、结构简单的二维细胞自动机——“生命游戏(Game of life)”，使得细胞自动机的研究再度兴起 [ 3 ] 。20世纪80年代初，Stephen Wolfram引导了细胞自动机理论研究的新阶段 [ 4 ] 。他首先提出了一维的状态数为2且邻域半径为1的基本细胞自动机(Elementary Cellular Automata，简称ECA)，并在大量计算机实验的基础上，通过观察待定规则产生的演化行为将基本细胞自动机分为：稳定、周期、混沌和复杂4类 [ 5 ] [ 6 ] [ 7 ] 。随后，Leon O. Chua等人利用非线性动力学的一套方法严格分析了Wolfram的经验主义观察结果 [ 8 ] [ 9 ] [ 10 ] [ 11 ] 。发展至今日，细胞自动机的理论已经十分成熟，而且有了很好的拓展。 本篇文章中，我们从拓扑动力系统的角度对细胞自动机的单射、满射、同胚性质进行研究。设X是符号空间， σ 是X上的位移映射，称映射 f : X → X 是细胞自动机，如果f连续且 f ∘ σ = σ ∘ f ，即是把细胞自动机看作是符号空间上的连续自映射。我们利用拓扑熵的一般性质证明了经典的Garden定理，即一维细胞自动机为同胚映射当且仅当它为单射 [ 12 ] [ 13 ] 。并且，利用该方法可以很方便地将Garden定理推广到高维情形，即任意维细胞自动机为同胚映射等价于它为单射。最后我们给出了基本细胞自动机中所有的同胚映射，以及几个是满射但不是同胚映射的细胞自动机的例子。"
"在本节中，我们将介绍细胞自动机，符号系统和拓扑熵的概念。首先说明一些动力系统中的记号： 我们用 ( X , T ) 表示拓扑动力系统，即X是一个紧致度量空间， T : X → X 是连续映射；用 α , β 等表示X的开覆盖。记 α ∨ β = { A ∩ B : A ∈ α , B ∈ β } ，则 α ∨ β 也是X的开覆盖。   设整数 k ≥ 2 ，任取k个不同符号，例如取 0 , 1 , ⋯ , k − 1 ，记 S = { 0 , 1 , ⋯ , k − 1 } ，称S为k个符号组成的 状态空间，其中每一个符号也称作状态。赋S以离散拓扑，则S为紧致拓扑空间 [ 14 ] 。 作拓扑积 S Z = ∏ − ∞ + ∞ S = { x = ( ⋯ , x − 1 , x 0 * , x 1 , ⋯ ) : x i ∈ S , ∀ i ∈ Z } ， 这里的Z表示全体整数的集合，记号*表示x中第0个符号(坐标)所在的位置。 对 ∀ x = ( ⋯ , x − 1 , x 0 * , x 1 , ⋯ ) ,   y = ( ⋯ , y − 1 , y 0 * , y 1 , ⋯ ) ∈ S Z ，定义 d ( x , y ) = ∑ i = − ∞ ∞ ρ ( x i , y i ) 2 | i | ， 其中 ρ ( x i , y i ) = { 0 , x i = y i , 1 , x i ≠ y i . 容易证明，d是 S Z 上的度量，且它诱导的拓扑与乘积拓扑等价。文 [ 14 ] [ 15 ] [ 16 ] 中证明了 ( S Z , d ) 是 一个完备的，完全不连通的紧致空间。称 S Z 为一维k-符号序列空间，简称为一维符号空间。 在 S Z 上定义位移映射： σ : S Z → S Z ( ⋯ , x − 1 , x 0 ∗ , x 1 , ⋯ ) ↦ ( ⋯ , x 0 , x 1 ∗ , x 2 , ⋯ ) 即在 σ 的作用下， S Z 中点的坐标依次向左移动一位，因此，也称 σ 为左移映射。称 ( S Z , σ ) 为S上的一维符号系统。  仍记 S = { 0 , 1 , ⋯ , k − 1 } 为 k ( k ≥ 2 ) 个符号组成的集合，记 S Z 2 = { x = ( x i , j ) : x i , j ∈ S , ( i , j ) ∈ Z 2 } 。对于每一个 x = ( x i , j ) ∈ S Z 2 ，用记号*表示第(0, 0)个符号(因子)所在的位置，即 x = ( x i , j ) = ( ⋮ ⋮ ⋮ ⋯ x 1 , − 1 x 1 , 0 x 1 , 1 ⋯ ⋯ x 0 , − 1 x 0 , 0 ∗ x 0 , 1 ⋯ ⋯ x − 1 , − 1 x − 1 , 0 x − 1 , 1 ⋯ ⋮ ⋮ ⋮ ) 在 S Z 2 中定义距离为 d ( x , y ) = max ( i , j ) ∈ Z 2 { 1 max { | i | , | j | } + 1 : x i , j ≠ y i , j } 。 显然上述定义是合理的。文 [ 17 ] 证明了度量空间 ( S Z 2 , d ) 是紧致的、完备的、完全不连通的Huasdorff 空间，并称 S Z 2 为二维k-符号序列空间，简称二维符号空间。 分别对两个坐标定义位移映射 σ 1 , σ 2 为 [ σ 1 ( x ) ] j 1 , j 2 = x j 1 + 1 , j 2 ， [ σ 2 ( x ) ] j 1 , j 2 = x j 1 , j 2 + 1 。其中 [ σ i ( x ) ] j 1 , j 2 表示 σ i ( x ) 中 ( j 1 , j 2 ) 位置的元素 ( i = 1 , 2 ) 。称 ( S Z 2 ; σ 1 , σ 2 ) 为S上的二维符号系统。类似地，可以定义d维符号系统。  细胞自动机(Cellular Automata，简称CA)是一类时间、空间和状态均离散的数学模型。构成细胞自动机的四个基本要素分别是：细胞(cell)、网格(lattice)、邻域(neighborhood)和规则(rule) [ 18 ] 。最简单的情况下细胞可以取0和1两个状态；网格是指细胞活动的空间；邻域一般指某个细胞自身及其直接相邻的细胞，常见的邻域有Neumann邻域和Moore邻域 [ 7 ] ；规则则规定了细胞间的相互作用方式。 1969年，数学家G. A. Hedlund给出如下细胞自动机的定义 [ 2 ] ： 定义2.1 设f是 S Z 上的连续映射，如果紧致系统 ( S Z , f ) 满足条件 f ∘ σ L = σ L ∘ f ，则称f是一个一 维细胞自动机，其中 S Z 表示定义在状态集S上的符号空间， σ L 为左移映射。 类似于一维细胞自动机的定义方式，我们可以定义高维细胞自动机。 定义2.2 设f是 S Z d 上的连续映射，如果紧致系统 ( S Z d , f ) 满足条件 f ∘ σ i = σ i ∘ f ( i = 1 , 2 , ⋯ , d ) ，则称f是一个d维细胞自动机，其中 S Z d 表示定义在状态集S上的d维符号空间， σ i 为第i个坐标上的位移映射，即 [ σ i ( x ) ] j 1 , ⋯ , j i , ⋯ , j d = x j 1 , ⋯ , j i + 1 , ⋯ , j d ， ∀ x ∈ S Z d , i = 1 , 2 , ⋯ , d 。其中 [ σ i ( x ) ] j 1 , ⋯ , j i , ⋯ , j d 表示 σ i ( x ) 中 ( j 1 , ⋯ , j i , ⋯ , j d ) 位置的元素。  动力系统中拓扑熵的定义有多种方法，这里我们用开覆盖来定义 [ 19 ] 。 设 ( X , T 1 ) 是一个拓扑动力系统， α 是X的一个开覆盖，用 N ( α ) 表示 α 的子覆盖的基数的下确界，即 N ( α ) = inf { β : β 是 α 的子覆盖}。因为X是紧致的，所以 N ( α ) 是一个正整数。定义开覆盖 α 的拓扑熵为 H ( α ) = log N ( α ) 。 定义2.3 设 ( X , T ) 是一个拓扑动力系统， α 是X的一个开覆盖，定义T关于 α 的拓扑熵为 h ( T , α ) = lim n → ∞ 1 n H ( ∨ i = 0 n − 1 T − i α ) ，T的拓扑熵为 h ( T ) = h ( X , T ) = sup α h ( T , α ) ，其中 α 取遍X的开覆盖。 下面给出与拓扑熵相关的几个命题： 命题2.1 设 ( X , T 1 ) , ( X , T 2 ) 是两个拓扑动力系统且拓扑共轭(即存在同胚映射 π : X → Y ，使得 π ∘ T 1 = T 2 ∘ π )，则 h ( T 1 ) = h ( T 2 ) 。也就是说拓扑熵是一个拓扑共轭不变量。 命题2.2 设 ( X , σ ) 是一维符号系统，则 h ( σ ) = log k 。 命题2.3 设 ( X , σ ) 是一维符号系统。如果 X 1 是X的闭子集，且 σ ( X 1 ) = X 1 ，那么 σ 限制在 X 1 上的拓扑熵为： h ( σ | X 1 ) = lim n → ∞ 1 n log θ n ( X 1 ) ， 其中 θ n ( X 1 ) 表示使得集合 { ( x i ) − ∞ + ∞ ∈ X 1 : x j = i j , j = 0 , 1 , ⋯ , n − 1 } 非空的n-元组 [ i 0 , i 1 , ⋯ , i n − 1 ] 的个数。 类似于命题2.3中一维符号系统拓扑熵的定义方式，Berger在文 [ 20 ] 中给出了二维符号系统拓扑熵的如下定义： 定义2.4 设 ( X ; σ 1 , σ 2 ) 是一个二维符号动力系统，Y是X的子系统，定义 ( Y ; σ 1 , σ 2 ) 的拓扑熵为 h ( Y ; σ 1 , σ 2 ) = lim n → ∞ 1 n 2 log θ n × n ( Y ) ， 其中 θ n × n ( Y ) 表示使得集合 { x i , j ∈ Y : x i , j = a i , j , i , j = 0 , 1 , ⋯ , n − 1 } 非空的 n × n -元组 [ a 0 , 0 ⋯ a 0 , n − 1 ⋮ ⋱ ⋮ a n − 1 , 0 ⋯ a n − 1 , n − 1 ] 的个数。 根据Berger的定义，显然有 θ n × n ( X ) = k ( n 2 ) ，因此 h ( X ; σ 1 , σ 2 ) = log k 。 命题2.4 设 ( X ; f 1 , f 2 ) 和 ( Y ; g 1 , g 2 ) 是两个二维符号系统且拓扑共轭，即存在X到Y的同胚映射 π ，使得 π ∘ f 1 = g 1 ∘ π ， 。那么， h ( X ; f 1 , f 2 ) = h ( Y ; g 1 , g 2 ) [ 20 ] 。也就是说，Berger定义的拓扑熵也是一个共轭不变量。"
"本节我们利用拓扑熵的性质这一方法给出Garden定理的证明，并利用该方法将Garden定理推广到任意维CA的情形。 定理3.1 设 X = { 0 , 1 , ⋯ , k − 1 } Z d ，其中 d ≥ 1 是一个整数。再设 f : X → X 是一个CA，则f是同胚映 射当且仅当f是单射。 为了证明此定理，我们首先给出一个引理： 引理3.1 设 X = { 0 , 1 , ⋯ , k − 1 } Z d ，其中 d ≥ 1 是一个整数。再设 f : X → X 是一个单射的CA，则f是 满射。 证明：我们首先说明一维的情形： 事实上，当 d = 1 时，上述结论由Garden-of-Eden定理即可直接得到 [ 12 ] [ 13 ] 。在这里，我们用拓扑熵的方法进行证明。 假设f不是满的，则 X \ f ( X ) 是一个非空开集，从而存在柱集 [ i 0 , i 1 , ⋯ , i m − 1 ] ⊂ X \ f ( X ) 。由细胞自动机定义， f ∘ σ = σ ∘ f ，所以 f ( X ) 是 σ -不变的。因此， ( f ( X ) , σ ) 是具有禁止词“ i 0 i 1 ⋯ i m − 1 ”的有限型位移系统 ( Y , σ ) 的子系统，即Y中的每个点(双边符号序列)均不含有词“ i 0 i 1 ⋯ i m − 1 ”。下面我们证明 h ( Y , σ ) < log k 。 由定理2.3， h ( Y , σ ) = lim n → ∞ 1 n log θ n ( Y ) = lim n → ∞ 1 m n log θ m n ( Y ) ≤ lim n → ∞ 1 m n log ( k m − 1 ) n = 1 m log ( k m − 1 ) < log k 从而， h ( f ( X ) , σ ) ≤ h ( Y , σ ) < log k 。另一方面，考虑映射 f : ( X , σ ) → ( f ( X ) , σ ) ，由于 f ∘ σ = σ ∘ f ，且f是X到 f ( X ) 的单射、满射，所以 ( X , σ ) 与 ( f ( X ) , σ ) 在映射f下拓扑共轭。于是， h ( f ( X ) , σ ) = h ( X , σ ) = log k ，矛盾。故f是满射。 下面我们说明高维的情形，为了表述方便，我们只对二维的情形给出证明。 类似于 d = 1 的证明，我们假设f不是满的。那么 X \ f ( X ) 是一个非空开集，于是，存在柱集 { x : x j 1 , j 2 = ω j 1 , j 2 , 0 ≤ j 1 , j 2 ≤ m − 1 } ⊂ X \ f ( X ) ，其中 ω 是一个m × m方块。因为 f ∘ σ i = σ i ∘ f ，所以 f ( X ) 是 σ i -不变的 ( i = 1 , 2 ) 。因此， ( f ( X ) ; σ 1 , σ 2 ) 是具有禁止词 ω 的有限型位移系统 ( Y ; σ 1 , σ 2 ) 的子系统，即 Y中的每个点均不含有词 ω 。从而， h ( f ( X ) ; σ 1 , σ 2 ) ≤ h ( Y ; σ 1 , σ 2 ) = lim n → ∞ 1 n 2 log θ n × n ( Y ) = lim n → ∞ 1 ( m n ) 2 log θ m n × m n ( Y ) ≤ lim n → ∞ 1 ( m n ) 2 log ( k ( m 2 ) − 1 ) ( n 2 ) = 1 m 2 log ( k ( m 2 ) − 1 ) < log k 另一方面，映射 f : ( X ; σ 1 , σ 2 ) → ( f ( X ) ; σ 1 , σ 2 ) 是一个共轭映射，于是， h ( f ( X ) ; σ 1 , σ 2 ) = h ( X ; σ 1 , σ 2 ) = log k ，矛盾，故f是满射。 下面我们给出定理3.1的证明： 证明：充分性是显然的，下面证明必要性： 由一般的拓扑理论，一个从紧致空间到度量空间的连续映射是同胚的，当且仅当它既是单射又是满射 [ 21 ] 。由于X是一个紧致度量空间，我们直接通过上述引理即可得到结论。"
"例1 基本细胞自动机(Elementary Cellular Automata，简称ECA)是指状态数为2、邻域半径为1的一维细胞自动机 [ 4 ] 。256个基本细胞自动机 f i ( i = 0 , 1 , ⋯ , 255 ) 中的同胚映射有： f 15 ， f 51 ， f 85 ， f 170 ， f 204 ， f 240 ，其中 f 170 是恒等映射， f 51 是镜像映射， f 170 和 f 204 分别是左移映射和右移映射， f 15 = f 240 ∘ f 51 ， f 85 = f 170 ∘ f 51 且 f 15 和 f 85 是拓扑共轭的。即对 ∀ x = ( x i ) ∈ { 0 , 1 } Z ，有 [ f 204 ( x ) ] i = x i ， [ f 51 ( x ) ] i = 1 − x i ， [ f 170 ( x ) ] i = x i + 1 ， [ f 240 ( x ) ] i = x i − 1 ， [ f 15 ( x ) ] i = [ f 240 ∘ f 51 ( x ) ] i = 1 − x i − 1 ， [ f 85 ( x ) ] i = [ f 170 ∘ f 51 ( x ) ] i = 1 − x i + 1 。 证明：显然 f 51 ， f 170 ， f 204 ， f 240 都是单射，所以 f 15 和 f 85 也是单射。于是，由定理3.1知， f 15 ， f 51 ， f 85 ， f 170 ， f 204 ， f 240 都是同胚映射。下面证明 f 15 和 f 85 是拓扑共轭的，为此，需构造同胚映射 π 使得 f 15 ∘ π = π ∘ f 85 。 在 { 0 , 1 } Z 上定义映射 π 为： π : { 0 , 1 } Z → { 0 , 1 } Z ( ⋯ , x − 1 , x 0 ∗ , x 1 , ⋯ ) ↦ ( ⋯ , x 1 , x 0 ∗ , x − 1 , ⋯ ) 即在 π 的作用下， { 0 , 1 } Z 中点的坐标关于坐标零做了翻转。显然 π 是 { 0 , 1 } Z 上的同胚映射。 对 ∀ x = ( x i ) − ∞ + ∞ ∈ { 0 , 1 } Z , ∀ i ∈ Z ， [ f 15 ∘ π ( x ) ] i = 1 − x − i − 1 = 1 − x − ( i + 1 ) = [ π ∘ f 85 ( x ) ] i 。 因此， f 15 ∘ π ( x ) = π ∘ f 85 ( x ) 。由x的任意性得 f 15 ∘ π = π ∘ f 85 。 例2 满射的CA不一定是同胚，例如ECA中的规则102 (即 f 102 )是满射，但不是单射，因而不是同胚映射。 证明：由于 102 = 2 0 × 0 + 2 1 × 1 + 2 2 × 1 + 2 3 × 0 + 2 4 × 0 + 2 5 × 1 + 2 6 × 1 + 2 7 × 0 ， 在布尔函数真值表中 N = 2 0 ⋅ f ( 000 ) + 2 1 ⋅ f ( 001 ) + 2 2 ⋅ f ( 010 ) + 2 3 ⋅ f ( 011 ) + 2 4 ⋅ f ( 100 )             + 2 5 ⋅ f ( 101 ) + 2 6 ⋅ f ( 110 ) + 2 7 ⋅ f ( 111 ) ， 令 N = 102 ，有 f 102 ( 000 ) = 0 ,     f 102 ( 001 ) = 1 ,     f 102 ( 010 ) = 1 ,     f 102 ( 011 ) = 0 ， f 102 ( 100 ) = 0 ,     f 102 ( 101 ) = 1 ,     f 102 ( 110 ) = 1 ,     f 102 ( 111 ) = 0 。 于是， f 102 ( x i ) = x i ⊕ x i + 1 ，其中 ⊕ 表示逻辑语言“异或”，即 0 ⊕ 0 = 1 ⊕ 1 = 0 ， 0 ⊕ 1 = 1 ⊕ 0 = 1 。显然 f 102 是满射，下面说明 f 102 不是单射。 取 x = ( ⋯ , 0 , 0 ∗ , 0 , ⋯ ) , y = ( ⋯ , 1 , 1 ∗ , 1 , ⋯ ) ∈ S Z ，则有 f 102 ( x ) = f 102 ( y ) = ( ⋯ , 0 , 0 ∗ , 0 , ⋯ ) 。 因此， f 102 不是单射。从而， f 102 不是同胚。 下面的例子说明存在 { 0 , 1 } Z 上的连续自映射f满足：f是单射，但不是同胚。因此，上述的结论要求 所讨论的映射是CA。 例3 设 X = { 0 , 1 } Z ，定义映射 f : X → X 为 [ f ( x ) ] 2 j = x j ， [ f ( x ) ] 2 j + 1 = 0 ， ∀ x ∈ X 。也就是说，通过在x的每两个符号之间插入0来构造 。容易看出f是连续的，但是，对于任意的 x ∈ X ， f ∘ σ ( x ) = f ∘ σ ( ⋯ , x − 1 , x 0 ∗ , x 1 , ⋯ ) = f ( ⋯ , x 0 , x 1 ∗ , x 2 , ⋯ ) = ( ⋯ , x 0 , 0 , x 1 ∗ , 0 , x 2 , ⋯ ) ， σ ∘ f ( x ) = σ ∘ f ( ⋯ , x − 1 , x 0 ∗ , x 1 , ⋯ ) = σ ( ⋯ , x − 1 , 0 , x 0 ∗ , 0 , x 1 , ⋯ ) = ( ⋯ , 0 , x 0 , 0 ∗ , x 1 , 0 , ⋯ ) 。 所以 f ∘ σ ≠ σ ∘ f ，因此f不是CA。进一步，f是单射，但是由于每一个 f ( x ) 都不包含长度为2的词“11”，因此f不是满射。"
