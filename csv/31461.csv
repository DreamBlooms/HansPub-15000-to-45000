"弃水控制是汛期水库发电调度的重要环节，降低水库起调水位进行预泄腾库可以有效控制梯级弃水，但如何确定水库起调水位是非常重要的技术问题。本文提出一种基于起调水位上限优化策略的弃水控制方法，以梯级弃水最小为目标，建立优化调度模型，并采用非线性全局优化方法进行求解；采用不同的起调水位策略优化获得特定组合洪水情景的梯级防弃水调度方案集，根据弃水量优选水库起调水位上限，最后采用该思路生成不同频率洪水场景对应的起调水位上限控制策略表。乌江流域构皮滩–思林–沙沱三库联合调度实例结果表明，当梯级遭遇历史最容易出现的洪水组合或者量级很大对水库调度极为不利的洪水组合时，都可以通过本文方法将梯级和各个水库的弃水控制在较低水平。 关键词 :弃水控制，起调水位，弃水最小模型，优化调度 Copyright © 2019 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"弃水控制是汛期梯级水库发电调度的重要环节，直接关系到水电调度的社会和经济效益 [ 1 ] 。汛期集中来水阶段，调节性能较差的水电站面临很大的弃水风险，极易造成水电资源浪费，实际工程中通常采用预泄腾库、降低起调水位的方式应对梯级可能发生的弃水 [ 2 ] [ 3 ] ，上游调节性能好的水库降低起调水位既能降低自身的弃水风险，同时可以控制下游水电站不弃水或少弃水，然而起调水位过低会降低电站的发电效率，过高则会增大弃水风险 [ 4 ] ，因此如何确定合理的上游水库起调水位是一个非常重要的技术问题。目前关于确定水库起调水位的研究，主要考虑不同频率洪水条件，通过调洪计算，确定水库在不弃水目标下的起调水位 [ 5 ] [ 6 ] ，或者离散起调水位，依据调度规则对多年实测来水进行计算，优选平均发电量最大的起调水位 [ 7 ] ，这些研究普遍采用常规调度思路，有必要结合优化方法和策略，以梯级弃水最小为目标，确定最优的水库起调水位，以尽可能保证汛期梯级水库群不弃水或少弃水，减少水资源浪费，提高水资源利用效率。 本文以乌江流域构皮滩–思林–沙沱三库联合防弃水调度为背景，提出一种基于起调水位上限优化策略的弃水控制方法，以梯级弃水最小为目标，建立优化调度模型，并采用非线性全局优化方法进行求解；采用不同的起调水位策略优化获得特定组合洪水情景的梯级防弃水调度方案集，根据方案弃水量优选弃水控制效果最佳的起调水位，作为水库起调水位上限，最后通过设置不同频率的设计洪水过程和组合，采用以上思路生成不同洪水场景对应的起调水位上限控制策略表，实现在不同洪水情景下对梯级弃水的良好控制。"
"基于起调水位上限优化策略的水库弃水控制方法包括三个步骤：1) 建立梯级弃水最小模型。对于给定的设计洪水过程和水库始末水位，以梯级弃水最小为目标，建立优化模型，并采用非线性全局优化方法进行求解；2) 优选水库起调水位上限。采用不同的起调水位策略通过弃水最小模型获得给定洪水过程的梯级防弃水调度方案集，并根据弃水量优选水库起调水位上限；3) 生成起调水位上限控制策略表。通过设置不同频率的设计洪水过程和组合，采用以上思路生成不同洪水场景对应的起调水位上限控制策略表。弃水控制方法流程如图1所示。 图1. 弃水控制方法流程  汛期来水较多的时候，水库可能面临弃水，并且对于梯级水库而言，下游调节性能较差的水库更容易发生弃水，而上游调节性能较优的水库不仅不容易弃水，还可以利用自身调节库容减小出库，进而减小下游水库来水压力和弃水风险。因此对于梯级而言，要实现弃水最小的目标，下游水库应该加大出力尽量减小弃水，而上游水库则应该根据下游水库实时调蓄能力相机确定出力和发电流量。梯级弃水最小模型目标函数如下： S W = min ( ∑ i = 1 M ∑ t = 1 T Q s p , i , t ⋅ Δ t ) (1) 式中，i、M分别为梯级水电站从上游到下游的序号和水电站总数， i = 1 , 2 , ⋯ , M ；t、T分别为调度期时段序号和时段总数， t = 1 , 2 , ⋯ , T ；SW表示梯级水电站调度期总弃水量， Q s p , i , t 表示水电站i在第t时段的弃水流量， Δ t 表示时段长。约束条件如下： ① 水量平衡约束：水库在上下两个时段间入库流量、出库流量以及库容值变化的动态平衡。 V i , t + 1 = V i , t + ( Q i n a l l , i , t − Q o u t , i , t ) Δ t (2) 其中： Q o u t , i , t = Q f d , i , t + Q s p , i , t (3) Q i n a l l , i , t = Q o u t , i − 1 , t + Q i n , i , t (4) 式中， V i , t 、 V i , t + 1 、 Q i n a l l , i , t 、 Q o u t , i , t 、 Q f d , i , t 、 Q s p , i , t 、 Q i n , i , t 分别表示水库i第t时段的初始库容、末库容、入库流量、出库流量、发电流量、弃水流量和区间流量。 ② 始末水位约束：给定水库调度期始末控制水位。 Z u p , i , 1 = Z b e g , i Z u p , i , T + 1 = Z e n d , i (5) 式中， Z u p , i , 1 表示水库i坝上第一个时段初始水位， Z u p , i , T + 1 表示水库i坝上第T个时段末水位， Z b e g , i 、 Z e n d , i 分别表示水库i坝上调度期始末水位。 ③ 库水位约束：保证水库安全合理运行的水位范围。 Z _ u p , i ≤ Z u p , i , t ≤ Z ¯ u p , i (6) 式中， Z u p , i , t 、 Z ¯ u p , i 、 Z _ u p , i 分别表示水库i坝上第t时段的初始水位及其上下限。 ④ 发电流量约束：取决于水电站机组最大过流能力和停机检修等。 Q _ f d , i ≤ Q f d , i , t ≤ Q ¯ f d , i (7) 式中， Q f d , i , t 、 Q ¯ f d , i 、 Q _ f d , i 分别表示水电站i第t时段的发电流量及其上下限。 ⑤ 出库流量约束：上限为水库最大泄流能力，下限满足下游航运、供水、生态用水等综合利用需求。 Q _ o u t , i ≤ Q o u t , i , t ≤ Q ¯ o u t , i (8) 式中， Q o u t , i , t 、 Q ¯ o u t , i 、 Q _ o u t , i 分别表示水电站i第t时段的出库流量及其上下限。 ⑥ 出力约束：上限为水电站总装机的额定容量。 N i , t ≤ N ¯ i (9) 式中， N i , t 、 N ¯ i 分别表示水电站i第t时段的出力和允许最大出力。 在模型求解方面，常用的优化方法包括线性规划、二次规划、动态规划以及智能算法。线性规划和二次规划求解速度快，但是需要大幅简化原问题，容易造成问题失真；动态规划通过离散状态变量，可获得离散精度下的全局最优解，但是容易陷入维数灾；智能算法通过模拟自然过程进行优化求解，但是计算结果并不稳定。本文借鉴文献 [ 8 ] 中的非线性全局优化方法，采用凸分析、区间分析、代数分析将原非凸、非线性问题转换为一系列凸、线性子问题，利用分支定界法遍历所有子问题，直至求得全局最优解。该方法由LINGO18.0 Multistart求解器实现。  优化模型构建完成后，对于确定的来水条件，可通过离散上游关键水库起调水位的方式调整起调水位策略，形成新的梯级水库始末水位条件，输入到梯级弃水最小模型中，优化计算得到不同起调水位策略对应的防弃水调度方案集，并根据防弃水调度方案的弃水量优选梯级弃水控制效果最优的水库起调水位，作为起调水位上限。 需要注意的是：1) 为了最大程度减小弃水风险，下游调节性能差的水库需要提前腾库降低水位运行，所以将它们的起调水位设置为水位运行下限；2) 上游调节性能好的水库作为控制梯级弃水的关键水库，通过调整起调水位的方式控制梯级弃水；3) 为了避免起调水位太低模型无法求解的情况，上游关键水库的起调水位从水位上限往水位下限离散；4) 综合考虑寻优效率和水位控制的精度要求，水位离散步长逐步缩小，最小步长根据实际水库运行状态决定。 具体实现步骤如下： 步骤1：令 k = 1 ，关键水库起调水位 Z b e g , k 设置为水位运行上限，水位离散步长为 Z s t e p ； 步骤2：将梯级各水库区间来水和始末水位输入到弃水最小模型中，求解得到防弃水方案 P l a n k ，对应的梯级弃水量为 S W k ； 步骤3：令 k = k + 1 ， Z b e g , k = Z b e g , k − 1 − Z s t e p ，重复步骤2； 步骤4：判断 S W k 是否小于 S W k − 1 ，如果小于，转至步骤3，直至弃水量不再减少； 步骤5：判断 Z s t e p 是否为最小离散步长，如果不是，令 Z s t e p = Z s t e p / 2 ， k = k − 1 ，转至步骤3，直至最小离散步长； 步骤6：判断 Z b e g , k 是否低于水位运行下限，如果低于，令 Z b e g , k 等于水位下限； 步骤7：此时得到的 Z b e g , k 便是将梯级弃水降到最低的关键水库起调水位。 通过以上7个步骤，可以得到确定来水条件下，梯级弃水控制效果最优的水库起调水位策略，并将它作为起调水位上限。  在实际调度中，来水往往是不确定的，因此，需要考虑不同洪水情景，进行优化调度和起调水位策略的优选；但是梯级各个电站区间遭遇的洪水并不能简单通过排列组合的方式得到，需要结合历史洪水组合频率分析，寻找历史上较容易出现的洪水组合。 首先，根据各个电站区间洪水洪量频率计算成果，对洪水进行编码，编码规则如表1所示： Table 1 洪水频率 50% 20% 10% 5% …… 0.01% 电站A A1 A2 A3 A4 …… An …… …… …… …… …… …… …… 电站M M1 M2 M3 M4 …… Mn 表1. 洪水编码规则表 然后，考虑各个频率洪水在各个电站间的组合，通过排列组合得到初步的洪水组合情景，并通过历史洪水组合频率分析，统计各个洪水组合在历史上出现的频次，得到历史高频洪水组合，再对高频洪水组合进行编码，如图2所示： 图2. 历史洪水组合频次分析 最后，对于历史上各个高频的洪水组合，通过放大典型洪水过程的方式得到对应的各个电站区间设计洪水过程，采用2.2中的方法分别进行优化调度和起调水位的优选，得到起调水位上限控制策略表。"
"为了验证本文方法的合理性和适用性，以乌江流域构皮滩、思林、沙沱三座电站为研究对象，进行梯级弃水控制方法研究。 构皮滩、思林、沙沱三座电站分别位于乌江干流中下游，总装机达到5170 MW，约占乌江干流水电总装机的60%，是乌江流域乃至贵州省的重要电源。另一方面，由于思林、沙沱位于梯级下游，且调节能力较差，这两个电站的弃水也非常严重，自2011~2016年，思林、沙沱两个电站的弃水量占到了梯级弃水总量的49.8%，研究电站流域图以及乌江干流弃水分布如图3所示。构皮滩电站位于思林、沙沱上游，具有多年调节能力，在汛期可以利用构皮滩的调蓄能力对梯级的弃水起到一定控制作用。各电站基础资料如表2所示。 图3. 流域图以及2011~2016年弃水分布 Table 2 电站 死水位/m 汛限水位/ m 正常高水位/m 装机/MW 调节库容/亿m³ 调节性能 构皮滩 590 626.24 (6~7月) 628.12 (8月) 630 3000 31.54 多年 思林 431 435 440 1050 3.17 日 沙沱 353.5 357 365 1120 2.87 日 表2. 各电站特征参数  本文研究时段为7天，为了考虑不同洪水条件的影响，根据乌江梯级各区间洪水洪量频率计算成果，首先统计历史上不同频率洪水组合出现的次数，寻找最容易出现的洪水组合，然后通过放大典型洪水的方式得到不同洪水组合对应的洪水过程。各电站区间不同设计频率七日洪量及编码情况如表3所示。 Table 3 电站 50% 20% 10% 5% 2% 构皮滩 6.46/A1 11.30/A2 15.10/A3 19.00/A4 24.30/A5 思林 2.59/B1 5.19/B2 7.55/B3 10.10/B4 13.50/B5 沙沱 2.92/C1 5.78/C2 8.36/C3 11.10/C4 14.90/C5 表3. 各电站区间不同设计频率七日洪量(亿m 3 ) 根据2.2中的编码规则，对各个电站区间洪水进行编码，考虑不同频率洪水在三个电站间的组合情况，统计历史上三个电站汛期七日洪水情况，寻找历史上最容易出现的洪水组合，将组合(A, B, C)定义为构皮滩、思林、沙沱分别遭遇编码为A、B、C洪水的组合，统计结果如表4所示。 由表4可知，(两年一遇，两年一遇，两年一遇)、(两年一遇，两年一遇，五年一遇)、(两年一遇，五年一遇，五年一遇)三个洪水组合是构皮滩、思林、沙沱最容易出现的洪水组合。另外，构皮滩上游水库出库流量按照多年平均出库流量计算(442.0 m 3 /s)。 Table 4 洪水组合 洪水组合 频次 频率 组合编码 (A1, B1, C1) (50%, 50%, 50%) 872 89.90% FC 1 (A1, B1, C2) (50%, 50%, 20%) 58 5.98% FC 2 (A1, B2, C2) (50%, 20%, 20%) 18 1.86% FC 3 (A2, B2, C3) (20%, 20%, 10%) 8 0.82% FC 4 (A1, B2, C1) (50%, 20%, 50%) 4 0.41% FC 5 (A1, B2, C3) (50%, 20%, 10%) 4 0.41% FC 6 (A2, B2, C2) (20%, 20%, 20%) 4 0.41% FC 7 (A3, B5, C5) (10%, 2%, 2%) 2 0.21% FC 8 表4. 历史洪水组合频次统计 设计洪水过程线是指具有某一设计标准的洪水过程线，目前主要通过放大典型洪水过程线的方法得到 [ 9 ] ，结合乌江流域历史资料(2014年7月中下旬乌江流域发生较大洪水，多个区间洪水达到了二十年一遇或五十年一遇水平)和洪水特性，选取2014年7月14日~7月20日总共7天的区间来水过程作为乌江梯级各区间的典型洪水过程线，典型洪水过程线和放大后不同频率对应的设计洪水过程线如图4所示。 图4. 不同设计频率对应的洪水过程线 为了最大程度减小弃水风险，思林、沙沱需要腾库降低水位运行，因此拟定思林、沙沱起调水位为死水位(431 m, 353.5 m)，末水位为汛限水位(435 m, 357 m)；构皮滩起调水位在死水位(590 m)至汛限水位(626.4 m)之间离散，初始离散步长为1亿m³库容对应的水位变幅，末水位为汛限水位。   水库调度部门一方面关心减少弃水，另一方面还重视发电效益，本文提出的梯级弃水最小模型以弃水最小为目标，为了验证该模型具有较优的发电效益，以洪水组合代码为FC3 (两年一遇，五年一遇，五年一遇)的洪水过程为例，离散关键水库构皮滩的起调水位，并控制各水库的始末水位，与梯级发电量最大模型进行对比，如图5所示。 由图5可知，本文模型与梯级发电量最大模型相比，发电量基本接近；弃水量比梯级发电量最大模型略小，本文模型与发定量最大模型发电量偏差和弃水减少量如表5所示。 由表5可知，本文模型与发电量最大模型的发电量偏差很小，对于洪水组合代码为FC3 (两年一遇，五年一遇，五年一遇)的洪水过程，两模型发电量平均偏差为1.29%，证明本文所提梯级弃水最小模型具有较优的发电效益，并且本文模型弃水量比梯级发电量最大模型更少，构皮滩起调水位越高，弃水量减少越多，最多可减少0.40亿m 3 。 图5. 两个模型发电量弃水量对比 Table 5 构皮滩起调水位/m 发电量偏差 弃水减少量/亿m³ 614.81 1.65% 0.03 616.16 2.21% 0.03 617.52 1.12% 0.04 618.88 0.93% 0.09 620.24 1.50% 0.11 621.59 1.55% 0.14 622.91 1.06% 0.20 624.19 0.91% 0.28 625.42 0.73% 0.40 平均 1.29% 0.15 表5. 两模型发电量偏差和弃水减少量  以组合代码为FC3 (两年一遇，五年一遇，五年一遇)的洪水过程为例，离散关键水库构皮滩的起调水位，并控制各水库的始末水位，输入到梯级弃水最小模型中，采用非线性全局优化方法进行求解，得到不同起调水位对应的防弃水方案集，每一个防弃水方案都代表在当前起调水位下梯级弃水最小的调度方案，如图6所示。 由图6可知，随着构皮滩起调水位的降低，防弃水方案对应的梯级弃水量逐渐减小，说明构皮滩通过降低起调水位控制梯级弃水的方式是合理的，当构皮滩起调水位降低至617.79 m时，防弃水方案对应的梯级弃水量降至最低，因此该水位就是保证梯级弃水量最小目标下构皮滩水库的起调水位上限。 图6. 不同起调水位策略对应的梯级弃水量  根据历史洪水组合频次分析结果，本文考虑了8种电站间洪水组合，作为来水情景。对于每一种来水情景，分别计算防弃水方案集，根据弃水量优选构皮滩水库的起调水位上限，生成起调水位上限控制策略表，结果如图7所示。 图7. 不同组合洪水计算结果 各个洪水组合对应的起调水位上限、梯级弃水量以及各电站弃水分布如表6所示。 Table 6 代码 洪水组合 起调水位上限/m 梯级弃水/亿m 3 构皮滩弃水/亿m 3 思林弃水/亿m 3 沙沱弃水/亿m 3 FC 1 (50%, 50%, 50%) 623.30 0.00 0.00 0.00 0.00 FC 2 (50%, 50%, 20%) 620.17 0.00 0.00 0.00 0.00 FC 3 (50%, 20%, 20%) 617.79 0.70 0.00 0.00 0.70 FC 4 (20%, 20%, 10%) 610.62 2.18 0.00 0.00 2.18 FC 5 (50%, 20%, 50%) 620.17 0.00 0.00 0.00 0.00 FC 6 (50%, 20%, 10%) 616.91 2.18 0.00 0.00 2.18 FC 7 (20%, 20%, 20%) 611.61 0.70 0.00 0.00 0.70 FC 8 (10%, 2%, 2%) 603.33 19.20 0.00 4.27 14.93 表6. 起调水位上限控制策略表 历史上出现的各种洪水组合都可以通过查询起调水位上限控制策略表得到构皮滩的起调水位上限，参考该起调水位进行预泄调度，可将梯级弃水控制在最低水平。为验证本文弃水控制方法的合理性，将洪水组合FC1~FC8的调度结果分别与常规调度的结果进行对比，如表7所示。 Table 7 代码 梯级弃水/亿m³ 构皮滩弃水/亿m³ 思林弃水/亿m³ 沙沱弃水/亿m³ 常规调度 弃水控制 常规调度 弃水控制 常规调度 弃水控制 常规调度 弃水控制 FC 1 0.21 0.00 0.00 0.00 0.08 0.00 0.13 0.00 FC 2 2.03 0.00 0.00 0.00 0.29 0.00 1.74 0.00 FC 3 4.65 0.70 0.00 0.00 1.40 0.00 3.26 0.70 FC 4 18.87 2.18 1.79 0.00 6.09 0.00 10.99 2.18 FC 5 1.65 0.00 0.00 0.00 0.40 0.00 1.26 0.00 FC 6 15.61 2.18 0.97 0.00 5.64 0.00 9.00 2.18 FC 7 14.28 0.70 2.92 0.00 4.04 0.00 7.32 0.70 FC 8 67.72 19.20 13.13 0.00 21.06 4.27 33.53 14.93 表7. 不同调度方法结果对比 由表7可知，与常规调度相比，本文弃水控制方法可以将梯级和各个水库的弃水控制在较低水平，具体表现如下：1) 对于历史上出现频次最高的洪水组合FC1 (两年一遇，两年一遇，两年一遇)和FC2 (两年一遇，两年一遇，五年一遇)，都可以通过本文方法将梯级弃水从0.21、2.03亿m 3 降低至零，思林弃水减少了0.08、0.29亿m³，沙沱弃水减少了0.13、1.74亿m³；2) 对于历史上出现频次不高，但是量级很大，对水库调度极为不利的洪水组合FC8 (十年一遇、五十年一遇、五十年一遇)，通过本文方法可将梯级弃水从67.72亿m 3 控制到19.20亿m³，构皮滩弃水从13.13亿m³降低至零，思林、沙沱弃水分别减少了16.79、18.6亿m 3 ，弃水控制效果十分明显。"
"本文提出一种基于起调水位上限优化策略的弃水控制方法，并将其应用到乌江流域构皮滩–思林–沙沱三库联合调度，以梯级弃水最小为目标，通过不同频率洪水，不同组合情景下优化计算构皮滩起调水位上限和对应的梯级最小弃水量，获得如下主要结论： 1) 本文通过调整构皮滩的起调水位策略，寻求将梯级弃水控制到最小程度的起调水位上限，研究结果发现随着构皮滩起调水位的降低，梯级最小弃水量逐渐减小，说明通过降低构皮滩起调水位控制梯级弃水的方式是合理的。 2) 本文通过不同洪水组合情景下的优化计算，得到构皮滩水库起调水位上限控制策略表，当梯级遭遇历史最容易出现的洪水组合或者量级很大对水库调度极为不利的洪水组合时，都可以通过本文方法将梯级和各个水库的弃水控制在较低水平。 3) 本文方法不仅可以实现控制梯级弃水的目的，还可以保证发电效益，对于(两年一遇，五年一遇，五年一遇)的洪水组合，发电量与梯级发电量最大模型相比十分接近，差距仅为1.29%。"
