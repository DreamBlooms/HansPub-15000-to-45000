"计算机断层扫描(Computed Tomography, CT)技术被广泛地应用于医学、工程领域。模板的形状对CT系统参数标定至关重要，本文针对普通的单椭圆和小圆模板进行了改进，设计了三种新的模板。首先利用Radon变换和R-L滤波获取其接收信息，然后基于卷积反投影重建算法得到其重建图，并利用敏感度、特异度和约登指数对重建效果进行了定量评估。与原模板相比，新模板重建效果更好。此外，为了考察其抗噪性，对原模板和新模板分别加入不同强度的高斯噪声，试验结果表明新模板比原模板具有更好的抗噪性。一个有趣的发现是以多边形轮廓的单参考系几何图形比边缘为弧线的多参考系几何图形为模板对CT重建效果更好。 关键词 :多边形模板，CT，卷积，R-L滤波，约登指数 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"在临床医学上，计算机断层扫描(CT)技术是应用非常广泛的影像技术，该技术以多个X射线的投影来获得穿过人体内部的X射线密度值，由此形成人体某个组织的断层切片图像，并通过三维重建得到人体内部器官和组织的立体图像 [ 1 ] 。X射线处理同时配接X光机可以实现动态显示人体内的器官与组织的细节部分。而CT中的模板可以迅速确定其旋转中心的位置，以及可以衡量图像还原的好坏程度，因此模板的设计选择对于CT技术的效果至关重要。在CT图像还原方面，Sidky等推导出了BPF重建算法，该算法可用于直线CT图像重建 [ 2 ] 。Katsevich提出了螺旋轨迹的滤波反投影重建算法。先对投影数据沿着指定方向进行一维Hilbert变换，然后通过反投影得到重建图像 [ 3 ] 。郭威 [ 4 ] 改进的ART算法提高了收敛速度，使原图像还原度更高。莫华等 [ 5 ] 利用卷积反投影重建算法对CT图像进行重构。Wang等 [ 6 ] 利用约登指数衡量图像还原程度的好坏。 针对之前的研究成果，基于平行射束的模板设计，本文提出了几种新型模板，选取使用卷积反投影算法对图像进行重构后，用约登指数进行检验图质的还原程度，同时对模板进行加噪处理，对比得到还原程度最好的模板，且抗噪性能最佳的模板。该模板可应用于实际CT图像系统的参数标定，有利于更加准确的标定CT系统的参数。"
"本研究对象来源于2017年全国大学生数学建模竞赛数据，如图1所示。为了简化，作以下假设：1)数据来源中的两个几何图形为椭圆和小圆；2) CT系统旋转中心在探测器组的中垂线上；3) 不考虑X射线的在介质表面反射造成的影响；4) 探测器接收到的射线能量经过的增益为等倍数增益；5) 不考虑由于CT系统旋转而产生的X射线散射效应。"
"在进行卷积反投影重建时，由于噪声对CT扫描工作的影响，因此有必要对其进行滤波处理。下面我们利用原始数据与滤波函数的卷积运算，得到各方向卷积的投影函数，以期获取信噪比更高的图像。采用R-L滤波器 [ 7 ] ，其函数如下， h R − L ( n d ) = { 1 / ( 4 d 2 ) n = 0 ; 0 n 为 偶 数 ; − 1 / ( n 2 π 2 d 2 ) n 为 奇 数 . (1) 其中d为采样间隔，记 p ( n , m ) 为原始投影函数， 为滤波之后的投影函数，则： p ˜ ( n , m ) = p ( n , m ) × h ( n ) = ∑ l = − N i N i p ( n − l , m ) h ( l )               n = 0 , 1 , 2 , ⋯ , 255 (2) 之后将滤波之后的投影函数 p ˜ ( n , m ) 进行射束计算与内插。由于数据为离散数据，可能存在间距过大时数据缺失，所以进行内插对数据进行插补，而射束计算的目的是计算出内插公式中的 n 0 和权重δ。内插公式如下： p ˜ ( n 0 + δ ) = p ˜ ( n 0 ) + δ [ p ˜ ( n 0 + 1 ) − p ˜ ( n 0 ) ] = ( 1 − δ ) p ˜ ( n 0 ) + δ p ˜ ( n 0 + 1 ) (3) 对于任意的像素 ( x i , y j ) ，以及旋转角度θ有: x r = x i cos θ + y j sin θ = ( i − N + 1 2 ) cos θ + ( j − N + 1 2 ) sin θ (4) 令 x ˜ r = x r + N − 1 2 ，则射束运算如下： x ˜ r = C θ + ( i − 1 ) cos θ + ( j − 1 ) sin θ = 整 数 ( n 0 ) + 小 数 ( δ ) (5) 经过射束计算与内插后，利用累加反投影法得到任意一点 ( x , y ) 的图像。进行初始化，定义所有像素 a 0 ( i , j ) = 0 ，令 θ = m Δ ，Δ为角增量， m = 1 , 2 , ⋯ , N θ 。 x ˜ | θ = m Δ = x ˜ r , m ( i , j ) = ( i − 1 ) cos m Δ + ( j − 1 ) sin ( m Δ ) + C m . (6) 根据以下递推公式进行计算: a m ( i , j ) = a m − 1 ( i , j ) + p ˜ [ x ˜ r , m ( i , j ) , m Δ ] ,     m = 1 , 2 , ⋯ , 180. (7) 当 m = 180 时，图像重建完毕。卷积反投影重建流程图 [ 8 ] 如下。"
"新模板下的图像重建 由于椭圆和小圆的边界圆润，在提取其接收信息二值图边缘时可能产生的边缘信息冗余或不连续现象 [ 9 ] ，这样计算得到标定信息可能存在误差。我们重新设计了三种新的模板，大小仍为256像素 * 256像素，其吸收率灰度图像记为 I ( k ) , k = 1 , 2 , 3 ，如图2第1列所示。 记吸收率为1的区域为 I 1 ( k ) (有介质的区域)，吸收率为0的区域为 I 0 ( k ) (没有介质的区域)，则有 I t ( k ) = { ( i , j ) | I ( k ) ( i , j ) = t } , t = 0 , 1 ; k = 1 , 2 , 3 ，且 I ( k ) = I 1 ( k ) ∪ I 0 ( k ) 。为了考察新模板接收信息的重建图像的效果，并与原模板(图1)进行比较。为简单起见，我们设定CT系统的旋转中心为模板几何中心 [ 10 ] ，以1˚ 图1. 原始数据模板图 的步长从1˚旋转到360˚，利用Radon变换 [ 11 ] 获取其接收信息，如图2第2列所示。利用上述提出的基于卷积反投影函数重建的方法对图2第2列图像重建，得到重建图 J ( k ) ，如图2第3列所示，重建效果图 基本与原图 I ( k ) 吻合，效果较好。 为了进一步定量比较新模板与原模板的优劣，借用医学评价筛查试验真实性的方法，重新定义敏感度(sensitivity，Se)和特异度(specificity，Sp)。敏感度定义为有介质的区域重建正确率，特异度定义为没有介质的区域重建正确率 [ 12 ] 。并利用约登指数 [ 13 ] (Youden指数 = Se + Sp − 1)综合评价敏感度与特异度。上述三个指标的计算如(15)式所示。原模板与新模板 I ( k ) 重建后的Se、Sp和Youden指数如表1所示：结果表明新模板下得到的敏感度和特异度均优于原模板，以新模板 I ( 3 ) 的效果最优。 { S e = 1 − 1 s i z e ( I 1 ( k ) ) ∑ ( i , j ) ∈ I 1 ( k ) | I ( k ) ( i , j ) − J ( k ) ( i , j ) | , S p = 1 − 1 s i z e ( I 0 ( k ) ) ∑ ( i , j ) ∈ I 0 ( k ) | I ( k ) ( i , j ) − J ( k ) ( i , j ) | Y o u d e n = S e + S p − 1. , (8) 其中， 表示新模板 中有介质区域的像素点总个数， s i z e ( I 0 ( k ) ) 表示新模板 I ( k ) 中没有介质区域的像素点总个数。 更进一步，由于实际工作中CT系统对对象进行断层扫描时，容易受到噪声影响 [ 14 ] ，因此，对新模板 I ( k ) 与原模板分别加入5组不同强度的高斯噪声 [ 15 ] ，并利用Radon变换获取它们的接收信息，最后利用3节中提出的基于卷积反投影函数重建的算法得到重建图像，并利用Youden指数定量评价其效果，为消除随机因素的影响，对每次加噪过程重复100次，得到的平均结果如表2所示。原模板和新模板的重建效果如图3所示，Youden指数改变率随噪声强度的变化情况如图4所示。 从表2及图4、图5可以看出，随着噪声强度的增加，原模板和三个新模板的敏感度和特异度均有下降趋势，但新模板的重建效果总是优于原模板。表明设计的新模板在抗噪性方面优于原模板。然而，新模板2和新模板3的Youden指数变化率显著小于原模板和新模板1，这个现象表明以多边形轮廓的几 图2. 基于卷积反投影重建流程图 图3. 新模板的接收信息与重建效果。第1列为吸收率矩阵灰度图；第2列为接收信息灰度图；第3列为重建图像 Table 1 Se Sp Youden指数 原模板 0.9575 0.8910 0.8485 新模板 I ( 1 ) 0.9659 0.9704 0.9363 新模板 I ( 2 ) 0.9634 0.9904 0.9538 新模板 I ( 3 ) 0.9702 0.9920 0.9622 表1. 原模板与新模板 I ( k ) 重建效果 何图形比边缘为弧线的几何图形为模板对于CT重建效果更好。"
"参照将边缘弧线变为边缘为多边形，且参考系逐步减少的原则设计了三个新模板。本文对初始模板和新设计的三个模板采用Radon变换得到接收图像的信息，然后对接收图像信息进行R-L滤波，采用平 Table 2 噪声标准差 0.05 0.1 0.15 0.35 0.55 原模板 0.3802 0.3366 0.3510 0.2791 0.1985 新模板1 0.4486 0.4483 0.4202 0.3001 0.2846 新模板2 0.6029 0.5660 0.5673 0.4597 0.3736 新模板3 0.6254 0.5695 0.6001 0.4706 0.3570 表2. 在不同强度噪声下原模板与三个新模板重建效果的Youden指数 图4. 原模板和新模板在不同噪声强度下的重建效果图 行射束卷积反投影算法得到还原的模板图像及衡量图像还原质量的约登指数发现以多边形轮廓的几何图形比边缘为弧线的几何图形为模板对CT重建效果更好。由于上述还原条件为理想状态，因此为了适应现实中含有各种对图像质量影响的条件，对所有的模板进行逐步加高斯噪声，并计算每个加噪模板还原后的约登指数，通过对比发现，新模板2和新模板3的Youden指数变化率显著小于原模板和新模板1，研究结果为：以多边形轮廓的单参考系几何图形比边缘为弧线的多参考系几何图形为模板的重建效果更优。 图5. 原模板与三个新模板的Youden指数变化率随噪声强度的变化 因此，在CT系统模板设计时，可以参考以多边形轮廓的单参考系几何图形，这有利于CT系统的参数标定的准确性。"
