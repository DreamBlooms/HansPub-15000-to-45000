"PH曲线是一类特殊的多项式参数曲线，其最显著的优点是弧长函数为多项式，其等距线可由兼容于CAD系统的有理多项式曲线表示。鉴于此，基于三次DP曲线，从平面PH曲线的定义出发，给出了三次DP曲线为PH曲线时其控制多边形满足的充分必要条件，得到了关于控制多边形的边长和夹角的几何特征条件，给出DP-PH曲线的定义。通过DP-PH控制多边形几何特征条件，给出可以先通过构造控制多边形进而构造出三次DP-PH曲线的几何构造方法。进一步分析了DP曲线和DP-PH曲线的误差。 关键词 :PH曲线，DP曲线，DP-PH曲线，几何特征 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"在计算机辅助几何设计中，非均匀有理B样条(NURBS)方法发展比较成熟，成为现代曲线曲面设计中最为广泛流行的技术，但是仍然存在不足：不能准确表示摆线、螺旋线、圆锥、圆弧曲线等工程问题中经常用到的超越曲线曲面。近年来，学者们不仅在非多项式空间构造出了新型曲线，而且在多项式空间也构造出了新型曲线。Delgado和Peña [ 1 ] 提出了新型参数曲线，称为DP曲线，该曲线不但在数值计算上具有稳定性、在算法上具有线性的计算时间复杂度，而且是由具有曲线保形性的全正基(NTP基)生成的 [ 2 ] [ 3 ] [ 4 ] [ 5 ]。 在CAD的很多领域涉及到曲线弧长和等距线的计算问题，例如铁路与公路的设计、机械零件的设计以及半智能机器人运动轨迹生成等，往往需要多项式曲线的弧长和等距线具备有理形式。为此，FAROUKI和SAKKALIS [ 6 ] 引入毕达哥拉斯速端(Pythagorean Hodograph, PH)曲线，具有多项式形式的弧长和有理形式的等距线。到目前为止，对PH曲线的研究过多地侧重于代数结构方面，在几何方面的研究成果很匮乏。众所周知，对于给定Bézier曲线的控制多边形，其相关边长和内角不依赖于坐标选择的固有内在几何参量，具体数据可由实际测量得。因此，从控制多边形的长度和角度来讨论PH曲线的几何性质无论在理论上还是实际应用中都具有重要意义。Farouki和Sakalis [ 6 ] 给出具有不同控制顶点的3次Bézier曲线为PH曲线分离形式的边长约束条件和角的约束条件。此外，五次PH曲线的几何特征条件也被确立，但对于边长和角度来说这个条件不是分离形式的。近年来，四次 [ 7 ]、五次 [ 8 ] 和六次 [ 9 ] PH曲线的充分必要的几何特征条件被确定。 对于基于三次DP曲线构造PH曲线的问题，本文给出了三次PH-DP曲线的定义，DP曲线成为PH曲线的充分必要条件，关于控制多边形的边长和夹角的几何特征条件，并且是边角完全分离的条件。通过DP-PH控制多边形几何特征条件，我们给出可以先通过构造控制多边形进而构造出三次DP-PH曲线的几何构造方法。最后，分析了DP曲线和DP-PH曲线的误差，给出数值例子。"
"本章基于DP曲线，构造PH曲线(DP-PH曲线)，并给出三次DP曲线成为PH曲线的几何特征条件。  给定控制点 P k ，对于 ∀ t ∈ [ 0 , 1 ] ，定义三次DP曲线： P ( t ) = ∑ i 3 p i D i , 3 (t) 其中三次DP曲线基函数为： [ D 0 , 3 ( t ) , D 1 , 3 ( t ) , D 2 , 3 ( t ) , D 3 , 3 ( t ) ] = [ ( 1 − t ) 3 , t ( 1 − t ) ( 2 − t ) , t ( 1 − t ) ( 1 + t ) , t 3 ]  定义1 [ 6 ] ：给定平面参数多项式曲线 q ( t ) = ( x ( t ) , y ( t ) ) ，如果存在多项式 δ ( t ) ，使得，即 δ ( t ) = x ′ 2 ( t ) + y ′ 2 ( t ) 是勾股数，称平面参数多项式曲线 q ( t ) 为Pythagorean-hodograph曲线，简称PH曲线。 定理1 [ 6 ] ：设 u ( t ) , v ( t ) , w ( t ) 为非常数的实多项式且 ( u ( t ) , v ( t ) ) = 1 ，则导数具有如下形式： x ′ ( t ) = w ( t ) ( u 2 ( t ) − v 2 ( t ) ) , y ′ ( t ) = 2 w ( t ) u ( t ) v (t) 的平面参数曲线 q ( t ) = ( x ( t ) , y ( t ) ) 为PH曲线。  下面推导DP曲线成为PH曲线的条件。 给定两个线性多项式 a ( t ) 和 b ( t ) ： a ( t ) = a 0 D 0 1 ( t ) + a D 1 1 (t) b ( t ) = b 0 D 0 1 ( t ) + b D 1 1 (t) 假设 a 0 : a 1 和 b 0 : b 1 的比率不等，利用三次DP基函数 [ D 0 , 3 ( t ) , D 1 , 3 ( t ) , D 2 , 3 ( t ) , D 3 , 3 ( t ) ] = [ ( 1 − t ) 3 , t ( 1 − t ) ( 2 − t ) , t ( 1 − t ) ( 1 + t ) , t 3 ] ，求得： a ( t ) 2 − b ( t ) 2 = 2 ( a 0 2 − b 0 2 ) D 0 2 ( t ) + 3 ( a 0 a 1 − b 0 b 1 ) D 1 2 ( t ) + 2 ( a 1 2 − b 1 2 ) D 2 2 (t) 2 a ( t ) b ( t ) = 4 a 0 b 0 D 0 2 ( t ) + 3 ( a 0 b 1 + a 1 b 0 ) D 1 2 ( t ) + 4 a 1 b 1 D 2 2 (t) x ( t ) = ∫ 0 t a ( t ) 2 − b ( t ) 2 d t = ∑ k = 0 3 x k D k 3 (t) y ( t ) = ∫ 0 t 2 a ( t ) b ( t ) d t = ∑ k = 0 3 y k D k 3 (t) 所以PH-DP曲线的控制点为 p k = ( x k , y k ) { p 1 = p 0 + 1 3 ( 2 ( a 0 2 − b 0 2 ) , 4 a 0 b 0 ) p 2 = p 1 + 1 3 ( 3 ( a 0 a 1 − b 0 b 1 ) , 3 ( a 0 a 1 + b 0 b 1 ) ) p 3 = p 2 + 1 3 ( 2 ( a 1 2 − b 1 2 ) , 4 a 1 b 1 ) 其中 p 0 是任意给定的。进一步的，给出上述条件公式(2.1)的几何解释，即DP-PH曲线几何特征条件。 定理2：对于任意给定的一个三次DP曲线 q ( t ) ，其控制顶点 p k ( k = 0 , 1 , 2 , 3 ) ，控制多边形的各边长为 L 1 , L 2 , L 3 ， d j , k 表示 p k 和之间的距离， ( j ≠ k ) ， L 1 = d 01 , L 2 = d 12 , L 3 = d 23 , L = d 02 顶点 p 1 , p 2 对应的角为 θ 1 , θ 2 若满足条件 2 L = 3 L 1 L 3 和 θ 1 = θ 2 q ( t ) 就是PH-DP曲线。 证明 若 q ( t ) 满足PH曲线的条件公式(2.1)，可以得到： { d 01 = 2 ( a 0 2 + b 0 2 ) 3 d 12 = 2 ( a 0 2 a 1 2 + b 0 2 b 1 2 ) d 23 = 2 ( a 1 2 + b 1 2 ) 3 图1. 三次DP-PH曲线控制多边形 如图1可以得出： cos θ 1 = d 01 2 + d 12 2 − d 02 2 2 d 12 d 23 cos θ 2 = d 12 2 + d 23 2 − d 13 2 2 d 12 d 23 根据公式(2.1)给出 d 02 , d 13 ，则 d 02 2 = 4 9 ( a 0 2 + b 0 2 ) [ 9 ( a 0 + a 1 ) 2 + 9 ( b 0 + b 1 ) 2 ] d 13 2 = 4 9 ( a 1 2 + b 1 2 ) [ 9 ( a 0 + a 1 ) 2 + 9 ( b 0 + b 1 ) 2 ] 得 cos θ 1 = cos θ 2 = − 4 ( a 0 a 1 + b 0 b 1 ) 3 a 0 2 a 1 2 + b 0 2 b 1 2 可以推得 θ 1 = θ 2 或 θ 2 = 2 π − θ 1 ，进而比较与 sin θ 1 和 sin θ 2 ，计算两个角的正弦值，即 sin θ 1 = ( Δ p 1 × Δ p 0 ) ⋅ z d 12 d 01 sin θ 2 = ( Δ p 2 × Δ p 1 ) ⋅ z d 23 d 12 其中z是与 q ( t ) 平面正交的单位向量，将上述带入，可得到 sin θ 1 = sin θ 2 = 4 ( a 1 b 0 − a 0 b 1 ) 3 a 0 2 a 1 2 + b 0 2 b 1 2 由此得出 θ 1 = θ 2 。 并且根据条件公式(2.1)可得控制多边形边长之间的关系满足 2 L = 3 L 1 L 3 。 证毕。"
"通过DP-PH控制多边形几何特征条件，我们给出可以先通过构造控制多边形进而构造出三次DP-PH曲线的几何构造方法。 给定始末控制顶点 P 0 , P 3 和任意点O，依次连接给定的三点，并且令 ‖ O P 3 ‖ ‖ P 0 O ‖ = ρ ≥ 1 ，角的范围为 π > ∠ P 0 O P 3 = θ > 0 。在边 P 0 O 和 O P 3 分别取点 P 1 , P 2 。设单位向量 e 1 = O − P 0 ， e 2 = P 3 − O 。得到 P 1 , P 2 坐标为： { P 1 = λ e 1 + P 0 P 2 = P 3 − μ e 2 (3.1) 0 ≤ λ , μ ≤ 1 。 以点O为原点， P 0 O 为x轴建立直角坐标系。令 P 1 = ( 1 , 0 ) ， e 1 = ( − 1 , 0 ) ， e 2 = ρ ( cos θ , sin θ ) ，代入式(3.1)得到四个控制顶点的坐标为 { P 0 = ( 1 , 0 ) P 1 = ( 1 − λ , 0 ) P 2 = ( 1 − μ ) ρ ( cos θ , sin θ ) P 3 = ρ ( cos θ , sin θ ) (3.2) 通过定理2中边 P 0 O 和 O P 3 关系之比和推导出的控制多边形几何特征条件可以得出DP曲线控制顶点的中间两点 D 1 , D 2 ，并得到如下关系式： ∠ D 2 D 1 P 0 = ∠ P 3 D 2 D 1 和 4 | D 1 D 2 | 2 = 9 | D 1 P 0 | ∗ | P 3 D 2 | ， 由 ‖ O P 3 ‖ ‖ P 0 O ‖ = ρ ≥ 1 得到 λ , μ 表达关系式如下： 1 − λ = ρ ( 1 − μ ) (3.3) { | D 1 P 0 | = λ | P 3 D 2 | = ρ + λ + 1 | D 1 D 2 | 2 = 2 ( 1 − λ ) 2 ( 1 − cos θ ) (3.4) 由式(4)，得到关于参数 λ 的方程 ( 1 + 8 cos θ ) λ 2 + ( 7 + 9 ρ − 16 cos θ ) λ + ( 8 cos θ − 8 ) = 0 (3.5) 式(3.4)存在解 λ = ( 16 cos θ − 7 − 9 ρ ) ± 81 ( 1 + ρ ) 2 − 36 ρ ( 8 cos θ + 1 ) 2 ( 1 + 8 cos θ ) (3.6) 令 θ = π 3 ， ρ = 1 由式(3.3)得到 λ = μ = 2 5 ，把式(3.3)和(3.6)代入式(3.2)中，从而得出 D 1 = ( 3 5 , 0 ) ， D 2 = ( 1 5 , 3 5 ) ，取点 p 0 , D 1 , D 2 , P 3 ，画图如图2和图3： 图2. DP曲线 图3. DP-PH曲线"
"定义2：设 P ( t ) ， D ( t ) 是两条三次曲线，这两条曲线误差定义如下： ε = max t ∈ D 〈 P ( t ) − D ( t ) , P ( t ) − D ( t ) 〉 (4.1) 给定控制顶点 P i , D i 定义三次DP-PH曲线为： D ( t ) = ∑ i = 0 3 D i u i , 3 (t) 则DP曲线和DP-PH曲线的误差表示如下： ε = ∫ 0 a ‖ ∑ i = 0 3 P i u i , 3 ( t ) − ∑ i = 0 3 D i u i , 3 ( t ) ‖ 2 d t ≤ a max i = 0 , 1 , 2 ‖ P i − D i ‖ 令 n = ‖ ∑ i = 0 3 P i u i , 3 ( t ) − ∑ i = 0 3 D i u i , 3 ( t ) ‖ 2 ，则 n = ( t 2 − 2 t 3 + t 4 ) ( ( 3 + 3 ) 2 400 − 3 5 + ( 3 − 3 ) 2 400 t 2 ) ， 从而 ε = 6 − 3 3 1400 a 7 − 2 − 3 200 a 6 + 27 250 a 5 − 126 + 3 3 400 a 4 − 19 100 a 3 m = a max t ∈ D = 3 + 8 60 a 当 a < 0 , ε < 0 ，当 0 < a < 1 , ε < m ，当 a > 1 , ε < m ，则得出两条曲线之间误差较小。 利用定理2中通过控制多边形几何特征条件求出的DP-PH曲线更逼近其控制多边形，具有更好的逼近效果。"
