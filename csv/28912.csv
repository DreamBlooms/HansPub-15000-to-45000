"质量良好的电能是电力设备正常运行的保障。本文介绍了基于LabVIEW的实时电能检测系统，在应用LabVIEW进行解析的前提下，设计出信号处理和数据分析能力的虚拟仪器检测装置，对实时采集的电压、电流参数可以通过专用模块准确显示。建立基于虚拟仪器的电能质量分析系统。 关键词 :LabVIEW，电能检测 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"物联网电能监测系统是基于物联网和互联网技术，由电能数据采集模块对各项电能数据进行收集，将收集到的数据传输到数据收集模块，由数据收集模块将收集到的电能进一步传输到互联网平台上，最后互联网平台将数据传输到设备终端电脑上，由监测中心完成数据的存储、分析处理，从而实现物联网的电能远程在线监测 [ 1 ] 。物联网电能监测系统能解决传统有线电能检测带来的弊端，并对电能进行实时监测，体现出降损节能的优势。"
"本项目使用具有RS485通讯协议的多功能电表完成对三相电压、电流以及功率因数的测量与计算机之间的通信。具体实现如下功能： 1) 对电网的电压、电流波形的实时采集； 2) 使用Labview中自带的算法实现对波形的谐波分析，计算功率因数； 3) 使用RS485串口，实现上传数据，并通过Labview，将检测的数据显示出来。检测平台能够对电能自动检测系统的测试状态进行控制。  本文设计的电能检测系统分为AD采集、Labview信号处理与数据上传三部分。电网电压、电流分别通过电压互感器和电流互感器接在各自的信号调理电路中，DSP通过对ADC芯片的时序控制完成对电流、电压的采样。采集的电压电流信号，通过RS485串口实现计算机终端的显示，如图1。 图1. 系统总体方案设计图"
"电压部分采用电阻分压的方式测量，测量范围为0~456 V，精确度为万分之五。电流部分采用元星零磁通电流互感器，测量范围为0~3.6 A，精确度等级为0.02级。A/D转换模块在整个电能质量监测系统中具有举足轻重的作用。如果A/D转换器的性能不能达到要求，将引起较大的测量误差，所以本监测装置采用TI公司08年推出的ADS1178，可以达到16位的数据采集精确度，带宽25 kHz，具有97 dB的信噪比和105 dB的总谐波失真，支持8路同时采样。同时对4路电压和4路电流信号进行采样，消除了信号由于采样问题而导致的相位延时，有效地降低了监测误差。STM32是具有ARM Cortex-M3内核的高性能低成本低功耗的嵌入式芯片，主要为A/D提供采样时钟以及将采集的数据加上UDP地址进行发送。设计框图如图2所示。 图2. 数据采集模块设计图  RS485兼容TTL电平，可以方便的与TTL电路相连。在电平转换的设计中，采用芯片HYM3085将UART串行接口输出的TTL电平转换成差分信号，使其可以与外部RS485设备进行通信。本项目对典型方法进行优化设计，将RS485中的使能信号与DI (数字输入信号)分别控制的方式简化为用DI代替使能控制信号 [ 2 ] 。 串口通信是一种广泛应用的通信方式，串口是计算机的基本接口，通常被称为RS232口或者COM口。可以通过设备管理器观察COM口的具体配置情况，最简单的串口通信仅仅需要3跟引线,即接地、发送和接收。进行串口通信之前，需要配置一些参数使得通信双方设置相同,从而可以实现通信,这些参数分别为： 1) 每秒传送的位数，例如4500表示每一秒传送的位数为4500个。 2) 数据位，指需要传送的真正内容，例如设为7，则每一帧数据中含有7位是真正需要发送的数据。 3) 停止位，串口通信时在每一帧的最后面加一个停止位表示本帧数据发送完毕，使得两台通信设备出现小的不同步时，能够自动校正。 4) 奇偶校验位，是用来验证收到的数据是否正确，具体来说是根据数据位0或者1的个数来决定校验位补1还是补0，奇校验时1的个数为奇数，偶校验时1的个数为偶数。 5) 流控制，指串口通信时使得发送与接收两端的协调的控制方式，也可以称作是两个通信端之间的握手。  1) 通讯的第一步是根据资源的名称打开USB设备连接通过VISA的写入函数来实现向连接的USB设备发送控制指令；通过VISA的读入函数实现USB设备数据传输。根据USB的传输协议，通过不同的端点来接收采集到的数据及发送或读取控制命令。 2) 串口信息的读取与LabVIEW程序设计底层的I/O软件同顶层应用软件之间是通过设备驱动程序作为中介联系在一起的。在本系统中驱动程序是直接采用N提供的VISA自动生成的，从而最终实现了LABVEW的USB通讯功能 [ 3 ] 。  对于三相电压有效值，需先根据电路理论知识原理，写出各个参数的算法，然后利用离散化方法推算出各个电参数在数字信号电路中的计算公式，最后在Labview中编程实现。 基本参数测量方法如下：  根据电路理论知识，电压、电流有效值的计算公式为： U = ∫ 0 T U 2 ( t ) d t T       I = ∫ 0 T i 2 ( t ) d t T 式中：T为周期，u(t)为瞬时电压值，i(t)为瞬时电流值，U为电压有效值，I为电流有效值。 上式是在输入模拟信号时，计算电压和电流有效值的公式。在数字电路中，计算机只能接收经过A/D转换以后的离散信号。对于莫属转换具体的实现方式是在一个周期T内，对信号采样N个点，每个采样点采样所得的电压、电流值记为u(n)和i(n)，则以离散采样表示的计算电压电流有效值计算公式为： U r m s = ∑ n = 1 N u 2 ( n ) N       I r m s = ∑ n = 1 N i 2 ( n ) N 式中：N = T/Δt，Δt是相邻两次采样之间的时间间隔 [ 4 ] 。 电压、电流等基本电参量是准确计算电压偏差电能质量标准中规定的指标基础和前提，因此需准确测量电能质量基本参数。  在输入连续信号时，单相有功功率的计算公式： P = 1 T ∫ 0 T u ( t ) i ( t ) d t 式中：P为有功功率，T为周期，u(t)为瞬时电压值，i(t)为瞬时电流值。 在测量离散信号时的功率理论同测量离散电流、电压，这里不再重复，同理得计算公式为： P = 1 N ∑ n = 1 N u ( n ) i (n)"
"LabVIEW可实现两大电能参数数据的显示：1、实现仪表数据的传输和显示2、模拟电路的传输和显示(通过正弦波模拟系统实现)。 以下为模拟电路中三相电能各参数的测试值。 三相电压和三相电流的实时采集前面板，如图3。 图3. 三相电压和三相电流的实时采集前面板 三相电流电压仿真信号程序框图，如图4。 三相电压电流有效值前面板，如图5。 有功功率测量前面板，如图6。 图4. 三相电流电压仿真信号程序框图 图5. 三相电压电流有效值前面板 图6. 有功功率测量前面板"
"传统的电能质量监测装置是以硬件为核心的，多数电能质量监测设备还停留在功能单一，操作复杂，需要大量人工参与的阶段，同时存在着体积较大、价格昂贵、可扩展性不高、升级困难等缺点，虚拟仪器在测控领域的广泛应用使得仪器的开发周期得以缩短，成本也大大降低，功能得到增强，基于虚拟仪器的产品可以不断升级或功能扩展，因此建立基于虚拟仪器的电能质量分析系统非常必要 [ 5 ] 。 本试验方法对电能质量测量实时性较好，能够实时的显示电能质量各参数的变化情况，同时能够对电能参数进行较系统的分析。"
