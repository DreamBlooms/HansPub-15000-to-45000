"针对孤岛微电网的优化调度问题进行研究，在考虑一般负荷作为可平移负荷，柴油机的治污成本和蓄电池放电循环损耗成本的基础上，采用以运行成本最低和负荷满意度最大为目标函数。通过对风电机组、光伏发电和微电网内重要负荷及一般负荷的日前预测，在满足系统供需平衡的前提下，记及蓄电池充放电功率及SOC范围、风电和光伏最大发电功率、柴油机最大最小发电功率等约束条件。采用混合整数线性优化方法对多目标日前优化调度模型进行求解。仿真结果表明采用该日前优化调度方法，可最小化蓄电池的使用量并充分发挥可再生能源的作用。 关键词 :微电网，日前优化，多目标优化函数，混合整数线性优化，可平移负荷 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"近年来，随着微电网技术的不断发展，如何正确管理微电网内部的分布式电源和储能的运行，实现微电网经济性和环境友好性成为重要的研究课题。环境友好性一般通过利用可再生能源发电来保证。经济性则通过微电网经济运行优化来实现 [ 1 ] 。微电网内部的控制方式、能源结构、分布式电源结构的多样性，决定了微电网安全稳定运行离不开完善的能量优化调度。微电网能量优化调度是在对分布式电源发电预测、负荷预测基础之上，充分发挥储能单元的重要作用，妥善管理微电网的能量流动，实现微电网经济效益最大化 [ 2 ] [ 3 ] [ 4 ] 。由于风、光等可再生能源在系统中的比重越来越大，它们所具有的随机性和间歇性特点给微电网的优化调度带来了极大的困难，使微电网的经济运行优化变成一个多目标、多变量、多约束的非线性问题。 当前国内外关于微电网的优化调度已进行了很多研究，主要研究内容包括优化问题的分析、优化目标的选择、约束条件的设定以及优化算法的选择这四个主要方面。优化问题分析主要根据优化对象的特征分析该优化调度属于静态优化还是动态优化。优化目标的制定分为单目标函数优化和多目标函数优化，目标函数可以选择经济、技术、环境某一指标或其集合。当前微电网优化调度研究大多集中在多目标函数优化。目标函数的制定要结合相应的约束条件，微电网优化调度的约束条件包括系统运行约束和设备出力约束。当前约束条件的设定大部分没有考虑优化调度与协调控制相统一的问题，也未考虑在优化调度过程中约束条件会随着微电网的拓扑结构、控制方式以及运行状态的改变而变化，因此可能无法达成系统真正的最优运行。优化调度模型的求解通常采用数学规划方法和智能算法进行求解。数学规划根据问题类型可分为线性规划和非线性规划。智能算法包括遗传算法、粒子群算法、模拟退火算法等，一般更为灵活通用，能解决各类非凸、非线性和不可导的数学优化问题，甚至对于无法用数学表达式表达的数学优化问题，只要掌握优化变量和优化结果的一一对应关系，即可从概率意义上找到问题的最优解。文献 [ 5 ] 对风力发电机、光伏阵列和柴油发电机三种分布式电源以及蓄电池构建了不同的模型，以经济性为目标，对微电网进行优化。蓄电池储能在运行时不直接产生运行费用，但其每一次充放电都会损耗使用寿命，文献 [ 6 ] [ 7 ] 通过实验详细分析了蓄电池充放电深度和充放电速率对其寿命的影响。就微电网优化时间尺度方面，微电网优化必须要对可再生能源的出力进行预测，预测的准确度和预测的时间尺度有直接联系，受到云层的影响，导致对光伏阵列的日前预测出力误差通常为20%左右 [ 8 ] ，短期预测出力的误差可以降低到10%。对优化目标的研究，如电能质量 [ 9 ] 、经济效益 [ 10 ] 、环境效益 [ 11 ] 等，提出了很多新颖的方法。最后，对于优化问题的求解，由于微电网优化是个多目标、多变量、多约束、非线性问题，文献 [ 12 ] [ 13 ] 的方法应用于单目标问题时都取得了很好的效果，应用于多目标问题时将每个目标赋予权重转换成单目标问题进行求解 [ 14 ] [ 15 ] 。现已有的粒子群算法、改进微分进化算法、细菌觅食算法等非线性智能算法进行求解。但是，运用智能算法求解微电网优化模型时，由于可再生能源发电出力以及负荷功率的随机性，所列出的等式约束实际上是难以满足要求的。 本文将针对含风光柴蓄的微电网系统建立日前经济优化调度模型，考虑到风光等新能源出力以及预测负荷的随机性，一般负荷作为可平移负荷，柴油机的治污成本和蓄电池放电循环损耗成本的基础上，采用以运行成本最低和负荷满意度最大为目标函数。通过对风电机组、光伏发电和微电网内重要负荷及一般负荷的日前预测，在满足系统供需平衡的前提下，记及蓄电池充放电功率及SOC范围、风电和光伏最大发电功率、柴油机最大最小发电功率等约束条件。本文第二部介绍了风光柴蓄微电网的结构和各部分成本模型；第三部分日前优化调度的目标函数和约束条件；第四部分在风电、光伏和负荷预测数据的基础上采用混合整数线性优化方法对多目标日前优化调度模型进行求解；最后一部分给出了本文的结论。"
"风光柴蓄微电网结构如图1所示，包括风力发电单元、光伏发电单元、柴油机发电单元、蓄电池、重要负荷和非重要负荷。  光伏出力模型为了实现光伏阵列最大功率点跟踪，满足光伏阵列工作在最大功率点，功率特性表达式为 P PV = P STC G AC [ 1 + k ( T C − T r ) ] / G STC (1) 式中： P PV 为输出功率； P STC 为标准测试条件下的最大测试功率， G AC 为光照强度， G STC 标准测试条件的光照强度，其值取1 kW/m 2 ，k为功率温度系数，其值为−0.0047/K， T C 为光伏阵列的实际工作温度； T r 为参考温度，取298.15 K。 约束条件：光伏阵列的实际输出功率最小为零，最大为对应光照强度和温度下的最大允许输出功率。费用方面，光伏阵列包括固定投资与维修费用。  风力发电机常见参数包含：切入风速、额定风速、切出风速和额定功率。对风力发电机进行建模： P WT = { 0                                       v ≤ v ci a v 3 − b P r           v ci < v ≤ v r P r                                 v r < v ≤ v co 0                                       v > v co (2) 图1. 典型微电网结构图 其中： P WT 为输出功率； v ci 为切入速度，m/s； v co 为切出速度，m/s； v co 为额定风速，m/s； P r 为额定输出功率，kW； a = P r / ( v r 3 − v ci 3 ) ， b = v ci 3 / ( v r 3 − v ci 3 ) 约束条件为：风力发电机的实际输出功率最小为零，最大为对应风速下的最大允许输出功率。可以表示为 0 < P WT < P max 。费用方面，风机包括固定投资与维修费用。  蓄电池充放电损耗按90%计算，出力模型需要满足的条件是，铅酸蓄电池每小时的最大充电电量和最大放电电量不能超过蓄电池额定容量0.2倍。蓄电池的放电深度不能太深，必须留有余量用于实时调度，故本文设定蓄电池在提前优化时最大放电深度为0.6，即 S O C ≥ 0.4 ，实际计算中，忽略蓄电池自放电。 蓄电池的运行损耗费用和放电深度有直接关系。蓄电池放电深度越深，最大循环次数越少，运行损耗费用越高。所以蓄电池的损耗费用可以表示如下： g ( s o c ) = ∫ S O C start S O C end ( 308.66 s o c 3 − 473.55 s o c 2 − 129.54 s o c + 307.99 ) d ( s o c ) (3) 式中：蓄电池的损耗与放电的初始和最后的荷电状态有关。并认为蓄电池损耗是由放电引起的，充电过程无损耗。  约束条件：柴油发电机运行时的最大输出功率不能超过额定功率，最小输出功率不能低于0.3倍额定功率。 柴油发电机损耗包括固定投资、维修费用、燃油费用和环境成本。 燃油费用计算： c o s t DG = k 1 c i + k 2 P DG-rated (4) 额定功率为30 kw时， k 1 = 0.52173 ， k 2 = 1.5252 ， c i 为发电量， P DG-rated1 为额定功率。 环境成本有两个部分构成：1) 消耗环境资源所带来的环境损失；2) 污染物排放的罚款。环境成本为0.0441065元/kw∙h。 综上，可以给出各设备单元费用总结如表1所示。"
"日前优化是等时间步长激发优化，将未来的一天划分为24个时间段，每个时间段1小时，提前一定时间对24个时间段各设备单元的出力情况进行计划；对微电网进行日前优化时，本文考虑了两个目标：一是微电网的运行费用最低。二是尽可能满足负荷需求，即负荷满意度最大。 如图1所示微电网，日前调度优化目标所指运行费用包含：微电网初始的固定投资费用、柴油发电机燃油费用与环境成本、各分布式电源运行维护费用、蓄电池运行损耗等。可以表示为： C O S T sum 1 = C O S T invest + C O S T PV + C O S T DG + C O S T WT + C O S T bat (5) C O S T invest 为所有设备的初始投资费用； C O S T PV , C O S T DG , C O S T WT , C O S T bat 分别为光伏、柴油发电机、风机、蓄电池的运行总费用。 负荷满意度体现了微电网中负荷日所需功率的满足程度大小。可以表示为 C O S T LOSS = A W LOSS 2 W a + W b + B W LOSS (6) W a + W b 表示总的需求电量， W a 为重要负荷， W a 为可中断负荷，系统必须保证重要负荷的供给，而可中断负荷如果无法完全满足，就会产生一定的赔偿，这里用(6)式来求解由于缺少电量 W LOSS 所引起的 Table 1 设备类型 风力发电机 光伏 柴油发电机 蓄电池 燃油费用(元) ------ ------ c o s t DG ------ 维护系数 0.0296 0.0096 0.0946 0.0832 环境成本(元/kw) ------ ------ 0.0441065 ------ 损耗(元) ------ ------ ------ g ( S O C ) 表1. 设备单元运行费用 费用损失。这里取 A = 10 ， B = 0.5 。 W LOSS 为总的需求电量与实际供给电量之差。  1) 对风机、光伏阵列的最大功率约束，需要满足约束条件 0 ≤ a i ≤ a ′ i ， 0 ≤ b i ≤ b ′ i (7) 这里 a i 和 b i 分别表示每时段风、光的出力， a ′ i , b ′ i 分别表示各自最大功率。 2) 柴油发电机功率约束 P Cimin ≤ P Ci ≤ P Cimax   or   P ci = 0 (8) 柴油发电机一般有最小运行功率限，因此柴油机运行时有最大和最小功率约束，停止运行时功率为零。 a i 表示每时段柴油发电机的出力。 3) 蓄电池充放电功率约束和SOC范围约束 − 0.2 E C ≤ e i ≤ 0.2 E C (9) 其中， E C 表示蓄电池的总容量， e i 表示每时段蓄电池的出力。 放电深度过大，会影响蓄电池的寿命，所以对蓄电池SOC约束 0.4 ≤ S O C i ≤ 1 (10) S O C i 为第i时段蓄电池组荷电状态。 4) 系统功率平衡约束 独立微电网系统在运行过程中需满足功率平衡： G i ≤ a i + b i + c i + e i ≤ S i (11) 其中， G i , S i 分别为每时段重要负荷和总负荷。  数学规划是应用数学的一个重要分支，根据问题类型可分为线性规划和非线性规划。线性规划方法能较容易地处理所求解问题之间的联系，这种方法必可以把优化问题表现的更为直观，目标函数和约束条件更为明确。使用线性规划方法需要对具有非线性特征的目标函数和约束条件做相应的线性化处理，这里用的是MATLAB中的混合整数线性优化方法正是线性规划的一种，针对于多目标求解，尤其这里针对新能源与负荷预测不确定性进行的调度，这种方法是一种行之有效的方法。"
"如图1所示结构，微网中包括风机六台、光伏四台、30 kW柴油发电机一台、总容量为96 kW∙h的铅酸蓄电池，普通负荷与重要负荷。表2和表3分别给出风机和光伏的参数。 Table 2 风力发电机 1号 2号 3号 4号 5号 6号 总计 切入风速(m/s) 4 4 3 3 3 3 — 额定风速(m/s) 12 12 10 10 8 8 — 切出风速(m/s) 24 24 25 24 20 20 — 额定功率(kW) 10 10 8 8 7 7 50 表2. 风机结构参数 优化过程如下： 1) 输入未来24个小时的预测温度 T i 、光强 P i 、风速 V i 、重要负荷 G i 、总负荷 S i 。 Table 3 光伏阵列 1号 2号 3号 4号 总计 额定功率 12 10 8 10 40 表3. 光伏阵列参数 图2. 温度和光照强度未来一天的预测曲线 图3. 风速未来一天的预测曲线 图4. 光伏24小时出力 通过预测数据(图2、图3)，可以得到风机和光伏每台每小时的最大出力，这里对光伏和风机均求其每时段的总和，用于统一调度，通过已知出力模型进行计算，得到光伏和风机的最大出力值。 四台光伏24小时的出力见图4、图5。 2) 输入目标函数与约束条件，可以归纳如下： 目 标 函 数 = f 1 + ∑ i = 1 24 ( a i ) ∗ M 1 + ∑ i = 1 24 ( b i ) ∗ M 2 + ∑ i = 1 24     c i ∗ ( M 3 + E 3 ) + ∑ i = 1 24 ( k 1 c i + k 2 P DG-rated ) + f soc + C O S T LOSS (12) 其中 C O S T LOSS = A W LOSS 2 S i + B W LOSS (14) 式中，f 1 表示每天的固定投资，初始投资费用150万元，再加上银行借款利率等，折算到每一天的固定投资为483元，M1~M4分别为风机、光伏、柴油发电机、蓄电池的维修系数，E3为环境成本对应系数，这些值在费用模型中已经给定， α , β , γ 的值决定设备单元充放电，具体参数设定如下： c i ≠ 0 时， k 2 =定值， c i = 0 时， k 2 = 0 ； e i ≥ 0 时， α = 0 ； e i < 0 时， α = 1 e i ≥ 0 时， β = 0 ； e i < 0 时， β = − 1 充电过程不计损耗，可以对此约束为： S O C i ≥ S O C i + 1 时， λ = − 1 ； S O C i < S O C i + 1 时， λ = 0 蓄电池初始电池容量： S O C 0 = 0.6 从用电方的角度进行考虑：用电方所必须承担的费用包括微电网的运行费用和电量不足引起的损失。 C O S T LOSS 是负荷不能完全供应引起的赔偿， W LOSS 表示缺电量，每一时间段的值均不同，与各个时间段的总负荷 S i 一一对应， W LOSS = S i − a i + b i + c i + e i 3) 运用混合整数线性优化方法对多目标问题求解，一是运行费用最低；二是负荷满意度最大。根据目标函数与约束条件，在给定范围内线性优化，得到费用最低时的解。这里已经将多目标转化为单一目标，总费用=运行费用+电量不足的损失。最后求得最优解为最终一天24小时的总费用为1302.8元，为日前优化的最优解，对算例进行分析： i) 对应表4和表5，可以总结出实际的出力总是介于该时段重要负荷和总负荷之间，也就是不可中断负荷的需求必须满足，在电量提供不充足时，可以适当选择让可中断负荷停止电量供给，如图6所示。 ii) 从前三个小时就可以观察到，当风光能源供应不足时，若蓄电池在满足其出力约束和SOC剩余约束的情况下，让蓄电池供电，若蓄电池输出功率最大，仍旧不能满足负荷需求，就将启动柴油发电机供电，柴油发电机24小时供电情况如图7所示。 24小时内，柴油发电机尽量不投入使用，因为其较其它供电单元的投资成本更多，可是若不满足重要负荷或者缺电损耗太大，柴油发电机就要供电了。 图5. 风机24小时出力 Table 4 时间 温度(℃) 光照强度(kW/m 2 ) 风速(m/s) 总负荷(kW) 重点负荷(kW) 0:00~1:00 13.9 0 4.05 23.9 15.2 1:00~2:00 12.1 0 5.16 19.8 12.4 2:00~3:00 11.5 0 4.92 16.9 12.6 3:00~4:00 11.3 0 6.71 13.8 8.6 4:00~5:00 12.7 0 7.88 11.6 8.5 5:00~6:00 13.4 0 7.3 11.1 8.4 6:00~7:00 13.2 0 7.87 18.9 13.7 7:00~8:00 14.2 0.004 7.6 31.4 20.5 8:00~9:00 14.4 0.1406 10.3 60 50 9:00~10:00 16.8 0.3899 6.28 35 20.5 10:00~11:00 17.3 0.7029 10.42 83 70 11:00~12:00 17.8 0.8345 9.29 74.9 40.2 12:00~13:00 18.8 1.044 7.63 65.4 39.9 13:00~14:00 20.9 0.7673 8.65 60.2 35.4 14:00~15:00 20.1 0.9872 7.27 75.1 37.7 15:00~16:00 20.7 0.7392 3.75 60.9 33.8 16:00~17:00 20.3 0.4633 4.15 48.3 31.1 17:00~18:00 20.2 0.2378 4.52 46.9 32.9 18:00~19:00 18.5 0.0259 3.48 40 31 19:00~20:00 16.3 0 3.17 40 30 20:00~21:00 16.2 0 2.9 30 21 21:00~22:00 15.2 0 2.44 30 20 22:00~23:00 14.2 0 4.41 38 15 23:00~24:00 14.6 0 3.59 29.5 14.8 表4. 未来一天预测数据 Table 5 时间 风机出力(kW) 光伏出力(kW) 柴油发电机(kW) 蓄电池(kW) 实际出力(kW) 投资费用(元) 0:00~1:00 1.8158 0 21 −0.2 23.0158 81.4150 1:00~2:00 5.8837 0 0 −13.2 19.0837 46.3180 2:00~3:00 4.8350 0 11 −0.2 16.0350 75.3700 3:00~4:00 15.3272 0 0 1.8 13.5272 20.7520 4:00~5:00 26.0588 0 0 14.8 11.2588 21.2430 5:00~6:00 20.3094 0 0 9.8 10.5094 21.8390 6:00~7:00 25.9521 0 0 7.8 18.1521 22.0300 7:00~8:00 23.1735 0.1681 0 −7.2 30.5417 29.5080 8:00~9:00 60.6526 5.9042 0 6.8 59.7568 22.0033 9:00~10:00 12.2063 16.1971 0 −6.2 34.6034 27.7980 10:00~11:00 62.8677 29.1335 0 9.8 82.2012 22.7710 11:00~12:00 43.9719 34.5096 0 3.8 74.6815 21.7610 12:00~13:00 23.4727 42.9769 0 1.8 64.6496 21.7410 13:00~14:00 35.1117 31.2843 0 6.8 59.5951 21.8240 14:00~15:00 20.0356 40.3974 0 −14.2 74.6330 32.6070 15:00~16:00 1.1661 30.1656 29 −0.2 60.5316 85.7020 16:00~17:00 2.1049 18.9414 27 −0.2 48.2463 84.0810 17:00~18:00 3.3015 9.7266 30 −3.2 46.2281 90.1610 18:00~19:00 0.6862 1.0676 30 −7.2 38.9538 97.2000 19:00~20:00 0.2200 0 30 −9.2 39.4200 102.9200 20:00~21:00 0 0 29 −0.2 29.2000 86.3600 21:00~22:00 0 0 29 −0.2 29.2000 86.3620 22:00~23:00 2.9243 0 30 −4.2 37.1243 95.8490 23:00~24:00 0.8730 0 28 −0.2 29.0730 85.1300 表5. 算例最终的优化解 图6. 微网中24小时的总负荷与重要负荷 图7. 微网中24小时柴油发电机出力 iii) 这里可以考虑改变蓄电池的容量，算例优化结果表明，微电网中蓄电池容量至关重要，这里是限 制蓄电池一次充放电功率不能超过0.2倍的蓄电池额定容量，即19.2 kW，这种限制是很有必要的，因为考虑到蓄电池使用寿命，且留有一定容量以备实时调度，若容量选择不够大，将导致风光的弃用，对能源造成很大浪费。我们可以猜想，如果将蓄电池容量增大两倍甚至三倍，相对于这个算例，再综合考虑各部分的成本花费情况，可能会得到更加理想的结果。 通过优化结果中各设备出力的讨论，验证了所述方法对多目标多约束的不确定性优化问题求解的快速有效性。"
"本文利用混合整数线性优化方法来进行日前优化调度研究，在考虑一般负荷作为可平移负荷，柴油机的治污成本和蓄电池放电循环损耗成本的基础上，采用以运行成本最低和负荷满意度最大为目标函数。通过对风电机组、光伏发电和微电网内重要负荷及一般负荷的日前预测，在满足系统供需平衡的前提下，记及蓄电池充放电功率及SOC范围、风电和光伏最大发电功率、柴油机最大最小发电功率等约束条件。仿真结果表明采用该日前优化调度方法，可最小化蓄电池的使用量并充分发挥可再生能源的作用。"
