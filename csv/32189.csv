"采用变状态空间增量逐次逼近轮库迭代动态规划优化方法，根据沅水梯级水库电站水资源侧、电源侧的目标层及动态约束条件实际，通过水库电站层、机组层、设备运行层的组合约束条件结构，对三板溪、白市、托口等沅水流域梯级水库电站，选取具有丰、平、枯典型代表的来水年组进行中长期联合优化计算，实现梯级水库电站优化调度应用，与实际运行进行指标比较，验证沅水流域梯级优化调度研究的应用价值。在沅水流域梯级水库优化调度研究中，进一步对梯级水库水力联系中的调度对象目标，构建算法组合计算模型、配置约束条件与目标相互转化要素，有效结合径流预报、优化调度、厂内机组设备高效率区调控经济运行，拓展长中短期优化调度应用。 关键词 :沅水，梯级水库，优化调度，动态约束条件 Copyright © 2019 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"在水库优化调度中，单库静态约束条件及算法的局部改进，作为单目标水库优化调度理论模型与评估计算分析，以往在一些场景中常有研究。应用上，水情预测精度、防洪调度要求、发电方式安排、设备检修要求、电网断面潮流等多因素的不确定性，使优化调度为调度评估分析决策仅提供运行指导，给水库调度计划编制提供一定的参考。效果上，对优化调度与科学调度、精细调度、实时调度的要求，还有较大的潜力可以挖掘。 近年来，水库优化调度在流域梯级多库型联合、复杂动态约束条件、约束条件与目标相互转化的多态混合目标，算法及性能方面改进优化 [ 1 ] ，多种优化方式结合的流域梯级库群理论模型，向目标多态、约束条件动态调控的广度与深度应用上探索。随着大数据技术的应用，深度挖掘利用气象、水情测报及综合数据，与传统调度理论模型和实际经验相结合，水库优化调度的智能化和实用价值化程度越来越高。 五凌电力在沅水流域干流上有三板溪、挂治、白市、托口、洪江、五强溪、凌津滩，支流酉水上有碗米坡，共8座梯级水电站。梯级水电站分布在不同省份，沅水干流和支流酉水上还有其它投资主体电站，存在多调度主体和市场竞争。梯级电站间河道滞流时间长，沅水上游三板溪、白市、托口3座水电站与黔东火电厂共352万千瓦装机容量经500 kV同一通道最大限额为210万千瓦从湘西电网送出，各电站发电出力调度边界和电力市场环境约束条件复杂动态多变 [ 2 ] 。沅水流域梯级水库调度自动化系统投运较早，为优化调度提供了基础条件。 在沅水流域梯级优化调度 [ 3 ] 中，结合采用变状态空间增量轮库逐次逼近迭代动态规划优化方法 [ 4 ] [ 5 ] [ 6 ] ，具有很好的算法效率、稳定及目标求解收敛性的特点，在具体计算时，结合水库二次函数特征曲线成果以进一步简化计算。"
"约束条件是寻优计算过程的边界条件，在优化调度实际计算过程中，由于不同调度对象和调度期内约束条件复杂动态多变，需要提供配置约束条件，进行人工干预调度边界参数，自定义约束条件，及约束条件计算参数实时修正管理功能，使调度函数及调度规则具有多态适应性。考虑运行机组和检修机组利用状况，也需要人工对机组台数进行干预，以适应临检需求。在具体求解过程中，根据约束条件和目标特性的相互转化，使呈现出约束条件的动态性和求解目标的多态性。 沅水流域梯级水库优化调度主要目标约束条件见表1。表中目标层为水资源、电源等的计算期内最小或最大总目标，水库电站约束层基本对应于流域梯级水库电站的上网、市场等接口，机组约束层基本对应于电站机组特性要求，设备运行约束层基本对应于机组设备运行下的条件因素。 Table 1 资源侧 电源侧 目标层 1) 计算期末库水位 2) 沅水流域面总降雨量 3) 下泄总水量 4) 平均水头 1) 计算期内总效益及目标电量 2) 计算期内市场需求合同电量 3) 应急交易总电量 4) 平均发电耗水率 水库、电站约束层 1) 计算期初库水位 2) 水库上、下限正常蓄水位 3) 水库汛限水位 4) 水库区间径流总量 5) 水库时段运行上游水位限制 6) 水库运行上、下游水位时段变幅 7) 水库航运、生态保证供水流量 8) 水库下泄限制流量 9) 水库区间水流时滞 1) 三、白、托、黔东四厂及湘西电网通道送出限制 2) 电站上网断面负荷平衡 3) 不同电厂合同价 4) 应急交易电价 5) 电站最大/最小出力 6) 电站出力平衡 7) 水电、火电出力平衡 8) 电站旋转备用容量 9) 厂用电量 机组约束层 1) 机组最小/最大过水流量 2) 定负荷方式机组流量 3) 定流量方式流量 4) 定流量方式流量平衡 1) 机组最大/最小出力 2) 定流量方式出力 3) 定负荷方式机组出力 4) 定负荷方式机组出力平衡 5) 综合出力系数 设备运行约束层 1) 机组工况上游水位 2) 机组工况水头 3) 机组段工况水头出力 4) 机组工作流量 5) 机组超低水头 1) 机组运行时段条件下的电价 2) 机组运行汽蚀振动区 3) 机组运行最小开停机时限、启停次序 4) 机组运行工况水头、机组设备可调出力 5) 机组检修性约束 表1. 沅水流域梯级水库目标组合约束条件"
"梯级电站优化调度以单一水电站为计算单元，采用变状态空间增量动态规划与轮库逐次逼近迭代相结合求解梯级水电站的联合优化调度，计算步骤如下： 1) 根据入库径流过程在水库容许变化范围，拟定每一个水库一条反映水头最优利用，符合初始、终了约束条件的初始可行最优近似调度轨迹线位置 Z i , t 0 ，( i = 1 , 2 , ⋯ , n 水 库 ;   t = 1 , 2 , ⋯ , T 调 度 期 ) [ 7 ] 。 2) 固定 Z k , t 0 ( k = 1 , 2 , ⋯ , i − 1 , i + 1 , ⋯ , n ; t = 1 , 2 , ⋯ , T )，计算 Z i , t ∗ ，依下列过程得到每一个水库最优调度线 Z 1 , t ∗ , Z 2 , t ∗ , ⋯ , Z n , t ∗ 。 3) 对第i个水库，以初始可行调度线为中心，在其上下取初始水位增量步长ΔZ，形成若干个离散值的策略廊道。在约束条件下，对廊道范围内进行状态空间离散，形成第i个电站ΔZ廊道范围状态库容第j个状态变量 V i , j ( j = 1 , 2 , ⋯ , Z Δ Z ) 。 4) 在策略廊道状态空间V i ,j 范围内，利用增量动态规划方法顺时序向后递推求解 Z i , t ∗ 。 5) 如果 | Z i , t ∗ − Z i , t 0 | > ε ，则令 Z i , t 0 = Z i , t ∗ ( t = 1 , 2 , ⋯ , T ) ，以所求调度线作为初始调度线，缩短步长ΔZ至ΔZ’，回步骤3)继续进行优化计算。 6) 如果 | Z i , t ∗ − Z i , t 0 | < ε ，对于所选廊道步长已不能增优，步长ΔZ满足精度要求，得最优调度线 Z i , t ∗ 。 计算模型如图1所示。 图1. 变状态空间增量轮库逐次逼近迭代动态规划优化计算模型图  以沅水流域三板溪、白市、托口电站联合优化调度出力计算为例。用二次多项式拟合各库库容曲线、尾水位流量曲线、耗水率曲线等特征曲线，所有拟合均采用Y =Ax 2 + Bx + C的形式。对库容曲线，Y为水位，单位为m，A、B、C为库容系数，单位为10 6 m 3 。对尾水位流量曲线，Y为尾水位，单位为m，A、B、C为出库流量系数，单位为m 3 /s。对耗水率曲线，Y为单耗，单位为m 3 /kWh，A、B、C为水头系数，单位为m。各库特征曲线A、B、C系数见表2。 Table 2 水库特征曲线 水库(电站)名称 参数A 参数B 参数C 库容曲线 三板溪 −0.0000032573 0.034621 390.5577 白市 −0.0000221402 0.058967 271.8157 托口 −0.0000092985 0.041929 212.1888 尾水位流量曲线 三板溪 −0.0000002469 0.003380 318.6055 白市 −0.0000001558 0.002268 247.2962 托口 −0.0000001029 0.002099 188.9831 耗水率曲线 三板溪 0.0001122107 −0.058494 8.991061 白市 0.0020673077 −0.307666 18.307849 托口 0.0026689723 −0.414815 22.401232 表2. 水库电站特征曲线参数表 1) 梯级水库间水力联系 I i , t = q i , t + ∑ i 1 = 0 n 1 Q i 1 , t i 1 (1) 式中：I i ,t 为第i个电站在t时段的入库流量，q i ,t 为第i个电站在t 时段的区间径流， ∑ i 1 = 0 n 1 Q i 1 , t i 1 为第i个电站的上游电站出库总流量，t i 1 为上游第i1个电站到第i个电站的水流时滞 [ 8 ] ，n1为第i个电站上游电站个数。梯级水库间联系见表3。 Table 3 水库(电站) 三板溪 白市 托口 三板溪 −1 0 0 白市 1 0 0 托口 0 1 −2 表3. 梯级水库(电站)间的水力联系 从横向看，1表示该库的上游，从纵向看，1表示该库的下游。0表示不是直接上、下游关系。−1表示参加优化调度计算最上级电站，−2表示优化调度计算最末级电站。 2) 出库流量计算 X i , t = q i , t + J i , t (2) 式中：X i ,t 为第i个水库在t时段出库流量，通过该库尾水位流量曲线求得；q i ,t 为第i个水库在t时段发电用水量；J i ,t 为第i个水库在t时段弃水量。"
"在沅水流域梯级水库优化调度中，构建如下应用功能和优化计算： 1) 调度对象目标模型优化。根据梯级水库群调度目标函数及约束关系，对调度对象及调度期，灵活选取评价对比指标，通过动态规划及其改进、启发式搜索遗传GA等多种优化算法进行模型稳定性评估和优化方案比较 [ 9 ] 。调度对象可选择单库、梯级和水库群。梯级关系根据水库网络拓扑结构图梯级电站水力联系生成。 2) 边界约束条件结构化。对详细边界和约束条件，电网断面送出限制特性、库型特性、电站设备运行特性、综合特性等复杂约束条件进行结构性、计算目标性模型化，并用工具进行灵活配置。 3) 发电调度计划编制。根据优化模型制定未来一段时期水电站群发电优化调度计划，满足各电站电量和调度计划运行指导需求。根据负荷和水情需求变化向前滚动计算，对优化调度线不断进行修正。 4) 长期联合优化计算。以选取2017年1月~2019年6月典型代表沅水流域来水年组长期优化计算为例，2017平水年，2018枯水年，2019年为历史丰水年，采用变状态空间增量轮库逐次逼近迭代动态规划优化计算模型方法，对三板溪、白市、托口三个梯级电站联合优化调度出力计算，优化调度计算总发电量156.81亿kWh，比实际151.22增加5.59亿kWh，年发电量提高3.7%，优化指标对比 [ 10 ] 见表4。 Table 4 指标对比 三板溪电站 白市电站 托口电站 梯级电站 发电量/(亿kWh) 2017年 实际 26.66 12.51 22.08 61.25 优化 26.99 13.39 23.34 63.72 2018年 实际 20.06 10.23 15.79 46.08 优化 22.02 10.47 17.56 50.05 2019年1~6月 实际 17.68 9.52 16.69 43.89 优化 17.61 9.08 16.28 42.97 平均出力/(万kW) 2017年 实际 30.4 14.2 25.3 70.89 优化 31.24 15.5 27.02 73.75 2018年 实际 23.00 11.70 18.10 53.33 优化 25.49 12.12 20.32 57.93 2019年1~6月 实际 40.8 21.9 38.5 101.60 优化 40.76 21.03 37.69 99.47 平均水头/(m) 2017年 实际 134.65 48.83 56.14 88.82 优化 145.24 50.51 58.39 93.52 2018年 实际 132.83 49.05 55.82 87.84 优化 145.11 50.51 58.75 95.02 2019年1~6月 实际 130.66 47.72 54.71 83.79 优化 148.03 50.11 58.06 93.25 平均单耗/(m 3 /kWh) 2017年 实际 2.95 8.18 7.46 5.64 优化 2.87 8.05 7.30 5.58 2018年 实际 3.11 8.17 7.96 5.90 优化 2.87 8.05 7.25 5.49 2019年1~6月 实际 3.06 8.46 7.57 5.95 优化 2.79 8.09 7.33 5.63 表4. 三板溪、白市、托口梯级电站2017年1月~2019年6月联合优化调度出力计算指标对比 其中三板溪电站2017年1月~2019年6月梯级联调优化调度见图2。 图2. 三板溪电站2017年1月~2019年6月联调优化过程 5) 中长期联合优化计算。三板溪、白市、托口电站2018年三个电站联合调度优化调度计算总发电量50.93亿kWh，比实际46.08增加4.85亿kWh，年发电量提高10.53%，优化指标对比见表5。 Table 5 指标对比 三板溪电站 白市电站 托口电站 梯级电站 发电量/(亿kWh) 实际 20.06 10.23 15.79 46.08 优化 22.65 10.65 17.63 50.93 平均出力/(万kW) 实际 23.00 11.70 18.10 52.8 优化 26.22 12.34 20.41 58.97 平均水头/(m) 实际 132.83 49.05 55.82 87.84 优化 145.37 50.26 58.21 95.31 平均单耗/(m 3 /kWh) 实际 3.11 8.17 7.96 5.90 优化 2.87 8.07 7.31 5.49 表5. 三板溪–白市–托口梯级电站2018年联合优化调度出力计算指标对比 三板溪电站2018年梯级联调优化调度见图3。 图3. 三板溪电站2018年联调优化过程 6) 提高调度实用价值性。融合长、中、短期调度模型构建，将较长时期内的沅水流域梯级优化经济运行计算分配到较短时段，制定出各电站短期优化运行方式，确定短期内电站逐日负荷分配，再通过厂内经济运行 [ 11 ] 实时调度方式，把相应负荷要求分配落实到机组小时，进行实时调度。"
"沅水流域梯级水库优化调度研究，通过分析沅水流域梯级水库调度目标和约束条件特性，着力从目标、模型、约束条件、方法组合等方面对应用求解。在算法应用实施中，采用变状态空间增量轮库逐次逼近迭代动态规划优化计算模型方法，适应约束条件水资源和电源侧的计算目标层、水库电站约束层、机组约束层、设备运行约束层的复杂动态多态性要求，根据长系列历史数据给出优化实施运行应用效果。模型方法嵌入水库调度自动化系统运行，支持优化计算、分析，对优化调度目标模型进行评估，实现梯级库群调度在线应用，为调度人员提供及时连续的决策依据。"
