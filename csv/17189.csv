"本文设计了一种新型数字气量表，该装置基于单片机和涡轮流量传感器对气罐剩余气量的间接测量，实现了CNG气罐剩余气量的实时显示。为驾驶员实时掌握气耗提供了准确数据依据。 关键词 :单片机，涡轮流量传感器，液晶显示"
"随着国家对清洁燃料的大力推广，CNG加气站等基础设施的广泛铺设，越来越多的CNG燃料汽车出现在人们的视野中。汽车燃气计量也引起了相关部门的重视和驾驶者的关注，但是由于没有可以精确显示燃气量的计量装置而无法落实管理。尤其在出租车行业，由于没有可以精确显示CNG气罐剩余气量的仪表，昼夜交班前都是以满罐为基准，导致加气站在固定时间加气车辆猛增，排队时间较长，给司机和乘客都造成不便。因此，本文设计了一种数字气量表，采用了涡轮传感器对CNG气罐进出流量进行计量作差，实现了对汽车剩余气量的实时监测，便于考核汽车的经济指标，而且给出租车行业昼夜交班带来极大便利，一定程度上能够解决出租车行业聚集加气的情况。"
"硬件系统包括2个传感器信号输入模块、单片机控制模块、数据储存模块、液晶显示模块、面板按键模块和汽车电源供电模块 [ 1 ] [ 2 ] 。系统框架图如图1所示。 系统软件包括信号测量模块、单片机和液晶显示的初始化设置模块、液晶的写数据/命令模块、流量计算模块、数据储存和数据显示模块，还有定时器的中断模块 [ 3 ] - [ 5 ] 。  系统能够实现实时显示CNG气罐剩余气量的功能。单片机通过对分别安装在进气管道和出气管道上的涡轮传感器上的脉冲个数进行采集，然后通过计算，得出进气量和出气量，再进行作差处理，便得到了气罐中的剩余气量，所得的数据采用 总线，通过 来储存，并通过液晶显示模块实时显示出来。设计中面板上有一个清零/复位按键，短按为复位键，长按5 s为清零。信号经采集后须通过整形放大处理，再传送给单片机进行计算。 图1. 硬件系统结构图"
"结合软件方案设计硬件系统，尽可能的简化硬件结构，减小硬件系统的复杂性。  流体流经传感器壳体，由于叶轮的叶片与流向有一定的角度，流体的冲力使叶片具有转动力矩，克服摩擦力矩和流体阻力之后叶片旋转，在力矩平衡后转速稳定，在一定的条件下，转速与流速成正比，由于叶片有导磁性，它处于信号检测器(由永久磁钢和线圈组成)的磁场中，旋转的叶片切割磁力线，周期性的改变着线圈的磁通量，从而使线圈两端感应出电脉冲信号，此信号经过放大器的放大整形，形成有一定幅度的连续的矩形脉冲波，可远传至显示仪表，显示出流体的瞬时流量和累计量 [ 6 ] 。 在一定的流量范围内，脉冲频率f与流经传感器的流体的瞬时流量Q成正比，流量方程为： (1) 式中： f——脉冲频率[Hz]； k——传感器的仪表系数[ ]； Q——流体的瞬时流量(工作状态下) [ ]； 每台传感器的仪表系数由制造厂填写在检定证书中，k值设入配套的设备中，便可计算出瞬时流量和累积总量。  本系统选用STC89C52作为处理芯片。AT89C2051是美国ATMEL公司生产的低电压，高性能CMOS 8位单片机。具有8 k字节Flash，512字节RAM，32位I/O口线，看门狗定时器，内置4 KB EEPROM，MAX810复位电路，三个16位定时器/计数器，一个6向量2级中断结构和全双工串行口。本系统中主要用到了芯片的2个定时器和它的P1，P2端口。  数据存储选用了 总线的 存储器AT24C02。AT24C02是低工作电压的2 K位串行电可擦除只读存储器，内部组织为256个字节，每个字节8位。在其SCL输入时钟信号的上升沿将数据送入 器件，并在时钟的下降沿将数据读出。SDA引脚可实现双向串行数据传输，该引脚为开漏输出，需要连接上拉电阻。将剩余气量数据保存在AT24C02中，可保证断电不丢失。数据储存模块和单片机的接口电路如图2所示。  显示部分选用了一块1602液晶，满足需求，简单方便。所用1602液晶为5 V电压驱动，带背光，可显示两行，每行16个字符，内置含128个字符的ASCII字符集字库，使用并行接口。该部分和单片机的接口电路如图2所示。 需要说明的是，真正投入使用的显示模块需要根据车辆生产厂家对仪表界面的要求去液晶厂家定制。"
"系统软件设计应遵循自顶向下逐步细化的设计方法，各个模块尽量保持独立，便于调试和修改。主程序流程图如图3所示。 图2. 单片机与液晶显示模块接口电路 图3. 主程序流程图"
"介绍了一种基于单片机STC89C52的数字式气量表的设计方法。设计中采用了涡轮流量传感器，其具有测量精度高、重复性小、体积小、质量轻、输出数字脉冲且维修方便等优点。作者设计的数字式气量表能够满足各方面的显示要求，能够实时显示CNG气罐剩余气量，为驾驶员实时掌握气耗和出租行业昼夜交班管理提供了准确可靠的数据依据。"
