"曲线细分是曲线造型的有力工具。采用添加差分形式的偏移量是构造细分格式的一种重要方法。本文讨论了采用高阶中心差分形式的偏移量所能够构造的细分格式求和规则的最高阶数问题。 关键词 :细分格式，求和规则，偏移量，高阶中心差分 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"曲线细分是一种从初始控制多边得到光滑曲线的迭代格式。通过迭代可以设计出合适的曲线，光滑度较高，因而得到了广泛应用。 近年来，采用通过添加偏移量的形式构造新的细分格式吸引了众多学者的注意 [ 1 ] [ 2 ] [ 3 ] [ 4 ] 。偏移量是组合系数和为零的同层的相邻几个顶点的线性组合。在已有细分迭代规则的基础上加上偏移量做调整，既可以从逼近型细分构造插值型细分 [ 1 ] [ 2 ] [ 3 ] ，又可以从插值型细分构造逼近型细分 [ 4 ] 。上述工作局限于单个细分格式，没有从理论上对这种方法进行探讨。Luo等 [ 5 ] 指出添加偏移量的操作对应的是在原细分生成函数基础上加上一个Laurent多项式。求和规则是细分的基本性质 [ 6 ] [ 7 ] [ 8 ] ，亓万锋等 [ 8 ] 分析了采用二阶中心差分形式的偏移量所能达到的最高阶求和规则的问题。本文将 [ 8 ] 的结论推广，考虑了高阶中心差分是否能够达到最高阶求和规则的问题。"
"细分格式是从给定的初始控制顶点集 P 0 = { p i 0 ∈ ℝ d } i ∈ ℤ 和一个正整数m，利用有限个数 a = { a i } i ∈ ℤ ∈ l 0 ( ℤ ) ， l 0 ( ℤ ) 代表 ℤ 上支撑有限的序列的集合，通过迭代格式 p i k = ∑ j ∈ ℤ a i − m j p j k − 1 ,     i ∈ ℤ ,   k = 1 , 2 , ⋯ (1) 迭代k次后得到控制顶点集合 P k = { p i k ∈ ℝ d } i ∈ ℤ 的一种造型方法，其中 m 称为重数， a = { a i } i ∈ ℤ 称为细分掩模，对应的Laurent多项式 a ˜ ( z ) = ∑ i ∈ ℤ a i z i ， z ∈ ( ℂ \ { 0 } ) 称为细分生成函数 [ 8 ] 。 给定m重细分掩模 a = { a i } i ∈ ℤ ∈ l 0 ( ℤ ) ，记 supp     a = { i ∈ ℤ , a i ≠ 0 } 。在实际应用中，往往使用对称的生成函数即细分掩模满足 a i = a − i , i ∈ ℤ ，显然生成函数是对称的当且仅当 a ˜ ( z ) = a ˜ ( z − 1 ) 。长度为s的列向量 v = ( v 1 , v 2 , ⋯ , v s ) T 称为中心对称的，如果满足 v i = v s + 1 − i , i = 1 , ⋯ , s 。显然对称的生成函数的系数组成的列向量是中心对称向量。 细分格式可以分为插值型和逼近型两种格式，插值型细分每次迭代时保留上一次的控制顶点，其细分掩模满足 a m i = δ i 。若细分格式不是插值型的，则称为逼近型细分。 称m重细分格式 a ˜ ( z ) 满足k阶求和规则，如果 a ˜ ( 1 ) = m 且 a ˜ ( z ) 含有因式 ( 1 + z + ⋯ + z m − 1 ) k 。易见当 a ˜ ( z ) 满足一阶求和规则时，有 ∑ i a m i = ∑ i a m i + l = 1 , 0 ≤ l < m 成立。"
"在这一节里，我们讨论添加偏移量是2n阶中心差分时，所构造的细分格式能否达到最高阶求和规则的问题。 给定第 k − 1 层上的控制顶点集合 P k − 1 = { p j k − 1 ∈ ℝ d } j ∈ ℤ ，在顶点 p j k − 1 处的2n阶中心差分是 δ 2 n p j k − 1 = ∑ i = 0 2 n ( − 1 ) i ( 2 n i ) p j + n − i k − 1 例如在 p j k − 1 处的二阶中心差分是 δ 2 p j k − 1 = p j − 1 k − 1 − 2 p j k − 1 + p j + 1 k − 1 ，四阶中心差分是 δ 4 p j k − 1 = p j − 2 k − 1 − 4 p j − 1 k − 1 + 6 p j k − 1 − 4 p j + 1 k − 1 + p j + 2 k − 1 。 添加偏移量的方法是在原细分格式的基础上添加偏移量。在给定原细分格式 p m i + l k = ∑ j ∈ ℤ   a m i + l − m j p j k − 1 ,     i ∈ ℤ ,   l = 0 , 1 , ⋯ , m − 1 的顶点 p m i + l k 处添加2n阶中心差分 ∑ j ∈ ℤ c m i + l − m j δ 2 n p j k − 1 ，即 p m i + l k = ∑ j ∈ ℤ a m i + l − m j p j k − 1 + ∑ j ∈ ℤ c m i + l − m j δ 2 n p j k − 1 相应的生成函数变为原生成函数加上对应偏移量的Laurent多项式 d ˜ ( z ) = ∑ l = 0 m − 1 ∑ j ∈ ℤ c m i + l − m j z m i + l − m j − m n ( 1 − z m ) 2 n 。 (2) 下面我们分析 d ˜ ( z ) 在满足限定条件时，所含自由系数的个数。 引理3.1若对称的Laurent多项式 d ˜ ( z ) = ∑ l = 0 m − 1 ∑ j ∈ ℤ c m i + l − m j z m i + l − m j − m n ( 1 − z m ) 2 n 的最高幂次是r，则 d ˜ ( z ) 中自由系数个数是 r − n m + 1 。 证： d ˜ ( z ) = ∑ l = 0 m − 1 ∑ j ∈ ℤ   c m i + l − m j z m i + l − m j − m n ( 1 − z m ) 2 n = ∑ l = 0 m − 1 ∑ j ∈ ℤ   c m i + l − m j z m i + l − m j − m n ( 1 − z ) 2 n ( 1 + z + ⋯ + z m − 1 ) 2 n = z − m n ( 1 − z ) 2 n ( 1 + z + ⋯ + z m − 1 ) 2 n ∑ l = 0 m − 1 ∑ j ∈ ℤ   c m i + l − m j z m i + l − m j 。 因为 d ˜ ( z ) 和 z − m n ( 1 − z ) 2 n ( 1 + z + ⋯ + z m − 1 ) 2 n 是对称的Laurent多项式，所以 ∑ l = 0 m − 1 ∑ j ∈ ℤ c m i + l − m j z m i + l − m j 也 是对称的Laurent多项式。注意到 d ˜ ( z ) 的最高次数是 m i + l − m j 的最大值与 n m 的和。因此当限制 d ˜ ( z ) 的最高次数是r时，此时 c m i + l − m j 中下标 m i + l − m j 的最大值是 r − n m 。因此， d ˜ ( z ) 具有的自由系数个数是 r − n m + 1 。证毕。 由引理3.1可知，当给定m重的细分生成函数 a ˜ ( z ) 后，如果限定 d ˜ ( z ) 的最高幂次是r，则组成 d ˜ ( z ) 的中心差分的阶数应小于等于2r/m。 下面的定理给出了当采用中心差分形式的偏移量能够达到最高阶求和规则的 a ˜ ( z ) 的形式。 定理3.2若限定m重对称的细分掩模 a ˜ ( z ) 和2n阶中心差分形式的偏移量 d ˜ ( z ) 的最高幂次是r，且 a ˜ ( z ) + d ˜ ( z ) 能具有支撑在 [ − r , r ] 上生成函数的最高阶求和规则，则 a ˜ ( z ) 至少具有2n阶求和规则。设 b ˜ ( z ) 是支撑在 [ − r , r ] 的对称生成函数中求和规则最高，则 a ˜ ( z ) 具有形式 a ˜ ( z ) = b ˜ ( z ) − z − m n ( 1 − z ) 2 n ( 1 + z + ⋯ + z m − 1 ) 2 n ∑ l = 0 m − 1 ∑ j ∈ ℤ c m i + l − m j z m i + l − m j ，系数 { c m i + l − m j , j ∈ ℤ } 自由的个数为 r − n m + 1 。 证：根据文献 [ 8 ] 中的定理2.1，在 [ − r , r ] 上存在具有最高阶求和规则的对称的生成函数，记为 b ˜ ( z ) ，则当限定采用的偏移量是2n阶中心差分时， a ˜ ( z ) = b ˜ ( z ) − d ˜ ( z ) .     supp     d ˜ ⊂ [ − r , r ] ，因此 b ˜ ( z ) 的求和规则至少是2n阶，同时 d ˜ ( z ) 含有因子 ( 1 + z + ⋯ + z m − 1 ) 2 n ，因而 a ˜ ( z ) 至少具有2n阶求和规则。 代入 d ˜ ( z ) 的形式有 a ˜ ( z ) = b ˜ ( z ) − z − m n ( 1 − z ) 2 n ( 1 + z + ⋯ + z m − 1 ) 2 n ∑ l = 0 m − 1 ∑ j ∈ ℤ c m i + l − m j z m i + l − m j ，在对称的 b ˜ ( z ) 固定的情形下，由引理3.1知自由系数个数 { c m i + l − m j , j ∈ ℤ } 为 r − n m + 1 。 推论3.3在定理3.2的条件下，当 n = 1 时， a ˜ ( z ) 自由系数个数与 d ˜ ( z ) 自由系数个数一致；当 n > 1 时， a ˜ ( z ) 自由系数个数大于 d ˜ ( z ) 自由系数个数。 证：首先 a ˜ ( z ) 自由系数个数是 r − n m + n 。这是因为 a ˜ ( z ) 可分解为 a ˜ ( z ) = m z − n ( m − 1 ) m − 2 n ( 1 + z + ⋯ + z m − 1 ) 2 n a ˜ 1 ( z ) 。由 a ˜ ( z ) 和 m z − n ( m − 1 ) ( 1 + z + ⋯ + z m − 1 ) 2 n 的对称性知 a ˜ 1 ( z ) 也是对称的。易得 a ˜ 1 ( z ) 的最高次数是 r − n ( m − 1 ) = r − n m + n ，而 a ˜ 1 ( z ) 的系数和是1，因此 a ˜ ( z ) 自由系数个数是 r − n m + n . 当 n = 1 即采用二阶中心差分时，对任何对称的细分掩模 a ˜ ( z ) 具有的自由系数个数与 d ˜ ( z ) 自由系数一致。当 n > 1 时， a ˜ ( z ) 自由系数个数是 r − n m + n > r − n m + 1 ，即大于 d ˜ ( z ) 的自由系数个数。证毕。 推论3.2从另一个方面表明若 a ˜ ( z ) 不具有定理3.2中的形式时，则不能通过添加2n阶中心差分的形式得到最高阶求和规则。例对具有四阶求和规则的二重细分生成函数 a ˜ ( z ) = ( 1 + z ) 4 ( 132 − 464 z + 880 z 2 − 1091 z 3 + 880 z 4 − 464 z 5 + 132 z 6 ) 40 z 5 ，最高幂次 r = 5 ，计算知支撑在[−5, 5]上具有最高阶求和规则的逼近型细分和插值型细分的生成函数分别是 ( 1 + z ) 10 512 z 5 和 ( 1 + z ) 6 ( 3 − 18 z + 38 z 2 − 18 z 3 + 3 z 4 ) 256 z 5 。若采用四阶中心差分形式的偏移量 d ˜ ( z ) = ( 1 − z ) 4 ( 1 + z ) 4 ( d 1 + z d 0 + z 2 d 1 ) z 5 ，则无论 d 0 , d 1 取何值， a ˜ ( z ) + d ˜ ( z ) 都无法得到 ( 1 + z ) 10 512 z 5 或 ( 1 + z ) 6 ( 3 − 18 z + 38 z 2 − 18 z 3 + 3 z 4 ) 256 z 5 。原因在于 ( 1 + z ) 10 512 z 5 − a ˜ ( z ) 和 ( 1 + z ) 6 ( 3 − 18 z + 38 z 2 − 18 z 3 + 3 z 4 ) 256 z 5 − a ˜ ( z ) 中因式 1 − z 的幂次都是2，不是4。 当采用的是2阶中心差分即 n = 1 时，我们可以得到相应的线性方程组的形式： 定理3.4对任意正奇数s和中心对称列向量 b ，且向量 b 所有元素的和为0，系数矩阵 A 满足 A = ( 1 − 2 1 1 − 2 1 ⋱ ⋱ ⋱ 1 − 2 1 1 − 2 1 ) ( s + 2 ) × s ， 则线性方程组 A x = b 有中心对称解。 证：对任意正奇数s，利用中心对称的向量 b ，构造一个Laurent多项式 b ˜ ( z ) = b − ( s + 1 ) z − ( s + 1 ) + ⋯ + b s + 1 z s + 1 。 显然 b ˜ ( z ) 的系数和为0，即 b ˜ ( 1 ) = 0 。 的系数是对称的，由文献 [ 8 ] 知 b ˜ ′ ( 1 ) = 0 。因此 b ˜ ( z ) 含有因子 z − 1 ( 1 − z ) 2 ， b ˜ ( z ) 可以分解为 b ˜ ( z ) = z − 1 ( 1 − z ) 2 ( x − s z − s + ⋯ + x s z s ) 。由 b ˜ ( z ) 的系数对应关系可知， x = ( x − s , ⋯ , x s ) T 就是该线性方程组的解。由 b ˜ ( z ) 和 z − 1 ( 1 − z ) 2 的对称性知 x 是中心对称的。"
"国家自然科学基金(No. 61502217)，辽宁省教育厅科研项目(L20168366)。"
