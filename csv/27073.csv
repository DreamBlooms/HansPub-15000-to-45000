"为提升决策的敏捷性和科学性，提出了一种短时间序列和Kalman滤波相结合的决策优化预测方法TS_KF(Time Series-Kalman Filter)。此方法以提高预测准确度和减小计算复杂度为目的，采用Kalman滤波模型对预测过程进行建模，应用时间序列的自回归模型对Kalman滤波进行状态转移的更新和优化。以煤产量预测为例进行方法验证，结果表明，同其它典型的预测方法相比，TS_KF预测方法在保持低计算复杂度的前提下实现了预测准确度的大幅度提升，证明了TS_KF方法的有效性。 关键词 :决策，预测方法，短时间序列，Kalman滤波，自回归 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"在快变的国际化和一体化经济环境中，要保持国民经济的有序和平稳，政府和企业都需要有敏捷的信息获取能力和科学的决策能力。预测是决策的重要前提，预测的依据是预测模型。随着决策问题复杂性的增加，为提高决策的准确性和科学性，必须深入研究系统的决策预测方法 [ 1 ] 。 经过多年的研究发展，预测技术已经形成了相对完善的预测方法体系及相应的应用成果 [ 2 ] 。预测方法可分为定性判断和定量分析两大类。定性判断技术、统计时间序列模型和因果模型是三种最主要的典型预测方法 [ 3 ] ，其中后两种为定量分析方法。定性判断方法适用于数据难以获取，决策更多依赖于经验的情况，主要侧重于宏观分析和经验分析。例如文献 [ 4 ] 采用定性方法实现了宏观预测的医疗应用；文献 [ 5 ] 采用德菲尔法研究了护理实践和教育过程中与健康相关的问题；文献 [ 6 ] 采用经验曲线模式对能源需求进行预测。可见定性方法侧重于宏观和具有较大、较强趋势的预测。统计时间序列方法主要用于预测短期时间变化过程中某个指标的数量变化。该方法以时间作为自变量，寻求目标变量随着时间变化而产生的数量变化情况。例如文献 [ 7 ] 采用SVR方法对集成电路产业的输出进行预测分析。而因果预测模型适应于长期预测，主要采用各种回归模型实现回归分析，通过模型展现各种经济环境变量之间的影响关系。该方法用于在多个关注指标之间寻求因果关系，从而可以通过自变量指标预测因变量指标。例如文献 [ 8 ] 对多变量回归的模型选择和预测估计问题进行了讨论；文献 [ 9 ] 采用多变量图像分析回归模型预测了小吃行业生产分布。 基于智能算法改进定量分析模型是当前的研究热点 [ 10 ] - [ 16 ] 。例如文献 [ 10 ] 利用神经网络进行信用风险和破产预测；文献 [ 13 ] 集成神经网络、遗传算法和蚁群优化算法进行了电路负载预测；文献 [ 14 ] 通过遗传模糊推理系统对医院的来访者数量进行预测。这些基于智能方法的改进虽然能提升预测的准确度，但需要建立在大量的样本训练基础上，带来了额外的计算复杂度。从总体来看，现有大部分研究专注于模型与方法的验证，但对方法应用的时间特点没有进行归类分析，对方法的计算复杂性也较少关注。 各类预测方法的比较见表1。 本文对比研究用到的移动平均预测方法(Moving Average, MA) [ 17 ] 和指数平滑预测法(Exponential Smoothing, ES) [ 18 ] 都是基于统计时间序列的短期预测方法。 本文在以上典型预测方法的基础上，为进一步增强决策者对外界环境反应敏捷性，以提高预测方法的准确度和减小计算复杂度为目的，立足于短期预测提出了一种基于时间序列模型的Kalman滤波优化预测模型(Time Series-Kalman Filter, TS_KF)。通过时间序列建立短期的自回归模型，增强预测的时效性，再将Kalman滤波融入到预测模型中。Kalman滤波对于预测过程中的数据可以实现滤波和预测双重功效，在提升预测模型的可靠性和准确性方面起到重要作用。文中对预测模型的实现原理进行了详细分析，体现了模型简洁、有效、计算复杂度低等优势。最后以煤产量预测的实例，通过与现有两种常见的时间序列预测方法——移动平均预测方法和指数平滑预测方法对比，验证了TS_KF方法在数据预测中的有效性。"
"TS_KF预测方法以Kalman滤波预测模型为基础，预测模型能保持Kalman滤波本身的迭代收敛特性，在使用过程中通过样本的积累实现逐步收敛。预测模型框架如图1。 图1. 预测模型框架 Table 1 预测方法 特点 适用范围 定 性 简单，直观，没有定量计算 宏观分析和经验分析 定 量 统计时间序列模型 短时间序列，较低计算复杂度，预测精度一般 对单一因素的短时间变化预测和分析 因果模型 关注因素之间的关系，多用回归模型 长期预测，因素之间关系预测和分析 定量智能预测方法 预测精度较高，需要大量样本训练和计算量 长期及短期预测均可 表1. 不同预测方法比较 相对于神经网络的智能方法，该预测模型具有以下特点： • 不必进行前期大量样本值的训练，而将此过程融入到运行过程中，减少了模型应用过程中的前期准备工作量； • 在使用过程中可以对样本值进行滤波，减小样本本身的误差，这是其它模型没有实现的。 预测模型在整个过程中以Kalman滤波作为主线，在局部通过时间序列分析模型进行建模，并采用了自回归模型来描述。在预测迭代过程中动态的更新Kalman滤波的状态转移矩阵。在较短的时间内保证了预测过程的线性特性，在整个过程中又跟踪了模型参数的动态变化。  基于预测模型框架，下面构建Kalman滤波预测模型。Kalman滤波是一种广泛应用的线性定常系统滤波和预测方法，其数学表述为： { x k = A x k − 1 + B u k + w k − 1 z k = H x k + v k (1) 其中， x k 表示k时刻的估计值； z k 表示k时刻的测量值； w k − 1 和 v k 分别表示系统的过程噪声和量测噪声，相互独立且都服从高斯分布，即： { w k − 1 ~ N ( 0 , Q ) v k ~ N ( 0 , R ) (2) 在短时间段内对数据进行预测时，数据具有短时连续和平稳特性。该模型中不存在外输入，即 u k = 0 ，因此确定了A矩阵后，状态递推关系就可确定。对于量测方程，该模型的量测值就是状态向量的真值加上量测误差，因此H可取为单位阵。为简化模型和便于应用，在系统模型的矩阵参量确定之后，假设其在下一步的预测过程中保持不变。这样，得出简化的Kalman滤波和预测模型如下： { x k = a x k − 1 + w k − 1 z k = x k + v k (3) 式(3)中，状态转移矩阵A需要定期更新，当对单一变量进行预测时，可得矩阵A形如 d i a g ( a ) = a 。存在量测误差的时间序列可以看作一个随机过程的连续时间间隔的一次过程实现。这里采用时间序列分析中常用的自回归模型对目标变量建模。自回归模型可以表达为： y ˜ t = ϕ 1 y ˜ t − 1 + ϕ 2 y ˜ t − 2 + ⋅ ⋅ ⋅ + ϕ p y ˜ t − p + ξ (4) 式(4)称为AR(p)，即p阶自回归过程，式中将t时刻的偏差表示为前p个时刻的偏差的线性组合加上一个随机的干扰 ξ 。在实际的应用中p一般取1或2，对应于AR(1)和AR(2)。由于Kalman只需要一步递推的参数即可，因此采用AR(1)实现建模： y ˜ k = ϕ 1 y ˜ k − 1 + ξ (5) 在 μ 为 y k 的期望水平的情况下，将 y ˜ k = y k − μ 代入到(5)，可得AR(1)的以下等效过程： y k = ϕ 1 y k − 1 + τ + ξ (6) 其中的参数根据时间序列采样数据来估计，依据最小二乘原则，具体参数可利用下式计算： { y ¯ = 1 S ∑ i = 0 S y k − i ϕ 1 = ∑ i = 0 S − 1 y k − i y k − i − 1 − ( S − 1 ) y ¯ 2 ∑ i = 0 S − 1 y k − i − 1 2 − ( S − 1 ) y ¯ 2 τ = ( 1 − ϕ 1 ) y ¯ (7) 其中，S为预测的步长。 按照式(7)对式(3)中的Kalman滤波模型进一步调整和优化得： { x k = a x k − 1 + β + w k − 1 z k = x k + v k (8) 式中将 β = ( τ ) = τ 加入转移方程，表示目标变量的期望水平，该向量和矩阵 A = d i a g ( a ) = d i a g ( ϕ 1 ) = ϕ 1 同样需要进行不断更新。 v k 的方差可由时间序列计算，进而得到 v k 的方差阵R： { σ 2 = ∑ i = 0 S [ y ^ i − ( ϕ 1 y ^ i − 1 + τ ) ] 2 R k = d i a g ( σ 2 ) = σ 2 (9)  结合时间序列分析的Kalman滤波模型的运算步骤如下： 根据状态向量的时间序列计算回归参数 τ , ϕ 1 ，进而确定状态转移方程中的状态转移矩阵A和水平向量 β ，计算量测误差矩阵 R k 。初始化Kalman滤波模型时，有关参数的初始化问题，也会影响到模型的收敛速度和精度，因此参数初始化需根据实际情况酌情调整，以获取较好的收敛性能。 依据Kalman滤波模型进行状态向量k时刻的滤波和k + 1时刻的预测。在这两个过程中状态方程是保持不变的。 基于构建的Kalman滤波预测模型，形成的TS_KF预测算法流程见图2。 图2. 预测算法流程"
"煤资源的生产和消耗关系着整个世界能源战略目标制定与能源可持续发展计划的实施，煤资源的生产问题一直是备受关注的社会问题之一，因此基于该问题的预测研究具有的重要意义。 实验选取1975~2017年的煤生产数据为样本，进行相应的需求预测，并将预测结果与真实产量数据比对，以验证TS_KF预测模型在短期时间序列预测中的有效性。同时基于现有两种常见的统计时间序列的短期预测方法——移动平均预测方法(MA)和指数平滑(ES)预测方法，实现了模型之间的对比分析研究，证明TS_KF模型具有提升预测精度的作用。实验参数设置如表2。 实验以表2中预测方法和参数设置，分别进行了煤产量的预测，记录预测结果，通过整理形成表3中的预测统计数据。 如表2所示，首先利用各种方法进行了相关的时间序列预测；然后根据预测数据和真实数据，计算了预测误差。 为对预测效果具有更全面的比较，实验中对各种预测方法误差进行衡量，分别计算了相关的平均绝对误差(MAD)、均方误差(MSE)和平均百分比误差(MAPE)，如表4。图3给出了在MA (k = 2)、ES (ε = 0.1)及TS_KF (Step = 5)下各预测方法预测效果实验统计数据比较图。 从表4和图3的综合统计结果和预测曲线可见，在相同的误差计算方法下，TS_KF预测模型在计算复杂度等级相同的情况下，极大的提高了预测的准确性。 Table 2 预测方法 方法参数 MA移动平均预测 预测步长k = 2, 3 ES指数平滑预测 阻尼系数为ε = 0.1/0.4/0.9 TS_KF预测 预测步长Step = 5 表2. 预测方法对比实验参数设置 Table 3 煤产量原始数据 预测数据(单位：T) 误差计算ERR (单位：T) 年度 煤产量 (单位：T) MA (k = 2) ∙∙∙ ES (ε = 0.1) ∙∙∙ TS_KF (Step = 5) MA (k = 2) ∙∙∙ ES (ε = 0.1) ∙∙∙ TS_KF (Step = 5) 1975 526,954,000 490,688,500 ∙∙∙ 473,207,506 ∙∙∙ 522,911,455.8 −36,265,500 ∙∙∙ −53,746,494 ∙∙∙ 4,042,544 1976 546,822,000 515,568,000 501,084,551 540,013,153.3 −31,254,000 −45,737,449.4 6,808,847 ∙∙∙∙∙∙ 2016 1,162,749,659 1,121,798,485 ∙∙∙ 110,831,7825 ∙∙∙ 1,151,298,279 −40,951,175 ∙∙∙ −54,431,834 ∙∙∙ 11,451,380 2017 1,145,567,167 1,147,123,879 1,129,180,072 1,151,863,276 1,556,712 −16,387,095 −6,296,109 表3. 预测统计数据详细列表 Table 4 预测方法 误差类型 MA (k = 2) MA (k = 3) ES (ε = 0.4) ES (ε = 0.1) ES (ε = 0.9) TS_KF (Step = 5) MAD 35,060,848 40,972,196 48,266,140 43,664,316 147,901,792 11,623,238 MSE (10 9 ) 1,772,385 2,286,805 3,236,252 2,774,031 25,146,882 219,239 MAPE 4.40% 5.36% 6.06% 5.44% 17.56% 1.39% 表4. 不同预测模型误差统计 图3. 各种预测方法煤产量预测效果比较"
"1) 综述了决策中现有的典型预测方法，阐述了不同预测方法的应用场合和相互关系。统计时间序列方法主要用于短期预测，是决策敏捷性的重要支撑，因此着重对短期时间序列预测进行了研究。 2) 为提升决策的敏捷性和科学性，以短时段数据的时间序列为研究对象，提出了将时间序列模型和Kalman滤波模型相结合的TS_KF预测方法，并从预测准确性和计算复杂度上优化预测方法。TS_KF方法具有模型简洁、有效、计算复杂度低等特点。 3) 以煤产量数据作为时间序列样本，采用与典型的时间序列预测方法(MA和ES)对比的方法，设计了实验验证算例，以验证TS_KF方法的有效性。结果表明，在保持计算复杂度同水平的前提下，TS_KF方法能极大的提高预测的准确性。"
