"本文提出一种仅利用局域信息的孤岛微电网分布式控制方法。该方法利用agent构造通信网络，并进行局域信息交换。Agent根据收集的信息，计算下一时刻分布式电源的输出设定值，从而调整下一时刻分布式电源的输出。本文系统地给出，从任意通信网络为agent导出分布式控制律的一般方法，并且在理论上证明，该分布式控制律不仅能够保证微电网内功率平衡，而且能够使得可控分布式电源输出与其容量成比例。最后，设计两组实验，验证文中提出的分布式控制律有效性。仿真结果表明，当环境和负载变化时，文中提出的方法能够维持微电网内功率平衡，保证功率在可控分布式电源之间按照容量大小进行分配。 关键词 :孤岛微电网，多Agent系统，分布式控制，第二级控制，网络化控制 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"可再生能源的开发与利用已经受到各国研究人员的关注。微电网能够更好的接纳可再生能源，成为研究热点 [ 1 ] 。通常，微电网能够融合多种分布式电源为有机整体，如光伏电源、风力发电电源、微型燃气轮机、燃料电池，储能电源等，为用户提供清洁、可靠、灵活的电能。微电网有两种运行方式 [ 2 ] [ 3 ] ，第一种运行方式是通过并网开关与大电网连接的并网运行方式；第二种是不与大电网相连接的孤岛运行方式。孤岛运行的微电网，缺乏电压频率的支撑，分布式电源(DG)的逆变器响应速度快，过载能力小，间歇性电源输出不稳定，负载变化随机等导致孤岛微电网控制逐渐成为研究热点 [ 4 ] 。 随着研究的不断深入，多种控制策略 [ 5 ] - [ 23 ] 用于控制微电网稳定运行，包含集中式控制方法 [ 12 ] ，分层控制方法 [ 13 ] [ 14 ] [ 15 ] ，基于MAS的分布式控制方法 [ 19 ] [ 20 ] [ 21 ] [ 22 ] [ 23 ] ，其中分布式控制方法受到了人们广泛研究。与集中式控制相比，分布式控制的通信网络结构灵活，通信系统投资成本低，不需要中央控制器，不会发生单点故障，控制方式灵活多样，容易实现DG的即插即用，更加适应间歇性可再生电源的输出随机波动特性 [ 12 ] [ 23 ] 。 文献 [ 9 ] [ 10 ] [ 11 ] 提出了改进的下垂控制方法用于控制微电网中的分布式电源，有效的提高了无功功率在系统中的合理分配，但是都未曾考虑可再生能源接入对微电网运行的影响。文献 [ 16 ] 提出了一种分布式频率电压合作制策略，在保证DG发电成本最小时，能够使得系统频率稳定，节点电压维持在稳定值，系统无功功率均衡分配。作者 [ 17 ] 提出孤岛微电网分布式电压预测控制方案，在不借助通信系统时也能够保证系统电压稳定，并建立小信号模型分析提出方法的稳定性，但当机组加入和退出运行时，需要重新修改预测控制方程。结合分布式控制与分层控制的思想，文献 [ 18 ] 提出针对不确定通信网络结构的微电网控制策略，提供了电压频率恢复的解决办法，但提出的方法中需要一个虚拟节点提供电压和频率参考值。文献 [ 19 ] [ 20 ] 借鉴多Agent系统，提出了微电网运行控制策略，但文献未考虑可控DG成比例输出的功能。基于此问题，文献 [ 21 ] 提出了孤岛微电网分布式控制策略，有效的解决了可再生电源输出波动对系统的影响，随后，在此基础上提出了分布式最优控制方法 [ 22 ] ，使得微电网中功率按照DG的容量分配。 上述一些文献采用的控制方法较为复杂，不能快速响应环境负载的剧烈变化，针对上述问题，本文提出一种仅利用局域信息的微电网分布式控制策略。文章中提出的分布式控制方法为完全分布式的方法，只需要局部信息就可以实现微电网中功率供需平衡，可控DG成比例输出的功能，实现微电网中功率在可控DG之间按照容量大小分配。 文章内容安排如下。首先，介绍分布式分层控制策略，控制策略包含通信网络的构建和分布式控制律的设计；其次，证明分布式控制律的功率平衡特性与收敛特性；随后，介绍微电网仿真系统；然后，设计实验验证文中控制方法的有效性，并分析仿真结果；最后，总结文章。"
"本文提出的仅利用局域信息的分布式控制模型，首先构造由Agent组成的通信网络。由Agent组成的通信网络中，Agent节点只收集邻居Agent的信息，不需要收集全网的信息。对于任意给定的通信网络，本文系统地给出为Agent导出分布式控制律的方法，从理论上证明分布式控制律的功率平衡特性与收敛性。理论证明，若Agent通过分布式控制律调节可控DG的功率输出设定值，则能够保持系统功率供需平衡，通过迭代的方法，能够逐渐使得可控DG成比例输出，实现微电网系统功率最优分配。  如图1所示，微电网中，分布式电源由微型燃气轮机(MT)，光伏电源(PV)、永磁同步风力发电机(WT)，蓄电池(BESS)等组成。而通信网络由Agent组成，用于信息传递、处理和计算。网络G中，所有的Agent都不收集负载的信息，只收集DG的输出功率信息。并且，定义与微型燃气轮机(可控DG)相连的Agent为可控Agent，与蓄电池(半可控DG)相连的为半可控Agent。由于光伏、风机(不可控DG)采用最大功率跟踪(MPPT)控制方式，不对其输出进行调节，所以没有对应的Agent，从而减少了通信投资。图1中，可控Agent与可控Agent之间采用双向通信方式，半可控Agent与可控Agent之间采用单向通信方式，信息由半可控Agent传递给邻居可控Agent。虚线表示通信网络与微电网中DG的局部控制器之间的信息流动，箭头表示信息传递方向。可控Agent既收集对应DG的信息，又控制底层可控DG，半可控Agent 图1. 微电网控制模型，上层为Agent组成的通信网络，半可控Agent由椭圆表示，可控Agent由棱形表示。此外，两个网络层之间的虚线表示Agent与底层DG的连接，箭头表示信息的传递方向 只收集半可控DG的信息，不控制半可控DG。 本文中，蓄电池采用电压频率(V/F)控制，由其控制方式可知，其输出可以大致表明了系统的功率缺额。只要半可控DG输出不为零，半可控Agent就会将此信息传送给相连的可控Agent，通过计算，使得可控DG分担半可控DG的输出，从而使得半可控DG输出归零。进一步，在网络G上，将可控DG的输出进行再分配，通过迭代的方式逐渐实现可控DG的输出与其容量成比例。由于半可控Agent只发送信息，而不参与迭代，因此通信网络G中，不包含半可控Agent。 假设通信网络G包含n个可控Agent。对角矩阵D = [d ii ] n×n 表示节点的出度，出度定义为Agent出边的条数。此外，记半可控Agent v的出度为d v ，例如，半可控Agent有两条出边，则d v = 2。为使得控制律中所有矩阵维数相等，Agent的编号与对应DG的编号相同，并且可控Agent的个数与可控DG的个数相等。  上面详细介绍了通信网络G的结构和Agent之间的通信方式，这部分将系统地给出，从任意通信网络，为Agent导出分布式控制律的方法。首先，给出系统功率平衡条件。若以下条件成立时，我们认为系统的功率供需是平衡的， (1) 其中 ， 是 时刻可控DG的输出向量，P v (t)，Q v (t)为半可控电源在t时刻的有功功率和无功功率输出值。根据文献 [ 21 ] 可知，采用V/F控制的DG能够根据电压频率的变化输出功率，维持系统电压频率稳定，补偿系统瞬时功率缺额，从而采用V/F控制DG的输出值能够表示系统的功率缺额。因此，等式(1)表示，当可控DG下一时刻的输出等于可控DG上一时刻的输出与半可控DG输出的加和时，系统的功率是平衡的。 为使得半可控DG在瞬间补充系统缺额后，其输出由可控DG分担，半可控Agent将半可控DG的输出功率值发送给邻居(可控Agent)。半可控Agent向邻居发送信息后，可控Agent的输出根据以下等式(2)确定， (2) 其中P'(t)、P(t)和Q'(t)、Q(t)为n × 1的可控DG功率输出列向量。Z为n×1列向量，若Agenti能够接收到半可控Agentv的信息，则Z中对应的元素 ，否则 。由向量Z的定义可知 。 可控Agent若根据等式(2)调节可控DG的输出，能够保证等式(2)成立，系统功率平衡，但不能保证可控DG按照其容量大小输出。为保证系统功率平衡时，可控DG的输出与容量大小成比例，设计如下分布式控制律， (3) 其中 ， 为可控Agent的有功列向量，F为权值矩阵。权值矩阵F中的元素f ij 根据以下等式(4)确定， (4) 其中， ， 表示可控DG的有功容量列向量，N i 表示节点i的邻居集合。将控制律(3)中的P'(t)换成Q'(t)，P(t)换成Q(t)， 替换成 就可以得到无功功率的分布式控制律。可控Agent根据分布式控制律(3)调节可控DG的输出，就可以使得微电网中的功率平衡，并且经过迭代使得功率按照可控DG的容量大小分配。  首先证明分布式控制律(3)的功率平衡特性，随后证明其收敛特性。 定理1：在网络G上，若可控Agent根据分布式控制律(3)调节可控DG的输出，则等式(1)成立，同时在可控DG分担半可控DG的输出时，能够保证微电网中功率供需平衡。 证明：首先证明F矩阵的列和为1。将矩阵F中的第j列相加得到， (5) 然后，证明等式(1)成立。将等式(3)两边相加，并利用F矩阵列和为1，得到 (6) 由于 ，并根据等式(2)和等式(6)得到， (7) 证毕。 定理2：在网络G上，若可控Agent根据分布式控制律(3)调节可控DG的输出，通过迭代就能够实现微电网中功率在可控DG之间成比例分配，使得可控DG的输出功率与其容量的比值 。 证明：将矩阵F的第j行与容量列向量S相乘，得到， 。(8) 同时，根据文献 [ 25 ] 的推论1和网络G的结构可知，矩阵F只包含单一的幅值为1的特征值，又由于矩阵F的谱半径特性可知， (9) 其中， 为矩阵的1范数。记 ，写出矩阵F和H的特征值表达式，并对其做相同的行列式变化，得到 (10) 根据F的1特征值的唯一性，结合等式(10)得到， (11) 其中ρ(F)，ρ 2 (F)分别是矩阵F的谱半径、第二大特征值幅值。结合等式(8)，(9)和(11)，并根据文献 [ 26 ] 的定理2可知， 。所以得到， 。(12) 证毕。 定理2说明分布式控制律(3)能够调节可控DG的输出，通过迭代使得可控DG功率输出与容量的比值为 ，实现微电网中功率在可控DG之间按比例分配。"
"孤岛微电网仿真系统由MATLAB/Simulink搭建而成，包含14组DG和负载，采用辐射状结构，如图2所示。设置线路阻抗为0.169 + j0.07 Ω/km，系统频率为50 Hz，标准电压为380 V。考虑分布式DG的物理特性，仿真中设置各DG输出不超过容量限制，储能电源DG 7 在瞬时输出功率时也不超越容量限制。微电网仿真系统中，可控分布式DG i = 2,4,6,8,11,12,14 采用恒功率(PQ)控制，由理想直流电压源V dc [ 24 ] 模拟；光伏电源DG i = 1,9 采用最大功率跟踪(MPPT)控制，永磁同步风机DG i = 3,5,10,13 也采用MPPT控制；DG 7 采用V/F控制，由储能系统组成，为孤岛微电网提供频率和电压支撑 [ 21 ] 。在仿真中，设定不可控分布式DG不产生无功功率，即Q i = 1,3,5,9,10,13 = 0 kVar。DG容量和负载参数见于表1中。在仿真中，可控Agent之间的通信周期为1 ms，半可控Agent每间隔10 ms给可控Agent传递一次信息。设定可再生光伏电源DG 1,9 的有功功率输出在25 kW到35 kW之间变化，永磁同步风机DG 3,5,10,13 的有功功率输出在8 kW到42 kW之间变化，如图3所示。 图2. 孤岛微电网结构 Table 1 电源 容量 控制 负载 最大需求 DG 1 60 kW,0 kVar MPPT Load 1 35 kW,0 kVar DG 2 60 kW,15 kVar PQ Load 2 35 kW,10 kVar DG 3 45 kW,0 kVar MPPT Load 3 15 kW,20 kVar DG 4 55 kW,22 kVar PQ Load 4 20 kW,15 kVar DG 5 30 kW,0 kVar MPPT Load 5 30 kW,15 kVar DG 6 45 kW,35 kVar PQ Load 6 35 kW,15 kVar DG 7 20 Ah V/F Load 7 20 kW,20 kVar DG 8 65 kW,30 kVar PQ Load 8 25 kW,0 kVar DG 9 50 kW,0 kVar MPPT Load 9 20 kW,20 kVar DG 10 55 kW,0 kVar MPPT Load 10 30 kW,0 kVar DG 11 40 kW,33 kVar PQ Load 11 20 kW,0 kVar DG 12 70 kW,25 kVar PQ Load 12 20 kW,15 kVar DG 13 40 kW,0 kVar MPPT Load 13 20 kW,0 kVar DG 14 35 kW,20 kVar PQ Load 14 35 kW,20 kVar 表1. DG和负载参设置 图3. 不可控DG功率输出"
"这部分仿真实验部分，设计两组仿真验证提出的分布式控制策略的有效性。首先，验证在环境变化时，在分布式控制律的作用下，验证微电网系统的功率平衡特性、系统电压幅值、频率稳定变化，可控DG成比例输出功能。其次，分析在环境和负载变化时，在分布式控制律的作用下，验证系统功率平衡特性、电压频率稳定，可控DG成比例输出功能。最后，总结分析仿真实验结果。  当环境变化，负载不变时，可控Agent采用控制律(3)调节可控DG的输出，得到在网络结构G 1 下的仿真结果如图4所示。从图4中可以看出，可控DG能够平稳输出功率，系统电压维持在380V，系统频率保持在50 Hz，DG 7 的输出功率始终保持为0，微电网系统能够稳定运行。此外，从图3的(c,f)两图中看出，可控DG是输出功率与其容量的比例都相等，说明在控制律(3)的调节作用下，即使在环境变化时，系统功率能够在可控DG之间合理分配。仿真结果表明，只要通信网络G连通，不存在孤立节点，Agent采用控制律(3)就可以实现微电网中功率在可控DG之间按照其容量大小分配。  实际微电网中，系统负载是变化的，因此，这部分仿真验证当负载和环境同时变化时控制律(3)的控制效果。设置系统负载变化情况为：1) t = 2 s时刻，Load 5,13 接入微电网中，2) t = 4s时刻，系统有功率减少50 kW，无功功率减少20 kVar；3) t = 6 s时刻，Load 5,13 从微电网中切除。 Agent在网络G 1 中，按照控制律(3)调节可控DG的输出，得到的系统的动态仿真结果如图5所示。从图5中可以看出，在负载和环境剧烈变化的情况下，可控DG在控制律(3)的调节作用小，可控DG能够平稳输出功率，微电网系统首尾两端的电压幅值，即Load 2 和Load 14 两端的负载电压，分别维持在380 V附近，系统频率保持在50 Hz。在负载剧烈变化的时刻，系统电压频率也不超过允许范围，微电网系统能稳定正常运行。储能电源DG 7 在瞬时输出或者吸收功率后，经可控DG的调节作用，能够快速变为0。此外，更为重要的是，即使在负载和环境同时变化的情况下，可控DG的输出功率与容量的比例值相等，实现了系统功率在可控DG之间按照可控DG的容量大小分配。 图4. 环境变化时的仿真结果。(a) 可控DG的有功和无功功率输出。(b) 系统电压频率和BESS输出变化情况。(c) 可控DG的功率输出与其容量的比例值 图5. 负载和环境同时变化时的仿真结果。(a) 可控DG的有功和无功功率输出。(b) 系统电压频率和BESS输出变化情况。(c) 可控DG的功率输出与其容量的比例值"
"本文针对孤岛微电网的分布式控制问题，提出一种只利用局域信息的分布式控制方法。此方法为两层网络结构，其中上层是由Agent组成的通信网络，用于处理、传递信息，而下层网络是由分布式DG和负载组成的微电网。针对任意给定的连通网络，本文系统地为Agent设计了分布式控制律，用于调节可控DG的输出，使得微电网内功率供需平衡，并且通过迭代的方法，逐渐实现可控DG成比例输出的功能。此外，本文从理论上证明了提出的分布式控制律的功率平衡特性与收敛特性。最后，仿真结果表明，即使负载和环境同时变化，文中提出的控制方法都能使得微电网系统中电压频率稳定，实现可控DG的输出与其容量成比例。"
