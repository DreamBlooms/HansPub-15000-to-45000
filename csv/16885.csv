"本文介绍了三维激光扫描技术的原理、系统组成及其对玉米植株三维形态扫描的过程、数据的处理和形态特征参数获取的方法，并与传统量测方法进行比较探讨两种新旧方法的优劣。使用人工测量方法和三维激光扫描方法分别对12株玉米植株的株高、叶基角、茎秆直径及横截面积进行测量比较，研究结果表明，三维激光扫描的测量结果与人工测量结果规律性一致，可以替代人工测量。对同一植株的重复测量进行稳定性分析，发现三维激光扫描方法的测量结果变异性小于人工测量结果，人为影响因素小。但是在时间效率上，三维激光扫描方法还有待进一步提高。三维激光扫描能无损监测植株的三维形态结构，拓展了植株形态测量方法，对植物数字化有重要意义。 关键词 :三维激光扫描技术，玉米，三维形态，人工测量方法，无损监测，数字化"
"在农学、生物学等领域，植物的三维形态结构一直是重要的研究内容。随着测绘科学与计算机可视化技术的发展，植物的三维形态虚拟建模逐渐兴起，同时促使“数字植物”的研究成为热点[ 1 ] -[ 3 ] 。通过“数字植物”手段将植物三维形态结构信息数量化，可以更加细微和深入地研究植物生长的外在表现与内在生长分化之间的定量关系。三维激光扫描技术作为“数字植物”的一种重要数据采集手段，可以快速获取三维模型点云信息，冯仲科等[ 4 ] -[ 6 ] 在大型树木管径测量上进行了相关研究，郭新宇等[ 7 ] -[ 9 ] 对番茄、西瓜等植物的部分器官的三维重建方法进行了探讨，但是对于幼苗生长发育微观形态特征参数提取方面报道较少。玉米作为我国主要作物之一，其三维形态结构的研究有重要现实意义[ 10 ] -[ 12 ] 。传统获取其三维形态结构信息的方法不仅工作量大、精度低而且测量因子单一、测量过程复杂。而三维激光扫描技术能把玉米植物的立体模型在计算机上实现，不仅能提供更丰富的测量信息，而且具有精度高、原位无接触、不对植株造成破坏等特点[ 13 ] [ 14 ] ，可以实现植株生长的连续动态监测与比较。本文以盆栽玉米植株为例来探讨三维激光扫描在玉米形态监测中的可视展现与可视计算的方法，以比较与人工测量方法的优劣，为后期生物修复效果的植物形态监测奠定了理论基础，具有重要的现实生态意义。"
"三维激光扫描技术是通过激光发射器不断地发射激光束，经过目标物体反射，被传感器接收后经过分析计算出被测物体精确的点位信息。经过这样不断重复地数据采集和处理过程获取逼近被测物体表面的高密度的三维点云。它的测距方法主要有脉冲法、相位法、三角法。脉冲法主要是通过测量激光速在激光发射器与被测物体之间的传播时间来计算物体的位置信息。三角法是通过测量激光经过传播、反射后相位差来获取目标精确的点位，一般能够测量的最大距离小于脉冲法，但精度一般高于脉冲法。本实验使用的是三角法，它的原理是是激光发射点和CCD接收点位于长度为高精度基线的两端，并与目标反射点构成一个空间平面三角形，借助三角形几何关系，求得目标的位置信息[ 15 ] -[ 17 ] ，测量的有效距离最小，但精度最高。 如图1，通过激光扫描仪角度传感器可得到发射、入射光线与基线的夹角分别为γ、λ，激光扫描仪的轴向自旋转角度α，然后以激光发射点为坐标原点，基线方向为X轴正向，以平面内指向目标且垂直于X 轴的方向线为Y轴建立测站坐标系，通过计算可获得P点的坐标。  三维激光扫描系统主要由扫描仪、带有配套软件的工作站、供电系统组成(图2)。本试验使用加拿大CreaformHandyscanEXAscan 3D扫描仪，精度可达0.04 mm，扫描速度约50,000点/秒，最高分辨率为0.05 mm，景深为30 cm。配套的数据采集软件为VXelements，具有实时可视化和扫描结果增强的功能[ 18 ] 。后期处理软件为Geomagic Studio，它是一款点云处理能力强大的逆向软件，具有交互处理扫描数据，建立精密的三维模型，基本测量等功能。 图1. 三角法测量原理 图2. 三维激光扫描系统的组成 通过此系统对玉米植株扫描过程如下： 1) 通过数据线连接扫描仪与工作站，启动VXelements软件，扫描仪每一次发射激光速采集的点位信息都是在仪器自身坐标系下，一个位置很难扫描完整的植株，所以要围绕植株不断进行扫描。每个位置扫描的坐标系不同，需要通过控制点拼接起来。所以在扫描准备的时候要通过在植株周围固定位置粘贴反射片，仪器自动通过识别反射片完成拼接。 2) 仪器初次使用或者使用一段时间后要使用校正板进行校正。由于植物叶片柔弱易动，扫描数据容易分层，从扫描将要开始时要减少人员走动，以减少外界对叶片的扰动，来获取高质量的数据。 3) 扫描开始后，手持扫描议围绕植株不断采集数据，并注意计算机上实时显示的点云模型信息查漏补缺，防止数据缺失，并保证在每一测站至少有三个控制点可视。按照控制点的先后顺序扫描可分为两种方式。一种是全局控制法：先直接一次扫描全部控制点信息，建立全局坐标系，形成整体控制，然后再采集植株的位置信息，通过每一站扫描的控制点匹配到全局坐标系下面。另一种方式是直接先扫描植株，并且扫描这一测站范围内的控制点，两个相邻测站保持至少三个公共控制点，通过控制点，每一站的数据自动凭借到上一个坐标系下，直到扫描结束。   手持扫描仪获取的原始数据是数万个离散点的位置坐标和反射强度值，在建立三维模型前需要对点云进行初步处理[ 19 ] 。将获得的植株点云数据以.igs格式导入Geomagic Studio中经着色后方便观察。在扫描时由于仪器本身和外界环境的原因，有多余项和噪音被同时采集，需要经过删除非连接项、去除孤点、减噪等前期处理获得目标点云(图3(a))，分离塑料盆和土壤后就提取到完整的玉米植株的点云数据。  多边形模型是以相邻的数据点为顶点建立不规则三角形，形成TIN网模型，对实体表面进行逼近。对2.3.1节中处理后的点云数据进行封装形成表现玉米植株形态的不规则三角网模型(TIN模型) (图3(b))。 1) 填充孔洞 扫描时会有部分数据缺失形成如图3(c)所示的不同类型的孔洞(孔1为边界孔，孔2为岛屿孔)，需要选择不同的“填充孔”命令进行填充，其实质就是利用孔洞周边数据分析变化趋势进而填补残缺部分的数据。 2) 转换坐标系 在扫描时，仪器会自动建立一个独立空间坐标系，Z轴与茎秆竖直方向不同向，需要运用旋转矩阵，将独立空间坐标系转换为以玉米最低端中心为坐标原点，茎杆中心为Z轴的空间坐标系。首先选取茎秆数据进行圆柱特征模拟，出现贯穿茎秆的中心线，然后运用“对齐”命令，以这条中心线为固定，以Z轴为参考进行坐标转换，就得到茎秆方向与Z轴一致的玉米模型(图3(d))。这时可以随意旋转模型从任何角度对植株进行观测。  对于建立完成的TIN模型，可以进一步通过探测曲率–构造曲面片–拟合轮廓–构造格栅–拟合曲面步骤，得到视觉效果较好的Nerbs曲面模型。通过对模型进行渲染或者匹配植株的数码图像，可以得到更加逼真的晕渲图和真彩模型。也可以通过兼容格式导入CAD、3Dmax等图形处理软件中处理得到的等值线图、断面图、投影图来进行光照模拟等研究。 图3. 点云数据的处理及形态指标的获取  1) 株高冠幅的量测 在TIN模型打开时选择显示模型的边界框尺寸，出现最小的包围盒(图3(e))，同时显示包围盒的尺寸信息。则竖直方向的边框边界差值就是株高，水平方向的最大边界差值就是冠幅。 2) 面积的量测 直接应用“工具–测量”模块对选取的任意叶片进行面积测量(图3(f))，若是选取全部叶片可一次性计算叶片总面积。方法是：旋转模型到俯视视角(此时Z轴垂直屏幕向外)，在非贯穿模式下选择全部叶片测量出来的叶面积就是投影面积。 3) 茎秆横截面积和扁率的量测 在距根部5 cm高处建立垂直玉米茎秆的特征平面(图3(g))，“量测”模块中可量测此截面与玉米茎秆的横截面积。在曲线模块中创建以特征平面截取的茎秆的轮廓曲线(图3(h))，此时会显示一个紧紧包围轮廓曲线的矩形边框，这个边框表达着轮廓边界，此时显示的边框信息就是长短半轴直径。长短半轴的差与长轴的比值即为扁率。 4) 叶片形态参数的量测 曲线模块下按曲率提取曲线，得到与叶面密合的沿叶脉的空间曲线和叶片的边界轮廓曲线(图3(i))，进行参数交换导入到与Geomagic Studio相配套的Soliworks软件中，运用量测工具进行叶片长度和宽度的量测。利用“分析–点坐标”在植株的三维叶片上沿主叶脉拾取叶枕部位的点、叶片基部挺直的部分的点，以相应的点坐标信息计算出叶片的叶基角(叶片基部直挺部分中脉与茎秆上方间的夹角)。"
"传统的测量株高冠幅的方法主要是通过卷尺量取，在确认最高点和水平最大伸展长度的时候人为因素较大。而通过三维激光扫描获取植株模型后，可以自动客观地获取株高冠幅信息。 在叶面积测量上，传统主要有方格纸法、长宽系数，称重法等，工作量大且需要离体采集、对植株生长扰动较大等缺点，特别是当叶片卷曲时测量精度难以保证[ 20 ] 。对于投影面积的测量，传统方法是先把植株投影到地面，然后计算投影面积，不仅繁琐而且误差较大，有时甚至无法实现。三维激光扫描技术可以一键式地很方便地实现面积的量测。并且当叶片卷曲时，通过三维激光扫描技术建立模型后，沿着光照方向的视角非贯通模式下选择目标叶片可以进行有效光合面积的测量，这是传统方法难以实现的。 在许多研究中茎干的粗壮程度常用直径来表示，但是玉米的茎杆的横截面并不严格地呈圆状，而是类似椭圆状，它有一定的扁率，且不同生长时期的扁率有所不同。用手工量测不同植株茎杆直径时较难在最大直径(长轴)和最小直径(短轴)间把握同一个量测尺度标准，而茎杆的截面积不受茎杆截面形状的影响，能比直径更准确地表示出玉米茎杆的粗壮程度。传统方法很难直接进行横截面积的测量，而三维激光扫描技术通过建立垂直茎秆的特征平面很轻易获取横截面积，同时获得横截面轮廓，方便后期对数字植物进行深入研究。"
"为了验证两种量测方法的准确性，取12株生长状况不同的玉米盆栽植株，在自然状态下分别用卷尺和量角器人工量取株高和12片叶片的叶基角，用游标卡尺量取茎杆直径，以圆面积的计算公式计算出茎杆横截面积S 2 ，并用三维激光扫描方法测量的株高、相同叶片的叶基角和茎杆的长短直径以及横截面积S 1 ，结果如表1和表2所示。 由对比结果可知，株高的平均相对误差为4.18%，最大相对误差为8.1%。叶基角的平均相对误差为4.82%，最大相对误差为8.8%，可见株高和叶基角的相对误差较小。而横截面积相对误差较大，平均为18.98%，甚至有4个达到30% 以上，这也印证了茎秆的横截面不是严格的圆形状。在茎秆直径的比较中发现，茎秆横截面都有一定的扁率，人工测量直径介于长短轴之间，并且与长短轴没有明显的数量关系，所以在人工测量直径时很难把握同一个量测尺度标准，主观误差较大。 以人工测量数据为自变量x，以激光扫描数据为因变量y，分别对株高测量数据、叶基角和横截面积测量数据画出散点图(图4~6)，进行线性拟合得出回归方程。由图4和图5的回归方程得到，株高的决定系数R 2 达到0.9906，叶基角的R 2 达到0.9559，置信度为95%，说明人工测量数据和三维激光扫描数据 Table 1 编号 株高(cm) 叶基角(˚) 人工测量 激光扫描 相对误差 人工测量 激光扫描 相对误差 1 68.7 65.09 5.30% 32.9 32.29 1.90% 2 71.3 69.15 3.00% 40.6 38.12 6.10% 3 49.0 51.36 4.80% 38.6 40.07 3.80% 4 58.5 55.24 5.60% 35.5 34.60 2.50% 5 55.9 52.28 6.50% 17.2 17.56 2.10% 6 46.8 45.11 3.70% 30.0 31.57 5.20% 7 50.6 48.10 5.00% 28.5 26.49 7.10% 8 30.9 31.67 2.50% 45.3 47.82 5.60% 9 26.6 28.72 8.10% 18.0 17.72 1.60% 10 36.5 36.48 0.10% 33.0 31.12 5.70% 11 25.1 24.93 0.70% 41.8 38.14 8.80% 12 71.1 67.68 4.80% 46.5 43.06 7.40% 平均值 4.18% 4.82% 表1. 株高和叶基角的测量结果 Table 2 编号 茎杆直径(cm) 横截面积(mm 2 ) 短轴 长轴 扁率 人工测量直径 激光扫描面积S1 人工测量面积S2 相对误差 1 7.8 12.5 0.376 10.3 75.41 83.32 10.50% 2 11.7 15.3 0.234 14.7 130.11 169.72 30.40% 3 7.8 10.6 0.264 9.0 55.63 63.62 14.40% 4 16.5 17.2 0.041 17.2 210.22 232.35 10.60% 5 14.0 17.5 0.200 14.6 189.45 167.42 11.70% 6 13.5 16.6 0.187 13.9 171.40 151.75 11.50% 7 12.9 17.0 0.241 15.3 170.75 183.85 7.70% 8 9.0 14.7 0.388 12.4 106.27 120.76 13.90% 9 9.2 12.2 0.246 12.1 88.36 114.99 30.40% 10 7.6 9.8 0.229 9.8 53.79 75.43 40.20% 11 9.7 13.0 0.254 11.8 95.12 109.36 14.90% 12 9.1 12.8 0.289 11.9 84.96 111.22 31.50% 平均值 18.98% 表2. 茎杆扁率和横截面积的测量结果 图4. 株高散点图 图5. 叶基角散点图 图6. 横截面积散点图 密切相关。说明使用三维激光扫描方法完全可以替代人工测量。由图6可见横截面积人工测量值和扫描方法的R 2 仅为0.8879。再次说明以圆形面积来计算茎杆的横截面积与三维激光扫描获得的真实值有一定的差距，传统方法测得的直径不能准确完全地表达茎秆水平生长方向的信息。  为了比较不同方法的稳定性，相同条件下对同一植株的株高、横截面积和同一叶片的叶基角分别进行8次重复量测，结果如表3所示。 Table 3 编号 株高(cm) 叶基角(˚) 横截面积(mm 2 ) 人工测量 激光扫描 人工测量 激光扫描 人工测量 激光扫描 1 46.5 45.56 35.6 34.71 206.49 177.36 2 45 45.61 32.8 33.97 194.82 175.85 3 44.8 45.34 31.8 34.22 133.03 175.77 4 45.6 45.47 33.5 34.9 165.47 177.72 5 45.2 45.29 32.7 34.73 134.52 171.3 6 47.7 45.56 35.3 34.54 134.26 172.78 7 46.8 45.73 35.5 34.2 188.95 177.42 8 46 45.33 32.6 34.64 172.59 175.75 平均值 45.95 45.486 33.725 34.488 166.266 175.493 标准差 0.935 0.145 1.417 0.301 27.672 2.16 变异系数 2% 0.3% 4.2% 0.9% 16.6% 1.2% 表3. 不同量测方法对株高、叶基角和横截面积的稳定性对比 三维激光扫描测量出的株高和叶基角均值与人工方法接近，截面积的差别相对较大，这与茎杆的非圆形有关。而三维激光扫描方法对于三个指标的变异系数分别为0.3%、0.9%、1.2%，远低于人工测量的2%、4.2%、16.6%，说明三维激光扫描测量结果稳定，重复性好，受人为因素影响更小。  试验中使用传统方法测量上述的12植株的株高、冠幅、茎杆直径，每株取4片叶共48个叶长、叶宽、叶面积(长宽系数法)和48个叶基角并填写在记录本上共耗时41 min。把三株植株同时扫描在一个坐标系中对同样的12个植株进行扫描，并处理获取相同指标数值，共耗时95 min。三维激光扫描方法比传统方法耗时较长主要体现在扫描前期准备上，而数据采集后在一键式测定使测定的指标量越多，时间差距越小。此外总用时在与处理时使用的计算机硬件配置也有很大关系。"
"1) 三维激光扫描技术引入植株形态量测中具有重要意义，通过相关分析和稳定性分析可知它可以高精度测量玉米形态，替代人工测量。此外，三维激光扫描的方法可以获得曲率半径、茎秆横截面积等常规方法难以获取的形态指标，为更细微深入地研究植物的三维形态结构提供一条新思路。 2) 三维激光扫描法获取的结果是数值化的三维图像，方便保存和随时查看，是植物数字化的一条重要途径。由室内盆栽拓展到野外大田，由单株监测拓展到大范围监测是进一步研究的方向。 3) 三维激光扫描技术在采集植物形态监测的应用时也存在一些不足，比如边缘效应造成测量偏差、受风吹扰动影响较大、叶片遮挡使数据获取不完整等，但是它可以对植株形态无损量测，减少人为影响，方便实现对植株的原位动态的监测。三维激光扫描技术在植物形态监测及生态修复效应方面将会形成一个新的应用领域与方向。"
