"为了提高光伏并网微逆变器的性价比，研究了一种采用阻塞二极管和偏置二极管相组合的电流采样电路，实现了无额外电流传感器的峰值电流采样，在此基础上研究了无电压、无电流传感器的最大功率点跟踪(Maximum Power Point Tracking, MPPT)方法，并提出了基于电网半周期内峰值电流采样值之和的MPPT扰动算法，产生并网电流的给定值，基于这一并网电流给定值设计了占空比观测器，从而实现了并网微逆变器的开环控制。文中研究的控制方法可在较低成本的控制芯片中实现，程序算法简单、硬件成本低。实验验证了本文研究方法的可行性，从而获得了高可靠性和高性价比。 关键词 :并网微逆变器，最大功率点跟踪，峰值电流采样，占空比观测器 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"光伏并网新能源发电是智能电网的重要组成部分，这就对光伏能源并入电网提出了高要求，各国都经过并网逆变器将光伏这一间隙性的能源送入电网 [ 1 ] 。并网逆变器经历了大规模并网发电架构、组串型并网架构，和并网微逆变器。当今分布式发电是主流市场，采用的是组串型并网逆变器，但为了避免热斑效应，提高光伏发电的利用能力，并网微逆变器已受到关注 [ 2 ] 。然而并网微逆变器相对于其它架构的并网逆变器而言存在成本高的缺点，这严重限制了光伏并网微逆变器的推广应用 [ 3 ] 。 为了提高性价比，国内外大多从电路拓扑的研究着手以简化成本和控制方法 [ 4 ] ，文献 [ 5 ] 是一种单级式的带工频升压变压器发电方案，但工频变压器体积不便于小型化；文献 [ 6 ] 研究了推挽电路一级式并网拓扑，但存在高频变压器偏磁的隐患；文献 [ 7 ] 采用了反激型电路，但设计在电流断续工作模式，故其功率密度还须进一步优化 [ 8 ] [ 9 ] [ 10 ] [ 11 ] [ 12 ] 。由于反激易于小型化，故目前市场上大多采用反激型电路作为并网微逆变器的主电路，论文在现有技术的基础上，研究控制方法以提高性价比 [ 13 ] 。 论文针对目前大多的单通道两级式并网微逆变器应用，研究了双通道光伏并网微逆变器的控制方法。即两套光伏组件共用一个光伏并网微逆变器，两块光伏组件通过各自的反激变换电路，共用一套滤波器、一套倒相逆变器和一套控制电路，显然，与目前市场上的单通道微逆变器相比，可降低成本，提高功率密度，从而提高性价比 [ 14 ] [ 15 ] 。本文为了进一步降低成本，研究一种无额外电流传感器的开环控制策略，无需通过光伏组件的电压和电流计算功率来判断是否达到最大功率点，而是根据电网半周期内开关管中峰值电流之和的大小判断，对并网电流的给定值进行扰动，从而得到最大功率点时并网电流的给定值，再根据这一并网电流给定值采用提出的占空比观测器得到反激开关管的占空比，无需传统的电流闭环控制，故算法简单，可采用低成本的数字芯片实现控制以进一步提高性价比。"
"图1给出了利用开关管压降采样峰值电流的电路原理图。TR1为反激变压器，Q1为反激高频MOS管，反激开关管驱动信号由MCU经过驱动电路得到，驱动电路的信号经过两路，一路经门极限流电阻R1控制Q1的通断，另一路送到峰值电流采样电路，峰值采样电路中的阻塞二极管D2的阴极与Q1的漏极相连，故D2的阳极电压V ip 即对应Q1中通过电流i p 时的采样电压值，V ip 再经过偏置二极管D3，抵消掉D2的管压降后经差分调理电路便得到开关管Q1中电流的采样值，送入数字芯片MCU。与传统的电阻采样、电流霍尔传感器或电流互感器采样得到电流相比，本方法能利用开关管的导通电阻就可得到电流采样值，只要偏置二极管D3和阻塞二极管D2选择相同型号，就可以获得电流的精确采样值。故可降低成本，并提高可靠性。 图1. 基于关管压降的峰值电流采样电路原理图"
"提出一种基于峰值电流的光伏并网微逆变器最大功率点快速算法。传统的最大功率点跟踪采用扰动观察法，是根据组件的电压和电流乘积计算得到功率，再根据组件输出功率的大小来实现组件给定电压的扰动，或并网给定电流的扰动，最终实现最大功率点的跟踪。 在传统的反激型并网微逆变器中，反激变换器设计在断续或临界连续状态，开关管Q1中的电流波形如图2，其中的第一部分为上一次电网半周期的峰值电流，第二部分为此时的电网半周期的峰值电流。当微逆变器实现了单位功率因数并网发电时，并网电流的相位是跟电网电压相位保持一致的，在电网电压达到最大和最小值时，这个瞬间相对的反激电路开关管中电流峰值也应达到最大值，假设在第k次电网半周期反激电路中的峰值电流是I pk_i (k)，在半周期内第i个开关周期T s 内的平均电流是I p_i (k)，光伏组件的输出电压为U i ，输出电流为I i ，组件的输出功率P PV 由公式(1)计算： 图2. 两个半周期的峰值电流示意图 P p v = U i ⋅ I i = 2 π ⋅ U i ⋅ I p _ i ( k ) (1) 假设第k次电网半周期即为当前的半周期，在当前半周期的第i次开关周期T s 内的开关管导通时间为t on ，即可计算出此时的峰值电流I pk_i (k)和单个周期内平均电流I p_i (k)之间的算数关系，可得公式(2)： I p _ i ( k ) = 1 2 ⋅ t o n ⋅ I p k _ i ( k ) T s (2) 设反激变压器原边电感的感量为L p ，根据光伏组件的输入电压U i 和MOS管中峰值电流I pk_i (k)之间的关系，能够列出公式(3)： t o n = L p I p k _ i ( k ) U i (3) 联立式(1)、(2)和(3)可得到组件功率的计算公式(4)： P i = I i ⋅ U i = L m ⋅ I p k _ i 2 ( k ) π ⋅ T s (4) 从公式(4)能得到逆变器的输入功率P i 和 I p k _ i 2 ( k ) 成正比。因在反激电路中I pk_i (k) > 0始终成立，故 I p k _ i 2 ( k ) 是I pk_i (k)的增函数(I pk_i (k) > 0)。由上述分析知，在进行最大功率跟踪时，能用I pk_i (k)是否达到最大值来判断最大功率点跟踪，而无须经过组件电压、电流的乘积计算组件的输出功率，这就节省了程序的资源，提高了算法的速度。由式(4)可见，这种最大功率点的跟踪无需采集组件的电压值。 但在实际应用中，很难通过如图1的峰值电流采样电路得到恰好对应着电网电压峰值时的开关管峰值电流I pk _max (k)，并且开关噪声不可避免。如图2，设当前电网半周期为第K个，前一个电网半周期为K − 1个的话，结合以上分析不难知道，若在并网电流增加的情况下，第K个电网半周期内的I pk_i (k)大于第K − 1个电网半周期内对应的I pk_i (k − 1)，故第K个电网半周期内所有的电流峰值之和也将大于第K − 1个电网半周期内的电流峰值之和。反之则反之。公式(5)给出了电网半周期内的电流峰值之和。 I t o t a l = ∑ i = 1 N I p k _ i ( k ) = k c o f f ⋅ I p k _ max ( k ) (5) 式中，I pk_i (k)代表一个电网半周期内每个开关周期T s 内Q1中峰值电流的大小，N表示一个电网周期内峰值电流的采样次数，I pk _max (k)为单个电网半周期内峰值电流的最大值，k coff 是个常数，相当于平均系数，故也是数字滤波，增加了电流采样的抗干扰能力。由公式(5)知电网半周期内的峰值电流之和是该半周期内最大峰值电流I pk _max (k)的单调增函数(I pk _max (k) > 0)。由于单调增函数的反函数也是单调增函数，所以I pk_i (k)也是I total 的单调增函数。这样就可以知道，P pv 是I total 的单调增函数(I pk_i (k) > 0)，故可以通过电网半周期内的开关管Q1中峰值电流之和来判断并网微逆器是否实现了最大功率点跟踪，从而实现基于开关管峰值电流之和的MPPT扰动观察法。如图3给出了程序算法流程图。"
"反激变换器的工作原理图如下图4所示。 反激变压器在开关Q1处于开通状态时，电感存储能量，当开关Q1关断，电感向后级传递能量。存在以下关系： i s _ p e a k = N ⋅ i p _ p e a k (6) 图3. 峰值电流之和的MPPT扰动观察法程序流程图 图4. (a) 反激变换器开关闭合；(b) 反激变换器开关断开 另外有： i p _ p e a k = V i n L p ⋅ t o n (7) i s _ p e a k = V o u t ( 1 / N ) 2 L p ⋅ t o f f (8) N为变压器原边与副边匝数比。实际图3中的负载为倒相逆变器，其两端电压为V out ，输出电流即为并网电流的绝对值，设电网电压 v g r i d = V g m ⋅ sin ( ω t ) ，电网电流 i g = I g m ⋅ sin ( ω t ) 。 下面分临界连续与断续模式分析原理。 1) 临界连续模式 并网电流的给定值不妨用来计算Q1的通断时间。由式(6)、(7)、(8)可计算出开关管Q1导通时间和关断时间，如式(9)和(10)。 t o n _ B C M = L p ⋅ i p k _ i ( k ) V p v (9) 可以得到Q1的关断时间为： t o f f _ B C M = L p ⋅ i p k _ i ( k ) V o u t ⋅ N 2 (10) 因是临界连续，故开关周期这t on _BCM 和t off _BCM 之和，推导出的副边电流计算公式如式(11)。 i s _ a v g _ B C M ( ω t ) = N ⋅ i _ r e f _ B C M ( ω t ) ⋅ t o f f _ B C M ( ω t ) 2 ⋅ [ t o n _ B C M ( ω t ) + t o f f _ B C M ( ω t ) ] (11) 令副边输出电流等于并网电流的给定值，得式(12)，I gm _ref 为输出电流峰值的给定。 i s _ a v g _ B C M ( ω t ) = I g m _ r e f sin ( ω t ) (12) 由此可得到在BCM模式下高频开关周期内的原边电流峰值： i p k _ i ( k ) = 2 ⋅ I g m _ r e f ⋅ [ V o u t ⋅ | sin ( ω t ) | V p v + | sin ( ω t ) | N ] (13) 将式(13)回代入式(9)和(10)便可计算出开关管Q1的通断时间。 2) 断续导通模式 当反激变流器工作于DCM模式时，并网电流基准用来控制主功率开关管S m 的关断，固定的开关周期控制主功率管的开通，因此主功率开关管S m 在固定的开关频率下工作。 由式(6)、(7)、(8)推导出DCM模式下开关管的关断时间如式(14)。 t o f f _ D C M = L p ⋅ i p k _ i ( k ) V o u t ⋅ N 2 (14) 将DCM模式下Q1的固定周期设为T DCM ，则推得副边电流表达式： i s _ a v g _ D C M ( ω t ) = 0.5 ⋅ N ⋅ i r e f _ D C M ( ω t ) ⋅ t o f f _ D C M ( ω t ) T D C M (15) 令副边输出电流等于并网电流的给定值，得式(16)，I gm _ref 为输出电流峰值的给定。 i s _ a v g _ D C M ( ω t ) = I g m _ r e f ⋅ sin ( ω t ) (16) 将式(15)代入式(16)推导出DCM模式下高频开关周期内原边电流峰值： i p k _ i ( k ) = 2 ⋅ I g m _ r e f ⋅ T D C M ⋅ V o u t ⋅ N L p ⋅ | sin ( ω t ) | (18) 将式(18)回代到式(14)便得到开关管的关断时刻。  并网微逆变器的开环控制方法如图5，采用如图3所示的峰值电流之和扰动观察法实现MPPT，MPPT算法产生并网电流的给定值I gm _ref (峰值电流)，经过占空比观测器得到反激开关管的通断时刻。 图5. 开环控制示意图 当电网电压在过零点附近时，由于反激电路输出能量较小，开关频率势必很高，故开关损耗增加，这不利于高效率和高功率密度的实现，为此可在电网过零附近按固定开关频率的断续工作模式进行控制。具体控制流程图，如图6，当系统开始运行时，计算t on 、t off 的值，再计算出反激电路的开关频f，当频率小于300 kHz时，反激电路工作在临界连续模式；当频率大于等于300 kHz时，反激电路工作在断续模式。 图6. 临界连续模式、断续模式切换流程图 相对于传统电流闭环的控制策略来讲，电流开环控制策略不需要反馈回来的电流来计算反激MOS管的占空比，而是直接通过观测计算的方法计算出反激MOS管的开通关断时间，这样就可以省去逆变后级的输出电流传感器，从而降低成本。另电流闭环控制进可以由调节器控制倒相逆变器桥臂中点输出的电压相位，从而控制输出滤波电感中的电流相位与电网相位一致，但在开环控制中，只能采用电网电压相位来控制逆变器桥臂中点电压相位，故需省去滤波电感，否则无法实现电感中电流与电网同步。由于网侧滤波电感的省去进一步降低了成本，当然并网电流的低谐波可由反激变压器的电感来实现。"
"双通道交错反激型光伏并网微逆变器的主要性能指标如表1所示。这里的MCU选择的是Mc56F8245飞思卡尔芯片。 Table 1 参数 数值 输入电压范围 24V DC ~54V DC 电网电压范围 184V AC ~265V AC 输出电压纹波 ΔV dc < 1% 额定输出功率 P o = 490 W 效率 η > 95% 功率因数 PF > 0.99 输入电流总谐波畸变率 THD < 2.4% 表1. 双通道交错反激型光伏并网微逆变器的主要性能指标 为了验证该方案是否可靠，设计与制作了实验的样机，下面给出了实验波形。 如图7，当样机开始并网发电时，电流开始逐渐增加，经过一段时间之后，电流到达最大值，并处于该值恒定输出，表明了采用图3中基于峰值电流之和的MPPT扰动观察法能稳定实现光伏组件的最大功率输出。图8所示是反激电路中开关管的驱动波形，对于双通道来说，4只开关管实现了交错控制，可以减少输入电流纹波和网侧的电流纹波，并可减小输入、输出滤波器的体积，这对降低系统成本是有利的。图9是反激电路中开关管漏源电压及其采样波形，其中图9(b)是图9(a)的展开波形，结合图1，这里的通道1是开关管Q1漏源电压波形，通道2是送到MCU的AD采样信号(AD1)，实验表明可以采用开关管的导通电阻采样峰值电流，且论文中的峰值电流采样电路的有效的。图10给出了并网电流和电网电压的稳态波形，可以看出，并网电流能很好的跟踪电网电压，且电流畸变较小，表明文中设计的占空比观测器是有效的。图11是并网微逆变器的效率曲线图，满载时的效率达95.18%。图12功率因数曲线以及电流总谐波畸变曲线，当功率增加时，其功率因数也在增大，电流谐波畸变率减小，满载时候的网侧功率因数达到0.9959，电流总谐波畸变小于2.3%，满足了双通道交错反激型光伏并网微逆变器的性能指标。实验表明论文中的控制方法是可行的。 图7. 微逆变器发电最大功率追踪波形 图8. 前级四路MOS管的驱动波形 图9. MOS管漏级电压测试波形 图10. 并网电流和电网电压稳态波形 图11. 效率曲线 图12. 功率因数曲线和电流总谐波畸变曲线"
"论文采用MOS开关管导通电阻采样峰值电流，提出了一种基于峰值电流之和的MPPT扰动观察法，得到了并网电流的给定值，基于这一并网电流给定值按断续和临界连续设计了占空比观测器，并给出了断续与临界连续切换方法，从而实现了并网微逆变器的开环控制方法。论文所研究的并网微逆变器控制方法可省去额外的电流传感器，可在低成本的数字芯片中实现算法，故能降低并网微逆变器的成本，提高性价比，有助于并网微逆变器的应用推广，获得光伏能源的高效利用。"
