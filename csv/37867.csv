"针对公共自行车站点之间的车辆分配不平衡与服务质量低下的问题，本文提出了基于服务质量角度的自行车数量配置的优化方法。根据双反射壁的随机游动原理，构建了度量顾客在租车与还车过程中无法满足需求的概率计算方法。对于顾客的到达规律服从单周期与多周期的时齐泊松过程，分别给出了不同的计算方式。最后在对到达人数，租车与还车人数之比和站点容量大小等因素进行了灵敏度分析的基础上给出了自行车配置的一些建议。为优化城市公共自行车站点的数量配置提供了参考。"
"公共自行车作为接驳公共交通的系统，可减少交通和汽车造成的污染以及解决近距离旅行，是解决“最后一公里”问题的重要组成部分。目前世界上实施的公共自行车系统很多是非营利性的(De Chardon C M et al., 2016) [ 1 ]，如Palma de Mallorca和中国的很多城市如北京等实行的都是“免费 + 低费”策略。显然，PBSS在中国还具有特殊的社会属性，是带有惠民性质的民生保障工程。如北京市通州区某站点因故停运后，市政管理部门当天就收到民众数百个投诉电话，要求恢复运行。正是这种惠民且环保的优点，让公共自行车系统有了较大的发展空间。 Demaio P (2009) [ 2 ] 指出第四代自行车系统关键特征是良好的再分配系统，随着GPS设备和高级锁技术引入共享单车，第四代的自由停(free-floating)即无桩自行车由此诞生，从2015年，无桩自行车开始在全球出现，中国尤为盛行。无桩车不用建站，降低了启动成本，用户使用自行车更方便、步行距离更短。但无站点也引发了更多新的社会问题，如乱占道和停放居民区、扰民等。Wang et al. (2019) [ 3 ] 指出这些问题在中国已经广泛显现，管理当局经过仔细考量，已经开始执行严格的管制措施，管制、注册用户增速下滑，再加上运营者缺乏有效的盈利模式，导致很多公司倒闭和退出市场，到2018年4月，共享单车运营公司已从30家减少到17家。 比起第四代无桩共享自行车市场低迷甚至萎缩，以非营利性或者主要收入非源于骑行用户为特征的第三代公共自行车系统则依然保持着快速增长势头，据Bike-sharing World Map (2019) [ 4 ]，全球现有1975座城市运行着公共自行车系统，拥有车辆1500万辆左右。而且目前第三代公共自行车也广泛应用了新技术，如Bergamo的BSSs，LaBiGi早在2015年就集成了移动APP，用户可以实时了解整个城市站点车桩车辆的可用情况(Maggioni F et al., 2019) [ 5 ]。Elliot Fishman et al. (2013) [ 6 ] 广泛分析了共享自行车系统，指出可持续发展的挑战，共享单车类型(如单程和双程等)，模式替代及影响，使用率，用户动机、偏好和意图，再平衡问题等是共享单车运营实施面临的重要问题。 基于此我们将有桩式共享单车，即公共自行车作为研究对象。当前学术界对于公共自行车的运营过程中的再平衡问题，主要集中在以下两个方面：考虑政策影响下的站点自我平衡以及车辆的调度研究。但目前对于站点借还车需求的研究中较少有学者对于还车与借车双向需求的顺序进行相关研究，从而导致难以对单车系统中需要配置的数量进行合理的预测。并且由于各个站点所处的区域不尽相同，其服务的客户以及车辆的借还规律都有其自身特点，对于其需求进行深入分析研究十分必要。"
"共享单车在运营过程中最重要因素就是满足用户不同需求的能力，在对日常需求统计分析的基础之上，必须对单车的投放进行系统的规划与管理，以最大限度的减少顾客需求无法被满足的概率，提高客户的满意度。 首先对共享单车的单个站点进行分析，发现顾客需求无法被满足主要有以下两种情况:一是用户到达车站取车时，发现车站是空的，无法取车，二是当用户到达车站还车时，发现车站已无空车桩，无法还车，这两种情况都应尽量避免。 考虑服务质量的单站点最优车辆配置的定义如下：已知一个站点的容量为C，即有C个车桩，根据租赁点各个时段的借还车数据，在分析其借还规律的基础上，计算出站点应配置的数量与相应的车辆调度策略。设单个时间段内λ为取车人数参数，μ为还车人数参数，总的到站人数参数为λ (λ = λ + μ)。多个时间段的取车与还车需求可为时齐多周期分布，在对还车与借车双向需求的顺序进行研究的基础上，对不同的需求分布，建立相应的需求未满足概率的计算模型，合理的确定出站点的最优配置数量。 该问题的研究目的是确定在一段时间内站点车辆配置的最优数量，以及最优的车辆补充策略，使得顾客无法取车或还车的情况得到有效控制。"
"各符号说明如下表1。 Table 1 标号 意义 C 站点容量，即有C个车桩。 λ 记取车人数服从参数为 λ 的泊松分布。 μ 记还车人数服从参数为 μ 的泊松分布。 j 在站点中投放j辆单车，并以j点为初始状态点。 j ∈ ( 0 , C ) q 站点车辆减1的概率，在图中状态点向左移动。 q = λ / ( λ + μ ) p 站点车辆加1的概率，在图中状态点向右移动。 p = μ / ( λ + μ ) p i 为站点有i辆单车的概率，即经过状态转移后处于状态点i的概率。 p j k 为车辆数从状态点j转移至状态点k的概率。 n 总的取车和还车事件发生次数为n p j k ( n ) 为在经过n步转移之后由状态点j转移到状态点k的概率。 η w 在一段时间内，取车失败的比例。 η r 在一段时间内，还车失败的比例。 T 表示将整段时间分为T长度相同的子区间。 T ∈ ( 1 , t ) SL 表示一段时间内未得到服务的人数。 表1. 参数 针对一个公共自行车站点，车桩数为C，站点的一个事件指的是一个租车需求或还车需求的产生。设在一段时间段内租车需求服从概率分布f，还车需求服从概率分布g。那么该站点有一个租车需求时，如果站点车辆大于0，则站点车辆数量减1；如果站点车辆为0，则该租车需求未被满足，站点车辆数量仍为0。站点有一个还车需求时，如果站点车辆小于C，则站点车辆数量加1；如果站点车辆为C，则该还车需求未被满足，站点车辆数量仍为C。由此，该站点在站的车辆数量构成了一个特殊的马尔科夫模型，即带有两个反射壁的随机游走模型，0和C是两个反射态。则有从高状态到低状态转移的概率为q，从低状态到高状态的概率为1 − q。如图1所示。 图1. 带有两个反射壁的随机游动 该随机游动的状态空间为 I = { 0 , 1 , 2 , 3 , ⋯ , c } ，0，c两状态为反射态。其一步转移概率为： p 0 , 0 = q ;     p 0 , 1 = p ;     p 0 , j = 0     ( j ≠ 0 , 1 ) p a , a = p ;     p a , a − 1 = q ;     p a , j = 0     ( j ≠ c − 1 , c ) 该马尔科夫模型的转移概率矩阵为 P = ( p 00 p 01 p 02 ⋯ p 0 C p 10 p 11 p 12 ⋯ p 1 C p 20 p 21 p 22 ⋯ p 2 C ⋮ ⋮ ⋮ ⋱ ⋮ p C , 0 p C , 1 p C , 2 ⋯ p C , C ) = ( q p 0 ⋯ 0 0 q 0 p ⋯ 0 0 0 q 0 ⋯ 0 0 ⋮ ⋮ ⋮ ⋱ ⋮ ⋮ 0 0 0 ⋯ 0 p 0 0 0 ⋯ q p ) 目标是在一段时间(设为T，如一个工作日)开始前，为站点配置车辆数j，显然 j ∈ [ 0 , C ] ，使得该站点在T时间段内租车、还车需求未被满足的概率最低。 为此，本文设计了以下算法：  共享单车系统由一组站点组成，在经注册后的用户可以在任何时间任何站点取走一辆单车，在经过一段时间的使用之后将其返回到另一个站点。而服务质量可以通过一个站点无法满足客户需求的概率来衡量，要么无法满足取车需求，要么是无法满足还车需求。所以本研究所考虑的共享单车系统服务质量的度量，是结合两种可能的需求不被满足情况下的服务质量度量：1) 想要取车的用户发现车站已空的概率；2) 想要还车的用户发现车站已满的概率。 首先我们把在一段时间内的取车失败的量与还车失败的量分别记为 η w ， η r 。所以在这段时间内的服务质量定义为 M = η w + α η r 。在此 α 是用来加权平衡两种因素的重要性，在下文中 α = 1 即默认两种服务中产生的损失同样重要。 1) 时齐单周期条件下的计算 步骤一：根据租车和还车的概率分布，计算如一个事件发生，这个事件是租车事件的概率 q = λ / ( λ + μ ) ，显然，还车事件的概率为 1 − q = μ / ( λ + μ ) ； 步骤二：根据带有两个反射壁的随机游走模型，以及步骤二计算的租车还车事件概率，得到该转移概率矩阵P，计算矩阵n次幂 P n ， P n 矩阵的元素 p j k ( n ) 就是经过n步租还车事件后，在站车辆数为k的概率； 步骤三：计算在时间段T结束后，在站车辆数量为 k ∈ [ 0 , C ] 的概率 p j k ，公式为 p j k = ∑ n = 0 ∞ p j k ( n ) ⋅ p ( x = n ) = ∑ n = 0 ∞ λ n n ! e − λ p j k ( n ) ，由于 p j k ( n ) 在n比较大时，趋向于极限概率，所以计算该无限 序列时，只要 p n 值小于一个设定的值即可终止。 由于该模型是不可约遍历马尔科夫链，其极限概率就是长程比例，所以 p j k 为在时间段T间，站点处于状态k(即有k辆车)时间所占比例的期望值； 步骤四：计算期初在站点部署j辆车的情况下，租车未满足率(概率)为 λ λ + μ p j 0 ，还车未满足率(概率)为 μ λ + μ p j C ，所以，总未满足率为 λ λ + μ p j 0 + μ λ + μ p j C ； 步骤五：确定站点部署车辆最佳数量 j * ，使总未满足率最小，即 j * = min ( λ λ + μ p j 0 + μ λ + μ p j C ) 。 2) 多周期条件下的计算 步骤一：将时间窗口离散化，把一段较长的时间分隔成t个长度相同的子区间，且每一个子区间的取车与还车分别服从参数为 λ t , μ t 的泊松分布。 步骤二：计算单个子区间内有j辆车情况下的服务损失量 p ( x = n ) = λ n n ! e − λ (3.1) E ( S L t w | j ) = λ t ∗ ∑ n = 0 ∞     p ( x = n ) q j 0 ( n )       ( j = 0 , 1 , ⋯ , m ) ,   t ∈ ( 1 , T ) (3.2) E ( S L t r | j ) = μ t ∗ ∑ n = 0 ∞     p ( x = n ) q j m ( n )       ( j = 0 , 1 , ⋯ , m ) ,   t ∈ ( 1 , T ) (3.3) p 1 ( i , l ) = ∑ n = 0 ∞     p ( x = n ) q i l ( n )       ( i = 0 , 1 , ⋯ , m )     ( l = 0 , 1 , ⋯ , m ) (3.4) 由于服务质量的损失只会在状态的边界点产生，所以边界点的概率乘以取车或是还车的概率即可得到服务质量的损失值。 p 1 ( i , l ) 为期初在投放i辆车的情况下，时间段末有l辆车的概率 步骤三：计算下一段内的服务损失量 E ( S L t w ) = ∑ i = 0 m     E ( S L t w | i ) p t − 1 ( i )       t ∈ ( 2 , T ) (3.5) E ( S L t r ) = ∑ i = 0 m     E ( S L t r | i ) p t − 1 ( i )       t ∈ ( 2 , T ) (3.6) p t ( l ) = ∑ i = 0 m   ∑ n = 0 ∞     p ( x = n ) q i l ( n ) p t − 1 ( i )       ( l = 0 , 1 , ⋯ , m ) ,     t ∈ ( 2 , T ) (3.7) 步骤四：计算一段时间内总的服务质量损失 S L ^ w = ∑ t = 1 T     E ( S L t w ) (3.8) S L ^ r = ∑ t = 1 T     E ( S L t r ) (3.9)"
"在本文中服务损失量是指顾客无法在站点取车或是还车的状况，且这种状况只有在站点无车或满车的状态下发生，即在站点无车之后，如下一个到来的客户是取车的，由于无法取到车辆此时会产生服务质量的损失。假设我们已经获得区域内单个时间段的取车人数与还车人数，且用户的规律到达的规律服从泊松分布。在投放数量与投放成本不受限制的情况下，此时只需考虑投放合适的车辆数使服务质量损失最低即可。   从表2，图2结果可以看到，在取车人数多于还车人数的情况下，如果投放的车辆数较少，易造成客户无车可取的现象。但随着投放量的增加，这种无车可取的情况会逐渐减少，但另一方面如果车辆投放过多，无桩可还的概率又会迅速提高，所以根据本文的计算，在 λ = 8 ， μ = 6 的情况下投入13辆单车会使服务损失概率降至最低。而在 λ = 16 ， μ = 12 时可以在此站点投入17辆左右的单车，此时无法取车的人数与无法还车的人数都处于较低水平，达到了提高站点服务质量的目的。当 λ = 32 ， μ = 24 时，可以看到服务质量的损失率随着投放量的增加而不断减少，无先减后增的情况，产生这种现象一是因为取车人数与还车人数相差大，二是因为站点的高客流量。 Table 2 总人数 借还车人数参数 最佳配置车辆 服务损失率 服务损失量(人) λ = 7 λ = 4 , μ = 3 11 0.0002 0.002 λ = 14 λ = 8 , μ = 6 12 0.0047 0.066 λ = 28 λ = 16 , μ = 12 16 0.0192 0.536 λ = 56 λ = 32 , μ = 24 20 0.0365 2.045 λ = 112 λ = 64 , μ = 48 20 0.1018 11.396 表2. 借还车人数影响的分析 图2. 单站点单个时间段的服务损失率 从上面的计算结果可以看出，投放的车辆数，不仅会受到状态转移概率的影响，而且会受到借还车次数的影响。所以可以得到以下结论： 1) 取车人数与还车人数比例相差越大，那么需投放的车辆数就越多(越少)。 2) 在一段时间内且借还车比例相同情况下，到达车站的人数越多，需要投放的车辆数就越多(越少)。  表3、图3结果为总人数相同，还车与取车参数比例不同时的服务损失率对比，(上图中取车人数多于还车人数)可以看到当取车人数与还车人数相等时，两种损失的比例也相同，且在投放10辆单车时会使总的服务损失率达到最小。并且随着两者差值的变大，无桩还车的概率会逐渐变小，而无车可取的概率会明显增加。在另一方面我们发现由于空车的服务损失率随着投放车辆的增加，下降较为迅速，在 =16， =14的情况下，投放8辆车时服务损失率已只有5%左右，达到了较为理想的水平。 可以得出以下结论：当需要考虑投放成本时，车辆的投放数量会受到限制，在把服务损失率控制在一定范围内的情况下，可适当减少车辆的投放，达到提高服务质量与降低运营成本的效果。 Table 3 总人数 借还车人数参数 最佳配置车辆 服务损失率 服务损失(人) λ = 30 λ = 15 , μ = 15 10 0.0232 0.7 λ = 30 λ = 16 , μ = 14 13 0.0228 0.69 λ = 30 λ = 17 , μ = 13 16 0.0209 0.6 λ = 30 λ = 18 , μ = 12 20 0.01667 0.5 λ = 30 λ = 19 , μ = 11 20 0.0168 0.5 表3. 借还车人数比例影响的分析 图3. 不同取车参数比例的服务损失率  下面将一段时间分为连续的5个小时间段，时段1，2模拟取车高峰期，时段4，5模拟还车高峰期，每个时段的总人数参数λ均为30。 从表4、图4可以看到受时段1取车人数较多的影响，在借还活动开始前，投入20辆公共自行车，即可让整个时间段的累计损失人数降到最低。这是因为，经过取车高峰期的影响，已将站点库存车辆降至较低水平，正好符合了还车高峰期对于车桩的需求。所以整体的损失人数达到了较低水准，相比于投放站点容量的一半(投10辆自行车)这种简单投放策略，损失人数减少了45%左右。另外，当取车人数与还车人数差值过大时，无法取车或无法还车的人数将大大增加，仅对站点配置一次车辆，将无法有效减少服务损失人数。所以增加配置车辆的次数将是合理的选择。 Table 4 时间段 借还车人数参数 最佳车辆配置(辆) 累计的服务损失(人) 时间段1 λ = 19 , μ = 11 20 0.5 时间段2 λ = 16 , μ = 14 20 1.3 时间段3 λ = 15 , μ = 15 20 2.0 时间段4 λ = 13 , μ = 17 20 3.3 时间段5 λ = 12 , μ = 18 20 7.2 表4. 各时段最佳车辆配置分析 图4. 各时段的服务损失人数的累计量"
"自行车共享系统已在世界各地的许多城市得以实施，并日益普及。在这些系统中，一个主要的运营成本驱动因素是随着时间的推移对自行车进行重新平衡，以确保用户有适当数量的自行车和空余的车桩可以使用。对于服务水平需求的确定，本文通过建立双反射壁的随机游动模型，在给定初始库存与人流量之比的情况下，计算出了车站无法取车的概率，与无法还车的概率。并且通过灵敏度分析，得出取车与还车人数之比，人流量大小和初始库存的数量等因素对该站点服务水平的影响，为公共自行车站点的车辆配置提供了一定的参考。"
