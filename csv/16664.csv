"近年来能源和环境问题受到各国重视，采用大量可再生能源的微电网技术快速发展。对微电网进行能量管理可以保证微电网安全高效的运行。本文针对微电网的能量管理问题，阐述了微电网能量管理系统物理层的控制结构与方法、软件层架构与算法，在此基础上开发实现了基于本地服务器的能量管理系统软件平台。平台由服务器、数据库、后台进程、Web网页四部分构成。服务器端系统采用ASP.NET结合MFC开发，连接MySQL数据库，储存微电网状态信息及读取历史用发电信息。用户通过动态刷新的Web网页，实时查看微电网运行状况并进行管理，人机界面友好。后台系统根据给定时间间隔执行预测和调度算法。本系统实现了对微电网的实时监控、发用电预测、储能调度优化和信息综合管理。 关键词 :微电网，能量管理系统，软件平台，储能调度，ASP.NET"
"近年来，接入大量可再生能源发电的微电网架构在各国快速发展。 可再生能源发电的间歇性，这使得微电网的能量管理对于微电网的高效、稳定运行十分重要。 短期功率平衡和长期能量管理是微电网能量管理系统的两个主要任务[ 1 ] 。前者使微电网稳定运行，后者针对不同运行目标的微电网经济调度和优化运行。微电网能量管理系统控制结构分为集中式(CS Centralized System)和多代理式(MAS Multi-agent System) [ 2 ] ，如日本的Kyotango微电网工程 [ 3 ] 。多代理式结构以希腊国立大学的NTUA微电网为代表 [ 4 ] 。集中式控制存在对中央控制器依赖强，分布式电源无法即插即用的不足，但其控制技术成熟，成本低，维护方便，因此使用广泛。本文主要针对集中式的控制结构。 下面从软件架构和调度优化上，介绍现有研究状况。软件架构上，现有研究 [ 5 ] - [ 7 ] 考虑到智能电网内智能电器、三网合一，和智能电网的高级计量架构(AMI)的研究现状，提出微电网能量管理的软件功能结构。调度和运行优化上，微电网能量管理主要有信息预测和调度优化两方面工作。发电预测有基于数值天气预报模型的预测方法和基于历史数据的预测方法，负荷预测考虑负荷种类、需求侧相应等因素故相对复杂，有待进一步研究 [ 8 ] 。调度优化采取求解多目标函数加权得到的单目标问题，或通过多目标算法求最优解。文献 [ 9 ] 建立多约束条件下的多目标优化模型，并对离网和并网微电网采用不同控制方式。文献 [ 10 ] 基于改进遗传算法对微网能量管理进行优化。现有微电网能量管理的调度优化算法的研究，大多采用遗传算法 [ 9 ] [ 10 ] 、粒子群算法 [ 11 ] 、前向DP算法 [ 12 ] 等算法解带约束的多目标优化问题。 然而，现有研究中 [ 5 ] - [ 7 ] 从电网公司角度考虑较多，对于用户的可视化程度低，软件实现的介绍也较简略。优化调度得出的最优解主要考虑小时级的优化调度，对并网微电网更短时间尺度的储能管理涉及较少 [ 9 ] - [ 12 ] 。文献 [ 10 ] 使用的Sybase数据库在可伸缩性与平台兼容上不如本文所用的MySQL。本文设计实现了一个B/S架构的微电网能量管理系统软件平台。对超短期的储能调度也进行优化设计，更加注重用户体验，具备良好的可移植性。实现了微电网运行状态实时监控、用发电及气象状态预测、储能调度、用户信息维护等功能，对微电网进行集中式管理。"
"微电网是相对于大电网一种新型的发配电架构，它是由分布式电源、负荷、储能、变流器及监控保护设备组成的小规模电网 [ 13 ] 。它既能够和大电网并网运行，也可以离网孤岛运行。其中分布式电源指大量能够发出电能的小型设备，相比传统电网邻近电力用户。分布式电源有电力成本低、可靠性高、安全性高、对环境影响小等潜在优势，可以显著降低碳排放量 [ 14 ] 。微电网负荷主要包含用户的用电负荷和少量的线路损耗负荷。实现负荷的优化分配对于优化微电源的出力、节约发电成本有重要的意义。储能装置在微电网中可以起提供短时供电、电力调峰、改善电能质量、提高微电源性能等作用，现阶段可利用的储能装置有蓄电池、超导磁、飞轮、压缩空气、超级电容、抽蓄水储能等，电动汽车未来也有作为储能装置并网输送电能的潜质 [ 15 ] 。  为解决分布式电源受环境影响大、发电量不稳定引起的诸多问题，保证微电网高效稳定的运行、实现能源效益最大化，为微电网设计全面的能量管理系统至关重要。一套合适的微电网能量管理系统至少应具备如下功能： 1) 预测分布式电源发电量、发电功率等状态量，提前制定发用电计划，从而实现发电模块的优化调度。 2) 实时显示微电网的拓扑结构和各个开关状态，监测其中各模块、节点、线路的电压和功率，并存入数据库中，使用户可以直观了解微电网的当前运行状态。 3) 根据用户设置和实时微电网运行状态进行负荷管理和储能管理，通过管理可控负荷以及控制储能装置充放电使微电网安全平稳运行。"
"分布式电源的常见控制方法有恒功率控制，下垂控制和恒压恒频控制三种 [ 16 ] 。 1) 恒功率控制(PQ control) 恒功率控制是将分布式电源输出的有功功率、无功功率都维持在给定值的附近。其原理是由有功、无功功率控制器分别按频率、电压的下垂特性曲线对工作点进行调整。即对于一个含有分布式电源的微电网，保持输出的有功和无功均不变，而不根据分布式电源端电压、频率进行调整。当系统中有维持频率和电压的分布式电源或与大电网相连时才能采用此方法。 2) 恒压恒频控制(V/f control) 恒压恒频控制的特点是输出电压的频率，幅值不随分布式电源输出功率的变化而变化。即分布式电源输出的有功、无功改变都不影响其输出频率，且电压幅值为额定值。该方法大多用于主从控制策略中控制主分布式电源。 3) 下垂控制(Droop control) 下垂控制是通过分布式电源输出有功功率与频率的关系、无功功率与电压幅值的关系进行控制，这种关系在局部可以看作线性的。即当分布式电源输出有功增加时，频率线性减小，当无功增加时，电压幅值线性减小。"
"在微电网能量管理系统(EMS)中，EMS监测软件发挥了巨大的作用，它通过风光储协调控制，保证整个微电网系统的稳定控制和经济运行。 本文设计了一个微电网系统中可用的微电网能量管理系统软件。采用Web网页的形式发布，用户可以通过浏览器中输入网址从而查看到微电网运行情况和能量优化管理运行效果。  软件功能主要包括： 1) SCADA监测功能(数据采集与监视系统)。用户可以通过SCADA界面观察到整个微电网中各个微源(风机、光伏和储能)、PCC连接点、母线、各条负荷馈线等的实时电压、电流、功率值等。同时用户可以观察到每条线路上的开关状态。SCADA界面包含整个微电网系统的网络拓扑结构展示，可以使用户从全局上了解整个微电网的运行情况。 2) 发用电预测功能。通过后台运行光伏发电预测算法和负荷预测算法，通过图表的形式显示出第二天的发用电量计划，并且与实时的光伏发电量、负荷对比，给用户察看。 3) 小时调度和分钟调度功能。储能调度算法包含一小时运行一次和每十分钟运行一次的超短期调度算法。通过后台算法的执行，可以在界面上查看到每组储能的日调度计划以及短期调度计划、PCC点联络线功率和每组的SOC值。 4) 气象功能。因为光伏预测是基于预测天的气象的，所以通过网络接口访问中国气象网从而获取预测天的气象和当前时间的实时气象信息，提供给用户查看和采用寻找相似日算法的光伏预测算法使用。 5) 维护信息功能。界面提供给用户查看系统运行中的一些告警信息和故障信息等，从而方面用户对系统维护。 6) 登陆界面和用户信息维护界面。完整的管理系统软件包含用户登陆界面，同时也包含最基本的注册新用户、修改密码、删除用户等功能。 网页界面通过与MySQL数据库交互数据，显示给用户，后台的预测算法和调度算法通过MFC程序与数据库交互，将算法预测得到的结果和计算得到的结果存入数据库中，提供给Web界面显示。由于用户界面是通过Web的形式发布到局域网中，因此在服务器上安装了IIS (互联网信息服务)容器，并且在服务器上运行通过MFC编写的算法程序。  软件的总体架构如图1所示，人机界面程序采用Web界面显示的方式，采用B/S架构，网站发布到服务器中，在浏览器中可以查看微电网能量管理系统。数据库采用MySQL数据库，在MySQL数据库中有历史数据表，主要用于存放一年的历史数据信息、实时数据信息、气象、维护信息、发用电预测值、储能调度计划和用户信息。通过与MySQL数据库交互将数据库中信息进行处理后显示在Web网页界面。同时，后台运行发用电预测算法和储能调度算法，将计算所得结果存入MySQL数据库。  本文软件主要包含三个大模块：Web界面、MySQL数据库和后台预测和调度算法。  Web界面包含6个主要部分：SCADA监测界面、发用电预测界面、小时调度界面、分钟调度界面、维护界面、登陆界面、用户管理界面。每个界面的主要功能说明如表1所示。 为了实现网页界面的局部实时刷新，本文采用了AJAX异步无刷新技术。减轻了服务器的负担，节约了空间和带宽，也获得了更好的用户体验。 图1. 软件总体架构 Table 1 主要部分 功能说明 SCADA监测界面 实时显示微电网运行信息，包括每个微电源的电压、功率，开关状态、联络线功率等 发用电预测界面 动态刷新显示光伏预测和负荷预测算法执行所计算得到的数据 小时调度界面 动态图表显示每组储能每天的小时级调度指令计划 分钟调度界面 动态图表显示每组储能电池和PCC功率调度计划 登陆界面 提供用户登录接口 用户管理界面 提供用户管理和维护功能，报告添加、修改、删除用户等功能 表1. Web界面主要功能  MySQL数据库模块主要包括一个名为Web的数据库，里面包含有历史数据表、气象表、用户表、预测信息表和调度信息表。数据库中每个表的功能及作用说明如表2所示。  后台预测和调度运行算法模块是一个MFC主进程程序，主要包括两个定时器的控制和执行。程序主要执行两个定时器进程。一个是十分钟定时器模块，执行超短期预测算法和调度算法，一个是一小时定时器模块，执行小时级的预测算法和调度算法。算法模块封装成dll动态链接库的形式提供给主进程调用，并将计算得到的结果存入数据库中。 光伏预测算法是采用的基于相似日气象的算法，通过从网络接口获得预测天的气象信息，基于一年的历史光伏发电信息数据，查找到和需要预测的气象相似的日期的光伏发电量，从而预测出预测天的光伏发电量。 负荷预测算法同样是基于历史负荷用电量进行预测。 Table 2 表 功能及作用 历史数据表 包含366个表格，存储前一年的每天的光伏、负荷等信息值 气象表 存储前一年的所有的气象信息，每天的最高温、最低温、天气状况等 用户表 存储用户信息，用户名、密码等 预测信息表 存储每次执行预测算法所得的数据 调度信息表 存储小时级和分钟级下发的调度指令信息 表2. MySQL数据库功能说明 算法实现如下所示： 1) 开辟Data数组存放历史数据； 2) 查找有关相似日； 3) 根据查找到的相似日发电量和负荷值预测明天的发电量和用电量。 储能装置的调度分配是基于预测算法得出的值，从而对明天的微电网运行给出3组储能的调度分配计划和PCC点功率情况。调度储能充放电量采用的是遗传算法求解。 主要步骤如下： 1) 编码，将初始方案进行编码； 2) 选择，选择遗传到下一代中的编码； 3) 变异，通过变异得出新的子个体调度方案； 4) 交叉，通过子个体之间的交叉得到新的一代，从而重复上面的过程，一步一步得到最优的调度算法。  软件的运行流程图如图2所示。   通过调试运行，Web界面和数据库交互，可以实时显示数据库中的信息，并且可以通过数据库的交互，将气象、设置、维护等信息存入数据库。 Web界面测试效果如图3所示。  为了更好的显示效果，在进行软件测试的时候，将小时级算法和分钟级算法分别设为18秒和3秒执行一次(如图4)。运行主程序，可以观察数据库中的数据看到程序运行结果，也可以直接通过Web网页更直观形象地查看算法运行能量优化管理效果。"
"本文考虑微电网稳定运行及优化的需求，分析了功能目标和架构模式，采用本地服务器与Web网页的集中式B/S架构，搭建了微电网能量管理系统的软件平台。在实现基础的实时监控和信息管理上，实现了负荷与发电预测。采用短时和超短时的负荷预测算法，根据历史数据信息和遗传算法计算预测负荷。按照气象预报信息与实测值预测发电量，对储能调度优化了储能配置。本文的工作对实现微电网平稳运行和与配电网良性互动积极意义，提高了微电网能源利用效率，Web网页对微电网可视化的呈现也有助于推广绿色、节能的微电网。 图2. 软件流程图 图3. 运行界面测试效果图 图4. 主进程后台辅助软件测试效果图"
