"睡眠是人体必不可少的一项生理活动。通常，专家将病人整夜的脑电EEG数据以30秒为一帧进行睡眠状态分期并据此进行睡眠状态的分析与评估。然而，依靠人工标记睡眠数据需要消耗大量的精力。另一方面，专家的主观判断也会对分期结果带来误差。所以睡眠的自动分期就变得很重要，本文将介绍近年来的睡眠分期方法，分别是基于统计规则分期方法与基于深度学习技术的分期方法。在统计的分期方法中，介绍了三个重要的过程，预处理、特征提取以及分类器的选择。在基于深度学习的分期方法中，介绍了多层神经网络、卷积神经网络、长短时记忆神经网络以及不同网络组合的神经网络。最后我们对睡眠分期的研究进行了讨论, 认为深度神经网络将是未来睡眠分期研究主要方法。 关键词 :睡眠自动分期，睡眠脑电，深度学习 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"睡眠是一项与人体健康有密切关系的生理活动。研究发现，人的一生中，有约三分之一的时间处于睡眠的状态，对于新生儿来说，一天中有二十个小时处于睡眠状态。良好充足的睡眠可以让人精力充沛，在面对日常的工作学习生活时，可以做到轻松应对，事半功倍 [ 1 ] 。而且，睡眠也有助于缓解疲劳，恢复体力。研究发现，睡眠是伤口愈合最快的时期。因此，国际社会公认的三项健康标准之一就是拥有良好的睡眠。中国睡眠研究会在2003把“世界睡眠日”正式引入中国 [ 2 ] 。 随着现代社会的生活节奏越来越快，越来越多的人面临睡眠问题的困扰。偶尔失眠会导致身体的轻微不协调；长时间的睡眠不足会造成记忆力衰退，工作效率低下等问题 [ 3 ] 。根据世界卫生组织的统计，全世界的睡眠障碍率达到27%。而在中国，成年人的失眠率已经达到38.2%，也就是说，超过3亿中国人受到睡眠问题的困扰，而这一数据目前还在不断地增长。在90后中，能够保持健康睡眠习惯的只有17%。老年人睡眠障碍患病率则为35.9%，睡眠障碍已经成为困扰中国人的最大问题之一 [ 4 ] 。 目前，越来越多的科研工作者开始关注睡眠问题。而作为睡眠问题研究基础的睡眠分期也得到更多人的关注，只有对睡眠进行正确的分期，才使得对睡眠问题的进一步研究成为可能。"
"十九世纪之前，睡眠的研究几乎处于空白状态。到了十九世纪，各种睡眠理论开始涌现，脑电图等电生理技术被应用于睡眠研究。1928年，德国学者发现人在睡眠状态和觉醒时，其脑电信号的变化节律不同 [ 5 ] 。1937年，基于脑电图，睡眠被分为5个时期。1953年，Aserinsky和Kleitman发现了睡眠中眼球的快速转动，即快速眼动睡眠期(Rapid Eye Movemrnt, REM)被发现。随后，为了能够对睡眠进行定量分析研究，R&K标准被制定。这一标准由Rechtsehafen与Kales于1968年提出。R&K标准对睡眠中出现的6个阶段进行划分。除了清醒期(Wake, W)，睡眠可以分为快速眼动睡眠相(Rapid Eye Movemrnt, REM)和非快速眼动睡眠相(Non-Rapid Eye Movement, NREM)。其中，非快速眼动期又可以分为睡眠一期(S1)到睡眠四期(S4)四个时期。其中S1和S2为浅睡眠，S3和S4为深睡眠。 为统一睡眠分期的不同标准，美国睡眠医学会(American Academy of Sleep Medicine, AASM)制定了全新的标准——AASM标准并正式发布《睡眠及相关事件判读手册》，该手册首次规范化了睡眠相关规则术语和判别方法，这具有划时代的重要意义。这一判读标准将原有的六个睡眠时期变更为5个 [ 6 ] 。别是清醒期(Wake, W)、三个非快速眼动期(Non-Rapid Eye movement, N1, N2, N3)以及一个快速眼动期(Rapid Eye Movement, REM)。R&K标准和AASM标准的关系如图1所示。 图1. R&K标准和AASM标准关系图 人类的大脑皮层之中有大约140亿个神经元，这些神经元形态各异，功能也不尽相同。然而，总体上可以将神经细胞分为细胞体和突触两个部分。突触又可以被分成树突和轴突两种情况，树突的主要功能是将外界的刺激冲动传入细胞体，进行进一步的处理。而轴突的功能是将细胞体的冲动传递到另一个神经元或者功能细胞。 进一步的研究发现，脑电信号是神经元的突触后电位的变化形成。一个神经元的电位变化很微小，但是大量的神经元细胞在同一时间发生变化，就会形成明显引发大脑皮层的电位变化，出现明显脑电信号 [ 7 ] 。 通常情况下，脑电信号的波幅最大不会超过100 uV，这是一种极其微弱的信号。因此脑电信号的监测需要特定的专业设备获取。专业医学领域，通常使用多导睡眠记录仪来完成这项工作。现阶段市场上的睡眠记录仪有很多，但是基本结构大同小异，一般由电极、信号放大器、存储器以及显示屏等组成。 放置电极的时候要采用国际标准的10~20系统电极放置法 [ 8 ] 。该方法的实施步骤如下：首先在头皮部确定两条直线：第一条直线是鼻根到枕骨部的连线，第二条是两只耳朵之间的左右方向的连线。两条直线的交点，也就是颅顶位置，是Cz电极。从鼻子根部往后量大概10%的地方是FPz (额部中线)，从FPz再向后量每一个20%都放置加一个电极，则依次定义位置Fz、Cz、Pz以及Oz。FPz-Cz是多数研究者的选择，因为这一条通道是脑电记录中的典型通道。 脑电信号的频率一般在0.5~30 Hz。一般会按照频率、波幅的范围进行对脑电波进行分类，以此来表示睡眠过程中出现的各种特征波形。典型的睡眠特征波如下。 β波：常见于清醒期，频率大于13 Hz，没有标准的振幅和形态。 α波：常见于安静时闭眼状态和REM时期，频率在8~13 Hz。睁眼时消失。没有标准的振幅和形态，往往表现为渐变状。老年人的频率和振幅降低。主要出现在枕部的EEG中。 θ波：常见于N1期的后期，频率在4~7 Hz之间，没有标准的振幅和形态，波幅通常大于50 uV。有时是短阵高压电波。在中央部位很明显。 颅顶尖波：常见于N1睡眠期后期，外形尖锐，与背景是明显不一样的。没有一定标准的幅度和形态，持续时间通常小于0.5秒。 睡眠纺锤波：常见于N2，N3时期，有着规则的外形，频率为11~16 Hz (通常是12~14 Hz)，时间一般都会大于0.5秒，主要位于中央部。 K复合波：常见于N2期，是N2期的特征性电波。没有标准的频率，在背景中很突出，有一个标准的形状：先是一个向上的负向波紧接着一个向下的正向波。时间大于0.5秒。通常在颈部是最明显的。 δ波：常见于慢波睡眠中，频率在0.5~2 Hz，通常情况下，波幅大于75 uV，出现在N2期的时候，所占比例低于20%，如果出现在N3时期，所占比例大于20%。 锯齿波：常出现于REM时期，频率在3~7 Hz，形状为尖锐的三角形波。值得一提的是，REM时期的锯齿波其实就是θ波。 下面介绍现在通用的AASM分期标准： 应用的方法是逐屏分期，将每一个30秒定义为一屏，按照顺序进行分期，分期过程中，不允许将相邻的两屏组成一个新的阶段。但是在实际分期的过程中，经常会遇到一个屏之中含有多个时期的情况，这时将这一屏分为占比例大的时期。另一种极端的情况是，如果这一屏没有出现任何的睡眠特征，那就需要根据之前或之后一屏进行分期。 成年人睡眠的分期规则如下： W期：在一个人的清醒状态下，EEG通常有两种表现，一种是低电压混合波，频率在16~25 Hz。第二种是α波。当α波出现而且占的比例高于50%时，就可以判断这一时期是睡眠清醒期。即使没有出现α节律或者说出现的α节律不清晰，但如果出现了清晰的眨眼或者阅读性的眼球运动，或者快速的眼球运动，也就是不规律呈现尖峰状的眼电运动，也可以判读为清醒期。 N1期睡眠：这一时期的睡眠是清醒期到其他睡眠时期的过渡阶段，也是睡眠时期出现体动后到再次入睡的过渡阶段。当α波所占的比例已经不超过50%，背景波是低波幅混合波的时候，就可以将此一时期判读为N1期。如果没有出现明显的α波，但是出现了范围在4~7 Hz的脑电波，或者是出现了颅顶尖波以及明显的眼球运动，都可以判别是N1期睡眠。 N2期睡眠：这一时期的特征是出现睡眠纺锤波以及非觉醒相关K复合波。当出现一个睡眠纺锤波或者K复合波，将此时期判读为N2期睡眠。此一时期内，眼球运动已经很少，肌电活动已经比清醒时低很多。N2期结束之后如果出现了觉醒的情况，则判读为N1期。 N3睡眠期：当δ波出现的比例高于20%，可判读为N3时期，这一时期内，睡眠纺锤波可能持续出现，已经没有眼球运动，肌电活动水平达到最低。 REM睡眠期：这一时期内，出现了低电压的θ波，低频率的α波(但是会比清醒时期的α波慢1~2 Hz)，并且会有一定数量的锯齿波的出现 [ 9 ] 。可以观察到快速眼球运动。肌肉的活动水平则会达到整个晚上的最低水平。几乎接近于一个平坦的状态。总体来说，当出现了低波幅混合波，低的肌肉活动水平以及快速的眼球运动就可以将这一时期判读为REM睡眠期。这一时期之后，可以过渡到W期或者N3时期，如果没有出现慢速眼球运动，肌肉的水平依然是低状态，继续判读为R期。睡眠时期与特征脑电的关系如表1所示。 Table 1 期别 特征波 W Alpha (8~13 Hz), Beta (12~30 Hz) N1 Theta (4~8 Hz) N2 Spindle (12~14 Hz), K Complex (1 Hz) N3 Delta (0.5~2 Hz) REM Alpha (8~13 Hz), Beta (12~30 Hz), Sawtooth Wave (2~6 Hz) 表1. 睡眠时期特征波 现阶段主要由专家进行人工分期，人工分期的过程如图2所示。然而人工分期会受到分期标准、个体差异、培训指导 [ 10 ] 等多方面的主观或客观条件的影响，而计算机进行的睡眠自动分期，不仅可以解决上述诸多问题，还可以将医师从繁重的分期工作中解放出来。睡眠分期是睡眠研究工作的基础，所以快速准确地进行睡眠的自动分期就尤为重要。目前，进行睡眠自动分期主要有两种办法，一种是基于统计规则的睡眠自动分期，另一种是基于深度学习的端对端睡眠自动分期研究方法。本文将以此为划分介绍近年来的睡眠自动分期方法。在本文所介绍的分期方法中，由于各个研究中采用的是不同公开数据集的数据，有的实验的数据由研究者自行采集，所以所介绍方法的分期准确率只能作为一个参考，并不能简单认为准确率高的模型性能更好。 图2. 专家分期过程"
"基于统计规则的睡眠自动分期方法中，研究的重点主要包括数据预处理、提取特征、选择分类器三个主要的过程。这种方法将研究的重点放在特征和分类器的选择方面。  在睡眠脑电的监测过程中，通常会受到心电、肌电、眼电以及环境噪音的影响 [ 11 ] ，为了能够排除噪音对于睡眠分期结果的影响，需要对数据进行一定程度的预处理。在医学研究中，关注的脑电频率范围在0.5~35 Hz之间 [ 12 ] ，低于或高于这一频率范围的脑电波通常被视为噪音处理，这些噪音会对睡眠分期的结果产生很大的影响。通常情况下，要对数据进行滤波操作。吕甜甜等 [ 11 ] 对脑电数据进行了降噪处理，采用“db4”小波对原始EEG进行7层分解，采用中值滤波法对呼吸信号进行去噪处理，得到较纯净的信号。叶仙等 [ 13 ] 对脑电数据进行滤波，滤波的带通为0.5~35 Hz。Berg和scherg等人则采用主成分分析法去除睡眠脑电中的伪迹 [ 14 ] ，Lagerlund等人则对此技术进行了改进，使计算量大大减少 [ 15 ] 。Scott makeing等人将主成分分析法应用于去除伪迹，成功去除了干扰信号 [ 16 ] 。Jung等对比了几种分析方法，结果证明，主成分分析法能够有效去除各种伪迹 [ 17 ] 。  在基于统计规则的睡眠自动分期研究中，特征的提取对于分期结果准确率有着很大的影响，选择不同的特征，分期的结果也会有很大的不同。生理信号的复杂度是目前阶段抽取的主要特征，包括脑电信号的近似熵、样本熵、多尺度熵以及精细度多尺度熵等。 Koupparis等人结合短时傅里叶变换，提取睡眠脑电数据的时频信息作为输入，以半自动的方式有效地区分出W期、REM期以及N1期 [ 18 ] 。刘慧等利用睡眠通道的模糊熵作为特征进行睡眠的自动分期，分期的准确率达到了87.1% [ 19 ] ，范文兵等则选取了相对能量均值以及多尺度熵两种特征，取得了85.81%的分期准确率 [ 20 ] ，周鹏等使用主成分分析法提取时频特征以及非线性动力学特征，正确率达到89.9% [ 21 ] 。See等则选用信号的样本熵作为特征输入到分类器 [ 22 ] 。Costa等人则发现多尺度熵能够区分不同睡眠时期之下的差异性 [ 23 ] 。 上海交通大学的叶仙[ 13 ]等人选择准确性和有效性都更高的精细多尺度熵方法解析睡眠过程中的脑电信号复杂度，并获取通道信号的多尺度熵，以精细度多尺度熵为输入特征分类中，模型的总体准确率达到了85.3%。 上述方法提取的特征是单个特征，另一种思路是多个特征的组合作为特征。B.Koley等人选取了从时域、频域到非线性特征的39个特征进行睡眠的自动分期 [ 24 ] 。 在Koley等人 [ 24 ] 的实验中，分别从时域、频域以及非线性方向提取特征。在时域特征中，提取出从一阶到四阶的特征，这些特征分别是均值、方差、偏度以及峰度。这些特征分别表示出了脑电数据的集中趋势、离散度以及不对称性和峰值 [ 25 ] [ 26 ] 。除此之外，脑电信号通过平均值参考线的次数定义为过零率 [ 27 ] ，这个特征参数能很好区分睡眠纺锤波。Hjorth参数则反映了脑电信号的活动性和复杂性 [ 28 ] [ 29 ] 。 在频域方面，经过小波变换，不同频率的特征波的功率谱以及功率比 [ 30 ] [ 31 ] 。都取得了很好的结果。另一个有效的频域特征是韦尔奇谱估计。在非线性特征中，有效性相关维度、李雅普诺夫指数、近似熵、去趋势波动分析、Higuchi分形维数也都是典型的特征 [ 32 ] [ 33 ] 。 除去上面所述的特征中，在Koley的实验中一共使用了39个不同维度的特征，得到了85.72%的准确率。  在基于统计规则的睡眠分期中，第一个重点是特征提取，另一个重要步骤是分类器的选择。常用的分类器有线性判别、贝叶斯方法、人工神经网络以及支持向量机等几种方法。其中人工神经网络由于是一种与其他分类器明显不同的方法，将在第四章中单独介绍。 叶仙等人实验中分类器选择支持向量机(Support Vector Machine, SVM) [ 13 ] ，由于支持向量机的本质是一个二分类器，而睡眠分期的任务要完成五分类，所以设置了多层次SVM分类器。 Fraiwan等人选用随机森林作为分类器 [ 34 ] ，随机森林是通过构造多棵决策树完成的，每一棵树都会给出一个分期结果，最终的结果由所有树的结果综合而成。在随机森林分类器中，每一棵树都相当于一个弱分类器，随机森林则是多个弱分类期组合而成的强分类器。随机森林如图3所示。构造随机森林的步骤如下：首先，构造每一棵树，构造树的时候可以采用随机树、CART、C4.5等不同的决策。其次为每一棵树准备训练集，训练集中的数据采用采样的形式得到。然后训练每一棵树，对于每一棵树，Fraiwan等人都输入了四个不同的特征，而且输入特征的过程是完全随机的，这可以保证分类器对于噪音的敏感性降到最低。最后将所有的树组合成为随机森林分类器。随机森林的输出取决于每一棵树的结果。Fraiwan等人的实验取得了83%的分类准确率。 图3. 随机森林模型示意图 与支持向量机相似的一种分类器是相关向量机，与支持向量机相比，相关向量机的解更稀疏，泛化能力也能好。沈跃、刘慧等人利用相关向量机结合二叉树的思想对睡眠进行自动分期，取得了比支持向量机更好的结果 [ 35 ] 。 在刘跃等人的实验中，利用训练数据集，训练相关向量机的预测以确定向量机的核函数。由于标准的相关向量机适用于二分类任务，而睡眠的分期是一个多分类任务，与支持向量机的方法相似，采用二叉树思想对睡眠阶段进行逐层分期。如图4所示。 图4. RVM睡眠分期二叉式模型 从图4中可以看出，在刘跃等人的实验中，只进行了四个时期的分期工作，其中不包含REM睡眠时期。以相关向量机作为分类器的分期准确率将达到89.00%。这个结果已经接近于人类专家的分期水平。 除上述方法之外，Weiss、Sirvan等人采用线性判别 [ 36 ] ，李谷等提取脑电信号不同频段的能量特征，使用最近邻分类器，得到了81.7%的准确率 [ 37 ] 。表2是各种不同的分期模型的表现。 Table 2 文献 文献类型 数据库 预处理 特征提取 分类器 准确率(%) 1 [ 35 ] 中文 Sleep-EDF × 样本熵 相关向量机 89.0 2 [ 21 ] 中文 Sleep-EDF 滤波 主成分分析 支持向量机 87.1 3 [ 20 ] 中文 Sleep-EDF 滤波 多尺度熵 Bp网络 85.8 4 [ 13 ] 中文 Sleep-EDF 滤波 精细多尺度熵 支持向量机 85.3 5 [ 19 ] 中文 Sleep-EDF × 模糊熵 支持向量机 83.0 6 [ 38 ] 英文 海德堡大学 归一化、基线漂移 Hilbert-Huang Transform 随机森林 83.0 7 [ 39 ] 英文 Sleep-EDF × 时频 自编码器 78.9 8 [ 40 ] 英文 ISRUC-Sleep × 时频等 softmax 74.9 9 [ 40 ] 英文 ISRUC-Sleep × 时频等 K-NN 73.3 10 [ 34 ] 英文 圣保罗大学 × 小波 支持向量机 72.3 表2. 基于统计规则的不同分期模型表现"
"近年来，深度学习技术的理论得到了极大的发展 [ 41 ] [ 42 ] [ 43 ] ，而且随着计算机计算能力的加强以及GPU技术的出现，越来越多的深度学习项目取得了令人欣喜的成果 [ 44 ] [ 45 ] 。在睡眠分期方面，各种不同的神经网络也都取得了较高的分期准确率。由于睡眠脑电数据非平稳、非线性的特点 [ 46 ] [ 47 ] ，传统的机器学习方法需要研究人员在分期过程中进行干预，而神经网络能够很好地解决此类问题，因而越来越多的研究者将神经网络技术应用于睡眠的自动分期任务中。神经网络应用于睡眠分期时，输入以及网络结构是两个重要方向。  在基于深度学习的睡眠自动分期方法中，分类器的输入数据有两种不同的情况，分别是输入单通道的脑电数据，以及多通道的睡眠体征参数，包括睡眠脑电数据、睡眠眼电数据、肌电数据以及呼吸数据等。其中，由于睡眠多导记录仪会记录多个通道的脑电数据，各研究者采用的通道也会有所不同。Imtiaz等人输入单通道脑电数据设计了睡眠自动分期的可穿戴设备 [ 48 ] ，Wei等人输入脑电数据中的Fpz-Cz通道数据，得到了84.5%的分期准确率 [ 49 ] 。在本文完成的过程中，我们厦门大学帅建伟生物物理课题组也进行了睡眠自动分期的工作。我们利用卷积神经网络对从福建省某医院采集的数据集中的数据进行了分析。在目前的睡眠分期工作中，大部分的模型输入的是单通道数据或者仅仅输入EEG数据。考虑到在专家进行睡眠标定的时候，会同时考虑多条通道，所以在我们的模型中，选取了三条EEG数据以及两条眼电数据。在医院数据集上取得了82.0%的整体准确率 [ 50 ] 。  在确定网络的输入后，选择不同的网络。近年来的研究中，多层神经网络(Convolutional Neural Network, CNN)、卷积神经网络以及循环神经网(Recurrent Neural Network, RNN)络在睡眠自动分期方面都取得了比较好的结果。  多层人工神经网络训练集小、运算速度快同时又能很好地处理非线性以及非平稳信号，很适合应用于睡眠的自动分期任务之中。M. Emin Tagluk等人 [ 51 ] 利用多层感知器神经网络用来对睡眠进行自动分期。一个典型的神经网络如图5所示。 图5. 人工神经网络示意图 通常神经网络由一个输入层、一个输出层和一个或多个隐藏层组成，这些隐藏层由神经元组成，这些神经元将前一层产生的输出累加起来，再乘以神经元的加权向量。然后，每个单元或节点产生一个带有非线性传递函数的输出，称为激活函数。 构造神经网络的关键是确定隐层数目，不同于输入层以及输出层，隐含层中神经元的数量是不确定的，对于隐层的神经元数。如果隐层的神经元数目过多，就会因为噪音的影响而使网络的泛化性能大大降低。如果隐层的神经元数目过少，则不能很好的学习脑电数据内部的分期信息。另一个关键的问题是网络的训练方式，在M. Emin Tagluk等人的实验中，采用的是反向传播算法。该网络的最终分期准确率达到了74.7%，这一结果并不足够理想，但是M. Emin Tagluk等人的实验证明了神经网络应用于睡眠分期工作的可行性，这为各种神经网络应用于睡眠分期提供了基础。  卷积神经网络在图像识别、模式识别任务中表现优异 [ 52 ] [ 53 ] ，是现阶段使用最广的一种神经网络。一般情况下，CNN应用于二维或三维的矩阵，由于睡眠脑电数据是一维时间序列。Arnaud Sors等人 [ 54 ] 提出应用于睡眠分期的一维卷积网络。在每一卷积层中，都包含了卷积操作和池化操作。网络的整体结构如图6所示。 图6. 卷积神经网络示意图 从图6中可以看到，该网络共含有14层，其中最后两层是全连接层。网络的输出是输入脑电数据属于每一个睡眠时期的分类。每一层网络的神经元数量显示在每一个模块中。该网络的分类总体准确率达到了87%。  在诸多的神经网络之中，大部分网络只有一个前向的传播过程，数据向前流动。然而在睡眠分期的AASM规则中明确提到，各个睡眠时期之间并不是独立的，每一个睡眠时期都与其之前和之后的睡眠阶段相联系，所以一种能捕捉这种前后关联关系的网络被应用于睡眠的自动分期，这就是递归神经网络。递归神经网络捕捉睡眠时期的关联性。Hsu等人 [ 55 ] 采用了递归神经网络对睡眠进行自动分期。递归神经网络的结构如图7所示。 图7. 递归神经网络图 该网络是一个三层网络结构，分别是输入层、隐含层以及输出层。在Hsu等人的实验中，输入层输入的是提取的睡眠脑电的能量特征，隐含层中由激活函数对输入的特征数据进行计算。最后一层是输出层，输出层输出每一个输入属于某一睡眠时期的概率分布，神经元的个数与睡眠时期数相同，并将输入定义为概率最高的神经元。该网络的分期最终准确率达到87.2%。  上述的实验方法都是单一神经网络用于睡眠分期，然而，每一种单独的网络在有其优势的同时，也会有一定的局限。最简单的前向神经网络训练速度快、方法简单，但是分期的准确率不高。卷积神经网络能够提取脑电信号的时频特征，然而却不能挖掘出睡眠时期之间的关系。递归神经网络虽然能够挖掘各个睡眠时期的关系，但是其缺点也很明显，一是特征提取的不确定性，二是训练速度慢，很难收敛，在数据量很大的时候需要很长的时间 [ 56 ] 。为了走出单一神经网络陷入的困境，众多的组合的神经网络被提出用于睡眠的自动分期。Akara Supratak等人提出一种新的用于睡眠分期的网络：Deepsleepnet [ 57 ] ，该网络用两个卷积神经网络来提取脑电数据的时频特征，使用长短时记忆神经网络(Long-Short Term Memory Neural Network, LSTM) [ 58 ] [ 59 ] 提取不同睡眠时期之间的关联。整个网络的结构如图8所示。 由于在训练的过程中，长短时记忆神经网络需要很长时间收敛，于是对网络加入了一个预训练的过程。首先在两个卷积神经网络之后加一个softmax层用于分类，进行预训练。然后将训练好的卷积神经网络加上长短时记忆网络。引入预训练后，网络的训练速度大大提高。DeepsleepNet网络的分期总体准确率达到82.0%，是一个可以接受的结果，另外，由于该网络的层数较少，对分期的结果有一定的影响，如果增加网络的复杂性，准确率应该也会有所提升。 图8. DeepsleepNet网络结构图 除去上面的网络之外，杨鑫等人的双向递归神经网络的分期准确率达到了95% [ 60 ] ，魏良洁等人分别采用CNN以及CNN-LSTM模型的分期准确率都达到了80% [ 46 ] ，张秀丽等人采用LSTM-RNN模型取得了81.2%的结果 [ 61 ] 。表3是基于深度学习技术的各种睡眠分期模型的表现。 Table 3 文献 文献类型 数据库 预处理 网络 准确率(%) 1 [ 60 ] 中文 Sleep-EDF 去除过多清醒期 Bi-RNN 95.0 2 [ 62 ] 中文 Sleep-EDF × CNN 86.9 3 [ 50 ] 中文 福建某医院 × CNN 82.0 4 [ 61 ] 中文 图宾根大学 × LSTM-RNN 81.9 5 [ 46 ] 中文 Sleep-EDF × CNN-LSTM 80.0 6 [ 55 ] 英文 Sleep-EDF 滤波 RNN 87.2 7 [ 57 ] 英文 Sleep-EDF × 2CNN-LTTM 82.0 8 [ 63 ] 英文 Sleep-EDF × CNN 74.8 9 [ 51 ] 英文 自行采集 滤波 NN 74.7 表3. 基于深度学习的不同分期模型表现"
"睡眠分期作为睡眠研究的基础工作，在睡眠质量研究中扮演着重要的角色。睡眠的自动分期作为睡眠判定的重要工作，正得到越来越多的研究者的关注。基于统计规则的睡眠自动分期方法主要依靠提取特征以及分类器的选择。随着深度学习的广泛使用，一大批神经网络被应用于睡眠分期的研究之中，综合上文所述，可以发现： 数据方面，基于统计规则的分期方法对于训练数据的要求不高，数据的数量对实验结果不会产生很大的影响，几十个到几百个数据就可以完成一个分类器的训练。应用神经网络进行睡眠的自动分期则对数据的要求很高，因为神经网络本身由大数据驱动，在训练的过程中，需要输入大量的带有正确标签的训练数据，否则很难训练出准确率高的模型。因此，在数据量较少的时候，或者只有少数受试者的时候，可以选择基于统计规则的睡眠分期方法。 在数据的预处理方面，基于统计规则的睡眠分期需要对数据进行预处理，首先要对数据进行滤波操作，以去除在数据采集的过程中产生的噪音的影响。其次要对脑电数据进行特征抽取，特征抽取是基于统计规则进行睡眠分期工作中重要的一步。针对不同的数据，抽取的特征也有所区别。神经网络可以进行端到端的睡眠分期过程，从数据中学习专家在分期过程中的经验以及方法，可以在不进行数据预处理以及特征提取等操作的情况下取得较好的分期结果。 在模型泛化方面，基于统计规则的睡眠分期工作需要在面对不同数据的时候，观察数据的不同，并对于不同的数据进行不同的预处理以及特征提取等工作，因此其泛化性能受到一定的局限。神经网络在面对不同的数据时，只需要对网络中输入层的参数进行修改即可，所以比基于统计规则的睡眠分期方法泛化性能更好。 另外，在进行睡眠自动分期的过程中，如果采用基于统计规则的分期方法，需要研究者熟练掌握睡眠分期的背景知识。由于神经网络是端到端的分期过程，不需要研究者熟练掌握背景知识，可以节省下更多的时间精力到睡眠自动分期的工作中。 目前，越来越多的研究者开始关注睡眠健康问题。作为研究睡眠问题的基础，睡眠的自动分期也成为一个热点课题。神经网络拥有着不需要进行数据预处理和特征提取、泛化性能良好等优点。而且在分期的过程中，不同的网络可以适应各个阶段的任务，如CNN能够自动提取有效特征，RNN可以捕捉前后睡眠时期之间的联系。综上所述，我们认为深度神经网络将会成为未来睡眠分期研究领域的主流工具。"
