"本文依据现代农业需求开发设计了一款基于物联网技术的植物生长状况检测系统。该系统基于STM32F103VE芯片，设计了图像采集器以及开发了相应的数据分析算法，其中图像采集器包含对应的智能图像处理算法。数据分析算法通过STM32F103VE芯片以及对应的外设实现检测植物生长状况的功能，并通过Wi-Fi以及GPRS技术实现数据的传输，最后通过移动终端或者管理终端显示结果。 关键词 :植物生长状况检测，STM32F103VE，GPRS Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"农业作为我国主要的经济产业，是人类社会发展的基础，而农作物的生长状况决定了农作物的产量的，因此用现代科技技术提高农作物的产量势在必行，从而打造智慧农业。智慧农业即以最高效率整合利用各种农业资源，最大限度减少农业的能耗和成本、农业生态破坏以及实现农业系统整体最优为目标。结合物联网与大数据使农业入网，打造智慧农业，不仅是时代的需求，也是现代农业的发展趋势。"
"肥料为农作物生长提供必需的营养元素，对保持农作物高产、稳产起到了重要作用。但是，由于施肥不当或过量施肥带来的环境污染问题也愈发突出。其中，由农田中的氮磷流失引起的水体富营养化问题也越来越受到人们的普遍关注，不适时施肥、过量施肥、化肥施量过高不仅仅破坏环境，同时还提高了农作物的生产成本。因此，现急需一种能给出合理施肥，从而提高肥料的利用率、降低肥料流失造成而水体富营养化的方案或装置，从而有利于检测农作物的生长状况。 目前，对植物生长状况的检测装置有传统的植物生长信息检测仪、叶绿素仪和植物营养测定仪。其中，植物生长信息检测仪需要从植株上提取样本，用药剂和仪器进行化学分析，得出植株的氮素、磷素、钾素等含量，从而判断植物生长状况，操作十分复杂。而叶绿素仪原理是通过测量叶片在两种波长范围内的透光系数来确定叶片当前叶绿素的相对数量，也就是在叶绿素选择吸收待定波长长光的两个波长区域，根据叶片透折射光的量来计算测量值。叶绿素仪虽然能够精确地测定农作物的叶绿素含量，但在使用的时候需要用仪器夹住植物叶片，不利于自动测定，并且不能实时检测。植物营养测定仪和叶绿素仪类似，但能同时测定植物叶绿素含量、氮素含量和水分含量等，能够为施肥提供依据。植物营养测定仪原理和叶绿素仪原理相同，即通过测定的SPAD值推断植物的氮含量，但使用时同样需要仪器夹住植物叶片进行测定 [ 1 ] 。 由此可见，传统的植物生长信息检测仪检测过程复杂，而叶绿素仪和植物营养测定仪都需要人工手持式操作，需要用仪器夹住叶片进行测定，不能进行自动检测，并且价格极高，操作也有一定的复杂性，一般在科研中使用，难以在实际农业生产中推广。"
"植物生长状况检测系统如图1所示，应用于服务器，所诉服务器能够与移动终端和图像采集器通信。其中服务器包括植物生长状况检测装置、处理器和存储器三个模块，移动终端可以是智能手机、平板电脑、笔记本电脑等电子产品。 图1. 植物生长状况检测系统设计示意图 该系统中服务器能够通过网络与移动终端通信，以进行数据通信或交互。同样，服务器也能够通过网络与图像采集器进行数据通信或交互。而服务器为该系统主要的模块，其中处理器模块和存储器模块能够之间或间接的电性连接，而植物生长状况检测装置中包括至少一个可以软件或固件的形式存储于存储器模块的软件功能模块，处理器模块则处理执行存储器中存储的可执行模块。  植物生长状况检测装置如图2所示，分为三个模块图像获取模块、生长状况模块、培育指导分析模块。其中图像获取模块从图像采集器获取图像后，之后在生长状况分析模块中进行分析，将分析结果利用培育指导分析模块输出植物的生长状况以及培育指导建议方案。 图2. 植物生长状况检测装置设计示意图  图像获取模块主要用于控制处理图像采集器获取的植物图像，图像采集器每隔一段预设时长自动获取所诉植物图像，并发送至服务器，图像获取模块接收该植物图像。 图3. 图像获取模块设计示意图 如图3所示，图像获取模块首先通过摄像头位置调整单元根据植物图像，判断图像采集器的摄像头位置是否符合预设拍摄标准，若是，则将该图像传入到下一个标识信息提取单元，若否，则按照预设调整计划调整摄像头，并接收调整摄像头后图像采集器获取的植物图像，对调整后的摄像头位置是否符合预设拍摄标准进行判断，直到根据再次接收到的植物图像，判断得出摄像头位置符合预设拍摄标准为止。 当获得符合标准的植物图像后，便开始进行标识信息提取与分析。标识信息提取模块用于提取标准 图4. 生长状况分析模块设计示意图 植物图像中携带的标识信息，再通过种类信息查找单元根据所提取的标识信息查找出与该标识信息对应的植物种类信息，最后开始进行该植物的生长状况分析。  生长状况分析模块主要通过接受图像获取模块所得到的植物种类信息及图像信息，进行特征分析。 如图4所示，生长状况分析模块包括生物特征提取单元和生长状况信息获取单元。其中生物特征提取单元用于提取植物图像的RGB值和纹理特征，同时为了提高检测结果的准确性，还提取了植物图像的几何形态特征和小波特征等。将生物特征提取单元获得的植物图像特征经过生长状况信息获取单元分析其RGB值和纹理特征，并结合植物种类信息，根据预设的运算规则获得植物的生长状况信息。  培育指导分析模块通过获得生长状况分析模块所分析出来的植物图像生长状况信息生成培育指导建议，更好的向用户提供科学的施肥指导建议。在植物培养过程中，植物缺少氮素、磷素、钾素时，对植物生长状况都会有不同影响。具体表现在，在缺少氮素的情况下，植物叶片发黄，生长缓慢，并且伴有早熟早衰的情况产生。在缺少磷素的情况下，植物叶片和根茎会出现紫红色的斑点，新根少，并且生长缓慢。在缺少钾素的情况下，植物枝干高度较低，叶片焦黄，边缘干枯严重。由此，通过获得的植物的生长状况信息，即可判断其缺肥情况，从而生成具有针对性的培育指导建议，并发送至移动终端。 图5. 培育指导分析模块设计示意图 如图5所示，培育指导分析模块包括培育指导建议生成单元和培育指导建议发送单元。培育指导建议生成单元用于根据生长状况信息，并结合植物种类信息，生成培育指导建议并存储。培育指导建议发送单元接收到移动终端发送的信息获取请求时，将生成的该植物培育指导建议发送至移动终端。需要说明的是，该移动终端发送的信息获取请求可以是实时获取请求，以获取该植物的当前生长状况信息和培育指导建议，也可以是历史信息获取请求，以获取该植物的历史生长状况信息和培育指导建议，从而得到该植物整个生长过程的生长状况信息和培育指导建议。  植物生长状况检测流程如图6所示，刚开始植物生长状况检测装置要控制图像采集器以获得正确标准的植物图像，然后接收图像采集器获取的植物图像，通过标识信息提取模块提取植物图像中携带的标识信息，以种类查找单元根据标识信息查找出与该标识信息对应的植物种类信息，接下来进行生长状况分析，由生物特征提取单元提取植物图像的RGB值和纹理特征，并通过生长状况信息获取单元分析RGB值和纹理特征，并结合植物种类信息，根据预设规则获得植物的生长状况信息，最后根据生长状况信息，生成培育指导建议，并发送至移动终端由客户根据生长状况信息以及培育指导建议进行培育植物。 图6. 植物生长状况检测流程"
"植物生长状况检测系统硬件设计如图7所示，基于嵌入式CPU的中央处理单元以图像采集器采集的图像为检测背景，可以实现对植物生长状况进行采集分析和处理，进而给出植物生长培育指导建议等功能。除此之外，该系统还可以对植物生长环境的基础数据温湿度进行采集传输和显示，并具有防盗功能。 图7. 植物生长状况检测装置硬件设计图  电源我们采用太阳能供电方案，结合蓄电池，以更便捷地将该检测系统应用于农田中。根据阳光情况选择并切换功率源，在阳光充足时由太阳能电池供电，在阳光不足时由蓄电池供电。 图8. 太阳能供电系统总体框图 如图8，控制系统作为中枢，来控制太阳能电池、蓄电池和负载之间的连接关系，控制系统主要实现两个功能： 1) 当控制系统判断光照充足，太阳能电池的功率足以供给负载时，则控制太阳能电池板单独向负载供电，同时给蓄电池充电 2) 当控制系统判断光照不足时，太阳能电池功率不足以供给负载，则由太阳能电池充电，同时由蓄电池单独向负载供电 太阳能供电系统主电路如图9所示。 图9. 太阳能供电系统主电路 如上图所示，稳压模块的输出电压为12 V，其输出电压有三个等级，分别为±12 V和5 V。其中±12 V输出直接采用输入电压，不进行处理，−12 V和5 V输出需进行电压等的变换 [ 2 ] [ 3 ] [ 4 ] 。  温湿度传感器：采用TI HDC2010温湿度传感器，该传感器是一款采用超紧凑WLCSP的集成式温度和湿度传感器，能够以超低耗提供高精度测量。同时该传感器经过工厂校准，温度精度为0.2℃，相对湿度精度为2%，并配备了加热元件，可消除冷凝和湿气，从而增加可靠性。这为精准检测植物的生长环境提供了极大帮助。  如图10所示，图像采集器通过摄像头，以图片方式间隔性、周期性地记录作物生长，并将图像数据通过GPRS模块传输至服务器，系统首先对图像进行直方图增强、图像去噪、边缘检测、锐化等预处理，然后进一步对图像数据处理分析，得出植物静态叶片的颜色(灰度)、色泽(图片明暗度对比)、纹理等能够表征作物生长情况的相关信息。在作为培育指导建议反馈给用户的同时，还便于用户观察植物情况 [ 5 ] 。 图10. 图像信息采集处理  本植物生长状况检测系统不仅可以用于温室大棚内，也可以在室外田间工作，在温室大棚内可通过 Wi-Fi将采集的信号发送到互联网，再通过服务器接收，将采集的数据进行分析处理。 数据传输结构如图11所示。如果在室外无Wi-Fi覆盖，就需要用GPRS进行数据传输。GPRS网不但具有覆盖范围广、数据传输速度快、通信质量高、永远在线等优点，而且其本身就是一个分组型数据网，支持TCP/IP协议，无需经过PSTN (公用电话交换网)等网络的转接，可直接与Internet网互通 [ 6 ] [ 7 ] [ 8 ] 。 图11. 数据传输结构图  本项目采STM32F103VE单片机该款芯片采用ARM32位Cortex-M3的处理器，最高工作频率可达72 MHz，1.25 DMIPS/MHz，因此其处理速度快。存储器方面，片上集成512 KB的Flash存储器，64 KB的SRAM存储器，其自带的存储器使其即使不外接存储芯片也可以存储很多的数据；该芯片具有3种低功耗模式：休眠、停止、待机模式，因此非常适合应用于在野外采用太阳能供电的系统当中。  该系统除了上述模块以外，还具有外围显示模块，可以显示系统的电量、系统采集时间、系统工作频率等参数；由于该系统放在田间工作，因此它需要具有防盗功能，我们为此设计了GPS定位跟踪系统当系统被移动以后，会自动实时发送位置信息，为找回被盗系统、减少被盗情况提供了有力帮助 [ 9 ] [ 10 ] 。"
"本系统使用Keil MDK集成开发环境和C语言、汇编语言进行工程开发。编写好.hex文件后，最后通过ST-JTAG将生成的二进制可执行性文件烧写进单片机。本系统包括了预热自检、显示浓度、时间调节、GPRS/WiFi数据传输、GPS定位等功能。 系统软件框图如图12所示： 图12. 系统软件框图 1) 预热自检：金属氧化物传感器在长时间的放置后需要进行一段时间的预热才能产生正确的信号。检测各个传感器的信号电压和加热电压是否正常，通过测量其电压值来判断。 2) 显示浓度：测得的数据可以显示在植物生长状况检测装置上，也可以通过移动终端显示。利用互联网实时查看被检测地点的植物生长状况信息以及培育指导建议。 3) 时间调节：可显示当前时间，也可调整。 4) GPRS/Wi-Fi数据传输：将植物生长状况信息通过GPRS系统或者Wi-Fi模块传入互联网中，以作为大数据的数据基础和后期分析处理使用。 5) GPS定位功能：加入GPS模块可实时查看系统所处位置，当系统被移动时，会产生报警信息，以防检测系统被盗，即使被盗，也可根据GPS定位到我们的系统位置。  如图13所示，为实现跨区域、跨时间地获取植物生长状况情况的信息，同时能够让更多的人共享，也为了使数据存储起来，便于更好地分析植物生长情况，我们设计了相应的人机界面和数据库系统，可以将试验地中测量仪器采集的数据和植物的收成情况记录下来，以便于进一步分析处理。 图13. 数据库与人机交互界面实现流程图"
"该系统立足于农业方面的应用，据了解，农村确有存在盲目施肥、过量施肥的情况，故该系统可以说极大帮助了并可以改善用户对植物的了解情况，起到因材施教的作用。该系统采用各种新颖算法，并结合当今物联网和智能仿生技术的流行趋势，最大限度减少农业的能耗和成本、农业生态破坏以及实现农业系统整体最优。打造智慧农业，不仅是时代的需求，也是现代农业的发展趋势。"
