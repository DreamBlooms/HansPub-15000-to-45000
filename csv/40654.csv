"本文给出随机环境中的M/M/n排队系统的定义，随机环境中的M/M/n排队系统的平衡条件 P { θ ∗ ∈ Θ ∗ | ρ ( θ ∗ ) < 1 } = 1 ， L ( θ ∗ ) ， L q ( θ ∗ ) ， K ( θ ∗ ) 的表达式及其关系，最后给出 X ∗ 的转移概率 p ( θ ∗ , t ; i , j ) 的随机Kolmogorov向前和向后方程。"
"排队系统一直是运筹学的热点，众多国内外学者对此做了广泛的研究，如Wang [ 1 ] 等学者研究了具有相关正、负顾客到达的MMBP/Geo/1队列，Bae [ 2 ] 等人考虑顾客耐心恒定的条件下，得到了在繁忙周期内工作负载过程中的水平的预期下穿及繁忙周期的预期长度。Taufemback [ 3 ] 提出了基于排队论的有关银行超额准备金最优管理的方法，Laxmi [ 4 ] 等人分析了一个具有延迟、叛逆和异构服务器的更新输入多个工作假期队列，得到了一些较实用的数值结果，Rajadurai [ 5 ] 分析了伯努利计划下具有休假和休假中断的重试G-队列，得到了较好的理论结果。目前对于随机环境中的随机过程的研究已进入一个新阶段，诸如具有代表性的随机环境中的马氏过程 [ 6 ]、随机环境中的生灭过程 [ 7 ]、随机环境中分支q-过程 [ 8 ]、随机环境中的泊松过程 [ 9 ] 等。从对经典M/M/n排队系统的研究得出其为一生灭过程，本文由此受到启发，基于目前对随机环境中排队过程的研究较少的现状，结合 [ 6 ] [ 7 ] [ 8 ] [ 9 ] [ 10 ] 等文，对随机环境中的M/M/n排队系统进行研究。随着国内外数学家研究的进一步深入，随机环境中的随机过程理论日益完善。胡在 [ 7 ] 中构造性地证明了随机环境中生灭过程存在的条件为 ∑ n = 1 ∞ ∑ k = 1 n μ k + 1 * ( θ * ) ⋯ μ n * ( θ * ) λ k * ( θ * ) λ k + 1 * ( θ * ) ⋯ λ n * ( θ * ) = ∞ 。吕在 [ 8 ] 中引进随机环境中一致马氏过程，给出随机环境中分枝q-过程存在性和唯一性的充分条件，最后证明了任意随机分枝转移密度矩阵都是零流入的。2020年，单在 [ 9 ] 中引入随机环境中的泊松过程，证明了随机环境中泊松过程是一类特殊的随机环境中马氏过程，并给出其随机Kolmogorov方程。高在 [ 10 ] 中引入随机环境中双移民生灭过程的概念，并研究其转移矩阵的平稳分布 π * = π * P * 。本文给出随机环境中的M/M/n排队系统的定义，随机环境中的M/M/n排队系统的平衡条件 P { θ ∗ ∈ Θ ∗ | ρ ( θ ∗ ) < 1 } = 1 ，在平衡状态下的一些结果，如 L ( θ * ) ， L q ( θ * ) ， K ( θ * ) 的表达式及其关系，最后给出 X * 的转移概率 p ( θ * , t ; i , j ) 的随机Kolmogorov向前和向后方程。"
"令 X = N 为一状态空间， ( Θ , B ) 是任一抽象可测空间， X * = { X ( t ) , t ∈ R + } ， ξ * = { ξ t , t ∈ R + } 是概率空间 ( Ω , F , P ) 上分别取值于X和 Θ 的两个随机过程， Θ * 是从 R + 到 Θ 上的函数集，对每个 θ * ∈ Θ * ， s ≥ 0 , t > 0 ， θ * [ s , s + t ) 为 θ * 在 [ s , s + t ) 上的局限， Θ * [ s , s + t ) = { θ * [ s , s + t ) : θ * ∈ Θ * } ，p为 Θ * 上的时齐的随机转移函数，参见 [ 6 ]，即 p ( θ * [ s , s + t ) ; i , j ) 不依赖于s (对每个 θ * ∈ Θ * ， t > 0 ， i , j ∈ X )。 定义1 如果一排队系统满足： 1) 对 ∀ θ * ∈ Θ * ，记 N * = { N * ( t ) , t ≥ 0 } 是顾客进入服务系统的过程，且 N * 服从强度参数为 λ ( θ * ) 的随机环境中的泊松过程(参见 [ 9 ] )，其中 N * ( t ) 表示在 ξ * = θ * 下，时刻t进入系统的人数。 2) 对任意固定的 θ * ∈ Θ * ，若记 J * = { J k * , k ≥ 0 } 为顾客相继到达时间间隔序列，那么随机变量序列 { J k * , k ≥ 0 } 为独立同分布随机变量序列，且 J 1 * ~ Γ ( 1 , λ ( θ * ) ) 。 3) 对 ∀ θ * ∈ Θ * ，记 B * = { B k * , k ≥ 0 } 为顾客的服务时间序列， B * = { B k * , k ≥ 0 } 为独立同分布随机变量序列， B 1 * ~ Γ ( 1 , μ ( θ * ) ) ，且满足 B * 与 J * 相互独立。 4) 该系统中有 n ( n ≥ 1 ) 个服务台。 则称该系统为随机环境 Θ * 中的M/M/n系统。 例1 考虑一随机环境中依时的马氏链 ( X → , ξ → ) (参见 [ 12 ] )，其相应的状态空间 X = { 0 , 1 , 2 , ⋯ } 。A是由X生成的 σ 代数，环境集取 Θ = ( 0 , 1 ) ，B是由 Θ 生成的 σ 代数。如下定义该马氏链的随机转移矩阵 P ( θ ) = ( p ( θ ; x , y ) , x , y ∈ X ) ： p ( θ ; 0 , x ) = p ( θ ; 1 , x ) = k x θ         ( θ ∈ Θ , x ≥ 1 ) ; p ( θ ; 0 , 0 ) = p ( θ ; 1 , 0 ) = 1 − ∑ x = 1 ∞ k x θ       ( θ ∈ Θ ) ; p ( θ ; n , x ) = 0 ,       ( θ ∈ Θ , n ≥ 2 , x < n − 1 ) ; p ( θ ; n , x ) = p ( θ ; , 1 , x − n + 1 )       ( θ ∈ Θ , n ≥ 2 , x ≥ n − 1 ) , 其中 k 2 + k 3 + ⋯ > 0 , k x ≥ 0 , ∑ x = 1 ∞ k x < 1 , ∑ x = 0 ∞ k x = 1 。则该随机环境中依时的马氏链为一随机环境中的排队过程。 接下来，令 X * = { X * ( t ) , t ≥ 0 } 为系统的状态过程，其中 X * ( t ) 表示在 ∀ θ * ∈ Θ * 下，时刻t系统中的顾客数(包含正在接受服务的顾客数)。我们记事件 { t < X k * < t + Δ t } 表示系统中有k个服务台在时间间隔 ( t , t + Δ t ) 中结束服务，易知 0 ≤ k ≤ n 。 下面着手推导随机环境 ∀ θ * ∈ Θ * 下的M/M/n排队系统的状态过程 X * 的转移概率。容易想到一个服务台在t时刻正在服务，经过 Δ t 时间后，它没有结束服务的概率为 P { B * > t + Δ t | B * > t , ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } = e − μ ( θ * ) Δ t = 1 − μ ( θ * ) Δ t + o ( Δ t ) 那么其对立事件，该服务台结束服务的概率为 P { B * > t + Δ t | B * > t , ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } = e − μ ( θ * ) Δ t = 1 − μ ( θ * ) Δ t + o ( Δ t ) 又因为事件 { N * ( t + Δ t ) − N * ( t ) = n | ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } 与事件 { X * ( t ) = i | ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } ( i ∈ X ) 独立，因此当 Δ t ↓ 0 时，系统中总人数增加一位的概率为： p i , i + 1 ( Δ t , θ * ) ≡ P { X * ( t + Δ t ) = i + 1 | X * ( t ) = i , ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } = ∑ k = 0 min ( i , n ) P { t < X k * < t + Δ t , N * ( t + Δ t ) − N * ( t ) = k + 1 | X * ( t ) = i , θ * [ t , t + Δ t ) } = P { t < X 0 * < t + Δ t , N * ( t + Δ t ) − N * ( t ) = 1 | X * ( t ) = i , θ * [ t , t + Δ t ) } + o ( Δ t ) = P { t < X 0 * < t + Δ t | X * ( t ) = i , θ * [ t , t + Δ t ) } P { N * ( t + Δ t ) − N * ( t ) = 1 | θ * [ t , t + Δ t ) } + o ( Δ t ) = ( e − μ ( θ * ) Δ t ) min ( i , n ) λ ( θ * ) Δ t e − λ ( θ * ) Δ t + o ( Δ t ) = λ ( θ * ) Δ t + o ( Δ t ) 系统中总人数减少一位的概率为： p i , i − 1 ( Δ t , θ * ) ≡ P { X * ( t + Δ t ) = i − 1 | X * ( t ) = i , ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } = ∑ k = 0 min ( i , n ) P { t < X k * < t + Δ t , N * ( t + Δ t ) − N * ( t ) = k − 1 | X * ( t ) = i , θ * [ t , t + Δ t ) } = P { t < X 1 * < t + Δ t , N * ( t + Δ t ) − N * ( t ) = 0 | X * ( t ) = i , θ * [ t , t + Δ t ) }     + P { t < X 2 * < t + Δ t , N * ( t + Δ t ) − N * ( t ) = 1 | X * ( t ) = i , θ * [ t , t + Δ t ) } + o ( Δ t ) = C min ( i , n ) 1 ( 1 − e − μ ( θ * ) Δ t ) ( e − μ ( θ * ) Δ t ) min ( i , n ) − 1 e − λ ( θ * ) Δ t     + C min ( i , n ) 2 ( 1 − e − μ ( θ * ) Δ t ) 2 ( e − μ ( θ * ) Δ t ) min ( i , n ) − 2 λ ( θ * ) Δ t e − λ ( θ * ) Δ t + o ( Δ t ) = min ( i , n ) μ ( θ * ) Δ t + o ( Δ t ) = { i μ ( θ * ) Δ t + o ( Δ t ) ,       i = 1 , 2 , ⋯ , n − 1 , n μ ( θ * ) Δ t + o ( Δ t ) ,     i = n , n + 1 , n + 2 , ⋯ . 同理可得，当 | j − i | ≥ 2 时： p i , j ( Δ t , θ * ) ≡ P { X * ( t + Δ t ) = j | X * ( t ) = i , ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } = o ( Δ t ) 所以我们可以得到： p i , i ( Δ t , θ * ) ≡ P { X * ( t + Δ t ) = j | X * ( t ) = i , ξ * [ t , t + Δ t ) = θ * [ t , t + Δ t ) } = 1 − λ ( θ * ) Δ t − μ i ( θ * ) Δ t + o ( Δ t ) 其中 μ i ( θ * ) = { i μ ( θ * ) ,       i = 1 , 2 , ⋯ , n − 1 , n μ ( θ * ) ,     i = n , n + 1 , n + 2 , ⋯ . (1) 根据随机环境中生灭过程 [ 7 ] 的定义知，随机环境中的M/M/n排队系统的状态过程 { X * ( t ) , t ≥ 0 } 是一随机环境中的生灭过程。生率为 λ i ( θ * ) = λ ( θ * ) ,     i , = 0 , 1 , 2 , ⋯ . 灭率由(1)式给出。 由 [ 10 ] 可知，当满足 ∑ k = 1 ∞ λ 0 ( θ * ) λ 1 ( θ * ) ⋯ λ k − 1 ( θ * ) μ 1 ( θ * ) μ 2 ( θ * ) ⋯ μ k ( θ * ) < ∞ , 时，随机环境中的生灭过程存在平稳分布。即 ∑ k = 1 n − 1 1 k ! ( λ ( θ ∗ ) μ ( θ ∗ ) ) k + ∑ k = n ∞ n n n ! ( λ ( θ ∗ ) n μ ( θ ∗ ) ) k < ∞ , 记 ρ ( θ ∗ ) ≡ λ ( θ ∗ ) n μ ( θ ∗ ) , 那么，当满足 P { θ ∗ ∈ Θ ∗ | ρ ( θ ∗ ) < 1 } = 1 时， { X * ( t ) , t ≥ 0 } 有平稳分布，且平稳分布为 π k * = { ( n ρ ( θ * ) ) k π 0 * k ! ,     k = 1 , 2 , ⋯ , n − 1 n n ρ k ( θ * ) π 0 * n ! ,       k = n , n + 1 , ⋯ (2) π 0 * = [ ∑ k = 0 n − 1 ( n ρ ( θ ∗ ) ) k k ! + ( n ρ ( θ ∗ ) ) n n ! ( 1 − ρ ( θ ∗ ) ) ] − 1 (3) 其中， π k * 表示随机环境中的M/M/n排队系统处于平衡状态后，系统中有k个顾客的概率。"
"由第二节中推导的平稳分布，可以得到随机环境中的M/M/n排队系统的几个重要的数量指标和一些重要结果。对 ∀ θ * ∈ Θ * ， L ( θ * ) 表示给定环境为 θ * 时的系统的队长， L q ( θ * ) 为给定 θ * 时的等待队长， K ( θ * ) 表示平均占用服务台数。 命题1 当 ξ * = θ * 且满足系统平稳条件 P { θ ∗ ∈ Θ ∗ | ρ ( θ ∗ ) < 1 } = 1 的情况下，我们有： K ( θ ∗ ) = λ ( θ ∗ ) μ ( θ ∗ ) ,       E ( L q ( θ ∗ ) ) = ρ ( θ ∗ ) π n * ( 1 − ρ ( θ ∗ ) ) 2 , E ( L ( θ ∗ ) ) = E ( L q ( θ ∗ ) ) + K ( θ ∗ ) = ρ ( θ ∗ ) π n * ( 1 − ρ ( θ ∗ ) ) 2 + λ ( θ ∗ ) μ ( θ ∗ ) . 证：由(2)式和(3)式可以得到 L q ( θ * ) 的分布律： { P { L q ( θ ∗ ) = k } = π n + k * = n n ρ n + k ( θ ∗ ) n ! π 0 * ,                   k = 1 , 2 , 3 , ⋯ P { L q ( θ ∗ ) = 0 } = ∑ j = 0 n π j * = ∑ j = 0 n ( n ρ ( θ ∗ ) ) j j ! π 0 * ,           k = 0 其中 π 0 * 由(3)式确定。从而可得 E ( L q ( θ * ) ) = E [ L q ( θ * ) | ξ * = θ * ] = ∑ k = 0 ∞ k ( n ρ ( θ * ) ) n ρ k ( θ * ) n ! π 0 * = ( n ρ ( θ * ) ) n ρ ( θ * ) n ! ( 1 − ρ ( θ * ) ) 2 π 0 * = ρ ( θ * ) π n * ( 1 − ρ ( θ * ) ) 2 由重期望的计算公式可得 E ( L ( θ ∗ ) ) = E [ L ( θ ∗ ) | ξ * = θ * ] = ∑ k = 0 ∞ k π k * = [ ∑ k = 1 n − 1 k ( n ρ ( θ ∗ ) ) k k ! + ∑ k = n ∞ k n n ρ k ( θ ∗ ) n ! ] π 0 * = { ∑ k = 1 n − 1 ( n ρ ( θ ∗ ) ) k ( k − 1 ) ! + ( n ρ ( θ ∗ ) ) n [ ρ ( θ ∗ ) + n ( 1 − ρ ( θ ∗ ) ) ] n ! ( 1 − ρ ( θ ∗ ) ) 2 } π 0 * 那么根据 E ( L ( θ ∗ ) ) 和 E ( L q ( θ ∗ ) ) 的表达式，平均占用服务台的个数 K ( θ * ) 为 K ( θ ∗ ) = E ( L ( θ ∗ ) ) − E ( L q ( θ ∗ ) ) = [ ∑ k = 1 n − 1 ( n ρ ( θ ∗ ) ) k ( k − 1 ) ! + ( n ρ ( θ ∗ ) ) n [ ρ ( θ ∗ ) + n ( 1 − ρ ( θ ∗ ) ) ] n ! ( 1 − ρ ( θ ∗ ) ) 2 ] π 0 * − ( n ρ ( θ ∗ ) ) n ρ ( θ ∗ ) π 0 * n ! ( 1 − ρ ( θ ∗ ) ) 2 = [ ∑ k = 1 n − 1 ( n ρ ( θ ∗ ) ) k ( k − 1 ) ! + ( n ρ ( θ ∗ ) ) n ( n − 1 ) ! ( 1 − ρ ( θ ∗ ) ) ] π 0 * = n ρ ( θ * ) π 0 * ∑ k = 0 n − 1 ( n ρ ( θ ∗ ) ) k k ! + n ρ ( θ * ) ( n ρ ( θ * ) ) n n ! ( 1 − ρ ( θ ∗ ) ) π 0 * = n ρ ( θ * ) = λ ( θ * ) μ ( θ * ) 再由 K ( θ * ) 的表达式，可以得到 E ( L ( θ * ) ) 更为简洁的表达式 E ( L ( θ * ) ) = E ( L q ( θ * ) ) + K ( θ * ) = ρ ( θ * ) π n * ( 1 − ρ ( θ * ) ) 2 + λ ( θ * ) μ ( θ * ) 命题2 当 ξ * = θ * 且满足系统平稳条件 P { θ ∗ ∈ Θ ∗ | ρ ( θ ∗ ) < 1 } 的情况下，记 W * 为随机环境下顾客的等待时间，则 W * 的分布函数 F W * ( t , θ * ) 为 F W * ( t , θ * ) = { 0 ,                                                                                 t ≤ 0 , 1 − π n * 1 − ρ ( θ * ) e − n μ ( θ * ) ( 1 − ρ ( θ * ) ) t ,           t > 0. 证：在证明之前给出在随机环境 ξ * = θ * 下，顾客到达服务机构需要等待和不需要等待的概率，记需要等待的概率为 p * ，于是 p * = P { L ( θ * ) ≥ n | ξ * = θ * } = ∑ k = n ∞ π k * = ∑ k = n ∞ n n ρ k ( θ * ) n ! π 0 * = ( n ρ ( θ * ) ) n n ! ( 1 − ρ ( θ * ) ) π 0 * = π n * 1 − ρ ( θ * ) 从而在随机环境 ξ * = θ * 下，顾客到达服务机构不需要等待的概率为 1 − p * = 1 − ( n ρ ( θ ∗ ) ) n n ! ( 1 − ρ ( θ ∗ ) ) π 0 * = 1 − ρ ( θ ∗ ) − π n * 1 − ρ ( θ ∗ ) 易见 P { W * = 0 } = P { L ( θ * ) < n } = 1 − π n * 1 − ρ ( θ * ) 对 ∀ t > 0 ， F W * ( t , θ * ) = P { W * < t } = P { W * = 0 } + P { 0 < W * < t } . 接下来要解决 P { 0 < W * < t } 的具体表达式，因为 P { 0 < W * < t } = P { 0 < W * < t | ξ * = θ * } = ∑ k = n ∞ P { 0 < W * < t | L ( θ * ) = k } P { L ( θ * ) = k }                                         = ∑ k = n ∞ P { 0 < W * < t | L ( θ * ) = k } π k * = ∑ k = n ∞ π k * ∫ 0 t ( n μ ( θ * ) ) k − n + 1 x k − n Γ ( k − n + 1 ) e − n μ ( θ * ) x d x                                         = ∫ 0 t π n * ∑ k = n ∞ ( n μ ( θ * ) x ρ ( θ * ) ) k − n ( k − n ) ! n μ ( θ * ) e − n μ ( θ * ) x d x                                         = n μ ( θ * ) π n * ∫ 0 t e − n μ ( θ * ) ( 1 − ρ ( θ * ) ) x d x = π n * 1 − ρ ( θ * ) [ 1 − e − n μ ( θ * ) ( 1 − ρ ( θ * ) ) t ] 因此 F W * ( t , θ * ) = { 0 ,                                                                                 t ≤ 0 , 1 − π n * 1 − ρ ( θ ∗ ) e − n μ ( θ ∗ ) ( 1 − ρ ( θ ∗ ) ) t ,           t > 0. 注1：上述 P { 0 < W * < t } 的推导过程中，利用到了如下引理： 引理1见 [ 11 ]。设 ξ 1 , ξ 2 , ⋯ , ξ n 为n个独立同分布的随机变量，且 ξ 1 ~ Γ ( 1 , α ) ，则 ∑ i = 1 n ξ i ~ Γ ( n , α ) ，即 ∑ i = 1 n ξ i 为具有密度函数 f ( x ) = { α n x n − 1 Γ ( n ) e − α x ,       x > 0 0 ,                                   x ≤ 0         ( α > 0 ) 的n阶埃尔朗随机变量，其中 Γ ( n ) = ∫ 0 ∞ x n − 1 e − x d x ，称 Γ ( n ) 为参数是n的 Γ 函数。 由 F W * ( t , θ * ) 的表达式，我们可以得到 W * 的密度函数 f W * ( t , θ * ) = { 0 ,                                                                                                                                 t < 0 , ( 1 − π n * 1 − ρ ( θ ∗ ) ) δ ( t ) + n μ ( θ ∗ ) π n * e − n μ ( θ ∗ ) ( 1 − ρ ( θ ∗ ) ) t ,       t ≥ 0 , 其中 δ ( t ) 为狄拉克函数，简称为 δ 函数。它有如下性质： 1) 当 t ≠ 0 时， δ ( t ) = 0 ；当 t = 0 时， δ ( t ) = ∞ 。 2) δ ( − t ) = δ ( t ) 。 3) 对任意连续函数 φ ( t ) 有 ∫ − ∞ ∞ φ ( t ) δ ( t ) d t = φ ( 0 ) 。 δ ( t ) 可以看成单跳跃函数 μ ( t ) = { 1 ,       t > 0 0 ,     t ≤ 0 的导数，即 δ ( t ) = d μ ( t ) d t 由 F W * ( t , θ * ) ，或 f W * ( t , θ * ) 的表达式可以得到 W * 的数学期望： E [ W * | ξ * = θ * ] = ∫ 0 − ∞ t d F W * ( t , θ * ) = ∫ 0 − ∞ t f W * ( t , θ * ) d t = ∫ 0 − ∞ ( 1 − π n * 1 − ρ ( θ * ) ) δ ( t ) t d t + ∫ 0 − ∞ n μ ( θ * ) π n * t e − n μ ( θ * ) ( 1 − ρ ( θ * ) ) t d t = π n * n μ ( θ * ) ( 1 − ρ ( θ * ) ) 2 = ρ ( θ * ) π n * λ ( θ * ) ( 1 − ρ ( θ * ) ) 2 = E ( L q ( θ * ) ) λ ( θ * ) 定理1 当 ξ * = θ * ，且满足随机环境中的排队系统平稳条件，设 T * 表示一位顾客在系统中的逗留时间，那么有 E [ T * | ξ * = θ * ] = E ( L ( θ * ) ) / λ ( θ * ) ，并且 T * 的分布函数为： F T * ( t , θ * ) = { 0 ,                                                                                                                                                           t ≤ 0 , 1 − e − μ ( θ * ) t − n μ ( θ * ) t π n * e − μ ( θ * ) t ,     n μ ( θ * ) = λ ( θ * ) + μ ( θ * ) ,         t > 0 , 1 − e − μ ( θ * ) t − μ ( θ * ) π n * ( 1 − ρ ( θ * ) ) ( n μ ( θ * ) − λ ( θ * ) − μ ( θ * ) ) × [ e − μ ( θ * ) t − e − ( n μ ( θ * ) − λ ( θ * ) ) t ] ,               n μ ( θ * ) ≠ λ ( θ * ) + μ ( θ * ) ,       t > 0. 证：1) 由于在随机环境 ξ * = θ * 下，顾客接受服务的时间 B * 与等待时间 W * 独立，于是 T * = W * + B * 因此 E ( T * | ξ * = θ * ) = E ( W * | ξ * = θ * ) + E ( B * | ξ * = θ * ) = ρ ( θ * ) π n * λ ( θ * ) ( 1 − ρ ( θ * ) ) 2 + 1 μ ( θ * ) = E ( L ( θ * ) ) λ ( θ * ) 2) 当 t > 0 时，我们有 P { T * < t | ξ * = θ * } = P { W * + B * < t | ξ * = θ * } = ∫ 0 t P { W * + B * < t | B * = x } μ ( θ ∗ ) e − μ ( θ ∗ ) x d x = ∫ 0 t P { W * < t − x } μ ( θ ∗ ) e − μ ( θ ∗ ) x d x = ∫ 0 t [ 1 − π n * 1 − ρ ( θ ∗ ) e − ( n μ ( θ ∗ ) − λ ( θ ∗ ) ) ( t − x ) ] μ ( θ ∗ ) e − μ ( θ ∗ ) x d x = { 1 − e − μ ( θ ∗ ) t − μ ( θ * ) t π n * 1 − ρ ( θ ∗ ) e − ( n μ ( θ ∗ ) − λ ( θ ∗ ) ) t ,       n μ ( θ ∗ ) = λ ( θ ∗ ) + μ ( θ ∗ ) 1 − e − μ ( θ ∗ ) t − μ ( θ * ) t π n * ( 1 − ρ ( θ * ) ) ( n μ ( θ * ) − λ ( θ * ) − μ ( θ * ) ) × [ e − μ ( θ ∗ ) t − e − ( n μ ( θ ∗ ) − λ ( θ ∗ ) ) t ] ,                                 n μ ( θ * ) = λ ( θ * ) + μ ( θ * ) 所以 T * 的分布函数为 F T * ( t , θ * ) = { 0 ,                                                                                                                                                           t ≤ 0 , 1 − e − μ ( θ ∗ ) t − n μ ( θ * ) t π n * e − μ ( θ * ) t ,     n μ ( θ * ) = λ ( θ * ) + μ ( θ * ) ,     t > 0 , 1 − e − μ ( θ ∗ ) t − μ ( θ * ) π n * ( 1 − ρ ( θ * ) ) ( n μ ( θ * ) − λ ( θ * ) − μ ( θ * ) ) × [ e − μ ( θ ∗ ) t − e − ( n μ ( θ ∗ ) − λ ( θ ∗ ) ) t ] ,               n μ ( θ * ) ≠ λ ( θ * ) + μ ( θ * ) ,       t > 0. 又因为 T * 是连续型随机变量，我们可以由 F T * ( t , θ * ) 得到 T * 的密度函数： f T * ( t , θ * ) = { 0 ,                                                                                                                                                                                                     t ≤ 0 , ( n μ 2 ( θ * ) t π n * + μ ( θ * ) − n μ ( θ * ) π n * ) e − μ ( θ ∗ ) t ,         n μ ( θ * ) = λ ( θ * ) + μ ( θ * ) ,           t > 0 , [ μ ( θ * ) + μ 2 ( θ * ) π n * ( 1 − ρ ( θ * ) ) ( n μ ( θ * ) − λ ( θ * ) − μ ( θ * ) ) ] e − μ ( θ ∗ ) t − n μ 2 ( θ * ) π n * n μ ( θ * ) − λ ( θ * ) − μ ( θ * ) × e − ( n μ ( θ ∗ ) − λ ( θ ∗ ) ) t ,       n μ ( θ * ) ≠ λ ( θ * ) + μ ( θ * ) ,             t > 0. 在之前的讨论中，我们得到了 E ( W * | ξ * = θ * ) 与 E ( L q ( θ * ) ) 的关系，以及 E ( T * | ξ * = θ * ) 与 E ( L ( θ * ) ) 的关系，下面给出随机环境 ξ * = θ * 下的利特尔公式及证明，该定理是经典利特尔公式的推广，适用范围更加广泛。 定理2 (随机环境下的利特尔公式)在随机环境 ξ * = θ * 下的排队系统中， E ( W * | ξ * = θ * ) 与 E ( L q ( θ * ) ) ， E ( T * | ξ * = θ * ) 与 E ( L ( θ * ) ) 分别满足： E ( W * | ξ * = θ * ) = E ( L q ( θ * ) ) / λ ( θ * ) ¯ ,         E ( T * | ξ * = θ * ) = E ( L ( θ * ) ) / λ ( θ * ) ¯ . 其中 λ ( θ * ) ¯ 为系统的进入率。 证：1) 设 α ( t , θ * ) 表示 ( 0 , t ] 时间内， ξ * = θ * 下，进入服务系统的顾客数，那么系统在这段时间内的平均进入率为： λ ( θ * ) ¯ = E [ α ( t , θ * ) | ξ * = θ * ] t . 设 γ ( t , θ * ) 表示 α ( t , θ * ) 个顾客到时刻t为止在系统中花费的总时间，那么在这段时间内每个顾客的平均逗留时间为： T t ( θ * ) ¯ = E [ γ ( t , θ * ) | ξ * = θ * ] E [ α ( t , θ * ) | ξ * = θ * ] 从而在这段时间里，单位时间中系统的平均顾客数为： L t ( θ * ) ¯ = E [ γ ( t , θ * ) | ξ * = θ * ] t . 也可以表示为： L t ( θ * ) ¯ = E [ γ ( t , θ * ) | ξ * = θ * ] E [ α ( t , θ * ) | ξ * = θ * ] . E [ α ( t , θ * ) | ξ * = θ * ] t . (4) 接下来，我们记 λ ( θ * ) ¯ = lim t → ∞ λ t ( θ * ) ¯ ,     E ( T * | ξ * = θ * ) = lim t → ∞ T t ( θ * ) ¯ ,     E ( L ( θ * ) ) = lim t → ∞ L t ( θ * ) ¯ 在系统平衡条件下，上述三个极限存在，对(4)式两端取极限，令 t → ∞ 得： E ( L ( θ * ) ) = λ ( θ * ) ¯ E ( T * | ξ * = θ * ) 即 E ( T * | ξ * = θ * ) = E ( L ( θ * ) ) λ ( θ * ) ¯ 2) 设 γ * ( t , θ * ) 表示在 ( 0 , t ] 内进入系统的 α ( t , θ * ) 个顾客到时刻t为止等待时间之和。那么每个顾客的平均等待时间为： W t ( θ * ) ¯ = E [ γ * ( t , θ * ) | ξ * = θ * ] E [ α ( t , θ * ) | ξ * = θ * ] . 从而在 ( 0 , t ] 里，单位时间中系统的平均等待顾客数为： L q t ( θ * ) ¯ = E [ γ * ( t ) | ξ * = θ * ] t = E [ γ * ( t ) | ξ * = θ * ] E [ α * ( t ) | ξ * = θ * ] ⋅ E [ α * ( t ) | ξ * = θ * ] t . 所以当 λ ( θ * ) ¯ = lim t → ∞ λ t ( θ * ) ¯ ， E ( W * | ξ * = θ * ) = lim t → ∞ W t ( θ * ) ¯ 存在时， E [ L q ( θ * ) ] = lim t → ∞ L q t ( θ * ) ¯ 也存在，从而可得： E [ L q ( θ * ) ] = λ ( θ * ) ¯ E ( W * | ξ * = θ * ) , 即 E ( W * | ξ * = θ * ) = E ( L q ( θ * ) ) λ ( θ * ) ¯ 注2：随机环境下的利特尔公式的推导与顾客到达时间间隔、服务时间、以及排队的规则无关。"
"本文的最后，将讨论随机环境中的M/M/n排队系统的状态过程 X * 的转移概率 p ( θ * , t ; i , j ) 的随机Kolmogorov方程。这里 p ( θ * , t ; i , j ) 采用 [ 7 ] 中的表示方法。对每个 θ * ∈ Θ * ，   t > 0 ,   i , j ∈ X ， p ( θ * , t ; i , j ) 为时齐的随机转移函数。以下讨论结果均在假设状态空间有限的条件下进行： 定理3 (随机Kolmogorov方程)设 X * = { X * ( t ) , t ≥ 0 } 是随机环境中M/M/n排队系统的状态过程，且对任意的 θ * ∈ Θ * ， P { θ * ∈ Θ * | λ ( θ * ) < ∞ } = 1 ，则对 ∀ θ * ∈ Θ * , s ≥ 0 , t > 0 , i , j ∈ X ，有 1) 随机Kolmogorov向后方程 ∂ ∂ t p ( θ * , t ; i , j ) = λ ( θ * ) p ( θ * , t ; i + 1 , j ) − λ ( θ * ) p ( θ * , t ; i , j ) ; 2) 随机Kolmogorov向前方程 ∂ ∂ t p ( θ * , t ; i , j ) = λ ( θ * ) p ( θ * , t ; i , j − 1 ) − λ ( θ * ) p ( θ * , t ; i , j ) ; 证：1) 根据 [ 9 ] 中定义1的(3)有 p ( θ * , t + h ; i , j ) = ∑ k ∈ X p ( θ * , h ; i , k ) p ( θ * , t ; k , j ) , 变形得到 p ( θ * , t + h ; i , j ) − p ( θ * , t ; i , j ) = ∑ k ≠ i p ( θ * , h ; i , k ) p ( θ * , t ; k , j ) − ( 1 − p ( θ * , h ; i , i ) ) p ( θ * , t ; i , j ) , 对上式两端取极限，令 h → 0 得 lim h → 0 p ( θ * , t + h ; i , j ) − p ( θ * , t ; i , j ) h = lim h → 0 ∑ k ≠ i p ( θ * , h ; i , k ) h p ( θ * , t ; k , j ) − lim h → 0 1 − p ( θ * , h ; i , i ) h p ( θ * , t ; i , j ) , (5) 因为假设随机环境中的M/M/n排队系统的状态有限，所以极限与求和运算可交换，即 lim h → 0 ∑ k ≠ i p ( θ * , h ; i , k ) h p ( θ * , t ; k , j ) = ∑ k ≠ i lim h → 0 p ( θ * , h ; i , k ) h p ( θ * , t ; k , j ) 于是可将(5)式变形得到 lim h → 0 p ( θ * , t + h ; i , j ) − p ( θ * , t ; i , j ) h = ∑ k ≠ i lim h → 0 p ( θ * , h ; i , k ) h p ( θ * , t ; k , j ) − lim h → 0 1 − p ( θ * , h ; i , i ) h p ( θ * , t ; i , j ) , (6) 又根据 [ 9 ] 中定义2的(3)，对 ∀ k ∈ X 有 lim h → 0 1 − p ( θ * , h ; k , k ) h = λ ( θ * ) , lim h → 0 p ( θ * , h ; k , k + 1 ) h = λ ( θ * ) , (7) 代入(6)式有 ∂ ∂ t p ( θ * , t ; i , j ) = λ ( θ * ) p ( θ * , t ; i + 1 , j ) − λ ( θ * ) p ( θ * , t ; i , j ) , 因此，随机Kolmogorov向后方程得证。 2) 类似地，根据定义1的(3)有 p ( θ * , t + h ; i , j ) = ∑ k ∈ X p ( θ * , t ; i , k ) p ( θ * , h ; k , j ) , 变形可得 p ( θ * , t + h ; i , j ) − p ( θ * , t ; i , j ) = ∑ k ≠ j p ( θ * , t ; i , k ) p ( θ * , h ; k , j ) − ( 1 − p ( θ * , h ; j , j ) ) p ( θ * , t ; i , j ) , 于是有 lim h → 0 p ( θ * , t + h ; i , j ) − p ( θ * , t ; i , j ) h = lim h → 0 ∑ k ≠ j p ( θ * , t ; i , k ) p ( θ * , h ; k , j ) h − lim h → 0 1 − p ( θ * , h ; j , j ) h p ( θ * , t ; i , j ) , 状态有限，上式中极限与求和运算顺序可交换，因此上式可变为 lim h → 0 p ( θ * , t + h ; i , j ) − p ( θ * , t ; i , j ) h = ∑ k ≠ j p ( θ * , t ; i , k ) lim h → 0 p ( θ * , h ; k , j ) h − lim h → 0 1 − p ( θ * , h ; j , j ) h p ( θ * , t ; i , j ) , (8) 最后利用(7)式的结果代入(8)式得到 ∂ ∂ t p ( θ * , t ; i , j ) = λ ( θ * ) p ( θ * , t ; i , j − 1 ) − λ ( θ * ) p ( θ * , t ; i , j ) . 因此，随机Kolmogorov向前方程得证。定理证明完毕。 注3：因为随机转移函数关于时间t是时齐的，随机转移函数关于t的可导性无特殊要求。"
