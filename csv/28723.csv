"从心电系统中采集的心率变异性(Heart Rate Variability, HRV)信号，不可避免的混入噪声和各种趋势，消除这些趋势的干扰，有助于非线性系统复杂动力学分析的准确性。本文采用平滑先验法消除健康人白天和夜间的HRV信号中所叠加的不同趋势项，使用近似熵和基本尺度熵对其进行复杂性计算，对比分析去趋势处理前、后近似熵和基本尺度熵的稳定性变化。研究发现：去趋势处理后，平滑先验法能够有效去除HRV信号的各种趋势项，且较大幅度地提高了近似熵的稳定性，而基本尺度熵在去趋势处理前、后均呈现出较强的稳定性。研究结果表明去趋势处理后，两种熵测度都可以区分开健康人白天和夜间的HRV信号，充分体现出平滑先验法可以提高熵测度的稳定性和识别性，为临床的生理病理诊断提供了重要的理论依据。 关键词 :平滑先验法，心率变异性，基本尺度熵，近似熵，稳定性 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"心率变异性信号，又称RR间期信号，是指逐次心跳周期差异的变化情况 [ 1 ] [ 2 ] ，蕴含有关心血管调节的大量信息。由于心脏系统本身是一个非常复杂的非线性系统，为了找出适合HRV信号的稳定性分析方法，国内外学者提出了一系列的非线性分析方法，如：小波分析、去趋势波动分析、多重分形、散点图、熵分析等。在这些众多的非线性分析方法中，熵分析是其中比较具有代表性的，而且被公认为效果比较好的方法 [ 3 ] [ 4 ] 。 然而在心电信号采集过程中，心电信号容易受到诸如人体呼吸、出汗和电极轻微移动，甚至是肌肉的缓慢运动等各种低频噪声的浸染，而这些低频噪声干扰或趋势项渗入通常不利于信号的分析。因此，减小和消除测试信号中的趋势项是数据处理的一个重要步骤 [ 5 ] 。 目前，去趋势处理的常用方法主要有差分法、低通滤波法、滑动平均法、最小二乘拟合法、小波法以及经验模态法 [ 6 ] 等。前4种方法需要预先假设趋势项类型，如线性、多项式或指数趋势等，不适合处理信号中趋势随机或复杂变化的情况；而后两种方法对小波基的选择或分解层次要求比较复杂，很难准确提取需要的特征值或特征向量。平滑先验法是一种改进的消除非平稳趋势项算法 [ 7 ] [ 8 ] ，能有效去除待处理信号中的趋势项，同时保留感兴趣的信号。而且在实际计算中，平滑先验法计算简单，可用于实时计算。本文使用平滑先验法来消除标准心电数据库中健康人昼夜节律心率变异性信号所叠加的各种趋势项，同时对去趋势处理前、后的实验数据进行近似熵和基本尺度熵 [ 9 ] 计算，分析两种熵分析方法的稳定性以及临床应用前景。"
"平滑先验法(Smoothness Priors Approach, SPA)是芬兰库奥皮奥大学的Karjalainen博士 [ 10 ] 提出的一种信号非线性去趋势方法，该算法假设原始数据信号，即时间序列z由两部分组成： z = z s + z t (1) 在上面公式(1)中， z s 是平稳项； z t 是非线性的低频趋势成分，且可用下面公式表示为： z t = H θ + v (2) 在公式(2)中， H ∈ R N × M 为观测矩阵， θ ∈ R M 为回归参数，v为观测误差，那么任务就转化为采取优化方法估计参数θ，从而使 z t ^ = H θ ^ 来估计原信号中的趋势项。估计参数θ的常用方法是最小二乘法，平滑先验法在寻优过程中加入了微分项 ‖ D d ( H θ ) ‖ ，并使之达到最小来保证 H θ 滤去的是信号中的趋势项部分： θ λ = arg min θ { ‖ H θ − z ‖ 2 + λ 2 ‖ D d ( H θ ) ‖ 2 } (3) 式中：λ为正规则化参数，D d 为离散化的d阶微分算子矩阵。矩阵D d 的求解方式如下： 设序列z中含有N个局部极值点，可用列项量 R = [ R 1 , R 2 , ⋯ R N ] T ∈ R N 表示，R的一阶趋势表示为： R 1 = [ R 2 − R 1 , ⋯ , R N − R N − 1 ] T ，二阶趋势可表示为： R 2 = [ R 3 − R 2 − ( R 2 − R 1 ) , R 4 − R 3 − ( R 3 − R 2 ) , ⋯ , R N − R N − 1 − ( R N − 1 − R N − 2 ) ] T (4) 以此类推，就可得到R的任意阶趋势的离散表示形式，即R的d阶微分可用D d 表示为： D d = [ d ( R d ) 1 / d R 1 ⋯ d ( R d ) 1 / d R N ⋮ ⋮ d ( R d ) N − d / d R 1 ⋯ d ( R d ) N − d / d R N ] (5) 式(5)中的解为 θ λ ^ = ( H T H + λ 2 H T D d T D d H ) − 1 H T z 和 ，其中 z t ^ 就是需要去除的趋势项的估计值。 矩阵H可以通过分析原信号z的特性获取，为了分析简便，H采用单位矩阵 I ∈ R N × N 。对于矩阵D d ，当阶数为2时可以很好地估计信号中的非周期趋势项，因此D d 的阶数取2， D 2 ∈ R ( N − 2 ) × N 可表示为： D 2 = [ 1 − 2 1 0 ⋯ 0 0 1 − 2 1 ⋯ ⋮ ⋮ ⋮ ⋮ ⋮ 0 0 ⋯ 0 1 − 2 1 ] (6) 因此，原信号去除趋势项后的平稳部分可以表示为： z s ^ = z − H θ ^ λ = [ I − ( I + λ 2 D 2 T D 2 ) − 1 ] z = L z (7) 公式(7)中令 L = [ I − ( I + λ 2 D 2 T D 2 ) − 1 ] ，则有 z s ^ = L z 。  在上式(7)中，矩阵L的作用相当于一个高通滤波器。通过对矩阵L的任意一行做傅立叶变换，可以得到其频率特性。取N = 50，λ = 50，根据式(6)和式(7)用MATLAB编程计算，得到L的频率响应如下图1所示。 在图1中，x轴是归一化后的频率f，z轴代表幅值，由于对称性的原理，y轴中的N只取了1~25之间的数据。由下图1可以看出，L的滤波作用绝大部分是平顺的，只有在信号的初始段和末段，滤波效果不太理想。让规则化参数λ取不同的值，对L的第N/2行作傅立叶变换，从而得到不同λ值对应的频率响应，结果如下图2所示。 图1. L的频率响应 图2. 不同λ下的频率响应 频率响应是电子学领域中用来衡量线性电子学系统性能的主要指标 [ 11 ] ，心电信号的主要成分的频率范围在1~100 Hz，趋势项的频率一般集中在低频范围中，因此一般在预处理中将HRV信号的采样频率降低为4 Hz。由下面表1可以看出，当λ = 100时，对应的截至频率为0.0296 × 4 = 0.1184 Hz，基本可以保证原始数据中低频趋势项的消除，同时保留感兴趣的信号成分。 Table 1 参数λ 1 2 5 10 20 100 相对截止频率 0.2241 0.1518 0.0942 0.0660 0.0499 0.0296 表1. 正则化参数与相对截止频率  近似熵主要是从衡量时间序列复杂性的角度来度量信号中产生的新模式概率的大小，产生新模式的概率越大、序列的复杂性越大，相应的近似熵也越大 [ 12 ] 。 本文采用标准近似熵(2, r, N)分析颠倒作息HRV时间序列，其中嵌入维数m = 2，r为相似容限(通常取0.1~0.5 SD，本文取r = 0.2 SD [ 13 ] ) (SD代表信号的标准差)。  基本尺度熵的本质是定量的分析m-words组合出现的不确定性 [ 14 ] ，熵值越大表示m-words的组合形式出现的更加不确定，即波动模式越复杂 [ 15 ] 。对于颠倒作息HRV序列，本文取嵌入维数m = 2，特殊参数α = 0.2，α的取值是利用Wessel [ 16 ] 等的测试方法得到。(若 m = 3 , 4 , 5 , 6 , 7 ，结果无任何影响，改变α值从0.1~2，结果也无明显的不同)。"
"本文的HRV数据来自Physionet当中的BIH/MIT Normal Sinnus Rhythm数据库，其中包含18名(平均年龄为20~50岁，采样频率为128 Hz)健康人白天和夜间的HRV信号(即健康人24 h昼夜节律下的HRV信号) [ 17 ] [ 18 ] 。本文对每一组RR间期信号，分别选取白天和夜间HRV信号作为原始信号，对其进行去除趋势项分析。为了能够清楚显示信号的细节，我们对两种样本信号选取了3000个采样点，消除趋势后的HRV信号的波形和原始信号的波形对比图如图3所示。 图3. 平滑先验法消除HRV信号趋势前后的波形 图3代表一个健康人在白天和夜间的RR间期使用平滑先验法消除趋势项前后的波形对比图(其余受试者RR间期去趋势前后波形对比图变化规律与此相似)，观察图3(a)和图3(b)可以明显看到：健康人白天RR间期明显小于健康人夜间的RR间期，心率变异性变化呈现出白天升高，夜间降低的特点；从图3中还可以看出，HRV信号的趋势项得到了有效消除，同时保留了感兴趣的HRV信号成分。"
"为了研究SPA去趋势处理算法对两种熵测度稳定性的影响，我们对健康人白天和夜间的HRV信号进行去趋势处理前、后的近似熵(m = 2, r = 0.2)和基本尺度熵(m = 2, α = 0.25)计算，其中线性趋势参数(A l = 0.001)、周期性趋势参数(As = 0.2, T = 500)、幂律性趋势参数(Ap = 2, i = 0.2)，其计算结果如图4、图5所示。 图4(a)和图4(b)分别是平滑先验法消除RR间期信号在不同趋势前、后的基本尺度熵的计算结果，具体统计计算结果分别如表2和表3所示。从表2中可以看出健康人白天的近似熵值大于健康人夜间的近似熵值，这与近似熵结果相反。这是因为睡眠会使迷走神经的调节活动增强，而抑制睡眠的交感神经活动减弱，使得近似熵值增强，基本尺度熵值减小 [ 19 ] 。且如表2所示，经t检验 [ 20 ] ，P (白天，夜间) < 0.05，即基本尺度熵可以区分开不同的两组样本；同时，当样本具有不同趋势时，P (白天，夜间) < 0.05，这表明基本尺度熵不会受信号中的各种趋势影响，可以准确的区分开健康人正常作息下的昼夜节律变化，充分体现出基本尺度熵的稳定性和有效性。作为比较，当我们使用平滑先验法去趋势处理后，如图4(b)所示，不管是HRV信号具有单一趋势还是由单一趋势叠加而成的混合趋势，基本尺度熵值均保持不变，如表3所示，经t检验，P (白天，夜间) < 0.05，这说明经过去趋势处理前、后，基本尺度熵值均可有效区分不同状态下的两组样本，且不会受趋势干扰影响实验结果的准确性，这是其他算法所不具备的优点。 图4. 两组样本在去趋势处理前(a)和去趋势处理后(b)的基本尺度熵 Table 2 基本尺度熵 原始信号 线性趋势 周期性趋势 幂律性趋势 混合趋势 健康人白天 4.1289 ± 0.1841 3.7142 ± 0.1386 3.6463 ± 0.1397 3.6114 ± 0.1485 3.6639 ± 0.1246 健康人夜间 3.7615 ± 0.1879 3.5260 ± 0.1510 3.4979 ± 0.1491 3.4805 ± 0.1476 3.5226 ± 0.1480 P值 1.777 × 10 − 6 5.953 × 10 − 4 0.0051 0.0144 0.0049 表2. HRV信号基本尺度熵统计结果(平均值 ± 标准差) Table 3 基本尺度熵 消除原始信号趋势 消除线性趋势 消除周期性趋势 消除幂律性趋势 消除混合趋势 健康人白天 3.7282 ± 0.1061 3.7282 ± 0.1061 3.7286 ± 0.1061 3.7282 ± 0.1061 3.7282 ± 0.1061 健康人夜间 3.6286 ± 0.1636 3.6286 ± 0.1636 3.6285 ± 0.1638 3.6286 ± 0.1636 3.6286 ± 0.1636 P值 0.0427 0.0427 0.0420 0.0427 0.0427 表3. 去趋势处理后HRV信号基本尺度熵统计结果(平均值 ± 标准差) 图5显示了平滑先验法消除RR间期信号在不同趋势前、后的近似熵的计算结果，具体统计计算结果分别如表4和表5所示。从表4可以看出，对于原始信号，即不含趋势的样本信号，健康人白天的近似熵值小于健康人夜间的近似熵值。经t检验，P (白天，夜间) < 0.05，即近似熵可以区分开不同的两组样本。然而，当样本具有线性、幂律以及三种趋势叠加的混合趋势时，P (白天，夜间) > 0.05，这表明近似熵易受到信号中不同趋势影响，使得近似熵不能准确的区分开健康人正常作息下的昼夜节律变化，体现出近似熵的不稳定性。作为比较，当我们使用平滑先验法去趋势处理后，如图5(b)所示，不论是HRV信号具有单一趋势或是具有由单一趋势叠加而成的混合趋势，近似熵值均保持恒定。如表5所示，经t检验，P (白天，夜间) < 0.05。这说明平滑先验法消除信号中掺杂的趋势项效果明显，大大提高了近似熵分析的准确度和稳定性，使之具有了和基本尺度熵同等的优势，这为以后信号的非线性处理提供了一个很好的思路。 图5. 两组样本在去趋势处理前(a)和去趋势处理后(b)的近似熵 Table 4 近似熵 原始信号 线性趋势 周期性趋势 幂律性趋势 混合趋势 健康人白天 0.5462 ± 0.3586 0.0419 ± 0.0184 0.2774 ± 0.1734 0.0270 ± 0.0112 0.0366 ± 0.0201 健康人夜间 0.9766 ± 0.3643 0.0884 ± 0.0419 0.5617 ± 0.2209 0.0527 ± 0.0281 0.0744 ± 0.0396 P值 0.0014 0.2056 0.0196 0.4281 0.2013 表4. HRV信号近似熵统计结果 Table 5s after detrending processin 近似熵 消除原始信号趋势 消除线性趋势 消除周期性趋势 消除幂律性趋势 消除混合趋势 健康人白天 1.0462 ± 0.4066 1.0462 ± 0.4066 1.0462 ± 0.4066 1.0462 ± 0.4066 健康人夜间 1.3480 ± 0.2510 1.3480 ± 0.2510 1.3466 ± 0.2508 1.3480 ± 0.2510 1.3480 ± 0.2510 P值 0.0232 0.0232 0.0238 0 .0232 0.0232 表5. 去趋势处理后HRV信号近似熵统计结果"
"本文首先通过对健康人昼夜节律下的心率变异性信号分别叠加不同的线性、周期性、幂律性趋势以及几种趋势的混合，运用近似熵和基本熵对其进行两种熵分析。结果表明近似熵对信号中存在的趋势较为敏感，即在趋势的掩盖下，严重影响了近似熵对HRV信号的复杂性分析；而基本熵受趋势影响较小，表现出良好的稳定性和有效性。当联合平滑先验去趋势方法之后，再次使用两种熵算法对健康人昼夜节律下的HRV信号叠加各类不同趋势进行分析时，研究结果发现：平滑先验法很好地消除了心率变异性信号中存在的各类趋势，使得近似熵对信号内部复杂性的区别有了很好的稳定性和分辨性；在不同趋势随机变化的影响下，近似熵在去趋势处理前、后熵值变化很大，而基本尺度熵在经过去趋势处理前、后的熵值变化均具有较高的稳定性。并且去趋势处理后，两种熵测度都可以区分开健康人白天和夜间的HRV信号。这充分体现出平滑先验法可以提高熵测度的稳定性和区分性，以后我们也可以研究平滑先验法是否能提高其他非线性分析方法的稳定性，为临床的生理病理诊断和以后的科学研究提供了又一良好的参考价值。"
