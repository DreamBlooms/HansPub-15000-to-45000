"论文融合计算机技术、移动平台开发技术、绿色照明系统技术等，设计一种基于单片机的新型绿色节能LED台灯。该系统下位机通过与热释电传感器、光敏电阻传感器和蓝牙传输等硬件相结合来达到手动调节和自动感应调节功能，系统上位机利用安卓平台对LED台灯进行手动控制和语音控制。 关键词 :LED台灯，单片机，安卓平台，PWM调光，语音控制 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"全球能源短缺忧虑的背景下，节约能源是我们面临的重要问题。LED光源具有产品颜色一致性好、节能、环保、寿命长等特点，其应用代表节能绿色照明趋势。本设计基于LED光源，加上外部环境感应模块以及蓝牙传输模块，并利用安卓设备对其控制，实现选择最合适的LED台灯亮度状态，达到满足人们生活品质要求和节能目的。"
"论文融合计算机技术、移动平台开发技术、绿色照明系统技术等，设计一种基于51单片机的新型绿色节能LED台灯。LED台灯下位机融合光线感应和热释电模块，结合脉宽宽度调制(Pulse Width Modulation，PWM)技术和驱动电路设计，并通过热释电传感器与光敏电阻传感器、蓝牙传输等硬件相结合实现手动和自动感应调节功能。上位机利用安卓平台对新型绿色节能LED台灯进行手动控制和语音控制。设计原理如图1。 图1. 新型节能LED台灯设计原理"
"考虑设计的LED台灯具备智能性和低功耗性，其下位机以STC89C51RC单片机为控制芯片，整体电路设计原理如图2，包括按键、复位、晶振、光敏、蓝牙通信、热释电、LED驱动等模块。 软件设计采用模块化结构，编程语言为C语言，开发环境为Keil，通过STC_ISP将程序下载到单片机内 [ 1 ]。下位机软件工作流程如图3。  本设计根据脉宽宽度调制(PWM)原理 [ 2 ]，将每一个脉冲看成是均匀分布的32份高低电平组成，每1份对应的时间为0.5 ms，定义变量PWM来计算定时器中断的次数，利用PWM的计数值作为高电平输出时间参考值，从而产生需要的占空比。设计使用S9012 (NPN)三极管，其硬件设计如图4，将其基极连接至单片机的P3.5端口。当单片机发送低电平至基极将会让LED电路导通并起到放大作用，保证设计中16个并联的LED灯能够正常工作。相反，当基极接收到高电平，整个三极管驱动电路动作在截止状态，使得LED进入熄灭状态。相比于传统的采用改变正向电流调光技术，设计能提供更大的调光范围和更好的线性度，且颜色一致性好、亮度级别高、LED驱动器转换效率高等特点。 图2. LED台灯模块组成 图3. LED台灯上位机软件工作流程图 图4. 三极管放大电路  当外界环境变亮，灯自动变暗至熄灭，反之亦然。为达到该要求，设计采用光敏电阻。光敏阻值变化与电阻分压，需通过模拟信号模数转换，以及可调电阻光线限值的调节，最终将信号给单片机处理。根据ADC0832的时序反复调试，保证LED调至合适状态。光线感应电路如图5。 图5. 光线感应电路 外界特征感应采用HC-SR501热释电红外线传感器探测人体信号。但热释电红外传感器输出的信号较弱(毫伏级)，单片机难以识别(伏级别)。为此，设计通过采用信号处理芯片BISS0001对热释电红外传感器输出的信号进行放大、滤波后得到伏级别的电压信号，单片机根据得到伏级的电压信号做出相应的判断 [ 3 ]。为热释电电路如图6。 图6. 基于HC-SR501热释电电路设计原理  通信模块采用HC-05系列芯片，设计原理如图7。首先进行时钟、定时器等初始化，然后进行蓝牙交互，即本地蓝牙从设备等待对方发送建链请求，并同意建立连接句柄后进行数据交换。蓝牙交互传输完成的数据提取出来进行相应操作。 图7. 基于蓝牙信号传输电路设计原理"
"上位软件设计采用Java语言，开发环境为Eclipse。首先进行上位机Activity的配置、监听事件等初始化，之后需判断是否和下位机HC-05蓝牙设备保证正常的通讯。当建立正常通讯后进入操作界面，选择操作方式进入下一步执行状态。若点击back按钮，则会进入模式选择界面，然后重新执行上一步 [ 4 ]。上位机软件流程如图8。 图8. LED台灯上位机软件设计流程  语音信号处理流程如图9。包括语音信号预处理、语音端点检测、语音特征提取、语音模型库选择、语音模式匹配。 图9. 语音信号处理流程  语音信号随时间变化而变化，每个音频之间存在不连续性。在较短时间段内，话音信号可近似其特性基本保持不变(即话音信号的“瞬时平稳性”)。为强化话音信号抽样附近的波形，弱化其余波形部分，则需对信号进行加窗处理 [ 5 ]。常用窗函数有矩形窗、海宁窗和汉明窗。矩形窗主瓣较窄，具有较高的频率分辨率，但有较高的旁瓣，相邻谐波会因能量泄漏而导致互相叠加或抵消等比较严重的干化。与矩形窗相比，汉明窗加窗处理后可得到的相对纯净的频谱，为此设计选用汉明窗。  信号中存在的噪声在信号检测中不可避免，而最大程度的减少噪声的干扰成为信号检测中关键的一步。设计采用谱减法去噪，即在假定加性噪声与短时平稳的语言信号相互独立的情况下，从带噪语音的功率谱中去除噪声获得较纯净的语音 [ 6 ]。谱减法基本处理过程如图10。 图10. 基本谱减法原理 假设带噪语音 y ( t ) ，纯净语音 s ( t ) ，噪声信号 n ( t ) ，则有： y ( t ) = s ( t ) + n ( t ) (1) 用 Y ( ω ) 、 、 N ( ω ) 分别表示 y ( t ) 、 s ( t ) 、 n ( t ) 的傅里叶变换，则可得： Y ( ω ) = S ( ω ) + N ( ω ) (2) 因假定信号与加性噪声为相互独立，则有： | Y ( ω ) | = | S ( ω ) | + | N ( ω ) | (3) 如果用 P y ( ω ) 、 P s ( ω ) 、 P n ( ω ) 分别表示 、 s ( t ) 、 n ( t ) 的功率谱，则有： P y ( ω ) = P s ( ω ) + P n ( ω ) (4) 由于平稳噪声的功率谱在发声前和发声期间可认为基本不变，则功率谱 P n ( ω ) ： (5)  语音信号一般分为浊音段、无声段和清音段。浊音段是声带振动发出对应的语音信号段，无声段是背景噪声段，清音段是空气在口腔中的冲击、摩擦发出的语音信号段。清音段和无声段的波形特点明显不同，清音段信号在幅度上变化剧烈，穿越零电平次数也多，无声段信号变化较为缓慢。端点检测指首先判断有声还是无声。如果有声，则需判断是清音还是浊音。论文根据过零率和短时能量两个特征进行端点检测 [ 7 ]。 定义语音信号 分帧后得到第i帧语音信号为 y i ( n ) 。则第i帧语音信号 y i ( n ) 的短时能量： E ( i ) = ∑ n = 0 L − 1 y i 2 ( n ) , 1 | n | f n (6) 过零率是指样本数值改变符号的次数。同样定义语音信号 x ( n ) 分帧后得到第i帧语音信号 y i ( n ) 。其过零率为： Z ( i ) = ∑ n = 0 L − 1 | s g n [ y i ( n ) ] − s g n [ y i ( n − 1 ) ] | , 1 ≤ i ≤ f (7) 式中 s g n [ ] 是符号函数 s g n [ x ] = { 1           x > 0 − 1       x < 0 (8)  语音识别用语音特征梅尔倒谱系数(Mel-Frequency Cepstral Coefficients, MFCC)。该参数相比基于声道模型的LPCC (Linear Prediction Cepstral Coefficients)具有更好的鲁邦性，且当信噪比降低时具有较好的识别性能。MFCC特征参数提取原理如图11 [ 8 ]。 图11. MFCC特征参数提取原理 (1) 对输入语音信号进行分帧、加窗以及离散傅立叶变换获得频谱分布信息。设语音信号的离散傅里叶变换为： (9) 式中 x ( n ) 为输入的语音信号，N为傅立叶变换的点数。 (2) 求能量谱(频谱幅度的平方)。 (3) 利用三角形滤波器组(见图12)分析上述步骤获得的能量谱。 图12. Mel 频率滤波器组 定义一个有M个滤波器的滤波器组(滤波器的个数和临界带的个数相近) [ 9 ]，中心频率为 f ( m , m = 1 , 2 , ⋯ , M ) ，设计取 M = 24 。各 f ( m ) 之间的间隔随着m值减小而缩小，随着m值增大而增宽。三角滤波器的频率响应为： H m ( k ) = { 0 , k < f ( m − 1 ) 2 ( k − f ( m − 1 ) ) ( f ( m + 1 ) − f ( m − 1 ) ) ( f ( m ) − f ( m − 1 ) ) , f ( m − 1 ) ≤ k ≤ f ( m ) 2 ( f ( m + 1 ) − k ) ( f ( m + 1 ) − f ( m − 1 ) ) ( f ( m + 1 ) − f ( m ) ) , f ( m ) ≤ k ≤ f ( m + 1 ) 0 , k ≥ f ( m + 1 ) (10) 其中 ∑ m = 0 M − 1 H m ( k ) = 1 。 (4) 计算每个滤波器组输出的对数能量： (11) (5) 经离散余弦变换(DCT)得到MFCC系数： (12)  在时间序列中，若语音信号波形长度相等则语音较容易匹配(如图13，a点对应b点)。但匹配过程中，语音识别领域表现为不同人的语速不同(如图14)。因为语音信号具有随机性，传统的欧几里得测距无法有效地求出两个时间序列之间的距离，如图14实线的“a”点对应虚点线的“b”点才是正确的。论文采用DTW (Dynamic Time Warping)找到这两个波形对齐的点，并正确计算它们的距离。 图13. 动态匹配示意图(长度相等) DTW是将距离测度和时间规整计算相结合的一种非线性规整技术 [ 10 ]，它寻找一个规整函数 i m = Φ ( i n ) ，将测试矢量的时间轴n非线性地映射到参考模板的时间轴m上，并使规整函数满足： D = min Φ ( i n ) ∑ i n = 1 N d ( T ( i n ) , R ( Φ ( i n ) ) ) (13) D为最优时间规整下的两矢量距离。因DTW不断地计算两矢量的距离以寻找最优的匹配路径，故求出的是两矢量匹配时累积距离最小所对应的规整函数，从而保证了它们之间存在的最大声学相似性，并避免时长不同而可能引入的误差。 图14. 动态匹配示意图(长度不相等)"
"本文所设计的新型绿色节能LED台灯，照明控制实现了手动控制和自动感应控制。下位机通过与热释电传感器、光敏电阻传感器和蓝牙传输器等硬件相结合来达到手动调节和自动感应调节功能。上位机通过安卓平台对LED台灯进行手动控制和语音控制。该LED台灯提供更宽的调光范围和更好的线性度，具有省电、亮度高、LED驱动器转换效率高等特点。"
