"传统下垂控制一般按照额定容量分配有功功率，未考虑分布式电源的运行成本，易引起微网运行成本偏高，针对这一问题，本文基于MAS理论提出了一种分布式经济下垂控制模型，实现了微网的最优经济运行。该模型采用两层控制结构，上层是基于MAS的通信网络，下层是基于下垂控制的微网。基于此模型，根据等微增率准则，提出分布式经济优化算法对目标函数进行求解，进而优化下垂控制的参考频率，实现了分布式电源按成本经济运行。该算法只需局部通信，在迭代过程中能够不会打破系统原有的功率平衡，且能够克服容量越界问题，具有较好的鲁棒性。通过算例分析了所提算法考虑出力越界以及环境和负荷同时波动情况下的收敛情况，仿真结果验证了所提算法的有效性。 关键词 :MAS，孤岛微网，经济下垂，分布式，分层控制 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"微网是由分布式电源(distributed generations, DGs)、储能装置、负荷以及控制装置组成的独立供用电系统 [ 1 ] ，具有并网和孤岛两种运行模式 [ 2 ] 。当其孤岛运行时，通常采用基于下垂控制的多机并联运行方式承担负荷分配，按照容量比例分配功率。但是DG的类型、运行成本及效率各不相同，按照传统的根据容量分配功率的方法易导致微网的运行成本偏高。为了实现微网最优经济运行，需要考虑DG的运行成本进行功率优化分配 [ 3 ] 。 目前，针对微网的经济优化运行控制问题，已经有很多集中式方法研究 [ 4 ] [ 5 ] [ 6 ] [ 7 ] [ 8 ] ，集中式控制方法需要一个中心控制器收集全局信息，利用优化算法求得模型的最优解，并将其外送给本地控制器，从而实现系统的最优经济运行。然而，集中式算法存在单点故障的风险，可靠性差。因此，有学者提出分散下垂控制的策略，文献 [ 9 ] [ 10 ] 根据DG的运行成本和容量设计下垂曲线的斜率，降低了运行成本，但预设优先级需要事先得到其余单元的信息，因此不能满足即插即用的需求。文献 [ 11 ] 采用三级分层控制结构，将DG成本融合进三次控制，实现了发电单元的微增率相等和微网的运行成本最小化，但是低通滤波器的存在降低了动态响应速度。 为了克服集中式控制和分散式控制的不足，近年来国内外学者提出了一些基于多智能体(multi-agent system, MAS)的分布式算法 [ 12 ] [ 13 ] 。文献 [ 12 ] 选择微增率为一致性变量，提出微增率一致性算法，实现了经济调度的分布式计算，但需要一个领导节点收集全局的功率缺额信息，存在单点故障的风险。文献 [ 13 ] 提出“一致项+更新项”的分布式经济调度方法，更新项的存在确保在微增率趋于一致时，系统的总有功出力等于负荷需求，其更新项由本地信息决定。文献 [ 3 ] 提出基于边际成本的改进电压-有功下垂控制，并通过分布式二次优化控制提高了功率分配精度，实现了微网的经济运行。 本文在现有研究的基础上，提出了一种基于MAS的分布式经济下垂控制策略，实现了微网的最优经济运行。该策略采用两层控制结构，上层是基于MAS的通信网络，下层是基于下垂控制的微网。基于此模型，根据等微增率准则，提出分布式经济优化算法，优化下垂控制的参考频率，实现了微网的运行成本最小化。所提策略只需Agent之间的局部通信，克服了集中控制收集全局信息的缺点，可靠性高；此外，所提算法能够求得最优经济运行点，且能克服容量越界问题，具有一定的鲁棒性。最后，本文对所提算法的收敛性进行了严格的推导和证明，并通过5节点和14节点仿真算例，验证了算法的有效性。"
"等微增率准则是指电力系统中的各发电单元按相等的耗量微增率运行，从而使总的运行成本最小，运行最经济 [ 14 ] 。微网的分布式电源既包括柴油发电机、燃气轮机等可控发电单元，又包括风机、光伏等不可控发电单元 [ 15 ] 。DG的运行成本主要包括燃料成本和维护成本 [ 16 ] ，燃料成本一般为有功功率的二次函数，维护成本为有功功率的线性函数，虽然不同的DG有着不同的运行成本，但其成本函数均可以统一表示为关于有功功率的二次函数形式： (1) 式中， 、 和 分别为成本系数。由于风机、光伏等不可控单元为清洁能源，假设其运行成本为零。 因此，以系统可控发电单元总运行成本之和最小为目标的孤岛微网经济优化模型为： (2) 同时微网要满足有功功率平衡约束条件和发电单元容量约束条件，分别为： (3) (4) 式中，P i 、P i ,min 和P i ,max 分别为可控发电单元的有功出力、有功出力的下限值和上限值，P D 为系统的总有功负荷，n为可控发电单元数。 对(1)式关于有功功率求导数，可得可控单元i的微增率如下： (5) 式中， 为可控单元i的微增率。 根据等微增率准则，可得由(2)、(3)和(4)式组成的经济优化模型的解析解为 [ 17 ] ： (6) 式中， 为系统最优微增率。当可控单元的有功出力均在容量约束范围之内时， 表示如下 [ 17 ] ： (7)"
"根据等微增率准则，当λ趋于一致时，式(2)表示的目标函数达到最小值，系统实现最优经济运行，本文设计基于MAS的分布式优化算法来实现这一目的。本节先介绍基于MAS的微网分布式控制模型，然后基于此模型，提出分布式经济优化下垂控制策略，最后对分布式优化算法的收敛性进行证明。  本文采用的微网分布式控制模型由两层控制结构组成 [ 18 ] 。上层是基于MAS的通信网络，下层是由DG和负载组成的微网，如图1所示为5节点微网分布式控制模型。 其中，每个可控DG分配一个Agent，n为Agent数。DG和Agent之间通过通信线路(图中黑色虚线)连接，Agent收集DG的信息，经自身的智能处理单元计算出外送信息和控制指令，从而实现控制微网物理层的目的。 上层通信网络用图G表示，各个Agent即为图的节点，Agent之间的边(图中黑色实线)表示通信链路，用于与邻居Agent的信息交流；Agent的连接关系用边权邻接矩阵 表示，如果Agent i和Agent j之间有连接边，则 ，否则 ，特殊地， 。每个Agent所连接边的数量之和表示节点的度，用 表示： 。为了下文叙述方便，这里定义一个对角矩阵D，其主对角元由各个节点的度d ii 组成，具体表示如下： (8) 基于此MAS控制模型，我们可以设计相应的分布式控制策略，实现微网的最优经济运行。  分布式经济优化下垂的控制框图如图2所示。主要由两部分组成：网络控制层和本地控制层。 在网络控制层，本地Agent与邻居Agent进行信息交互，从而生成本地控制层DG的最优目标功率值和全网平均频率。然后，在本地控制层，二次控制根据网络控制层反馈的目标有功功率和平均频率，通过PI控制器调节，生成P-f下垂控制中参考频率的修正量，从而实现跟踪目标有功功率和恢复频率的作用。 (1) 网络层控制策略 根据网络控制层的通信网络图G，本文设计如下分布式经济优化控制律。 图1. 基于MAS的微网控制结构 图2. 分布经济下垂控制结构框图 (9) 式中， 是有功功率列向量， ， 分别是成本系数列向量。其中， ， ，β i 、γ i 分别是成本函数(4)中的成本系数。另外，式中系数矩阵 的元素w ij 定义如下： (10) 由式(9)可知，此控制律通过迭代方式计算出可控DG的最优有功出力，实现微网的分布式经济运行。 令 ， ，则控制律(9)可以进一步简化成如下形式： (11) 式中， 。由式(11)可知，根据MAS通信网络，Agent与Agent之间只需交换彼此的r和x信息即可更新自身状态，求得最优目标功率。 具体到每个可控DG，其有功出力迭代更新表达式如下： (12) 式中，P j (t)是节点j在t时刻的有功出力，P i (t + 1)是节点i在t + 1时刻的有功出力。上式之所以引入各个节点的度是为了保证当系统的通信网络发生变化时，算法依然具有较好的鲁棒性和自适应性。 当算法收敛时，Agent i将求得的最优功率 送给底层的二次控制，从而实现最优经济运行。 当系统重载，成本低的DG输出功率可能达到其容量，为防止DG功率越界，可以采取如下判定策略。若DG i功率越界，则将 限制为边界值，退出Agent网络，通信网络拓扑结构发生变化，同时向邻居发送功率越界信号ΔP i ， ， ， 为Agent i的邻居数。 若Agent j为Agent i的邻居，则当其检测到Agent i发送的 信号时，将自身功率变为式(13)。 (13) 然后Agent将最优功率送给底层的二次控制，实现经济运行。 (2) 本地层二次控制策略 本地控制的一次控制采用传统的P-f和Q-V下垂控制，为了使下垂控制输出目标有功功率和稳定系统频率，需要本地二次控制的调节。 对于DG i来说，其二次控制将网络控制层传来的 与DGi的输出有功功率比较经PI调节，得到有功修正量 如下： (14) 式中， 和 分别为有功频率修正中PI控制器的参数。 由于传统下垂控制的一次控制会引起频率偏差，同时，在跟踪目标有功的过程中也会引起频率偏差，因此需要对频率进行修正，使系统频率恢复到额定值，平均频率的修正量为： (15) 式中， 和 分别为平均频率修正中PI控制器的参数， 为分布式平均一致性算法求得的平均频率。 因此，下垂控制的参考频率优化为： (16) 式中， 为最大频率偏差， 为有功下垂系数。 通过参考频率的优化，下垂控制将跟踪最优出力，实现微网最优经济运行。  为了证明所提分布式经济优化控制律的收敛性，本节先通过定理1证明该控制律在进行功率重新分配时不会破坏系统原有的功率平衡，然后通过定理2证明算法能够可靠收敛，最后通过定理3证明当算法收敛时，满足等微增率准则。 已知DG i在迭代初始时刻和迭代时刻t的有功出力分别为P i (0)和P i (t)，任意时刻的微增率为λ i ，初始总有功负荷为P D (0)；Agent i在迭代初始时刻和迭代时刻t的状态值分别为x i (0)、x i (t)。 定理1当系统功率平衡时，通过分布式经济优化控制律可以实现负荷在DG之间重新分配，不会破坏系统的功率平衡，即功率优化分配前后总功率恒定不变，即 。 证明：令 ， ， ， ，则迭代公式 可化为： (17) 将元素 的值代入，上式可化为： (18) 上式两边同时求和得到： 因此，可得： 又有 ，故 。 证毕。 定理1：说明了功率在经济优化分配的过程中，系统仍能保持原有的功率平衡，DG总功率输出不变。当负荷波动时，下垂控制调节功率输出适应负荷变化，以保证系统功率平衡，然后通过分布式经济优化控制律实现功率的重新分配，系统实现最优经济运行。 定理2：当t趋于无穷时，状态值x i (t)收敛，有 ， 。 证明：对矩阵 每一列元素求和，可得： 由上述推导可知矩阵 每一列元素的和均为1，所以矩阵 是列随机矩阵， 。又因矩阵的对角元素都为正，所以 ，矩阵 为素矩阵。因此，矩阵 有如下特性 [ 14 ] ： (20) 式中， ， ，1 n ×1 为n维单位列向量。 由上述特性可得： ，即状态值x i (t)收敛。其中，μ i 是μ的第i个元素。 证毕。 定理2说明本文推导出的分布式经济优化控制律经过有限次迭代后可靠收敛。下面证明算法能够收敛时满足等微增率准则。 定理3 若式(11)收敛，设收敛时可控DG i的微增率值为 ，则当算法收敛时所有可控DG的微增率相等，等于常数k，即 。 证明：由定理2可知本文所提算法能够收敛，假设状态变量 最终收敛到 ，式(11)可化为 ，等式两边同时减去 ，则有 ，写成齐次线性方程组形式为： (21) 令 ，由于 ，因此， (22) 由式(22)可推出矩阵 的秩为： (23) 因此上述齐次线性方程组有多解，可以验证其通解为： (24) 又有 ，可得： (25) 将 ， 代入上式，即有： (26) 证毕。 定理3说明了当分布式经济优化算法收敛时，微网中所有可控DG的微增率相等，目标函数达到最小值，微网实现最优经济运行。"
"为验证所提分布式经济下垂策略的有效性，本文利用Matlab/Simulink搭建了如图3(a)和(b)所示的5节点和14节点孤岛微网仿真模型。其中，DG1~5分别表示5个可控DG，均采用下垂控制；PV和WT分别表示光伏和风机，始终运行于MPPT模式。DG的成本和容量参数 [ 17 ] 见表1。考虑到系统的稳定性和算法的收敛性，分布式控制器的采样周期设为1 ms，每隔30 ms将最优目标值送给本地二次控制一次。 本节通过两个仿真算例验证所提控制策略的有效性。4.1考虑功率越界情况对算法的收敛性进行验证； 图3. 孤岛微网仿真模型 Table 1 DG i γ i β i α i P i, min (kW) P i, max (kW) 1 0.094 1.22 51 10 80 2 0.078 3.41 31 8 60 3 0.105 2.53 78 3.8 40 4 0.082 4.02 42 5.4 45 5 0.074 3.17 62 4.2 18 表1. 系统参数 4.2验证环境和负荷同时变化对算法的影响。  为了验证所提分布式经济下垂控制的有效性，本节采用5节点仿真模型进行仿真分析，系统0~0.5 s采用传统的下垂控制，0.5 s启动分布式优化算法，1.5 s前未考虑容量越界情况，1.5~2.5 s考虑容量越界情况，仿真结果如图4所示。 由图4(a)可知，启动控制策略后，DG1~5的有功出力发生变化，成本高的少出力，成本低的多出力，并逐渐趋于稳定，1.5 s以后，考虑容量越界情况，DG5的有功出力最终稳定在容量上界值。由于微增率与有功出力是正相关的一次函数关系，因此各个DG的微增率变化规律与其有功出力相同，如图4(b)所示，最终各DG的微增率收敛到一致值，说明DG1~5的运行成本之和达到最小值。此外，由图4(c)可知，系统的总成本相比传统下垂控制下降，但是1.5 s以后总成本增加，这是因为DG5有功出力达到最大值，系统多余的有功只能在其它DG单元之间分配，因此总成本增加。由图4(d)可知，由于控制策略的切换带来一定的扰动，系统的频率始终稳定在50 Hz，符合IEEE 1547标准 [ 19 ] 对频率的要求。  由于在实际的微网中，可再生能源的出力受环境影响有很大的波动性、间歇性和不确定性，同时负荷在不同时段也有所不同，因此本节模拟实际的运行条件，分析环境和负荷同时波动情况对系统运行的影响。采用如图3(b)所示的微网14节点模型，系统初始有功负荷设为150 kW且可控DG1~5在初始时刻均已达到最优经济出力，假设DG的容量足够大。风机和光伏的有功出力波动情况如图5(a)所示，系统 图4. 收敛性仿真结果 图5. 环境和负荷同时波动仿真结果 的有功负荷在1 s时增加30%，2 s时减小20%。仿真结果如图5(b)~(f)所示。 由图5(b)可知，在1 s以前，由于风机和光伏的出力波动不大，因此DG1~5的有功出力波动也较小。1 s时，由于负荷突然增加，可控DG1~5增加其有功出力以维持系统的功率平衡，随着风机和光伏有功出力的减小，可控DG1~5的有功出力将继续增加，负荷减小和可再生能源出力增加时的情况与此类似。由图5(c)可知，DG1~5的微增率将跟随其有功出力变化，且在其它时刻始终相等，仅在负荷波动瞬间有些许冲击，说明在环境和负荷同时波动的情况下，可控DG1~5的运行成本之和能够在波动之后迅速恢复到最小值，系统继续最优经济运行。由图5(d)可知频率波动也在允许范围之内。"
"本文提出了一种基于MAS理论的分布式经济下垂控制策略，实现了微网的最优经济运行。该模型采用两层控制结构，上层是基于MAS的通信网络，下层是基于下垂控制的微网。上层控制通过本地Agent与邻居Agent的信息交互，计算生成下层控制中DG的有功出力参考值；下层控制的二次控制完成目标有功功率的跟踪控制，实现可控DG的最优有功出力，同时二次调频环节的存在稳定了微网的频率。所提算法只需局部通信，克服了集中控制收集全局信息的缺点，可靠性高；此外，该算法在迭代过程中能够保证功率的恒定性，同时考虑了功率越界的情况对算法修正，具有较好的鲁棒性。最后通过仿真分析，验证了所提算法在功率越界和不越界情况下以及负荷和环境同时波动的情况下的有效性。"
