"本文提出了一种基于分层滤波技术的图像随机值冲击噪声检测和去除算法。为了解决经典自适应中心加权中值滤波技术在较高噪声比率下漏检严重的问题，我们采取逐级设置由高到低的噪声值判决门限来层层筛选噪声，利用不同高度的门限甄别出不同信赖度的冲击噪点，同时更新已检测出的噪声点值。每一层均得到一幅中间去噪图像，并继续进行噪声点的判决，最终得到完整的噪声点空间以及终极去噪图像。通过对多幅不同噪声比率的噪声图进行图像恢复的仿真实验验证后，得出结论：本文所提算法无论在低噪声比率还是高噪声比率的情况下均能有效地检测出图像中的随机值冲击噪声，漏检和误检像素数相对较低，同时获得了较好的图像去噪效果，极大地扩展了原算法的应用范围。 关键词 :图像去噪，分层策略，中值滤波，噪声检测"
"数字图像在获取、存储、传输的过程中容易遭受噪声的污染，这一方面导致用户无法从被污染的图像中获取正确的关键信息，另一方面使诸多图像后处理算法(例如：边缘检测、目标识别、特征提取等)难以获得满意的结果。因此，如何有效地去除被污染图像中的噪声，同时又保持本真图像中的关键细节特征一直是图像处理领域的研究热点。冲击噪声作为一种常见的噪声类型倍受研究者的关注，它对图像的污染通常是由于传感器上某些不良阵元的影响所致或是受传输信道内与信号无关的噪声干扰而产生，所污染的图像中部分比例的像素点值被冲击噪声值所篡改，而其余像素点值与本真值完全一致[ 1 ] 。按照冲击噪声值的不同可将这种噪声分为两类：固定值冲击噪声和随机值冲击噪声，前者通常具有较极端的值(比如0或者255)，因此也被称为椒盐噪声，而后者的噪声值则是均匀分布在图像的灰度范围中 [ 2 ] [ 3 ] 。 最经典的去除冲击噪声的方法是中值滤波法 [ 4 ] ，不仅操作简单而且有较强的去噪能力。但是这种方法将中值滤波作用于图像中所有像素点，因此那些并没有受到污染的点就或多或少偏离了本真值，导致图像中很多细节有所失真。基于决策的改进中值滤波法 [ 5 ] - [ 7 ] 弥补了经典中值滤波的漏洞，它首先对全图做一次噪声检测，然后仅对噪声点进行处理，未检测为噪声的像素点值被保存。在基于决策的去噪算法中，噪声检测性能至关重要，过高的漏检率或误检率都会对后续图像恢复效果产生不良影响。相对于固定值冲击噪声而言，随机值冲击噪声由于某些噪声点值与邻近非噪像素值之间差异并不那么明显，因此在检测上难度较大。近些年来涌现了许多如何处理随机值冲击噪声的算法，例如基于非局部平均滤波的去噪算法 [ 8 ] [ 9 ] ，然而由于算法时间复杂度较高，在实际应用中难以被接受。在此问题上，由Tao Chen等人提出的自适应中心加权中值滤波技术 [ 6 ] (Adaptive Center Weighted Median Filter，ACWMF)在较低噪声比率的情况下可以取得很好的噪声检测效果，由于该算法使用便捷效果良好，因此被广泛应用于诸多其他的去噪算法中 [ 10 ] - [ 12 ] 。然而，当噪声污染率大于30%时，这种技术的漏检率迅速攀升，对后续去噪算法产生了负面影响。针对ACWMF的固有优点与缺点，本文提出了一种分层自适应中心加权中值滤波技术，在保留ACWMF算法优势的同时能解决其在高噪声比率下漏检严重的问题。大量实验证明，本文提出的算法无论在低噪声比率下还是较高噪声比率下均可以取得鲁棒的噪声检测和恢复效果，极大地扩展了ACWMF算法的应用范围，并且在时间复杂度上也有较强的优势。 本文的结构安排如下：第二部分重点讲解所提出的分层自适应中心加权中值滤波法是如何对冲击噪声图像进行去噪处理的，第三部分进行仿真实验验证，包括数据及图像分析，并对相关细节进行讨论，第四部分对全文进行总结。"
"假设 为一幅大小为 的理想数字图像 在像素点 上的灰度值，其中 ， 为 的空间范围。若 是一幅8位灰度图像，则图中像素点值的灰度动态范围为 。当 遭受某种噪声污染后则形成了与之不同的另一幅图像 ，图像去噪的任务则是从 出发恢复出尽可能接近 的估计图像 。在冲击噪声污染图像的情况下， 如下所示： . (1) 上式中， 代表冲击噪声点的个数占图像全空间的比率，称作噪声比率(noise ratio，nr)。随机值冲击噪声环境下， 是均匀分布在灰度动态范围 中；而固定值冲击噪声值仅取 或 。换句话说， 中有一部分像素值与本真值完全相等，另一部分则偏离了本真值，偏离度有大有小，偏离得越多的像素点越不可信。这里我们用像素的“信赖度”来刻画冲击噪声点偏离本真值的度，偏离得小则信赖度越接近于1，偏离得越大则信赖度为0。若在图像恢复之前做出噪声点位置的检测，则只需对噪声点进行去噪操作即可，也就是引言中所提到的基于决策的去噪方法。 自适应中心加权中值滤波法 [ 6 ] 是一种广泛应用于随机值冲击噪声检测和去除的经典算法，经实践表明，在噪声比率不高的情况下，它可以很好地完成噪声检测与图像恢复任务。中心加权中值滤波式子如下： , (2) 其中 表示局部邻域方形窗大小的一半(取整)， 表示将中心像素 重复 次， 表示取集合的中值。令 ，取 ，并设 。显然：当 时， 即为传统中值滤波值；当 时， ，此时 为0。Tao Chen等人设置了一簇有效的门限值 ： , (3) 当局部邻域方形窗大小为 时， ，取 。 用于缩放 的比重，通常取 。对于 ，若 ，则判断 是噪声点，并用 来估计本真值。遍历图像空间 中的每一个像素点，则得到去噪后的图像 。ACWMF算法在噪声比率不超过30%时能取得很好的噪声检测和图像恢复效果，但当噪声比率超过30%时，漏检率迅速攀升。如果在此情况下，依然使用ACWMF来进行噪声检测，则势必成为图像恢复的瓶颈所在(例如：文献[ 11 ] 的算法就在极大程度上受制于ACWMF在噪声检测上的不准确性)。为了克服这一缺陷，同时发挥ACWMF的优势，我们提出一种分层自适应中心加权中值滤波法(Hierarchical Adaptive Center Weighted Median Filter，HACWMF)，不仅可以检测出冲击噪声所在位置，还能判断冲击噪声的信赖程度，并能获得一幅较好的去噪图像。 HACWMF的核心思想是从高到低逐级设置噪声值判决门限 ( 表示最大分层)，利用不同高度的门限甄别不同信赖度的噪声点，同时用邻域内的中值替换噪声点值，逐级得到层层筛选的噪声点以及中间去噪图 。高门限 所检测出的噪声点应该具有低的信赖度，而低门限 所检测出的噪声点应该具有高的信赖度，未被检测为噪声的像素点具有绝对信赖度。令 表示 的信赖度矩阵，则 表示每个 点的信赖度， ，并初始化 。设 为当前执行的层数， 从1到 递增，令 ，第 层的门限 设置为如下形式： . (4) 进行如下判决： (5) 然后递增层级： ，并令 继续进行式(5)的判决，直至 为止。权衡HACWMF的有效性和时耗，并通过一定的实验调试，取 ， 。 确保了分层的层数不太多，使得时间消耗在合适的范围内；而 使得层与层之间的阈值具有一定的区分性。此时 ，值越接近于1表明 的信赖度越高，最终的噪声空间为 。注意：为保证在较高噪声比率的情况下有足够多的有用信息进行噪声判决，我们在局部邻域大小上做了适当的调整：当噪声比率大于30%小于50%时，邻域在3 × 3窗口的基础上再多增加四个邻近像素点；当噪声比率大于50%时，邻域在3 × 3窗口的基础上再多增加八个或十六个邻近像素点。这样能保证更加准确的噪声检测度。 我们将HACWMF算法总结于表1当中。HACWMF的优势在于当噪声比率较高时，依然可以有效检测出噪声的位置，通过逐级恢复图像最终获得鲁棒的去噪图像，我们将在实验验证中给出结果。"
"为了验证HACWMF算法的性能，我们选取了六幅典型灰度图像来进行仿真测试实验，它们分别是“Barbara”、“Lena”、“House”、“Monarch”、“Baboon”和“Fingerprint”。为模拟不同比率的冲击噪声对图像的干扰，我们将10%至60%的随机值冲击噪声点加入到测试图像中，形成了不同噪声比率的带噪图像。同时，选择了三种有代表性的、并与HACWMF相关的冲击噪声去噪算法进行横向对比，它们分别是：中值滤波器(Median Filter，MF)、ACWMF [ 6 ] 、方向加权中值滤波器(Directional Weighted Median Filter，DWMF) [ 7 ] 。算法中的参数均按照原文献中作者建议的值来进行设置。  在定量评估图像质量时，我们选用峰值信噪比PSNR (Peak Signal-to-Noise Ratio)和结构相似性指数(Structure Similarity Index Measure，SSIM)来对去噪后的图像进行质量评估。PSNR主要利用了像素点间的平均灰度差异来衡量 与 的相似度： , (6) Table 1 输入：一幅受随机值冲击噪声污染后的含噪图像 及噪声污染率nr。 输出：信赖度矩阵 、噪声空间 以及去噪图像 。 <1>初始化设置： ； ； ； ；确定局部邻域大小 ，则 ，取 ；置 。 <2>分层筛选噪声： 第一步：遍历 ， ： ，计算 ， ， 设置门限 ， ， 。 判断大小，若 ，则 ， 。 令 ，并令 ，进入第二步。 第二步：若 ，返回第一步，否则分层计算结束，输出信赖度矩阵 、噪声空间 、最终去噪图像 。 表1. 分层自适应加权中值滤波法 越是接近于本真图像 ，PSNR值越高。SSIM则从结构视觉的角度来进行衡量，主要考虑了邻域窗内结构的吻合程度，它更加符合人的视觉在评价图像质量时的习惯，更多与之相关的讲解参看文献 [ 10 ] 。采用不同的算法对不同污染度的图像做去噪运算，定量评估结果如表2~4所示，表中粗体数值表示去噪性能最好的结果。由表可以看出：在低噪声比率(10%)下，HACWMF就超过了ACWMF和DWMF这两种具有代表性的基于决策的改进中值滤波算法；在中噪声比率下(30%)，HACWMF在PSNR上超过ACWMF平均约2.5 dB，并且能与DWMF的去噪性能相媲美；在高噪声比率下(60%)，HACWMF在PSNR上超过ACWMF平均约5 dB，并且绝大多数情况也不输给DWMF算法。 为了从主观视觉上衡量HACWMF算法的性能，我们将30%和60%随机值冲击噪声比率下几种算法对“Lena”和“Monarch”图像的去噪效果图展示于图1~4中。从中可以看出：即使在噪声比率只有30%时，ACWMF所生成的去噪图像中也残留了很多冲击噪点，当噪声比率达到60%时，漏检情况十分严重，图像恢复效果极差；分层自适应加权中值滤波算法通过逐级筛选噪声并恢复图像的思路，有效地抑制了可能残留在图像中的噪声，极大地扩展了原算法的应用范围，无论冲击噪声的污染比率如何，都可以获得较好地图像恢复效果；与DWMF算法相比，HACWMF所获得的去噪图更接近于本真图像。  分层自适应加权中值滤波算法的一大优点是在较高噪声比率的情况下较好地检测出冲击噪声，在这一节中，我们通过对比几种冲击噪声检测方法的误检(本来是非噪声却被判为噪声)和漏检(本来是噪声却被判为非噪声)像素数目来验证HACWMF所具有的这一优势。表5所示为ACWMF、DWMF和HACWMF三种算法对含有40%~60%随机值冲击噪声的“Lena”图像进行噪声检测的结果。可见：在较高噪声比率的情况下(>30%)，HACWMF检测噪声的总错误数(漏检数与误检数之和)最小；原始的ACWMF算法的漏检数量非常高，是该算法的致命缺陷；DWMF在检测效果上逊色于HACWMF。这一结果充分说明了分层筛选噪声的思路是正确的，通过设置由高到低的噪声判决门限，具有不同灰度偏移量的噪声逐步被甄选出来。 Table 2 Method p = 10% Lena Barbara House Monarch Baboon Fingerprint Noisy image 19.3011 (0.3184) 18.8234 (0.4199) 19.3967 (0.3329) 18.8414 (0.4568) 19.0645 (0.5228) 18.9251 (0.6688) MF 33.8303 (0.9103) 24.9169 (0.7954) 33.0810 (0.8761) 28.8623 (0.9386) 22.8266 (0.6468) 29.0805 (0.9401) ACWMF 37.5512 (0.9732) 26.9300 (0.9186) 36.6726 (0.9681) 30.6611 (0.9699) 23.7564 (0.7258) 32.5637 (0.9779) DWMF 36.8559 (0.9588) 26.1494 (0.8925) 37.0857 (0.9566) 29.4774 (0.9528) 22.8848 (0.6804) 32.7265 (0.9778) HACWMF 38.1950 (0.9774) 26.9424 (0.9188) 37.4692 (0.9743) 31.4846 (0.9739) 23.8406 (0.7305) 33.1143 (0.9797) 表2. 10%污染图像的量化恢复结果PSNRs (MSSIMs) Table 3 Method p = 30% Lena Barbara House Monarch Baboon Fingerprint Noisy image 14.4710 (0.1156) 14.1205 (0.1910) 14.4742 (0.1253) 14.1301 (0.2275) 14.5946 (0.2657) 14.2163 (0.3655) MF 28.1232 (0.7941) 23.0284 (0.6744) 27.4977 (0.7517) 24.4974 (0.8233) 21.3585 (0.5545) 24.3551 (0.8593) ACWMF 28.0009 (0.7978) 23.5396 (0.7361) 27.5895 (0.7807) 24.5828 (0.8192) 21.5185 (0.6073) 24.7538 (0.8827) DWMF 32.5379 (0.9241) 24.0494 (0.7844) 31.8547 (0.9169) 25.9910 (0.9090) 21.2732 (0.5384) 26.8416 (0.9118) HACWMF 32.6111 (0.9283) 24.6469 (0.8298) 31.3281 (0.9043) 26.9374 (0.9168) 21.9967 (0.6340) 26.9777 (0.9220) 表3. 30%污染图像的量化恢复结果PSNRs (MSSIMs) Table 4 Method p = 60% Lena Barbara House Monarch Baboon Fingerprint Noisy image 11.4823 (0.0462) 11.0497 (0.0772) 11.4676 (0.0515) 11.0543 (0.0979) 11.6838 (0.1131) 11.1905 (0.1563) MF 18.9989 (0.3350) 17.1431 (0.2871) 18.8102 (0.3080) 17.2960 (0.3967) 17.7309 (0.2995) 17.4795 (0.5506) ACWMF 18.2813 (0.2833) 16.6429 (0.2782) 18.1018 (0.2758) 16.7550 (0.3597) 17.1458 (0.3116) 17.0594 (0.5371) DWMF 26.2927 (0.7438) 21.6882 (0.5989) 25.3499 (0.7233) 21.0555 (0.7137) 19.7285 (0.4076) 20.6056 (0.7156) HACWMF 26.4936 (0.7819) 21.8537 (0.6006) 25.7494 (0.7758) 21.0574 (0.7313) 19.8061 (0.3775) 19.9103 (0.6394) 表4. 60%污染图像的量化恢复结果PSNRs (MSSIMs) Table 5 method 40% 50% 60% Undetected False-hit Total error Undetected False-hit Total error Undetected False-hit Total error ACWMF 25,802 2076 27,878 39,450 3745 43,195 55,796 5720 61,516 DWMF 17,702 3897 21,599 18,484 6162 24,646 18,969 9849 28,818 HACWMF 10,870 5339 16,209 12,083 8638 20,721 16,358 9153 25,511 表5. 三种算法对不同噪声比率的“Lena”图进行随机值冲击噪声检测的性能比较 图1. 几种算法对30%的噪声Lena图进行恢复的结果，(a)~(e)分别为：含30%随机值冲击噪声的Lena图、中值滤波器对(a)的去噪结果图、ACWMF算法对(a)的去噪结果图、DWMF算法对(a)的去噪结果图、HACWMF算法对(a)的去噪结果图、理想Lena图 图2. 几种算法对60%的噪声Lena图进行恢复的结果，(a)~(e)分别为：含60%随机值冲击噪声的Lena图、中值滤波器对(a)的去噪结果图、ACWMF算法对(a)的去噪结果图、DWMF算法对(a)的去噪结果图、HACWMF算法对(a)的去噪结果图、理想Lena图 图3. 几种算法对30%的噪声Monarch图进行恢复的结果，(a)~(e)分别为：含30%随机值冲击噪声的Monarch图、中值滤波器对(a)的去噪结果图、ACWMF算法对(a)的去噪结果图、DWMF算法对(a)的去噪结果图、HACWMF算法对(a)的去噪结果图、理想Monarch图 图4. 几种算法对60%的噪声Monarch图进行恢复的结果，(a)~(e)分别为：含30%随机值冲击噪声的Monarch图、中值滤波器对(a)的去噪结果图、ACWMF算法对(a)的去噪结果图、DWMF算法对(a)的去噪结果图、HACWMF算法对(a)的去噪结果图、理想Monarch图"
"本文描述了一种基于分层自适应中心加权中值滤波技术的随机值冲击噪声去除算法。经典的“自适应中心加权中值滤波技术”在高噪声比率的情况下存在噪声漏检严重，图像去噪能力有限的问题，针对这一缺陷，我们通过从高到低逐级设置噪声值判决门限来分层次甄别噪声点，同时更新已检测出的噪声点值，生成中间去噪图像后继续进行噪声判决和筛选，逐级得到所有噪声点以及最终的去噪图。通过大量实验数据验证：分层自适应中心加权中值滤波技术无论在低噪声比率还是高噪声比率的情况下均能有效地检测出图像中的随机值冲击噪声，同时获得很好的图像去噪效果，不仅充分利用了原算法在低噪声比率下噪声检测和图像去噪上的优势，还扩展了原算法的适用范围。随着近些年来稀疏表示理论、深度学习理论在图像处理上的广泛应用，已有大量文献报道用这些前沿技术来解决图像去噪等传统问题，如何解决前沿理论算法复杂度较高与图像去噪高时效的矛盾是我们在后续科研中重点解决的问题。"
