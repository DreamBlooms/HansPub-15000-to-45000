"理想的单光子源和高性能的单光子探测器是制约量子密钥分配系统中的密钥安全和码率的两个关键因素。弱相干脉冲作为单光子源，为保证安全性，平均光子数必须少而限制了码率的提高。本文介绍了超导边沿传感器单光子探测器，提出了多端口分束器与多APD结合可用于量子密钥分配系统中检测弱相干脉冲中的光子数。对窃听者的攻击策略进行分析的基础上，基于光子数的检测，指出在保证安全性的前提条件下可以提高弱相干脉冲中的平均光子数，进而提高系统的量子密钥成码率。 关键词 :量子密钥分配，单光子探测器，密钥安全性，密钥码率 Copyright © 2017 by author and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"量子密钥分配(QKD)是量子信息技术中最接近实用化的技术。与传统密钥的产生与分配不同，当今量子密钥的产生与分配是在专用的自由空间或是光纤信道中，基于量子力学的测不准原理、测量坍缩原理及量子不可克隆原理，按照一定的协议规范去操作携带量子信息的单光子，使发送方(Alice)与接收方(Bob)同时获得加密密钥与解密密钥，并可杜绝传统密钥在传送过程中失密的可能。原则上来说，如何安全、高效、方便地去实现量子密钥分配取决于协议规范。现存的协议规范基本的还是BB84协议、B92协议和EKert协议三种。出于对具体的实验条件和安全性增强的考虑，发展出了很多新的协议 [ 1 ] - [ 9 ] 。当今量子密钥分配实验系统中 [ 10 ] [ 11 ] [ 12 ] [ 13 ] ，影响量子密钥安全和码率的关键因素有两个：一是尚未开发出理想的单光子源。虽然量子点单光子源的研究展示着很好的前景，但远未到实用化阶段，目前多是利用相干光源衰减到单光子水平，由于相干光源的光子数分布规律的限制，总会产生很多空脉冲和多光子脉冲，这就限制了码率，并为窃听者攻击留下了可能；二是实用化的单光子探测器(SPD)的探测速率与效率与期望值相差甚远，因而进一步地限制密钥的成码率。多光子脉冲的存在为窃听者(Eve)进行信息窃取提供了可能。但窃听者的存在，必将扰动光子数的分布。本文立足于现有的单光子探测器基于对光子数的检测，提出了一种检测窃听者对量子信道进行攻击的方法。"
"目前，可对光子数进行探测的主要方法有两类：一类是基于现有的单光子探测器，将脉冲中的光子数进行分解，通过多端口探测器来探测光子数；另一类方法是采用某些超导薄膜在正常态与超导态温度转变边沿陡峭的电阻与温度变化关系做成超导转变边沿传感器(TES)来实现单光子探测。由于超导薄膜吸收不同数量的光子引起超导薄膜系统的温度变化不同，进而引起电阻变化的大小不同，最终引起偏置电路的电流变化不同而实现光子数的可分辨。 图1展示的是用钛(Ti)做成超导薄膜的TES单光子探测器的光学照片，其中存在有两种不同尺寸的4个TES单光子探测器 [ 14 ] 。其制作的工艺流程是首先在覆盖有一定厚度氮化硅(SiN)的硅(Si)衬底上，通过电子束蒸发或磁控溅射的方式生长一层几十纳米厚的单层或双层超导薄膜，一般单元素超导薄膜除了钛(Ti)薄膜之外还有有钨(W)薄膜、铪(Hf)薄膜等，这几种超导薄膜的超导转变温度Tc分别在100、390和128 mK附近。也可以制作出Ti/Au或Ti/Pd等复合双层薄膜，这时可以利用近邻效应，通过改变Au或Pd等正常金属层的厚度来改变Tc值 [ 15 ] 。为了提高Au或Pd与SiN/Si衬底之间的黏合性，在生长Au 图1. Ti TES单光子探测器光学照片 [ 14 ] 或Pd正常金属层之前，一般先沉积一层厚度为10~15 nm的Ti薄膜，再在其上生长正常的Au或Pd薄膜，最后生长出厚度约几十纳米的超导Ti薄膜层。为了使不同金属薄膜层之间保持干净良好的界面，制备Ti/Au或Ti/Pd双层薄膜的三次薄膜生长过程必须确保在同一真空环境中完成。待薄膜生长完毕之后，做一次光刻，针对不同薄膜层，通过专门的刻蚀方法完成整个薄膜的图形化，形成具有特定尺寸的TES。制备TES所需的超导引线和和芯片周围的焊盘一般采用超导铌(Nb)或铝(Al)材料，二者的Tc值分别为9.5和1.1 K，因而在探测器几百mK的工作温度下是完全超导的。制作工艺上，引线和焊盘通常为同一层，一般采用溅射方法生长，厚度在100~150 nm之间，最后使用剥离技术完成图形化。每个TES由两根超导Nb引线实现电连接，其中叉指结构的作用是方便光学对准。 TES探测器的灵敏度取决于超导薄膜的热容Ce。为了达到单光子能量探测水平并具备光子数分辨能力，TES超导薄膜的热容Ce须尽可能小，薄膜超导转变区域内R-T曲线变化应尽可能陡(超导转变温度变化宽度ΔTc尽可能小)，而且探测器的热噪声和读出电子学系统噪声水平要尽可能低。因此，超导TES单光子探测器中TES的尺寸不能太大，通常在20 μm × 20 μm左右，ΔTc在1.0 mK量级，Tc值也即探测器的工作温度一般在几百mK温度范围内。 图2为超导TES探测器的工作原理图。当有n个能量为E 0 的光子同时被超导薄膜吸收时，产生的总能量E ph = nE 0 会引起TES的电子系统温度Te出现微小的变化量ΔT = E ph /Ce，进而引起TES的电阻产生ΔR的变化量，图2(a)给出的是1个(1 ph)和2个光子(2 ph)被吸收后TES阻值变化示意图。TES采用的是恒压偏置，如图2(b)所示，ΔR的变化量引起TES所在支路的电流变化量ΔI被与TES串联的高灵敏超导量子干涉放大器(SQUID)读出。不同数目光子被吸收时，被探测到的响应信号ΔI也不相同。图2(c)显示的是对应吸收1和2个光子后ΔI的响应曲线。在一定的能量范围内，ΔI的幅度值与被吸收的光子数目成正比，这样就实现了具有光子数分辨能力的探测。 超导TES单光子探测器的典型测试系统如图3所示 [ 17 ] ，其中包括TES的偏置和读出电路，以及光脉冲产生和耦合系统。探测器芯片通常被固定在制冷机的mK温区上，使芯片的衬底温度等于mK温区的温度。R b 是处于低温下与TES支路并联的电阻，阻值通常在mΩ量级，远小于TES在工作点处的阻值R TES 。TES工作时所需要的电压偏置由室温电流源提供的偏置电流I b 流过R b 来实现，此时TES两端的电压约为V b = I b ∙R b 。流过TES的电流是通过一个输入线圈L in 与其串联、工作在磁通锁定环路(flux-locked loop, FLL)的SQUID来读出的。单个光子引起的TES阻值变化量ΔR是非常小的，为了准确 图2. 超导TES单光子探测器工作原理图 [ 16 ] 。(a) 吸收1个和2个光子后的TES阻值变化示意图；(b) 电压偏置测量TES支路电流；(c) 吸收1个和2个光子后TES支路的响应电流脉冲 图3. 超导TES单光子探测器的典型测试系统 [ 17 ] 探测到因电阻变化引起的电流变化量ΔI，采用铌钛(NbTi)合金超导线来实现电阻R b 、SQUID输入线圈L in 以及TES构成的整个环路的电连接。通过单模光纤将光脉冲从室温的发生系统导入至mK温区下的探测器，光纤末端与探测器的距离一般保持在100 μm左右。 世界上有很多研究小组研发出了TES单光子探测器 [ 14 ] [ 18 ] 。进一步通过集成光学谐振腔并提高光纤与探测器之间的光耦合效率的办法，目前的超导TES单光子探测器的系统探测效率在多个波长下已接近100%。对1550 nm的光纤量子通信波段，光子的能量分辨已达到0.2 eV以下，并表现出多至29个光子态的分辨能力。相较于APD单光子探测器，超导TES单光子探测器的突出优点在于极低的暗计数率(典型值在几个赫兹以下)、很高的探测效率、可分辨光子数及可实现光子能量的分辨。但其响应速度以及时间抖动等特性仍存在不足，目前最快的超导TES单光子探测器的响应时间在300 ns左右，最小的时间抖动在20 ns左右。TES单光子探测器使用的最大问题则是在于必须在极低温下工作，制冷系统体积庞大，使用成本高昂，因此很难用于实用的量子密钥分配系统中。 在实用的光纤通信1310 nm与1550 nm波段，为了有效地进行单光子探测，普遍采用的是带隙渐变的吸收区与倍增区分离结构的雪崩二极管(SAGM-APD)，其结构如图4所示 [ 19 ] [ 20 ] 。综合考虑带隙结构、暗噪声大小、工作温度和晶体缺陷等因素，通常选用III-V族化合物半导体(InGaAs)作为吸收区材料。重 图4. InGaAs/InP材料的SAGM型APD的截面图和能带图 掺杂的n + -InP作为衬底和缓冲层，由于其具有宽的带隙(EG = 1.35 eV)，因而波长大于900 nm的红外波段的光可以接近透明通过。非掺杂的I-InGaAs作为吸收层，其带隙约为0.73 eV，对波长小于1700 nm的红外波段的光具有很好的吸收特性，可在此充分吸收。本征I-InP层作为倍增层，可在其中建立很高的电场，雪崩倍增过程就发生在其中。n-InP作为电场控制层，当反向偏压很大时，倍增区可扩展到其中，与拉通型APD的π区的作用相似，起到控制倍增区电场的作用。由于InGaAs和InP带隙相差很大，能带在此发生突变，因而光生空穴容易在它们的界面发生陷落，出现电荷的堆积，影响器件的量子效率和响应速度。为了解决此问题，往往在n-InP和i-InGaAs层之间加上两层掺杂浓度不同，厚度约为1~2 μm的InGaAsP材料。 作为单光子探测器的核心部分——雪崩二极管(APD)必须以“盖革”模式工作 [ 19 ] [ 20 ] [ 21 ] ，这是通过性能优越的抑制电路来实现的。最早应用的是无源抑制电路，以后又出现了主动抑制电路和门模电路以及它们之间的组合。在量子密钥分配系统中，携带量子信息的光子到达的时间一般是准确知道的，因此普遍采用的是门模抑制电路。图5即为工作于门控“盖革”模式的单光子探测器示意图，其右上图表示的是加在APD上的反向电压时序图。其工作的门控时间通常为1~100 ns，而为了抑制后脉冲，其不工作的死时间通常为1~10 μs。 很显然，工作于“盖革”模式的APD型单光子探测器是不足以直接检测到达接收端的某一脉冲所包含的光子数的。1999年Kim等人提出了基于光学参量下转换产生的双光子光程的不同，因而在高灵敏度、响应区域大的可见光光子计数仪中产生的响应脉冲幅值与脉宽的不同来区分单光子与双光子。但这种方法只可以用于双光子检测，且暗计数率比较高 [ 22 ] [ 23 ] [ 24 ] 。山西大学何博等人研究了单光子探测器对微弱激光脉冲的暂态响应，利用不同光子数的响应时间不同的特性去实现光子数的分辨测量 [ 25 ] 。技术上也可将包含多个光子的弱光脉冲经Ｎ通道分流变为时间独立的Ｎ个单光子脉冲，耦合进入Ｎ个探测器，实现一定程度上的光子数区分 [ 26 ] [ 27 ] [ 28 ] [ 29 ] 。 作者在文献 [ 29 ] 中从解决QKD系统码率过低的角度出发，提出了充分利用“单APD”探测器处于沉寂状态的时隙窗口的方案。为此设计了多端口分束器与多APD结合构成各端口时分工作模式的探测器来代替QKD系统中的每一单光子探测器，如图6所示。它通过一对称的N端口光纤分束器(耦合器)与光纤 图5. 工作于门控“盖革”模式的单光子探测器 图6. 多端口分束器与多APD结合构成的各端口时分工作模式的快速单光子探测器 [ 29 ] 链路相连接。每一端口配置一反向偏置的雪崩二极管(APD)。各端口的APD均采用门控“盖革”模式工作，其偏置电压由一偏置电压产生器集中提供，其门控信号也由一门控信号发生器集中提供，这样可降低电路的复杂性，减少成本，并有利于提高工作的可靠性。偏置电压产生器与门控信号发生器可由从单光子源提取的时钟信号进行同步控制。从各端口输出的雪崩信号首先经幅度鉴别，然后输入到逻辑判决单元，与时钟信号进行符合，判别是否为暗计数与后脉冲引起的误计数，还可判别是否为多光子脉冲，并将这类特别事件输出显示出来。 为了使图6中的快速单光子探测器达到最大效能，端口数N的选择应该满足以下条件 (1) 其中μ表示每脉冲的平均光子数，Int表示取t dead /t on 的较大整数，t dead 与t on 分别表示单APD探测器的死时间与工作窗口的时间宽度。 从其工作过程看，这种探测器中的多端口分束器的端口数如果足够多的话，则可同时检测到达端口的弱相干脉冲中所包含的光子数。 现在有些研究组正在利用光电子集成开发单光子探测阵列 [ 30 ] 。如果单光子探测阵列实现了实用化，则成本可极大降低。通过多端口分束器，可实现脉冲中的光子数检测。端口数越多，检测的准确度越高。当然辅以光开关或时分复用解复用器来控制路由，则可极大提高QKD系统的工作频率，提高量子密钥的成码率。"
"从量子密钥分配系统来说，只要将相干光源衰减到单光子水平，通过误码率检测和密钥增强的方法，原则上是可以得到安全密钥的。但是对光子数的检测，不仅是个科学问题，对于量子密钥分配系统来说，如果准确知道单脉冲中所包含的光子数，也有助于改进系统的安全性。 当今QKD系统中采用的光源一般是激光脉冲经衰减而成。含有极少平均光子数的相干态(单光子Fock态)中的光子数遵循泊松分布(Poisson Distribution)，其统计规律为 (2) 其中μ为平均光子数， 为脉冲中包含n个光子的概率。图7即为不同平均光子数情况下的光子数泊松分布。 图7. 不同平均光子数情况下的光子数泊松分布 从图7可看出，如果平均光子数μ过大，则一个脉冲包含多光子数的概率也较高。窃听者(Eve)原则上可采用光子数分离器(PNS)攻击而摄取其中的光子进行测量，以获得密钥信息。从安全的角度考虑，目前的QKD系统中通常是将激光脉冲衰减到μ = 0.1的水平，但这时绝大部分脉冲不包含光子，即为空脉冲，因而QKD系统的码率大为受限。QKD系统中的Alice与Bob方不能肯定在密钥的产生与分配中是否有Eve的存在，为了确保密钥的安全，总是要牺牲所获得的一部分量子比特通过一定的算法进行信息调和与密钥增强，最后得到的密钥码率进一步降低。 在进行量子密钥分配时，如果能够实时检测到Eve的存在，则总是会采取具体行动，去捕获窃听者。但若能通过检测，确切排除Eve的存在，则只要进行纠错而没有必要再进行密钥增强，甚至可以提高脉冲的平均光子数，使密钥码率得到有效提高。 图6所示的快速单光子探测器除了能够提高QKD系统单光子的探测速率外，还能够实时检测是否存在窃听者(Eve)。图3所示的超导TES单光子探测器更是能准确检测到弱相干脉冲中所包含的光子数。在Eve发起PNS攻击时，必定要截取Alice发送给Bob的光子进行测量，因而脉冲所包含的光子数的泊松分布将可能受到干扰。其检测的原理是同时记录图6中的探测器对每一脉冲的响应端口数，以确定该脉冲包含的光子数，然后对脉冲包含的光子数进行统计分析，根据光子数的平均值及统计分布以确定是否受到窃听者的干扰。 窃听者通常要根据脉冲的平均光子数选用截取光子的技术方案。当脉冲的平均光子数较多时，比如μ > 2，这时他可以选用PNS攻击。这种攻击的物理效果对光子数的泊松分布并无改变，只是相当于在量子信道中引入一个固定的损耗。依靠纠错和密钥增强无法探知Eve的攻击，且不能杜绝密钥的泄漏，但可以通过检测Bob端的平均光子数来确定Eve是否存在。通常Alice到Bob之间的光纤长度及光纤单位距离的损耗是一定的，因而量子信道总的损耗也是一定的。若Alice发送的脉冲包含的平均光子数保持不变，Bob端在考虑信道损耗后，依据检测脉冲的平均光子数是否符合期望值就可以确定是否有Eve的存在。另外，Bob还可以对不同时段的光子数分布求平均，依据光子数平均值的变化确定是否有Eve的加入和退出。 当脉冲的平均光子数很少时，比如μ = 0.1，Eve可能采用“截收–发送”的光子截取方案。在这种情况下，量子信道中Alice发送给Bob的光子可能被Eve全部截收，Eve进行量子测量后再发送给Bob。这时光子数的泊松分布不会改变，依靠光子数检测，不能确定Eve的存在。Bob只能依据光子量子态的测量坍缩引起系统误码率的显著升高来确定Eve的存在。Bob依靠纠错和密钥增强过滤掉可能泄密的量子比特，这是QKD系统的常规方法。 当脉冲的平均光子数介于以上两者之间，比如μ = 1，Eve将最可能选用“光子计数–单光子摄取”的光子截取方案。即他有选择的摄取多光子脉冲中的其中一个光子进行测量，以获取关于密钥的信息，而对单光子脉冲中的光子则让其无干扰地通过。这种情况依靠纠错和密钥增强是无法确定Eve的存在的，也不能杜绝密钥的泄漏，但将改变光子数的泊松分布。 现在分析Eve采用“光子计数–单光子摄取”的光子截取方案时光子数分布的变化。假设无Eve干扰，这时光子数遵循泊松分布为 ，其中μ为平均光子数，光子数的分布情况如图7所示。考虑Eve对量子信道中的光脉冲进行光子截取，光子数的分布将变为 ，这时满足下列关系： (3) (4) (5) (6) (7) 图8所显示的是依据(3)~(7)式得出的Eve截取多光子脉冲中的一个光子后的光子数分布。从图8可看出，Eve截取光子后，明显地改变了光子数的分布情况，其中含有一个光子的脉冲显著增多。这种变化还与Alice发送脉冲的平均光子数有关，当μ = 1时表现尤为显著。 从上可看出，光子数检测是对所有脉冲包含的光子数进行实时检测与监控，是一种统计检测。结果的准确度将受到图6所示的快速单光子探测器的光子端口路由的影响。如果一个脉冲的多个光子进入同一个端口，则只引起一个端口探测器的响应，光子的计数只为1，使检测结果偏离图7和图8的分布。由此引起的光子数分布不确定度以U 1 表示，其大小应该反比于端口数N，即 (8) 上式中的k为一常数，可由实验测定。 每一端口的雪崩二极管(APD)的暗计数也会影响光子数检测结果的准确度。由暗计数引起的光子数检测的不确定度以U 2 表示，假设每一门脉冲时间τ内的暗计数率为P dark ，则U 2 为 (9) 光子数检测结果的总不确定度U为 (10) 图8. Eve截取多光子脉冲中的一个光子后的光子数分布 由(10)可以看出，要提高光子数检测结果的准确度，必须选取合适的端口数N，尽力减小暗计数率为P dark ，并限制门脉冲的宽度τ。 综上所述，通过图6所示的快速单光子探测器来检测光子数的分布，在(10)所容许的范围内分析其是否偏离泊松分布，可以检测是否存在Eve的“光子计数–单光子摄取”攻击；通过分析光子数平均值的变化，可以检测是否存在Eve的光子数分离器(PNS)攻击。如果检测出没有Eve的存在，原则上可以提高发送脉冲的平均光子数μ在1~2的水平，以减少空脉冲的数量，将量子密钥分配的码率提高一个数量级；还可以在纠错的基础上，不用再进行密钥增强，以充分利用成功获得的量子比特，进一步提高密钥分配的码率。 如果采用图2所示的超导TES单光子探测器来检测脉冲中的光子数，由于其很低的暗计数率，因此检测准确度相较于(10)式将大为提高。当然这时QKD系统的工作频率将受到TES探测器响应时间的限制。"
"超导TES单光子探测器由于具有极低的暗计数率、很高的探测效率、可分辨光子数及可实现光子能量的分辨，因此可对脉冲中所包含的光子数进行准确检测。用于光纤通信波段的量子密钥分配系统中的以InGaAs/InP为材料的SAGM型APD为核心的单光子探测器尚难以直接进行光子数检测。多APD与多端口分束器相结合，可以对弱相干光脉冲中的光子数进行统计检测，由此确定QKD系统中是否存在窃听者攻击。基于光子数检测，在保证安全性的前提条件下，可将发送的光脉冲中的平均光子数提高一个量级，使QKD系统的码率得以提高。"
