"电力用煤由于受到产地、运输和价格等多种因素影响，种类变化繁多，煤质发热量有很大的变化。这对锅炉的安全经济运行有很大的影响。为了及时了解机组的运行状况，本文应用反向建模思想，结合遗传算法优化的BP神经网络，模拟出锅炉运行过程中易测量的参数值和煤质发热量的关系，构建了煤质发热量在线测量模型。用电厂运行数据进行模型验证，精度满足工程要求，切实可行。 关键词 :煤质发热量，反向建模，神经网络，平均影响值法，在线监测"
"目前我国电厂多数使用的还是燃煤机组，因而煤对于电厂来说不可或缺。就燃煤而言，即使种类相同，如果开采地区、开采时间和开采深度具体条件不同，其化学成分也会有很大的差异 [ 1 ] 。近年来，全国用电量不断上升，同时煤价不停上涨；再加上我国地域复杂，煤炭资源分布不均，道路交通不便，使得电厂每日购进的燃煤种类变化繁多。为此，许多电厂锅炉会选择燃用混煤。通过主动配煤，可以在一定程度上改善入炉煤质发热量和做功能力的稳定性 [ 2 ] 。 发热量、挥发份、固定碳和灰熔点等煤质特性的变化，会对机组运行的经济性和安全性造成严重影响。在众多煤质特性中，煤质发热量是最为基本和重要的参数 [ 3 ] [ 4 ] 。 及时、准确的掌握煤质发热量，根据实际入炉煤质对锅炉运行参数进行调整，对于机组的运行优化工作有着深远的意义 [ 5 ] 。"
"反向建模方法就是利用实际火电机组热力系统的大量运行数据，用神经网络、支持向量机、遗传算法、灰色系统理论、模糊理论以及混合建模、组合建模等智能算法来建立系统相关参数间数学模型的过程 [ 5 ] 。 反向建模的方法与常规建模方法相比，效率高、精度大，更具有实用性 [ 6 ] 。 通常情况下，反向建模方法的具体应用过程可分为数据整理、模型建立及模型检验三个阶段 [ 7 ] 。 数据整理阶段分为数据的采集和数据的处理。样本数据的好坏直接决定了建模的精度，甚至决定了模型是否能够建立成功。目前，国内的绝大部分火力发电机组都安装了DCS系统，记录了机组大量实际运行数据，为模型建立提供了数据基础。由于电厂热力系统十分复杂，建立模型时，输出变量受诸多因素的影响，并且各因素之间相互关联、相互影响。因此，只有选择合适的输入变量，才能得到理想的模型，保证建模效率和建模精度。 模型检验是验证模型正确性和精度的过程。若不能满足预定要求，则需重复上述过程，重新处理和集成数据，直至所建模型符合验证要求为止。"
"BP神经网络作为一种机器学习方法，内嵌了很多数学思想和学习准则，基本思想是将输入数据经过多次迭代运算得到输出值。BP神经网络由输入层、隐含层和输出层三层组成。如果把输入值作为自变量，输出值作为因变量，那么我们可以把BP神经网络当成一个非线性函数 [ 8 ] 。 BP神经网络算法流程有三步：BP神经网络构建、BP神经网络训练和BP神经网络预测，如图1所示。 图1. 算法流程 BP神经网络训练是用输入输出数据训练神经网络，通过训练使网络具有联想记忆和预测能力，从而训练后的网络能够预测模型输出。BP神经网络的训练过程包括以下几个步骤。 步骤1：网络初始化。根据系统输入输出序列(X, Y)确定网络输入层节点数n、隐含层节点数l，输出层节点数m，初始化输入层、隐含层和输出层神经元之间的连接权值w ij ，w jk ，初始化隐含层阈值a，输出层阈值b，给定学习速率和神经元激励函数。 步骤2：隐含层输出计算。根据输入向量X，输入层和隐含层间连接权值w ij 以及隐含层阈值a，计算隐含层输出H。 (5) 式中，l为隐含层节点数；f为隐含层激励函数，该函数有多种表达形式，本文所选函数为： (6) 步骤3：输出层输出计算。根据隐含层输出H，连接权值w jk 和阈值b，计算BP神经网络预测输出O。 (7) 步骤4：误差计算。根据网络预测输出O和期望输出Y，计算网络预测误差e。 (8) 步骤5：权值更新。根据网络预测误差e更新网络连接权值w ij ，w jk 。 (9) (10) 式中， 为学习速率。 步骤6：阈值更新。根据网络预测误差e更新网络节点阈值a，b。 (11) (12) 步骤7：判断算法迭代是否结束，若没有结束，返回步骤2。 煤质发热量在线监测系统状态方程复杂，难以用数学方法准确建模，可以建立BP神经网络表达该非线性系统，把未知系统看成是一个黑箱，首先用系统输入输出数据训练BP神经网络，使网络能够表达该未知函数，然后就可以用训练好的BP神经网络预测系统输出。"
"遗传算法(Genetic Algorithm, GA)是模拟生物遗传和进化机制的一种并行随机搜索最优化的方法，1967年由美国Michigan大学的Holland教授及其学生首次提出 [ 9 ] 。它把自然界“优胜劣汰，适者生存”的生物进化原理引入优化参数组成的编码串联群体中，按照所选择的的适应度函数通过选择、交叉和变异对个体进行筛选，使适应度好的个体被保留，适应度差的被淘汰，最终收敛到最适合环境的个体，从而求得问题的近似最优解 [ 10 ] 。选择操作是指以一定的概率选择个体组成新群体，从而得以保留；交叉是指从种群中选择两个个体，以一定的概率交叉得到新的更好的个体；变异则是指从种群中随机选择一个个体，按一定的概率变异得到新个体，防止局部最好 [ 11 ] 。所以遗传算法作为一种全局优化搜索方法，只要有适当大的初始群体和足够的进化次数就能得到满意的结果，具有简单、并行处理，不需要目标函数明确的数学方程和导数表达式，不易于陷入局部最优解等优点。用遗传算法对神经网络的权值阈值进行优化，提高模型精度。"
"煤质的发热量是指单位质量的煤，在完全燃烧时所放出的全部热量。在实际的应用中，煤质发热量有高位发热量与低位发热量之分，我国在锅炉的计算中，通常采用煤质的低位发热量值。 从能量平衡的观点来看，在稳定工况下，输入锅炉的热量应等于输出锅炉的热量。输出锅炉的热量包括被有效利用的热量和损失的热量 [ 12 ] 。根据能量平衡原理得 (1) (2) (3) 式中，Q r ——输入锅炉的热量； Q 1 ——锅炉的有效利用热； Q 2 ——排烟热损失； Q 3 ——可燃气体未完全燃烧热损失； Q 4 ——固体未完全燃烧热损失； Q 5 ——散热损失； Q 6 ——灰渣物理热损失。 又输入锅炉的热量 (4) 式中， ——燃料的收到基低位发热量； ——燃料物理显热； ——外来热源加热空气时所带入的热量； ——雾化燃油所用蒸汽带入的热量。 可见输入锅炉的热量主要来自燃料的收到基低位发热量。 综上可得，煤质发热量主要与Q 1 ~Q 6 有关。因此，可以通过分析Q 1 ~Q 6 的影响因素来获取相关输入变量。 通过理论分析，再结合电厂DCS系统可读取的实时运行数据测点，初步选取如下34个输入特征变量：锅炉负荷、主汽压力、主汽流量、主汽温度、给水流量、给水压力、再热蒸汽温度、再热器入口压力、再热器出口压力、总煤量、背压、总风量、环境温度、省煤器给水温度、过热器减温水压力、过热器减温水温度、再热器减温水压力、再热器减温水温度、空预器入口氧量、空预器出口氧量、排烟温度、炉膛负压、送风机出口压力、一次风机出口压力、引风机入口压力、引风机出口压力、磨煤机给煤机出力、磨煤机一次风流量、磨煤机电流、磨煤机出口一次风温度、磨煤机入口热风温度、磨煤机入口一次风压力、磨煤机出口一次风压力和汽包压力。"
"根据遗传算法和BP神经网络理论，在MATLAB软件中编程实现基于遗传算法优化的BP神经网络煤质发热量在线监测。由上一节分析后确定有34个输入参数，1个输出参数，所以BP神经网络结构为34-12-1，即输入层有34个节点，隐含层有12个节点，输出层有1个节点。迭代次数为100，学习速率为0.01，训练目标误差0.001。即要求在迭代次数100次内，达到误差小于0.001，然后停止训练。遗传算法参数设置为：种群规模为10，进化次数为50次，交叉概率为0.4，变异概率为0.2。 从山西王曲电厂DCS系统中得到250组数据样本，从中随机选择210组作为训练数据，用于网络训练，剩余的40组数据作为测试数据，用于测试网络的拟合效果。  由于初步挑选的输入变量较多，且众多变量间有一定的相关性和信息的重叠性，所以需要通过预处理来剔除冗余变量。结合GA-BP神经网络应用平均影响值方法(MIV, Mean Impact Value)来筛选变量，找到对结果有较大影响的输入项 [ 8 ] 。 将初步挑选得到的含有34个输入变量的样本用MIV法进行筛选，得到结果如图2。 经过筛选，将对煤质发热量影响程度较小的变量剔除后，最终把主汽温度、再热蒸汽温度、省煤器给水温度、过热器减温水温度、再热器减温水温度、一次风机出口压力、引风机出口压力等7个变量作为输入特征变量。  应用筛选后的数据构建神经网络时，输入变量变为7，GA-BP神经网络结构为7-5-1，即输入层有7个节点，隐含层有5个节点，输出层有1个节点。构建好后，重新对神经网络进行训练。 用训练好的GA-BP神经网络预测煤质发热量，并通过GA-BP神经网络预测输出和实际数值进行比较，分析GA-BP神经网络的拟合能力。预测结果如图： 由图3和图4可以看出，GA-BP神经网络获得的煤质发热量预测值和真实值的吻合度很高，误差控制在±2.5%之间，满足工程精度要求。这表明，该神经网络具有良好的泛化能力，煤质发热量在线监测模型切实可行。 图2. 输入变量对煤质发热量的影响 图3. 煤质发热量预测输出"
"本文通过机理分析并结合电厂DCS系统中实际可读的在线监测点参数，确定出建立煤质发热量在线监测模型所需的输入特征变量。结合遗传算法优化的BP神经网络，用MATLAB进行编程，对构建的模型进行训练，达到了预期精度。为使模型更加精简，对所确定的众多输入特征变量进行处理：运用平均影响值方法对变量数据进行冗余特征变量的剔除。利用训练好的GA-BP神经网络，对处理后的数据进行 图4. BP网络预测误差 预测输出。输出值与实际值的误差控制在±2.5%之间，满足工程精度要求。表明建立的煤质发热量在线监测模型准确有效，切实可行。"
