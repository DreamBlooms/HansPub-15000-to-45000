"设计与实现了一个人体健康智能监测系统，该系统包括数据采集模块、单片机主控模块、显示模块、传输模块和监测终端。利用STM32单片机驱动ADS1292心电传感器、LMT70温度传感器以及MPU-6050运动处理传感器测量人体健康数据，并通过ESP8266Wi-Fi芯片将采集数据发送到OneNet服务器，采用HTTP协议实现PC端和移动终端对数据采集设备的管理及查看健康信息的功能。经系统测试发现，心率、体温和运动步数的平均测量误差分别为0、±0.09℃和±0.6米，整个系统可实时的将数据显示在本地TFT液晶屏、手机APP和PC端。系统可靠性高，能够满足个体家庭和管理机构对特殊群体健康监测的需求，为物联网系统开发与应用提供参考。"
"随着人民生活质量的提高和生活节奏的加快，人体健康监测成为全球关注的焦点之一。基于物联网的人体健康监测系统已被广泛应用于老人健康监护、肥胖患者运动健康监测和慢性病患者健康监护等方面。系统一般由数据采集传感器获取脉搏、心率、温度等数据 [ 1 ] [ 2 ] [ 3 ] 后，由单片机及外设电路实现数据处理、显示和异常报警，并通过Wi-Fi、蓝牙、ZigBee等传输模块 [ 4 ] [ 5 ] [ 6 ] 实现数据与监测终端 [ 7 ] [ 8 ] [ 9 ] 的信息共享。目前大部分监测系统主要围绕系统硬件电路的设计或监测终端系统的开发，很少涉及多个应用系统的数据显示和终端实时监测。 制作基于STM32和复合传感器的人体健康数据采集电路，利用Android和LabVIEW分别开发了手机监测APP和PC端上位机，采集的人体健康数据经Wi-Fi同步传输至云存储，并显示在监测终端。家庭监护人可通过手机APP实时查看被监护人的健康指标；养老院等管理组织利用PC端识别具有不同标识码的监测设备后，监测多名被管理人员的健康指标。人体健康智能监测系统总体框图如图1所示。 图1. 人体健康智能监测系统总框图"
"人体健康智能监测系统硬件电路集成了心电信号采集器、体表温度传感器和运动检测模块，用于实施采集人体心率、体温和运动步数等数据；选用ST公司的STM32F103芯片作为主控，控制各个传感器模块对人体健康信息进行采集和处理，在TFT液晶显示屏实时显示，并通过无线通信模块发送至云端。整个硬件电路供电由锂电池和电源转化模块组成。系统硬件电路框图如图2所示。 图2. 人体健康智能监测系统硬件电路设计框图  采用TI公司的ADS1292芯片作为心电信号模块主控，该芯片是多通道同步采样24位模数转换器(Analog-to-Digital Converter, ADC)，具有内置的可编程增益放大器 (programmable gain amplifier, PGA)、内部基准和板载振荡器等心电采集所需要的部件。在低功耗模式下，每个通道功率仅有335 μW，足以支持长时间的移动监控，且内置右腿驱动放大器，能有效减小心电信号受噪声的干扰。 该模块通过三导联线捕获心电信号，经前置滤波和ADS1292芯片内部的电磁干扰滤波器(Electromagnetic Interference filter, EMI)后输入可编译的PGA放大器，再经过高精度的ADC模数转换为数字信号，通过DRDY，DOUT等管脚与单片机进行通信与数据传输。考虑医疗产品具有漏电流限制，在低通滤波电路中添加限流电阻以满足电流输出要求；考虑在干燥且没有外伤破损状态下人体电阻大约在120 kΩ到200 kΩ之间，选择了10 M的上拉、下拉电阻，有利于捕获心电信号。该模块信号采集电路与芯片电路需要进行电源的隔离，采用2片线性稳压芯片AMS1117-3.3对5 V的供电电压分别进行转换来达到隔离数字地与模拟地的效果。心电信号采集模块原理图如图3所示。 针对获取的心电信号(如图4所示)，采用搜索心电信号峰值点的方法定位R波，将相邻两个R波顶点记为特征点Lb和Sc，计算出相邻特征点间的时间间隔，再计算这些时间间隔的均值，从而获得这段时间内的平均心率BMP值 [ 10 ]，单位(次/分)。具体计算公式为： B M P = 60000 ( ∑ i = 1 10 S c ( i ) − L b ( i − 1 ) ) / 10 (1)  采用LMT70芯片作为人体体温数据采集模块的主控，该芯片是一款带有输出使能引脚的超小型、高精度、低功耗互补金属氧化物半导体(CMOS)模拟温度传感器，在20℃至42℃的范围内拥有±0.05℃ (典型值)或者±0.13℃ (最大值)的精度，且近似线性，囊括了人体测温所可能达到的范围 [ 11 ]。在LMT70芯片的驱动电路中，考虑到电源中可能存在高频干扰，在VDD与GND之间放置了一个107 nF的旁路电容来吸收高频能量。温度信息输出脚TAO端可以驱动容值小于1.1 nF的ADC采样输入端口，通过向地并接一个1.5 kΩ的电阻以增加驱动能力和采样信号的稳定性。LMT70芯片引脚图和驱动电路如图5所示。 图3. 心电信号采集模块设计原理图 图4. 标准心电信号波形图 图5. LMT70引脚及驱动电路原理图 采用三阶线性拟合来提高测量精度，拟合公式如下所示： T M = A ( V T A O ) 3 + B ( V T A O ) 2 + C ( V T A O ) + D (2) 其中，V TAO 为温度采集模块输出电压值，TM为计算后的人体体温值，A、B、C和D为拟合系数，由多次实验数据代入拟合后获得：A = −1.809628 × 10 −9 ，B = −3.325395 × 10 −6 ，C = −1.814103 × 10 −1 ，D = 2.055894 × 10 2 。在单片机工作过程中，利用此函数将V TAO 管脚的模拟信号转化成代表人体体温的数字信号。  使用MPU-6050作为人体运动数据采集模块的主控芯片，该芯片是全球首例9轴运动处理传感器，集成了3轴MEMS陀螺仪，3轴MEMS加速度计，以及一个可扩展的数字运动处理器(Digital Motion Processor, DMP)。传感器陀螺仪的可测范围在±250，±500，±1000，±2000˚/sec，加速度计可测范围为±2 g，±4 g，±8 g，±16 g，可测量范围远远大于人体正常行走中能产生的加速度。 该模块采用IIC通信模式与单片机通信，其SDA\SCL\AD0\INT管脚分别串接一个120 Ω的保护电阻与单片机相连，同时SDA\SCL管脚输出端分别接一个4.7 kΩ上拉电阻，以得到更大的电流输出，进而提高通信的稳定性。设计时不采用外部时钟接入，CLKIN脚接地无效。具体设计如图6所示。 图6. 人体运动数据采集模块设计原理图  使用ESP8266芯片通过Wi-Fi与OneNet云端服务器建立连接，进行数据交互 [ 12 ] [ 13 ]。首先对ESP8266模块进行初始化配置，设置成station模式，作为节点与无线路由器连接，通过无线路由器转发数据包的方式连接到OneNet服务器。当STM32通过传感器得到数据后，按照HTTP协议将数据打包，通过串口通信的方式传输给ESP8266，然后ESP8266将数据包转发给无线路由器，最后上传到onenet平台。终端应用可以访问云端服务器获取数据，进行数据的展示，比如移动端App，和PC端网页显示。通信模块结构设计如图7所示。  整个系统采用12 V的锂电池供电，并通过LM7805 [ 14 ] 和线性稳压芯片AMS1117-3.3分别转换成5.0 V电压与3.3 V电压，以满足单片机主控模块、传感器采样模块、无线通信模块的供电要求。 图7. 系统通信模块设计框图"
"本系统使用STM32F103ZET6作为主控芯片，当系统启动时，会首先驱动ESP8266加入网络，成功后启动外设并初始化，进入待机界面之后通过按键操作启动人体信息的测量采集处理，软件控制流程图如图8所示。 图8. 单片机主控程序流程图  在XML里使用TextView显示文本框、Button按键、EditView可编辑文本框、ImageView显示图片等控件搭建UI界面。在Android端创建URL，HttpURLConnection的对象，在URL中设置服务器的IP和调用服务器的数据请求方法，HttpURLConnection的对象调用HTTP协议的post和get方法向服务器发送URL请求，服务器根据收到的URL请求中的数据请求方法调用数据库的数据，完毕后向Android端返回执行结果和数据库数据，Android端再调用接收数据流方法收到结果，经过数据处理后将其显示在UI界面上 [ 15 ]。UI界面设计如图9所示，可显示被测对象的心率、体温、运动步数等数据。该APP可安装于Android 6.0及以上系统的移动终端(手机或平板)。 图9. 安卓端UI界面  利用LabView创建一个web服务资源，再创建一个VI用作可视化界面显示数据 [ 16 ]。在启动时，LabView平台利用自带的HTTP协议函数与OneNet服务器建立连接，发送一个请求信息，当服务器收到请求并回复一个状态行表示连接成功时，LabView平台发送一个设备号信息，即可开始接受该设备上传到服务器中的信息，利用工具平化还原字符串—平化至json对数据进行解码，截取对应长度的字符串分别归类至心率、运动步数、体温等类别显示在前面板中，并实时保存至本地文件夹以便使用结束后查阅。"
"测试时，在左胸、右胸、左腿处贴上电极片，利用三导联线将人体心电信号引入设备输入端，通过单片机控制计算实时心率和驱动TFT液晶屏显示心电波形。该系统可以较好地显示正常和心律不齐心电信号波形，如图10和图11所示。以徐州铭昇电子科技有限公司的SKX-2000G心电信号模拟仪产生不同BPM值的心电信号为参考，系统测试误差为0。  为提高体温测量的稳定性、精确性与易测量性，选择人体掌心作为测量位置。随机选取30个不同年龄段的人作为被测对象，编号1~30，分别用市面上销售的测温枪与本模块进行测温比较，统计测量值并计算以测温枪为标准值的误差。统计得该模块的绝对误差在±0.2℃以内，平均误差为±0.09℃，满足一般体温测量的需求。测量数据比较折线图如图12所示。 图10. 正常心电信号测试 图11. 心率不齐信号测试 图12. 模块与测温枪数据比较图  该模块测量时设定测量距离分别为5 m，10 m，20 m，每种测量距离测量五次，将每次理论数据和实际数据进行比较，并计算平均误差，测试结果如表1所示。 Table 1 5米 10米 20米 测量步数/步 实际步数/步 测量步数/步 实际步数/步 测量步数/步 实际步数/步 1 7 7 14 15 27 27 2 7 7 13 14 25 26 3 7 7 12 13 27 27 4 9 8 14 14 27 26 5 8 8 12 14 27 28 平均误差 0.6 表1. 运动量误差模块测试数据  本系统利用单片机和复合传感器实时采集人体心率、体温和运动数据，经Wi-Fi通信模块传输至服务器。APP端可实时查看被监测人员的健康指标，PC端利用LabVIEW从云端读取数据，并根据独特的设备码识别设备信息，对数据进行拆分译码并在可视化界面显示。系统整体测试如图13所示。 图13. 系统整体测试图"
"设计与制作了人体健康监测系统，该系统以STM32控制器为核心，搭载心电信号处理模块、体表温度测量模块和运动测量模块等多个传感器模块，实现了人体心率、体温和运动步数的测量与显示。通过无线通信方式将不同设备、不同传感器的数据传至云存储空间，采用HTTP协议实现服务器与手机端和电脑端的数据共享。基于APP的人体健康智能监测适用于个体家庭，而基于PC端的人体健康智能监测系统能够在识别不同设备标识码的基础上，显示各设备的监测数据，更适合于需监护多人的管理机构。该设计系统稳定，功能较为齐全，但在便携式可穿戴、功能和UI设计等方面还需进一步提高与完善。"
