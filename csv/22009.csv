"针对图像采集过程中插值算法对图像三原色之间所引入的插值特性，论文提出一种基于后验概率和滤色阵列特性的图像篡改检测算法。首先提取待测图像绿色通道分量，引入二维预测滤波构建预测误差函数；然后分块提取特征，分析原始与篡改图像所提特征的直方图特性，从而建立特征的高斯混合统计模型，并借助EM算法估计模型参数；计算子块特征作为原始块的后验概率，定义似然率并应用到每个子块中，从而可得到篡改区域映射图，完成本次检测。仿真结果表明，该算法具有较强的鲁棒性，能够对图像篡改区域进行较准确地定位。 关键词 :后验概率，滤色阵列特性，高斯混合模型，似然率，图像篡改检测 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"图像取证是一项多学科综合的科学，其旨在获取与数字图像相关的重要“历史”信息，主要包括其编码进程和可能的编辑修改过程 [ 1 ] 。随着图像编辑软件的日益强大，人们能够很轻易地修饰和篡改一幅图像。因此，鉴别图像的真伪及篡改区域的精细定位变得日趋重要。 T. Bianch等 [ 2 ] 对JPEG图像压缩过程进行建模，使用后验概率法估计量化步长，最后通过篡改区域和未篡改区域量化表的不一致性来定位篡改区域。Swaminathan等 [ 3 ] 提出了一种通过估计CFA模式和插值内核进行识别相机型号的方法，紧接着又在文献 [ 4 ] 中将去马赛克模型中估计出的参数之间的不一致性作为篡改检测的依据。H. Farid等 [ 5 ] 提出用期望最大化算法来估计去马赛克算法内插核参数，实现了借助每个像素与其相邻像素相关性的概率图来检测篡改区域，但这种方法需要预先知道图像篡改区域的尺寸。S. Vinoth等 [ 6 ] 提出将反向传播神经网络作为非线性模型来描述CFA插值特性并进行分类的方法。Peng Shuang等 [ 7 ] 提出一种利用自然图像颜色通道之间的相关性来检测图像篡改操作的方法，但对经模糊篡改的检测存在一定的误差。 面对错综复杂的图像篡改方式，很多方法的鲁棒性很差甚至会失效。本文从图像生成的过程出发，通过分析数码相机的一般成像体系(如图1)发现，图像经过滤色阵列(Color Filter Array, CFA)插值后三颜色分量具有很强的相关性，而且这种相关性会在图像的原始区域表现得很明显，但在被篡改过的图像区域却会消失 [ 8 ] 。所以，可以此作为判断图像篡改与否的依据。 基于文献 [ 5 ] [ 6 ] [ 7 ] 以及对成像体系的分析，发现CFA插值过程引入的噪声会使图像篡改检测的精度降低，而且一般的算法对模糊篡改后的平滑区域的检测总会有误差。所以，本文提出一种基于后验概率和滤色阵列特性的图像篡改检测方法，对篡改区域实行较高精度的定位。首先提取待测图像绿色通道分量，引入二维预测滤波构建预测误差函数；然后分块提取特征，分析原始与篡改图像所提特征的直方图 图1. 数码相机一般成像体系 特性，从而建立特征的高斯混合统计模型(Gaussian Mixture Model, GMM)，并借助EM (Expectation Maximization)算法估计模型参数；计算块特征作为原始块的后验概率，定义似然率并应用到每个子块中，从而可得到篡改区域映射图，映射图上每个像素的灰度值分别对应于待测图像上该子块的似然率值，该值越小，表明该区域被篡改的可能性越高，而被篡改过的区域将以灰度值极低的黑色区域显现出来，完成本次检测。"
"数码相机的图像传感器通过CFA来感应不同光的强度。现存的阵列，包括Bayer CFA，Mosic CFA, Stripe CFA，其中Bayer CFA作为最经典的阵列，应用最为广泛，它交替使用一组红色和绿色滤镜及一组绿色和蓝色滤镜，其中绿色像素是红、蓝像素数量的两倍，如图2(a)所示。这是由于人眼对于绿色更为敏感，且绿色在可见光谱中占据着最重要和最宽的位置。所以本文的研究以绿色通道分量为焦点。 Bayer CFA传感器的原始输出图像的每个像素只有红、绿、蓝中的一种颜色分量，俗称“马赛克图像”，因此，必须采用插值算法将单色的马赛克图像转换成逼真的全彩色图像，这个过程通常被称为“去马赛克(Demosaicing)”。插值通常在缺失值的邻域应用一个加权矩阵(核)来实现，常见的CFA插值算法分两类：一类是以双线性和双三次插值 [ 9 ] 为代表的非自适应插值算法，另一类则是以梯度插值 [ 10 ] 为代表的自适应插值算法。但无论采用哪种插值算法，数码相机拍摄出的原始自然图像往往都会存在一定的滤色阵列特性，也称“去马赛克效应”，而被修改过的图像区域则不具备这些特性。 所提取绿色通道的像素构成如图2(b)所示，获得像素和插值像素分别对应于晶格A和晶格I。如果图像是原始的自然图像，则晶格A和I的绿色像素值具有一定的规律，即晶格A处绿色像素的预测误差方差要高于晶格I处；相反，如果图像被篡改过，这种规律被破坏，则两个晶格的预测误差方差会变成相似的值。因此，可通过评估两类不同晶格处绿色像素值的预测误差方差的不平衡性，来检测CFA插值特性的存在与否，从而判定图像是否受到篡改。"
"本文所提算法的检测流程如图3所示。检测算法主要包含：1) 提取待测图像绿色通道分量；2) 计算预测误差及其加权方差；3) 建立篡改特征统计模型；4) 估计特征模型参数；5) 引入后验概率模型，定义似然率，输出篡改映射图。 这里引入权重因子和二维预测器来构建预测误差及其加权方差的统计模型，从模型中的不重叠像素块中提取出特征。如果这个特征明显大于零值，则认为它是一个原始像素块；反之，如果特征很接近于零值，则认为该子块为一个篡改块。 图2. Bayer CFA及绿色通道获得和插值像素分布 图3. 所提算法的检测流程  待测图像的绿色通道分量为 ， ，引入二维预测滤波，得其预测误差为： (1) 其中 为二维预测滤波， 为像素 周围像素的横、纵坐标。在理想情况下，可令 ，其中 为插值算法的插值内核。由于相机的插值算法往往是未知的，所以令 。 因为余量局部平稳，并且预测误差 的方差在插值或获得像素的邻域像素位置可以被逐个局部估计，所以预测误差 具有局部平稳性，假设其在 窗口内有效，则其局部加权方差可定义为： (2) 其中 为预测误差的局部方差均值； 为一尺度因子，可使参数评估更准确，例如对于每一个像素都有 ； 是合适的权重因子： (3) (4) 式中， 为一 的高斯窗，其标准偏差为 。 若待测图像大小为 ，将其分割成 大小的非重叠子块，B与Bayer CFA的周期相关，最小块尺寸为 。任意位置 处的子块 ( )都是由获得像素和插值像素的非相交集 、 构成，由此提取特征 并定义为： (5) (6) (7) 其中， 和 分别为获得像素和插值像素预测误差局部加权方差的几何均值。式(5)中的 是非连续的，可用于评估预测误差局部方差的不平衡性。若待测块是未被篡改过的原始块，则其获得像素的局部方差要远大于插值像素的局部方差，即特征 的期望值为一个正量；反之，当图像块被篡改过，则获得像素与插值像素局部方差之间的差异消失，特征 的期望值为0。  为了准确描述提取出的特征，需建立一个简单的统计模型，对每个子块 ，应用贝叶斯的方法可评估其CFA插值特性出现的概率。假设存在CFA插值特性时为 ，不存在CFA插值特性时为 。已知篡改图像和未篡改图像中提取出的特征L的统计直方如图4所示。 经分析，特征 在这两种假设下均服从高斯分布。若分块尺寸B固定，可以用下面这两个条件概率密度函数来描述所提特征： (8) (9) ， 和 分别表示 在假设 、 下的先验概率。 代表该区域存在CFA插值特性， 则代表该区域CFA插值特性已被擦除。如果一幅图像包含了一些CFA特征被破坏的篡改区域，则以上两种假设均存在，此时特征 服从高斯混合分布(如图4(b)示)。为了估计出该高斯混合模型的参数，引入EM方法来估计参数 的值。 图4. 所提特征统计直方图。(a)原始图像特征统计直方图；(b)篡改图像特征统计直方图  本算法最终的目标是针对每一个子块，都能基于CFA插值特性的存在与否来获得它是原始块的概率，并以不同子块灰度值的高低显示，从而来定位出篡改区域。根据(8)式和(9)式，且已知先验概率 ，则可得该子块作为原始块的后验概率为： (10) 也可改写成： (11) 为 的似然率，定义式为： (12) (11)式和(12)式具有相同的统计意义。将(12)式作用于图像的每个子块中，则可得到一映射图，图中的每个像素值分别对应于一个 块的似然率，且似然率越低，则该子块为篡改块的概率越高。然而，似然率图往往包含通道噪声，为了消除这些噪声，需在更大的块上计算其累计特征值，块大小为 ，且满足 。假设 和 之间条件独立，则可定义累计似然率为： (13) 在实际篡改图像中，篡改区域通常是连通的。为了进一步提高定位性能，对生成的似然图先取对数后应用一个中值滤波器，既能保证数值的稳定性，还能将这些关联区域都强调出来。"
"为了检测本文算法对图像篡改区域的定位性能，在篡改图像库中进行实验。原始样本均由 Nikon D90 获得，经PS软件对样本进行复制-粘贴篡改，同时对图像做后处理操作，如平滑，滤波，尺度、旋转等可更好的移除篡改区域的CFA特征。关键参数设置： ， ， 。与文献 [ 11 ] 所提出方法进行了检测效果的对比，图5和图6为两种方法仿真结果的对比图。 从图5可看出，两种方法都能定位出篡改区域，但文献 [ 11 ] 方法篡改区域的边界污染较严重，即检测的精度不够高，本文算法对篡改区域的边界轮廓定位得很精确，且本文算法和文献 [ 11 ] 方法输出映射图的最低似然率分别为−28.8988和−23.4673，也充分说明了本文算法检测性能的优越性；图6中的篡改图像后期经过了模糊处理，虽然两种算法的检测均存在较明显的误判区域，即对天空处平滑区域的检测失效，俩算法在篡改区域输出的最低似然率分别为−7.8577 (本文)和−6.5299 (文献 [ 11 ] )，但本文算法较文献 [ 11 ] 算法而言，依旧能够更清晰地将真正的篡改区域定位出来。综上可得，本文所提算法较文献 [ 11 ] 算法的检测性能更好，且精确度达到更高。"
"针对当前数字图像被动取证算法易受噪声影响致使检测精度不高情况，本文提出了基于后验概率和滤色阵列特性的图像篡改检测算法。对每个子块中提取的特征引入其后验概率，然后建立高斯混合模型， 图5. 图像篡改区域定位。(a)原始图像；(b)篡改图像；(c)本文算法检测结果；(d)文献 [ 11 ] 算法检测结果 图6. 图像篡改区域定位。(a)原始图像；(b)篡改图像；(c)本文算法检测结果；(d)文献 [ 11 ] 算法检测结果 定义似然率，输出篡改映射图并中值滤波去噪，最后输出的映射值越低表明被篡改的概率越大。实验结果显示该算法不仅能准确检测和定位篡改区域，而且具有较强的鲁棒性。但是对图像模糊篡改进行检测时，在平滑区域存在误检，这也是后续研究工作中的重点之一。"
