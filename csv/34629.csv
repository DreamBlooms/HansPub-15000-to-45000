"对于TDOA定位法，不同的解算算法决定了不同的定位精度，传统的Taylor级数展开法对于初值选取的合适与否依赖性较强。为提高定位精度，本文在Taylor级数展开法的基础上提出了一种引入Lagrange约束因子修正初始位置误差的解算方法。仿真实验I表明，在同等仿真条件下，传统Taylor级数展开法的最优定位精度次于Chan算法的最优定位精度。仿真实验II表明，在星载观测平台组网个数分别为4、6时，本文提出的修正算法定位精度都优于传统的Chan算法、Taylor算法。 关键词 :TDOA，约束因子，Taylor级数展开法 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"近年来，随着通信技术和电磁信号等科学技术的发展与研究，资源争夺的领地已经不仅仅局限于海洋与陆地，如何掌握空中制导权已经成了各国军备竞赛的重要争夺单元。基于单星载观测平台的定位系统虽然机动性能好，但定位精度往往达不到1 km [ 1 ]。增加观测平台可以得到更多的定位参数信息，如到达时间差(Time Difference of Arrival, TDOA) [ 2 ] 、到达频率、到达频率差(Frequency Difference of Arrival, FDOA) [ 3 ] 、多普勒频率和多普勒频率变化率 [ 4 ] 等，其中TDOA定位法是使用最广泛的定位算法。 TDOA定位方程的解算方式与定位精度有直接关系 [ 5 ]。最早的定位算法是1976年Foy等人提出的Taylor级数展开法 [ 6 ]，本质上是一种迭代算法，类似的，还有利用Newton迭代法进行位置求解，迭代算法的优点是定位精度高 [ 7 ]，但是缺点迭代算法计算复杂，且需要选取合适的目标位置初始值，因此如何优化上述算法十分有研究意义。除了迭代法，还有以Y.T. Chan提出的Chan算法 [ 8 ] 为代表的解析法。此外，还有一种闭式解法思想，代表算法有球面相交法(SX) [ 9 ] 、平面相交法(PX) [ 10 ] 和球面插值法(SI) [ 11 ]，尽管这些算法都可以求得目标的位置解，但是闭式解法有一个共同的缺点，定位性能无法达到克拉美罗下界 [ 12 ]。"
"到达时间差(Time Difference of Arrival, TDOA)定位法，简称时差定位法。目标到达两个星载观测站的时间先后不同，故而可以得到一个时间差，利用速度距离公式可以确定一个双曲面，空间中三组双曲面相交可以得到一个交点，此交点即为近地辐射源目标。获得三组双曲面，至少需要三个星载观测平台，因此时差定位法对三维空间目标进行定位至少需要三个或三个以上的星载平台来组成定位网络。定位原理图如图1。 假设在地心固定坐标系描述下辐射源目标为 u = [ x y z ] T ， S i , i = 1 , 2 , ⋯ , N 均为星载观测平台，为了方便描述，以 S 1 为主观测平台，其余观测平台为辅助观测平台，三维坐标表示为 S i = [ x i y i z i ] T 。 以星载观测平台组网个数是四个为例，根据几何关系有： 图1. 三维TDOA定位原理示意图 { r 1 2 = ( x − x 1 ) 2 + ( y − y 1 ) 2 + ( z − z 1 ) 2 r 2 2 = ( x − x 2 ) 2 + ( y − y 2 ) 2 + ( z − z 2 ) 2 r 3 2 = ( x − x 3 ) 2 + ( y − y 3 ) 2 + ( z − z 3 ) 2 r 4 2 = ( x − x 4 ) 2 + ( y − y 4 ) 2 + ( z − z 4 ) 2 (1) 将速度距离公式带入式(1)有： { Δ r 1 = r 2 − r 1 = c Δ t 1 Δ r 2 = r 3 − r 1 = c Δ t 2 Δ r 3 = r 4 − r 1 = c Δ t 3 (2) 整理式(1)、式(2)得： { ( x 1 − x 2 ) x + ( y 1 − y 2 ) y + ( z 1 − z 2 ) z = k 1 + r 1 Δ r 1 ( x 1 − x 3 ) x + ( y 1 − y 3 ) y + ( z 1 − z 3 ) z = k 2 + r 2 Δ r 2 ( x 1 − x 4 ) x + ( y 1 − y 4 ) y + ( z 1 − z 4 ) z = k 3 + r 3 Δ r 3 (3) 其中： k i = 1 2 [ Δ r i 2 + ( x 1 2 + y 1 2 + z 1 2 ) − ( x i 2 + y i 2 + z i 2 ) ] ， i = 1 , 2 , 3 。 解方程组式(3)即可得到近地辐射源的坐标。"
"1994年学者Y.T. Chan提出了一种本质并非迭代法的非线性方程求解算法，该算法本质是解析式法，并且不需要设置初值，计算量也大大降低，于是该算法被命名为Chan算法。 该算法将辐射源目标与星载观测平台之间的距离视为常量，则式(3)可以写为： A X = F (4) 其中： A = [ x 2 − x 1 y 2 − y 1 z 2 − z 1 x 3 − x 1 y 3 − y 1 z 3 − z 1 x 4 − x 1 y 3 − y 1 z 3 − z 1 ] ， X = [ x y z ] ， F = [ k 1 + r 1 Δ r 1 k 2 + r 2 Δ r 2 k 3 + r 3 Δ r 3 ] 。 假设四个星载观测平台呈不规则分布，不会处于同一水平线上，则有 det A ≠ 0 ，此时辐射源目标的位置的最小二乘解可以由伪逆法求得： X ^ = ( A T A ) − 1 A T F (5) 记式(8)中的 ( A T A ) − 1 A T = [ a i j ] 3 × 3 = [ a 11 a 12 a 13 a 21 a 22 a 23 a 31 a 31 a 33 ] (6) 联立式(8)与式(9)可得近地辐射源目标位置的估计值： X ^ = [ x ^ y ^ z ^ ] = [ m 1 + n 1 r 1 m 2 + n 2 r 2 m 3 + n 3 r 3 ] (7) 其中： { m i = ∑ j = 1 3 a i j k j m i = ∑ j = 1 3 a i j Δ r j ,   i = 1 , 2 , 3 。 将式(10)带入式(1)得： a r 1 2 + 2 b r 1 + c = 0 (8) 其中： { a = n 1 2 + n 2 2 + n 3 2 − 1 b = ( m 1 − x 1 ) n 1 + ( m 2 − y 1 ) n 2 + ( m 3 − z 1 ) n 3 c = ( m 1 − x 1 ) 2 + ( m 2 − y 1 ) 2 + ( m 3 − z 1 ) 2 。 此时求解辐射源目标的位置解从求解复杂的非线性方程转化为求解一元二次方程，大大降低了计算复杂度，求解过程有以下三种情况： 1) 当判别式 Δ > 0 时，式(11)有两解，此时出现了时差定位模糊现象； 2) 当判别式 Δ = 0 时，式(11)有一解，此时的解便是辐射源目标的位置解，没有出现时差定位模糊现象； 3) 当判别式 Δ < 0 时，式(11)无解，时差定位曲线无交点，定位失效。 当判别式大于等于零时，对该一元二次方程进行求解便得到近地辐射源目标的位置解： r 1 = − b ± b 2 − a c a (9) 将式(12)与式(1)、(2)联立即可求得近地辐射源目标的位置。 以上便是Chan算法的解算步骤。但是由以上分析可知Chan算法有可能出现定位模糊甚至无解的情况，此时TDOA定位法的定位结果将受较大影响。"
"Taylor级数展开法本质上是一种迭代算法，核心思想 [ 13 ] 是：将TDOA定位方程按照Taylor级数终值定理展开，并忽略二阶及二阶以上的分量，在开始迭代前为目标位置赋予初值，之后在此基础上进行迭代，在每一次的迭代过程中通过局部最小二乘解(Least Squares, LS)逐渐收敛于辐射源目标位置解。 1) 根据TDOA定位原理，将迭代初始值设为 X ′ = ( x ′ , y ′ , z ′ ) T ，与真实位置的测量误差记为 δ = ( Δ x , Δ y , Δ y ) T ，则有如下关系： X = X ′ + δ (10) 2) 在迭代初始值处按照Taylor级数展开，去除二阶以上高阶分量的同时仅保留一阶分量，得到如下表达式： e ≈ H − G δ (11) 其中： e = [ e 1 , e 2 , e 3 ] T 为TDOA定位法中时间测量误差矩阵； H = [ c Δ t 1 − ( r ′ 2 − r ′ 1 ) c Δ t 2 − ( r ′ 3 − r ′ 1 ) c Δ t 3 − ( r ′ 4 − r ′ 1 ) ] ； G = [ ∂ Δ r 2 δ x ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 2 δ y ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 2 δ z ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 3 δ x ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 3 δ y ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 3 δ z ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 4 δ x ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 4 δ y ′ | ( x ′ , y ′ , z ′ ) ∂ Δ r 4 δ z ′ | ( x ′ , y ′ , z ′ ) ] = [ x 1 − x ′ r 1 − x 2 − x ′ r 2 y 1 − y ′ r 1 − y 2 − x ′ r 2 z 1 − z ′ r 1 − z 2 − z ′ r 2 x 1 − x ′ r 1 − x 3 − x ′ r 3 y 1 − y ′ r 1 − y 3 − x ′ r 3 z 1 − z ′ r 1 − z 3 − z ′ r 3 x 1 − x ′ r 1 − x 4 − x ′ r 4 y 1 − y ′ r 1 − y 4 − x ′ r 4 z 1 − z ′ r 1 − z 4 − z ′ r 4 ] . 3) 用加权最小二乘法得出初始位置处的最大似然估计： δ = [ Δ x Δ y Δ z ] T = ( G − 1 Q − 1 G ) − 1 G T Q − 1 H (12) 其中：Q为TDOA定位法测量误差的协方差矩阵。 4) 设定一个门限精度 ε t ： 如果 | Δ x | + | Δ y | + | Δ z | < ε ，则终止迭代过程，此时可以得出近地辐射源目标最终位置估计值： { x ^ = x ′ + Δ x y ^ = y ′ + Δ y z ^ = z ′ + Δ z (13) 如果 ，则继续执行步骤5)。 5) 用最新得到估计值的估计值替代上一个估计值，并重复步骤3)和步骤4)。 以上便是Taylor级数展开法的解算步骤。"
"Chan算法计算简单但是有时差模糊现象，该现象严重可导致系统定位功能失效；Taylor算法尽管计算复杂，但每次都能得到确定的位置解，此外初值选取的合适与否对定位结果有直接的影响。随着计算机计算速度的加快，复杂的计算已经变得不再复杂，为此提出一种基于Lagrange约束因子的解算方法。 式(3)转化为矩阵表达形式为： A X = b (14) 其中： A = [ x 1 − x 2 y 1 − y 2 z 1 − z 2 − Δ r 1 x 1 − x 3 y 1 − y 3 z 1 − z 3 − Δ r 2 x 1 − x 4 y 1 − y 4 z 1 − z 4 − Δ r 3 ] ； X = [ x y z r 1 ] T ； b = [ k 1 k 2 k 3 ] T 。 考虑到系统总含有观测噪声及测量误差，故在计算过程加入误差干扰项，用最小二乘法求得位置估计值为： X ^ = ( A T A − σ 2 I ) − 1 A T b = X + Δ X (15) 其中： σ 是矩阵 [ b − A ] 的最小奇异值；I为单位阵； Δ X 为误差项。 为了计算方便，将主观测平台所在的位置设为坐标原点，故式(1)的第一行可简化为： r 1 2 = x 2 + y 2 + z 2 (16) 进一步转化为矩阵表达形式为： X T g X = 0 (17) 其中： g = d i a g ( 1 , 1 , 1 , − 1 ) 。 至此，引入Lagrange数乘因子 λ ，Lagrange数乘算法 [ 14 ] 的思想由Joseph Lagrange在1971年首次提出，用来解决数学解算过程中的最优问题。利用该思想，得到以下约束表达式： L ( X , λ ) = ( A X − b ) T ( A X − b ) + λ X T g X (18) 对 L ( X , λ ) 求一阶偏导数并令其为零： ∂ L ( X , λ ) ∂ X = ( A T A + λ g ) − 1 − A T b = 0 (19) 解上述方程，得： X = ( A T A + λ g ) − 1 A T b (20) 联立式(20)和式(23)，有： (21) 为了求解上式，先令 ( A T A ) − 1 g = U Λ U − 1 ，其中 Λ = d i a g ( λ 1 , λ 2 , λ 3 , λ 4 ) ， λ i 为矩阵 ( A T A ) − 1 g 的特征值，所以有： ( A T A + λ g ) − 1 = U ( I + λ Λ ) − 1 U − 1 ( A T A ) − 1 (22) 将式(25)带入式(23)整理为矩阵表达形式为： E T ( I + λ Λ ) − 1 Λ ( I + λ Λ ) − 1 h = 0 (23) 其中： E T = b T A U = [ e 1 e 2 e 3 e 4 ] ； h = U − 1 ( A T A ) − 1 A T U = [ h 1 h 2 h 3 h 4 ] T 。 将矩阵表达形式整理为代数表达形式为： ∑ i = 1 4 e i λ i h i ( λ λ i + 1 ) 2 = 0 (24) 解该代数方程便可以得到Lagrange数乘因子 λ ，将其带入式(23)便可以得到位置解X。 根据位置解X得到误差修正项 Δ X 的表达式： Δ X = ( A T A − σ 2 I ) − 1 A T b + λ ( A T A ) g X − A − 1 b (25) 最终得到修正后的位置： X ^ = ( A T A − σ 2 I ) − 1 A T b + [ λ ( A T A ) g + I ] X − A − 1 b (26) 将修正后的位置作为Taylor展开时的初始值，之后进行Taylor级数展开法，当满足精度要求终止迭代时，本文提出的基于Lagrange约束因子的解算方法解算完成，算法流程图如图2。 图2. 基于Lagrange约束因子修正算法原理图"
"实验I：星载观测平台数量对不同定位算法精度的影响 各星载观测平台的位置坐标如表1所示，以星载观测平台1的位置为坐标原点，近地辐射源目标的位置为 ( 0.702 , 70.342 , 80.867 )   km 。TDOA测量误差服从理想高斯噪声环境。 定位精度用均方根误差来评判，计算公式为： R M S E ( X ) = E [ ‖ X − X ^ ‖ 2 2 ] = ∑ i = 1 T s ( X i − X ^ ) 2 / T s (27) 其中：X为第i次估计的近地辐射源目标位置； X ^ 为近地辐射源目标的真实位置； T s 为采样次数。 由图3、图4可知，Chan算法定位精度比Taylor级数展开法对定位系统中星载观测平台的个数更加敏感，尽管如此Chan算法也可以随着星载观测平台的个数增加得到更好的定位精度，但是当参与定位的星载观测平台个数达到5个及以上时，对定位精度改善不大。Taylor级数展开法的定位精度受星载观测平台的个数的影响不大，当个数达到四个或以上时，定位精度达到最优，并很难随着观测平台的增加而明显提高。就总体而言，Taylor级数展开法的最优定位精度次于Chan算法的最优定位精度。 Table 1 x/km y/km z/km 星载观测平台1 0 0 0 星载观测平台2 0 1.866 1.732 星载观测平台3 −1.500 0.867 1.732 星载观测平台4 −1.500 −0.867 0 星载观测平台5 0 −0.134 −1.732 星载观测平台6 1.500 −1.732 −1.732 星载观测平台7 1.500 −1.732 0 表1. 星载观测平台的位置分布 图3. 不同星载观测平台下Chan算法的性能 图4. 不同星载观测平台下Taylor算法的性能 实验II：不同定位算法的性能比较 基于实验I的仿真结果，实验II选择星载观测平台的个数分别为4、6，星载观测平台的位置同实验I。TDOA测量误差服从理想高斯噪声环境。 定位精度用均方误差来评判，计算公式为： M S E ( X ) = E [ ‖ X − X ^ ‖ 2 2 ] = ∑ i = 1 T s ( X i − X ^ ) 2 / T s (28) 图5. 四个星载观测平台下三种定位算法性能比较 图6. 六个星载观测平台下三种定位算法性能比较 图5、图6分别给出了同等仿真条件下Taylor级数展开法、Chan算法、本文提出的解算算法在4个星载观测平台、6个星载观测平台下的仿真结果。 由图可知，无论星载观测平台的个数是多少，本文提出的解算算法定位精度最高，Chan算法次之，Taylor级数展开法的定位性能最差，这说明初值的选取对Taylor级数展开法的定位精度有直接影响。本文用Lagrange约束因子修正后的位置值作为Taylor级数展开法的迭代初始值后，定位精度有了明显的提升。"
"本文提出的基于Lagrange约束因子修正算法引入了Lagrange约束因子，利用星载观测平台位置的已知性作为约束条件，求解出辐射源目标的位置在该约束条件下的修正解，并将修正后的位置作为Taylor级数展开法中的初值。仿真结果表明，传统Taylor级数展开法的最优定位精度次于Chan算法的最优定位精度，而本文提出的Taylor级数展开法修正算法在不同观测平台个数下的定位精度都高于传统的Chan算法、Taylor算法的定位精度。 但是本文仅在高斯噪声环境中做了仿真实验，真实的测量环境的噪声十分复杂，需要进一步探究。基于此，在后续的研究中考虑引入合适的滤波器滤除噪声及误差。同时，如何降低迭代次数，使得估计值快速收敛到目标真实值也是一个重要的研究课题。"
