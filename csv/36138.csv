"本文探究了一类随机动力系统转移概率密度函数的求解及其有效性问题。首先，提出了一种计算简便、精度较高的数值模拟方法，用于得到FPK (Fokker-Planck-Kolmogorov)方程的近似解。其次，通过比较该近似解与系统的精确解，我们发现此模拟方法的相对误差保持在2 × 10 (−3) 以内，误差基本在10 (−3) 以内。最后，通过比较由近似解得到的状态变量出现在某一稳态区域的概率和系统离散后的相图，我们得出此模拟方法可以有效地描述系统的性态。因此，它是求解系统FPK方程的一种有效算法。 关键词 :FPK方程，转移概率密度函数，平稳势，广义平稳，Mathematica Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"对随机微分动力系统而言，研究FPK方程是探究系统响应的一种重要方法。通过求解FPK方程，我们可以得到状态变量的转移概率密度函数，进而了解系统的状态。但是对于绝大多数系统而言，其FPK方程无法或很难求得其精确解，因此，FPK方程的数值解法非常重要。在许多学者的共同努力下，目前已经出现许多近似解法，例如有限元法 [ 1 ]，路径积分法 [ 2 ] [ 3 ] [ 4 ]，有限差分法 [ 5 ] [ 6 ] [ 7 ] [ 8 ] [ 9 ]，高斯闭合法 [ 10 ] - [ 16 ] 等等，但极少数文章关注其精确度。所以，本文针对一类非线性随机动力系统，在现有文献的基础上，首先提出一种数值解法——指数闭合法 [ 15 ]，其次研究其精确性问题。 我们的想法是：针对一类非线性随机动力系统，首先写出系统的FPK方程，其次假设方程的近似解为指数多项式形式，利用待定系数法可以求解出近似解的系数，从而得到系统FPK方程的数值解。并且，我们从两个方面验证该方法的有效性：一方面，比较该方法得到的FPK方程的数值解和广义平稳条件下的精确解的误差，发现该解法的误差小于千分之三。另一方面，比较数值解对应的转移概率密度函数和系统离散化后的相图这两者所确定的稳态区域，发现两个区域具有高度一致性。因此，本文提出的数值解法不仅计算简便，而且精度较高，是求解FPK方程的一种有效方法。"
"对于一般的非线性随机动力系统 [ 17 ]： d X i d t = f i ( X ) + ∑ l = 1 m g i l ( X ) W l ( t ) , i = 1 , 2 , ⋯ , n (1) 式中 X ( t ) = [ x 1 , x 2 , ⋯ , x n ] T ， W l ( t ) 是高斯白噪声，其相关函数为 E [ W l ( t ) W s ( t + τ ) ] = 2 π K l s δ ( τ ) , l , s = 1 , 2 , ⋯ , m (2) 如果该系统存在平稳转移概率密度函数，则由下列简化FPK方程决定： ∑ i = 1 n ∂ ∂ x i G i = ∑ i = 1 n ∂ ∂ x i [ a i ( x ) p − 1 2 ∑ j = 1 n ∂ ∂ x j ( b i j ( x ) p ) ] = 0 (3) 式中G i 是第i个方向的概率流。a i 、b ij 分别是一、二阶导数矩，由方程(1)可导出： a i ( x ) = f i ( x ) + π ∑ k = 1 n ∑ l , s = 1 m K l s g k s ( x ) ∂ ∂ x k g i l ( x ) ; b i j ( x ) = 2 π ∑ l , s = 1 m K l s g i l ( x ) g j s ( x )     ; (4) 如果对(3)增加如下一组充分条件，我们可以得到系统(1)在广义平稳条件下的精确解： G i = a i ( x ) p − 1 2 ∑ j = 1 n ∂ ∂ x j [ b i j ( x ) p ] = 0 (5) 此时，系统(1)属于平稳势类，因此，我们可以将平稳转移概率密度函数表示为 p ( x ) = C exp [ − φ ( x ) ] 。其中，C是归一化常数， φ ( X ) 叫做概率势函数。 而广义平稳的条件只有极少数系统满足，绝大多数系统的FPK方程无法或很难求解。下面我们对本文的数值算法思想进行详细阐述。  我们假设系统(1)的FPK方程的解，即系统的平稳转移概率密度函数为如下形式： p n ( x ) = C exp [ a 11 x 1 + a 12 x 2 + a 21 x 1 2 + a 22 x 1 x 2 + a 23 x 2 2 + ⋯ + a i j x 1 i − j + 1 x 2 j − 1 + ⋯ + a n n + 1 x 2 n ] (6) 其中C为归一化常数 a 11 , a 12 , ⋯ , a n   n + 1 ( n ≥ 2 ) 是常数。由于解必须要满足方程，即上式需满足(3)，从而我们将上式带入(3)，得到： a i ( x ) p n − 1 2 ∑ j = 1 n ∂ ∂ x j [ b i j ( x ) p n ] = 0 (7) 对上式两边使用待定系数法，通过解方程便可求出 x 1 i , x 2 j ( i , j = 0 , ⋯ , n ) 的系数 a 11 , a 12 , ⋯ , a n   n + 1 ( n ≥ 2 ) 与归一化常数C。因此，我们就可得到FPK方程的数值解。 下一小节我们通过两个例子具体说明该算法的计算过程与有效性。"
"考虑： x ¨ + 2 α [ 1 + W 1 ( t ) ] x ˙ + ω 2 [ 1 + W 2 ( t ) ] x + β 1 ( x 2 + x ˙ 2 ω 2 ) x ˙ = W 3 ( t ) (8) 式中 W 1 ( t ) , W 2 ( t ) , W 3 ( t ) 是相互独立的Stratonovich意义下的零均值高斯白噪声过程，其谱密度常数分别是 k 1 , k 2 , k 3 。 α , ω , β 1 是常数。 令 x 1 = x , x 2 = x ˙ ，则可得到其Stratonovich型随机微分方程为： { d x 1 = x 2 d t d x 2 = [ − 2 α x 2 − ω 2 x 1 − β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 ] d t − 2 α x 2 2 π k 1 ∘ d B 1 ( t )                   − ω 2 x 1 2 π k 2 ∘ d B 2 ( t ) + 2 π k 3 ∘ d B 3 ( t ) (9) 加入Wong-Zakai 修正项，上述方程便转化成Itô型随机微分方程为： { d x 1 = x 2 d t d x 2 = [ − 2 α x 2 − ω 2 x 1 − β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 + 4 α 2 x 2 π k 1 ] d t − 2 α x 2 2 π k 1 d B 1 ( t )                   − ω 2 x 1 2 π k 2 d B 2 ( t ) + 2 π k 3 d B 3 ( t ) (10) 我们求出一、二阶导数矩分别为： a 1 = x 2 ; a 2 = − 2 α x 2 − ω 2 x 1 − β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 + 4 α 2 x 2 π k 1 ; b 11 = b 12 = b 21 = 0 ; b 22 = 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ; (11) 带入(3)便可得到此系统的FPK方程： ∂ x 2 p ∂ x 1 + ∂ [ − 2 α x 2 − ω 2 x 1 − β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 + 4 α 2 x 2 π k 1 ] p ∂ x 2 − 1 2 ∂ 2 [ 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ] p ∂ x 2 2 = 0 (12) 我们知道，通过将一阶导数矩分为可逆和不可逆分量可以将精确可解类从平稳势拓展到详细平衡。类似思路，我们不仅把一阶导数矩分开，而且把二阶导数矩也分开，将精确可解类进一步拓展，用于求解系统的FPK方程。(12)式左端最后一项可以写成： ∂ 2 [ 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ] p ∂ x 2 2 = ∂ [ 16 α 2 x 2 π k 1 p ] ∂ x 2 + ∂ [ ( 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ) ∂ p ∂ x 2 ] ∂ x 2 (13) 将上式带入FPK方程(12)，我们可以得到： ∂ x 2 p ∂ x 1 − ω 2 x 1 ∂ p ∂ x 2 + ∂ [ − 2 α x 2 − β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 − 4 α 2 x 2 π k 1 ] p ∂ x 2 − 1 2 ∂ [ ( 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ) ∂ p ∂ x 2 ] ∂ x = 0 (14) 为了化简上式的求解，我们加入如下一组充分条件： { ∂ x 2 p ∂ x 1 − ω 2 x 1 ∂ p ∂ x 2 = 0 [ − 2 α x 2 − β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 − 4 α 2 x 2 π k 1 ] p − 1 2 ( 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ) ∂ p ∂ x 2 = 0 (15) 假设 p ( x ) = C exp [ − φ ( x ) ] ，其中 φ ( x ) = φ ( λ ) , λ = 1 2 x 2 2 + 1 2 ω 2 x 1 2 ，C是归一化常数。则(15)式等价为： { x 2 ∂ φ ∂ x 1 − ω 2 x 1 ∂ φ ∂ x 2 = 0 [ 2 α x 2 + β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 + 4 α 2 x 2 π k 1 ] + 1 2 ( 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ) ∂ φ ∂ x 2 = 0 (16) 化简可得到： d φ d λ = 2 α + β 1 ( x 1 2 + x 2 2 ω 2 ) + 4 α 2 π k 1 4 α 2 x 2 2 π k 1 + ω 4 x 1 2 π k 2 + π k 3 (17) 若取 4 α 2 k 1 = k 2 ω 2 , β 1 = ( 2 α + 4 α 2 π k 1 ) ω 4 k 2 k 3 则： d φ d λ = 2 α + β 1 ( x 1 2 + x 2 2 ω 2 ) + 4 α 2 π k 1 π k 2 ω 2 x 2 2 + ω 4 x 1 2 π k 2 + π k 3 = ( 2 α + 4 α 2 π k 1 ) [ 1 + ω 4 k 2 k 3 ( x 1 2 + x 2 2 ω 2 ) ] π k 3 [ 1 + ω 4 k 2 k 3 ( x 1 2 + x 2 2 ω 2 ) ] = 2 α + 4 α 2 π k 1 π k 3 (18) 故在广义平稳条件下，可解得该系统FPK方程的精确解为： p e ( x ) = C E x p [ − 2 α + 4 α 2 π k 1 π k 3 ( 1 2 ω 2 x 1 2 + 1 2 x 2 2 ) ] (19) 下面采用本文提出的数值解法求(12)的近似解，并将该近似解和上式精确解进行对比。首先，假设该系统的平稳转移概率密度函数为： p n ( x ) = C exp [ a 11 x 1 + a 12 x 2 + a 21 x 1 2 + a 22 x 1 x 2 + a 23 x 2 2 + ⋯ + a i j x 1 i − j + 1 x 2 j − 1 + ⋯ + a n n + 1 x 2 n ] (20) 将式(20)带入FPK方程(12)中，固定住n，就有 ∂ x 2 p n ∂ x 1 + ∂ [ − 2 α x 2 − ω 2 x 1 − β 1 ( x 1 2 + x 2 2 ω 2 ) x 2 + 4 α 2 x 2 π k 1 ] p n ∂ x 2 − 1 2 ∂ 2 [ 8 α 2 x 2 2 π k 1 + 2 ω 4 x 1 2 π k 2 + 2 π k 3 ] p n ∂ x 2 2 = 0 (21) 运用待定系数法确定p n 的系数，我们可求得此近似解。当取 ω = 1 , k 1 = k 2 = k 3 = 1 时，求得 α = 0. 5 , β 1 = 0.28 。 当取n = 2时，我们使用Mathematica解得： a 11 = a 12 = a 22 = 0 ;     a 21 = − 0.579577 ;     a 23 = − 0.579577 ; (22) 此时 p 2 ( x ) = − 0.579577 x 1 2 − 0.579577 x 2 2 (23) 当取n = 6时，我们解得： a 11 = a 12 = a 22 = a 31 = a 32 = a 33 = a 34 = a 42 = a 44 = a 51 = a 52 = a 53 = a 54 = a 55 = a 56 = a 62 = a 64 = a 66 = 0 ;     a 21 = − 0.579577 ;     a 23 = − 0.579577 ; a 41 = 0.000126739 ;     a 43 = 0.000253479 ;     a 45 = 0.000126739 ; a 61 = − 0.0000844929 ;     a 63 = − 0.000253479 ;     a 65 = − 0.000253479 ; a 67 = − 0.0000844929. (24) 此时： p 6 ( x ) = − 0.579577 x 1 2 + 0.000126739 x 1 4 − 0.0000844929 x 1 6 − 0.579577 x 2 2     + 0.000253479 x 1 2 x 2 2 − 0.000253479 x 1 4 x 2 2 + 0.000126739 x 2 4     − 0.000253479 x 1 2 x 2 4 − 0.0000844929 x 2 6 (25) 数值模拟结果如图1： 图1. 稳态转移概率密度函数示意图 下面我们重点比较两种解的误差情况。图2展示了在不同区域，近似解和精确解的误差图，通过比较，我们发现误差基本在0.0003之内，精度较高。从图1中我们也可以看到，系统的状态变量主要集中在(−2, 2)之间，因此，图3展示了在此区域内，不同小范围的精确度。图中不同颜色的线表示不同的区域，对应不同的精确度。总体来看，该方法在稳态区域的精确度非常高。 图2. p 6 (x)和p e (x)误差图 图3. 稳态区域的精确度示意图 表1和表2分别给出平衡态附近的不同区域内，近似解以及精确解的取值和误差比较，观察这些数据我们可以看出，两种解的误差非常微弱，这也说明我们的方法较精确。 Table 1 p(x) x 1 2 + x 2 2 ≤ 1 x 1 2 + x 2 2 ≤ 0.25 | x 1 | ≤ 1 ; | x 2 | ≤ 1 | x 1 | ≤ 0.5 ; | x 2 | ≤ 0.5 n = 2 0.439865 0.134886 0.516040 0.167808 n = 6 0.440668 0.135130 0.516982 0.168112 精确解 0.439865 0.134886 0.516040 0.167808 表1. 平衡态附近，数值解与精确解取值一览表 Table 2 比较p 2 (x)和p e (x) x 1 2 + x 2 2 ≤ 1 x 1 2 + x 2 2 ≤ 0.25 | x 1 | ≤ 1 ; | x 2 | ≤ 1 | x 1 | ≤ 0.5 ; | x 2 | ≤ 0.5 误差 0.000803 0.000244 0.000942 0.000304 相对误差 0.1825% 0.1808% 0.1825% 0.1811% 表2. 平衡态附近，数值解与精确解误差一览表  考虑： X ¨ + [ a + ( b X + c X ˙ ) 2 ] X ˙ + X = ( d X + e X ˙ ) W 1 ( t ) + W 2 ( t ) (26) 式中 a , b , c , d , e 是常数， W 1 ( t ) , W 2 ( t ) 是功率谱密度常数分别为 k 1 , k 2 的独立高斯白噪声。假设 X 1 = X , X 2 = X ˙ ，可以得到该系统的Stratonovich型随机微分方程为： { d X 1 = X 2 d t d X 2 = { − [ a + ( b X 1 + c X 2 ) 2 ] X 2 − X 1 } d t + ( d X 1 + e X 2 ) 2 π k 1 ∘ d B 1 ( t ) + 2 π k 2 ∘ d B 2 ( t ) (27) 式中 B 1 ( t ) , B 2 ( t ) 为单位维纳过程。转化为Itô型随机微分方程： { d X 1 = X 2 d t d X 2 = { − [ a + ( b X 1 + c X 2 ) 2 ] X 2 − X 1 + π k 1 e ( d X 1 + e X 2 ) } d t + ( d X 1 + e X 2 ) 2 π k 1 d B 1 ( t ) + 2 π k 2 d B 2 ( t ) (28) 式中 π k 1 e ( d X 1 + e X 2 ) 是 Wong-Zakai修正项。从而我们可以得到系统的FPK方程为： ∂ X 2 p ∂ X 1 + ∂ { − [ a + ( b X 1 + c X 2 ) 2 ] X 2 − X 1 + π k 1 e ( d X 1 + e X 2 ) } p ∂ x 2 − ∂ 2 [ ( d X 1 + e X 2 ) 2 π k 1 + π k 2 ] p ∂ X 2 2 = 0 (29) 如之前的计算过程类似，我们假设系统(26)的平稳转移概率密度函数为： p n ( X ) = C exp [ a 11 X 1 + a 12 X 2 + a 21 X 1 2 + a 22 X 1 X 2 + a 23 X 2 2 + ⋯ + a i j X 1 i − j + 1 X 2 j − 1 + ⋯ + a n n + 1 X 2 n ] (30) C归一化常数。把该近似解带入(29)中，可以得到： ∂ X 2 p n ∂ X 1 + ∂ { − [ a + ( b X 1 + c X 2 ) 2 ] X 2 − X 1 + π k 1 e ( d X 1 + e X 2 ) } p n ∂ X 2 − ∂ 2 [ ( d X 1 + e X 2 ) 2 π k 1 + π k 2 ] p n ∂ X 2 2 = 0 (31) 若取 a = 4 ; b = 5 4 ; c = − 15 4 ; d = 1 2 ; e = − 3 2 ; k 1 = k 2 = 1 π 。我们首先使用本文提出的数值解法求得平稳转移概率密度函数的系数，得到FPK方程的近似解为： p n ( X ) = 25 16 π e − 25 32 ( X 1 2 + 4 X 2 2 ) (32) 图4给出了p n 的数值模拟示意图。 图4. 稳态转移概率密度函数示意图 下面我们采用 Milsteins 离散方法，得到(28)的离散化形式： { X 1 ( t j + 1 ) = X 1 ( t j ) + X 2 ( t j ) Δ t X 2 ( t j + 1 ) = X 2 ( t j ) + { − [ a + ( b X 1 ( t j ) + c X 2 ( t j ) ) 2 ] X 2 ( t j ) − X 1 ( t j ) + π k 1 e ( d X 1 ( t j ) + e X 2 ( t j ) ) } Δ t   + ( d X 1 ( t j ) + e X 2 ( t j ) ) 2 π k 1 Δ W 1 ( t ) + 2 π k 2 Δ W 2 ( t )   + 1 2 { [ d ( d X 1 ( t j ) + e X 2 ( t j ) ) 2 π k 1 ] ( Δ W 1 ( t ) 2 − Δ t ) + [ e ( d X 1 ( t j ) + e X 2 ( t j ) ) 2 π k 1 ] ( Δ W 2 ( t ) 2 − Δ t ) } (33) 其中 Δ W 1 ( t ) , Δ W 2 ( t ) 服从 N ( 0 , Δ t ) 。模拟结果如图5所示： 图5. 系统(28)的相图示意图 长时间观察之后，我们发现系统的状态变量X 1 集中出现在(−1.2, 2)之间，X 2 集中出现在(−1.5, 1.8)之间。我们令(32)对X 1 和X 2 分别在区间(−1.2, 2)和(−1.5, 1.8)上积分，得其值为0.93。换句话说，根据本文提出的近似算法，我们估计此系统的状态变量X 1 和X 2 分别出现在区间(−1.2, 2)和(−1.5, 1.8)上的概率为0.93。可以看出此结果与图5所示结果具有很高的一致性。  本篇论文主要解决了一类非线性随机微分动力系统转移概率密度函数的求解及其有效性问题。首先我们提出一种近似方法，即假设系统FPK方程的解为指数多项式的形式，运用待定系数法求出多项式的系数，然后就可得到FPK方程的近似解。接着，通过两个具体的案例，我们详细地阐述了求解过程。通过比较广义平稳条件下得出的精确解和该近似解的误差，以及比较用近似解求出的状态变量位于稳态区域的概率和系统离散化后相图展示的结果，我们发现该方法不仅计算简便，而且精度很高，是求解转移概率密度函数的一种有效方法。在求解一般的FPK方程时，本文提出的模拟思路读者可以直接套用。"
