"针对一类线性多延时系统，提出一种基于梯度和最小二乘方法的参数辨识算法。该算法首先将系数矩阵和延时量的联合估计问题转化为仅关于延时量的优化问题，然后基于动量梯度法求出延时量的估计值，最后利用矩阵方程的最小二乘解得出系数矩阵的估计值，仿真结果表明，该算法有较好的辨识效果。"
"随着社会的发展和科技的进步，延时系统在生物、经济和自动化控制等诸多领域日益受到重视 [ 1 ] [ 2 ]。参数辨识是设计、分析与控制实际系统的重要前提 [ 3 ]。 时域方法 [ 4 ] [ 5 ] [ 6 ] 是延时系统参数辨识领域的重要方法。基于梯度的辨识算法近年来受到许多学者的关注。文献 [ 7 ] [ 8 ] [ 9 ] 应用变分方法计算梯度并提出一种参数辨识算法；文献 [ 10 ] 求得了准则函数对参数的梯度所满足的系统，并由此给出了一种辨识算法。 本文受文献 [ 11 ] 启发，研究了一类线性多延时系统的系数和延时量的辨识问题。本文的主要工作是设计了关于系数矩阵和延时量的准则函数，利用最小二乘原理给出了固定延时量时系数矩阵的最小二乘解，从而将系数矩阵和延时量的同时估计问题看作仅关于延时量的估计问题，利用梯度方法求解优化问题得出延时量，最终用估计出的延时量求解矩阵方程求得系数矩阵。"
"考虑以下线性延时系统： { d d t x ( t ) = ∑ i = 0 N     A i x ( t − τ i ) + ∑ i = 0 N     B i u ( t − τ i ) , t ∈ [ 0 , T ] ; x ( t ) = φ ( t ) , − τ ≤ t ≤ 0. (1) 其中 x ( t ) ∈ ℝ n 表示状态向量； u ( t ) ∈ ℝ p 表示控制向量； A i ∈ ℝ n × n ， B i ∈ ℝ n × p , ( i = 0 , 1 , 2 , ⋯ , N ) 是系统的参数矩阵；初始函数 φ ( t ) ∈ ℝ n ；这里假定系统的延时量满足 0 = τ 0 < τ 1 < ⋯ < τ N = τ 。 记 Θ = [ A 0 A 1 ⋯ B N ] ， τ ¯ = [ τ 1 ⋯ τ N ] T 。 定义2.1 设矩阵 Q ∈ ℝ n × m ，称 ‖ Q ‖ F = t r a c e ( Q T Q ) 为Q的Frobenius范数。 命题2.1 设 Q = [ q 1 ⋯ q m ] ∈ ℝ n × m ，则 ‖ Q ‖ F = t r a c e ( [ q 1 ⋯ q n ] T [ q 1 ⋯ q n ] ) = ∑ i = 1 m     q i T q i = ∑ i = 1 m ‖ q i ‖ 2 2 = ‖ [ q 1 T ⋯ q m T ] T ‖ 2 引理2.1 [ 12 ] 若A是列满秩矩阵，B是行满秩矩阵，矩阵 X , F 满足 A X B = F , 那么在最小二乘意义下上式有唯一解 X = ( A T A ) − 1 A T F B T ( B B T ) − 1 。 命题2.2 设矩阵函数 Q ( t ) 可逆且可导，则 d d t Q − 1 ( t ) = − Q − 1 ( t ) d d t Q ( t ) Q − 1 ( t ) 。 命题2.3 设矩阵函数 Q ( t ) ∈ ℝ n × m 可导，则 d d t ‖ Q ( t ) ‖ F 2 = d d t t r ( Q T ( t ) Q ( t ) ) = t r ( d d t ( Q T ( t ) Q ( t ) ) ) = 2 t r ( Q T ( t ) d d t Q ( t ) ) . 本文的目的是通过求解如下的优化问题辨识参数 Θ , τ ¯ ， m i n τ ¯ , Θ J ( τ ¯ , Θ ) = ∑ l = 1 m ‖ x ( t l ) − x ( 0 ) − [ ∑ i = 0 N     A i ∫ 0 t l     x ( t − τ i ) d t + ∑ i = 0 N     B i ∫ 0 t l     u ( t − τ i ) d t ] ‖ 2 2 = ∑ l = 1 m ‖ x ( t l ) − x ( 0 ) − Θ ϕ ( τ ¯ , l ) ‖ 2 2 . (2) 其中 ϕ ( τ ¯ , l ) = [ ∫ 0 t l     x T ( t ) d t ⋯ ∫ 0 t l     x T ( t − τ N ) d t ∫ 0 t l     u T ( t ) d t ⋯ ∫ 0 t l     u T ( t − τ N ) d t ] T . (3)"
"固定延时量 τ ¯ ，式(2)中 Θ 有唯一最小二乘解。从而对优化问题(2)的求解可转化为只与 τ ¯ 有关的优化问题。接下来，利用新目标函数关于 τ ¯ 的梯度采用动量梯度法估计延时量。最后，求系数矩阵关于式(2)的最小二乘解。  定理3.1 对于式(2)所述的优化问题，当 τ ¯ 固定时有唯一最小二乘解 Θ ^ ( τ ¯ ) = X ˜ Φ T ( τ ¯ ) ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 . (4) 其中 X ˜ = [ x ( t 1 ) − x ( 0 ) ⋯ x ( t m ) − x ( 0 ) ] , (5) Φ ( τ ¯ ) = [ ϕ ( τ ¯ ,1 ) ⋯ ϕ ( τ ¯ , m ) ] . (6) 证明。 J ( τ ¯ , Θ ) = ∑ l = 1 m ‖ x ( t l ) − x ( 0 ) − Θ ϕ ( τ ¯ , l ) ‖ 2 2 . 由命题2.1，上式可写为 J ( τ ¯ , Θ ) = ‖ X ˜ − Θ Φ ( τ ¯ ) ‖ F 2 。 由引理2.1上式中 Θ 有唯一最小二乘解。 Θ * = Θ ^ ( τ ¯ ) = X ˜ Φ T ( τ ¯ ) ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 . (7) □ 根据定理3.1可知，优化问题(2)可以转化为 min τ ¯ J * ( τ ¯ ) = min τ ¯ ‖ X ˜ − Θ ^ ( τ ¯ ) Φ ( τ ¯ ) ‖ F 2 . (8) 接下来分三个定理求 ∂ ∂ τ ¯ J * ( τ ¯ ) 。 定理3.2 设 ϕ ( τ ¯ , l ) ∈ ℝ ( N + 1 ) ( n + p ) ，则 ∂ ∂ τ j ϕ ( τ ¯ , l ) = [ O − x ( t l − τ j ) + x ( − τ j ) O − u ( t l − τ j ) + u ( − τ j ) O ] . 证明。 ∂ ∂ τ j ϕ ( τ ¯ , l ) = ∂ ∂ τ j [ ∫ 0 t l     x ( t ) d t ⋮ ∫ 0 t l     x ( t − τ N ) d t ∫ 0 t l     u ( t ) d t ⋮ ∫ 0 t l     u ( t − τ N ) d t ] = [ ∂ ∂ τ j ∫ 0 t l     x ( t ) d t ⋮ ∂ ∂ τ j ∫ 0 t l     x ( t − τ N ) d t ∂ ∂ τ j ∫ 0 t l     u ( t ) d t ⋮ ∂ ∂ τ j ∫ 0 t l     u ( t − τ N ) d t ] = [ O − x ( t l − τ j ) + x ( − τ j ) O − u ( t l − τ j ) + u ( − τ j ) O ] . □ 定理3.3 设 Θ ^ ( τ ¯ ) ∈ ℝ n × ( N + 1 ) ( n + p ) ，则 ∂ ∂ τ j Θ ^ ( τ ¯ ) = X ˜ ( ∂ ∂ τ j Φ ( τ ¯ ) ) T ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1   − X ˜ Φ T ( τ ¯ ) ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 [ ( ∂ ∂ τ j Φ ( τ ¯ ) ) Φ T ( τ ¯ )   + Φ ( τ ¯ ) ∂ ∂ τ j Φ T ( τ ¯ ) ] ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 . 其中 ∂ ∂ τ j Φ ( τ ¯ ) = [ ∂ ∂ τ j ϕ ( τ ¯ ,1 ) ⋯ ∂ ∂ τ j ϕ ( τ ¯ , m ) ] 。 证明。 ∂ ∂ τ j X ˜ Φ T ( τ ¯ ) ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 = X ˜ ( ∂ ∂ τ j Φ T ( τ ¯ ) ) ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1                                                                                   + X ˜ Φ T ( τ ¯ ) ( ∂ ∂ τ j ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 ) , 由命题2.2得 ∂ ∂ τ j ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 = − ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 [ ( ∂ ∂ τ j Φ ( τ ¯ ) ) Φ T ( τ ¯ ) + Φ ( τ ¯ ) ∂ ∂ τ j Φ T ( τ ¯ ) ] ( Φ ( τ ¯ ) Φ T ( τ ¯ ) ) − 1 . □ 定理3.4 式(8)对延时量 τ j 的偏导数如下 ∂ ∂ τ j ‖ X ˜ − Θ ^ ( τ ¯ ) Φ ( τ ¯ ) ‖ F 2 = − 2 t r ( ( X ˜ − Θ ^ ( τ ¯ ) Φ ( τ ¯ ) ) T ( ( ∂ ∂ τ j Θ ^ ( τ ¯ ) ) Φ ( τ ¯ ) + Θ ^ ( τ ¯ ) ( ∂ ∂ τ j Φ ( τ ¯ ) ) ) ) . (9) 证明。 ∂ ∂ τ j ‖ X ˜ − Θ ^ ( τ ¯ ) Φ ( τ ¯ ) ‖ F 2 = 2 t r ( ( X ˜ − Θ ^ ( τ ¯ ) Φ ( τ ¯ ) ) T ∂ ∂ τ j ( X ˜ − Θ ^ ( τ ¯ ) Φ ( τ ¯ ) ) ) = − 2 t r ( ( X ˜ − Θ ^ ( τ ¯ ) Φ ( τ ¯ ) ) T ( ( ∂ ∂ τ j Θ ^ ( τ ¯ ) ) Φ ( τ ¯ ) + Θ ^ ( τ ¯ ) ( ∂ ∂ τ j Φ ( τ ¯ ) ) ) ) . □  本文采用动量梯度法进行联合估计(见算法1)。"
"本节给出两个数值算例来验证结果的有效性 例4.1 考虑不稳定的线性单延时系统(1)，系统参数如下 A 0 = [ − 0.2511 − 0.1511 − 0.3194 − 0.2511 ] , A 1 = [ 0.3682 0.3682 0.1000 0.3682 ] , B 0 = [ 2.2000 0.2000 ] , B 1 = [ 3.1000 1.1000 ] , τ ¯ = [ 0.8 ] , 输入函数为 u ( t ) = 3 sin ( 3 t ) − cos ( t ) ，初始函数为 φ ( t ) = [ 0 0 ] T , T = 5 。 初始点 τ ¯ 0 = 0.7 ，参数 α = 0.7 , β = 0.2 , t l = 1 + 0.02 ( l − 1 ) , l = 1 , ⋯ , 201 。 利用算法1出参数 A 0 = [ − 0.2511 − 0.1505 − 0.3195 − 0.2511 ] , A 1 = [ 0.3684 0.3672 0.1001 0.3682 ] , B 0 = [ 2.2004 0.2000 ] , B 1 = [ 3.0997 1.1000 ] , τ ¯ = 0.8005 . 用算法1估计例4.1中延时量的迭代过程如图1所示。 图1. 延时量估计的迭代过程 例4.2 考虑线性多延时系统(1)，系统参数如下 A 0 = [ − 15.5000 − 15.5000 − 15.0000 − 15.5000 ] , A 1 = [ − 10.4110 − 10.4110 − 1.0000 − 10.4110 ] , A 2 = [ − 5.9110 − 5.9110 − 6.5000 − 5.9110 ] , B 0 = [ 0.5000 1.0000 ] , B 1 = [ 3.1000 1.1000 ] , B 2 = [ 2.2000 0.2000 ] , τ ¯ = [ 0.2 0.8 ] T , 输入函数为 u ( t ) = 10 + sin ( 3 t ) − 5 cos ( t ) ，初始函数为 φ ( t ) = [ 0 0 ] T , T = 10 . 初始点 τ ¯ 0 = [ 0.25 0.85 ] T ，参数 α = 0.9 , β = 20 , t l = 1 + 0.5 ( l − 1 ) , l = 1 , ⋯ , 19 . 利用算法1出参数 A 0 = [ − 15.4998 − 15.4998 − 14.9999 − 15.4999 ] , A 1 = [ − 10.4109 − 10.4109 − 1.0000 − 10.4109 ] , A 2 = [ − 5.9109 − 5.9109 − 5.9109 − 5.9109 ] , B 0 = [ 0.5000 1.0000 ] , B 1 = [ 3.1000 1.1000 ] , B 2 = [ 2.2000 0.2000 ] , τ ¯ = [ 0.2001 0.7998 ] . 用算法1估计例4.2中两个延时量的迭代过程通过等高线图方式呈现如图2所示。将图2中目标函数和迭代过程用三维曲面呈现后如图3所示。 图2. 两个延时量估计的迭代过程 图3. 延时量的迭代过程及目标函数"
"针对线性多延时系统，给出了一种含积分的目标函数。通过最小二乘方法将联合参数的目标函数转化为仅依赖延时量的非线性函数。采用动量梯度方法求解关于延时量的优化问题。确定延时量后求矩阵方程的最小二乘解估计系数矩阵。通过数值仿真验证了算法的有效性。"
