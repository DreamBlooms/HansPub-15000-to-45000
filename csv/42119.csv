"近年来，间断有限元方法在求解双曲型方程中获得广泛应用，与传统有限元和差分方法相比也有许多优势。在本文中，对双曲型的波动方程应用间断有限元分析，通过构造间断有限元的强形式，选择合适的数值通量，与精确解相比得到了较小的误差以及较高的收敛阶，达到了间断有限元的理论收敛阶。"
"近几年，间断有限元方法(DG方法)在诸多领域获得广泛应用。DG方法最早是由Reed和Hill在求解中子输运方程时提出 [ 1 ]，之后其他学者进行了DG方法的误差分析并获得了最优收敛阶。经过数十年的发展，目前已出现了多种DG方法。这些DG方法大致可以分为两大类：基于数值通量形式的DG方法和基于内部罚函数的DG方法。第一类基于数值通量形式的DG方法主要用于求解双曲方程，以Cockburn和Shu提出的求解双曲守恒律方程的Runge-Kutta DG (RK-DG)有限元方法具有代表性 [ 2 ] [ 3 ]。Cockburn和Shu提出了几种常用的数值通量，适用于各种不同情况。在实际应用中，学者可以针对不同的方程构造独特的数值通量以满足实际情况 [ 4 ] [ 5 ]，和其他差分格式相比可以达到更高收敛阶 [ 6 ]，所以应用的更为广泛。"
"以带有初值条件的一维无源声波方程为例，其方程形式如下： { ∂ 2 U ( x , t ) ∂ t 2 − c 2 ∂ 2 U ( x , t ) ∂ x 2 = 0 x ∈ [ L , R ] , t > 0 U ( x , 0 ) = f ( x ) x ∈ [ L , R ] ∂ U ( x , 0 ) ∂ t = g ( x ) x ∈ [ L , R ] 首先对方程进行降阶处理，使其化为满足守恒律的形式。引入位移变量 P = ( x , t ) ，满足如下的关系： c ∂ U ∂ x = ∂ P ∂ t . 将其带入原声波方程中，并进行积分得到满足双曲守恒律的方程组： { ∂ 2 U ∂ t 2 − c ∂ ∂ x ( ∂ P ∂ t ) = 0 c ∂ U ∂ x = ∂ P ∂ t ⇒ { ∂ U ∂ t − c ∂ P ∂ x = 0 ∂ P ∂ t = c ∂ U ∂ x . 为简化方程，引入以下记号：则方程可以写成 ∂ W ∂ t + V ∂ W ∂ x = 0. W = [ U P ]   V = [ 0 − c − c 0 ] 至此，通过引入新的变量将二阶声波方程转化为一阶方程组，并满足守恒律的要求 [ 7 ]。  对一阶方程组 ∂ W ∂ t + V ∂ W ∂ x = 0 进行空间离散。首先将求解区域 Ω = [ L , R ] 划分为K个不重叠的单元 D k = [ x l k , x r k ] 去逼近计算区域 Ω = [ L , R ] ，在单元上选取 N p 个节点。区域划分如图1所示： 图1. 计算区域单元剖分 引进线性映射如下：将每个计算单元变换到区间[−1, 1]上。 x ∈ D k : x ( r ) = x l k + 1 + r 2 h k ,   h k = x r k − x l k . 在求解区域上构建试验函数空间： V h : = { φ h ∈ L 2 ( Ω ) : φ h | K ∈ P k ( K ) } ，在单元上把局部解用 N = N p − 1 阶多项式表示： [ E h k ( x , t ) H h k ( x , t ) ] = ∑ i = 1 N p [ E h k ( x i k , t ) H h k ( x i k , t ) ] φ i k ( x ) 。 构造残量 R h ( x , t ) = ∂ W h ∂ t + V ∂ W h ∂ x ，现要求残量正交于 V h 中所有的试验函数 [ 8 ]，即 ∫ D k R h ( x , t ) φ n ( x ) d x = 0 ,   1 ≤ n ≤ N p . 经过一次分部积分得到DG方法弱形式如下，其中 n ^ 表示局部外法向量，在一维问题中是一个标量。 ∫ D k ( ∂ W h k ∂ t φ n − V W h k d φ n d x ) d x = − [ V W h k φ n ] x i k x r k = − ∫ ∂ D k n ^ ⋅ V W h k φ n d x , 1 ≤ n ≤ N p . 在图1中，如果对试验函数和局部解没有约束条件，在单元界面上就可能会出现多个值 W R k − 1 、 W L k ，必须选择一个合适的解来进行接下来的计算。这就是数值通量的选择，目前先将其记为 ( W h ) * [ 6 ]。 通过再一次分部积分，可以得到DG方法的强形式如下，这是计算常用的形式。 ∫ D k R h ( x , t ) φ n d x = ∫ ∂ D k n ^ ⋅ ( V W h k − ( V W h ) * ) φ n d x , 1 ≤ n ≤ N p . 将残量 R h ( x , t ) 带入上式积分得到： M k d W h k d t + V ⋅ S W h k = [ l k ( x ) ( V W h k − ( V W ) * ) ] x l k x r k . 其中： M i j k = ∫ x l k x r k φ i k ( x ) φ j k ( x ) d x = h k 2 ∫ − 1 1 φ i ( r ) φ j ( r ) d r S i j k = ∫ x l k x r k φ i k ( x ) d φ j k ( x ) d x d x = ∫ − 1 1 φ i ( r ) d φ j ( r ) d r d r . 接下来将局部解的表达式带入，即可得到一阶方程组的DG方法的强形式，如下： d U h k d t + − c J k D r P h k = 1 J k M − 1 [ φ k ( x ) ( ( − c ) H h k − ( − c ) H * ) ] x l k x r k = 1 J k M − 1 ∮ x l k x r k n ^ ⋅ ( ( − c ) H h k − ( − c ) H * ) φ k ( x ) d x . d P h k d t + − c J k D r U h k = 1 J k M − 1 [ φ k ( x ) ( ( − c ) E h k − ( − c ) E * ) ] x l k x r k = 1 J k M − 1 ∮ x l k x r k n ^ ⋅ ( ( − c ) E h k − ( − c ) E * ) φ k ( x ) d x . 其中： J k 为线性映射的Jacobi， D r , ( i , j ) = d φ j d r | r i 。 D r 和 S i j 之间存在如下的计算关系： ( M D r ) ( i , j ) = ∑ n = 1 N p M i n D r , ( n , j ) = ∑ n = 1 N p ∫ − 1 1 φ i ( r ) φ n ( r ) d φ j d r | r n d r = ∫ − 1 1 φ i ( r ) ∑ n = 1 N p d φ j d r | r n φ n ( r ) d r = ∫ − 1 1 φ i ( r ) d φ j ( r ) d r d r = S i j . 至此即完成了DG方法的空间离散。  完成空间域离散后，可以得到半离散问题如下，其中 W h 为未知量。此时问题的求解为常微分方程 [ 9 ]。 d W h d t = L h ( W h , t ) . 经典的基于数值通量的RK-DG方法采用Runge-Kutta进行时间离散，这是一种经典的单步法 [ 7 ]。一般的高阶Runge-Kutta时间离散格式表达式如下 [ 10 ]： { u ( 0 ) = W ( n ) u ( i ) = ∑ l = 0 i − 1 [ α i l u ( l ) + β i l Δ t L ( u ( l ) ) ] i = 1 , ⋯ , r W ( n + 1 ) = u ( r ) 其中当 r ≤ 4 时，上述时间离散格式的精度是 r 阶。在这里选取变形的四阶显式RK方法(ERK)：其基本形式如下，相关系数可查阅文献 [ 5 ] 得到。 p ( 0 ) = W n { k ( i ) = a i k ( i − 1 ) + Δ t L h ( p ( i − 1 ) , t n + c i Δ t ) , i ∈ [ 1 , ⋯ , 5 ] p ( i ) = p ( i − 1 ) + b i k ( i ) W n + 1 = p ( 5 )"
"在本节将介绍计算过程中选取的基函数、数值积分计算以及数值通量选择选择等。  如果考虑基函数 φ n ( r ) = r n − 1 ，在计算过程中需要计算单元质量矩阵 M i j ，随着多项式次数的增加，得到的质量矩阵条件数很差，因为 M i j = ( φ i , φ j ) I = ∫ − 1 1 φ i φ j d x = 1 i + j − 1 [ 1 + ( − 1 ) i + j ] . 一个稳妥的办法是选择一组规范正交基来计算，可以通过对基函数进行Gram-Schmidt直交化来实现。其计算形式如下： P n ( r ) 为传统的n阶Lengendre多项式。由此基函数得到的质量矩阵要优于简单基函数。 φ n ( r ) = P ˜ n − 1 ( r ) = P n − 1 ( r ) γ n − 1 其 中 γ n = 2 2 n + 1 .  从DG方法的强形式可以看出，计算中需要大量的积分运算。如果使用精确积分，会导致巨大的计算量，因此可以考虑使用数值积分进行计算，同时计算格式要满足精度要求。根据已有经验来看，对于K次多项式积分运算，单元内部的积分应该使用精度至少为2K次的数值积分格式，对于单元边界上的积分，应使用精度至少为2K + 1次的格式。 目前使用较为广泛的是采用Legendre-Gauss-Lobatto (LGL)积分点进行积分 [ 11 ]。该积分点与等距节点积分和Gauss积分不同，等距积分形成的矩阵随着多项式次数的增加会出现列几乎线性相关的情况，不利于计算。Gauss积分通过张量积形式形成高维情形时，节点会集中在积分区域内部。而LGL积分点可以通过其他方法避免这些情况。查阅相关文献可以得到LGL积分点的计算方法，得到积分点与积分权重。  关于数值通量的选择，首选具有相容性、守恒性、单调性的数值通量。此种类型的数值通量最初来自于求解双曲守恒律方程的高分辨率格式的构造上，它不仅具有高精度，而且还能保持数值格式的稳定性和收敛性，具有很好的数学性质 [ 4 ] [ 5 ]。 首先定义单元边界处的平均值 { { u } } 以及沿法向的跳跃 [ [ u ] ] 如下，其中 u − 表示单元内部极限值， u + 表示单元外部极限值。 { { u } } = u − + u + 2 ,   [ [ u ] ] = n ^ − u − + n ^ + u + . 目前常用的满足如上性质的数值通量函数有： ( u ) * = { { u } } + 1 − α 2 [ [ u ] ] ,   0 ≤ α ≤ 1 ， α = 1 代表中心通量， α = 0 代表迎风通量。 Lax-Friedrichs通量： ( u ) * = { { u } } + C 2 ( u + − u − ) ，其中C与计算区域的情况有关。 目前，在声波方程的计算中比较常用的是Lax-Friedrichs通量，其计算公式相对简单，但不会影响计算的精度。  为了保持数值算法的稳定性，空间、时间步长需要满足一定的关系式，对该方法进行冯·诺伊曼稳定性分析，以便知道数值 CFL L 2 的值是什么。 由条件 | c | Δ t Δ x ≤ CFL L 2 确保其 L 2 稳定性，因为只有在这种条件下，舍入误差才不会被放大 [ 5 ]。 例如，对于使用k次多项式和k + 1阶达到k + 1次的RK方法(k + 1阶精度)的DG离散，实际中可以采取 C F L L 2 = 1 2 k + 1 。此外，对于 k ≥ 2 ，数值 1 2 k + 1 比 CFL L 2 数值估算值小5% [ 5 ]。故在本文中时间步长满足 Δ t ≤ CFL L 2 C min k , i Δ x i k ，其中空间步长为 Δ x i k = x i + 1 k − x i k ，C为传播中最大速度。"
"本节将通过两个例子来验证DG方法的计算效果。  先来看一个一阶简单线性波动方程，该方程具有初值，形式如下： { ∂ u ∂ t + 2 π ∂ u ∂ x = 0   x ∈ [ − 2 π , 2 π ] , t > 0 u ( x , 0 ) = cos ( − x ) x ∈ [ − 2 π , 2 π ] u ( − 2 π , t ) = cos ( 2 π t ) t ≥ 0 . 该问题的精确解为 u ( x , t ) = cos ( − x + 2 π t ) 。对于单个方程，其DG方法要比方程组更简单，这里便不再重复。图2为一阶波方程DG方法数值解与精确解的比较，其中单元基函数选取为4阶，区域剖分为4段(a)、8段(b)和16段(c)，数值通量选为中心通量，最终时间为 t = 1.5 ，可以看出计算结果误差较小。 图2. 一阶波动方程数值解与精确解的比较 同时我们还计算了在不同单元个数K和多项式阶数N情况下的 L 2 误差以及收敛阶，从表1中可以看出：随着单元剖分个数的增加和多项式阶数的提高，收敛阶始终趋于 N + 1 阶 [ 12 ]。 Table 1 N K K = 8 K = 16 K = 32 K = 64 收敛阶 N = 2 4.16E−01 3.81E−02 5.30E−03 5.24E−04 3.0 N = 3 3.74E−02 2.10E−03 1.25E−04 6.05E−06 4.0 N = 4 4.20E−03 8.44E−05 2.42E−06 8.61E−08 5.0 N = 6 1.53E−06 9.05E−07 6.05E−09 4.66E−11 7.0 表1. 数值解的误差与收敛阶  对于二阶波动方程，带有初值条件如下：其中选取波速 c = − 1 ，计算区间为 [ − 10 , 10 ] 。 { ∂ 2 U ( x , t ) ∂ t 2 − c 2 ∂ 2 U ( x , t ) ∂ x 2 = 0 x ∈ [ − 10 , 10 ] , t > 0 U ( x , 0 ) = sin ( x ) x ∈ [ − 10 , 10 ] ∂ U ( x , 0 ) ∂ t = c sin ( x ) x ∈ [ − 10 , 10 ] . 在实际计算中，选取3阶基函数进行插值，数值通量选为Lax-Friedrichs通量，最终计算时间为 t = 1 。结果如图3：其中a为计算空间10等分，b为计算空间20等分，c为计算空间30等分。 图3. 二阶波动方程数值解与精确解的比较 对其进行误差分析和收敛阶计算，即使用N阶多项式模拟时，随着剖分单元数的增加，收敛阶逐渐趋向于 N + 1 阶。"
"在本文中，通过对二阶无源波动方程空间域进行间断有限元离散，在时间上采用经典的Rutta-Kutta方法进行离散，得到了较高的收敛阶，这和DG方法的理论分析是一致的。在计算过程中，选取经Gram-Schmidt直交化的Lengendre多项式作为基函数，避免了随着多项式阶数的提高质量矩阵条件数变坏的情况。数值积分选取LGL积分点和权重，避免了等距积分形成行列式线性相关的情况，时间离散上采用采用经典的Rutta-Kutta单步法四阶变形形式，减少了计算中的存储用量。最后通过两个实例分析验证了间断有限元方法可以获得更高的收敛阶，并且提高多项式的阶数要比传统有限元更方便，在未来会获得更广泛的应用。"
