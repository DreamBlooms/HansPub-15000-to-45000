"为了提高PSCAD电磁暂态模型的建立效率，本文提出了将PSASP机电暂态数据文件自动转换为PSCAD电磁暂态模型的方法。首先详细分析了两种软件中关键模型的差异，针对发电机控制系统模型的不对应问题，在PSCAD中采用隐士梯形积分法建立了自定义模型并对比验证了模型的有效性。然后基于自定义建立的模型库给出了模型自动转换的方法：先读取基础元件参数和拓扑信息，按照不同方案名将数据分组，将元件以变电站或发电厂为模块对网络进行模块化，采用基于力导向的图形可视化布局方法实现模型的自动布局和拓扑连接。最后通过工程实际应用验证了转换方法的准确性和实用性。 关键词 :PSASP，模型转换，自定义建模，电磁暂态仿真，PSCAD，自动布局 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着特高压直流输电和新能源的大力发展，越来越多的电力电子器件投入到电能的变换和控制中 [ 1 ][ 2 ]。由于直流控制的开关设备和电力电子器件响应速度极快，常用的机电暂态仿真软件采用基波、相量、序网分析模式难以模拟HVDC等电力电子装置的快速暂态特性和非线性特性 [ 3 ][ 4 ]。电磁暂态仿真程序以微小的步长进行计算，能够模拟包含大量电力电子设备的交直流混合输电、柔性交流输电等非线性系统，也能够模拟电磁暂态故障的发展过程，因此在交直流混合系统仿真分析中发挥着举足轻重的作用。 我国广泛使用的机电暂态仿真软件主要有BPA、PSS/E和中国电力科学研究院自主研发的PSASP [ 5 ]，实际电网的仿真数据都是按照不同的文本格式储存在这三种软件中。PSASP软件是我国自主研发的广泛使用的软件，软件中储存了现有电网的模型和数据，但是无法满足电磁暂态仿真、机电–电磁混合仿真的需求。在进行PSCAD电磁暂态仿真建模时通常需要根据机电暂态数据手动搭建模型，输入元件参数。对于交直流互联大电网系统，网络连接复杂，支路和元件数量庞大，手动建模处理数据的工作量大，准确率不高。因此需要研究将PSAPS机电暂态数据自动转换为PSCAD电磁暂态数据的方法和程序。 现有的研究主要针对于将PSS/E、BPA的机电暂态数据自动转换为PSCAD的电磁暂态数据 [ 6 ][ 7 ][ 8 ][ 9 ]。对于PSASP到PSCAD数据转换方面只是进行了部分的可行性和探索性的研究工作 [ 10 ]，没有进行实际的验证工作。目前的PSCAD和其他电磁暂态仿真软件也没有相互的数据转换功能。同时现有的转换方法采用分区式或者基于地理位置的布局方式，模型生成的布局方式不够灵活，给使用造成了困难 [ 11 ][ 12 ]。本文详细分析对比了PSASP与PSCAD在关键模型上的差异，针对其中差异很大的发电机控制系统模型采用隐士梯形积分法进行自定义建模，提出了模型自动转换和自动布局的流程和方法，并通过算例仿真和工程实际应用验证了转换方法的准确性和实用性。"
"PSASP7.1程序和PSCAD都提供了丰富的仿真模型，但模型的结构和数据的储存方式存在较大的差异，模型的准确性对仿真精度影响巨大，因此在实施数据的转化时必须对两者的关键模型进行对比分析。  PSASP给用户提供了7种同步发电机模型，同时兼容了BPA的6中同步机模型。PSCAD提供了可用作凸极机也可用作隐极机的同步电机模型，模型考虑了定子磁链衰减的过程，其结构和参数与PSASP中的模型一致。因此只需要简单的参数设置就可以直接进行参数的转换。  发电机控制系统模型包括励磁器模型(AVR)、原动机调速器模型(GOV)、电力系统稳定器模型(PSS)，PSASP中提供了1~15种励磁器调节器模型，7种类型的调速器模型，5种PSS模型。PSCAD中也提供了大量的调节器模型，但是二者的传递函数差别很大 [ 13 ]。同时PSASP中的发电机控制系统参数都经过实测，如果在模型转换时直接调用PSCAD中模型或者对传递函数进行处理简化后的模型，会严重影响仿真的精度。另外一方面，采用PSCAD中的控制元件搭建模型会给模型的自动转换带来困难。采用自定义建模的方法可以建立起发电机控制系统模型，从而使得模型完全对应。  PSASP中通常采用的是静态负荷和感应电动机负载，静态负荷的多项式如下： { P = P 0 [ A p ( V V 0 2 ) N p + B p ( V V 0 ) + C p ] ( ω ω 0 ) F p Q = Q 0 [ A q ( V V 0 2 ) N q + B q ( V V 0 ) + C q ] ( ω ω 0 ) F q (1) 式中 A p 、 B p 、 C p 均为有功–电压静态特性参数； A q 、 B q 、 C p 均为无功–电压静态特性参数； F p 、 F q 分别为有功频率指数和无功频率指数， N p 、 N q 分别为有功电压指数和无功电压指数。PSCAD中的静态负荷可表示为描述为： { P = P 0 ( V V 0 ) N p ( 1 + K p Δ f ) Q = Q 0 ( V V 0 ) N q ( 1 + K q Δ f ) (2) 式中 K p 、 K q 分别为有功、无功频率指数。采用恒功率负荷、恒阻抗负荷、恒电流负荷以及感应电动机的组合，通过取不同的比例系数就可以和PSASP中完全对应。组合负荷模型如下图1。  PSCAD模型库中提供了三种输电线路模型：PI型线路模型、Bergeron模型、频率相关模型。PI型线路模型采用集中RLC线路模型，Bergeron模型是基于分布LC参数和行波的线路模型，能够准确的模拟电磁暂态过程。频率相关模型是基于分布参数和行波理论的模型，使用时需要输入杆塔的详细信息。PSASP中使用的是集中参数PI型线路模型，不能精确模拟长距离输电线路的电磁暂态响应过程。当仿真步长为50 μs时，输电线路长度大于15 kM就应使用Bergeron模型。本文的转换程序在自动转换时提供PI型线路模型、Bergeron模型的交互式选择，转换时可以根据实际仿真需求。 图1. 组合负荷模型图"
"针对PSASP与PSCAD差异较大的发电机控制系统模型 [ 14 ]，根据PSASP软件中的传递函数在PSCAD软件中自定义建立起对应的模型。采用稳定性较高的隐士梯形积分法求解传递函数的微分方程 [ 15 ]自定义建模时，通常将系统传递函数按照相应的物理环节分解为多个一阶环节，并确定含有状态变量环节的状态变量。以常见的超前滞后环节为例进行说明，其传递函数框图见图2。 其时域微分方程为： { d x ' ( t ) d t = d x ' ' ( t ) d t = − 1 T x ' ( t ) + 1 T x ( t ) y ( t ) = x ' ' ( t ) + T 1 T 2 [ x ( t ) − x ' ( t ) ] (3) 隐士梯形积分求解方程(3)可得： { x ' ( t ) = ( 1 − Δ t 2 T 2 ) x ' ( t − Δ t ) + K Δ t 2 T 2 [ x ( t − Δ t ) + x ( t ) ] 1 + Δ t 2 T 2     y ( t ) = x ' ' ( t ) + T 1 T 2 [ x ( t ) − x ' ( t ) ] (4) 式中 Δ t 为积分步长，也是PSCAD中的仿真步长。 根据PSCAD官方模型库中AC4A型励磁调节器的传递函数，按照上述方法完成变换求解和状态变量初始化，在PSCAD中新建用户自定义模型，设置状态变量和输入常量，采用Fortran编写控制程序。图3是AC4A的传递函数框图，图4是自定义建立的AC4A型励磁器模型。 将自定义建立的AC4A模型和官方的模型分别加载到同步发电机上运行并施加扰动，进行暂态稳定和稳态输出的验证。验证电路模型见图5。 发电机的额定线电压有效值为7.967 kV，额定线电流有效值为5.02 kA，仿真步长50 μs，扰动出现在仿真开始后1 s，仿真时间为10 s。两种励磁调节器模型下的发电机输出量对比如下图6。 图2. 超前滞后环节的等效变换 图3. AC4A型励磁器模型 图4. 自定义AC4A型励磁器模型 图5. 励磁系统模型验证电路 图6. AC4A型励磁作用下电路电气参数波形。(a) 有功功率(MW)；(b) 无功功率(Mvar)；(c) 励磁电流(pu)；(d) 励磁电压(pu)；(e) 输出端电压(kV) 从以上电气参数的对比可以看出，自定义模型的动态调节速度快，运行稳定性好，准确度高。按照上述方法，在PSCAD中根据PSASP中模型的传递函数自定义建立了常用的1~13型励磁调节器模型、1~4型PSS模型、1~7类调速器模型，构成了自定义模型库，在模型自动转换时可以快速调用。  PSASP中的网络数据主要包括静态元件参数库和动态元件参数库，静态元件参数包括了元件所述数据组、编号、拓扑连接、支路参数信息。动态元件参数包括了发电机及其控制系统的型号、参数组等具体信息。自动生成电磁暂态模型的流程为：获取元件参数和拓扑信息，数据分组和元件模块化，自动布局和拓扑连接，生成PSC文件。  1) 参数的转换 PSASP的静态元件参数和动态元件参数分别为.myd格式的cdb和cpar数据表，cdb表中包括了发电机、母线、变压器、交流线等元件所属数据组、所属分区、拓扑信息和基本参数，cpar表中包含了发电机控制系统、负荷等动态元件的参数组号和基本参数。利用C#编程语言提取mysql数据库中的有效参数，首先将数据按方案名进行划分，其次将方案名中的数据按照数据组进行划分，转换时可以自由选择所需转换的方案和数据组。根据PSASP和PSCAD中模型的对应关系，将这些参数等值换算，尤其是元件参数的标幺值换算。 对于发电机控制系统参数，根据数据表cdb_generat获取同步机的模型号、同步机参数组、调压器模型、调压器参数组、调速器参数组、PSS和PSS参数组，然后根据模型号和参数组号在cdb_*_lib参数表中提取对应动态元件的参数，将这些参数和发电机参数等值换算后按顺序一起暂存。 2) 元件的模块化 PSCAD软件以图形化的形式展示模型，自动生成模型时需要考虑元件的布局和拓扑连接。在搭建不同规模的仿真模型时，需要一个灵活合理的布局方式。本文采用双层布局的方法，根据PSASP中获取的元件关联拓扑信息，以母线所属变电站或者发电站为模块，将母线及其连接的元件全部封装到模块中。用不同大小的同心圆环表示不同电压等级的变电站。在站点模块内部，将同步发电机、励磁器、调速器封装成电源模块，发电机的输出通过Xnode与外部母线相连。在PSCAD中可以复制和移动整个站点模块，方便仿真的后续处理。图7为发电机模块封装图。  本文的模型自动布局方法包括两部分：模块的布局采用基于力导向的可视化布局方法，模块之间采用Bergeron或PI型线路连接；模块内部布局采用网格化确定坐标方法，实现元件的拓扑连接。 1) 力导向布局法 基于力导向模型FDM (Force Directed Model)的布局方法可以自动、高效而美观地展现网络图形，帮助人们直观了解网络拓扑结构、链接关系、聚集特征等情况 [ 16 ][ 17 ]。将站点模块抽象为一个粒子，把连接模块的交流线视为连接粒子的边。设定为每个粒子均带同种电荷，由于库仑力的存在，粒子两两之间互相排斥。斥力计算式如下： F r e p e l i n g = K q 1 q 2 R 2 (5) F r e p e l i n g 是两个粒子所受的斥力， q 1 、 q 2 为两个粒子的质量； K 是斥力常量，以此调整全局的粒子之间的斥力，一般取值为−1。与此同时，某些粒子被一些能够产生类似弹簧胡克引力的“边”牵引着，“边”两端的粒子被紧紧牵连着。弹簧的引力计算如下式： F e l a c t i c = H ( l c u r r e n t − l n a t u r e ) (6) F e l a s t i c 是两个相连的粒子所受的弹簧力， H 是弹簧力的弹性系数， l c u r r e n t 是两个粒子当前的笛卡尔距离； l n a t u r e 是弹簧的自然长度，即两粒子的期望距离。在这些斥力与引力的不断作用下，初始时刻随机分布的粒子开始不断改变自己的位置，同时粒子所携带的能量也在不断消耗着，经过数次迭代计算过程，整个系统中的粒子的位置不再发生变化，系统中的能量达到最小，系统达到一种接近平衡的稳定状态。根据弹性势能，采用以下能量计算模型： E = ∑ i = 1 n 0.5 H i ( l i − l i n a t u r e ) 2 (7) 式中 E 表示弹性势能总和； l i 表示第 i 条边在当前布局中的笛卡尔长度； l i n a t u r e 表示第 i 条边所预设的自然长度； H i 表示第 i 条弹簧的弹性系数。能量达到最小值时，布局的结果越好，此时获取模块和交流线的坐标信息。 在布局的可视化界面可以选择需要转换的模块，在提取模块包含的数据时，根据模块的拓扑信息自动提取出与之有拓扑连接关系的邻近模块。同时可视化的交互布局界面可以在布局过程中调整模块的位置(图8，图9)。 2) 模块内部的布局 同一站点模块内，同电压等级母线如果通过短线开关电气连接，则合并为一条母线；当同等级电压母线未连接，则采用分段母线形式存在于同一侧，因此母线布局以站点内部画布中间为起点，考虑上下左右四个方向。当有2条不同电压等级母线时，实现左高右低的母线排布；当有3条不同电压等级母线时，按照高中低从左下右排列；当有4条及以上不同电压等级时，按照高、中、低、次低从左、下、右、右依次排列。检索出与母线相连接的元件，根据元件占空间的大小，分别确定每个元件的坐标，再计算导线的长度和方向，实现元件与母线的拓扑连接。图10表示转换后的变电站的内部布局图。上述10个站点总的转换和布局时间不超过30 s。 综上，基于自定义建立的模型库和PSASP软件的电力系统仿真数据，PSASP到PSCAD的转换步骤如下图11。 图7. 发电机模块封装图 图8. 可视化自动布局界面 图9. 自动布局结果 图10. 变电站内部布局 图11. PSASP到PSCAD的模型转换流程"
"本文将自动转换程序用于云阳变电站的故障分析中，对模型转换的准确性进行验证。云阳变电站在一次电压调整中，拉开电抗器978开关的同时，10 kV III母线单相接地动作发出，10 kV #2站用变968开关动作跳闸。现场检查发现10 kV #2站变本体高压侧A、B相连接线断裂，10 kV III母线A相避雷器动作。#2站变压器968开关的电流速断保护动作，电流最大值176 A，CT流比100/5。 整个故障过程是一个快速的电磁暂态过程，故障分析需要重点研究区域为云阳变电站及其相连的万县、聚宝、盖下坝三个站点。三个站点之间的输电线路最长为60 kM，因此输电线路模型选择为PI型模型。 将转换后的模型在PSCAD中进行稳态运行，计算的潮流数据与PSASP中计算的潮流数据最大误差在1.3%；与现场录波的潮流数据相比，最大误差为1.71%，验证了稳态的准确性。表1为云阳站出线的有功功率，表2为云阳站出线的电压。 根据故障相线路的电压、电流的录波波形和保护动作的记录，可以推测出故障的发展过程如下图12。 基于模型转换的结果，结合现场的实际操作，采用PSCAD对故障过程进行仿真模拟，图13为变电站故障期间10 kV III母线三相电压、电流的录波波形，图14分别为基于模型转换结果对故障进行仿真的10 kV III母线三相电压、电流波形图。 经过分析对比两组波形图可以看出，故障期间电压、电流的变化基本一致。因此通过转换软件自动转换得到的模型，能够对动态故障进行很好的仿真模拟，故转换结果的动态特性得到了验证。 Table 1 出线名 电压等级(kV) 有功(MW) 录波值 仿真值 误差(%) 万云南 220 9.11 9.20 0.99 万云北 220 12.86 12.68 1.40 云聚线 220 10.72 10.79 0.65 云新东 110 0.64 0.64 0 云新西 110 0.64 0.64 0 云江西 110 9.95 9.78 1.71 云江东 110 14.83 14.81 0.13 云薛西 110 3.23 3.21 0.62 云薛东 110 3.23 3.21 0.62 表1. 云阳站出线有功功率 Table 2 出线名 电压等级(kV) 电压(kV) 录波值 仿真值 误差(%) 万云南 220 231.3 231.7 0.17 万云北 220 231.3 231.7 0.17 云聚线 220 231.3 231.7 0.17 云新东 110 113.4 113.8 0.35 云新西 110 113.4 113.8 0.35 云江西 110 113.4 113.8 0.35 云江东 110 113.4 113.8 0.35 云薛西 110 113.4 113.8 0.35 云薛东 110 113.4 113.8 0.35 表2. 云阳站出线电压数据 图12. 云阳站故障演变过程推断 图13. 故障期间10 kV III母线各相电压录波波形 图14. 基于转换结果10 kV III母线各相电压仿真波形"
"本文对比了机电暂态仿真程序PSASP和电磁暂态仿真软件PSCAD的模型，在PSCAD中自定义建立了发电机控制系统模型，并基于自定义模型库提出了一种将PSASP数据自动转换为PSCAD模型的方法，采用图形可视化的力导向布局方法实现了模型的自动生成。生成重庆电网全部的电磁暂态仿真模型只需要3分钟。通过实际变电站工程应用对模型转换前后的拓扑结构、潮流分布和动态特性的正确性和实用性进行了验证，为电磁暂态快速仿真建模提供了参考。后续需进一步完善自定义模型库，充分考虑风电、光伏发电等新能源电磁暂态仿真模型，为交直流互联系统快速仿真建模提供丰富的模型库。"
