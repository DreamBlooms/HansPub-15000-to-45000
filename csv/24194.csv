"通过仿真光子灯笼中存在模式的相干叠加过程，利用模式耦合理论和M 2 因子的二阶矩算法，得到了输出光斑形态、耦合效率和光束质量随模式间相位差、功率占比以及偏振的变化规律，分析了对光子灯笼进行控制时需要考虑的因素。研究表明，只有同时控制光子灯笼输入端各模式的功率占比和相位差，才能得到耦合效率较高的高光束质量的输出；通过对输入端振幅、相位和偏振的合理控制可以得到需要的特殊的光斑形态。 关键词 :光子灯笼，模式耦合与控制，光束质量 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"光子灯笼是一种全光纤结构的线性光学器件，由多根单模光纤经拉锥而成 [ 1 ] [ 2 ] ，光子灯笼最早应用在天文学光谱滤波和空分复用(SDM)领域。目前人们将光子灯笼应用于光纤横模(模式)的自适应空间控制中 [ 3 ] ，并表现出了其独特优势。基于光子灯笼模式自适应控制，实现了对高功率光纤激光的模式不稳定(TMI)的控制，实验结果显示光子灯笼模式自适应控制可以大大提高TMI的阈值 [ 4 ] 。模式的自适应控制，在激光应用具有重要应用，比如：激光切割技术中有时需要环形光束进行钻孔 [ 5 ] ；基于空分复用的光通信系统需要利用高阶模式以提高通信容量 [ 6 ] ；对于高功率激光器，希望得到接近衍射极限的基模光束 [ 7 ] 等。 用于模式控制的光子灯笼，与最早用于天文光谱测量中的光子灯笼在结构上不同，如图1所示。用于模式控制的光子灯笼其形状与合束器类似，但光子灯笼的拉制要求更高，除了满足绝热近似要求外，还对输出模式与合束输入端单模光纤数以及排布有严格要求 [ 6 ] 。光子灯笼的输入端单模光纤的输入光初始相位、振幅等参量，对光束在光子灯笼中的演化和输出模式产生严重影响。为了分析光子灯笼中输入各通道的功率占比(振幅)、相位和偏振，对输出的耦合效率和光束质量的影响，本文中第二节将介绍光子灯笼中的结构与模式关系、模式相干叠加的一般理论、光束质量M 2 的理论计算方法。第三节主要通过数值计算，分析输出光斑形态、耦合效率和光束质量随模式间相位差、功率占比以及偏振的变化规律，并分析输入端振幅、相位和偏振对光子灯笼模式控制的影响。"
"为了使光子灯笼能对输出模式进行控制，光子灯笼的拉制在满足绝热条件的同时，其输入端单模光纤数与输出端结构的等效V数有一定的要求，这是由于多模光纤中V数与光纤中可以存在的模式数有一定的对应关系。因此光子灯笼中输出端由等效V数所确定的可以存在的模式数与输入端单模光纤数必须相等 [ 1 ] [ 7 ] [ 8 ] ，图2从物理图像上表示了这种关联，例如当等效V数大于3.83而小于5.13时(图中第三行)，对应输出端可以存在的6个模式(图中第二行)，则输入端单模光纤数应为6路，且其排布也有要求，以降低损耗 [ 6 ] ，如图中第一行所示。因此，光子灯笼在制作过程中，输入端的单模光纤数、以及几何排布必须满足一定规则，如图2所示。  由于光子灯笼中存在的 L P m n 模具有正交性、叠加性，当相干光注入系统时，在光纤不太长或经过光 图1. (a) 光纤模式控制中的光子灯笼，(b) 天文测量中光学滤波光子灯笼。 图2. (a) 耦合波导阵列。(b) 阶跃光纤前十五个空间模式。(c) 归一化频率V 程补偿的条件下，这些 L P m n 模式是相干的，此时输出光场可写为 [ 9 ] ： E ( r , ϕ ) = { ∑ m , n η m n P m n J m ( U m n r / a ) J m ( U m n ) cos ( m ϕ ) e i ψ m n ,   0 ≤ r ≤ a ∑ m , n η m n P m n K m ( W m n r / a ) K m ( W m n ) cos ( m ϕ ) e i ψ m n ,   a ≤ r ≤ b (1) 其中 η m n 是在相干叠加过程中 L P m n 模式的功率占比，在实际系统中，受到环境的影响，输入振幅会发生随机变化，进而引起 η m n 的变化，当然，也可以通过外加的控制对各通道输入的振幅进行调节。 ψ m n 是 L P m n 模式的相位，由三部分构成，即 ψ m n = ψ l + ψ n + ψ m ， ψ l 为 L P m n 模式在传输过程中产生的相位，可由 ψ l = β m n ⋅ l 计算得来(其中 β m n 为 L P m n 模式的传播常数，l为 L P m n 模式的传播距离)； ψ n 为 L P m n 模式的随机相位变化； ψ m 为控制系统外加的相位。另外，考虑到一些 L P m n 模式存在两个偏振态，故偏振也可能是影响叠加光场的因素之一。 在光子灯笼各通道进行耦合时，振幅和相位对耦合效率的影响如下 [ 3 ] ： η = 1 N | ∑ m = 1 N P m e j θ m | 2 ∑ m = 1 N P m (2) 其中， P m 是光子灯笼第m通道的功率，在小振幅误差条件下，耦合损耗 ( 1 − η ) 与 ( σ p 2 ) / P 2 成正比，其中P为每个通道的标称功率， σ p 为输入通道功率的标准差；相似地，随机相位变化( ψ n )对耦合损耗的影响也满足 ( 1 − η ) ~ σ θ 2 。 2.3. 光束质量M 2 的理论计算方法 M 2 因子是一种应用广泛且被大家所接受的光束质量评判参数 [ 9 ] ，能够反映光束在传输过程中的质量特性 [ 10 ] 。20世纪90年代初，A.E.Siegman引入空间频率和强度矩的概念，总结出基于二阶强度矩的M 2 因子计算方法。以 x 方向为例，设一光束的光场用 E ( x ) 表示，则其对应的空间频谱为 E ^ ( s ) ，则该光束的M 2 因子可表示为： M x 2 = 4 π σ x σ s (3) 其中二阶强度矩σ x 和σ s 分别为： σ x 2 = ∫ − ∞ + ∞ ( x − x ¯ ) 2 I ( x ) d x ∫ − ∞ + ∞ I ( x ) d x ,     σ s 2 = ∫ − ∞ + ∞ ( s − s ¯ ) 2 I ^ ( s ) d s ∫ − ∞ + ∞ I ^ ( s ) d s (4) 而 x ¯ 和 s ¯ 分别为空间和频域的重心： x ¯ = ∫ − ∞ + ∞ x I ( x ) d x ∫ − ∞ + ∞ I ( x ) d x ,     s ¯ = ∫ − ∞ + ∞ s I ^ ( s ) d s ∫ − ∞ + ∞ I ^ ( s ) d s (5) 根据式(3)可以数值计算输出光束的 M x 2 和 M y 2 ，实现对光束质量的评价，并为后续控制算法的评价函数提供依据。"
"从两个 L P m n 模式的相干叠加数值计算入手，得到输出光斑形态、耦合效率和光束质量随模式间相位差、功率占比以及偏振的变化规律。 以 L P 01 模式和 L P 11 模式的相干叠加为例，根据式(1)可知， L P 01 模式和 L P 11 模式(暂不考虑偏振)相干叠加的光场表达式为： E = { η P 01 J 0 ( U 01 r / a ) J 0 ( U 01 ) + 1 − η P 11 J 1 ( U 11 r / a ) J 1 ( U 11 ) cos ( ϕ ) e − i Δ φ ,   0 ≤ r ≤ a η P 01 K 0 ( W 01 r / a ) K 0 ( W 01 ) + 1 − η P 11 K 1 ( W 11 r / a ) K 1 ( W 11 ) cos ( ϕ ) e − i Δ φ ,   a ≤ r ≤ b (6)  假设两模式耦合时， L P 01 模式和 L P 11 模式的功率占比和偏振状态固定，而两模式间的相位差 Δ φ 从小到大变化(这里只考虑确定的相位差，而不考虑随机抖动的相位变化)。例如：当 L P 01 模式和 L P 11 模式的功率占比为4:1保持不变，且 L P 11 模式只考虑一个偏振态时，可以得到叠加结果随 Δ φ 的变化，如图3所示。 图3. L P 01 模式和 L P 11 模式相干叠加时，随着 Δ φ 的增加：(a) 近场和远场的光斑图像，(b) Δ φ -耦合效率曲线图，(c) Δ φ - M x 2 曲线图 可见，耦合效率和M 2 因子随相位差 Δ φ 的变化是周期性的，且周期为π。特别地，当高阶模成分比较低时，可以通过控制 Δ φ ，很好的的提高光束质量。  考虑功率占比h对叠加结果的影响：假设两模式耦合时， L P 01 模式和 L P 11 模式的相位差和偏振固定，而两模式的功率占比变化。比如：当 L P 01 模式和 L P 11 模式的相位差为0， L P 11 模式只考虑一个偏振态时，可以得到叠加结果随h的变化(如图4所示)。 可以看到， Δ φ ≠ π 且 Δ φ ≠ 0 时，耦合效率随 η ( L P 01 ) 的增加而降低。同时， 也随 η ( L P 01 ) 的增加而降低，且类似抛物线型，说明随着高阶模成分的增加，光束质量越差。  将上述参与耦合的单偏振的 L P 11 模式更替为两个偏振态 L P 11 模式的组合，通过数值计算发现： L P 11 o 模式和 L P 11 e 模式的占比不同时，得到的光斑形态不同，但与 模式耦合后的效率以及M 2 因子的数值并没有改变。 综上，在两个 L P m n 模式相干叠加时：相位差对耦合效率和M 2 因子的影响是周期性的；高阶模功率占比提升会使光束质量迅速下降；偏振会改变相干叠加的光斑形态而不影响光束质量；M 2 因子相同的输出可能对应着不同相位和功率占比的组合。 图4. L P 01 模式和 L P 11 模式相干叠加时，随着h的增加：(a) 近场和远场的光斑图像，(b) h-耦合效率曲线图，(c) η - M x 2 曲线图  上一节展示了振幅、相位、偏振对叠加结果不同程度的影响。结合2.1中的理论，以及三通道和六通道光子灯笼实际参数，进行仿真计算，得到光子灯笼单模输入端的振幅、相位和偏振对输出端模式控制的影响。 三通道光子灯笼是由三根单模光纤拉制而成，其输出模式为 L P 01 、 L P 11 o 和 L P 11 e 三个模式，如图2所示。由于三根输入单模光纤间的相位、振幅等因素的影响，其光子灯笼的输出呈现出不稳定模式变化，其变化表现为 L P 01 、 L P 11 o 和 L P 11 e 三个模式叠加行为 [ 3 ] 。我们对其变化规律进行了数值计算，图5(a)显示了三通道的光子灯笼中 L P 01 模式、 L P 11 o 模式和 L P 11 e 模式叠加时，光束质量与各模式功率占比的关系，依然符合高阶模含量越高，光束质量越差的基本规律，通过提升耦合过程中基模的功率占比，可以使输出端的光束尽量靠近基模状态；图5(b)显示了 L P 11 o 模式和 L P 11 e 模式相对 L P 01 模式间的相位差对光束质量产生的影响，此时M 2 因子随相位的变化仍是周期性的，且在 ψ m n = k π ，k为整数时，取到极小值。结合图5(a)、图5(b)可知，欲使输出端的模式控制在基模状态(M 2 因子较小)上，至少要同时控制参与耦合模式的振幅和相位两个变量。 在三通道的光子灯笼中，假设输入段光场已按不同模式传播了距离l，则其耦合前已存在的 ψ l 可以按照 ψ l = β m n ⋅ l 的方式来计算。因此要控制各通道相位使得 ψ n + ψ m = k π − ψ l (其中为整数)，此时耦合效率和光束质量都能得到较好的值，光斑形态基本成基模样式。而对于功率占比的控制，应在保证基膜含量较高的前提下，把控制重点放在减小功率随机变化量上(即减小 σ p )，以提高整个器件的耦合效率。 图5. L P 01 模式、 L P 11 e 模式和 L P 11 o 模式相干叠加时，(a) η - M 2 图h (b) 图 图6. 六通道光子灯笼中存在的模式相干叠加时形成的不同光斑形态 当光子灯笼扩展到六通道时，不同叠加方式形成的光斑形态更为丰富，给模式控制得到的结果提供了更多可能。六通道光子灯笼是由六根单模光纤拉制而成，其输出应为六个模式如图2所示。在图6中第一行给出了六通道光子灯笼中可以输出的六个模式，第二行给出了六通道输入经演化耦合后，输出可能出现六个模式叠加的光斑形态。 依旧以控制输出到基模状态为例：当同时改变六个通道的相位和功率占比时，我们可以得到的最优的光束质量 ( M x 2 + M y 2 ) 在2.03附近，该值在 η ( L P 01 ) 较高、 φ ( L P m n ) = 0 或p或2p时取到；而当 η ( L P 01 ) = 0.702 ， η ( L P 11 o ) = 0.013 ， η ( L P 11 e ) = 0.254 ， η ( L P 21 o ) = 0.021 ， η ( L P 21 e ) = 0.002 ， η ( L P 02 ) = 0.008 时，控制相位在0或p或2p附近的合适且相对稳定的值时，可以使 M x 2 + M y 2 = 2.07 ，此时对应的 σ p = 0.28 ，保证了可接受的耦合损耗，得到的光斑形态也与基模相一致。这说明光子灯笼能够通过控制输入端的振幅、相位等因素，实现输出端的模式控制。"
"本文主要讨论了光子灯笼中存在的模式在相干叠加的模型下，不同模式间的相位差、功率占比以及偏振对耦合效率h和光束质量M 2 因子的影响，分析了光子灯笼如何对输入端进行控制以实现输出端的模式控制。通过以上工作，我们得出：耦合效率h和光束质量M 2 因子的数值随基模功率占比 η ( L P 01 ) 的增加而降低；而随着模式间相位差的改变，耦合效率h和光束质量M 2 因子呈周期性变化。将以上结果应用在光子灯笼的模式控制中，需要同时控制光子灯笼输入端的功率占比和相位两个变量，且在得到较为理想的输出(比如M 2 因子较低的基模)后，要尽量减小这两个变量的标准差( σ p ， σ θ )，以提升耦合效率。若要利用光子灯笼实现特殊光斑的输出，则需同时控制振幅、相位以及偏振三个因素，并在控制系统中对评价函数进行特殊地设定。"
