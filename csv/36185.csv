"在统计学中，多借助零膨胀模型研究零膨胀数据潜在的模型结构及变量选择问题。然而，在多数情况下，响应变量的非零部分为定量数据，简单的零膨胀模型无法刻画这类数据的模型结构，对应的参数估计方法也不再适用。鉴于此，学者提出处理零膨胀半连续数据的两部模型。本文将组合惩罚似然估计方法引入两部模型，研究其变量选择问题。提出一种新的处理高维统计分析问题的惩罚似然估计方法：NCPM (New Combined Punishment Method)，并将该方法应用于太原市降水量数据，分析其影响因素。模拟及实例分析结果均表明本文的方法行之有效，较传统的惩罚似然估计方法具有更高的预测精度。 关键词 :组合惩罚，两部模型，LLA-CGD (Local Linear Approximation and Coordinate Gradient Descent)算法，变量选择，降水量 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"太原市由于地理环境的影响，形成了北温带大陆性气候，四季分明、冬无严寒、夏无酷暑。但其昼夜温差较大，年际气候变化较大，季风环流交替明显，气象灾害频发。尤其近几年，随着城市化进程的不断加快，公共绿地面积减少，道路等不透水面积不断增大，使得渗透力下降，排水压力加重。2005年8月16日，太原市最大降水量达到28.2 mm/h，导致道路积水严重，交通瘫痪数小时；2016年7月连日暴雨袭击给太原市带来了巨大损失：城市道路淹没，造成交通瘫痪；街边店铺、停泊车辆等不同程度的灌入雨水，给人民带来了不可逆转的财产损失；甚至对市民生命安全产生了威胁。研究降水量的影响因素，不仅可以为农作物的播种、培育提供便利，而且可以给气象部门提前预警，以便人们在暴雨来临之前能够做出有效的预防措施，避免造成人员损伤、财务损失等。 降水量数据是典型的零膨胀半连续数据。这类数据集中“零”值占很大比例，数据中的非零部分服从某一连续分布，所以使用传统的数据模型不能很好地解释这类数据。针对这种特殊的数据类型，专家学者提出一种行之有效的方法——两部模型 [ 1 ]。两部模型的第一部分用来判断响应变量是否为零，第二部分则用于描述非零响应变量的分布。该模型可以更合理、准确地研究此类特殊数据的内部规律，并在数据预测、检验等方面有着非常重要的作用。针对两部模型，学者们提出多种估计方法，包括：极大似然估计(MLE)、拟似然估计 [ 2 ] (McCulloch and Searle, 2001)，惩罚似然估计 [ 3 ] (Yau and Lee, 2001)和贝叶斯估计 [ 4 ] (Ghosh et al., 2006)等。其中，惩罚似然估计方法使用最为广泛，学者提出多种惩罚似然估计方法，如：Bridge [ 5 ] (Frank和Friedman, 1993)，MCP [ 6 ] (Minimax Concave Penalty)等，已广泛应用到多种领域，并取得良好效果。但当 p ≫ n 或者解释变量之间存在较强的相关性时，上述方法的性能会有一定的局限性。为此，Zou [ 7 ] 等提出了弹性网(Elastic net, Enet)，该方法将Lasso和 L 2 混合形成一种新的惩罚，改善了变量间相关性对预测性能造成的影响；Wang [ 8 ] 等将SCAD (Smoothly Clipped Absolute Deviation)与 L 2 组合，构成组合惩罚(Combined Penalization, CP)。但针对后来提出的MCP函数的组合惩罚问题，目前国内并没有具体阐述。本文将该方法引入两部模型对其进行具体说明，并将其应用于太原市降水量数据中，分析其影响因素。"
"假设Y表示事件，根据两部模型的基本思想，Y的分布可表示为如下形式： f ( y ) = π ∗ I ( y = 0 ) + [ ( 1 − π ) ∗ f ( y ) ] I ( y > 0 ) ,   y ≥ 0 ,   0 ≤ π ≤ 1 (1) 式中 I ( A ) 为示性函数， π 为零事件发生的概率， f ( y ) 为非零事件服从的分布。描述零事件发生可能性的函数包括：logit、probit、log-log等 [ 9 ]。本文选用logit作为模型第一部分的连接函数进行研究，记为： π = P r ( y = 0 | X ) = 1 1 + exp ( α 0 + α T X ) (2) 其中， α = ( α 1 , α 2 , ⋯ , α p ) T 表示未知的回归系数， α 0 表示截距项， X = { x 1 , x 2 , ⋯ , x p } T 表示p维的解释变量。 根据参考文献 [ 10 ] 令 f ( y ) 为Gamma分布，建立对应的概率密度函数为： f ( y ) = ( μ σ 2 ) ( μ 2 σ 2 ) Γ ( μ 2 σ 2 ) y μ 2 σ 2 − 1 e − μ σ 2 y , σ = exp ( β 0 + β T X ) , y > 0 , μ > 0 , σ 2 > 0 (3) 其数学期望和方差分别为： μ ， σ 2 ， β = ( β 1 , β 2 , ⋯ , β p ) T 表示未知的回归系数， β 0 表示截距项。 对每个 i , i = 1 , 2 , ⋯ , n 有： π i = 1 1 + exp ( α 0 + α T x i ) ,   σ i = exp ( β 0 + β T x i ) (4) 可得对应的对数似然函数为： L ( θ ) = ∑ i = 1 n { I ( y i = 0 ) log ( π i ) + I ( y i > 0 ) [ log ( 1 − π i ) − log ( g a m m a ( μ 2 σ i 2 ) )                     + μ 2 σ i 2 ∗ log ( μ σ i 2 ) + ( μ 2 σ i 2 − 1 ) ∗ log ( y i ) − y i ∗ μ σ i 2 ] } , θ = ( α 0 , α , β 0 , β ) (5)  对2.1节所述模型中的未知参数采用基于组合惩罚函数的极大似然方法进行估计，即对目标函数： Q ( θ ) = − L ( θ ) + J λ , v ( θ ) (6) J λ , v ( θ ) = p λ , γ ( θ ) + v 2 θ 2 (7) 求最小值。(6，7)式中的 λ , v 称为调整参数， γ 为正则化参数。惩罚函数中只考虑系数 α 和 β 。 p λ , γ ( θ ) 选取MCP函数，其形式如(8)。对正则化参数 γ ，Breheny and Huang (2011)的模拟中建议 γ = 3 ，所以本文取 γ = 3 ，并且尝试令 γ 取了几个不同的值，得到的结果基本一致 [ 11 ]。一般来说，调整参数的选择方法有很多，包括：AIC，BIC，GCV和CV等。本文利用10次5折交叉验证法确定调整参数 λ 的值。另外，还可以选用其他惩罚函数代替MCP。例如Hard、Lasso (Least Absolute Shrinkage and Selection Operator)、Ridge和SCAD等。 MCP函数形式如下： p λ , γ ( α , β ) = ∑ j = 1 p ( ρ ( | α j | ; λ , γ ) + ρ ( | β j | ; λ , γ ) ) ,   λ > 0 ,   γ > 0 ρ ( | θ | ; λ , γ ) = { λ | θ | − θ 2 2 γ , | θ | ≤ λ γ 1 2 λ 2 γ , | θ | > λ γ ,   λ ≥ 0 ,   γ > 1 ,   θ = ( α , β ) (8) 图1展示了几种惩罚函数的阈值函数图。结果表明，MCP、CP和提出的NCPM均具有稀疏性和连续型。组合惩罚函数对于 ∀ v > 0 都不会产生近似无偏估计量，而当 v → 0 时会产生渐近无偏估计量。 图1. Lasso、MCP、CP和NCPM的阈值函数图"
"本文选取一些常用的评价指标来衡量模型的泛化能力，具体指标如下： 1) 预测均方误差： PMSE = 1 m ∑ i = 1 m ( f ( x i ) − y i ) 2 (9) 2) 标准误差： SE = ∑ i = 1 m ( f ( x i ) − y i ) 2 m (10) 3) Freq：重要变量被优先选择的平均次数； 4) N n z ：最终模型中非零系数个数； 5) 平均误差： ME = ‖ θ − θ ^ ‖ 2 2 (11) 6) AUC：指ROC曲线下的面积 7) 错误发现率： FDR = FP FP + TP (12) 8) 假反例率： FNR = FN FN + TP (13) 上式m表示样本量； y i ， f ( x i ) 分别表示第i个样本的预测值和真实值； θ 表示参数真实值， θ ^ 表示参数的估计值；TP为真正例；FP为假正例；FN为假反例；TP为真正例。PMSE、SE、ME均是衡量样本真实值与预测值之间偏差的综合指标，FDR、FNR是性能度量指标，这些指标的值越小，表明模型描述数据的精确度越高。ROC曲线是以假正例率为横坐标，真正例率为纵坐标作图得到。若一种方法对应的ROC曲线被另一条曲线完全“包住”，则后者的性能优于前者 [ 12 ]。  根据前述模型随机生成模拟数据集。下面给出的四个不同场景，仅通过改变解释因子的维数以及设计矩阵的相关结构来实现，每个场景重复模拟100 ( N = 100 )次。在场景1和2中，分别生成训练集和测试集，且每生成一个训练集，在相同设置下独立生成相应的测试集，用于评估所得模型的预测性能。每个训练集由100个独立的观察值组成，而每个测试有500个独立的样本；在场景3和4中，整体生成模拟数据，不区分训练集和测试集。 模拟1 在该例中，令 p = 50 ， α j = − 0.5 , − 1 , 3 , 1 , 0.2 ， j = 1 , 11 , 31 , 41 , 50 。 α j = 0 ， j ≠ 1 , 11 , 31 , 41 , 50 ； β j = 1.49 , 0.4 , − 0.01 , 0.39 , − 0.06 ， j = 1 , ⋯ , 5 。 β j = 0 ， j ≠ 1 , ⋯ , 5 。另外，假设： X = ( X 1 , X 2 , ⋯ , X p ) ~ N p ( 0 , Σ ) ， Σ i , j = ρ | i − j | ， ρ 分别取0.1、0.4、0.7。 模拟1旨在解释因子相关程度不同的情况下，将各惩罚方法的预测精度和变量选择性能进行比较。作为参考，还考虑了Oracle估计结果，即所有重要变量都事先已知的岭回归。 Table 1ρ Method PMSE(SE) Freq.(%) N n z FDR FNR ρ = 0.1 Oracle 2.821(3.118) 100.000 10.000 0.100 0.530 Ridge 3.235(5.184) 84.833 50.000 0.077 0.732 NCPM 2.873(2.380) 88.667 9.731 0.080 0.490 MCP 2.656(3.038) 87.000 9.435 0.180 0.483 Enet 3.011(4.090) 87.000 29.890 0.190 0.610 ρ = 0.4 Oracle 2.172(1.532) 100.000 10.000 0.040 0.500 Ridge 2.413(1.825) 81.000 50.000 0.273 0.600 NCPM 2.141(1.689) 86.500 9.950 0.030 0.480 MCP 2.245(1.680) 84.320 9.950 0.020 0.520 Enet 2.391(1.799) 83.647 34.310 0.160 0.598 ρ = 0.7 Oracle 1.587(0.571) 100.000 10.000 0.060 0.560 Ridge 1.810(0.204) 74.167 50.000 0.172 0.632 NCPM 0.527(0.358) 92.483 10.180 0.030 0.390 MCP 1.553(0.553) 89.076 8.990 0.060 0.530 Enet 1.742(0.943) 81.833 26.740 0.140 0.590 表1. 例1模拟结果 从表1中报告的预测精度结果可以看出，在 ρ 的取值不同的情况下，Ridge是四种惩罚方法中效率最低的。显然，当真实模型中有多余变量时，简约的回归模型比非简约的回归模型具有更强的预测能力。此外，Enet的预测精度略低于MCP和NCPM，这可能是Lasso惩罚的偏差性引起的。可以看出，这些方法中MCP和NCPM是最优的。至于变量选择的性能：岭回归使用所有变量预测，Enet倾向于包含太多冗余变量，而MCP和NCPM通过对未知参数的值进行压缩，实现变量选择。因此，MCP和NCPM是这四种方法中最好的变量选择方法。 模拟2 在该例中，令 p = 50 ， α j = − 0.5 , − 1 , 3 , 1 , 0.2 , − 0.14 ， j = 1 , ⋯ , 6 。 α j = 0 ， j ≠ 1 , ⋯ , 6 ； β j = 1.49 , 0.5 , 0.4 , − 0.01 , 0.39 , − 0.06 ， j = 1 , ⋯ , 6 。 β j = 0 ， j ≠ 1 , ⋯ , 6 。令 X j , j = 1 , ⋯ , 50 为一组 的随机变量，且 X j ~ N ( 0 , 1 ) 。本例设置两种情况： 1) 当 j = 7 , ⋯ , 12 时，令 X j = X j − 6 + η j ，其中， η j ( i . i . d ) 且 η j ~ N ( 0 , 0.01 ) ； 2) 当 j = 7 , ⋯ , 28 时，令 X j = X j + 22 + η j ，其中， η j ( i . i . d ) 且 η j ~ N ( 0 , 0.01 ) ； (1)与(2)的区别在于：情况(1)中，重要变量间存在相关关系，情况(2)中，非重要变量间具有相关关系。 Table 2场景 方法 PMSE (SE) N n z Freq.(%) 1 Oracle 2.095 1.554 12.000 100.000 Ridge 2.927 1.635 50.000 78.583 NCPM 2.155 1.581 11.864 87.083 MCP 2.154 1.579 11.927 88.500 Enet 2.351 1.653 18.635 81.677 2 Oracle 0.724 0.976 6.000 100.000 Ridge 1.237 1.371 50.000 56.833 NCPM 0.841 0.513 6.039 91.459 MCP 1.652 1.008 44.830 0.000 Enet 1.037 1.023 25.379 89.176 表2. 例2模拟结果 模拟2旨在比较当解释变量间存在强相关性时，各惩罚方法性能的优越性。表2展示了实例2的模拟结果。MCP在场景1的变量选择中是最好的，但是在场景2中，比其他变量选择要差得多，得到的结果完全是误导性的。在场景2中，使用组合惩罚(Enet和NCPM两种方法)的性能比使用单一惩罚要好得多；NCPM对这两种情况都是最好的。从这个例子中，我们可以看出，在MCP中增加 L 2 惩罚可以显著降低解释因子之间的高共线性带来的风险。 接下来的两个例子旨在比较两种组合惩罚方法(CP和NCPM)在 ρ 较大情况下的效果。 模拟3在该例中，令 p = 200 ，剩余条件与模拟1相同。 模拟4在该例中，令 X j ( i . i . d ) ， j = 1 , ⋯ , p 且 X j ~ N ( 0 , 1 ) 。分别，令 p = 100 , 300 , 500 。 α j = − 0.5 , − 1 , 3 , 1 , 0.2 ， j = 1 , 11 , 31 , 41 , 50 。 α j = 0 ， j ≠ 1 , 11 , 31 , 41 , 50 ； β j = 1.49 , 0.4 , − 0.01 , 0.39 , − 0.06 ， j = 1 , ⋯ , 5 。 β j = 0 ， j ≠ 1 , ⋯ , 5 表3总结了组合惩罚方法的模拟结果。在表格中，我们分别列出了系数 α 和 β 在不同衡量指标下的具体情况。模拟结果表明：两种方法的变量选择均有很好的效果；增加解释变量间的相关性对两种方法的变量选择性能影响不大，这表明它们均有很好的处理解释变量间共线性的能力；NCPM比CP给出了更精确的变量选择结果。例如：例3 ρ = 0.4 的情境下(表3中第3、4行)，系数 α 在使用NCPM方法时，得到的FDR、FNR、ACU的值分别为：0.03、0.39、0.93，使用CP方法得到的值分别为0.05、0.43、0.92。并且发现，NCPM方法在ME、PMSE上均有所改善。另外，对系数 β 也有类似的发现。 Table 3 例 子 场 景 估计 方法 α β FDR FNR AUC ME PMSE FDR FNR AUC ME PMSE 例3 (p) 0.1 NCPM 0.090 0.439 0.890 0.182 0.385 0.300 0.171 0.900 0.016 0.321 CP 0.092 0.524 0.700 0.285 1.285 0.326 0.282 0.870 0.169 1.746 0.4 NCPM 0.030 0.390 0.930 0.141 0.457 0.280 0.142 0.920 0.016 0.208 CP 0.050 0.430 0.920 0.165 1.741 0.289 0.236 0.900 0.125 1.711 0.7 NCPM 0.029 0.536 0.918 0.132 0.872 0.230 0.274 0.960 0.029 0.151 CP 0.011 0.374 0.890 0.152 2.239 0.247 0.196 0.890 0.120 1.501 例4 (p) 100 NCPM 0.050 0.020 0.960 0.016 0.341 0.330 0.250 0.930 0.052 0.088 CP 0.060 0.433 0.910 0.022 1.046 0.300 0.324 0.870 0.089 0.114 300 NCPM 0.020 0.060 0.980 0.017 0.351 0.260 0.020 0.970 0.031 0.062 CP 0.090 0.371 0.950 0.059 0.832 0.285 0.143 1.000 0.054 0.105 500 NCPM 0.018 0.134 0.990 0.003 0.556 0.180 0.000 0.990 0.024 0.041 CP 0.023 0.520 0.970 0.041 0.610 0.244 0.025 1.000 0.049 0.067 表3. 模拟3、模拟4结果"
"降水量是指从天空落到地面的液态或固态(经融化后)水，未经流失，在水平面上积聚的深度(https://baike.baidu.com/item)。1 mm的降水量是指：在666.7 m 2 上，降水总深度达到1 mm。  降水量相关数据源于气象数据库https://www.aqistudy.cn/historydata/index.php，https://www.wunderground.com/history。本文主要收集了山西省太原市2017年1月~2018年12月期间风速、能见度、气压、日照时长、相对湿度、AQI、PM2.5以及PM10的日平均值。具体说明见表4。 Table 4 变量 符号 单位 说明 类型 均值 Min Max Y 降水量 mm 连续型变量 数值型 0.821 0.00 27.94 x 1 T max ℃ 日最高温度 数值型 18.231 −7.22 37.78 x 2 T min ℃ 日最低温度 数值型 5.239 −18.33 23.44 x 3 T D r ℃ 日期温差 数值型 −4.786 −16.11 7.22 x 4 T m e a n ℃ 日平均气温 数值型 11.747 −11.11 30.00 x 5 T D p ℃ 露点温度 数值型 0.747 −30.00 22.22 x 6 WS km/h 风速 数值型 21.009 6.44 49.89 x 7 VS km 能见度 数值型 24.679 3.1 30.96 x 8 P hPa 气压 数值型 1021.987 1002.03 1049.78 x 9 SD h 日照时长 数值型 12.186 9.53 14.77 x 10 RH % 相对湿度 数值型 52.038 14 93 x 11 AQI 无 空气质量指数 数值型 109.426 0 468 x 12 PM2.5 μg/m 3 细颗粒物 数值型 57.370 0 377 x 13 PM10 μg/m 3 可吸入颗粒物 数值型 121.869 0 473 表4. 相关变量说明 其中，2018年中有65天降水量大于0；2017年中有58天降水量大于0。 对数据收集整理后，共得到730组观测值。其中607 (约占83.2%)组内降水量的取值为0。另外，为了消除量纲的影响，需要对变量进行标准化处理。本文使用z-score标准化法对原始数据预处理，且经过z-score标准化处理的数据服从 N ( 0 , 1 ) 。 z-score标准化公式为： x ˜ i = x i − x ¯ σ ,   x ¯ = 1 n ∑ i = 1 n x i ,   σ = 1 n − 1 ∑ i = 1 n ( x i − x ¯ ) 2 (14)  根据参考文献 [ 13 ] 得到：Gamma分布对降水量非零部分的数据拟合效果最佳。因此，本节使用前述的Logit-Gamma模型进行研究。  运用NCPM方法对实例数据估计，并与Enet方法对比，结果见表5。 Table 5 解释变量 NCPM Enet Logistic (α) Gamma (β) Logistic (α) Gamma (β) T max x 1 T min x 2 0.274 1.816 T D r x 3 0.017 0.739 T m e a n x 4 3.522 0.019 0.001 T D p x 5 4.533 0.548 3.144 WS x 6 1.732 0.422 0.113 1.774 VS x 7 −0.033 0.159 P x 8 −4.667 −16.322 SD x 9 −8.493 −1.663 −1.120 −8.449 RH x 10 12.958 3.606 1.326 11.225 AQI x 11 −1.266 −0.505 0.006 1.236 PM2.5 x 12 −2.848 −0.461 −0.144 −2.695 PM10 x 13 −2.089 −0.539 0.077 1.943 表5. 实例分析结果(估计值(标准误差)) 由表5新提出方法得到的结果可知:气温与降水量成正相关，这一现象主要受全球变暖的影响。气候变暖，气温升高，水循环加快，大气中的水蒸气增多，降水量也随之增大。风速与降水量成正比。这是因为风速越大，单位时间内进入空气中的水分子越多，蒸发量就越大，导致降水量越大。日照时长与降水量成负相关；空气相对湿度与降水量成正相关，这些结论与实际相符。PM2.5、PM10的浓度以及AQI均与降水量呈负相关。这表明：降水能有效去除大气中的颗粒物，降低空气中PM2.5、PM10的浓度，从而起到净化空气的作用，导致AQI的值降低。 另外发现，新提出的方法得到的模型更简约，模型可解释性更高。如：表5中PM10的Logit部分，用两种方法获得的估计值分别：−2.089、0.077；PM10的Gamma部分，用两种方法得到的估计值分别为：−0.539、1.943，显然利用Enet方法得到的估计与实际意义不符。"
"本文以变量选择切入，从理论和数值模拟两方面系统地研究组合惩罚函数的极大似然估计方法在Logit-Gamma两部模型中的表现。具体总结如下： 利用L 2 在高度相关解释变量间的良好表现，将基于SCAD + L 2 惩罚函数的极大似然估计方法扩展到MCP函数，提出一种新的处理高维统计分析问题的惩罚似然估计方法，NCPM极大似然估计方法。该方法改善了变量间相关性对模型稳定性、精确度的影响。模拟研究表明，当 p ≫ n 或解释变量间的相关性较强时，该方法高效便捷且易于实现。 关于组合惩罚似然估计两部模型的变量选择，本文采用LLA-CGD算法。该算法解决了目标函数非线性问题，同时实现计算可行性。数值模拟结果显示，该算法选择效果良好，为两部模型的变量选择提供了新思路。 将提出的NCPM方法应用于Logit-Gamma两部模型，分析太原市降水量的影响因素。结果显示，是否降水主要受露点温度、风速、日照时长、空气相对湿度、PM2.5及PM10浓度等的影响；当降水产生时，降水量多少更易受日平均气温、风速、日照时长、空气相对湿度、PM2.5及PM10浓度、AQI等的影响。最后与Enet方法对比，进一步证实了提出方法具有估计的稳定性、模型可解释性等优势。"
