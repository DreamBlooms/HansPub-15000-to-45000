"随着互联网和我国经济的快速发展，智能化的产品不断被人们所熟知，智能开关是家居智能化的重要组成部分，它已经渐渐取代传统墙壁开关，走入了我们的日常生活中。本文设计了一种基于单片机智能无线WiFi开关控制系统。系统设计以STC89C52处理器作为系统主机控制器电路，单片机的串行口与无线传输模块esp8266wifi模块进行相关通信，人触摸手机发出的控制指令通过WiFi来控制家庭用电器的继电器，继电器开关数据通过WiFi模块发送给手机，从而实现了智能无线控制控制系统中的手机与家用电器的物物连接。设计整套设备的最终目的是实现使用手机APP即可对家庭各用电器开关进行控制，从而来实现家电的数字化和智能化。 关键词 :单片机，WiFi，智能手机，无线开关 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着科学技术和社会经济的迅猛发展，人类社会中自动控制，智能控制越来越普及，而单片机正是这种技术普及的基础 [ 1 ] 。无线网络技术的快速发展和日趋成熟，智能手机的普及率越来越高，WiFi技术也得到了非速的发展，已经完全融入了我们的生活，而且随着科学技术的快速发展，人民追求越来越高的生活质量 [ 2 ] [ 3 ] 。目前的室内灯开关的设计和装修大多采用固定式按键和触摸平板的方式，传统的室内灯控制方式已不再满足现代人们对生活水平的需求，而目前的室内灯开关的设计和装修大多采用固定式按键和触摸平板的方式，相比之下，WiFi控制不仅减少了硬件线路成本，易于维修也显得较为方便。因此，利用WiFi传输速度快、覆盖面大、抗干扰能力强等优点，本文设计了无线WiFi的智能开关 [ 4 ] [ 5 ] 。"
"基于WiFi模块的智能开关系统主要三部分组成：一是、智能移动终端。采用Java编写手机APP (TCP)连接，通过手机APP软件实现用户对系统的界面进行控制功能。二是、负责广播信息AP节点。通过AP建立无线wifi网络，手机客户端和家庭各个用电器开关节点模块采用UDP协议广播机制实现数据的交换功能。三是、无线开关控制模块。该部分主要是由串口WiFi模块、单片机、驱动电路组成。单片机作为终端控制设备，主要实现的功能是与串口WiFi模块实现数据的交换及系统终端有用数据的存储。本设计采用STC89C52单片机完成整个系统的控制流程。手机端软件设置操作界面登陆账号，WiFi模块连入网络，实现系统设计(图1)。"
"无线开关控制模块总体设计框架如图2所示。硬件电路主要由单片机、继电器驱动电路、WiFi模块电路组成。本设计采用STC89C52单片机完成整个系统的控制流程。STC89C52RC是STC公司生产的一种低功耗、高性能CMOS8位微控制器，具有8 K字节系统可编程Flash存储器。STC89C52使用经典的MCS-51内核，但是做了很多的改进使得芯片具有传统51单片机不具备的功能。在单芯片上，拥有灵巧的8位CPU和在系统可编程Flash，使得STC89C52为众多嵌入式控制应用系统提供高灵活、超有效的 图1. 系统总体设计框图 图2. 硬件设计的系统框图 解决方案。手机端软件设置操作界面登陆账号，WiFi模块连入网络，实现系统设计。图3为无线WiFi智能开关电路原理图。  综合考虑到本系统成本及模块体积大小的因素，本设计选用STC89C52单片机。本设计系统的数据传输方式采用串口通信，而此芯片可以直接利用它和WiFi模块进行通信从而实现无线数据的转发，软件程序中通过串口的中断检测一帧的数据是否完成的传送 [ 6 ] 。该单片机的串STC89C52是一种低功耗、高性能CMOS 8位微控制器，具有4 K在系统可编程Flash存储器。在单芯片上，拥有灵巧的8位CPU和在系统可编程Flash，使得STC89C52为众多嵌入式控制应用系统提供高灵活、超有效的解决方案。本文设计的系统采用的是单片机的工作方式1，采用中断方式与WiFi模块进行通信，从而节省了查询方式cpu，速度也更快 [ 6 ] 。  esp8266模块是基于UART接口的WiFi无线网络模块，能够实现无线网络和用户串口数之间的交换 [ 7 ] [ 8 ] 。通过串口WiFi模块与手机之间通信，使用的是ASCII码，手机把编码变为ASCII码进行发射，UART-WIFI会接收ASCII码并产生中断给单片机 [ 9 ] [ 10 ] 。此WiFi模块可以通过终端像普通路由器一样设置和修改密码，也可以通过配置软件进行相应设置和修改，其具有较高的安全性。  主要利用UDP通信模式，支持串口配置参数的方式。UDP模式下模块将本地UDP端口收到的所有数据(含其他多个远程端口的数据)报转发至串口 [ 11 ] 。esp8266模块的基本配置如下：创建网络名称：xew026；密码：1xe76；IP地址：103.212.33.134，端口是8129；子网掩码：255.255.255.0；默认网关：192.168.0.1。 图3. 无线WiFi智能开关电路原理图"
"本系统软件设计包含一个主程序和一个中断程序，其中主函数包括六个子函数；主程序的流程图如图4所示。  图4. 无线WiFi智能开关电路原理图 图5. 现场测试"
"实验环境为移动终端采用的OPPO R9，联发科MT6755八核处理器。通过应用商城或者豌豆荚将该上位机软件安装到该手机上。为了方便调试，选用四个LED指示灯(电饭煲开关、儿童房开关、电视机开关、热水器开关)，通过手机上位机程序发送控制指令，能够方便实现对以上四个用电器开关控制，验证了设计的方案(图5)。"
"本文设计的基于单片机的手机WiFi模块的智能无线开关系统，采用目前较新的控制方式——移动客户端控制 + 无线WiFi，这种方式不仅充分利用WiFi的传输速度快、传输距离远、覆盖面大、抗干扰能力强等优点，而且Android平台开发成本低、价格低廉、使用方便，适应时代发展，具有很好的市场开发前景。"
