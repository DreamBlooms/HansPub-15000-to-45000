"首先用蒙特卡洛罗法模拟生成股票的价格路径，然后对生成的路径建立对数似然函数。假设跳–扩散模型的股票市场价格与模型价格之间存在高斯误差，构造权重函数，通过线性搜索的方法求解加权极大似然函数的最大化，从而得到波动率的校准。最后给出数值模拟实验，实验结果表明了该算法的可行性。 关键词 :跳–扩散模型，蒙特卡罗法，加权极大似然法 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"随着计量经济理论的发展，各种参数估计方法不断涌现出来，极大似然法是求估计的一种方法，这一方法首先由德国数学家Gauss于1821年提出，但未得到足够的重视。英国的统计学家Fisher在1922年的论文“On the mathematical foundations of theoretical statistics, reprinted in Contributions to Mathematical Statistics” [ 1 ] 中再次提出了极大似然法的思想，并且首先探讨了这种方法的一些性质，如一致性，渐进正态性，渐进有效性和不变性等。极大似然估计这一名称也是Fisher命名的，这是一种目前仍然得到广泛应用的方法。 人们常用极大似然法来估计跳–扩散模型，这也是统计学里很经典的方法。但在实现操作过程中，极大似然法会有很大难度，因为只有少数扩散过程的似然函数具有封闭形式，如Black-Scholes-Merton (1973) [ 2 ]、Vasicek (1977) [ 3 ]、CIR (1985) [ 4 ] 等模型，而只有具有封闭形式的似然函数才可用来估计，这就引发了扩散模型的转移密度函数的研究。求解转移密度函数的方法一般分为两类，一类是直接将扩散模型离散化并假设模型的参差符合正态分布，在这种假设条件下，模型的参数估计可以直接通过求解非线性计量经济模型参数的方法求得，如Euler法、Nowman法等。另一类是从扩散模型满足的偏微分方程入手，通过数值方法求解偏微分方程来获得转移密度函数的近似解，如SMLE法、Crank-Nicoslon法等。 本文中，我们讨论了跳–扩散模型参数校准问题的极大似然法。首先模拟股票价格路径的生成，然后对生成的路径建立对数似然函数，并构造权重函数，利用加权极大似然法校准模型中的波动率，最后数值模拟试验表明了该算法的可行性。"
"在风险中性测度下，假设股票价格 S t 满足如下随机微分方程 d S t S t = ( μ − λ κ ) d t + σ d W t + ( η − 1 ) d Q t , (1) 其中 μ 是漂移率， σ 是股票的波动率， W t 是标准布朗运动， d Q t 是一个强度为 λ 的泊松过程， η − 1 是股票发生跳跃时的相对跳跃高度， κ = E [ η − 1 ] ，其中 E [ ⋅ ] 表示期望算子。 在Merton跳–扩散模型下， η 服从对数正态分布，若用 g ( η ) 表示 η 的概率密度函数，则有 g ( η ) = 1 2 π σ J η exp ( − ( log η − ν ) 2 2 σ J 2 ) , (2) 其中 κ = E [ η − 1 ] = exp ( ν + σ J 2 2 ) − 1 ， ν 和 σ J 表示跳跃的均值和方差。 而在Kou跳–扩散模型下， g ( η ) 满足对数双指数分布 g ( η ) = p α 1 e − α 1 η H ( η ) + q α 2 e α 2 η H ( − η ) , (3) 其中 α 1 > 1 ， α 2 , p , q > 0 ， p + q = 1 ， H ( η ) 是赫维赛德阶跃函数。 随机微分方程(1)的解为 S ( t ) = S ( 0 ) e ( a − 1 2 σ 2 ) t + σ W ( t ) ∏ j = 1 Q ( t ) η j , (4) 其中令 a = μ − λ κ 。"
"固定时间 0 = t 0 < t 1 < ⋯ < t n ，并令 Δ t i = t i + 1 − t i , i = 0 , 1 , ⋯ , n − 1 。Glasserman (2004) [ 5 ] 给出了模拟带跳的几何布朗扩散过程的方法。 假设Q是一个泊松过程， η 1 , η 2 , ⋯ 独立同分布， Q , W 和 { η 1 , η 2 , ⋯ } 相互独立。为了模拟 S t 在时刻 t 1 , ⋯ , t n 的值，我们推广(4)式为 S ( t i + 1 ) = S ( t i ) e ( a − 1 2 σ 2 ) Δ t i + σ [ W ( t i + 1 ) − W ( t i ) ] ∏ j = Q ( t i ) + 1 Q ( t i + 1 ) η j , (5) 若 Q ( t i + 1 ) = Q ( t i ) ，则乘积项 ∏ j = Q ( t i ) + 1 Q ( t i + 1 ) η j = 1 ，即退化为几何布朗运动。令 x ( t ) = log S ( t ) ，则有 x i + 1 = x i + ( a − 1 2 σ 2 ) Δ t i + σ ( W i + 1 − W i ) + ∑ j = Q i + 1 Q i + 1 log η j , (6) 其中 x i = x ( t i ) ， W i = W ( t i ) ， Q i = Q ( t i ) 。 Merton跳–扩散模型，一般模拟(6)式从时刻 t i 到 t i + 1 的方法有以下步骤： 1) 生成服从标准正态分布的随机变量 Z ( Z ~ N ( 0 , 1 ) ) ； 2) 生成服从参数为 λ Δ t i 的泊松分布的随机变量Q；如果 Q = 0 ，则令 M = 0 ，并跳到第4步； 3) 按照 η 的分布生成 log η 1 , log η 2 , ⋯ , log η Q ，令 M = log η 1 + log η 2 + ⋯ + log η Q ； 4) 令 x i + 1 = x i + ( a − 1 2 σ 2 ) Δ t i + σ Δ t i Z + M . (7) 这种方法充分依赖于泊松过程的两个性质：一是增量 Q i + 1 − Q i 服从均值为 λ Δ t 的泊松过程；二是具有独立增量，即 Q i + 1 − Q i 与 Q i 独立。作进一步的假设，设 η j 服从对数正态分布 L N ( ν , σ J 2 ) ，那么 log η j ~ N ( ν , σ J 2 ) ，则有 ∑ j = 1 n log η j ~ N ( n ν , n σ J 2 ) = n ν + σ J n N ( 0 , 1 ) . (8) 则可以替换第3步为 3’) 生成 Z 2 ~ N ( 0 , 1 ) ，设定 M = ν Q + σ J Q Z 2 。 参考Ait-Sahalia (2002) [ 6 ]，我们模拟Merton跳–扩散模型的路径生成时，选取参数为 a = 0.2 , σ = 0.3 , λ = 1 / 3 , ν = 0 , σ J = 0.2 , x 0 = 0 ，我们对该过程进行一次样本路径的模拟，并令 n = 1000 , Δ t = 1 / 52 ，见图1。 图1. 一次样本路径的模拟实现 而对于Kou跳–扩散模型， log η j 满足伽马分布(实际上是指数分布)，且 log η j 大于零的概率为p，小于零的概率为q。在这种情况下，当泊松随机变量 Q = n 时， log η j 取正值的个数满足参数为n和p的二项分布。因此第3步应改为 3a’) 生成 K ~ b ( Q , p ) ，其中 b ( Q , p ) 表示以n和p为参数的二项分布； 3b’) 生成 R 1 ~ G a ( K α 1 , α 2 ) ， R 2 ~ G a ( ( Q − K ) α 1 , α 2 ) ，令 M = R 1 − R 2 。 在第3b’步中，若 K = 0 ，则令 R 1 = 0 ；若 K = Q ，则令 R 2 = 0 。在第3a’步中，当 Q = n 时，二项分布K的密度函数为 P ( K = k ) = n ! k ! ( n − k ) ! p k q n − k ,     k = 0 , 1 , ⋯ , n (9)"
"Press (1967) [ 7 ] 已经证明，对于Merton跳–扩散模型， x t 的转移概率密度函数是一个独立的泊松过程和一个正态概率密度函数的合成，即为 f M ( x i + 1 | x i , σ ) = ∑ j = 0 ∞ ( λ Δ t ) j e − λ Δ t j ! ⋅ 1 2 π ( σ 2 Δ t + j σ J 2 ) ⋅ exp { − ( x i + 1 − x i − a Δ t + 1 2 σ 2 Δ t − j ν ) 2 2 ( σ 2 Δ t + j σ J 2 ) } , (10) 其中j表示发生跳跃的次数。对于 { x i } , i = 1 , ⋯ , n ，可得对数似然函数为 L M e r t o n ( σ ) = log f M ( x 0 , σ ) + ∑ i = 0 n − 1 log f M ( x i + 1 | x i , σ ) . (11) 而对于Kou跳–扩散模型， x t 的转移概率密度函数为 f K ( x i + 1 | x i , σ ) = ∑ j = 0 L L ! j ! ( L − j ) ! p j q L − j 1 2 π ( σ 2 Δ t − j ( Q − K ) α 1 α 2 2 + j K α 1 α 2 2 )     ⋅ exp { − ( x i + 1 − x i − a Δ t + 1 2 σ 2 Δ t + j ( Q − K ) α 1 α 2 − j K α 1 α 2 ) 2 2 ( σ 2 Δ t − j ( Q − K ) α 1 α 2 2 + j K α 1 α 2 2 ) } , (12) 其中 L = 0 , 1 , ⋯ 。对于 { x i } , i = 1 , ⋯ , n ，可得对数似然函数为 L K o u ( σ ) = log f K ( x 0 , σ ) + ∑ i = 0 n − 1 log f K ( x i + 1 | x i , σ ) . (13) 由于当观察次数足够多时，似然函数中第一项 log f ( x 0 , σ ) 的权重很小，因此在实际的估计过程中往往省略。求似然函数 L ( σ ) 的最大化，即可得到参数的估计值。对于j的取值，Ball和Torous (1985) [ 8 ] 发现：在 j = 10 处截断可以得到精确的极大似然估计量。 由于在实际情况中，我们获取的时间序列数据都包含着观测误差和市场噪音，因此我们假设股票的市场观测值 S i M 与模型所得价格 之间存在一定的高斯误差，即 S ( t i , σ ) = S i M + u i ,     i = 0 , 1 , … , n (14) 其中 S ( t i , σ ) 是在参数 σ 已知的条件下，通过模拟路径生成的值， u i ~ N ( 0 , ϕ i ) ， ϕ i 是已知的。 因此，为了使得估计得到的参数能更好地拟合市场的动态过程，构造如下权重函数 g ( x i + 1 | x i , σ ) = 1 2 π ϕ i + 1 ⋅ exp { − ( S i + 1 − S i + 1 M ) 2 2 ϕ i + 1 } ,     i = 0 , 1 , ⋯ , n − 1 (15) 综合(11)和(15)式，并省略常数项，我们得到Merton跳–扩散模型的加权对数似然函数为 F M e r t o n ( σ ) = ∑ i = 0 n − 1 log f M ( x i + 1 | x i , σ ) ⋅ g ( x i + 1 | x i , σ ) = ∑ i = 0 n − 1 log { ∑ j = 0 ∞ ( λ Δ t ) j e − λ Δ t j ! ⋅ 1 2 π ( σ 2 Δ t + j σ J 2 ) ⋅ exp { − ( x i + 1 − x i − a Δ t + 1 2 σ 2 Δ t − j ν ) 2 2 ( σ 2 Δ t + j σ J 2 ) } }         ⋅ 1 2 π ϕ i + 1 ⋅ exp { − ( S i + 1 − S i + 1 M ) 2 2 ϕ i + 1 } . (16) 综合(13)和(15)式，并省略常数项，我们得到Kou跳–扩散模型的加权对数似然函数为 F K o u ( σ ) = ∑ i = 0 n − 1 log f K ( x i + 1 | x i , σ ) ⋅ g ( x i + 1 | x i , σ ) = ∑ i = 0 n − 1 log { ∑ j = 0 L L ! j ! ( L − j ) ! p j q L − j 1 2 π ( σ 2 Δ t − j ( Q − K ) α 1 α 2 2 + j K α 1 α 2 2 ) }         ⋅ exp { − ( x i + 1 − x i − a Δ t + 1 2 σ 2 Δ t + j ( Q − K ) α 1 α 2 − j K α 1 α 2 ) 2 2 ( σ 2 Δ t − j ( Q − K ) α 1 α 2 2 + j K α 1 α 2 2 ) }         ⋅ 1 2 π ϕ i + 1 ⋅ exp { − ( S i + 1 − S i + 1 M ) 2 2 ϕ i + 1 } . (17) 通过求解 F ( σ ) 的最大化( F ( σ ) 表示 F M e r t o n ( σ ) 和 F K o u ( σ ) )，便可以得到参数 σ 的估计，即 σ * = arg max F ( σ ) . (18) 从 F ( σ ) 的表达式可以看出，加入权重函数(15)的目的是对于能够较好拟合市场期权价格的点，赋予的权重大一些，而对于那些与市场期权价格观测值差距较大的点，则赋予的权重要小一些。"
"下面给出算法的具体过程。 首先由第三节的算法步骤生成一条样本路径，即生成 x i , i = 1 , 2 , ⋯ , n 的值，同时算得 S i 和 S i M 的值，然后通过线性搜索的方法求解(18)式，并得到参数 σ ^ 的估计值。由于生成 x i 和 S i M 时都有随机项的存在，因此我们引入蒙特卡洛方法进行H次模拟，最终得到 σ 的平均估计值 σ ¯ ，并定义均方根误差为 RMSE ( σ ) = ∑ i = 1 H ( σ ^ i − σ 0 ) 2 / H , 其中 σ ^ i 为校准所得到的数值解。 对于Merton跳–扩散模型，我们选取参数 a = 0.2 , λ = 1 3 , ν = 0 , σ J = 0.2 , x 0 = 0 ，选取等距的离散时间点，令 Δ t = 0.01 ，并假设参数 σ 的真实值为 σ 0 = 0.3 。 从表1可以看出，当 ϕ = 10 − 3 S 时，波动率估计值 σ ^ 的平均值 σ ¯ 在 n = 10 时得到的波动率估计值的均值有一定的误差，并且均方根误差(RMSE)较大，而在 n = 50 , 100 , 200 三种情况下都能得到较好的估计，其中n表示模拟生成路径上点的个数。在这四种情况下，波动率估计值的均方根误差(RMSE)会随着n的增大而减小，并且减小到一定程度后，就只会缓慢减小。这表明随着路径上点的个数的增加，我们估计得到的波动率的值更稳定趋于真实值，但增加到一定程度，效果就会减慢。 表2表明，当 n = 100 时，在 ϕ = 10 − 2 S , 10 − 3 S , 10 − 4 S 三种情况下波动率估计值 σ ^ 的平均值 σ ¯ 与均方根误差的数值结果。实验结果表明，三种情况下得到的均值和均方根误差相差不大，都能得到较好的估计，且均方根误差都较小。 Table 1ϕ = 10 − 3 S n 10 50 100 200 σ Mean 0.3125 0.2967 0.3027 0.2980 RMSE 0.0787 0.0342 0.0238 0.0161 表1. 不同n下，Merton跳–扩散模型波动率校准均值及均方根误差 Table 2n = 100 ϕ ϕ = 10 − 2 S ϕ = 10 − 3 S ϕ = 10 − 4 S σ Mean 0.3048 0.3027 0.2978 RMSE 0.0241 0.0238 0.0219 表2. 不同f下，Merton跳–扩散模型波动率校准均值及均方根误差 对于Kou跳–扩散模型，我们选取参数 a = 0.2 , λ = 1 3 , α 1 = 3.0456 , α 2 = 3.0775 , p = 0.3445 , x 0 = 0 ，选取等距的离散时间点，令 Δ t = 0.01 ，并假设参数 σ 的真实值为 σ 0 = 0.3 。 从表3可以看出，当 ϕ = 10 − 3 S 时，波动率估计值 σ ^ 的平均值 σ ¯ 在 n = 10 时，得到的估计会有一定的误差，并且均方根误差(RMSE)较大，而当 n = 50 , 100 , 200 时，能得到波动率 σ 的较好估计，且其均方根误差(RMSE)会随着n的增大而减小，并且减小到一定程度后，就只会缓慢减小。这表明随着路径上点的个数的增加，我们估计得到的波动率的值更稳定趋于真实值，但增加到一定程度，效果就会减慢。 Table 3ϕ = 10 − 3 S n 10 50 100 200 σ Mean 0.2881 0.2997 0.2985 0.3012 RMSE 0.0682 0.0298 0.0246 0.0242 表3. 不同n下，Kou跳–扩散模型波动率校准均值及均方根误差 表4表明，当 n = 100 时，在 ϕ = 10 − 2 S , 10 − 3 S , 10 − 4 S 三种情况下波动率估计值 σ ^ 的平均值 σ ¯ 与均方根误差的数值结果。实验结果表明，三种情况下得到的均值和均方根误差相差不大，都能得到较好的估计，并且每次的估计值基本都稳定在真值附近。 Table 4n = 100 ϕ ϕ = 10 − 2 S ϕ = 10 − 3 S ϕ = 10 − 4 S σ Mean 0.3021 0.2985 0.3013 RMSE 0.0250 0.0246 0.0238 表4. 不同f下，Kou跳–扩散模型波动率校准均值及均方根误差 我们对Merton跳–扩散模型和Kou跳–扩散模型波动率校准进行比较。表5表示在其余参数相同的情况下，当 n = 10 , 50 , 100 , 200 时的计算结果。可以看出，当n较小时，两种模型得到的估计值都会有一定的偏差，并且Kou模型得到的结果要比Merton模型得到的更精确且稳定一些，而随着n的增加，两种模型都能得到比较精确且稳定的估计值，且n较大时，Merton模型得到的估计值更稳定一些。对于我们所举的数值算例，若路径上的点较少时，我们使用Kou跳–扩散模型进行波动率的校准，而当路径上的点较多时，我们采用Merton模型进行校准。 Table 5 ϕ = 10 − 3 S n 10 50 100 200 Merton Mean 0.3125 0.2967 0.3027 0.2980 RMSE 0.0787 0.0342 0.0238 0.0161 Kou Mean 0.2881 0.2997 0.2985 0.3012 RMSE 0.0682 0.0298 0.0246 0.0242 表5. Merton跳–扩散模型和Kou跳–扩散模型波动率校准的比较"
"本文中，我们讨论了Merton跳–扩散模型和Kou跳–扩散模型参数校准问题的极大似然法。首先用蒙特卡洛罗法模拟股票价格路径的生成，然后找到生成的路径的转移概率密度函数，并建立对数似然函数。令跳–扩散模型的股票市场价格与模型价格之间的误差为高斯误差，并构造权重函数，通过线性搜索的方法求解加权极大似然函数的最大化，从而得到波动率的校准。最后给出数值模拟实验，实验结果表明了该算法的有效性和可行性。"
