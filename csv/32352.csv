"针对草原多源遥感数据的数据量大、多时相和多数据源等特点，利用强大的ArcGIS Engine二次开发技术，以青海省海晏县为例，设计了一套一体化数据管理系统，从而改进了传统数据管理的不足，实现了对卫星、飞艇、无人机和地面的多源多时相草原遥感数据统一管理、多种数据的相互对比分析。与此同时，系统还实现了对草原遥感数据的查询、分析、制图等基础的方便功能。对于传统栅格影像查询时速度慢、资源消耗大的特点，提出了网格化的解决方案，满足了卫星影像及无人机影像的快速查询的需求，能够对草原多源多时相数据进行更加快速有效的管理和分析，为草原科学放牧以及生态管理提供了决策支持。 关键词 :ArcGIS Engine，草原遥感，草原监测系统，海晏县 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"草原是我国最大的陆地生态系统，并且在人类的生产生活中以及自然环境的保护和改善中扮演着重要的作用，首先，草原可以保持水土，减少水土流失以及固定土壤，保护下游的生态系统，其次草原的覆盖可以减少裸土，并且固定流沙起到防风固沙的作用。最后草原还养育了很多动植物，增加了生物多样性，与此同时，草原上很多动植物具有使用和药用价值，可制作成大量的食品、药品及皮毛等原料，为人类的生产和生活提供了重要的生产资料。 传统的草原监测对于草原的估产以及草原承载力的计算提供了强有力的依据，但是传统的草原监测受制于人力、物力的影响，监测的空间范围和时间尺度都是有限的 [ 1 ] 。而随着遥感技术的发展，产生了大量的大范围多时相的草原遥感数据，并被广泛地应用于草原的生态以及承载力的监测上，对草原监测具有十分重要的意义 [ 2 ] 。与此同时大量的大范围多时相的草原遥感数据的分析、管理也成为了草原遥感监测的研究热点之一。传统的管理方式由于数据来源单一或者管理分析手段的限制，大量的数据资源中蕴含的有效信息尚未被完整的开发和揭示出来，许多数据和信息都不能相互配合，造成了大量的数据资源的浪费。为了解决这一痛点，本文以青海省海晏县作为试验区域，利用Esri公司推出的ArcGIS Engine二次开发技术使用C#语言开发了一套草原遥感数据管理系统，将多源多时相遥感数据集成到一个系统中，能够对草原多源多时相数据进行更加快速有效的管理和分析，以解决多源多时相的草原遥感数据资源浪费问题。"
"海晏县属于青海省海北藏族自治州，地理上位于青海湖盆地东北部、祁连山系大通山脉的西南麓，是黄河重要支流—湟水河的发源地，北接祁连县、门源县，东邻大通县、湟中县，南接湟源县、共和县，西邻刚察县，属高原大陆性气候，平均海拔3200 m以上，年降水量230 mm至499.5 mm，年平均温度 0.9℃，年均日照时间为2750 h至2980 h，绝对无霜期30 d，年有效积温(≥10℃) 922.2℃，无灾害天气情况发生 [ 3 ] 。全县草原面积占比为49.35%，草场资源丰富、类型多样，是全国草原生态牧业的试验区。  本平台数据来源主要分为以下几种：卫星数据，飞艇高光谱数据、无人机高光谱数据、无人机可见光数据以及地面手持多光谱数据。数据展示及部分采集设备如图1所示。其中卫星数据来自于海晏县2016~2018年三年内Landsat和MODIS遥感影像。飞艇高光谱数据是由蓝天号飞艇搭载的高光谱载荷所采集，此高光谱相机共有840个波段，波段范围为400~1000 nm，可获得9 cm的地面分辨率的高光谱影像。无人机高光谱数据主要来自于实验室自主研发的无人机高光谱相机，搭载在大疆经纬M600 pro无人机上，共有194个波段，波段范围为400~1000 nm，地面分辨率可达2.5 cm。无人机可见光数据来自于小型无人机大疆“御”自带相机以及大型无人机大疆经纬M600 pro搭载的禅思X5相机，其地面分辨率可达2 cm。而地面手持多光谱数据为实验室自主研发的六波段多光谱设备，可获取450 nm、550 nm、650 nm、750 nm、850 nm、960 nm波长的多光谱数据，分辨率可达毫米级。 图1. 卫星数据和采集数据的部分仪器。(A) 2016年7月5号海晏县全境的NDVI图；(B) (A)对应的网格；(C) 获取无人机高光谱的无人机及其搭载的高光谱相机；(D) 获取飞艇高光谱的飞艇；(E) 获取手持多光谱数据的设备"
"基于ArcGIS Engine的草原多源遥感数据管理系统是采用C/S架构，利用ArcGIS Engine可以为不同需求层次用户提供的全面的、可伸缩的GIS产品线和解决方案的优势，根据草原多源遥感数据的特点而开发出的数据管理系统。其主体可以分为以下几个模块：数据模块，计算模块、工具模块、显示模块和用户管理模块。设计图如图2所示： 图2. 系统架构图  主要采用ArcGIS中的文件地理数据库对各种数据进行存储和管理的，其数据类型主要包括两大类：原始数据和预处理后的数据。 原始数据主要有以下几种：卫星数据，飞艇高光谱数据、无人机高光谱数据、无人机可见光数据以及地面手持多光谱数据。原始数据的波段数和地面分辨率参数可参考表1。预处理后的数据主要有：5天间隔的融合影像、辐射校正和几何校正后的高光谱数据、拼接后的影像以及单点植被指数。其中对卫星影像的预处理步骤是根据目标区域2016~2018年三年内Landsat和MODIS遥感影像，利用STARFM (Spatial And Temporal Adaptive Reflectance Fusion Model)模型融合高时间分辨率的MODIS数据与中等空间分辨率的Landsat数据，得到时序Landsat数据 [ 4 ] 。并利用融合后的时序影像计算出目标区域的NDVI指数和植被覆盖度指数。飞艇高光谱数据和无人机高光谱数据的预处理首先是对高光谱数据进行辐射校正和几何校正，之后对校正后的高光谱数据进行光谱衍生变换，采用不同建模方法构建营养量的反演模型，最终得到目标区域的营养量图，如粗蛋白、粗纤维等 [ 5 ] 。无人机可见光数据的预处理是对无人机影像进行影像拼接，得到目标区域大范围的影像。之后利用公式计算得到基于可见光影像的植被指数，包括ExG、ExR、GRVI、RGBVI、TGI等指数 [ 6 ] 。地面手持多光谱数据的预处理步骤是利用单张多光谱影像计算出单张的植被指数数据，与此同时利用同步采集的多光谱影像的位置数据上采样得到目标区域的植被指数。 Table 1 数据类型 Data type 波段数 Number of bands 分辨率 Resolution/m 卫星数据Satellite data 7 30 飞艇高光谱数据Airship hyperspectral data 840 0.09 无人机高光谱数据UAV hyperspectral data 149 0.03 无人机可见光数据UAV RGB Data 3 0.025 地面手持多光谱Ground Handheld Multispectral 6 20 (测量点间距) 表1. 系统中各种数据类型的参数  现如今草原遥感数据大都是栅格数据，而ArcGIS Engine的查询和统计功能对栅格数据不太友好，对矢量数据的查询则比较快速高效。计算模块的主要功能将目标区域划分为网格，计算出每个网格内区域的属性均值，并将这些属性值赋值到网格的属性里，以供查询和统计模块快速有效的获取当前位置的属性值。 其原理是调用渔网工具，生成网格，以及给网格赋值。创建渔网需要三组基本信息：渔网的空间范围、行数和列数以及旋转的角度 [ 7 ] 。本系统会根据不同的数据选择不同的参数来进行渔网的创建，比如在对卫星影像数据进行渔网创建时，使用旋转角度为0、大小为2 km × 2 km的网格来对海晏县全境进行网格划分，卫星影像网格划分示意图如图3所示。在对无人机影像数据进行渔网创建时，使用旋转角度为0、大小为10 m × 10 m的网格来对海晏县全境进行网格划分，无人机影像网格划分示意图如图4所示。在完成网格创建之后，就需要给网格赋值，步骤如下：首先给生成的网格添加字段，字段内容为所有需要查询和管理的植被指数名称。之后根据网格坐标范围确定每个网格的覆盖范围，将覆盖范围内所有的植被指数等栅格数据分别求得均值，并将每个网格内的植被指数等数据求得的结果写入对应网格的对应字段中。表2展示了卫星数据的网格参数属性表。 图3. 卫星数据以及其对应的2 km × 2 km的网格图 图4. 无人机原始影像以及其对应的10 m × 10 m的网格图 Table 2 Id Dem/m EVI/% NDVI/% 降水量 Precipitation/mm 湿润度 moisture index/% 1 3194 0.010795 0.0707 435.0086 2.797762 2 3194 0.0081 0.022331 435.3927 2.803571 3 3194 0.006751 0.110091 436.159 2.815067 4 3194 0.00303 0.285714 436.7814 2.824918 5 3194 0.2109 0.1025 437.248 2.832219 6 3194 0.19871 0.1222 431.6496 2.756019 7 3194 0.015904 0.009462 432.3522 2.765264 … … … … … … 表2. 卫星数据网格参数属性表(部分)  工具模块主要由以下几个部分组成：属性编辑、查询和统计、输出打印以及基础地图工具。其中属性编辑是可以对矢量图层进行编辑的工具，既可以单个元素修改也可以批量修改，其目的是对一些错误的数值进行修改或者对一些矢量元素的属性值进行人工输入。界面如图5所示，点击开始编辑之后，选择想要编辑的区域，即可在系统弹出的属性表中修改和添加当前区域的属性值。查询和统计是一种多条件查询工具，可以利用SQL语句对符合条件的区域进行查询和统计。比如想要知道所有鲜重大于115的网格，只需要在查询窗体的SQL语句输入框内输入“鲜重 > 115”，点击查询即可，符合结果的网格会高亮显示，查询结果的详细信息会在另一窗格里以表格的形式存在，并支持导出成表格以供其他系统使用，查询界面以及查询结果如图6所示。输出打印是系统必备数据输出功能，可以做到将当前地图作为图像输出或打印，以及对输出打印的地图添加图例、指北针、比例尺、地图标题等功能。基础地图工具模块主要是一些对地图操作的工具，主要包括打开、保存、添加数据、全图显示、放大、缩小、手型工具、书签工具、信息工具以及元素选择工具。 图5. 属性编辑 图6. 网格快速查询  显示模块主要负责地图主界面、图层窗格的显示以及鹰眼和专题图制作等功能。地图主界面显示调用的是ArcGIS Engine中的axMapControl控件，主要用来作为各种数据显示的主界面。图层窗格调用的是ArcGIS Engine中的axTOCControl控件，用来显示当前主界面数据的所有图层信息，并且利用contextMenuStrip控件实现了在axTOCControl上的右键功能，可以实现删除移动图层，缩放到图层以及打开属性表等操作。而鹰眼的功能是利用另一个axMapControl控件来实现的，表示数据视图中的地理范围在全图中的位置，与数据视图的地理范围保持同步，数据视图的当前范围能够在鹰眼视图中用一个矩形框标示出来。若数据视图的显示范围发生变化，鹰眼视图中的矩形框位置也会发生变化，在鹰眼中操作视图，数据视图中的地理范围也将同步调整。当鹰眼中用鼠标点击时，数据视图能够移动到被点击的位置。拖动矩形框可以调整数据视图中的地图显示范围；在鹰眼视图上拖动矩形框时，数据视图能够以全图显示矩形框内的内容。专题制图是按照特定专题来渲染地图的过程，专题制图通常使用数据集中的一组或多组数据利用颜色渲染、填充图案、符号、条形图和饼图的方式表示数据，根据数据中的数值来渲染颜色或者图案和符号，以创建专题地图 [ 8 ] 。本系统采用四种渲染方式：分级颜色、饼图、条形图和堆叠图，用户可以根据不同的数据类型选择不同的数据渲染方式，以达到更好的渲染效果，生成更加符合并突出数据特点的专题地图。  从数据的安全性方面考虑，本系统必须具有权限管理功能。因此本系统开发了用户管理模块，主要包括用户的注册、账户名密码设置以及用户权限设置密码修改等功能。确保不同用户接触到的数据等级不同，从而更有效的保证数据的安全性。"
"为满足草原遥感多源数据的有效管理和快速分析的需求，本系统利用ArcGIS Engine技术完成了草原多源遥感数据管理系统的设计与开发。实现了对青海省海晏县草原多源遥感数据管理与快速分析，为草原生态管理和草原生产力的估算提供了快速有效的数据信息，能够帮助草原管理部门更加科学有效地指导放牧和进行生态保护。论文对基于ArcGIS Engine的草原多源遥感数据管理系统的设计，主要完成了以下三点研究工作： 1) 将卫星数据，飞艇高光谱数据、无人机高光谱数据、无人机可见光数据以及地面手持多光谱数据等多源多时相草原遥感数据集中到一个系统中，系统利用对多源数据的分析可以得到比单一数据分析更加准确和全面的结果，对决策者提供更加有效的决策支持。 2) 本系统实现了对多种遥感数据的基本操作，包括鹰眼图、图层窗格、属性编辑、书签、元素选择等工具，方便了用户使用本系统。其次系统还加入了专题图制作以及输出打印功能，能够方便用户快速有效地导出当前数据的专题地图，满足了系统快速可视化的需求。 3) 为了卫星影像或无人机影像等栅格数据进行快速查询和统计，系统实现了网格化影像功能，将影像栅格数据转化成矢量数据，可以极大地加快查询和统计的时间和效率。"
