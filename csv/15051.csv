"为了给运煤车喷洒抑尘剂，需要识别火车车厢之间的钩铛。基于计算机视觉的火车钩铛识别只需在站台一侧安装摄像头，对拍摄到的图像序列进行处理从而识别出钩铛。由于光照、天气等诸多因素的影响，首先采用直方图均衡算法对图像进行增强，然后提取图像的LBP纹理特征和直线特征，并进行特征融合，选用SVM (Support Vector Machine)分类器，针对不同的目标通过离线训练的方式获得SVM模型参数。针对四类目标训练了相应的SVM模型，分别为车头、车厢、钩挡和车站，对拍摄的运煤车视频图像可以实现在线识别。经过初步实验验证，提出的钩铛识别系统能够自动识别火车钩铛的开始和结束，从而控制喷洒系统，且安装简单，能够最大程度的减少抑尘剂浪费。 关键词 :计算机视觉，视频处理，特征提取，特征融合，火车钩档识别"
"煤炭在铁路装车时，均采用敞篷车皮。为了防止煤炭在运输过程中被风吹散，需要在煤炭表面喷洒一层抑尘剂。一般情况下装车和喷洒是两个过程，人工装车和自动喷洒。在自动喷洒的过程中，由于车厢与车厢之间存在空隙(这个空隙被称为钩挡)，如果一直开启喷洒装置，喷洒完整列火车会浪费10%左右的抑尘剂。长期累积，会造成两方面的损失，一是抑尘剂浪费严重，二是环境污染。因此，在自动喷洒抑尘剂时，需要识别火车车厢与车厢之间的钩挡，同时为了自动开启和关闭喷洒系统，需要识别火车头和尾。 钩挡识别主要是识别出车厢的结束(即钩挡开始)和开始(即钩挡结束)，当车厢结束时发送关闭信号给喷洒系统，当车厢开始时发送打开信号给喷洒系统。一般的，在铁路两边放置一对红外线装置可以很精确的识别出钩挡的开始和结束。但是存在两个比较困难的问题，第一，红外线装置反馈出的信号太简单，对一些复杂的情况无法识别，例如当火车头经过时不应该喷洒的，当火车倒车时也不应该启动喷洒。第二，红外线装置通常都是在火车两侧成对铺设，如果火车的一侧没有站台，那么这一侧红外线装置的电源引接比较困难。而用计算机视觉的方法，只需要在站台一侧安装摄像头，就可以解决红外线装置遇到的困难。 目前将计算机视觉技术应用于火车识别已经很常见，绝大部分解决的是识别火车车号、标牌的问题[ 1 ] -[ 3 ] ，并未见到对火车钩挡识别方法有相关文献报道。本文用图像处理方法设计的火车钩挡识别系统，能自动识别出火车钩挡的开始和结束，从而控制喷洒系统，不仅能最大程度减少浪费，而且安装简单。"
"基于计算机视觉的钩挡识别系统需要在站台的一侧近距离架设摄像头一个，对获取到的视频图像采用图像处理方法检测和识别钩挡，实际距离在2~3米，以火车车厢的上下沿占满图像为最好。具体思路是对摄像头获取到的当前图像提取特征，经过特征融合，在一定策略的支持下判断出是否存在钩挡，并反馈信息。 钩挡识别系统的流程如图1所示。主要包括两大模块：计算机视觉分析和钩挡识别。 图1. 系统流程图 计算机视觉分析包括图像增强、特征提取和特征融合 [ 4 ] 。由于实际场景中的干扰因素很多，如刮风、下雨、昼夜更替，需要增强图像，提高图像质量。特征提取是识别的基础，优良的特征可以从很大程度上提高识别率。提取多种类型的底层特征，通过融合可以克服天气变化和光线变化带来的干扰。 钩挡识别模块主要对融合后的特征矢量进行分类匹配，从统计学的角度出发，对当前目标进行聚类，给出各类别的概率，然后用极大似然准则得到最后的钩挡识别结果。"
"在车站室外监控场景中，对钩挡识别影响最大的是昼夜更替和灯光开关，都会引起图像的亮度变化，亮度的变化对某些特征的提取不利，例如颜色、直方图等。可以采用直方图均衡化的方法调整图像的全局对比度，拉伸图像的直方图，使亮度均匀的在直方图上分布 [ 5 ] 。 本文采用的直方图均衡方法基本思路是：对原始图像灰度直方图中第 级有灰度 ，根据其左右两 边 和 之比来确定其修正后的灰度 的位置 ： (1) 经整理得： (2) 因为 ， ， 为灰度级为 的像素数， 为整幅图像的总像素数，所以(2)式可进一步变换为： (3) 具体实现过程为： 第一步：得到原始图像的灰度级 ， 第二步：统计各灰度级的像素数 ， 第三步：作灰度映射表 第四步，将得到的每个cell的统计直方图进行连接，就得到了整幅图的LBP纹理特征 ，然后便可利用SVM或者其他机器学习算法进行分类。  直线是一种数学上简单的中层描述符号，利用它可以描述许多人造目标。运媒火车车厢尾部通常会安装梯子，方便人员对车厢进行维护，梯子的直线特征比较多，而车厢的其他部分的直线特征比较少。通过检测直线及线间的关系，可以辅助检测钩挡位置。 由于钩挡检测过程在室外实施，外界环境时常发生变化(昼夜交替、天气变化等)，所获得的原始图像亮度、对比度经常变化。为了适应环境的变化，算法的鲁棒性就很重要。本文采用了Burns等人提出的相位编组法提取直线[ 7 ] ，该方法克服了已有算法只依据图像梯度的幅度信息提取直线的缺点，因而在提取低对比度直线时有明显优势。该方法主要有四个步骤： 第一步：计算梯度，用Sobel算子或Robert算子得到梯度的幅值和方向角； 第二步：梯度方向图分割，通过得到的方向角，采用固定分组的方法进行梯度方向分割，即将360度平均分为8个区域，每个区域45度，分别标记为0，1，2，…，6，7形成标记图，将有相同标记的像素划分为一组； 第三步：连接直线支持区域，一条边缘可能会被分为若干个相距较近且编码相同的直线支持区，将同属于一条边缘的直线支持区进行连接，形成更长的直线支持区； 第四步：直线支持区拟合直线，采用最小二乘法确定最后的直线方程参数。 图4给出了对车厢进行直线提取的结果，从中可以看出钩档开始(车厢尾部)时的水平直线特征明显多于车头和车厢中间。 将提取到的直线特征形成特征矢量 如下： (4) (5) 图3. LBP算法邻域示例 图4. 直线提取结果 其中， 为直线的端点， 为直线的长度， 为直线的方向。将直线 按照从上到下，从左到右的顺序形成矢量 。  为了给分类匹配提供合适的数据，需要把上面提取出的特征进行融合。由于对于该应用来说，直线特征比较重要，因此，将纹理特征和直线特征通过线性加权的方式组合起来，形成当前视频帧的特征矢量： (6) 其中， 为加权系数。当然融合的方法还可以选择其他的。"
"钩挡识别的过程主要分两步：离线训练和在线识别。离线训练主要用已标识过的数据训练SVM分类器参数。在线识别用已训练好的SVM分类器识别新的数据。  由于识别环境在室外，图像数据受外界光照变化影响比较大，因此，需要在各种光照条件下对SVM分类器进行训练，主要包括：早晨、中午、傍晚、晚上、阴天、雨天、雪天、雾天等。 SVM训练的主要思路[ 5 ] 是：构建核函数，然后用测试集验证准确率，当达到满足需要的准确率后，就可以对新数据进行识别了。 本文中SVM的核函数选取为径向基内核RBF函数 (7) 其中 为核函数的宽度。RBF核函数可以将一个样本映射到一个更高维的空间，但需要确定的参数要少，使得计算复杂度不高。 在进行 参数选择时采用 交叉验证的方法，即将训练数据集分成 份相等的子集，每次将其中 份数据作为训练数据，而将另外一份作为测试数据。这样重复 次，根据 次迭代后得到的最小均方误差MSE平均值来估计期望泛化误差，最后选择出最优的参数 。  离线训练好的SVM模型可以对四类目标进行识别，分别是：车头、车厢、钩挡和车站(摄像头前无火车)，综合上面的分析整个钩挡识别的流程如图5如示。"
"本文的实验视频采用704 × 576的分辨率，分别对C64、C70两种运煤车进行了白天和夜晚钩档识别测试。首先对两种运煤车分别完成了3小时的钩档识别训练，采用人工标注的方法进行识别，然后用SVM模型对标注结果进行学习，最后再实现在线识别。结果如图6和图7所示。 图6为C64识别结果，图7为C70识别结果，为了提高运算效率，测试时选取了100 × 250的识别框，算法只在该识别框中运算。从识别结果中看，该算法能较准确的识别到钩档的开始和结束，经过多次测试，识别率如表1所示。 从表1中可以看到，钩档识别算法在白天的识别率要高于晚上，这是由于晚上站台上开启了较强的照明灯，灯光使得某些特征变弱甚至消失。同时C70比C64的识别率高，这是因为C70的车皮比C64 图5. 在线钩挡识别流程 Table 1 车厢类型 测试时间段 测试时长 识别率 C64 白天 1小时23分42秒 96.2% 夜晚 1小时3分15秒 90.7% C70 白天 1小时15分21秒 98.4% 夜晚 1小时30分07秒 93.1% 表1. 钩档识别率 的要新、干净，因此C70的特征较丰富，准确率就会提高。"
"本文基于计算机视觉的方法提出了一个有效的火车钩挡识别系统，能自动识别出火车钩挡的开始和结束，从而控制喷洒系统，不仅能最大程度减少浪费，而且安装简单。该系统首先对视频图像做增强处理，然后从增强的结果中提取纹理、直线等特征，通过特征融合，用SVM模型对融合后的特征分类、识别。总之该系统的钩档识别率较高，具有一定的实用潜力。但该系统还需要做以下改进：1) 调整模型，提高夜晚的识别率；2) 由于是在室外，要实用必须适应全天候情况，因此要在复杂天气情况下测试。"
