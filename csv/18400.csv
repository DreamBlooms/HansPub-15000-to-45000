"研究基于粒子群优化自适应最小二乘法的电网谐波估计方法，针对自适应最小二乘(Recursive Least Square, RLS)算法对初始值敏感的问题，本文利用粒子群(Particle Swarm Optimization, PSO)算法得到最优化的电网谐波参数即状态向量的权重初始值，再利用自适应最小二乘法(RLS)对电网谐波参数进行参数估计。对静态和动态的电压信号进行仿真分析，并比较了不同的噪声环境下参数估计效果，最后还应用本文所提方法对电网动态子谐波和间谐波进行了仿真分析。仿真结果表明，与可变约束最小二乘方法(VCLMS)，遗传算法(GA)优化参数估计方法相比，本文所提方法估计效果更优。 关键词 :电能质量，谐波估计，粒子群算法，自适应最小二乘法"
"随着电力系统中非线性设备及负荷在电力网络中大量增加，由此而产生的谐波问题也越来越受到人们的重视。有效地治理谐波及其产生的一系列问题，提供更好更加优质的电能质量，对谐波的产生和扩散进行监视是十分必要的，电力系统谐波状态估计可以根据电网部分节点的测量值来估计整个网络的谐波状态，实现对谐波的有效监视 [ 1 ] 。 传统的电力系统谐波检测和分析方法有傅里叶变换(FT)、快速傅里叶变换(FFT)等。其中，快速傅里叶变换(FFT)适用于静态谐波分析，对时变的动态谐波会丢失精度，而且还会产生混叠、泄露和栅栏现象 [ 2 ] 。除此之外常用的有小波变换、卡尔曼滤波算法(Kalman filter, KF)、以及最小二乘算法等。文献 [ 3 ] 提出了一种基于Kalman滤波误差的电能质量扰动检测方法，采用线性卡尔曼滤波器的误差序列来实时检测电能质量扰动。卡尔曼滤波算法(KF)对有噪声的信号存在估计精度不高的问题，LMS算法因其具有方法简单，计算量小，易于实现且对信号的统计特性具有稳健性等优点 [ 4 ] 。近年来涌现出了很多的智能优化算法，利用这些智能优化算法结合最小二乘算法可以得到较好的谐波参数。文献 [ 5 ] - [ 7 ] 分别提出了先利用遗传算(genetic-algorithm, GA)、粒子群算法(PSO)以及改进的细菌觅食算法(Bacterial Foraging Optimization, BFO)来估计谐波的相位，然后再结合最小均方算法(LS)来估计谐波的幅值。文献 [ 8 ] 和 [ 9 ] 分别提出利用细菌觅食算法(BFO)、萤火虫算法(Firefly Algorithm, FA)结合自适应最小二乘法(RLS)来估计谐波的幅值和相位。 自适应最小二乘算法(RLS)是最小二乘算法的一类快速算法，由于采用了在每个时刻对所有己输入信号重估的平方误差和最小准则，克服了LMS算法收敛速度慢和信号非平稳适应性差等缺点。与LMS算法相比，RLS算法具有快速的跟踪能力 [ 4 ] 。由于RLS在估计谐波参数时，会对初始参数比较敏感，因此本文所提出利用粒子群算法得到最优化的电网谐波参数的初始值，再利用自适应最小二乘法对电网谐波参数进行估计，克服RLS算法初始参数敏感的问题。"
"粒子群优化(PSO)算法于1995年由Kennedy和Eberhart提出 [ 10 ] 。是从一组随机解出发，采用迭代的方法寻找最优解，用适应度来评价解的优劣，并通过追随当前搜索到的群体最优解和个体最优解来寻找全局最优。 在粒子群算法中，种群被称为粒子群，种群中的每一个个体被称为粒子，每个粒子有两个属性，分别是粒子的位置和粒子的速度。 k时刻N个粒子的位置可以表示如下 (1) 其中： ， ， 分别是粒子搜索的上限和下限。 k时刻N个粒子的速度可以表示如下 (2) 其中： ， ， 分别是粒子的最大速度和最小速度。 在PSO的每次迭代中，粒子群中的粒子的速度和位置更新公式如下： (3) (4) 其中：P i 是第i个粒子比较上一时刻的最好位置，通常记为pbest；P g 是所有粒子中的最好位置，通常记为gbest；r 1 和r 2 是两个均匀的随机数，它们服从如下均匀分布： ， ；ω为惯性因子，它的取值范围是[0,1]，当ω较大时，会促进全局搜索，当ω较小时，会促进局部搜索以改变搜索区域。c 1 和c 2 为加速常量，用来控制每一步迭代时粒子移动的步长，通常取为2。"
"一个含有加性噪声的离散谐波周期信号可表示为如下谐波信号模型 [ 11 ] ： (5) 其中：N为谐波的个数； 为对应次数谐波的幅值； 为对应次数谐波的相位； 为基波的角频率；T为采样周期； 为直流分量；v为加性的高斯白噪声。 将上式中的直流分量用泰勒公式展开，取前面的两项，忽略后面的高阶项，则直流分量可以近似等于如下： (6) 把(7)式代入(6)式中得： (7) 通过对(5)式做三角函数分解，令： (8) 将这些状态变量写成矩阵的形式： (9) 对应的，我们可以写出这些每个谐波的分量表达式如(12)所示： (10) 将上述表达式写成矩阵形式： (11) 考虑到直流分量，我们将直流分量也分别代入的两个矩阵中去，则矩阵W和X分别如下： (12) (13) 因此我们可以将谐波表达式(5)写成如下的矩阵形式： (14)  RLS采用了在每时刻对所有己输入信号重估的平方误差和最小准则，在最小均方算法(LMS)的基础上加入了指数加权因子l，其值的范围为 。其特点是时间越久，其数据信息对系数更新的贡献也越小 [ 12 ] 。用自适应最小二乘算法(RLS)来更新权重，更新公式如下 [ 13 ] [ 14 ] ： (15) (16) (17) (18) 其中：K为增益因子；(为遗忘因子；P为误差协方差， ；I为单位矩阵。 从(12)式中可以看出，W中包含的2N + 2个状态量即为这N个谐波信号的权值以及直流分量的权值，也就是谐波信号的参量。我们可以计算出对应谐波的幅值和相角，计算公式如下： (19) (20) (21) (22) 以上就是RLS的权重更新公式，接下来我们通过PSO算法来寻找出最优化的初始权值W 0 。 PSO-RLS算法的具体的步骤流程图如图1。"
"为了比较出每个算法的优劣，我们采用均方根误差(Root Mean Square Error, RMSE)来衡量估计值与理论值之间的偏差，以便评估每个算法的性能。性能指标——均方根误差公式由下式给出： (23) 其中：d(k)为k时刻的期望信号，y(k)为k时刻的信号的估计值。性能指标函数计算从k = 1的起始时刻到k = N时刻的平方误差的平均值，表现出了整体的平均估计效果，在同等条件下，RMSE的值越小，算法的估计效果更好。  考虑形如(24)的含直流衰减的稳态信号： (24) 图1. PSO-RLS算法流程图 其中：f 1 = 50 Hz，f 3 = 150 Hz，f 5 = 250 Hz，f 7 = 350 Hz，f 11 = 550 Hz，v(t)为高斯白噪声。 我们给出了信噪比为10 dB和40 dB的条件下本文提出的算法的谐波信号估计效果以及与GA-RLS、VCLMS算法在信噪比为40 dB的性能比较。 从图2和图3中我们可以看出随着信噪比的升高，算法的估计效果会变好。图4和图5分别是PSO-RLS、GA-RLS、VCLMS三种算法在信噪比为40 dB时对谐波幅值的估计误差和基波相位的估计误差比较图，从图中可以看出PSO-RLS的估计效果要优于其他两种算法。 表1为三种算法对静态谐波的幅值和相位误差估计及误差对比，从表中的数据可以看出，对于基波，实际的幅值和相位分别1.5 p.u.和80˚，VCLMS、GA-RLS和PSO-RLS的幅值及相位估计误差分别为1.9967%、0.8267%、0.2467%和0.8076˚、0.6720˚、0.5371˚。可见PSO-RLS对幅值和相位的估计误差都要小于其他两种方法。  实际上，在大多数情况下谐波信号是随时间变化的动态信号。一个给定的动态信号由式(25)给出： (25) 图2. 在信噪比为10 dB下的实际曲线和估计曲线 图3. 在信噪比为40 dB下的实际曲线和估计曲线 图4. 信噪比为40dB下幅值RMSE比较 图5. 信噪比为40 dB下基波相位的RMSE比较 (26) 在给出的动态信号中，我们加入了三个不同的频率f 1 、f 3 、f 5 ，他们分别为3 Hz、2 Hz、7 Hz。从式中我们可以看出动态信号的幅值不是固定的，而是随着时间的变化而改变着的。 下面给出了PSO-RLS算法的谐波幅值估计图，如图6；并在高斯噪声和非高斯噪声环境下用三种算法对谐波信号进行了仿真分析，结果如图7~图10所示。 图6是PSO-RLS算法对动态信号的估计曲线和实际信号曲线的对比图；图7~图10展示了两种不同噪声下的估计误差曲线图，图7和图8分别为高斯噪声下的幅值估计误差和基波相位误差；图9和图10分别为伽马噪声下的幅值估计误差和基波相位误差。从估计误差中我们可以看出不论是在高斯噪声还是在非高斯噪声下PSO-RLS的估计误差都要低于其他两种算法。   在真正的的谐波信号中，不单单只有常规上的奇数次的谐波，还有小于基波频率的子谐波和非整数 Table 1 算法 参数 基波 三次谐波 五次谐波 七次谐波 十一次谐波 实际值 频率(Hz) 50 150 250 350 550 幅值(p.u.) 1.5 0.5 0.2 0.15 0.1 相位(˚) 80 60 45 36 30 VCLMS 幅值(p.u.) 1.4705 0.5048 0.1796 0.1329 0.0930 误差(%) 1.9667 0.9600 10.2000 11.4000 7.0000 相位 80.8076 61.4135 43.6830 33.2560 27.7366 误差(˚) 0.8076 1.4135 1.317 2.744 2.2634 GA-RLS 幅值(p.u.) 1.4876 0.4852 0.1823 0.1569 0.0943 误差(%) 0.8267 2.9600 8.8500 4.6000 5.7000 相位 79.3280 61.2374 47.0352 34.3547 26.7385 误差(˚) 0.6720 1.2374 2.0352 1.6453 3.2615 PSO-RLS 幅值(p.u.) 1.4963 0.5017 0.1991 0.1496 0.1017 误差(%) 0.2467 0.3400 0.4500 0.2667 1.7000 相位 80.5371 59.3401 46.0502 37.8950 31.7283 误差(˚) 0.5371 0.6599 1.0502 1.895 1.7283 表1. 三种算法的估计性能表 图6. 动态谐波实际曲线和估计曲线 图7. 高斯噪声下的幅值估计的RMSE比较 图8. 高斯噪声下的基波的相位RMSE比较 图9. 伽马噪声下的幅值估计的RMSE比较 图10. 伽马噪声下的基波相位估计的RMSE比较 倍的间谐波。为了测试我们的算法，我们给定如下的子谐波信号，其谐波频率f = 30 HZ，并在其中加入均值为零，信噪比为40 dB的高斯白噪声。并用三种算法对其进行仿真分析，仿真结果如图11~图13。 (27) (28) 图11. 动态子谐波(f = 30 HZ)和估计曲线 图12. 动态子谐波(f = 30 HZ)的幅值跟踪图 图13. 动态子谐波(f = 30 HZ)的幅值估计RMSE比较 其中：f 1 = 3 HZ，f 5 = 7 HZ。 图11~图13为动态子谐波的仿真图，图11是PSO-RLS对动态子谐波的估计曲线和实际曲线对比图；图12是三种算法对动态子谐波的幅值跟踪图；图13是三种算法的幅值估计误差图，可以看出，对于子谐波在三种算法中PSO-RLS具有最小的估计误差。可见对于动态子谐波PSO-RLS算法要优于其他的两种算法。  本节测试本文所提出算法对间谐波的估计性能。其动态间谐波形如式(29)，间谐波频率f = 190 HZ，并在其中加入均值为零，信噪比为40 dB的高斯白噪声。用三种算法对其进行仿真分析，仿真结果如图14~图16。 (29) (30) 其中：f 1 = 3 HZ，f 5 = 7 HZ。 图14是PSO-RLS对动态间谐波的估计曲线和实际曲线对比图；图15是三种算法对间态子谐波的幅值跟踪图；图16是三种算法的幅值估计误差图，可以看出，对于间谐波PSO-RLS同样具有最小的估计 图14. 动态间谐波(f = 190 HZ)和估计曲线 图15. 动态间谐波(f = 190 HZ)的幅值跟踪图 图16. 动态间谐波(f = 190 HZ)的幅值估计RMSE比较 误差。可见对于动态间谐波PSO-RLS算法也要优于其他的两种算法。"
"针对自适应最小二乘(RLS)算法在谐波估计时对初始权重敏感的问题，本文提出了基于粒子群优化自 适应最小二乘法的谐波估计方法。分别对稳态和动态谐波以及子谐波和间谐波进行仿真分析并与其它两种方法比较。从对比中可以看出，不论是静态或动态或者在不同的噪声下PSO-RLS对谐波的估计误差都是三者中最小的，所提出的方法在总体的估计性能上要优于其他两种方法。"
