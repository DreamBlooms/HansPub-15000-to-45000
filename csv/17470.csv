"基于BP神经网络算法，对H型传感器测厚系统采集到的感应差压信号进行分析处理。由不同厚度铝箔采集到的感应差压信号建立网络预测被测铝箔的厚度。 关键词 :BP神经网络，脉冲涡流检测，Ansoft Maxwell仿真"
"金属膜厚的在线检测与控制在工业领域的很多方面都有应用,比如：核反应燃料棒包覆层、飞机机翼厚度、金属板生产、精密机械加工以及化工容器的厚度检测。目前，测量的方法主要有接触法、超声法、射线法、电磁涡流法等。但是这些方法都有其缺点。射线法中的射线源会对环境及操作人员产生影响，需要配备防护措施，不够便捷；具有较高测量精度的接触法需要与被测试件接触，易对被测试件和传感器本身造成表面的损伤；超声法不具有很高的精度，且需要耦合剂来填补探头与被测试件之间的缝隙，来减小空气对检测的影响。脉冲涡流测厚具有高速高效、无需耦合剂、无需接触试件、结构简单、成本低等优点，能够在其他检测方法不能实施的情况下使用 [ 1 ] - [ 5 ] 。 本文属于脉冲涡流检测技术的研究。脉冲涡流检测是一种新型的无损检测方法，以电磁感应原理为基础，由检测线圈阻抗的变化，推断被检试件性能的变化。而线圈阻抗改变时，感应线圈中感应电压也会相应地改变，本文就是根据这个原理，通过H型传感器检测到的感应差压信号来预测被测铝箔的厚度。"
"对磁场变化敏感的元件都可以作为涡流传感器，如磁敏二极管、霍尔元件、线圈等。通过传感器中的电流、电压或者阻抗的变化来反映被测试件的参数的变化。本文中用线圈作为传感器，通过线圈中电压的变化来反映被测金属板厚度的变化。 本文中用到得H型传感器为自比较差动互感检测方式，支架为软磁铁芯，传感器由5个线圈组成，中间的线圈为激励线圈，激励信号供给激励线圈，其余四个线圈为感应线圈，将上端的两个线圈串联构成测量端，将下面的两个线圈串联构成参考端，再将上下两个端口反向连接构成差动模式。这个结构可以看成是由两个U型软磁铁芯背对背组合构成，两者具有共同的中间激励线圈，其中一端为测量端，另一端为参考端。 这样的结构设计不仅使得传感器具有较高的灵敏度，并且降低了背景信号的影响，使环境温度、环境磁场变化对传感器影响较小。将测量端和参考端的线圈进行差动连接，即得到感应差压信号。通过对这个感应差压信号的采集与分析处理即能得到导电材料的相关参数，比如本文中被测铝板的厚度。"
"选用Ansoft Maxwell这一电磁场有限元分析和电磁设计软件 [ 6 ] 对H型传感器进行建模仿真，对H型传感器施加脉冲激励，对比分析不同厚度的铝板得到的感应差压信号。构建H型传感器模型如图1所示。 对测量端和参考端的感应电压进行仿真，并用测量端减去参考端的感应电压计算得到感应差压，见图2。 变化的磁通在被测金属试件中感应出涡流，而涡流磁场对测量端感应电流产生的磁场有相互作用，所以测量端得到的感应电压绝对值比参考端得到的感应电压绝对值要小，用测量端得到的感应电压信号减去参考端得到的感应电压信号就得到与被测金属试件性能相关的感应差压信号。这个感应差压信号可用于下面的有关被测金属参数的研究，在本文中为被测铝板厚度的研究。 图1. H型传感器模型 图2. 脉冲波激励下三种感应电压信号对比图 改变被测铝板的厚度，得到不同厚度下的感应差压信号，如图3所示。 由图3可以看出，铝板厚度越大，感应差压信号的峰值的绝对值越大，并且整个波形图越向后偏移。在峰值部分的感应差压信号区分明显，集中地反映了被测铝板厚度的变化，有利于后续特征信号的提取和算法的处理分析。"
"实验测厚系统原理图如图4所示。 得到1~20层不同厚度的被测铝箔对应的感应差压信号，如图5所示。 图3. 不同厚度下的感应差压信号波形图 图4. 实验测厚系统结构原理图 由图5可以看出，实验采集得到的感应差压信号与软件仿真得到的感应差压信号相似。对于不同厚度的铝箔，具有不同的感应差压信号；随着厚度的增加，感应差压信号的峰值的绝对值也在逐渐增大，并且波形图也越向后偏移。即便该实验系统的环境不同于软件仿真的真空环境，存在其他一些可能的电磁干扰带来的噪声，但由图5可以看出该实验系统得到了与软件仿真相似的结果，证明H型传感器能够由不同厚度的铝箔检测得到不同的感应差压信号，能够用于检测铝箔的厚度。"
"BP网络的设计主要包括输入层、隐含层、输出层神经元个数，各层之间的激活函数，初始值以及学习率等几个方面 [ 7 ] - [ 11 ] 。 图5. 不同厚度的感应差压信号对比图  Hecht-Nielson在1989年说明对于任何闭区间都可以用只有一个隐含层的BP网络去逼近一个连续函数。即任意n维到m维的映射都可以通过一个三层的BP网络来完成。那么可以通过三层即单隐含层的BP神经网络建立采集到的感应差压信号与被测铝箔厚度之间的非线性对应关系。将感应差压信号设置为网络的输入量，被测铝箔的厚度设置为网络的输出量。  网络输入层神经元数就是系统的特征因子(自变量)个数，输出层神经元数就是系统的目标个数。实验系统中每个特定厚度被测铝箔测试采集到的感应差压信号数量为1000，但是为了较快地完成网络训练，对这1000个感应差压信号进行预处理，以期得到较小的输入层神经元个数。 将五个周期1000个感应差压信号进行分割，在一个周期内进行对比，1~20层厚五个周期的感应差压信号图形具有相似性。选取20层厚被测铝箔五个周期的感应差压信号对比图如图6进行说明。在测量的起始阶段，即第一个周期的起始阶段，采集到的感应差压信号与其余四个周期相同时间点的感应差压信号相比有较大的偏差，因此忽略第一个周期的感应差压信号，将接下来四个周期的感应差压信号平均，得到脉冲激励下不同厚度被测铝箔四个周期平均后的感应差压信号，每个特定厚度相应地有200个感应差压信号值，将其作为BP神经网络的输入，即BP网络的输入层神经元的个数为200，以此增加网络预测精度并减少了网络的训练时间。由图7可以看出预处理后的BP网络输入信号有明显的差异性。 BP网络的目标为被测铝箔的厚度，即将BP网络的输出量设为被测铝箔的厚度，那么BP网络输出层神经元的个数为1。  已有理论证明：具有偏差和至少一个S型隐含层加上一个线性输出层的网络，能够逼近任何有理函数。因此本文设计的BP神经网络隐含层传递函数为S型传递函数tansig，输出层传递函数为纯线性函数purelin，能够输出任意值。 图6. 20层厚被测铝箔五个周期的感应差压信号对比图 图7. 四个周期平均后的感应差压信号对比图  学习速率的大小影响了每次迭代时权值的变化量。学习速率过大会使系统不稳定，训练的均方误差会出现震荡，学习速率过小会延长网络的训练时间导致网络速度变慢，但是能使网络的误差值在不跳出误差表面低谷的情况下趋于最小误差值，因此一般会选择取较小的学习速率来保证系统的稳定性，一般在0.01~0.7之间选择，文中设计的BP网络设置BP学习速率为0.01。  本文中使用单隐含层BP神经网络，则整个网络的精度依赖于隐含层神经元的个数。隐含层神经元个数的选择是一个比较复杂的问题，如果神经元个数太少，从样本中获取信息的能力差，不能概括和体现样本规律，容错性差，识别未经学习的样本能力低，如果神经元个数太多，则会增加网络训练时间，并且可能将样本中非规律的东西(干扰、噪声等)存储进去，降低泛化能力，出现“过度吻合”的问题。可根据经验参照以下公式进行设计： 。 其中， 为隐含层神经元个数， 为输入层神经元个数， 为输出层神经元个数， 为1~10之间的调节常数。可用试凑法进行试验，采用同一样本，对其进行训练，开始时隐含层的神经元个数较小，然后逐渐递增，计算网络误差，根据网络误差来确定隐含层神经元的数量，网络误差最小的那一个就是最佳解。在本文中设计的BP网络中，输入层神经元个数为200，输出层神经元个数为1，对相邻的神经元个数也进行观测，因此计算隐含层神经元的个数在(15, 26)之间的网络误差。以1至19层厚被测铝箔的感应差压信号数据作为训练样本，20层厚被测铝箔的感应差压信号数据作为检测样本，即网络的期望输出值为294，观察隐含层神经元个数不同时的BP网络训练过程、系统误差和预测值。 因为网络的初始权值和阈值是随机给定，所以每一次网络的预测值不同。当隐含层的神经元个数为(15, 26)中的某一特定值时，连续30次测试网络，观察预测值、预测值与期望值之间的误差百分比及网络的相关系数，并比较误差百分比、预测值及偏差值。 当隐含层神经元个数为26时，网络预测值的误差百分比的平均值达到最低，平均值最接近期望值，且平均偏差值也最小，也就是说隐含层神经元个数为26的网络预测能力更佳。该网络进行10次迭代运算后低于设定的最小均方误差之后，结束了训练。样本的训练集(train set)、验证集(validation set)和测试集(test set)的拟合程度都较高。其中训练集用来估计模型，验证集用来确定网络结构或者控制模型复杂程度的参数，而测试集则用来检验最终选择最优的模型的性能。 综合考虑网络的预测值、预测值误差百分比、预测偏差值及网络的相关系数这四个因素，选定隐含层的神经元个数为26。  综上所述，本文采用只有一个隐含层的BP神经网络，输入层神经元个数为200，隐含层神经元个数为26，输出层神经元个数为1，隐含层的激活函数为tansig函数，输出层的激活函数为purelin函数，学习速率为0.01，最小均方误差为0.000001，采用trainlm训练算法。 使用预处理过的1至19层的采集数据作为训练样本，将预处理过的20层——294 um厚被测铝箔采集的数据作为检测样本。首先对所有样本数据进行归一化处理，再进行训练和预测，最后进行反归一化处理得到检测样本的预测值。 对如上设置的网络进行多次测试，记录其预测值，然后平均这些预测值，可以得到精度较高的结果。如上设置的网络平均预测值为292.895546 um，与期望值294 um只有1.104454 um的差距，说明如上设置的BP神经网络可以用来建立采集到的感应差压信号与被测铝箔厚度之间这种非线性、有噪声的函数关系，可以用其来预测被测铝箔的厚度，并且能够达到较高的精度。"
