"图像拼接是一种常见的图像篡改手段。对拼接过的图像进行盲检测可以有效鉴别图像是否经过人为篡改。针对图像盲检测中经常用到的质量参数特征进行了改进：首先对图像进行离散小波变换，然后提取小波变换后的四个子波带的质量参数特征；最后将得到的特征输入到支持向量机(SVM)中进行分类。在哥伦布比亚图像拼接评测彩色库上进行试验，证明了小波域上的质量参数特征比之前的质量参数特征有更好的表现，达到了93.39%的识别率。 关键词 :离散小波变换，图像质量参数，支持向量机，图像拼接检测 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"与以语言和文字为主的传统交流方式不同，图像是一种直接的、天然的信息表达方式，它不要求信息手中具有特定知识即可完成信息传达，在现今社会中占据重要地位。随着功能强大的图片处理工具，如Photoshop、Microsoft paint等的出现，图像编辑、修改更加容易。数字图像防伪鉴定近年来成为信息安全领域的新兴且极其重要的研究课题，同时是图像媒体内容安全的关键技术。拼接篡改是最常用的图像篡改方式之一，本文主要研究图像拼接篡改的检测方法。 图像篡改检测主要分为两种方法，即主动检测方法和被动检测方法 [ 1 ] 。主动检测主要依靠事先在图像中嵌入的数字水印 [ 2 ] 和数字签名 [ 3 ] 来对图像的真实性进行判断。但是由于这种方法对拍摄图像的设备有特殊要求以及数字水印和签名的脆弱性，并不具有普适性。在大多数情况下，需要被检测的图像都是不含有数字水印或者签名的。这就需要被动检测技术又称盲检测。盲检测是仅依靠图像内容特征来对图像的篡改行为进行检测。 国内外在图像篡改盲检测方面的研究工作集中在两方面：一方面是基于单一特征在篡改前后的变化进行检测鉴定。国外主要研究成果有：利用图像光照不一致性进行检测 [ 4 ] ；基于CFA插值模式特征的检测算法 [ 5 ] ；基于图像重采样痕迹的检测算法 [ 6 ] ；基于DCT域共生矩阵的算法 [ 7 ] 。该类方法不需要图像库训练分类器，直接对图像进行鉴定，但有其局限性，准确率偏低。另一方面是基于图像多特征要素加以综合分析，通过在图片库中训练分类其来达到检测篡改的目的。基于希尔伯特–黄变换(HTT)和离散小波变换的特征 [ 8 ] ；马尔科夫和统计矩特征 [ 9 ] ；基于离散小波变换特征函数和二阶相位不一致性的特征 [ 10 ] 。国内的工作主要有图像信息熵和多步马尔科夫特征相结合 [ 11 ] ；张震 [ 12 ] 和任远 [ 13 ] 的基于图像高斯滤波的图像质量评价量(Image quality measures, IQMs) [ 14 ] 特征。本文提出了一种新的基于图像小波变换子波带质量参数特征的盲检测模型，在哥伦比亚彩色拼接图像库上达到了93.39%的识别率。"
"小波变换首先要选取母函数，经变换得到各级小波函数，然后将信号分解为小波函数的级数，即得到小波参数 [ 15 ] 。本文对图像分级所采用的是可分离正交镜像滤波器，如图1(a)所示(从上倒下依次是0阶、 图1. 离散小波变换过程示意图 1阶和2阶，从左到右依次是低通、垂直、水平和对角方向)，其将图像内容以不同的尺度和方向进行分解。图像沿水平和垂直方向与低通和高通滤波器进行运算，可以得到低通、垂直、水平和对角子带，用 i = 1 , 2 , ⋯ , n 表示尺寸，用A表示子带，V、H、D表示方向，则对应子带可记为A i 、V i 、H i 、D i 。以一个圆盘图像的三阶小波分解为例，各子带如图1(b)所示。"
"Avcibas研究了图像的客观质量评价量及其统计特性 [ 16 ] [ 17 ] ，其主要方法是将待检测图像进行一个高斯滤波，然后比较二者在统计特性方面的差异。当使用拼接技术对一副数字图像进行处理后，可认为该图像被引入了一定程度的噪声，即该图像某个区域的图像质量评价量发生了变化。为了得到并表征这种变化，本文将整幅图像进行一阶离散小波变换，然后提取四个子带的图像质量参数作为特征。Avcibas提出了26个图像质量参数，经过筛选、分析和对比，本文选取了对图像拼接操作较为敏感、计算复杂度较低的6个评价量，其计算方法如下： 1) 基于图像之间像素差异的图像质量参数的计算相较于其他质量参数比较简单，而且在某些情况下有不错的表现。因此，这类直观的质量参数也是被最早应用的一类参数。在图像拼接检测中，如果拼接区域和原图像的其它部分内容差异较大，那么这一类质量参数可以很敏感捕获到由拼接带来的边缘信息。该类质量参数有分别表是图像和滤波版本之间像素统计差异的平局绝对误差和均方差的 D 1 、 D 2 ： D 1 = 1 K ∑ k = 1 K { 1 N × M ∑ i = 0 N − 1 ∑ j = 0 M − 1 | C K ( i , j ) − C ^ K ( i , j ) | } (1) D 2 = 1 K ∑ k = 1 K { 1 N × M ∑ i = 0 N − 1 ∑ j = 0 M − 1 | C K ( i , j ) − C ^ K ( i , j ) | 2 } 1 2 (2) 其中： C K ( i , j ) 表示待检图像中第i行j列像素的第K (RGB图像中K = 1，2，3)通道值。 C ^ K ( i , j ) 表示待检图像高斯滤波后第i行j列像素第K通道值，图像大小为 N × M 像素，下同。 2) 基于图像和它的滤波版本之间相关性的度量，包括图像保真度度量 D 4 和归一化相关度量 D 5 ： D 4 = 1 − [ 1 K ∑ k = 1 K 1 N × M ∑ i = o N − 1 ∑ j = 0 M − 1 [ C K ( i , j ) − C ^ K ( i , j ) ] 2 ∑ i = 0 N − 1 ∑ j = 0 M − 1 [ C K ( i , j ) ] 2 ] (3) D 5 = 1 K ∑ k = 1 K ∑ i = o N − 1 ∑ j = 0 M − 1 C K ( i , j ) C ^ K ( i , j ) ∑ i = 0 N − 1 ∑ j = 0 M − 1 [ C K ( i , j ) ] 2 (4) 3) 基于图像和它的滤波版本之间谱差异度量，包括基于傅里叶谱幅值差异度量 S 1 ： S 1 = 1 K ∑ k = 1 K 1 N × M ∑ u = 0 N − 1 ∑ v = 0 M − 1 | φ ( u , v ) − φ ^ ( u , v ) | (5) 其中： φ ( u , v ) = arctan ( Γ ( u , v ) ) Γ K ( u , v ) = ∑ n = 0 N − 1 ∑ m = 0 M − 1 C K ( m , n ) exp ( − 2 π i m u N ) ⋅ exp ( − 2 π i n v M ) ; K = 1 , ⋯ , K 4) 基于图像和它的滤波版本之间人眼视觉系统的度量，即归一化均方差 H 1 ： H 1 = 1 K ∑ k = 1 K ( ∑ i = 0 N − 1 ∑ j = 0 M − 1 | U { C K ( i , j ) } − U { C ^ ( i , j ) } | ∑ i = 0 N − 1 ∑ j = 0 M − 1 | U { C K ( i , j ) } | ) (6) 其中： U ( C K ( i , j ) ) = D C T − 1 ( H ( u 2 + v 2 ) Ω ( u , v ) ) H ( ρ ) = { 0.05 e 0.554 ρ , ρ < 7 e 9 | n ρ − ln 9 | 2.3 , ρ ≥ 7  在提取特征的过程中对每一幅图像进行如下操作： 1) 将彩色图像转化为0~255范围的灰度图像。 2) 将图像进行一阶离散小波变换(这里选取Haar小波函数作为母函数)。 3) 对图像小波变换后得到的四个子带：A、H、D、V分别由(1)~(6)式计算他们的质量参数。 特征提取过程如图2所示： 这样对于每幅图像的四个子带都各有6个质量参数特征，一共是 4 × 6 = 24 维特征向量。"
"目前图像篡改检测领域供公开测试的权威样本库是哥伦比亚大学拼接图像库，又独立分为无压缩彩色图像拼接检测哭和灰度图像拼接检测库。彩色库拥有363张图片(图3)，其中真实图像有183张，拼接图 图2. 特征提取过程示意图 像有180张，图像大小从 757 × 568 到 1152 × 768 不等，格式为tiff，由几部不同的相机拍摄，拼接图像的来源可以是同一个相机也可以是不同的相机，且没有平滑处理等后续操作 [ 18 ] ，有利于针对拼接进行实验和分析。 为了评测所提取特征检测操作的有效性，将在彩色库上进行试验。将彩色图像库的图像转换为灰度图像。从RGB颜色空间提取亮度信息转换为灰度图像的常用公式如下式所示： Y = 0.299 R + 0.587 G + 0.114 B  支持向量机(Support Vector Machine, SVM)是一种基于统计学习理论的模式识别方法。本文选用LIBSVM [ 19 ] 作为分类器，径向基函数(RBF)作为核函数。对测试图库随机分为六份，其中五份即153张真实图片和150张拼接图片作为训练集，一份即30张真实图片和30张拼接图片作为测试集，进行交叉检验，最后取平均值作为识别结果。训练时用网格搜索方法寻找最佳的c和g参数。分类算法流程如图4所示。  现在彩色库上进行实验与其他特征进行对比，如彩色质量参数特征 [ 12 ] ，小波域统计矩特征 [ 9 ] 、小波域马尔科夫特征 [ 20 ] ，结果如表1所示。通过对比可知，本文提出的特征具有较高的识别率：93.39%，高于其他特征。还将矩特征，小波域马尔科夫特征和本文特征分别作了受者操作特征曲线(Receiver Operating Characteristic Curve, ROC)，如图5所示，比较识别过程的灵敏度和特异度，本文特征显示了最好的综合诊断准确性。 随机从彩色库中选取了五幅图片，分别记录了对于不同特征他们的特征提取时间，还记录了不同特征的模型训练时间，以期比较他们之间的时间复杂度，结果如表2。 从表2可以看出，相较于其他特征本文特征在特征提取和训练上时间复杂度都有明显下降。"
"本文提出了一种基于图像离散小波变换的图像质量评价量的拼接盲检测模型。该模型首先对图像进行离散小波变换，然后提取一阶变换后的四个子波带作为计算质量参数的原图。通过公式计算出每个子波带的6个质量参数，得到24维特征向量。将特征输入到SVM训练分类器。最后，比较了本文的小波域质量参数特征和其他特征的识别率等指标。结果显示本文在哥伦比亚彩色拼接图像库上的识别率达到 图3. 彩色图像库中的图片 图4. SVM分类算法流程 图5. 彩色库质量参数特征roc曲线 Table 1 提取特征 维数 识别率 AUC TP TN 小波域质量参数 24 93.39 0.97 91.09 (0.25) 94.5 (0.16) 彩色质量参数 [ 12 ] 28 78.79 0.87 83.26 (0.62) 75.66 (0.49) 小波域马尔科夫特征 [ 20 ] 588 90.36 0.96 88.83 (0.78) 90.63 (0.41) 统计矩特征 [ 9 ] 168 77.69 0.83 69.87 (0.65) 81.81 (0.89) 表1. 不同特征在彩色库上的识别率及AUC 注：括号内的数据表示实验数据的标准差。 Table 2 提取特征 维数 特征提取时间 训练时间 小波域质量参数 24 28.273 s 0.006 s 原图质量参数特征 28 41.365 s 0.011 s 小波域马尔科夫特征 588 60.485 s 0.127 s 统计矩特征 168 37475.325 s 0.038 s 表2. 彩色库上特征时间比较 注：括号内的数据表示实验数据的标准差。 了93.39%，高于其它几种特征。并且，小波域质量参数特征相较于其它特征而言，提取特征的时间更短，训练时间也更短。"
