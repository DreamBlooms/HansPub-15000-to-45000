"当前，我国矿山安全问题日渐凸显，矿山开采伴随着岩石破裂。针对岩石破裂产生的多源信号，采用时频分析对各种信号进行研究。常用的时频分析方法有短时傅里叶变换，小波变换，S变换等。本文首先阐述各种时频分析方法的原理，并进行比较筛选，从而得知S变换为处理各种信号的最优时频分析法。通过S变换对岩石破裂、爆破、敲击、钻孔、铲车等信号进行处理，来归类信号显著特征，如频率、能量、振幅、持续时间等，使得信号易于区分，为多源信号的特征提取以及分析提供了一定帮助。 关键词 :时频分析，S变换，多源信号，特征分析 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"矿产资源是当前国家以及世界发展的重要构成，现在，中国已有90%以上的能源和工业原材料来自矿物材料 [ 1 ] 。同时，矿难是我国以及世界所面临的重大难题。岩土工程的长期劳动中，人们发现，在较高的应力下，特别是在采矿的影响下，原始的地质缺陷被激活或岩石发生破裂而产生错动，能量以波的方式释放和传播出去 [ 2 ] 。矿井下作业条件复杂，噪音信号较多，基于信号特征识别不同的振动信号，尤其快速提取有效岩石破裂信号对于保障矿山开采人员生命财产安全极其关键。"
"时频分析是处理非平稳信号的常用方法，是将一维时域信号映射到二维时频空间的一种刻画和表述方法。在信号的局部或暂态表征描述中具有非同一般的优势 [ 3 ] 。时频分析根据核函数类型，有非线性变换与线性变换，线性变换描绘信号的时频变换特性，借助于线性函数，这类方法主要包括短时傅里叶变换、S变换、小波变换等。  短时傅里叶变换是针对时变非平稳信号的一种联合时频分析方法，能将一维的故障振动信号变换成适应于CNN处理的二维矩阵：一种包含时域和频域信息的特征谱 [ 4 ] 。信号从时间域h(t)过渡到频率域h(f)的过程被称为Fourier变换的正变换 [ 5 ]，用数学函数表示为： h ( f ) = ∑ + ∞ − ∞ h ( t ) e − i 2 π f t d t (1) 式中，信号h，时间t，频率f，令 ω = 2 π f 。 Fourier变换是将信号时域映射到频率域，整体上，使信号丢失了时域特性，在处理信号过程中，加入窗函数g(t)，并对非平稳信号h(t)截选，将小段信号转换到频率域通过Fourier变换，随着时间轴上窗函数的移动，每部分信号都被过渡到了频率域，同时也含有了时域特征，最终汇成整段信号的时频分布结果，这种方法将时域信号转换成时频信号，是信号分析领域的重大突破性研究，其中，时窗函数的数学表达式为 [ 6 ] [ 7 ] ： g τ , ω ( t ) = g ( t − τ ) e − i ω t (2) 短时傅里叶变换是通过强化时间t处的信号并消弱其它处信号来研究信号h(t)在时间t上的频率特征，主要实现手段是将中心位于 的窗函数g(t)与信号h(t)相乘来实现，可表示为 [ 8 ] ： S T F T ( τ , ω ) = ∫ − ∞ + ∞ h ( t ) g ( t − τ ) e − i ω t d t (3) S T F T ( τ , ω ) 是h(t)的短时傅里叶变换结果，并需要满足以下能量归一化条件的要求，即 ‖ g ( t ) ‖ = ∫ − ∞ + ∞ | g ( t ) | 2 d t = 1 , ‖ g τ , ω ‖ = ∫ − ∞ + ∞ | g τ , ω | 2 d t = 1 (4) 短时傅里叶变换法实质就是利用时窗函数在时域信号中以 τ 中心的时间轴上对其进行加权，从而进行局部分析通过时窗内信号的加强，通过数学公式可以看出，越远离时刻 τ 的信号被压制的越严重，且把时窗函数顺着时间轴移动，用采样率控制算法精确性，使得汇成信号全部时频谱 [ 8 ] 。  小波变换法的窗口形态灵活，面积固定，该方法可以通过选取适当的小波函数，改变优化得到满足相应信号所要求的相对较好的时频分辨率，引入了多分辨率分析的思想，可根据信号不同区域里高频、低频的差异来调节算法的分辨率。该方法的基本思想是利用基小波在二维平面上表示初始信号，此方法与短时傅里叶变换的最大区别就在于它是利用基小波函数的伸缩和平移来构造一组分辨率不同的正交投影空间，用以实现其时频分辨率自适应调整的功能 [ 9 ] 。 定义小波变换的小波函数为 ψ ( t ) ，小波函数经过伸缩、平移、归一化等变化后就构成了一组用以分解信号的小波 [ 10 ] [ 11 ]， ψ a , b ( t ) = 1 a ψ ( t − b a ) ，式中a，b参数分别为尺度与时窗， ψ a , b ( t ) 就是母小波， 小波变换具有自适应性，在窗口面积的固定的前提下，当尺度与时移因子改变时，导致分析时频窗 口的形状与位置的改变，小波函数须满足 ∫ − ∞ + ∞ ψ ( t ) d t = 0 , ‖ ψ ( t ) ‖ = ∫ − ∞ + ∞ | ψ ( t ) | 2 d t = 1 ，由这两个条件式我们可 以得知小波函数中无能量归一化与零频率，设 h ( t ) 为非平稳信号，则连续小波变换公式为: C W T ( a , b ) = 1 a ∫ − ∞ + ∞ h ( t ) ψ ( t − b a ) d t (5) 小波函数可以根据具体的信号特点进行构造，基函数的拉伸可以依靠增大尺度参数，从而导致窗函数在频域上压缩，时域上扩展，窗口形状的变换将导致小波函数的时频分辨率的变化，借助小波函数的此特点来实现h(t)多分辨率分析 [ 10 ] 。  S变换最早是由Stockwell于1996年提出 [ 7 ] [ 11 ]，依照短时傅里叶变换公式(3)，加入带有频率变量窗函数进而推出S变换公式，短时傅里叶变换依靠时窗函数截取信号从使局部分析的功能实现，短时傅里叶变换的处理精度受窗函数选取的直接影响，又因为采用Gauss窗函数可以获得信号最小时宽与带宽乘积 [ 3 ] [ 7 ]，因此定义Gauss窗函数为： g ( t ) = 1 2 π e − t 2 2 (6) 窗函数进一步优化而构造适用于实际问题的时窗函数： g ( t , σ , τ ) = 1 σ 2 π e − ( t − τ ) 2 2 σ 2 (7) 式中，时间因子 ，尺度因子 σ ，代入式(3)得： S ( τ , f , σ ) = ∫ − ∞ + ∞ h ( t ) 1 σ 2 π e − ( t − τ ) 2 2 σ 2 e − 2 π f t i d t (8) 由式(8)可知，Gauss窗函数的宽度随着 σ 值大小的变化而变化，由此改变时频分辨率，并获得信 号的部分时频信息。 1 / | f | 控制Gauss窗尺度，并加强信号频率与时频分辨率之间的影响，从而将 σ 与频率相联系，则令： σ ( f ) = 1 | f | (9) 将(9)代入(8)从而推导出S变换公式： S ( τ , f ) = ∫ − ∞ + ∞ h ( t ) | f | 2 π e − f 2 ( t − τ ) 2 2 e − 2 π f t i d t (10) 窗函数为： φ ( t , f ) = | f | 2 π e − f 2 ( t − τ ) 2 2 e − 2 π f t i (11) 由上述(8)~(10)可知，S变换在构造窗函数 φ ( t , f ) 时加入了频率的倒数作为自变量，窗函数的 σ 与频率直接联系，从而随不同频率的要求进行自适应改变，显示了S变换法的多分辨率分析的特点。另外通过小波变化也可以推出S变换的公式。"
"通过观察以及分析STFT的原理和算法可知，时频分辨率受所选窗口尺寸的干扰，当窗口尺寸为零或 g ( t ) = 1 时，STFT就退化为了单一的频域或时域，即Fourier变换和原始时域信号，通过算法，可知频率，时间分辨率处于相对矛盾形态，用数学语言来说两者近似成反比关系，即一方的递增必定会导致另一方的降低。 小波变换是通过原始信号的分解，将基本小波变成一系列小波。不同于短时傅里叶变换，小波变换不但可获得信号的时域信息，还可获取信号的频率信息 [ 12 ]，小波函数通过尺度参数a来改变小波函数的形状，但小波变换的分析结果并不是真正的时间–频率谱，从而导致信号特征的精确度有一定的问题，这是因为值与信号的真实频率组成不直接相关。 S变换 [ 13 ] 的公式既可由短时傅里叶变换推出又可由小波变换推出，S变换是前两种方法的继承与发展。S变换法与短时傅里叶变换法相比的最大优点在，其高斯窗函数中的频率变量可以根据具体的频率大小来调节从而实现对时频分辨率的控制；与小波变换相比的最大优势在于，它可以反映出信号真正的时间频率谱，完整地描述信号特征，另外S变换拥有短时傅里叶变换和小波变换的线性特征，对于多分量的合成信号来说，S变换结果不存在交叉项，使其时频分析成效得到了大幅提升 [ 12 ] 。  综上所述，S变换法相对于其他时频分析法来说主要有以下方面的优点：第一，是短时傅里叶变换与小波变换的继承与发展，加入了小波变换法的多分辨率分析思想，有效克服了短时傅里叶变换法时窗被固定的缺点，能较好地适应非平稳信号频率不规律变化的特点。第二，反映出信号最真实的频率组成，完整地描述信号特征。第三，S变换继承了短时傅里叶变换和小波变换的线性特征。不存在非线性时频分析法中的交叉项，对信号的分析质量较非线性分析法更高。"
"将S变换时频分析法引入矿山微地震信号识别中，通过在时间域和频率域两方面的联合分析，直观地提取信号特征，作为信号识别与分类的依据。根据振源的不同，可将信号可分为岩石破裂，爆破，敲击，电脉冲，钻孔，铲车等信号。信号图谱 [ 14 ] 见图1与图2。 图1. 信号的原始图谱 图2. S变换后信号的时频谱  岩石破裂、爆破、敲击、铲车、钻孔等信号在其频率范围互相交叉，但也有差异。通过图谱分析，从最大振幅、频率范围、主频、卓越能量等几个方面总结出了这五类信号大致的信号特征，特征范围见表1 [ 14 ] 。 Table 1 振源 最大振幅范围(mm/s) 频率范围(Hz) 主频范围(Hz) 持续时间范围(ms) 卓越能量范围 岩石破裂 10~60 130~230 170~180 200~500 2~30 爆破 160~360 100~500 160~180 300~400 60~300 敲击 50~290 50~500 180~330 250~400 20~100 钻孔 20~60 130~260 170~190 - 5~17 铲车 50~230 140~210 160~170 - 15~95 表1. 各类振动信号的特征范围 由以上可知岩石破裂、爆破、敲击等拥有极为相似的波形在原始波形图上，不易直接区分，但在振幅、频率、主频、能量各方面还有有很大差别。爆破信号的能量和振幅相比其他信号是最大的，主频低于敲击信号的主频，频率范围较广，总的来说在这几类信号中，爆破信号的能量最大。岩石破裂信号的振幅范围以及振幅值均较小，能量值也小其他信号，如爆破，敲击等，但却一般大于钻孔信号，主频范围较为集中。敲击信号的能量值和振幅值均介于岩石破裂信号和爆破信号之间，但主频范围最广。 钻孔与铲车信号两者波形度较为类似，但铲车信号的最大振幅范围，主频范围以及卓越能量范围与钻孔信号均有很大差别，由钻孔信号与铲车信号频率范围的差别，可知钻孔信号在时频谱上会出现明显的分层，而铲车信号的时频分布谱的连续性更好，因此通过时频分析后便易于与钻孔信号加以区别。"
"时频分析方法综合考虑了地震资料的时间与频率等两者的分辨率，同时改善了单纯时间域或频率域分析方法的短板 [ 15 ]，S变换法中，频率变量的倒数被引入Gauss窗函数，其时窗宽度可随频率变化自适应地呈反比调整，频率低，时窗宽，满足加工非平稳信号过程中低频段要求高频率分辨率而高频段要求高时间分辨率的特性，在对非平稳信号加工上更胜一筹，S变换时频分析法引入矿山微地震信号识别中，通过在时域和频域等两方面的联合分析，较为直观地提取信号特征。 岩石破裂，爆破，敲击，钻孔，铲车等五类信号，在其原始图谱可大致分为两类，在钻孔与铲车信号两者之间，一般较为连续的为铲车信号，另一者则为钻孔信号，两者除了根据原始图谱外，还可根据经过S变换后的时频谱，铲车信号的主频范围一般较钻孔信号低。其余三类信号中，一般能量最大的为爆破信号，剩余的两者岩石破裂以及敲击信号在最大振幅范围、主频范围、以及卓越能量均有较大差别。通过最大振幅、频率范围、主频、卓越能量等几个方面来对信号进行分类，使多源信号易于区分。虽然本文对各种信号分析还不是特别到位，但却对多源信号的特征提取与分析有重要的价值及意义。"
