"目前国内照明市场主要停留在LED(Light-emitting diode)可调光产品上，真正进行系统化LED智能照明的产品还比较少，本文针对传统照明技术灵活性差、控制方式单一等缺点，结合当前广泛使用的无线WiFi(Wireless Fidelity)技术和时下流行的LED照明技术，提出设计一种基于WiFi环境下对LED智能照明控制系统。本系统以智能手机终端、恒压电源模块、ESP8266智能WiFi模块和三基色LED灯四部分组成。采用Java语言在Eclipse平台上开发了一款智能控制软件，实现了硬件系统的灯光自启、切景设置和三基色LED灯的颜色和亮度的自主调节。该系统简单灵活，实现了LED灯的自主控制和远程控制，且具有良好的稳定性和可行性。 关键词 :LED，WiFi，ESP8266，智能照明"
"近年来，随着国内照明水平的不断提升，照明技术的不断进步，智能照明开始出现并逐渐进入人们的日常生活。同时，随着光电子技术、光电检测技术、控制工程信号处理元器件以及新型半导体发光材料的发展，人们对智能照明提出了更高的要求[ 1 ] 。其中LED照明技术的发展和进步引起了国内外的广泛关注，特别是三基色LED灯的光效和品质等方面取得了重要的突破，加速了LED在智能照明领域的广泛应用。LED具有重量轻、体积小、方向性好、寿命长、节能、动态变幻、抗振、色彩丰富等优点，能够适用于各种复杂、恶劣照明环境，从而使用户感受到良好的舒适性、安全性、方便性和艺术性[ 2 ] -[ 4 ] 。在当代新兴智能照明产业的推动下，社会各界，各个领域有不同的照明需求，智能照明也朝着更加人性化、智能化的趋势发展。如今市面上已经出现许多通过物联网控制LED照明的电子产品，其网络技术较先进，覆盖范围较宽，而WiFi手持终端必然成为潜在的应用模式[ 5 ] [ 6 ] 。随着现代光电子的飞速发展，智能照明越来越受到普通民众的广泛关注，将来会有越来越多的人选择智能照明代替传统的照明方式。WiFi技术目前已经趋于成熟，很多人都在使用无线WiFi设备，使得基于WiFi环境下对LED智能照明的实现变得更加方便。本文在物联网基础上对LED照明和WiFi技术做进一步研究拓展，将两者有机的结合在一起，使人们仅仅使用智能手机即可方便快捷的控制LED照明。 本系统的设计方案是：在无线WiFi网络环境下，协同LED灯具组，使用无线控制系统达到灯控节点的照明进行远程遥控、监测，完成各项照明信息的采集，并把收集的相关数据发送到智能手机终端，经过云计算对相关数据进行处理和分析，以实现对智能照明系统的远程维护、主动控制、主动问询等功能，从而实现用户能够自主、方便地调节目标LED灯具组的颜色和亮度。"
"本文根据WiFi局域网控制的研究现状及相关的应用情况，结合无线WiFi网络、LED照明、通讯和自动化等多项技术，旨在实现LED照明的智能化控制。根据WiFi无线局域网的组网特点及运作方式，建立基于Java语言控制发射的基础WiFi模式局域网环境，并向目标空间进行信号发射并调试，使其发出稳定、良好的信号。基于Eclipse软件开发平台，运用Java语言进行程序编写，开发了一款操作简单、功能齐全、界面友好的智能手机客户端应用软件，使之能准确、及时地向目标硬件系统发出指令信号。完成对无线通信三基色LED灯控节点进行设计，包括LED灯控节点的硬件设计、Java语言控制下ESP8266无线WiFi模块的工作模式设计以及LED灯具组的整体布局合理设计，以确保LED照明系统能正常运作。最后对完成的接入点模块以及LED灯控节点模块进行功能测试。系统测试包括LED照明系统的稳定性以及LED灯具组在WiFi环境下的智能化调控能力，如亮度、色温的自主控制以及相关模块在系统中的稳定性。 设计系统的总体构架图如图1所示。系统采用220 V家用电源供电，经变压器变压后，输出5 V直流电压，再经过AMS1117模块进行降压，使输出3.3 V稳定直流电压。以上三个部分构成硬件系统的电源模块，输出的3.3 V直流电压不会随电网电压发生明显波动，为ESP8266模块和LED灯具组的供电提供了良好的保障。系统中的ESP8266无线WiFi模块是整个控制系统的核心，其作用包括：与智能手机终端进行通信，接受控制信号并返回相关状态信息，根据接受的控制指令，向三基色LED灯输出不同的PWM波信号，以实现对LED灯具组的色温、亮度和颜色的控制。当对单个LED灯具组进行控制时，ESP8266可直接与智能手机终端进行通信；当对多套LED灯具组进行控制时，需要借助路由器发挥中继作用。系统选用三基色LED作为照明的主要器件，可实现不同颜色的任意组合，从而根据用户需要改变亮度和颜色。系统的智能手机终端相当于远程遥控设备，应用软件基于Andriod条件下开发，用Eclipse软件进行程序编写，编译完成后生成.apk文件，下载至智能手机终端，安装好后即为控制软件。 系统的设计以ESP8266模块为灯控节点的主要控制芯片。乐鑫智能互联平台——ESP8266拥有高性能无线SOC，给移动平台设计功能嵌入其他系统提供了比较方便的开发平台，它以最低成本提供最大实用性，为WiFi的开发平台提供了比较全面的技术资料，并且其产品的稳定性十分优越。ESP8266具有透传功能，即透明传输功能。Host通过art将数据发给ESP8266，ESP8266再通过无线网络将数据传出去；ESP8266通过无线网络接收到的数据，同理通过uart传到Host ESP8266只负责将数据传到目标地址，不对数据进行处理，发送方和接收方的数据内容、长度完全一致，传输过程就好像透明一样；此功能为系统中的无线控制信号的传输提供了良好的保障。ESP8266的CPU内核具有对信息处理的能力，可将接收的控制信号进行及时的翻译和响应，向三个输出端口输出相应的PWM波，以实现对三基色LED灯的控制。同时，ESP8266还具有监测的功能，通过不断检索当前PWM波输出端口的状态，经CPU内核处 图1. 设计系统的总体构架图 理后，反向传输信号，向用户反馈当前照明信息，以达到实时监测的目的。 AMS1117是一个高效线性正向低压降稳压器，用于交换式电源5 V至3.3 V线性稳压器。本设计系统的供电电源需要稳定的直流3.3 V电源，而AMS1117是目前较为合适的5 V转3.3 V的贴片元件。此芯片为本设计系统提供直接稳定电压，即给ESP8266模块和三基色LED灯提供稳定的电压。"
"在硬件系统所包含的电子电路和设备中，ESP8266模块和三基色LED灯具组都需要稳定的直流电源供电。为了方便用户用家用电源直接给系统供电，所以系统需要一个变压设备，将220 V交流电压转为3.3 V直流电压。整个恒压电源模块由两部分组成，即变压器和AMS1117模块。其中变压器为一个小型AC-DC电源模块，即交流220 V转直流5 V小型开关电源变压器，它将有效值为220 V、频率为50 HZ的单相交流电压转换成有效值为5 V的稳定直流输出电压。此款变压模块为高低压隔离型恒压电源，具有温度保护、过流保护及短路全保护，体积小巧，性能稳定的优点。系统需要稳定的3.3 V直流电源作为直接供电电源，而AMS1117是一个5 V至3.3 V高效线性正向低压降稳压器，即交换式电源，是比较合适的一款贴片元件。以上两个原件组成的恒压电源模块为设计系统提供直接稳定电压，即直接给ESP8266模块和三基色LED灯提供稳定的直流电压。  本系统的灯控节点是以ESP8266为主要控制芯片，ESP8266具有良好的稳定性，对控制信号的传输和处理都具有良好的时效性和准确性。ESP8266无线WiFi模块是整个控制系统的核心，其作用包括：与智能手机终端进行通信，将由串口接收用户终端发来的指令信息，然后对具体指令内容进行解析并输出相应的PWM波为三基色LED恒流驱动器使用，以实现对LED灯具组亮度和色温的自主调节，同时向智能手机终端返回相关状态信息。 为了满足用户对照明颜色、亮度和色温自主调节的要求，系统的照明灯具采用了10 mm全彩共阳红绿蓝三基色雾状LED发光二极管超亮七彩散光灯。其颜色为RGB红绿蓝三色可控多彩，控制参考电压分别为：R(红)：1.8~2.0 V，G(绿)：3.2~3.4 V，B(蓝)：3.2~3.4 V。对于LED红、绿、蓝三种小灯珠的发光强度的比例，一般选择为3(红):6(绿):1(蓝)，可以组合得到白色，用户也可以利用这个特点来任意调节LED灯的亮度和色温。因此用户可以根据自己需要调节颜色和亮度，即通过改变封装好的三基色LED中的各种颜色小灯珠的电压，从而实现对LED光源的亮度和色温的调节[ 7 ] 。因系统运用的LED灯光谱十分灵活，其显色性和辐射光受三颗单色的小灯珠共同影响，所以封装好的三基色LED灯，具有良好的稳定性，其发光的亮度和颜色的调节也十分方便。 PWM Dimming (脉宽调制)是三基色LED灯最佳的颜色调节方式。通俗地说PWM就是控制LED开和关的时间比例，将开和关的时间比例划分为若干等级，LED就会显示出相应数量的灰阶。PWM频率调节是通过调整打开和关闭LED的时间比例实现的，但是开关频率不能太低，最起码要欺骗过眼睛。简而言之，PWM是对连续模拟信号进行数字编码。通过高分辨率计数器，实现对方波占空比的调制，从而实现对模拟信号的数字编码功能。此时只有两种重复脉冲输出，即高电平为通，低电平为止。当为高电平时，可以看到LED灯被点亮，即导通；当为低电平时，可以看到LED灯熄灭，即截止。LED灯在不断交替的导通和截止状态切换，从而实现对单只LED灯亮度的调节。由于PWM调光负载电流只有满载、空载两种工作状态，所以不会对LED的色温、色偏等性能造成干扰。因此，PWM调光为本设计系统的主要调光方式。  本系统的硬件工作流程如图2所示。WiFi发送模块自组成WiFi无线通信网络，智能手机客户端和ESP8266无线控制模块都分别加入预设WiFi网络，智能终端的相关控制信号经由WiFi网络，传送给系统中的所有节点，即每个硬件控制模块。当网络中包含多个硬件控制系统时，则无线控制信号需要通过路由器进行中继转发；当网络中仅包含单个硬件控制系统时，智能终端不需经过路由器便可直接与硬件系统进行通信。当ESP8266无线控制模块接收到相应的控制信号时，便会做出响应——灯光控制模块执行对应操作并向智能手机终端反馈状态信息，即向用户反映即时信息。 系统终端主控芯片选用ESP8266，其主要作用是接受用户控制信号，对三基色LED灯具组进行灯光自启、切景设置、颜色和亮度的自主调节，以及向手机终端反馈信息。LED灯调光方式有很多，如可控硅调光、PWM调光、调解止向电流调光[ 8 ] 。每种调光方式都有各自的优缺点，当前应用最广泛的是PWM调光，它的调光效果也是最好的，本设计系统的LED控制终端使用的便是PWM调光方式。不同的控制指令使ESP8266的三个PWM输出端口输出占空比互不相同的PWM波信号，以对三基色LED灯具组的三种不同颜色的小灯珠进行亮度调节，从而组合成用户要求颜色和亮度。WiFi接受模块最终与CPU内核连接，实时传送用户控制信号到CPU内核，反馈内核信号到用户终端，使数据稳定传输和进行实时监测。控制指令经CPU内核处理后，LED灯控节点便接收到准确的PWM信号，以实现对三基色LED灯具组的色温、亮度和颜色的调节。"
"本系统是基于Android平台，运用Eclipse软件进行的软件设计。Android是开放源代码的移动通信平台，它主要包括上层的Java应用程序、中间层的中间件和底层的Linux操作系统，是通过Java语言开发的。同时Android多样的功能支持以及完善的计算服务使其有能力扩展到手机市场以外，它可以运用于别的应用程序和开发平台，虽然各有差异，但它们之间的数据仍然能同步，而且不会影响到软件之间的兼容性[ 9 ] 。Java作为面向对象语言，开发简单并且周期相对比较短，可用于开发操作系统、应用程序和用户界面——移动电话工作所需的全部软件，为移动产业的创新和发展提供了一个良好的平台[ 10 ] 。同时Java语言有平台无关性的良好优点，其可植性很好，本系统用Java语言开发软件。Eclipse最先由IBM公司投入开发，是基于Java的、开放源代码的可扩展集成开发平台。Eclipse拥有免费、源代码开放、无限的可扩展性等特点，为本系统的软件编写提供了便利的条件。 本系统借助Eclipse软件，运用Java语言进行控制程序编写，编译完成后可生成一个.apk文件，将其下载至手机，可得到一个手机APP软件，借助这个软件便能对ESP8266模块进行控制。编译后的电脑模拟图如图3所示，编译得到的手机主界面，如左侧图所示；模拟解锁后，可看到模拟手机桌面，右图中的右下方红色图标即为所开发控制软件，点击进入后即可进入用户控制界面。 系统的软件设计部分主要是智能手机终端的应用软件设计，具体包括用户控制界面设计和相关控制指令与用户界面的对接。当用户点击相关图标时，手机终端响应相关指令并向外广播控制信号，从而使硬件系统接受的指令为用户目标指令。手机传来的信号可由ESP8266独立完成。"
"进入用户控制软件，上电初始化后搜索当前运行硬件设备，发送入网申请信号并输入正确SSID和密码，加入成功后开始执行用户控制指令，完成对LED灯具色温和亮度的调节，并返回系统当前所处状态数据。用户第一次成功进入该系统后，先搜索目标运行设备，添加的信息将自动保存到数据库中，以后 图2. 系统硬件原理框图 图3. 电脑模拟图 每次进入控制软件，都无需再次输入账号和密码，只要以前记录的硬件系统在线，均可直接进行控制。用户对不需要的单个照明可进行删除；若需添加其他设备，只要输入单个设备的密码即可。 具体软件测试图如图4所示。进入软件界面，刷新后看到两台设备正在运行，即最左端控制界面所示。点击进入其中一个设备，能实现对单个设备的控制，拖动频率调节条纹，可控制单个设备所有LED灯的亮度，拖动冷白，暖白条纹，可改变LED灯的色温；拖动红、绿、蓝条纹，可任意改变LED灯的颜色，即中间控制界面所示。单击右上方上田字按钮，可进入大范围颜色调节界面，触摸屏幕至任意位置，即用户所需颜色响应，即最左端控制界面所示。经过上述操作可实现对目标LED灯具组颜色、亮度和色温的调节。当用户在智能手机终端进行操作时，手机终端会向目标WiFi环境广播控制信号，控制信号在WiFi局域网的搭载下，传播到每个灯控节点，根据信号的不同，单个硬件系统会选择性的执行命令。  调试软件成功后接通电源，将LED灯具组接入预定WiFi网络，可实现对目标灯具组的实时控制，其测试结果如图5所示。根据用户的具体指令，ESP8266模块会对控制信号进行处理，并通过三个端口分别向三种颜色的LED灯珠输出PWM波，三颗灯珠封装好后实现了混色，图5展示了在不同情况下，LED灯具组的发光效果。 图4. 软件测试图 图结果"
"随着科学技术的进步，越来越多的智能化、自动化和人性化的照明技术进入到人们的生活，智能照明将逐渐替代传统照明而成为一种行业发展新趋势。WiFi环境下的智能LED照明系统作为智能家居系统的一个重要子系统，具有高效节能、管理简单、控制多样、成本较低和容易进入市场的优势。本文对基于WiFi环境下LED智能照明系统进行研究和设计，主要完成了以下工作：结合LED照明、无线WiFi网络、通讯和自动化等多项技术，实现LED照明的智能化控制，达到LED灯具组在Android手机客户端的控制下，实现了灯光自启、定时控制、切景设置和灯光亮度、色温的自主调节。"
