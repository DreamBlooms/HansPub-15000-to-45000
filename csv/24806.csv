"流域的退水预报对洪水退水期的水库调度至关重要，直接影响着水库调度效益的发挥。桓仁水库预报模型的7日退水预见期的合格率QR = 100%；确定性系数DC = 0.88。退水预报精度等级接近甲级，达到可利用水平。现以桓仁水库为例，针对综合退水曲线退水段，建立了退水段发电量最大模型，并利用遗传算法对该模型进行求解，最后通过对优化调度结果进行分析，说明了该算法的有效性和优越性，对水库水电站汛期退水段的调度有一定的指导意义。 关键词 :优化调度，遗传算法，退水曲线，桓仁水库 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"由于水能资源的时效性比较强，北方流域的降雨主要集中在汛期，造成汛期和非汛期的来水量相差很大，不合理的调度极易引起洪水面临时发生弃水，洪水过后又不能蓄满水库的现象，若后期降雨不足，则水库长期处于低水位运行状态，这不仅影响水库兴利效益的发挥，也影响大坝等水工建筑物的安全运行。因此充分利用退水预报和气象预报信息进行水库调度，根据未来几日流域降雨预报信息提前对水库进行预蓄或者预泄，对水库防洪、兴利效益的发挥起着很大的作用。因此对流域汛期退水段的短期优化调度也是非常重要的。 目前水电站水库优化调度常用的方法有：动态规划法 [ 1 ] 、逐步优化算法 [ 2 ] 、遗传算法 [ 3 ] [ 4 ] 等。动态规划产生于20世纪50年代，其中确定性动态规划的研究开始于60年代，是解决多阶段决策过程最优化的一种数学方法，但是使用动态规划时状态空间和决策空间约束在优化过程中容易产生“维数灾”。为了克服动态规划的“维数灾”，一些学者又提出了几种改进的动态规划，如逐步优化算法等。逐步优化算法由Howson等人在1975年提出，可以将多阶段问题化为两阶段问题，无需将状态离散化，但是它对目标函数和约束条件有较严格的要求。随着各种优化方法在各个领域的应用，遗传算法也逐渐被引入到水库调度中来。遗传算法是由美国人J.H. Holland吸取自然界中适者生存和基因遗传的思想而提出的一种全新的优化搜索算法，它克服了动态规划的不足，为水库优化调度寻求了一种新的优化算法。 80年代以来，一些学者开始将遗传算法应用到水库水电站的年优化调度和日优化运行调度中，但是目前为止，针对汛期洪水过程，利用遗传算法来进行优化调度的例子还不是很多，本文尝试将遗传算法应用到汛期退水段的实时优化调度中。下面将针对流域未来几日有大雨、暴雨或大暴雨等连续性降雨过程出现的天气情况，研究分析退水段优化调度问题，并且验证遗传算法在实时调度中的可行性，通过对优化调度结果进行的分析，说明了该算法的有效性和优越性，对水库水电站汛期退水段的调度有一定的指导意义。"
"水电站水库优化调度是根据水库的入流过程，按照优化调度准则，运用最优化方法，寻求比较理想的水库调度方案，使水库按照最优调度方式进行蓄水、用水和泄水，以避免因水库运行管理不当而造成的水资源损失，从而使水电站水库在整个调度期内获得最大的经济效益。 针对本实例，水库优化调度可描述为：已知系统初始库水位和入库径流过程，在满足水库水电站各种约束的条件下，求水库的泄流过程，使水库在保证出力的条件下发电量最大。到退水段结束时，库水位能达到控制水位，尽可能多发电、少弃水。如果当前水位比较高，则应提前加大出力发电，以减少弃水。优化调度数学模型包括目标函数和约束条件两部分。 目标函数： E = max ∑ t = 1 T Q f ( t ) × Δ t / h s l ( t ) (1) 式中：E为调度期内总发电量； Q f ( t ) 为水电站发电引用流量； Δ t 为时段秒数； h s l ( t ) 为水电站时段平均发电耗水率；T为计算时段总数。 约束条件： 水量平衡约束(汛期蒸发等水量损失忽略不计)： V ( t + 1 ) = V ( t ) + [ Q i n ( t ) − Q f ( t ) − Q d ( t ) ] × Δ t (2) 水位约束： Z s ≤ Z ( t ) ≤ Z max (3) 发电流量约束： Q min ≤ Q f ( t ) ≤ Q max (4) 电站出力约束： N min ≤ N ( t ) ≤ N max (5) 泄流量约束： q t , min < Q f ( t ) + Q d ( t ) < q t , max (6) 式中： V ( t + 1 ) 、 V ( t ) 分别为时段初、末蓄水量； Q i n ( t ) 、 Q d ( t ) 分别为时段入库流量和弃水流量； Z s 、 Z ( t ) 、 Z max 分别为水库调度初水位、时段水库水位和水库允许最高水位； Q min 、 Q f ( t ) 、 Q max 分别为最小发电流量、时段发电流量和最大发电流量； N min 、 N ( t ) 、 N max 分别为水电站保证出力、时段水电站平均出力和水电站装机容量。 q t , min ， q t , max 分别为水库下游综合利用要求的最小下泄流量和下游河道安全泄流量。"
"遗传算法 [ 5 ] (GA)是基于自然选择和遗传机制，在计算机上模拟生物进化机制的寻优方法。它把搜索空间映射为遗传空间，把每一个可能的解编码为一个向量，称为一个染色体，所有染色体组成群体(群体中染色体个数用POP表示)。对于水库优化调度的遗传算法，是在水库水位的允许变化范围内，随机选择POP组可行水位变 化序列 ( Z 1 1 , Z 2 1 , ⋯ , Z n 1 ) , ( Z 1 2 , Z 2 2 , ⋯ , Z n 2 ) , ⋯ , ( Z 1 p o p , Z 2 p o p , ⋯ , Z n p o p ) ，其中，POP为群体规模，n为时段数，再通过一 定的编码方法将其表示为个体的数字串，在满足给定的约束条件下，按预定的适应度评价标准评价水位变化的优劣，通过一定的遗传操作(选择、交叉和变异)，使适应度低的个体被淘汰，适应度高的个体遗传至下一代，如此反复，直至满足给定的终止规则。遗传算法的终止规则一般有三种，即1) 是否达到预定的进化代数；2) 是否找到了某个优秀个体；3) 连续几代的最优目标值有否变化等。对于水库优化调度，第一种终止规则最为常用。  本研究采用十进制的浮点数编码方式，选用库水位Z作为决策变量，水库在时段t允许的水位变化区间为 ( Z t , min , Z t , max ) ， Z t , min 、 Z t , max 分别为时段允许水库水位的最大值和最小值，欲使十进制编码精度为δ，则应把变量取值区域划分为m等份： m = Z t , max − Z t , min δ ，则染色体的每一基因可用整数 n ( n = 1 , 2 , 3 , ⋯ , m + 1 ) 来表示。个体的每一向量(基因)即为水库水位的真值。表示为： Z t = Z t , min + ( n − 1 ) × Z t , max − Z t , min m (7)  本文所求的问题为约束极大值优化问题，关于约束优化问题的处理，通常采用惩罚函数法。惩罚函数又分为定量惩罚法和变量惩罚法。在定量惩罚法中，解的质量严重的依赖于惩罚系数的值，当惩罚系数太小时，算法可能收敛于不可行解；另一方面，惩罚系数太大时会使算法较早的收敛于某个局部最优解。因此本文采用变量惩罚函数法，使惩罚系数随着进化代数的增加而动态增大，因此适应值函数表达式为 F ( Z ) = f ( Z ) − M ( g ) ∑ j = 1 P W j (8) M ( g ) = α g β (9) 式中： f ( Z ) ——优化问题的目标函数； M ( g ) ——进化代数相关的罚因子；g——进化代数； W j ——与第j个约束有关的违约值；P——违约数目；α、β——调节惩罚值大小的参数。  1) 选择算子。本文采用GA中常用的轮盘赌选择法(又称适应度比例法)对个体进行选择。设群体的大小为POP，个体的适应度为 f i ，则个体被选中的概率为 P i = f i / ∑ i = 1 p o p f i ，因此，个体的适应度越大，被选中的概率越高。 2) 交叉运算。交叉是把两个父代个体的部分结构加以替换重组而生成新个体的操作，目的是寻找父代双亲已有的但未能合理利用的基因信息。本文采用单点交叉，设 P c 为交叉概率，对经过选择后得到的 P c ⋅ P O P 个母体进行两两随机配对，然后，随机设置某一基因之后的位置为交叉点，交换这一位置之后所有的基因以形成新的个体。 3) 变异运算。通过变异可引入新的基因以保持种群的多样性，它在一定程度上可以防止成熟前收敛的发生。具体方法为：设 ( Z 1 , Z 2 , ⋯ , Z k − 1 , Z k , ⋯ , Z T ) 为一个母体，基因 Z k 被选中进行变异，其定义区间为 ( Z k , min , Z k , max ) ，则变异后的新个体为 ( Z 1 , Z 2 , ⋯ , Z k − 1 , Z ′ k , ⋯ , Z T ) ，其中： Z ′ k = { Z k + Δ ( t , Z k , max − Z k )       if   r a n d ( 2 ) = 1 Z k − Δ ( t , Z k − Z k , min )         if   r a n d ( 2 ) = 2 (10) 式中： r a n d ( 2 ) 表示随机产生的正整数2所得的结果，t为当前进化代数，函数 Δ ( t , y ) 的值域为 [ 0 , y ] ，并使得当t增大时， Δ ( t , y ) 取值接近于0的可能性越大。函数 Δ ( t , y ) 的具体表达式可取为 Δ ( t , y ) = y ( 1 − r ) ( 1 − t T ) λ ，式中：r为 [ 0 , 1 ] 上的一个随机数；T为最大进化代数；λ为决定非一致程度的一个参数，起着调整局部搜索区域的作用，其值一般为2~5。 4) 终止准则。但迭代次数达到预先设置值时，即终止遗传操作。"
"桓仁水库是浑江梯级的龙头，属不完全年调节水库，以发电为主，兼顾防洪、灌溉、养殖及旅游等综合利用任务的水利工程。总库容34.6 × 10 8 m 3 ，正常蓄水位及汛期限制水位均为300.0 m，库容22.0 × 10 8 m 3 ；死水位290.0 m时，水库死库容13.8 × 10 8 m 3 。有效库容8.2 × 10 8 m 3 ，调洪库容12.6 × 10 8 m 3 。库区耕地补偿标准为P = 10%洪水标准，坝上洪水位为303.00 m。电站装机容量22.25万kW，保证出力为3.3万kW。 桓仁流域3 h流量计退水预见期7 d合格率QR = 100%；确定性系数DC = 0.88。退水预报精度等级接近甲级，达到可利用水平。本文以桓仁水库综合退水曲线退水段退水流量为水库入库流量，共120个计算时段，每时段 Δ t = 3 h (其余有代表性的典型年退水曲线等详见文献 [ 3 ] )。按照退水段发电流量最大求水库的最优泄流过程。假设未来几天流域有大雨、暴雨或大暴雨等连续性降雨过程，面临时刻库水位为303.00 m，则为了防洪安全，库水位在调度期末要降至主汛期汛限水位300.00 m。 图1. 遗传算法水位变化曲线 Table 1 进化代数 100 200 300 400 500 总发电量(万kwh) 7357.079 7358.748 7359.003 7360.264 7360.654 表1. 不同进化代数遗传算法计算结果 注：POP = 60，P c = 0.7，P m = 0.08。 针对前文所建立的优化模型，运用遗传算法进行求解，结果如下： 1) 水位、泄流量变化过程分析，水位变化曲线、泄流过程和发电流量变化曲线见图1。基于遗传算法的优化调度是以调度期内发电量最大为目标，在可引用的流量一定的情况下努力提高水头，最终提高调度期的总发电量，水位开始一直保持在正常水位，随着入库流量的减少水位逐渐下降，到调度期末库水位降至控制水位。 2) 发电量结果 利用遗传算法进行求解，不同进化代数计算结果见表1。 由上述计算结果可见，随着进化代数的增加，最优解趋于稳定。用遗传算法求得调度期内总发电量为7360.654万kwh。"
"遗传算法作为一种基于自然选择和群体遗传机理的全局优化搜索方法，为复杂优化问题提供了一条有效解决途径。本文以库水位作为决策变量并利用浮点数编码的遗传算法研究水库在汛期退水段的优化调度。对桓仁水库来说，水位的变化对库容的影响较大，因此在初定水位的计算精度时要尽量取小一点，但这势必要增加搜索空间，增加了计算机时，为了尽量避免这一点，本文编制计算程序时限定搜索范围，在给定的初始群体上下范围内进行搜索，大大减少了运行时间，加快了收敛速度，并且通过给定不同的初始解，证明了算法收敛于最优解。通过用遗传算法对水库优化调度模型的求解，计算结果满足约束条件，每个时段的出力均大于保证出力，且水位也在允许的变化范围内。 本文讨论的水库短期优化调度是假设未来几日将出现大雨、暴雨和大暴雨等连续性降雨气候，短期决策与当前的水位、未来的气候情况及预知的时间有关。目前气象部门已有较精确的短期预报，所以根据未来几日的来水量或降雨量来动态控制调度期末库水位。本文只是计算了其中的一种情况，如果面临时刻是属于汛后期，利用退水预报进行调度能充分抓住后汛期的退水，保证水库到汛期末能蓄到兴利蓄水位，这对水库调度效益的发挥有着很重要的意义。通过本例应用可知算法收敛到最优解。该法可以应用到汛期退水段的优化调度中，指导水库在汛期的实时调度。"
