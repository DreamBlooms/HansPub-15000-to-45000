"针对智能四轮转向车辆车道保持系统控制行驶时的稳定性需求，提出了一种新的四轮主动转向车道保持控制策略。针对智能车辆车道保持和非线性车辆系统状态估计问题，设计了利用车辆传感模块、曲率预瞄模块结合基于自适应MPC算法的车道保持控制算法，对车辆的稳定性进行分析，设置约束条件，实现对参考车道的精确跟踪。设计权系数后轮主动转向最优控制器，实现四轮转向的最优控制，在Matlab/Simulink中对控制算法的效果进行了验证，仿真结果表明：基于自适应MPC车道保持的最优控制四轮转向方法具有良好的横向控制稳定性和车道保持控制精度。"
"随着自主驾驶技术和电子控制技术的飞速发展，智能车辆车道保持和自动驾驶的研究已成为一个重要的研究热点。在自主车辆的研究中，操纵性和稳定性一直是两个关键的性能指标。智能车辆的车道保持系统是智能车辆重要的控制系统，也是车辆主动安全控制研究的核心技术之一。车道保持控制不仅需要考虑车辆自身行驶时的车身状态，也需要考虑车辆的位置信息道路信息等，传统车道保持系统如采用PID [ 1 ]，滑模控制 [ 2 ]、线性二次最优(LQR) [ 3 ]、模型预测 [ 4 ] [ 5 ] [ 6 ] 等控制算法可以实现车道中心线的准确跟踪并实现车辆的稳定操控，但仍不能满足更高的行驶的稳定需求。模型预测算法虽可以满足系统不确定关系下的递推约束问题，但未知车辆的实时适配问题模型与保证满足约束条件，一直没有彻底解决 [ 7 ]。由于车辆内部模型参数恒定，无法保证在车辆高速行驶时由于路面环境的影响或车辆状态参数的变化等强非线性特征往往导致车辆无法按预定车道行驶。四轮转向技术是提高汽车的操纵稳定性和安全性的直接、高效的主动安全底盘技术 [ 8 ] [ 9 ] [ 10 ] [ 11 ]。四轮转向技术在低速时减小转弯半径，提高机动性和高速行驶时转向响应小，车辆的操纵稳定性相比传统两轮转向有明显改善 [ 12 ]。 考虑智能四轮转向车辆在车道保持行驶时的稳定性，设计了自适应MPC车道保持控制器，为了实现对车道中心线精确跟踪，建立了车辆线性二自由度持预测模型和控制器的传感模块动力学方程，利用曲率计算车辆和期望车道中心线的侧向位移偏差，控制车轮转角输入从而使侧向偏差趋向于0。为提高线控主动四轮转向汽车的行驶稳定性，通过控制前轮转角和线性二次最优反馈控制的后轮转角的大小和方向来对车辆的运动轨迹和行驶稳定性进行控制，并在Matlab/simulink中对不同的四轮转向控制方法进行仿真对比，验证本文设计的控制方法整体性能。"
"实际车辆的小侧向加速度和横摆角速度运动可用简化的线型二自由度车辆模型描述，模型假设轮胎的侧向力处于线性工作区。四轮转向车辆车道保持控制系统控制稳定性取决于侧向和横摆运动，建立的车辆单轨模型线性二自由度线型微分方程为 [ 13 ]： m ( v ˙ y + v x ω ) = ( C l f + C l r ) β + 1 v y ( a C l f − b C l r ) ω − C l f δ f − C l r δ r I z ω ˙ = ( a C l f − b C l r ) β + 1 v x ( a 2 C l f + b 2 C l r ) ω − a C l f δ f + b C l r δ r (1) 式中：m——整车质量；v x ——纵向速度；v y ——侧向速度；C lf 、C lr ——前、后车轴的侧偏刚度；δ f 、δ r ——前轮转角；I z ——绕Z轴横摆转动惯量；a，b——前、后轴距；ω——横摆角速度；β——质心侧偏角。"
"智能车辆车道保持辅助系统配备有摄像头传感器，该系统将车道传感器数据输出的自适应MPC控制器中，控制车辆保持在车道中间即通过控制转向角减小侧向位移偏差e 1 及横摆角偏差e 2 ，同时通过摄像头预瞄的点测量当前车道的曲率和曲率导数，根据当前时间和预瞄长度，计算出未来曲率。车辆传感模块示意图，如图(1)所示。 图1. 车道保持系统传感模块示意图 如图１中所示，车道保持系统传感模块输出横向偏差 e ˙ 1 和相对偏航角 e ˙ 2 ，动力学方程如下所示： e ˙ 1 = v y + v x e 2 (2) e ˙ 2 = ω − ρ v x (3) 其中： ρ = ( g ( x ) ⋅ g ( g ( y ) ) g ( x ) 2 + g ( y ) 2 ) 3 (4) 式(3)中： ρ 表示曲率；实际横摆角速度 ω 可用三轴加速度传感器实际得到；道路曲率预瞄模块检测车道曲率后以1秒提前时间输出预览曲率，因此在模型预测控制器设置样本时间T s 为0.1 s，预测域设置10个步长进行输出。本文使用的曲率 ρ 基于双移线变换轨迹计算。 由非线性模型和复杂的控制约束对车辆车道保持控制求解计算量大，不能满足实际工况中实时性要求，采用简单化的线性模型预测控制器，且考虑到传统MPC内部固定难以适应车辆不同工况下如高速行驶的转向工况的稳定性控制采用自适应MPC算法，改善工作条件的强耦合高、非线性问题。设置输出变量： X = [ y ˙       ω ˙         e 1     e 2 ] ，输入变量 U = [ δ       ω ˙ d e s ] 结合式(1)~(3)，建立车辆连续时间预测模型如下： d d t = [ y ˙ ω ˙ e 1 e 2 ] = [ a 11 a 12 0 0 a 21 a 21 0 0 1 0 0 v x 0 1 0 0 ] [ y ˙ ω ˙ e 1 e 2 ] + [ b 11 0 b 21 0 0 0 0 − 1 ] [ δ f ω ˙ d e s ] = A f [ y ˙ ω ˙ e 1 e 2 ] + B f [ δ f ω ˙ d e s ] (5) [ e ˙ 1 e ˙ 2 ] = C [ y ˙ ω ˙ e 1 e 2 ] + D [ δ f ω ˙ d e s ] (6) 上式(6)中， a 11 = − 2 C l f + 2 C l r m v x ， a 12 = − v x − 2 a C l f − 2 b C l r m v x ， a 21 = − 2 a C l f + 2 b C l r I z v x ， a 22 = − 2 a 2 C l f + 2 b 2 C l r I z v x ， b 11 = 2 C l f m ， b 21 = 2 a C l f I z 由于MPC算法只适用于离散系统控制，因此需要对上述连续系统方程进行求解离散化： { x ( k + 1 ) = A t x ( k ) + B t x ( k ) + B V v ( k ) + B d d ( k ) y ( k ) = C x ( k ) + D v v ( k ) + D d d ( k ) (7) 上式中，变量k为采样时刻；d(k), v(k)分别为过程状态偏差和测量输出偏差，其中： A t = e A T s B t = ∫ 0 T s e A t d t B u (8) 为引入积分，并减少静差，将参考车辆系统信息与当前系统信息作偏差采用控制增量取代控制量： { x ( k + 1 ) = x ¯ + A d ( x ( k ) − x ¯ ) + B d ( u ( k ) − u ¯ ) y ( k ) = y ¯ + C ( x ( k ) − x ¯ ) + D ( u t ( k ) − u ¯ t ) (9) 由于车道保持行驶过程中，应控制车辆在预定车道内行驶，需要对侧向位移进行约束，同时满足前文假设小角度下的车辆模型假设条件，不超过车辆执行器的物理极限，对车辆纵向加速度、前轮转角范围和变化率建立控制约束如下： { u min ( t + k ) ≤ u ( t + k ) ≤ u max ( t + k ) , k = 0 , 1 , ⋯ , N c − 1 Δ u min ( t + k ) ≤ Δ u ( t + k ) ≤ Δ u max ( t + k ) , k = 0 , 1 , ⋯ , N c − 1 (10) 车道保持横向控制目标是实时准确的跟踪确定的车道路径，确保稳定性和舒适性。模型预测控制优化算法需要同时从侧向运动横向偏差最小和稳定安全考虑，定义优化目标函数求解系统的控制增量，目标函数引入松弛变量 ε 增强系统可行解，选取的目标函数为： J ( k ) = ∑ i = 1 N p ‖ y ( k + i | t ) − y ¯ ( k + i | t ) ‖ Q 2 + ∑ i = 1 N c − 1 ‖ Δ u ( k + i | t ) ‖ R 2 + p ε 2 (11) 式(10)中：N p 和N c 分别为预测和控制时域；ε为松弛因子；Q、R分别为表征横向跟随误差、控制输出增量权重矩阵。目标函数的第一项表示输出和参考之间的误差，它反映了控制目标的精确跟踪；第二项表示控制增量的大小，该值在控制目标上体现稳定性和舒适性；第三项是松弛因子，它保证了二次规划的最优控制量即前轮偏角。 将最优控制输入向量定义如下 Δ U = [ Δ u t , Δ u t + 1 , ⋯ , Δ u t + N c − 1 , ε ] T (12) 自适应MPC控制器计算得到的前轮转角 u ( k ) = u ( k − 1 ) + Δ u * ( k ) 作用于车辆执行器，直到产生在下一时刻最佳控制输入。"
"方程(1)中二自由度模型的状态空间矩阵形式如下 [ 10 ]： X ˙ = A r X r + B r U r + C r W r (13) 其中： A r = [ C l f + C l r m v x a C l f − b C l r m v x 2 − 1 a C l f − b C l r I z − a 2 C l f + b 2 C l r I z v x ] , B r = [ − C l f m v x − a C l f I z ] , C r = [ − C l r m v x b C l r I z ] , X ˙ = [ β ˙ ω ¨ ] , X r = [ β ω ˙ ] , U r = [ δ f ] , W r = [ δ r ] 。 线型二次规划最优控制(LQR)算法通过计算当前车辆状态X与理想状态量X d 之间的误差构造一个评价函数，通过求解评价函数即后轮的最佳输出角，得到最优控制律 [ 14 ]。用于建立车辆理想参考模型的状态变量如下式(13)所示： X d = [ β d ω ˙ d ] = A d δ f (14) A d = [ G β d G ω ˙ d ] = [ 0 v x ( a + b ) ( 1 + K v x 2 ) ] (15) 在公式(14)中， G β d 是侧滑角对前轮角输入的增益， G ω ˙ d 是前轮转向车辆横摆角速度的增益，K是表征车辆转向特性的稳定系数。 K = m a + b ( a C l r − b C l f ) (16) e = X − X d = [ e β e ω ˙ ] = [ β − β d φ ˙ − φ ˙ d ] (17) 为了保证LQR控制器有最优解，应设置控制器性能指标J，当J值最小时，应得到最佳后轮转角U(t)： J = 1 2 ∫ 0 ∞ [ ( X − X d ) T Q ( X − X d ) + U 0 T R U 0 ] d t (18) 其中： Q = [ q β 0 0 q ω ˙ ] , R = [ r r ] 式中， q β 、 q r 和 r r 分别表示侧滑角、横摆角速度和后轮角度。通过大量的仿真实验，本文确定LQR控制后轮主动转向的最优 q β 、 q φ ˙ 、 r r 值为5、0、1。 采用变分法求解二次型最优控制问题 [ 15 ]，最终得到最优控制律如下： U * ( t ) = − R − 1 B T P X + R − 1 B T ( P B R − 1 B T − A T ) − 1 ( Q A d − P C ) δ f (19) 状态反馈增益矩阵如下： K F B = R − 1 B 0 T P (20) 前馈增益矩阵： K F F = R − 1 B T ( P B R − 1 B T − A T ) − 1 ( Q A d − P C ) (21) 综上所述，基于最优控制的后轮主动转向控制方程可以表示为： δ r = K F B X e + K F F δ f (22) 为了比较分析不同四轮转向的控制效果，验证本文提出的四轮转向控制方法优越的控制性能，将后轮转角比例于前轮转角控制，控制表达式如(22)所示，定义了四轮转向车辆的前轮转角和前轮转角，K b 可以保证在稳定状态下侧滑角为0。横摆角速度的反馈控制控制表达式为式(23)。将基于线性二次型最优控制理论控制的主动四轮转向与上述方法对比。 K b = δ r δ f = − b − m a v x 2 / [ C c r ( a + b ) ] a − m b v x 2 / [ C c f ( a + b ) ] (23) δ r = − C c f C c r δ f + ( a C c f − b C c r C c r v x − m v x C c r ) ω ˙ (24)"
"为验证本文设计的自适应MPC车道保持最优控制四轮转向控制系统的优越性，利用Matlab/Simulink仿真，采用常用的双移线工况检测车道保持控制精度和车辆稳定性，对比在相同仿真条件下，不同四轮转向控制方法的控制效果。设置出初始仿真车辆参数：整车质量m = 1575 kg；横摆转动惯量I z = 2875 N/m；前轴距中心位置lf = 1.2 m；后轴距中心位置lr = 1.6 m；前轴侧偏刚度C lf = −19000 N/rad；后轴侧偏刚度C lr = −33000 N/rad；初始车速为15 m/s；设置自适应MPC控制器参数：控制时域N c 为2，预测时域N p 为10。设定前轮转角 δ f 变化范围为 − 25 ∘ ≤ δ f ≤ 25 ∘ ，变化量为 − 0.5 ≤ Δ δ f ≤ 0.5 ，仿真结果如下： 由仿真结果图2和图3可以分析得出，采用最优控制的四轮转向车道保持控制双移线路径曲率跟踪横向误差最小，分别较前轮转向、比例前轮四轮转向、横摆角速度反馈四轮转向三种转向控制方法减少了0.8 m、0.46 m、0.7 m横向偏移误差。由图4相对偏航角偏差对比可知，基于最优控制的四轮转向控制的车道保持相对偏航角偏差仅为0.9%，较另外三种方法相对偏航角误差最小，说明自适应MPC车道保持最优控制四轮控制效果满足车辆车道保持控制的道路中心线跟踪的精确性要求。 图2. 车道保持行驶路径 图3. 车道保持横向误差 图4. 车道保持相对偏航角 由仿真结果图5和图6可知，基于自适应MPC设计的车道保持控制器，通过采集道路信息和对车道中心线曲率以及偏差计算，考虑四轮转向车辆行驶稳定性需求，结合单轨车辆模型设置模型约束产生最优的前轮转角，图6显示了不同四轮转向控制方法后轮转角对前轮转角输入的响应输出。 图5. 前轮转角输入 图6. 后轮转角输入 由双移线工况下的车辆横摆角速度响应见图7可知，最优控制四轮转向控制的车辆横摆角速度与前轮转向汽车横摆角速度最为接近，说明该方法有很好的转向感与前轮转向车辆保持一致，同时产生的质心侧偏角见图8最大也仅为0.145 rad，最优控制四轮转向控制方法在保证车辆转向能力的同时，降低了质心侧偏角，确保了车辆在转向过程中的稳定性。 图7. 横摆角速度响应 图8. 质心侧偏角响应"
"本文针对智能四轮转向车辆车道保持控制时转向稳定性问题，提出了一种基于自适应MPC道路车道保持最优控制四轮转向方案，自适应MPC控制器逐步优化求解最优参考前轮转角并通过最优控制器得到最优后轮转角作用于车辆。双移线路径跟踪仿真实验测试结果表明：自适应MPC满足高速转向工况强耦合、非线性状况下车道保持的准确性和稳定性；最优四轮转向控制相比前轮控制、比例前轮四轮转向控制、横摆角速度反馈四轮转向控制方法横向偏差最小，质心侧偏角最小且保证了横摆率，可以有效的提高车辆的操纵稳定性，减少车辆侧偏角避免产生侧翻等危险状况。"
