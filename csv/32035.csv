"建立了用于消除泥浆脉冲信号基线漂移的形态学滤波器。采用最小二乘多项式拟合法、中值滤波法和形态学滤波法等3种方法处理泥浆脉冲PPM编码信号的基线漂移，并利用信噪比、均方根误差、归一化相关系数定量分析计算结果。对比结果表明，形态学滤波法消除泥浆脉冲信号基线漂移效果最佳。 关键词 :随钻测量，泥浆脉冲信号，基线漂移，形态学滤波 Copyright © 2019 by authors, Yangtze University and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"目前，无线随钻测量数据传输时，地面接收的泥浆脉冲信号常常存在基线漂移现象。随钻泥浆脉冲信号解码中，消除信号的基线漂移是重要的预处理工作，直接关系到后期解码的正确率，是泥浆脉冲信号解码技术的关键环节 [ 1 ] [ 2 ] [ 3 ] 。形态学滤波消除信号基线漂移的研究多见于医学中的心电信号去噪，其效果好、适应性强、计算量较小 [ 4 ] [ 5 ] [ 6 ] [ 7 ] 。医学心电信号和脉搏信号均具有规律性强的特征。但泥浆脉冲信号PPM编码信号占空比变化较大，同时还需考虑泥浆脉冲信号噪声干扰的随机性以及信号处理的实时性要求。因此，针对泥浆脉冲信号PPM编码信号的这一特征还需要进一步研究以消除其基线漂移。"
"泥浆脉冲信号以泥浆压力波的形式通过钻柱内从井底传输至地面，能量耗散不可避免，且压力波与其反射波叠加，会产生波形畸变。另外，由于钻头的活动、钻柱的自转公转、钻柱与井壁的撞击、井下工具和泥浆泵的泵冲等干扰因素，接收信号会混叠很强的噪声，为后续信号处理带来困难。图1为现场采集的压力脉冲信号局部特征，采样频率为200 Hz。分析信号的频域特征(图1(b))，噪声分布频域较广，幅度无明显规律，高强度噪声主要集中在0~20 Hz之内，低频噪声中的泵噪信号基值频率接近于0。 图1. 现场采集泥浆压力脉冲信号及脉冲信号频域分析"
"地面接收泥浆脉冲信号是一维离散信号，信号序列f(n)定义为 F = { 0 , 1 , ⋯ , N } ，一维结构元素g(m)定义为 G = { 0 , 1 , ⋯ , M } ，且M < N。形态学基本运算包括腐蚀和膨胀。 f(n)关于g(m)腐蚀的关系式如下： ( f Θ g ) ( n ) = min { f ( n + m ) − g ( m ) } ， n = 0 , 1 , ⋯ , N − M (1) f(n)关于g(m)膨胀的关系式如下： ( f ⊕ g ) ( n ) = max { f ( n − m ) + g ( m ) } ， n = 0 , 1 , ⋯ , N + M − 2 (2) 将腐蚀和膨胀进行级联可以组成开运算和闭运算。开运算是指信号先被结构元素腐蚀再膨胀，记为“ ∘ ”，其关系式为： ( f ∘ g ) ( n ) = ( f Θ g ⊕ g ) ( n ) (3) 闭运算是指信号先被结构元素膨胀再腐蚀，记为“ • ”，其关系式为： ( f • g ) ( n ) = ( f ⊕ g Θ g ) ( n ) (4) 形态学开运算可以抑制信号正脉冲，闭运算可以抑制信号负脉冲，是基本的形态滤波器。  笔者采用2级滤波消除泥浆脉冲信号的基线漂移。第1级形态学滤波器直接处理原始泥浆脉冲信号f 0 ，分别进行先“开”再“闭”运算和先“闭”再“开”运算，并取二者的算术平均，获得信号f 1 。第1级运算消除高频噪声，保留脉冲信号，选择的结构元素应与脉冲信号特征近似，且结构元素宽度小于脉冲信号宽度。其运算关系式如下： f 1 = 1 2 ( f 0 ∘ g 1 • g 1 + f 0 • g 1 ∘ g 1 ) (5) 第2级形态学滤波器处理第1级运算获得的信号f 1 ，分别进行先“开”再“闭”运算和先“闭”再“开”运算，并取二者的算术平均，获得基线漂移相关分量信号f 2 。第2级运算需要消除脉冲信号，且保留基线的特征，结构元素宽度应大于脉冲信号的宽度。其运算关系式如下： f 2 = 1 2 ( f 1 ∘ g 2 • g 2 + f 1 • g 2 ∘ g 2 ) (5) 最后，将原始泥浆脉冲信号f 0 减去基线漂移相关分量信号f 2 ，即可消除原始泥浆脉冲信号的基线漂移。 f 3 = f 0 − f 2 (6)"
"试验研究采用含强非线性基线漂移的模拟泥浆脉冲信号作为样本，分别采用最小二乘多项式拟合法、中值滤波法和形态学滤波法消除该信号的基线漂移，并对计算结果进行定量分析。  将基线信号从噪声信号中排除，并单独考虑，作为重要分析对象。图2为理想泥浆脉冲信号和各信号分量。 图2. 试验样本信号   采用最小二乘多项式拟合法、中值滤波法和形态学滤波法，分别处理图2中的模拟信号e和f (结果如图3、图4所示)。图3(a)中左端仍可见比较明显的基线波动，图3(b)中左端的基线波动轻微，图3(c)中左端基线波动极小。图4(a)中右端仍存明显的基线波动，图4(b)和图4(c)右端基线波动轻微。因此，可以初步判断形态学滤波消除基线漂移的效果最佳，中值滤波法的效果次之，最小二乘多项式拟合法的效果最差。 图3. 模拟信号高占空比处存在强非线性基线漂移的修正结果 图4. 模拟信号低占空比处存在强非线性基线漂移的修正结果  选取信噪比(R SN )、均方根误差(E rms )、归一化相关系数(C ncc ) 3个指标进行定量分析。R SN 越大、E rms 越小、C ncc 越接近1，则表示信号消除基线漂移的效果越好。计算R SN 、E rms 、C ncc 所需的对比样本为图2(c)为例，结果见表1、表2，可以看出，在PPM编码信号占空比高、低两种情况下，形态学滤波结果的R SN 最大、E rms 最小、C ncc 最接近1，所以形态学滤波的效果最好。3种方法对比，中值滤波的效果次之，最小二乘多项式拟合最差。 Table 1 方法 R SN E rms C ncc 最小二乘多项式拟合法 3.0366 13.8243 0.8066 中值滤波法 6.6990 16.5151 0.9002 形态学滤波法 9.8388 10.3444 0.9513 表1. 模拟信号高占空比处存在强非线性基线漂移的修正结果对比 Table 2 方法 R SN E rms C ncc 最小二乘多项式拟合法 2.5687 13.8171 0.7835 中值滤波法 5.9797 14.8940 0.8853 形态学滤波法 7.3071 10.7396 0.9102 表2. 模拟信号低占空比处存在强非线性基线漂移的修正结果评价"
"采用2级滤波消除泥浆脉冲信号的基线漂移，分别采用最小二乘多项式拟合、中值滤波和形态学滤波处理含强非线性基线漂移的模拟泥浆脉冲信号。对比结果显示，在PPM编码信号占空比高、低两种情况下，形态学滤波的R SN 最大、E rms 最小、C ncc 最接近1，说明形态学滤波可以有效地消除泥浆脉冲信号的基线漂移，效果最佳。"
