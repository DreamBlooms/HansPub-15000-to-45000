"为了应对世界范围内的能源危机和环境污染问题，以三联供为代表的多能源混合系统应用而生。但实际运行经验表明，若潮流分布不合理，多能源混合系统可能存在生产成本和发电效益不匹配的问题。本文以IEEE 123节点网络为例，研究了含天然气和电力在内的混合网络的潮流优化问题，首先利用OpenDSS软件搭建混合网络模型，同时设置各种约束条件，然后将OpenDSS模型导入MATLAB，最后利用MATLAB工具箱提供的粒子群优化算法实现混合网络的潮流优化。 关键词 :多能源系统，最优潮流，粒子群优化算法 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着世界各国经济快速发展，人们对能源的需求也与日俱增，与此同时，产生的大规模污染也使得全球环境不堪重负。为了适应世界的新形势实现可持续发展，多能源混合技术在电力系统中应运而生。多能源混合技术是指将可再生能源与不可再生能源进行耦合，结合多种能源的优点，充分提高能源利用效率，减少发电过程中所产生的污染。近些年来，以三联供为代表的多能源供能方式由于其更加高效的供能效率，逐步得到了人们的青睐。三联供系统以天然气为主要燃料，不仅用于供电，还可以利用余热向用户供热、供冷。但考虑到目前三联供模式下，冬夏季城市的天然气利用存在峰谷差值，这种不合理的用气结构不仅造成天然气的浪费，也使天然气输配管道利用率下降，且天然气输送管道内部压强会随着输送天然气量的消耗而降低，为了保证系统压强平衡，需要对管道加压，这个过程也需要耗用很大的成本，显然会使初始发电收益削减。 为了确保初始发电收益，即考量多种能源系统运行的经济性，需要对发出的电能所获取的收益及因加压所消耗的成本进行规划，即进行潮流优化。目前，国内外在多能源系统最优潮流优化方面已展开了大量的相关研究工作。文献 [ 1 ] 提出了不同的能源基础设施耦合优化算法，如电力、天然气、集中供热系统的耦合功率流的组合优化方法。文献 [ 2 ] 围绕着水火电力系统多个运行指标间的合理协调问题，研究了如何构建节能调度模型及该模型的求解方法。文献 [ 3 ] 提出了基于分布式热电联产装置的综合能源系统调度模型，将城市电力、水、天然气网络耦合起来。文献 [ 4 ] [ 5 ] [ 6 ] 研究了电力天然气综合系统的最优混合潮流。文献 [ 7 ] 研究了电热能源集成系统的运行优化，将热力网络约束纳入考虑，说明电热联合系统能较好地促进风电消纳。文献 [ 8 ] 提出广义启发式算法，研究电力、天然气、热力综合网络的最优潮流，并解决了装置可变效率问题。 综合分析最优潮流的计算方法发现，粒子群优化算法在解决电力系统问题，尤其在多变量非线性约束规划问题方面，表现出比其他算法更快的收敛速度，且找到全局最优解的概率也较高。文献 [ 9 ] 将粒子群优化算法应用于解决各类复杂等式约束和不等式约束条件问题，同时对连续变量及离散变量的最优问题进行了求解，证实了PSO的广泛应用性。文献 [ 10 ] 通过导入被动聚集因子，并利用此类因子与粒子群优化算法的耦合来解决最优潮流问题，这一方法有效地提升了传统最优粒子群算法的计算收敛性，因而提高了计算效率。 本文以文献 [ 11 ] 的算例为基础，对含天然气和电力在内的混合网络潮流进行优化研究。混合网络的模型搭建及相关约束条件设置均基于OpenDSS软件实现，然后将OpenDSS模型导入MATLAB中，利用MATLAB提供的粒子群优化算法工具实现潮流优化。研究结果显示，本文提出的研究思路可以实现多能源混合网络的潮流优化，对其他相关研究有一定的借鉴意义。"
"研究多能源混合网络的潮流最优解，首先要确定混合网络的各组成部分的数学模型，本小节主要是针对电网、天然气管道及能源集线器的基本数学模型进行较详细的说明，为后续数据处理奠定基础。  电网中的潮流模型由节点复功率平衡来建立。对于节点m，节点复功率平衡如下式表示： (2-1) S m 是注入节点m的复功率，S mn 是流向与节点m相关联的所有节点的潮流。而线路上的潮流由节点电压幅值U和相角θ及线路的参数来表示。  天然气管道网络潮流模型同电力网络潮流模型类似，可以根据节点流量平衡来建立。因而对于该网络中某一节点m，其体积流量平衡公式如下： (2-2) Q m 是注入节点m的天然气体积流量，而Q mn 则是管道的体积流量，其具体表达公式如下： (2-3) P m 和P n 分别表示天然气管道上游及下游的压力，k mn 用来表征天然气管道及内部天然气特性的参数，文献 [ 12 ] 给出了该参数的具体计算公式： (2-4) 在式(2-4)中，各字母所标示的含义如下： T b ——标准状态下的温度(K)； p b ——标准状态下的压力(kPa)； D mn ——管道内径(mm)； T f ——管道内燃气的温度(K)； G——天然气相对空气的比重； Z——燃气压缩因子； L mn ——天然气管道长度(km)； f mn ——气体管道摩擦系数。 式(2-3)中，s mn 表征管道内气体流动方向，具体取值如下： (2-5) 微型燃气轮机驱动天然气管道的压缩机，驱动所消耗的功率可视为流入管道的额外能量，压缩机的能耗如下式所示： (2-6) 式(2-6)中，P k 表示压缩机入口侧的压力，而P m 则表示压缩机出口侧的压力。 正如前文所述，天然气管道流量Q mn 与电力潮流P mn 相似，因而两者之间的关系只相差一个转换系数k，相应公式如下： (2-7) 天然气管道模型如图1所示。天然气压缩机用字母C来表示，天然气管道用字母P表示。  类似与计算机科学中的“集线器”概念，从宏观上看，能源集线器是连接微电网与大电网的一个控制中心或控制平台，它通过实时在线监测分布式电源、配电网的各项状态以及对数据进行超短期负荷预测，实现对各发电侧和受控负荷的优化控制。鉴于微电网的覆盖面积较广，因而能源集线器的规模小则可以覆盖一个家庭或者一个社区网络，大则覆盖整个城市网络 [ 13 ] 。图2给出了能源集线器与电网之间的反馈关系。由图2可以看出，能源集线器在电力系统中与配电网连接，两者相互补充能量，提升了电力系统的工作效率。 根据能源集线器的特点及结构可知，能源集线器是各能源载体间的接口，具有多输入–多输出端口 [ 14 ] ，因而需要对该系统内部功率间交换关系进行描述。 图1. 天然气管道模型 图2. 能源集线器与电网的反馈关系 对于一个单输入单输出的能量转换装置而言，输入输出关系如下式： (2-8) 上式中， 和 分别表示系统的稳态输入及输出，而 则为输入及输出之间的耦合系数。对于拥有多种能源形式的多能源系统，利用耦合矩阵C表示输入及输出之间的耦合关系，而相量P及相量L表示多能源系统的输入及输出。 (2-9) 设燃气轮机的转换效率为常数，天然气经过微型燃气轮机转化为其它能量的效率是 ，因而多能源系统输入输出关系如下： (2-10)"
"最优潮流作为电力系统运行中的一类重要优化问题，可以用来在满足电力系统负荷需求和运行约束的前提下，通过调整控制参数获得电力系统最优的运行状态 [ 15 ] 。对于此类最优问题，其目标函数为系统运行成本最低或者电网总网损最小。根据选用不同的最小优化目标函数、不同的控制变量集和不同的约束集，就得可以解决不同网络的最优潮流问题。 结合已有研究成果分析发现，天然气–电力最优潮流是一个有各种线性约束和非线性约束条件的非线性优化问题。因此本文所求解的优化问题同时受限于等式约束及不等式约束，等式约束方程由电力网络潮流方程、天然气流量网络方程、能源集线器系统的平衡方程构成，不等式约束由电力及天然气网络变量构成，目标函数是使总能量消耗最小。 1) 等式约束条件 等式约束条件由电力网络潮流方程、天然气网络流量方程及能源集线器的平衡方程组成，如下式所述： (3-1) 2) 不等式约束条件 电力系统的优化问题一般对系统各种功率、各点电压值等表征系统特征的物理量进行限制。该问题中，不等式约束由能源集线器的输入P i ，电力网络和天然气网络的流量F a 、发电机电压幅值U m 和相角θ m 、发电机有功出力P ei 和无功出力Q ei 、天然气管道压力p m 的限制共同组成。 (3-2) (3-3) (3-4) (3-5) (3-6) (3-7) (3-8) (3-9) (3-10) 3) 目标函数 本文所建立的多能源混合网络模型分别由电网及天然气网络提供能源，因而其目标函数应使总耗电量及天然气消耗量最小，即为总的购电成本与天然气消耗成本和最小，因而目标函数如下： (3-11) 上式中，T e 和T g 分别代表消耗的电能及天然气成本，同时本文将天然气网络的消耗特性等同于电力网络来处理。"
"本文利用IEEE 123节点模型(网络结构见图3)，利用粒子群优化算法对潮流优化问题进行计算分析。需要说明的是，由于粒子群优化算法迭代次数设置有限，因而部分优化问题不能保证寻找到精确最优解。 图3. IEEE123节点网络图  为了提高MATLAB仿真速率，本文对基于孤岛模型的并行粒子群优化算法进行了研究，通过编写程序实现了利用计算机的多核功能并行计算粒子最优解。为了保证并行计算的可利用性，文章首先以IEEE 123节点为基本拓扑，通过在图3的79节点处添加一台光伏，利用光伏在一天内各小时出力的不同改变该网络的基本潮流，以改变潮流计算次数，测试不同计算量下并行计算指令的优势。 执行并行计算指令前，首先利用“MATLABPOOL 2”执行多核配置，该指令暗示对于本台两核电脑开辟两个虚拟“实验室”进行多核计算，同时在MATLAB代码中，用并行计算指令代替原来的串行计算指令。表1是通过执行不同计算次数的潮流所耗时间统计。 利用OpenDSS处理不同数目的数据，可以发现： 1) 利用并行循环指令确实可以提升代码执行速率； 2) 当输入数据个数比较少时，速率提升效果不是非常明显，这是由于并行计算指令在处理小数目数据时，由于其自身占用电脑内存时也需耗一定的时间，因而计算量较小时效果不是特别明显； 3) 当计算量较大时，并行计算指令相比串行指令速率提升的百分比会呈现上升趋势，但当计算量更大时的速率提升效果还有待探究；当执行计算的电脑核数更多时，并行计算指令的速率所提升百分比也需要进一步测试得到。 基于OpenDSS并行的研究，本文对粒子群优化算法的并行计算也开展了相应的研究，结果显示，当每次迭代次数取100次时，串行计算指令消耗时长约为31 s，并行计算指令约为19 s，显然计算速率提升了40%，这说明并行计算指令在计算速率上的极大优势。  在IEEE123网络的节点13、86、108处添加三台燃气轮机，同时在节点79处添加一台光伏，由于光伏有功功率输出在一天内各个小时随着光照强度的变化而发生改变，因而整个网络的潮流也会随着变化，同时三台燃气轮机的最优出力也会发生变化。该优化问题的目标函数是使整个网络的网损最小，即： 以7月份某天为例，测试这一天内所添加在节点79处的光伏出力，其输出有功功率值随时间变化曲线如图4所示。 由图4可以看出，光伏输出的有功功率值随着光照强度的增强而增加，因而可以推测在中午时分，整个网络的潮流变化最大。 利用粒子群优化算法对每一时刻网络的潮流进行优化求解，设定各台发电机的出力上限为500kW，优化后三台发电机最优出力曲线如图5所示。 由图5可以看出，燃气轮机1的出力达到上限500 kW，而燃气轮机2和燃气轮机3的有功出力则随着光伏出力的变化发生变化，显然光伏出力较多时燃气轮机的出力会下降。同时，为了体现采用粒子群优化算法后的优化效果，对整个网络的网损曲线及未优化时的网损曲线进行描绘，通过两类曲线对比得到最终结论。图6给出了网络优化前后的网损曲线。 由图6可以看出，对网损没有进行优化时，当光伏出力为零时，网损较大，而到了中午时分，光伏出力增加，网络有功损耗下降，利用粒子群优化算法优化后的网损会变得很低，而且一天内网损变化很小，达到了优化的目的。 寻找整个网络中节点电压最低的一个节点39及所添加光伏的79节点，绘制两节点优化后每时刻电压的变化曲线，节点39及节点79的电压值均为三相电压，研究通过优化算法优化后整个网络中节点电压的变化程度以及接入光伏后对节点电压的影响情况。 节点39及节点79的电压值随着一天时刻的变化曲线图如图7和图8所示。 由图7和图8可以看出，利用粒子群优化算法对全网络潮流优化求解后，各个节点的电压变化程度也变小了，体现出了优化的效果。 Table 1 输入数据个数 串行计算指令所耗时间(S) 并行计算指令所耗时间(S) 速率提升百分比(%) 24 0.803606 0.661054 17.74 144 4.487114 2.747462 38.77 240 7.455185 4.281431 42.57 表1. 串行指令与并行指令计算速率对比表 图4. 光伏一天内出力曲线 图5. 各台燃气轮机最优出力曲线 图6. 优化前后网损曲线对比 图7. 优化后节点39电压变化曲线 图8. 优化后节点79电压变化曲线"
"研究多能源系统的最优潮流问题，是为了应对未来电网能源发展方向的重要课题。本文以天然气网络与电网耦合的综合系统为例，以网络耗电耗气成本最低为目标函数，加入各类约束条件，最终求解和分析出了混合网络的潮流优化问题。此外，本文以MATLAB工具箱中的粒子群优化算法为基础，编程实现了可提高计算速率的并行粒子群算法，该方法充分利用了计算机多核处理器的特点，实现了系统的充分利用，这在研究多能源大系统的最优潮流方面有一定的计算基础和借鉴意义。 本文旨在研究潮流优化问题，但由于电力系统的复杂性，研究过程中考虑的约束条件并不能保证全面性，如本文设置的最优潮流目标函数中只考虑了系统的运行成本，暂时没有考虑系统的前期建设投资成本，因此研究结论有一定的局限性。为保证本文研究成果的延续性，后续将进一步完善目标函数，实现多能源混合系统更加详细的经济性分析。"
