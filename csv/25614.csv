"针对传统机械式永磁同步电机(PMSM)转子初始位置检测方法存在可靠性差、适用范围小的缺陷，对利用高频信号注入的转子位置检测方法进行了改进。该方法利用PMSM的凸极效应，将永磁同步电机注入高频信号，对三相电流进行滤波后用外差法提取转子位置信息，并设计观测器准确地估计出转子位置。在滤波环节，设计了一种基于比例谐振控制器的带通滤波器，简化了滤波器结构，易于数字实现。仿真实验结果表明，提出的方法可以准确检测PMSM转子位置，位置检测的平均误差在0.1˚以内。 关键词 :永磁同步电机，外差法，转子位置检测，带通滤波器 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"永磁同步电机(PMSM)因其具有高性能、工作密度高、控制特性优良和可靠性高等特点，在军事与民用领域都取得了广泛的应用。在其控制过程中，无论是直接转矩控制还是矢量控制，都对电机转子的初始位置确定有极高的要求。传统的永磁同步电机转子位置检测主要是通过机械式位置传感器来实现的，这些传感器包括测速发电机、旋转变压器或光电编码器等。但在高温、超时、高粉尘等环境工作时，它们的可靠性将大大降低 [ 1 ] [ 2 ] 。因此，使用无位置传感技术来进行转子位置的检测具有特殊的优势。文献 [ 3 ] 提出了一种检测基波反电动势，以此来获得转子位置信息的方法，但在电机低速或是零速时，电机的反电动势很小，不易被检测。文献 [ 4 ] [ 5 ] 提出基于高频电压检测的方法，但要求必须已知电机参数并且需要外加观测器，算法较为复杂，实际应用存在一定的困难。文献 [ 6 ] [ 7 ] [ 8 ] 提出了转子凸极跟踪的转子位置检测方法。该方法要求电机具有一定的凸极效应，且对电机参数变化不敏感，鲁棒性好。 针对以上研究所存在的问题，本文采用一种基于高频旋转电压信号注入的转子位置辨识方法。通过在永磁同步电机的定子端注入幅值很小的高频电压脉冲信号，使其在电机的定子绕组中产生与之对应的高频电流响应。对得到的高频电流响应进行相应的解调、滤波、正负相序分量分离和外差法处理之后，就可以得到永磁同步电机转子的初始位置信息 [ 9 ] [ 10 ] [ 11 ] 。实验结果表明，由于注入高频电压信号的频率高且幅值低。在检测的过程中，转子不会出现转动的现象，而且估计准确度高。从而为电机的平稳启动提供了基础。"
"三相永磁同步电机作为一个强耦合、复杂的非线性系统，相关数学模型的建立对于其控制算法的设计具有十分重要的意义 [ 12 ] 。在同步旋转坐标系下建立三相PMSM在高频电压信号激励下的数学模型。 定子旋转坐标系下的电压方程为： u d = R i d + d d t ψ d − ω e ψ q u q = R i q + d d t ψ q + ω e ψ d (1) 定子的磁链方程为： { ψ d = L d i d + ψ f ψ q = L q i q (2) 将式(1)与(2)联立将电压方程改写为： { u d = R i d + L d d d t i d − ω e L q i q u q = R i q + L q d d t i q + ω e ( L d i d + ψ f ) (3) 将PMSM在同步旋转坐标系 q r   d r 下定子电压方程和磁链方程变换为静止坐标系 q s   d s 中，可得： [ u d s u q s ] = R [ i d s i q s ] + d d t [ ψ d s ψ q s ] (4) [ ψ d s ψ q s ] = [ L + Δ L cos 2 θ r Δ L sin 2 θ r Δ L sin 2 θ r L − Δ L cos 2 θ r ] [ i d s i q s ] + ψ f [ cos θ r sin θ r ] (5) 式中： L = ( L d + L q ) / 2 —平均电感； Δ L = ( L d − L q ) / 2 —半差电感。 它的值在内置式PMSM中较大，而在表贴式PMSM中接近于0。 定义两相静止坐标系 q s   d s 的电感 L d q s 为： L d q s = [ L + Δ L cos 2 θ r Δ L sin 2 θ r Δ L sin 2 θ r L − Δ L cos 2 θ r ] (6) 从式(6)中可以发现，该电感矩阵中含有PMSM转子位置 θ r 的信息。 由式(1)可知如果注入的旋转高频信号的频率相对于电机旋转的角频率足够大时，一般为0.5~2 kHz，即高频信号的频率远高于电机基波频率。这时可以将永磁同步电机当作是一个简单的RL负载，此时高频电压方程可简化为： { u d h s ≈ L d d i d h s d t u q h s ≈ L q d i q h s d t (7) 旋转坐标系中PMSM的电磁转矩与机械运动方程为： { T e = 2 3 n p ( ψ d i d − ψ q i q ) J p ω e n p = T e − T L − R Ω ω e n p (8) 由式(1)、(7)、(8)就能够建立高频信号激励下的永磁同步电机数学模型。"
"采用旋转高频电压信号注入法进行转子初始位置的检测，其优点在于检测出的转子位置信息包含在电机定子的电流响应之中，且对电机参数的变化不敏感，较强的鲁棒性和适应性使其具有广泛的应用范围。尤其是在凸极效应明显的内置式永磁同步电机转子位置检测上有着明显的优势。  为了获取高频信号，我们常用的有从外部电路获得和使用PMW逆变器产生两种方式。相比之下，使用逆变器来产生高频信号，更有利于增加系统的稳定性与可靠性，同时也会节约一定的成本。 但值得注意的是，对于中、小型逆变器，开关频率通常被设定为8~20 kHz，逆变器的开关谐波受其负载的变化和自身开关频率的影响，逆变器频率越高，其产生的波形将越接近与正弦波，但逆变器的直流母线电压的变化和逆变器的死区时间都会导致高频电压信号非正弦化。从而影响转子位置信息的估计，所以在实际系统设时要充分考虑到这一点所带来的影响，若需要将逆变器开关频率设置为500~2000 Hz时，此时高频电压信号将失真严重，所以此时高频电压信号只能有外部电路产生。 受到最大基波的频率、系统所需的估计带宽以及SVPWM的开关频率的影响。高频电压信号的频率在选择时不能超过开关频率的1/2，否则将会产生大量的谐波混杂信号。与此同时，受到载波频率的增加、信噪比的减小和电机特性的不断变化等因素的影响，高频电压信号的频率的最大值被再一次约束在了一个更小的范围 [ 13 ] 。为了保证其产生正弦波的正弦性，高频信号的最大值应小于800 Hz。选择高频信号将由数字化电路产生，应考虑到实际电路中芯片的能力，此时选择高频信号的频率一半低于500 Hz。此外，如果注入的高频电压信号的频率太低，接近于基波的频率，这时高频信号将不容易与基波信号分离，为了满足这个要求高频信号的频率被限定在了300 Hz以上。所以高频电压信号的频率应取一个介于逆变器开关频率和基波信号频率之间的一个合理值。综上所述，本文在仿真实验中选取高频信号的频率为400 Hz。 同时，高频电压信号幅值选择受到逆变器的电流反馈值和其非线性特性的影响，选去高频电压信号的幅值较高时，将会产生较大的系统噪声，若这个值继续增加，则甚至有可能使电机在检测过程中发生意外转动，使整个初始位置检测过程失去意义。但是如果幅值较小的话，将会使得高频电流响应信号变得微弱，对整个信号处理系统的要求又会大大增加。所以，选择为高频电压信号的电压为5 V。  带通滤波器可以通过其指定频率范围内的频率分量，可以利用这个特性，将注入的高频信号电流响应分量选择出来。传统模拟带通滤波器由电阻-电感-电容电路(RLC circuit)构成。在实际设计中实现起来较为繁琐。因此本文采用了一种基于比例谐振(Proportional Resonant, PR)控制器的带通滤波器设计方法。  对于被控量为交流信号的控制系统，其理想的PR控制器传递函数： G P R ( s ) 1 = 1 2 [ G P I ( s + j ω 0 ) + G P I ( s − j ω 0 ) ] = K p + 2 K i s s + ω 0 2 (9) 其中： K p 为比例增益， K i 为积分增益。 理想的比例谐振控制器只在谐振频率点 ω 0 处的增益比较大，而在谐振频率点外的增益急剧下降，这样控制系统对输入信号频率的变化就会变得比较敏感，使得系统变得不稳定。而且，在实际系统中，元器件参数的精度和数字控制系统的精度都是有限的，所以理想比例谐振控制器无论是在模拟系统还是数字系统中都不易实现 [ 14 ] 。所以选用一种改进的准PR控制器，其结构框图如图1所示，其中 K G 为改进PR控制器的比例系数。 图1. 准PR控制系统结构框图 其传递函数为： G P R ( s ) = K p + 2 K i ω c s s 2 + 2 ω c s + ω 0 2 (10) 其中 ω 0 为准谐振控制器的截止频率。  由式(10)可知，比例谐振控制器的传递函数中含有三个参数，分别是 K p ， K i 和 ω c 。可以通过调整这三个参数的值来设计带通滤波器。利用波特图进行分析，分别仅改变这三个参数，分析其对控制器效果的影响。 由图2可知：频带外的幅值随 K p 的增大而增大，而基波频率处的幅值增加幅度不大，所以对于带通滤波器的设计， K p 的值不能设置过大。由图3可知：随着 K i 的增大，基波频率处增益增大，但频带范围增大，这时无用信号将会被放大，会使系统崩溃，所以 K i 应取一个中间的合理值。由图4可知：随着 ω c 的减小，基波频率处增益增大，频带变窄，说明其对信号具有良好的选择性。通过这些特点，就可以利用比例谐振控制器来设计带通滤波器。 利用比例谐振控制器原理设计带通滤波器，由于注入的高频信号频率被设置为400 Hz。所以只需要将比例谐振控制器的准谐振频率 ω 0 的值设置为 400 × 2 π rad/s，并且整定 K p ， K i 和 ω c 的大小。通过对不同参数波特图的分析，综合考虑实际要求，在系统设计时可取 K p = 0.1 ， K i = 1 ， ω c = 15 。 为了使比例谐振带通滤波器易于数字化实现，将其采用双线性变换的方法离散化，变换公式为： s = ω 0 ( z − 1 ) tan ( ω 0 T s / 2 ) ( z + 1 ) (11) 式(11)中 T s 为离散系统采样周期。令 b = ω 0 / tan ( ω 0 T s / 2 ) 。将式(11)带入式(10)中，可得到离散化传递函数： G P R ( z ) = b 0 + b 1 z + b 2 z 2 a 0 + a 1 z + a 2 z 2 (12) 图2. 只改变 K p 参数结果 图3. 只改变 K i 参数结果 图4. 只改变 ω c 参数结果 式中： b 0 = − d k i ω c d 2 + d ω c + ω 0 2 ,       b 2 = d k i ω c d 2 + d ω c + ω 0 2 ,       b 1 = 0 a 0 = d 2 − d ω c + ω 0 2 d 2 + d ω c + ω 0 2 ,       a 1 = 2 ( ω c 2 − d 2 ) d 2 + d ω c + ω 0 2 ,       a 2 = 1 整理后得到控制器的差分方程为： y ( k ) = b 0 x ( k − 2 ) + b 2 x ( k ) − a 1 y ( k − 1 ) − a 0 y ( k − 2 ) (13) 由图(1)和式(13)可以看出，控制器的结构变得简单，并且比较容易实现数字化。  旋转高频电压注入法利用在基波上叠加一个三相平衡的高频激励电压的原理，检测电机中对应产生的电流响应其系统框图如图5示。其中Clark变换将三相坐标系转换为两相静止坐标系，SFF为同步轴系高通滤波器。 设注入高频电压信号的频率为 ω i n ，幅值为 V i n ，则注入旋转高频电压信号可表示为： u α β h s = [ u α h s u β h s ] = [ V i n cos ω i n t V i n sin ω i n t ] = V i n e j ω i n t (14) 将式(14)转换为同步旋转坐标系下，有： u d q h s = u α β h s e − j θ r = V i n e j ω i n t (15) 将式(15)代入式(7)中，可得旋转坐标系下高频电压激励下的三相PMSM的电流响应方程为： i d q h s = V i n L d ∫ cos ( ω i n t − θ r ) d t + j V i n L q = V i n ω i n L d L q [ L d + L q 2 e j ( ω i n t − θ r − π 2 ) + L d − L q 2 e j ( − ω i n t + θ r + π 2 ) ] (16) 将式(16)变换到两相静止坐标系下的表达式为： i α β h s = i d q e j θ r = I c p e j ( ω i n t − π 2 ) + I c n e j ( − ω i n t + 2 θ r + π 2 ) (17) 式中： I c p —正相序高频电流分量的幅值， I c p = V i n ω i n L d L q L d + L q 2 ； I c n —负相序高频电流分量的幅值， I c n = V i n ω i n L d L q L d − L q 2 。 从式(17)可以得出，高频电压信号注入下永磁同步电机的电流响应包含了两种分量，一种是旋转方向与注入电压矢量的方向相同的正相序分量，其幅值与平均电感相关。另一种称为负相序分量，它的旋转方向与注入电压矢量方向相反，幅值与半差电感相关 [ 15 ] 。不难看出，正相序高频电流分量中不包含任何与转子位置有关信息，只有负相序高频电流响应分量中包含了转子的位置信息 θ r ，如何选取适当的信号处理方式来将它提取出来成为实现转子位置检测的关键步骤。 图5. 电机中对应产生的电流响应系统框图  为获得负相序高频电流响应中的转子位置信息，设计带通滤波器(BPF)和同步轴系高通滤波器(SFF)分别滤除电机端电流中的基波电流、低次谐波电流、PWM开关谐波电流与正相序高频电流响应等无关信号 [ 16 ] 。经过滤波处理后，负相序高频电流信号被提取出来，可以用其来对转子凸极进行跟踪，其矢量表示为： i d q h s _ n = I c n e j ( − ω i n t + 2 θ r + π 2 ) (18) 由式(18)可知，为了从负相序高频电流响应分量中提取转子位置信息，常用的方法为外差法，外差法作为通信原理中常用的模型，它的作用是实现相角调制来解调出经过空间凸极调制的负相序高频电流分量，以此得出与矢量相位误差成正比的转子位置跟踪误差信号 [ 17 ] [ 18 ] 。误差信号的表达式如下： ε = i q h s _ n cos ( 2 θ ^ r − ω i n t + π 2 ) − i d h s _ n sin ( 2 θ ^ r − ω i n t + π 2 ) = I c n sin ( 2 θ r − 2 θ ^ r ) (19) 由式(19)可知误差信号 ε 的值与 sin ( 2 θ r − 2 θ ^ r ) 相关，本文采用基于锁相环(PLL)的方法来识别负相序高频电流响应分量的相位，为了是PLL有较高的稳定性和抗干扰性，采用具有比例积分特性的PLL跟踪方法来设计转子位置观测器。调节PLL的参数使得位置跟踪误差信号 ε 的值尽可能的趋近于0，这样转子位置估计值 θ ^ r 将会收敛于转子位置实际值 θ r ，从而得到转子位置的一个较为准确的估计值。转子位置检测的原理框图如图6所示。"
"根据图6所示的旋转高频电压信号注入的三相永磁同步电机初始位置检测的原理图，结合图5所示的电机用对应产生的电流响应的系统框图，利用MATLAB/Simulink搭建系统仿真模型，如图7所示。在仿真过程中，为了便于检测永磁永同步电机不同初始位置情况下的检测参数，仿真实验采用MATLAB/Simulink中自带三相PMSM仿真模块，电机具体的设置参数如表1所示。 图6. 转子位置检测的原理图 图7. 旋转高频电压信号注入的三相PMSM初始位置检测仿真 Table 1 参数名称 参数符号 参数值 额定功率 P n 35 W 额定频率 f n 50 Hz 额定转速 N r 3000 r/min 直轴电感 L d 5.2 mH 交轴电感 L q 17.4 mH 定子电阻 R s 1 Ω 极对数 n p 4 转动惯量 J 0.008 kg ⋅ m 2 转子磁链 ψ f 0.646 Wb 表1. 仿真用永磁同步电机参数表 仿真实验的条件设置为：逆变器直流测电压 U d c = 311   V ，SVPWM的开关频率设置为5 kHz。并选择高频电压的幅值 V i n = 5   V ，频率 f h = 400   Hz ，带通滤波器采用基于比例谐振控制器设计，谐振频率为400 Hz。 设置永磁同步电机初始角度为30˚，运行仿真，结果如图8所示。由图可知在仿真运行时间0.6秒后，估计结果逐渐趋于稳定。 分析检测时产生的误差，可得估计误差如图9所示。由图可知系统稳定后最大估计误差在0.04˚以内。后对不同初始角度进行多次估计验证，其估计误差被控制在0.1˚以内。完全满足设计要求。 进行永磁同步电机转子初始位置的检测，其目的在于预知其初始位置，为其后续的矢量控制或直接转矩控制提供信息，避免转子反转或启动失败。所以转子的位置不能在检测的过程中发生明显的偏移。图10显示了在转子位置检测的过程中，永磁同步电机转子实际位置变化的情况，由图可知，转子位置在检测过程中发生极小角度的偏转。从图9可以看出转子位置的估计误差不是稳定在一个固定的值，在检测过程中稍有波动，误差值始终保持在0.04˚以内。由于位置估计误差的波动，相应的图10中转子的位置偏移量也出现波动，但转子位置的正偏移保持在0.04˚以内，可以近似认为转子在这此过程中未发生明显转动，满足设计要求。 图8. PMSM初始位置为30˚时仿真结果 图9. PMSM初始角为30˚时的位置误差 图10. 检测过程中PMSM转子位置的偏移情况"
"本文介绍了一种基于高频旋转电压信号注入法的永磁同步电机转子启动前初始位置检测方法，克服了传统检测方法对电机参数有要求或者要求额外增加外设硬件的缺陷。提出了基于比例谐振控制器的带通滤波器设计方法，简化了系统结构，易于系统的数字化实现。仿真实验结果表明，在保证转子不发生明显转动的前提下，该方法实现了对永磁同步电机转子位置的检测，检测的最大误差被控制在0.1˚以内。满足永磁同步电机启动前对初始位置信息准确性的要求。"
