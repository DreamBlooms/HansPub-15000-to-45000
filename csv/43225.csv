"针对水库优化调度模型求解方法中，传统动态规划(DP)法存在“维数灾”，求解耗时较长等不足，提出基于自优化模拟技术的水电站水库调度模型快速求解方法(SOST)。该方法在满足水电站负荷要求和最小下泄流量要求的前提下，尽可能提高水库调度期的运行水位以寻求全局优化调度解。选取潘口–小漩梯级水电站30个典型日的历史运行数据作为计算实例，汛期典型日的小时尺度优化调度结果显示：该方法能够实现潘口–小漩梯级水电站总负荷的经济分配，优化分配计算所得梯级水电站总耗能为104.23万kW·h，比实际运行耗能减少3.89%。相较于传统的DP算法，该方法计算时间降幅达58.04%。SOST法寻优性能较好，可有效提高水能利用效率，为梯级水电站发电优化调度提供参考。"
"梯级水电站短期优化调度(梯级调度)的目标是在满足多种约束条件下，寻求最大发电效益。为实现这一目标，梯级水电站可以采用不同的模型进行优化调度，如耗水量最小模型、耗能最小模型等 [ 1 ] [ 2 ]。耗水量最小模型虽然能够有效减少发电耗水，节约水资源，增加水库调度期末的蓄水量，但是由于其仅注重发电的耗水量，没有关注水体的水头效应，因而，在从单个水库推广至梯级时，应用受到限制 [ 3 ] [ 4 ]；作为另一种常用调度模型，耗能最小模型，概念简单直观，其从能量角度对水量所具有的能量进行刻画，对于发电效益的描述更为准确 [ 5 ] [ 6 ]，因此，针对所求解的梯级水电站短期优化调度问题，本文构建耗能最小模型并进行求解。 梯级水电站短期优化调度属于非线性规划问题，维数多且约束复杂。针对该问题，多种优化算法被提出。主要分为传统优化算法和智能优化算法，前者的特点是结构较为固定，可以获得较为可靠的结果，但计算耗时较长，不适用于对实时性要求较高的场景，并且随着计算维度的增加会出现“维数灾”问题。后者的特点是计算耗时较短，求解效率较高，且能有效缓解“维数灾”问题，但其收敛性存在不确定性，无法保证每次计算都能收敛到全局最优，因而具有一定的随机性。 自优化模拟技术是一种有效的模型求解方法，由雷声隆 [ 7 ] 等利用现代控制论基本原理，在南水北调东线工程规划中提出。该方法在常规模拟技术基础上增加了在线辨识与反馈机理，使得拟解决的问题不仅可以沿其总体优良的决策方向寻优，而且可以控制系统的运转过程。1995年，邵东国、郭元裕等从数值计算分析上对自优化模拟技术进行了实例验证，1997年，沈佩君等从理论上证明了自优化模拟技术的收敛性 [ 8 ]；灵活利用调蓄工程(水库)具有最优决策域的特点，应用中以顺时序模拟得到的防破坏蓄水线和逆时序模拟得到的经济蓄水线包裹的区域作为最优决策域。2002年，罗强等针对水库调度的特点，从理论上证明了单一水库调度自优化模拟技术最优决策域的存在性，即证明了由顺时序模拟得到的防破坏蓄水线和逆时序模拟得到的经济蓄水线形成了一个封闭的区域，并对这一区域是否为最优决策域进行了证明 [ 9 ]。 自优化模拟技术具有较好的仿真性，并且算法收敛速度快，在进行多库联合优化调度时，其计算时间仅随水电站数量线性增加，可有效缓解“维数灾”问题，计算效率高。因此，为保证梯级水电站优化调度结果的收敛性和最优性，将自优化模拟技术引入到梯级水电站短期优化调度问题的求解中，以期充分发挥梯级的补偿调节作用，实现总负荷在各水电站间的优化分配，促进水能资源的高效利用。"
"堵河位于湖北省西北部，是汉江支流，全长354 km，流域面积12,502 km 2 ，多年平均流量236 m 3 /s。潘口水电站水库位于堵河干流上游河段，多年平均流量164 m 3 /s，多年平均年径流量51.7亿m 3 [ 10 ]。小漩水电站水库距上游潘口水电站水库约10.4 km，小漩水电站具备日调节能力。"
"建立以时段梯级耗能最小为目标的优化调度模型，从水电能源相互转换的角度出发，建立优化调度模型如下： 1) 目标函数： E = ∑ i = 1 M ∑ t = 1 T 9.81 ⋅ H i , t ⋅ Q i , t ⋅ Δ t (1) 式中，E为时段梯级耗能， H i , t 为第i个水电站t时段的平均水头， Q i , t 为第i个水电站t时段的发电流量， Δ t 为时段长度，M为梯级中水电站的个数，T为调度期总时段数。 2) 约束条件： 水量平衡约束： V i , t = V i , t − 1 + ( I i , t − Q i , t ) ⋅ Δ t (2) 式中， V i , t 为第i个水电站t时段末的蓄水量， I i , t 为第i个水电站t时段的入库流量。 梯级总负荷平衡约束： N t = N 1 , t + ⋯ + N i , t + ⋯ + N M , t (3) 式中， N t 为t时段梯级总出力， N i , t 为第i个水电站t时段出力。 水头约束： H t min ≤ H t ≤ H t max (4) 式中， H t 为水电站水头， H t min 为维持水电站稳定运行的最小水头， H t max 为维持水电站稳定运行的最大水头。 水位约束： Z t min ≤ Z t ≤ Z t max (5) 式中， Z t 为水电站运行水头， Z t min 和 Z t max 为t时段水电站水位约束。 下泄流量约束： Q t min ≤ Q t ≤ Q t max (6) 式中， Q t min 和 Q t max 为t时段水电站下泄流量约束。  自优化模拟技术是在自适应控制原理的基础上，将一般模拟技术的输出结果反馈至输入端，从而将梯级水电站群的输入参数进行改变，进行多次的模拟试验引导，最终使得模拟结果趋于目标值的最优，自动生成梯级水电站群的最优运行策略。其具体步骤如下： 步骤1：输入各个水电站水库的状态初值，包括水电站日发电量计划值以及水电站历史运行数据，确定调度模型参数并赋给初始值。 步骤2：建立优化调度模型，将过去若干年分为连续的短期调度期，依次对各调度期进行优化调度计算。 步骤3：顺流向模拟。顺时序模拟依次进行厂内优化计算，确定各水电站的初始运行过程线。在满足下游河道水电站生态需水的前提下，进行梯级水电站时段负荷分配并维持高水位运行。接着进行逆时序模拟，若顺时序时段末水位处于限制水位范围之外，那么需要以前一时段末的水位作为时段初水位，重新计算该时段的水电站出力。 步骤4：各个水电站进行运行模拟决策过程。进行负荷分配，计算时段初、末的发电流量。将厂内所有发电机组按从小到大编号，对于第j阶段，以机组的编号j为阶段变量，以第j台发电机组的负荷 N j 为决策变量，以1~j台发电机组的累积负荷 N j a l l 为状态变量。分别按式(7)和式(8)确定状态转移方程和当前阶段决策，接着进行逆推计算，得到各发电机组的最优分配发电流量和最优分配负荷。 N j a l l = N j − 1 a l l + N j (7) { Q j a l l * ( N j a l l ) = min [ Q j ( N j ) + Q j − 1 a l l * ( N j − 1 a l l ) ] Q 0 a l l * ( N 0 a l l ) = 0 (8) 其中： Q j a l l * 是j阶段最优总分配发电流量， Q j 是第j台发电机组的发电流量， Q 0 a l l * 和 N 0 a l l 分别是开始阶段的发电流量和分配负荷。 步骤5：当顺流向模拟完成后，将顺流向协调耦合所得各水电站的下泄水量过程 D L ( t ) 作为反馈修正量，用于后续的决策控制。进行逆流向模拟，将各水电站的入库流量，再加上反馈到输入端的反馈修正量，成为各个水电站新的入库流量。并收紧全部约束条件，即调控水电站的入库流量需要受到下游水电站运行出库流量的限制，建立新的模拟控制线。 步骤6：判断控制线是否收敛于最优控制线，目标值的收敛程度是否在给定的范围之内，若都满足则整理运行结果，得出结论。若不满足则返回步骤3进行下一轮的模拟迭代过程。具体流程见图1。"
"基于上述模型，以潘口、小漩单个水电站和潘口–小漩梯级水电站为例，选取30个典型日的历史运行数据作为计算实例，其中汛期典型日的小时尺度优化调度结果如下所示。 图1. 基于自优化模拟技术的梯级耗能最小模型求解流程图 Table 1 时间/h 计算出力/MW 实际水位/m 计算水位/m 0:00 0 346.56 346.52 1:00 0 346.55 346.52 2:00 0 346.63 346.60 3:00 0 346.62 346.60 4:00 0 346.61 346.60 5:00 0 346.61 346.60 6:00 0 346.61 346.60 7:00 0 346.61 346.60 8:00 68.14 346.60 346.59 9:00 68.14 346.60 346.59 10:00 68.41 346.60 346.59 11:00 68.41 346.60 346.59 12:00 68.31 346.59 346.58 13:00 68.31 346.59 346.58 14:00 60.41 346.58 346.57 15:00 60.41 346.58 346.57 16:00 72.42 346.58 346.57 17:00 72.42 346.58 346.57 18:00 79.64 346.57 346.56 19:00 79.64 346.57 346.56 20:00 150.99 346.57 346.55 21:00 150.99 346.57 346.55 22:00 140.31 346.55 346.54 23:00 140.31 346.55 346.54 0:00 139.27 346.54 346.53 表1. 汛期典型日的潘口水电站出力和水位 图2. 潘口水电站出力和水位变化过程 由表1和图2可得，对潘口水电站进行分析，0~7时潘口水电站停机，没有出力，7时后开机，库水位缓慢下降。经过梯级耗能最小模型对计算水位进行优化，8~19时保持65 MW左右的出力，20时出力加大到140 MW左右。计算水位与实际水位基本重合，说明优化过程对于潘口水电站调度无太大影响，耗能减少的部分主要在于小漩水电站。 Table 2 时间/h 计算出力/MW 实际水位/m 计算水位/m 0:00 2.31 263.63 263.68 1:00 2.12 263.64 263.74 2:00 2.22 263.62 263.68 3:00 2.31 263.57 263.65 4:00 2.03 263.51 263.57 5:00 2.08 263.42 263.54 6:00 2.01 263.38 263.45 7:00 2.11 263.36 263.47 8:00 16.31 263.43 263.51 9:00 16.01 263.48 263.73 10:00 15.83 263.50 263.82 11:00 15.93 263.53 263.63 12:00 16.64 263.55 263.65 13:00 16.82 263.58 263.78 14:00 17.32 263.58 263.73 15:00 18.21 263.52 263.68 16:00 18.32 263.50 263.81 17:00 17.43 263.42 263.88 18:00 17.32 263.50 263.95 19:00 16.23 263.42 264.03 20:00 23.31 263.35 264.02 21:00 23.14 263.30 263.36 22:00 18.31 263.28 263.38 23:00 18.31 263.24 263.39 0:00 2.27 263.17 263.21 表2. 汛期典型日的小漩水电站出力和水位 由表2和图3可知，对小漩水电站进行分析，0~7时维持2 MW左右的基本出力，此时水位从263.6 m下降到263.4 m左右，实际水位和计算水位的趋势基本保持一致。8~23时的出力加大到16 MW左右，在20时和21时两个时间点达到最大，为24 MW左右，计算水位与实际水位曲线变化较大，且基本位于实际水位上方。同时实际水位曲线趋势基本为下降趋势，而计算水位曲线趋势却呈上升趋势，优化调度方案中小漩运行水位明显高于实际，保持高水位运行使得小漩在发电水量相同的情况下可以发出更多的电量。 图3. 小漩水电站出力和水位变化过程 Table 3 时间 水位/m 实际耗能/万kW·h 计算耗能/万kW·h 潘口 小漩 潘口 小漩 梯级 潘口 小漩 梯级 0:00 346.52 263.68 0.01 2.52 2.53 0.02 2.29 2.31 1:00 346.52 263.74 0.01 2.48 2.49 0.02 2.35 2.37 2:00 346.61 263.68 0.01 2.43 2.44 0.01 2.27 2.28 3:00 346.61 263.65 0.00 2.43 2.43 0.00 2.36 2.36 4:00 346.61 263.57 0.00 2.40 2.40 0.00 2.32 2.32 5:00 346.61 263.54 0.01 2.27 2.28 0.01 2.16 2.17 6:00 346.61 263.45 0.00 2.45 2.45 0.00 2.31 2.31 7:00 346.61 263.47 0.00 2.41 2.41 0.00 2.31 2.31 8:00 346.60 263.51 3.35 0.95 4.30 3.37 0.78 4.15 9:00 346.60 263.73 3.54 0.98 4.52 3.49 0.64 4.13 10:00 346.59 263.82 3.20 1.47 4.67 3.28 1.19 4.47 11:00 346.59 263.63 3.48 0.87 4.35 3.41 0.63 4.04 12:00 346.59 263.65 3.08 1.46 4.54 3.13 1.10 4.23 13:00 346.59 263.78 3.39 1.41 4.80 3.32 0.84 4.16 14:00 346.58 263.73 3.15 1.14 4.29 3.13 0.91 4.04 15:00 346.58 263.68 3.28 0.97 4.25 3.31 0.90 4.21 16:00 346.57 263.81 3.61 1.49 5.10 3.23 1.01 4.24 17:00 346.57 263.88 3.33 0.63 3.96 3.61 0.27 3.88 18:00 346.56 263.95 3.65 0.99 4.64 3.88 0.66 4.54 19:00 346.56 264.03 4.07 1.03 5.10 4.03 1.34 5.37 20:00 346.56 264.02 4.43 1.27 5.70 4.45 0.88 5.33 21:00 346.56 263.36 5.33 1.17 6.50 5.43 1.02 6.45 22:00 346.54 263.38 5.47 0.98 6.45 5.55 0.48 6.03 23:00 346.54 263.39 6.03 1.01 7.04 6.03 1.02 7.05 0:00 346.53 263.21 5.38 1.19 6.57 5.50 0.98 6.48 表3. 潘口、小漩以及潘口–小漩梯级水电站的水位和耗能 图4. 潘口–小漩梯级水电站耗能变化过程 由表3和图4可得，经过优化模拟后，计算耗能相比实际耗能确实有一定的降低0~7时电站出力较低时，实际耗能与计算耗能基本保持一致，并无太大区别。9时后出力加大，实际耗能和计算耗能出现差别，说明耗能优化主要集中在一天中出力较大的时段，这与图3和图4所显示的规律相吻合。 对潘口–小漩梯级水电站整体进行分析，如下表4所示，计算过程中，优化分配后的梯级负荷曲线与实际运行曲线十分接近，最大负荷绝对偏差为3.43 MW，最大负荷相对偏差为0.24%，平均负荷偏差为0.08 MW，平均负荷相对偏差为0.01%，时段负荷平衡约束基本满足。各站优化分配计算发电量与实际发电量偏差均在0.1%以内，梯级总发电量比实际少0.01%，电量平衡约束亦基本满足。 潘口–小漩梯级水电站实际运行总耗能为108.21万kW·h，优化调度后运行总耗能为104.23万kW·h，耗能减少3.89%。原因在于潘口水电站是高水头水电站，而小漩水电站是低水头电站。因此虽然小漩水电站的运行水位抬升对潘口确实存在影响，但这对于高水头水电站的影响比较有限；相比之下，小漩水电站机组对于水头变化的敏感程度更高，因此耗能的减少程度更加明显。 Table 4 实际发电量/万kW·h 计算发电量/万kW·h 发电量偏差 实际耗能/万kW·h 计算耗能/万kW·h 耗能差 潘口 117.31 117.26 −0.04% 67.81 68.21 0.59% 小漩 32.55 32.58 0.09% 40.40 36.02 −6.20% 梯级 149.86 149.84 −0.01% 108.21 104.23 −3.89% 表4. 潘口、小漩以及潘口–小漩梯级水电站发电量偏差和耗能差 分别采用自优化模拟技术(SOST)、动态规划法(DP)，对潘口–小漩梯级水电站进行仿真模拟计算，两种方法各运行15次，计算结果如表5所示。 Table 5 计算方法 耗能/(万kW·h) 标准差 平均计算时间/s 最大值 最小值 平均值 SOST 104.52 103.88 104.19 0.35 28.42 DP - - 104.07 - 67.74 表5. 潘口–小漩梯级耗能计算结果 由表5计算结果可以看出：自优化模拟技术的耗能相对于动态规划法仅增加了0.12万kW·h，增幅仅为0.01%，说明自优化模拟技术有着较好的寻优性能。同时计算时间降幅58.04%，说明自优化模拟技术可以大幅减少求解计算耗时，提高计算效率。"
"针对水库优化调度模型求解方法中，传统动态规划(DP)法存在“维数灾”，求解耗时较长等不足。本文将自优化模拟技术引入到潘口–小漩梯级水电站短期优化调度问题求解中，提出了基于自优化模拟技术的水电站水库调度模型快速求解方法(SOST)。选取潘口–小漩梯级水电站30个典型日的历史运行数据作为计算实例，汛期典型日的小时尺度优化调度结果显示：该方法能够降低潘口–小漩梯级水电站运行耗能，并且在极大程度上提高求解效率，可为梯级水电站发电优化调度提供参考。"
