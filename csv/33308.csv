"钢铁和一个国家的工业发展息息相关，随着制造2025的到来，对钢铁的要求更是进一步提高，因此提出一种钢水“脱氧合金化”配料方案对工业制造和经济社会的发展具有十分重要的意义。本文综合考虑了钢水配料中C、Mn两种元素的历史收得率与其他影响因素之间的关系，对历史数据进行了预处理，建立了主成分分析模型综合分析影响两种元素收得率的主要因素；然后构建BP神经网络，对C、Mn两种元素的收得率进行预测，并在此基础上利用分数阶对BP网络进行改进，优化预测结果；最后利用动态规划的思想求出了最优成本和配料方案。最终结合本文研究结果制定了配料方案的优化的建议与策略。 关键词 :钢水脱氧合金化，主成分分析，BP神经网络，分数阶灰色神经网络组合模型，动态规划 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着社会经济的发展，钢铁工业也迅速发展，由于钢铁被广泛运用在建筑，汽车、机械、运输等多方面事业上，对我国的国民经济，国防建设及社会发展都有着重大的影响，所以对其需求量不断增大，同时对于其质量的要求也有所提高。因此，对钢水“脱氧合金化”配料方案的研究、对钢水中关键元素的收得率的讨论和预测并提出一套钢水“脱氧合金化”配料方案具有十分重要的意义。 以往的研究中，许多学者分别对人才发展进行了不同的研究。1997年，李树江等人 [ 1 ] 采用线性规划中成本最小的单纯形法，确定各合金的添加量。2000年，聂雨青等人 [ 2 ] 进行了转炉冶炼20 MnSi钢应用70%SiC及75%SiC和铁–锰–硅合金替代以往的高碳铁–锰与部分铁–硅脱氧的工艺试验。2002年，龚伟等人 [ 3 ] 采用多元线性规划方法对合金化操作进行最优化计算，得到工程实用的脱氧和合金化控制模型。2004年，张广军等人 [ 4 ] 建立了高精度基本计算模型以及特殊钢冶炼中装炉配料、合金化、钢液量估算、超规格元素成分调整和元素回收率确定等常见问题的相应计算模型和程序模块。2007年，张俊伟 [ 5 ] 基于线性规划算法开发了合金成分优化模型。2008年，李香平等人 [ 6 ] 应用中碳锰铁、铝线的合金脱氧方法替代了以往的锰芯铝铁预脱氧与铝线微调的脱氧合金化工艺试验。2012年，舒遗一等人 [ 7 ] 在保证质量的前提下，讨论了脱氧、合金化成本更低以及寻求铸坯上夹杂更少(脱氧产物、梭状坚硬N、O化合物)。徐喆等人 [ 8 ] 系统地进行了钢包精炼过程元素收得率预测模型建模方法的研究。2014年，宿永波等人 [ 9 ] 利用碳一氧反应脱除高碳锰铁中的碳。2015年，高鹏程等人 [ 10 ] 通过相应措施，提高转炉终点C含量，LF出站时钢包渣(FeO + MnO)含量由之前的5.6%降低至2%以下。2018年，刘涛等人 [ 11 ] 采用线性归划的单纯形法解决线性优化问题，计算出达到钢水目标要求的化学元素含量时要加入的合金料料重。 本文通过对钢水中合金元素收得率的研究以及对历史收得率的讨论和分析，建立了主成分分析模型、BP神经网络模型、和动态规划模型等对钢水配料方案进行讨论。李树江等人 [ 1 ]、龚伟等人 [ 3 ]、张俊伟 [ 5 ]、高鹏程等人 [ 10 ]、刘涛等人 [ 11 ] 讨论了钢水中需加入各个合金的量以及如何控制各个合金的量，但却忽略了合金收得率的影响因素。聂雨青等人 [ 2 ]、李香平等人 [ 6 ]、舒遗一等人 [ 7 ]、宿永波等人 [ 9 ] 对钢水脱氧合金化的铸造公艺进行了讨论，却没有对合金收得率和钢水脱氧合金化配料方案进一步研究。张广军等人 [ 4 ]、徐喆等人 [ 8 ] 对合金元素的收得率进行了精确的计算和预测。却没有对影响元素收得率的因素研究，也没给出钢水配料的方案。本文在对合金元素历史收得率的研究的基础之上，分别对每种钢号钢铁进行讨论，建立了主成分分析模型对影响C、Mn两种元素收得率的主要因素进行分析。并在对合金元素收得率影响因素的研究之上，又建立了BP神经网络模型对C、Mn两种元素收得率做精准预测，并结合BP神经网络的缺点，对预测模型进行改进，利用新的模型预测得到了更加精确的C、Mn两种元素收得率。最后利用动态规划的思想求出了最优成本并结合现实情况和国家政府政策给出了相应的配料方案。以确保未来钢铁质量满足工业的发展和经济社会的建设。"
"在出钢过程中向其加入一种或几种合金，使其达到成品钢的标准要求，而在合金脱氧过程中，合金收得率是一项重要指标，生产实践表明，准确判断和估算合金元素收得率，是达到脱氧和提高成品钢成分命中率的关键。然而，合金元素收得率受诸多因素影响。本文结合2019年第九届MathorCup高校大学生数学建模竞赛D题 [ 12 ] 背景和题目所给数据钢水“脱氧合金化”配料方案的优化问题进行了研究和讨论。并通过建立相关模型对2019年第九届MathorCup高校大学生数学建模竞赛D题 [ 12 ] 题目进行求解。 1) 在钢水的脱氧合金化过程中主要关注C、Si，Mn，P，S这五种元素，根据附加中提供的数据，计算出C、Mn两种元素的历史收得率，并分析数据，找出影响收得率的主要原因。 根据历史的炼钢记录下的数据，合金的收得率指脱氧合金化是被钢水吸收的合金元素的重量与如该元素总重量之比。但是由于数据不完整、存在干扰数据，所以本文对数据进行了预处理。然后建立了收得率求解模型，运用MATLAB软件编程求解出不同钢号分类下的C、Mn两种元素的历史收得率，再建立了主成分分析模型，对影响C、Mn两种元素的历史收得率的主要因素进行分析，通过MATLAB2015软件编程求解出不同钢号分类下的影响C、Mn两种元素的收得率的主要因素。 2) 在上文的基础上，对C、Mn两种元素的收得率做出预测，并对其做出改进和优化，提高收得率预测的准确性。 由于C、Mn两种元素的收得率具有多元性、复杂性等特点，所以本文利用了BP神经网络的深度学习方法，建立了BP神经网络预测模型，运用MATLAB软件编程求解出不同钢号分类下的影响C、Mn两种元素的收得率。又因为BP神经网络模型运算速度缓慢和易陷入局部最小值的缺点，弥补传统股票价格预测方法的不足。所以本文运用分数阶灰色模型与BP神经网络网络组合的方式对预测模型进行了改进，建立了分数阶灰色神经网络组合预测模型。通过MATLAB2015软件编程求解出不同钢号分类下的影响C、Mn两种元素的收得率。 3) 根据合金收得率的预测结果及历史炼钢所记录下的数据，以实现钢水脱氧合金化成本优化计算，并提供一套配料优化方案。 由于不同合金的价格不同，考虑到成本问题。本文在上文的基础上，通过对收得率计算模型进行反解，求出了不同钢号下C、Mn两种元素在配料合金种类中的对应含量，又因为钢水脱氧合金化的成本受多方面动态因素的影响，所以本文建立了动态规划模型对钢水脱氧合金化的成本进行优化计算。并通过MATLAB2015软件编程求解出不同钢号分类下的钢水脱氧合金化的最优化成本和合金配料方案。"
"由于数据不完整、存在干扰数据，所以本文通过对无关干扰数据的减除，再利用均值插补法对缺失数据进行填补，并针对不同的钢号对数据进行分类，将所给数据分为了HRB400B、HRB400D、HRB500、20 MnK、Q五类，见图1。 图1. 钢号分类图 在钢水脱氧合金化的过程中，合金的收得率受多种因素的影响。合金的收得率指脱氧合金化是被钢水吸收的合金元素的重量与如该元素总重量之比。为此本文建立了收得率计算模型如：  (1)  { p = ( n 1 − n 0 ) ∗ m 钢 M M = m M n + m 钢 × n 0 m M n = m 合 金 × n c (2)  求解出C、Mn两种元素的历史收得率以后，还需要分析影响收得率的主要因素。在钢水脱氧合金化的过程中，合金的收得率受多种因素的影响。为此本文在C、Mn两种元素的历史收得率的基础上建立了如下主成分分析模型： 主成分分析法就是利用其降维的思想，取少数几个综合指标，去反映原始数据中的大部分信息，且所含信息互不重复。这种方法在引进多方面变量的同时将复杂因素归结为几个主成分，使问题简单化，与此同时得到的结果也是更加科学有效的数据信息。  假设进行主成分分析的指标变量有m个，分别为 x 1 , x 2 , ⋯ , x m ，共有n个评价对象，第i个评价对象的第j个指标的取值为 a i j 。将各指标值 a i j 转换成标准化指标值 a ˜ i j ，则有 { a ˜ i j = a i j − μ j s j , i = 1 , 2 , ⋯ , n μ j = 1 n ∑ i = 1 n a i j s j = 1 n − 1 ∑ i = 1 n ( a i j − μ j ) 2 j = 1 , 2 ⋯ , m (3) 其中， x ˜ j = x j − μ j s j , j = 1 , 2 , ⋯ , m 为标准化指标变量。  相关系数矩阵 R = ( r i j ) m × m ，有 { r i j = ∑ i = 1 n a ˜ k i ⋅ a ˜ k j n − 1 ,     i , j = 1 , 2 , ⋯ , m r i i = 1 r i j = r j i (4)  计算相关系数矩阵R的特征值 λ 1 ≥ λ 2 ≥ ⋯ ≥ λ m ≥ 0 及对应的特征向量 u 1 , u 2 , ⋯ , u m ，其中 u j = [ u 1 j , u 2 j , ⋯ , u m j ] T 由特征向量组成m个新的指标变量： y 1 = u 11 x ˜ 1 + u 21 x ˜ 2 + ⋯ + u m 1 x ˜ m , y 2 = u 12 x ˜ 1 + u 22 x ˜ 2 + ⋯ + u m 2 x ˜ m ,                                       ⋮ y m = u 1 m x ˜ 1 + u 2 m x ˜ 2 + ⋯ + u m m x ˜ m , (5)  计算特征值 λ j ( j = 1 , 2 , ⋯ , m ) 的信息贡献率和累计贡献率。称 b j = λ j ∑ k = 1 m λ k , j = 1 , 2 , ⋯ , m (6) 为主成分 y j 的信息贡献率，同时有 α p = ∑ k = 1 p λ k ∑ k = 1 m λ k (7) 为主成分 y 1 , y 2 , ⋯ , y p 的累积贡献率。当 α p 接近于1时，说明其包含的原始变量信息越多，于是选择前p个指标变量 y 1 , y 2 , ⋯ , y p 作为p个主成分，代替原来m个指标变量，从而可对p个主成分进行综合分析。 计算综合得分： z = ∑ j = 1 p b j y j (8) b j 为第j个主成分的信息贡献率，根据综合得分值就可进行综合评价。  BP神经网络如图2所示，其中 N 1 为输入层， N 2 为中间层， N 3 为输出层。本文将影响合金的相关影响因子作为输入层(如连铸正样Ceq_val、连铸正样Cr、连铸正样Ni_val连铸正样Cu_val、连铸正样V_val、连铸正样Alt_val等)，最终输出预测结果。在神经网络中，神经元接收到来自其他神经元的输入信号，这些信号乘以权重累加到神经元接收的总输入值上，随后与当前神经元的阈值进行比较，然后通过激活函数处理，即可产生神经元的输出。 图2. 神经网络 理想的激活函数是阶跃函数，“0”对应神经元抑制，“1”对应神经元兴奋。然而阶跃函数的缺点是不连续、不可导，且不光滑，所以常用sigmoid函数作为激活函数代替阶跃函数，即 s i g m o i d ( x ) = 1 1 + e − x (9) 对于一个训练例 ( E r D , E r n n ) ，假设神经网络的输出为 E r n n ，则输出可表示为： y = σ ( [ w 11 ⋯ w 1 n ⋮ ⋱ ⋮ w m 1 ⋯ w m n ] [ ε ( 1 ) ⋮ ε ( n ) ] + [ θ 1 ⋮ θ n ] ) 其中 σ ( ε ) 为激活函数。中间层节点为 O = [ O ( 1 ) , O ( 2 ) , ⋯ , O ( l ) ] ′ ，阈值为 θ 1 = [ θ 11 , θ 12 , ⋯ , θ 1 l ] ′ ，输出层节点的阈值为 θ 2 = [ θ 21 , θ 22 , ⋯ , θ 2 m ] ′ 。输入层与中间层神经元间的权值矩阵为 W 1 、中间层与输出层神经元间的权值矩阵为 W 2 可分别表示为 W 1 = ( ω 1 i j ) l × n , ( i = 1 , 2 , ⋯ , l ; j = 1 , 2 , ⋯ , n ) ， W 2 = ( ω 2 i j ) m × l , ( i = 1 , 2 ⋯ , m ; j = 1 , 2 , ⋯ , l ) 。 带入传递函数，可得中间层节点为 O ( i ) = f ( ∑ j = 1 n ω 1 i j Y e a r ( j ) − θ 1 i ) , i = 1 , 2 , ⋯ , l ， 因此输出层节点，即网络输出值 E r n n = [ ε ^ ( 1 ) , ε ^ ( 2 ) , ⋯ , ε ^ ( n ) ] 为 ε ^ ( i ) = f ( ∑ j = 1 l ω 2 i j O ( j ) − θ 1 j ) , i = 1 , 2 , ⋯ , m ，则，网络输出值与原始数据的误差为 E = 1 m ∑ i = 1 m ( ε ^ ( i ) − ε ( i ) ) 2 (10) 通过调整 W 1 和 W 2 的值，使得误差E最小，从而确定权值。 确定权值之后，即可根据 { O ( i ) = f ( ∑ j = 1 n ω 1 i j ε ( j ) − θ 1 i ) , i = 1 , 2 , ⋯ , l ε ^ ( i ) = f ( ∑ j = 1 l ω 2 i j O ( j ) − θ 1 j ) , i = 1 , 2 , ⋯ , m (11) 得到通过BP神经网络得到 E r n n = ( ε ^ ( 1 ) , ε ^ ( 2 ) , ⋯ , ε ^ ( n ) ) 。 反向传播的基本思想就是通过计算输出层与期望值之间的误差来调整网络参数，从而使得误差变小。在此利用梯度下降法训练，取代价函数为偏差平方和。  由于BP神经网络模型运算速度缓慢和易陷入局部最小值的缺点，所以本文运用分数阶灰色模型与BP神经网络网络组合的方式对预测模型进行了改进，建立了分数阶灰色神经网络组合预测模型。通过MATLAB软件编程求解出不同钢号分类下的影响C、Mn两种元素的收得率。 设有非负序列 X ( 0 ) = ( x ( 0 ) ( 1 ) , x ( 0 ) ( 2 ) , ⋯ , x ( 0 ) ( n ) ) ， X ( r ) = ( x ( r ) ( 1 ) , x ( r ) ( 2 ) , ⋯ , x ( r ) ( n ) ) 为 X ( 0 ) 的r累加序列，且称 x ( r ) ( k ) = ∑ i = 1 k x ( r − 1 ) ( i ) 为 x ( 0 ) ( k ) 的r阶累加算子，则 x ( r ) ( k ) = ∑ i = 1 k C k − i + r − 1 k − i x ( 0 ) ( i ) (12) 其中，规定 C r − 1 0 = 1 ， C k k + 1 = 0 ，且 k = 1 , 2 , ⋯ , n ， C k − i + r − 1 k − i = ( k − i + r − 1 ) ( k − i + r − 2 ) ⋯ ( r + 1 ) r ( k − i ) ! 称 x ( r ) ( k + 1 ) = β 1 x ( r ) ( k ) + β 2 (13) 为r阶累加离散灰色模型，其中 k = 0 , 1 , ⋯ , n − 1 。而离散灰色模型参数的最小二乘估计满足 [ β 2 β 1 ] = ( B T B ) − 1 B T Y (14) 其中， B = [ 1 x ( r ) ( 1 ) 1 x ( r ) ( 2 ) ⋮ ⋮ 1 x ( r ) ( n − 2 ) 1 x ( r ) ( n − 1 ) ] ， Y = [ x ( r ) ( 2 ) x ( r ) ( 3 ) ⋮ x ( r ) ( n − 1 ) x ( r ) ( n ) ] 。 设有非负序列 X ( 0 ) = ( x ( 0 ) ( 1 ) , x ( 0 ) ( 2 ) , ⋯ , x ( 0 ) ( n ) ) ， X ( − r ) = ( x ( − r ) ( 1 ) , x ( − r ) ( 2 ) , ⋯ , x ( − r ) ( n ) ) 为 X ( 0 ) 的r累减序列，且称 x ( − r ) ( k ) = ∑ i = 1 k x ( − r − 1 ) ( i ) 为 x ( 0 ) ( k ) 的r阶累减算子，则 x ( − r ) ( k ) = ∑ i = 1 k C k − i − r − 1 k − i x ( 0 ) ( i ) (15) 其中，规定 C − r − 1 0 = 1 ， C k k + 1 = 0 ，且 k = 0 , 1 , ⋯ , n − 1 ， C k − i − r − 1 k − i = ( k − i − r − 1 ) ( k − i − r − 2 ) ⋯ ( − r + 1 ) ( − r ) ( k − i ) ! 。 定义，对于非负序列 X ( 0 ) = ( x ( 0 ) ( 1 ) , x ( 0 ) ( 2 ) , ⋯ , x ( 0 ) ( n ) ) 的分数阶灰色模型的预测值为 X ^ ( 0 ) = ( x ^ ( 0 ) ( 1 ) , x ^ ( 0 ) ( 2 ) , ⋯ , x ^ ( 0 ) ( n ) ) ，则其相对误差 E r D = ( ε ( 1 ) , ε ( 2 ) , ⋯ , ε ( n ) ) 为 ε ( k ) = x ( 0 ) ( k ) − x ^ ( 0 ) ( k ) x ( 0 ) ( k ) ， k = 1 , 2 , ⋯ , n (16)  记以 t 0 为起始影响因子，连续n个原始数据 X ( 0 ) = ( x ( 0 ) ( 1 ) , x ( 0 ) ( 2 ) , ⋯ , x ( 0 ) ( n ) ) ，记以t为截至影响因子，模拟序列为 P r e = ( p r e ( 1 ) , p r e ( 2 ) , ⋯ , p r e ( t − t 0 ) ) 。 取其中前k个影响因子的数据作为 D G M ( 1 , 1 ) 的原始序列 X ( 0 ) = ( x ( 0 ) ( 1 ) , ⋯ , x ( 0 ) ( k ) ) ，通过分数阶灰色模型得模拟序列 X ^ ( 0 ) = ( x ^ ( 0 ) ( 1 ) , x ^ ( 0 ) ( 2 ) , ⋯ , x ^ ( 0 ) ( t − t 0 ) ) ，并计算各影响因子相对误差 E r D = ( ε ( 1 ) , ε ( 2 ) , ⋯ , ε ( k ) ) 。 建立输入层节点数为1、中间层节点数为m、输出层节点数为1的BP神经网络模型，将年份 Y e a r 作为输入，相对误差 E r n n 作为输出，以分数阶灰色模型的前k年相对误差 E r D = ( ε ( 1 ) , ε ( 2 ) , ⋯ , ε ( k ) ) 为目标进行训练，并预测出以 t 0 为起始年份，以t为截至影响因子的相对误差 E r n n = ( ε ^ ( 1 ) , ε ^ ( 2 ) , ⋯ , ε ^ ( t − t 0 ) ) 。 最终通过方程： P r e = X ^ ( 0 ) 1 − E r n n (17) 解出预测值 P r e 作为最终结果。 建模步骤如下所示： Step1：通过(9)式，计算得到r阶累加序列 X ( r ) = ( x ( r ) ( 1 ) , x ( r ) ( 2 ) , ⋯ , x ( r ) ( n ) ) ； Step2：将 x ( r ) ( k ) ( k = 1 , 2 , ⋯ , n ) 带入(10)式，采用最小二乘法估计参数 [ β ^ 2 , β ^ 1 ] ′ ； Step3：利用 x ^ ( r ) ( k ) = ( x ( 0 ) ( 1 ) − β ^ 2 1 − β ^ 1 ) β ^ 1 ( k − 1 ) + β ^ 2 1 − β ^ 1 预测得到 X ^ ( r ) ； Step4：对 X ^ ( r ) 作r阶累减得到 X ^ ( 0 ) = ( x ^ ( 0 ) ( 1 ) , x ^ ( 0 ) ( 2 ) , ⋯ , x ^ ( 0 ) ( n ) ) ； Step5：利用公式(14)，计算各影响因子相对误差 E r D = ( ε ( 1 ) , ε ( 2 ) , ⋯ , ε ( n ) ) ； Step6：以分数阶灰色模型的前k影响因子相对误差 E r D 为目标进行训练，并预测出以 t 0 为起始影响因子，以t为截至影响因子的相对误差 E r n n ； Step7：利用公式(17)，求出预测值 P r e 作为最终预测结果。  在钢水脱氧合金化的过程中，合金的收得率受多种因素的影响。合金的收得率指脱氧合金化是被钢水吸收的合金元素的重量与如该元素总重量之比。所以本文通过对收得率计算模型的反解，求解出相应的元素总质量。建立了如下的反解收得率计算模型： { M = ( n 1 − n 0 ) × m 钢 p m c = M − m 钢 × n 0 m M n = M − m 钢 × n 0 (18)  本文通过建立成本函数作为目标函数，以元素总含量作为约束条件，建立了如下的动态规划数学模型： min z = ∑ i = 1 ; j = 1 16 x i p j { x i ⋅ k j ≥ m c i i , j = 1 , 2 , ⋯ , 16 (19)"
"通过MATLAB编程求解，本文得到的C和Mn的部分历史收得率如下表1~4所示： Table 1钢号 HRB400B HRB400D HRB500 20 MaK Q C收得率 0.9134 0.8265 1.0407 0.9266 1.3299 0.8665 0.9421 1.0715 0.8950 0.7564 1.0120 0.9742 0.8707 0.9647 0.8787 0.8672 0.8852 0.8888 0.9202 0.9294 0.9795 0.8220 0.9060 1.2311 0.6604 0.9705 0.7909 0.9785 0.9302 0.8706 1.0295 0.9213 0.9949 0.9362 0.8805 0.915 0.9897 0.9744 0.9721 0.8234 0.6927 0.8706 0.9124 0.9618 1.8624 0.9984 0.9422 0.8511 0.8343 2.5437 C收得率 0.9736 0.995 0.8700 0.8567 1.5868 0.9148 1.0156 0.9506 0.8019 2.2533 1.2824 0.9633 1.0107 0.9835 2.0635 0.8276 0.9576 0.8714 0.8485 1.9118 0.8469 0.9122 2.9445 0.8924 1.7142 0.9246 1.0577 0.8102 0.8036 2.0535 0.7158 0.8090 0.8677 0.9615 1.7310 0.8187 0.8889 0.9225 0.7835 1.6753 表1. C的部分历史收得率表 C收得率 Table 2钢号 HRB400B HRB400D HRB500 20 MaK Q 平均收得率 0.9440 0.9361 0.9748 0.9449 1.4736 表2. C的平均收得率 Table 3M 钢号 HRB400B HRB400D HRB500 20 MaK Q Mn收得率 0.8184 0.7773 0.8888 1.0076 0.9961 0.8518 0.8202 0.8987 0.9686 0.8535 0.8877 0.8833 0.8821 0.9471 0.8489 0.8332 0.8440 0.9147 0.8710 0.8797 0.8733 0.8123 0.8718 Inf 0.7768 0.8689 0.8358 0.8756 0.9800 0.9401 0.8284 0.8605 0.8783 0.9832 0.8531 0.8230 0.8988 0.9029 0.9894 0.8325 0.8388 0.8855 0.8733 0.9853 1.4788 0.8148 0.8476 0.8681 0.8806 1.5278 0.7713 0.8143 0.8764 0.9459 1.5801 0.7013 0.8576 0.8520 0.9435 1.6295 0.7899 0.7977 0.8782 1.0624 1.4789 0.7847 0.8211 0.8401 0.9374 1.5571 0.7372 0.8244 2.5395 0.9101 1.3866 0.7931 0.8406 0.8613 0.9625 1.6158 0.6817 0.8132 0.8539 1.0277 1.5132 0.7290 0.7987 0.8734 0.8994 1.4505 表3. Mn的部分历史收得率表 Table 4M 钢号 HRB400B HRB400D HRB500 20 MaK Q 平均收得率 0.9041 0.8709 0.8694 0.9759 1.2333 表4. Mn的平均收得率  在钢水脱氧合金化的过程中，合金的收得率受多种因素的影响。所以本文针对于不同的钢号针对于合金的收得率受多种因素作了不同的分析。通过MATLAB编程求解，本文得到不同钢号下的影响C、Mn两种元素的收得率的主要因素如下表5~14所示： Table 5 影响因素 Ceq_val Cr Ni_val Cu_val V_val Alt_val Als_val Mo_val Ti_val 相关系数 0.0813 0.0792 0.1066 0.0926 0.0798 0.0827 0.0828 0.0821 0.0722 表5. 钢号HRB400B影响C收得率因素 Table 6 影响因素 Ceq_val Cr Ni_val Cu_val V_val Alt_val Als_val Mo_val Ti_val 钒氮合金 相关系数 0.0907 0.0743 0.0824 0.0923 0.1184 0.1222 0.1224 0.0867 0.0857 0.0785 表6. 钢号HRB40D影响C收得率因素 Table 7 影响因素 净重 Ceq_val Alt_val Als_val Mo_val Ti_val B_val FeMn68Si18 Mn收得率 相关系数 0.0972 0.0992 0.0807 0.0804 0.0883 0.0947 0.0843 0.0887 0.0990 表7. 钢号HRB500影响C收得率因素 Table 8 影响因素 Ceq_val Ni_val Cu_val V_val Alt_val Als_val FeV55N11-A FeV50-B 碳化硅 Si收得率 相关系数 0.1263 0.1328 0.1545 0.1170 0.1289 0.0943 0.1166 0.1166 0.1273 0.1026 表8. 钢号20 Mnk影响C收得率因素 Table 9 影响因素 V_val Alt_val Als_val Mo_val B_val 钒氮合金 石油焦增碳剂 FeMn68Si18 相关系数 0.1610 0.1331 0.1401 0.1211 0.1512 0.1622 0.1415 0.1662 表9. 钢号Q影响C收得率因素 Table 1 0 影响因素 Ceq_val Cr Ni_val Cu_val V_val Alt_val Als_val Mo_val Ti_val 相关系数 0.0813 0.0792 0.1066 0.0926 0.0798 0.0827 0.0828 0.0821 0.0722 表10. 钢号HRB400B影响Mn收得率因素 Table 1 1 影响因素 Ceq_val Cr Ni_val Cu_val V_val Alt_val Als_val Mo_val Ti_val 钒氮合金 相关系数 0.0907 0.0743 0.0824 0.0923 0.1184 0.1222 0.1224 0.0867 0.0857 0.0785 表11. 钢号HRB40D影响Mn收得率因素 Table 1 2 影响因素 Ceq_val Alt_val Als_val Mo_val Ti_val B_val 相关系数 0.0990 0.0734 0.0733 0.0898 0.0713 0.0742 表12. 钢号HRB500影响Mn收得率因素 Table 1 3 影响因素 Ceq_val Alt_val Als_val Mo_val Ti_val B_val FeMn68Si18 相关系数 0.0990 0.0734 0.0733 0.0898 0.0713 0.0742 0.0937 表13. 钢号20 MnKA影响Mn收得率因素 Table 1 4影响因素 净重 Ceq_val V_val Alt_val Als_val Mo_val B_val 相关系数 0.0881 0.0844 0.1679 0.1404 0.1472 0.1200 0.1552 影响因素 钒氮合金 硅铝钙 石油焦增碳剂 FeMn68Si18 S收得率 P收得率 相关系数 0.1698 0.1078 0.1533 0.1744 0.1118 0.1065 表14. 钢号Q影响Mn收得率因素  本文针对于不同的钢号针对于合金的收得率受多种因素作了不同的预测。通过MATLAB编程求解，将原数据分为训练集和验证集。将C合金元素收得率的预测值与实际值进行比较，做出对比图如下图3~7所示： 图3. HRB400B、C预期值与实际值对比 图4. HRB400D、C预期值与实际值对比 图5. HEB500、C预期值与实际值对比 图6. 20MnK、C预期值与实际值对比 图7. Q、C预期值与实际值对比 针对于不同的钢号针对于合金的收得率受多种因素作了不同的预测。通过MATLAB编程求解，得到不同钢号下的C元素的收得率的部分预测数据如下表15所示： Table 1 5 C部分预测收得率 平均值 HRB400B 0.9760 1.0315 0.9683 0.9184 0.9373 1.0442 0.9249 0.9500 0.9688 HRB400D 0.9286 0.9509 0.9409 1.1035 0.8501 1.0190 0.9280 0.9206 0.9552 HEB500 1.1198 0.9338 0.7078 0.9721 1.1908 0.9783 1.3575 0.8684 1.0161 20 MnK 0.9337 0.8270 1.1036 0.9260 0.8858 0.9111 0.9125 0.9135 0.9267 Q 1.2897 1.4144 1.3547 1.1607 1.3533 1.1734 1.8262 0.2370 1.2262 表15. C部分预测收得率 将原数据分为训练集和验证集。将Mn合金元素收得率的预测值与实际值进行比较，做出对比图如下图8~12所示。 针对于不同的钢号针对于合金的收得率受多种因素作了不同的预测。通过MATLAB编程求解，得到不同钢号下的Mn元素的收得率的部分预测数据如下表16所示。 Table 1 6 Mn部分预测收得率 平均值 HRB400B 0.3839 0.7003 0.6000 0.6667 0.5944 0.6975 0.7128 0.7432 0.6373 HRB400D 0.8852 1.0025 0.8312 0.8302 0.6628 0.9068 1.9549 0.8622 0.9920 HEB500 0.8576 0.8745 0.8095 0.9807 0.8697 0.4646 0.9975 0.9819 0.8545 20 MnK 0.9442 0.9122 0.9261 0 0 0.9483 0.9499 0.9215 0.9337 Q 0.6667 0.6895 1.2371 1.3835 0.6705 1.1584 1.3724 1.2884 1.3331 表16. Mn部分预测收得率 图8. HRB400B、Mn预期值与实际值对比 图9. HRB400D、Mn预期值与实际值对比 图10. HEB500、Mn预期值与实际值对比 图11. 20MnK、Mn预期值与实际值对比 图12. Q、Mn预期值与实际值对比  由于BP神经网络模型运算速度缓慢和易陷入局部最小值的缺点，所以本文运用分数阶灰色模型与BP神经网络网络组合的方式对预测模型进行了改进，建立了分数阶灰色神经网络组合预测模型。通过MATLAB软件编程求解出不同钢号分类下的影响C、Mn两种元素的收得率。本文得到不同钢号下的C、Mn两种元素的收得率的部分预测数据如下表17和表18： Table 1 7 钢号 C部分预测收得率 平均值 HRB400B 0.9586 0.9649 0.9606 1.0132 0.9882 0.9590 0.9028 0.8751 0.9407 HRB400D 0.9523 0.9759 0.9610 0.9203 0.8090 1.0142 0.9569 0.8013 0.9336 HEB500 1.1623 1.1274 1.0159 0.9154 1.9901 0.8419 1.2948 1.0078 1.0792 20 MnK 0.9155 0.8991 0.9261 0.8169 0.8816 0.9079 0.8701 0.8137 0.8828 Q 2.7027 1.4210 1.6953 0.4525 0.8453 0.9834 1.6951 0.9166 1.2826 表17. C部分预测收得率 Table 1 8 钢号 Mn部分预测收得率 平均值 HRB400B 0.7336 0.7381 0.7424 0.8203 0.8191 0.8470 0.7503 0.8370 0.7796 HRB400D 0.8220 0.8466 0.7907 0.8357 0.8712 0.8497 0.7667 0.8413 0.8399 HEB500 1.1104 0.8493 0.9694 0.9732 1.4426 0.9350 1.3322 0.8750 0.9003 20 MnK 0.9417 0.9326 1.0080 1.0075 0.9156 0.9743 0.9466 0.9089 0.9760 Q 0.9525 1.4459 0.7551 0.8213 1.4363 1.3430 0.8287 1.4679 1.0948 表18. Mn部分预测收得率  本文针对于不同的合金料价格的不同以及问题二中的预测结果。通过MATLAB编程求解，本文得到不同钢号下脱氧合金化的成本和配料方案。  不同元素的要求下下配料方案和成本有所不同，所以本文在不同钢号下分别对不同的元素进行求解，如表19为C元素下合金配料方案及成本： Table 1 9 合金配料(吨) HRB400B HRB400D HRB500 20 MnK Q FeV55N11-A 0 0 0 0 0 低铝硅铁 0 0 0 0 0 钒氮合金 0 0 0 0 0 FeV50-A 83.8533 85.2965 47.5206 76.5619 77.0437 FeV50-B 83.8533 85.2965 47.5206 76.5619 77.0437 硅铝钙 0 0 0 0 0 FeAl30Si25 83.8533 85.2965 47.5206 76.5619 77.0437 硅铝锰合金球 0 0 0 0 0 硅锰面 83.8533 85.2965 47.5206 76.5619 77.0437 硅铁 83.8533 85.2965 47.5206 76.5619 77.0437 FeSi75-B 83.8533 85.2965 47.5206 76.5619 77.0437 石油焦增碳剂 83.8533 85.2965 47.5206 76.5619 77.0437 FeMn64Si27 83.8533 85.2965 47.5206 76.5619 77.0437 FeMn68Si18 83.8533 85.2965 47.5206 76.5619 77.0437 碳化硅 83.8533 85.2965 47.5206 76.5619 77.0437 硅钙碳脱氧剂 83.8533 85.2965 47.5206 76.5619 77.0437 成本(元) 38706691.7 39372885.7 21935552 35340974.6 35563393 表19. C元素下合金配料方案及成本  不同元素的要求下下配料方案和成本有所不同，所以本文在不同钢号下分别对不同的元素进行求解，如表20为Mn元素下合金配料方案及成本： Table 2 0 合金配料(吨) HRB400B HRB400D HRB500 20 MnK Q FeV55N11-A 0 0 0 0 0 低铝硅铁 0 0 0 0 0 钒氮合金 0 0 0 0 0 FeV50-A 0 0 0 0 0 FeV50-B 0 0 0 0 0 硅铝钙 0 0 0 0 0 FeAl30Si25 0 0 0 0 0 硅铝锰合金球 83.8533 85.2965 47.5206 76.5619 77.0437 硅锰面 83.8533 85.2965 47.5206 76.5619 77.0437 硅铁 0 0 0 0 0 硅铁FeSi75-B 0 0 0 0 0 石油焦增碳剂 0 0 0 0 0 FeMn64Si27 83.8533 85.2965 47.5206 76.5619 77.0437 FeMn68Si18 83.8533 85.2965 47.5206 76.5619 77.0437 碳化硅 0 0 0 0 0 硅钙碳脱氧剂 0 0 0 0 0 成本(元) 2716848 2763608 1539670 2480606 2496217 表20. Mn元素下合金配料方案及成本"
"1) 本文利用主成分分析法对影响C、Mn两种元素的历史收得率的主要因素进行分析，通过模型的建立选出少量综合指标，巧妙地反映高效有利的历史数据信息。将历史数据进行预处理，删除失真数据，利用均值填充遗失数据，最后根据钢号的不同将其分为五大类，极大的提高了算法的高效性。 2) 针对于BP神经网络模型运算速度缓慢和易陷入局部最小值的缺点，所以本文运用分数阶灰色模型与BP神经网络网络组合的方式对预测模型进行了改进，建立了分数阶灰色神经网络组合预测模型。进一步提升了预测的精度。 3) 本文通过模型的建立对历史数据的分析，得到较为理想的合金收得率的预测结果，在一定的程度上将会提高炼钢厂的钢铁生产量及其产品质量，同时为其节省成本。将其进行推广，将有利于我国钢铁事业的发展。"
