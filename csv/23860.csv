"在蜂窝通信单元下的大规模多输入多输出(MIMO)系统中，公用信号应该被全向传输以确保全范围覆盖。空时分组编码(STBC)目前已被广泛地应用于MIMO系统中，本文研究下行同步传输情景下的全向STBC编码，该方案也为有效降低下行链路导频开销提供了新的思路。首先我们在采样后的离散角度域为2*2的Alamouti编码设计了一种全向编码，该方案可以在空间角度域获得恒定的传输功率，同时保证各天线上的瞬时功率相等。随后，为获得4分集阶数，我们针对天线数为4的星座旋转STBC编码，提出了一种全向编码设计，并给出了对应的STBC编码中信息符号的生成方法。同时，我们将该方法推广到了使用复信号OSTBC编码时的情形。然后我们针对连续角度域重新推导了全向传输的等价条件，运用相位互补序列分别构造了Alamouti码和星座旋转STBC码的全向编码。为评估上述编码的性能，我们从误码率，遍历信道容量，峰均比，中断概率四个方面推导了相关表达式。最后我们从上述四个方面对所提出的构造进行了性能仿真，结果证明其中一种编码能有效降低误码率，渐进地达到信道容量上界，并在OFDM系统中保持原信号峰均比。 关键词 :大规模MIMO系统，全向预编码，STBC编码，分集阶数，Zadoff-Chu序列，相位互补序列 Copyright © 2018 by author and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"大规模多输入多输出(MIMO)技术是下一代移动通信的核心技术之一，它通过在发射端和接收端同时使用多个天线，能够充分地利用空间资源，提高频谱利用率，从而改善无线通信质量。MIMO系统的应用，可以在环境信噪比难以改善的情况下提高信道容量 [ 1 ] ，因而受到了广泛关注。针对大规模MIMO系统的研究目前已较深入地展开，主要工作包括：文献 [ 2 ] [ 3 ] 研究了大规模MIMO系统中正交频分复用的应用，并提出了正交扩频序列的设计方法，文献 [ 4 ] [ 5 ] 研究了MIMO系统下的信道检测与信道估计问题，文献 [ 6 ] 利用相位编码优化给出了一种干扰抑制技术，能够稳定地抑制频率选择信道下的信道间干扰，文献 [ 7 ] 提出了一些时分双工(TDD) MIMO系统下降低导频开销的有效方法，此外，在当今频带资源紧张的情况下，毫米波频段通信 [ 8 ] 也成为了研究热点。 在MIMO系统关键技术的研究中，下行链路的STBC编码传输是一个重要的课题。STBC编码是一种在空间域和时间域同时进行信道编码的方法，由于STBC编码通常采取正交编码方式，因此在接收端使用最大似然算法进行解码十分方便。Alamouti等人首先提出了一种双天线传输方法 [ 9 ] ，该方法是双天线模式下唯一可以达到满发送速率的编码方式。由于STBC编码方式下的译码复杂度随天线数成指数关系增长，同时增加传输天线数目又会导致时频资源的浪费 [ 10 ] ，因此STBC编码通常以低维形式出现。为解决上述问题，文献 [ 11 ] [ 12 ] 提出了将传输信号限制在低维子空间中以降低导频开销的方法。在MIMO系统的信号传输中，为提高资源利用率通常在接收端会安排多个用户(UT)，因此关于全向传输编码的研究具有十分重要的意义。全向传输条件要求基站(BS)发送的信号在不同的时隙内，在空间各角度上均获得相同的信噪比，以确保不同用户获得同样的接收功率。同时为充分利用发射天线的功放(PA)容量，基站各天线上的传输功率也应保持一致。因此，我们需要设计与信道无关的全向预编码(OP)矩阵来实现上述要求。目前关于MIMO系统中全向预编码方法已有几篇研究工作 [ 12 ] [ 13 ] ，但上述文献仅从离散采样角度考虑了对单流信号的全向编码，没有考虑连续角度域的设计，且几乎没有分析编码后系统的误码率、信道容量等性能。为此，本文将主要研究采用STBC编码的下行链路传输的全向预编码方法及其编码性能，该模型大幅度降低了等效信道矩阵列数，从而降低信道估计压力。 根据以上分析，本文剩余部分的安排如下：在第2部分，我们给出了MIMO系统模型，并结合相关文献的研究给出了离散角度域STBC编码条件下OP矩阵满足的条件。在3部分，我们首先针对2*2的Alamouti编码，提出了一种符合要求的构造实例，并讨论了其中的参数的取值要求，其次我们针对常用的4*4星座旋转STBC编码和复信号OSTBC编码，利用Hadamard矩阵和ZC序列分别提出了构造，并且指出在该构造方法下STBC编码中的传输符号的设计方法。在第4部分中，我们考虑连续角度域的情况推导了OP矩阵所满足的条件，根据该条件提出了一种Alamouti编码对应的全向编码构造，随后又将其推广得到STBC编码矩阵为4*4型时所需的OP矩阵。在第5部分中，我们对编码后系统误码率，峰均比(PAPR)，信道容量，中断概率进行了分析，并说明发射天线数充分大时信道容量达到上界。第6部分中，我们针对所提出的几种OP矩阵的上述四种性能指标进行看仿真。结论在第6部分中给出。 符号约定：我们用 ⊗ 和*分别表示矩阵的Kronecker积和Hadamard积，用 I M 和 1 M 分别表示M维单位矩阵和单位列向量，用 ( ⋅ ) * , ( ⋅ ) T , ( ⋅ ) H 分别表示矩阵 A 的共轭、转置和共轭转置，用 diag ( a ) 表示以向量 a 为对角线向量的矩阵，用 det ( A ) 、 tr ( A ) 、 rank ( A ) 和 vec ( A ) 分别表示矩阵的行列式值、迹、秩和拉直算子，用 ‖ x ‖ F 表示向量 x 的二范数，用 E ( ⋅ ) 表示数学期望，用记号DFT表示序列的离散傅里叶变换。"
"考虑一个具有M个发射天线，K个接收天线的通信系统，如图1所示。预编码矩阵为 W ∈ ℂ M × N ，低维STBC矩阵为 X ∈ ℂ N × T ，其中T表示传输符号从T个时隙 t = 1 , 2 , 3 , ⋯ , T 发送出去。设第k个接收天 图1. 使用全向STBC编码的MIMO系统模型 线所对应的信道向量为 h k ∈ ℂ M × 1 ， h k 符合瑞利衰落分布。信道矩阵可表示为 H = [ h 1 , h 2 , ⋯ , h K ] 。设各信道之间是相互独立的，则有第k个接收天线在T个时刻接收到的信号 [ y k , 1 , y k , 2 , ⋯ , y k , T ] 为 [ y k , 1 , y k , 2 , ⋯ , y k , T ] = h k T S + [ z k , 1 , z k , 2 , ⋯ , z k , T ] (1) 其中 S = W X 为经过OP矩阵映射后的发送符号， S ∈ ℂ M × T ，因此导频序列长度只需要不小于N即可，导频开销将显著降低。 [ z k , 1 , z k , 2 , ⋯ , z k , T ] 为均值为0，方差为 σ k 2 的复加性高斯白噪声。不妨设接收端的K根天线关于基站段有相同的大尺度衰落，用 Λ k 表示对角线上第k个元素为M，其余所有元素均为0的对角阵，则第k根天线在第t个时隙的接收功率为 P k = E { | h k W x t | 2 } = x t H W H F M H Λ k F M W x t (2) 其中 F M 表示M点离散傅里叶变换矩阵， [ F M ] m , n = e − 2 π j m n / M ，对列向量 x 作DFT变换等效于左乘 F M 。 x t ∈ ℂ N × 1 表示矩阵 X 的某一列。 我们采用文献 [ 12 ] 提出的设计准则，即预编码矩阵 W 和低维STBC编码矩阵 X 需要满足以下条件： ·全向传输条件：首先，所设计的OP矩阵需要满足在$M$个离散角度域上具有相同的传输功率，即列向量 F M W x t 的M个分量具有相同的幅值： [ F M W x t ] 1 = [ F M W x t ] 2 = ⋯ = [ F M W x t ] M = c ，此时容易验证K个接收天线上所接收的信号功率 P ( Λ 1 ) = P ( Λ 2 ) = ⋯ = P ( Λ K ) = M c 2 为定值，符合设计要求。 ·PA利用率条件：为达到较高的天线功放利用率，我们考虑保证M个发送天线上的传输信号相等，即对任一时刻t，均有 [ W x t ] 1 = [ W x t ] 2 = ⋯ = [ W x t ] M ，由各发送天线上的瞬时功率与OP矩阵 W 和STBC矩阵 X 都有关，因此本文将STBC矩阵中的传输符号与预编码矩阵联合设计。"
"当 N = 2 时，我们使用Alamouti码作为低维码，则有 N = T = 2 。Alamouti码是一种发射天线数为2，可以提供满分集速率的正交空时码，编码器输出的两个符号在两个时间周期内被发送出去，如下式所示： X A = [ x 1 x 2 * x 2 − x 1 * ] (3) 我们提出使用以下构造来设计 S = W X ： W = diag ( Π r F M c ) ( 1 M / 2 ⊗ P ) (4) 其中 c 为长度为M的ZC恒模序列，其定义为： [ c ] m = { e j π γ m 2 / M         M iseven e j π γ m ( m + 1 ) / M M isodd (5) 上式中能够 m = 0 , 1 , ⋯ , M − 1 ， γ 是与M互素的正整数。 Π k 为k阶循环位移阵，其定义为： Π k = [ 0 I k I M − k 0 ] (6) 矩阵 P ∈ ℂ 2 × 2 ， P = [ [ p 11 , p 12 ] T , [ p 21 , p 22 ] T ] T 需要满足以下三个条件： ① p 11 p 12 ∗ ∈ ℝ ， p 21 p 22 ∗ ∈ ℝ 。 ② | p 11 | 2 + | p 12 | 2 = | p 21 | 2 + | p 22 | 2 。 ③ 矩阵 P 是规范列正交的。 证明：取发射天线个数M为偶数，即 M = 2 M 0 ，为方便推导不妨令 γ = 1 (若 γ ≠ 1 ，下述推导是完全类似的)。 首先我们有： [ c Π r ( 1 ) , c Π r ( 2 ) , ⋯ , c Π r ( 2 M 0 − 1 ) ] → D F T [ d ( 0 ) , d ( 1 ) , ⋯ , d ( 2 M 0 − 1 ) ] (7) 其中： d ( k ) = ∑ n = 0 2 M 0 − 1 c Π r ( n ) e − 2 π j k n / 2 M 0 (8) = e − j π ( n − r ) 2 / 2 M 0 ∑ n = 0 2 M 0 − 1 e 2 j π ( n − k − r ) 2 / 2 M 0 (9) = ∑ n = 0 2 M 0 − 1 e j π ( n − r ) 2 / 2 M 0 e − 2 π j k n / 2 M 0 (10) 容易验证上式中对任意给定的 0 ≤ k , r ≤ 2 M 0 − 1 ，当n取遍 { 0 , 1 , 2 , ⋯ , 2 M 0 − 1 } ， e 2 j π ( n − k − r ) 2 / 2 M 0 恰好为 { e 2 j π 0 2 / 2 M 0 , e 2 j π 1 2 / 2 M 0 , ⋯ , e 2 j π ( 2 M 0 − 1 ) 2 / 2 M 0 } 的一个排列，故 d ( k ) 可记作 d ( k ) = e − j π ( k − r ) 2 / 2 M 0 λ ( 2 M 0 ) ，其中 λ ( 2 M 0 ) 是与k无关的复函数。注意到 d ( k ) = Π r F M c ( k ) ，则有： S A = [ d ( 0 ) p 11 d ( 0 ) p 12 d ( 1 ) p 21 d ( 1 ) p 22 d ( 2 ) p 11 d ( 2 ) p 12 ⋮ ⋮ d ( 2 M 0 − 1 ) p 21 d ( 2 M 0 − 1 ) p 22 ] [ x 1 x 2 * x 2 − x 1 * ] (11) F M W x t = F M [ ( p 11 x 1 + p 12 x 2 ) d ( 0 ) ( p 21 x 1 + p 22 x 2 ) d ( 1 ) ( p 11 x 1 + p 12 x 2 ) d ( 2 ) ⋮ ( p 21 x 1 + p 22 x 2 ) d ( 2 M 0 − 1 ) ] (12) 与式(8) (9) (10)中的推导类似，易得 F M [ d ( 0 ) , d ( 1 ) , ⋯ , d ( 2 M 0 − 1 ) ] T = [ X ( 0 ) , X ( 1 ) , ⋯ , X ( 2 M 0 − 1 ) ] T ，其中 X ( k ) = e j π ( k − r ) 2 / 2 M 0 λ 2 ( 2 M 0 ) 。于是由(12)式可得： F M W x 1 ( k ) = ( p 11 x 1 + p 12 x 2 ) ∑ n = 0 2 M 0 − 1 d ( n ) + ( − 1 ) n d ( n ) 2 W 2 M 0 k n     + ( p 21 x 1 + p 22 x 2 ) ∑ n = 0 2 M 0 − 1 d ( n ) − ( − 1 ) n d ( n ) 2 W 2 M 0 k n                         (13)   = ( p 11 x 1 + p 12 x 2 ) X ( k ) + X ( ( k + M 0 ) 2 M 0 ) 2     + ( p 21 x 1 + p 22 x 2 ) X ( k ) − X ( ( k + M 0 ) 2 M 0 ) 2                         (14) = f 1 ( x 1 , x 2 ) X ( k ) + f 2 ( x 1 , x 2 ) X ( ( k + M 0 ) 2 M 0 )                         (15) 上式中 W N k = e − 2 π j k / N ， ( a ) b 表示a模b的余数， f 1 ( x 1 , x 2 ) , f 2 ( x 1 , x 2 ) 均为 x 1 , x 2 的线性函数。由 X ( k ) 的表达式容易验证 X ( k ) X ( ( k + M 0 ) 2 M 0 ) * = const 当且仅当 4 | M ，我们进一步令天线个数为4的倍数，则有： | F M W x 1 ( k ) | 2 = ( | f 1 ( x 1 , x 2 ) | 2 + | f 2 ( x 1 , x 2 ) | 2 ) λ 2 ( 2 M 0 )       + 2 ℜ ( f 1 ( x 1 , x 2 ) f 2 * ( x 1 , x 2 ) X ( k ) X * ( ( k + M 0 ) 2 M 0 ) ) (16) 上式显然与k无关，由此我们证明了 F M W x 1 的M个分量恒模，对 F M W x 2 ，证明是完全等价的，于是全向传输条件得到了满足。下面我们证明式(4)中给出的构造满足PA利用率条件：由(11)式给出的 W x 1 的形式，容易验证： | W x 1 ( k ) | 2 λ 2 ( 2 M 0 ) = | p 11 | 2 | x 1 | 2 + | p 12 | 2 | x 2 | 2 + 2 ℜ ( p 11 p 12 * x 1 x 2 * ) , k ≡ 0 ( mod 2 ) (17) | W x 1 ( k ) | 2 λ 2 ( 2 M 0 ) = | p 21 | 2 | x 1 | 2 + | p 22 | 2 | x 2 | 2 + 2 ℜ ( p 21 p 22 * x 1 x 2 * ) , k ≡ 1 ( mod 2 ) (18) 由上两式及所提出的 P 的设计条件，容易得到当传输符号 x 1 , x 2 满足： | x 1 | = | x 2 | = c 。且 ℜ ( x 1 x 2 * ) = 0 时， | W x 1 ( 0 ) | = | W x 1 ( 1 ) | = ⋯ = | W x 1 ( 2 M 0 − 1 ) | 为定值，因此低维传输符号矩阵 X 需要与OP矩阵 W 联合设计。文献给出了在Alamouti编码结构下对符号信息 x 1 , x 2 进行单独设计的方法，该方法虽构造简便，但其不能有效降低传输信号的峰均比。本文给出一种满足设计准则的新的构造方法，将 x 1 , x 2 联合设计，虽然该方法在接收端最大似然译码时略显复杂，但在之后的性能分析与仿真结果中，可以看到该方案降低了系统峰均比，如下所示： { x 1 = e j sin 2 π n / T x 2 = j e − j sin 2 π n / T (19) 其中T为码元周期。另外我们注意到所提出的编码矩阵 W 的两列向量是复正交的，这样的构造使得在接收端只需进行简单的相关处理即可将不同时隙发送的符号进行分离。  当N = 4时，令 M = 4 M 0 ，我们采用4天线的Jafarkhani码，即每次取4个信息符号 x 1 , x 2 , x 3 , x 4 进行编码，其中 x 1 , x 2 取自星座图 A ，而 x 3 , x 4 取自星座图 e j θ A ，即： X J = [ x 1 − x 2 * − ( x 3 e j θ ) * x 4 e j θ x 2 x 1 * − ( x 4 e j θ ) * − x 3 e j θ x 3 e j θ − ( x 4 e j θ ) * x 1 * − x 2 x 4 e j θ ( x 3 e j θ ) * x 2 * x 1 ] (20) 与Alamouti编码类似，上述Jafarkhani码编码也可以达到满发射速率。我们同样采用ZC序列提出一种构造： S J = W J X J ，其中： W J = diag ( Π r F M c ) ( 1 M / 4 ⊗ ( I 2 ⊗ H 2 ) ) (21) 上式中 H 2 为二阶Hardmard矩阵。 证明：我们首先给出一个简单的引理： 引理1：对任意 D ∈ ℕ + ，都存在一个函数集 ϕ 1 ( n ) , ϕ 2 ( n ) , ⋯ , ϕ D ( n ) ，使对任意 1 ≤ i ≤ D ， ϕ i ( n ) = 1 而 ϕ j ( n ) = 0   ( j ≠ i ) 当且仅当 n ≡ i ( mod D ) 。 引理1的证明：事实上，我们令 ε 0 , ε 1 , ⋯ , ε D − 1 为1的D阶单位根，则取 { ϕ 1 ( n ) = 1 D ∑ i = 0 D − 1 ε i n ϕ 2 ( n ) = 1 D ∑ i = 0 D − 1 ε i n − ( D − 1 )                       ⋮ ϕ D ( n ) = 1 D ∑ i = 0 D − 1 ε i n − 1 (22) 容易验证上述一系列函数满足要求。 为简便起见我们令 Q = 1 M / 4 ⊗ ( I 2 ⊗ H 2 ) ， Q 的第j行行向量为 Q j , ; ，类似于(13)式的推导我们有： F M W J x 1 ( k ) = ∑ j = 1 4 [ Q ] j , ; x 1 ∑ n = 0 4 M 0 − 1 d ( n ) ϕ j ( n ) W 4 M 0 k n (23) 注意到： ∑ n = 0 4 M 0 − 1 d ( n ) ϕ j ( n ) W 4 M 0 k n = ∑ p = 1 4 ε p − 1 − j X ( ( k + ( j − 1 ) M 0 ) 4 M 0 ) D (24) 于是(23)式又可写作： | F M W J x 1 ( k ) | 2 = | ∑ i = 1 4 f i ( x 1 , x 2 , x 3 , x 4 ) W ( ( k + ( i − 1 ) M 0 ) 4 M 0 ) | 2 = ∑ i = 1 4 | f i ( x 1 , x 2 , x 3 , x 4 ) | 2 | λ ( 4 M 0 ) | 2     + ∑ 1 ≤ i < j ≤ 4 2 ℜ [ f i ( x 1 , x 2 , x 3 , x 4 ) f j * ( x 1 , x 2 , x 3 , x 4 )     × W ( ( k + ( i − 1 ) M 0 ) 4 M 0 ) W ( ( k + ( j − 1 ) M 0 ) 4 M 0 ) * ] 容易验证 W ( ( k + ( i − 1 ) M 0 ) 4 M 0 ) W ( ( k + ( j − 1 ) M 0 ) 4 M 0 ) * 为定值当且仅当 4 | M 0 ，因此我们取 16 | M ，则由上式容易证明 F M W J x 1 为一恒模向量。 另一方面，由Hardmard矩阵的定义容易验证： | W J x 1 ( k ) | 2 = | λ ( 4 M 0 ) | 4 ( | x 1 | 2 + | x 2 | 2 + 2 ( − 1 ) ( k ) 4 ℜ ( x 1 x 2 * ) ) (25) | W J x 1 ( k ) | 2 = | λ ( 4 M 0 ) | 4 ( | x 3 | 2 + | x 4 | 2 + 2 ( − 1 ) ( k − 2 ) 4 ℜ ( x 3 x 4 * ) ) (26) 式(25)中 k ≡ 0 , 1 ( mod 4 ) ，式(26)中 k ≡ 2 , 3 ( mod 4 ) 。由上式可知，采用(21)式提出的预编码矩阵，可以使符号组 x 1 , x 2 和 x 3 , x 4 独立设计，即按照(19)中所提出的方法构造，可以满足 | x 1 | = | x 2 | = | x 3 | = | x 4 | = c 且 ℜ ( x 1 x 2 * ) = ℜ ( x 3 x 4 * ) = 0 。  在文献 [ 10 ] 中，作者给出了发射信号为复信号情况下的OSTBC编码设计，其可以达到3/4的发射速率，事实上这类矩阵总可以表示为： [ X O T ] , ; k = Σ 1 , k [ x 1 , x 2 , x 3 , x 4 ] T + Σ 2 , k [ x 1 * , x 2 * , x 3 * , x 4 * ] T (27) 其中 Σ 1 , k , Σ 2 , k ∈ ℝ 4 × 4 。于是我们可将式(21)中提出的构造进一步推广为 W O T , k = diag ( Π r F M c ) ( 1 M / 4 ⊗ ( ( I 2 ⊗ H 2 ) ( Σ 1 , k + Σ 2 , k ) − 1 ) ) (28) 证明： 将 diag ( Π r F M c ) 写作分块对角阵的形式，即： diag ( Π r F M c ) = diag [ B 1 , B 2 , ⋯ , B M / 4 ] (29) 并记 U = I 2 ⊗ H 2 。这样，我们有： W O T , k x k = [ ( B 1 U ( Σ 1 , k + Σ 2 , k ) − 1 ) T , ( B 2 U ( Σ 1 , k + Σ 2 , k ) − 1 ) T , ⋯ ] T × ( Σ 1 , k + Σ 2 , k ) Ω k = [ ( B 1 U Ω k ) T , ( B 2 U Ω k ) T , ⋯ , ( B M / 4 U Ω k ) T ] T (30) 其中 Ω k ∈ ℂ 4 × 1 ， ( Ω k ) i = ± x i 或 ± x i * 。这样， W O T , k x k 事实上具有与(23)式中的 W J x k 完全相同的性质，接下来的证明与3.2节中类似。"
"当考虑连续角度域的设计时，本文第二部分所述的全向传输条件中的离散角度变量变为连续角度变量，即对 W x k 作DTFT变换，并考虑T个时隙 k = 1 , 2 , ⋯ , T 的发送总功率，我们得到修正后的全向传输条件： P ( ω ) = ∑ k = 1 T | ∑ n = 1 M ( W x k ) n e − j ω n | 2 = const ,   ω ∈ [ − π , π ] (31)  当 N = 2 时，我们仍然利用(3)式中给出的Alamouti编码。为得到(31)式的等效条件，我们将 W 写出列向量的形式： W = [ w 1 , w 2 ] 。并记对列向量 w 1 , w 2 的DTFT变换分别为 S 1 ( ω ) , S 2 ( ω ) ，即： S i ( ω ) = ∑ n = 1 M w i , n e − j ω n ,   i ∈ { 1 , 2 } (32) 利用(32)式，(31)式又可写作： P ( ω ) = [ S 1 ( ω ) , S 2 ( ω ) ] [ x 1 , x 2 ] T [ x 1 , x 2 ] * [ S 1 ( ω ) , S 2 ( ω ) ] H     + [ S 1 ( ω ) , S 2 ( ω ) ] [ x 2 * , − x 1 * ] T [ x 2 * , − x 1 * ] * [ S 1 ( ω ) , S 2 ( ω ) ] H = [ S 1 ( ω ) , S 2 ( ω ) ] [ | x 1 | 2 + | x 2 | 2 0 0 | x 1 | 2 + | x 2 | 2 ] × [ S 1 ( ω ) , S 2 ( ω ) ] H = ( | x 1 | 2 + | x 2 | 2 ) ( | S 1 ( ω ) | 2 + | S 2 ( ω ) | 2 ) (33) 根据(33)式得到的等效表达式，我们得到考虑连续角度时的设计准则： ·全向传输条件：由于 | x 1 | = | x 2 | = 1 ，为满足各方向用户所接收的总功率相等，只需满足 | S 1 ( ω ) | 2 + | S 2 ( ω ) | 2 = const 。 ·PA利用率条件：PA利用率的约束条件与离散角度域相同，需要满足 W x k 为一恒模向量。 ·最大化分集增益：为保证编码后仍能取得最大分集增益，我们希望使 rank ( W ) = N 根据上述设计准则，取天线数 M = 2 M 0 ，我们提出一种构造方法： W = [ a 1 cos θ − b 1 sin θ b 1 sin θ a 1 cos θ a 2 cos θ − b 2 sin θ b 2 sin θ a 2 cos θ ⋮ ⋮ a M 0 cos θ − b M 0 sin θ b M 0 sin θ a M 0 cos θ ] (34) 其中 [ a 1 , a 2 , ⋯ , a M 0 ] 和 [ b 1 , b 2 , ⋯ , b M 0 ] 为一对长度为 M 0 的glory互补序列。当 M 0 = 2 p ，glory序列可由递归方法生成：取初始序列 s 1 = [ 1 , 1 ] ,   t 1 = [ 1 , − 1 ] ，根据 s k + 1 = [ s k , t k ] ， t k + 1 = [ s k , − t k ] 进行递归生成，则 s p , t p 即为所求的glory互补序列。 证明：首先将 S 1 ( ω ) , S 2 ( ω ) 变形为： S 1 ( ω ) = cos θ ∑ n = 1 M 0 b n e − j ω 2 n + sin θ ∑ n = 1 M 0 a n e − j ω ( 2 n − 1 ) = cos θ A ( 2 ω ) + e j ω sin θ B ( 2 ω ) (35) S 2 ( ω ) = − sin θ ∑ n = 1 M 0 b n e − j ω 2 n + cos θ ∑ n = 1 M 0 a n e − j ω ( 2 n − 1 ) = − sin θ e j ω B ( 2 ω ) + cos θ A ( 2 ω ) (36) 其中 A ( ω ) = ∑ n = 1 M 0 a n e − j ω n ， B ( ω ) = ∑ n = 1 M 0 b n e − j ω n 分别为 [ a 1 , a 2 , ⋯ , a M 0 ] 和 [ b 1 , b 2 , ⋯ , b M 0 ] 的DTFT变换函数。利用(35) (36)式可得： | S 1 ( ω ) | 2 + | S 2 ( ω ) | 2 = 2 cos 2 θ | A ( 2 ω ) | 2 + 2 sin 2 θ | B ( 2 ω ) | 2 + sin 2 θ ℜ ( e − j ω A ( 2 ω ) B * ( 2 ω ) )         − sin 2 θ ℜ ( e j ω A * ( 2 ω ) B ( 2 ω ) ) = 2 cos 2 θ | A ( 2 ω ) | 2 + 2 sin 2 θ | B ( 2 ω ) | 2 + 2 sin 2 θ ℜ ( 2 j ℑ ( e − j ω A ( 2 ω ) B * ( 2 ω ) ) ) = 2 cos 2 θ | A ( 2 ω ) | 2 + 2 sin 2 θ | B ( 2 ω ) | 2 (37) ℑ ( ⋅ ) 表示取虚部。用 r a , a ( n ) , r b , b ( n ) 分别表示 [ a 1 , a 2 , ⋯ , a M 0 ] 和 [ b 1 , b 2 , ⋯ , b M 0 ] 的自相关函数，根据glory互补序列的性质有 r a , a ( n ) + r b , b ( n ) = 0 ,   ∀ 1 ≤ n ≤ M 0 − 1 ，我们进一步得到： | A ( ω ) | 2 + | B ( ω ) | 2 = ∑ n = 1 M 0 ( | a n | 2 + | b n | 2 ) + 2 ∑ n = 1 M 0 − 1 ℜ ( e − j ω n ( r a , a ( n ) + r b , b ( n ) ) ) = 2 M 0 (38) 令 θ = π / 4 ，于是有 | S 1 ( ω ) | 2 + | S 2 ( ω ) | 2 = | A ( 2 ω ) | 2 + | B ( 2 ω ) | 2 = 2 M 0 ，为与 ω 无关的定值。这就证明了式(34)所提构造符合全向传输条件。另一方面，容易验证 W x k = 1 2 M 0 及 rank ( W ) = N = 2 ，综上，式(34)中的OP矩阵完全符合设计准则。  当 时，我们仍考虑采用式(20)中的星座旋转编码，此时与 N = 2 时的推导类似，我们可以得到： P ( ω ) = ∑ n = 1 4 | x n | 2 ∑ n = 1 4 | S n ( ω ) | 2 。设计准则与 N = 2 的情况类似，我们给出一种构造方法： W = [ [ I 4 ] , : 1 ⊗ a T , [ I 4 ] , : 2 ⊗ b T , [ I 4 ] , : 3 ⊗ c T , [ I 4 ] , : 4 ⊗ d T ] (39) 其中 a = [ a 1 , a 2 , ⋯ , a M 0 ] ， b = [ b 1 , b 2 , ⋯ , b M 0 ] ， c = [ c 1 , c 2 , ⋯ , c M 0 ] ， d = [ d 0 , d 1 , ⋯ , d M 0 ] 。 与(38)式类似，本文可以得到： | A ( ω ) | 2 + | B ( ω ) | 2 + | C ( ω ) | 2 + | D ( ω ) | 2 = ∑ n = 1 M 0 ( | a n | 2 + | b n | 2 + | c n | 2 + | d n | 2 )       + 2 ∑ n = 1 M 0 = 1 ℜ ( e − j ω n ( r a , a ( n ) + r b , b ( n ) + r c , c ( n ) + r d , d ( n ) ) ) (40) 由上式可知，满足全向传输条件的关键是得到一组非循环完全互补序列，满足 r a , a ( n ) + r b , b ( n ) + r c , c ( n ) + r d , d ( n ) = k δ ( n ) ，其中 δ ( n ) 为长度为 M 0 的Kronecker序列。我们利用生成树的方法提出一种完全互补序列组的构造方法：令 C a 1 = [ 1 , 1 ] , C a 2 = [ 1 , − 1 ] , S a 1 = [ − 1 , 1 ] , S a 2 = [ − 1 , − 1 ] ，首先我们得到一组4个长度为8的完全序列集： L 4 × 8 = [ C a 1 C a 2 S a 1 S a 2 C a 1 − C a 2 S a 1 − S a 2 C a 2 C a 1 S a 2 S a 1 C a 2 − C a 1 S a 2 − S a 1 ] (41) 在(41)的基础上进行递推，可以得到一组4个长度为16的互补序列集： L 4 × 16 = [ C a 1 C a 2 C a 1 − C a 2 C a 1 C a 2 − C a 1 C a 2 C a 1 − C a 2 C a 1 C a 2 C a 1 − C a 2 − C a 1 − C a 2 S a 1 S a 2 S a 1 − S a 2 S a 1 S a 2 − S a 1 S a 2 S a 1 − S a 2 S a 1 S a 2 S a 1 − S a 2 − S a 1 − S a 2 ] (42) 事实上，据此可以归纳出由 L 4 × 2 k 递推得到 L 4 × 2 k + 1 的一般方法：首先我们将 L 4 × 2 k 分块记为： L 4 × 2 k = [ L k , 1 L k , 2 L k , 3 L k , 4 ] (43) 其中 L k , 1 , L k , 2 , L k , 3 , L k , 4 ∈ ℝ 2 × 2 k − 1 。注意到所提构造以 C a 1 , C a 2 , S a 1 , S a 2 为基本单位，我们用记号 F ( x ) 表示将序列 x 中的负号左移一次，用记号 x ¯ 表示对序列 x 取反，例如设 x = [ C a 1 , C a 2 , C a 1 , − C a 2 ] ，则 F ( x ) = [ C a 1 , C a 2 , − C a 1 , C a 2 ] ，而 x ¯ = [ − C a 1 , − C a 2 , − C a 1 , C a 2 ] 。运用上述记号，由 L 4 × 2 k 生成 L 4 × 2 k + 1 的递推关系可表示为： L 4 × 2 k + 1 = [ vec ( L k , 1 ) vec ( L k , 2 ) F ( vec ( L k , 1 ) ) F ( vec ( L k , 2 ) ) F ( F ( vec ( L k , 1 ) ) ) F ( F ( vec ( L k , 2 ) ) ) vec ( L k , 1 ) ¯ vec ( L k , 2 ) ¯ ] (44) 通过上述关系式，我们构造了一组4个长度为任意 2 p 的互补序列，该序列组中的任意两序列均为一对glory互补序列。用这四个序列分别作为式(39)中的序列 a , b , c , d ，即可得到满足全向传输条件的OP矩阵。与 N = 2 的情形类似，容易验证 W x k 恒模及 rank ( W ) = N = 4 ，因此(39)式中的构造方法符合三个设计准则的要求。另外，注意到(39)中矩阵每行只有一个非零元素，根据下文的讨论可以看到，其能够保持传输信号的峰均比。"
"在OFDM通信系统中，降低子载波调制后信号的峰均比是一个重要的问题，因此我们至少应保证经过预编码矩阵映射后信号峰均比不会增加。考虑 N c 个信息符号，码元周期为 1 / T ，经过 N c 个相互正交的子载波调制后其峰均比可表示为： PAPR n , befor = max 0 ≤ t ≤ T { | ∑ k = 0 N c − 1 x n ( k ) e 2 π j k t / T | 2 } E { | ∑ k = 0 N c − 1 x n ( k ) e 2 π j k t / T | 2 } (45) 经过预编码后的峰均比可表示为： PAPR m , after = max 0 ≤ t ≤ T { | ∑ k = 0 N c − 1 [ Q ] m , : x ( k ) e 2 π j k t / T | 2 } E { | ∑ k = 0 N c − 1 [ Q ] m , : x ( k ) e 2 π j k t / T | 2 } (46) 其中 x ( k ) 为低维符号矩阵 X 的某一列向量的第k个分量。下面我们推导经过预编码后PAPR降低的充分条件。一方面由子载波的正交性容易验证： E { | ∑ k = 0 N c − 1 x n ( k ) e 2 π j k t / T | 2 } = ∑ k = 1 N c − 1 | x n ( k ) | 2 (47) E { | ∑ k = 0 N c − 1 [ Q ] m , : x ( k ) e 2 π j k t / T | 2 } = ∑ k = 1 N c − 1 | [ Q ] m , : x ( k ) | 2 (48) 另一方面我们有： | ∑ k = 1 N c − 1 [ Q ] m , : x ( k ) e 2 π j k t / T | = | | ∑ k = 0 N c − 1 ( ∑ n = 0 N − 1 w m , n x n ( k ) ) e 2 π j k t T | = | ∑ n = 0 N − 1   w m , n ∑ k = 0 N c − 1 x n ( k ) e 2 π j k t / T ︸ f n ( t ) | ≤ | ∑ n = 0 N − 1   w m , n 2 | | ∑ n = 0 N − 1   f n 2 ( t ) | ≤ | ∑ n = 0 N − 1   w m , n 2 | ∑ n = 0 N − 1 | f n ( t ) | 2 (49) 其中第一个不等号利用了复数域的柯西不等式，第二个不等号利用了复数的三角不等式。注意到 max 0 ≤ t ≤ T | f 1 ( t ) | = max 0 ≤ t ≤ T | f 2 ( t ) | = ⋯ = max 0 ≤ t ≤ T | f N ( t ) | ，同时设 [ W ] m , : 有 R m 个非零元素，结合(29) (30) (33)可得 PAPR m , after ≤ PAPR n , befor 的一个充分条件为： | ∑ n = 0 N − 1   w m , n 2 | ≤ R m N ⋅ | λ ( M ) | 2 (50) 由此易知，为达到不增加PAPR的目的，只需使式(21)所提OP矩阵乘一归一化常数1/4即可，这对全向性能没有任何影响。特别地，若，则由(47) (48)可直接验证 PAPR m , after = PAPR n , befor ，显然式(39)中提出的构造能保持峰均比。  考虑欲发送的符号矩阵为 X ，被误判决为 X ′ 的概率，其中 X ≠ X ′ ∈ C ， C 为码本集合。利用文献 [ 10 ] 给出的定义，可以得到： ℙ ( X → X ′ | H ) = E { Q ( tr [ H H W ( X − X ′ ) ( X − X ′ ) H W H H 2 σ n 2 ] ) } ≤ E { exp ( − 1 2 tr [ H H W ( X − X ′ ) ( X − X ′ ) H W H H 2 σ n 2 ] ) } = E { exp ( − 1 4 M σ n 2 tr [ S 1 S 2 ] ) } ≤ E { exp ( − 1 4 M σ n 2 tr [ S 2 ] λ min ( S 1 ) ) } = ∫ − ∞ + ∞ exp ( − 1 4 M σ n 2 tr [ S 2 ] t ) × d [ 1 − ∫ t + ∞ ⋯ ∫ t + ∞ L ( λ 1 , λ 2 , ⋯ , λ K ) d λ 1 ⋯ d λ K ] d t d t (51) 其中 S 1 = H H H ， S 2 = W ( X − X ′ ) ( X − X ′ ) H W H ， Q ( x ) ≜ 1 2 π ∫ x + ∞ e − t 2 / 2 d t 为高斯补误差函数， λ 1 , λ 2 , ⋯ , λ K 为 S 1 的 个特征值， L ( ⋅ ) 为其联合概率密度函数。 λ min ( S 1 ) 为 S 1 的最小特征值，第一个不等号由 Q ( x ) ≤ e − x 2 / 2 得到，第二个不等号由引理2得出。 引理2：设 A 为半正定Hermite矩阵， B 为Hermite矩阵，则有： tr ( A B ) ≥ λ min ( B ) tr ( A ) (52) 由(51)式可知，得到误码率上界的关键为求得 λ min ( S 1 ) 的概率密度。我们有： ∫ t + ∞ ⋯ ∫ t + ∞ L ( λ 1 , λ 2 , ⋯ , λ K ) d λ 1 d λ 2 ⋯ d λ K = a 1 ( M ! ) 2 ∫ t + ∞ ⋯ ∫ t + ∞ ∏ j = 1 M exp ( − λ j ) det ( G ) d λ 1 d λ 2 ⋯ d λ K = 1 ( M ! ) 2 det ( S ) (53) 其中： G = [ 1 λ 1 ⋯ λ 1 M − 1 λ 2 λ 2 2 ⋯ λ 2 M ⋮ ⋮ ⋱ ⋮ λ M M − 1 λ M M ⋯ λ M 2 M − 2 ] (54) 等式(a)由文献 [ 14 ] 给出的引理得到(为简化推导假定 M = K )，且有： S i , j = ∫ u = t + ∞ exp ( − λ i ) λ i i + j − 2 d u = ϕ ( i + j − 2 , t ) = ( i + j − 2 ) ! ( 1 − e − t ∑ p = 0 i + j − 2 t p p ! ) (55) 其中 ϕ ( n , k ) ≜ ∫ u = t + ∞ e − u u k d u 为第二类不完全欧拉积分。注意到 S 为 M × M 的Hankel矩阵，即该矩阵中任意元素总能表示为 S i , j = f ( i , j ) 的形式。利用Hankel的性质：其行列式展开中每一项 ∏ i = 1 M f ( s i , t i ) 均满足 ∑ i = 1 M s i + t i − 2 = M ( M − 1 ) ，经计算可得 det ( S ) 可展开为： det ( S ) = ∑ i = 0 M ∑ j = 0 M ( M − 1 ) c i , j exp ( − i t ) t j (56) 其中系数 可由下式确定： (57) 将(56)式代入(51)式，经推导可得： (58) 其中 为gamma函数。(58)式给出了采用全向STBC编码的系统误码率上界。容易看到，若STBC编码经过 矩阵映射后满足 充分大，则系统误码率性能将得到显著改善。  利用文献 [ 15 ] 的结果，我们给出独立同分布瑞利信道下的信道容量表达式： (59) 其中 ，注意 为正定阵，在(45)的基础上运用阿达玛不等式，可进一步得到遍历化信道容量的上界： (60) 上述不等号取等的充要条件是 为对角阵。利用 和低维符号矩阵的正交性： ， 为对角阵等效于 为对角阵。对式(21)提出的构造，经计算可得： (61) 其中 ， 的定义与(23)式中相同。这就证明了(21)式提出的构造在天线数M趋向于无穷时能渐进地达到上界，根据引理4，对式(28)中提出的OP矩阵也有同样的结论。将(61)式代入(60)式，我们有： (62) 根据(48)式，容易看出 时的STBC全向编码信道容量优于 时的情形。另一方面，由于 且有 (引理3)，显然采用全向编码后将获得信道容量增益，且当天线数较大时尤其明显。 引理3：利用文献 [ 16 ] 的结果，对二次高斯和函数 ，有： (63) 其中 ， 表示勒让德符号，当 互素， 。 引理4：式(28)中的构造能够满足遍历互信息量渐进地达到上界。 证明：只需考虑形如 形式的构造，因为 (64)(65) 其中第二个等号是由于在(28)式中 为恒模序列，第三个等号由 得到。这样，为满足 为对角阵，我们只需满足 为对角阵，而(28)式中的 为正交阵，即证。  在下行同步传输中，中断概率常被用来考察在一定用户速率要求下信噪比低于门限值的概率。在本文中，我们记门限值为 ，则第k( )个用户发生中断的中断概率的表达式为： (66) 其中 为基站端的发送功率。对(21)式提出的构造， 为一稀疏矩阵，满足： (67) 而 满足： 。利用文献 [ 17 ] 的结果，我们有： (68) 其中 ， ，P为给定的功率约束常数， 。 为 的N个特征值。为计算(68)式，我们给出一个引理： 引理5：见式(71)。 证明： (69) 其中： (70) 将(70)的结果代入(69)，则有： (71) 应用引理3的结果，首先对 作部分分式分解，设 中有 个不同的值 且其代数重数分别为： ，则： (72) 其中： (73) 由(68) (71) (72)式，可得系统中断概率的闭式表达： (74)"
"本部分我们将从误码率，遍历互信息量，中断概率，峰均比性能四个方面分析施加预编码矩阵后的系统性能。考虑OFDM系统下的理想扇区天线，每个扇区圆心角为120˚，阵元间隔为 ，其中 是电磁波波长。基站端的配置为具有 根天线的ULA阵列，由于用户端各用户的接收信号互相独立，我们设 。信道特征为独立同分布信道，各分量均为均值为0，方差为1的循环对称复高斯变量。 图2给出了不同信噪比条件下，无预编码、分别使用式(4)，式(21)，式(34)，式(39)所提出的编码情况下的误码率性能。码元速率设为1 bps/HZ。式(4)和(21)中循环位移阵的 ，ZC序列中参数 。式(4)中的矩阵 设为： (75) 由图2可知，在应用所提出的四种全向预编码后，系统的误码率性能均有所改善，其中(21)式OP矩阵能最大限度地降低误码率。 图2. 系统误码率仿真 图3给出了四种OP矩阵在天线数目增加时的遍历信道容量变化曲线，信噪比条件设定为 ，根据前述分析，为满足全向传输条件天线数至少应为4的倍数，故我们取 时的数据。由图可知，(21)，(34)，(39)中的OP矩阵均能在天线个数足够大时渐进地逼近信道容量上界，这与理论分析的结果是一致的。 为比较所提出编码的峰均比性能，我们引入互补累积分布函数(CCDF)，其定义为PAPR超过一定数值PAPR 0 的概率，即： (76) 分别考察使用4种不同OP矩阵情况下的峰均比，对每种构造，采用本身具有较低峰均比的DFTS-OFDM QPSK调制方式与式(19)中提出的编码方式相对比。由图4可知，使用式(19)提出的调制编码方式对连续角度的OP矩阵PAPR优化较明显，对式(34)，(39)中的OP矩阵，其在 时对应的信噪比门限值较之DFTS-OFDM QPSK调制情况分别减少约0.7 dB和1.2 dB。 图5给出了信噪比 情况下，四种OP矩阵在天线数目变化时的中断概率曲线。式(66)中的门限值设为 。由图容易看出 时的系统中断概率明显优于 时的情形，且当天线数目增长时四种构造的中断概率均能较快地收敛于下界，而(21)式中提出的编码中断概率性能最优。"
"本文主要研究了大规模MIMO系统下使用联合预编码-STBC编码情况下的下行链路同步传输。我们从离散角度域和连续角度域分别讨论了全向STBC编码的构造，对 ， 时的常用STBC编码，我们分别提出了全向编码的构造实例，并给出了联合设计低维传输符号的方法，其能够满足：接收端各用户获得相同的传输功率。基站端各天线PA利用率最大化。当 时，所提出的编码能够使4个低维传输符号被分组独立地设计。随后，我们进一步将 时的构造推广到了复信号的OSTBC编码。在性能分析部分中，我们分别推导了误码率与中断概率的闭式解，同时我们给出了天线数目增加时遍历化信道容量的上界以及为渐进地逼近上界，预编码矩阵所需满足的条件。我们还分析了经过预编码矩阵映射 图3. 天线数量变化时遍历互信息量仿真 图4. 不同编码与调制方式下的峰均比仿真 图5. 天线数目变化时系统中断概率仿真 后系统峰均比的变化情况，给出了OFDM系统下保持原发送信号峰均比的预编码矩阵的一个充分条件。在连续角度域，我们从全向传输，最大化PA利用率和保持满分集增益三个方面重新推导了预编码矩阵满足的条件，在 和 的情况下，利用相位互补序列分别给出了构造方法。在性能仿真部分，我们从误码率、峰均比、信道容量、中断概率四个方面分别进行了详尽的仿真，结果证明：所提出的四种预编码矩阵均能有效降低误码率。式(21)，(61)，(66)提出的编码均能渐进地逼近信道容量上界。式(19)中给出的联合设计低维传输符号的方法能有效降低系统的峰均比，且其针对连续角度的编码优化较明显。式(21)中提出的预编码矩阵具有最佳的性能，其在误码率，信道容量，中断概率的仿真中均为最优。最后，本文的研究仍可以进一步拓展，例如使用二维阵列天线(UPA)情形下的预编码矩阵构造，以及使用预编码矩阵后的接收译码方案等仍有待进一步研究。"
