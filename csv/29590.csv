"为了保证对燃气轮机的性能与故障进行精准的描述及诊断，建立精确的燃气轮机模型便起到关键作用。燃气轮机处于变工况条件下，其模型计算准确性取决于燃气轮机各部件(压气机与透平)特性的精度。为保证获得燃气轮机模型特性的精度，本文建立一种改进的遗传算法与自适应技术对燃气轮机的特性进行获取。采用自适应遗传算法(AGA)和灰度预测(GM)相结合的方法，对部件特向修正因子进行优化，保证在获得最优的燃气轮机特性的同时，能提高遗传算法的收敛速度。 关键词 :燃气轮机，自适应遗传算法，灰度预测，建模仿真 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"燃气轮机模型是燃气动力系统中的关键环节，因此燃气轮机模型的准确度直接影响动力系统仿真、故障诊断、检测控制等工作的质量与效率。同时燃气轮机是一种非线性强、时变性高、构成复杂的气动热力系统，因此如何建立高精度的燃机轮机数学模型是燃气动力系统仿真研究的热点问题 [ 1 ] 。 燃气轮机由压气机、燃烧室、涡轮、附属设备及机匣等组成，其中压气机、涡轮又可根据压力、气动结构等细分为高、低压压气机、高、低压涡轮和动力涡轮，而燃气轮机中的压气机、涡轮以及附属系统中的燃油系统、引气系统等均为强非线性、动态部件，因此自适应控制建模的关键是对以上部件特性参数进行合理的预测与校正。段守付等 [ 2 ] 通过改进的加权函数自适应建模方法对部件特性参数进行校正。谢光华等 [ 3 ] 运用改进的共轭梯度算法对部件特性参数进行校正。陈玉春等 [ 4 ] 根据实验测量参数合理选择部件特性修正因子并通过部件特性删除法求解部件特性修正因子。王永华等 [ 5 ] 通过在数学模型中引入压力比函数Ｚ和辅助参数β，对部件特性进行自适应修正。Li YG等 [ 6 ] 采用遗传算法对燃气轮机进行了自适应建模，并研究自适应参数的敏感度和自适应的鲁棒性。刘永葆等 [ 7 ] 用测量基数、部件匹配、测量参数相关性、以及传感器测量精度等四个因素对部件特性修正，从而进一步改进了遗传算法，提高了算法的收敛精度与速度。 获得最优解的方法从传统的优化算法(如线性规划的单纯形法，非线性规划的基于梯度的各类迭代算法)改进到现代智能算法(如粒子群寻优算法、遗传算法)，不但在寻优方法上不断获得突破，同时在目标函数构造上也不断改进，通过设定合理的加权，使得目标函数更加合理 [ 8 ] 。 智能算法的引入使得能够实现参数更多的多目标优化，对初值不敏感，限制条件更加宽松，但是也带来了计算耗费资源较重，计算时间较长的缺点。因此如果能够合理地预测最优解的取值空间，对智能算法中的限制条件进一步进行限制，则能够缩短最优解的解算时间，同时也能一定程度提高最优解的精度。本文建立一种改进的遗传算法与自适应技术对燃气轮机的特性进行获取。采用自适应遗传算法(AGA)和灰度预测(GM)相结合的方法(本文设定为GM-AGA算法)，对部件特向修正因子进行优化，保证在获得最优的燃气轮机特性的同时，能提高遗传算法的收敛速度。"
"由于通过实验来获取燃气轮机部件特性耗费昂贵、周期长，因此不可能对每台燃气轮机进行特性实验，但是可以根据同一型号燃气轮机，其特性相近的情况，用已知改型燃气轮机装置的通用标准特性建立数学模型，在根据所研究的特定燃气轮机装置实际运行的有关测量参数，对模型中的部件特性进行修正，以达到获取精确的燃气轮机数学模型，这种方法就是燃气轮机部件的自适应建模 [ 9 ] 。 在数学模型中发动机目标参数Y可通过函数用部件特性参数数据X、输入参数Uin及环境参数Uam表示： Y = f ( X , U i n , U a m ) (1-1) 其中部件特性参数X可由解析式获图标法获得。但由于部件特性参数是由通用特性数据获得，因此与实测数据存在偏差e。用Xact表示部件的真实特性，用Xcal表示部件通过通用特性获得的特性，定义修正因子M，则M计i算如式(2)所示： M = X a c t X c a l (1-2) 将式(2)代入式(1)中可得修正后的数学模型； Y = f ( X , U i n , U a m ) (1-3) 根据数学模型的需求将需要修正的一系列部件特性参数的修正因子设为 M i ( i = 1 , 2 ⋯ ⋯ n ) ，为了获得最优的M i 解，需要通过构造特定的数学模，因此设发动机试车平台中能够实测的参数值为 C a i ( i = 1 , 2 ⋯ ⋯ n 1 ) ，对应的模型计算出的参数值为 C c i ( i = 1 , 2 ⋯ ⋯ n 1 ) ，求解发动机模型平衡方程产生的残量为 e r r i , ( i = i = 1 , 2 ⋯ ⋯ n 2 ) ，则建立函数F如下： F = ∑ i = 1 n 1 ( C a i − C c i ) 2 + ∑ i = 1 n 2 ( e r r i ) 2 (1-4) 能够使F值最小的M i 解则为最优解。 获得最优解的方法 获得最优解的方法从传统的优化算法(如线性规划的单纯形法，非线性规划的基于梯度的各类迭代算法)改进到现代智能算法(如粒子群寻优算法、遗传算法)，不但在寻优方法上不断获得突破，同时在目标函数构造上也不断改进，通过设定合理的加权，使得目标函数更加合理 [ 10 ] 。"
"造成单个个体燃气轮机部件的特性与通用特性的差异的原因有多方面，例如生产中几何尺寸的偏差，使用环境与测试环境的偏差以及在使用过程中的零部件的损耗等。由于根本无法获得完整的信息能够保证将造成偏差的所有原因都进行量化并形成合理的修正系数，因此为了能够有效合理的预测部件特性的修正因子，本文引入简单 G M ( 1 , 1 ) 灰度预测模型 [ 11 ] 。 根据文献 [ 12 ] ， G M ( 1 , 1 ) 模型定义为： x ( 0 ) ( k + 1 ) = a − 1 2 ( x ( 1 ) ( k ) + x ( 1 ) ( k + 1 ) ) + u (2-1) 其中， 为待定系数， X ( 0 ) 为原始数列： (2-2) 取2-2式中 x ( 0 ) ( i ) = M i ，对 X ( 0 ) 进行一次累加，得到新数列： X ( 1 ) = { x ( 1 ) ( 1 ) , x ( 1 ) ( 2 ) , ⋯ ⋯ , x ( 1 ) ( n ) } (2-3) 其中 x ( 1 ) ( k ) = ∑ i = 1 k x ( 0 ) ( k ) 。 构造矩阵： (2-4) ∅ = [ a , u ] T 为待辨识参数向量，则(2-1)可写成： Y = B * ∅ (2-5) 参数向量 ∅ 可用最小二乘法求取，即 (2-6) 把求取的参数代入(2-1)式，并求出其近似时间响应式为： x ^ ( 1 ) ( k + 1 ) = a x ( 1 ) ( k ) − u ^ a ^ e − a ^ k + u ^ a ^ (2-7) 累减还原为： x ^ ( 0 ) ( k + 1 ) = x ^ ( 1 ) ( k + 1 ) − x ^ ( 1 ) ( k ) = ( 1 − e a ^ ) x ^ ( 1 ) ( k ) − x ^ ( 1 ) e − a ^ k (2-8) x ^ i ( 0 ) ( k + 1 ) 即为预估的部件修正因子 。取 ( ± 10 % + 1 ) M ^ i 为遗传算法中的种群空间进行进一步优化求解。  遗传算法(GA)是一类借鉴生物界的进化规律(适者生存，优胜劣汰遗传机制)演化而来的随机化搜索方法。它是由美国的J. Holland教授1975年首先提出，其主要特点是直接对结构对象进行操作，不存在求导和函数连续性的限定；具有内在的隐并行性和更好的全局寻优能力；采用概率化的寻优方法，能自动获取和指导优化的搜索空间，自适应地调整搜索方向，不需要确定的规则。遗传算法的这些性质，已被人们广泛地应用于组合优化、机器学习、信号处理、自适应控制和人工生命等领域。 简单遗传算法局部搜索能力不强，容易陷入局部最优解，且进化运算的后期速度比较慢。因此可引入自适应机制 [ 10 ] ，形成AGA算法，AGA旨在通过以不同的方式实现搜索和随机性之间的权衡，根据适合度值自适应地改变Pc和Pm的值，当群体倾向于停留在局部最优时(也就是群体适应度集中，多样性比较差时) Pc和Pm的值增加，并且当群体在解空间中散布时(也就是群体适应度分散，多样性比较高时)减小。所以需要一个针对Pc和Pm的计算公式如下所示，让其符合动态变化。 P c = { K 1 f max − f ′ 1 f max − f avg , f ′ ≥ f avg K 3 , f ′ < f avg (2-9) P m = { K 2 f max − f ′ 2 f max − f avg , f ′ ≥ f avg K 4 , f ′ < f avg (2-10) f max ，群体中的最大适应值f max ，群体中的最大适应值，f avg ，群体平均适应值f avg ，群体平均适应值， f ′ 1 要交叉的两个个体中较大的适应值， f ′ 2 要变异个体的适应值，K 1 ，K 2 ，K 3 和K 4 是常数。 至此本文中燃气轮机自适应建模流程如图1所示。 图1. 燃气轮机自适应建模流程"
"本文的研究对象为某型单轴带回热燃气轮机，该燃气轮机装置结构示意图如图2所示。图1中，各个截面用0~6这7个阿拉伯数字表示：0表示大气环境，1表示压气机进口截面，2表示压气机出口截面，3表示回热器冷端进口与热端出口截面，4表示回热器冷端出口热端进口截面，5表示燃烧室出口(涡轮进口)截面，6表示涡轮出口截面，对该型燃气轮机，其部件特性采用6个修正因子，见表1所示。 根据划分的7个截面中描述每个截面气动特性的参数需求，确定共需要9个测量参数，分别为：转子转速n、压气机进口流量G1、压气机出口温度T1、压气机出口压力P1、回热器冷端出口温度T2、燃烧室出口温度T3、涡轮出口温度T4、涡轮出口压力P2、回热器热端出口温度T5 [ 13 ] 。 3个输入参数分别为：环境温度T0、环境压力P0、燃油质量流量G2；1个平衡检验误差参数为：轴功率平衡误差e。 适应度F的定义为 [ 7 ] ： F = 1 1 + F c (3-1) Table 1 部件名称 修正因子 压气机 M 1 = η c a c t η c c a l M 2 = G c a c t G c c a l 换热器 M 3 = η e a c t η e c a l 燃烧室 M 4 = η b a c t η b c a l 涡轮 M 5 = η t a c t η t c a l 表1. 修正因子 图2. 单轴回热燃气轮机结构图 (3-1)式中 F c 由式(1-4)获得，由于式(1-4)中的定义可知函数 F c 为正数，随着M i 逐步优化， F c 逐步减少，适应度F逐步增大，适应度极值等于1。 首先获得每个测量参数的多组测量数据，由测量数据计算每次测量的修正因子集 X ( 0 ) 作为原始数列，根据本文2.1章节中所述的 G M ( 1 , 1 ) 模型获得预测的修正因子 M ^ i ( i = 1 , 2 , ⋯ ⋯ n ) 。取 ( ± 10 % + 1 ) M ^ i 为自适应遗传算法中的种群空间。 根据自适应建模原理，运用自适应遗传算法(AGA)编程．其中GM-AGA算法种群空间设为 ，AGA遗传算法种群空间设为通用形式，两种算法的其他参数设置如下：最大进化代数为100，种群规模为20，染色体的选择方法为轮盘赌法，编码方式为浮点法，自适应交叉和变异机制中K 1 = 0.8，K 2 = 0.6，K 3 = 0.005，K 4 = 0.002。 燃气轮机设计工况点的自适应建模结果见表2所示。在收敛精度方面，优化前的相对误差最大值约为−1.357%，AGA算法的最大误差约为−0.879%，GM-AGA的最大误差约为−0.604%；而目标函数 F c 由0.144%下降到0.0224%，改进后的自适应遗传算法效果较理想。在收敛的速度方面，收敛时间由0.537下降到0.235 s，耗时减小了约56%，改进后的算法收敛速度大大提高。由表2可知，相对于AGA算法进行自适应建模而言，GM-AGA算法进行的自适应建模效果更好。 Table 2 参数 优化前误差/% 优化后误差/% AGA算法 GM−AGA算法 n 0 0.699 −0.299 G1 −0.449 −0.426 0.314 T1 −0.550 −0.133 0.194 P1 −1.010 −0.0665 −0.217 T2 −0.942 −0.879 −0.101 T3 −1.357 −0.857 −0.604 T4 0.604 0.541 −0.142 P2 −0.628 0.553 0.221 T5 −1.036 −0.208 0.369 e 0.307 0.345 −0.191 F c 0.144 0.0460 0.0224 收敛时间 ------ 0.537 0.235 表2. 设计工况点计算值与测量值相对误差"
"本文结合实际工程应用提出了灰度预测机制，综合考虑单个部件因制造、使用及环境等因素导致的特性偏差，进而将遗传优化算法的种群空间进一步合理收缩．改进的自适应遗传算法能很快接近最优解。但是该算法也存在以下几个问题需要进一步进行研究：一是可能存在不合理的缩小种群空间导致只能获得局部最优；二是本算法未与其他改进的自适应遗传算法进行对比，其优势有待进一步进行评估；三是试验数据可能会对算法的精度产生较大的影响，需要进一步研究试验数据质量对算法影响程度。"
