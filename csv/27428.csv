"针对涪陵页岩气田焦石坝区块试验井组PCS系统不能直接与后期开发井组采用的SCADA系统纳入统一平台进行集中监控的问题，提出了借助第三方OPC服务器整合PCS系统与SCADA系统的通信方案，探讨了KEP Server与PLC及SCADAvantage Explorer与KEPServerEX的通信配置与实现方法，并以Visual Studio 2013软件为主设计了人机交换界面。运行表明：采用该方案可有效完成试验井组生产过程数据与SCADA系统的信息交换，目前在涪陵页岩气田实现了33个集气站和15个井口采气平台无人值守生产。 关键词 :页岩气，KEPServerEX，SCADA系统，通信技术 Copyright © 2018 by authors, Yangtze University and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"SCADA系统是近年来在电力、天然气站等领域广泛应用的数据采集和监控系统 [ 1 ] ，除了能完成传统的数据采集和监控功能外，其提供的信息平台有利于实现企业数字化管理，提高科学管理水平，因而也获得涪陵页岩气田的青睐，目前正在页岩气集气站推广应用。而涪陵焦石坝区块试验井组于2013年前期建成的以西门子S7-300为核心的集气站PCS过程控制系统，旨在提高集气站的自动化水平，降低工人劳动强度，经过几年的生产运行表明：该PCS过程控制系统达到当初设计要求，但信息化程度稍差，不能直接与后期开发井组采用的SCADA系统纳入统一平台进行集中监控，因而亟需将前期试验井组的PCS系统进行整合以便纳入统一平台进行集中监控与管理。 随着涪陵页岩气田生产管理要求的不断提升及后期开发井组的增多，油气田生产指挥管理对信息技术提出了更高要求，需要兼容更强、平台更广的SCADA系统。SCADA系统的实时数据库系统支持Modbus协议、OPC协议，能够接入智能仪表的数据，但不支持西门子S7-300 TCP/IP协议，无法与试验井组的西门子S7-300冗余PLC系统直接通讯。笔者研究采用KEPServer实现对工业现场西门子S7-300的生产过程数据进行采集汇总，并上传至SCADA实时服务器，最终用Visual Studio 2013软件制作HMI画面进行数据实时监控。"
"KEPServerEX是第三方OPC服务器，为连接、管理、监控和控制各种自动化设备和软件应用提供了灵活的和可扩展的解决方案，支持OPC、专有的通信协议、API以及各种自动化系统接口 [ 2 ] 。配置KEPServerEX是与PLC通信的关键步骤，目的就是在KEPServerEX中建立一个OPC Server [ 3 ] ，为OPC客户端和需要读写PLC地址位之间建立连接。"
"图1为涪陵焦石坝区块试验井组PCS系统数据通讯及人机界面流程，现场仪表如压力变送器、温度变送器、切断阀的关断等信号通过数字或模拟信号传输至西门子S7-300 PLC控制器，PLC控制器及智能仪表分别通过Siemens TCP/IP协议和Modbus TCP/IP协议传送至集气站站控系统里。以力控软件为基础开发的上位机软件对集气站站内数据进行实时监控，调控中心电脑客户端也可以借助网络对力控画面进行实时监控。 图1. 试验井组PCS系统数据通讯及人机界面流程 如前所述，试验井组PCS系统不能直接与SCADA系统纳入统一平台进行集中监控，究其原因是因为西门子S7-300与基于ABB PLC的SCADA系统采用了不同的通讯协议所致。由于KEPServerEX支持各种专有通信协议以及各种自动化接口，因而借助第三方OPC服务器便可建立PCS系统与SCADA系统的联系，如图2所示。 KEP Server OPC服务器通过交换机直接从S7-300及智能仪表中读取其现场仪表的数据。数据采集成功后直接存入SCADA服务器中，交由上位机服务器上通过C # 编写的后台服务做处理，最终通过Visual Studio 2013制作HMI画面，实现对页岩气现场仪表数据的实时监控。 图2. 通讯系统整合方案及人机界面流程"
"采用KEP Server软件通过以太网TCP/IP通信协议使基础自动化系统的数据整合到SCADA系统中。示例系统主要采集焦石坝页岩气1号集气站的数据，由于控制器件使用通讯协议不同，故分成2组数据。JQZ01-Modbus组和JQZ01-PCS组。分别代表智能仪表使用Modbus TCP/IP Ethemet协议和Siemens TCP/IP Ethemet协议。实现KEPServerEX与PLC的通信，首先需要对所要连接的PLC设备进行授权获得该设备驱动的使用；然后在KEPServerEX中建立OPC服务器。步骤如下：① 点击“Click to add a channel”，根据所要连接的设备选择 设备驱动类型，建立一个New Channel；② 依据所用设备的型号以及所接模块的属性信息建立Device；③ 为建立的Device创建所有需要的Tag [ 4 ] ，系统所需全部数据一部分从PLC采集，另一部分从智能仪表采集，对各种需要采集的数据，先从PLC和智能仪表里查找出对应点的存储地址、点位描述、数据类型、线性转化等信息。并根据KEPServerEX符号编码规则，编制出每一个数据的编码，相应地写在每一个Tag里面。当1 # 集气站所有Tag建立好后，通过SCADAvantage服务器作为客户端读取KEP Server OPC服务器内数据。  SCADAvantage Explorer软件用于配置SCADAvantage系统。首先通过在巡检站SCADA系统及调控中心SCADA系统分别安装KEPServerEX软件和SCADAvantage Explorer软件，KEPServerEX软件读取现场PLC系统和智能仪表实时数据；然后通过SCADAvantage服务器里面的SCADAvantage OPC服务器读取Kepserver OPC服务器内数据；最后通过SCADAvantage Explorer软件进行组态显示数据。对SCADAvantage Explorer软件配置如下：① 打开软件点击里面的System在其配置启动时需要运行可执行文件名及路径；② 配置Network，在Communication选择OPCNetwork，实现与OPC服务器通讯；③ 配置Device，在Communication建立OPC Device为JQZ01PCS，设备地址为Kepware.KEPServerEX.V6；④ 配置数据点，在Telemetry中根据实际变量依次添加Analog Point和Digital Point；⑤ 配置报警，ABB人机界面的报警均来自SCADAvantage的设置，因此需要在服务器数据库中完成报警组和报警上下限以及颜色的设置。  根据设计需求应用Visual Studio 2013软件制作HMI画面，应用C#服务读取SCADAvantage Explorer软件数据，实行对现场数据实时监控。1 # 集气站人机交换界面如图3所示。 图3. 1 # 集气站人机交换界面"
"整合后的SCADA系统采用3级控制方式 [ 5 ] 。第1级为调控中心控制级，通过SCADA系统进行远程监控，实现生产统一调度管理；第2级为站场控级，通过PCS、ESD、RTU或脱水站站控系统实现；第3级为就地控制级，由现场仪表、控制阀门等设施实现。该系统经过1年多的运行表明，各子系统间通讯可靠，显示、控制及时，整体性能稳定，达到设计要求。依靠该系统，涪陵页岩气田目前实现了33个集气站和15个井口采气平台无人值守生产，易于得到用户进行决策所需要的各种报表及趋势图，极大地提升了油气田自动化、数字化程度及科学决策水平。"
