"设 φ ( n ) 为欧拉函数，本文将应用Selberg-Delange方法研究 φ ( n ) 及 g ( n ) = φ ( n ) n 的均值问题并得到了一个较好的主项。"
"若自然数 n ≥ 1 ，欧拉函数 φ ( n ) 表示不超过 n 且和 n 互素的正整数的个数。众所周知 ∑ d | n φ ( d ) = n ， 由Mӧbius变换有 φ ( n ) = ∑ d | n μ ( d ) n d ， 由此 φ ( n ) 也可以表示为遍历 n 的不同素因子的乘积的形式，即 φ ( n ) = n ∏ p | n ( 1 − 1 p ) . 我们记 ∑ n ≤ x φ ( n ) = M ( x ) + R ( x ) . Dirichlet证明了对于任意的 ε > 0 ， M ( x ) = x 2 2 ζ ( 2 )   ,   R ( x ) = O ( x 1 + ε ) . 1874年，F. Mertens [ 1 ] 进一步得出以下结论： R ( x ) = O ( x log x ) . 我们在很多数论相关的书里可见到该结论的证明(例 [ 2 ]，定理330)。1963年，Walfisz [ 3 ] 改进了余项： R ( x ) = O ( x log 2 3 x ( log log x ) 4 3 ) . 若令 g ( n ) = φ ( n ) n ，可以得到： ∑ n ≤ x g ( n ) = J ( x ) + E ( x ) ， 其中 J ( x ) = x ζ ( 2 ) ， E ( x ) ≪ log x 。1987年，Montgomery [ 4 ] 明确给出了 R ( x ) 和 E ( x ) 的关系，即 R 0 ( x ) = R ( x ) x + O ( exp ( − c log x ) ) ， 其中 c > 0 是绝对常数。这改进了Pillai和Chowla [ 5 ] 以及Erdös和Shapiro [ 6 ] 先前的结果。 本文利用Selberg-Delange方法研究 g ( n ) 和 φ ( n ) 在长区间上的均值问题，并得到了较好的主项，结果如下： 定理1 D ( s ) : = ∑ n = 1 ∞ g ( n ) n s 和 F ( s ) : = ∑ n = 1 ∞ φ ( n ) n s 是 P ( z ; c 0 , δ , M ) 型Dirichlet级数( P 型级数的定义参见第二部分)。对 x ≥ 3 ， N ≥ 0 ， A > 0 ， | z | ≤ A 有 ∑ n ≤ x g ( n ) = x { ∑ k = 0 N λ k ( z ) ( log x ) k + O ( M ( c 6 N + 1 log x ) N + 1 ) }   (1) ∑ n ≤ x φ ( n ) = x 2 { ∑ k = 0 N λ k ( z ) ( log x ) k + O ( M ( c 7 N + 1 log x ) N + 1 ) } (2) 其中正常数 c 6 ， c 7 以及 O 符号中的隐含常数至多依赖于 c ， δ 和 A 。 基于对式(1)，(2)主项的观察可以发现，本文结果的主项较 J ( x ) 和 M ( x ) 更为精细，它是关于 1 / log x 的 N 次多项式，而 N 可取任意自然数。"
"符号说明： A ≥ 0 ， M > 0 ， c > 0 ， 0 < δ ≤ 1 是一些常数， ε 是任意小的正常数， s = σ + i τ ， σ , τ 为实数， φ ( n ) 为欧拉函数， Γ ( s ) 为伽马函数， ζ ( s ) 是Riemann Zeta函数。 由de la Vallée-Poussin [ 7 ]，存在正常数 c ，使得 ζ ( s ) 的非零区域 K ′ 为 σ ≥ 1 − c / ( 1 + log + | τ | ) ， 其中 log + | τ | = max { 0 , log τ } ，我们用 K 表示区域 K ′ 除去实线段 [ 1 − c , 1 ] 后得到的单连通区域。 定义1 设 z ∈ ℂ ， c > 0 ， 0 < δ ≤ 1 ， M > 1 ， f ( n ) 是一个数论函数，其对应的Dirichlet级数为 F ( s ) : = ∑ n = 1 ∞ f ( n ) n s . 若Dirichlet级数 G ( s , z ) : = F ( s ) ζ ( s ) − z 在 K ′ 上可延拓为全纯函数且在其上满足上界估计 | G ( s , z ) | ≤ M ( 1 + | τ | ) 1 − δ ， 则称级数 F ( s ) 具有性质 P ( z ; c , δ , M ) 。 在 G ( s ; z ) 的全纯区域中，其 k 阶偏导为 G ( k ) ( s ; z ) = ∂ k ∂ s k G ( s ; z ) ， 及 λ k ( z ) : = 1 Γ ( z − k ) ∑ h + j = k 1 h ! l ! G ( h ) ( 1 ; z ) γ j ( z ) . 考虑到 φ ( n ) 和 g ( n ) 对应的Dirichlet级数与 ζ ( s ) 的关系， s = 1 是 ζ ( s ) 的一阶极点，定义函数 Z ( s ; z ) : = { ( s − 1 ) ζ ( s ) } z s ， 我们有 引理1 函数 Z ( s ; z ) 在圆盘 | s − 1 | < 1 上全纯，具有Taylor展式 Z ( s ; z ) = ∑ j = 0 ∞ 1 j ! γ j ( z ) ( s − 1 ) j (3) 其中 γ j ( z ) 是 z 的整函数，对任意的 A > 0 ， ε > 0 满足上界估计 1 j ! γ j ( z ) ≪ A , ε ( 1 + ε ) j    ( | z | ≤ A ) . (4) 证明：参见 [ 8 ] 中定理II.5.1。 引理2 存在正常数 c ，使得对 | τ | > 3 及 σ ≥ 1 − c / log | τ | 有 | log ζ ( s ) | ≤ log log | τ | + O ( 1 ) . 证明：参见 [ 8 ] 中定理II.3.16。 引理3 设 H 为Hankel围道，对每个 X > 1 ，令 H ( X ) 为Hankel围道在半平面 σ > − X 的部分，那么对 z ∈ ℂ 一致地有 1 2 π i ∫ H ( X ) s − z e s d s = 1 Γ ( z ) + O ( 47 | z | Γ ( 1 + | z | ) e − X 2 ) . 证明：参见 [ 8 ] 中推论II.5.2.1。"
"由欧拉函数 φ ( n ) 是乘性函数(见 [ 9 ] )，有 F ( s ) = ∑ n = 1 ∞ φ ( n ) n s = ∏ p ( 1 − 1 p s ) ( 1 + 1 p s − 1 + 1 p 2 ( s − 1 ) + ⋯ ) = ζ ( s − 1 ) ζ ( s )             ( σ > 2 ) . 同理可得 D ( s ) = ∑ n = 1 ∞ g ( n ) n s = ζ ( s ) ζ ( s + 1 )                         ( σ > 1 ) . 我们先证明定理中的式(1)。 D ( s ) = ζ ( s ) G ( s ; z ) 在区域 K 内全纯，且 G ( s ; z ) = 1 ζ ( s + 1 ) ，由于 σ − 1 σ ≤ | ζ ( s ) | ≤ σ σ − 1                 ( σ > 1 ) ， 我们有 | G ( s ; z ) | = | 1 ζ ( s + 1 ) | ≤ σ + 1 σ ≤ M ( 1 + | τ | ) 1 − δ                       ( s ∈ K ) . (5) 从而级数 D ( s ) 具有性质 P ( z ; c , δ , M ) 。 在 s ∈ K 上有解析延拓 ζ ( s ) z = s Z ( s , z ) ( s − 1 ) − z . 取 z = 1 ，我们有 ζ ( s ) = s Z ( s ; 1 ) ( s − 1 ) − 1 . 另外由引理2的上界估计可得，对任意常数 A > 0 ，有 ζ ( s ) ≪ A ( 1 + log + | τ | ) A    ( | z | ≤ A , s ∈ K , | s − 1 | ≫ 1 ) ，(6) 由(5)和(6)知对 | z | ≤ A ， s ∈ K ， | s − 1 | ≫ 1 一致地有 D ( s ) ≪ M ( 1 + log + | τ | ) A ( 1 + | τ | ) 1 − δ ≪ A , δ M ( 1 + | τ | ) 1 − δ 2 . (7) 令 A ( x ) : = ∑ n ≤ x g ( n ) ，由Perron公式有 ∫ 0 x A ( t )   d t = 1 2 π i ∫ κ − i ∞ κ + i ∞ D ( s )   x s + 1 d s s ( s + 1 ) ， 其中 κ = 1 + 1 log x 。取 T > 1 为待定参数，令 Γ 是包括以下三部分的Hankel围道： 1) 以 s = 1 为圆心， r = 1 / ( 2 log x ) 为半径，并且除去点 s = 1 − r 的圆， 2) 由 1 − c 2 到 1 − r 的线段，幅角 θ = − π ， 3) 由 1 − r 到 1 − c 2 的线段，幅角 θ = π 。 σ ( τ ) 是 0 ≤ τ ≤ T 及 − T ≤ τ ≤ 0 上的曲线 σ ( τ ) : = 1 − 1 2 c / ( 1 + log + | τ | ) 。由留数定理，可将积分线段 [ κ − i T , κ + i T ] 转化成 Γ ∪ σ ( τ ) ∪ [ σ ( T ) ± i T , κ ± i T ] . 我们利用(7)可算得 [ κ ± i T , κ ± i ∞ ] 及 [ σ ( τ ) ± i T , κ ± i T ] 上的贡献 ≪ A , δ M x 2 T − δ 2 。事实上， I 1 : = 1 2 π i ∫ κ + i T κ + i ∞ D ( s ) x s + 1 d s s ( s + 1 ) ≪ A , δ ∫ T ∞ M ( 1 + | τ | ) 1 − δ 2 x 1 + κ d τ | κ + i τ | | κ + 1 + i τ | ≪ A , δ M x 2 T − δ 2 , I 2 : = 1 2 π i ∫ σ ( T ) + i T κ + i T D ( s ) x s + 1 d s s ( s + 1 ) ≪ A , δ ∫ σ ( T ) κ M ( 1 + | τ | ) 1 − δ 2 x σ + 1 d σ | σ + i T | | σ + 1 + i T | ≪ A , δ M T − 1 − δ 2 x 2 . 下面计算曲线 σ = σ ( τ ) 的贡献， I 3 : = 1 2 π i ∫ σ ( τ ) + i τ D ( s ) x s + 1 d s s ( s + 1 ) ≪ A , δ M ∫ σ ( τ ) + i τ ( 1 + | τ | ) 1 − δ 2 x σ ( T ) + 1 d τ τ 2 ≪ A , δ M x σ ( T ) + 1 ∫ 0 T τ 1 − δ 2 d τ τ 2 ≪ A , δ M x 2 T − δ 2 , 取 T = exp ( c δ − 1 log x ) ，则对 x ≥ x 0 有 T − δ 2 = exp ( − c δ 4 log x ) = exp ( − c 1 log x ) ， 综上所述有 I 1 + I 2 + I 3 ≪ A , δ M x 2 exp ( − c 1 log x ) ， 于是 ∫ 0 x A ( t ) d t = Φ ( x ) + O A , δ ( M x 2 e − c 1 log x ) ， 其中 Φ ( x ) : = 1 2 π i ∫ Γ D ( s ) x s + 1 d s s ( s + 1 ) . 易知道 Φ ( x ) 是 ℝ + 上关于 x 的无穷阶可微函数，我们有 Φ ′ ( x ) = 1 2 π i ∫ Γ D ( s ) x s s d s ， 对 s ∈ K ，有 D ( s ) = s G ( s ; z ) Z ( s ; z ) ( s − 1 ) − 1 ， 从而由(3)、(4)和(5)得 D ( s ) ≪ M | s − 1 | − A     ( s ∈ Γ ) . 当 s ∈ Γ 时， G ( s ; z ) Z ( s ; z ) 在 s = 1 处有Taylor展式： G ( s ; z ) Z ( s ; z ) = ∑ k = 0 ∞ g k ( z ) ( s − 1 ) k = ∑ h = 0 ∞ G ( h ) ( 1 ; z ) h ! ( s − 1 ) h ∑ l = 0 ∞ r l ( z ) l ! ( s − 1 ) l = ∑ k = 0 ∞ ( ∑ h + l = k 1 h ! l ! r l ( z ) G ( h ) ( 1 ; z ) ) ( s − 1 ) k , 于是 g k ( z ) = ∑ h + l = k 1 h ! l ! r l ( z ) G ( h ) ( 1 ; z ) = 1 k ! ∑ h + l = k ( k l ) r l ( z ) G ( h ) ( 1 ; z ) = Γ ( z − k ) λ k ( z ) . 而 G ( s ; z ) Z ( s ; z ) 全纯且在圆盘 | s − 1 | ≤ c 中为 O ( M ) ，由Cauchy公式可得到 g k ( z ) = 1 2 π i ∮ | s − 1 | = c G ( s ; z ) Z ( s ; z ) ( s − 1 ) k + 1 d s ≪ ∮ | s − 1 | = c M | s − 1 | k + 1 | d s | ≪ M c k             ( k ≥ 0 ) . 考虑到 Γ 包含于 | s − 1 | ≤ 1 2 c 中，我们有 ∑ k = N + 1 ∞ g k ( z ) ( s − 1 ) k ≪ ∑ k = N + 1 ∞ M c k | s − 1 | k ≪ M ( | s − 1 | c ) N + 1 ， 因此，对于 s ∈ Γ ， N ≥ 0 有 G ( s ; z ) Z ( s ; z ) = ∑ k = 0 N g k ( z ) ( s − 1 ) k + O ( M ( | s − 1 | c ) N + 1 ) . 从而 Φ ′ ( x ) = 1 2 π i ∫ Γ s G ( s ; z ) Z ( s ; z ) ( s − 1 ) − 1 x s s d s = ∑ k = 0 N g k ( z ) 1 2 π i ∫ Γ ( s − 1 ) k − 1 x s d s + 1 2 π i ∫ Γ O ( M ( | s − 1 | c ) N + 1 ) 1 s − 1 x s d s = 1 2 π i ∑ k = 0 N g k ( z ) ∫ Γ ( s − 1 ) k − 1 x s s − 1 s d s + O ( M c − N R ( x ) ) , (8) 其中 M c − N R ( x ) : = 1 2 π i ∫ Γ O ( M ( | s − 1 | c ) N + 1 ) 1 s − 1 x s d s ≪ M c − N − 1 ∫ Γ | s − 1 | N + 1 | ( s − 1 ) − 1 | | x s | | d s | ≪ M c − N ∫ Γ | s − 1 | N | x s | | d s | 因此 R ( x ) ≪ ∫ 1 − c 2 1 − r ( 1 − σ ) N x σ d σ + ∮ | s − 1 | = c r N x r cos θ + 1 | d s | ≪ ∫ c 2 r x 1 − t t N d ( − t ) + x 1 + r r N + 1 ≪ x ∫ r c 2 x − t t N d t + x ( 1 2 log x ) N + 1 . 令 u = t log x ，则 x − t = e − t log x = e − u ，有 R ( x ) ≪ x ( log x ) − N − 1 ∫ 1 2 c 2 log x e − u u N d u + x ( log x ) − N − 1 2 − N ≪ x ( log x ) − N − 1 Γ ( N + 1 ) ≪ x ( c 2 N + 1 log x ) N + 1 . 我们利用引理3来估计主项 Φ ′ ( x ) ，作变量代换 ω = ( s − 1 ) log x ，则 x s = x ω log x + 1 = x e ω ，有 1 2 π i ∫ Γ ( s − 1 ) k − 1 x s d s = x ( log x ) − k 1 2 π i ∫ H ( c 2 log x ) e ω ω k − 1 d ω = x ( log x ) − k { 1 Γ ( 1 − k ) + O ( 47 | 1 − k | Γ ( 1 + | 1 − k | ) e − 1 2 ⋅ c 2 log x ) } = x ( log x ) − k { 1 Γ ( 1 − k ) + O ( ( c 3 k + 1 ) k x − c 4 ) } . 于是 Φ ′ ( x ) = ∑ k = 0 N   g k ( z ) [ x ( log x ) − k { 1 Γ ( 1 − k ) + O ( ( c 3 k + 1 ) k x − c 4 ) } ] + O ( M c − N R ( x ) ) = ∑ k = 0 N   g k ( z ) x ( log x ) k 1 Γ ( 1 − k ) + ∑ k = 0 N   g k ( z ) x ( log x ) k O ( ( c 3 k + 1 ) k x − c 4 ) + O ( M c − N R ( x ) ) = x { ∑ k = 0 N λ k ( z ) ( log x ) k + O ( E N ) } + O ( M c − N R ( x ) ) , 其中 E N : = x − c 4 ∑ k = 0 N g k ( z ) ( c 3 k + 1 log x ) k ≪ M x − c 4 c 4 N ∑ k = 0 N k ! ( 5 c log x ) k ≪ M x − c 4 ( 5 c 4 c log x ) N ∑ k = 0 N N ! ( N − k ) ! ( 5 c log x ) k − N ≪ M ( 5 c 4 c log x ) N N ! x − c 20 ≪ M ( c 5 N + 1 log x ) N + 1 , 将其代入(8)得 Φ ′ ( x ) = x { ∑ k = 0 N λ k ( z ) ( log x ) k + O ( M ( c 5 N + 1 log x ) N + 1 ) } + O ( M c − N x ( c 2 N + 1 log x ) N + 1 ) = x { ∑ k = 0 N λ k ( z ) ( log x ) k + O ( M ( c 6 N + 1 log x ) N + 1 ) } . 证毕。 式(2)的证明与式(1)的证明类似，故在此做简要说明而不再赘述。由于 φ ( n ) 的Dirichlet级数可表为 F ( s ) = ζ ( s − 1 ) ζ ( s )             ( σ > 2 ) . 我们将用 H ( s ; z ) : = { ( s − 2 ) ζ ( s − 1 ) } z s 替换证明过程中的函数 Z ( s ; z ) ，它在 | s − 2 | < 1 上全纯，取 z = 1 , G ( s ; z ) = 1 ζ ( s ) ， κ = 2 + 1 log x ，证明过程可类似推出。"
