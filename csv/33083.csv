"本文以灰色预测为基础，结合马尔科夫模型，建立灰色马尔科夫预测模型。然后使用粒子群算法对参数进行优化，提高预测精度。将灰色模型和马尔科夫模型组合，用灰色模型得到时间序列数据的趋势，用马尔科夫模型使数据呈现出波动性，得到时间序列趋势预测。通过对外汇支出业务量的数据进行验证，结果表明：粒子群优化的组合预测模型即可得到时间序列数据的总体趋势，又可以使数据随着时间的变换呈现出变换的波动性，提高预测精度。优化的预测组合预测模型精度高于单一预测模型的精度。 关键词 :GM(1,1)，马尔科夫模型，粒子群，外汇支出，组合预测 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"预测是各国专家学者致力于研究的问题，根据各学科领域的不同，也提出了许多预测方法，时间序列分析法，回归分析法，神经网络预测法，灰色预测法和马尔科夫预测等。相比于其它预测模型，灰色预测模型所需要的数据量小等优点，但是对于具有随机波动性的数据，灰色预测呈现出预测精度低等问题 [ 1 ]。随着组合预测模型的提出 [ 2 ]，有效地提高了预测的精度。本文使用组合的灰色马尔科夫预测模型，并通过粒子群算法对其进行优化。以某市外汇业务支出量对模型进行验证。"
"灰色系统理论是由我国邓聚龙教授于20世纪80世纪初提出，已广泛应用于社会、经济、科技、农业、生态、生物等各个领域 [ 3 ]。其中GM(1,1)模型是灰色系统理论的核心模型。该模型是由一个变量的一阶微分方程构成。 设原始序列为 x ( 0 ) = { x ( 0 ) ( 1 ) , x ( 0 ) ( 2 ) , ⋯ , x ( 0 ) ( n ) } ，并且序列中的任何一项均不为负数。其中 ∀ x ( 0 ) ( k ) ∈ x ( 0 ) , k = 1 , 2 , ⋯ , n 。 对原始序列进行级比计算： σ ( k ) = x ( k − 1 ) x ( k ) , x ( k ) , x ( k − 1 ) ∈ x (2.1) 进而得到级比序列 σ = ( σ ( 2 ) , σ ( 3 ) , ⋯ , σ (n) ) 计算级比检验区间 σ ( 0 ) ( k ) ： σ ( 0 ) ( k ) ∈ ( e − 2 n + 1 , e 2 n + 1 ) (2.2) 判断级比是否落入检验区间，如果未落入，则对原始序列进行相应的数据变换，常见的变换方式：对数变换，方根变换和平移变换。对变换后的数据序列进行一次累加生成(AGO)，即将同一序列中数据逐次相加以生成新的数据。 即 x ( 1 ) = ( x ( 1 ) ( 1 ) , x ( 1 ) ( 2 ) , ⋯ , x ( 1 ) ( n ) ) ，其中： x ( 1 ) ( k ) = ∑ i = 1 k X ( 0 ) ( i ) , k = 1 , 2 , ⋯ , n (2.3) GM(1,1)的一阶线性微分方程为： d x d t + a x = b (2.4) 其中a为发展系数，a的大小和符号反应了 x ( 0 ) 和 x ( 1 ) 的发展态势，b为灰作用量。a和b可以通过最小二乘法求得。 u = [ a , b ] T = ( B T B ) − 1 B T Y (2.5) Y为数据向量： Y = ( X ( 0 ) ( 2 ) , X ( 0 ) ( 3 ) , ⋯ , X ( 0 ) ( n ) ) (2.6) B为构造矩阵，形式如下： B = [ − z ( 1 ) ( 2 ) 1 − z ( 1 ) ( 3 ) 1 ⋮ ⋮ − z ( 1 ) ( n ) 1 ] = [ − 1 2 [ x ( 1 ) ( 1 ) + x ( 1 ) ( 2 ) ] 1 − 1 2 [ x ( 1 ) ( 2 ) + x ( 1 ) ( 3 ) ] 1 ⋮ ⋮ − 1 2 [ x ( 1 ) ( n − 1 ) + x ( 1 ) ( n ) ] 1 ] (2.7) 于是得到预测模型： x ⌢ ( 1 ) ( k + 1 ) = ( x ( 0 ) ( 1 ) − b a ) e − a b + b a (2.8) 通过递减得到GM(1,1)预测模型的还原值： x ⌢ ( 0 ) ( k + 1 ) = x ⌢ ( 1 ) ( k + 1 ) − x ⌢ ( 1 ) ( k ) (2.9)  马尔科夫链是由俄国数学家马尔科夫提出，是一种时间离散状态的马尔科夫过程。未来状态的发生概率仅和当前系统状态有关，与系统过去状态无关。马尔科夫过程是根据现在的状态和状态转移概率，预测未来可能出现的状态 [ 4 ]。  通过GM(1,1)预测模型，计算真实值和预测值之间的相对误差，通过相对误差的范围进行状态区间的划分。状态区间为： E i = [ L i , H i ] 其中 H i , L i 分别为状态区间的上下限 [ 5 ]。  设序列 x t 在时间t的状态为 E i 的概率为 p ( x t = i ) ，若序列 x t 从 E i 状态转移到下一个时间状态 E j 的概率为 p i j ，则 p i j = p ( x t + 1 = j | x t = i ) 为从时刻t处于i状态到下一个时刻 t + 1 转移到j状态的概率。满足此条件的时间序列为马尔科夫链。 p i j 为在t时刻的一步转移条件概率 [ 6 ]。 由概率组成的矩阵称为概率矩阵。状态 E i 转移到状态 E j 的次数为 n i j ，状态 E i 的总次数为 N i ，状态 E i 到状态 E j 的概率为 p i j 。 p i j = n i j N i ， 0 < p i j < 1 ， ∑ i = 1 k P i j = 1 , ( j = 1 , 2 , ⋯ , n ) k步转移概率为： p i j ( k ) ( n ) = p { x t + k = j | x t = i } 所以k步转移概率矩阵为k步转移概率组成的矩阵。形式如下： p ( k ) = [ p 11 ( k ) p 12 ( k ) ⋯ p 1 n ( k ) p 21 ( k ) p 22 ( k ) ⋯ p 2 n ( k ) ⋮ ⋮ ⋱ ⋮ p n 1 ( k ) p n 2 ( k ) ⋯ p m n ( k ) ] 矩阵具有如下两个性质： ① 非负性： p i j ( k ) ≥ 0 ,   i , j = 1 , 2 , ⋯ , n ； ② 行元素和为1，即 ∑ j = 1 n p i j ( k ) = 1 ,   i = 1 , 2 , ⋯ , n 。 根据当前时刻所处的转态，利用一步转移概率矩阵对下一时刻进行预测。 P i j = max { P i 1 , P i 2 , ⋯ , P i k } 当前时刻t的状态为 E i ，则 t + 1 时刻转移到状态 E j ，状态j出现的概率最大，则为下一时刻的预测结果 [ 7 ]。  y = x ⌢ ( 0 ) ∗ ( 1 − 0.5 ( L i + H i ) ) (2.10)   粒子群算法(Particle Swarm Optimization, PSO)是一种仿生物集群进化算法，PSO由美国科学家James Kennedy和Russell Eberhart于上世纪90年代提出 [ 8 ]。 PSO算法首先初始化一群随机粒子，通过对局部最优解和全局最优解的不停迭代以得到最终结果。在迭代的过程中，粒子通过参考个体极值(pbest)和全局极值(gbest)来更新自己。粒子没有质量和体积，但是有自己的位置和速度，粒子的速度代表飞行的方向和距离，位置代表空间中的一个点。在一个D维搜索空间，N个随机粒子的群体中，第i个粒子的空间位置为 x i = ( x i 1 , x i 2 , ⋯ , x i D ) , i = 1 , 2 , 3 , ⋯ , N ，速度为 v i = ( v i 1 , v i 2 , ⋯ , v i D ) 。在粒子探索的过程中，个体极值(pbest)为粒子个体本身所达到的最优值即局部极值用 p b e s t i = ( p b e s t i 1 , p b e s t i 2 , ⋯ , p b e s t i D ) 表示，全局极值(gbest)为粒子在整个种群中所能达到的最优值用 p b e s t i = ( g b e s t i 1 , g b e s t i 2 , ⋯ , g b e s t i D ) 表示。粒子根据个体极值和全局极值，按照以下两个公式不断更新自身的速度和位置 [ 9 ] [ 10 ]。 v i d k + 1 = w k ∗ v i d k + c 1 r 1 ( p b e s t i d k − x i d k ) + c 2 r 2 ( g b e s t i d k − x i d k ) (2.11) x i d k + 1 = v i d k + 1 + x i d k + 1 (2.12) 其中 r 1 和 r 2 为随机数，取值范围为[0, 1]， c 1 和 c 2 为学习因子，通常 c 1 = c 2 = 2 ， c 1 , c 2 的作用是提高算法的收敛速度。 c 1 代表飞行过程中自身影响。 c 2 代表飞行过程中全局影响。 p b e s t i d 代表粒子个体极值在d维分量所经历的最好位置， g b e s t i d 代表粒子全局极值在d维分量所经历的最好位置， x i d 为粒子所在位置的第d维分量， v i d 为粒子速度的d维分量。w为惯性权重，上一速度对当前速度的影响。w过大，算法的全局搜索比较好，w过小，局部搜索能力加强。 2.3.2. 粒子群算法实现的步骤 [ 11 ] 步骤① 设定粒子数目，并进行初始化，随机生成初始速度。 步骤② 每个粒子的速度和位置都是在持续更新，在当前时刻具有最新的位置，计算粒子的目标函数fitness。 步骤③ 计算粒子的适应值，如果优于原有的个体极值，则用当前适应值替换原有的个体极值。 步骤④ 根据粒子的个体极值寻找全局极值。 步骤⑤ 根据式(2.11)改变粒子速度，每个粒子都不可以超过最大速度，如果超过，则该粒子的速度会被设定为最大速度。 步骤⑥ 根据式(2.12)更新粒子的位置。 PSO算法流程图见图1所示： 图1. PSO算法流程图  模型对于预测的效果，需要根据模型的评定指标进行检验，我们这里采用2个误差标准作为模型的评定指标。 ① 平均绝对误差 MAE = 1 n ∑ i = 1 n | e ( i ) | 其值越小越好，反映了模型预测值和原始值的平均偏离程度。 ② 平均绝对百分误差 MAEP = 1 n ∑ i = 1 n | e ( i ) | x ( 0 ) ( i ) ∗ 100 % 其值越小越好，反映了不同模型对相同数据拟合好坏的比较。 e ( i ) 为误差，即预测值和原始值的误差。 x ( 0 ) ( i ) 为原始值。"
"以某市2017年度个人外汇涉外支出业务量作为原数据(2017.01~2017.12)，建立GM(1,1)模型： x ( 0 ) = ( x ( 1 ) ( 0 ) , x ( 2 ) ( 0 ) , ⋯ , x ( n ) ( 0 ) ) = ( 1875 , 1651 , 1653 , 1444 , 1417 , 1621 , 1405 , 1602 , 1362 , 1168 , 1053 , 1129 ) 对数据进行检验，按式(2.1)计算级比： λ ( k ) = x ( k − 1 ) ( 0 ) x ( k ) ( 0 ) ,     k = 2 , 3 , 4 , ⋯ , 12 λ = ( λ ( 2 ) , λ ( 3 ) , ⋯ , λ ( 12 ) ) = ( 1.14 , 1.0 , 1.15 , 1.02 , 0.87 , 1.15 , 0.88 , 1.18 , 1.17 , 1.11 , 0.93 ) 计算级比检验区间范围为： x = ( e − 2 n + 1 , e 2 n + 1 ) = ( 0.857 , 1.166 ) 发现级比 λ 的值不完全落在检验区间范围内，需要对原数据进行相应的变换，如平移变换，方根变换，对数变换，这里我们选择平移变换，平移量C = 150，平移后的数据为： x 1 = ( 2025 , 1801 , 1803 , 1594 , 1567 , 1771 , 1555 , 1752 , 1512 , 1318 , 1203 , 1279 ) 从而再次得到级比： λ 1 = ( 1.12 , 1.0 , 1.13 , 1.02 , 0.89 , 1.14 , 0.89 , 1.16 , 1.15 , 1.1 , 0.94 ) 发现新的级比 λ 1 往前落在检验区间(0.857, 1.166)。 根据式(2.3)生成一次累加数据： x ′ = ( 2025 , 3826 , 5629 , 7223 , 8790 , 10561 , 12116 , 13868 , 15380 , 16698 , 17901 , 19180 ) 根据式(2.6)和式(2.7)，构造数据向量Y和矩阵B，计算参数a和b的值 a = 0.034 ,     b = 1936.55 得到式(2.4)对应的微分方程 d x d t + 0.034 x = 1936.55 对应式(2.8)的预测模型为： x ⌢ ( 1 ) ( k + 1 ) = ( x ( 0 ) ( 1 ) − b a ) e − a k + b a = − 54892.35 e − 0.034 k + 56957.35 由式(2.9)我们可以还原数据，在还原数据之前，由于我们对原始数据做了平移，所以要减去平移量C = 150，所以最终的还原数据见表1所示。 Table 1 时间(月) 原始值 GM预测值 误差 相对残差% 灰色马尔科夫 误差 相对残差% 2017.01 1875 1875 - - - - - 2017.02 1651 1624 −27 −1.6 1640 −11 −0.67 2017.03 1653 1564 −89 −5.4 1627 −26 −1.57 2017.04 1444 1507 63 4.4 1447 3 0.21 2017.05 1417 1451 34 2.4 1429 12 0.85 2017.06 1621 1398 −223 −13.8 1580 −41 −2.53 2017.07 1405 1346 −59 −4.2 1400 −5 −0.36 2017.08 1602 1296 −306 −19.1 1464 −138 −8.61 2017.09 1362 1248 −114 −8.4 1410 48 3.52 2017.10 1168 1201 33 2.8 1183 15 1.28 2017.11 1053 1156 103 9.8 1069 16 1.52 2017.12 1129 1112 −17 −1.5 1123 −6 −0.53 表1. GM(1,1)模型与灰色–马尔科夫模型预测值对比 通过GM(1,1) 预测模型得到2018.1和2018.2的外汇支出业务量的预测值分别为：1070和1029。 由表1可知，GM(1,1) 预测模型的相对残差范围为(−19.1, 9.8)，所以我们根据相对残差范围进行状态区间的划分，划分的状态区间分别为：E1(−20, −6]，E2(−6, −2]，E3(−2, 0)，E4[0, 3]，E5(3, 5]，E6(5, 10]。最终划分结果见表2所示。 Table 2 状态 月份 状态 月份 E1 2017.6, 2017.8, 2017.9 E4 2017.1, 2017.5, 2017.10 E2 2017.3, 2017.7 E5 2017.4 E3 2017.2, 2017.12 E6 2017.11 表2. 马尔科夫区间状态划分 得到的灰色马尔科夫预测结果见表1所示。根据状态划分进行状态矩阵的构建，得到一步转移概率矩阵和两步转移概率矩阵。 p ( 1 ) = [ 1 / 3 1 / 3 0 1 / 3 0 0 1 / 2 0 0 0 1 / 2 0 0 1 0 0 0 0 1 / 3 0 1 / 3 0 0 1 / 3 0 0 0 1 0 0 0 0 0 1 0 0 ] ， p ( 2 ) = [ 7 / 18 1 / 9 1 / 9 1 / 9 1 / 6 1 / 9 1 / 6 1 / 6 0 2 / 3 0 0 1 / 2 0 0 0 1 / 2 0 1 / 9 4 / 9 0 4 / 9 0 0 1 / 3 0 1 / 3 0 0 1 / 3 1 / 3 0 1 / 3 0 0 1 / 3 ] 由于12月份所处的状态为E3，所以初始状态向量为(0, 0, 1, 0, 0, 0)，根据初始向量状态和一步转移概率矩阵、两步转移概率矩阵得到2018年1月和2月的概率预测见表3所示。 Table 3 时间|状态 E1 E2 E3 E4 E5 E6 2018.01 0 1 0 0 0 0 2018.02 1/2 0 0 0 1/2 0 表3. 2018.1~2018.2概率 于是得到2018年1月和2月的灰色马尔科夫预测结果分别为1113和1162。 预测结果对比见图2所示： 图2. GM(1,1)与GM(1,1)——马尔科夫模型对比 下面通过粒子群算法对灰色马尔科夫模型中的参数进行优化，计算灰色马尔科夫模型中区间的白化系数。设白化系数为 λ 。选取m个粒子构成粒子群，粒子的长度为d，即粒子为d维向量，这个向量代表白化系数 λ 。白化系数初始值为随机生成，区间范围为[0, 1]。进行初始化后，粒子的位置根据飞行速度的变换而变换，本文用均方差衡量粒子的适应度函数值。 f i t = M A S = 1 n ∑ i = 1 n e 2 (i) 根据马尔科夫的状态区间 E i = [ L i , H i ] ，我们在灰色马尔科夫模型中的白化系数取值 λ = 0.5 ，即 0.5 ( L i + H i ) 。在实际情况中取值不一定是中间值，所以我们通过粒子群算法计算出最优的白化系数值。 z = λ ∗ L i + ( 1 − λ ) H i 在粒子群算法中，我们根据一步概率转移矩阵和已经划分好的6个状态区间，我们选择粒子的长度为6，粒子数为1000，学习因子 c 1 = c 2 = 2 ，惯性权重为1，迭代次数1000，粒子更新位置最大为1，最小为0，粒子更新速度最大为0.01，最小速度为−0.01。从而得到白化系数。 λ 1 = 0.62 , λ 2 = 0.3 , λ 3 = 0.38 , λ 4 = 0.17 , λ 5 = 0.43 , λ 6 = 0.32 进而得到粒子群灰色马尔科夫模型对外汇支出的预测值，见表4所示，预测结果对比图见图3所示，误差对比见表5所示。 Table 4 时间(月) 原始值 粒子群 误差 相对误差% 2017.01 1875 - - - 2017.02 1651 1636 −15 −0.91 2017.03 1653 1614 −39 −2.36 2017.04 1444 1445 1 0.07 2017.05 1417 1415 −2 −0.14 2017.06 1621 1603 −18 −1.1 2017.07 1405 1389 −16 −1.14 2017.08 1602 1486 −116 −7.24 2017.09 1362 1431 69 5.07 2017.10 1168 1171 3 0.26 2017.11 1053 1059 6 0.57 2017.12 1129 1120 −9 −0.8 表4. 粒子群优化灰色马尔科夫模型预测值 图3. 灰色马尔科夫预测模型和粒子群优化的灰色马尔科预测模型 Table 5 预测方法\误差类型 MAE MAEP 灰色马尔科夫模型 29.18182 1.97% 粒子群优化的灰色马尔科夫模型 26.72727 1.79% 表5. 预测模型误差对比 从上表可以看成，粒子优化的灰色马尔科夫预测模型在一定程度上优于灰色马尔科夫模型，我们通过粒子群优化的灰色马尔科夫预测模型得到2018.1和2018.2的外汇支出业务量的预测值分别为：1104和1180。"
"本文首先采用灰色预测模型得到一个预测趋势，但不能反映出数据的随机波动性，然后结合马尔科夫链进行组合预测，使数据呈现出较好的随机波动性，接近原始数据，提高预测的精度。接着，我们再通过使用粒子群算法对灰色马尔科夫预测模型进行参数优化，进一步提高预测精度，达到更加接近真实值的效果。也体现出组合预测模型比单一预测模型精度高，效果更好。"
