"空间地图投影涉及大量的椭球偏心率幂级数展开、复合函数微分、空间坐标变换、傅里叶级数展开、矩阵运算等一系列含时间变量的复杂数学分析过程，传统算法主要依靠人工推导完成，许多问题解决的并非完美。以空间地图投影各种复杂数学分析过程为研究对象，提出利用计算机代数分析方法，借助计算机代数系统强大的数学分析能力，深入开展卫星地面轨迹投影、空间地图投影正反解、空间地图投影变换计算机代数精密分析和空间地图投影计算机代数可视化研究，推导和建立理论上更严密、形式上更简单、精度上更精确的符号化的新公式和新算法，揭示空间地图投影各类复杂数学模型背后隐藏的规律。空间地图投影计算机代数分析研究可以实现空间地图投影特定数学分析问题的突破和创新，进一步丰富和完善空间地图投影的理论体系。研究成果可广泛应用于卫星遥感图像处理、地图制图、空间信息定位、测量等领域。 关键词 :空间地图投影，数学分析，计算机代数，可视化 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"卫星遥感图像数据的大量涌现，为地图制图提供了丰富的资料来源，促使卫星遥感制图不断发展。由于卫星遥感制图是一种动态的制图过程，传统意义上的静态、二维的地图投影理论和方法已不能适应其应用需求，与之相适应地也开辟了地图投影学的一个崭新研究领域—空间地图投影 [ 1 ] 。空间地图投影能够很好地模拟卫星动态成像的物理过程，可将传统地图投影中地球形状、透视中心和投影面三者固定的关系转换成随时间变化的函数关系，是适合于遥感图像处理的动态投影，是卫星图像的一种较为理想的数学基础。 当前，我国已经发射了100多颗人造地球卫星，其中包括高分四号、资源三号等多颗遥感卫星，今后还将要发射一系列资源卫星和多用途军事应用卫星等，对这些卫星图像数据的处理和制图是摆在我们面前的首要任务。因此，开展空间地图投影研究，建立与卫星图像相适应的数学基础具有非常重要的科学意义和现实意义。同时，随着人们不断获得大范围的、多分辨率的、海量的地理空间数据，空间地图投影算法的优劣在计算机实现中至关重要，为满足计算机处理海量数据的变换需求，迫切需要研究方程简、精度高、适用范围广的空间地图投影新算法。 空间地图投影涉及地球形状、地球自转、卫星轨道摄动等非常复杂的数学分析问题，从而不可避免地会遇到大量的椭球偏心率幂级数展开、复合函数微分、空间坐标变换、三角函数变换、傅里叶级数展开、矩阵运算等一系列与时间变量有关的复杂符号推导过程。过去由于历史条件的限制，空间地图投影数学分析问题主要依靠人工推导完成。由于问题本身的复杂性，人工处理费时费力、又非常繁琐冗长，并且很容易出错；特别是随着展开阶数的增加，展开式的复杂性会呈几何级数增加，人工推导难度极大，甚至难以完成。本文总结了空间地图投影数学分析的研究现状，分析了当前研究中存在的问题，并给出了相应的研究对策，以期为空间地图投影研究提供参考。"
"空间地图投影按投影经纬线形状可分为空间方位、空间圆柱、空间圆锥投影三种。以下分别介绍这三中投影正反解的国内外研究现状。 1) 空间方位投影正反解研究方面 空间方位投影为遥感影像最原始、最常用的投影方式，包括单张航空像片的正负图像空间透视投影，倾斜像面透视投影，空间正、斜方位投影等。 国外研究方面，Snyder研究了单张倾斜像面的航天像片的构像模型，为模拟航天像片提出了地球透视投影的三角方程 [ 2 ] ；布加耶夫斯基详细阐述了单张航天像片的理论和投影方法，论述了将摄影像片和非摄影像片变换为给定的地图投影的问题、像片量测测的数学处理问题以及从单张像片上向地图传递地物信息的问题 [ 3 ] ；Deakin利用矢量方法导出了单张像片的投影公式 [ 4 ] ；Hanna研究了单张像片正负图像的地图坐标解析式 [ 5 ] 。 国内研究方面，时晓燕根据透视投影的基本原理，给出了关于倾斜相机式投影的几何解法，在此基础上分析了倾斜相机式投影与外心投影的异同，提出了二者比较的一致性条件 [ 6 ] ；任留成利用矢量方法推出椭球的倾斜像面空间透视投影正解公式，计算出此正解公式与球体的相应正解公式之间的误差，并且利用矢量方法导出其相应反解公式 [ 7 ] ；丁琳针对卫星动态获取的正图像，建立了平面透视投影，利用矢量解法导出了其正反解变换和星下点坐标计算公式 [ 8 ] ；利用空间几何理论建立了卫星图像的随时间变化的空间斜方位投影模型，利用矢量解法建立了该投影模型的正解和反解变换算法以及星下点坐标计算方法，摆脱了卫星像片构像方程要依赖于像片的外方位元素的限制，解决了图像量算与像点快速定位的算法问题 [ 9 ] 。 2) 空间圆柱投影正反解研究方面 空间圆柱投影的主要研究内容包括：空间墨卡托投影、空间高斯—克吕格投影和等角空间投影等。 国外研究方面，Colvocoresses首先提出了适用于Landsat卫星图像应用的新型地图投影—空间斜墨卡托投影(SOM) [ 10 ] ，描述了该投影的几何模型，但并未推导其相应的数学公式，他建议制图工作者致力于研究其数学模型及编程计算，并指出数学问题是这项研究中最重要的问题。1977年，Junkins和Snyder各自独立推导出了SOM投影公式 [ 11 ] [ 12 ] 。Snyder考虑了卫星与地球的相对运动、地球的自转和轨道的进动等情形，假设星下点轨迹保持长度不变形，把地球分为球体和椭球体，把卫星轨道分为圆形和椭圆形，分四种情况建立了相应的SOM投影公式。Junkins采用完全不同于Snyder的思路，推导出适合描述卫星遥感光学图像数据的动态地图投影模型。在保持星下点轨迹长度不变形和曲率不变的假设条件下，导出了卫星星下点轨迹线的微分方程，建立了扫描点的SOM投影。Junkins的投影公式通用性强，可用于非圆形轨道，但是公式较为复杂，也不等角，更适用于非圆形轨道；Snyder的投影公式简单，且近似等角，适合于(陆地卫星)圆形轨道。 国内研究方面，杨启和讨论了卫星地面轨迹在投影中的映像，并对SOM投影模型进行了较深入的分析和实验 [ 13 ] ；李建森推导了球体、椭球体空间斜墨卡托投影公式，指出了空间投影的特点和用途，给出了可实际应用的SOM投影正反解公式计算程序包 [ 14 ] ；程阳在SOM投影几何模型条件下，基于卫星飞行轨道在惯性系中满足的微分方程组，利用数值解法得到了星下点轨迹线在投影平面上的坐标，再计算出相应的切墨卡托投影坐标，采用正形多项式拟合的方法得到了目前仅有的等角空间地图投影(CSP)，并进行了投影变形分析 [ 15 ] [ 16 ] 。程阳提出的等角空间地图投影具有广泛的适用性，可适用于任何卫星轨道，圆形轨道和椭圆形轨道，且近极轨道和低纬轨道均适用。赵琪将SOM投影改进为适合于大幅面卫星图像的空间割圆柱投影，给出了该投影的一般公式并分析了其变形情况 [ 17 ] ；任留成研究了适合星下点轨迹是赤道的卫星图像数据的空间墨卡托投影，推导了该投影正解公式，分析了其变形情况，并证明了该投影是等角空间投影 [ 18 ] ；研究了适合于星下点轨迹是某一经线的卫星图像数据的空间高斯—克吕格投影，推导了该投影正解及变形公式，并证明了该投影是等角空间投影 [ 19 ] 。 3) 空间圆锥投影正反解研究方面 空间斜墨卡托投影和等角空间投影是专门为沿星下点轨迹周围扫描成像的卫星图像而设计的空间投影，投影精度只能满足星下点轨迹周围220 km以内的扫描图像，而侧视雷达的侧视区域中心线一般偏离星下点轨迹大约270 km以上，不适合用空间斜墨卡托投影和等角空间投影表示，而更适合用空间圆锥投影表示，目前该方面的研究还比较少。针对卫星侧视雷达图像的空间地图投影问题，任留成为卫星侧视雷达图像设计了一种空间斜圆锥投影 [ 20 ] ，根据空间斜圆锥投影的几何模型，建立了侧视区域中心线轨迹投影，进而导出了空间斜圆锥投影公式，并讨论了投影变形。该投影能够保持侧视区域中心线不变形，直接建立了侧视区域内像素点与地面点之间较近似的对应关系。 4) 空间地图投影正反解研究存在的主要问题 空间地图投影正反解涉及大量的椭球偏心率幂级数展开、复合函数微分、特殊函数展开、空间坐标变换等一系列包含时间变量的繁琐的符号推导过程。限于当时的历史条件，计算机代数分析方法和计算机代数系统并未得到充分利用，其间许多推导过程主要由人工完成，还存在一些急需解决的问题。如有些算法是基于球体模型导出的，存在近似，精度不高；有些算法正反解表达式相当复杂繁琐，计算效率不高；特别是有些投影正解展开式系数为积分形式，应用时以具体的数值形式给出，对于不同的椭球需要重新计算系数，不便于推广应用，反解展开式则包含繁琐的迭代计算，理论分析不甚方便。笔者认为，非常有必要开展空间地图投影正反解的计算机代数分析研究，借助计算机代数系统的强大数学分析能力，提高推导效率，消除近似处理和迭代运算，得到理论上更为严密、形式上更为简单、精度上更为精确的符号化的算法和数学模型。  空间地图投影变换是空间地图投影的一个重要组成部分，研究的主要内容包括不同空间地图投影之间的变换、空间地图投影与传统地图投影之间的变换。 空间地图投影变换的主要方法有解析变换法、数值变换法、数值解析变换法 [ 21 ] [ 22 ] ，其实现过程及主要特点如表1所示。 因为现行的地形图采用传统地图投影，卫星遥感用户在使用图像时，通常喜欢把遥感图像附于地形图上，所以利用遥感图像进行制图时，无论遥感图像产品的投影性质如何，最后都将根据用户要求转换 Table 1 方法 实现过程 主要特点 反解变换法 通过中间过渡的方法，反解出原地图投影点的地理坐标，再代入新投影中求得该点在新投影下的直角坐标。 投影方法是严密的，但计算过程复杂，有时需要繁琐的迭代运算，计算效率不高。 正解变换法 直接确定原地图投影下点的直角坐标与新投影下相应直角坐标的联系。 表达了编图和制图过程的数学实质，不同投影之间具有精确的对应关系。 数值变换法 采用多项式逼近的方法建立两投影间的变换关系式。 不能反映投影变换的数学实质，对于较大区域的地图为了保证变换精度必须分块处理。 数值解析变换法 采用多项式逼近的方法求出原投影点的地理坐标，然后代入新投影方程。 类似于数值变换法，为了保证变换精度，同样应采用分块变换。 表1. 空间地图投影变换方法的实现过程和主要特点 成所需的地图投影。这使得人们更多地关注空间地图投影与传统地图投影之间的变换问题，而较少研究不同空间地图投影之间的变换。李建森采用一般四次正形多项式和最小二乘法平差的四次正形多项式，建立了空间斜墨卡托投影与高斯投影、等角圆锥投影之间的数值变换关系式 [ 14 ] ；任留成系统给出了空间斜墨卡托投影与高斯—克吕格投影、等角圆锥投影、UTM投影、墨卡托投影、方位投影之间的变换公式 [ 1 ] ，为空间斜墨卡托投影下的图像变换问题提供了理论依据。 虽然前人对上述方法进行了大量的研究，并在一定程度上解决了许多问题，但由于当时历史条件和分析手段的限制，一些问题解决得并非完美和理想： 1) 如空间地图投影和传统方位投影间的变换主要采用反解变换法，变换中有时需要经过繁琐的迭代运算才能反解出大地纬度，使得计算过程变得相当复杂，计算效率不高，特别是这种方法而未能建立投影坐标间的直接关系式，不能表达编图和制图过程中的数学实质，而且变换中有些公式的系数表现为适用于特定参考椭球的具体数值形式，不便于推广使用。 2) 对于等角空间投影之间的变换以及等角空间投影与传统等角投影之间的变换，传统上通常将一种等角投影的坐标展开为另一种等角投影坐标的幂级数形式，虽然是不同等角投影坐标间的直接关系式，但存在近似处理，特别是其计算精度受变换区域大小的限制。"
"针对当前空间地图投影研究存在的问题，笔者认为非常有必要开展空间地图投影计算机代数精密分析研究，以空间地图投影各种数学分析过程和数学模型为研究对象，充分利用具有严格解析意义的计算机代数分析方法，借助计算机代数系统强大的数学分析能力 [ 23 ] [ 24 ] ，系统地解决过去人工推导未能完美解决的空间地图投影数学分析问题，推导和建立理论上更为严密、形式上更为简单、精度上更为精确的空间地图投影新公式和新算法，揭示各类空间地图投影复杂数学模型和海量数据背后隐藏的规律，实现空间地图投影在一些具体数学分析问题上的突破和创新，进一步丰富和完善空间地图投影的理论体系。具体可以从以下四个方面开展研究。  卫星地面轨迹也称卫星星下点轨迹，即地心至卫星的向径与地球表面的交点(星下点)在地面上移动的轨迹，如图1所示。卫星地面轨迹投影是指将卫星星下点轨迹描绘在地图上的投影，是构建卫星图像空间地图投影的基础，因此是空间地图投影的一项重要内容。研究卫星地面轨迹投影的目的是为了便于确定卫星地面轨迹的位置。 图1. 卫星星下点示意图 现有的关于卫星地面轨迹线的投影主要有三种基本形式：一是圆柱投影，即卫星轨道圆柱投影；二是双正形纬线圆锥投影，包括双纬线卫星轨迹正形圆锥 投影和双正形纬线卫星轨迹圆锥投影(其中一纬线为轨迹极限)；三是单标纬圆锥投影，包括单正形纬线卫星轨迹圆锥投影和最接近方位投影的卫星轨迹圆锥投影。 卫星地面轨迹方程和投影的计算涉及卫星轨道摄动、椭球偏心率幂级数展开、复合函数微分、三角函数变换、超越函数解算等一系列与时间变量有关的复杂数学分析问题。这些问题过去由于历史条件和分析手段的限制，许多推导过程由人工完成，特别是为了推导方便，采取了一些这样或那样的近似处理，如现有的算法通常将地球简单视为球体，不仅理论上不够严密，而且包含复杂的迭代过程，计算效率不高。 因此，需要基于地球椭球模型，对卫星地面轨迹方程、卫星地面轨迹圆柱投影、卫星地面轨迹圆锥投影以及卫星地面轨迹方位投影进行深入研究，利用计算机代数分析方法，借助计算机代数系统的强大数学分析和符号推导能力，消除以往采取的近似处理和迭代运算，推导理论上更为严密、形式上更为简单、精度上更为精确的符号化的新公式和新算法。  空间地图投影正反解涉及大量的椭球偏心率幂级数展开、隐函数高阶导数求取、特殊函数展开、空间坐标变换等一系列包含时间变量的繁琐的符号推导过程。人工处理这些问题既费时费力，又非常繁琐、容易出错，并且随着展开阶数的增高，展开式的复杂性会呈几何级数增加，变得人工几乎不可能推导。过去有些算法是基于球体模型导出的，存在近似，精度不高；有些算法正反解表达式相当复杂繁琐，计算效率不高；特别是有些投影正解展开式系数为积分形式，应用时以具体的数值形式给出，对于不同的椭球需要重新计算系数，不便于推广应用，反解展开式则包含繁琐的迭代计算，理论分析不甚方便。而借助计算机代数系统则可以提高正解的推导效率，确保结果的准确性，并有可能导出反解无需迭代的直接公式，实现算法上的突破。 因此，需要利用计算机代数分析方法，借助计算机代数系统强大的数学分析能力，系统研究空间方位投影、空间圆柱投影、空间圆锥正反解的计算机代数解法，重点研究各类空间地图投影正反解中涉及到的椭球偏心率幂级数展开、傅里叶级数展开、空间坐标变换、三角函数变换等数学分析过程，通过具有严格解析意义的数学分析，导出各类空间地图投影正反解关于椭球偏心率的符号表达式，使其理论上更为严密、形式上更为简单、精度上更为精确，解决空间地图投影正反解以往限于历史条件和分析手段未能完美解决的数学问题，实现空间地图投影在一些具体问题上的突破和创新。 因此，需要从等角空间投影和复变函数的内在联系出发，研究各类等角空间投影正反解的复变函数表示，借助计算机代数分析方法和计算机代数系统，推导出严密、准确、简单的等角空间投影正反解的复变函数表达式。 为便于分析和推导，空间地图投影有时需要采用“空间双重投影法”，即首先将椭球面按某种数学准则投影于球面，然后将球面投影于平面。因此，选取合适的数学准则，以使椭球面投影于球面的变形较小也是一个非常值得研究的问题。当前，椭球面投影于球面的准则主要有等距离、等角、等面积三种，这些准则以及球体半径的确定会涉及大量关于椭球偏心率的幂级数展开、复合函数的积分等运算，过去对这些问题的研究并不全面和充分，不仅包含很多的近似处理，而且有些公式还是具体的数值形式，不便于推广应用。因此，需要利用计算机分析方法，借助计算机代数系统强大的数学分析能力，探索更有效的空间双重投影准则，推导更加严密、准确的符号化的空间双重投影公式。  空间地图投影变换包括不同空间地图投影之间的变换、空间地图投影与传统地图投影之间的变换。过去人们更多地关注空间地图投影与传统地图投影之间的变换问题，而较少研究不同空间地图投影之间的变换。采用的主要是反解变换法和数值变换法，反解变换法需要反解出椭球面地理坐标，有时需要经过繁琐的迭代运算，使得计算过程变得相当复杂，计算效率不高，数值变换法对于较大区域的地图为了保证变换精度必须分块处理，特别是这两种方法而未能建立投影坐标间的直接关系式，不能表达编图和制图过程中的数学实质，而且变换中有些公式的系数表现为适用于特定参考椭球的具体数值形式，不便于推广应用。 因此，需要将在导出的空间地图投影正反解表达式基础上，利用计算机代数分析方法，借助计算机代数系统强大的数学分析能力，研究空间地图投影变换的计算机代数精密分析，具体包括以下两个方面： a) 不同空间地图投影之间的变换； b) 空间地图投影和传统地图投影之间的变换。 研究中综合考虑正轴、横轴、斜轴三种情形，与传统反解变换不同的是，重点关注和研究椭球情形下不同变形性质间各类空间地图投影直接变换的数学分析过程，通过具有严格解析意义的计算机代数分析，推导出理论上更为严密、形式上更为简单、精度上更为精确的符号化的新公式和新算法。 对于等角空间投影之间的变换以及等角空间投影与传统等角投影之间的变换，传统上通常将一种等角投影的坐标展开为另一种等角投影坐标的幂级数形式，虽然是不同等角投影坐标间的直接关系式，但存在近似处理，特别是其计算精度受变换区域大小的限制。因此，需要在各类等角空间投影和传统等角投影正反解的复变函数表示基础上，利用计算机代数分析方法，借助计算机代数系统强大的数学分析能力，建立等角空间投影之间以及等角空间投影和传统等角投影之间直接变换的严密、准确、简单的复变函数表示模型，实现算法上的突破和创新。  过去地图投影可视化大都需要大型软件的支持，推广应用不甚方便。计算机代数系统不但具有符号推导功能，而且具有强大的可视化分析能力。借助于这些能力，将使人们更容易发现各类空间地图投影模型和大量数据背后隐藏的规律。因此，需要借助计算机代数系统强大的可视化功能，开展空间地图投影计算机代数可视化研究，具体包括：卫星地面轨迹投影的可视化表现手段和算法，各类空间地图投影角度、长度和面积变形的可视化表现手段和算法，分析投影后经纬线变形规律和特点，探索和设计新型空间地图投影；各类空间地图投影变换的可视化表达手段和算法。 利用计算机代数分析方法，通过计算机代数系统探索在动态、多维条件下的空间地图投影可视化表达，重点是将那些过去很难设想和非常相似的空间地图投影数学模型以及海量空间地图投影数据以动态直观的方式表现出来，其目的是提高对空间地图投影复杂数学过程分析的洞察能力，提高多维和多时相空间地图投影数据的显示能力，改善空间地图投影信息的表达效果。 通过计算机代数可视化分析，使空间地图投影数学分析变得生动有趣，给视觉化的空间地图投影研究带来了巨大改进，有效增强用户对于特殊空间地图投影方式的理解，通过建立新的可视化算法，优化空间地图投影变形设计，提高空间地图投影对空间信息表述的准确性。"
"过去由于历史条件的限制，空间地图投影数学分析问题主要依靠人工推导完成。由于问题本身的复杂性，人工处理费时费力、又非常繁琐冗长，并且很容易出错；特别是随着展开阶数的增加，展开式的复杂性会呈几何级数增加，人工推导难度极大，甚至难以完成。本文分析了空间地图投影数学分析问题研究现状，提出开展空间地图投影计算机代数精密分析研究，主要结论如下： 1) 将具有严格解析意义的计算机代数分析方法引入空间地图投影数学分析领域，代替繁琐机械单调的人工推导，一定程度上革新和丰富了空间地图投影数学分析手段。由于计算机代数强大的数学分析能力，将会推导出一些理论上更严密、形式上更简单、精度上更精确的空间地图投影非数值的符号化表达式，解决以往算法存在“近似处理、复杂繁琐、迭代运算、数值形式”的问题。 2) 借助计算机代数系统强大的数学分析能力和符号运算功能，将会导出一些过去依靠人工推导难以实现的空间地图投影新公式和新算法，实现空间地图投影在个别理论和应用方面较大的突破和创新，进一步丰富空间地图投影的数理基础，完善空间地图投影的理论体系。 3) 过去地图投影可视化大都需要大型软件的支持，推广应用不甚方便。计算机代数系统具有非常强大的科学计算可视化能力，借助计算机代数系统强大的可视化功能进行空间地图投影计算机代数可视化分析和表示，不仅使枯燥的空间地图投影数学分析变得更生动有趣，而且可以揭示空间地图投影复杂数学模型和海量数据背后隐藏的规律，直观显示椭球空间几何元素和各类投影的空间变化特征。"
