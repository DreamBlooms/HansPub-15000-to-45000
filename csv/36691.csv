"命名实体识别是自然语言处理的基础任务之一。而目前中文命名实体识别研究大多是面向现代汉语的，针对古汉语的这方面研究工作涉及较少。因此，本文以《战国策》为例，根据古汉语独特的子语言特征，利用网格长短期记忆(Lattice LSTM)神经网络构建命名实体识别模型以解决古汉语中的信息提取问题。实验结果表明，Lattice LSTM能够学会从语境中自动找到所有与词典匹配的词汇，以取得较好的命名实体识别性能。实验结果中的F1值达到92.16%。 关键词 :神经网络模型，古汉语，命名实体识别，条件随机场 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"命名实体识别 [ 1 ] (Named Entity Recognition, NER)是自然语言处理(Natural Language Processing, NLP)基础性工作之一，它可以准确地从文本中识别出人名、机构名、地名、时间等信息，为信息检索、机器翻译、舆情分析等下游自然语言处理任务提供重要的特征信息。过去，命名实体识别任务多采用基于规则的方法、基于统计的方法和基于规则和统计相结合的方法 [ 2 ]。 近年来，深度神经网络在自然语言处理领域广泛地受到关注，与上述方法相比，基于深度神经网络的方法具有更强的泛化能力、对人工特征依赖较少的优点。因此，面向现代汉语和英语等大语种，研究者已提出了许多基于深度神经网络的命名实体识别模型 [ 3 ] - [ 18 ]，但针对古汉语在这方面的研究才刚刚起步。 鉴于此，本文以《战国策》为例，根据古汉语独特的子语言特征，利用网格长短期记忆(Lattice LSTM)神经网络构建命名实体识别模型以解决古汉语中的信息提取问题。该方法将传统的LSTM单元改进为网格LSTM，在字模型的基础之上显性利用词与词序信息，从而避免了分词错误传递的问题。实验结果表明，Lattice LSTM能够学会从语境中自动找到所有与词典匹配的词汇，以取得较好的命名实体识别性能。在本研究构建的数据集上F1值达到92.16%。"
"在英文领域，第一个采用神经网络进行命名实体识别的是Hammerton等人，由于LSTM良好的序列建模能力，LSTM-CRF [ 19 ] 模型成为命名实体识别的基础架构之一，很多方法都是以LSTM-CRF为主体框架，在此之上融入各种相关特征。本文将LSTM-CRF作为主要网络结构，并且在该模型对一系列输入字符进行编码的同时将所有与词典匹配的词汇网格结构融入模型中。 一般将输入序列表示为 s = c 1 , c 2 , ⋯ , c n 。其中， c j 代表第j个字符。本文中应用 t ( i , k ) 表示索引j，代表第i个词的第k个字符。比如“医扁鹊”，索引从1开始，那么 t ( 1 , 1 ) = 1 (医)， t ( 2 , 1 ) = 2 (扁)。本研究运用BIO标注策略进行字粒度和词粒度的命名实体识别标注，古汉语命名实体识别的字序列和标记序列举例说明如表1所示。 Table 1 字 舜 虽 贤 不 遇 尧 不 得 为 天 子 标记 B-PER O O O O B-PER O O O B-POS I-POS 表1. 古汉语命名实体识别的字序列和标记序列举例 注：“O”是实体外部标记，“B”是实体开始标记，“I”是实体内部标记，“PER”表示人名，“POS”表示官职。  基于字的命名实体识别(见图1)存在一种缺陷，即无法充分利用词的显性以及词序信息。 图1. 基于字符的模型 图2. 词–字符网格 图3. Lattice模型  基于词的模型见图4。  本文利用Lattice LSTM [ 20 ] 来处理句子中的词汇词(lexicon word)，从而将所有潜在词信息全部整合到基于字符的LSTM-CRF中，见图2。并使用一个自动获取的词典来匹配句子，进而构建基于词的Lattice，见图3。由于在网格中存在指数数量的单词到字符路径，因此使用Lattice LSTM结构来自动控制从句子的开头到结尾的信息流。门控单元用于将不同路径的信息动态的传输到每个字符。在训练数据集上训练后，Lattice LSTM能够学会从信息流中自动找到有用的词，从而提升命名实体识别性能，见图5。与基于字符和基于词的命名实体识别方法相比，本文采用的模型优势在于利用词汇的显性信息进行分词，而不是仅仅自动关注，从而减少分词误差。 图4. 基于词的模型 图5. Lattice LSTM模型  RNN循环神经网络理论上可以处理任意长度的序列信息，但实际应用中，当序列过长时会出现梯度消失的问题，且很难学到长期依赖的特征。因此，Graves等人 [ 21 ] 改进了循环神经网络，提出长短期记忆网络(Long Short-Term Memory) LSTM模型。LSTM单元通过输入门、遗忘门和输出门来控制信息传递。它是一种特殊的RNN，能够学习长期的规律，应用十分广泛。LSTM编码单元如图6所示。 具体计算过程如公式(1)~(6)所示： i t = σ ( W i h t − 1 + U i + b i ) (1) f t = σ ( W f h t − 1 + U f x t + b f ) (2) c t ˜ = tanh ( W c h t − 1 + U c x t + b f ) (3) 图6. LSTM编码单元 c t = f t ⊙ c t − 1 + i t ⊙ c t ˜ (4) o t = σ ( W o h t − 1 + U o x t + b o ) (5) h t = o t ⊙ tanh ( c t ) (6) 其中， σ 是sigmoid函数， ⊙ 是点积。 x t 为时刻t的输入向量， h t 是隐藏状态，也是输出向量，包含前面t时刻所有有效信息。 c t 是一个更新门，控制信息流入下一个时刻； f t 是一个遗忘门，控制信息丢失；二者共同决定隐藏状态的输出。"
"由于目前古汉语命名实体识别缺乏公开的标注数据集，因此本文人工构建了一个古汉语命名实体识别数据集。该数据集包括训练集、开发集、测试集，训练集共包含43.995 K个字，开发集包含5.843 K个字，测试集包含5.849 K个字。各类实体统计如表2所示。 Table 2 数据集 语料数量 人名数量 地名数量 职官数量 训练集 43,995 1,255 2,671 101 开发集 5,843 125 285 37 测试集 5,849 144 315 26 表2. 实体个数统计  命名实体识别的标注策略有BIO模式，BIOE模式，BIOES模式。本文采用的是BIO标注策略，其中B表示实体开始，I表示实体非开始部分。O表示不是实体的部分。在预测实体边界的时候需要同时预测实体类型，所以待预测的标签一共7种，分别是O，B-PER，I-PER，B-LOC，I-LOC，B-POS，I-POS。在测试过程中，只有当一个实体的边界和实体的类型完全正确时，才判断该实体预测正确。 命名实体识别的评价指标有精确率(P)、召回率(R)和F1值。具体定义如公式(7)：T p 为模型识别正确的实体个数，F p 为模型识别到的不相关实体个数，F n 为相关实体但是模型没有检测到的个数。 P = T P T P + F P × 100 % R = T P T P + F n × 100 % F 1 = 2 × P × R P + R × 100 % (7)  本研究中的实验环境为Python3.6，深度学习框架为Pytorch1.4.0神经网络超参的取值会影响神经网络的性能。本文的神经网络参数设定如表3所示。 Table 3 参数 取值 参数 取值 音节向量维度 50 词向量维度 50 Lattice向量维度 50 Lattice丢弃率 0.5 丢弃率(Dropout) 0.5 学习率(lr) 0.05 LSTM层 1 主LSTM隐藏层维度 200 表3. 神经网络超参取值  为了验证本研究中所使用的模型对古汉语命名实体识别数据集中的人名、地名、官职三大类实体的识别性能，本文分别采用三种神经网络模型设计了三个实验。其中主要实验模型为Lattice LSTM，对比实验模型为BiLSTM-CRF和BiLSTM-CNN-CRF。实验的评价指标有准确率(P)、召回率(R)和综合指标F1值。各模型实验结果见表4。 Table 4 模型 准确率 召回率 F1值 BiLSTM-CRF 88.30 87.70 87.92 BiLSTM-CNN-CRF 89.50 89.10 89.25 Lattice LSTM 92.42 91.90 92.16 表4. 各模型的实验结果(%) 实验结果表明Lattice LSTM模型能有效提升实体识别的性能。各模型随着训练轮数F1值变化如图7所示。  以本研究构建的数据集中的一个句子为例展示Lattice LSTM模型的实体识别效果。具体实例如表5所示。 图7. F1值变化图 Table 5 句子 故以舜汤武不遭时不得帝王 正确的分词 故以舜汤武不遭时不得帝王 自动分词 故以舜汤武不遭时不得帝王 Lattice分词 故以舜汤汤武舜汤武不遭遭时不遭时不得帝王 BiLSTM-CRF 故以舜汤武 PER 不遭时不得帝王 POS BiLSTM-CNN-CRF 故以舜汤武 PER 不遭时不得帝王 POS Lattice LSTM 故以舜 PER 汤 PER 武 PER ，不遭时不得帝王 POS 表5. 古汉语实体识别实例 注：斜体表示识别不正确的实体，粗体表示识别正确的实体。"
"针对古汉语命名实体识别所面临的问题，本文采用了一种同时关注字信息和词信息进行实体识别的深度学习模型。该模型将传统的LSTM单元改进为网格LSTM，在字符模型的基础之上显性利用词和词序信息，从而避免了分词错误传递的问题；利用具有长短期记忆功能的LSTM模型作为隐藏层，可以解决古汉语文本中部分实体结构较长的问题；最后使用CRF作为标签推理层以解决文本序列标签依赖问题。在已构建的古汉语命名实体识别数据集上进行实验，实验结果证明了Lattice LSTM模型的有效性。 今后，本文的研究工作应该在数据和词典规模方面加大力度，从而进一步提高模型的整体性能。另外，还应该针对古汉语文本进行广泛深入的语言信息处理方面的研究，以便获得更多有价值的知识。"
