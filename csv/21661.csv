"现代人类90%的生命周期在室内度过，因此，室内环境质量不仅影响到室内滞留人员的工作效率，也直接与其身体健康具有很高相关性。本文针对室内热舒适度评价机制不足的问题，依据FAHP(Fuzzy Analytic Hierarchy Process)热舒适度评价模型设计一种基于51单片机和蓝牙无线通信协议的室内环境热舒适度感知系统。系统用单片机、温湿度传感器、光强传感器采集环境参数并采用FAHP算法得到室内环境热舒适度测量值与标准舒适值的权重比，比值为1时表明当前环境为最舒适状态。系统包括软件系统和硬件系统。通过无线蓝牙模块将数据发送到电脑上的虚拟服务器以实现数据在个人网页上显示的功能。实验结果，系统能够将室内环境热舒适度量化，并给出舒适度排序结果。结果可用于室内建筑热环境评估，也可以为建筑节能提供理论依据。 关键词 :热舒适度感知系统，单片机，FAHP算法，无线蓝牙模块 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"加速的城市化进程以及生活水平的提高，使得人们对室内环境质量的关注度日益提高 [ 1 ] 。相关研究表明，现代人类90%的生命周期在室内度过，因此，室内环境的质量不仅关系到工作效率，更是与身体健康水平具有密切关系 [ 2 ] 。同时，在不影响室内人员舒适度前提下，实现建筑节能也是当前智能建筑研究的热点 [ 3 ] 。 影响室内滞留人员舒适度的因素众多，其中环境热舒适度是最重要的影响因子之一。影响室内热环境的各个变量之间存在非线性、强耦合的关系，且具有时变特性，导致室内热环境成为了一个复杂的多变量系统，因此，建立室内热环境的量化模型并实现热舒适度的智能化控制一直是学界和业界的研究热点及难点 [ 4 ] 。 预测平均投票(PMV)是用来定义用户在一定环境中的热舒适条件的国际指数，PMV模型是较受认可的热舒适标准评价模型之一 [ 5 ] 。通过估算人体活动的代谢率及服装的隔热值可以获得PMV指数，同时还需要获取以下几个重要的环境参数：空气温度、平均辐射温度、相对空气流速及空气湿度。从本质上来说，PMV指数基本上就是根据人体的热平衡原理来计算的 [ 6 ] 。 自从PMV热舒适评价模型被提出以来，不少专家和学者根据这个模型做了大量的关于热舒适评价的研究，既包括一些理论实验研究，也包含不少现场研究 [ 7 ] 。有些实验得到的结果与PMV热舒适模型预测结果相比差别不是很大，而有些实验的结果则和PMV热舒适模型预测结果相比有较大的偏差。这些有较大偏差的实验结果往往都是在现场研究中得来的。但是，PMV作为到目前为止提出的最全面的热环境评价指标，依然被大量地用于建筑环境的舒适度评价方面 [ 8 ] 。 本文拟使用模糊层次分析法，对无线传感网获取的热舒适度系统参量进行评估，获取量化指标，实现对室内环境热舒适度的量化度量。"
"室内环境热舒适度感知系统的硬件系统分为三个模块：环境数据采集模块、数据传输模块和BOA服务器模块。 数据采集系统由DHT11温湿度传感器、GY-30数字光照强度监测模块和 89C 52RC单片机组成，该系统中DHT11温湿度传感器和GY-30数字光照强度监测模块主要完成多环境参数的数据采集，如室内环境的温度、相对湿度和光照强度(图1)。 89C 52RC单片机与温湿度传感器DHT11和光照强度传感器BH1750FVI通信，负责收集数据，并将多个数据通过HC-05无线蓝牙模块上传到Linux系统内的虚拟服务器。BOA服务器模块用来接收环境数据并且以网页的形式将结果展示给用户 [ 9 ] 。  图2所示为系统的软件框图。如图所示，本地端设备的程序主要负责控制传感器采集室内环境的数据，并通过模糊层次分析法处理数据，然后通过无线蓝牙模块将数据上传到服务器端 [ 10 ] 。服务器端通过串口读取程序接收本地端设备上传的数据，然后通过CGI程序实现浏览者与服务器之间的交互，并将数据结果通过Web网页的形式展示给用户。 图3所示为系统软件流程图，本地端设备程序主要包含数据采集端的程序和算法处理端的程序，工作过程具体为： 1) 设备上电启动后，先初始化硬件设备，主要包括系统启动，参数设计等，设备处于接收状态，然后等待蓝牙配对，配对成功后，单片机便进入一个主循环中，该循环不断地进行当前环境温度、湿度以及光照强度的测量； 2) 服务器端软件主要分为串口读取程序和CGI程序。写一个串口读取程序来读取蓝牙模块上传的数据。串口读取到数据之后通过进程间通信传给CGI程序，CGI程序与网页交互，将数据传送到网页上； 3) 模糊AHP算法处理主要包括基于环境参量获取后的指标权重计算以及不同环境与标准环境的参数评估，用来判断当前状态的舒适度，网页上主要显示当前环境下的温度值、湿度值、光强值、以及测量值权重和标准值权重。 图1. 硬件系统图 图2. 软件系统框图 图3. 本地端设备软件设计流程图"
"算法处理端在接收到数据后需要对数据进行处理，基于模糊层次分析法处(FAHP)，实现室内环境热舒适度的结果量化以及显示。 运用模糊层次分析法测量室内环境热舒适度时先建立层次结构模型，然后构造准则层的判断矩阵，得出温度、湿度和光强对室内热环境舒适度的影响所占的权重，由于本设计只考虑三个影响因素，因此不用做一致性检验 [ 11 ] 。最后构造方案层的判断矩阵，得出当前室内环境热舒适度测量值与室内环境热舒适标准值所占的权重，最终得出结论。  图4所示为本系统的层级结构模型，如图所示，本系统包含三层，即最高层目标层、准则层和方案层 [ 12 ] 。准则层中使用温度、湿度和光强作为舒适度指标。方案层包含标准舒适度状态值以及实际的测量值。  设某层有n个因素，要比较它们对上一层的某一准则或目标的影响程度，确定它们在该层中相对于某一准则所占的比重，即把n个因素对上一层某一目标的影响程度进行排序。上述比较是在两两因素之间进行的比较，比较时用数字1到9来表示尺度 [ 13 ] 。用a ij 表示第i个因素相对于第j个因素的比较结果，则 (1) (2) 图4. 层次结构模型 Table 1 标度 定义 含义 1 同样重要 两个因素对于某个准则来说同样重要 3 稍微重要 两个因素对于某个准则来说，因素一比因素二稍微重要 5 明显重要 两个因素对于某个准则来说，因素一比因素二明显重要 7 强烈重要 两个因素对于某个准则来说，因素一比因素二强烈重要 9 极端重要 两个因素对于某个准则来说，因素一比因素二极端重要 2,4,6,8 相邻标度中值 表示相邻两个标度之间折中时的标度 上列标度倒数 反比较 元素i对元素j的标度为a ij ，反之为1/a ij 表1. FAHP比较尺度 FAHP的比较尺度如表1所示。 论域通常用U来表示，指将所讨论的对象限制在一定的范围之内，并把所讨论的对象的全体成员称为论域。设论域U，如果存在 ，则称 为 的隶属度，从而一般称 为A的隶属函数。明确集合A：元素x不是属于A就是不属于A [ 14 ] 。隶属函数为： (3) 模糊集合A：元素x常以某个程度 属于A，而非 或x不属于A。 在此基础上，荷兰学者F.J.M. Van Laarhoven和W. Pedrycz提出了用三角模糊数表示模糊比较判断的方法：设论域R上的模糊数M，M的隶属度函数表示为 (4) 式中 ，l和u分别表示M的下界值和上界值。m为M的隶属度为1的中值。 如图5所示，一般三角模糊数M表示为(l,m,u)，当x = m时，x完全属于M，l和u分别表示下界和上界。当x在l或u以外时就是完全不属于模糊数M [ 15 ] 。例如用(4,5,6)表示i方案比j方案明显重要这一模糊判断。当隶属度为1时，这一判断标度为5；当隶属度为x-4时，判断标度为x( )；当隶属 图5. 三角模糊数 度为6-x时，标度为x( )。 两个三角模糊数M 1 和M 2 的运算方法： (5) 本系统目的是测量室内环境热舒适度，主要考虑三个因素：温度、湿度和光强，通过咨询三个专家得到了它们的模糊评价矩阵(表2)。 每组的三个比较模糊值，可以通过相加求平均值的方法整合为一个模糊值，例如温度比湿度的值为( , , )，由此可以得到模糊矩阵表3。 然后计算温度、湿度、光强的综合模糊值： ; ; ; 计算出温度、湿度和光强的综合模糊值后，通过图6所示的去模糊化方法，求出温度、湿度和光强 Table 2 温度 湿度 光强 温度 (1,1,1) (1,2,3) (1,2,3) (1,1,2) (1,2,3) (2,3,4) (2,3,4) 湿度 (1/3,1/2,1) (1/3,1/2,1) (1/2,1,1) (1,1,1) (1,2,3,) (1,2,3) (2,3,4) 光强 (1/3,1/2,1) (1/4,1/3,1/2) (1/4,1/3,1/2) (1/3,1/2,1) (1/3,1/2,1) (1/4,1/3,1/2) (1,1,1) 表2. 模糊评价矩阵 Table 3 温度 湿度 光强 温度 (1,1,1) (1,1.67,2.67) (1.67,2.67,3.67) 湿度 (0.39,0.67,1) (1,1,1) (1.33,2.33,3.33) 光强 (0.28,0.39,0.67) (0.31,0.44,0.83) (1,1,1) 表3. 模糊权重值 图6. 去模糊化几何解释图 所占的最终权重。模糊数 的可能度用三角模糊函数定义为： (6) ; ; ; ; ; ; 可以得到三个指标分别所占的权重值： ; ; ; 将以上权重值标准化，得到温度、湿度和光强的最终权重： ； ； 。 因此，本设计中温度、湿度和光强三个指标对于室内环境热舒适度的影响所占的权重分别为0.51、0.4和0.09。  得到温度、湿度和光强三个指标分别所占的权重之后，需要求出在每个指标下测量值与舒适标准值所占的权重比，从而求出当前环境热舒适度测量值与热舒适标准值所占的权重比。方案层的三个判断矩阵分别如下表4~6所示。 其中a代表当前环境下温度的测量值与舒适温度标准值相比较得到的评价尺度，相关研究表明：当温度测量值在18~ 24 摄氏度 时，属于舒适范围，这时a的值为1；当温度测量值在10~17和25~32摄氏 Table 4 温度 测量值 标准值 测量值 a 1 标准值 1 1/a 表4. 温度判断矩阵 Table 5 湿度 测量值 标准值 测量值 b 1 标准值 1 1/b 表5. 湿度判断矩阵 Table 6 光强 测量值 标准值 测量值 c 1 标准值 1 1/c 表6. 光强判断矩阵 度时，属于不太舒适范围，这时a的值为3；当温度测量值在2~9和33~42摄氏度时，属于不舒适范围，这时a的值为5；当温度测量值在其他范围时，属于很不舒适范围，这时a的值为7。以此类推，b和c分别代表当前环境下湿度和光强的测量值与舒适标准值相比较得到的评价尺度。通过测量到的环境数据可以得出测量值所占权重和标准值所占权重，当测量值权重越接近标准值权重时表明当前环境越贴近标准舒适环境，如测量值所占权重为0.5，标准值所占权重为0.5，就说明当前环境处在一个非常舒适的状态。"
"基于模糊层次分析法的室内环境热舒适度感知系统的本地端架构实物图如下图所示。图7是本地端设备在进行室内环境的数据采集，温湿度、光强传感器以及蓝牙模块同时工作。图8是无线蓝牙模块与电脑连接，接收本地端设备上传的数据。  系统实验环境如下： 图7. 本地端设备开始进行数据采集 图8. 蓝牙设备开始接受数据 实验时间：安排在4、5月份； 实验地点：苏州科技大学，具体地点为学生宿舍； 实验内容：试验共分为两组，第一组实验是在温度为28摄氏度、湿度为41%、光强为19LX的正常环境下进行测量，查看当前环境的舒适度结果。第二组实验是在改变了室内环境的条件下进行测量得到热舒适度结果。对比两组试验得到的结果，对系统的可行性做一个有效的评估。下面是两组实验得到的结果显示图9和图10。 图9. 实验一结果图 图10. 实验二结果图  实验结果表明，实验一的环境温度为28摄氏度、湿度为41%、光强为18LX，热舒适度的测量值权重为0.66，实验二的环境温度为30摄氏度、湿度为38%、光强为15LX，热舒适度的测量值权重为0.79。可以看出实验一的热舒适度测量值权重更加接近舒适度标准值权重，也就是说，实验一的环境更加贴近标准热舒适环境，实验二的环境温度相比略高，湿度略低，这也与体验者感受一致。"
"室内环境的热舒适度和光照舒适度是衡量室内环境质量的重要因素，直接影响到滞留人员的工作效率以及身体健康。面对室内环境舒适度评估体系中存在的定性描述过多、缺乏定量描述的问题，提出了一种基于模糊层次分析法的室内环境舒适度的定量描述方法，实验结果表明，方法能够有效给出不同环境下的舒适度定量描述，可以直观看出不同环境与舒适环境的定量差异。结果可以为室内环境舒适度的评估提供一定方法，也可以为室内节能提供主要依据。"
