"根据相位测量轮廓术的基本原理，利用MATLAB的用户界面设计了基于相位测量轮廓术的仿真交互界面，给出了三维面形测量的仿真结果。该仿真可以将三维面形测量和实验很好的结合起来，具有一定的参考价值。文中给出了理论分析和计算机模拟。 关键词 :三维测量，GUI界面，相位测量轮廓术"
"近年来，随着工业的快速发展和科技的进步，光学三维测量技术以其非接触性、测量精度高、测量速度快等优点在制造业、航空航天、文物保护等领域具有广阔的应用前景 [ 1 ] - [ 5 ] 。相位测量轮廓术(Phase Measuring Profilometry，简称PMP)在三维面形测量中发展迅速，其理论已经相当成熟。PMP一般需要采集3帧以上的条纹图来恢复被测物体面形，是目前结构光三维面形测量中精度最高的一种，引起国内外研究者的关注。 在理论教学中，被测物体的三维面形与测量系统结构和相移量有关系。在实验中，如果将系统的结构参数和光栅相移作为实验内容，由于光学仪器比较精密，调节起来相对复杂，耗费大量的时间。因此，学生在仪器调节步骤上花费时间长，难以深入观察实验现象、不能更好的理解实验原理。为了更好的解决以上问题，本文通过MATLAB GUI技术开发了三维面形测量仿真软件。该仿真软件可以对相位测量轮廓术在不同参数条件下进行仿真模拟，互动式界面中采用滚动条动态展现系统参数、相移与物体高度之间的关系，仿真结果更加直观，有利于加深学生对PMP原理的理解和认识，便于学生对PMP的研究和学习 [ 6 ] 。"
"相位测量轮廓术系统原理如图1所示， ， 是系统结构参数。当一幅正弦光栅图像被投影到三维漫反射物体表面上时，通过成像系统获得变形光栅像可表示 [ 7 ] 为 (1) 图1. 测量系统原理图 式中， 表示物体表面不均匀的反射率， 表示背景强度， 表示条纹对比度。相位函数 表示了条纹的变形，包含了待测物体的高度信息。 连续投影4幅具有 相移量的正弦条纹，所产生相应的4帧变形条纹图像可表示为 (2) (3) (4) (5) 由(2)、(3)、(4)、(5)式，可以计算出相位函数 (6) 由上式计算出的相位分布 被截断在反三角函数的主值范围内，必须将其展开成连续的相位分布。相位与高度 之间的映射关系可以表示 [ 7 ] 为 (7) 利用上式的映射关系就可以计算出待测物体的三维面形。"
"为了更加便捷地操作与直观地展示三维面形测量的仿真结果，在相位测量轮廓术Matlab程序的基础上添加了GUI图形用户界面。GUI是指采用图形方式显示的计算机操作用户界面，通过GUIDE工具来设计 [ 8 ] 。  新建一个fig文件，命名为PMP_Simulation.fig。在布局编辑器中设置如下控件：建立4个坐标轴对象用来显示模拟物体图、变形条纹图、恢复物体图和误差分析图；建立5个静态文本标签，标注相应的控件提示；建立5个可编辑文本框，分别显示系统参数L、d、条纹周期T、噪声noise和最大误差Error;建立4个滑动条用来控制系统参数L、d、条纹周期T、噪声noise；建立2个按钮，用来开始和结束程序，如图2所示。  打开M文件，进行相关的代码的编写，并将可编辑文本框和滑动条进行相互控制，以便于更改参数的操作。在MATLAB里进行相关的代码程序编写之后，将系统参数L和d的初始默认值设为75 cm和20 cm，条纹周期的初始默认值设为0.4，噪声的初始默认值为0.03，仿真演示时，再根据需要调节参数值或者滑动条。  在点击开始按钮，并对基本参数进行设置之后，便能够清晰的在交互式界面中显示出模拟物体图、变形条纹图、恢复物体图和误差图，并且能够显示出在这种方法下的最大误差，仿真结果如图3所示。 图2. Matlab GUI界面设计图 图3. 仿真结果"
"为了能够更加清晰地展示我们所提出的方法的实用性，可以通过以下这个具体实验来展现，也就是以下所展示的——通过MATLAB的仿真交互式界面恢复物体葫芦的实验，被测物体如图4(a)所示。 图4. 实验 首先，将GUI界面设计好，新建一个fig文件，命名为pmp_experiment.fig，在布局编辑器中设置各需要的控件。进行相关的代码的编写，将读取图片、计算相位、恢复物体等步骤的代码编写好。 接着，采集恢复物体需要的图片。实验采用奥图马投影仪(EP728)投影条纹到葫芦模型上，在与投影仪成一定夹角的方向上用CCD相机(JAI CV-A50)获取条纹图和变形条纹图，测量系统参数为L = 760 mm，d = 220 mm。采集到的图如图4(b)、图4(c)所示。 最后将采集到的条纹图和变形条纹图(共八张)，经由设计好的程序读取，转换为需要的可计算的数据，经由MATLAB GUI设计的相位测量轮廓术三维面形测量仿真软件将该数据进行相应的图像计算方面的处理之后，恢复出所需的物体，最终的结果如图4所示。"
"利用MATLAB GUI设计的相位测量轮廓术三维面形测量仿真软件，通过在界面中修改相关参数，实现在不同参数情况下的仿真测量并进行一定程度上的误差结果分析。操作简单、使用方便，避免了因光学仪器比较精密，调节起来相对复杂，从而影响实验现象的深入观察，使同学能够对相位测量轮廓术(PMP)理解更加深刻。同时，通过参数的直接修改，模拟过程的直接呈现，使得图像细致逼真，误差清楚直观，对学生三维测量的学习和深入理解有积极作用。"
