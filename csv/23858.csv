"相关干涉仪是当前最常用的测向体制之一。传统相关干涉仪测向算法需要将测量的相位差与样本库中的所有相位差进行相关运算，计算量较大，在需要对信号进行快速测向的场景下，测向效率有时难以令人满意。针对此问题，本文提出一种相关干涉仪测向算法的快速实现方法，基于前后两次测量相位差之间的相关系数，缩小样本库中可用样本的个数，可有效减少相关运算次数。仿真结果验证了该方法相比传统算法减小了相关计算所需时间，提高了测向效率。 关键词 :测向，相关干涉仪，相关系数 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"无线电测向是利用无线电测向设备测量空中的无线电信号并获取信号发射源方位的过程，被广泛应用于无线电管理、航海航空救援、抢险救灾、射电天文、医学电子、电子对抗等民用和军用的诸多领域。常用的测向体制包括比幅测向法 [ 1 ] 、时差测向法 [ 2 ] 、相位测向法 [ 3 ] 和空间谱估计测向法 [ 4 ] 等。相关干涉仪测向是相位测向法的一种，测向精度和灵敏度都比较高，可同时获取方位和仰角信息，适用于多种天线阵形式，并且因为引用了相关处理，可以避免普通相位干涉仪中存在的相位模糊问题，是当前应用最为广泛的测向体制之一。但是相关干涉仪测向需要将测量的相位差与样本库中的相位差进行相关运算，运算量相对较大，尤其是在进行宽带频段测向的时候，如果测向接收机实时带宽内存在信号较多，需要对多个信号进行测向，那么测向消耗的时间比较多，效率难以令人满意。针对这一问题，当前的主要解决思路有两种：算法加速和硬件加速。算法加速方法中，当前研究比较多的是基于基线引导式的快速测向算法 [ 5 ] [ 6 ] ，使用一条或者多条基线计算可能的角度信息，然后只对这些可能角度进行相关计算，即先进行相位干涉仪测向，再进行相关干涉仪测向，但是由于受到天线阵子间的耦合影响，相位干涉仪测向误差较大，导致该方法的测向准确度难以满足实际要求。硬件加速有两种：基于FPGA的算法实现 [ 7 ] 和基于GPU的算法实现 [ 8 ] 。基于FPGA的测向算法实现需要在FPGA中进行大规模的并行相关运算，设计非常复杂，实现难度很大。基于GPU的实现方法需要将测量的相位差传输至安装有特定型号GPU的主机板上，再使用GPU进行相关运算，因此该方法会引入额外的硬件成本。因此，本文提出一种相关干涉仪测向算法的快速实现方法，适于在DSP或者嵌入式板卡中实现，并通过仿真与传统方法和文献 [ 6 ] 提出的基线引导方法进行比较，验证了方法的有效性。"
"相关干涉仪测向原理如下： 在一个无模糊的阵列中，对给定方向、给定仰角、给定频率的已知(校正信号)到达波，测出阵列中各阵元间的相位差，即为对应方向、仰角、频率的信号的相位差样本；在所设计的天线阵列工作频率范围内，按照一定规律选择方位、仰角、频率，依次建立样本群，作为标准模板存起来，形成相关计算的标准样本库。以角度个数为N，天线振元对个数为M为例，某个频率的样本库为 Φ = [ φ 11 φ 12 ⋯ φ 1 N φ 21 φ 22 ⋯ φ 2 N ⋮ ⋮ ⋱ ⋮ φ M 1 φ M 2 ⋯ φ M N ] = [ φ 1 , φ 2 , ⋯ , φ N ] (1) 可用角度索引集合为 I = { i | 1 ≤ i ≤ N ,   i ∈ ℤ } (2) 式中： ℤ 表示整数集。 每一个角度索引i对应一个方位和仰角的组合，如果以1˚步进方位和1˚步进仰角建立样本库，则 N = 360 × 90 = 32400 。样本库中在角度索引i的样本相位差为 φ i = [ φ 1 i , φ 2 i , ⋯ , φ M i ] T , i ∈ I (3) 式中： ( ⋅ ) T 表示转置。 对该频率未知信号测向时，先按照采集样本的规则采集未知信号，得到其相位差 φ ^ = [ φ 1 , φ 2 , ⋯ , φ M ] T (4) 将该相位差与样本库中的样本进行相关运算处理得到相关系数 ρ i = | φ i H φ ^ | ‖ φ i ‖ ⋅ ‖ φ ^ ‖ (5) 式中： ( ⋅ ) H 表示共轭转置， ‖ ⋅ ‖ 表示2-范数。 ρ i 的最大值的索引i对应的是测得的角度。 从式(5)中可以看到，如果样本库中的相位差和测量的相位差都已进行了归一化处理，那么单次相关运算就是两个M维矢量的内积运算，单个信号测向需要进行N次相关运算。当需要进行测向的信号较多的时候，运算量会变得很大，因此，有必要对单个信号测向的运算量进行优化。"
"考虑到相关干涉仪测向过程，就是在样本库中查找与测量相位差相关性最强的样本的过程，而在一个稳定的环境中，对同一信号进行多次测量得到的相位差之间应当具有较高的相关系数，因此可以利用原有的测向结果和相关曲线，对样本库中的使用样本进行限定，减少相关运算的次数。  由式(5)可以发现，相关运算得到的相关系数 ρ i 正是矢量 φ ^ 与矢量 φ i 的夹角 α ( φ ^ , φ i ) 的余弦，即 ρ i = cos [ α ( φ ^ , φ i ) ] (6) 式中： 0 ≤ α ( φ ^ , φ i ) ≤ π 。 因此，可以将相关系数的比较转化为矢量夹角的比较。 若 ρ i 取最大值时的角度索引为 i max ，对应的矢量夹角为 α min = α ( φ ^ , φ i max ) (7) 当再次进行测向时，测量得到的相位差矢量为 φ ^ ′ 。首先计算 φ ^ ′ 与 φ ^ 之间的夹角 α ( φ ^ , φ ^ ′ ) ，如果满足公式 α min + 2 × α ( φ ^ , φ ^ ′ ) < π / 2 (8) 则生成相关系数门限 ρ th = cos [ α min + 2 × α ( φ ^ , φ ^ ′ ) ] (9) 由此可以产生一个角度索引子集 K = { k | ρ k ≥ ρ th ,   k ∈ I } (10) 显然， i max ∈ K ，故 K 不是空集。 假设存在 h ∈ I , h ∉ K ，则 ρ h < ρ th ，即 α ( φ ^ , φ h ) > α min + 2 × α ( φ ^ , φ ^ ′ ) (11) 由此可以得到 α ( φ ^ ′ , φ h ) ≥ α ( φ ^ , φ h ) − α ( φ ^ , φ ^ ′ ) > α min + 2 × α ( φ ^ , φ ^ ′ ) − α ( φ ^ , φ ^ ′ ) > α min + α ( φ ^ , φ ^ ′ ) (12) 同时，又有 α ( φ ^ ′ , φ i max ) ≤ α ( φ ^ , φ i max ) + α ( φ ^ , φ ^ ′ ) ≤ α min + α ( φ ^ , φ ^ ′ ) (13) 所以可以得到 α ( φ ^ ′ , φ h ) > α ( φ ^ ′ , φ i max ) (14) 即 φ ^ ′ 与 φ h 的相关系数小于 φ ^ ′ 与 φ i max 的相关系数，因此得出结论，在 Φ 中与 φ ^ ′ 相关系数最大的角度索引必定是集合 K 的元素，所以在对 φ ^ ′ 进行测向时，只需要与 K 中所有角度索引的样本做相关运算和峰值搜索即可。 如果不满足式(8)，说明采集的相位差与样本库中的样本的相关性很差，或者两次采集信号的相位差相关性很差，这种情况下只能与样本库中所有的样本进行相关运算再进行峰值搜索。  根据上一节的推导分析，相关干涉仪快速实现方法的流程如下： · 1) 首次进行测向，将采集的相位差矢量 φ ^ 与样本库中所有角度的样本进行相关计算，得到 ρ i ； · 2) 搜索 ρ i 中的最大值，得到本次测向的结果 i max ，记录最大值对应的矢量夹角 α min ； · 3) 进行下一次测向，计算采集的相位差矢量 φ ^ ′ 与 φ ^ 的夹角 α ( φ ^ , φ ^ ′ ) ； · 4) 如果不满足公式(8)，则重复步骤1)； · 5) 如果满足公式(8)，则将按照式(9)计算相关系数门限，将 ρ i 中所有不小于 ρ th 的角度索引生成新的角度索引集合 K ； · 6) 将 φ ^ ′ 与 K 中所有角度的样本进行相关运算，并进行峰值搜索，得到测向结果； · 7) 重复步骤3)，继续进行测向。  使用MATLAB生成仿真数据，再使用VC++6.0对传统实现方法、文献 [ 6 ] 提出的基线引导方法和本文实现方法进行仿真比较。选择直径为0.9 m的9元均匀圆阵天线，选择30 MHz、100 MHz和300 MHz三个频率进行比较分析，分别在–20 dB~20 dB信噪比下进行1,000,000次蒙特卡洛试验。 首先，为了验证本文方法推导的正确性，对本文方法测向结果与传统算法测向结果的一致性进行仿真验证。记第q次蒙特卡洛试验中传统算法得到的角度索引为 i q 1 ，本文方法得到的角度索引为 i q 2 ，使用以下公式对两种方法的一致性进行计算。 Δ = ∑ R SN = − 20 20 ∑ q = 1 1000000 | i q 1 − i q 2 | (15) 式中： R SN 表示信噪比。 分别对三个选择频率进行仿真，结果如表1所示。 表1的结果表明，本文方法得到的角度索引与传统方法完全一致。 然后，对相关计算时间进行仿真，结果如图1、图2和图3所示。 Table 1 频率 30 MHz 100 MHz 300 MHz Δ 0 0 0 表1. 一致性仿真结果 图1. 30 MHz相关计算时间仿真结果 图2. 100 MHz相关计算时间仿真结果 图3. 300 MHz相关计算时间仿真结果 由仿真结果可以看到，当信噪比很低的时候，本文方法的相关计算时间与传统方法接近，高于基线引导方法，这是因为在低信噪比的情况下，受到噪声的影响，采集相位差与样本库相位差之间的相关系数很低，两次采集的相位差之间的相关系数也很低，即 α min 和 α ( φ ^ , φ ^ ′ ) 较大，无法满足式(8)的条件，每次测向都需要对样本库中的所有角度进行相关和搜索，因而相关计算时间与传统方法接近。 在信噪比较高的时候，本文方法可以极大地减少相关计算时间，在20 dB信噪比时，本文方法的相关计算时间只有传统方法的十分之一，基线引导方法的三分之一。"
"本文针对传统相关干涉仪测向算法计算量大的缺点，提出一种相关干涉仪测向算法的快速实现方法，根据上一次全向搜索的相关曲线和两次测量信号相位差之间的相关系数，确定相关计算使用的样本范围，减小相位差相关运算次数。使用VC进行仿真，验证了该方法在较高信噪比的情况下相比传统算法减小了相关计算时间，提高了测向效率；在低信噪比的情况下，本文方法与传统方法的相关计算时间接近，无明显的改善。"
