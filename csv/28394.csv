"VSP作为一种地球物理勘探方法在油田勘探开发中扮演着越来越重要的角色。它通过井中垂直排列上的波场响应，求地球物理参数、速度场信息、层位识别、井旁构造形态和地层岩性特征等，解决这些反问题的能力得到很大提高。同时为了更好的解决反问题首先也要处理好正问题—VSP正演模拟。下文以XX井为例，综合应用地震资料，测井资料，分别进行了基于射线理论和基于波动方程的两种VSP正演模拟的实现过程，并结合野外实际采集资料对比了二者方法的差异和优劣势。 关键词 :VSP正演模拟，射线理论，波动方程，射线追踪，正演道集记录 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"近年来VSP在“三高”地震勘探中扮演着重要角色，在油田勘探开发中发挥重要作用，解决反问题的能力得到很大提高，而应用这些的前提是解决好正问题。因此，VSP正演模拟受到越来越多的关注。正演模拟主要是基于射线理论和波动方程理论，两种方法都能实现VSP正演模拟，可以从理论上研究VSP的波场特征，指导VSP施工方案设计，提供资料采集质控依据，是VSP资料处理解释中必不可少的环节。迄今为止，国内外很多学者已经提出多种提高数值模拟精度的方法 [ 1 ] [ 2 ] [ 3 ] [ 4 ] ，Dablain [ 5 ] 应用不同差分近似阶数情况下的声波方程进行波场的对比研究，认为差分近似阶数越高，精度也越高；Alford [ 6 ] 指出网格大小和地震波传播方向是影响声波方程有限差分法频散的两个主要因素；裴正林、陈可洋等 [ 7 ] [ 8 ] 提出了声波、弹性波等的高阶交错网格有限差分方法，实现了地震波场高精度正演数值模拟；Fei T等 [ 9 ] 应用通量传输校正(FCT)技术有效压制了数值频散问题；董良国、吴国忱、宁刚、陈可洋等 [ 10 ] [ 11 ] [ 12 ] [ 13 ] 研究了正演模拟的频散问题、分析了误差来源及边界吸收问题，并提出了相应的解决办法。在前人研究的基础上，下文重点讨论基于射线理论方程的射线迭代法和基于波动方程的交错网格高阶有限差分法的原理，正演模拟实现过程，射线追踪，正演道集记录，进行了两者正演道集记录对比分析以及与实际野外采集道集记录的比较，同时总结了两者方法的优势和劣势。"
"各向同性介质波的运动方程如下式 [ 14 ] ： ρ ∂ 2w ∂ 2 t = ( λ + μ ) ∇ ( ∇ ⋅ w ) + μ ∇ 2 w + ∇ λ ( ∇ ⋅ w ) + ∇ μ × ( ∇ × w ) + 2 ( ∇ μ ⋅ ∇ ) w (1) 式中： ρ 是弹性介质密度；W为波函数； λ 、 μ 是拉梅系数； ∇ 是哈密顿算子。 ∇ = i → ∂ ∂ x + j → ∂ ∂ y + k → ∂ ∂ z (2) ∇ μ = i → ∂ u ∂ x + j → ∂ u ∂ y + k → ∂ u ∂ z (3) ∇ ⋅ W = i → ∂ Wx ∂ x + j → ∂ Wy ∂ y + k → ∂ Wz ∂ z (4) ∇ × W = | i → j → k → ∂ x ∂ y ∂ z W x W y W z | (5) 假定方程(1)的时间简谐函数的解可用 ω 的负幂数表示为： W = exp [ j ω ( t − τ ) ] ∑ k = 0 ∞ ( j ω ) − k W k (6) 式中 τ 、 W k 与 ω 、t没有关系。(6)式为射线级数 [ 14 ] ， W k ( k = 0 , 1 , 2 , ⋯ ) 为射线级数的振幅系数， τ 是相位函数，波前是运动着的等相位面 t = τ ( x , y , z ) ，与波前正交的轨迹线称为射线，射线在其与波前交点的方向与该点波前的梯度 ∇ τ 的方向相同。假定 ∇ τ ≠ 0 ，否则(6)式将不表示传播着的波。 τ 和 W k ( k = 0 , 1 , 2 , ⋯ ) 都是坐标的未知函数，如果知道某些初始条件，将(6)式代入(1)式后，可确定 τ 和 W k ( k = 0 , 1 , 2 , ⋯ ) 。 为了求相位函数 τ 和振幅系数 W k ，先给出射线理论基本方程组。 { N ( W 0 ) = 0 N ( W 1 ) − M ( W 0 ) = 0 N ( W k ) − M ( W k − 1 ) + L ( W k − 2 ) = 0 ( k ≥ 2 ) (7) (7)式中 { N ( W k ) = − ρ W k + ( λ + μ ) ( W k ⋅ ∇ τ ) ∇ τ + μ ( Δ τ ) 2 W k M ( W k ) = ( λ + μ ) [ ∇ ( W k ⋅ ∇ τ ) + Δ τ ( Δ ⋅ W k ) ] + μ [ 2 ( ∇ τ ⋅ ∇ ) W k + ( ∇ 2 τ ) W k ]                             + ∇ λ ( W k ⋅ Δ τ ) + ∇ μ × ( ∇ τ × W k ) + 2 ( Δ μ ⋅ Δ τ ) W k L ( W k ) = ( λ + μ ) ∇ ( ∇ ⋅ W k ) + μ ∇ 2 W k + ∇ λ ( ∇ ⋅ W k ) + ∇ μ × ( ∇ × W k ) + z ( ∇ μ ⋅ ∇ ) W k (8) 且 λ 、 μ 、 ρ 及其相应的导数连续； τ 是解析函数，且 Δ τ ≠ 0 , W 0 ≠ 0 ； λ 、 μ 、 ρ 及其相应的导数在短距离内的变化不迅速。 方程(7)是射线理论的基本方程，由此方程组可以求 τ 及所有的 W k ( k = 0 , 1 , 2 , ⋯ ) 。 而程函数方程是解决运动学问题的基本方程，能够确定射线、旅行时、波前等波的运动学特性。方程表达式如下： V p = [ ( λ + 2 μ ) / ρ ] 1 / 2 (9) V s = [ μ / ρ ] 1 / 2 (10) 方程(9)是描述P波传播的运动学特征， V p 是P波速度。 方程(10)是描述S波传播的运动学特征， V s 是S波速度。  射线法主要包含两方面内容：1) 在已知射线起始位置和知道射线出射方位的前提下，确定射线路径；2) 给出起始出射方向，逐渐修改出射方向，直到射线足够精确地到达预定的接收点 [ 15 ] 。 内容1)是积分问题，已知速度分布，应用程函数方程(9)和(10)，对微分方程作积分求解射线路径问题。内容2)是射线法的核心和难点，它涉及到解两个非线性方程的方程组 [ 15 ] 。 { h ( i 0 , j 0 ) = H g ( i 0 , j 0 ) = G (11) 式中： i 0 为起始入射角； j 0 为起始方位角； h和g为射线到达点的坐标，它是 i 0 和 j 0 的函数； H和G是期望的射线到达点的坐标。 通常不可能精确求解该线性方程组，使用迭代的方法能近似求解。在每一迭代歩中先计算偏导数： ∂ h ∂ i 0 , ∂ h ∂ j 0 , ∂ g ∂ i 0 , ∂ g ∂ j 0 (12) 而后解线性方程组： [ ∂ h ∂ i 0 ∂ h ∂ j 0 ∂ g ∂ i 0 ∂ g ∂ j 0 ] [ i 0 ( n + 1 ) − i 0 ( n ) j 0 ( n + 1 ) − j 0 ( n ) ] = [ H − h ( i 0 ( n ) , j 0 ( n ) ) G − g ( i 0 ( n ) , j 0 ( n ) ) ] (13) 求估计值 i 0 和 j 0 ，反复迭代，直到( H − h )和( G − g )的值在期望的误差范围之内。"
"基于波动方程的算法有很多，下文着重介绍基于波动方程的交错网格高阶有限差分法。  设二维声波方程在直角坐标系中表示为： U x x + U z z = V − 2 ( x , z ) U x z (14) 式中：U是声波响应；V是波速 下标表示对于相应变量的偏导数。 采用显示二阶差分格式，写出其有限差分解 [ 16 ] 。 U k , j i = 2 ( 1 − 2 A 2 ) U k , j i − 1 − U k , j i − 1 + A 2 [ U k + 1 , j i − 1 + U k − 1 , j i − 1 + U k , j + 1 i − 1 + U k , j − 1 i − 1 ] (15) A = V ( x k , z j ) Δ t / h (16) U ( x k , z j , t i ) = 2 ( 1 − 2 A 2 ) U ( x k , z j , t i − 1 ) − U ( x k , z j , t i − 2 )     + A 2 [ U ( x k + 1 , z j , t i − 1 ) + U ( x k − 1 , z j , t i − 1 ) + U ( x k , z j + 1 , t i − 1 ) + U ( x k , z j − 1 , t i − 1 ) ] (17) 式中： x k = k Δ x ； z j = j Δ z ； t i = i Δ t ； h = Δ x = Δ z ； A = [ V ( x k , z j ) Δ t ] / h 。 递推求解时，先要给出边界条件和初始条件。在已知x-z面内起始两个时间步的波场分布后，即可递推求出x-z面内各个时间步的波场分布。"
"无论是射线迭代法还是交错网格高阶有限差分法正演模拟，在资料准备、地质模型建立、观测系统布设上是一致的，这样才具有可比性 [ 17 ] [ 18 ] [ 19 ] 。  正演要求的基本数据是：正确的深度域地面地震剖面，地质层位底界深度，地质层位的纵横波速度、密度等地球物理参数和观测系统数据。  模型建立的一般流程是：1) 建立初始模型；2) 建立构造模型；3) 定义模型的介质属性；4) 检查模型合理性，修改模型。 通过图片拓绘方式，结合地面地震剖面(见图1)，地质层位深度，建立深度域模型，然后定义速度密度等常属性及梯度属性，得到XX井地质模型(见图2)。 图1. 过XX井Line190801地震剖面 图2. 过XX井Line190801地质模型  模拟观测系统布设与实际采集时一致，观测系统见表1。 Table 1 观测位置 观测井段(m) 观测点距(m) 观测点数(个) 井源距(m) SP1 3260-10 10 326 197.84 SP2 3260-10 10 326 1521.77 备注 检波器沿大井布设，炮点沿地表布设，激发深度0m，模拟可控震源激发 表1. XX井观测系统表  射线法正演是对分块变速块内常速的二维地质模型进行共炮点射线追踪的过程。SP1点和SP2点直达波射线追踪见图3和图4。 图3. SP1点直达波反射波射线追踪 图4. SP2点直达波反射波射线追踪  制作正演道集记录时可以使用的子波有Ricker子波、Gauss子波、Yushi子波，此次采用主频30 Hz的Ricker子波。SP1和SP2点野外原始X、Z分量见图5和图6。SP1点X、Z分量正演道集记录见图7和图8。SP2点X、Z分量正演道集记录见图9和图10。 图5. SP1点野外原始X、Z分量道集记录 图6. SP2点野外原始X、Z分量道集记录 图7. SP1点X、Z分量正演道集记录(射线理论) 图8. SP1点X、Z分量正演道集记录(波动方程) 图9. SP2点X、Z分量正演道集记录(射线理论) 图10. SP2点X、Z分量正演道集记录(波动方程) 基于射线理论正演道集记录与野外资料相比，符合不太好，存在较大差别，正演道集记录整体波组特征较单一，主要是一次下行波，一次上行波和一次上行转换波，上行波同相轴有些局部还存在缺失，波组频率和分辨率与实际野外资料差别很大。 基于波动方程正演道集记录与野外资料对比，波组特征一致，符合良好，但也有一些差别：1) 因为野外资料可控震源采集时存在时移，所以，实际资料同相轴向下移；2) 野外资料所用震源比计算VSP正演道集记录所用震源能生成较长的子波，并具有高的P波和S波能量比；3) 正演道集记录上的S波与直达波的耦合在野外记录上不太明显，主要是两者震源能量比不同，而且野外衰减较正演道集记录严重；4) 野外资料弹性波在三维空间球面扩散，正演道集记录弹性波在二维空间呈柱面扩散。 总的来说，基于射线理论的正演道集记录指导意义不是太大，尤其当模型复杂时而基于波动方程的有限差分对于弹性介质和复杂构造情况下计算VSP正演道集记录最为有效。"
"通过上述对两种方法的介绍，综合考虑模型精度和成本，每一种方法都有其应用条件和应用范围。 基于射线理论的试射迭代方法制作VSP射线追踪、射线路径、覆盖次数统计、角度统计、反射(透射)系数统计等方面有很大优势，在正演道集记录制作上存在限制。适用于构造相对简单模型的正演模拟，在界面变化剧烈、速度变化剧烈的模型上(薄互层、盐丘刺穿等)，将很难得到满意的结果。 基于波动理论的有限差分方法可以解标量波动方程，也可以解矢量波动方程。既适用于均匀地层，也适应用于不均匀地层。选用的坐标系可以是笛卡尔直角坐标系，也可以是其它坐标系，可以模拟不同的观测系统。对于研究广角入射、横向变化、散射及规模与波长相当的不均匀体等有明显的优越性。制作VSP正演道集记录可用于研究某些类型的波是否存在、波的振幅变化、波至时间、同相轴曲率、能量聚焦和分散、波的互相干涉等多种特征，模拟细致的构造和岩性特征特别有利。该法主要缺点在于计算工作量大，耗费机器时间长，当网络节点多时，要求计算机内存资源多，同时该方法突出的问题之一就是数值频散问题，这种频散现象是由于波场中的各种频率成分具有不同的传播速度，从而导致这些频率成分随着时间的推移在时域波形上逐渐分散开，但目前对各种频率成分如何分散开的问题研究相对较少 [ 20 ] ，实际应用时应该相互结合这两种或其他方法，实现优势互补，更好的指导野外勘探。"
