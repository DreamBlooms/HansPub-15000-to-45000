"本文以整数线性规划和多目标规划为理论基础，针对二维矩形切割优化问题，建立了以木板利用率最大为目标的多阶段分析模型。考虑了产品类型由单一到多元，产品生产任务以及木板原料的限定，由浅到深，一步步编写程序结合LINGO求解得到系统的最优切割方案。与商业切割软件对比结果表明，该模型可以有效地解决木板切割问题，模型稳定且寻优能力较好。 关键词 :整数线性规划，多阶段分析，多目标规划 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"工厂中经常会碰到一些材料切割的优化问题，为了节省材料，减少废料对环境的污染，必须选择最优的切割方案。某家具行业中有一批木板用于加工，在加工过程中，木板被切割成不同面积大小，分别加工成不同的产品。在木板的面积和数量有限的情况下，安排木板切割使得在完成生产任务的基础上，最大化利用率和家具厂的利润成为亟需解决的问题。简化切割操作，对提高工厂的经济效益和增大产品竞争力具有重要意义。 在工业生产流程中，一般是家具厂根据订单要求的产品类型来加工。原木板作为毛坯按照产品生产任务被切割成不同面积大小。优化切割方案并得出利润最大的方案是最终决策的来源。如图1所示。 图1. 标准试验系统结果曲线 本文依据这个流程基于二维矩形切割建立了规划模型，分析了怎样实现木板的最优切割，使木板利用率与利润达到最高，产品类型由单一到多元，并考虑了产品的生产任务以及木板原料的限定，最终系统给出了符合要求的切割方案。"
"本研究对象来源于第16届五一数学建模竞赛数据，对矩形木板进行切割，需要得到四种类型的产品，木板的具体参数数据如表1所示，产品的具体参数数据如表2所示。 Table 1 木板 长度(cm) 宽度(cm) S1 300 150 表1. 木板的具体参数数据 Table 2 产品类型 长度(cm) 宽度(cm) 生产任务(件) 利润(元/件) P1 37.3 20.1 774 19.9 P2 47.7 28.2 2153 23.0 P3 40.6 22.9 1623 21.0 P4 31.1 22.5 1614 16.0 表2. 产品的具体参数数据 1) 不计木板的厚度和割缝宽度； 2) 每一刀仅可切割成直线； 3) 每一刀不考虑斜向切割； 4) 切割下来的木板在通过加工得到产品时，没有材料的损失； 5) 切割木板时无损耗，即不产生废料。"
"相关符号说明见表3。 Table 3 符号 含义 单位 Z 总利润 元 K 木板总利用率 % L S1木板长度 cm W S1木板宽度 cm P i 第i个产品生产任务 件 l i 第i个产品长度 cm w i 第i个产品宽度 cm p i 第i个产品的利润 元 h i 第i个产品的单位面积价格 元/件∙cm 2 c j 第j个方案的木板数量 件 k j 第j个方案的木板利用率 % z j 第j个方案的利润 元 L l i 第i个产品的长度在水平方向上的个数 件 W w i 第i个产品的宽度在垂直方向上的个数 件 L w i 第i个产品的长度在垂直方向上的个数 件 W l i 第i个产品的宽度在水平方向上的个数 件 m 产品种类数 类 n 方案个数 个 表"
"矩形切割问题是二维下料的一个重要研究方向，对于一块木板，在水平方向和垂直方向切割可以得到两种毛坯，将这两种毛坯沿同一方向堆砌，组成两种同类条带 [ 1 ]，如图2所示。 图2. 毛坯1.1 (左)，毛坯1.2 (右)，同型条带1.1 (左)，同型条带1.2 (右)"
"在木板上切割单一产品，求木板利用率最大的切割方案。即看成产品在木板上的排列组合，与木板利用率直接关联的排列面积为目标函数。决策变量假设是产品在某一方向的排列个数，那么约束条件包括产品排列长宽不能大于木板本身。 假设第i个产品在水平方向上的个数和在垂直方向上的个数分别为 L l i ， L w i ，以他们为决策变量，切割面积最大为目标建立如下的整数线性规划模型 目标函数 max W w i × L l i + W l i × L w i (1) 由于切割下来的条带集合的长度不能超过木板的长度，则约束条件 { l i × L l i + W l i × L w i ≤ L L l i , L w i ≥ 0 , 为 整 数 (2) 其中， L l i = ⌊ L / l i ⌋ ， L w i = ⌊ L / w i ⌋ ， ⌊   ⌋ 为向下取整符号。 木板利用率是评价一个切割方案的有效指标，利用率高的切割方案不仅节省了原料，而且提高了工厂利润，利用率用在木板上切割下来的毛坯面积与木板面积的比例表示，即一块木板的利用率 [ 2 ] 为 ∑ i l i w i ( W w i × L l i + W l i × L w i ) L W (3) 对于产品P1，其中 i = 7 ， L l 1 = ⌊ L / l 1 ⌋ = 7 ， L w i = ⌊ L / w i ⌋ = 4 ，那么 max 7 L l 1 + 4 L w 1 { 373 L l 1 + 201 L w 1 ≤ 3000 L l 1 , L w 1 ≥ 0 , 为 整 数 利用LINGO [ 3 ] 得到最优解为： L l 1 = 1 ， L w 1 = 13 ，最优值为：59。因此一块木板的利用率为98.3%。 切割方案示意图如图3所示，其中切割下来的产品P1数量如表4所示。 图3. 产品P1的木板切割方案示意图 Table 4 P1数量(件) 利用率(%) 59 98.3 表4. 切割方案的具体参数值 单一产品的木板切割排列简单，建立整数线性规划模型可以得到切割面积最大的方案，该方案下的利用率较高。"
"在木板上切割两类产品，以集合 { L l i , L w i } 为决策变量，切割度最大为目标建立如下的整数线性规划模型。 目标函数 max ∑ i ( l i × L l i ) + ∑ i w i × L ( w i ) (4) 由于切割下来的宽度不能超过木板的宽度，则约束条件 { ∑ i ( l i × L l i ) + ∑ i ( w i × L w i ) ≤ W L l i , L w i ≥ 0 , 为 整 数 (5) 由该模型得到某一种毛坯的排列方式，将他作为初始排列，不断迭代模型，最终木板不能排列毛坯时停止。 统计这两类产品的数量，根据下面公式计算木板利用率 k j = ∑ j = 1 m l i w i a j i L W × 100 % (6) 步骤1：对于产品P1和产品P3， i = 1 , 3 。这两种类型组合的整数线性规划为 max 373 L l 1 + 201 L w 1 + 406 L l 3 + 229 l w 3 { 373 L l 1 + 201 L w 1 + 406 L l 3 + 229 L w 3 ≤ 3000 L l 1 , L w 1 , L l 3 , L w 3 为 整 数 利用LINGO得到最优解为： ( L l 1 , L w 1 , L l 3 , L w 3 ) T = ( 1 , 7 , 3 , 0 ) T 。 由于 L w 1 的个数最多，占切割木板的面积最大，因此先排列此毛坯，由最优解得出一部分排列a，如图4所示。 步骤2：模型迭代 max 373 L l 1 + 406 L l 3 { 373 L l 1 + 406 L l 3 ≤ 1593 L l 1 , L w 1 , L l 3 , L w 3 为 整 数 利用LINGO得到最优解为： L l 1 = 1 ， L l 3 = 3 ，由此得到排列b，如图4所示。 步骤3：木板中间的剩下未排列区域，以余料最少为原则，得到排列c，如图4所示。 图4. 迭代排列过程图 该模型可以得到多种方案，图5，图6，图7分别为三种切割方案，其中切割下来的产品数量和利用率如表5所示。 图5. 产品P1和P3的木板切割方案1示意图 图6. 产品P1和P3的木板切割方案2示意图 图7. 产品P1和P3的木板切割方案3示意图 Table 5 方案编号 P1数量(件) P3数量(件) 利用率(%) 1 32 22 98.8 2 33 21 98.6 3 43 13 98.5 表5. 切割方案的具体参数值  在木板上全部切割产品P1作为方案4，全部切割产品P3作为方案5，得到表6。 Table 6 方案编号 P1数量(件) P3数量(件) 利用率(%) 1 32 22 98.8 2 33 21 98.6 3 43 13 98.5 4 59 0 98.3 5 0 47 97.1 表6. 切割方案的具体参数值 构造方案矩阵 A n × m = ( a j i ) ，其中 i = 1 , 2 ; j = 1 , ⋯ , 5 。方案矩阵用于存储每一个方案下的产品数量。 A 5 × 2 = ( 32 ⋯ 22 ⋮ ⋱ ⋮ 0 ⋯ 47 ) 以 c j 为决策变量，总木板利用率最高为目标建立整数规划模型。 目标函数 max ∑ i l i w i P i L W ∑ j = 1 n c j (7) 由于需要完成产品的生产任务，则约束条件为 { ∑ j = 1 n a j i c j ≥ P i ,     i = 1 , ⋯ , m c j ≥ 0 , 为 整 数 ,     j = 1 , ⋯ , n (8) 统计这两类产品分别在每种方案下的数量，根据下面公式计算木板利用率 K = ∑ i l i w i P i L W ∑ j = 1 n c j × 100 % (9) 对于产品P1和P3，整数规划为 max 373 × 202 × 774 + 406 × 229 × 1623 ∑ j = 1 5 c j × 3000 × 1500 { 32 c 1 + 33 c 2 + 44 c 3 + 59 c 4 + 0 × c 5 ≥ 774 22 c 1 + 21 c 2 + 12 c 3 + 0 × c 4 + 47 c 5 ≥ 1623 c j ≥ 0 , 为 整 数 ,     j = 1 , ⋯ , 5 编写程序，求出每个方案下木板S1的数量以及总利用率。结合LINGO得出最优解为： ( c 1 , c 2 , c 3 , c 4 , c 5 ) T = ( 21 , 1 , 2 , 0 , 24 ) T 最优值为： K = 96.7 % ， K ′ = 97.9 % 。其中K是实际的木板总利用率，P1和P3的产品数量为774件和1623件不变。 K ′ 是按超过生产任务的产品数量计算的木板利用率。切割下来的产品数量和总利用率如表7所示。 Table 7 方案编号 S1数量(张) P1数量(件) P3数量(件) 利用率(%) 1 21 32 22 98.8 2 1 33 21 98.6 3 2 43 13 98.5 4 0 59 0 98.3 5 24 0 47 97.1 合计48 合计774 合计1623 木板总利用率96.7 表7. 切割方案的具体参数值  由基于生产任务的两类产品木板切割可得到多类产品的切割处理方法。假设四类产品P1，P2，P3和P4都需要完成生产任务，由排列组合的原理四类产品有 2 4 − 1 种切割方案。 设方案矩阵 B 15 × 4 = ( b j i ) ，其中 b j i 表示在第j个方案下产品i的数量。文章前面已知矩阵B里每一个元素的数值。以 c j 为决策变量，总木板利用率最高为目标建立整数规划模型 目标函数 max ∑ i = 1 4 l i w i P i L W ∑ j = 1 15 c j 约束条件 { ∑ j = 1 15 B j i c j ≥ P i ,     i = 1 , ⋯ , 5 c j ≥ 0 , 为 整 数 ,     j = 1 , ⋯ , 15 利用LINGO得到 K = 97.06 % ， K ′ = 97.70 % 。切割下来的产品数量和总利用率如表8所示。 Table 8 方案编号 S1数量(张) P1数量(件) P2数量(件) P3数量(件) P4数量(件) 利用率(%) 1 11 59 0 0 0 98.3 2 0 0 31 0 0 92.67 3 0 0 0 47 0 97.1 4 0 0 0 0 48 93.5 5 0 20 21 0 0 96.09 6 0 17 0 0 45 98.3 7 39 0 16 24 0 97.41 8 5 32 0 22 0 98.76 9 0 0 21 0 22 96.98 10 0 0 0 31 9 97.63 11 0 10 0 25 9 98.1 12 0 7 19 0 18 96.45 13 0 20 9 18 0 97.41 14 85 0 18 7 19 97.81 15 0 23 5 21 1 98.21 合计140 合计774 合计2153 合计1623 合计1614 木板总利用率97.06 表8. 切割方案的具体参数值 将模型得到的不同方案下木板利用率与商业软件cuttLogic得到的结果做对比，如表9所示。 Table 9 方案编号 组合 模型结果( ) cuttLogic结果(%) 差值(%) 1 P1 98.3 98.3 0 2 P2 92.67 92.67 0 3 P3 97.1 97.1 0 4 P4 93.5 93.5 0 5 P1, P2 96.09 97.9 -1.81 6 P1, P4 98.3 98.3 0 7 P2, P3 97.41 96.05 1.36 8 P1, P3 98.76 98.23 0.53 9 P2, P4 96.98 97.34 -0.36 10 P3, P4 97.63 98.7 -1.07 11 P1, P3, P4 98.1 98.56 -0.46 12 P1, P2, P4 96.45 97.55 -1.1 13 P1, P2, P3 97.41 96.89 0.52 14 P2, P3, P4 97.81 98.2 -0.39 15 P1, P2, P3, P4 98.21 98.05 0.16 模型结果： 最大值98.76 最小值92.67 软件结果： 最大值98.7 最小值92.67 表9. 切割方案的具体参数值 通过该表可以看出15个方案中，模型结果与软件模拟结果基本相同，甚至较多方案的利用率超过了软件结果，说明模型得出的切割方案是合理的，且模型的寻优能力好。模型结果的最大利用率大于软件的最大利用率，最小利用率数值相同，说明该模型比较稳定。  不考虑产品的生产任务，给定木板数量，首先考虑产品的组合形式。以产品的单位面积价格作为依 据来选取产品组合，由公式 h i = p i l i w i 计算出 h 1 , h 2 , h 3 , h 4 ，且 max { h i } = h 1 ，如表10所示。 Table 1 0 产品类型 单位面积价格(元/件∙cm 2 ) P1 0.0265 P2 0.0171 P3 0.0226 P4 0.0229 表10. 产品的具体参数值 假设给定100张木板S1，每张木板的切割方案相同，对于P1，P2，P3和P4四类产品，以 c j ( j = 1 , ⋯ , 15 ) 为决策变量，总木板利用率最高为目标函数1，总利润最大为目标函数2，建立多目标规划模型。 目标函数1 max ∑ i = 1 4 l i w i P i L W ∑ j = 1 15 c j 目标函数2 max ∑ i a j i P i 约束条件 { ∑ j = 1 15 b j i c j ≥ P i ,     i = 1 , 2 , 3 , 4 c j ≥ 0 , 为 整 数 ,     j = 1 , ⋯ , 15 利用LINGO得到 K = 98.3 % ， w 1 = 1174.1 ， W = 1174.1 × 100 = 11740 。切割下来的产品数量和总利用率如表11所示。 Table 1 1 S1数量(张) P1数量(件) P2数量(件) P3数量(件) P4数量(件) 利润(元/件) 利用率(%) 1 59 0 0 0 1174.1 98.3 100 774 2153 1623 1614 总利润117410 木板总利用率98.3 表11. 切割方案的具体参数值"
"1) 计算简单，结果正确，符合实际，模型具有合理性和可行性，是解决木板切割问题的有效方法； 2) 模型可由少量的编程结合LINGO得到最优切割方案，简洁有效，易于求解； 3) 模型约束条件不多，一些复杂的因素没有纳入考虑范围。比如只考虑的同型条带没有考虑普通条带等； 4) 迭代求解会使误差成倍增长； 5) 本文求解属于半自动方法，不够智能，在处理巨大数据上不够快速。  1) 结合模型缺点，对规划作更加严格的约束，建立更加精确，更加适用于实际工艺应用的模型； 2) 改进算法，使得原有模型更加快捷和智能。"
