"湘江梯级水库的建设促进了水资源的开发利用，但目前各梯级间采用单一水库调度模式，水库群各目标职能无法充分发挥。本文通过对湘江流域9座水电站联合调度，以保障多控制断面生态流量需求为主要目标，兼顾供水、灌溉和发电等多目标，建立湘江梯级水库群多目标调度图优化模型。采用布谷鸟搜索算法优化多目标调度图，使得各控制断面和下游长沙综合枢纽生态供水保证率在99%以上，同时使梯级水库供水保证率、灌溉保证率和发电保证率尽量达到实际生产要求，梯级效益得到有效保障。 关键词 :调度图，综合利用水库，多目标水库调度，布谷鸟搜索算法，湘江 Copyright © 2019 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"水库群优化调度是一个多目标、多阶段、非线性和强约束的复杂决策优化问题 [ 1 ] [ 2 ] 。而水库调度图作为一种指导水库运行的有效工具，具有简单、直观、操作性强等优点 [ 3 ] [ 4 ] 。其因而被广泛应用于水库实际调度中，作为核算水库运行效益指标、评价水库实际调度运行优劣的基本依据 [ 5 ] 。水库调度图的传统编制方法一般通过已有的实测水文资料或选用典型年资料，进行径流调节计算各种兴利调度线，一般需要人工修正调度线，存在一定主观性，因此存在优化的空间 [ 6 ] 。刘攀等采用基于历史径流资料的隐随机方法，分别建立了多年期望调度模型以及强调特定年发电风险的调度模型；采用多目标遗传算法NSGA-II计算程序求解，进行水库优化调度图的编制 [ 5 ] 。周研来等以丹江口水库为研究对象，构建了防洪、供水、发电及生态等调度目标相权衡的多目标调度图优化模型来模拟指导水库调度运行，探讨了多目标优化调度图在该水库的适用性 [ 7 ] 。姬晶等提出了一种生态因子ecoflow指标，构建了水库发电量–发电保证率–生态目标的多目标优化调度模型，并考虑了四大家鱼和中华鲟的生态流量约束，以三峡水库为研究对象，生成了多个调度方案，为同时考虑发电效益和生态效益提供了可行方案 [ 8 ] 。现行水库优化调度图侧重于水库运行的经济效益最大化，而不注重于考虑水库下游的生态需水要求，对水库群优化调度图考虑多个控制断面流量需求的研究较少。因此，本文根据实际调度需要，考虑多控制断面生态流量需求，建立流域水库群综合利用调度模型；采用智能算法布谷鸟搜索算法对模型进行求解。以湘江水库群的调度问题为研究背景，对考虑多控制断面流量需求的湘江水库群综合利用调度的优化设计问题进行研究。"
"流域水库群调度规则是用来指导各水库针对不同用水户，做出相应决策和控制整体运行效益的依据 [ 9 ] 。对于综合利用水库，根据其各功能的优先级，通过各功能限制供水线将调度图划分为多个调度决策区。综合利用水库一般具有生态、供水、灌溉、发电、防洪等功能，图1表示的是综合利用水库调度图的其中一种形式。 图1. 综合利用水库调度图示例 图1中，各功能调度限制线将水库的水位划分为六个调度决策区，各调度决策区的调度决策描述如表1所示。 Table 1 水库水位 调度决策区内各功能相应供水决策 调度总决策 生态需水量D1 供水需水量D2 灌溉需水量D3 发电需水量D4 Zone I D1 D2 D3 D4(β4*N 保 ) M a x { D 1 + D 2 + D 3 , D 4 ( β 4 * N 保 ) } Zone II D1 D2 D3 D4(N 保 ) M a x { D 1 + D 2 + D 3 , D 4 ( N 保 ) } Zone III D1 D2 D3 D4(β5*N 保 ) M a x { D 1 + D 2 + D 3 , D 4 ( β 5 * N 保 ) } Zone IV D1 D2 β3*D3 D4(β5*N 保 ) M a x { D 1 + D 2 + β 3 * D 3 , D 4 ( β 5 * N 保 ) } Zone V D1 β2*D2 β3*D3 D4(β5*N 保 ) M a x { D 1 + β 2 * D 2 + β 3 * D 3 , D 4 ( β 5 * N 保 ) } Zone VI β1*D1 β2*D2 β3*D3 D4(β5*N 保 ) M a x { β 1 * D 1 + β 2 * D 2 + β 3 * D 3 , D 4 ( β 5 * N 保 ) } 表1. 综合利用水库调度图决策区的调度决策描述 注：D4(N)表示对于发电决策为N时对应的发电需水量。  经济性和可靠性是水库运行管理的两个目标，经济性服从可靠性是水库运行与调度必须遵循的一个基本原则。对于湘江流域以供水(生态、生活、灌溉等)为主的综合利用水库，考虑各控制断面最小流量目标的优化调度模型是以流域内水库群为调度对象，以水库特性和水电站特性为约束，在满足各控制断面最小流量需求的基础上，尽可能发挥其他兴利效益的优化模型。  1) 水库群生态供水保证率最大化，即 M a x R 1 ( T ) = M a x ∑ t = 1 T ∑ m = 1 M # [ Q m E ( t ) ≥ Q m E D ] T (1) 2) 水库群生活供水保证率最大化，即 M a x R 2 ( T ) = M a x ∑ t = 1 T ∑ k 1 = 1 K 1 # [ Q k 1 L ( t ) ≥ Q k 1 L D ] T (2) 3) 水库群灌溉供水保证率最大化，即 M a x R 3 ( T ) = M a x ∑ t = 1 T ∑ k 2 = 1 K 2 # [ Q k 2 I ( t ) ≥ Q k 2 I D ( t ) ] T (3) 4) 水库群发电保证率最大化，即 M a x R 4 ( T ) = M a x ∑ t = 1 T ∑ k 3 = 1 K 3 # [ P k 3 ( t ) ≥ P k 3 f i r m ] T (4) 5) 水库群总发电量最大化，即 M a x P ( T ) = M a x ∑ t = 1 T ∑ k 3 = 1 K 3 P k 3 ( t ) ⋅ Δ t (5) 式中： R 1 ( T ) 、 R 2 ( T ) 、 R 3 ( T ) 和 R 4 ( T ) 分别为流域水库群整体的生态供水保证率、生活供水保证率、灌溉供水保证率和发电保证率； P ( T ) 为流域水库群的总发电量；t和T分别为调度时期内时段编号和总时段数；m和M分比为流域内生态流量控制断断面编号和总断面数；k1、k2、k3、K1、K2和K3分别为流域内具有生活供水功能的水库编号、具有灌溉功能的水库编号、具有发电功能的水库编号、具有生活供水功能的水库总数、具有灌溉功能的水库总数和具有发电功能的水库总数。 Q m E ( t ) 和 Q m E D 分别为生态流量控制断面m第t时段的流量和最小需水流量； Q k 1 L ( t ) 和 Q k 1 L D 分别为水库k1第t时段生活供水流量和需水流量； Q k 2 I ( t ) 和 Q k 2 I D ( t ) 分别为水库k2第t时段的灌溉供水流量和需水流量； P k 3 ( t ) 和 P k 3 f i r m 分别为水库k3第t时段的出力及其保证出力。  1) 水量平衡约束 V k ( t ) = V k ( t − 1 ) + ( Q i n k ( t ) − Q o u t k ( t ) ) Δ t (6) 2) 流量平衡约束 Q i n k + 1 ( t ) = Q o u t k ( t ) + q k k + 1 ( t ) (7) 3) 水库水位约束 Z min k ( t ) ≤ Z n ( t ) ≤ Z max k ( t ) (8) 4) 泄流能力约束 Q o u t k ( t ) ≤ Q max k ( t ) (9) 5) 电站出力约束 P k ( t ) ≤ P max k ( t ) (10) 6) 调度线形状约束，指各调度线不交叉 L x − 1 k ≤ L x k (11) 式中： Q i n k ( t ) 和 Q o u t k ( t ) 分别为第t时段水库k的入库和下泄流量； Δ t 为计算时段长度(旬或月)； q k k + 1 ( t ) 为第t时段水库k + 1和水库k的区间入流； V k ( t ) 为第t时段初水库k的库容； Z n ( t ) 、 Z min k ( t ) 和 Z max k ( t ) 分别为第t时段初水库k的水位、最小和最大允许水位； Q max k ( t ) 为第t时段水库k的允许下泄流量的上限； P k ( t ) 为第t时段水库水电站k的出力； P max k ( t ) 为第t时段水库水电站k的允许出力的上限； L x − 1 k 、 分别为水库k的相邻两条调度线，x为调度线编号。   布谷鸟搜索算法(Cuckoo Search, CS)是由Yang和Deb受布谷鸟的巣寄生育雏行为启发，于2009年提出的一种启发式算法 [ 10 ] 。CS以鸟类的飞行轨迹特征为参考设计莱维飞行(Lévy flights)机制进行全局搜索，以布谷鸟的寄生育雏习性为参考，设计了一定替代概率的局部更新机制，实施包括整体全局更新、随机个体更新的偏好随机游动更新 [ 11 ] [ 12 ] 。 本文应用改进的布谷鸟搜索算法 [ 13 ] ： 1) 引入动态发现概率解决进化后期种群质量高，容易陷入局部最优解的问题。区别于固定发现概率，动态发现概率在搜索后期增大，以增加种群进化强度； 2) 引入自适应动态步长，在搜索初期，解集改变比例大，因此莱维飞行步长需较大以保持全局搜索，提高寻优效率。在搜索后期，新解改变越来越小，趋向于短距离搜索，精细化寻优，则莱维飞行步长自适应变小。 CS的具体计算步骤如下： 1) 随机生成N个序列，其中每个序列包括r座水库的n个关键节点时间空间信息编码，初始化种群； 2) 计算当前所有种群的适应度，并筛选出最优种群； 3) 莱维飞行更新。根据莱维飞行全局步长公式(12)更新当前鸟窝位置，计算更新后的适应度值。若更新后的子代鸟窝支配父代鸟窝，则父代鸟窝被子代鸟窝替换，反之不替换。 X i l + 1 = X i l + α ⊕ L ( λ ) L ( λ ) = u | v | 1 / β ( X i l − X b e s t l ) (12) u ~ N ( 0 , σ u 2 ) , v ~ N ( 0 , σ v 2 ) σ u 2 = { Γ ( 1 + β ) sin ( π β / 2 ) Γ [ ( 1 + β ) / 2 ] β 2 ( β − 1 ) / 2 } 1 / β , σ v 2 = 1 (13) 式中： X i l 表示第l代中的第i个体， X b e s t l 表示第l代最优秀的个体； L ( λ ) 表示全局随机搜索步长，服从Lévy分布 ，u，v服从正态分布。 α 为步长控制参数，控制全局搜索的范围。 α 0 l + 1 = α 0 l ⋅ exp ( K ( r − T ) ) (14) 式(14)为自适应动态步长，K为变化率，r为新解改变的比例，T此处取0.3，因此，当r大于0.3时， α 0 l + 1 > α 0 l ，保持全局搜索，当新解改变越来越小时，趋向于局部搜索；则最终第l代个体i更新为： X i l + 1 = X i l + α 0 l σ u 2 ⋅ u | v | 1 / β ( X i l − X b e s t l ) (15) 4) 偏好随机游动更新。根据一定发现概率 P a 随机选取一部分鸟窝，局部更新个体。生成一个随机数并与发现概率 P a 对比，若随机数小于 P a 则更新该个体。 x i l + 1 = x i l + γ ⋅ H ( P a − ε ) ⊗ [ x j l − x k l ] (16) 式中： x i l , x j l , x k l 分别为l轮迭代，任意选取的3个种群个体； H ( P a − ε ) 为赫维赛德函数，当 P a − ε > 0 时，函数值等于0，当 P a − ε < 0 时，函数值等于1，当 P a − ε = 0 时，函数值等于0.5。本文采用式(17)的动态自适应概率，增加后期种群进化强度，新个体的生成方法如下： P a = 0.1 ⋅ cos [ ( N i t e r − 1 ) π 2 ( N f i n a l − 1 ) ] + 0.1 (17) 式中： N i t e r 、 N f i n a l 分别表示算法的当前迭代次数和总迭代次数。 ε , γ ∈ [ 0 , 1 ] ，服从均匀分布； 5) 计算种群适应度，记录当前最优解，进行下一轮迭代； 6) 满足迭代终止条件后，终止迭代，输出寻优结果。  假设流域有r座水库，每座水库有s条调度线，每条调度线包括n个关键节点参与编码，其中每个关键点包括时间空间二维信息，因此每座水库包括 s ⋅ n 个时间编码和 s ⋅ ( n + 1 ) 个空间编码(始末水位一致)，第j座水库第i条调度线编码方式如下： s u q ( j , i ) = [ ( t j , i 1 , ⋯ , t j , i n ) ︸ time , ( Z j , i 1 , ⋯ , Z j , i n , Z j , i E N D ) ︸ waterlevel ] (18) 式中： s u q ( j , i ) 表示第j座水库第i条调度线编码， t j , i n 表示第j个水库第i条调度线第n个关键点的时间坐标， Z j , i n 表示第j座水库第i条调度线第n个关键点的水位坐标， Z j , i E N D 表示第j座水库第i条调度线始末水位坐标。将r座水库序列串联构成一个布谷鸟种群序列，则第ii个鸟巢的编码方式为： n e s t ( i i ) = { [ s u q ( 1 , 1 ) , ⋯ , s u q ( 1 , s ) ] ︷ r e s e r v o i r   1 , ⋯ , [ s u q ( j , 1 ) , ⋯ , s u q ( j , i ) , ⋯ , s u q ( j , s ) ] ︷ r e s e r v o i r   j , ⋯ , [ s u q ( r , 1 ) , ⋯ , s u q ( r , s ) ] ︷ r e s e r v o i r   r } ︸ r (19) 式中： n e s t ( i i ) 表示第ii个鸟巢的编码序列。  根据多目标的重要程度设置不同权重，将多目标问题转化为单目标最优化问题，对生态、灌溉、供水、发电等多目标的调度图模拟结果线性加权，作为进化算法的适应度函数值。"
"湘江又称湘水，地处长江之南，洞庭水系以东，是长江中游南岸重要支流之一。湘江是湖南省最大的河流，流域面积9.46万km 2 ，流经64个县市区，包括长沙、湘潭、株洲、衡阳的全部区域，于全州附近汇入罗江和灌江。年径流量696.1亿m 3 ，蕴藏水能资源521.7万千瓦，其中湖南省占总水能的90%，约470.7万千瓦，水能资源丰富 [ 14 ] 。湘江干流及以下河段规划了九级梯级开发，本文研究对象为其中的9座水利枢纽，涔天河水库、双牌水库、欧阳海水库、东江水库、青山垅水库、洮水水库、酒埠江水库、水府庙水库、株树桥水库等。9座水库均具有发电、生态目标，东江、水府庙、株树桥水库具有供水职能，除东江水库外所有水库均具有灌溉职能，水库群的拓扑图如图2。本文数据输入包括：1) 1980~2010年各水库的入库径流日资料；2) 1980~2010年湘江流域各片区区间入流日资料；3) 1980~2010年灌溉需水过程旬资料；4) 各水库下游生态需水资料。为了匹配资料与调度的时间尺度，将入库径流和区间入流日资料整理为旬资料，采用旬尺度调度。 图2. 研究流域水库群拓扑图   根据流域资料，建立综合利用多目标优化模型，基于模拟优化湘江水库群调度图，采用布谷鸟搜索算法求解。由于各个水库的功能不同，各水库共涉及生态供水灌溉发电综合防破坏线、生态供水灌溉综合防破坏线、生态供水综合防破坏线、生态灌溉综合防破坏线、生态防破坏线、生态限制线、生态供水发电综合防破坏线、生态灌溉发电防综合破坏线等8种类型调度线。 各水库的综合利用调度图优化结果如图3所示。图中从左至右依次是涔天河水库、双牌水库、欧阳海水库、酒埠江水库、东江水库、洮水水库、青山垅水库、水府庙水库和株树桥水库综合利用调度图。  考虑多控制断面流量需求的湘江水库群优化调度的首要任务是保证生态断面的供水流量尽可能满足，生态供水的优先级最高。在此基础上，再尽可能综合纳入供水、灌溉和发电等兴利任务。如图4所示为湘江流域各生态控制断面的最小流量需求和采用优化的调度图调度的长系列生态供水统计结果。 从图4中可以看出，各水库控制断面的最小生态流量保证率普遍较高，基本达99%以上，说明采用优化的调度图模拟调度，其结果能够较好的满足流域内各控制断面的生态流量供水需求。对于下游重要城市长沙，其供水需水量为387 m 3 /s，而采用优化的调度图对流域内各水库模拟调度，计算得长沙断面的生态供水保证率达99.73%，满足实际要求长沙断面生态供水保证率99%的目标。因此，优化的调度图能有效指导流域内水库群的运行调度，满足多个控制断面的生态流量的供水需求。 图3. 湘江流域综合利用调度图优化结果 图4. 湘江流域各生态控制断面的最小流量需求和优化调度结果  对于综合利用水库群，湘江流域内水库群在满足多个控制断面生态流量的供水需求的基础上，应根据兴利任务的优先级，尽可能发挥其余兴利功能。表2给出了采用优化的湘江水库群调度图进行长系列模拟调度的其他兴利目标的指标统计结果，可知： 1) 对于具有供水任务的水库，东江水库的供水保证率达100%，说明所有时段的供水需求全部得到满足，供水效益较好。而对于水府庙水库，供水保证率为98.92%，满足实际要求供水保证率97%的目标。 Table 2 水库 供水保证率 灌溉保证率 发电保证率 年平均发电量(亿kWh) 涔天河 / 100% 100% 0.84 双牌 / 99.91% 97.22% 1.87 欧阳海 / 99.64% 100% 0.67 东江 100% / 67.38% 10.13 洮水 / 99.10% 99.01% 1.11 酒埠江 / 83.24% 83.87% 0.37 青山垅 / 59.95% 25.45% 0.06 水府庙 98.92% 86.74% 94.27% 0.58 株树桥 76.34% 80.82% 58.15% 0.39 表2. 湘江水库群其他兴利目标调度结果统计 注：“/”表示水库无该项兴利任务。 2) 对于具有灌溉任务的水库，涔天河水库和洮水水库的灌溉设计保证率为85%，其余六座水库的灌溉设计保证率均为90%。从表2的统计结果可知，8个有灌溉任务的水库中，有一半水库的灌溉保证率达到灌溉设计保证率的要求。由于灌溉的优先级稍低，所以较难保证所有水库的灌溉保证率都能得到满足。其中，位于上游的涔天河、双牌、欧阳海和洮水四座水库的灌溉保证率接近100%，灌溉满足情况较好。而下游的水库灌溉满足情况普遍劣于上游水库。 3) 对于流域内的所有水库，都具有发电的功能，但该功能的兴利优先级在每座水库中都是最低的。从表2中可以看出，各水库多年平均发电量多数都较小。对于发电保证率，涔天河、双牌、欧阳海、洮水和水府庙五座水库均在90%以上。由于各水库在发挥生态、供水和灌溉功能后，其发电的用水量将得到削减，发电效益在一定程度上会被削弱。但对于9座水库中装机最大的东江水库，其装机容量为560 MW，接近所有水库装机总容量的1/2。其设计多年平均发电量为9亿kWh，模拟调度结果为10.13亿kWh，发电效益良好。 综合以上结果，优化的水库群综合利用调度图在满足多个控制断面生态流量需求的基础上，可以尽可能让水库发挥供水、灌溉和发电等兴利任务，显示了该优化的水库群综合利用调度图的合理性与有效性。"
"湘江水能资源丰富，梯级水库群联合多目标调度能充分利用各梯级间的补偿作用，充分利用水库群的水能资源，同时益于保护生态环境。 1) 本文将布谷鸟搜索算法应用于梯级水库多目标调度图优化中，通过引入动态发现概率和自适应步长改进算法，实例结果验证了布谷鸟搜索算法在梯级水库多目标调度图优化问题中收敛速度快，具有有效性。 2) 本文通过优化调度图，保障湘江梯级9座水电站以及下游长沙综合枢纽的生态供水保证率基本均在99%以上，满足多控制断面最小生态流量目标，基本符合湘江生态供水需求。 3) 本文通过梯级水库联合调度，实现了在保障生态流量目标的基础上，尽可能发挥供水效益、灌溉效益和发电效益，充分开发梯级水库的综合职能效益，提出的调度模型具有可行性。"
