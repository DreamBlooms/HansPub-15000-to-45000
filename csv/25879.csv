"本文通过分析巨磁阻效应，采用自主研制的多层膜结构的GMR磁传感器研制二维电子罗盘，该电子罗盘包括二只GMR磁传感器和信号处理电路。通过对传感器进行静态特性标定，给出了电子罗盘的整体设计方案。采用了AD620仪表放大器、arduino uno微处理器和12864LCD液晶显示屏分别实现了差分放大、信号处理以及液晶显示，并在IDE编程软件中采用C语言对电子罗盘信号处理模块进行软件编程，在二维磁场中实现了当前方位测量的功能。通过对研制的电子罗盘特性进行测试与分析，实验结果表明，本文设计的巨磁阻电子罗盘实现了基本的功能。 关键词 :二维电子罗盘，GMR传感器，磁敏特性 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"电子罗盘作为一种新型姿态检测模块，利用地球自带磁场的特性来确定当前方位，现已广泛应用于航空航天航海、军事工业以及设备导航等多个领域。作为电子罗盘的核心，磁传感器常分为磁敏三极管结构、霍尔元件磁传感器、磁通门(Flux-gate)、各向异性磁阻(AMR)和隧道磁阻(TMR)等 [ 1 ] [ 2 ] [ 3 ] 。由GMR传感器研制的电子罗盘具有体积小、灵敏度高、稳定性好和外接电路简单等优点，更适合应用于各种电子产品的导航系统 [ 4 ] 。在2004年，黑龙江大学就基于巨磁阻效应研制了测角仪 [ 5 ] 。2006年英国英飞凌科技公司研制了一个单片集成的GMR二维磁场测量传感器 [ 6 ] 。2013年，杭州电子科技大学林乾浩设计制作的GMR磁敏传感器电子磁罗盘 [ 7 ] 。 本文基于自主研制的巨磁电阻磁传感器，自行将两只单轴传感器呈45˚夹角放置、封装成测量二维磁场的磁传感器，并对其进行静态特性的测试标定，设计制作了电子罗盘的硬件电路以及软件程序的编写，实现了二维电子罗盘的基本功能。"
"自行研制的单轴GMR传感器是由四个磁电阻R 1 、R 2 、R 3 、R 4 组成。R 1 、R 3 为两个磁敏感方向相同，且其余参数一致的磁电阻，R 2 、R 4 为另两个磁敏感方向相同但与R 1 、R 3 的磁敏感方向相反，其余参数与R 1 、R 3 一致的磁电阻，这四个磁电阻连成闭合回路构成惠斯通电桥结构，具有巨磁阻效应。单轴磁传感器基本结构示意图如图1所示，其中两个输入端分别为电源电压V DD 、接地端GND，V o1 、V o2 为两个输出端电压，则输出电压为： V o u t = V o 1 − V o 2 (1) 本文利用惠斯通电桥结构的单轴磁传感器，将两个单轴巨磁阻磁传感器，即两个独立的惠斯通电桥，呈45˚夹角放置并压焊封装于PCB板上制得二维磁传感器。二维磁传感器输出后，连接AD620仪表放大器、arduino uno微处理器和12864LCD液晶显示屏三个硬件功能模块电路，准确显示当前位置方向，实现了二维电子罗盘的功能。  1988年法国巴黎大学阿尔伯特·费尔和德国尤里希研究中心彼得·格林贝格尔就先后独立发现了“巨磁电阻”(Giant Magneto Resistance, GMR)效应 [ 8 ] 。巨磁阻效应是一种量子力学和凝聚态物理学现象，是磁阻效应的一种，可在铁磁性材料(FM)和非铁磁性材料(NM)相间的薄膜层(nm量级)结构中观察到，是指磁性材料在受到外磁场作用时较无外加磁场作用时电阻率发生显著变化的现象 [ 9 ] 。 本文以测量水平(x轴)方向的单轴GMR磁传感器为例，当外加磁场B = 0 T时，四个磁电阻的阻值相等，均为R 1 = R 2 = R 3 = R 4 = R 0 ；当外加磁场 B ≠ 0 T时，四个磁电阻R 1 、R 2 、R 3 、R 4 的阻值随磁场的改变而改变，从而电桥两端输出端V o1 、V o2 产生电势差，将微弱的磁信号转化为压电信号输出。黑龙江大学自制的GMR磁传感器令与电阻R 1 、R 3 的磁敏感方向相同时的B为正值，即B的方向与x轴的正方向相同；反之，B为负值，即B的方向与x轴的正方向相反。其工作原理示意图如图2所示。则该单轴传感器电桥输出电压V outx 为： 当B = 0 T时 图1. 单轴磁传感器基本结构示意图 图2. 单轴磁传感器工作原理示意图：(a) B = 0 T；(b) B > 0 T；(c) B < 0 T V o u t x = V o 1 − V o 2 = 0 (2) 当B > 0 T时 V o u t x = V o 1 − V o 2 = Δ R R 0 ⋅ V D D (3) 当B < 0 T时 V o u t x = V o 1 − V o 2 = − Δ R R 0 ⋅ V D D (4)  地球作为一个巨大的磁体，在它周围存在着地磁场。地球磁场方向源于地理南极附近的磁场北极，终于地理北极附近的磁场南极，磁场强度大小约在0.5~0.6 Gs [ 10 ] 。电子罗盘利用地磁场水平总分量始终指向地磁北极这一基本特性来确定当前位置相对于磁北位置的方向角度差。两个单轴磁传感器分别测量两个相互垂直的磁感应强度分量B x 、B y ，并将其转化为相应的电势差输出V x 、V y 。则当前方位角θ与测量分量V x 、V y 的关系为： V x > 0; V y > 0 θ = arctan ( V y V x ) (5) V x > 0; V y < 0 θ = arctan ( − V y V x ) (6) V x < 0; V y < 0 θ = arctan ( − V y V x ) (7) V x < 0; V y > 0 θ = arctan ( V y − V x ) (8)"
"本文设计的电子罗盘框图如图3所示。首先利用GMR磁传感器将磁信号转化为微弱的模拟电信号，再由仪表放大器对模拟信号进行适当放大，用自带模数转换模块的微处理器将接收到的模拟信号转换为数字信号，并对数据进行处理与计算，最终把处理后的数据传输到液晶显示模块，在显示屏是实时显示当前方位，完成电子罗盘的基本功能。  图4给出了电子罗盘整体电路图，该系统由二维GMR磁传感器、AD620仪表放大器模块、含模数转换模块的arduino uno微处理器电路和12864LCD液晶显示电路四个部分组成，且这四个模部分都用同一个电压源供电。且完成焊制后的电路如图5所示。 图3. 电子罗盘设计框图 图4. 电子罗盘整体电路图 图5. 电子罗盘照片  电子罗盘主要是对arduino uno微处理器中ATmage328P单片机的程序设计，系统程序流程图如图6所示。本文采用Arduino自带的编程软件(IDE)进行程序设计，编译成功的程序可直接使用USB-ISP下载器下载到单片机中运行，程序主要实现对模拟电压的采集、模数转换、算法计算以及方位显示的功能。该编程软件包含大量的储存库，具有功能齐全、语句简练、使用方便、技术支持全面等优点 [ 11 ] 。"
"本文自行封装了GMR二维电子罗盘，使用学生电源为整个罗盘供电(工作电压为：±5.0 V)。在室温条件下，本文采用霍尔效应测试仪器(CH-100)模拟磁场环境，搭建电子罗盘测试系统，如图7所示，设置磁场大小为10 mT，学生直流电源提供的电压为5 V，并用步进电机旋转360˚一个周期，旋转速度为0.5˚/s。通过自动采集测量得磁传感器旋转特性的输出曲线如图8(a)所示。经过放大模块进行信号放大后的旋转特性输出曲线如图8(b)所示。 对整体罗盘进行标定，步长为5˚，量程为0˚~360˚，如图9所示，标定结果在−15˚~345˚之间，该罗盘可以较好的在水平面内进行当前方位测量并实时显示。液晶显示模块连接5 V工作电压时，首先会在液晶显示屏第一行中间显示“compass”，然后在第二行显示电子罗盘检测到的当前位置方向。 图6. 系统程序流程图 图7. 电子罗盘测试系统测试图 图8. 磁传感器旋转特性输出曲线：(a) 传感器输出；(b) 放大电路输出 图9. 输出角与标准角关系曲线 实验结果表明，由于磁传感器存在温漂与零漂，且在无磁场下自身存在一定的磁矩，存在15˚左右的零点漂移；自行搭建的磁传感器二维旋转测试平台在测量过程中也存在一定的精度误差，导致了灵敏度出现一定的偏差。"
"本文给出了GMR磁传感器的基本结构和工作原理，在此基础上设计、制作基于巨磁电阻的二维电子罗盘。实验结果给出，该电子罗盘能够实现基本的功能，具有成本低、灵敏度高等优点，但该电子罗盘存在一定的误差，通过分析实验结果，主要原因为传感器自身存在一定的磁矩以及测量装置引起的误差，需进一步提高自制磁传感器的分辨率、灵敏度以及测量装置的精度，并尽可能的使用软件补偿来降低硬件误差。该罗盘可以实现当前方位的测量，具有一定的应用背景与市场价值。"
