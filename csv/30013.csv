"BDS/INS深组合导航可以提高系统的导航精度、抗干扰性和动态性能，是目前研究的重点和热点。本文给出了BDS/INS深组合导航仿真平台的设计及实现，介绍了仿真平台的总体体系结构、信息流程及各分系统的组成。该平台便于进行深组合导航系统算法及性能的验证分析，仿真验证结果表明，在高动态条件下，BDS/INS深组合导航系统的位置误差稳定在4 m范围内，速度误差稳定在0.2 m/s内。 关键词 :BDS/INS，深组合，仿真平台，性能分析 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"GNSS (Global Navigation Satellite System)和INS (Inertial Navigation System)具有良好的优势互补性，因此GNSS/INS组合导航被业内称之为“黄金组合” [ 1 ] [ 2 ] [ 3 ] ，根据观测量的不同，有松组合、紧组合和深组合三种组合模式 [ 2 ] [ 3 ] [ 4 ] 。GNSS/INS深组合是一种深层次的、基于硬件层面的组合方式，实现了INS导航参数与GNSS接收机相关器输出的I/Q信号的融合，在高动态、强干扰、弱信号及遮挡环境中具有优越的导航性能，是今后GNSS/INS组合导航应用的主要发展方向。目前，我国的北斗卫星导航系统(BeiDou Navigation Satellite System, BDS)已经在亚太大部分区域得到了广泛的应用，BDS/INS深组合导航系统在民用领域可应用于无人驾驶、精密精近飞机着陆、测绘、地图绘制等，在军用领域可应用于导弹、制导炸弹、单兵导航、无人侦察机等。由于其优越的性能及广泛的应用前景，得到国内外相关大学、研究机构高度重视 [ 3 ] - [ 9 ] 。 BDS/INS深组合导航是INS信息与BDS接收机跟踪层面的融合，涉及到BDS接收机内部编排，在高动态、强干扰应用环境下进行物理或半物理仿真试验难度大，考虑因素较多 [ 10 ] [ 11 ] 。而构建BDS/INS深组合导航仿真平台可以建立和提供接近实际的物理模型和工作参数，从而为方案论证提供依据，经济性和适应性强 [ 12 ] 。参照GSNRx-ut TM 设计思想，本文构建了BDS/INS深组合导航仿真平台，给出了仿真平台的体系结构、信息流程及各分系统的组成，该仿真平台可以同步输出BDS中频数据、INS观测数据，具备基带信号处理功能、INS导航解算功能、组合导航滤波解算等功能，可用于对BDS/INS深组合导航系统在高动态和弱信号环境下的导航性能进行仿真分析。此平台预留接口，可以扩展到其它GNSS/INS深组合导航系统。"
"深组合的概念源于学者Spilker提出的“矢量跟踪” [ 2 ] ，其核心思想是利用相关器残差来更新导航参数，利用更新后的导航参数预测BDS信号跟踪环路参数。目前通常有两种设计方案 [ 7 ] [ 13 ] [ 14 ] ，一种是级联式深组合导航系统，其组合导航滤波器的量测值为经基带信号预处理滤波器处理后的基带I/Q信息；另一种是集中式深组合导航系统，其组合导航滤波器的量测值为基带I/Q信息与惯性导航估计的I/Q信息之差。从信息融合最优准则角度考虑，集中式深组合导航系统在导航性能提升层面是最优的。这里以集中式深组合导航系统为例进行仿真分析。BDS/INS深组合导航结构如图1所示。 从结构图中可以看出，这种组合模式将导航参数估计与BDS信号跟踪融合在一起，可同时跟踪处理所有可视北斗卫星信号。组合导航系统可以充分利用INS短时精度高的特点，提供准确的动态信息，增强BDS接收机对动态应力的适应性，减小BDS信号跟踪环路的带宽；同时利用导航滤波器输出信息修正INS,使BDS接收机跟踪环路仅跟踪由INS解算误差、BDS接收机晶振、外部噪声等导致的多普勒移 图1. BDS/INS深组合结构图 移误差，有效提高BDS信号跟踪精度。当BDS信号受干扰或遮挡时，INS测量值可以满足无缝导航，同时组合导航系统可以预测载体的动态信息，对BDS信号的Doppler和相位偏移信息进行连续预测，可显著减小BDS接收机重新捕获的时间。"
"BDS/INS深组合导航仿真平台主要由以下几部分构成：运动轨迹发生器，BDS中频信号仿真器，BDS接收机基带信号处理，IMU信号产生器，INS力学编排、组合导航滤波器。平台总体结构如图2所示。 图2. 深组合仿真平台总体结构  运动轨迹发生器是整个BDS/INS深组合导航仿真平台的基础和数据来源，可以模拟用户的各种运动(如静止、匀速、加速、拐弯、俯冲等)，其主要作用是：一是为仿真平台提出输入信息，包括用户的位置、速度、加速度、姿态等信息，用来仿真IMU输出、BDS卫星导航电文、伪距信息及电离层、对流层延迟改正信息等；二是作为基准值和评判准则，对仿真结果进行误差分析，用来检验BDS/INS深组合导航理论模型、算法的正确性及优劣性。轨迹仿真中常用的方法是利用四阶龙格库塔法解算一组轨迹微分方程，具体仿真流程参考文献 [ 9 ] 。  基于INS元器件误差模型建立陀螺仪和加速度计仿真器，模拟输出的角加速度和线加速度信息，这里为了简化分析，假设初始对准已经完成并且对安装误差进行了有效补偿。 ①陀螺仪仿真器 考虑到陀螺仪的误差信息，其输出为： ω ˜ i b b = ω i b b + ε g b (1) 式中， ε g b 为陀螺元器件的误差， ε g b 为载体相对于惯性坐标系在载体坐标系中的真实角加速度，表示为： ω i b b = R L b ( ω i e L + ω e L L ) + ω L b b (2) 式中， ω L b b = [ cos r 0 cos p sin r 0 1 sin p sin r 0 cos p cos r ] ⋅ [ p ˙ r ˙ y ˙ ] (3) ②加速度计仿真器 加速度计的输出为： f ˜ b = f b + ∇ a b (4) 式中， ∇ a b 为加速度计的误差， f b 为载体相对于惯性坐标系的加速度，表示为： f b = R L b [ V ˙ L + ( 2 Ω i e L + Ω e L L ) × V L − g L ] (5) 式中，相关参数参考文献 [ 9 ] [ 15 ] 。  BDS中频信号仿真器可以根据模拟的用户运动轨迹，结合BDS卫星星历，综合多种误差因素，模拟接收机接收到的BDS卫星中频信号。 ①频信号数学模型 B1信号由I、Q两个支路的“测距码 + 导航电文”正交调制在载波上构成 [ 16 ] [ 17 ] ，这里以B1I信号为例进行分析。第j颗可见BDS卫星发送的B1I信号经过空间环境传播后，其解析式为： R B 1 I j = 2 P D j ( t − T p − δ t i o n o − δ t t r o p o + δ t S V ) C j ( t − T p − δ t i o n o − δ t t r o p o + δ t S V )     × cos [ ω B 1 I ( t − T p + δ t i o n o − δ t t r o p o + δ t S V ) + φ 0 ] + n ( t ) (6) 式中，P为接收机接收到的第j颗可见卫星信号的功率， 为从卫星发射到接收机接收的传播延时， δ t i o n o 为电离层延时， δ t t r o p o 为对流层延时， δ t S V 为卫星钟差， 为初始相位， n ( t ) 为接收到的噪声。为了便于后续基带信号处理，需要将接收到的BDS信号进行混频处理，将信号下变频为中频，然后进行采样处理。设本地信号为： L O = 2 cos ( ω L O ( t + δ t r ) ) (7) BDS信号经过混频、低通滤波器后表示为： S I F j = 2 P D j ( t − T d − δ t i o n o ) C j ( t − T d − δ t i o n o )     × cos [ ω B 1 I ( t − T d + δ t i o n o ) − ω L O ( t + δ t r ) + φ 0 ] + n j ( t ) (8) 式中， δ t r 表示接收机的钟差。令： ω I F = ω B 1 I − ω L O (9) t s = T d + δ t i o n (10) (11) 将式(8)进一步简化得到： S I F j = 2 P D j ( t − t s ) C j ( t − t s ) cos [ ω I F t + φ ] + n j ( t ) (12) 式中， ω I F 为期望的中频信号角频率。当用户做高速运动时，需要考虑多普勒频移引起的载波相位的变化，因此包含所有可见卫星的中频信号表达式为： S I F = ∑ j = 1 N { 2 P D j ( t − t s ) C j ( ( 1 + η ) ( t − t s ) ) cos [ ( ω I F − ω d ) t + φ ] + n j ( t ) } j (13) ②仿真实现 BDS中频信号系统仿真流程如图3所示，主要包括以下功能模块：一是BDS导航电文仿真模块，基于BDS星历数据，依靠BDS-SIS-ICD-B1I-1.0文件定义的导航电文编码格式及误差模型，编制下行导航电文；二是信号状态参数设置模块，包含仿真时间、电离层延迟、对流层延迟等误差模型参数及中频信号参数的设置；三是BDS中频信号生成模块，根据仿真时间段内可视卫星数，仿真多颗BDS卫星合成信号。该中频信号仿真器为GPS、Galileo星座预留接口，依据相应的ICD文件就可以生成对应的导航电文，结合不同星座的载波频率就可以扩展为对应星座下的中频信号。 图3. 中频信号仿真流程图 传输时间计算、各种误差仿真、信号采样和量化参考文献 [ 12 ] [ 13 ] ，与GPS信号C/A码不同，B1I信号测距码(C B1I )码速率为2.046 Mcps，码长为2046。C B1I 码由两个线性序列G1和G2模二和产生平衡Gold码后截短 1 码 片生成。G1和G2序列分别由两个11级线性移位寄存器生成，其生成多项式为： G1 ( X ) = 1 + X + X 7 + X 8 + X 9 + X 10 + X 11 G 2 ( X ) = 1 + X + X 2 + X 3 + X 4 + X 5 + X 8 + X 9 + X 11 (14) 采用一种自适应步长计算方法，对多普勒信号进行精确的控制，判定准则为： { V 径 向 ≤ 100   m / s t s t e p = 1   ms 100   m / s < V 径 向 ≤ 1000   m / s t s t e p = 100   μ s 1000   m / s < V 径 向 ≤ 10000   m / s t s t e p = 10   μ s (15) BDS接收机基带信号处理算法参考GNSS软件接收机的设计思路，实现对BDS信号的捕获、跟踪、解调，环路估计等信息直接输入导航滤波器进行后续组合解算，这里不做详细介绍。  INS力学编排是根据INS的观测信息选取适当的数学模型计算出载体的速度、位置及姿态信息等导航定位参数。具体为：利用陀螺仪测得的载体相对于惯性坐标系的旋转角速度，计算得到载体坐标系至导航坐标系的转换矩阵；利用转换矩阵将加速度计测得的载体相对于惯性空间的加速度转换到导航坐标系，并补偿掉重力和Coriolis加速度，经积分得到导航定位信息 [ 13 ] 。相应的数据流程如图4所示。 图4. 当地水平坐标系下力学编排数据流程图 当地水平坐标系下的力学编排方程可以表达为： X ˙ L = [ r ˙ L V ˙ L R ˙ b L ] = [ D − 1 V L R b L f b − ( 2 Ω i e L + Ω e L L ) V L + g L R b L ( Ω i b b − Ω i L b ) ] (16) 式中， Ω 是角速度向量 ω 的反对称矩阵， Ω = [ 0 − ω z ω y ω z 0 − ω x − ω y ω x 0 ] ， Ω i e L = [ ω i e L × ] ， Ω e L L = [ ω e L L × ] ， Ω i b b = [ ω i b b × ] ， Ω i L b = [ ω i L b × ] ， f b = [ f x b f y b f z b ] T 是加速度计量测信息， ω i b b = [ ω i b x b ω i b y b ω i b z b ] T 是陀螺仪量测信息， r = [ φ λ h ] T 是位置向量信息， V = [ V E V N V U ] T 是速度向量信息， g L = [ 0 0 − g ] T ， R b L 为姿态转换矩阵， D − 1 = [ 0 1 M + h 0 1 ( N + h ) cos φ 0 0 0 0 1 ] 为转换矩阵，更详细的参数信息参考文献 [ 13 ] 。"
"为了验证BDS/INS深组合导航仿真平台性能，选用的参考时刻为 2015 年 9 月 9 日 0 时 0 分 0 秒 ，卫星高度截止角取15度，BDS中频模拟信号的采样频率为30 MHZ，中频频率为7 MHZ，预检测积分为1 ms，组合周期为1 s。模拟INS的器件特性参数见表1，其更新频率为100Hz。模拟载体速度1000 m/s，加速度为100 m/s 2 ，姿态角均为0˚。初始位置信息为东经108˚，北纬39˚，高程为200 m；初始位置误差为2 m，初始速度误差为0.1 m/s，初始对准姿态角误差为0.1˚。仿真时间为120 s，以仿真的标称运动轨迹作为真值，仿真结果与标称轨迹进行比较。位置误差和速度误差分别如图5和图6所示。 Table 1 元器件 参数 量值 单位 陀螺仪 偏差稳定性 50 deg/h 随机游走 1 deg / h 加速度计 偏差稳定性 1 mg 随机游走 0.1 mg / Hz 表1. INS器件特征参数 图5. 位置误差曲线图 图6. 速度误差曲线图 从上面的仿真结果可以看出： 1、在高动态条件下，BDS/INS深组合导航系统的位置、速度误差迅速收敛稳定在很小的误差范围内。位置方向的误差稳定在4 m范围内，速度误差稳定在0.2 m/s范围内。 2、经度方向位置误差及东向速度误差在仿真时出现较大偏差，是由于仿真时载体可观测性较差。"
"BDS/INS深组合导航具有广阔的应用前景，是目前研究的重点和热点。进行物理和半物理仿真试验，代价昂贵且试验难度大，而构建全数字仿真平台可以建立和提供接近实际的物理模型和工作参数，从而为方案论证提供依据，经济性和适应性强。本文给出BDS/INS深组合导航仿真平台的设计及实现方法，对系仿真平台的体系结构及信息流程进行详细的介绍。并以此平台为基础进行仿真分析，结果表明，高动态应用背景下，BDS/MEMS IMU深组合导航系统的位置误差稳定在4 m范围内，速度误差稳定在0.2 m/s内，这也表明了本文构建的BDS/INS深组合导航平台的正确性及有效性。后续将开展干扰情况下BDS/INS深组合导航精度相关研究，本研究内容对下一步设计BDS/INS深组合导航样机具有指导意义。"
