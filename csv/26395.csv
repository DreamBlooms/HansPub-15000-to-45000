"很多统计问题中会包含讨厌参数，在小样本情况下传统的频率学派无法给出较好的方法，然而大样本的获取往往成本较大，甚至无法完成，广义推断的提出很好的解决了此类假设检验问题。广义推断是基于广义检验变量和广义枢轴量的统计推断方法，随着信息技术与数据分析的发展，广义推断正发挥着它良好的性能，得到了广泛应用。此文章主要介绍广义枢轴量法在几种不同模型下的应用，通过构造广义枢轴量给出检验的广义p值，并通过假设检验与置信区间的一一对应关系给出兴趣参数的置信区间。 关键词 :广义检验变量，广义枢轴量，广义p值，广义置信区间 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"两总体均值差的假设检验问题来源于生产生活的实际需求之中，是医学、经济学以及现实的工业生产等各领域的统计工作中的一部分。然而因为检验问题中包含讨厌参数，且样本量有限，因此传统的频率学派很难给出精确的方法。本文利用广义推断思想方法的广义枢轴量法解决此类假设检验问题，另外，根据假设检验问题与区间估计的一一对应关系，对兴趣参数置信区间进行了研究。比较数值模拟的结果可知，通过广义枢轴量法得到的检验统计量犯第一类错误的概率都小于显著性水平α，不管样本量和总体数如何变化，结果都很好，确定了广义推断思想方法的良好性能。"
"定义1：广义检验变量与广义p值。 形如 T = ( X ; x , η ) 的广义检验变量，不仅是随机向量X的函数，也是观测值x和未知参数 η 的函数，且满足以下三个条件： 1) 对给定的x和 η = ( θ 0 , δ ) ， T = ( X ; x , η ) 的分布函数与讨厌参数 δ 无关。 2) 观测值 T = ( x ; x , η ) 与 η 无关。 3) 对给定的x和 ， P ( T ( X ; x , η ) ≥ T ( x ; x , η ) | x , η ) 关于 θ 非减(或非增)。 考虑单边假设检验问题； H 0 : θ ≤ θ 0 , H 1 : θ > θ 0 (1) 若 T = ( X ; x , η ) 关于 θ 非减，则关于检验问题(1)的广义p值为 sup θ ≤ θ 0 P ( T ( X ; x , η ) ≥ t ( x ) | θ = θ 0 ) 若 T = ( X ; x , η ) 关于 θ 非增，则关于检验问题(1)的广义p值为 其中 t ( x ) 为 T = ( X ; x , η ) 当 X = x 时的观测值 [ 1 ] 。 检验的p值是指在假设检验问题中利用观测值做出拒绝原假设的最小显著性水平，即拒绝域的上确界，因此有了上面的判断形式，这样可以避免事先确定显著性水平，也可以用p值与人们心中的显著性水平 α 进行比较，通常情况下，p值越小越容易拒绝原假设。  定义2：广义枢轴量和广义置信区间。 形如 R ( X ; x , η ) 的广义枢轴量是 X , x 和 η 的参数，其中 η = ( θ , δ ) ， θ 是兴趣参数， δ 是讨厌参数，并且满足以下条件： 1) 对给定的x， R ( X ; x , η ) 的分布与未知参数 η = ( θ , δ ) 无关。 2) 观测值 r = R ( x ; x , η ) 与讨厌参数 δ 无关。 假设给定广义枢轴量 R ( X ; x , η ) 和置信系数 γ ( 0 < γ < 1 ) ，寻找R的样本空间的一个子集 C γ ，使得 , 取 Θ γ = { θ | R ( x ; x , η ) ∈ C γ } , 则称 Θ γ 为参数 θ 的一个置信系数为 γ 的广义置信区间 [ 2 ] 。 广义枢轴量法解决了传统枢轴量法无法解决的问题，即当分布含有讨厌参数时枢轴量很难或者无法构造的问题。 事实上，广义检验变量T和广义枢轴量R之间有如下关系： T + R = g ( θ ) ，其中 g ( θ ) 为兴趣参数的函数，因此可以通过构造广义枢轴量的方法来进行假设检验，且其相应的广义p值可以通过二者的关系计算得到。  定义3：Fiducial广义枢轴量。 设 R ( X ; x , η ) 是关于 X , x 和 η 的参数，其中 η = ( θ , δ ) ， θ 是兴趣参数， δ 是讨厌参数，并且满足以下条件： 1) 对给定的x， R ( X ; x , η ) 的分布与未知参数 η = ( θ , δ ) 无关。 2) 观测值 R ( x , x , η ) = θ 。 则称 R ( X , x , η ) 为兴趣参数 θ 的Fiducial广义枢轴量。 可以看出Fiducial广义枢轴量是广义枢轴量的特殊情况，这也使得Fiducial广义枢轴量可以通过构造参数的Fiducial分布得到，且已经有了较为成熟的构造方法 [ 3 ] ，下面的部分将主要通过实例来做假设检验问题。"
"设 X 1 , X 2 , ⋯ , X m 和 Y 1 , Y 2 , ⋯ , Y n 是分别来自两正态总体 N ( μ 1 , σ 1 2 ) ， N ( μ 2 , σ 2 2 ) 的随机样本， X i ， Y j ， i = 1 , ⋯ , m ， j = 1 , ⋯ , n 相互独立，其中考虑检验问题： H 0 : μ 1 − μ 2 ≤ 0 , H 1 : μ 1 − μ 2 > 0 (2) 令 X ¯ = ∑ i = 1 m X i m ， Y ¯ = ∑ i = 1 n Y i n ， S 1 2 = ∑ i = 1 m ( X i − X ¯ ) 2 m ， S 2 2 = ∑ i = 1 n ( Y i − Y ¯ ) 2 n 已知 X ¯ , Y ¯ , S 1 2 , S 2 2 是独立的充分统计量，分别是 μ 1 , μ 2 , σ 1 2 , σ 2 2 的极大似然估计。其中： U 1 = X ¯ − μ 1 σ 1 2 / m ~ N ( 0 , 1 ) , U 2 = Y ¯ − μ 2 σ 2 2 / n ~ N ( 0 , 1 ) K 1 = m S 1 2 σ 1 2 ~ χ m − 1 2 , K 2 = n S 2 2 σ 2 2 ~ χ n − 1 2 是相互独立的随机变量。 设 ( x ¯ , y ¯ , s 1 2 , s 2 2 ) 是 ( X ¯ , Y ¯ , S 1 2 , S 2 2 ) 的观测值。 令 R ( X , Y , x , y , η ) = ( X ¯ − Y ¯ ) − ( U 1 s 1 2 / K 1 − U 2 s 2 2 / K 2 ) ， r o b s = R ( x , y , x , y , η ) = μ 1 − μ 2 ，则关于检验问题(2)的广义p值为： p = Pr ( R ( X , Y , x , y , η ) ≤ r ( x , y , x , y , η ) | μ 1 − μ 2 = 0 ) = Pr ( U 1 s 1 2 K 1 − U 2 s 2 2 K 2 ≤ x ¯ − y ¯ ) = Pr ( s 1 2 m − 1 U 1 K 1 / m − 1 − s 2 2 n − 1 U 2 K 2 / n − 1 ≤ x ¯ − y ¯ ) = Pr ( s 1 2 m − 1 T 1 − s 2 2 n − 1 T 2 ≤ x ¯ − y ¯ ) = Pr ( T 1 ≤ ( ( x ¯ − y ¯ ) + s 2 2 n − 1 T 2 ) ( s 1 2 m − 1 ) − 1 2 ) = E T 2 ( F T 1 ( ( x ¯ − y ¯ ) + s 2 2 n − 1 T 2 ) ( s 1 2 m − 1 ) − 1 2 ) 其中 T 1 = U 1 K 1 / m − 1 , T 2 = U 2 K 2 / n − 1 ，并且分别服从自由度为 m − 1 和 n − 1 的t分布。 F T 1 ( ⋅ ) 是自由度为 m − 1 的t分布的分布函数， E T 2 是对 T 2 来求得。 根据假设检验与区间估计的一一对应关系，我们可以得到 μ 1 − μ 2 的置信系数为 γ 单侧置信下限。 具体可以通过下面的形式得出： P ( R ( X , Y , x , y , η ) ≥ c ) = P r ( T 1 ≥ ( x ¯ − y ¯ + c ) + s 2 2 n − 1 T 2 ) ( s 1 2 m − 1 ) − 1 2 = 1 − E T 2 ( F T 1 ( ( x ¯ − y ¯ + c ) + s 2 2 n − 1 T 2 ) ( s 1 2 m − 1 ) − 1 2 ) = γ 因此， μ 1 − μ 2 的置信系数为 γ 的置信区间为 ( c γ , ∞ ) ，其中 c γ 满足： 1 − E T 2 ( F T 1 ( ( x ¯ − y ¯ + c γ ) + s 2 2 n − 1 T 2 ) ( s 1 2 m − 1 ) − 1 2 ) = γ  设 G ( α , β ) 表示形状参数为 α ，尺度参数为 β 的伽马分布， 和 Y 1 , Y 2 , ⋯ , Y n 是分别来自指数分布总体 G ( 1 , 1 / μ 1 ) ， G ( 1 , 1 / μ 2 ) 的随机样本，均值分别为 μ 1 和 μ 2 ， X i ， Y j ， i = 1 , ⋯ , m ， j = 1 , ⋯ , n 相互独立，考虑检验问题： H 0 : μ 1 − μ 2 ≤ δ 0 , H 1 : μ 1 − μ 2 > δ 0 (3) 其中 δ 0 ≥ 0 。 已知 X = ∑ X i ~ G ( m , 1 / μ 1 ) ， Y = ∑ X i ~ G ( n , 1 / μ 2 ) 是独立的充分统计量，因此检验可以基于两个充 分统计量来进行。 令 U = X μ 1 ~ G ( m , 1 ) ， V = Y μ 2 ~ G ( n , 1 ) ， R ( X , Y , x , y , η ) = x U − y V ，其中 ，则关于检验问题(3)的广义p值为： p = Pr ( R ( X , Y , x , y , η ) ≤ r ( x , y , x , y , η ) | μ 1 − μ 2 = δ 0 ) = Pr ( x U − y V ≤ δ 0 ) = Pr ( U ≥ x δ 0 + y / V δ 0 ) = 1 − E V ( F U ( x δ 0 + y / V ) ) 根据假设检验与区间估计的一一对应关系，我们可以得到 μ 1 − μ 2 的置信系数为 γ 单侧置信下限。具体可以通过下面的形式得出： Pr ( x U − y V ≥ c ) = Pr ( V ≥ y x / U − c ) = 1 − E U ( F V ( y x / U − c ) ) = γ μ 1 − μ 2 的置信系数为 γ 的置信区间为 ( c γ , ∞ ) ，其中 c γ 满足： 1 − E U ( F V ( y x / U − c γ ) ) = γ  设 X 1 , X 2 , ⋯ , X m 来自一截尾指数分布的一个样本，其密度函数为： p ( x ; α , β ) = { 1 β { − x − α β } ,       x ≥ α 0 ,                                       x ≤ α 其中， α ∈ R 为门限参数， β ∈ R 为尺度参数。考虑假设检验问题： H 0 : α + β ≤ μ 0 , (4) 其中， μ = α + β 是分布的均值。 已知 U = min X i 和 V = X ¯ − min X i 是两个独立的充分统计量。并且有： U − α ~ G ( 1 ; n / β ) ; Y 1 = 2 n β ( U − α ) ~ χ 2 2 ; Y 2 = 2 n β V ~ χ 2 ( n − 1 ) 2 令 R ( ( U , V ) ; ( u , v ) , η ) = u − v Y 1 Y 2 + 2 n v 1 Y 2 ，其中 r o b s = α + β ， 因此关于检验问题(4)的广义p值为： p = Pr ( R ( ( V , U ) ; ( v , u ) , θ ) ≤ r ( ( u , v ) ; ( u , v ) , θ ) | θ = μ 0 ) Pr ( u − v Y 1 Y 2 + 2 n v 1 Y 2 ≤ μ 0 ) = Pr ( ( Y 1 − 2 n ) / Y 2 ≥ ( u − μ 0 ) / v ) = E Y 1 ( ψ Y 2 ( ( Y 1 − 2 n ) ( u − μ 0 ) − 1 ) ) 其中， ψ ( ⋅ ) 是自由度为 2 ( n − 1 ) 的卡方分布的分布函数。 根据假设检验与区间估计的一一对应关系，我们可以得到 α + β 的置信系数为 γ 单侧置信下限。具体可以通过下面的形式得出： Pr ( u − v Y 1 Y 2 + 2 n v 1 Y 2 ≥ c ) = Pr ( u − v Y 1 Y 2 + 2 n v 1 Y 2 ≥ c ) = 1 − E Y 1 ( ψ Y 2 ( ( Y 1 − 2 n ) ( u − c ) − 1 ) ) = γ 因此 α + β 的置信系数为 γ 单侧置信区间为 ( c γ , ∞ ) ，其中 满足：  设 X 1 , X 2 , ⋯ , X m 和 Y 1 , Y 2 , ⋯ , Y n 是代表寿命的随机样本，分别来自指数分布总体 G ( 1 , 1 / μ x ) ， G ( 1 , 1 / μ y ) ，其均值分别为 μ x 和 μ y ， X i ， Y j ， ， j = 1 , ⋯ , n ，相互独立，同时假设对两总体寿命的观察分 别在抽取的第m个和第n个样本之后结束，考虑检验问题： H 0 : μ x − μ y ≥ δ 0 , H 1 : μ x − μ y < δ 0 (5) 已知 U = ∑ i = 1 m X ( i ) + ( M − m ) X ( m ) 和 V = ∑ i = 1 n Y ( i ) + ( N − n ) Y ( n ) 是 μ x 和 μ y 的充分统计量。并且有： U ~ G ( m , 1 / μ x ) ， V ~ G ( n , 1 / μ y ) ，因此： W 1 = 2 U μ x ~ χ 2 m 2 ; W 2 = 2 V μ y ~ χ 2 n 2 令 R ( ( U , V ) ; ( u , v ) , η ) = 2 u W 1 − 2 v W 2 ，其中 r o b s = μ x − μ y ， 因此关于检验问题(5)的广义p值为： p = Pr ( R ( ( V , U ) ; ( v , u ) , η ) ≥ r ( ( u , v ) ; ( u , v ) , η ) | θ = δ 0 ) = Pr ( 2 u W 1 − 2 v W 2 ≥ δ 0 ) = Pr ( W 2 ≥ 2 v 2 u / W 1 − δ 0 ) = 1 − E W 1 ( F W 2 ( 2 v 2 u / W 1 − δ 0 ) ) 其中 F W 2 ( ⋅ ) 是自由度为2n的卡方分布的分布函数。 根据假设检验与区间估计的一一对应关系，我们可以得到 μ x − μ y 的置信系数为 γ 单侧置信上限。具体可以通过下面的形式得出： Pr ( 2 u W 1 − 2 v W 2 ≤ c ) = 1 − E W 2 ( F W 1 ( 2 u c + 2 v / W 2 ) ) = γ 因此 μ x − μ y 的置信系数为 γ 单侧置信区间为 ( ∞ , c γ ) ，其中 满足： .  考虑随机效应模型： X i j = μ + α i + e i j , i = 1 , ⋯ , a ; j = 1 , ⋯ , n , 其中 μ 是未知参数， α i 是随机效应项，且 α i ~ N ( 0 , σ α 2 ) ， e i j 是误差项，且 e i j ~ N ( 0 , σ e 2 ) 。令 X ¯ i 为第i个随机效应的样本均值并且 X ¯ 为所有观测者的均值。令： S 1 = ∑ i = 1 a ∑ j = 1 n ( X i j − X ¯ i ) 2 , S 2 = n ∑ i = 1 a ( X ¯ i − X ¯ ) 2 其中 为组内平方和， S 2 为组间平方和。考虑假设检验问题： H 0 : σ α 2 ≤ δ 0 , H 1 : σ α 2 > δ (6) 已知 S 1 和 S 2 为充分统计量，且有： U = S 1 σ e 2 ~ χ a ( n − 1 ) 2 , V = S 2 σ e 2 + n σ α 2 ~ χ a − 1 2 构造广义枢轴量 R = s 2 n V − s 1 n U ，其中 ，且R关于 非减，因此关于检验问题(6)的广义p值为： p = P r ( s 2 n V − s 1 n U ≤ δ ) = P r ( V ≥ s 2 s 1 / U + n δ ) = 1 − E U ( F V ( s 2 s 1 / U + n δ ) ) . 其中 F V ( ⋅ ) 是自由度为 a − 1 的卡方分布的分布函数。 根据假设检验与区间估计的一一对应关系，我们可以得到 σ α 2 的置信系数为 单侧置信下限。具体可以通过下面的形式得出： P ( s 2 n V − s 1 n U ≥ c ) = E U ( F V ( s 2 s 1 / U + n c ) ) = γ 因此 σ α 2 的置信系数为 γ 置信区间为 ( c γ , ∞ ) ，其中 c γ 满足 E U ( F V ( s 2 s 1 / U + n c γ ) ) = γ 。"
"根据概率积分变换的性质，我们得到广义p值服从 [ 0 , 1 ] 上的均匀分布。 若显著性水平 α 为0.05，根据模拟结果得到的广义p值均控制在显著性水平以下，且有非常好的性能，当样本量或总量发生变化时，模拟的结果依然很稳定。 本文只在一元情形下做研究，关于广义p值在多元统计下的统计推断问题的应用我们会继续研究，虽然广义推断有着经典频率学派方法所没有的优点，但未必在所有情况下都适合，并且在很多情况下统计推断也无法给出相应的解决方法，这也是需要我们进一步进行探讨与研究的。"
