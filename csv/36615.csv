"本文采用非对称指数幂分布(AEP)与非对称拉普拉斯分布(ALD)对分位数回归模型的误差项进行假定，对此进行贝叶斯分位数回归的参数估计。针对参数后验密度的复杂性，采用吉布斯抽样算法，对ALD分布和AEP分布进行后验参数抽样。通过数值模拟结果可知，服从AEP分布的误差假定对数据的适应性比ALD分布的要强。 关键词 :分位数回归，非对称指数幂分布，非对称拉普拉斯分布，吉布斯抽样 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"分位数回归模型传承于经典最小二乘回归模型，相比于经典最小二乘回归模型，分位数回归模型提供了更多的信息，有利于解释因变量与自变量之间的关系。近年来，分位数回归在各个领域得到广泛的应用，很多学者越来越关注因变量在任意分位数水平下与自变量的关系。 1978年Koenker首次提出“分位数回归”概念 [ 1 ]，用于解释因变量与自变量之间的关系。1999年Koenker和Machado研究了非对称拉普拉斯分布和分位数回归之间的关系 [ 2 ]。2001年Keming Yu [ 3 ] 介绍了一种贝叶斯分位数回归思想，采用基于非对称拉普拉斯分布对参数进行估计，并证实无论数据的原始分布如何，使用非对称拉普拉斯分布对贝叶斯分位数回归建模是一种非常自然且有效的方法。自此，贝叶斯估计方法在分位数回归中有越来越多的应用。 目前，对于分位数回归模型的研究，基本集中在贝叶斯分位数估计、离散选择分位数回归估计、分位数处理效应模型以及无条件分位数回归方法的研究。针对贝叶斯分位数回归估计，它的关键在于将误差项设定为服从某种分布，由于非对称指数幂分布的优良性质比非对称拉普拉斯分布较好，而且非对称拉普拉斯分布还是非对称指数幂分布的一个特例，本文利用这一思想，使用非对称指数幂分布的似然函数来进行贝叶斯分位数回归参数估计。"
"对贝叶斯分位数回归模型进行参数估计，需要假定分位数回归中的误差项服从非对称拉普拉斯分布或者非对称指数幂分布。根据概率密度函数构建极大似然函数，依据贝叶斯定理，从参数先验分布中求解后验分布。两种分布的概率密度函数如下： 非对称拉普拉斯分布(Asymmetric Laplace Distribution, ALD)的概率密度函数为： f ( y ; μ , σ , p ) = p ( 1 − p ) σ exp { − y − μ σ [ p − I ( y ≤ μ ) ] } , y ∈ ( − ∞ , + ∞ ) (1) 其中， 0 < p < 1 为偏度参数， σ > 0 为尺度参数， − ∞ < μ < + ∞ 为位置参数。 非对称指数幂分布(Asymmetric Exponential Power Distribution, AEPD)是由Zhu Dongming [ 4 ] 等提出的，其概率密度函数为： f AEP ( y | μ , σ , α , p 1 p 2 ) = { 1 σ exp ( − | y − μ α σ / Γ ( 1 + p 1 ) | p 1 ) , y ≤ μ 1 σ exp ( − | y − μ ( 1 − α ) σ / Γ ( 1 + p 2 ) | p 2 ) , y > μ (2) 其中， Γ ( x ) 为gamma函数， 0 < α < 1 为偏度参数， σ > 0 为尺度参数， p 1 > 0 和 p 2 > 0 分别控制左尾和右尾参数， − ∞ < μ < + ∞ 为位置参数。当 α = 1 2 和 p 1 = p 2 时，AEPD分布为对称的指数幂分布；当 α = 1 2 和 p 1 = p 2 = 2 时，AEPD分布为标准的正态分布；当 p 1 = p 2 = 1 时便是ALD分布； p 1 ( p 2 ) 值越小，则左尾(右尾)越厚， α 值越大，则分布呈现为左偏。"
"在进行贝叶斯分位数回归模型的参数估计时，需要构建一般线性回归模型，假定回归模型中的误差项服从ALD分布与AEP分布，对此构建相应的似然函数。通过贝叶斯定理、参数先验分布求解该分布的后验分布。由于似然函数的复杂性，为了更快的求解后验分布，采用吉布斯抽样算法的思想。  y i = β 1 x i 1 + β 2 x i 2 + ⋯ + β k x i k + ε i ,     i = 1 , ⋯ , n ;   k = 1 , ⋯ , n (3) 其中， x i 为自变量， y i 为因变量， β k 为未知参数向量，误差项 ε i ~ ALD ( 0 , 1 , τ ) 和 ε i ~ AEP ( 0 , σ , α , p 1 , p 2 ) 。  根据假设分位数回归模型的误差项服从ALD分布，其似然函数为： L ( y i | x i T β , σ , p ) = p n ( 1 − p ) n σ n exp { − 1 σ ∑ i ρ p ( y i − x i T β ) } (4) 其中， ρ τ ( u ) = u ( p − I ( u < 0 ) ) 。 为了在分位数回归中采用吉布斯算法，因此参考2011年Kozumi和Kobayashi [ 5 ] 在文章中给出的吉布斯抽样方法，对此进行贝叶斯分位数回归参数估计。  Naranjo在2012 [ 6 ] 和2015 [ 7 ] 年对SEP分布和AEP分布进行相关的研究，提出了关于非对称指数幂相关的理论和方法。 设 Y | [ U 1 = u 1 ] ~ U ( μ − α σ Γ ( 1 + 1 p 1 ) u 1 1 p 1 , μ ) ， U 1 ~ G a ( 1 + 1 p 1 , 1 ) ，且概率为 α ，和 Y | [ U 2 = u 2 ] ~ U ( μ , μ + ( 1 − α ) σ Γ ( 1 + 1 p 2 ) u 2 1 p 2 ) ， U 2 ~ G a ( 1 + 1 p 2 , 1 ) ，且概率为 ( 1 − α ) ，则 Y ~ AEP ( μ , σ , α , p 1 , p 2 ) 。 根据假设分位数回归模型的误差项服从AEPD分布，其似然函数为： L ( y , x , u 1 , u 2 | β , σ , α , p 1 , p 2 ) = ∑ i = 1 n 1 σ { exp ( − u 1 ) I [ x i T β − α σ Γ ( 1 + 1 p 1 ) u 1 1 p 1 < y i < x i T β ]         + exp ( − u 2 ) I [ x i T β < y i < x i T β + ( 1 − α ) σ Γ ( 1 + 1 p 2 ) u 2 1 p 2 ] } (5) 其中， y = ( y 1 , ⋯ , y n ) T ， u 1 = ( u 11 , ⋯ , u 1 n ) T ， u 2 = ( u 21 , ⋯ , u 2 n ) T ， x = ( x 1 , ⋯ , x n ) T ， β = ( β 1 , ⋯ , β n ) T 。 根据贝叶斯定理，参数的联合后验密度为： P ( u 1 , u 2 , β , σ , α , p 1 , p 2 | y , x ) ∝ f ( β ) f ( σ ) f ( α ) f ( p 1 ) f ( p 2 ) σ − n       × ∑ i = 1 n ( exp ( − u 1 ) ∑ i = 1 n 1 σ { exp ( − u 1 ) I [ x i T β − α σ Γ ( 1 + 1 p 1 ) u 1 1 p 1 < y i < x i T β ]       + exp ( − u 2 ) I [ x i T β < y i < x i T β + ( 1 − α ) σ Γ ( 1 + 1 p 2 ) u 2 1 p 2 ] } ) (6) 其中， f ( β ) , f ( σ ) , f ( α ) , f ( p 1 ) , f ( p 2 ) 均为待估参数的先验密度函数。 设定参数的先验分布为： { u 1 , u 2 ~ E x p ( 1 ) σ ~ I G ( a σ , b σ ) α ~ B e t a ( a α , b α ) p 1 , p 2 ~ N ( a p i , b p i ) β ~ N k ( b , B ) (7) 其中， E x p ( 1 ) 为参数为1的指数分布，IG为逆伽玛分布，Beta为贝塔分布，N为正态分布， N k 为多元正态分布。 根据贝叶斯定理可得参数的待估后验密度为： 1) u 1 , u 2 P ( u 1 i | y , x , β , σ , α , p 1 , p 2 ) ∝ f ( u 1 i ) I [ u 1 i > ( ( x i T β − y i ) Γ ( 1 + 1 p 1 ) α σ ) p 1 ] ( y i < x i T β ) ∝ E x p ( 1 ) I [ u 1 i > ( ( x i T β − y i ) Γ ( 1 + 1 p 1 ) α σ ) p 1 ] ( y i < x i T β ) (8) P ( u 2 i | y , x , β , σ , α , p 1 , p 2 ) ∝ f ( u 2 i ) I [ u 2 i > ( ( y i − x i T β ) Γ ( 1 + 1 p 2 ) ( 1 − α ) σ ) p 2 ] ( y i > x i T β ) ∝ E x p ( 1 ) I [ u 2 i > ( ( y i − x i T β ) Γ ( 1 + 1 p 2 ) ( 1 − α ) σ ) p 2 ] ( y i > x i T β ) (9) 其中， I ( ⋅ ) 为指示函数。 2) σ P ( σ | y , x , u 1 , u 2 , α , β , p 1 , p 2 ) ∝ f ( σ ) 1 σ n I [ σ > σ _ ] ∝ I G ( n − 1 + a σ , b σ ) I [ σ > σ _ ] (10) 当 u 1 i > 0 时， x i T β − α σ Γ ( 1 + 1 p 1 ) u 1 i 1 p 1 < y i ，化简为： σ > ( x i T β − y i ) Γ ( 1 + 1 p 1 ) α u 1 i 1 / p 1 当 u 2 i > 0 时， y i < x i T β + ( 1 − α ) σ Γ ( 1 + 1 p 2 ) u 2 1 p 2 ，化简为： σ > ( y i − x i T β ) Γ ( 1 + 1 p 2 ) ( 1 − α ) u 2 i 1 / p 2 由此可得： σ _ = max { ( x i T β − y i ) Γ ( 1 + 1 p 1 ) α u 1 i 1 / p 1 , ( y i − x i T β ) Γ ( 1 + 1 p 2 ) ( 1 − α ) u 2 i 1 / p 2 } 。 3) α P ( α | y , x , u 1 , u 2 , σ , β , p 1 , p 2 ) ∝ f ( α ) I [ α _ < α < α ¯ ] ∝ B e t a ( a α , b α ) I [ α _ < α < α ¯ ] (11) 当 u 1 i > 0 , u 2 i > 0 时，有 x i T β − α σ Γ ( 1 + 1 p 1 ) u 1 i 1 p 1 < y i < x i T β + ( 1 − α ) σ Γ ( 1 + 1 p 2 ) u 2 1 p 2 化简可得： max { 0 , ( x i T β − y i ) Γ ( 1 + 1 p 1 ) σ u 1 i 1 / p 1 } < α < min { 0 , 1 − ( y i − x i T β ) Γ ( 1 + 1 p 2 ) σ u 2 i 1 / p 2 } α _ = max { 0 , ( x i T β − y i ) Γ ( 1 + 1 p 1 ) σ u 1 i 1 p 1 } α ¯ = min { 0 , 1 − ( y i − x i T β ) Γ ( 1 + 1 p 2 ) σ u 2 i 1 / p 2 } 4) p 1 , p 2 P ( p 1 | y , x , u 1 , u 2 , α , σ , β , p 2 ) ∝ f ( p 1 ) I [ x i T β − y i α σ < u 1 i 1 / p 1 Γ ( 1 + 1 p 1 ) ] ( u 1 i > 0 ) ∝ N ( a p 1 , b p 1 ) I [ x i T β − y i α σ < u 1 i 1 / p 1 Γ ( 1 + 1 p 1 ) ] ( u 1 i > 0 ) (12) P ( p 2 | y , x , u 1 , u 2 , α , σ , β , p 1 ) ∝ f ( p 2 ) I [ y i − x i T β ( 1 − α ) σ < u 2 i 1 / p 2 Γ ( 1 + 1 p 2 ) ] ( u 2 i > 0 ) ∝ N ( a p 2 , b p 2 ) I [ y i − x i T β ( 1 − α ) σ < u 2 i 1 / p 2 Γ ( 1 + 1 p 2 ) ] ( u 2 i > 0 ) (13) 5) β 设 β − j T = ( β 1 , ⋯ , β j − 1 , β j + 1 , ⋯ , β k ) 为不含第j个参数的向量， β 的先验分布服从多元正态分布，根据贝叶斯定理和多元正态分布性质可得： P ( β j | y , x , u 1 , u 2 , β − j , α , σ , β , p 1 , p 2 ) ∝ f ( β j ) I [ β j ∈ ( β _ j , β ¯ j ) ] ∝ N ( b j * , B j * ) I [ β j ∈ ( β _ j , β ¯ j ) ] (14) 其中， j = 1 , ⋯ , k ， b j * = b j − B j ( − j ) B ( − j ) ( − j ) − 1 ( β ( − j ) − b ( − j ) ) ， B j * = B j j − B j ( − j ) B ( − j ) ( − j ) − 1 B ( − j ) j ；由似然函数可知： x i T β − α σ Γ ( 1 + 1 p 1 ) u 1 1 p 1 < y i < x i T β + ( 1 − α ) σ Γ ( 1 + 1 p 2 ) u 2 1 p 2 当 x i j > 0 时，化简为： y i − x i ( − j ) T β ( − j ) x i j − ( 1 − α ) σ u 2 i 1 / p 2 x i j Γ ( 1 + 1 / p 2 ) < β j < y i − x i ( − j ) T β ( − j ) x i j + α σ u 1 i 1 / p 1 x i j Γ ( 1 + 1 / p 1 ) 当 x i j < 0 时，化简为： y i − x i ( − j ) T β ( − j ) x i j + α σ u 1 i 1 / p 1 x i j Γ ( 1 + 1 / p 1 ) < β j < y i − x i ( − j ) T β ( − j ) x i j − ( 1 − α ) σ u 2 i 1 / p 2 x i j Γ ( 1 + 1 / p 2 ) 由此可得： β _ j = { y i − x i ( − j ) T β ( − j ) x i j − ( 1 − α ) σ u 2 i 1 p 2 x i j Γ ( 1 + 1 p 2 ) , y i − x i ( − j ) T β ( − j ) x i j + α σ u 1 i 1 / p 1 x i j Γ ( 1 + 1 / p 1 ) } β ¯ j = { y i − x i ( − j ) T β ( − j ) x i j + α σ u 1 i 1 p 1 x i j Γ ( 1 + 1 p 1 ) , y i − x i ( − j ) T β ( − j ) x i j − ( 1 − α ) σ u 2 i 1 / p 2 x i j Γ ( 1 + 1 / p 2 ) }"
"针对一般化的形式，数据由以下设定生成： { y i = β 1 x 1 + β 2 x 2 + ε i ,   i = 1 , 2 , ⋯ , n x i ~ u n i f ( 0 , 100 ) β 1 = 3 , β 2 = 2 , (15) 由于不同的误差项分布会影响分位数回归系数的变化，本文将讨论误差项 ε i ~ ALD ( 0 , 1 , p ) 和 ε i ~ AEP ( 0 , σ , α , p 1 , p 2 ) ，生成两种不同的模拟数据。 图1给出了标准化非对称拉普拉斯分布的密度图。从中可以看到，随着偏度参数(p)不断的变化，该分布也呈现出不同的变化：当 p = 0.1 时，ALD密度图的取值集中在中右尾，当 p = 0.3 时，ALD密度图呈现左偏现象，取值偏在右尾，当 p = 0.5 时，两侧分布是对称的。 图1. 标准化非对称拉普拉斯分布(ALD)密度图 图2给出了非对称指数幂分布(AEPD)随偏度参数( α )变化密度图。从图中可以看到，随着偏度参数 α 不断的增大，该图呈现左偏现象。 图2. 非对称指数幂分布(AEPD)随偏度参数(α)变化密度图 图3给出了非对称指数幂分布(AEPD)随着左尾参数( p 1 )变化密度图。从图中可以看出，随着左尾参数 p 1 不断的减小，该分布呈现左尾厚重的现象。 图3. 非对称指数幂分布(AEPD)随着左尾参数( p 1 )变化密度图 图4给出了非对称指数幂分布(AEPD)随着左尾参数( p 2 )变化密度图。从图中可以看出，随着左尾参数 p 2 不断的减小，该分布呈现右尾厚重的现象。 图4. 非对称指数幂分布(AEPD)随右尾参数( p 2 )变化密度图 针对模型(15)产生相应的分布数据，ALD分布随机数可由R语言中ald包中的rALD函数生成；对于AEPD分布随机数可由3.3节中生成。采用Gibbs抽样算法对两种分布进行参数抽样，在对非对称指数幂分布进行参数抽样时，可依据(8)、(9)、(10)、(11)、(12)、(13)和(14)进行贝叶斯条件后验密度参数抽取。从条件后验密度中可以看出，对每种共轭分布进行参数抽样时，都必须进行截断处理，可使用R语言中的LaplacesDemon包，对常见的截断分布进行随机数抽样。 Table 1 样本量 服从分布 分位点 β 1 β 2 σ α p 1 p 2 25 真值 - 3 2 1 - 0.5 2 ALD 0.25 3.21769 2.61343 - - - - 0.5 2.99164 2.50190 - - - - 0.75 2.80045 2.27823 - - - - AEP 0.25 3.09100 2.01110 1.04400 0.32920 0.50870 2.10583 0.5 3.12700 1.97490 1.05900 0.49630 0.50710 2.13347 0.75 3.14700 1.96430 1.03000 0.69330 0.50680 2.14629 75 ALD 0.25 3.48854 1.86533 - - - - 0.5 3.12252 1.75050 - - - - 0.75 3.17599 1.80351 - - - - AEP 0.25 2.82540 2.08200 1.01400 0.32836 0.50990 2.11686 0.5 2.77225 2.55186 1.01900 0.49516 0.50750 2.13644 0.75 3.10410 2.02950 1.01000 0.69320 0.49980 2.13935 100 ALD 0.25 2.89894 1.83473 - - - - 0.5 2.99395 2.03291 - - - - 0.75 2.78297 1.85832 - - - - AEP 0.25 2.82131 1.95700 1.01000 0.33197 0.50200 2.07409 0.5 2.89455 1.94560 1.01400 0.49911 0.50090 2.08550 0.75 3.06794 1.96022 1.00700 0.69420 0.50040 2.11248 表1. 服从ALD分布和AEP分布的估计模拟值与真值对照表 从上表1中可以看出，非对称指数幂分布对于贝叶斯分位数回归来说是非常适应的，由于非对称指数幂的优势，在处理数据的偏度和重尾时，非对称拉普拉斯分布就稍逊一些，ALD分布只能处理偏度问题，对于拖尾的数据，ALD分布并没有参数对其进行控制，所以AEP分布相对处理起来就比ALD分布灵活一些，也更适合现在的数据。在低分位点和高分位点可以看出，对于未知参数的估计有所变化，ALD分布的参数估计使得参数值在变小，而AEP分布的参数估计却在变大。也可以看到，AEP分布在其他未知参数的估计也比较接近真实值；在样本量为25时，AEP分布的模拟结果更加接近真实真；在样本量为100时，各分位点下，AEP分布的模拟结果都稍接近真实值。 图5中给出了样本量为100时，迭代5000次，去掉前500次，服从ALD分布的 β 1 ， β 2 在0.25分位点的MCMC抽样轨迹图，可以看出，均在设定值上下波动，因此抽样构成的马尔科夫链收敛。 图5. 服从ALD分布的 β 1 ， β 2 的MCMC抽样值轨迹图 图6中给出了样本量为100时，迭代5000次，去掉前300次，服从AEP分布的 β 1 ， β 2 在0.25分位点的MCMC抽样轨迹图，可以看出，均在设定值上下波动，因此抽样构成的马尔科夫链收敛。 图6. 服从AEP分布的 β 1 ， β 2 的MCMC抽样值轨迹图"
"本文对贝叶斯分位数回归的参数估计，从以往的ALD分布扩展到AEP分布，并对ALD分布和AEP分布进行Gibbs算法抽样。从ALD分布和AEP分布的密度图可以看出，AEP分布相对于ALD分布来说对于数据的适应性更强。从模拟的情况来看，AEP分布针对数据在低分位和高分位时，参数的估计值会比较接近真值，这也体现了它的优势。由于AEP分布的特点，AEP分布在金融数据中会得到更好的运用，由于金融数据的复杂性，ALD分布在厚尾状况下，无法对数据进行处理，而AEP分布刚好能处理这方面的问题。"
