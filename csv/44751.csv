"在信息化数字化的大环境下，实现能源管理系统的在线监测办法无形中成为了企业能源管理最基础的措施。而系统中的能源需求预测功能为企业的节能降耗提供最有力的数据支撑。为提高预测准确率，本文提出了一种改进的多维灰色模型能源预测算法，先使用指数加权方式进行源特征数据处理增加趋势平滑度，再用自适应粒子群与多维灰色模型算法组合，使预测的精度在原始数据不完整的情况下达到最高，为能源信息化水平不足提供了新的解决思路，解决了企业的系统优化，能源调度和管理的问题。将提出的改进算法在实际的企业项目中运行，结果显示：优化后的自适应粒子群多维灰色模型预测算法正确率最高可达到93.573%，比传统的预测算法精确度提高约36%左右。"
"中国已经迅速成为能源消耗量最大的国家。2019年全年能源消费总量达48.6亿吨标准煤，比上年增长3.3%，以钢铁行业为例：2020年中国的粗钢产量达10.65亿吨，占全球粗钢产量的一半以上，中国钢铁行业的能耗约占全国总能耗的8.9% [ 1 ] [ 2 ]。 这些惊人的数据都表明着传统工业制造业能源消耗和二氧化碳排放都对地球造成了巨大的压力。对于这种高耗能企业来说，产销，季节性周期，环境因素，国家政策等因素都对能源损耗有不同权重的影响，选择合适的能源预测方法，结合企业运行的能源需求数据，预测未来一段时间的能源损耗情况，进而提高能源利用率，促进企业进行能源优化调度，以达到节能减排，提高生产效率，减少生产成本的目的 [ 3 ] [ 4 ]。 目前进行能源预测的方法有很多 [ 5 ] [ 6 ]，综合运用系统动力学模型、灰色系统模型、向量自回归模型、变权重组合预测模型等。因样本量少，不需要考虑特征数据的分布状态和趋势，因此对灰色模型进行能源需求预测进行研究分析。为提高预测精确度，本文提出的改进灰色模型也是基于这几个方面的缺陷。 传统的灰色模型理论是由我国学者邓聚龙先生于1982年提出的，主要用来研究样本信息匮乏的数据预测问题，根据部分已知的信息推算出系统发展规律，对未来状态做出定量考察。传统的灰色模型预测算法有着很多影响预测结果的问题，原始数据序列的光滑度，数据的级别偏差，多维自变量因素。张怡 [ 7 ] 提出一种将X(1)的第n个分量作为灰色微分模型的初始条件与优化背景值相结合的方式改进GM(1,1)。谢乃明 [ 8 ] 用麦克劳林公式解释了传统灰色模型不稳定的原因，提出一种离散预测灰色模型(DGM(1,1))。陈淑燕 [ 9 ] 提出嵌入型，并联和串联型三种灰色模型预测结构与神经网络进行组合，在高速公路断面实时交通量数据中进行结果验证。牛东晓 [ 10 ] 考虑两种非线性趋势的复杂季节型负荷预测问题，对于这种具有波动性趋势的电力负荷，提出一种季节型负荷预测的组合优化灰色神经网络模型，经实验证明该模型兼顾了季节型和同季波动性的特性，对电力负荷预测提供了一个新颖精确度高的方法。自适应粒子群算法 [ 11 ] 是一种通过设定迭代终止条件来在随机生成的粒子中求解出最优解。本文所提出的优化多维灰色预测模型其实是利用自适应粒子群算法收敛速度快，全局优化能力强的优点求解灰色模型中的参数，提高模型的预测精度。"
"能源管理系统是针对明确的高耗能企业进行个性化能源管理，因此针对能源预测功能所用的模型必须具有广泛性的特点 [ 12 ]。我们结合所有的设计需求，最终选用灰色系统方法对能源数据进行预测。灰色预测是指采用GM(1,1)模型对系统行为特征值的发展变化进行预测。高耗能企业的能源种类并不是单一的，是一个多能源融合的数据分析。企业的能源损耗依赖于产品的生产。而产品的需求很大程度上依赖于大环境的影响。考虑这些不确定因素，综合来看，灰色系统办法处理此类问题理论上是有效的。在我们的测试过程中也被证实是有效的。 设变量的原始序列为： X ( 0 ) = X ( 0 ) ( i ) ,   i = 1 , 2 , 3 , ⋯ , n (1) 首先对 X 0 进行一次累加，生成的一次累加序列为： X ( 1 ) = X ( 1 ) ( k ) , k = 1 , 2 , 3 , ⋯ , n (2) 最终的灰色预测模型序列满足以下关系： X ^ ( 1 ) ( k ) = ( X ( 0 ) ( 1 ) − u / a ) ∗ e − a ( k − 1 ) + u / a (3) 其中k为时间序列，a，u为待定系数，可以用 a ^ = [ a , u ] T 来表示，并利用最小二乘法进行求解 a ^ = ( B T B ) − 1 B T Y n 。其中： B = ( − 1 / 2 ( X 1 ( 1 ) + X 1 ( 2 ) ) 1 − 1 / 2 ( X 1 ( 2 ) + X 1 ( 3 ) ) 1 ⋮ ⋮ − 1 / 2 ( X 1 ( n − 1 ) + X 1 ( n ) ) 1 ) (4) Y n = ( X ( 0 ) ( 2 ) , X ( 0 ) ( 3 ) , X ( 0 ) ( 4 ) , ⋯ , X ( 0 ) ( n ) ) T (5) 经过累加后的数据序列已经失去意义，必须通过累减还原为原来数据序列： { X ^ ( 0 ) ( k ) = X ^ ( 1 ) ( k ) − X ^ ( 1 ) ( k − 1 ) k > 2 X ( 0 )   x = 1 (6) 时间序列k递增至未来，即为预测数据。 原始数据是否可以进行灰色预测，则需要对数据进行可行性检验： λ ( k ) = X ( 0 ) ( k − 1 ) / X ( 0 ) ( k ) , k = 2 , 3 , 4 , ⋯ , n (7) 若满足 λ ( k ) ∈ [ e − 2 / n + 1 , e 2 / n + 1 ] ，其中n表示原始数据序列的个数，则 X ( 0 ) 可建立灰色模型，进行灰色预测。 否则需要对数据进行处理，使其落在有效范围内，如平移转换： y ( 0 ) ( k ) = x ( 0 ) ( k ) + c , k = 1 , 2 , 3 , ⋯ , n (8) 此算法可实现企业的能源需求预测，也可实现在企业采取节能措施后的效果预测，或者将生产数据和设备能耗数据的关系函数数值进行预测，对设备进行全生命周期的管理，由被动维修变为主动保养，减少由于设备停摆或者老化所带来的损失。为能源系统的安全稳定和持续经济运行提供了很好的支持。  GM(1,1)是一种呈指数增长模型的预测方法，其预测精确度受原始数据序列光滑度离散性的限制，提高原始数据序列光滑度的办法有指数加权法，对数变换，和开n次方等方法。对于不同趋势的原始数据，预测结果的误差率比较则不同。我们这里研究的是指数加权法。 设原始数据为： X ( 0 ) = X ( 0 ) ( i ) , i = 1 , 2 , 3 , ⋯ , n (9) 对原始数据按照以下公式进行处理，生成新序列 Y ( 0 ) ( i ) Y ( 0 ) ( i ) = α X ( 0 ) ( i ) + ( 1 − α ) Y ( 0 ) ( i − 1 ) , i = 1 , 2 , 3 , ⋯ , n (10) 将新序列带入GM(1,1)模型进行预测，获得预测序列 Y ^ ( 0 ) ( i ) X ( 0 ) ( i ) = [ Y ^ ( 0 ) ( i ) − ( 1 − α ) Y ^ ( 0 ) ( i − 1 ) ] / β , i = 1 , 2 , 3 , ⋯ , n (11) 最后按照下列公式对序列进行还原。 在此过程中， α , β 的参数调整控制预测结果和精度。  在传统一维灰色模型的基础上，增加了相关的影响因子序列。原始数据序列为 X ( 0 ) 相关因素序列为： X 2 ( 0 ) ( i ) = ( X 2 ( 0 ) ( 1 ) , X 2 ( 0 ) ( 2 ) , X 2 ( 0 ) ( 3 ) , ⋯ , X 2 ( 0 ) ( n ) )                                                                   ⋮ X N ( 0 ) ( i ) = ( X N ( 0 ) ( 1 ) , X N ( 0 ) ( 2 ) , X N ( 0 ) ( 3 ) , ⋯ , X N ( 0 ) ( n ) ) (12) 再将原始特征数据和因素数据进行累加 X k ( 1 ) ( i ) = ∑ i − 1 n X k ( 1 ) ( i ) , i = 1 , 2 , 3 , ⋯ , n (13) 紧邻均值序列计算公式为： Z 1 ( 1 ) ( i ) = 1 / 2 [ X 1 ( 1 ) ( i ) + X 1 ( 1 ) ( i − 1 ) ] , i = 1 , 2 , 3 , ⋯ , n (14) 最后建立灰色理论方程： X 1 ( 0 ) ( i ) + α Z 1 ( 1 ) ( i ) = ∑ k − 2 N b k X 1 ( 0 ) ( i ) , i = 1 , 2 , 3 , ⋯ , n (15)  在迭代中不断缩小种群搜索空间，使粒子能够跳出之前的搜索最优解，在更大的空间开展搜索，增加搜索到最优解的可能性。第i个粒子在L维空间的搜索位置是X i ，他所经历的最好的位置是 P b e s t i = ( p i 1 , p i 2 , ⋯ , p i l ) ，整个粒子群所经历最好的位置为 G b e s t i = ( p k 1 , p k 2 , ⋯ , p k l ) 。 V i ( t + 1 ) = W V i ( t ) + c 1 r 1 ( P b e s t i ( t ) − X i ( t ) ) + c 2 r 2 ( G b e s t g ( t ) − X i ( t ) ) + ⋯ (16) X i ( t + 1 ) = X i ( t ) + V i ( t + 1 ) (17) 其中 c 1 , c 2 是加速度因子， r 1 , r 2 是[0,1]之间的随机数， X i ( t ) 和 V i ( t ) 分别是第i个粒子的当前位置和飞行速度。"
"对于应用型的系统设计来说，我们需要考虑到物理层数据采集不完整或者运行初期样本数量少的情况，为满足客户对这一功能的使用，基于对原始数据样本要求不高，但能预测出相对误差较小的能源损耗趋势。因此本文选择研究灰色模型来进一步改进提高预测精确度。根据钢铁行业的能源损耗监测的结果来看，电力负荷类型复杂，对电力数据进行预测分析是整个系统的重头戏。为验证对能源需求预测算法的准确度，我们对比了传统灰色模型，指数加权优化灰色模型和自适应粒子集群优化多维灰色模型的预测误差率结果。选取变电站南钢2P64线——表记耗电量原始特征数据。在预测之前对样本选择做了限制：原始数据进行时间序列的特征提取，系统的数据采集频率是每分钟，因减少差异性所以设定同一个区域同一个设备级别的： · 小时级别的(这是每天的第几个小时)； · 天级别的(这是每周的第几天，每月的第几天，每年的第几天)； · 周级别(星期几，每年的第几周)； · 月级别(哪一月，是否是月初，是否是月末)； · 季度级别(对系统运行时间，采集到的数据周期跨度有要求)； · 年度级别(对系统运行时间，采集到的数据周期跨度有要求)。 我们选取2021年1月份到3月份的每周一上午10:00的变电站南钢2P64线电力损耗数据，具体数据如下表1所示： Table 1 日期 变电站南钢2P64线——表计耗电量趋势 2021-01-04 10:00:00 36963.87 2021-01-11 10:00:00 36678.71 2021-01-18 10:00:00 34787.11 2021-01-25 10:00:00 36963.87 2021-02-01 10:00:00 38072.27 2021-02-08 10:00:00 38678.71 2021-02-15 10:00:00 37534.18 2021-02-22 10:00:00 37534.18 2021-03-01 10:00:00 35855.47 2021-03-08 10:00:00 37534.18 2021-03-15 10:00:00 36787.11 2021-03-22 10:00:00 38104.49 2021-03-29 10:00:00 40216.8 表1. 变电站南钢2P64线——表记耗电量数据 经过计算，数据满足级别要求，可选用传统灰色模型算法进行预测。预测结果的平均准确率为57.143%。经过计算，预测处理的能源数据的总体误差很大，预测准确率太低，数据趋势也与实际情况有很大出入。作为预测模型进行能源损耗数据的预测是不可取的。传统灰色模型预测误差分析如下表2所示： Table 2 时间 原始值 预测值 残差 相对误差 级别偏差 2021-01-04 10:00:00 36,963.87 36,963.87 0.000 0 0.000 2021-01-11 10:00:00 36,678.71 36,173.47347 1.008 0.01377475 0.014 2021-01-18 10:00:00 34,787.11 36,423.70718 1.054 0.04704599 −0.062 2021-01-25 10:00:00 36,963.87 36,675.67192 0.941 0.00779683 0.052 2021-02-01 10:00:00 38,072.27 36,929.37964 0.971 0.03001853 0.022 2021-02-08 10:00:00 38,678.71 37,184.84242 0.984 0.03862253 0.009 2021-02-15 10:00:00 37,534.18 37,442.07238 1.030 0.00245402 −0.038 2021-02-22 10:00:00 38,534.18 37,701.08176 0.974 0.02161976 0.019 2021-03-01 10:00:00 35,855.47 37,961.88286 1.075 0.05874729 −0.082 2021-03-08 10:00:00 37,534.18 38,224.48809 0.955 0.01839143 0.038 2021-03-15 10:00:00 36,787.11 38,488.90991 1.020 0.04626075 −0.027 2021-03-22 10:00:00 38,104.49 38,755.16089 0.965 0.01707596 0.028 2021-03-29 10:00:00 40,216.8 39,023.25369 0.947 0.0296778 0.046 表2. 传统灰色模型预测分析表 为提高预测准确度，我们对原始数据的平滑度进行优化。通过调节指数加权算法中的α，β参数，优化后的一维灰色模型预测结果平均准确率为67.376%。考虑的可能原因如下：对于钢铁行业来说，能源损耗与产销，与季节性周期，环境因素，国家政策等因素有不同权重的影响，这是传统灰色模型的理论缺点。随后列举出影响能源需求数据的所有因素，按照能源管控平台所能提供的其他因素数据，我们选取企业运行温度，生产产量作为影响因子序列，用自适应粒子群求解粒子的位置和更新速度，通过不停地迭代，确定Pbesti，Gbesti和w，输出灰色模型的参数带入目标函数。 利用表1的原始数据进行实验验证，实验结果如图1所示，其中Testing data1为指数加权改进的灰色模型预测结果，Testing data2为自适应粒子群多维灰色模型的预测结果： 由图知，原始数据为非单调增长趋势函数类型，传统的灰色模型预测出来的曲线趋势近似指数函数。这也是传统灰色模型的预测缺陷，即对原始数据的要求严格。当特征数据呈指数趋势，预测效率是最好的。我们通过指数加权的方式对原始数据的平滑度进行处理，改进后的预测精确度和传统模型比，有了初步的提高。而自适应粒子群多维灰色模型预测结果是最好的，整体趋势更接近于原始特征数据，在多个时间节点上都更接近于原始数据。经过计算，预测准确度高达93.573%。 图1. 几种不同预测算法的结果折线对比图"
"就目前的工业企业来说，生产，供应，销售，管理等各个环节都存在一定的能源浪费 [ 13 ]。这些节能减排需求和运行短板，使得企业生产效率低下，能源浪费 [ 14 ] [ 15 ]。本文所设计的自适应粒子群与灰色模型结合，在实际的非单调增长趋势的能源数据预测中，得到了很好的应用，改善了传统的灰色模型预测数据的局限性。该模型运用在能源管理系统中，可为企业提供最有力的数据支持，在满足企业生产的前提下，最大限度地进行能源调度，实现节能减排，优化生产过程，减少生产成本。 该算法在实验中虽然大大提高了预测准确度，但是影响因素的选择有待考量。生产企业的电力损耗相关性因素有待挖掘。原始数据的不同曲线趋势与预测模型的选择的相关性也是值得研究的话题。"
