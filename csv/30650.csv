"本文根据血压连续监测需求，设计并实施了一套基于心电脉搏的无创连续血压检测系统。采用硬件终端 + 手机APP的监护模式，硬件终端实现心电与脉搏信号采集与处理；手机APP实现对心电、脉搏信号的特征点识别，建立血压测量模型，获取脉搏传导时间，计算得到血压值。本系统有效的实现无创连续血压测量，为高血压疾病的治疗与预防提供了一种有效的解决方案。 关键词 :血压，脉搏波传导时间，心电，脉搏 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"血压是血液对血管壁在单位面积上的侧压力，即压强，其测量单位常用mmHg来表示(1 mmHg = 0.133 KPa)。血压是反应人体心血管状况的重要生理参数，在医学上成为了疾病判断、观察治疗成果、预后判断的重要依据 [ 1 ] 。根据统计表明，在国内每年有近300万心血管患者死亡，而这其中超过一半与高血压有关系 [ 2 ] 。因此，保证血压测量的准确性与实时性，对于心血管疾病的治疗与预防具有至关重要的作用。 现有的人体连续血压测量方法可以分为有创测量法和无创测量法。有创连续血压监测一般通过动脉插管法测量，将连接压力传感器的导管插入大动脉或者心脏来监测血压信号，从而实现连续测量血压，但是这种方法局限性很大。无创连续测量方法包括示波测量法、动脉张力测量法、容积补偿测量法和脉搏波传导时间测量法 [ 3 ] 。 相比较于其他的无创血压测量方式，基于心电(ECG, electrocardiograph)与光电容积脉搏波(PPG, Photoplethysmography)相结合测量脉搏波传导时间(PTT, pulse transit time)，在利用PTT与血压之间的关系来获取血压，该方法在设计上更加的简单易行。本文设计了一种连续血压测量系统，集心电检测、脉搏检测、信号处理、蓝牙传输于一体，以接触式传感器代替原有的充气式袖带，装备实用，操作简单。"
"1878年，Moens与Korteweg经过实验提出了脉搏波速度(pulse wavevalociy, PWV) [ 4 ] 的公式： P W V = K E h ρ D (1) 式中h为血管壁厚度，D为血管平衡状态的内径，ρ为血液密度，E为血管的杨氏弹性模量，K为血管参数，主动脉的K值一般可取0.8。 根据Hughes等 [ 5 ] 人提血管弹性模量E与血管跨壁压(血管内外压力差) p之间关系： E = E 0 exp ( α p ) (2) 式中，α为表征血管特征参数，数值一般为0.016~0.018 H g − 1 ， E 0 是p为0时的血管弹性模量。 结合式(1)和式(2)可以得到： P W V = K E 0 h ρ D exp ( α p ) (3) 假设脉搏波经过一个长度为L的血管，所用的传导时间PTT，传输速度为PWV，则有 [ 6 ] ： P W V = L P T T (4) 其中L表示动脉两个检测点之间的距离。将式(4)代入式(3)可以获得血压p： p = 1 α ( ln L 2 ρ d h E 0 − 2 ln P P T ) (5) 若对式(5)中的PTT进行幂级数展开，则有： ln P T T = ∑ n = 1 ∞ ( − 1 ) n − 1 × ( P P T − 1 ) n n (6) 式(6)的一阶近似代入式(5)后，可得简化的血压与脉搏传导时间PTT与血压的线性模型： P = a × P W T T + b (7) 其中a，b为待定系数，可以通过大量的实验数据进行确定。"
"系统主要有ECG信号采集电路、PPG信号采集电路、主控电路模块、蓝牙通信模块以及电源管理模块组成。其系统设计框图如图1所示。 图1. 系统结构框图 系统通过光电反射式脉搏传感器与金属干电极分别采集ECG信号与PPG信号，经过调理电路将预处理后的信号传到主控制器，主控制器再对心电、脉搏信号进行处理后利用蓝牙4.0技术发送至手机终端，在手机端实现脉搏、心电波形的显示以及血压计算。"
"系统通过金属干电极采集到ECG信号后，再通过BMD101心电处理芯片对心电心电信号进行处理。BMD101是生理信号检测和处理的片上设备，芯片内部主要包括低噪声放大与ADC模数转换器两个部分，具有极低的系统噪声与可控增益，因此可以有效的检测到生物信号，并使用16为高精度ADC模拟数字转换器将它们转化为数字信号，并通过串口实现数据的传输。其内部处理处理流程图如图2所示。 图2. BMD101内部处理流程图 其BMD101心电检测电路原理图如图3所示： 图3. BMD101心电检测电路原理图  脉搏采集传感器采用的是光电反射式脉搏传感器PulseSensor，该传感器利用光电容积原理，通过对手指末端透光度的检测，间接检测出PPG信号。光电式脉搏传感器具有结构简单、无损耗、可重复性好等优点。同时，传感器内部集成了放大电路与噪声消除电路，接入3.3 V供电电压，输出引脚输出的是0 V~3.3 V之间的PPG信号波形，直接连接MCU的ADC口进行采集。 蓝牙传输电路 本系统选用MTSerialBle蓝牙4.0作为蓝牙模传输电路的核心芯片，MTSerialBle是馒头科技设计的一块低功耗蓝牙透传模块，模块支持主从一体，可以实现和Android进行完美的数据传输。系统采用MCU串口连接蓝牙，实现采集硬件终端与手机终端之间的数据传输。其电路原理图如图4所示： 图4. 蓝牙模块电路原理图"
"系统软件部分主要由终端软件设计、手机APP设计两个部分组成。其中终端软件设计实现控对ECG、PPG数据同步采集，并实现对ECG信号、PPG信号处理，最后通过控制蓝牙实现数据上传数据手机终端。手机APP设计主要实现从MCU模块接收生理数据，再对接收的数据进行进分析处理，完成血压测量。  系统终端软件通过单片机串口、定时器、A/D转换器等功能，实现对ECG与PPG信号的同步采集，再对ECG、PPG信号进行处理，最后通过蓝牙实现数据传输至手机终端。终端信号采集如图5所示。ECG信号通过串口从BMD101接收；PPG信号通过A/D转换器将模拟信号转为数字信号；通过为了后面PTT的获取，这里需要ECG与PPG信号采集同步，系统利用定时器设定为100 Hz采样频率实现同步采集。采集后的ECG与PPG信号经过一定的滤波处理后，最后通过蓝牙将数据发送至手机终端。 图5. 终端信号采集  手机APP端设计是基于Android系统平台开发，通过Android平台实现对心电与脉搏信号处理实现脉搏传导时间的获取，最后建立血压模型完成血压测量。 从功能上来说，本系统的手机APP主要包括了数据接收、数据处理与计算、系统管理与显示三个功能模块。数据接收通过Android的蓝牙接口接收从硬件终端发送的心电与脉搏数据；系统管理与显示主要完成用户信息的注册、登录、注销，并对心电、脉搏波形以及测量的血压值进行显示。 数据处理与计算主要分为心电与脉搏信号的特征点获取、传导时间计算、血压计算三个部分。 ECG与PPG信号的特征点获取实现对ECG信号R波点与PPG信号主波点定位。其处理步骤如下： 1) 选定一段信号为数组φ(n)，φ(n)对相邻数据做差值，即进行一阶导得dx(n)： d x ( n ) = φ ( n ) − φ ( n − 1 ) (8) 当dx(n)大于0时，记为1；当dx(n)小于等于0时，即为−1； 2) 根据 d x ( n ) ∗ d x ( n − 1 ) 的值来判断峰点与谷点，如果其值小于0，则记录该点； 3) 对所有的峰点与谷点进行识别，从峰点开始检测，如果第一个点是谷点，则跳过。寻找所有满足比左邻近最小谷点值(初始值为信号最小值，指从上次检测到的有效峰值点开始，到当前峰点之间的最小谷值点)、比右邻近谷点都高于一定阈值的有效峰点，并且在一个有效峰点检测过程中，检测到的峰点为两次有效检测所有可能的峰点中的最大值点。阈值一般取信号最大值与最小值之差的三分之一，可自适应调整； 4) 对检测到的有效峰点再次进行判断，判断两个有效峰值点之间的距离是否在一定的区间，若满足条件的的则即为目标峰值点，而不符合要求的情况下，舍去其中较小的那个有效峰值点。其中区间一般可选取采样频率的1/2到1倍之间，可自适应调整。 传导时间是以心电信号的R波点为起点，以脉搏信号的主波点为终点的时间间隔来获取，最后通过传导时间与血压之间的关系模型获取血压值。"
"为了验证血压测量方式的准确性，本文采取了10名身体健康志愿者的EGC与PPG信号进行连续测量血压实验，利用建立的模型分别计算获得收缩压与舒张压值，并与欧姆龙的袖带血压计进行比较。其测量结果统计如表1所示： Table 1 志愿者编号 PTT/ms 收缩压/mmHg 舒张压/mmHg SBP C SBP S DBP C DBP S 1 184.3 116.6 114 77.9 74 2 223.2 94.7 98 75.9 66 3 192.2 112.2 118 77.3 73 4 200.1 107.6 108 77.9 79 5 225.5 90.4 91 75.8 67 6 195.5 110.3 110 77.1 70 7 188.2 114.5 118 77.5 71 8 174.5 122.8 124 78.1 72 9 196.4 109.8 111 77.1 74 10 216.4 98.5 101 76.2 69 表1. 系统测量与袖带血压计测量结果统计 其中PWTT表示EGC信号R波点到PPG信号主波点的时间间隔，SBP C 与DBP C 为系统通过血压模型计算获得收缩压值与舒张压值，SBP S 与DBP S 为通过袖带血压计测量获得收缩压值与舒张压值。 通过表1统计的结果，可以看出在一定误差范围内，本系统的测量结果可以与袖带血压计测量结果具有一定的互换性。为了更好的验证其检测结果，这里同样采用了Bland-Altman差值法对SBP C 与SBP S 、DBP C 与DBP S 进行一致性检验，实验结果分别见图6所示。 图6. 系统血压与袖带血压的Bland-Altman分析 根据Bland-Altman分析可以看出测量的收缩压与舒张压在10个志愿者数据中，每种测量方法都只有一个点在95%一致检验之外，说明本系统的方法与袖带血压测量方法具有很好的一致性，在一定的范围内，本系统可以替代袖带血压计。"
"本文设计并实现了基于心电脉搏的无创连续血压检测系统，兼容了心电、脉搏信号监测以及基于脉搏波传导时间的血压测量方式，采用硬件终端 + 手机APP的监护模式，为用户提供了一种科学有效、经济实在的健康监测方案。通过实验检测发现脉搏传导时间与血压之间存在很好的相关性，为脉搏波传导时间血压测量法的发展提供了参考，但是结果还是存在一定的误差，需要在后期的工作中进一步的探索与研究。"
