"布尔网络是描述基因调控、细胞分化等系统生物学的有力工具。布尔网络系统的最优控制问题已经成为当前控制领域的研究热点问题之一。本文主要研究布尔网络系统取目标泛函最大化的最优控制问题。首先，给出有限时域上问题的求解方法；其次，在该方法的基础上，对无穷时域上的问题进行研究，给出无穷时域上目标泛函最大化的布尔网络最优控制问题的可解性和求解方法；最后，将方法应用到一个具体的实例上。 关键词 :无穷时域，布尔网络，最优控制 Copyright © 2019 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"上世纪六十年代，Jacob和Monod两位教授发现在任何细胞中都包含着几个类似开关一样的调节基因，它们能够打开或者关闭其他的基因 [ 1 ] 。1969年，美国学者Kauffman在文献 [ 1 ] 的研究基础上，首次提出用布尔网络来刻画细胞和基因调控网络的理论，将基因的表达与不表达用“1”和“0”来表示 [ 2 ] 。随后，布尔网络被广泛应用于描述人工智能、神经网络、基因调控等系统，成为系统生物学家、物理学家和系统科学家们共同关心的热点问题。 动态布尔网络系统各节点状态的变化可描述为布尔状态变量的离散时间系统，每一个节点在下一时刻的状态由它及其相邻节点的当前状态确定，数学上可以用布尔函数来描述。为了使用控制论和最优控制理论解决布尔控制系统问题，其关键是如何将逻辑运算表示为相应的代数运算，矩阵半张量积的引入较好地解决了这个瓶颈问题。 矩阵半张量积是中国科学院程代展教授在1998年首次提出的，并在此后多年逐步发展和不断完善。早期的结果被收录在文献 [ 3 ] [ 4 ] 中，主要结果出版在专著 [ 5 ] [ 6 ] 中。矩阵半张量积的方法可以将复杂的逻辑推理过程转变为简单的代数形式，该方法激发了国内外众多学者在布尔网络方面的大量研究工作。 关于布尔网络的最优控制问题，2011年，Laschov和Margaliot教授基于矩阵半张量积方法，研究单输入和多输入布尔控制网络Mayer型最优控制问题 [ 7 ] [ 8 ] ，导出了这一最优控制问题的Pontryagin极大值原理。同年，赵寅等在文献 [ 9 ] 中研究了无穷时域上的动态布尔网络控制系统，以及如何寻找最大化序列使其在平均支付条件下目标泛函最大化的问题，运用不动点及极限环等拓扑性质，证明了最优控制可以在乘积空间的一个环上得到，并且具备周期性。李海涛等在文献 [ 10 ] 中运用输入–状态关联矩阵研究布尔控制网络Mayer型最优控制问题的求解方法，给出了该问题的最优控制策略。2014年，Fornasini和Elena教授提出求解目标泛函取最小值的逻辑动态网络系统最优控制的一种新的求解方法。在此基础上研究了无穷时域上最优控制问题可解的充分必要条件，并说明可选择一种输入，使其状态经过有限步后，状态–控制对呈现周期性和目标泛函效用为零，因而将无穷时域的最小控制问题转换为有限时域的最优控制问题，从而导出了无穷时域目标泛函最小化问题求解的一种新方法 [ 11 ] 。但该方法不能直接用于布尔控制网络目标泛函极大化问题的求解，因其是居于目标泛函非负而设计的算法，不能直接套用经典的最优控制问题中目标泛函的最大化和最小化通过乘以−1相互转化的办法得到。因此，本文主要研究布尔控制网络目标泛函最大化的最优控制问题。本文在给出有限时域上布尔网络控制系统目标泛函最大化求解方法的基础上，给出无穷时域上布尔网络控制最大化问题的可解性和求解方法，最后给出一个具体的算例。"
"· ℝ n 是实数域上的n维向量空间。 · M m × n 是 m × n 维实矩阵集合。 · I n 是n维单位矩阵。 · Δ n = { δ n i | i = 1 , 2 , ⋯ , n } ，其中 δ n i 为单位矩阵 I n 的第i列，特别地 Δ 2 = Δ 。 · 矩阵 L = [ δ n i 1 , δ n i 2 , ⋯ , δ n i m ] ∈ L n × m ，记为 L = δ n [ i 1 , i 2 , ⋯ , i m ] 。 · 逻辑变量 x ∈ D = { 0 , 1 } 。 · ⊗ 是矩阵的Kronecker积。  定义2.2.1 [ 5 ] ：给定矩阵 A ∈ M m × n , B ∈ M p × q 。A与B的半张量积记成 A ⋉ B = ( A ⊗ I t / n ) ( B ⊗ I t / p ) 其中 t = l c m ( n , p ) 是 { n , p } 的最小公倍数。 命题2.2.1 [ 5 ] ：矩阵半张量积满足 1) 分配律： ( A + B ) ⋉ C = A ⋉ C + B ⋉ C C ⋉ ( A + B ) = C ⋉ A + C ⋉ B 2) 结合律 ( A ⋉ B ) ⋉ C = A ⋉ ( B ⋉ C ) 3) 转置 ( A ⋉ B ) T = B T ⋉ A T 为进一步实现交换运算，定义如下换位矩阵。 定义2.2.2 [ 5 ] ：换位矩阵 W [ m , n ] 是一个 m n × m n 维矩阵，它的行由双指标 ( I , J ) 依次标注并按索引 I d ( I , J ; m , n ) 排列，列由双指标 ( i , j ) 依次标注并按索引 I d ( i , j ; n , m ) 排列，位于 ( I , J ) 行 ( i , j ) 列的元素为 W ( I , J ) , ( i , j ) = { 1 , I = i 且 J = j 0 , 其 他 特别地，当 m = n 时，记 W [ n ] = W [ n , n ] 。 通过换位矩阵，可以实现矩阵的伪交换性质。 命题2.2.2 [ 5 ] ：给定矩阵 A ∈ M m × n 。 1) 设 X ∈ ℝ n ， Y ∈ ℝ m 为列向量，则 W [ n , m ] ⋉ X ⋉ Y = Y ⋉ X , W [ m , n ] ⋉ Y ⋉ X = X ⋉ Y 2) 设 X ∈ ℝ n 为列向量, Y ∈ ℝ m 为行向量，则 X ⋉ Y = Y ⋉ W [ n , m ] ⋉ X 3) 设 Z ∈ ℝ t 为列向量，则 Z ⋉ A = W [ m , t ] ⋉ A ⋉ W [ t , n ] ⋉ Z = ( I t ⊗ A ) ⋉ Z 4) 设 Z ∈ ℝ t 为行向量，则 A ⋉ Z = Z ⋉ W [ m , t ] ⋉ A ⋉ W [ t , n ] = Z ⋉ ( I t ⊗ A ) 命题2.2.3 [ 6 ] ： 哑矩阵 E d = δ 2 [ 1   2   1   2 ] ，具有如下性质：对于任意矩阵 X , Y ∈ Δ 2 E d X Y = Y , E d W [ 2 ] X Y = X 命题2.2.3 [ 6 ] ： 降阶矩阵 M r = [ δ 2 1 0 2 0 2 δ 2 2 ] ，具有如下性质：对于任意 X ∈ Δ 2 ， X 2 = M r X 命题2.2.6 [ 6 ] ： 常用逻辑算子：非( ¬ )，合取( ∧ )，析取( ∨ )，等值( ↔ )，异或( ∨ ¯ )的结构矩阵为 M n = δ 2 [ 2 , 1 ] , M c = δ 2 [ 1 , 2 , 2 , 2 ] , M d = δ 2 [ 1 , 1 , 1 , 2 ] , M e = δ 2 [ 1 , 2 , 2 , 1 ] , M m = δ 2 [ 2 , 1 , 1 , 2 ]"
"考虑布尔网络控制系统 { x 1 ( k + 1 ) = f 1 ( x 1 ( k ) , x 2 ( k ) , ⋯ , x n ( k ) , u 1 ( k ) , u 2 ( k ) , ⋯ , u m ( k ) ) , x 2 ( k + 1 ) = f 2 ( x 1 ( k ) , x 2 ( k ) , ⋯ , x n ( k ) , u 1 ( k ) , u 2 ( k ) , ⋯ , u m ( k ) ) ,                           ⋮ x n ( k + 1 ) = f n ( x 1 ( k ) , x 2 ( k ) , ⋯ , x n ( k ) , u 1 ( k ) , u 2 ( k ) , ⋯ , u m ( k ) ) , (1) 其中 x i ( k ) ∈ D , i = 0 , 1 , 2 , ⋯ , n 为系统的状态变量， u i ( k ) ∈ D , i = 0 , 1 , 2 , ⋯ , m 为系统的控制变量， f i : D n + m → D 为布尔函数。设初始状态 x ( 0 ) ，终端状态 x ( K ) 给定。 容许控制集： u a d = { u : N → D m , u i ( k ) ∈ D , k = 0 , 1 , 2 , ⋯ , K − 1 } 目标泛函： J = λ K Φ f ( x ( K ) ) + ∑ k = 0 K − 1 λ k Φ ( u ( k ) , x ( k ) ) (2) 其中 0 < λ < 1 , K > 0 给定， Φ f ( ⋅ ) : D n → D , Φ ( ⋅ , ⋅ ) : D n + m → D 上的有界效用函数。 问题(P)：寻找 u ∗ ∈ u a d , s .   t , J ( u ∗ ) ≥ J ( u ) , ∀ u ∈ u a d 。  引理3.2.1 [ 6 ] ：设任意n元布尔函数 f ( x 1 , x 2 , ⋯ , x n ) : D n → D ，存在唯一的逻辑矩阵 M f ∈ L 2 × 2 n 。 使在向量形式下 f ( x 1 , x 2 , ⋯ , x n ) = M f ⋉ i n x ^ i (3) 其中 x ^ i ∈ Δ ， M f 称为函数f的结构矩阵，(3)式称为布尔函数f的代数形式。 对于受控系统(1)，令 x ^ ( k ) = ⋉   i n   x ^ i ( k ) ,   u ^ ( k ) = ⋉   i m   u ^ i ( k ) ，由引理3.2.1，对于每一个布尔函数 f i ，可以找到与之相对应的结构矩阵 M i ，使得 x ^ i ( k + 1 ) = M i ⋉ u ^ ( k ) ⋉ x ^ ( k ) , i = 1 , 2 , ⋯ , n (4) 把(4)中n个方程相乘，应用矩阵半张量的性质，得到系统(1)的代数表达式 x ^ ( k + 1 ) = L ⋉ u ^ ( k ) ⋉ x ^ ( k ) (5) 其中 x ^ ( k ) = ⋉ i n x ^ i ( k ) ∈ Δ 2 n 是系统的状态变量， u ^ ( k ) = ⋉ i n u ^ i ( k ) ∈ Δ 2 m 是系统的控制变量， L ∈ L 2 n × 2 n + m ，称为受控系统(1)的状态转移矩阵。 引理3.2.2 [ 6 ] ：设任意n元伪布尔函数 f ( x ^ 1 , x ^ 2 , ⋯ , x ^ n ) : D n → ℝ ，存在唯一的行向量 V f ∈ ℝ 2 n 。 使在向量形式下 f ( x ^ 1 , x ^ 2 , ⋯ , x ^ n ) = V f ⋉ i n x ^ i (6) 其中 x ^ i ∈ Δ ， V f 称为伪布尔函数f的结构向量。 对于受控系统(1)的目标泛函(2)，令 x ^ ( k ) = ⋉   i n   x ^ i ( k ) ,   u ^ ( k ) = ⋉   i m   u ^ i ( k ) ，由引理3.2.2，目标泛函可转化为如下形式 J ( u ^ ) = λ K Φ f ( x ^ ( K ) ) + ∑ k = 0 K − 1 λ k Φ ( u ^ ( k ) , x ^ ( k ) ) = λ K Φ f T ⋉ x ^ ( K ) + ∑ k = 0 K − 1 λ k Φ T ⋉ u ^ ( k ) ⋉ x ^ ( k ) (7) 其中 0 < λ < 1 , K > 0 给定， Φ f ( ⋅ ) : D n → ℝ , Φ ( ⋅ , ⋅ ) : D n + m → M 2 m × 2 n 的有界效用函数， Φ f T , Φ T 可按如下方式选取： Φ f T = α T x ^ ( K )             = [ α T ⋉ δ 2 n 1     α T ⋉ δ 2 n 2     ⋯     α T ⋉ δ 2 n 2 n ]             = [ Φ f ( δ 2 n 1 )     Φ f ( δ 2 n 2 )     ⋯     Φ f ( δ 2 n 2 n ) ] ∈ ℝ 其中 α ∈ ℝ 2 n , { a i ∈ α | a i = i , i = 1 , ⋯ , 2 n } Φ T = u ^ ( k ) T ⋉ A ⋉ x ^ ( k )           = [ Φ ( δ 2 m 1 , δ 2 n 1 ) ⋯ ( δ 2 m 1 , δ 2 n 2 n )   |   ⋯   | Φ ( δ 2 m 2 m , δ 2 n 1 ) ⋯ Φ ( δ 2 m 2 m , δ 2 n 2 n ) ]           = [ Φ 1 T |   ⋯   | Φ 2 m T ] ∈ M 2 m × 2 n 其中 A ∈ M 2 m × 2 n , { a i j ∈ A | a i j = i + j , i = 1 , ⋯ , 2 m , j = 1 , ⋯ , 2 n } 。 进而可以得到如下半张量形式的布尔网络最优控制问题： 受控系统： x ^ ( k + 1 ) = L ⋉ u ^ ( k ) ⋉ x ^ (k) 初始状态 x ^ ( 0 ) ∈ Δ ，终端状态 x ^ ( K ) ∈ Δ 给定。 容许控制集： u ^ a d = { u ^ ( k ) : = ⋉ i m u ^ i ( k ) , u ^ i ( k ) ∈ Δ , k = 0 , 1 , 2 , ⋯ , K − 1 } 目标泛函： J ( u ^ ) = λ K Φ f T ⋉ x ^ ( K ) + ∑ k = 0 K − 1 λ k Φ T ⋉ u ^ ( k ) ⋉ x ^ ( k ) (8) 问题( P ^ )：寻找 u ^ ∗ ∈ u ^ a d , s .   t . , J ( u ^ ∗ ) ≥ J ( u ^ ) , ∀ u ^ ∈ u ^ a d 。"
"我们注意到对任意时刻的控制输入 u ^ ( k ) = δ 2 m i ，令 L ⋉ u ^ ( k ) = L i ∈ L 2 n × 2 n ，则可把布尔控制网络系统(5)看成一个布尔切换系统 [ 12 ] [ 13 ] [ 14 ] [ 15 ] ，自然地，布尔切换系统的第i个子系统是一个布尔系统。从而得到 x ^ ( k + 1 ) = L i x ^ ( k ) , i ∈ [ 1 , 2 m ] (9) 系统(5)的状态转移矩阵L可以表示为 L = [ L 1   L 2   ⋯   L 2 m ] (10) 下面考虑有限时域 ( K = N < ∞ ) 时布尔网络最优控制问题的求解方法。 因对任意n维非正向量 ω ( k ) , k ∈ [ 0 , K ] 和状态 x ^ ( k ) , k ∈ [ 0 , K ] ，成立下列恒等式： 0 = ω ( 0 ) T ⋉ x ^ ( 0 ) + ∑ k = 0 K − 1 [ ω ( k + 1 ) T ⋉ x ^ ( k + 1 ) − ω ( k ) T ⋉ x ^ ( k ) ] − ω ( K ) T ⋉ x ^ ( K ) (11) 因此，由(8)式-(11)式可得 J ( u ^ ) = − ω ( 0 ) T ⋉ x ^ ( 0 ) + ( λ K Φ f T + ω ( K ) T ) ⋉ x ^ ( K )                     + ∑ k = 0 K − 1 λ k Φ T ⋉ u ^ ( k ) ⋉ x ^ ( k ) − ∑ k = 0 K − 1 [ ω ( k + 1 ) T ⋉ x ^ ( k + 1 ) − ω ( k ) T x ^ ( k ) ] (12) 又因为 u ^ ( k ) = δ 2 m i , i ∈ [ 1 , 2 m ] ，故对任意状态 x ^ ( k ) , k ∈ [ 0 , K ] ，成立 ω ( k ) T x ^ ( k ) = [ ω ( k ) T   ω ( k ) T   ⋯     ω ( k ) T ] ⋉ u ^ ( k ) ⋉ x ^ ( k ) (13) 将(13)式代入(12)式得 J ( u ^ ) = − ω ( 0 ) T ⋉ x ^ ( 0 ) + ( λ K Φ f T + ω ( K ) T ) ⋉ x ^ ( K )                     + ∑ k = 0 K − 1 ( λ k Φ T − ω ( k + 1 ) T L + [ ω ( k ) T   ⋯   ω ( k ) T ] ) ⋉ u ^ ( k ) ⋉ x ^ ( k ) (14) 令 ψ ( k ) T = [ ψ 1 ( k ) T   ψ 2 ( k ) T   ⋯   ψ 2 m ( k ) T ] = [ λ k Φ 1 T   λ k Φ 2 T |   ⋯   | λ k Φ 2 m T ] − ω ( k + 1 ) T [ L 1   L 2   ⋯   L 2 m ] + [ ω ( k ) T   ω ( k ) T   ⋯   ω ( k ) T ] (15) 即(14)式可等价表示为 J ( u ^ ) = − ω ( 0 ) T ⋉ x ^ ( 0 ) + ( λ K Φ f T + ω ( K ) T ) ⋉ x ^ ( K )                     + ∑ k = 0 K − 1 [ ψ 1 ( k ) T   ψ 2 ( k ) T   ⋯   ψ 2 m ( k ) ] T ⋉ u ^ ( k ) ⋉ x ^ ( k ) (16) 为使目标泛函(16)式达到最大，根据贝尔曼动态规划方法的最优性原理，我们希望每一步的取值达到最大，即取 ω ( K ) 为零向量时使终端达到最大，对 ∀ k ∈ [ 0 , K − 1 ] , j ∈ [ 1 , 2 n ] ，存在 i ∈ [ 1 , 2 m ] 使得向量 [ ψ i ( k ) ] j = 0 ，否则 [ ψ i ( k ) ] j ≤ 0 。 因此，我们设计如下算法，使目标泛函(16)式达到最大： Step 1：设向量 ω ( K ) = 0 2 n T ； Step 2：当 k = K − 1 , K − 2 , ⋯ , 1 , 0 ，向量 ω ( k ) 的第j项为 − [ ω ( k ) ] j = max i ∈ [ 1 , 2 m ] ( λ k [ Φ i ] j − [ ω ( k + 1 ) T L i ] j ) , ∀ j ∈ [ 1 , 2 n ] ; Step 3：使目标泛函(16)式达到最大值的控制输入序列 u ^ ( k ) , k ∈ [ 0 , K − 1 ] 可选择如下： 对 ∀ x ^ ( k ) = δ 2 n j ，可得 u ^ ( k ) = δ 2 m i * ( j , k ) 。 其中 i * ( j , k ) = arg max i ∈ [ 1 , 2 m ] ( λ k [ Φ i ] j − [ ω ( k + 1 ) T L i ] j ) , j ∈ [ 1 , 2 n ] 注1：事实上，根据算法的设计，最优控制序列 u ^ ( k ) 实际上是一个反馈控制，即 u ^ ( k ) = Η ( k ) x ^ (k) 其中 Η ( k ) = [ δ 2 m i * ( 1 , k )   δ 2 m i * ( 2 , k )   ⋯   δ 2 m i * ( 2 n , k ) ] 注2：根据贝尔曼动态规划方法，令值函数为 { J K ( x ^ ( K ) ) = max u ^ ( K − 1 ) ∈ Δ 2 m λ K Φ f T ⋉ δ 2 n j J [ 0 , K − 1 ] ( x ^ ( k ) , u ^ ( ⋅ ) ) = J [ 0 , K − 1 ] ( δ 2 n j , u ^ ( ⋅ ) ) = max u ^ ( ⋅ ) ∈ Δ 2 m { λ K Φ f T ⋉ δ 2 n j + J k + 1 ( δ 2 n j , u ^ ( ⋅ ) ) } 由本文设计的算法可知 − [ ω ( k ) ] j = max u ^ ( k ) ∈ Δ 2 m J ( δ 2 n j , u ^ (⋅) ) − [ ω ( k ) ] j = max u ^ ( k ) ∈ Δ 2 m { λ K Φ f T ⋉ δ 2 n j + J k + 1 ( δ 2 n j , u ^ ( ⋅ ) ) } − [ ω ( k ) ] j = max u ^ ( k ) ∈ Δ 2 m { λ K Φ f T ⋉ δ 2 n j } + max u ^ ( k ) ∈ Δ 2 m { J k + 1 ( δ 2 n j , u ^ ( k ) ) } 从中我们得到，本文给出的方法与动态规划算法的求解结果相一致。 综上，我们得到了有限时域上布尔网络最优控制问题的求解方法。  下面我们考虑受控系统(5)支配下，无穷时域 ( K → ∞ ) 上的布尔网络最优控制问题。设目标泛函为 J ( u ^ ) = ∑ k = 0 ∞ λ k Φ ( u ^ ( k ) , x ^ ( k ) ) (17) 其中 0 < λ < 1 ， Φ ( ⋅ , ⋅ ) : D n + m → M 2 n × 2 m 上的有界效用函数。 对于无穷时域上的最优控制问题，其最优控制问题的可解性等价于目标泛函中无穷级数的收敛性。如下定理给出无穷时域上布尔网络最优控制问题的求解方法。 定理4.2.1：对布尔控制系统(5)以及目标泛函(17)，总存在最优控制 u ^ * ( k ) ，且当有限时域中终端步K取得充分大时，从有限时域上求得的最优控制序列 { u ^ ( 1 ) * , u ^ ( 2 ) * , ⋯ , u ^ ( K ) * } 与无穷时域上的最优控制序列的前K个值一致。 证明：令 M = max u ^ ( k ) , x ^ ( k ) ∈ Δ | Φ ( u ^ ( k ) , x ^ ( k ) ) | ，则由 u ^ ( k ) , x ^ ( k ) 都是有限维向量， Φ ( ⋅ , ⋅ ) : D n + m → M 2 m × 2 n 上有界函数，可知 M < + ∞ ，所以无穷级数 ∑ k = 0 ∞ λ k Φ ( u ^ ( k ) , x ^ ( k ) ) 的优级数为 M ∑ k = 0 ∞ λ k 是收敛的。 即无穷级数 ∑ k = 0 ∞ λ k Φ ( u ^ ( k ) , x ^ ( k ) ) 一致收敛。故对任意给定的 ε > 0 ，存在足够大的p，使得 | ∑ k = p ∞ λ k Φ ( u ^ ( k ) , x ^ ( k ) ) | ≤ ∑ k = p ∞ λ p M = λ p + 1 1 − λ M < ε 2 不妨设 K = p ，考虑受控系统如下求解有限时域最优控制问题 J K ( x ^ 0 , u ^ ) = ∑ k = 0 K λ k Φ ( u ^ ( k ) , x ^ (k)) 若 { u ^ ( 1 ) * , u ^ ( 2 ) * , ⋯ , u ^ ( K ) * } 为 J K ( x ^ 0 , u ^ ) 的最优控制，若 { u ^ ∞ ( 1 ) * , u ^ ∞ ( 2 ) * , ⋯ , u ^ ∞ ( K ) * , ⋯ } 为 J ∞ ( x ^ 0 , u ^ ) 的最优控制，则有 J K ( x ^ 0 ; u ^ ( 1 ) * , u ^ ( 2 ) * , ⋯ , u ^ ( K ) * ) − J ∞ ( x ^ 0 ; u ^ ∞ ( 1 ) * , u ^ ∞ ( 2 ) * , ⋯ , u ^ ∞ ( K ) * , ⋯ ) ≤ ε 否则 J ( x ^ 0 ; u ^ ( 1 ) * , u ^ ( 2 ) * , ⋯ , u ^ ( K ) * , u ^ ∞ ( K + 1 ) * , ⋯ ) − J ( x ^ 0 ; u ^ ∞ ( 1 ) * , u ^ ∞ ( 2 ) * , ⋯ , u ^ ∞ ( K ) * , ⋯ ) = ∑ k = 0 K λ k [ Φ ( u ^ ( k ) * , x ^ ( k ) * ) − Φ ( u ^ ∞ ( k ) * , x ^ ∞ ( k ) * ) ]       + ∑ k = K ∞ λ k [ Φ ( u ^ ( k ) * , x ^ ( k ) * ) − Φ ( u ^ ∞ ( k ) * , x ^ ∞ ( k ) * ) ] > ε − 2 ⋅ ε 2 = 0 这与 u ^ ∞ ( k ) * 为最优控制相矛盾，即无穷时域上的最优控制存在。 □ 注3：当K取得足够大时，无穷时域上的最优控制序列 { u ^ ∞ ( 1 ) * , u ^ ∞ ( 2 ) * , ⋯ , u ^ ∞ ( K ) * , ⋯ } 可从有限时域得到的最优控制序列 { u ^ ( 1 ) * , u ^ ( 2 ) * , ⋯ , u ^ ( K ) * } 逐次逼近得到。"
"上述方法为我们求解布尔网络最优控制问题提供了一种思路清晰，行之有效的求解方法，下面将给出实例具体验证方法的可行性。 考虑如下布尔网络最优控制问题 { x 1 ( k + 1 ) = ¬ ( x 1 ( k ) ↔ x 2 ( k ) ) , x 2 ( k + 1 ) = ¬ ( x 2 ( k ) ↔ x 3 ( k ) ) , x 3 ( k + 1 ) = u ( k ) ∧ x 1 ( k ) , (18) 其中 x i ( k ) ∈ D , i = 1 , 2 , 3 为系统状态变量， u ( k ) ∈ D 为系统控制变量， f i : D 3+ 1 → D 为布尔函数。设初值 x 1 ( 0 ) = 1 , x 2 ( 0 ) = 0 , x 3 ( 0 ) = 1 ,终端 x 1 ( 4 ) = 0 , x 2 ( 4 ) = 0 , x 3 ( 4 ) = 0 ,目标泛函为 J = ( 0.9 ) 4 Φ f ( x ( 4 ) ) + ∑ k = 0 3 ( 0.9 ) k Φ ( u ( k ) , x ( k ) ) (19) 其中 上的有界效用函数。 问题(Q)求使目标泛函(19)式达到最大的控制序列 { u * ( 0 ) , u * ( 1 ) , u * ( 2 ) , u * ( 3 ) } 。 解：首先，将布尔网络系统的最优控制问题转化代数形式的最优控制问题； ①将上述布尔控制网络系统(18)转化为代数形式 令 x ^ ( k ) = x ^ 1 ( k ) ⋉ x ^ 2 ( k ) ⋉ x ^ 3 ( k ) ∈ Δ 为系统状态变量， u ^ ( k ) ∈ Δ 为系统控制变量 { x ^ 1 ( k + 1 ) = M m ⋉ x ^ 1 ( k ) ⋉ x ^ 2 ( k ) , x ^ 2 ( k + 1 ) = M m ⋉ x ^ 2 ( k ) ⋉ x ^ 3 ( k ) , x ^ 3 ( k + 1 ) = M c ⋉ u ^ ( k ) ⋉ x ^ 1 ( k ) , (20) x ^ ( k + 1 ) = M m ⋉ x ^ 1 ( k ) ⋉ x ^ 2 ( k ) ⋉ M m ⋉ x ^ 2 ( k ) ⋉ x ^ 3 ( k ) ⋉ M c ⋉ u ^ ( k ) ⋉ x ^ 1 ( k )                       = M m ⋉ ( I 4 ⊗ M m ) ⋉ ( I 2 ⊗ M r ) ⋉ ( I 8 ⊗ M c ) ⋉ W [ 4 , 8 ] ⋉ ( I 2 ⊗ M r ) ⋉ u ^ ( k ) ⋉ x ^ ( k )                       = L ⋉ u ^ ( k ) ⋉ x ^ (k) 此时，布尔控制网络系统的状态转移矩阵为 L = δ 8 [ 7   5   1   3   4   2   6   8   8   6   2   4   4   2   6   8 ] ∈ L 2 3 × 2 3 + 1 ②将目标泛函(19)式中的伪布尔函数转化为半张量形式 J = ( 0.9 ) 4 Φ f T ⋉ x ^ ( 4 ) + ∑ k = 0 3 ( 0.9 ) k Φ T ⋉ u ^ ( k ) ⋉ x ^ ( k ) (21) 其中 Φ f T = α T x ^ ( K )           = [ α T ⋉ δ 8 1     α T ⋉ δ 8 2   ⋯   α T ⋉ δ 8 8 ]           = [ 1   2   3   4   5   6   7   8 ] 其中 α ∈ ℝ 8 , { a i ∈ α | a i = i , i = 1 , 2 , ⋯ , 8 } 。 Φ T = u ^ ( k ) T ⋉ A ⋉ x ^ ( k )           = [ Φ ( δ 2 1 , δ 8 1 ) ⋯ Φ ( δ 2 1 , δ 8 8 )       Φ ( δ 2 2 , δ 8 1 ) ⋯ Φ ( δ 2 2 , δ 8 8 ) ]           = [ Φ 1 T     Φ 2 T ]           = [ 2   3   4   5   6   7   8   9 3   4   5   6   7   8   9   10 ] 其中 A ∈ M 2 × 8 , { a i j ∈ A | a i j = i + j , i = 1 , 2 , j = 1 , 2 , ⋯ , 8 } 。 ③求解问题( Q ^ )给定初值状态 x ^ ( 0 ) = δ 8 3 ，终端状态 x ^ ( 4 ) = δ 8 8 ，求使受控系统在半张量形式下的目标泛函(21)式达到最大的最优控制序列 { u ^ * ( 0 ) , u ^ * ( 1 ) , u ^ * ( 2 ) , u ^ * ( 3 ) } 。 其次，求解问题( Q ^ )； 应用4.1.中有限时域上布尔网络最优控制的求解方法。 ①将布尔控制系统转化为切换布尔系统 x ^ ( k + 1 ) = L u ^ ( k ) x ^ (k) x ^ ( k + 1 ) = L i x ^ ( k ) , i ∈ [ 1 , 2 ] L 1 = L ⋉ δ 2 1 = δ 8 [ 7   5   1   3   4   2   6   8 ] L 2 = L ⋉ δ 2 2 = δ 8 [ 8   6   2   4   4   2   6   8 ] ②根据递归算法，可得 ω ( 4 ) = 0 2 3 T = [ 0   0   0   0   0   0   0   0   0 ] − ω ( 3 ) = max i ∈ [ 1 , 2 ] , j ∈ [ 1 , 8 ] ( λ 3 [ Φ i ] j − [ ω ( 4 ) T L i ] j ) = [ 2.19     2.92     3.65     4.37     5.10     5.83     6.56     7.29 ] ⇒ x ^ * ( 3 ) = δ 8 8 Η ( 3 ) = [ δ 2 i * ( 1 , 3 )   δ 2 i * ( 2 , 3 )   ⋯   δ 2 i * ( 8 , 3 ) ] = [ δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2 ] ⇒ u ^ * ( 3 ) = δ 2 2 − ω ( 2 ) = max i ∈ [ 1 , 2 ] , j ∈ [ 1 , 8 ] ( λ 2 [ Φ i ] j − [ ω ( 3 ) T L i ] j ) = [ 9.72     9.07     6.97     9.23     10.04   9.40     13.12     15.39 ] ⇒ x ^ * ( 2 ) = δ 8 8 Η ( 2 ) = [ δ 2 i * ( 1 , 2 )   δ 2 i * ( 2 , 2 )   ⋯   δ 2 i * ( 8 , 2 ) ] = [ δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2 ] ⇒ u ^ * ( 2 ) = δ 2 2 − ω ( 1 ) = max i ∈ [ 1 , 2 ] , j ∈ [ 1 , 8 ] ( λ [ Φ i ] j − [ ω ( 2 ) T L i ] j ) = [ 18.09     13.00     13.57     14.63     15.53     16.27     17.50     24.39 ] ⇒ x ^ * ( 1 ) = δ 8 8 Η ( 1 ) = [ δ 2 i * ( 1 , 1 )   δ 2 i * ( 2 , 1 )   ⋯   δ 2 i * ( 8 , 1 ) ] = [ δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2 ] ⇒ u ^ * ( 1 ) = δ 2 2 − ω ( 0 ) = max i ∈ [ 1 , 2 ] , j ∈ [ 1 , 8 ] ( [ Φ i ] j − [ ω ( 1 ) T L i ] j ) = [ 27.39     20.27     22.09     20.63     21.63     21.00     25.27     34.39 ] x ^ * ( 0 ) = δ 8 3 给定 Η ( 0 ) = [ δ 2 i * ( 1 , 0 )   δ 2 i * ( 2 , 0 )   ⋯   δ 2 i * ( 8 , 0 ) ] = [ δ 2 2   δ 2 2   δ 2 1   δ 2 2   δ 2 2   δ 2 2   δ 2 2   δ 2 2 ] ⇒ u ^ * ( 0 ) = δ 2 1 J ( u ^ * ) = ( 0.9 ) 4 Φ f T ⋉ x ^ ( 4 ) + ∑ k = 0 3 ( 0.9 ) k Φ T ⋉ u ^ ( k ) ⋉ x ^ ( k ) = 0.66 × [ 1   2   3   4   5   6   7   8 ] ⋉ δ 8 8 + max u ^ * ( ⋅ ) J ( δ 8 3 , u ^ ( ⋅ ) ) = 5.25 − ω ( 0 ) ⋉ δ 8 3 = 27.34 最优控制序列为 u ^ * ( 0 ) = δ 2 1 , u ^ * ( 1 ) = u ^ * ( 2 ) = u ^ * ( 3 ) = δ 2 2 。 状态轨迹为 x ^ * ( 0 ) = x ^ * ( 1 ) = x ^ * ( 2 ) = x ^ * ( 3 ) = x ^ * ( 4 ) = δ 8 8 。 最后，将问题( Q ^ )代数形式的求解结果返回问题(Q)的逻辑形式，得到 最优控制序列为 { u * ( 0 ) → u * ( 1 ) → u * ( 2 ) → u * ( 3 ) } = { 1 → 0 → 0 → 0 } 。 状态轨迹为 { x * ( 0 ) → x * ( 1 ) → x * ( 2 ) → x * ( 3 ) → x * ( 4 ) } = { ( 1   0   1 ) T → ( 0   0   0 ) T → ( 0   0   0 ) T → ( 0   0   0 ) T → ( 0   0   0 ) T } 。"
"本文运用矩阵半张量积的方法，将布尔控制系统转化为代数离散时间系统，从而考虑经典的布尔网络最优控制问题，在找到有限时域上使目标泛函达到最大值时的最优控制及状态轨迹方法的基础上，重点研究无穷时域上的最优控制问题，给出无穷时域上布尔网络控制最大化目标泛函问题的可解性和求解方法，并应用到具体的实例，说明该方法可行。"
