"基于变分理论提出的能量泛函极小化，在图像去噪中已经有了很广泛的应用。在去噪过程中，合理的选取参数是十分重要的，神经网络的通用性和可操作性比传统的算法有更多的优势。本文针对全变差去噪模型中不能自适应调整正则项参数的缺点，通过构建BP神经网络模型，经过大量的学习训练，模拟出图像原始信息和正则项参数的关系，根据模型得到的正则项参数，再结合Chambolle对偶算法，两者构成一个整体，这样改进后的算法其参数选取更为精确，去噪效果更加有效。 关键词 :图像去噪，全变差，Chambolle对偶，BP神经网络，自适应 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"图像是我们从外部获取信息的重要媒介，但在图像的获取，传输，存储等过程中，难免会受到其他未知因素的干扰，导致图像产生噪声，影响我们对有效信息的获取，因此，对含噪声的图像进行去噪处理一直是图像处理领域的热点和难点之一。在进行图像去噪时，要尽可能的保留图像的边缘、纹理和一些细节信息，以保证修复后的图像与原图像有一定的结构相似性。为解决这一难题，许多专家学者都提出了很多相关理论和方法，其中，在保护边缘方面，1992年Rudin、Osher和Fatemi [ 1 ] 从能量极小化的角度出发，把全变差半范数作为正则项引入到图像去噪模型中，建立了全变差正则化模型，简称ROF模型，该模型通过引入能量泛函，将图像去噪问题转变为求能量泛函最小问题，并且在保护图像边缘上的取得了很好的效果。在保护纹理方面，2001年，Y. Meyer等人提出了TV-G模型 [ 2 ] ，将图像分解为几何部分和纹理部分。2005年，Buades等人提出了非局部均值算法 [ 3 ] ，利用像素之间的距离来表示相似度，在保护纹理方面取得了很好的效果。在数值求解方面，对偶投影算法，ADMM交替方向乘子法 [ 4 ] ，Bregman迭代法 [ 5 ] 等都能达到快速收敛，易于数值实现。 ROF模型中的能量泛函分为逼近项和正则项两部分，其中，逼近项用于去除噪声，保证去噪后的图像与原图像的相似性，而正则项则防止去噪过强，起到抑制噪声的作用，因此，需要选取适当的权重参数用于平衡这两项的关系，目前，国内外许多学者都已经提出了一些权重确定方法，具体有无偏预测风险估计器 [ 6 ] (URPE)，局部方差估计 [ 7 ] ，基于Morozov偏差原理 [ 8 ] 选取参数等方法。本文基于全变差正则化模型，利用Chambolle对偶投影算法 [ 9 ] [ 10 ] ，提出了一种参数可以随着迭代算法自适应地改变的新方法，可根据图像的先验信息，能够自适应的选取合适的参数，进而保证去噪后的图像能够保留更多的细节信息。"
"ROF模型的基本思想是将图像处理问题看成一个能量系统，其中，不含噪声的图像能量相对比较小。当图像被噪声污染后，图像就变得不光滑，其能量也就相应的增大了很多，通过这种思想，就将图像去噪问题转化成了一个能量最小化问题，之后，再通过变分法进行求解。模型如下 min u ∈ B V ( Ω ) E ( u ) = J ( u ) + 1 2 λ ‖ u − f ‖ 2 (1) 其中，BV表示有界变差函数空间， ‖ ⋅ ‖ 表示 L 2 范数， ∇ 表示梯度算子，u为去噪后的图像，f表示观测图像， λ 表示正则化参数， J ( u ) = ∫ Ω | ∇ u ( x ) | d x 模型的第一项为正则项，第二项为逼近项。我们的图像是一个二 维矩阵( N × N )，用X表示欧几里得空间，为了定义离散的全变差范数，首先给出正则项中离散的梯度算子的具体定义，梯度 ∇ u 是一个在 Y = X × X 的向量。  假定图像被高斯噪声污染，对针对能量泛函(1)式利用变分法原理进行变分，获得欧拉-拉格朗日方程，表达式为 0 ∈ ∂ J ( u ) + λ ( u − f ) (2) 式(2)中， ∂ J 表示次微分，定义为 w ∈ ∂ J ( u ) ⇔ J ( u ) ≥ J ( u ) + 〈 w , v − u 〉 X ，根据凸分析中的对偶原理，上 式可以表示为 u ∈ ∂ J * ( ( u − f ) / λ ) (3) 式(3)中， J * 是Legendre-Fenchel变换，是闭凸集K上的指示函数 [ 11 ] ，其形式为 J ∗ = χ K ( v ) = { 0 v ∈ K + ∞ 其 他 (4) 对(3)式进行转化，有如下等价形式 f λ ∈ f − u λ + 1 λ ∂ J * ( f − u λ )"
"基于最小化下列能量泛函模型，表达式为 min ω E ( ω ) = 1 2 ‖ ω − λ f ‖ 2 2 + λ J * ( ω ) (5) J * 由(5)式已给出，我们可以推导出 ω 一定是 λ f 在凸集K上的正交投影，若 P K λ 表示在集合K上的 投影，则能量泛函式的解为 u = f − P K λ ( f ) (6) 计算非线性投影算子 P K λ 等价于求解于下列问题 min p { ‖ λ d i v p − f ‖ 2 : p ∈ Y , | P i , j | 2 − 1 ≤ 0 , ∀ i , j = 1 , ⋯ , N } (7) 在KKT条件 [ 8 ] 下，存在拉格朗日乘子 α i , j ≥ 0 ，满足 − ( ∇ ( λ d i v p − f ) ) i , j + α i , j p i , j = 0 (8) 结合梯度下降算法 [ 12 ] ，取 τ > 0 , p 0 = 0 ，以及对任意的 n ≥ 0 ，有 p i , j n + 1 = p i , j n + τ ( ( ∇ ( d i v p n − f λ ) ) i , j − | ( ∇ ( d i v p n − f λ ) ) i , j | ⋅ p i , j n ) (9) 再结合之前式子求出 u n ，若满足 | u n − u n u n | ≤ ε ，则得出的 u 即为优解。  BP神经网络在机构上类似于多层感知器，是一种多层前馈神经网络，在结构上具有三层或三层以上神经元，包括输入层、中间层、和输出层。上下层之间实现全连接，而每层神经元之间无链接。当一对学习样本提供给网络后，神经元的激活值从输入层经各中间层向输出层传播，在输出层的各神经元获得网络的输入相应。 BP网络学习规则 网络输入向量 P k = ( a 1 , a 2 , ⋯ , a n ) ；网络目标向量 T k = ( y 1 , y 2 , ⋯ , y q ) ；中间层单元输入向量 S k = ( s 1 , s 2 , ⋯ , s p ) ；输出向量 B k = ( b 1 , b 2 , ⋯ , b p ) ；输出层单元输入向量 L k = ( l 1 , l 2 , ⋯ , l q ) 输出向量 C k = ( c 1 , c 2 , ⋯ , c q ) ； 1) 初始化。给每个连接权值 w i , j , v j t 、阈值 θ j 和 γ t 赋予区间 ( − 1 , 1 ) 内是随机值。 2) 随机选取一组输入和目标样本 P k = ( a 1 k , a 2 k , ⋯ , a n k ) , T k = ( S 1 k , S 2 k , ⋯ , S n k ) 提供给网络。 3) 用输入样本 P k = ( a 1 k , a 2 k , ⋯ , a n k ) 连接权 w i , j 和阈值 θ j 计算中间层各单元的输入 s j ，然后用 s j 通过传递函数计算中间各层单元的输出 b j 。 s j = ∑ i = 1 n w i j a i − θ j ,     b j = f ( s j ) ,     j = 1 , 2 , ⋯ , p 4) 利用中间层的输出 b j 、连接权 v j t 和阈值 γ t 计算输出层各单元的输出 L t ，然后通过传递函数计算输出层各单元的响应 C t 。 5) 利用网络目标向量 T k = ( y 1 , y 2 ⋯ , y q ) ，网络的实际输出 C t ，计算输出层的各单元一般化误差 d t k 。再利用一般化误差和各单元的输出来修正连接权和阈值。直到m个训练样本训练完毕。"
"我们使用不同图像经Chambolle处理后的最佳的图像数据为训练样本，选取图像去噪效果最好时的图像结构相似性、峰值信噪比、正则项的数值和逼近项的数值三个因素，为BP神经网络的输入神经元，因此神经元网络的输入层单元数为4，正则项前的参数为输出指标，即输出的参数是唯一的输出神经元。 对于隐含层的选择。Nielse曾证明对于在任何闭区间内的一个连续函数，我们都可以使用一个隐含层来进行设置。Cybenko指出，当选用的转移函数为S型函数时，一个隐含层就能够解决问题。神经网络隐含层数的设计并非越多越好，隐含层数的增多虽说可以增大网络的处理能力，但这也可能会引发反向传播误差，使神经网络结构变得复杂化。本文选用S型连续函数，故隐含层数设计为1。 从图1的网络收敛结果可以看出：网络训练3次后收敛，网络误差为0.005749，基本达到了网络误差设置的要求。其中网络误差动态变化效果图来看：纵坐标为误差，我们可以清晰的看出随着训练次数的增加，训练集与测试集误差逐步减小，训练集与测试集变化趋势一致，网络训练到3次时，3条曲线相差很小，误差稳定，此时模型训练效果较好。 从图2可以看出，训练样本的拟合优度是93.40%，测试集的拟合优度是94.92%，而全部的拟合优度也达到了94.22%。这个拟合度证明了网络训练效果优秀，此训练模型精准度高，此模型可以解释94%左右的数据样本，除去个别数据样本的影响，我们可以完全可以通过此模型进行全变差正则项参数的精准预测。 图1. 网络训练和迭代图 图2. 模型拟合图 在得到正则项参数的预测值后，结合Chambolle对偶算法进行去噪。 我们选取了不同图像分别添加不同方差的高斯白噪声和泊松噪声进行实验，然后利用本文提出的自适应对偶投影算法进行实验，图3是对图像添加高斯白噪声和泊松噪声前后实验对比效果图： 图3. 第一行是噪声图像，第二行是处理后效果图 从主观方面上来看，我们可以发现，无论对于高斯白噪声还是泊松噪声，试验后的图像效果要比噪声图像清晰很多，说明了算法改进的可行性，在客观上，我们分别计算了每组实验的图像相似结构性SSIM和峰值信噪比，以及算法的运行效率等指标，分别和Chambolle合理值进行对比。 其中，Chambolle合理值的获得，是经过大量的人为实验，在图像取不同参数时算出此时图像的结构相似性ssim和峰值信噪比psnr，当这两个指标最大时，此时的ssim和psnr数值，我们视为Chambolle算法的合理值，然后将Chambolle合理值和改进后算法的结果做对比，结果如下： Table 1 图像 Chambolle合理值 本文改进算法 结构相似性SSIM 峰值信噪比PSNR 结构相似性SSIM 峰值信噪比PSNR BABOO 0.5231 30.0279154 0.5341 30.09057793 BOAT 0.4717 29.01847508 0.4895 28.99801813 BIRD 0.3952 27.68666436 0.4084 27.78572117 表1. 图像质量指标对比 从表1中我们可以看出，无论是经泊松噪声还是高斯白噪声，经过改进后算法结构相似性比Chambolle合理值要高些。峰值信噪比方面，经本文算法处理后与Chambolle合理值很接近，从而进一步说明了改进后算法的合理性和可行性。由此我们可以看出，经改进算法去噪后的效果图远比噪声图像清晰度高很多，在图像纹理和细节部分也能够较好的保护，这就避免了由于原算法中权重的主观选取，而导致图像过于光滑和去噪不彻底的弊端，具有一定的实际应用价值。"
"本文针对全变差去噪模型，首先分析了ROF模型的去噪机理，然后介绍了利用Chambolle对偶原理和BP神经网络的学习规则，利用基于BP神经网络对正则项参数的预测，再结合Chambolle对偶算法，使之构成一个统一整体的模型，利用改模型该求解速度更快，收敛性较好，弥补了一些传统数值算法中不能对权重进行调整的缺陷。同时通过对不同图像添加不同方差的高斯白噪声和泊松噪声进行仿真实验，在实验效果方面，我们从结构相似性，峰值信噪比等方面与合理值进行对比，其结果表明，该算法的各项去噪量化指标均可达到较好水平，从而解决了Chambolle对偶算法中参数的主观选取的弊端，提高了图像去噪的效率，具有很好的实际价值。"
