"针对锂电池执行器热故障问题，提出了一种基于集员滤波的故障诊断方法。通过建立锂电池电热耦合模型，基于电池温度采样数据，采用全对称多胞体卡尔曼滤波算法对采样数据进行分析，得到故障估计的区间，从而实现锂电池执行器热故障诊断。"
"锂电池是一种常用的动力电池，因其寿命长、自放率低、能量密度高等优势成为最具有发展前景的储能电源，被广泛应用于储能领域的各个方面 [ 1 ]。锂电池应用领域的不断拓展对电池的性能提出了较高的要求，安全性和可靠性问题是电池储能系统最关心的问题。锂电池热故障是电池故障中最重要的故障之一，它具有潜在的灾难性，会致使鼓包、漏液等问题，进而导致整个储能系统故障严重 [ 2 ]。因此，为保证电池储能系统的安全运行，对锂电池进行快速而准确的热故障诊断有着重要的意义。 现有的电池故障诊断方法可以分为两类，一种是基于电池模型的故障诊断方法，另一种是无电池模型的故障诊断方法 [ 3 ]。基于电池模型的故障诊断方法是通过比较电池模型的预测值与测量值之间的差异获取残差信号，进一步对信号处理以获取故障信息。该诊断方法可以实时进行电池故障检测和诊断，在电池的故障诊断技术领域中占据重要的地位。然而在实际情况中，系统中噪声的存在会导致实际系统建模不准确，基于电池模型的故障诊断方法的性能也因此受到影响。 本文主要针对上述基于电池模型的故障诊断方法中存在的不足，提出一种基于集员滤波思想的电池故障诊断方法，通过建立锂电池电热耦合模型，获取锂电池核心温度和表面温度的采样数据，将其作为全对称多胞体卡尔曼滤波算法的输入，从而得到锂电池执行器热故障的估计区间，根据故障估计区间可判断系统的故障状况。"
"锂电池热故障指导致电池温度异常的故障，包括电池滥用、风机故障和电池过充电故障等。热故障的普遍表现为电池核心温度和表面温度异常。因此需要建立电池热模型来模拟核心温度和表面温度的动态行为。考虑到电池的电学参数如电池电流、端电压等会影响到电池的产热，结合锂电池二阶Thevenin等效电路模型，建立电热耦合模型。 图1. 二阶Thevenin模型示意图 图1所示为二阶Thevenin模型， R 1 和 C p 1 分别为电化学极化电阻和电容， R 2 和 C p 2 分别为浓差化电阻和电容。 U 1 , U 2 为两个RC电路的压降， U o 为电池两端电压， U o c 为电池内部电压。R为电池内阻，I为电池电流。模型的数学表达式如下 [ 4 ]： U = U o c − R o I − U 1 − U 2 { U ˙ 1 = − 1 R 1 C p 1 U 1 + 1 C p 1 I U ˙ 2 = − 1 R 2 C p 2 U 2 + 1 C p 2 I (1) 式中， U ˙ 1 和 U ˙ 2 分别表示电压 U 1 和 U 2 的变化率。 根据电池内外的能量守恒方程、傅里叶热定律和牛顿散热定律，将产热模型定义为 [ 5 ]： { C c T ˙ c = Q g e n + T s − T c R c C s T ˙ s = T e − T s R u − T s − T c R c (2) 式中， C c 和 C s 分别表示电池内部材料的热容系数和电池表面的热容系数， R c 表示电池核心与表面之间的等效热传导电阻， R u 表示电池表面与冷却空气之间的等效对流电阻。 T e 表示环境温度， Q g e n 表示电池核心的发热功率。 根据Bernardi公式，电池的发热功率 Q g e n 为： Q g e n = I ( U o c − U ) = I ( R o I + U 1 + U 2 ) (3) 以产热率 Q g e n 和环境温度 T e 作为电热耦合模型的输入，以表面温度的测量值 T ¯ s 和核心温度的测量值 T ¯ c 作为电热耦合模型的输出。 离散化后，电热耦合模型的状态空间表达式为： { x k + 1 = A x k + B u k + D 1 w k y k = C x k + D 2 v k (4) 式中， x k = [ T c , k , T s , k ] T ∈ ℝ n 为系统的状态向量， u k = [ Q g e n , k , T e , k ] T ∈ ℝ r 为系统的输入向量， y k = [ T ¯ c , k , T ¯ s , k ] T ∈ ℝ p 为系统的输出向量， w k ∈ ℝ w 是系统中的扰动噪声， v k ∈ ℝ v 是系统中的测量噪声。 Δ t 是采样时间，并且 A = [ 1 − Δ t R c C c Δ t R c C c Δ t R c C s 1 − Δ t R c C s − Δ t R u C s ] , B = [ Δ t C c 0 0 Δ t R u C s ] , C = [ 1 0 0 1 ] , D 1 = D 2 = [ 1 0 0 1 ] 根据构建的电热耦合模型，设置相应的系统参数，可得到相对应的电池核心温度和表面温度的采样数据。"
"集员滤波是集员估计的一种。集员估计是一类利用几何空间求解状态估计的方法，相比于传统的状态估计算法，集员估计方法不需要知道系统噪声和干扰的统计特性，只要求系统噪声有界 [ 6 ]。集员估计方法的关键之处在于找到一个包含状态或参数的可行集的简单几何体来近似可行集。目前常用的几何空间有区间，椭球和全对称多胞体。由于区间分析本身的缺陷，基于区间的集员算法收敛速度较慢。基于椭球的集员算法迭代简单，但包裹性差，因此保守性有限。基于全对称多胞体的集员算法可以转换为简单的矩阵运算，相比于其他几何空间，所需的计算量较少，保守性低 [ 7 ]。 全对称多胞体卡尔曼滤波(Zonotopic Kalman filter, ZKF)算法是将卡尔曼滤波与全对称多胞体集员估计结合。与卡尔曼滤波相似，ZKF可分为状态预测和测量更新。状态预测使用前一时刻的状态多胞体，干扰和噪声多胞体，以及系统的输入和测量输出来生成下一时刻状态的预测多胞体。测量更新步骤中，将预测多胞体与来自测量输出信息的带状空间相交，以获得当前时刻的状态多胞体。基于ZKF的故障诊断算法将系统故障向量扩展到系统状态向量，构造增广系统，通过ZKF算法获得状态的估计区间。当故障发生时，故障的估计区间也可以得到，由此可以判断系统是否发生故障以及故障类型。"
"基于电热耦合模型，根据状态空间表达式(4)，锂电池执行器热故障模型可写为： { x k + 1 = A x k + B u k + f k + D 1 w k y k = C x k + D 2 v k (5) 式中， f k = [ f 1 , k , f 2 , k ] T ∈ ℝ p 表示热故障向量，当锂电池发生产热故障时，例如过充\过放以及电池短路时， f 1 ≠ 0 , f 2 = 0 。当锂电池发生冷却系统故障时， f 1 = 0 , f 2 ≠ 0 。当锂电池内部导热电阻发生故障时， f 1 ≠ 0 , f 2 ≠ 0 。 w k 和 v k 分别表示系统未知但有界的扰动和测量噪声，即 | w k | ≤ w ˜ ， | v k | ≤ v ˜ 。 首先将故障向量扩展到电热耦合模型的状态向量，得到增广的状态向量如下式： x ¯ k = [ x k f k − 1 ] (6) 因此锂电池执行器热故障模型可以重新写成： { E x ¯ k + 1 = A ¯ x ¯ k + B ¯ u k + D ¯ 1 w k y k = C ¯ x ¯ k + D 2 v k (7) 其中 E = [ 1 0 − 1 0 0 1 0 − 1 0 0 0 0 0 0 0 0 ] , A ¯ = [ 1 − Δ t R c C c Δ t R c C c 0 0 Δ t R c C s 1 − Δ t R c C s − Δ t R u C s 0 0 0 0 0 0 0 0 0 0 ] , B ¯ = [ Δ t C c 0 0 Δ t R u C s 0 0 0 0 ] , D ¯ 1 = [ 1 0 0 1 0 0 0 0 ] , C ¯ = [ 1 0 0 0 0 1 0 0 ] 不失一般性，假设系统(5)的初始状态 x ¯ 0 对应的全对称多胞体 Z 0 = p ¯ 0 ⊕ G ¯ 0 B s ， p ¯ 0 代表初始时刻对应全对称多胞体的中心点， G ¯ 0 代表初始时刻对应全对称多胞体的形状矩阵， Β s 为s个单位区间 [ − 1 , 1 ] 构成的单位盒子。假设扰动噪声 w k 和测量噪声 v k 都可以被一个全对称多胞体包裹： w k ∈ W = 〈 0 , W 〉 v k ∈ V = 〈 0 , V 〉 (8) 其中， W , V 分别为扰动和测量噪声所在的全对称多胞体集合。 W = diag ( w ˜ ) , V = diag ( v ˜ ) 。 假设k时刻的状态变量 x ¯ k 对应的全对称多胞体 Z k = p ¯ k ⊕ G ¯ k B s = 〈 p ¯ k , G ¯ k 〉 ，根据全对称多胞体的性质及系统状态方程可知，第 k + 1 时刻状态变量的预测集为 χ ¯ ^ k + 1 = 〈 p ¯ ^ k + 1 , G ¯ ^ k + 1 〉 (9) p ¯ ^ k + 1 = T A ¯ p ¯ k + T B ¯ u k + N y k + 1 (10) G ¯ ^ k + 1 = [ T A ¯ ↓ r e G ¯ k   T D ¯ 1 W − N D 2 V ] (11) 其中，T和N可以看作加权矩阵，T和N的含义分别是从模型和测量输出中选择信息。T和N的可行解为： T = Θ † α 1 + S Ψ α 1 , N = Θ † α 2 + S Ψ α 2 (12) 其中，S为任意选取的矩阵， Θ = [ E C ¯ ] ， Θ † 是 Θ 的伪逆， Ψ = I n + 2 p − ΘΘ † ， α 1 = [ I n + p 0 ] ， α 2 = [ 0 I p ] ； ↓ r e G ¯ k 表示将k时刻状态所在全对称多胞体降阶后的生成矩阵，通过式(13)~(16)求得 Z = 〈 p ¯ , G ¯ 〉 ⊆ p ¯ ⊕ r s ( G ¯ ) B n (13) r s ( G ¯ ) = [ ∑ j = 1 s | G ¯ 1 , j | 0 ⋯ 0 0 ∑ j = 1 s | G ¯ 2 , j | ⋯ 0 ⋮ ⋮ ⋱ ⋮ 0 0 ⋯ ∑ j = 1 s | G ¯ n , j | ] (14) Z = 〈 p ¯ , G ¯ 〉 ⊆ 〈 p ¯ , ↓ r e G ¯ 〉 (15) ↓ r e G ¯ = { G ¯ , s ≤ q [ G ¯ > r s ( G ¯ < ) ] , s > q (16) 求得状态预测集 χ ¯ ^ k + 1 后，寻求 k + 1 时刻的带状空间 S k + 1 与状态预测集的交集，进而得到 k + 1 时刻的状态估计范围。 带状空间 S k + 1 是根据 k + 1 时刻系统输出变量构造得到，如下式所示： S k + 1 = { x ¯ k + 1 ∈ ℝ n + s : | C ¯ x ¯ k + 1 − y k + 1 | ≤ D 2 v ˜ } (17) 根据 k + 1 时刻的带状空间 S k + 1 和状态变量预测集 χ ¯ ^ k + 1 的全对称多胞体集合，结合式(18)~(21)计算得到 k + 1 时刻的系统状态变量 x ¯ k + 1 的全对称多胞体集合： x ¯ k + 1 ∈ χ ¯ k + 1 = 〈 p ¯ k + 1 , G ¯ k + 1 〉 (18) p ¯ k + 1 = p ¯ ^ k + 1 + L k + 1 ( y k + 1 − C ¯ p ¯ ^ k + 1 ) (19) G ¯ k + 1 = [ ( I n + p − L k + 1 C ¯ ) G ¯ ^ k + 1   L k + 1 D v ] (20) L k + 1 = G ¯ ^ k + 1 G ¯ ^ k + 1 T C ¯ T ( C ¯ G ¯ ^ k + 1 G ¯ ^ k + 1 T C ¯ T + D v D v T ) − 1 (21) 其中， D v = diag ( D 2 v ˜ ) 。 对于一个全对称多胞体 Z = 〈 p , G 〉 ⊂ ℝ n ，能够被一个区间盒子 Box ( Z ) = [ z − , z + ] 限定。 z − 和 z + 可以通过如下公式计算： { z − ( i ) = p ( i ) − ∑ j = 1 s | G ( i , j ) |     ,   i = 1 , ⋯ , n z + ( i ) = p ( i ) − ∑ j = 1 s | G ( i , j ) |     ,   i = 1 , ⋯ , n (22) 因此，结合全对称多胞体卡尔曼滤波算法，可以得到 x ¯ k + 1 的区间估计，计算公式如下： { x ¯ k + 1 + ( i ) = p ¯ k + 1 ( i ) + ∑ j = 1 q | G ¯ k + 1 ( i , j ) |     ,     i = 1 , ⋯ , n + p x ¯ k + 1 − ( i ) = p ¯ k + 1 ( i ) − ∑ j = 1 q | G ¯ k + 1 ( i , j ) |     ,     i = 1 , ⋯ , n + p (23) 式中， x ¯ k + 1 + ( i ) , x ¯ k + 1 − ( i ) 分别表示 k + 1 时刻状态估计的最小上界和最大下界。 根据式(24)可以确定 时刻的故障估计区间 f k + = [ 0 I p ] x ¯ k + 1 + f k − = [ 0 I p ] x ¯ k + 1 − (24) 式中， f k + , f k − 分别表示k时刻故障估计的最小上界和最大下界。 当锂电池执行器不存在热故障时，则故障估计的上下界位于0的两侧。而当锂电池执行器发生热故障时，则故障估计的上下界同时位于0的一侧，故障的真实值则处于故障估计的区间范围内。故障类型不同，故障估计的区间不同，因此可以根据故障估计区间判断执行器热故障类型。 依据上述算法，基于温度采样数据，能够准确判断锂电池在工作过程中是否产生热故障，以及判断热故障类型，有效地保证了锂电池储能系统的安全性、可靠性和持久高效性。"
"基于锂电池电热耦合模型，设置仿真模型参数如表1所示： Table 1 参数 数值 R c 1.98 Ω C c 63.5 F C s 4.5 F R u 1.718 Ω R 1 0.0298 Ω C 1 1789.7 F R 2 0.03819 Ω C 2 5.26 F r 0.0501 Ω I 5 A 表1. 锂电池电热耦合模型主要参数 环境温度 T e 设为25℃，核心温度 T c 和表面温度 T s 的初始值都设为25℃。扰动和测量噪声限制为 | w k | ≤ 0.01 , | v k | ≤ 0.01 。锂电池执行器热故障 f k = [ f 1 , k f 2 , k ] T 具体形式如式(25)所示： f k = [ f 1 , k   f 2 , k ] T = { [ 0 0 ] T , 0 ≤ k < 100 [ 0.1 0 ] T , 100 ≤ k < 300 [ 0.2 0.2 ] T , 300 ≤ k < 500 [ 0.2 0.4 ] T , k ≥ 500 (25) 按照设置的参数运行，采样到的锂电池核心温度值和表面温度值如图2所示。 图2. 核心温度和表面温度采样值 基于温度采样数据，采用全对称多胞体卡尔曼滤波算法对采样数据进行分析。设置 p 0 = [ 25 25 ] T ， G 0 = 0.1 I 4 ，设置s矩阵： S = [ 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 ] (26) 根据式(12)，可以得到矩阵T和N如下式所示： T = [ 0 0 0 0 0 0 0 0 − 1 0 1 0 0 − 1 0 1 ] , N = [ 1 0 0 1 1 0 0 1 ] (27) 锂电池执行器热故障和它们的区间估计结果如图3所示。实际的故障用红线表示。从图3中可以看出，全对称多胞体卡尔曼滤波算法可以快速跟踪实际的执行器故障，并给出准确的区间估计结果。对于锂电池电热耦合模型而言，当系统出现故障时，ZKF可以检测到故障，并且可以迅速、准确地判断故障的类型，同时，根据故障估计的最大下界和最小上界，在一定的误差范围内，可以得到锂电池热故障的估计值。由此可见，ZKF算法准确地实现了锂电池执行器热故障诊断。 图3. 锂电池热故障和故障估计区间"
"本文针对锂电池执行器热故障诊断问题，提出了一种基于集员滤波的电池故障诊断方法，通过获得锂电池的温度采样数据，采用全对称多胞体卡尔曼滤波算法得到系统故障的估计区间，若锂电池运行过程中某一时刻有某类热故障发生，则该故障估计的上下界同时位于0的一侧，从而实现锂电池执行器热故障诊断。 基于集员滤波的故障诊断方法有着准确性好、鲁棒性强、应用范围广等优点，因此本文将基于集员滤波的故障诊断方法运用到锂电池执行器的热故障诊断中，能够有效提高锂电池热故障诊断的质量和性能。"
