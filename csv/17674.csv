"方向估计的主要目的是计算出图像等多维信号各点的方向信息，在图像处理和机器视觉的底层处理中具有广泛的应用。在总结现有的方向估计方法的基础上，对现有方法进行了误差比较，从而有利于对这类方法进行深入研究或设计更准确的方向估计方法。 关键词 :方向估计，图像处理，误差比较"
"方向估计可以计算出图像中各点的方向信息，在边缘提取、图像分割、纹理分析、自适应滤波、立体视差估计、图像增强和运动分析中都有直接应用，对位移和光流场的计算即对信号在三维空间中进行方向估计。如果把图像处理分为三个层次：底层视觉、中层视觉和高层视觉，那么底层视觉的主要任务就是提取不同尺度下的边缘及其方向信息。 本文的主要工作是对现有的方向估计方法进行分类总结，并进行误差比较，从而有利于对这类方法进行进一步研究。"
"现有的方向估计方法根据方向表示法来划分，可以分为基于通道表示的方法、基于自相关函数的方法和基于张量的方法。下面本文采用后一种分类方法对相关工作分别介绍。  基于通道表示的方法 [ 1 ] 选择某种核函数对信号在不同尺度下的梯度分别作一个映射，然后通过对该核函数的编解码过程来估计方向。现有的方法中，核函数主要有两种：一种是高斯函数；另一种是余弦函数。 基于自相关函数的方法 [ 2 ] [ 3 ] 主要基于信号理论以及对方向概念的统计分析。这种估计方法与其它方法相比，无需直接计算灰度梯度，而是直接计算信号的自相关函数，然后用抛物线拟合自相关函数的一小部分中心值并从抛物线的主曲率的方向中推导出所要估计的方向。信号对频域中信噪比的适应性通过对自相关函数进行线性滤波获得。 基于张量的方法 [ 4 ] - [ 19 ] 用二阶张量表示方向，表示方法简单有效，是目前应用最为广泛的一种方法。与前两种方法相比，这类方法具有实现简单、计算复杂度低等优点，因而论文重点对这类方法进行了研究。  根据(方向)张量的计算方法不同，这类方法可以进一步细分为梯度张量法 [ 4 ] - [ 12 ] 、多项式张量法 [ 13 ] 和正交张量法 [ 14 ] - [ 19 ] 。Bjorn Johansson和 Gunnar Farneback [ 23 ] 对不同的方向张量计算方法进行了比较。 梯度张量法与以往一些文献中提到的结构张量(Structure Tensor)的计算方法相同，主要是采用某种微分算子计算图像的灰度梯度，然后根据不同方向的梯度构造张量，这类方法的主要缺点是对噪声的鲁棒性比较差，往往需要一个整体上的平滑，而这一平滑过程使得方向估计的局部特征受到全局特征的干扰。文献‎ [ 24 ] 比较了窗口傅里叶变换法和边缘梯度方法在解决边缘方向估计问题中优劣。基于梯度张量的方法中，S. Fu等 [ 4 ] 加入均值滤波平滑噪声；A. Shrivastava [ 5 ] 和Davide Maltoni [ 6 ] 采用计算二倍角的方法克服正切变换在90度附近的不连续性和三角函数及角度的周期性的影响；Kuldeep Singh等 [ 7 ] 引入主元分析与多分辨率Kalman滤波提高估计结果的精度和鲁棒性；I.V. Grigoryeva等 [ 8 ] 主要讨论了多方向估计的问题；J. Feng [ 9 ] 和A. Sourice [ 10 ] 对梯度算子进行了改进，改善了一些轮廓关键点的方向估计结果；Jie Zhou等 [ 11 ] 先采用梯度梯度张量进行粗略估计，然后通过多项式模型优化方向估计结果；S. Kim等 [ 12 ] 提出了ABFT框架，由噪声鲁棒的特征检测和仿射不变量的二进制特征描述基于结构张量空间。 基于多项式张量的方法 [ 13 ] 是采用正则化卷积(Normalized Convolution)的信号分析方法，综合考虑信号的不确定性和信号分析函数，首先选择一组信号分析函数构成一组基，然后通过正则化卷积获得这组基的系数，这组系数与信号的泰勒展开式具有对应关系，最后采用多项式近似构造方向张量。正则化卷积的方法最初由Knutsson和Westin [ 20 ] - [ 22 ] 提出，其几何解释是：将信号及其邻域投影到一个由信号分析函数张成的子空间。其投影过程等同于一个加权最小均方问题，其权值由信号的确定性和分析函数决定。每一点的卷积结果是对应于分析函数的展开系数。尽管最小均方估计、选取分析函数及处理数据的不确定性都不是新思想，正则化卷积的创新之处在于将三者有效结合于统一的理论框架下。 基于正交张量的方法一般是设计一组正交滤波器，在频域对信号进行滤波，最后根据滤波器组的输出结果构造方向张量，用于估计方向。G. H. Granlund和H. Knutsson [ 14 ] 提出了一种基于lognormal滤波器(一种极坐标下可分解的正交滤波器)的方向估计方法；Tsantis Stavros等 [ 15 ] 使用EFCM聚类分析方法和多分辨力小波分析从散斑噪声中区分图像的边缘问题；Hans Knutsson等 [ 16 ] 主要采用单项式形式的傅里叶定向成对滤波器组，一个奇数阶集和一个偶数阶集，以实现相不变半正定局部结构张量估计；Fatih Porikli [ 17 ] 主要针对彩色图像进行了颜色信息的融合处理；C. Gottschlich [ 18 ] 和Hao Geng [ 19 ] 采用Gabor滤波器获得方向信息；Ryan P [ 25 ] 通过对正交滤波得到的方向角度图进行扩散滤波提高估计的鲁棒性。  我们选取了几种比较典型的方法进行比较，它们是基于通道表示的方法、基于梯度的方法、基于正交滤波的方法、基于正则化卷积的方法和基于Gabor滤波的方法。 通过对已知方向信息的合成图像进行方向估计，可以得到不同方法对各种倾角的直线进行方向估计的平均误差。这里，合成图像由各种倾角的直线组成，选取对各种倾角的直线进行估计的原因是不同倾角的直线离散化的误差不同，只有某些特定的方向(如水平、垂直和 方向)不存在离散化误差。其中，平均误差的计算公式为： (1) 式中， 为方向张量的准确值， 为估计值对应的张量。对于基于通道表示的方法需要将估计结果转化成张量表示。另外需要指出的是，这一误差的计算方法与方向角之间不存在直接的对应关系，只是误差大小的一个衡量标准。 表1为对几种不同方向估计方法的估计误差进行计算的实验数据，而图1和图2为根据实验数据绘制的误差比较图。首先，从估计精度角度看，在无噪的情况下，前四种方法的估计误差都比较小，而第五种方法的估计精度受滤波器个数的影响，随滤波器个数的增加而减小。其次，从对噪声的鲁棒性角度看，随着噪声的增加，基于梯度的方法受影响最大；基于正则化卷积的方法次之；基于Gabor的方法在对噪声的鲁棒性方面同样受滤波器个数的影响比较大；基于通道表示的方法在噪声较小时鲁棒性还好，当噪声增大到一定程度时估计误差也会明显增大；基于正交滤波的方法不但估计误差较小，对噪声的鲁棒性也最好；从图2的误差变动曲线中更可以看出基于正交滤波的方法的优越性。第三，进一步从计算 复杂度分析，对于 大小的图像，原始算法的计算复杂度为 ，其中，对图像作Fourier变换 Table 1 估计方法 参数设置(参数说明) 平均误差( 为高斯噪声的方差) 方法1：基于通道表示的方法‎ [ 7 ] (高斯微分滤波器的方差) (微分滤波器大小) (高斯平滑滤波器的方差) (平滑滤波器大小) (通道数) = 0:0.35; = 0.1:1.63； = 10:5.10. 方法2：基于梯度的方法 [ 12 ] (高斯微分滤波器的方差) (微分滤波器大小) (高斯平滑滤波器的方差) (平滑滤波器大小) =0:0.19; =0.1:2.98； ＝10:9.70. 方法3：基于正交滤波的方法‎ [ 20 ] (中心频率) (带宽) (滤波器个数) = 0:0.12; = 0.1:0.23； = 10:2.16. 方法4：基于正则化卷积的方法 [ 19 ] (奇偶滤波器之间的权系数) (滤波器大小) = 0:0.16; = 0.1:3.98； = 10:5.93. 方法5：基于Gabor滤波的方法 [ 25 ] 方法5a：n = 3； 方法5b：n = 6； 方法5c：n = 10； (高斯滤波器与Gabor滤波器的方差之比) n为滤波器个数 = 0: 时为6 时为1.46 时为0.75 = 0.1： 时为7.29 时为2.23 时为1.06 = 10： 时为9.57 时为3.37 时为1.95 表1. 几种方向估计方法的误差比较 图1. 各方向估计方法的估计误差柱状图 的计算复杂度为 ；计算滤波函数矩阵的计算复杂度为 ；对单个图像象素点进行方向张量的特征值分解的计算复杂度为 ，所以对于整幅图像计算复杂度为 ，故整个算法的计算复杂度为 。另外，基于正交滤波的方法采用张量表示方向，具有表示方法的简洁性，而且是唯一一种对于简单信号具有相位不变性的方向估计方法，所以，综合考虑估计精度、对噪声的鲁棒性、计算复杂度等因素，基于正交滤波的方法是比较好的方向估计方法。 图2. 各方向估计方法的估计误差变动曲线"
"本文对现有的方向估计方法进行了分类总结和实验分析，从而可以看出各种方法对噪声的鲁棒性程 度。在此基础上，本文进一步对其中性能较好的两种方法：基于自相关函数的方法和基于正交滤波的方法进行了计算复杂度分析，从而可以看出基于正交滤波的方向估计方法的优越性。我们下一步的工作将对基于正交滤波的方法进行进一步的改进。"
