"本文在时变波动率模型下，利用蒙特卡罗模拟研究了一类多资产到期理财产品的定价问题。为了进一步提高蒙特卡罗的模拟精度和收敛速度，利用主成分分析法构造了对应的方差缩减方案，并将该方案应用于一款挂钩多股票的到期理财产品定价中。结果表明，该方案既可以减小模拟的复杂程度，又提高了理财产品的定价精度。 关键词 :多资产理财产品，定价，方差缩减，主成分分析，蒙特卡罗模拟 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"时代发展的同时往往伴随着我国个人财富以及个人理财需求的增长，这使得各种新型金融理财产品层出不穷。对于金融衍生理财产品每个人的定义都有些许不同，说通俗些，理财不过就是用合法手段让自己现有的资产增多。多资产到期理财产品属于金融理财产品中的一种，且占有一定比重，深受投资者追捧。究其原因，必然有其定价的合理性，故而本文研究多资产到期理财产品定价问题。 随着金融衍生产品的不断创新和发展，挂钩多资产的理财产品也相继问世，但目前为止，对挂钩多资产理财产品的定价研究相对较少。2000年，Li采用Cholesky对一款挂钩多资产的结构性理财产品进行了研究，模拟其违约事件的联合分布 [ 1 ]。Satyayitdas在2001年对结构性理财产品挂钩的多种风险资产进行了多方位分析，总结出结构性理财产品的基本原理、设计因素和定价构成等，这对金融理财产品相关理论研究有着促进作用 [ 2 ]。随后2004年，Cherubini采用Copula函数法对资产组合的风险进行了度量。随着理财产品的发行数量增多，逐渐有更多的学者研究产品的收益定价情况，同时进行相对更全面的分析。2010年，Wallmeier和Diethelm分析了多款多资产债券，发现产品属于溢价发行，得到最终收益会比预期收益低的结论 [ 3 ]。2011年，陈金龙和任敏用蒙特卡罗方法对挂钩多资产的保本型结构性产品进行了定价研究 [ 4 ]。So MKP，Yeung CYT在2014年构造了混合Copula模型对香港蓝筹股的相关性进行了研究，发现股票收益的相关性与依赖于时间的变化 [ 5 ]。2016年，针对想要购买结构性理财产品中的普通投资者，Entrop O，Mckenzie M，Wilkens M采用混合Copula模型对他们所面临的风险调整绩效进行了计量，发现普通投资者会承担多种风险 [ 6 ]。2018年，方艳等人首先借助混合Copula函数对资产间尾部相依性进行拟合，然后利用蒙特卡罗模拟方法对多资产挂钩的结构性理财产品进行了定价研究，并且还对比了不同模型的的定价结果，从而进一步丰富我国的理财产品定价模型 [ 7 ]。 国内外对挂钩多资产的期刊或理财产品研究日趋成熟，有的是从理财产品设计及风险方面进行研究，有的是从定价方面进行研究，但大多都基于Cholesky分解和Copula模型进行研究。基于此，本文将主成分分析法融入蒙特卡罗模拟中，对挂钩多资产的理财产品进行了定价研究。一般而言，当普通投资者面对眼花缭乱的理财产品时，他们很难对理财产品的价值进行合理评估，常常会对其风险和收益的认知出现稍许偏离。因此，本文希望能为发行银行在产品设计定价方面提供思路，为丰富发行银行的理财产品种类提供参考，为普通投资者选择适合自己的理财产品进行投资作参考。"
"有的学者选择用增加模拟路径的方法试图提高其模拟精度，但发现，这样做大大增加了模拟时间，且对运行设备要求较高。因此，接下来将采用控制变量技术来达到减小其波动方差的目的。 控制变量技术是一种最简单、且较有效的方法，其应用更加广泛 [ 9 ]。假定在求理财产品收益 F ( S ) 的期望值 E [ F ( S ) ] 时，得到所挂钩的风险资产随机向量 V i = ( S 1 , S 2 , ⋯ , S d ) T 的同时，还能获取另一个随机向量 Y = ( Y 1 , Y 2 , ⋯ , Y d ) T 的样本 Y i ，并且 E [ Y ] 是更加容易计算的，则可以用随机变量Y来构造期望值 E [ F ( S ) ] 的控制变量C，换句话说，假定 ( V i , Y i ) 具有如下的协方差矩阵 ( Σ Y Σ Y V Σ Y V T σ V 2 ) 其中 Σ Y 是非奇异的 d × d 方阵， Σ Y V T 是 d × 1 向量， σ V 2 是变量V的方差。  本小节论述单一控制变量的构造方法。对任意常数 b ∈ R 可以构造 E [ X ] 的一个估计值 V ¯ N ( b ) = V ¯ N − b ( C ¯ k N − E [ C k ] ) (1) 其中，b为待定常数， E [ C k ] 可求， C k 是由任意一个 Y k , k = 1 , 2 , ⋯ , d 构造的单一控制变量，即 C k = g ( 0 , ⋯ , 0 , Y k , 0 , ⋯ , 0 ) (2) 其中， k = 1 , 2 , ⋯ , d ，显然 V ¯ N ( b ) 是 V ¯ n 的无偏估计，有最优系数 b * = cov ( C k , V ) var ( C k ) = cov ( Y k , V ) var ( Y k ) = ρ Y k V σ V σ Y k (3) 其中， cov ( C k , V ) 和 var ( C k ) 的值一般难以求得，故需要估计 ( C i , V i ) , i = 1 , 2 , ⋯ , N ，然后可以得到 cov ( C k , V ) 和 var ( C k ) 的估计值 var ( V ¯ n ) = 1 n − 1 ∑ i = 1 n ( V i − V ¯ n ) 2 (4) cov ( C , V ) = ∑ i = 1 n ( Y i − Y ¯ ) ( V i − V ¯ ) n − 1 (5) b n * = ∑ i = 1 n ( Y i − Y ¯ ) ( V i − V ¯ ) ∑ i = 1 n ( Y i − Y ¯ ) 2 (6) 其中，n是控制变量模拟次数，N是蒙特卡罗总模拟次数，一般 n ≪ N 。考虑控制变量估计值 V ¯ N ( b ) 的最小方差 var ( V ¯ N ( b * ) ) = ( 1 − R C k V 2 ) var ( V ¯ N ) = ( 1 − R Y k V 2 ) var ( V ¯ N ) (7) 原变量的方差 var ( V ¯ N ) = 1 N − 1 ∑ i = 1 N ( V i − V ¯ N ) 2 (8) 从而可以获取方差缩减指数 var ( V ¯ n ) var ( V ¯ N ( b ) ) = 1 1 − ρ C k V 2 = 1 1 − ρ Y k V 2 (9) 其中， ρ C k V 是相关系数，可以看出，方差缩减指数的大小依赖于控制向量 C k 和原始变量V之间的相关系数.同时，方差缩减指数越大，意味着方差缩减效果越好。  控制变量不但可以由一个随机变量 Y k 构造，还可由多个随机变量共同构造，即 C k = ( Y 1 , Y 2 , ⋯ , Y k ) T , k ≤ d (10) 相同地，对任意固定的向量 b ∈ R d 构造 E [ X ] 的估计值 V ¯ N k ( b ) = V ¯ N − b T ( C ¯ N k − E [ C k ] ) (11) 其中，b为待定常向量， E [ C k ] 可求，同单一控制变量一元，可以得到最优系数 b k * = Σ C k − 1 Σ C k V (12) 这里， Σ C k V 为d维向量，第j个元素为 1 N − 1 [ ∑ i = 1 N C i k ( j ) V i − n C ¯ k V ¯ ] Σ C k − 1 为 d × d 矩阵，第jk个元素为 1 N − 1 [ ∑ i = 1 N C i k ( j ) C i k ( k ) − n C ¯ k ( j ) C ¯ k ( k ) ] 仍从方差缩小的角度考虑蒙特卡罗模拟效果，计算 X ¯ N k ( b ) 的最小方差 var ( V ¯ N k ( b k * ) ) = σ V 2 − Σ C V T Σ Y − 1 Σ C V = var ( V ¯ N ) ( 1 − R C k V 2 ) (13) 其中 R C k V 2 = Σ C k V T Σ Y − 1 Σ C k V / var ( V ¯ N ) (14) 容易获取方差缩减指数为 var ( V ¯ N ) var ( V ¯ N k ( b k * ) ) = 1 1 − R C k V 2 (15) 可以看出，方差缩减指数对控制向量 C k 和原始变量X之间的平方复相关系数 R C k V 2 高度敏感。 特别地，当复合控制变量 C k 的各个分量 Y 1 , Y 2 , ⋯ , Y k 独立时，此时协方差矩阵 Σ V 恰好为对角矩阵，此时平方复相关系数简化为 R C V 2 = ρ Y 1 V 2 + ρ Y 2 V 2 + ⋯ + ρ Y k V 2 ,     k = 1 , 2 , ⋯ , d (16) 其中 ρ Y i V 是变量 Y i 与V的相关系数。 因此，在理财产品定价中，若想达到更加良好的缩减方差效果，需要选取多个与之相关性更高的变量来控制模拟方差，又因为控制变量之间不相关时方差控制效果更加良好，所以本文利用主成分分析方法提取控制变量，进行蒙特卡罗模拟。  本节利用主成分方法构造控制变量。对风险资产向量 V = ( S 1 , S 2 , ⋯ , S d ) T 假设其协方差矩阵为 Σ V ，显然 Σ V 是一个半正定对称矩阵，从而存在谱分解 Σ V = U Λ U T 其中 是特征值 λ i 组成的对角矩阵，且 λ 1 ≥ λ 2 ≥ ⋯ ≥ λ n ≥ 0 。此外， U = ( u 1 , u 2 , ⋯ , u n ) 是一个正交矩阵， u i 是特征向量。于是，风险资产向量V的主成分变换为 Y = U T V (17) 多资产理财产品收益函数 F ( S ) 各有不同，一般可以由理财产品说明书得到，当风险资产V进行主成分变换后，理财产品收益 F ( S ) 变为 g ( Y ) ，则理财产品定价等价于 E [ F ( S ) ] = E [ g ( Y ) ] = E [ g ( Y 1 , Y 2 , ⋯ , Y n ) ] (18) 显然，式(17)定义的主成分Y具有零均值。Y的第i个分量 Y i = u i T V 称为第i个主成分。 进一步，对于挂钩多资产的理财产品进行定价，本文利用主成分方法构造了两种方差缩小方案： 方案一：将第k个主成分 Y k 构造为第k个单一控制变量 C k = ( 0 , ⋯ , 0 , Y k , 0 , ⋯ , 0 ) ,                           k = 1 , 2 , ⋯ , d (19) 方案二：将前k个主成分 Y 1 , Y 2 , ⋯ , Y k 共同构造复合控制变量 C k = ( Y 1 , Y 2 , ⋯ , Y k ) ,                               k = 1 , 2 , ⋯ , d (20) 主成分分析具体处理步骤如下： 1) 提取主成分 2) 获取风险资产向量V的协方差矩阵 Σ V 3) 计算特征值与特征向量 根据特征方程 | Σ V − Λ I | = 0 ，其中I是单位矩阵，可得到其特征值组成的对角矩阵 Λ 与特征向量正交矩阵 U = ( u 1 , u 2 , ⋯ , u n ) 。 4) 写出主成分表达式 根据特征值，特征向量，可写出主成分表达式。"
"对多资产区间理财产品进行定价研究之前，需要先做如下假设： 假设1市场是完全的，所有资产是完全可以无限细分，且没有卖空限制。 假设2在衍生证券生命期内，无风险利率采用连续复利的方式计算考虑我国区间理财产品大多期限较短的实际情况，因此假定利率为固定利率。 假设3市场是无套利的 [ 8 ]。 假设4股票价格均遵循时变Black-Scholes模型，即 d S t = μ t S t d t + σ t S t d W t 其中 W t 表示标准布朗运动，波动率 σ t 和股票期望收益率 μ t 都是时间的函数。假定 σ ^ t 为波动率 σ t 的矩估计，则波动率 的二阶原点矩为 σ ^ t = s ^ Δ t 这里 s ^ 是风险资产价格的对数差分序列 u i 的标准差，换句话说 s ^ = 1 n − 1 ∑ i = 1 n ( u i − u ¯ ) 2 u i = ln ( S i S i − 1 ) 其中， i = 1 , 2 , ⋯ , T [ 10 ]。  在风险中性世界中，风险资产的状态变量 V = ( S 1 T , S 2 T , ⋯ , S d T ) T 在到期日具有相关性的基础随机过程如下 { d S 1 , T = r S 1 , T d t + σ 1 S 1 , T d W 1 d S 2 , T = r S 2 , T d t + σ 2 S 2 , T d W 2                             ⋮ d S i , T = r S i , T d t + σ i S i , T d W i (21) 其中， i = 1 , 2 , ⋯ , d ，r为无风险利率， W i 为标准布朗运动。资产两两之间的相关系数为 ρ i j ，即 d W i ⋅ d W j = ρ i j d t ， j = 1 , 2 , ⋯ , d ，协方差矩阵为 Σ V Σ V = d i a g ( σ ) U d i a g ( σ ) ,                 σ = ( σ 1 , σ 2 , ⋯ , σ i ) T (22) 根据前述条件及伊藤引理，式(21)可以转换成以下形式 { S 1 , T = S 1 , 0 exp [ ( r − σ 1 2 2 ) T + σ 1 ε 1 T ] S 2 , T = S 2 , 0 exp [ ( r − σ 2 2 2 ) T + σ 2 ε 2 T ]                                                 ⋮ S i , T = S i , 0 exp [ ( r − σ i 2 2 ) T + σ i ε i T ] (23) 其中， { ε i , i = 1 , 2 , ⋯ , d } 是相互独立的标准正态随机变量。 下一步，进行主成分转换，可以通过几何布朗运动过程的协方差矩阵分解成特征值和特征向量 Σ V = U Λ U T (24) 其中，特征值矩阵 Λ = d i a g ( λ 1 , λ 2 , ⋯ , λ n ) 特征向量矩阵 U = ( u 1 , u 2 , ⋯ , u n ) 则风险资产向量X的主成分变换为 Y = U T V 由式(23)和式(25)可知 σ i = u i 1 λ 1 + u i 2 λ 2 + ⋯ + u i i λ i 那么， Y 1 , Y 2 , ⋯ , Y n 线性无关，则式(23)可变换为 (25) 其中， i = 1 , 2 , ⋯ , d ，分别代表第i个成分。  基于以上分析，主成分蒙特卡罗模拟算法设计步骤如下： 步骤1：进行主成分转换 ① 首先，在R软件中，将五支股票的收盘价数据进行KMO检验，看数据是否适合进行主成分分析，若适合则进行下一步。 ② 根据特征值及碎石图判断需要提前的主成分个数。 ③ 计算特征值对应的特征向量矩阵。 ④ 得到风险资产的主成分表达式。 步骤2：计算收益 首先，生成独立的标准正态随机变量 ε 1 , ε 2 , ⋯ , ε i ( i = 1 , 2 , ⋯ , d ) ，d是风险资产个数，根据式(4.23)算出每个风险资产到期时的价格， S 1 T , S 2 T , ⋯ , S d T ，再根据理财产品收益方式说明，得到收益函数 F ( S ) ，计算其收益。 步骤3：构造控制变量 根据式(25)求得 Y 1 T , Y 2 T , ⋯ , Y d T ，再根据公式(2)及公式(10)，可以构造单一控制变量及复合控制变量 C k = g ( 0 , ⋯ , 0 , Y k , 0 , ⋯ , 0 ) ,     C k = g ( Y 1 , ⋯ , Y k , 0 , ⋯ , 0 ) 其中 Y k 为第k个主成分。 步骤4：计算最优系数 根据公式(6)计算最优系数 b n * ；公式(12)计算最优系数 b k * 。 步骤5：计算理财产品价格 首先，得到传统蒙特卡罗估计价格 V ¯ N = e − r T 1 N ∑ i = 1 N F ( S ) (i) 其次，得到主成分控制变量蒙特卡罗估计价格 V ¯ N ( b ) = V ¯ N − b ( C ¯ k N − E [ C k ] ) V ¯ N k ( b ) = V ¯ N − b T ( C ¯ N k − E [ C k ] )"
"为更清晰对比主成分蒙特卡罗的模拟效果，本节选取的理财产品为中国银行发行的中银进取系列某款理财产品，该理财产品业务自2010年以来均有发行，其挂钩的是五只港股股票，该理财产品信息如表1所示： Table 1 产品名称 中银进取系列 产品类型 保本浮动收益型 投资及理财收益币种 人民币 观察期 一年 挂钩指标 名称 定盘价格 中国神华(1088.HK) 以香港股票交易所公布的该股票收市价为准， 括号中为该支股票在香港股票交易所的代码 建设银行(0939.HK) 中国铁建(1186.HK) 华能国际(0902.HK) 大唐发电(0991.HK) 起点认购金额 5万元 收益计算方式 产品到期时，分别计算五支股票的股价表现绝对值，将计算出来的五个绝对值中最小的绝对值乘以参与率，具体计算公式，即客户的最后理财收益率具体计算公式如下： 到期产品理财收益率(港币) = 50% * min|期末股价/期初股价-1| 表1. 理财产品说明书  考察表1中所述五支股票的主成分。将五支股票收盘价的一年期历史数据进行KMO检验，KMO值为0.73，大于0.7，表明数据可以进行主成分分析。为了进一步提取主成分的个数，首先，获得其特征值和碎石图如图1所示： λ 1 = 2.4530 , λ 2 = 1 .1208 , λ 3 = 0 .6002 , λ 4 = 0 .4253 , λ 5 = 0 .4007 第一个特征值和第二个特征值均大于1，结合碎石图综合来看，可以提取前两个成分作为主成分。接下来，计算特征值对应的特征向量组成的矩阵 U = ( − 0.4812 0.3289 − 0.5146 0.2127 − 0.4011 0.4458 − 0.3582 − 0.6700 − 0.4631 − 0.4461 ) = ( u 1 , u 2 ) 从而可以得到主成分表达式 Y 1 T = Y 1 t exp [ ( r − σ 1 2 2 ) ⋅ T + ( u 11 ε 1 λ 1 T + u 21 ε 2 λ 2 T + ⋯ + u i 1 ε i λ i T ) ] Y 2 T = Y 2 t exp [ ( r − σ 2 2 2 ) ⋅ T + ( u 12 ε 2 λ 2 T + u 22 ε 2 λ 2 T + ⋯ + u i 2 ε i λ i T ) ] 图1. 股票数据碎石图 由以上分析，本节构造三个独立的控制变量 C 1 = ( Y 1 ) ,                             C 2 = ( Y 2 ) ,                         C 3 = ( Y 1 , Y 2 )  本节进行控制变量情形下的理财产品价值的蒙特卡罗模拟。依据主成分蒙特卡罗模拟算法的步骤2，获取风险资产向量 V = ( S 1 T i , S 2 T i , S 3 T i , S 4 T i , S 5 T i ) T 其中 i = 1 , 2 , ⋯ , N ，N表示蒙特卡罗模拟的总次数。 再根据理财产品收益方式说明，得到该理财产品收益函数如下： F ( S ) = { F S i , T = S i , 0 F [ 1 + 50 % × min | S i T S i t − 1 | ] S i , T ≠ S i , 0 (27) 其中， i = 1 , 2 , ⋯ , d ， S i , T 为理财产品挂钩的第i个风险资产期末价格， S i , 0 为期初价格。构造相应的控制变量 C 1 i = Y 1 ,                         C 2 i = Y 2 ,                       C 3 , i = ( Y 1 , Y 2 ) 根据主成分蒙特卡罗模拟算法步骤4计算最优系数 b 1 , b 2 , b 12 ，再依照步骤5即可得到传统蒙特卡罗估计价格 V ¯ N = e − r T 1 N ∑ i = 1 N F ( S ) (i) 以及主成分控制变量蒙特卡罗估计价格 V ¯ N , 1 = V ¯ N − b 1 ( C ¯ 1 N − E [ C 1 ] ) V ¯ N , 2 = V ¯ N − b 2 ( C ¯ 2 N − E [ C 2 ] ) V ¯ N , 3 = V ¯ N − b 12 ( C ¯ 1 N − E [ C 1 ] , C ¯ 2 N − E [ C 2 ] ) 依据上述三个公式，表2展示了10,000次模拟总次数下的理财产品价格。 Table 2 V ¯ n V ¯ N , 1 V ¯ N , 2 V ¯ N , 3 价格 48,524.25 47,681.88 47,457.38 47,699.30 方差 12,4881.7 78,737.35 88,824.79 42,680.49 表2. 标准mc与控制变量mc模拟价格对比 由表2不难看出，复合控制变量蒙特卡罗模拟价格的方差为42680.49，是最小的，其次是由第一主成分构造的单一控制变量蒙特卡罗，其模拟价格的方差为78737.35，均比传统蒙特卡罗模拟价格的方差小很多。 Table 3 类型 方差缩减指数 V ¯ N , 1 1.558294 V ¯ N , 2 1.380146 V ¯ N , 3 3.527895 表3. 模拟一万次的mc方差缩减指数 再计算方差缩减指数，其结果见表3，可看出方差缩减指数均大于1，即说明控制变量蒙特卡罗模拟可以缩减方差以达到提高精度的目的，方差指数越大，说明其方差缩减效果越好。 在单一控制变量中，用第一主成分构造的控制变量方差缩减指数大于第二主成分构造的控制变量的方差缩减指数，即1.558294 > 1.380146，第一主成分往往能更好解释原变量的大部分信息，与原变量相关性更高，效果更好。 同时，也可看出，由第一主成分和第二主成分共同构造的控制变量指数最大，为3.527895，约为单一控制变量的一倍，不难看出其方差缩减效果比单一控制变量的效果好一倍之多。故用复合控制蒙特卡罗模拟一万次的估计价格来讨论该理财产品的定价合理性，其理论价格为 V ¯ N , 3 = 47699.30 溢价率 ( F − V ¯ N , 3 F ) × 100 % = 4.6 % 该理财产品属于溢价发行，溢价率为4.6%，定价偏高，意味着投资者若购买此款产品，则到期时获得的收益会略低于预期收益。"
"本文研究了多资产区间理财产品的定价问题，由于挂钩多资产理财产品的设计更加复杂，从而选择蒙特卡罗模拟进行计算。为了提高模拟精度的同时又释放其挂钩风险资产间的相关性，将主成分方差控制技术融入蒙特卡罗模拟中。结果表明，用主成分蒙特卡罗模拟可以更好地缩减方差，获取更高精度的定价结果，该方法可以应用到其他类型的多资产理财产品定价中。"
