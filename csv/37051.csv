"目前，车用橡胶导管的质量检测主要是依靠人工来完成，检测效率低下，并且存在误检、漏检等问题，本文以车用胶管为研究对象，设计了一种基于机器视觉的车用胶管质量在线检测系统。从硬件和软件设计了一套系统，硬件方面包括相机与镜头选型和光源照明系统的创新性设计等，软件设计包括图像滤波和边缘检测等。实验结果表明，本设计系统具有较高的识别率，对于在复杂的工业环境下完成胶管的在线检测具有很高的实用价值。 关键词 :机器视觉，光源与照明，边缘检测 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"车用橡胶导管是汽车发动机中的关键部件，其质量好坏对汽车的驾驶性能和安全性起到重要作用。汽车胶管质量检测主要分为管壁外形的缺陷检测和内外径与壁厚尺寸的测量，本文主要针对汽车胶管尺寸设计一套在线测量系统。目前，对于尺寸的质量指标检验都是由人工采用接触式测量工具来完成，由于橡胶材质的易形变的特性，使得测量精度受人为主观影响较大，导致检测误差大。这种依靠人力检测的方法，手段比较落后，不仅影响了生产线的工作效率，而且浪费了大量的劳动资源，检测人员的工作状态对检测结果有很大影响，造成检测效率低、精度低、成本高等缺点 [ 1 ]。 机器视觉是利用计算机对图像或视频进行处理，实现对二维或三维场景的识别、检测、感知和理解等功能 [ 2 ]。机器视觉检测系统具有测量精度高、速度快、非接触、实时性好等特点 [ 3 ]。本文致力于开发一套基于机器视觉技术的胶管尺寸质量自动检验系统，目的是替代人工检验，同时提高检验精度和效率。"
"基于机器视觉进行汽车胶管的内外径与壁厚的测量，检测要求内外径误差为0.07 mm，管壁的壁厚的误差范围不大于0.05 mm。测量系统由照明系统、CCD摄像机、图像采集卡、计算机以及图像处理算法组成 [ 4 ]，如图1所示。 图1. 汽车胶管质量检测系统 通过CCD摄像机和照明系统采集最佳的汽车胶管图像，再利用计算机对图像进行处理得到检测信息，最后根据检测信息进行胶管的分类，判断其是正品还是次品。"
"硬件是机器视觉检测系统的基础，光源、摄像机、光学镜头、采集卡及工业计算机是系统的关键部分，其选型与检测的要求息息相关，选型合适与否直接影响后续图像处理的结果及检测准确度 [ 5 ]。  相机与镜头的光轴与被测物体截面的位置关系设定为垂直，以便减少误差。选择合适的光源有助于提高视觉检测系统所获得图像的质量 [ 6 ]。以其它带有尺寸测量的系统为参考，选取垂直照射环形光源，具有照明面积大，光照均匀性好，适用于较大面积的照明。而背光源经过特殊导光材料优化光路，平行性好，适用于外观检测或是尺寸测量。根据实际检测环境本系统提出了一种“双向–环形光源”方案，充分发挥光源对轮廓外形获取的功能，如图2所示。 图2. 相机镜头与光源的位置关系  本系统中的质量检测为静态测量，对相机帧率要求不需要很高，30 fps至65 fps基本可以满足需求。车用胶管最大测量尺寸约为45 mm * 45 mm，根据公式： p = ( l / μ ) × ( w / μ ) (1) 其中 μ 为检测精度，表示系统要求的分辨率的实际物理尺寸， l × w 是相机的视场角(FOV)，表示相机的拍摄视野范围。而相机的感光芯片一般有4:3的长宽比例，可估算长边像素数量约为2500，对应短边为1800。综合考虑各种参数，本系统选取维视图像的MV-EM500M/C型号相机，分辨率为2592 * 1944，即500万像素，如图3所示。 图3. MV-EM500M/C型号相机  标定的目的是确定被测工件的实际尺寸与采集图像中像素数的量化对应关系，以便将图像中的点与被测物体中的点联系起来，方便提取几何特征参数 [ 7 ]。以下为具体计算像素当量流程：1) 将标准胶管件与摄像机成像平面的坐标轴平行放置。2) 在特定焦距、物距下，求得标准胶管件实际尺寸，并截取到其对应图像，得到该图像像素数，进而可求解到像素当量。经标定，本系统像素当量为0.03345 mm/pixel。 在实际工业环境中，环境变量发生变动后，如相机与镜头位置发生变化、胶管放置位置变化等，需要对整个系统进行重新标定。"
"如图4所示，整个软件系统分为图像采集模块、图像处理模块和图形交互界面模块。 图4. 软件系统结构图 图像采集模块是体系构件的基础模块，主要负责控制摄像头和照明光源对图像进行采集工作 [ 8 ]。图像处理模块是软件系统的核心，图形交互界面模块是对相机的相关使用参数设置实现交互界面，并将测量的结果以图形界面显示出来。通过对界面的合理设计，用户可以清晰地看到测量后胶管各参数。  检测算法流程图如图5所示。 图5. 检测算法流程图   灰度直方图是图像预处理中最基本的概念之一，表示了图像中每一个灰度和其对应的出现频率之间的关系，是图像的重要统计特征。在本文中体现为胶管图像中0-255每个灰度值对应的像素点个数。 直方图均衡化处理是图像处理领域中利用图像直方图对对比度进行调整的方法。通过这种方法，亮度可以更好地在直方图上分布，就是把原始图像的灰度直方图从比较集中的某个灰度区间变成在全部灰度范围内的均匀分，对图像进行非线性拉伸，重新分配图像像素值，使一定灰度范围内的像素数量大致相同。 胶管的原图像及其灰度直方图如图6所示。由于胶管内孔处的灰度值很低基本接近于黑色，所以在灰度值0处形成了峰值，而在内外径之间(管壁)的灰度值在80~100之间，外径边缘灰度值在120~180这个区间，与其它范围灰度值分布差别很大。图7为直方图均衡化后的图像及其灰度直方图。可以看到，直方图均衡化不仅保持了上述两个区间的峰值，同时改善了其它灰度范围分布不均匀的情况，使得一些原图像不够清晰的细节更清楚，提高了图像的对比度。 图6. 胶管原图像及其灰度直方图 图7. 直方图均衡化后胶管图像及其灰度直方图  图像在获取和传输过程中常常会受到噪声的污染使图像质量降低。由于降质图像在获取的过程中受各种不同因素的影响，如环境条件、传感器元器件自身质量、传输信道的干扰以及量化等，因此所引入的噪声类型多种多样，如高斯噪声、椒盐噪声、斑点噪声等 [ 9 ] [ 10 ]。这时候需要对图像进行滤波处理 [ 11 ]。本系统采用中值滤波，中值滤波的具体过程就是在一个采集窗口内，将中心点替换为该窗口灰度值的中值，其中滤波器可以定义如下： p 0 = m e d ( q 1 , q 2 , ⋯ , q n ) = q n + 1 2 其中 q 1 , q 2 , ⋯ , q n 是滤波器图像范围中的像素灰度值， p 0 是图像经过滤波器后的输出灰度值，是n是中值滤波器图像范围中的像素数量，由于需要在中值滤波器中形成一个中心像素，故n通常为奇数。 中值滤波的窗口大小是可以选择的，选择的窗口越大，对噪声的抑制效果越好，但会造成图像边缘的模糊。图8为分别采用3 × 3、5 × 5和7 × 7的窗口进行中值滤波后的结果。 图8. 中值滤波去噪 从图8可以看出，采用3 × 3中值滤波效果最好，既不会导致明显的边缘模糊，又有效抑制了噪声，而5 × 5大小的窗口会造成轻微的边缘模糊，7 × 7大小的窗口导致了严重的边缘模糊。因此，本文选用3 × 3窗口进行中值滤波。   Canny算法的主要流程为：1) 对图像进行高斯滤波。由于Canny算法对噪声非常敏感，首先必须对图像进行降噪处理，此算法采用高斯滤波。2) 计算梯度矢量。传统Canny算法利用中心点2 × 2邻域内一阶有限差分的均值来计算该点的梯度幅值，由于采用相对较少的点，所以对噪声较敏感，且容易检测出假S边缘或丢失一些真实边缘的细节部分 [ 12 ]。Canny算子沿x方向和y方向的梯度表达式为： f x ( x , y ) = f ( x , y + 1 ) − f ( x , y ) + f ( x + 1 , y + 1 ) − f ( x + 1 , y ) (3) f y ( x , y ) = f ( x , y ) + f ( x , y + 1 ) − f ( x + 1 , y ) − f ( x + 1 , y + 1 ) (4) Canny算子的水平方向和垂直方向的一阶微分卷积模板分别为： S x = [ − 1 1 − 1 1 ] , S y = [ 1 1 − 1 − 1 ] (5) 3) 对梯度幅值进行非极大值抑制。图像梯度幅值大并不一定就是边缘点，作为Canny算法的重要步骤，非极大值抑制简单来说就是寻找像素点梯度局部最大值，将非极大值点对应的灰度值置为0，这样可以提出以大部分非边缘点 [ 13 ]。4) 用双阈值算法检测和连接边缘。在第3步之后，所得结果中仍然有很多假边缘和噪声等干扰，需要进一步处理。此处设定的两个阈值不同，对检测的边缘会造成很大影响。 本系统目的为测量内外径和壁厚，因此内外径边缘的完整检测至关重要。经过实验发现，双阈值选取50和150时可以检测到内外径完整边缘。图9为Canny算法边缘检测效果图。 图9. Canny算法边缘检测结果  在对图像进行Canny算法边缘检测后，可以提取到内外径的完整边缘，由于检测环境的复杂，胶管周身会产生各种干扰，直接体现在边缘图像中，如何快速准确的提取出想要的边缘(内外径)变得至关重要。 本系统分两步提取内外径边缘：1) 将各个边缘做标记。通过将边缘标号，可以方便后续对边缘的提取操作，减少不必要的工作。2) 通过比较预估值和检测值提取边缘。首先预估胶管尺寸，将检测到的边缘按标号和预估值进行比较，设定阈值，完成对边缘的提取。图10为最终提取到的边缘图像。图11为测量内外径和壁厚的处理图。 图10. 内外径边缘提取图 图11. 测量图像"
"软件界面设计如图12所示，在图像处理模块中，可以选择自动处理功能，当获取到图像时，系统自动进行图像处理，处理后的图像可以显示在显示区域，测量结果模块会实时显示出胶管尺寸，包括内外圆直径、最大壁厚和最小壁厚。选取了一种型号的胶管，外径约为34.95 mm，选取50个胶管样本使用本系统进行检测，检测结果如图13、图14。 图12. 界面显示 图13. 约定真值和测量值对比 图14. 误差绝对值 根据约定真值和测量值的对比曲线图和误差绝对值曲线图可知，21号胶管样本的测量误差绝对值为0.08 mm以上，超过了标准值0.07 mm，其他样本的测量值都在标准范围内，满足工业检测的需求。"
"设计了一套基于机器视觉的胶管自动检测系统，在非接触的情况下可以准确测量汽车胶管的尺寸信息，从而完成对胶管的分类工作，大大节省了人力、成本。检测结果表明，检测准确率在98%以上，单个检测用时0.09 s，基本满足实时性需求，实际应用价值较大。"
