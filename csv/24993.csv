"系统主要通过研究基于电子海图、移动互联网以及大数据模式下的小型船舶智能移动导航终端来解决小型船舶使用电子海图、船舶导航以及船舶避碰等问题。文章简述了小型船舶智能移动导航系统在电子海图上叠加多元异构数据以及云服务存储等方面的技术运用以及两种电子海图的显示方式：瓦片图切片和矢量电子海图解析。并介绍了小型船舶智能移动导航系统应具备的功能。最后介绍了该系统开发的过程和应用案例。 关键词 :电子海图，导航，移动终端，云计算，大数据 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"电子海图信息显示系统以及电子海图系统(ECDIS/ECS)是近十几年来航海领域出现并逐渐成熟的一项新技术，它适应了海运船舶驾驶实践的需求。但是现有的电子海图系统(ECDIS、ECS)大多采用工业计算机或普通台式计算机作为平台，具有体积大、造价高、维护难的特点。我国沿海渔船、小型运输船舶众多，渔船将近100万艘，小型运输船舶超过10万艘。由于成本和船员素质等原因，我国沿海大部分小型运输船舶和渔船还未能够使用中国海事局电子海图进行船舶定位和导航，也没有有效电子手段接收中国海事局发布的航海通告、航行安全警告等信息。 因此，本文针对上述需求，研发了小型船舶智能移动导航系统，该系统借助于云计算平台、Web云端和智能手机云端，综合集成各类助导航信息及航海保障信息并进行发布，用户只需要有一个网络浏览器或移动终端(如智能手机、掌上电脑)应用软件，以及一些基本的硬件设备，就能获取最新的电子海图数据和各类服务功能，且不存在电子海图数据更新的问题。该系统已经得到广泛使用，用户反映较好。本文从系统设计、功能构成和用户使用等方面，做了概要阐述。"
"以满足业务信息化应用上的需求为基本前提，本着长远规划，合理布局，优化结构的思路，实现平台研发的可持续发展。根据项目需求，整个应用软件总体架构可以概括为“五级层次，四大体系”。本系统采用面向对象模式设计，各功能子模块以对象形式实现相互调用，对本系统的所有功能进行集成，形成一个整体的系统进行安装部署。系统总体架构如图1所示。 基础设施层：通过对硬件设备、基础系统软件的集成，为各模式业务系统及本系统提供统一、稳定的运行环境。基础运行环境包括机房环境、网络设备、安全设备、服务器、存储设备、高性能计算机、操作系统、数据库、文件系统、应用中间件等内容。 基础软件层：后台技术框架采用J2EE架构，为系统的可伸缩性、灵活性、易维护性提供了良好的机 图1. 整体技术架构图 制。Web服务器采用tomcat + nginx平台技术，高效处理异构数据资源。缓存处理方案为成熟的Redis技术，支持系统工作负载的数据吞吐量与延迟状况的实时优化。大数据处理分发平台基于Hadoop + Spark技术研发，并根据业务深度优化。 数据资源层：通过对数据资源的统一规划，实现资源的集中存储、数据共享。数据资源层存储本项目产生的结构化数据和非结构化数据，主要包括关系型数据库和文件系统。 技术支撑层：借助自动更新、任务调度、数据存取、接口通讯协议等底层技术保证前后端的信息衔接；借助业务产品加工处理、WEBGIS、SVG矢量化图形、HTML5、WEBGL、OSGEarth、Chart图形图表展现和Node.js信息推送等关键技术，保证了前端展示合理、交互友好。 平台应用层：系统主要通过Web页面为用户的使用提供支持，主要包括直接用户和最终用户使用操作的各类界面。各用户界面需要提供友好操作方式，为用户提供应用支撑。本项目的最终系统用户，分别为运维管理用户、服务用户(或称操作人员)，服务用户又分为模式用户(研发和业务运行)和科研用户。  小型船舶智能移动导航系统计划采用Hadoop和Spark [ 1 ] 计算框架构建一种高效的、强可扩展性的大数据安全分析检测平台，实现海图数据、海缆数据、气象水文数据、通航信息等海量异构数据的整体优化整合，使用离线模型生成与在线检测相结合的方式对异构网络数据进行分析，在海量数据流环境中实现实时安全分析检测 [ 2 ] 。基于Hadoop和Spark的大数据安全分析平台具有优秀的可扩展性及高效处理能力，能够满足安全大数据的分析与检测要求(图2)。 分布式存储： 首先，在对文件的物理存储方面，云计算框架中与一般的操作系统中有不同的处理。传统的操作系统中传统的windows或Linux操作系统下，文件都是本分成了小块(block)进行存储，例如windows操作系统下，每一块的文件大小是8 K字节。然而在云计算中，文件的分块将比传统的文件分块空间大，这 图2. 部署设计 是为了便于处理较大数据时，获得较高的效率。本项目的后续研究中，适合用这种方法处理移动端航行数据。例如当存储某一个移动端的历史轨迹时，将该移动端的历史轨迹数据都存放在同一个较大的数据块中，这样在查询数据和读写数据时能较快获得结果。 其次，在文件的读写方面，也存在着显著的差异。传统的操作系统中对文件的读写设计了连续读写和随机读写两种方式，由于文件被分块存储，则随机写的效率低于顺序写的效率。然而在云计算框架中，有很多数据往往只写入一次，但却有多次的读取操作，所以在云计算中，文件写入被设计成顺序写入方式，这种写入数据的效率远高于随机写的方式。结合本项目的研究，要设计移动端航行数据的存储系统，该系统的特征之一就是连续不断的写入航行数据，而写入数据后基本不对这些数据进行进一步的修改，其后的操作基本是对移动端航行数据的读取，因此用这种数据读写方式非常快捷。 最后，文件被分布在计算集群里的计算机上，而不是集中在某一台计算机上。云计算需要众多的计算机协同配合，因此数据文件不是存储在某一台计算机上，而是散列在集群里的计算机上。并且为了防止集群中某些计算机出现故障而影响到集群的工作状态，在散列分布这些数据文件时，还设计了备份机制，即一份文件在多台不同计算机上有相同的拷贝而不是在一台计算机的不同硬盘上有相同的多份拷贝(RAID模式)。这样，在读取数据文件时，可由集群中不同的计算机分别读取分布在散列在本计算上的文件块，读取效率也大大提高。并且在这种模式下，往集群中添加新的计算机，不仅能扩大集群的存储容量，还可以提升集群的计算能力和容载能力。"
"小型船舶智能移动导航系统必须能够满足最基本的电子海图显示以及信息支持能力，并且利用移动终端的网络能力，实时接收各类辅助信息并进行数据叠加。通过智能手机以及云计算的运算能力，实现智能避碰、航线设计与推荐，智能导航等功能，图3为该系统的技术流程图。 图3. 技术流程图  小型船舶智能移动导航系统最基本的功能是电子海图的显示，目前互联网地图常使用的地图显示模式是瓦片图形式，而主流的电子海图信息显示系统采用的是矢量模式。 1) 电子海图瓦片图模式的建设 电子航行瓦片生成工具的建设需要完成电子海图瓦片切片系统以及离线包制作等功能建设。在获得最新的电子海图数据后，系统支持前端应用系统提交查询航行水域经纬度范围信息，实时查询电子海图数据库，根据S-52标准快速绘制生成航行示意图瓦片并返回。业务流程如图4所示。 必须考虑到该系统用户在远海航行时移动终端丢失信息的情况。由于海图资源是通过网络向服务器请求获得，当移动网络在海上失效的情况下就无法从服务器获取海图资源。为了使本系统用户能够在没有网络的情况下仍然可以使用系统进行定位，需要开发切片的离线包。电子航行示意图离线包制作工具根据主要功能可以分为两个模块，分别是自定义下载模块和预定义下载模块。 自定义下载模块和预定义下载模块工作流程图5、图6所示。 2) 矢量电子海图模式建设 电子海图数据采用国际标准(S57)封装，该标准提供了一种在不同的计算机系统间传输数据记录及说明的方法。将电子海图数据解析后，数据中的点线面三种物标类型和相应的空间坐标解析形成内部数据格式，相比瓦片图形式可极大地提高电子海图的显示效率。之后将内部数据按图幅存储到终端的存储卡 图4. 快速生成电子海图瓦片业务流程图 图5. 自定义下载模块流程图 上，根据比例尺形成图幅索引便于海图的显示检索。一个海图文件由一个或多个逻辑记录组成，每个逻辑记录由头标区、目次区、字段区构成。首记录为数据描述记录，其后的各个记录为数据记录。 电子海图解析后为了方便一次解析多次使用，可以将解析后数据形成内部格式数据，并根据文件名、比例尺、图框范围等要素存储起来形成海图数据库，需要时可以直接检索读取显示，这大大节省了海图的显示预处理时间。 为了显示海图中的物标以及船舶定位信息，需要将数据中的地理坐标转换为移动设备上的屏幕坐标， 图6. 预定义下载模块工作流程图 而在进行海图漫游、缩小放大等操作时，又必须将操作的屏幕坐标点变换为对应的地理坐标。屏幕坐标与地理坐标之间的转换对于电子海图的显示和操作至关重要。数据的空间位置采用的是世界地理坐标系统。在显示海图时，由于显示器的平面特性，必须以某种地图投影的方式把地图椭球面表现在平面上才能进行正常的显示及航海作业。所以，要求电子海图也采用与纸质海图相同的地图投影方式。  小型船舶移动智能终端利用网络云服务以及大数据的接入来实现系统的智能化，因此网络信号也应作为系统的建设功能之一。 移动网络通讯信号理论上最远只能达到30海里。但是目前利用4G宽带通信技术通过网内船舶作为中间节点，实现多层信号跃迁，将岸基信号最远扩散至80~100海里，形成船舶间的立体移动通信网络。在这个区域内，可以覆盖80%的沿海航行船舶。  小型船舶智能移动导航系统的船舶避碰功能，可以借助于移动终端的定位功能以及网络AIS信号，获取船舶本身的位置以及附近其他船舶的相对位置，并利用航海相关的避碰模型进行计算，将危险情况提前告知驾驶者，起到提醒和规避船舶碰撞的功能。实现船舶避碰，需要实现船舶安全半径、船艏扇形区域计算、船舶定位、船舶信息获取等功能。  安全半径是智能避碰的基础，系统将会针对进入安全半径的船舶进行位置计算，并判断其中可能对本船造成危险的船只。安全半径为两圈，内圈是报警圈，按照小型船舶的船型大小，一般设置为3海里，监视圈内船舶并对可能发生的碰撞进行报警；外圈是预警圈，半径为5海里，监视圈内船舶，但不进行报警。视不同航行模式作适当调整。 当安全半径内无船舶时，避碰提醒指示为安全，安全圈为绿色； 当安全半径内有船舶时，避碰提醒指示为注意，安全圈变为橙色，并发出提醒声音； 当安全半径内有高风险船舶时(通过相对速度等因子综合判定)，避碰提醒指示为危险，安全圈变为红色，并发出警报声音。  船艏扇形导航区域的目的是识别在船艏前方最具有危险性的船舶。扇形导航区域是指船首左侧30°至船首右侧30˚的60˚扇形区域内(扇形半径为1.5海里)，如有船舶，则变色提醒，同时避碰指示变色，在海图上重点标识该船舶，发出相应警报声音。  系统只通过平台GPS实现定位，其余船只通过AIS或北斗定位。  系统应可以通过AIS网络信号等途径，获取船舶的具体信息。包括：船旗国、MMSI、呼号、IMO类型、位置经纬度、长/宽/吃水等信息。以方便沟通与交流。  小型船舶移动智能导航系统需要特别考虑到针对小型化船舶人员配备不齐的情况，在驾驶室或船台缺乏足够人员保持警戒的情况下，如能提供智能语音提醒，导航全程智能语音提醒，则能增加安全保障。 船舶前方有碍航物时提示碍航物信息，有灾情时提示灾情信息，并同时给出航行建议。智能提醒可结合智能穿戴设备，结合智能避碰功能，提供更多安全保障。例如，渔船晚间抛锚后，值班人员打瞌睡时发生险情，智能提醒功能可以提供声音提醒，如果配合智能穿戴设备，即使在船舱中也可以提供智能提醒功能。  小型船舶的导航功能是本系统建设重点之一。由于大型船舶有详细的航线设计及规划，而沿海小型船舶的航行计划性较弱，而气象、海况则对小型船舶的影响更大，所以小型船舶移动智能导航系统的辅助导航功能应考虑针对这些船舶的导航及优化。 首先应利用电子海图的优势和矢量化数据以及及时的数据更新能力，提供使用者及时的海图保障。在此基础上，航线设计应能实现普通的ECDIS航线设计的基本功能，即设计转向点并绘制航线，之后自动进行航线检查功能，在航线途中有碍航物时提示碍航物信息。但是利用移动终端的数据获取能力，智能导航系统的航线设计有更大的扩展可能：有灾情时提示灾情信息；给出航行建议；船舶航行前提醒航行途中的气象信息(包括风、浪、天气、能见度等)、洋流(流向、流速)、潮汐、海事信息(航警)等。 利用移动终端和移动网络的便捷性以及移动设备的计算能力，智能导航系统可以轻易将电子海图、气象数据结合，形成简易的气象导航能力，利用目前渔业部门提供的信息，可以提供渔船渔区导航能力，利用潮汐等信息，可以提供船舶回港提示功能。其他例如：提供航线绘制、测量工具、航线推荐、一键回港、一键渔区等功能。提供港口选择、我的位置、收藏的点、地图选点等多种选点方案，满足各类需求。  海上救助的关键是时间，黄金救援时间非常短，例如冬季人员在5摄氏度的水中，只能存活1一个小时。移动智能导航设备的优势则是平台易于搭建，利用成熟的移动终端设备例如手机，很容易打造综合性救援网络体系。 求助船舶利用智能导航系统或AIS信号发出求救后，只要安装有本系统的手机都可以接收到信号。一键求助应支持快速发送救援信息，多渠道高覆盖接收者：可一键拨打救助中心电话、可通知周边船舶协助、可通知政府管理人员(综合管理云平台提醒) (图7)。 以云服务平台为基础，开发基于AIS-MOB的警告功能，实现对落水人员的位置提醒，增强海E行云服务平台的功能性、拓展其服务领域 [ 3 ] 。"
"2013年，交通运输部东海航海保障中心开始了小型船舶移动智能导航系统的建设，2014年成功开发了基于电子海图瓦片图的后台管理系统以及移动端APP系统，并命名为“海E行”。2017年，东海航海保障中心成功将“海E行”升级为基于矢量电子海图的系统。  2017年5月16日，海事局舟山空巡总队成功安装海E行及AISWIFI设备，实现了海E行首次运用与空中巡逻飞机的创举(图8)。 2017年7月，吴淞海事局使用海E行+及AIS WIFI设备，并成功安装与两条执法巡逻船，成功运用 图7. 基于AIS MOB人员落水信息推送 图8. 空巡总队飞机使用海E行及AIS WIFI 与海事巡逻船执法之中。同月，崇明海事局三条巡逻船成功安装海E行+及AIS WIFI设备，进一步提升了海E行+及AIS WIFI的使用区域和范围。2017年8月，黄浦海事局以及杨浦海事局各两条巡逻船也安装了海E行+及AIS WIFI设备，并取得了一致的好评。"
"随着电子海图显示与信息系统应用的推广和深入，用户对电子海图系统的功能、应用形式不断提出新的要求。国际航标协会IALA提出的E-Navigation战略 [ 4 ] ，要求船舶的导航系统能够综合性的显示海事信息，以增强船舶从泊位到泊位的全程航行、海上服务、安全和安保能力，更好的保护海洋环境，提高航行安全和效率。交通运输部海事局也提出以感知船舶为核心理念构建“智慧海事”。小型船舶智能移动导航系统的开发为广大海上低配船舶和涉海岸基用户提供免费的、基于互联网的、支持Web和APP双重应用的电子海图定位、导航、航线设计的应用服务，不仅适应新时代下的船舶导航应用需求，而且展现了科技信息化对海事科学发展的支撑和引领作用，为公众提供了便捷、实时的信息服务。"
