"本文针对智能电网能量规划在多目标多约束条件下的优化问题，利用粒子群算法(PSO)对风光储(风电、光伏、储能)微电网系统进行能量优化调度。建立了各个分布式发电单元的典型能量优化数学模型，仿真算例说明，通过优化调度实现微电网中动态资源优化配置是可行的，满足限制条件的前提下可使得微电网资源利用经济效益最大化，有效提升微电网运行的可靠性和经济性。 关键词 :粒子群，微电网，能量优化调度 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"近年来，受制于资源环境影响，风能、光能等新能源研究和利用取得了较大进展，微电网作为可再生能源接入电网的有效途径 [ 1 ] ，由多种分布式电源、储能装置、负荷、监控和保护装置等构成。其中分布式新能源的不确定性和随机性对传统系统稳定运行构成极大影响，为保证系统的稳定，储能单元作为可调度的优化变量可以进行有效的缓冲、改善电网特性。如何根据负荷需求，通过优化利用储能单元及与大电网合理交换功率，使得系统运行成本经济效益最大化是微电网优化运行亟待解决的问题。 目前国内外针对微电网能量管理优化调度均已开展广泛研究。文献 [ 2 ] 通过分布式多代理协调控制系统实现微电网独立运行时各储能装置的能量动态平衡。文献 [ 3 ] 提出微电网多目标能量管理模型，通过改进蚁群算法进行求解实现能量优化管理；文献 [ 4 ] 制定多个微电网的调度策略并比较，寻找最优方案，但没有考虑蓄电池的重置费用；文献 [ 5 ] 基于机会约束规划理论，首先模拟了可再生能源输出功率、负荷需求，随后模拟故障停运等不确定因素，最后利用结合蒙特卡罗模拟的遗传算法解决了微电网系统经济调度。可见能量平衡作为经济调度的核心环节，未来仍有广阔的发展前景。 本文从经济效益最大化的角度出发，基于粒子群算法建立了微电网优化调度模型，搭建了微电网能量管理系统。实时监测各分布式电源的工作状态合理分配微电网内储能容量及与大电网交换功率，统筹考虑蓄电池储能单元的重置费用，优化微电网运行成本，使得综合效益实现最优。"
"如图1所示为美国CERTS研究机构提出的微电网结构图，本文以此为例针对光伏发电单元、风力发电单元，储能发电单元及负荷组成的微电网调度问题进行了探索。微电网中的光伏发电、风力发电等分布式发电单元的功率输出均随环境的变化而变化，往往会导致输出功率不断波动，会时常出现发电量大于负载需求量或小于负载需求量的情况，且不能实时跟踪负载需求的变化。因此，储能单元不仅是微网电能质量保证的手段，而且对于实现微电网能量管理平衡必不可少。当发电单元所发电量除满足负荷需求外还有超额，电能可存储到储能装置或者卖给大电网取得收益；当发电单元所发电量无法满足电力负载需求时，储能装置可释放其能量，或从大电网买电来保证微电网的正常运行。  1) 光伏电池 图1. 分布式含储能微电网结构图 光伏电池的输出功率由于受到光照辐射强度、温度、天气等多因素影响，具有强烈的非线性。光伏阵列输出功率计算公式如下所示： P P V ( t ) = P s t c G ( t ) G s t c ( 1 + k ( T ( t ) − T s t c ) ) (1-1) 式中， P P V ( t ) 为光伏电池在光强 G ( t ) 下的输出功率；设标准测试条件是1000 W/m 2 、25℃， G s t c 、 T s t c 、 P s t c 分别是在该条件下的光强、温度和最大输出功率；k是温度系数； 2) 风力发电机 由图2可知，风能经过轮机之后，机械能通过发电机转化为电能。其功率输出模型如下所示： P W T = { 0 , v < v i k 2 v 2 + k 1 v + k 0 , v i ≤ v < v r P r , v r ≤ v < v o 0 , v > v o (1-2) 式中， k 0 、 k 1 、 k 2 是发电机功率特性曲线相关参数； v i 、 v r 、 v o 、 P r 分别是风力发电机的切入风速、额定风速、切出风速和额定功率。 3) 储能蓄电池模型 设 E S max 为蓄电池的最大储能容量，kWh； P c h max 和 P d e c h max 分别为蓄电池最大充电和放电功率，kW。假 图2. 风力发电机组出力计算流程图 设 P s ( t ) 表示蓄电池在 t 时段的充放电功率，则 P S ( t ) = E S ( t ) − E S ( t − 1 ) , t = 1 , 2 , ⋯ , T (1-3) 上式中，当 P s ( t ) > 0 时，蓄电池处于放电状态，且 P S ( t ) / η D ≤ P d e c h max ；当 P s ( t ) < 0 时，蓄电池处于充电状态，且 − η C P S ( t ) ≤ P c h max 。也即： E S min − E S ( 0 ) ≤ ∑ k = 1 t P S ( k ) ≤ E S max − E S ( 0 ) (1-4) 其中， t 在 1 , 2 , ⋯ , T 中任意取值。 为了优化微电网的能量管理，储能单元蓄电池在每个调度周期满足表达式为： E S ( 0 ) = E S ( T ) ，可以表示为： 1 η D ∑ P ( t ) > 0 , t = 1 T P S ( t ) + η C ∑ P ( t ) < 0 , t = 1 T P S ( t ) = 0 (1-5)"
"从经济调度最优的角度考虑 [ 6 ] ，以微网运行成本最低为目标函数(1)。假设在单位时间 Δ t 内分布式发电单元发电功率恒定，负载需求恒定，微电网与主电网交换功率恒定且交互电价维持恒定。本文的 Δ t 取1h。本文研究的微网为风光储系统，成本主要由可再生发电单元运行的维护成本、与大电网间电价交易的成本和蓄电池的重置成本构成，即： min F 1 = ∑ i = 1 24 [ K O M × P p v − i + K O M × P W T − i ] + ∑ i = 1 24 ( F b u y − F s e l l ) + F b a t (2-1) F b u y = f P b u y − i (2-2) F s e l l = h P s e l l − i (2-3) F b a t = S q n (2-4) 式中， min F 1 是系统运行的最低成本； K O M 是可再生发电单元的运行维护系数，参考文献 [ 7 ] 可得光伏电池的运行维护费0.0095元/kWh，风力发电机的运行维护费0.0296元/kWh； P P V − i 为第i小时光伏电池的有功出力； P W T − i 为第i小时风力发电机的有功出力； F b u y − i 为第i小时向大电网购买的电价； F s e l l 为第i小时电网的售电价格； f 为购买电价的系数； h 为卖电系数； P b u y − i 为第i小时微网向大电网购买的功率； P s e l l − i 为第i小时微网向大电网售出的功率； F b a t 为重置蓄电池所需费用，计算表达式见式(2-4)， S 为蓄电池的购买费用， q 为一天内全充放次数， n 为蓄电池寿命内全充放的次数。由运行成本函数(2-1)分析，可再生发电单元(光伏、风机)作为不可调度单元，通过统计其发电功率再经过计算得到的运行维护成本为定值，故要想得到目标函数(1)微网的最低运行成本，必须合理分配调度储能单元(即蓄电池)的发电功率及微网与大电网间的交换功率，从而达到经济效益最大化。 从用户侧考虑，以用户停电损失费用为目标函数(2)，一定程度可以反映微电网供电能力的稳定性和持续性。 min F 2 = C L × T (2-5) 式中 min F 2 为用户停电总的损失费用， C L 为单位时间段用户停电的损失费用，根据参考文献 [ 8 ] 统计不同用户类型单位时长的停电损失得到综合条件下损失费为3.85元/kWh， T 为停电的时间长度。 综合效益可以由两个目标函数按照权重进行合理分配，因为停电几率小，故可取 w 1 = 0.95 ,   w 2 = 0.05 。目标函数也即适应度函数可用下式表示： min F = w 1 F 1 + w 2 F 2 (2-6)  约束条件主要包括电功率平衡约束、发电单元发电量约束、蓄电池荷电状态约束、微电网与大电网传输容量约束等。 1) 电功率平衡约束： ∑ i = 1 N P g e n , i + P b u y ( t ) − P s e l l ( t ) = P l o a d (2-7) 式中， P g e n , i 为任意时段内发电单元(光伏、风机及储能)的发电功率； P l o a d 为负载所需功率。 2) 发电单元的发电量约束 微电网中各个分布式发电单元必须满足其自身的发电出力约束，这样才能稳定可靠运行。发电出力约束可以表示为： P D G i min ≤ P D G i ≤ P D G i max ,     ( i = 1 , 2 , ⋯ , N ) (2-8) 式中， P D G i min 、 P D G i max 分别是第i个发电单元的最小、最大发电出力。 3) 蓄电池荷电状态约束 蓄电池储能单元运行约束表示如下： P S min ≤ P S ≤ P S max (2-9) E s min < E s ( t ) < E s max (2-10) S O C i + 1 = S O C i + P S − i E s max (2-11) 式中， P s max 、 P s min 分别是蓄电池的最大、最小充放电功率； E s max 为蓄电池的最大储能容量，kWh；如果蓄电池工作在全放电状态会缩短其使用寿命，故蓄电池储存能量应有最低限值 E s min 。 E s ( t ) 是蓄电池在 t 时段储存的能量。 S O C i + 1 和 S O C i 分别为相邻时刻蓄电池荷电状态。 4) 微电网与大电网传输容量约束 P L i n e min ≤ P L i n e ≤ P L i n e max (2-12) 式中， P l i v e max 和 P l i v e min 分别是微电网与大电网交互功率的上下限值。  在满足约束条件下，优先使用新能源出力，保证最大功率输出。1) 当微电源的有功出力超过负载的需求时，多余能量峰时上网优先，谷时蓄电池蓄电优先；2) 欠缺能量峰时蓄电池蓄电优先补充，谷时上网购买；3) 考虑到蓄电池重置成本，尽量减少电池的充放电次数。一旦进入充电状态，尽可能保证蓄电池一直达到SOC的上限。一旦进入放电状态，尽可能保证蓄电池放电至SOC的下限。"
"微电网能量的优化配置是一个含有多个约束条件的优化问题，本文以蓄电池作为储能设备，提出基于改进粒子群算法(PSO) [ 9 ] [ 10 ] 的资源优化配置的模型。粒子群算法是基于群体的优化技术，通过一组初始化的群体在搜索空间并行搜索，通过不断的迭代过程，最终搜寻到最优解。假设粒子群中粒子个数为 N ，每个粒子在时刻 t 时的K维空间坐标和速度分别表示为 x i ¯ ( t ) = ( x i 1 , x i 2 , ⋯ , x i d , ⋯ , x i D ) 和 v i ¯ ( t ) = ( v i 1 , v i 2 , ⋯ , v i d , ⋯ , x i D ) 。在 t + 1 时刻，坐标位置 x i ¯ ( t ) 和速度 v i ¯ ( t ) ，粒子通过公式(3-1)和(3-2)更新位置和速度找到最优解。 v i ¯ ( t + 1 ) = v i ¯ ( t ) + c 1 ⋅ r 1 ( p i ¯ ( t ) − x i ¯ ( t ) ) + c 2 ⋅ r 2 ( p g ¯ ( t ) − x i ¯ ( t ) ) (3-1) x i ¯ ( t + 1 ) = x i ¯ ( t ) + v i ¯ ( t + 1 ) (3-2) { v i d = v max ,           if   v i d > v max v i d = − v max ,       if   v i d < − v max (3-3) c 1 和 c 2 分别表示粒子学习因子； r 1 和 r 2 在 [ 0 , 1 ] 间均匀取值。公式(3-3)用来保证粒子的速度在规定范围内。为进一步提高算法性能，本文引入惯性权值 w ，这里将更新方程进一步修改为： v i k n = w v i k n + c 1 r a n d ( p b e s t i k n − x i k n ) + c 2 r a n d ( g b e s t i k n − x i k n ) (3-4) x i k n + 1 = x i k n + v i k n (3-5) (3-6) n为进化代数， c 1 , c 2 为学习因子，rand为[0, 1]之间随机数， x i k n 为粒子i在n次迭代上K维的位置。 p b e s t 、 g b e s t 分别为到第k代为止第i个粒子的个体最优解和全局最优解；算法步骤如下： 步骤一：数据初始化：根据经验设置种群规模为20、迭代次数300、学习因子、粒子速度(即电池荷电状态SOC)的上下限、粒子速度(即荷电状态)的初始值。输入量为光伏发电单元、风力发电单元的发电功率和负载负荷的需求功率； 步骤二：算法初始化：随机产生符合条件的粒子，根据式(2-11)求出蓄电池输出功率 P S − i ，根据式(2-7)求出交换功率 P b u y − i 和 P s e l l − i ，并且求适应度 f i t n e s s (即目标函数)； 步骤三：在满足蓄电池每次充放电可以完全、且荷电状态不超过上下限时，粒子速度与位置更新。 步骤四：迭代到300次，求该粒子群最佳适应度 f i t n e s s b e s t ，此时目标函数取得最小值，并找到最优粒子速度 z b e s t ( SOC ) (荷电状态SOC)，求出最优状态下的蓄电池的输出功率以及交换功率(调度量)。若迭代次数小于300则重复进行步骤三和四。 本文中微电网能量优化调度的算法流程如图3所示。"
"本文以某微电网为分析算例，采用粒子群多目标优化算法对上文提到的容量优化分配的有效性加以 图3. 微电网能量优化调度算法流程图 验证。将一天24小时的日光照、温度、风速等实测数据输入1.2节中所述的光伏发电模型和风力发电模型，计算得到光伏发电机输出功率和风力发电机输出功率数值见表1，并根据统计的负荷需求功率数据预测负荷需求功率，将不可控的新能源发电单元发电功率及负荷需求功率绘制功率图如图4所示。 f 为微电网向大电网购买电价的系数,具体参数见表2； h 为微电网向大电网的卖电系数，本文取1.4元/kWh。 通过粒子群算法进行Matlab仿真，综合考虑不同时段的电价系数，以成本最低为目的，经过优化调度，合理分配可调度单元(即储能容量及交换功率输出量)见表3和图5所示。为便于分析，本文将负荷需求功率与新能源发电单元的发电功率作差，得到可调度总功率如图6所示，也就是储能单元及微网与大电网间的交互功率之和。当负荷需求功率大于风光发电功率时取值为正，当负荷需求功率小于风光发电功率时取值为负。为节约蓄电池的重置成本，尽可能减少蓄电池的充放电次数，蓄电池的SOC荷电状态如图7所示，仿真结果显示蓄电池一天内经历了7次完整的充放电。 由图6所示，1~4 h及第24 h可调度单元总功率值为负，此时风光发电量大于负荷需求量，5~23 h可调度单元总功率值为正，此时风光发电量不满足负荷的需求功率。举例进行分析如下：第5 h，此时可 图4. 风光发电功率和负荷需求功率预测图 图5. 蓄电池及交换功率功率输出图 图6. 可调度单元总功率柱状图 图7. 蓄电池荷电状态曲线图 Table 1 时间/h 1 2 3 4 5 6 7 8 光伏P/kW 0 0 0 0 0 90 110 170 时间/h 9 10 11 12 13 14 15 16 光伏P/kW 200 240 250 400 250 240 200 170 时间/h 17 18 19 20 21 22 23 24 光伏P/kW 110 90 0 0 0 0 0 0 时间/h 1 2 3 4 5 6 7 8 风力P/kW 600 500 475 450 125 175 425 450 时间/h 9 10 11 12 13 14 15 16 风力P/kW 400 525 725 1000 750 1000 1000 900 表1. 风光输出功率数值表 Table 2 价格系数f/(元/kwh) 峰时段 平均时段 谷时段 (9 h~11 h), (14 h~15 h), (19 h~21 h） (7 h~8 h), (12 h~14 h), (16 h~18 h) (1 h~6 h), (22 h~24 h) 1.1 0.7 0.25 表2. 购买电价系数 调度单元总功率为正，即新能源发电量不足以给微电网供电，此时需向大电网买电。大电网给负荷供电的同时也给蓄电池充满了电，由表2分析可得此第5 h时为谷时段电价，此时给蓄电池充电可以节约成本。同理，也可以分析第22 h~23 h。由表3看出，第8 h，13 h~14 h，22 h~23 h蓄电池充满电，分 Table 3 时间/h 1 2 3 4 5 6 7 8 储能P/kW 600 0 −600 600 −600 0 600 −600 时间/h 9 10 11 12 13 14 15 16 储能P/kW 0 600 600 0 −600 300 300 0 时间/h 17 18 19 20 21 22 23 24 储能P/kW 0 0 600 600 0 −600 −600 0 时间/h 1 2 3 4 5 6 7 8 交换功率P/kW −867 −200 442 −814 775 1067 1866 1345 时间/h 9 10 11 12 13 14 15 16 交换功率P/kW 2356 2568 1725 1667 −65 1202 1790 1467 时间/h 17 18 19 20 21 22 23 24 交换功率P/KW 3180 3410 3896 3130 4367 2448 617 −375 表3. 蓄电池及交换功率输出数值表 析可知因为此时买电价格相对较低。在10 h~11 h，14 h~15 h，19 h~20 h蓄电池放完电，因为此时买电价格高，满足2.3节中的能量调度策略，蓄电池在电价谷时段购电在峰时段放电。故如此分配可以经济效益最大化，同时在用电高峰期储能单元发挥作用可以尽量避免停电事故。蓄电池的充放电次数与重置费用有关，如图7所示，在蓄电池重置成本S定为100,000的约束下，蓄电池一天内充放电7次，系统运行成本最小。"
"本文通过建立微电网能量管理系统和优化模型，实时监测所有储能电池组的工作状态，基于改进粒子群算法进行多目标多约束条件下寻优，合理分配微电网内储能容量及微网大电网间交换功率，进行微电网内能量管理和优化调度。该系统有效利用了储能系统对电网之间的辅助作用，可减少新能源利用中“弃风”、“弃光”的现象发生，提高各储能电池组的利用效率，对提高新能源渗透率提供了新的解决思路。"
