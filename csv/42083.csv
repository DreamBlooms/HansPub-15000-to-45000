"清江流域7月20日以后洪量明显减小，可以根据洪水和长江中下游出梅时间的预报结果考虑提前蓄水。建立梯级水库提前蓄水多目标联合优化调度模型，以旬最小生态流量作为蓄水期下泄流量的刚性约束，并采用NSGA-II和PA-DDS优化算法求解。应用结果表明：Pareto前沿分布范围均匀且广泛，可供决策者灵活调度。与原设计方案相比，通过水库群提前蓄水联合优化调度，总蓄满率由82%增加到89%，蓄水期可增发电量4100万kW·h (+2.1%)，增加生态供水1.1亿m 3 。"
"水库在汛末期，入库流量逐渐减少，水库则需要为供水期供水及自身兴利等方面考虑，将库水位逐渐蓄至正常高水位。针对水库汛末期提前蓄水优化调度问题，我们持续开展研究并取得了一系列成果。刘心愿等 [ 1 ] 全面考虑三峡水库上下游防洪、发电、航运和蓄满率等综合要求，建立了多目标蓄水调度模型，采用“优化–模拟–检验”的算法流程，最终求解得到三峡水库优化蓄水调度图。李雨等 [ 2 ] 从风险率与风险损失率两方面建立三峡水库提前蓄水防洪风险分析模型，探讨不同提前蓄水方案对下游地区防洪安全的影响，并将其与综合效益相结合，对多组分台阶蓄水方案进行优选，推荐三峡水库从9月1日及以后起蓄。陈柯兵等 [ 3 ] 利用支持向量机预报三峡水库9月径流信息，通过聚类方法对9月来水进行分类，针对不同来水情况下三峡水库综合利用效益最大化问题，提出了基于改进调度图的汛末蓄水调度方案。周研来等 [ 4 ] 以溪洛渡–向家坝–三峡为例，实现蓄水时机与蓄水进程的协同优化，推求了可协调防洪与兴利之间矛盾的联合蓄水调度方案。何绍坤等 [ 5 ] 建立了基于防洪、发电和蓄水的多目标调度模型，采用Pareto存档动态维度搜索算法(PA-DDS)优化求解，得到一系列非劣优化蓄水方案。结果表明：在不降低原设计防洪标准前提下，乌东德、白鹤滩、溪洛渡、向家坝和三峡水库的优化起蓄水时间可分别提前至8月1日，8月1日，9月1日，9月1日和9月10日，与原设计方案相比，优化方案蓄水期年均发电量可增加36.82亿kW·h，增幅3.12%；水库蓄满率达95.09%，提高3.38%。郭生练等 [ 6 ] 以长江上游30座巨型水库群为研究对象，采用分区策略、大系统聚合分解、参数模拟优化方法和并行逐次逼近寻优算法求解。与原设计方案相比，通过水库提前蓄水联合优化调度，梯级水库总蓄满率由90.40%增加到94.42%，年均增发电量76.5亿kW·h (+3.76%)，经济社会效益显著。 清江梯级水库由于上下游蓄水时间相差不大，因此容易发生水库在汛末期集中蓄水，导致河道内水量减少、可能无法满足生态流量要求、水库无法正常蓄满等问题。因此，合理地判断和选择水库的起蓄时间以及蓄水方式，制定各水库汛末蓄水方案，对指导梯级水库科学、有序、高效蓄水具有重大的经济、社会效益。"
"以梯级上两个不受综合利用限制的年调节水电站为例，研究它们不同的蓄放水次序对发电量的影响。设上游水库为A，下游水库为B。当某一供水时段电力系统需要水电站放水来补充出力不足时，如果由上游A水库供水发电来满足系统要求，其提供的电能为： Δ E K A = F A Δ H A ( H A + H B ) η A / 367.1 (1) 如果由下游B水库供水发电满足系统要求，其提供的电能为 Δ E K B = F B Δ H B H B η B / 367.1 (2) 式中： F A 、 F B ， H A 、 H B ， Δ H A 、 Δ H B ， η A 、 η B 分别为某时段内A、B水库的存水面积，发电水头，供水消落深度和水电站的发电效率。 上游A水库发电下放的流量在下游B水电站仍可用来发电，以式(2)中的水头项是两水电站的水头之和。由于系统要求的不足出力是相同的一个值，并假设两电站的发电效率相等，即 Δ H B = F A ( H A + H B ) F B H B Δ H A (3) 由于水库发电供水使水库消落，从而影响了以后时段的发电水头，导致不蓄电能的损失。由于两水库特性不同，不蓄电能的损失是不同的。A水库的不蓄电能损失值为 Δ E b A = W b A Δ H A η A / 367.1 (4) B水库的不蓄电能损失值为 Δ E b B = ( W b A + V A + W ′ b B ) Δ H B η B / 367.1 (5) 式中： Δ E b A 、 Δ E b B 分别为A、B水库不蓄电能损失值； W b A 为A水库在面临时段以后至供水期末的不蓄水量； W ′ b B 为面临时段以后的供水期内，两电站间的区间不蓄水量； V A 为A水库蓄水量。 上级A电站的蓄水量及不蓄水量都将经过下游B电站发电，因此，式(5)括号内有三部分水量。 自计算时段至水库供水期末，按不蓄电能损失总值最小原则求梯级水库放水次序。则上游水库A先蓄水的有利条件为 W b A Δ H A > ( W b A + V A + W ′ b B ) Δ H B (6) 将式(3)代入式(6)中得 W b A F A ( H A + H B ) > W b A + W ′ b B + V A F B H B (7) 令 K A = W b A F A ( H A + H B ) ， K B = W b A + W ′ b B + V A F B H B ，上式即为梯级水库蓄水次序判别的K值判别式。上游A水库先蓄水条件为 K A > K B ；下游B水库先蓄水条件为 K B > K A ；若 K A = K B ，则两库同时蓄水。 采用清江梯级水库1951~2019年7月20日至12月31日的入库径流资料，计算时段为1 d。根据清江梯级水库蓄水调度规则，一般从主汛期末开始蓄水，9月、10月考虑秋汛的可能性，若蓄满则有弃水风险。采用原设计蓄水方式(图1)作为分析对比，起蓄时间为8月1日，蓄满时间为10月31日。梯级水库K值判别法结果如表1所示。可以看出，隔河岩水库的K值大于水布垭水库的K值，K值判别法表明隔河岩水库蓄水优先级更高。结合流域梯级水库蓄水原则，考虑原设计两库各为荆江错峰预留5亿m 3 防洪库容的特殊情况。因此，采用两水库同步蓄水方式进行蓄水调度。 Table 1 水库 10%频率来水 90%频率来水 电站 最大值 最小值 最大值 最小值 水布垭 1.47 0.13 0.24 0.06 隔河岩 5.28 0.57 0.71 0.23 表1. 清江梯级水库K值计算表  将水库的蓄水时间提前至汛末期，必须考虑汛末期的防洪安全问题。水库调度图一般设置有预想出力线、加大出力线、保证出力线和降低出力线等，将其划分为若干出力区等，这类调度图对于发电调度十分有效，但由于调洪流量一般远大于电站预想出力所对应的流量，对于洪水调度，这类调度图的作用就受到了很大的限制。本研究利用水库蓄水调度线作为调度规则，指导水库蓄水调度。蓄水调度线能明确起蓄时间和蓄水进程，通过设置汛末控制水位，满足防洪的要求，对充分发挥水库枯水期的综合利用效益，具有重要的理论价值和现实意义。水库蓄水调度线如图1所示，蓄水模型优化对象为蓄水调度线各时间点水位。 从图1可以看出，水库分期防洪控制水位和设计蓄水调度线将调度图分成了三个区域。设计蓄水调度线通常为起蓄水位到正常蓄水位的一条斜线，在设计蓄水调度线以下的III区时，水库按照满足相应要求的最小下泄流量下泄；分期防洪控制水位是水库在蓄水期不同时段，在不增加防洪风险的前提下，水位允许达到的最大值，当水库水位位于设计蓄水调度线和分期防洪控制水位之间的II区时，可分为两种情况：第一，若未发生洪水时，水库可以按照优化蓄水调度线的指示运行调度；第二，若发生洪水时，在出库流量不超出下游安全流量的前提下，控制水库水位不超过分期防洪控制水位。当水位位于分期防洪控制水位之上的I区时，若此时没有大洪水，则在出库流量不超出下游安全流量的前提下，控制水位降至分期防洪控制水位；若此时仍有大洪水，则按防洪调度要求控制水位不超过设计洪水位。"
"梯级水库联合蓄水调度模型由目标函数及约束条件组成。清江梯级水库主要功能依次为防洪、发电、生态，且不同功能目标之间可能并不一致，无法同时保证各目标都达到最优，因此，需要在各个目标函数之间进行权衡。 图1. 水库蓄水调度示意图  采用发电量最大和蓄满率最大两个目标函数，其表达式如下： 1) 梯级水库多年平均发电量最大： max E = max x ∈ X ( ∑ i = 1 M E j ) (8) 2) 梯级水库蓄满率最大： max V f = max x ∈ X ( ∑ i = 1 M α j V ( i , h i g h ) − V min , j V max , j − V min , j ) (9) 式中： E j 表示第j个水库的多年平均发电量， V ( i , h i g h ) 表示水库i第i年蓄水期末水库达到最高水位时，对应的库容； V max , j 表示水库j正常蓄水位对应的库容； V min , j 表示水库j死水位对应的库容， α j 为权重系数，可以根据水库j的兴利库容占梯级水库总兴利库容的百分比来确定。  确定模型的目标函数之后，考虑梯级水库联合蓄水调度模型的约束条件： 1) 水量平衡约束 V i , t = V i , t − 1 + ( I i , t − Q i , t ) ⋅ Δ t (10) 式中： V i , t − 1 、 V i , t 分别表示水库i在 t − 1 时段和t时段初水库的库容， I i , t 为水库i第t时段的入库流量， Q i , t 为水库i第t时段的出库流量。 2) 蓄水过程约束 V L i , t ≤ V i , t ≤ V U i , t (11) 式中： V L i , t 为水库i第t时段允许的最小蓄水量，这里取为水库i设计蓄水调度线第t时段的库容； Z U i , t 为水库i第t时段允许的最大蓄水量，这里取分期防洪控制水位在时段t时对应的库容。 3) 电站出力约束 P L i , t ≤ P i , t ≤ P U i , t (12) 式中： P L i , t 、 P U i , t 分别为水库i第t时段的保证出力和额定出力。 4) 出库流量约束 Q L i , t ≤ Q i , t ≤ Q U i , t (13) 式中： Q L i , t 、 Q U i , t 分别为水库i第t时段允许的最小下泄流量(即生态流量)和最大下泄流量。采用分旬控制的最小生态流量(见图2)作为蓄水期下泄流量约束 [ 7 ]。 图2. 清江最小旬生态流量过程  目前常用和效果最好的多目标优化算法主要有两种： 1) 非支配排序遗传算法(Non-dominated Sorting Genetic Algorithm II, NSGA-II)。该算法克服了初代NSGA算法计算复杂、效率不高的局限性，充分利用了非支配排序方法的优点，提高了算法的计算效率，使得该算法能够快速的收敛至目标解集。同时，NSGA-II算法在产生下一代时，选择将父代和子代进行合并后，再从中选取表现优秀的个体，能够最大限度地保留优良个体。NSGA-II算法还引入了精英策略，确保表现优秀的个体在自然选择的过程中不会丢失。多目标遗传算法(NSGA-II)的计算流程和步骤，详见文献 [ 8 ]。 2) PA-DDS算法。动态维度搜索(Dynamically Dimensioned Search, DDS)结合Pareto存档进化(Pareto-Archived Evolution, PAE)策略的PA-DDS算法，充分利用DDS算法的全局搜索能力，同时结合Pareto存档进化策略来加速寻优过程。PA-DDS算法在解决多目标优化问题时，效率高、收敛性强，有广阔的应用前景。PA-DDS算法的计算流程和计算步骤，参见文献 [ 9 ]。"
"由图1可知，梯级水库提前蓄水联合调度的关键在如何确定起蓄时间和分期防洪限制水位，通过抬高关键时间节点的水库水位，可以使水库蓄水期大幅度提高发电效益和汛末蓄满率。水库蓄水调度控制线的优化空间为水库分期防洪限制水位和水库设计蓄水线围成的区域。  根据1951~2020年的实测资料，分析长江中下游梅雨与清江长阳年最大洪峰流量的关系。5月25日入梅前，年最大洪峰出现了5次，占总次数的7.14%，且流量相对较小；整个梅雨期内，洪峰共出现了53次，占总次数的75.71%；出梅以后，洪峰发生的频次和量级明显减少，8月7日~8月21日出现一个空档期，9月中旬，受秋汛影响，又出现少量洪峰。 采用均值变点分期方法对清江隔河岩历年汛期的7日最大洪量序列进行分期，进一步分析长江中下游梅雨与清江汛期分期洪水的关系，如图3所示。5月初，清江进入前汛期，梅雨尚未出现；6月中上旬，长江中下游入梅，清江流域的降雨增多，洪量逐渐增大；6月20日~7月20日为清江的主汛期，洪水峰高量大，此时段恰为梅雨的中后期，中下游降雨频繁，雨量集中，雨洪易发生明显的遭遇；7月21日起，清江进入后汛期，洪量 图3. 隔河岩水库7日洪量汛期分期与长江中下游梅雨关系图 迅速减小，中下游梅雨也接近尾声，雨量不大，此时如果长江没有出现流域性的大洪水，长江上游来水主要由三峡水库等拦蓄调洪，水布垭和隔河岩水库没有必要再为荆江错峰预留10亿m 3 防洪库容，可以考虑提前蓄水。 长江中下游入梅主要发生在6月，出梅主要发生在7月，梅雨的年际变化较大。入梅和出梅的早晚决定了梅雨期的长短，入梅后，暴雨频发，降水量大，梅雨量随梅雨历时的延长而增大。清江洪水主要发生在6~7月，主汛期与长江中下游梅雨的中后期相重合。 清江流域7月20日以后洪量明显减小，根据长江中下游出梅时间和长江上游洪水的预测预报结果，可以考虑在出梅后提前蓄水，这时长江中游来水大幅度减少，长江上游来水由上游水库群和三峡水库调蓄，清江梯级水库防洪任务大大缓解。  水库分期防洪控制水位可以通过在选定的时间节点，假定水库遭遇相应设计标准的洪水时，在不增加防洪风险的前提下，水库允许的最高防洪控制水位来确定。因此，优化方案将起蓄时间提前到7月20日，蓄满时间为10月31日。设定7月20日、7月25日、7月30日、8月10日、8月20日、8月30日、9月10日、9月20日、9月30日九个时间节点。采用分期最大取样方法对各个时间节点所包含的洪水序列进行采样，采用皮尔逊III型曲线拟合各个采样序列，并通过适线法估计参数，分析计算清江梯级水库各自的千年一遇分期设计洪峰和不同时段洪量。通过同频率放大法对1998典型年后汛期的洪水过程线进行放大，并通过调洪演算得到相应的最高防洪控制水位。水布垭、隔河岩水库千年一遇后汛期设计洪水如图4所示。结合其他约束条件和实际调度经验，确定各时段相应的防洪控制水位如表2所示。"
"得到各水库蓄水优化调度过程线的优化空间后，分别采用NSGA-II算法和PA-DDS算法对梯级水库的蓄水调度控制线进行优化计算，得到在不增加防洪风险的前提下，发电量与蓄满率较优的可行方案。  图5展示了NSGA-II算法和PA-DDS算法计算得到的梯级水库联合蓄水调度方案Pareto解集。可以看出，采用NSGA-II算法和PA-DDS算法对清江梯级水库联合蓄水优化调度模型进行求解的结果较好。清江梯级水库最大蓄满率可达89%，发电量最大可达19.6亿kW·h。分析比较两种优化算法得到的Pareto解集点据的分布情况可以看出，PA-DDS算法得到的Pareto解集略优于NSGA-II算法解集，同时PA-DDS求解模型的速度更快，说明PA-DDS算法能够以更高的效率，得到较优的结果，体现了PA-DDS算法的优势。  从图5的Pareto解集中优选出保证蓄满率最大的方案A和保证发电量最大的方案B，采用A、B两种水库蓄水调度方案进行模拟调度计算，并与原设计方案的各效益指标数据进行比较，结果如表3所示，表中发电量统计时段均为7月20日至蓄满时间10月30日。 Table 2 月/日 7/20 7/25 7/30 8/10 8/20 8/30 9/10 9/20 9/30 水布垭 393.8 395.9 396.2 396.9 397.2 397.5 398.9 400 400 隔河岩 193.2 194.6 195.5 195.7 196 196.3 196.5 198.2 200 表2. 水库蓄水期各时间节点的防洪限制水位约束(m) 图4. 水布垭和隔河岩水库后汛期千年一遇分期设计洪水过程线(1998典型年) 当清江梯级水库采用原设计蓄水方案进行蓄水调度时，蓄水期多年平均发电量为19.22亿kW·h，梯级水库蓄满率为82%，年均弃水量13.81亿m³。对于梯级水库联合蓄水调度来说，提前蓄水节点，抬高关键时间节点水库水位，可以使水库蓄水期发电效益和汛末蓄满率大幅提高。采用方案A指导梯级水库蓄水调度，可以使清江梯级水库蓄满率由原设计蓄水方案的82%提高至89%；尤其是隔河岩水库的蓄满率可从80%提升至89%，蓄满率明显提高。优化方案B更加侧重梯级水库蓄水期的发电效益，相比原设计方案多年平均增发电量可达4100万kW·h，增幅为2.1%，增加生态供水1.1亿m 3 ；梯级水库蓄满率与设计蓄水方案相比也有所提高。此外，这两种优化方案并不会增加弃水风险。因此，在实际调度中建议采用蓄满率最大的优化调度方案，其蓄水关键时间节点列于表4所示。 图5. 梯级水库联合蓄水调度方案Pareto解集 Table 3 项目 水布垭 隔河岩 高坝洲 梯级 设计方案 发电量(亿kW·h) 10.02 7.30 1.90 19.22 蓄满率(%) 0.84 0.80 / 0.82 年均弃水(亿m³) 2.95 4.92 5.94 13.81 方案A 发电量(亿kW·h) 10.03 7.33 1.92 19.28 蓄满率(%) 0.88 0.89 / 0.89 年均弃水(亿m³) 2.86 4.74 5.71 13.31 方案B 发电量(亿kW·h) 10.23 7.45 1.95 19.63 蓄满率(%) 0.78 0.89 / 0.83 年均弃水(亿m³) 2.83 4.72 5.68 13.23 表3. 梯级水库不同方案模拟调度结果 Table 4 日期 水布垭 隔河岩 7月25日 392.8 194.5 7月30日 393.3 194.9 8月10日 393.9 195.6 8月20日 394.4 196.6 8月30日 395.1 197.3 9月10日 395.7 197.8 9月20日 396.6 198.6 9月30日 397.3 199.4 10月10日 398.7 199.7 10月22日 400.0 200.0 表4. 清江梯级水库建议蓄水关键节点(m)  为了更直观的展示优化方案A (蓄满率最大)和优化方案B (发电量最大)的区别，分别以来水较丰(1967年)和来水较枯(2006年)作为典型年，采用优化方案A、优化方案B进行水库模拟蓄水调度计算，得到水布垭和隔河岩水库在不同典型年下，各蓄水方案的蓄水调度过程，如图6和图7所示。 图6给出了1967年来水较丰的情况下，水布垭–隔河岩水库不同蓄水调度方案的蓄水过程线。从图中可以看出，优化方案A可以在蓄水期末期将水布垭和隔河岩水位蓄至正常高水位，而优化方案B仅能将隔河岩水库水位蓄至正常高水位。优化方案A的蓄水水位过程线始终高于优化方案B。在分期防洪限制水位的约束下，水库采用两种优化方案均未增加防洪风险。 图6. 水布垭和隔河岩水库1967年模拟调度蓄水过程 图7. 水布垭和隔河岩水库2006年模拟调度蓄水过程 由图7可知，2006年来水较枯，受最小生态流量的约束，水布垭和隔河岩水库在汛末期均无法蓄满。优化方案A (B)在蓄水期末期，水布垭水库蓄至397.7 m (396.4 m)。对于隔河岩水库来说，由于水布垭蓄水造成隔河岩入库流量更小，因此两种优化方案下均只能按照最小生态流量下泄。综上所述，优化方案A在蓄满率方面的表现要明显优于优化方案B。"
"针对清江梯级水库汛末蓄水蓄满率不高、综合效益无法充分发挥等问题，本文构建了梯级水库联合蓄水调度模型，并采用NSGA-II算法和PA-DDS算法对模型进行求解，从得到的Pareto解集中优选所需方案，再与原设计方案进行比较，主要结论如下： 1) 根据长江中下游梅雨出梅时间预报结果确定提前蓄水时机，逐步抬高清江梯级水库运行水位。与原蓄水方案相比，提前蓄水提高了梯级水库在特定时间节点的蓄水位，在保证防洪安全的前提下既提高了蓄满率，也使梯级水库蓄水期发电量有所提升。 2) 多目标智能优化算法能够较好地求解梯级水库联合蓄水调度模型，其得到的一系列Pareto解集可以为决策者在不同情景下的调度决策提供技术支撑。采取蓄满率最大方案，梯级水库蓄水期年均发电量为19.28亿kW·h，蓄满率89%；发电量最大方案，年均发电量为19.63亿kW·h，蓄满率83%；与原设计方案相比均有所提升。"
