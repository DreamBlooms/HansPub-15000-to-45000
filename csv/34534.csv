"在张量分解中，稀疏性的引入解决了实际应用中遇到的一些困难，本文简单的介绍了张量及张量CP分解的相关概念，在已有研究的基础上提出基于Lq范数( 0 < q < 1 )的稀疏张量分解问题，并使用乘子交替方向法来进行求解，以及给出 q = 1 2 时问题解的形式。 关键词 :稀疏性，张量分解，乘子交替方向法 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"张量分解可以应用于多维数据的数据压缩、可视化、探索，这使得它在神经成像、人脸识别、核磁共振成像等领域有着重要的作用。而实际应用的过程中也会遇到一些困难，如大量的数据需要占据较大的内存空间，计算复杂度较高。为了解决这样的问题，学者们提出将稀疏性引入到张量分解的问题中。 在文献 [ 1 ] 中，作者给出了稀疏性可取的原因：第一，稀疏性进一步压缩了多维数据集使得减轻了存储压力；第二，因为许多特征并不活跃，稀疏性的引入为高维张量的特征选取提供了一种自动的工具；第三，在高维张量下，数据的可视化和解释较为困难，而稀疏性限制了特征的数量从而简化了数据分析结果的可视化和解释。 稀疏性不仅具有良好的理论性质，而且在文献 [ 1 ] [ 2 ] [ 3 ] [ 4 ] 中通过数值结果表明在稀疏情况下考虑的张量分解有很好的数值性能。  为了讨论张量分解以及进一步地去讨论带有稀疏性的张量分解，我们需要简单地了解张量的符号及相关运算，文献 [ 5 ] [ 6 ] 给出了这些内容。张量作为向量和矩阵在高维空间的推广，可以容纳较大的多维数据。若张量为一阶，我们可以将其看做为向量，二阶的张量则为矩阵。三阶及三阶以上的张量成为高阶张量，我们所讨论的张量常指高阶张量。 张量常用 A , B , C , ⋯ 表示，矩阵用大写字母 A , B , C , ⋯ 表示，向量用 a , b , c , ⋯ 表示。N阶张量可以记为 A ∈ ℝ I 1 × I 2 × ⋯ × I N ， I i 是它的第i个模数， i = 1 , 2 , ⋯ , N 。它的元素表示为 A i 1 i 2 ⋯ i N ，其中 i k = 1 , 2 , ⋯ , I k ; k = 1 , 2 , ⋯ , N 。 张量可以表为若干个向量的外积，即 A = u ( 1 ) ∘ u ( 2 ) ∘ ⋯ ∘ u ( N ) 。此时，张量 A 为秩为1的张量。 张量的Frobenius范数定义为 ‖ A ‖ F = 〈 A , A 〉 = ( ∑ i 1 , ⋯ , i N A i 1 ⋯ i N 2 ) 1 2 。  CP分解是张量最为常见的分解方法之一，它将张量表为一系列秩为1的张量的和。对N阶张量 A ∈ ℝ I 1 × I 2 × ⋯ × I N ，它的CP分解可以写为 A = ∑ i = 1 r u i ( 1 ) ∘ u i ( 2 ) ∘ ⋯ ∘ u i ( N ) , 其中 r = min { R | A = ∑ i = 1 R u i ( 1 ) ∘ u i ( 2 ) ∘ ⋯ ∘ u i ( N ) } 是张量的秩。张量的CP分解保证了张量分解的唯一性。 一般将张量分解的问题转化为优化问题，于是N阶张量的CP分解问题等价于优化问题： min 1 2 ‖ A − ∑ i = 1 r u i ( 1 ) ∘ u i ( 2 ) ∘ ⋯ ∘ u i ( N ) ‖ F 2 . (1) 令 U ( 1 ) = ( u 1 ( 1 ) , u 2 ( 1 ) , ⋯ , u r (1) ) U ( 2 ) = ( u 1 ( 2 ) , u 2 ( 2 ) , ⋯ , u r (2) ) ⋯ U ( N ) = ( u 1 ( N ) , u 2 ( N ) , ⋯ , u r (N) ) 则优化问题(1)又可以写成 min 1 2 ‖ A − 〚 U ( 1 ) , U ( 2 ) , ⋯ , U ( N ) 〛 ‖ F 2 , (2) 其中 〚 U ( 1 ) , U ( 2 ) , ⋯ , U ( N ) 〛 = ∑ i = 1 r u i ( 1 ) ∘ u i ( 2 ) ∘ ⋯ ∘ u i ( N ) 。 U ( 1 ) , U ( 2 ) , ⋯ , U ( N ) 称为张量 A 的因子矩阵，也是我们在张量分解问题中要求得的解。"
"因目标张量数据过大，我们需要注意到在实际处理中遇到的问题。稀疏性的引入，可以帮我们解决如占据内存过大、不相关不活跃的数据过多而很难从中找出我们所需的特征等类似的问题。 为引入稀疏性，研究者们考虑在张量分解的优化问题中加入因子的正则范数。在已有的文献中，我们可以找到关于在优化问题中加入因子矩阵的L1范数的讨论。于是，稀疏的张量CP分解问题可以等价于 min 1 2 ‖ A − 〚 U ( 1 ) , U ( 2 ) , ⋯ , U ( N ) 〛 ‖ F 2 + ∑ i = 1 N λ i ‖ U ( i ) ‖ 1 , 其中 A ∈ ℝ I 1 × I 2 × ⋯ × I N ， U ( i ) ∈ ℝ I i × r , i = 1 , 2 , ⋯ , N 。 为计算方便，我们常以三阶张量为例，更高阶的情况同三阶张量的求解思路及方法一致。 对三阶的张量 A ∈ ℝ m × p × q ，加入因子的L1范数，它的稀疏分解问题为 min 1 2 ‖ A − ∑ i = 1 r x i ∘ y i ∘ z i ‖ F 2 + λ 1 ‖ X ‖ 1 + λ 2 ‖ Y ‖ 1 + λ 3 ‖ Z ‖ 1 , 其中 X = ( x 1 , x 2 , ⋯ , x r ) , Y = ( y 1 , y 2 , ⋯ , y r ) , Z = ( z 1 , z 2 , ⋯ , z r ) 分别为 m × r , p × r , q × r 的矩阵。 在统计学和机器学习中，Lq范数( 0 < q < 1 )中的q的取值越小，求得的解的稀疏性越好。我们用Lq范数来代替L1范数，于是得到本文所提出的基于Lq范数的稀疏张量分解。它的优化问题为 min 1 2 ‖ A − ∑ i = 1 r x i ∘ y i ∘ z i ‖ F 2 + λ 1 ‖ X ‖ q + λ 2 ‖ Y ‖ q + λ 3 ‖ Z ‖ q , 等价地，也可以为 min 1 2 ‖ A − 〚 X , Y , Z 〛 ‖ F 2 + λ 1 ‖ X ‖ q + λ 2 ‖ Y ‖ q + λ 3 ‖ Z ‖ q . (3)"
"这一节中，我们首先对乘子交替方向法进行简单的描述，随后给出问题(3)在使用乘子交替方向法的求解思路及 q = 1 2 时问题解的形式。  乘子交替方向法是一种求解优化问题的计算框架，它适用于求解大规模分布式优化问题。通过分解协调过程，将问题分解为多个局部小问题，求解出局部小问题的解从而得到原问题的解。 考虑优化问题 min f ( x ) + g (y) s .t .     x − y = 0 ; 该问题的迭代求解算法为 x k + 1 ∈ arg min L β ( x , y k , λ k ) , y k + 1 ∈ arg min L β ( x k + 1 , y , λ k ) , λ k + 1 = λ k − β ( x k + 1 − y k + 1 ) , 增广拉格朗日函数为 L β ( x , y , λ ) = f ( x ) + g ( y ) − λ T ( x − y ) + β 2 ‖ x − y ‖ 2 ， β > 0 是罚参数， λ 是拉格朗日乘子。  我们加入约束条件 X = L , Y = M , Z = N ，问题(3)变为 min 1 2 ‖ A − 〚 X , Y , Z 〛 ‖ F 2 + λ 1 ‖ L ‖ q + λ 2 ‖ M ‖ q + λ 3 ‖ N ‖ q , s .t .       X = L , Y = M , Z = N , 它的增广拉格朗日函数 L ( X , Y , Z , L , M , N , Λ 1 , Λ 2 , Λ 3 ) , = 1 2 ‖ A − 〚 X , Y , Z 〛 ‖ F 2 + λ 1 ‖ L ‖ q + λ 2 ‖ M ‖ q + λ 3 ‖ N ‖ q − 〈 Λ 1 , X − L 〉         − 〈 Λ 2 , Y − M 〉 − 〈 Λ 3 , Z − N 〉 + τ 1 2 ‖ X − L ‖ F 2 + τ 2 2 ‖ Y − M ‖ F 2 + τ 3 2 ‖ Z − N ‖ F 2 它的迭代算法为 L k + 1 = arg min τ 1 2 ‖ L − X k − 1 τ 1 Λ 1 k ‖ F 2 + λ 1 ‖ L ‖ q , X k + 1 = arg min 1 2 ‖ A − ∑ i = 1 r x i ∘ y i k ∘ z i k ‖ F 2 + τ 1 2 ‖ L k + 1 − X − 1 τ 1 Λ 1 k ‖ F 2 , M k + 1 = arg min τ 2 2 ‖ M − Y k − 1 τ 2 Λ 2 k ‖ F 2 + λ 2 ‖ M ‖ q , Y k + 1 = arg min 1 2 ‖ A − ∑ i = 1 r x i k + 1 ∘ y i ∘ z i k ‖ F 2 + τ 2 2 ‖ M k + 1 − Y − 1 τ 2 Λ 2 k ‖ F 2 , N k + 1 = arg min τ 3 2 ‖ N − Z k − 1 τ 3 Λ 3 k ‖ F 2 + λ 3 ‖ N ‖ q , Z k + 1 = arg min 1 2 ‖ A − ∑ i = 1 r x i k + 1 ∘ y i k + 1 ∘ z i ‖ F 2 + τ 3 2 ‖ N k + 1 − Z − 1 τ 3 Λ 3 k ‖ F 2 , Λ 1 k + 1 = Λ 1 k − λ 1 ( L k + 1 − X k + 1 ) , Λ 2 k + 1 = Λ 2 k − λ 2 ( M k + 1 − Y k + 1 ) , Λ 3 k + 1 = Λ 3 k − λ 3 ( N k + 1 − Z k + 1 ) ; 方法的思路是对 L , X , M , Y , N , Z , Λ 1 , Λ 2 , Λ 3 依次进行迭代，直至问题收敛。求得的矩阵 X , Y , Z 为张量的因子矩阵。 当 q = 1 2 时， L , M , N 的子优化问题具有显示解。于是，令 ，L的优化问题变为 L k + 1 = arg min τ 1 2 ‖ L − X k − 1 τ 1 Λ 1 k ‖ F 2 + λ 1 ‖ L ‖ 1 2 根据文献 [ 7 ] 中的证明，推出相应的阈值算子为 H 2 λ 1 τ 1 ( x ) = { 2 3 x ( 1 + cos ( 2 π 3 − 2 φ ( x ) 3 ) ) ,       | x | > 54 3 4 ( 2 λ 1 τ 1 ) 2 3 0 ,                                                                                           其 他 其中 φ ( x ) = arccos ( λ 1 4 τ 1 ( | x | 3 ) − 3 2 ) ，x对应矩阵 X k + 1 τ 1 Λ 1 k 的每一个元素。M和N的子问题的解可以参照L得出。 X的子优化问题 X k + 1 = arg min ‖ 1 2 A − ∑ i = 1 r x i ∘ y i k ∘ z i k ‖ F 2 + τ 1 2 ‖ L k + 1 − X − 1 τ 1 Λ 1 k ‖ F 2 (4) 的求解涉及到了张量的计算，为降低计算困难，我们可以将张量展开成矩阵的形式。张量的展开是将张量沿某一个模的展开，张量展开成的矩阵包括张量中的每一个元素，且张量沿不同的模展开得到的矩阵也不一定相同。张量按它的第一个模展开所得的矩阵记为 A ( 1 ) ，它是一个 m × p q 的矩阵，我们在X的优化问题中选用张量沿第一个模展开的矩阵来计算。问题(4)转化为 X k + 1 = arg min 1 2 ‖ A ( 1 ) − X ( Z k ⊙ Y k ) T ‖ F 2 + τ 1 2 ‖ L k + 1 − X − 1 τ 1 Λ 1 k ‖ F 2 , (5) ⊙ 表示矩阵的Khatri-Rao积，等式(5)的右边为最小二乘问题。对(5)求导， 0 = ( Z k ⊙ Y k ) T ( A ( 1 ) T − ( Z k ⊙ Y k ) X T ) − τ 1 ( L k + 1 T − X T ) − Λ 1 k T , 整理后得第k + 1步矩阵X的解 X T = ( ( Z k ⊙ Y k ) T ( Z k ⊙ Y k ) − τ 1 I ) − 1 ( ( Z k ⊙ Y k ) T A ( 1 ) T − τ 1 L k + 1 T − Λ 1 k T ) . Y , Z 的优化问题的求解过程类似，不同的是， Y , Z 的求解所用的展开矩阵分别为沿张量的第二个模和第三个模展开的矩阵。"
"具有稀疏性的张量分解因其理论性质及在应用中良好的体现，逐渐得到学者们的关注。加入因子L1范数来引入稀疏性在一些文献中得到了验证，而Lq范数( 0 < q < 1 )的情况目前还未有学者提出。本文提出了基于Lq范数的稀疏张量分解问题，同时给出了使用乘子交替方向法求解张量分解问题的思路和过程 以及 q = 1 2 时问题所具有的显式解的形式。在接下来的研究中，我们希望能够进行数据实验，和普通的张 量分解以及引入L1范数的稀疏张量分解的结果进行比较，证明基于Lq范数的分解问题的稀疏性以及它具有更好的稀疏性。"
