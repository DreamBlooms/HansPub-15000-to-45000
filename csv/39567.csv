"本文基于小波变换理论及其在图像水印算法中的应用，给出了利用量子Daubechies D (4) 小波变换分解FRQI量子图像的量子线路设计以及基于量子Daubechies D (4) 小波变换的分块量子水印算法。该算法首先将经典图像用量子图像形式表示，其次利用Daubechies D (4) 小波变换对其进行一级分解，最后将量子水印信息插入到高频段的对角小波系数中。对载体图像影响较小，同时具有较强的嵌入容量以及嵌入质量。"
"小波变换是傅里叶变换发展史上的里程碑式的进展，其优越性在于在时域和频域均具有良好的局部化性质，除了能够显示信号瞬时频率成分的特点外，还具有多分辨率的性质。目前小波变换在信号检测、图像分析、图像压缩等方面均有着十分重要的应用 [ 1 ]。 水印技术是1993年提出的一种信息融合技术，主要应用于数字图像、文本、影音等内容中，目的是为了保护产权或证明产品真实性 [ 2 ]。本文着重研究的是量子水印技术，与经典水印技术相比，量子水印仍处于初始阶段。目前，量子图像水印主要分为基于空间域和频域两种。基于空间域的水印算法是直接将水印信息嵌入到载体图像，基于频域的算法是在载体图像的频域上叠加水印信号，频域水印算法主要有量子傅里叶变换(Quantum Fourier transform, QFT)、量子余弦变换(Quantum cosine transform, QCT)和量子小波变换(Quantum wavelet transform, QWT) [ 3 ] [ 4 ] [ 5 ] [ 6 ]。 本文基于1999年，Fijany等提出的量子信号处理中的量子Daubechies D (4) 小波变换(Quantum Daubechies D (4) wavelet transform, QDWT)的线路设计 [ 7 ]，给出了利用量子Daubechies D (4) 小波变换分解FRQI量子图像相关的量子线路设计以及基于QDWT的分块量子水印算法。"
"2011年，Le等提出了灵活的量子表示方法 [ 8 ]，将位置信息和灰度信息利用量子纠缠态表示在一起，即FRQI量子图像表示法。一个的经典图像的量子表示形式为 [ 9 ] [ 10 ] [ 11 ] | I ( θ ) 〉 = 1 2 n ∑ i = 0 2 2 n − 1 | C i 〉 | i 〉 = 1 2 n ∑ i = 0 2 2 n − 1 ( cos θ i | 0 〉 + sin θ i | 1 〉 ) | i 〉 (1) θ i ∈ [ 0 , π 2 ] , i = 0 , 1 , 2 , ⋯ , 2 2 n − 1 其中 | C i 〉 = cos θ i | 0 〉 + sin θ i | 1 〉 编码的是 | i 〉 位置上的灰度信息， | 0 〉 和 | 1 〉 是二维空间的一组基，FRQI用图像中的两个变量 | Y 〉 和 | X 〉 来表示像素点的位置信息 | i 〉 ， | Y 〉 代表垂直方向， | X 〉 代表水平方向，其中 | i 〉 = | y 〉 | x 〉 = | y n − 1 y n − 2 ⋯ y 0 〉 | x n − 1 x n − 2 ⋯ x 0 〉 (2) x , y ∈ { 0 , 1 , ⋯ , 2 n − 1 } ， | y j 〉 , | x j 〉 ∈ { | 0 〉 , | 1 〉 } , j = 0 , 1 , ⋯ , n − 1  量子计算是通过量子逻辑门实现，对一个或多个量子比特进行的量子操作可以通过酉矩阵表示，这就使得量子逻辑门是可逆的 [ 12 ] [ 13 ] [ 14 ]，本文在水印图像的嵌入过程中会使用到一个非常重要的单量子比特门，矩阵形式如下： R y ( 2 φ ) = ( cos φ − sin φ sin φ cos φ ) 作用于一个单量子比特 | ψ 〉 = cos ξ | 0 〉 + sin ξ | 1 〉 = ( cos ξ sin ξ ) T 时，结果为 R y ( 2 φ ) 将 ξ 变为 ξ + φ 。 酉矩阵 R y ( 2 φ ) 对于多量子比特的受控操作如图1，其中白色和黑色圆点分别代表量子基础态 | 0 〉 和 | 1 〉 ，当量子序列与控制序列相同时 R y ( 2 φ ) 才会作用于最后一个量子比特，也就是说当量子序列为 a n − 1 a n − 2 a n − 3 ⋯ a 2 a 1 = 101 ⋯ 01 时， | a 0 〉 将会变成 R y ( 2 φ ) | a 0 〉 ，量子序列与控制序列不相同时，则对其进行单位门操作。 图1. 多量子比特控制下 R y ( 2 φ ) 的量子线路"
"3. 量子Daubechies D (4) 小波变换的线路图以及FRQI图像的分解 小波变换作为信号处理的一种多尺度结构描述，在图像处理中有着非常重要的作用。本文我们选取Daubechies D (4) 小波用于量子水印算法中的量子图像分解 [ 15 ] [ 16 ]。 量子线路设计的本质是将变换矩阵分解为一系列基本的酉矩阵，在本节中，我们将会给出量子Daubechies D (4) 小波变换的完备的量子线路以及FRQI图像的量子多尺度分解。 3.1. 量子Daubechies D (4) 小波变换的有效线路 基于正移置换矩阵 Π 2 n 以及比特逆转置换矩阵 P 2 n 两个基本置换矩阵 [ 7 ] [ 17 ]，再考虑 2 n 维的Daubechies D (4) 小波核， D 2 n ( 4 ) 的传统矩阵表示不适用于量子实现，Hoyer [ 18 ] 提出了一种 D 2 n ( 4 ) 的分解形式为 D 2 n ( 4 ) = ( I 2 n − 1 ⊗ C 1 ) S 2 n ( I 2 n − 1 ⊗ C 0 ) (3) 其中 C 0 = 2 ( c 4 − c 2 − c 2 c 4 ) ， C 1 = 1 2 ( c 0 / c 4 1 1 c 1 / c 2 ) c 0 = 1 + 3 4 2 ， c 1 = 3 + 3 4 2 ， c 2 = 3 − 3 4 2 ， c 3 = 1 − 3 4 2 其中置换矩阵 S 2 n 可以由两个置换矩阵 Q 2 n 和 R 2 n 的乘积表示： S 2 n = Q 2 n R 2 n (4) 其中 Q 2 n 是下平移置换矩阵 [ 19 ]， R 2 n 可写为 R 2 n = I 2 n − 1 ⊗ N (5) 将(4) (5)式代入(3)式中可以得到 D 2 n ( 4 ) 的新分解式如下： D 2 n ( 4 ) = ( I 2 n − 1 ⊗ C 1 ) Q 2 n ( I 2 n − 1 ⊗ N ) ( I 2 n − 1 ⊗ C 0 ) = ( I 2 n − 1 ⊗ C 1 ) Q 2 n ( I 2 n − 1 ⊗ C ′ 0 ) (6) 其中 N = ( 0 1 1 0 ) ， C ′ 0 = N C 0 = 2 ( − c 2 c 4 c 4 − c 2 ) 接下来为了进一步得到 D 2 n ( 4 ) 的分解，我们将利用正移置换矩阵 Π 2 n 对置换矩阵 Q 2 n 进行直接的递归分解： Π 2 n T Q 2 n Π 2 n = ( 0 I 2 n − 1 I 2 n − 1 0 ) ( Q 2 n − 1 0 0 I 2 n − 1 ) = ( N ⊗ I 2 n − 1 ) ( Q 2 n − 1 ⊕ I 2 n − 1 ) (7) 则根据(7)式， Q 2 n 可以表示为 Q 2 n = Π 2 n ( N ⊗ I 2 n − 1 ) ( Q 2 n − 1 ⊕ I 2 n − 1 ) Π 2 n T (8) 将 Q 2 n − 1 的分解代入上式有 Q 2 n = Π 2 n ( N ⊗ I 2 n − 1 ) ( Π 2 n − 1 ( N ⊗ I 2 n − 2 ) ( Q 2 n − 2 ⊕ I 2 n − 2 ) Π 2 n − 1 T ⊕ I 2 n − 1 ) Π 2 n T (9) 对于任意的矩阵 A ∈ R 2 n − 1 × 2 n − 1 ，存在以下恒等式 [ 7 ] Π 2 n − 1 A Π 2 n − 1 T ⊕ I 2 n − 1 = ( I 2 ⊗ Π 2 n − 1 ) ( A ⊕ I 2 n − 1 ) ( I 2 ⊗ Π 2 n − 1 T ) (10) 则(9)式可以表示为 Q 2 n = Π 2 n ( N ⊗ I 2 n − 1 ) ( I 2 ⊗ Π 2 n − 1 ) ( ( N ⊗ I 2 n − 2 ) × ( Q 2 n − 2 ⊕ I 2 n − 2 ) ⊕ I 2 n − 1 ) ( I 2 ⊗ Π 2 n − 1 T ) Π 2 n T (11) 再利用恒等式 [ 7 ] ( N ⊗ I 2 n − 2 ) ( Q 2 n − 2 ⊕ I 2 n − 2 ) ⊕ I 2 n − 1 = ( N ⊗ I 2 n − 2 ⊕ I 2 n − 1 ) ( Q 2 n − 2 ⊕ I 2 n − 2 n − 2 ) (12) (11)式可以进一步表示为 Q 2 n = Π 2 n ( N ⊗ I 2 n − 1 ) ( I 2 ⊗ Π 2 n − 1 ) ( N ⊗ I 2 n − 2 ⊕ I 2 n − 1 ) ( Q 2 n − 2 ⊕ I 2 n − 2 n − 2 ) ( I 2 ⊗ Π 2 n − 1 T ) Π 2 n T (13) 依次对 Q 2 i ，i从n-3到1，进行重复迭代， Q 2 = N ，则 Q 2 n 可迭代表示为 Q 2 n = Π 2 n ( I 2 ⊗ Π 2 n − 1 ) ( I 4 ⊗ Π 2 n − 2 ) ⋯ ( I 2 n − 2 ⊗ Π 4 ) ( N ⊗ I 2 n − 1 ) ⋯                 × ( N ⊗ I 2 ⊕ I 2 n − 4 ) ( N ⊕ I 2 n − 2 ) ( I 2 n − 2 ⊗ Π 4 T ) ⋯ ( I 2 ⊗ Π 2 n − 1 T ) Π 2 n T (14) 根据对 P 2 n 的分解，我们有 Q 2 n = P 2 n ( N ⊗ I 2 n − 1 ) ( N ⊗ I 2 n − 2 ⊕ I 2 n − 1 ) ⋯ ( N ⊗ I 2 ⊕ I 2 n − 4 ) ( N ⊕ I 2 n − 2 ) P 2 n (15) 将(15)式带入(6)式并进行整理有 D 2 n ( 4 ) = P 2 n ( C 1 ⊗ I 2 n − 1 ) ( N ⊗ I 2 n − 1 ) ( N ⊗ I 2 n − 2 ⊕ I 2 n − 2 n − 1 ) ⋯ ( N ⊗ I 2 n − i ⊕ I 2 n − 2 n − i + 1 )     × ( N ⊗ I 2 ⊕ I 2 n − 2 2 ) ( N ⊕ I 2 n − 2 ) ( C ′ 0 ⊗ I 2 n − 1 ) P 2 n (16) 通过对 Q 2 n 进行迭代分解可以得到 D 2 n ( 4 ) 的量子线路如图2： 图2. D 2 n ( 4 ) 的迭代分解量子线路  对于一个二维数字图像的db4小波分解采用标准分解，利用一维db4小波变换将图像的像素点权值转化到每一行，对行操作结束后，再对列进行相同的操作。 FRQI图像表示方法是利用量子基态编码所有的像素点信息，并且将它储存成量子叠加态。因此基于QDWT的量子变换的标准分解在量子线路的应用方面比不标准分解更加简单合适 [ 20 ]。 利用图2中的 D 2 n ( 4 ) 的n级量子线路对FRQI图像进行分解，主要分为两步： 第一步(行分解)：行分解是将 D 2 n ( 4 ) 矩阵组合作用于FRQI图像的水平方向的量子比特 | X 〉 = | x n − 1 x n − 2 ⋯ x 1 x 0 〉 上，我们将这一步的矩阵记为 D r o w ，则行分解矩阵可表示为 D r o w = I 2 ⊗ I 2 ⊗ n ⊗ D 2 n ( 4 ) (17) 第二步(列分解)：列分解是将 D 2 n ( 4 ) 矩阵组合作用于FRQI图像的垂直方向的量子比特 | Y 〉 = | y n − 1 y n − 2 ⋯ y 1 y 0 〉 上，我们将这一步的矩阵记为 D c o l u m n ，则列分解矩阵可表示为 D c o l u m n = I 2 ⊗ D 2 n ( 4 ) ⊗ I 2 ⊗ n (18) 因此，基于量子Daubechies D (4) 小波变换的FRQI图像分解对应的矩阵形式为 D = D r o w D c o l u m n = ( I 2 ⊗ I 2 ⊗ n ⊗ D 2 n ( 4 ) ) ( I 2 ⊗ D 2 n ( 4 ) ⊗ I 2 ⊗ n ) (19)"
"在本节中，将会给出将 2 n − 1 × 2 n − 1 的灰度水印图像插入到 2 n × 2 n 的灰度携带图像中的分块量子水印方案。还会给出量子水印图像的插入和提取算法以及有效线路。 4.1. 分块1级分解(Block 1 st -Level Decomposition) 基于图2中的 D 2 n ( 4 ) 的n + 2级迭代分解量子线路，FRQI图像的分块1级分解量子线路如图3所示 图3. FRQI图像的分块1级分解量子线路 如图3所示，FRQI图像的分块1级分解包括两个部分：行分解以及列分解，因此我们可以推断出分块1级分解的矩阵表达形式如下： ( I 2 ⊗ n ⊗ C ′ 0 ⊗ I 2 ⊗ n ) ( I 2 ⊗ P 2 n ⊗ I 2 ⊗ n ) × ( I 2 ⊗ 2 n ⊗ C ′ 0 ) ( I 2 ⊗ n + 1 ⊗ P 2 n ) (20) 对于分块1级分解，图像被分为四个部分，近似部分、水平细节、垂直细节以及对角细节，每一个分块都是 2 n − 1 × 2 n − 1 大小。 我们知道近似频段频率较低但是包含原始图像中的大量信息能量，细节频段频率较高，并且能够更好地表示图像的细节信息，同时与近似频段相比它具有更少的能量。特别的，水平和垂直细节比对角细节能表现更多的边缘子图像的小波系数和差异，因此，我们选取对图像重构过程影响更小的对角频段作为水印信息的插入区 [ 17 ]。  根据FRQI图像的分块1级分解，分块量子水印的嵌入步骤如图4所示： 图4. 分块量子水印的嵌入步骤 一个 2 n − 1 × 2 n − 1 大小的二进制水印图像WI是以下形式： WI = ∑ Y = 0 2 n − 1 − 1 ∑ X = 0 2 n − 1 − 1 f ( Y , X ) (21) Y = y n − 2 y n − 3 ⋯ y 1 y 0 ， X = x n − 2 x n − 3 ⋯ x 1 x 0 基于每一个点 ( Y , X ) 的权值 f ( Y , X ) ，我们可以定义一个酉矩阵 R y ( 2 φ K ) 如下 R y ( 2 φ K ) = [ cos ( φ K ) − sin ( φ K ) sin ( φ K ) cos ( φ K ) ] ， φ K = 0 ， 5 × π 2 × 255 (22) 其中 φ K = 0 ，和 φ K = 5 × π 2 × 255 ，分别代表二进制水印图像WI中的像素点信息 f ( Y , X ) = 0 和 f ( Y , X ) = 1 ，并且 K = Y X = 0 , 1 , 2 , ⋯ , 2 2 n − 2 − 1 表示水印图像WI中的像素点位置信息。分块量子水印图像的嵌入算法步骤如下： 第一步：根据图3所示，利用QDWT对量子携带图像进行分块1级分解，可以得到中间态的量子图像表示： | C B 1 〉 = ( I 2 ⊗ n ⊗ C ′ 0 ⊗ I 2 ⊗ n ) ( I 2 ⊗ P 2 n ⊗ I 2 ⊗ n ) × ( I 2 ⊗ 2 n ⊗ C ′ 0 ) ( I 2 ⊗ n + 1 ⊗ P 2 n ) | C 〉 (23) 中间量子态 | C B 1 〉 可以被分为近似部分、水平细节、垂直细节以及对角细节四个部分。 第二步：是将水印信息嵌入的关键一步，我们可以根据酉矩阵 R y ( 2 φ K ) 设计一个多量子比特的控制酉变换 U K C U K C = R y ( 2 φ K ) ⊗ | Y 〉 | X 〉 〈 X | 〈 Y | | C B 〉 = U K E | C B 1 〉 = ( ∏ K = 0 2 2 n − 2 − 1 U K C ) | C B 1 〉 (24) 其中 U K E 是由 U K C 构成，目的是作用于中间量子态 | C B 1 〉 中的对角细节信息。 | Y 〉 = | y n − 1 y n − 2 ⋯ y 1 y 0 〉 和 | X 〉 = | x n − 1 x n − 2 ⋯ x 1 x 0 〉 有最高的量子比特 | y n − 1 〉 = | 1 〉 和 | x n − 1 〉 = | 1 〉 ，中间量子态的对角细节可以通过最高量子比特 | y n − 1 〉 = | 1 〉 和 | x n − 1 〉 = | 1 〉 来筛选。因此，通过 U K E ，水印图像的像素信息被嵌入到携带图像的对角小波系数中，一方面，当水印图像的像素点权值为0 bit时，相对应的对角小波系数不改变；另一方面，当水印图像的像素点权值为1 bit时，将会通过多量子受控门 R y ( 2 φ K ) 对相关对角小波系数产生细微的改变。 第三步：含水印图像 | C W B 〉 可以通过对量子态 | C B 〉 进行逆变换得到，酉矩阵表示如下 | C W B 〉 = [ ( I 2 ⊗ 2 n ⊗ C ′ 0 ) ( I 2 ⊗ n + 1 ⊗ P 2 n ) ] ∗ [ ( I 2 ⊗ n ⊗ C ′ 0 ⊗ I 2 ⊗ n ) ( I 2 ⊗ P 2 n ⊗ I 2 ⊗ n ) ] ∗ | C B 〉 (25) 其中 [ ] ∗ 表示的是共轭转置 A ∗ = ( A ¯ ) T = A T ¯ 。 第四步：利用量子测量实现从量子叠加态图像到传统含水印图像的转换 [ 21 ]。量子测量是为了获悉系统的状态，使量子叠加态坍缩，从量子寄存器中获取到传统图像的信息 [ 22 ]。 基于上述分析，完整的分块量子水印图像嵌入量子线路第一步到第三步如图5所示。  在量子计算中，任何复杂的量子线路都可以被分解为一系列包含1、2量子比特的酉量子门 [ 13 ] [ 14 ]，在本文中，完整的量子线路的复杂度是由其中包含的基本量子门个数决定的。 图5. 分块量子水印图像嵌入量子线路 量子携带图像和量子水印图像的大小分别为 2 n × 2 n 、 2 n − 1 × 2 n − 1 ，本文的量子水印算法复杂度主要体现在图5的量子线路复杂度上，本节将会对其进行详细分析。 图5的分块量子水印图像嵌入线路可以分为三个部分：1) 利用QDWT对量子携带图像进行分块1级分解；2) 一系列的多量子比特控制循环操作；3) 逆分块1级分解。 因此我们可以分别分析这三个步骤来确定嵌入方案的算法复杂度。 第一部分：分块1级分解的量子线路如图3所示，其中包括两个 C ′ 0 和两个置换算子 P 2 n ， P 2 n 的矩阵分解如(12)式所示，其中 Π 2 n 包括 n − 1 个交换门， Π 2 n − 1 包括 n − 2 个交换门，则 P 2 n 一共包括 ( n − 1 ) + ( n − 2 ) + ⋯ + 1 = n ( n − 1 ) 2 个交换算子，综上，第一部分的算法复杂度为 2 + 2 × n ( n − 1 ) 2 = n 2 − n + 2 。 第二部分：对2n个量子比特进行 2 2 n − 2 的条件循环门操作，根据文献 [ 14 ] 中的7.12定理，n量子比特的控制循环门 R y ( 2 φ ) 的量子复杂度为 O ( n ) ，因此这一系列循环门操作的复杂度不会超过 O ( n 2 2 n − 2 ) 。 第三部分：因为所有的量子操作都是通过量子酉门进行的，所以量子变换是可逆的，因此，逆分块1级变换的量子线路相当于对分块1级分解求逆，所以与第一部分的算法复杂度相同，均为 n 2 − n + 2 。 将以上三个部分的算法复杂度相加可以得到分块量子水印图像嵌入算法总体的算法复杂度为 O ( n 2 2 n − 2 ) 。"
