"本研究利用基于有界平均振荡模型(boundary mean oscillation, BMO)的Z Q 梯度算子，结合各向异性非线性偏微分方程模型，构造用于图像处理的BMO滤波器，对水稻谷粒的数字图像进行去噪增强、边缘检测和特征提取，并对粒形参数进行统计分析。在此基础上，比较了BMO滤波与中值滤波的处理效果，并分析了BMO滤波技术的准确性与稳定性。结果表明，BMO滤波在保留图像的边界与细节特征方面显著优于中值滤波，其处理图像获取的谷粒粒长、粒宽和长宽比与人工测量值无显著差异(p < 0.05)，平均粒面积与千粒重正相关性强(R 2 = 0.942, p < 0.001)，且粒形参数提取结果在不同水稻品种间有较好的稳定性。 关键词 :有界平均振荡模型，偏微分方程，图像滤波技术，水稻粒形参数 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"我国是世界上最大的水稻消费国，同时也是最大的水稻生产国，全球有超过一半的人口是以稻米为食 [ 1 ] 。随着水稻生长环境的胁迫日益严峻及粮食需求的急剧增长，培育出高产量、高营养，具备抗胁迫能力的水稻优良品种一直是水稻育种研究的重点。随着功能基因组技术和基因与表型解析技术的发展，目前科研工作者已经可以利用基因组数据和表型组数据建立相关性模型，从而达到解析复杂表型的目的 [ 2 ] 。水稻的表型参数和生理生态参数有很多，其中，水稻粒形参数能直接反映水稻的产量，如总粒数、实粒数、粒长、粒宽、千粒重及其衍生参数 [ 3 ] 。研究表明水稻谷粒的粒形如长、宽、面积是遗传性状，是进行品种区分的重要指标，一般粳稻的谷粒较短、呈椭圆形，长宽比较小，而籼稻的谷粒为细长型，长宽比较大 [ 4 ] ，水稻谷粒形态参数作为水稻育种的重要标准，研究其测量方法对水稻育种具有重要意义。 然而如何快速、准确、可靠地获取水稻表型参数已经成为困扰科研工作者的重大问题，现有的水稻谷粒形态检测多由人工完成，传统测量方法为直尺或游标卡尺测量，为减少统计数据误差，需要重复测量以提高实验的准确性，存在着劳动强度大和人工主观误差的缺点 [ 5 ] [ 6 ] [ 7 ] 。但随着现代计算机技术、机器视觉技术、信息与自动化技术的飞速发展，国内外研究人员相继研发了一系列高精度、高效率的水稻谷粒自动化测量方法与设备 [ 8 ] [ 9 ] [ 10 ] [ 11 ] ，其粒形参数提取的核心是图像处理技术，而图像的去噪增强是图像前处理的关键，其能减少图像获取过程中因各种因素产生的噪声对后期图像分析带来的影响。图像去噪增强方法大致分为两类：1) 基于统计技术的传统图像滤波技术，如中值滤波 [ 12 ] [ 13 ] 等，该类滤波技术在去噪同时由于不考虑图像的形状特征，容易对图像边缘造成过度平滑 [ 14 ] ；2) 基于偏微分方程的去噪方法，该类滤波技术由图像梯度决定其扩散速度，属于各向异性扩散模型，在去噪同时又能够保留细微的图像边缘特征 [ 13 ] [ 14 ] [ 15 ] [ 16 ] 。 本研究提出利用基于BMO (bounded mean oscillation，有界平均振荡模型)的ZQ梯度算子 [ 17 ] [ 18 ] ，结合各向异性非线性偏微分方程模型，构造用于图像处理的BMO滤波器，对水稻谷粒的数字图像进行去噪增强、边缘检测和特征提取，并对相关的谷粒形态参数进行统计分析。在此基础上，比较了BMO滤波与以中值滤波为代表的传统滤波技术的处理效果，并分析了BMO滤波技术的准确性与稳定性，以期为水稻谷粒数字化测量提供精准有效的图像处理手段，为准确获取粒形参数做出重要贡献。"
"本实验选取籼稻和粳稻各两种，分别为内5优8015、Y两优689、春优927和春优84，每个品种选10个重复，每个重复均为100粒水稻成熟谷粒。获取谷粒数字图像时，将水稻谷粒随机散落在黑色背景板上，并置于专业摄像箱中，采用Canon EOS 5D Mark III垂直于背景板进行拍摄，拍摄所得的数字图像像素为5760×3840，分辨率为每像素0.05mm。 同时对谷粒进行人工测量，用游标卡尺测量谷粒的粒长和粒宽，其中粒长为谷粒颖壳上距离最远的两个点长度，而粒宽则为与粒长垂直方向上最大距离。每个重复用电子天平测量谷粒总重量，乘以10作为该样品的千粒重。每个水稻品种每个重复进行三次人工测量，测量结果的平均值作为该样品粒长、粒宽和千粒重的真值。 本研究采用单因素方差分析和回归分析方法对图像提取的水稻谷粒形态参数进行分析，并计算BMO滤波与人工测量结果的相对误差、变异系数，在此基础上分析BMO滤波技术的准确性与稳定性。"
"水稻籽粒形态参数检测系统V1.0(软件著作权登记号：2018SR344298)主要用于水稻谷粒数字图像的前期处理、谷粒形态特征参数的提取和相关数据的统计。系统中除了BMO滤波，还包括中值滤波等多种常规图像滤波技术，可对谷粒数字图像进行去噪增强、边缘检测等功能，并可对处理完成后的数字图像进行二值化，最终完成粒形参数的提取，包括粒长、粒宽、粒面积以及长宽比。该系统运行流程如图1所示。 图1. 图像处理流程图  BMO(bounded mean oscillation)即有界平均振荡模型的英文缩写，它通过一种新的导数格式的确定来探测边界特征，并运用积分平均的思想来消除噪声的影响，其能够利用较少的计算量和计算步骤以及简单的算法结构来达到检测细微边缘特征的目的，使得该计算格式得到广泛发展 [ 14 ] [ 19 ] 。 其2-D的算法格式为 [ 16 ] [ 17 ] [ 18 ]： (1) 在BMO格式和梯度的关系上，将正方形邻域 Q ( x , r ) 换成球 B ( x , r ) ，则可以证明如下等式 [ 16 ] [ 17 ] [ 18 ]： lim r → 0 1 r Z n | B ( x , r ) | ∫ B ( x , r ) | u ( y ) − 1 | B ( x , r ) | ∫ B ( x , r ) u ( z ) d z | d y = | ∇ u ( x ) | (2) 上式适用于2-D正方形区域 Q ( x , r ) 的BMO形式即为Z Q 梯度算子 [ 16 ] [ 17 ] [ 18 ]： Z Q ( u , x , r ) = 2 r | Q ( x , r ) | ∫ Q ( x , r ) | u ( y ) − 1 Q ( x , r ) ∫ Q ( x , r ) u ( z ) d z | d y (3) 本研究拟采用3*3离散格式对ZQ梯度算子进行离散。BMO格式的ZQ梯度算子亦可在更大的窗口中进行离散，但是其计算格式更为复杂，而且过大的窗口会造成更大范围的平均值计算，这样也会降低边界特征的强度，故本研究采用3*3离散格式对图像进行处理，而不采用更大尺度范围的ZQ梯度算子。  本研究从数字图像中提取测量的粒形参数主要有粒长、粒宽、粒面积和长宽比。粒长、粒宽计算步骤如下所述，针对每一颗谷粒图像，提取该谷粒二值图像的轮廓，然后搜索谷粒轮廓得到轮廓上距离最远的两个点P1、P2，该谷粒粒长即为P1P2两点之间的距离；直线P1P2将谷粒轮廓划分为上下两个部分，接着搜索上下轮廓分别距离直线P1P2的最大距离d1、d2，该谷粒粒宽即为d1、d2之和；最后计算图像上所有谷粒的长、宽最后求平均值即为该样品的平均粒长和平均粒宽，长宽比则为粒长与粒宽之比，谷粒平均粒面积则为谷粒区域像素面积的平均值 [ 2 ] 。"
"水稻的谷粒形态与产量和品质密切相关，主要包括粒长、粒宽和长宽比等方面 [ 20 ] [ 21 ] ，粒长不仅决定稻米的外观和碾磨品质，而且对水稻的千粒重也有影响 [ 22 ] [ 23 ] ，因此图像滤波技术能否最大程度的保留谷粒数字图像的边缘特征，更好地反映谷粒形态特征是值得关注的问题。图2以内5优8015为例展示了谷粒数字图像经过不同图像滤波技术处理后的灰度图像与二值化图像，并与原图直接二值化后的效果进行了对比，我们将谷粒数字图像直接采用自适应阈值 [ 24 ] 二值化，即未经过任何图像增强滤波处理，作为对照进行对比分析。 结果表明(表1)，针对多种形态差异明显的谷粒，中值滤波和原图二值处理后获得的粒长粒宽均与人工测量结果有显著性差异，而BMO滤波则没有显著性差异，人工测量与各滤波技术所得粒长粒宽大小为人工测量 > BMO滤波 > 原图二值 > 中值滤波，以籼稻Y两优689和粳稻春优84为例，BMO滤波处理后所得粒长粒宽要显著大于原图二值和中值滤波，这两个品种的粒长较其他处理方式分别增加了0.33%、0.55%和0.28%、0.42%，粒宽较其他处理方式分别增加了1.26%、1.26%和1.22%、1.22%，而中值滤波和原图二值所得结果则无显著性差异。在长宽比方面，各滤波技术与人工测量之间则并无显著性差异。 将BMO滤波处理后所得测量结果与人工测量结果相比(表2)，不同水稻品种间其粒长相对误差分别为1.29%、0.88%、1.39%和0.76%，变异系数分别为0.94%、0.90%、1.25%和0.60%，其粒宽相对误差分别为2.90%、1.44%、0.71%和0.86%，变异系数分别为1.74%、1.04%、0.59%和0.66%，可见BMO滤波对粒形参数提取结果有较好的稳定性。 从上述结果来看，BMO滤波对不同水稻品种和同一品种多个重复的谷粒数字图像处理效果有较好的准确性和稳定性，中值滤波作为传统的图像滤波技术，其算法对去噪效果具有不稳定性，在滤波过程中丢失了大量的谷粒边缘特征信息，滤波效果不佳，而BMO滤波兼顾去噪增强与保留细节两方面，尤其是在保留图像中边缘特征信息效果显著优于传统图像滤波技术，但其所得结果与人工测量仍存在一定差距，其原因如下：一方面数字图像获取过程中，图像分辨率在一定程度上会导致谷粒信息的损失，一方面人工测量时，对粒长粒宽的判断存在主观上的判断，因此也会一定程度上影响测量结果。 图2. 内5优8015谷粒图像采用不同滤波技术后的效果局部图(其中(a)~(c)依次为无滤波处理、中值滤波、BMO滤波后的灰度图像，(d)~(f)依次为无滤波处理、中值滤波、BMO滤波后的二值图像)  水稻千粒重是体现种子大小与饱满程度的一项指标，是检验种子质量和作物考种的内容，也是田间预测产量时的重要依据，有相关研究指出水稻千粒重与粒面积具有正相关性 [ 2 ] 。因此本研究利用不同图像滤波技术对谷粒数字图像进行处理后，统计获得谷粒平均粒面积，并与千粒重进行相关分析，结果表明，水稻千粒重与粒面积具有正相关性(图3)，即粒面积越大，千粒重越大，其中原图二值和中值滤波的相关系数分别为0.936和0.935，BMO滤波的相关系数为0.942，高于其他图像处理方式。 从3.1可知，BMO滤波对谷粒数字图像具有较好的处理效果，从处理后图像提取的水稻粒形参数与人工测量值无显著差异，但由于二维图像只能平面反映谷粒的形状、大小，并不能体现其厚度变化，因此该方法仍具有一定的局限性。从图3结果可知，水稻千粒重与水稻粒面积具有较高的正相关性，其中BMO滤波获得的结果正相关性最高，使得利用粒面积预测千粒重成为可能，在一定程度上弥补了二维图像的局限性。 Table 1 水稻品种 Rice varieties 粒形参数 Grain shape parameters 人工测量/mm Manual measurement/mm 滤波类型 Image filter 原图二值/mm Blank control/mm 中值滤波/mm Median filter/mm BMO滤波/mm BMO filter/mm 内5优8015 (籼) 粒长 9.93 ± 0.48a 9.77 ± 0.50b 9.76 ± 0.50b 9.80 ± 0.50a 粒宽 2.53 ± 0.16a 2.43 ± 0.21b 2.43 ± 0.21b 2.51 ± 0.20a 长宽比 3.93 ± 0.29a 4.03 ± 0.30a 4.04 ± 0.30a 3.92 ± 0.29a Y两优689 (籼) 粒长 9.14 ± 0.62a 9.08 ± 0.54b 9.06 ± 0.54b 9.11 ± 0.54a 粒宽 2.44 ± 0.12a 2.39 ± 0.22b 2.39 ± 0.21b 2.42 ± 0.22a 长宽比 3.76 ± 0.28a 3.81 ± 0.31a 3.80 ± 0.31a 3.78 ± 0.31a 春优927 (粳) 粒长 7.57 ± 0.37a 7.47 ± 0.46b 7.46 ± 0.46b 7.51 ± 0.46a 粒宽 3.25 ± 0.18a 3.17 ± 0.23b 3.17 ± 0.23b 3.21 ± 0.23a 长宽比 2.33 ± 0.12a 2.36 ± 0.21a 2.36 ± 0.21a 2.35 ± 0.21a 春优84 (粳) 粒长 7.29 ± 0.24a 7.19 ± 0.24b 7.18 ± 0.24b 7.21 ± 0.30a 粒宽 3.37 ± 0.16a 3.29 ± 0.17b 3.29 ± 0.17b 3.33 ± 0.19a 长宽比 2.19 ± 0.12a 2.18 ± 0.13a 2.18 ± 0.13a 2.17 ± 0.13a 表1. 根据不同图像滤波技术处理后的图像分析与人工测量得到的水稻粒形参数 Note: Different letters represent soil porosity obtained from three image filters differ significantly in the same soil layerand tillage methods (p < 0.05). 注：不同字母表示同一水稻品种同一谷粒形态参数不同图像处理方式间的差异显著，相同字母表示差异不显著(p < 0.05)。 Table 2 水稻品种 Rice varieties 粒形参数 Grain shape parameters 相对误差/% Relative error/% 变异系数/% Variation coefficiency/% 内5优8015 (籼) 粒长 1.29 0.94 粒宽 2.90 1.74 Y两优689 (籼) 粒长 0.88 0.90 粒宽 1.44 1.04 春优927 (粳) 粒长 1.39 1.25 粒宽 0.71 0.59 春优84 (粳) 粒长 0.76 0.60 粒宽 0.86 0.66 表2. 粒形参数的相对误差和变异系数(BMO滤波) 图3. 千粒重与平均粒面积的相关分析((a)、原图二值；(b)、中值滤波；(c)、BMO滤波，p < 0.001)"
"本文基于图像处理、数值分析和计算机技术，利用BMO滤波对谷粒数字图像进行了去噪增强的滤波处理，并将提取的粒形参数结果与传统滤波技术进行了比较。主要研究结果如下：BMO滤波与传统滤波技术相比，在保留图像的边界与细节特征方面显著优于传统滤波技术，其处理图像获取的谷粒粒长、粒宽和长宽比与人工测量值无显著差异，数值结果与人工测量值最为接近，且在不同水稻品种间具有较好的稳定性；此外不同图像滤波技术获得的谷粒平均粒面积与水稻千粒重均表现为正相关性，其中BMO滤波的相关系数要高于其他图像处理方法。 由于谷粒数字图像的二维性以及相关设备的限制，无法立体完整的反映谷粒的粒形特征，如粒厚、长厚比等，因此图像方法提取粒形参数有一定的局限性，在今后的研究过程中，可以考虑将图像滤波技术与断层扫描技术结合，以期能够完整的描述谷粒在三维空间上的形状特征，为水稻育种提供精确的量化指标。"
