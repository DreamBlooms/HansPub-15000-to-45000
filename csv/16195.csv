"为实现天气现象的自动观测，本文提出了一种基于贝叶斯分类的室外图像的天气现象识别方法，该方法通过提取图像的色相、饱和度和亮度等特征，采用贝叶斯分类，对雾霾和沙尘两类天气现象进行判断。实验结果的准确率达到预期目标，并且能快速、准确地测量室外图像的天气现象。 关键词 :天气现象识别，图像处理，贝叶斯分类"
"最近随着图像理解与智能视频技术的不断发展，对室外环境下各种天气现象，尤其是恶劣天气现象的自动检测与识别提提供了必要条件。但是，目前天气现象的观测仍然主要依靠人工观测，天气现象信息的采集耗费了大量的人力和物力，而且人工观测受外界环境和地域条件影响较大，观测数据较少且不连续，因此近年来基于室外图像与视频数据的天气现象自动识别研究受到了较为广泛的关注 [ 1 ] 。 目前，人们在不同方向对各种天气现象进行分析并建模，取得了一定的成果。本文提出了一种通过提取的图像特征进行贝叶斯分类的天气现象识别与分类方法。该方法通过提取图像的色相、饱和度和亮度等特征，采用贝叶斯分类，对雾霾和沙尘两类天气现象进行判断。该方法可以进行连续观测，且能快速准确的识别天气现象 [ 2 ] 。"
"Pearl通过结合专家系统，发展出贝叶斯理论的高级应用模型贝叶斯网络，并指出贝叶斯网络或许是概率推理中最普及的模型 [ 3 ] 。贝叶斯理论经过长期的发展与运用，其理论被很多学者运用到各行各业，是统计学中一支重要的理论。 贝叶斯方法是基于贝叶斯定理而发展起来用于系统地阐述和解决统计问题的方法。该方法的核心为贝叶斯公式 [ 4 ] ，其基本形式如下： 式中，P(w)代表对w拥有的初始概率，即w的先验概率，它反映了关于w是一正确假设的机会的背景知识。P(x)代表将要观察的集合x的全概率，即在没有确定某一假设成立时x的概率。 代表假设w成立的情形下观察到集合x的概率，即条件概率。 代表给定集合x时w成立的概率，即w的后验概率，它反映了在看到集合x后w成立的置信度。 贝叶斯理论经过长期的历史发展，以其独特的不确定性知识表达形式、丰富的概率表达能力、综合先验知识的增量学习特性等成为众多学者日益研究的焦点问题。贝叶斯在现实生活中作为数据挖掘、分类等方面得到了广泛的应用。其中尤其发展而来的朴素贝叶斯分类器得到了广大学者的重视，朴素贝叶斯分类器(naive Bayes classifiers，简记为NB)基于简单而不现实的假设：在给定类标记时属性值之间相互条件独立 [ 5 ] 。 贝叶斯定理作为一种概率计算可用于多个领域内进行概率推理。今天，我们用贝叶斯法则过滤垃圾邮件，为网站用户推荐唱片、电影和书籍。它渗透到了互联网、语言和语言处理、人工智能、机器学习、金融、天文学和物理学乃至国家安全等各个领域，当然也可以运用在图像识别概率的优化上，从而建立数学优化模型 [ 6 ] 。"
"在许多场合下，我们研究贝叶斯的重点落在修订其后验概率的工作上。为了寻找给定集合x时可能性最大的假设 (W为候选假设集合)。这种具有最大可能性的假设被称为极大后验假设，简记为w map 。即 (3.1) 应用到贝叶斯公式得到： (3.2) 因为P(x m )是一个不依赖于w n 的常量，去掉它可得到： (3.3) 为做好几种天气图像的识别，我们需要将实际问题与贝叶斯原理进行紧密的结合。实际上，图像的识别通常与饱和度、色相等要素有着密切的关联，即给定一组因子，对因子进行合理的分类和数据挖掘，就可以得到显著的相关关系，从而进行概率的优化与完善。我们可以将天气图像识别与朴素贝叶斯分类器结构相结合，以自变量表示图像的饱和度等要素，以因变量表示研究对象及图像所属的天气种类。显然，分类问题就可以直接用MAP假设来解决 [ 7 ] 。 应用MAP假设分类，x的目标是在给定集合 的情况下，得到最可能的w(x)的值。应用公式(3.3)得到 (3.4) 现在要做的就是基于总集合估计上式中的两个概率值。估计每个P(w n )值很容易，只要计算每个w n 出现在集合W中的频率就可以。然而，估计每个 的值不太可行，原因在于：首先，完整估计 值的时候复杂程度相当于学习一个贝叶斯网络，是一个比较难的问题。因此，为获得合理的估计，我们引入朴素贝叶斯分类器机构，假定：在给定自变量时其属性值之间是相互条件独立的。也就是说，在给定自变量集合的情况下，观察到的联合概率正好是每个单独属性值概率的乘积。 具体数学表达式如下： (3.5) 将其带入公式(3.4)可得到朴素贝叶斯分类器的分类公式： (3.6) 式中，x j 为预报因子x的第j个属性、概率 和 可以通过计算集合中不同种类和属性值组合的出现频率来简单计算，计算公式如下： (3.7) (3.8) 式中，n为集合的总个数，w i 为集合中第i个要素，x ij 为第i个预报因子的第j个属性， 为一个二值函数，当w i = w n 时为1，否则为0。 在大多数情况下，上述这种基于频率比例的方法是对概率的一个良好估计，但当接近零频率属性值出现的时候，就会导致这种概率估计产生一个有偏的过低估计概率。更极端的是，当零频率属性值出现时，就会使得某概率值为0，进而致使式(3.6)为0。为了避免此类问题的出现，Laplace估计常常被用来平滑上述所得概率，修改式(3.7)和(3.8)可得： (3.9) (3.10) 式中，n w 为因变量种类的个数，n j 为该预报因子属性的种类个数。"
"运用朴素贝叶斯分类器来解决天气图像识别问题：根据图像的要素来判断图像中的天气属于哪一类 [ 8 ] 。从试验数据中筛选一组数据集合(部分内容见表1)，我们可以将因变量划分为两类： 雾霾天气W N 和沙尘天气W Q Table 1 序号 色相均值 饱和度均值 亮度均值 天气现象 1 0.3008 0.0067 0.7058 雾霾 2 0.5671 0.0693 0.5632 雾霾 3 0.5402 0.1159 0.6693 雾霾 4 0.5867 0.3455 0.5803 雾霾 5 0.4532 0.0452 0.5539 雾霾 6 0.1084 0.6269 0.7579 沙尘 . . . . . . . . . . . . . . . n − 2 0.0973 0.5314 0.7281 沙尘 n − 1 0.0878 0.4673 0.5568 沙尘 n 0.0946 0.5699 0.6213 沙尘 表1. 试验数据集合(部分) 可以从原始数据中选取合适的自变量：色相均值X 1 、饱和度均值X 2 、亮度均值X 3 。其中每一类自变量我们可以将其划分为三种属性 [ 9 ] ： 色相均值X 1 ： ； ； 饱和度均值X 2 ： ； ； 亮度均值X 3 ： ； ； 现在给定一组自变量数值X：(X 1 = 0.0871；X 2 = 0.4930；X 3 = 0.6598)让我们来判断图像中的天气是雾霾还是沙尘天气？ 显然，我们的任务是判断图像中的天气情况，确定所选图像天气情况W取值(W N 或W Q )。为此，我们拿出图像中天气的一类情况进行考虑(其他类别同此分析)，构建朴素贝叶斯网络分类器。因变量W的类别是W N ，其他3个自变量X 1 、X 2 、X 3 分别代表色相均值，饱和度均值，亮度均值。根据朴素贝叶斯假设子结点之间没有任何的依赖关系，即自变量之间相互独立。 其中j属于自变量的属性，根据给定的一组自变量数据和之前我们对自变量的属性分类，我们可以将上式改写为： 为计算W N 的值，需要从表1所示的集合中估计出概率：P(W N )、P(x 11 |W N )、P(x 22 |W N )、P(x 33 |W N )、P(W Q )、P(x 11 |W Q )、P(x 22 |W Q )、P(x 33 |W Q )等。 其中部分算法如下： 我们可以将处理后的所有条件概率汇总于表2，表3。 所以有： 可见，朴素贝叶斯分类器将该图像的天气现象归为沙尘W Q 类。将上述概率进行归一化，可得到朴素贝叶斯分类器对该图像天气现象的识别概率： 上述概率即为我们所修订后的后验概率，当然它们彼此之间没有可比性，因为历史资料告诉我们它 Table 2 P(x ij |W N ) X 1j X 2j X 3j X i 1 0.0159 0.9206 0.0159 X i 2 0.9365 0.0635 0.1270 X i 3 0.0476 0.0159 0.8571 表2. 雾霾W N 条件下自变量各属性的条件概率 Table 3 P(x ij |W Q ) X 1j X 2j X 3j X i 1 0.9512 0.0488 0.0244 X i 2 0.0244 0.4878 0.1463 X i 3 0.0244 0.4634 0.8293 表3. 沙尘W Q 条件下自变量各属性的条件概率 们各自出现的概率本来就不是平均的。所以我们再引入增长率 ，它表示后验概率在其对应的先验概率的基础上的增量。此时我们在结合增长率之间的大小就可以对该天的天气现象做出相应的预报[ 10 ] -[ 15 ] 。 如天气现象预报情况为：最有可能出现沙尘W Q ，且出现的概率为P Q = 99.66%。而所选图像为沙尘天气，这与我们所得结果正好吻合，这也验证了朴素贝叶斯预报模型的适用性，为了进一步验证模型天气图像识别的准确性，我们用同样的方法选取多组自变量数值X进行检验，分别选取沙尘和雾霾的天气图像多张进行检验，准确率达到了80%以上。"
"本文提出了一种基于贝叶斯分类方法的天气图像自动识别方法。主要是对雾霾和沙尘两种天气图像进行识别分类，通过数字图像处理提取图像的色相、饱和度和亮度等特征，采用贝叶斯分类，建立贝叶斯分类模型，通过仿真验证了该模型的有效性，有比较高的准确性，准确率达到了80%以上。本方法可以适用于不同天气现象的识别，在天气现象识别方面可以取代人工观测，节省大量的人力物力，且本方法简单可靠、经济适用、精度较高，可以应用在船舶、机场等天气识别的场合。"
