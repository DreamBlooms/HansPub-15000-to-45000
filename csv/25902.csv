"在城市化的快速发展和极端暴雨天气频发背景下，世界很多城市遭遇暴雨内涝侵袭。而城市洪水模拟计算呈现出计算范围大、模拟精度高等特点，对模型要求越来越高。本文选取英国伦敦为研究区域，采用基于细胞自动机的二维洪水模型CADDIES-2D进行洪水模拟，并采用基于情景模拟的方法评估了伦敦Waterloo区域洪水风险。结果表明，基于细胞自动机的二维洪水模型CADDIES-2D计算效率高，具有较高的实用性和有效性，可用于城市洪水风险分析，提高城市防灾减灾水平。 关键词 :细胞自动机，洪水模拟，洪水风险，CADDIES-2D Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"工业化的快速发展使得全球气候发生变化 [ 1 ] ，如全球变暖加速水文循环过程，增加空气中的水汽容量，导致极端暴雨日益频发。近年来，世界上很多城市频频遭受暴雨洪涝灾害 [ 2 ] - [ 7 ] 。2012年7月21日，北京市遭遇特大暴雨侵袭，全市平均降雨量达到170 mm，而暴雨中心房山区的降雨量甚至达到460 mm。北京721暴雨导致城区下凹式立交桥出现63处积水点，造成79人死亡，全市受灾人口190万人，因灾造成直接经济损失达116.4亿元 [ 8 ] [ 9 ] 。此外，城市规模的不断扩张，导致城市中不透水下垫面的比例增大，使得雨水下渗减少，地表汇流时间变短，从而加剧了城市内涝程度。 城市洪水模拟可以发布洪水预警以减轻洪水灾害损失，同时可以用来评估城市洪水高风险区域，对城市洪水改造提供科学支持。经过经验性模型、概念性模型以及物理性模型三个阶段的发展，现如今开发了一系列的暴雨径流模型 [ 10 ] 。其中常用的二维洪水模型有DHI MIKE 21，JFLOW-GPU及InfoWorks等。例如，DHI开发的二维河口、海岸及海洋模型MIKE 21可以与一维城市污水和雨水管网模型MIKE URBAN耦合进行城市洪水模拟计算。虽然上述耦合计算可以得到较精确的城市地表洪水分布信息，但是该模型对资料要求较高并且模型计算速度相对较慢。 近年来，随着城市化的快速发展，城市洪水模拟呈现出计算范围大、模拟精度高等特点。为了提高大尺度研究区域的模拟精度，如伦敦，模型中采用精度较高的地形等数据，其网格数量高达上千万，使得模型运算时间增长。而模型的运算时间过长给模型结果分析和洪水灾害预警带来重大挑战。尽管并行计算在一定程度上提高了模型计算效率，但模型计算速度始终是瓶颈，难以满足超大城市快速模拟计算的需求。基于细胞自动机技术(CA)的二维洪水模型CADDIES-2D由英国埃克塞特大学水系统中心开发，可以满足城市洪水计算范围大、模拟精度高的需求 [ 11 ] 。因此，本文选择CADDIES-2D模型进行城市洪水模拟及风险分析相关方面的研究。"
"细胞自动机，也称元胞自动机，它是在一个具有离散、有限状态的细胞组成的细胞空间上，并按照一定的局部规则在离散的时间维度上演化的动力学系统 [ 12 ] 。不同于一般的动力学模型，细胞自动机由一系列模型构造的规则构成。细胞自动机一般由离散空间、邻居、细胞状态、时间和转移规则五部分组成。 英国埃克塞特大学开发了基于细胞自动机的城市洪水动力学模型CADDIES-2D。目前，已经开发的CADDIES-2D有两个版本，即CA2D和WCA2D。本文采用基于WCA2D的CADDIES-2D进行洪水模拟计算。WCA2D是一个扩散模型，并且其忽略了惯性项和动量守恒。如图1所示，该模型采用冯诺依曼邻居关系中的 图1. 离散网格洪水流动示意图 正方形网格进行洪水动力学计算。模型主要由以下特点：1) 中心网格向相邻网格转移的水量由权重计算；2) 采用曼宁公式和临界流方程限制中心网格向相邻网格转移的水量；3) 设置步长更新周期来提升模型计算效率。 CADDIES-2D模型具体结构及其推导过程已在文献中给出 [ 11 ] ，本文只针对模型中不同网格间转移水量的计算规则作简单介绍。如图2，根据每个网格的水位计算得到中心网格与相邻网格之间的水位差，其中低于中心网格水位的网格被称为下游网格，即其与中心网格的水位差为正值，且中心网格的水流向下游网格。水位差 乘以网格的面积即得到中心网格与下游网格之间的水量体积差 Δ V 0 , i 。根据体积差计算中心网格向下游各个网格 转移水量的权重，且模型假设中心网格保留的水量等于最小水量体积差。权重计算如公式(1)~(2)所示： w i = Δ V 0 , i Δ V t o t + Δ V min ∀ i ∈ { 1...     m } (1) w 0 = Δ V min Δ V t o t + Δ V min         (2) 式中：w i 为第i个网格的权重，w 0 为中心网格保留水量的权重，m为下游网格数量。 CADDIES-2D模型采用离散的网格及CA转移规则进行洪水模拟计算。对于每一个网格，CA转移规则是指利用该网格及其周围相邻网格上一个时间步长的相关状态变量进行水量转移计算，即其新状态并不依赖于同一时间步长上任何其他网格的新状态，因此该模型很适合并行计算。针对WCA2D开发了基于OpenMP的多核CPU并行计算模型和基于OpenCL库的GPU并行计算模型。此外，为了提高洪水模拟的精度，模型可对每个网格的曼宁系数糙率和恒定下渗率参数分别赋值，其中恒定下渗率参数代表土壤下渗和排水管网排水。  城市洪水风险可以定义为一定概率下的洪水造成的破坏或损失，即洪水发生的概率与损失的乘积。目前常用的洪水风险分析方法主要包括基于历史灾情数理统计法、基于指标体系的加权指数法、基于情景模拟分析的方法以及基于遥感数据分析法等 [ 13 ] [ 14 ] [ 15 ] 。本章从栅格尺度出发，采用基于情景模拟的方法对城市洪水风险进行评估。由于用一次内涝灾害风险评估不足以代表该区域的内涝风险水平，且鉴于CADDIES模型可以实现快速计算，本文采用重现期情景分别为10年，20年，30年，50年，100年以及200年一遇的设计降雨进行内涝风险评估。同时，为了考虑不同降雨历时的影响，针对每个超越概率情景，本文分别采用100场不同历时的设计降雨进行洪水模拟计算，即5 min，10 min，…，495 min，500 min。本文取100场设计降雨最大洪水深度的平均值作为相应重现期降雨带来的栅格损失值。洪水风险计算如公式(3)所示： R i = ∑ r = 1 6 p r ( 1 100 ∑ d = 1 100 D r d ) (3) 式中：Ri为栅格洪水风险值；p r 为第r个设计降雨对应的超越概率；D rd 是采用超越概率为p r 的第d场降雨进行洪水模拟得到的栅格最大淹没水深。"
"伦敦处于英格兰东南部，位于西经0˚30'至东经0˚18'北纬51˚18'至51˚42'之间。跨泰晤士河下游两岸，距河口88公里。伦敦地理位置如图3所示，全域面积约为1572 km 2 。伦敦夏季(6~8月)的气温在18℃左右，春季(3月底~5月)和秋季(9~10月)的气温维持在11℃~15℃左右，而冬季(11月~3月中旬)的气温在6℃左右波动，因此在伦敦冬季有罕见结冰的情况。伦敦年降雨量为600 mm，全年降水分配比较均匀，没有明显的季节性。此外，Waterloo地理位置如图3所示，其下游毗邻泰晤士河，区域面积为68.8 km 2 。 图2. 网格间水量转移计算示意图 图3. 伦敦和Waterloo地理位置示意图  选用英国的国家测绘单位陆地测量局(Ordnance Survey)的地形数据进行洪水模拟计算。如图4所示为Waterloo的DEM和土地覆盖数据。DEM栅格数据的水平精度为5 × 5 m，其最大高程和最小高程分别为115.5 m和−6.4 m。该研究区域的土地覆盖数据共分为6类，即建筑物、绿地、人造表面(广场等)、铁路、道路及水体。该研究区域中高达81.0%的面积为不透水层，而可透水的绿地面积仅占19.0%。 根据英国洪水评估手册中(FEH)的降雨强度–历时–频率曲线计算设计降雨的降雨量，而设计降雨雨型由Info Works自带的英国降雨产生器生成。例如，降雨历时2小时重现期为15年一遇情景的设计降雨过程如图5所示。该设计降雨的降雨量为37 mm，而相应的降雨强度峰值为74 mm/h。 此外，根据降雨强度–历时–频率曲线得到降雨历时5 min、10 min、…、495 min、500 min且重现期分别为10、20、30、50、100及200年一遇的600场暴雨情景进行洪水风险计算分析。上述600场设计降雨采用图5所示降雨过程的雨型，其相应的降雨深度和降雨强度峰值这里不再一一列出。  采用CADDIES进行城市洪水模拟需要输入下垫面数字高程模型(DEM)，土地覆盖数据(land cover)，土地利 图4. Waterloo DEM和土地覆盖数据 图5. 15年一遇2 h设计降雨 用数据(land use)，降雨数据等等。分别上述得到数据后，借助ArcGIS等工具进行处理，转变为CADDIES模型所使用的数据格式。模型数据处理流程如图6所示。"
"采用100年一遇2小时设计降雨对伦敦进行洪水模拟，模拟计算时段为6 h。为了对比模型计算效率，本文以泰晤士河(如图3所示)将伦敦分为北伦敦和南伦敦两个部分，分别将伦敦、北伦敦及南伦敦输入模型进行洪水模拟计算。 考虑到伦敦区域栅格数量较多，对计算机配置要求较高。本文选用装有GPU的计算机TITAN对伦敦进行洪水模拟，其配置Intel Xeon处理器(3.20 GHz、18 GB内存)和GeForce GTX TITAN显卡(3072 Cores、12 GB图像存储器)。图7为采用100年一遇2 h设计降雨模拟得到的伦敦最大淹没水深。伦敦、北伦敦及南伦敦分别对应的栅格数量和模型运行时间如表1所示。 图6. CADDIES模型数据处理流程 图7. 100年一遇2 h设计降雨情境下的洪水最大淹没水深 Table 1 伦敦全部 北伦敦 南伦敦 计算机平台 TITAN (GPU) TITAN (GPU) TITAN (GPU) 栅格数量(×10 6 ) 62.9 37.1 25.8 运行时间(h) 20.3 6.0 8.8 表1. 研究区域栅格数量及模型运行时间 Table 2 设计降雨 淹没面积(km 2 ) 水深0.1~0.3 m 水深0.3~0.6 m 水深0.6~0.9 m 水深 > 0.9 m 20 year-1 h 1.40 0.35 0.06 0.01 100 year-1 h 3.26 1.08 0.29 0.14 100 yera-5 h 1.98 0.63 0.16 0.06 200 year-1h 4.36 1.57 0.47 0.26 表2. Waterloo在不同设计降雨情境下的洪水淹没面积 图8. 不同设计降雨情境下的Waterloo最大淹没水深 由表1可知，当栅格水平精度为5 × 5 m时，伦敦的栅格总量为62.9 × 10 6 个。虽然伦敦的栅格数量巨大，但其在TITAN上采用CADDIES模拟的运行时间仅为20.3 h，计算效率非常高。此外，通过对北伦敦和南伦敦分别进行洪水模拟，得到模型运行时间分别为6.0 h和8.8 h。北伦敦及南伦敦模型运行时间之和小于伦敦的运行时间。这是因为模型计算采用自适应步长且整个研究区域在某时刻的时间步长为同一个值；而时间步长与研究区域中栅格的流速有关，即流速越大，计算得到的时间步长越小，且模型选取所有栅格的最小时间步长作为模型整体的时间步长。当对伦敦进行洪水模拟时，模型中的时间步长取北伦敦及南伦敦所有栅格的时间步长中的最小值，导致伦敦模拟迭代次数增加，模型运行时间增长。  分别采用降雨历时5，10，…，495，500 min且重现期分别为10，20，30，50，100及200年一遇的600场设计暴雨对Waterloo进行洪水模拟。其中Waterloo在20，100，200年一遇1 h设计降雨及100年一遇5 h设计降雨情境下的最大淹没水深如图8所示，而相应的洪水淹没面积统计结果如表2所示。 由图8(a)、图8(b)、图8(d)可知洪水淹没面积随着设计降雨强度的增加而增加。Waterloo在200 year-1 h设计降雨时的洪水淹没最严重，其中水深范围处于0.1~0.3 m、0.3~0.6 m、0.6~0.9 m及大于0.9 m的洪水淹没面积分别为4.36、1.57、0.47及0.26 km 2 。此外，历时分别为1 h和5 h的100年一遇设计降雨情景下的洪水模拟结果如图8(b)和图8(c)所示。在相同重现期条件下，洪水淹没面积随着降雨历时的增加而减小。因此，设计降雨的重现期和历时均会影响洪水模拟结果。 本文分别采用不同重现期及不同历时的600场设计降雨评估城市内涝灾害风险，Waterloo洪水风险分布如图9所示。由图9可以得到研究区域中不同栅格的洪水风险值。图中高洪水风险的栅格在研究区域的上游和下游均有大量分布，上、下游风险分布特征相似。通过计算得到洪水风险值大于1的高风险栅格面积与研究区域 图9. Waterloo洪水风险图 总栅格面积的比值为3.0%。对于风险较大的区域，应提前做好洪水预警，从而切实有效地降低洪水灾害造成的损失和影响。因此，上述城市内涝风险可以更好地用于城市洪水管理，提高防灾减灾水平。"
"本文以基于细胞自动机的CADDIES-2D模型为基础，选取伦敦和Waterloo分别进行洪水模拟及风险分析。主要结论如下： 1) 通过采用基于细胞自动机的洪水模型CADDIES-2D对伦敦进行洪水模拟，验证了该模型计算效率高。借助高性能计算机平台，CADDIES-2D可以对超大城市实现高精度洪水模拟。 2) 根据CADDIES-2D城市洪水模拟结果，本文基于栅格尺度提出的城市内涝风险评估方法可以充分考虑不同降雨特点，为城市内涝灾害风险评估提供了一种新的探索。栅格尺度的洪水风险计算结果可为城市防灾减灾及可持续发展提供更加准确的参考依据。"
