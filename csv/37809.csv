"本文研究了具有不等式约束的优化问题的微分方程方法。首先建立优化问题的拉格朗日函数，运用鞍点的性质和投影算子，将原始的优化问题转化为等式方程。再利用等式方程建立微分方程系统，并证明了该微分方程系统的轨迹的聚点是原始的优化问题的解。"
"本文将研究具有不等式约束的优化问题，如下：求解 x * ∈ Q 使得 min f ( x ) s .t . g ( x ) ≤ 0 x ∈ Q (1.1) 其中， f : R n → R 是凸函数， g : R n → R m 是凸向量值映射，Q是非空闭凸集合。 优化应用于很多学科领域，诸如自动控制系统，信号处理，通讯和网络，电子电路设计，数据分析和建模，统计学(最优化设计)，以及金融等。其求解方法有内点法、罚函数方法等许多经典的求解方法。本文通过对Antipin [ 1 ] [ 2 ] 文章的学习和研究，运用微分方程方法求解具有不等式约束的优化问题(1.1)。 投影算子在具有不等式约束的优化问题(1.1)转化为等式时起着重要的作用，下面介绍投影算子的定义及与其相关的重要引理。 设C是闭凸集合，对每一个 x ∈ R n ，存在唯一的 x ^ ∈ C 使得 ‖ x − x ^ ‖ = min { ‖ x − y ‖ | y ∈ C } , 称 x ^ 是点x到集合C的投影，记作 Π C ( x ) 。投影算子 Π C ( x ) : R n → C 是定义好的，且 Π C ( x ) 是非扩张映射。 引理1.1 ( [ 3 ] )设H是实希尔伯特空间， C ⊂ H 是闭凸集合。对给定的 z ∈ H ， u ∈ C 满足不等式 〈 u − z , v − u 〉 ≥ 0 , ∀ v ∈ C , 当且仅当 u − Π C ( z ) = 0 。"
"本节将运用拉格朗日函数及投影算子等将原始的具有不等式约束的优化问题(1.1)经过计算、转化得到其由等式表示的充分条件，为微分方程系统的建立做好充分的准备。 具有不等式约束的优化问题(1.1)的拉格朗日函数如下： L ( x , u ) = f ( x ) + 〈 u , g ( x ) 〉 , ∀ x ∈ Q , ∀ u ∈ R + m , (2.1) 由于 x * 是 f ( y ) 的最优值点，点对 ( x * , u * ) (在一定的正则条件下)是拉格朗日函数 L ( x , u ) 的鞍点，即 f ( x * ) + 〈 u , g ( x * ) 〉 ≤ f ( x * ) + 〈 u * , g ( x * ) 〉 ≤ f ( x ) + 〈 u * , g ( x * ) 〉 , (2.2) 不等式组(2.2)中左边的不等式和右边不等式可分别转化为下面的包含形式 u * ∈ arg max { 〈 u , g ( x * ) 〉 | u ∈ R + m } , (2.3) x * ∈ arg min { f ( x ) + 〈 u * , g ( x ) 〉 | x ∈ Q } . (2.4) 在一定的条件下，可以得到(2.4)成立的充分条件，见下面的命题： 命题2.1：若 f : R n → R 为凸函数， g : R n → R m 为向量值映射，则(2.4)式成立的充分条件为 〈 ∇ f ( x * ) + ∇ g ( x * ) u * , x − x * 〉 ≥ 0 , ∀ x ∈ Q . (2.5) 其中 ∇ f 表示函数f的梯度， ∇ g 表示映射g和雅可比阵的转置。 证明：如果函数g是凸的，则由凸性条件可得 g ( x ) − g ( x * ) ≥ J g ( x * ) ( x − x * ) , (2.6) 其中 J g 表示映射g的雅可比阵。 同理，如果函数f是凸的，则由凸性条件可得 f ( x ) − f ( x * ) ≥ J f ( x * ) ( x − x * ) , (2.7) 其中 J f 表示函数f的梯度的转置。 而事实上，由于共轭算子的性质可以得到 J f ( x * ) ( x − x * ) + 〈 u * , J g ( x * ) ( x − x * ) 〉 = 〈 J f ( x * ) T , x − x * 〉 + 〈 J g ( x * ) T u * , x − x * 〉 = 〈 ∇ f ( x * ) , x − x * 〉 + 〈 ∇ g ( x * ) u * , x − x * 〉 . (2.8) 则根据(2.6)与(2.7)，(2.5)成立时必有(2.4)成立，即 f ( x ) − f ( x * ) + 〈 u * , g ( x ) − g ( x * ) 〉 ≥ 0. 则本命题的结论成立。证毕。 下面的命题可以找到具有不等式约束的优化问题的等式转化，为微分方程系统的建立奠定基础。 命题2.2：若 f : R n → R 为凸函数， g : R n → R m 为向量值凸映射，则若 ( x * , u * ) 使下面的等式方程 x * = ∏ Q ( x * − α ( ∇ f ( x * ) + ∇ g ( x * ) ) u * ) , (2.9) u * = ∏ + ( u * + α g ( x * ) ) . (2.10) 成立，则 ( x * , u * ) 满足鞍点不等式(2.2)，即 x * 是具有不等式约束的优化问题(1.1)的解。 证明：根据(2.5)和(2.3)可以得到 〈 ∇ f ( x * ) + ∇ g ( x * ) u * , x − x * 〉 ≥ 0 , ∀ x ∈ Q , (2.11) 〈 − g ( x * ) , u − u * 〉 ≥ 0 , ∀ u ∈ R + m . (2.12) 由(2.11)式和(2.12)分别可以得到，对 α > 0 有 〈 x * − x * + α ( ∇ f ( x * ) + ∇ g ( x * ) ) u * , x − x * 〉 ≥ 0 , ∀ x ∈ Q , 〈 u * − u * − α g ( x * ) , u − u * 〉 ≥ 0 , ∀ u ∈ R + m . 根据投影算子的定义和引理1.1，上述的两个变分不等式可转化为下面的等式形式 x * = ∏ Q ( x * − α ( ∇ f ( x * ) + ∇ g ( x * ) u * ) ) , (2.13) u * = ∏ + ( u * + α g ( x * ) ) , (2.14) 其中 Π + ( ⋅ ) 和 Π Q ( ⋅ ) 分别是到正卦限 R + m 和集合Q的投影算子， α > 0 是一个参数。证毕。 注2.1：上面的讨论表明在一定的正则条件下，命题2.1和命题2.2给出了 x * 是具有不等式约束优化问题(1.1)的解的充分条件是 x * 及其拉格朗日函数中对偶最优解 u * 满足等式(2.9)和(2.10)。"
"本节将要建立求解具有不等式约束的凸优化问题(1.1)的微分方程系统。 在等式方程(2.9)和(2.10)的基础上可建立如下的微分方程系统： d x d t + x = ∏ Q ( x − α ( ∇ f ( x ) + ∇ g ( x ) u ) ) , x ( t 0 ) = x 0 , d u d t + u = ∏ + ( u + α g ( x ) ) , u ( t 0 ) = u 0 , 其中 α > 0 是参数。 为了证明二阶微分方程系统的轨迹收敛于拉格朗日函数 L ( x , u ) 的鞍点 ( x * , u * ) ，受到文献Antipin [ 1 ] 和Antipin [ 2 ] 的启示，引入下面的具有控制过程的微分方程系统： x ¯ = ∏ Q ( x − α ( ∇ f ( x ) + ∇ g ( x ) u ¯ ) ) , u ¯ = ∏ + ( u + α g ( x ) ) (3.1) 其中 x ¯ = ∏ Q ( x − α ( ∇ f ( x ) + ∇ g ( x ) u ¯ ) ) , u ¯ = ∏ + ( u + α g ( x ) ) 。 为了简便计算，记 x ˙ = d x d t 和 u ˙ = d u d t 。根据投影定理，一阶微分方程系统(3.1)可转化成下面的变分不等式形式： 〈 x ˙ + α ( ∇ f ( x ¯ ) + ∇ g ( x ¯ ) u ¯ ) , y − x − x ˙ 〉 ≥ 0 , ∀ y ∈ Q , (3.2) 〈 u ˙ − α g ( x ¯ ) , v − u − u ˙ 〉 ≥ 0 , ∀ v ∈ R + m , (3.3) 〈 x ¯ − x + α ( ∇ f ( x ) + ∇ g ( x ) u ¯ ) , y − x ¯ 〉 ≥ 0 , ∀ y ∈ Q , (3.4) 〈 u ¯ − u − α g ( x ) , v − u ¯ 〉 ≥ 0 , ∀ v ∈ R + m . (3.5) 接下来，如果 g , ∇ f 和 ∇ g 是Lipschitz连续的，Lipschitz常数分别是 | g | , | ∇ f | 和 | ∇ g | ，除此之外，假设 ‖ u ¯ ‖ ≤ C 0 且 C 0 是一个常数。 在这些条件下，很容易证明得到下面的不等式关系： ‖ u ˙ + u − u ¯ ‖ ≤ α ‖ g ( x ¯ ) − g ( x ) ‖ ≤ α | g | ‖ x ¯ − x ‖ (3.6) 和 ‖ x ˙ + x − x ¯ ‖ ≤ α ‖ ∇ f ( x ¯ ) + ∇ g ( x ¯ ) u ¯ − ( ∇ f ( x ) + ∇ g ( x ) u ¯ ) ‖ = α ‖ ∇ f ( x ¯ ) + ∇ g ( x ¯ ) u ¯ − ∇ f ( x ) − ∇ g ( x ) u ¯ ‖ ≤ α ( ‖ ∇ f ( x ¯ ) − ∇ f ( x ) ‖ + ‖ ∇ g ( x ¯ ) − ∇ g ( x ) ‖ ‖ u ¯ ‖ ) ≤ α ( | ∇ f | + C 0 | ∇ g | ) ‖ x ¯ − x ‖ = α C ‖ x ¯ − x ‖ , (3.7) 其中， C = | ∇ f | + C 0 | ∇ g | 。"
"定理3.1设具有不等式约束的优化问题(1.1)的解集 Ω * 是非空的， ∇ f 是单调的且Lipschitz连续的，Lipschitz常数为 | ∇ f | ；g是凸可微的且Lipschitz连续的，Lipschitz常数为 | g | 。设对任意 t → ∞ 满足 ‖ u ( t ) ‖ ≤ C 0 ， ∇ g 是Lipschitz连续的，Lipschitz常数为 | ∇ g | ， Q ⊆ R n 是闭凸集合。则当 α 2 ( | ∇ f | + C 0 | ∇ g | ) 2 + | g | 2 < 1 2 时，微分方程系统(3.1)的轨迹 x ( t ) 的聚点是具有约束不等式约束的优化问题(1.1)的解。 证明：在变分不等式(3.2)中令 y = x * ∈ Ω * ，有 〈 x ˙ + α ( ∇ f ( x ¯ ) + ∇ g ( x ¯ ) u ¯ ) , x * − x − x ˙ 〉 ≥ 0. (3.8) 在变分不等式(3.4)中令 y = x + x ˙ ，可得 〈 x ¯ − x , x + x ˙ − x ¯ 〉 + α 〈 ∇ f ( x ¯ ) , x + x ˙ − x ¯ 〉 − α 〈 ∇ f ( x ¯ ) − ∇ f ( x ) , x + x ˙ − x ¯ 〉   + α 〈 ∇ g ( x ¯ ) u ¯ , x + x ˙ − x ¯ 〉 − α 〈 ∇ g ( x ¯ ) u ¯ − ∇ g ( x ) u ¯ , x + x ˙ − x ¯ 〉 ≥ 0 , 通过不等式(3.7)，上述不等式变为 〈 x ¯ − x , x + x ˙ − x ¯ 〉 + α 〈 ∇ f ( x ¯ ) , x + x ˙ − x ¯ 〉 + α 〈 ∇ g ( x ¯ ) u ¯ , x + x ˙ − x ¯ 〉 + ( α C 2 ) ‖ x − x ‖ 2 ≥ 0. (3.9) 其中， C = | ∇ f | + C 0 | ∇ g | 。将不等式(3.8)与(3.9)相加可得 〈 x ˙ , x * − x − x ˙ 〉 + 〈 x ¯ − x , x + x ˙ − x ¯ 〉 + α 〈 ∇ f ( x ¯ ) , x * − x ¯ 〉   + α 〈 ∇ g ( x ¯ ) u ¯ , x * − x ¯ 〉 + ( α C ) 2 ‖ x ¯ − x ‖ 2 ≥ 0. (3.10) 由于g是凸的，有 〈 ∇ g ( x ¯ ) u ¯ , x * − x ¯ 〉 = 〈 u ¯ , J g ( x ¯ ) ( x * − x ¯ ) 〉 ≤ 〈 u ¯ , g ( x * ) − g ( x ¯ ) 〉 . (3.11) 因此。由(3.10)和(3.11)可得 〈 x ˙ , x * − x − x ˙ 〉 + 〈 x ¯ − x , x + x ˙ − x ¯ 〉 + α 〈 ∇ f ( x ¯ ) , x * − x ¯ 〉   + α 〈 u ¯ , g ( x * ) − g ( x ¯ ) 〉 + ( α C ) 2 ‖ x ¯ − x ‖ 2 ≥ 0. (3.12) 由于g是凸的，则由(2.11)式可得 〈 ∇ f ( x * ) , x − x * 〉 + 〈 u * , g ( x ) − g ( x * ) 〉 ≥ 0 , ∀ x ∈ Q . 在上式中令 x = x ¯ ，对 α > 0 有 α 〈 ∇ f ( x * ) , x ¯ − x * 〉 + α 〈 u * , g ( x ¯ ) − g ( x * ) 〉 ≥ 0. (3.13) 将(3.12)和(3.13)相加，得 〈 x ˙ , x * − x − x ˙ 〉 + 〈 x ¯ − x , x + x ˙ − x ¯ 〉 + α 〈 ∇ f ( x ¯ ) − ∇ f ( x ∗ ) , x * − x ¯ 〉   + α 〈 u ¯ − u * , g ( x * ) − g ( x ¯ ) 〉 + ( α C ) 2 ‖ x ¯ − x ‖ 2 ≥ 0. (3.14) 接下来，令(3.3)中 v = u * ，令(3.5)中 v = u + u ˙ ，分别得到 〈 u ˙ , u * − u − u ˙ 〉 − α 〈 g ( x ¯ ) , u * − u − u ˙ 〉 ≥ 0 (3.15) 和 〈 u ¯ − u , u + u ˙ − u ¯ 〉 − α 〈 g ( x ¯ ) , u + u ˙ − u ¯ 〉 + α 〈 g ( x ¯ ) − g ( x ) , u + u ˙ − u ¯ 〉 ≥ 0 (3.16) 将不等式(3.15)和(3.16)相加，利用不等式(3.6)得 〈 u ˙ , u * − u − u ˙ 〉 + 〈 u ¯ − u , u + u ˙ − u ¯ 〉 − α 〈 g ( x ¯ ) , u * − u ¯ 〉 + ( α | g | ) 2 ‖ x ¯ − x ‖ 2 ≥ 0. 由于 〈 u ¯ , g ( x * ) 〉 ≤ 0 和 〈 u * , g ( x * ) 〉 = 0 ，将上述不等式写成 〈 u ˙ , u * − u − u ˙ 〉 + 〈 u ¯ − u , u + u ˙ − u ¯ 〉 + α 〈 g ( x * ) − g ( x ¯ ) , u * − u ¯ 〉 + ( α | g | ) 2 ‖ x ¯ − x ‖ 2 ≥ 0 (3.17) 将(3.14)和(3.17)相加，考虑到映射 ∇ f 的单调性，有 〈 x ˙ , x * − x − x ˙ 〉 + 〈 u ˙ , u * − u − u ˙ 〉 + 〈 x ¯ − x , x + x ˙ − x ¯ 〉   + 〈 u ¯ − u , u + u ˙ − u ¯ 〉 + α 2 ( C 2 + | g | 2 ) ‖ x ¯ − x ‖ 2 ≥ 0. 得到 〈 x ˙ , x * − x 〉 − ‖ x ˙ ‖ 2 + 〈 u ˙ , u * − u 〉 − ‖ u ˙ ‖ 2 + α 2 ( C 2 + | g | 2 ) ‖ x ¯ − x ‖ 2   + 〈 x ¯ − x , x + x ˙ − x ¯ 〉 + 〈 u ¯ − u , u + u ˙ − u ¯ 〉 ≥ 0. (3.18) 通过下面的范数和内积等式 1 2 d d t ‖ x − x * ‖ 2 = 〈 x ˙ , x − x * 〉 , 1 2 d d t ‖ u − u * ‖ 2 = 〈 u ˙ , u − u * 〉 , 〈 x ¯ − x , x + x ˙ − x ¯ 〉 = 1 2 ‖ x ˙ ‖ 2 − 1 2 ‖ x ¯ − x ‖ 2 − 1 2 ‖ x + x ˙ − x ¯ ‖ 2 , 和 〈 u ¯ − u , u + u ˙ − u ¯ 〉 = 1 2 ‖ u ˙ ‖ 2 − 1 2 ‖ u ¯ − u ‖ 2 − 1 2 ‖ u + u ˙ − u ¯ ‖ 2 , 不等式(3.18)变为 1 2 d d t ‖ x − x * ‖ 2 + 1 2 d d t ‖ u − u * ‖ 2 + 1 2 ‖ x ˙ ‖ 2 + 1 2 ‖ u ˙ ‖ 2 + ( 1 2 − α 2 ( C 2 + | g | 2 ) ) ‖ x ¯ − x ‖ 2   + 1 2 ‖ x + x ˙ − x ¯ ‖ 2 + 1 2 ‖ u ¯ − u ‖ 2 + 1 2 ‖ u + u ˙ − u ¯ ‖ 2 ≤ 0. 考虑到 α 2 ( | ∇ f | + C 0 | ∇ g | ) 2 + | g | 2 < 1 2 ，将上述不等式从 t 0 到t积分 1 2 ‖ x − x * ‖ 2 + 1 2 ‖ u − u * ‖ 2 + 1 2 ∫ t 0 t ‖ x ˙ ‖ 2 d τ + 1 2 ∫ t 0 t ‖ u ˙ ‖ 2 d τ + α 0 ∫ t 0 t ‖ x ¯ − x ‖ 2 d τ + 1 2 ∫ t 0 t ‖ u ¯ − u ‖ 2 d τ   + 1 2 ∫ t 0 t ‖ x ¯ − x − x ˙ ‖ 2 d τ + 1 2 ∫ t 0 t ‖ u ¯ − u − u ˙ ‖ 2 d τ ≤ 1 2 ‖ x 0 − x * ‖ 2 + 1 2 ‖ u 0 − u * ‖ 2 , 其中 α 0 = 1 2 − α 2 ( C 2 + | g | 2 ) 。 很容易看出 x ( t ) 和 u ( t ) 都是收敛的轨迹，而且，下面的积分当 t → ∞ 时是收敛的 ∫ t 0 t ‖ x ˙ ‖ 2 d τ < ∞ , ∫ t 0 t ‖ u ˙ ‖ 2 d τ < ∞ , ∫ t 0 t ‖ x ¯ − x ‖ 2 d τ < ∞ , ∫ t 0 t ‖ u ¯ − u ‖ 2 d τ < ∞ . 假设对所有的 t ≥ t 0 ，存在 ε > 0 使得 ‖ x ˙ ( t ) ‖ ≥ ε ， ‖ u ˙ ( t ) ‖ ≥ ε ， ‖ x − x ¯ ‖ ≥ ε 和 ‖ u − u ¯ ‖ ≥ ε 。则这与积分当 t → ∞ 时是收敛的相矛盾。所以，存在子列 { t i } ，当 t i → ∞ 时有 ‖ x ˙ ( t i ) ‖ → 0 ， ‖ u ˙ ( t i ) ‖ → 0 ， ‖ x ( t i ) − x ¯ ( t i ) ‖ → 0 和 ‖ u ( t i ) − u ¯ ( t i ) ‖ → 0 。由于 x ( t ) 和 u ( t ) 都是有界的，所以 x ( t i ) 和 u ( t i ) 也是有界的。选择 x ( t i ) 和 u ( t i ) 的子列 x ( t i j ) 和 u ( t i j ) ，则存在 x ′ 和 u ′ 使得 x ( t i j ) → x ′ ， u ( t i j ) → u ′ ， ‖ x ( t i j ) − x ¯ ( t i j ) ‖ → 0 ， ‖ u ( t i j ) − u ¯ ( t i j ) ‖ → 0 ， ‖ x ˙ ( t i j ) ‖ → 0 和 ‖ u ˙ ( t i j ) ‖ → 0 。 在(3.1)中取 t i j ，令 j → ∞ 取极限得 x ′ = Π Q ( x ′ − α ( ∇ f ( x ′ ) + ∇ g ( x ′ ) u ′ ) ) , u ′ = Π + ( u ′ + α g ( x ′ ) ) , 根据命题2.2，上式表明 x ′ ∈ Ω * 是具有不等式约束的凸优化问题(1.1)的解。证毕。 □"
"本节给出下面的算例说明微分方程方法的有效性。 例：求解优化问题 min f ( x ) s .t . g ( x ) ≤ 0 x ∈ R + 5 (4.1) 其中 f ( x ) = 2 − x 1 x 2 x 3 x 4 x 5 / 120 ， g ( x ) = ( x 1 − 1 , x 2 − 2 , x 3 − 3 , x 4 − 4 , x 5 − 5 ) T 。本例在Hock和Schittkowski [ 4 ] 中研究过，其最优解为 x * = ( 1 , 2 , 3 , 4 , 5 ) T 。 应用微分方程方法(3.1)，取 α = 1.5 ，得到从四个随机初始点的微分方程系统的路径的轨迹图如下： 图1. 问题(4.1)的微分方程系统的轨迹 x ( t ) 和 u ( t ) 的收敛情况 上图1说明微分方程系统(3.1)的轨迹 x ( t ) 收敛于优化问题的解 x * = ( 1 , 2 , 3 , 4 , 5 ) T 。"
"本文给出了具有不等式约束条件的优化问题的微分方程方法，并给出算例说明该方法的可行性。"
