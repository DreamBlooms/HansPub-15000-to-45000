"本文针对与电网连接的非隔离电力电子装置安全运行要求，提出了一种基于振荡电路和微分电路的漏电流检测和保护方法。这种漏电流保护电路由互感器、自激振荡器、二阶有源低通滤波电路和微分检测电路及系统中现有的控制芯片组成。将漏电流检测电路检测到的漏电流信号通过设备中的数字控制芯片采样，采样得到的漏电流值与安全标准中规定值进行比较，从而可形成分级保护，而对于过大的漏电流，则通过所研究的漏电流检测电路中的微分电路与软件实现快速的保护。最后通过应用于电机驱动器前端的三相双向PWM整流器中的实验验证了这种漏电流检测和保护方法的有效性。 关键词 :非隔离电力电子装置，漏电流检测，保护，数字控制 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着现代电力电子技术的迅速发展，电力电子装备已广泛应用于通讯、电力、机械、冶金等领域。为了避免电力电子设备对电网产生的谐波污染，能实现网侧能量的回收及网侧的单位功率因数，大多电力电子设备中采用了双向PWM变换器作为网侧能量变换的接口电路 [ 1 ] [ 2 ] 。近年来，随着智能电网的发展，尤其是在中大功率应用场合，三相可逆PWM整流器已广泛应用到并网发电、电动汽车充电设施、电机驱动器和光伏储能设备中，为了获得小体积、轻重量、低成本和高性价比，在这些网侧变换器中常采用非隔离电路拓扑 [ 3 ] [ 4 ] 。考虑到光伏、电力电子设备及电网地之间存在共模漏电流，如果在异常情况下出现过大会危害人身安全及设备本身的安全可靠运行，故电气电工和并网规范中对网侧变换器的漏电流提出了严格的保护要求 [ 5 ] 。 对于共模漏电流的抑制方法研究，目前国内外学者已做了大量的工作，但对于漏电流检测和保护方法的研究较少报道。对于共模漏电流抑制方法主要是从调制技术及电路拓扑改进实现的 [ 6 ] [ 7 ] ，但是由于控制器的控制方式、器件特性及环境等其它不同因素的影响，抑制漏电流的方法均有不同程度的局限性，故也无法完全消除其漏电流隐患。若不能准确检测出漏电流并进行快速保护的话，尤其当漏电流超出人体安全等级时会导致人员的触电事故。因此有必要对非隔离的网侧变换器增设漏电检测电路，并实施快速的保护算法，从而确保系统的安全可靠运行和人身的安全 [ 8 ] 。 为此，文献 [ 8 ] 将漏电流的检测信号经数字控制芯片采样后，再由控制芯片中的有效值计算子程序得到漏电流的有效值，用所计算出来的正弦漏电流有效值与控制器中事先设定好的阈值进行比较以产生相应的动作。但这种方法缺点在于，当出现漏电流过大的情况时，这种方法不能及时的进行快速保护，故增加了操作人员触电的风险，及造成系统安全可靠性的降低。针对这种情况，本文提出了一种基于振荡电路和微分电路的漏电流检测和保护方法。这种方法是在继承了文献 [ 8 ] 的漏电流检测原理基础上，增加了微分检测电路以实现漏电流的快速保护，有效减少了来自漏电流检测电路的漏电流有效值计算到实施保护动作的延时时间，从而降低了操作人员的触电风险，增强了网侧变换器系统的安全可靠性。"
"论文中提出的漏电流检测保护电路如图1所示，漏电流检测保护电路主要由漏电流检测互感器、自激振荡电路、两个二阶有源低通滤波电路、采样调理电路、微分检测保护电路和数字控制器的AD通道构成。当网侧变换器出现漏电流时，由自激振荡电路在漏电流检测互感器副边绕组上产生高频振荡信号，反射到漏电流检测互感器原边绕组成为低频漏电流的载波信号，将低频漏电流传输到漏电流检测互感器的副边，因此副边的电流i s 包含高频信号和低频的漏电流信号，i s 经漏电流检测电阻变成电压信号u s 送入两个二阶有源低通滤波器，经低通滤波器滤去高频振荡信号后可得到低频的漏电流信号，再经采样调理电路后送到数字控制器的AD采样通道。然后由软件实现相应的计算、逻辑判断和保护功能。图1中的微分检测保护电路可实现过大漏电流的快速保护功能 [ 9 ] 。 图1. 漏电流检测保护电路总原理图 1) 自激振荡电路工作原理 分析图2中自激振荡电路，在本文中Q2和Q3分别为NPN和PNP型三极管，电阻R24 = 30 kΩ，R13 = 100 kΩ。U1、U2为LM2903、U3为TL074，U1、U2、U3均作比较器使用。假设U3输出为高电平此时三极管Q2导通，Q3关闭，此时Q2与Q3中点电压为+12 V，通过电阻串联分压原理可知U1同相输入端电压和U2反相输入端电压为2.77 V，同时Q2与Q3中点电压也会向漏电流检测互感器的副边线圈进行充电，当互感器副边线圈达到饱和状态时，电流出现上翘，电阻R s 上的电压突然变大，使得U1反相输入端电压和U2的同相输入端电压变大且超过2.77 V。由于U1和U2是比较器，故U1反相端输入电压大于同相输入端电压时，U1输出低电平−10 V，且经过R21和R22串联分压后送到U3同相输入端的电位仍为负；与此同时，U2同相输入端电压大于反相输入端电压时，U2输出为高电平，U2的输出被电阻R23和R25上拉到Q2与Q3的中点电位(+12 V)，U2的输出经电阻R23与U3反相输入端相连，由于U3的同相输入端和反相输入端存在“虚短”，故运放U3的反相输入端电压会被拉到接近于U3同相输入端的电压，但运放反相输入端的电流不可能太大，故U3反相输入端电压仍大于U 3 的同相输入端电压，所以U3输出为低电平，此时三极管Q2关断，Q3导通，Q2与Q3中点电压变为−12 V，漏电流检测互感器副边线圈反向充电。 图2. 自激振荡电路 同理，当副边线圈反向充电到饱和时，U1输出高电平0电位(通过R21和R22上拉)，即运放U3的同相输入端为0电位，此时U2输出电压为−10 V，所以U3输出高电平，故Q2与Q3中点电压再次变为+12 V。综上分析，由比较器U1和U2、运放U3、Q2和Q3和检测线圈的副边绕组构成了自激振荡器，自激振荡器的正、负脉冲宽度是一样的。且容易知道该振荡器的自激振荡频率与漏电流检测互感器的磁芯饱和特性、漏电流检测电阻R s (将漏电流变成电压信号)和漏电流的大小有关，但电路一旦确定后则振荡频率只与漏电流的大小有关。 2) 二阶有源低通滤波电路工作原理 如图3所示，文中研究的漏电流检测电路中采用了两个相同的二阶有源低通滤波器。式(1)给出了二阶有源低通滤波器电路的传递函数。 图3. 二阶有源低通滤波电路 A ( s ) = V o ( s ) V i ( s ) = A V F 1 + ( 3 − A V F ) s C R + ( s C R ) 2 (1) 由式(1)知二阶有源低通滤波器的增益不能大于3，否则不稳定。以第一级二阶有源滤波电路来说明，式(1)的增益可由式(2)计算。 A V F 1 = 1 + R 54 R 56 (2) 截止频率采用式(3)计算： f c 1 = 1 2 π C 51 ⋅ C 53 ⋅ R 11 ⋅ R 51 (3) 电阻R54、R56和运放U4构成一个同相比例放大电路，R11、C51和R51、C53构成两级RC滤波电路。U4的输出端与U4同相输入端之间引入一个负反馈，在不同的频段，反馈的极性会发生改变，当自激振荡的频率f大于截止频率f c 时，两级RC滤波电路会移相到−180˚，使得电路的输入电压与输出电压的相位相反，此时U4输出端经过电容C51到U4同相输入端的反馈是负反馈。负反馈作用于输入端使得输入信号减小，同时电压放大倍数减小，所以二阶低通有源滤波器的幅频特性在高频段迅速衰减，只能通过低频信号。论文中采用了两个同样架构的二阶低通有源滤波器实现自激振荡电路产生的高频载波信号，从而得到低频的漏电流检测信号。 3) 微分检测保护电路的工作原理 微分检测保护电路如图4，主要由电容C1，R1，D1，R2，R3，C2，R4和NPN型三极管Q1及其相关电路构成。自激振器的高频率信号会经微分电容C1传输到D1的阳极，经D1，R3为电容C2充电，R1和R2分别是电容C1和C2的泄放电阻，R3就电容C2的限流电阻，R4是三极管Q1的基极限流电阻，+3 V是基准电压，R5和R61取值相等，从而可在采样调理电路中运放U6的同相端形成1.5 V的直流偏置电压。由于D1的单向导电性，仅使得自激振荡器中的高频正脉冲信号能量经C1为电容C2充电，此时自激振荡器中的高频正脉冲信号通过电阻R3为电容C2充电，故充电时间常数由R3和C2决定；而自激振荡器中的高频负脉冲信号期间，电容C2中的能量则经R3和R2进行泄放，故放电时间常数由R2，R3和C2决定，显然电容C2放电时间较其充电时间慢。 图4. 微分检测保护电路 当自激振荡器的频率不够高时，电容在高频正脉冲期间所充能量会在高频负脉冲期间放完，或致使电容C2上的电压不足以开通三极管Q1，此时采样调理电路中运放U6的同相端形成1.5 V的直流偏置电压；当自激振荡的频率足够高时，电容C2的充电频率变快，故其在高频正脉冲时所充的能量不能在高频负脉冲期间得以充分泄放，则致使电容C2上积聚的电压足以使得Q1导通，从而使得采样调理电路中运放U6的同相端拉低到0电位。可见，微分检测保护电路的作用是根据自激振荡器的频率是否足够高，来决定采样调理电路中是否加入直流偏置电压。 图1中的采样调理电路是由运放6构成的射极跟随器，而运放6的同相端叠加了来自有源低通滤波器的低频漏电流信号，和由微分检测保护电路决定的直流偏置电压信号，并通过运放6的输出端将这一叠加后的信号送到数字控制器AD采样通道。  论文中研究的漏电流检测保护方法有两种响应方式。 1) 漏电流较小时的响应 当漏电流较小时，由上述分析知，自激振荡器产生的正负振荡脉冲信号的频率不足以使得微分检测保护电路中的Q1导通，从而使得漏电流信号叠加+1.5 V的直流偏置电压后经采样调理电路送入数字控制器的AD采样口，数字控制中的数据处理程序会减去+1.5 V的直流偏置电压后，以得到实际的正弦漏电流值，再经有效值子程序计算出漏电流的有效值。然后在程序中与设置好的阈值进行比较以决策是否产生相应的保护动作。 2) 漏电流较大时的响应 当电流互感器中的漏电流超过设定安全阈值时，控制器需要快速检测到过大漏电流并对系统进行保护动作，以确保操作人员的人身安全。当漏电流较大时，由上述分析知，自激振荡器产生的正负振荡脉冲信号的频率足以使得微分检测保护电路中的Q1导通，从而使得采样调理电路中运放的同相端为0电位，而二阶有源低通滤波器产生的漏电流信号被阻断，使得送入DSP控制器的AD采样值为零。由所述程序中的计算方法知，此时将会是按1.5 V固定数值进行有效值的计算，这要比计算相对较小的正弦漏电流信号有效值迅速，且在程序中获得了很大的电流有效值(被当作此时漏电流的实际值)，故能迅速得到一个较大的漏电流数值与预置的阈值进行比较，从而迅速产生相应的保护动作。图5给出了漏电流检测保护程序流程图。 图5. 漏电流检测保护程序流程图"
"图2中自激振荡电路的部分参数已在2.1节中给出，这里仅给出漏电流检测互感器的设计方法。 1) 磁芯选取 电流检测互感器磁环材料选德国VAC公司的Nanocrystalline (纳米晶)材料，型号为W539。 2) 计算原副边绕组匝数 磁环外径OD = 19 mm，内径ID = 15 mm，高度HD = 5 mm。因漏电流检测互感器在检测电路中有自激振荡电路，故按自激振荡电路中的最低频率设计，设f s = 2.5 kHz，T s = 400 µs，加在驱动互感器原边的方波电压正幅值V c = 12 V，取最大工作磁密B m = 0.82 T，则磁环有效截面积为A e ： A e = ( OD-ID ) ⋅ HD = 20   mm 2 (4) 磁环表面积Q为： Q = π ⋅ ID 2 4 = 176.7   mm 2 (5) 互感器原边匝数为N 1 ： N 1 = V c ⋅ T s 4 B m ⋅ A e = 73.171 (6) 取原边绕组N 1 = 73匝。 自检绕组N 2 是检测上电时CPU的IO口产生的50 mA的精准电流，用以模拟漏电流，若CPU中检测出这一电流是50 mA，则认为漏电流检测保护电路无故障，否则该检测电路故障，程序不会进入Normal状态。为了计算方便不妨取自检绕组N 2 = 10匝。相线绕组和自检绕组一样，对于CPU产生的50 mA低频电流信号，都需要通过原边绕组N 1 中的高频载波信号调制才得以传输，所以不妨取相线匝数N 3 = N 4 = N 5 = N 6 = 1匝。 3) 线径选取 设漏电流最大值为I N 3 = 300 mA，则绕组N 1 中的电流I N 1 为： I N 1 = I N 3 N 1 ⋅ N 3 = 4.11   mA (7) 取N 1 绕组线径为d 3 = 0.3 mm，电流密度J = 1 A/m 2 则导线截面积S d 3 为0.071 mm 2 ，原边绕组N 1 并绕股数nn1： n n 1 = I N 1 J ⋅ S d 3 = 0.058   m − 2 ⋅ kg − 1 ⋅ s 2 (8) 并绕股数nn1 = 0.058，取nn1 = 1股线。 自检绕组N 2 电流为I N 2 = 50 mA，不妨取线经与绕组N 1 一样，同理可得副边绕组N 2 ： n n 2 = 50 ⋅ 10 − 3 J ⋅ S d 3 = 0.707   m − 2 ⋅ kg − 1 ⋅ s 2 (9) 并绕股数nn2 = 0.707，取nn2 = 1股线。 相线绕组N 3 、N 4 、N 5 、N 6 中的电流按25 A有效值计算，则导线截面积S d 4 取4 mm 2 。 n n 3 = 25 J × S d 4 = 6.25   m − 2 ⋅ kg − 1 ⋅ s 2 (10) 通过计算可知相线绕组N 3 、N 4 、N 5 、N 6 并绕股数nn3 = 6.25，取nn3 = 1股线。由此计算变压器的窗口系数k为： k = N 1 ⋅ n n 1 ⋅ S d 3 + N 2 ⋅ n n 2 ⋅ S d 3 + 4 N 3 ⋅ n n 3 ⋅ S d 4 Q = 0.078 (11) 小于0.3，可以绕下。  根据文中的二阶有源低通滤波器的原理进行设计。如图3所示，U4、U5、U6为运算放大器TL074，其中R51 = R5 = R56 = 10 kΩ，R11 = R52 = 22.1 kΩ，R53 = 6.49 kΩ，R55 = 20 kΩ，R57 = 13 kΩ，C51 = C52 = C53 = C54 = 10 nF。第一级滤波电路参数计算方法如下： 通带增益为： A V F 1 = 1 + R 54 R56 = 2 (12) 截止频率： f c 1 = 1 2 π C51 ⋅ C53 ⋅ R11 ⋅ R51 = 1.071   kHz (13) 第二级滤波电路参数计算： 通带增益为： A V F 2 = 1 + R55 R57 = 2.538 (14) 截止频率： f c 2 = 1 2 π C52 ⋅ C54 ⋅ R 52 ⋅ R53 = 1.329   kHz (15) 所以两个二阶有源低通滤波电路放大倍数为： A V F = A V F 1 ⋅ A V F 2 = 5.077 (16)  如图4所示，对于微分电路的设计的关键在于对R2、R3和C2组成的RC电路进行参数设计。自激振荡器产生幅值为±12 V的脉冲振荡信号，当振荡频率较高时，振荡信号经过隔直电容C1和二极管D 1 ，因此在一个振荡周期内，可以认为在R2两端加上幅值为12 V的方波激励。当振荡频率较低时，隔直电容C1阻碍振荡信号。RC电路如图6所示。 考虑漏电流较大的情况，选择自激振荡周期为160 µs进行计算，其中振荡信号为正幅值的时为80 µs，在给电容C2进行充电时RC电路处于一阶零状态响应，故C2的充电电压在一个周期内，应满足式(17)，使开关管Q1工作在饱和导通的状态，其中Q1的导通电压U on = 0.6 V，U CE = 3.3 V，得到式(19)关系。 { u c ( 80   μs ) = 12 ⋅ ( 1 − e − 80 ⋅ 10 − 6 τ 1 ) ≥ 0.6   V u c ( 80   μs ) ≥ 3.3   V (17) 图6. RC电路 τ 1 = R 3 ⋅ C 2 (18) τ 1 = R 3 ⋅ C 2 ≤ 2.5 ⋅ 10 − 4 (19) 本文选取电阻R 3 = 10 kΩ，电容C 2 = 10 nF，电容C 2 准备放电时刻的初始电压为 u c ( 80   μs ) ，对于电容C 2 的放电过程，可以认为是一阶零输入响应，此时电容C 2 上的放电电压应满足式(20)，经过80 µs的放电时间，此时电容C 2 上电压值要大于三极管的导通电压，使得Q1处于饱和导通状态。 u c ( 160   μs ) = u c ( 80   μs ) e − 80 ⋅ 10 − 6 τ 2 ≥ 3.3   V (20) τ 2 = ( R 3 + R 2 ) ⋅ C 2 (21) 综合上述各式，可得如下关系式(22) τ 2 = ( R 3 + R 2 ) ⋅ C 2 ≥ 1.16 ⋅ 10 − 4 (23) 综合考虑，本文选取C 2 的容值取值C 2 = 10 nF，电阻R 3 取值为10 kΩ，电阻R 2 取值为2 kΩ。"
"在实验室现有的16 kW双向PWM整流器实验平台上，对本文提出的基于振荡电路和微分电路的漏电流检测和保护方法进行验证，数字控制在采用来自TI公司的TMS320F28335。在不同的漏电流情况下，自激振荡的频率会发生变化，在漏电流较小时，振荡周期约为400 µs，如图7所示；当漏电流较大时，振荡周期为160 µs，如图8所示。 图7. 漏电流较小时自激振荡波形 图8. 漏电流较大时自激振荡波形 图9是漏电流检测电路自激振荡波形，CH1：采样电阻R s 电压，CH2：U3 (TL074)输出端波形，CH3：U3同相端输入，CH4：U3反相端输入。当U3的同相端输入大于反相端输入时，U3输出高电平，当U3的同相端输入小于反相端输入时，U3输出低电平。 图9. 自激振荡波形 自激振荡器在正常工作的情况下，变压器绕组会存在叠加的高频方波，并且高频方波作为载波对原边漏电流进行调制，经过调制后电流互感器副边形成电流流到采样电阻R s ，在电阻R s 上会产生一个电压信号，经过两个二阶低通滤波器送到DSP的AD采样通道。当漏电流很大时，与电流互感器副边线圈电流叠加使得采样电阻R s 上的电压迅速变高，则自激振荡器的频率变高。高频振荡信号给电容C2充电达到一定电压，使得三极管Q1导通，此时U6同相端输入被拉到低电平，DSP的AD采样值为0 V，程序中计算漏电流值是将采样值减去了偏置1.5 V，故漏电流有效值的计算结果很大。在程序中认为是漏电流很大并很快实施漏电保护功能。实验中通过在直流输出端和地接电阻网络，模拟产生漏电流，如图10所示，CH1：A相电压波形，CH2：漏电流信号波形，CH3：A相电流，产生保护的时间仅为17.6 ms。 图10. 漏电流检测保护波形"
"针对三相双向PWM整流器应用于电机驱动器负载场合，本文提出一种基于振荡电路和微分电路的漏电流检测和保护方法。仅通过增加几个电子元器件构成微分检测保护电路，从而得到了漏电流的快速保护电路和方法，当漏电流检测互感器检测到过大漏电流时，通过微分检测保护电路可使程序中计算得到很大的漏电流有效值，从而实现快速保护功能。该方法可实现非隔离网侧变换器的低频漏电流的有效保护，保障操作人员的人身安全，提高系统设备运行的安全可靠性。这种漏电流保护方法具有低成本、高性价比等优点。"
