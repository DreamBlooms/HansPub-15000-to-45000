"随着科学技术的进步，成像观测技术越来越先进。流动成像测井方面，国外各大测井公司均推出了全井眼测量阵列持率测井仪，测量在井中相同深度上套管内壁附近或分布在不同半径的圆周上的局部持水率。基于电容阵列持水率测井仪CAT的测井数据特征，分析了简单距离反比加权插值、高斯径向基函数插值、普通克里金插值和克里金中的变差函数距离反比插值算法的原理，然后对4种插值算法在理论和实际应用方面进行了比较，试验数据成像处理效果图和误差综合分析结果表明，普通克里金插值算法的成像效果和误差估计总体比其他3种插值算法好，能较直观反映井内油水介质的分布和井筒截面上总的持水率值。 关键词 :水平井，阵列持水率仪，流动成像，生产测井"
"随着水平井钻采技术应用规模的快速扩大，对水平产出剖面测井的需求也日益迫切。持水率作为油井生产剖面评价的一个重要流动参数，对找准产水层位、采取措施提高油气产量至关重要。在水平井中多相流并不以混合状态存在，而是以水平层流为主的复杂流型，最重要的流动信息存在于沿井筒直径的垂直面上，通常用于垂直井中的常规生产测井仪器的各个传感探头居中并分散到井筒长距离内，使得其测量水平复杂状态的参数非常困难，常规生产测井仪器不再适用 [ 1 ] 。目前国内外文献报道的在水平井中应用较好的阵列持水率测井仪器主要有Flowview Plus (8个探头)、GHOST (4个探头)、DEFT (6个探头)、RAT (12个探头)和CAT (12个探头)等 [ 2 ] 。 阵列持水率成像测井属于对非均匀介质动态的非线性测量 [ 3 ] ，获取多相流体的二维分布信息，通过对油气井内多相流体在有限点分布信息的成像处理，实时成像显示整个井筒截面上的流体分布情况，实现流型辨识和确定相含率，克服传统测量技术难以解决的问题，为生产油井动态监测提供更精确的测井信息，成为解决油田动态监测难题的新“武器” [ 2 ] 。笔者以电容阵列持水率测井仪CAT的测井数据为例，探讨阵列持水率测井资料的成像插值算法，并结合试验资料予以验证，提高了阵列持水率测井资料解释精度。"
"CAT仪器是用来解决在水平井或大斜度井中区别井下流相的分布，它在井中居中测量，并且和井斜仪配合测量。由于油、气、水有不同的介电常数，每个探头的输出频率随着它周围流体的不同而变化，对仪器进行刻度可准确地鉴别探头周围流体的性质。仪器由12个特定的微小的电容传感器组成，并安装于每个弹簧弓里，每个探头测量其周围流体的介电常数，12个值同时传送给地面或存储单元，通过数据处理和仪器在油和水中的刻度将响应值转化为每个探头的局部持水率 [ 4 ] 。CAT仪器的12个探头均匀分布在井筒截面圆周上，为单环模式(见图1、图2)。根据12个探头的测井响应值对井截面进行插值成像，实际上就是根据12个探头的响应值对井筒截面上其他点的局部响应值进行插值估计，再根据井筒截面上持水率的高低分配以不同的颜色显示，展示出整个井筒截面上的流体分布情况。 上述插值成像的数据场可视化需要通过对离散数据场进行区域剖分，建立数学模型插值后，利用传统的计算机图形学方法加以显示，从而获取对数据场内部信息的观察。因此，利用图形学成像，插值是其中关键的一步，插值过程就是建立所研究变量完整的数学模型的过程。采用不同的插值方法建立的数学模型会有差别，后期对其规律的显示从效果上看也是不相同的 [ 5 ] 。数据场可视化常用的插值算法一般有简单距离反比加权插值算法、高斯径向基函数插值算法、普通克里金插值算法和克里金中的变差函数距离反比插值等。 图1. 电容阵列持水率测井仪CAT单环模式图 图2. CAT仪器12个探头的剖面分布示意  设P i (x i , y i )为井截面上的点坐标，D ij 为第i个CAT探头点到井截面上非探头点P j (x j , y j )的距离，T i 为CAT第i个探头测井响应值( )，T j 为井筒截面上非探头点P j (x j , y j )处的持水率预测值。假设CAT探头局部持率在井筒截面上的分布连续变化是合理的，那么点和点之间的关联性随着距离的增大而连续减小。简单距离反比加权的插值是就是基于源值对其他点的影响随着距离增大而减小考虑的，其插值原理是，井筒截面上待插值点预测的持水率值是待插点区域内已知CAT探头持水率值的加权平均，权系数的大小与待插点和区域内CAT探头位置之间的距离有关，是距离的k ( ) (k一般取2)次方的倒数。即： (1)  插值算法中权值是插值处理的关键 [ 6 ] ，高斯径向基函数是与距离有关的权系数计算函数，具有连续的一阶和二阶倒数，源点对周围点的影响程度随着距离的增大而平稳减小，且源点对周围点的影响程度在过了一定的范围后，随着距离的增大而迅速减小。该特性和CAT探头的测量值所反映的范围是有限的这个规律很相符。该次研究引用的高斯径向基函数 为： (2) 式中：r为待插点与CAT探头的距离；σ ij 为i、j这2点间的递减控制系数。 高斯径向基函数插值算法中，函数为权值系数，即井筒截面上待插值点预测的持水率为： (3)  克里金(Kriging)方法又称空间局部插值法，是以变差函数理论和结构分析为基础，在有限区域内对区域化变量进行无偏最优估计的一种方法，是地质统计学的主要内容之一。其实质是利用区域化变量的原始数据和变差函数的结构特点，对未知样点进行线性无偏、最优估计。无偏是指偏差的数学期望为0，最优是指估计值与实际值之差的平方和最小。 设 为区域上的一系列观测点， 为相应的观测值。区域化变量在x 0 处的值 可采用一个线性组合来估计： (4) λ i ( )为待求权系数，无偏性和估计方差最小被作为λ i 选取的标准，即： (5) 式中：E为数学期望；Var为方差。 从本征假设出发，可知E[Z(x)]为常数，有： (6) 可得到关系式： (7) 应用拉格朗日乘数法求条件极值，达到估计方差最小要求，即： (8) 式中：λ j 为拉格朗日乘子；μ为拉格朗日因子。 进一步推导，可得求解权系数λ i 的方程组： (9) 式中： 为协方差。 求出权系数后，就可以根据式(4)求出井截面上非探头点的持水率预测值。 当随机函数不满足二阶平稳，而满足内蕴(本征)假设时，可用待插点与已知采样点之间的变差函数γ(x i , x j )来表示式(9)： (10) 变差函数定义为： (11)  变差函数是克里金插值的基础。插值需要首先确定研究区域变量的变差函数。设z(x)是系统某属性z在空间位置x处的值，z(x)为一区域化随机变量，并满足二阶平稳假设；h为两样本点空间分隔距离，z(x i )和z(x i + h)分别是区域化变量z(x)在空间位置x i 和x i + h处的实测值[ ]。那么，变差函数γ(h)的离散计算公式为： (12)  变差函数理论模型一般分为有基台值和无基台值两大类。有基台值的变差函数理论模型包括球状模型、指数模型、高斯模型等。最常用的是球状模型 [ 5 ] ，球状模型公式为： (13) 式中：c 0 为块金(效应)常数；c为拱高；c 0 + c为基台值；a为变程。  在克里金插值法和简单距离反比插值法的基础上，可以将简单距离反比加权法中的距离函数改写成变差函数，加权系数仍为距离的函数(变差函数是距离的函数)，但是不按距离平方的倒数方式减小，而是按变差函数的性质来减小。具体表达形式如下： (14)"
"距离反比加权的插值是基于源点值对其他点的影响随着距离增大而较小考虑的，插值矩阵是恒定不变的，只与待插值点与源点的距离有关，源点之数值对待插点的影响没有考虑，权系数与源点相互之间没有任何关系，只要待插点和源点之间的距离一定，则其权系数是相同的。插值矩阵没有任何适应性，它不能更丰富地表达流体流动的特征，不能表现流量、含水和井斜对流型的影响 [ 6 ] 。但是，该模型简单，实现起来容易，效率最高，插值中所需存储空间最小。所以简单距离反比加权插值模型还是有一定的价值的。 高斯径向基函数插值是采用高斯函数作为权系数计算函数，它具有随距离衰减的特性。该算法通过递减控制系数σ ij 反映流量、井斜等因素对流型的影响。σ ij 的引入使得高斯径向基函数插值算法的插值矩阵对流量和井斜等特征有了一定的适应性。 变差函数距离反比插值是将距离反比加权的插值中的距离值用变差函数代替，这样，待插点与源点的距离越大，对应该点的权系数越小；和距离反比相似，但是不按距离平方的倒数方式减小，而是按变差函数的倒数减小，并且具有归一化的性质。使用该方法时，需先根据源点位置及源点测量值确定变差函数，失去了距离反比加权插值算法效率高的特点。 上述3种插值算法的权函数与距离的递减关系如图3所示。距离反比加权函数在整个区域是个凹函数，对距离太敏感，用它作为求取权系数的函数无法保证算法的相容性，它会导致插值矩阵成为病态矩阵。高斯径向基函数表示源点对周围点的影响程度随着距离的增大而平稳减小，当距离超过一定范围后迅速的减小。相对来说，它的特性比变差函数距离反比函数优秀，是对距离反比加权算法的一种有效改进。 普通克里金插值是先通过源点之间的距离和源点的测量值确定所研究区域的变差函数，然后通过求基于变差函数的克里金方程组得到克里金插值法的权系数。这种构性集中体现在探头测量值的变差函数(即测量值的协方差函数)中。权系数不仅与待插点到源点的距离有关，还与源点上的测量值有关，能更好地体现井筒截面流体的流动特性。"
"基于上述4种插值算法，采用VC++6.0开发平台，编写了CAT测井数据处理模块，可以实现探头测量值的显示、插值算法的选择及相关参数的调整(图4)。 图3. 距离反比加权、高斯径向基函数、变差函数距离反比函数对比图 图4. CAT插值成像数据处理模块 处理数据来自CAT在多相流动模拟装置上的油水两相试验采集结果，试验温度为13.66℃，压力约为0.2 MPa，介质为自来水和10号工业白油，试验井斜为90˚ (即井段处于水平状态)，油水总流量为100 m 3 /d，含水率分别为20%、40%、60%、80%。试验数据根据仪器在油和水中的刻度值将响应值转化为持水率，结果见表1。对该组数据分别利用简单距离反比加权插值算法、高斯径向基函数插值算法、普通克里金插值算法和克里金中的变差函数距离反比插值算法对其插值进行成像处理，持率成像处理结果与试验时流管侧面照片对比见图5。 对上述测井数据插值结果进行交叉验证，即依次删除一个探头的测井值，利用其他探头的测井值插值计算被删除探头的响应值，并对12个探头插值计算结果与实际测井值作比较，进行误差统计分析，分析结果见表2。 Table 1 含水率/% 12个CAT探头持水率/1 S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 S12 20 0.2000 0.2077 0.2311 0.2147 0.8729 1.0000 1.0000 1.0000 0.8729 0.2291 0.2070 0.2068 40 0.2342 0.2305 0.2692 1.0078 0.9927 1.0000 1.0000 1.0000 0.9925 0.9167 0.2655 0.2561 60 0.2342 0.2533 0.9923 1.0078 0.9927 1.0000 1.0000 1.0000 1.0000 1.0083 0.2655 0.2281 80 0.2684 0.2686 1.0000 1.0078 0.9853 1.0000 1.0000 1.0000 1.0000 1.0083 0.9927 0.2351 表1. 水平井12个CAT探头持水率 Table 2 插值算法 均方误差 绝对误差平均值 绝对误差的最大值 相对误差平均值/% 简单距离反比插值算法 0.101682692 0.0041429 0.084692601 1.512055807 高斯径向基函数插值算法 1.240119472 0.153101561 0.314889161 39.18046857 普通克里金插值算法 0.511993363 0.034415885 0.419793024 5.642565763 变差函数距离反比插值算法 0.703828473 0.04599213 0.290337584 14.20786734 表2. 插值算法交叉验证结果比较 图5. 不同含水率情况下CAT试验资料持水率成像处理结果与试验照片对比 从插值成像处理结果与试验时流管侧面照片对比来看，高斯径向基函数插值算法和变差函数距离反比插值算法能更好地反映油水分界面的位置，但成像色差代表的持水率明显没有简单距离反比插值算法和克里金插值算法计算结果好；简单距离反比插值算法和变差函数距离反比插值算法对距离太敏感，在探头位置附近收敛速度过快，出现持水率变小后形成的圆点；普通克里金插值算法分层能力较高斯径向基函数插值算法和变差函数距离反比插值算法稍差，但比简单距离反比插值算法好，成像色差代表的持水率明显比其他算法好。 从交叉验证结果看，简单距离反比插值算法的误差最小，其次是普通克里金插值算法，高斯径向基函数插值算法误差最大。高斯径向基函数插值算法和变差函数距离反比插值算法在水层和油层的持水率计算值误差较大。结合成像效果和误差估计总体比较可以看出，普通克里金插值算法优于其他算法的效果和指标。"
"阵列持水率测井仪采用多个探头测量井筒截面上不同方位的持水率，克服了常规单个探头测量值代表井筒截面持水率总体效应的确定，对于水平及大斜度井中由于重力影响造成油水分布出现各向异性有较好的应用效果。对其测井数据进行成像处理重建井筒过流截面油水分布图像，可以帮助测井解释人员直观了解井筒油水分布及流型。但由于井筒截面上阵列探头个数的局限，不同插值算法权系数的确定方法不同，造成成像效果差异较大。成像插值中建立的数据模型的关键是探头测量值与待插值之间的函数关系，要求既要反映井内介质的分布情况，又要符合井筒整个截面上总的持水率。通过水平井段4种含水情况下试验数据的处理分析结果表明，普通克里金算法的插值效果和误差结果优于其他算法。"
