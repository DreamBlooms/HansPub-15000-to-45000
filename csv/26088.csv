"选取2013~2015年的四川省814个国家级地面观测站降水资料和美国NOAA研发的CMORPH卫星反演降水产品，利用加法模型和乘法模型开展了降水资料的融合试验，并选用未参与融合试验的157个基准站降水数据对试验效果进行交叉验证。结果表明，CMORPH的加法融合结果与雨量计结果非常类似，而乘法模型则只能在四川局部地区与雨量计的降水情况相吻合，且加法模型的结果在四川省西部更多体现的是原CMORPH数据的特点，而乘法模型结果并无这一特点。交叉验证结果表明，CMORPH的加法融合结果与基准站所记录降水量的相关系数高、偏差和均方根误差都低，并且再次证明CMORPH的加法融合结果优于乘法模型结果。总的来说，加法融合模型在降水资料融合研究中具有较好的应用效果。 关键词 :CMORPH，融合，降水，四川省 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"不同来源的降水资料均存在数据覆盖不完整、明显的随机误差及不可忽略的系统误差等问题 [ 1 ] 。地面观测降水能较好代表某一点的降水量，但在大量无人居住地区的地面观测站很少，且地面观测降水在反映区域面降水特征时的误差与区域内降水样本数密切相关。利用红外和微波观测可获取全球范围大尺度的降水估计，国内外已开展了大量的卫星反演降水方法研究 [ 2 ] ，但由于样本选取、算法误差及卫星观测量和降水量之间的物理关系式很难被恰当选取，卫星反演降水通常存在较大的系统误差和随机误差 [ 3 ] ，在中高纬度获得较好的卫星反演降水产品更为困难。将不同来源降水资料进行融合，通常被认为是从整体上提高降水观测质量的最有效途径之一 [ 4 ] 。 通过遥感手段结合雨量计数据进行融合的方法主要分为全局性和区域性两种，全局性的方法就是简单地全局平均校准，但是不同地区的降水和地表条件又不相同，不同区域的卫星反演降水数据与地面实测数据之间肯定存在不同的空间关系，这样的方法就不能推而广之地应用；而区域性的方法考虑到了地区的特点，例如最优系数法 [ 5 ] 、最大似然估计方法 [ 6 ] 、泊松方程求解法 [ 7 ] 、反距离平方法 [ 8 ] 、阈值匹配降水指数法(Threshold-Matched Precipitation Index, TMPI) [ 9 ] 等。虽然各种方法有着各自的特点，但其中心思想是一致的，即首先都需要建立降水的背景场，然后在雨量计实测数据的基础上对背景场进行修正，使降水空间分布和降水量的精度得以提升，更多地展现真实降水的信息，从而得到一个降水估计场，这个估计场就是融合降水的目标，用来代表真实的降水信息。本章内容将在雨量计数据的基础上，利用加法和乘法融合模型对CMORPH和地面观测场数据进行融合，并结合GWR(地理加权回归，Geographically weighted regression)方法，建立融合模型，讨论在月尺度上的融合结果，评估融合降水数据的精度，分析融合数据与传统的插值方法的差异，提供适合四川省的融合降水模型。"
"本文融合试验使用的地面站点观测降水资料为四川省814个地面气象站日降水量观测数据(08:00~08:00，北京时，简称RSURF，下同)。使用的卫星反演降水为通过Internet实时收集的美国CPC研制的CMORPH卫星反演降水产品，该资料的原始时间分辨率为30 min，空间分辨率8 km。时间均为2013~2015年。 本文交叉验证用到的数据是未参与融合的157个基准站的降水观测数据，时间是2013年5~8月逐小时。"
"用P表示某个区域的真实降水场，P 0 表示地面有n个由雨量计所观测的降水数据，称之为观测场，同时还有另一个预先生成的降水初估场P b (或称之为背景场)。观测场的数据在定量方面精度高，但空间上比较离散，不连续；而初估场就是由空间分辨率不高的卫星反演降水数据通过某种方法所生成，空间上是连续的，但是定量的精度低，同时也能反映降水在空间上的分布格局。 在某个实测点处，降水的真实值、实测值和背景值之间的关系可以用下列两个表达式表示： P i = P b ( i ) + e b ( i ) ,       i = 1 , 2 , 3 , ⋯ , n (1) P i = P o ( i ) + e o ( i ) ,       i = 1 , 2 , 3 , ⋯ , n (2) 在(1)和(2)中， e b ( i ) 和 e o ( i ) 分别表示在实测点i所对应的降水背景误差(残差)和实测误差。将 e b 和 e o 的方差分别设定为 δ b 和 δ o ，根据加法模型的原理，假设两者相等，且 e o 的数学期望为0，那么在公式1和2的基础上，可得到如下的近似关系： P o ( i ) ≈ P b ( i ) + e b ( i ) ,       i = 1 , 2 , 3 , ⋯ , n (3) e b ( i ) ≈ P o ( i ) − P b ( i ) ,       i = 1 , 2 , 3 , ⋯ , n (4) 式(4)说明在拥有具体地表观测数据的位置，降水的背景误差可近似表达为观测场与初估场数据之差，即观测值可近似作为真实降水数据。在这个条件下，在没有地表实测数据的点，下文中用下标j表示，降水的背景误差 (其中， j = 1 , 2 , 3 , ⋯ , k , k < n )可利用实测点的降水数据与初估场数据之差进行拟合，即： e ^ b ( j ) = f [ P o ( 1 ) − P b ( 1 ) , P o ( 2 ) − P b ( 2 ) , P o ( 3 ) − P b ( 3 ) , ⋯ , P o ( n ) − P b ( n ) ] (5) 将(5)的背景场误差的估计值与背景场数据叠加，即对背景场数据进行修正，得到没有地表观测点处的降水估计值，也就是“加法模型”的融合结果，将其记为 P a ( j ) ，其表达式为： P a ( j ) = P b ( j ) + e ^ b ( j ) = P b ( j ) + f [ P o ( 1 ) − P b ( 1 ) , P o ( 2 ) − P b ( 2 ) , P o ( 3 ) − P b ( 3 ) , ⋯ , P o ( n ) − P b ( n ) ] (6) 在对 e ^ b 的计算中，一般不需要采用对每个观测点的降水值和背景场相应点之间的残差进行估计计算，只需要采用观测点的临近点即可。  乘法模型和加法模型的原理不同，假设条件也有着差异，但是两种模型的基本思路是类似的。第一步是在卫星反演降水数据的基础上生产一个分辨率较低的降水背景场，第二步计算地表观测点处的降水量与背景场值的比率因子；最后，估计没有测量点处的降水“真实值”与背景场值的比率因子，记为 r b 。在得到整个空间的 r b 后，再对背景场进行修正，获得降水的融合结果。 假设降水在观测点处，观测场、背景场以及真实场之间存在以下的数学关系： P ( i ) = r b ( i ) × P b ( i ) ,       i = 1 , 2 , 3 , ⋯ , n (7) P ( i ) = r o ( i ) × P o ( i ) ,       i = 1 , 2 , 3 , ⋯ , n (8) 在(7)和(8)中， r b ( i ) 代表地表实测点处的真实降水值与背景场值在该处的比例， r o ( i ) 代表真实降水值与观测场在该处的比例。根据“乘法模型”的假设条件，将 r o ( i ) 的数学期望定位1，其数学方差接近0，那么上面两式可用如下的近似公式表示： P o ( i ) ≈ r b ( i ) × P b ( i ) (9) r b ( i ) ≈ P o ( i ) / P b ( i ) (10) 公式(10)说明在有地表实测数据的位置，降水的真实场与背景值之间的比例因子可近似用观测值与背景值的比例因子表示。在此基础上，对于任意一个缺少地表雨量计观测数据的点，用下标j表示，设 r b ( j ) 为这些点的降水背景值的比例因子(其中， j = 1 , 2 , 3 , ⋯ , k , k < n )，那么 r b ( j ) 可用雨量计实测值与背景值之比进行估计，其表达式为： r ^ b ( j ) = f [ P o ( 1 ) / P b ( 1 ) , P o ( 2 ) / P b ( 2 ) , P o ( 3 ) / P b ( 3 ) , ⋯ , P o ( n ) / P b ( n ) ] (11) 将公式(11)中的比例因子估计值与卫星数据的背景值相乘，即得到没有观测点处的降水值，即融合降水结果，可用公式(12)表示其结果，其中 r ^ b 与“加法模型”中的 e ^ b 一样，不需要利用所有点的观测值进行计算，只需要选用其周边的若干点即可。 P a ( j ) = r ^ b ( j ) × P b ( j ) (12)  交叉验证方法采用常规的相关系数(CC)、偏差系数(BIAS)、均方根误差(RMSE)三个参数来表示基准站和融合结果的差异。 CC = ∑ i = 0 n ( G i − G ¯ ) * ( S i − S ¯ ) ∑ i = 0 n ( G i − G ¯ ) 2 * ∑ i = 0 n ( S i − S ¯ ) 2 ∗ 100 % (13) BIAS = ∑ i = 0 n S i ∑ i = 0 n G i (14) RMSE = ∑ i = 0 n ( S i − G i ) 2 n (15)"
"对2013~2015年的CMORPH数据进行加法融合，所有的36个月结果表明，加法融合结果与雨量计结果类似，但在某些地区仍然有不连续的现象，即融合结果未体现降水是一种空间现象，这和背景场与观测场的残差估算有关，因为在许多地区，雨量计不能做到观测，而背景场却有值，在这些区域，残差就会存在误差。选择2013年8月、2014年4月、7月及2015年3月和11月的数据作为CMORPH加法融合结果进行说明，从左至右依次是站点降水、未融合CMORPH数据及加法融合结果。 融合结果与雨量计的结果在大部分地区都比较类似，从图1还可知，在四川的东部地区，融合结果主要体现了雨量计的降水特点，四川西部地区则既有与未融合CMORPH数据类似的情况，如2013年8月，也有与雨量计数据类似的情况，如2015年11月，融合数据在降水的空间连续性上比未融合数据有优势，如2013年8月、2015年3月，降水在空间上更加连续，2013年8月在四川的东部存在一个降水的类似“曲线”区域。同时CMORPH本身对降水的测量存在着误差，比如CMORPH明显高估了2014年4月的中西部地区降水，而融合数据则对这一区域的降水存在着低估现象，又如在2014年的7月，CMORPH对四川从东北向西南的降水区域存在明显的探测误差，区域上向南方偏离许多，而融合数据对这一降水区域的空间判断准确的，但是范围相比于未融合CMROPH则偏大。 从3年的融合情况来看，融合数据对降水区域的判断是比较精准的，在这一点上，比未融合数据精确，而且在降水的空间连续性上比未融合数据更好，但其在某些区域对降水也存在量上的高估，这与融合方法是密切相关的，因为融合过程中涉及到引入经纬度和NDVI因子。由于目前并没有“十全十美”的融合方法，存在误差在所难免，对原数据精度进行提升，能得到比原卫星数据精度更高的融合数据也是目前的主要工作。  利用乘法模型对CMORPH进行融合，发现基于乘法模型的结果没有基于加法模型结果准确，这是由于在乘法模型中将经度、纬度和NDVI因子作为背景场的系数，这种做法将增加结果的不确定性，间接地将五个参数变为了一个参数，使最终结果易出现误差。选择三组数据作为融合结果进行说明，分别是2013年5月、2014年6月和2015年4月，从左至右依次是站点降水、未融合CMORPH数据及乘法融合结果(图2)。 在2013年5月，乘法融合数据能够反映降水在四川东部的分布，与雨量计的结果吻合，但是在四川的中部地区，低估了降水量，并且在降水的空间范围上也比雨量计的窄。相比较于未融合CMORPH数据，融合数据的精度已经比原数据高，例如在四川的西北部，未融合CMORPH数据明显高估了降水量，而在融合数组中，这种现象并不存在。在2014年6月，融合降水在四川的西部地区与雨量计的结果吻合，但是在四川东南地区，明显高估降水。与原数据相比，融合数据都具有在空间上更连续的特点，说明融合数据能够反映精细的、空间范围更小的降水情况。在2015年4月，融合数据在四川北部与南部与雨量计降水情况类似，但是明显在西部地区有一个高估降水量的情况，这和原CMORPH数据的空间分布基本吻合，也说明了其在作为降水背景场时，如果探测结果是正确的，那么就将增加融合降水的精度，如果其在某些区域存在误差，那么这种误差就有可能被带到融合数据中，从而影响融合结果。"
"图3是CMORPH的加法和乘法模型融合结果在2013年5月~8月与基准站的散点图，从左至右依次 图1. CMORPH加法融合结果 图2. CMORPH乘法融合结果 是基准站与未融合CMORPH的散点、基准站与加法模型的散点、基准站与乘法模型的散点，表1是原CMORPH数据和两种融合数据的偏差、均方根误差和相关系数。从散点的分布上可知，在2013年5月，加法模型的融合效果明显比乘法模型结果更好，相关系数分别为76%和62%，乘法模型的相关系数比原CMORPH的65%还低，三种数据的均方根误差类似，均在47 mm上下，加法模型和乘法模型所反演的降水比基准站的降水量低，两者的偏差均在1以下，其次，从散点中也可知，散点偏向X轴，也说明了基准站降水量比反演值高。2013年6月的加法模型融合结果散点集中分布在对角线上，其相关系数为86%，比原始CMORPH数据的64%以及乘法模型的73%高很多，其偏差为0.97，与基准站数据非常接近，且其均方根误差只有27.78 mm，而另外两种数据都超过了100 mm。2013年7月的加法模型融合结果的相关系数为79%，比乘法模型的64%高，且偏差只有1.05，比另外两种数据在雨量上更接近基准站，乘法模型高估了降水量，偏差值达到了0.5，偏离真实值太多，而原数据的偏差为0.83，比乘法模型高。2013 图3. 2013年5~8月CMORPH、加法模型、乘法模型融合结果与基准站散点图(单位：mm) 年8月的CMORPH和乘法模型下的CMORPH数据都高估了降水量，偏差分别为0.7与0.68，与基准站差距过大，而加法模型中，偏差为0.94，且相关系数为81%，比另外两种数据高。 结合散点图和三个数据参数可知，对CMORPH，从2013年5月~8月的加法融合模型结果比乘法融合模型精度高很多，乘法模型在某些月份的精度甚至不如原数据。 Table 1 时间 偏差 均方根误差(单位：mm) 相关系数 5月 CMORPH：0.96 加法模型：0.8 乘法模型：0.76 CMORPH：48.48 加法模型：47.8 乘法模型：47.58 CMORPH：65% 加法模型：76% 乘法模型：62% 6月 CMORPH：1.07 加法模型：0.97 乘法模型：0.53 CMORPH：123 加法模型：27.78 乘法模型：104.96 CMORPH：64% 加法模型：86% 乘法模型：73% 7月 CMORPH：0.83 加法模型：1.05 乘法模型：0.5 CMORPH：159.3 加法模型：122.5 乘法模型：156.94 CMORPH：70% 加法模型：79% 乘法模型：64% 8月 CMORPH：0.7 加法模型：0.94 乘法模型：0.68 CMORPH：79.25 加法模型：72.73 乘法模型：70.3 CMORPH：71% 加法模型：81% 乘法模型：65% 表1. CMORPH、加法模型、乘法模型融合降水与基准站偏差、均方根误差和相关系数"
"本章内容借助地面雨量计、经纬度、NDVI因子，对CMORPH降水产品进行了融合，所采用的融合模型有两种，一是加法模型，二是乘法模型，这两种融合方法是目前降水融合中运用比较广泛的两种方法。结合GWR方法，计算地理因子和卫星反演降水产品在每个点的参数，不同于以往的地理因子只有一个参数，此处的地理因子在空间上都有其对应的与其空间分辨率相同的参数矩阵，充分考虑了每个点的差异，两种模型的方法虽然大同小异，但是结果却有着较大差异，很难直接定义哪一种方法更好，因为在某些时候加法模型融合效果好，某些时候乘法模型的融合效果更佳，总体而言，加法模型的结果优于乘法模型。最后挑选未参与融合的2013年5月~8月的四川省基准站157个数据作为验证标准，对CMORPH数据的融合结果进行检验，本章的结论可总结如下： 1) CMORPH的加法融合结果与雨量计结果非常类似，而乘法模型则只能在四川局部地区与雨量计的降水情况相吻合，且加法模型的结果在四川省西部更多体现的是原CMORPH数据的特点，而乘法模型结果并无这一特点。 2) CMORPH的加法融合结果与基准站所记录降水量的相关系数高、偏差和均方根误差都低，并且再次证明CMORPH的加法融合结果优于乘法模型结果。"
