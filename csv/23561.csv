"本文讨论跳扩散过程下期权定价模型的偏积分微分方程的隐–显三阶SBDF时间离散格式。我们引入参数 c ∈ [ 0 , 1 ] ，使由跳跃产生的零阶项变成一个关于 c 的凸组合，并将其分别加入到隐式部分和显式部分；并应用傅里叶分析研究该方法的稳定性。在适当的假设条件和时间步长限制下，我们证明了隐–显三阶SBDF方法对于所有的 c ∈ [ 0 , 1 ] 是条件稳定的。数值实验表明了该方法的有效性。 关键词 :隐–显方法，线性多步法，跳扩散模型，期权定价，傅里叶稳定性分析 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"期权作为一种重要的金融衍生产品，在当前的金融市场中非常活跃。1973，F. Black和M. Scholes [ 1 ] 提出著名的Black-Scholes模型。但Black-Scholes模型忽略了一些市场特征，如市场跳跃和崩溃，而这些是应该考虑的重要事件。 1976，R. Merton [ 2 ] 将一个跳跃项添加到Black-Scholes模型中。相较于连续路径模型，跳扩散模型允许标的资产的价格发生大的突变。在文献 [ 3 ] 中，S.G. Kou介绍了具有对数双指数型分布的跳扩散模型。在更为一般的CGMY模型 [ 4 ] 中，标的资产价格是满足可能发生无限次跳跃的Levy过程。 跳扩散模型的解可以通过求解一个偏微分积分方程(PIDE)获得。求解PIED的直接数值法在文献 [ 5 ] [ 6 ] 中已有讨论。然而直接法通常是要解一个全矩阵，这需要大量的计算，因此，应考虑其他数值方法。D. Tavella和C. Randall [ 7 ] 描述了欧式期权定价模型的一种定常迭代方法。S. Salmi和J. Toivanen [ 8 ] 提出了跳扩散模型下美式期权定价的一种迭代方法。U. Ascher，S. Ruuth与B. Wetton [ 9 ] 介绍了随时间变化的偏微分方程的隐–显方法，包括隐–显三阶SBDF法。J. Frank，W. Hundsdorfer和J. Verwer [ 10 ] 分析了隐–显线性多步法的稳定性。S. Salmi和J. Toivanen [ 11 ] 讨论了跳扩散模型下期权定价问题的一些隐–显二阶方法。 在本文中，我们讨论Kou跳扩散模型下美式期权定价的隐–显三阶SBDF方法，并把零阶项表示成凸组合的形式，该思想在文献 [ 11 ] 中有过介绍；然后用傅立叶分析研究该方法的稳定性；最后用数值实验表明该方法的有效性。"
"在风险中性测度下，标的资产价格 x 满足下面随机微分方程 d x x = ( μ − λ κ ) d t + σ d W + ( η − 1 ) d q , (1) 其中 μ 是漂移率， σ 是波动率， d W 是标准布朗运动， η − 1 是标的资产从 x 跳跃到 η x 所产生的脉冲函数， κ = E [ η − 1 ] ，其中 E [ ⋅ ] 表示期望算子， d q 是参数为 λ 的独立泊松过程。 令 v ( x , t ) 表示执行价格为 K 的美式期权价格。若定义 L v : = v τ − 1 2 σ 2 x 2 v x x − ( r − λ κ ) x v x + ( r + λ ) v − λ ∫ 0 ∞ v ( x η , τ ) g ( η ) d η , (2) 则 v ( x , t ) 可表示为如下偏微分积分互补问题的解 { L v ( x , t ) ≥ 0 , v ( x , t ) − v * ( x , t ) ≥ 0 , L v ( x , t ) ( v ( x , t ) − v * ( x ) ) = 0 , (3) 其中 T 是到期日， τ = T − t ， x ∈ [ 0 , ∞ ) ， τ ∈ [ 0 , T ) ， r 是无风险利率， g ( η ) 是跳跃幅度的概率密度函数，并且满足 ∫ 0 ∞ g ( η ) d η = 1 。本文中，我们讨论Kou模型。Kou模型下， g ( η ) 满足对数双指数分布 g ( η ) = p η 1 exp ( − η 1 η ) H ( η ) + q η 2 exp ( η 2 η ) H ( − η ) , (4) 其中 η 1 > 1 ， η 2 , p , q > 0 ， p + q = 1 ， H ( η ) 是赫维赛德阶跃函数。则 κ 可表示为 κ = E ( η − 1 ) = p η 1 η 1 − 1 + q η 2 η 2 + 1 − 1 . (5) 若考察美式看跌期权，则还需施加下面的边界条件 v ( 0 , t ) = K , v ( X , t ) = 0 , (6) 其中 X 满足 X ≫ K 。同时， v ( x , t ) 也应满足终值条件 v ( x , T ) = v * ( x ) = max { K − x , 0 } , (7) 其中 v * ( x ) 为美式看跌期权的支付函数。 为了简单表示，我们把(2)式改写为如下形式 L v = v τ − D v − λ J v + λ v , (8) 其中微分算子 D 和积分算子 J 定义为 { D v : = 1 2 σ 2 x 2 v x x + ( r − λ κ ) x v x − r v , J v : = ∫ 0 ∞ v ( x η , τ ) g ( η ) d η . (9)"
"下面，我们引入参数 c ∈ [ 0 , 1 ] ，使得(8)式的零阶项 λ v 形成一个凸组合，则(8)式改写为 L v = v τ − ( D − λ ( 1 − c ) I ) v − λ ( J − c I ) v , (10) 其中 I 是恒等算子。 当 L v = 0 时，我们可以引出隐–显三阶SBDF (semi-implicit backward differentiation formula)时间步长法，即 11 6 v m + 1 − 3 v m + 3 2 v m − 1 − 1 3 v m − 2 = Δ τ λ ( J − c I ) ( 3 v m − 3 v m − 1 + v m − 2 ) + Δ τ ( D − λ ( 1 − c ) I ) v m + 1 , (11) 其中 v m = v ( m Δ τ ) ， D 和 J 是(10)式空间离散所生成的矩阵。对于该方法的更一般情形请参考文献 [ 9 ] 。 参数 c ∈ [ 0 , 1 ] 的引入，使得我们得到了一族隐–显三阶SBDF方法(每固定一个 c ，即得到一个确定的隐– 显三阶SBDF法)。对于空间的离散，我们采用有限差分法，关于具体的离散过程请参考文献 [ 8 ] 。 我们用傅立叶分析研究数值格式的稳定性。有限差分格式称为稳定的，如果初始误差不随着时间的推移而被放大。一个方法当 Δ τ → 0 时是稳定的，则称该方法为(零)稳定的。这种方法的解在有限时间内保持有界。然而，在实际情况中，时间步长是固定大小的，为了获得最佳计算效率，人们通常希望选择最大可能的时间步长来获得所需的精度水平。零稳定是该方法的必要条件，但在实际计算中并不是充分的。满足稳定性所需的实际时间步长对于刚性问题或者拥有两个以上时间层次的方法尤其受限制。最坏的情况是，一个方法可以是零稳定的，但是对于任意固定的 Δ τ > 0 都是不稳定的。 一个方法当 Δ τ 小于一个给定的正值时是稳定的，则称该方法是条件稳定的。这是一个更严格的要求，因为条件稳定的必然是零稳定的。但一个方法的稳定性区域往往难以精确找到。通常的方法是将该方法应用于线性试验方程，并分析其稳定性。对于隐–显方法，线性试验方程为 v ′ ( τ ) = υ B v ( τ ) + υ C v ( τ ) . (12) 其中 υ B 和 υ C 分别表示显式部分和隐式部分的复特征值。 对偏微分积分方程(2)应用线性逼近法，我们得到常微分方程的半离散线性系统 v ′ ( τ ) = D v ( τ ) + J v ( τ ) − λ v ( τ ) , τ ≥ 0 . (13) 使用交换矩阵可以很容易把试验方程(12)的稳定性结果推广到线性系统中。文献 [ 10 ] 讨论了可交换框架下隐–显格式的稳定性分析。然而， D 和 J 一般是不可交换的。更甚至，在许多实际应用中，基于线性测试方程时间步长的限制，即便在非可交换的情况下也可能是准确的(见文献 [ 12 ] )。下面，我们将应用线性测试方程(12)分析隐–显三阶SBDF格式(11)的稳定性。  隐–显线性多步法的稳定性是由下列特征方程的根决定的 ∑ i = 0 l a i ζ l − i = υ B ∑ i = 1 l b i ζ l − i + υ C ∑ i = 0 l c i ζ l − i , (14) 其中 a i ， b i 和 c i 是隐–显方法的系数， l 表示涉及到的前面节点个数(见文献 [ 10 ] )。该方法称为稳定的，如果所有的根满足 | ζ | ≤ 1 ，并且当根为重根时不等式严格成立。我们采用文献 [ 10 ] 中的方法，对方程(14)两边同时除以 ζ k ，并令 z = 1 ζ 。则特征方程变为 A ( z ) = υ B B ( z ) + υ C C ( z ) , (15) 其中 A ， B 和 C 为 A ( z ) = ∑ i = 0 l a i z i , B ( z ) = ∑ i = 1 l b i z i , C ( z ) = ∑ i = 0 l c i z i . (16) 如果所有根满足 | z | ≥ 1 ，并且重根时不等式严格成立，则稳定性成立。它的一个必要条件是 A ( z ) − υ B B ( z ) + υ C C ( z ) ≠ 0 , A ( z ) − υ B B ( z ) + υ C C ( z ) ≠ 0 . (17) 除去模1存在多重根的可能性外，这也是一个充分条件。 对于隐–显三阶SBDF法(11)，特征方程(15)中的各项为 A ( z ) = 11 6 − 3 z + 3 2 z 2 − 1 3 z 3 , B ( z ) = 3 z − 3 z 2 + z 3 , C ( z ) = 1 . (18) υ B 和 υ C 由下面两式得到 Δ τ λ ( J − c I ) v = υ B v , Δ τ ( D − λ ( 1 − c ) I ) v = υ C v . (19) 令特征值 υ J 和 υ D 为 J v = υ J v , D v = υ D v . (20) 则满足 υ B = Δ τ λ ( υ J − c ) , υ C = Δ τ [ υ D − λ ( 1 − c ) ] . (21) 把(18)和(21)代入到特征多项式(15)中，有 11 6 − 3 z + 3 2 z 2 − 1 3 z 3 = Δ τ ( υ J − c ) ( 3 z − 3 z 2 + z 3 ) + Δ τ [ υ D − λ ( 1 − c ) ] . (22) 从上式中解得 υ J υ J = c + 1 3 z − 3 z 2 + z 3 [ 1 λ Δ τ ( 11 6 − 3 z + 3 2 z 2 − 1 3 z 3 ) + ( 1 − c − υ D λ ) ] . (23) 设 z = e θ i ，代入到(23)式中，并令 θ 在 [ 0 , 2 π ] 间变化，我们可以得到 υ J 稳定区域的边界值。图1表示当 υ J = 0 时，隐–显三阶SBDF方法的稳定性边界。图中绿球表明可能的特征值区域 | υ J | ≤ 1 。这表明隐–显三阶SBDF方法当 λ Δ τ < 10 21 时，对于任意的 c ∈ [ 0 , 1 ] 都是稳定的。 现在我们研究隐–显三阶SBDF方法的稳定性区域。我们假设 J 没有因为区间截断而产生误差。因此 J 为非负右随机矩阵。另一个选择是假设 J 有截断误差并且是非负定的。在这种情况下，可由Gershgorin圆定理得 | υ J | < 1 成立。因此，模1的根是不存在的，并且即便 J 不是右随机的，下面的结论仍是成立的。我们假设 J 不存在截断误差。 图1. 当 υ D = 0 ，隐–显三阶SBDF法对于 c = { 0 , 0.5 , 1 } 下的稳定性边界，左边图为 λ Δ τ = 1 ，中间图为 λ Δ τ = 2 3 ，右边图为 λ Δ τ = 10 21 由文献 [ 11 ] ，我们得到如下引理 引理1：如果 J 是严格正定的，那么 | υ J | ≤ 1 成立并且模1的根是单根。 命题1：如果 J 是严格正定的， r ， λ ≥ 0 ，那么对于实数 υ D ≤ 0 ，隐–显三阶SBDF法对于所有 λ Δ τ < 10 21 和 c ∈ [ 0 , 1 ] 是条件稳定的。 证明：特征方程满足(23)式，即 υ J = c + 1 3 z − 3 z 2 + z 3 [ 1 λ Δ τ ( 11 6 − 3 z + 3 2 z 2 − 1 3 z 3 ) + ( 1 − c − υ D λ ) ] . 由引理1得 | υ J | ≤ 1 。假设 | z | < 1 并且方程(23)式成立。下面我们将推导出矛盾。令 k = 1 λ Δ τ > 2.1 ， z = a + b i ( − 1 < a < 1 , − 1 < b < 1 , a 2 + b 2 < 1 ) ， m = − υ D λ ≥ 0 。方程(23)两边同时乘以 z ，得 υ J ⋅ z = c z + 1 3 − 3 z + z 2 [ k ( 11 6 − 3 z + 3 2 z 2 − 1 3 z 3 ) + ( 1 − c + m ) ] = ( z − 1 3 − 3 z + z 2 ) c + 11 6 − 3 z + 3 2 z 2 − 1 3 z 3 3 − 3 z + z 2 k + 1 3 − 3 z + z 2 m + 1 3 − 3 z + z 2 . (24) 现在我们证明 Re ( υ J ⋅ z ) ≥ 1 ，也就说明 | υ J ⋅ z | ≥ 1 。由(24)式可知， υ J ⋅ z 由4部分组成，下面我们分别讨论参数 c ， k 和 m 部分的实部情况。首先考虑 m 的系数 1 3 − 3 z + z 2 = 1 3 − 3 ( a + b i ) + ( a 2 − b 2 + 2 a b i ) = ( 3 − 3 a + a 2 − b 2 ) + ( 3 b − 2 a b ) i ( 3 − 3 a + a 2 − b 2 ) 2 + ( 3 b − 2 a b ) 2 . 其实部 ( 3 − 3 a + a 2 − b 2 ) ( 3 − 3 a + a 2 − b 2 ) 2 + ( 3 b − 2 a b ) 2 > 0 , 这说明 Re ( υ J ⋅ z ) 关于 m 是单调递增的。接下来考察 c 的系数 z − 1 3 − 3 z + z 2 = a + b i − 1 3 − 3 ( a + b i ) + ( a 2 − b 2 + 2 a b i ) , 其实部 a − ( 3 − 3 a + a 2 − b 2 ) ( 3 − 3 a + a 2 − b 2 ) 2 + ( 3 b − 2 a b ) 2 < 0 , 这说明 Re ( υ J ⋅ z ) 关于 c 是单调递减的。最后讨论 k 的系数，并令 d = z z ¯ = a 2 + b 2 ，有 11 6 − 3 z + 3 2 z 2 − 1 3 z 3 3 − 3 z + z 2 = 11 z ¯ − 18 d + 9 d z − 2 d z 2 6 ( 3 z ¯ − 3 d + d z ) , 经计算，其实部 ( 11 a − 18 d + 9 a d − 2 ( a 4 − b 4 ) ) ( 3 a − 3 d + a d ) + ( 11 b − 9 b d + 4 a b d ) ( 3 b − b d ) 6 ( 3 a − 3 d + a d ) 2 + 6 ( 3 b − b d ) 2 > 0 , 这说明 Re ( υ J ⋅ z ) 关于 k 是单调递增的。综合上面分析可得如下不等式成立 Re ( υ J ⋅ z ) > Re ( υ J ⋅ z ) | m = 0 , c = 1 , k = 2.1 . 经计算，有 Re ( υ J ⋅ z ) − 1 > 0 。 上述分析说明 Re ( υ J ⋅ z ) > 1 ，因此 | υ J ⋅ z | > 1 。这导致 | υ J | | z | > 1 ，即 | υ J | > 1 | z | > 1 ，与引理1矛盾。因此，不存在 | z | < 1 使得(23)式成立，这表明稳定性的必要条件(17)式是满足的。同时这也是充分的，因为引理1保证了模1的根都是单根。 □ 在Kou模型下， J 对于任意带正权的积分都是严格正定的。我们可以从命题1中得到以下推论。 推论1：如果 υ D ≤ 0 ，那么隐–显三阶SBDF法在Kou模型下，对于所有 λ Δ τ < 10 21 和 c ∈ [ 0 , 1 ] 都是条件稳定的。  在上面的分析中，我们假设 υ D ≤ 0 。特征值 υ D 为非正实数的一个充分条件是： D 是三对角矩阵并且是M-矩阵。在 r ≥ 0 的情况下，M-矩阵的性质可以通过在模型中添加人工扩散来实现(见 [ 13 ] )。 我们分析了 υ D = 0 情况下的稳定性。图2表示当 υ D = − 1 8 ， υ D = − 1 和 υ D = − 4 时隐–显三阶SBDF法的稳定性区域。对于任意实数 υ D < 0 ，稳定性区域都是增加的。这表明在适当的假设条件下，特殊情况 υ D = 0 可以看作是稳定性条件满足的最坏情况。"
"本节中，我们讨论由隐–显三阶SBDF法计算所得的数值结果。我们应用文献 [ 13 ] 中提到的方法来 图2. 当 λ = 1 2 ， λ Δ τ = 1 时，隐–显三阶SBDF法对于 c = { 0 , 0.5 , 1 } 下的稳定性边界，左边图为 υ D = − 1 4 ，中间图为 υ D = − 1 ，右边图为 υ D = − 4 计算美式看跌期权，并选取惩罚因子 ε = 10 − 4 。Kou模型下的美式看跌期权参数如下 σ = 0.15 , r = 0.05 , T = 0.25 , K = 100 , λ = 0.1 , α 1 = 3.0456 , α 2 = 3.0775 , p = 0.3445 . 这些参数也在文献 [ 6 ] 和 [ 13 ] 中使用过。我们使用 [ 13 ] 中描述的期权价格作为参考价格(见表1)。 我们把区间 [ 0 , X ] 作 n 等分，并令 X = 400 。迭代的终止条件为 ‖ v l − v l + 1 ‖ < 10 − 8 。计算空间节点 x i = { 90 , 100 , 110 } 处的均方根误差(RMSE)。RMSE更准确的表示为： RMSE = ( ( v 1 − v 1 * ) 2 + ( v 2 − v 2 * ) 2 + ( v 3 − v 3 * ) 2 ) / 3 ，其中 v i * 和 v i 分别表示在节点 x i = { 90 , 100 , 110 } 处的参考价格和计算所得价格。先验选择的凸组合参数为 c = { 0 , 0.5 , 1 } 。 表2、表3和表4分别表示当 c = { 0 , 0.5 , 1 } 时的数值实验结果，类似的思想可见文献 [ 14 ] 和 [ 15 ] 。 Table 1 模型 v ( x = 90 ) v ( x = 100 ) v ( x = 110 ) KOU 10.005071 2.807879 0.561876 表1. 数值实验的参考价格 Table 2n m x i = 90 的误差 x i = 100 的误差 x i = 110 的误差 RMSE 200 80 −5.0712e−4 −3.6114e−3 −5.6112e−4 2.1303e−3 400 160 −4.2847e−4 −1.1047e−3 −1.5973e−4 6.9031e−4 800 320 −3.8520e−5 −3.7678e−4 −4.7168e−5 2.2036e−4 1600 640 −1.3619e−5 −1.4210e−4 −1.4438e−5 8.2840e−5 表2. 当 c = 0 时的数值结果 Table 30. n m x i = 90 的误差 x i = 100 的误差 x i = 110 的误差 RMSE 200 80 −5.0713e−4 −5.2720e−3 −1.4840e−3 3.1756e−3 400 160 −4.6344e−4 −1.9258e−3 −6.2564e−4 1.1993e−3 800 320 −6.1876e−5 −7.8592e−4 −2.8082e−4 4.8317e−4 1600 640 −2.5018e−5 −3.4641e−4 −1.3139e−4 2.1439e−4 表3. 当 c = 0.5 时的数值结果 Table 4n m x i = 90 的误差 x i = 100 的误差 x i = 110 的误差 RMSE 200 80 −5.0713e−4 −6.9449e−3 −2.4058e−3 4.2534e−3 400 160 −4.9028e−4 −2.7500e−3 −1.0913e−3 1.7314e−3 800 320 −8.5083e−5 −1.1958e−3 −5.1442e−4 7.5317e−4 1600 640 −3.6358e−5 −5.5090e−4 −2.4832e−4 3.4951e−4 表4. 当 c = 1 时的数值结果"
"我们讨论了(2)式中当 L v = 0 时所形成的偏微分积分方程的隐–显三阶SBDF方法，并引入其零阶项 λ v 的凸组合，使其形成一族算法。通过傅里叶稳定性分析，可知该方法对于所有 λ Δ τ < 10 / 21 和 c ∈ [ 0 , 1 ] 都是条件稳定的。数值实验表明，当 c = 0 时该方法能得到最好的计算精度。因此，我们可以应用 c = 0 时的隐–显三阶SBDF方法对Kou跳扩散模型下的美式期权进行定价。"
