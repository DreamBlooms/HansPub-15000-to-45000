"像控点是航空像片进行几何纠正及地理定位时重要的基准数据源，为了实现航空摄影中像控点的快速定位，本文通过研究基于相位一致性原理的异源影像匹配，将像控点标定在目标航空影像上，并以湖南省某区域不动产成果数据为例对本文的算法进行对比实验论证算法的有效性。 关键词 :相位一致性，像控点，异源影像，标定 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"近年来，随着摄影测量技术在生产生活中的不断应用，大量像控点信息被采集整理用于影像纠正及定位，并将其纳入数据库系统进行管理 [ 1 ] [ 2 ] ，大大方便了航空摄影测量作业。然而，像控成果的应用却仍以目视判别为主，在目标航空影像中人工判别像控点所在地面位置，耗时耗力、作业量大且判别效率与精度较低 [ 3 ] ，成为制约摄影测量生产效率的重要因素之一。计算机视觉技术的不断深入研究与应用使影像的精确识别正逐步成为可能。诸多学者对影像的机器识别技术进行了深入研究，基于特征的多源影像特征关系匹配技术实现多源遥感影像的匹配 [ 4 ] [ 5 ] 。对多源影像进行基于灰度的多级概率松弛整体匹配，实现了SPOT全色和TM多波段影像的配准 [ 6 ] 。计算机视觉技术的研究为目标定位提供了坚实的技术支撑 [ 7 ] ，但基于计算机视觉技术的点目标精确定位方法却鲜有研究，并未形成有效的技术方案体系。 针对上述问题，本文以快速定位像控点为研究目标，通过对像控点影像与目标航空影像匹配及像控点在目标航空影像上的精确标定方案进行深入研究，提出一种基于相位一致性原理的像控点精确标定算法，有效实现像控点在目标航空影像中的精确定位，通过实验对本文研究的算法进行分析以确定该算法的可靠性、稳定性与准确性。"
"利用目标航空影像的POS数据及像控点坐标在目标航空影像中对像控点进行初步定位并建立目标航空影像的匹配窗口，将像控点影像与该窗口影像进行匹配后在目标航空影像中标定像控点。算法实施主要包括四个步骤：建立匹配窗口、特征点检测、特征点匹配及像控点标定。  为加速算法运行速度，保证匹配结果精度，在进行影像匹配前需要建立目标航空影像的影像匹配窗口。匹配窗口建立步骤为： 1) 定位像控点：利用共线方程结合POS数据将像控点地理坐标换算以像主点为原点的像平面坐标，再将其换算为影像像素行列号，由于目标航空影像在成像时与像空间辅助坐标系存在相对旋转，因此首先将像平面坐标进行旋转变换，变换公式为： { x = x cos ( k ) − y sin ( k ) y = x sin ( k ) − y cos ( k ) (式1) 式中k 表示外方位元素中的Z轴旋转角， 表示旋转后像平面坐标，得到像平面坐标后再将其换算为影像行列号，换算公式为： { H = x + i m a g e l / 2 L = y + i m a g e c / 2 (式2) 式中 ( H , L ) 表示像控点所在行列号， ( x , y ) 表示像控点的像平面坐标， ( i m a g e l , i m a g e c ) 分别表示影像的长度与宽度。 2) 裁剪匹配窗口：以第1)步计算行列号对应像素为中心，裁剪800*800像素大小的影像作为匹配窗口，参与下一步影像匹配。  由于像控点影像数据来源与目标航空影像不同，其亮度、对比度及纹理等信息具有明显差异，针对异源影像的匹配采用相位一致性特征点检测算法 [ 8 ] ，该方法选取6个方向和4个度的Log-Gabor小波变换，计算相位一致性测度 P C ( θ ) ，得到最大矩M，计算公式为： M = 1 2 ( c + a − b 2 − ( a − c ) 2 ) a = ∑ ​ ( P C ( θ ) cos ( θ ) ) 2 (式3) b = 2 ∑ ​ ( P C ( θ ) cos ( θ ) ) ∗ ( P C ( θ ) sin (θ)) c = ∑ ​ ( P C ( θ ) sin ( θ ) ) 2 其中，对于影像上的任意点 ( x , y ) ，若该点最大矩 M > T 1 ，则该位置为边缘点。其中，T1为边缘点检测阈值。对最大矩M后进行归一化处理，将归一化处理结果乘以灰度最大值255从而生成基于相位信息的边缘影像，突出影像边缘信息，再结合FAST角点提取算法对该影像进行角点提取即可得到影像特征点。  对2.2中提取出的特征点建立特征描述符：采集特征点统计梯度方向直方图生成近似的特征描述符，具体步骤为： 1) 以特征点为中心选择100*100的图像区域作为特征区域； 2) 对特征区域进行划分，使其成为25*25的16个子区域； 3) 每个子区域统计4个方向的梯度方向直方图，16个子区域共得到64维的特征向量作为特征描述符。 对异源影像匹配采用归一化相关函数作为匹配测度进行匹配，归一化相关函数公式为： dis ( k i , k j ) = 〈 k i , k j 〉 | k i | ∗ | k j | (式4) 其中， k i , k j 分别表示影像的两个特征描述符。 由于异源影像差异往往较大，匹配测度的单一极值点不一定是正确的匹配点，造成一定量的误匹配点存在，因此，需要在已匹配的点对的基础上利用随机抽样一致性算法(RANSAC)对匹配点进行剔除提纯，剔除误匹配点，得到正确匹配的特征点对。  利用正确匹配的特征点对结合最小二乘原理可求得仿射变换模型的六个参数，建立像控点影像块中像控点行列号与目标航空影像中像控点行列号的映射关系。最后根据仿射变换公式将像控点影像块中的像控点位置换算至目标航空影像，完成像控点在目标航空影像上的标定。仿射变换公式为： { X = a 1 x + a 2 y + a 3 Y = b 1 x + b 2 y + b 3 (式5) 其中， ( x , y ) 为像控点在像控点影像块上的坐标， ( X , Y ) 表示像控点在目标航空影像上的坐标， a 1 , a 2 , a 3 , b 1 , b 2 , b 3 是目标航空影像与像控点影像之间的仿射变换参数。 由像控点的在像控点影像上的行列号坐标，并将此坐标代入式5中即可计算出像控点在目标航空影像上的行列号坐标，完成像控点在目标航空影像上的标定。"
"实验以湖南省某区域不动产成果数据作为测试数据，实验数据包括航空影像及相应POS数据、原始航空影像的相机参数及区域内像控成果资料。原始影像航空大小为11,704*7920像素大小，图1为航空影像。  1) 建立影像匹配窗口 实验首先建立影像匹配窗口，在目标航空影像上裁剪出500*500像素大小的影像作为影像匹配窗口，图2、图3中图3(a)为目标航空影像裁剪之后的影像匹配窗口，图3(b)为与目标航空影像对应的像控点影像，从图上可以看出目标影像匹配窗口与像控点影像成像差异较大，纹理不一致，为异源影像。 图1. 原始影像 图2. 实验数据1 2) 特征提取与特征匹配 使用本文的算法对实验数据进行特征提取与特征匹配，结果图如图4、图5所示，从图中可以看出本文的特征提取与特征匹配算法匹配结果较为正确，对于角点及拐点的检测较为准确，经过随机抽样一致性算法对匹配点对进行剔除提纯得到的匹配点对少而精确，为了为确定本文研究算法优劣，使用sift特征匹配算法与本文研究的算法进行对比，图6、图7为sift特征匹配算法的匹配结果图，图6匹配结果大致正确，但存在少量的误匹配点，且得到的匹配点对数较多，图7匹配的点对较少，且出现匹配错误，实验可以看出本文的算法对异源影像匹配具有较好的稳定性。 3) 像控点标定 利用正确匹配的特征点对计算影像匹配窗口与像控点影像的仿射变换参数，由仿射变换参数及像控点坐标计算出像控点在影像匹配窗口的位置，本文的算法标定结果如图8所示，由图8可以看出本文算 图3. 实验数据2 图4. 匹配结果1 图5. 匹配结果2 图6. Sift特征算法匹配结果 图7. Sift特征算法匹配结果2 图8. 实验数据2 图9. Sift特征算法标定结果 法能够精确地将像控点标定在目标航空影像上，sift算法标定结果如图9所示，像控点P00201在影像匹配窗口上的标定存在误差，像控点P00200由于影像匹配失败，导致像控点P00200在影像匹配窗口没有标定结果。从标定结果可以看出，本文的特征提取与特征匹配算法计算出的影像匹配窗口与像控点影像的仿射变换参数正确，因此标定结果精确。"
"像控点目标精确标定是实现像控点重复利用、提高航空摄影测量作业效率的技术基础，对于提高摄影测量技术的高效性与实时性具有重要意义。本文采用相位一致性原理有效实现像控点影像与目标航空影像两种异源影像精确匹配，并将匹配结果应用于目标航空影像的像控点精确标定，使用湖南省某区域不动产成果资料进行实验分析，实验结果表明基于相位一致性原理的像控点精确标定算法能够准确快速地完成目标航空影像的像控点精确标定工作，减少航空影像处理中像控刺点的工作量，提高作业效率。"
