"空气是人类及生物赖以生存的条件，因此清洁的空气对人类显得尤为重要。但是，近年来随着我国工业和交通运输业的发展，大量的污染物被排放到空气中，空气质量每况愈下，空气质量问题也越来越受到政府和公众的关注。为了探究空气质量与哪些污染物密切相关以及它们之间的关系，本文选取西安作为实例，收集了2013年12月~2018年4月西安空气质量数据 [ 1 ] ，主要包括空气质量指数(AQI)及PM2.5、PM10、SO 2 、CO、O 3 等含量，应用R软件进行回归分析。首先利用2013年12月~2017年6月的空气质量数据进行建模，并对模型进行显著性检验，然后利用2107年7月~2018年4月的数据进行AQI指数的预测，以此来检验模型的好坏。 关键词 :空气质量，回归分析，显著性检验，AQI指数预测 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"工业的快速发展与城市化导致我国的空气污染形势日益严峻。近年来，我国有越来越多的城市被雾霾问题所困扰，这一问题逐渐引起了国内外媒体与广大学者的关注，我国也开始在治理空气污染方面加大投入。党的十九大报告指出，我们要着力解决突出环境问题。国内外学者用不同的方法对我国的空气质量情况进行了分析。李丹 [ 2 ] 基于聚类分析和多元回归的思想对空气质量问题进行了研究，建立了回归模型；李晓童 [ 3 ] 等人，基于Bootstrap方法，对北京市空气质量的影响因素进行回归分析及预测；肖正 [ 4 ] 等人基于多元线性回归分析对合肥市的空气质量进行了实证研究。基于以上研究，本文利用回归分析对西安空气质量数据进行了分析。首先利用2013年12月~2017年6月的空气质量数据进行建模，并对模型进行显著性检验，然后利用2107年7月~2018年4月的数据进行AQI指数的预测，以此来检验模型的好坏。"
"回归分析 [ 5 ] 是研究变量间函数关系的一种方法。  假设AQI为响应变量，PM2.5、PM10、SO 2 、CO、NO 2 、O 3 为预测变量，响应变量与各预测变量的建模过程如下： 1) 散点图 如图1的散点图可以看出，响应变量与各预测变量之间大致呈线性关系，因此建立一般多元线性回归模型。 2) 拟合模型 如表1，从拟合结果来看，只有变量PM2.5，PM10和O 3 的系数显著，其他几个参数估计结果均不显著，R-squared = 0.9701是一个很大的值，F检验的p-value: < 2.2e−16是一个很小的值，这说明模型可能存在过拟合的情况。 3) 回归诊断 绘制上述模型的边际模型图： 图1. 散点图 Table 1 Call: lm(formula = AQI ~ PM2.5 + PM10 + SO 2 + CO + NO 2 + O 3 , data = air) Residuals: Min 1Q Median 3Q Max −11.9898 −3.9216−0.26693.6843 18.2069 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) −13.52998 10.94688 −1.236 0.2245 PM2.5 0.86999 0.0843110.319 2.67e−12 *** PM10 0.22467 0.07914 2.839 0.0074 ** SO 2 0.10969 0.12524 0.876 0.3869 CO 1.84763 5.41873 0.341 0.7351 NO 2 0.01416 0.14484 0.098 0.9227 O 3 0.33644 0.04969 6.770 6.59e−08 *** --- Signif. codes:0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Residual standard error: 7.118 on 36 degrees of freedom Multiple R-squared:0.9744, Adjusted R-squared:0.9701 F-statistic: 228.1 on 6 and 36 DF,p-value: < 2.2e−16 表1. 模型拟合结果 如图2，边际模型图显示各个变量的拟合效果比较好。 绘制上述模型的诊断图(图3)。 如图3拟合模型的诊断图：用Q-Q图判断正态性，若满足正态假设，那么图上的点应该落在呈45度角的直线上 [ 6 ] ，可以看出模型的标准化残差不满足正态性；用位置尺度图判断同方差性，若满足不变方差假设，那么在“位置尺度图”中，水平线周围的点应该随机分布 [ 6 ] ，该图不满足同方差性假设。 进一步绘制上述回归模型的变量添加图评估一下每个变量对其他变量的影响。 图2. 边际模型图 图3. 回归诊断图 如图4变量添加图可以看出，PM2.5，PM10和O 3 对其他变量影响较大，NO 2 ，SO 2 和CO对其他变量的影响都不是太大，这也与估计结果中NO 2 ，SO 2 和CO的系数估计的结果不显著相对应，所以我们考虑将这三个变量去除之后再做模型的拟合。 如表2模型拟合结果来看，去掉变量后所建模型中变量的系数均显著，并且R-squared没有减小且F检验的p-value依旧显著。绘制这个模型的标准化残差诊断图。 如图5回归诊断图可以看出，虽然模型拟合较好但是诊断图形呈现的问题仍然没有得到解决。于是认为，一般的线性模型不足以表达变量间的关系，我们考虑对变量进行变换继续建立更加有效地模型。 图4. 变量添加图 Table 2 Call: lm(formula = AQI ~ PM2.5 + PM10 + O 3 ) Residuals: Min 1QMedian 3Q Max −12.2394 −4.0724 −0.11663.582519.8939 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) −9.12503 7.90795−1.154 0.255561 PM2.5 0.87644 0.0810410.815 2.66e-13 *** PM10 0.25403 0.06878 3.693 0.000677 *** O 3 0.30719 0.04108 7.477 4.79e−09 *** --- Signif. codes:0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Residual standard error: 7.021 on 39 degrees of freedom Multiple R-squared:0.973, Adjusted R-squared:0.9709 F-statistic: 468.4 on 3 and 39 DF,p-value: < 2.2e−16 表2. 模型拟合结果  首先，我们从验证变量为正态分布的假设入手，我们需要画出各变量高斯核密度估计图、箱线图、QQ图。 从图6~12中观察可得各变量数据存在偏态非正态的情况，所以考虑对其预测变量和相应变量同时进行BOX-COX变换。 图5. 回归诊断图 图6. AQI正态分布检验 图7. PM2.5正态分布检验 图8. PM10正态分布检验 图9. NO 2 正态分布检验 图10. SO 2 正态分布检验 图11. CO正态分布检验 图12. O 3 正态分布检验 如表3的结果显示对变量进行如下变换：log(AQI)，log(PM2.5)，1/ SO 2 ，1/CO对变换后的变量进行建模。 从表4的模型拟合结果来看，变量NO 2 ，tSO 2 ，tCO系数不显著，这有可能是由多重共线性引起的，下面进行多重共线性的判别。 tPM2.5 PM10 NO 2 tSO 2 tCO O 3 28.211357 24.0693573.452873 10.288414 14.752069 6.674461 由上面的多重共线性的输出结果可以看出，方差膨胀因子存在大于10的值，因此数据存在多重共线性。下面采用向后剔除法进行变量选择。 由表5可以看出，变量选择后的模型中各个变量都是显著的。 绘制上述模型的诊断图(图13)。 由图13的回归诊断图可以看出残差与拟合图中的点更加随机的分布在水平线周围，说明建立的模型合适。位置尺度图中的点也随机分布在水平线周围满足同方差性。因此该模型的拟合效果比较好。 Table 3 bcPower Transformations to Multinormality Est Power Rounded Pwr Wald Lwr Bnd Wald Upr Bnd AQI −0.1534 0.0 -0.7781 0.4714 PM2.5 −0.2468 0.0 -0.6046 0.1109 PM10 0.9526 1.0 0.4643 1.4409 NO 2 0.1247 1.0 −1.0050 1.2543 SO 2 −0.3271 −0.5 −0.6019 −0.0523 CO −0.6059 −1.0 −1.1548 −0.0570 O 3 1.0138 1.0 0.5136 1.5140 Likelihood ratio test that transformation parameters are equal to 0 (all log transformations) LRT df pval LR test, lambda = (0 0 0 0 0 0 0) 49.203387 2.07e-08 Likelihood ratio test that no transformations are needed LRT df pval LR test, lambda = (1 1 1 1 1 1 1) 133.52787 < 2.22e−16 表3. BOX-COX变换结果 Table 4 Call: lm(formula = tAQI ~ tPM2.5 + PM10 + NO2 + tSO2 + tCO + O3) Residuals: Min 1QMedian 3Q Max −0.14048 −0.05670 −0.021330.04512 0.23899 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept)2.21130080.4725635 4.679 3.99e−05 *** tPM2.5 0.37277200.1483575 2.5130.01660 * PM10 0.00433720.0012748 3.4020.00165 ** NO 2 0.00012760.0020187 0.0630.94995 tSO 2 −0.19236910.6134640−0.3140.75565 tCO 0.16740150.2425960 0.6900.49459 O 3 0.00310130.0008675 3.5750.00102 ** --- Signif. codes:0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Residual standard error: 0.09108 on 36 degrees of freedom Multiple R-squared:0.9318, Adjusted R-squared:0.9205 F-statistic: 82.02 on 6 and 36 DF,p-value: < 2.2e−16 表4. 模型拟合结果 Table 5 Call: lm(formula = tAQI ~ tPM2.5 + PM10 + O3) Residuals: Min 1Q Median 3Q Max −0.14596 −0.05394 −0.01348 0.03781 0.23737 Coefficients: Estimate Std. Error t value Pr(>|t|) (Intercept) 2.187334 0.409397 5.343 4.22e−06 *** tPM2.5 0.399506 0.128671 3.1050.00354 ** PM10 0.003997 0.001127 3.5460.00104 ** O 3 0.003511 0.000544 6.455 1.21e−07 *** --- Signif. codes:0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 Residual standard error: 0.08817 on 39 degrees of freedom Multiple R-squared:0.9308, Adjusted R-squared:0.9255 F-statistic: 174.8 on 3 and 39 DF,p-value: < 2.2e−16 表5. 变量选择结果 图13. 回归诊断 绘制上述模型的边际模型图(图14)。 由图14的边际模型图也可以看出拟合效果很好，因此该模型为有效模型。 综上，最终确定模型为： log ( AQI ) = 0. 3995 0 6log ( PM2 . 5 ) + 0.00 3997PM1 0 + 0.00 3511O 3 + 2 . 187334"
"得到的预测结果如下： 如表6的预测结果显示真实值全在预测区间内，预测效果很好，由此进一步证明了模型的有效性。 图14. 边际模型图 Table 6 真实值 预测值 预测区间下限 预测区间上限 真实值是否在预测区间内 4.662174 4.479 4.286 4.671 是 4.564348 4.401 4.215 4.588 是 4.343805 4.386 4.202 4.57 是 4.330733 4.262 4.065 4.458 是 4.867534 4.775 4.586 4.964 是 5.087596 4.993 4.81 5.177 是 5.204007 5.089 4.886 5.293 是 4.828314 4.839 4.643 5.035 是 4.875197 5.001 4.81 5.192 是 4.624973 4.717 4.523 4.911 是 表6. 预测结果数据"
"本文首先建立一般多元线性回归模型，通过模型诊断发现一般多元线性回归模型不能很好的反映响应变量与各预测变量之间的关系，拟合效果并不好，然后通过变量变换和变量选择，建立了变换后的模型，通过回归诊断发现模型的诊断效果比较好，确定了最终模型，最后用最终确定的模型进行了预测，发现预测，将预测值与真实值进行比较，发现预测效果很好，进一步证明建立的最终模型有效。"
