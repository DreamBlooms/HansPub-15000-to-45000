"心肺耦合关系研究是国内外众多学者的研究热点，在多个疾病的临床检测和治疗中发挥重要作用。用联合熵单一的分析心电信号或者呼吸信号，研究结果的准确性和稳定性会受到序列非稳性的严重影响。本文在原有联合熵的研究基础上，通过对20位志愿者在基础状态和音乐状态下的心电图信号和呼吸信号进行耦合分析，得到心血管循环系统和呼吸系统之间的耦合作用状态，能呈现出音乐对人体心肺耦合关系的调制作用。此外，本文应用经验模态分解法将心电图信号进行分解后，再进一步运用联合熵与呼吸信号进行耦合计算，发现心肺耦合关系研究中的联合熵在不同的心电图分量下对应相同的趋势，并且实验结果表明，在经验模态分解下的联合熵能够得到显著的耦合作用和区分效果，能更敏锐、精准地捕捉信号中的动态信息的变化，从而有效的反映出音乐对人体心肺耦合关系的调制作用，可为以后进一步的耦合关系的研究和临床医学的应用提供一份更有价值的参考。 关键词 :心肺耦合，心电图和呼吸信号，联合熵，经验模态分解 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"人体器官是一个相互关联、相互作用的生理系统，一个器官的故障可能引发级联故障 [ 1 ] (对应的临床意义：“多器官功能衰竭”)，所以研究不同器官之间的耦合关系具有重要意义。心脏和肺是人体两大器官，已有文献提及心肺系统之间存在耦合、同步关系 [ 2 ] 。但是，这种耦合关系如何应用来考察心理疾病患者情绪的变化以及应用来对情绪病的药物治疗效果监测等问题还未见提及。因此，运用新的数据采集技术和分析方法，进一步探究心肺耦合关系，对于更深理解人体器官之间的协同工作及辅助临床具有重要的意义。 ECG (electrocardiogram)即心电图，是心脏兴奋的发生、传导及恢复过程的重要客观指标。它可以反映心脏兴奋的电活动过程，可以分析、鉴别各种心律失常，也能够体现心肌受损的程度和发展过程以及心房、心室的功能结构状况 [ 3 ] 。ECG在科学研究方面有相当广泛的应用，对心脏基本功能及病理的研究具有重要的参考价值 [ 4 ] ，而且对指导心脏手术及指导药物上也有相当的参考价值。呼吸是人体新陈代谢和功能活动重要的生理功能之一，对人体呼吸功能、状况的检测可以发现或预防呼吸道、肺部以及心血管等部位 [ 5 ] 的病变。而且可以了解病情和发展趋势，从而可以及时进行对症治疗。呼吸状况的基本信息在医学麻醉过程、重症监护、新生儿监护中都起着重要的作用，甚至在分析血液流速模式的研究中也有着重要作用。心血管循环系统和呼吸系统之间的内在相互作用及协调机制叫做心肺耦合(也可以叫心肺交互作用)，相对于单一的分析心电信号或者呼吸信号来说明机体的平衡与健康状况，将心电信号与呼吸信号放在一起进行分析，得到心血管循环系统和呼吸系统之间的耦合作用状态，更具有准确性和稳定性 [ 6 ] 。探究动力学系统中的耦合关系一直都是国内外众多学者的研究热点，尤其近年来，心肺耦合的研究在发现疾病和检测治疗效果中产生了重要影响 [ 7 ] ，例如在睡眠检测 [ 8 ] 、抑郁症的治疗及心肺复苏等方面。 2005年，哈佛大学医学院的研究学者R.J. Thomas与交叉医学研究团队的众学者一起研究并公开了心肺耦合分析方法(Cardiopulmonary Coupling, CPC)，这是一种将呼吸信号和ECG信号联合考虑的算法 [ 9 ] 。通过能量不同的高频、低频和极低频部分，反映出睡眠程度和呼吸节奏紊乱程度。目前，该方法在评估睡眠质量和判断睡眠呼吸紊乱的领域中被广泛的应用 [ 10 ] 。虽然CPC技术的优势很明显，但它也存在着一定局限性。如低频刺激对高低频耦联部分的能量影响较大；CPC技术不能准确的判读入睡时间；而且，CPC分析方法也不能用来研究心律失常的患者的睡眠状态。除了用CPC进行心肺耦合研究，还有很多研究方法也被公开，国内外主要应用的心肺耦合技术分析有非性耦合方法和线性耦合分析方法，线性分析方法即因果关系。现阶段，对心肺耦合分析的方法大多数是用频谱分析或者非线性动力学等理论的方法研究处理呼吸、心率、血压等常见的生理参数，以此获得的心肺系统之间的生理机制的参数评估结果，来判断两个系统之间相互作用的关联程度 [ 11 ] 。还有的研究人员将心、肺感受器之间反馈调控的发生过程进行模拟和仿真，获得对心率变异性产生的作用 [ 12 ] 。研究心肺耦合分析的方法，不但可以检测机体在不同的生理和心理状态下心肺系统间的协调关系，还可以由心肺耦合状态获得自主神经功能状态的评价。 联合熵将动力学统计理论和替代数据的概念相结合，成为信息统计学中的一个统计量。原始时间时间序列和其替代时间序列之间计算所得的联合熵，可以使序列的动力学复杂性得到一个量化的结果。联合熵方法能有效的从短时混沌信号中提取出动力学信息，由此而反映出序列的动力学复杂信的强弱 [ 13 ] 。经验模态分解法(Empirical Mode Decomposition, EMD)是一种新型的自适应信号时频处理方法，由于它分解信号是依据数据自身的时间尺度特征来进行的，因此EMD方法在理论上可以应用于任何类型信号的分解，尤其是在分析处理非平稳非线性数据上，具有特别突出的优势 [ 14 ] 。所以，EMD方法被提出后就很快地大量地被应用于不同的工程领域，例如在图像、大气、生物信号、机械故障、地震记录分析以及土木工程结构的模态参数识别方面。 本文利用检验模态分解法将ECG信号，分解成为有限个包含了原信号的不同时间尺度的局部特征分量。而且这些分量没有复杂的叠加波，只包含了一种震动模式。在这样的分解下，再进行联合熵的计算 [ 15 ] ，得到耦合的结果大大提高了结果的有效性。"
"1) 将时间序列转换成符号序列 符号动力学在分析时间序列复杂性方面有着显著的作用 [ 16 ] 。现设一个心跳时间序列为X，其中 X = { x 0 , x 1 , x 2 , ⋯ , x i , ⋯ x N } ， x i 表示第 i 个心跳间期。把ECG序列X转换成符号序列 S = { s 1 , s 2 , s 3 , ⋯ s i , ⋯ s N } ， s i ∈ A ( A = 0 , 1 , 2 , 3 )。具体的转换方法如下方程(1)所示。 s i ( x i ) = { 0 : u   < x i ≤ ( 1 + a ) u 1 : ( 1 + a ) u   < x i < ∞ 2 : ( 1 − a ) u < x i ≤ u 3 : 0 < x i ≤ ( 1 − a ) u (1) 这里 i = 1 , 2 , 3 , ⋯ , u 代表心跳间期的平均值， a 是一个特殊参数，我们取 a = 0.05 。且当 a 取0.04到0.07时都可得到相似的结果。但当 a 的取值小于0.04或大于0.07，则不能得到较为合理的统计特性。这主要是因为 a 的值取的过大或过小，在把原始时间序列转化成符号序列时，会导致细节信息的丢失，不能很好的捕捉到信号中的动态信息。 2) 产生替代序列并转换成符号序列 先取原始时间序列X的替代时间序列Y。根据Schreiber等人提出的打乱相位法，将原始时间序列X进行傅立叶变换得到其功率谱 [ 17 ] 。将此功率谱中各频率成分的相位随机的改变，然后进行逆傅立叶变换，这样得到的数据序列就是原始时间序列的替代数据Y。然后再依据方程式(1)把替代时间序列Y也转化成符号序列，得到了替代序列的符号序列。 3) 计算联合熵 对于原始时间序列X和其替代时间序列Y之间的联合熵 H ( X , Y ) 可表示为： H ( X , Y ) = − ∑ i = 1 m ∑ j = 1 n p i j log 2 p i j (2) 这里 m , n 代表的是“三位字”的总状态个数( m = n = 64 )， p i j 代表X序列在第i个状态且Y序列在第 j 个状态( i , j ∈ [ 1 , 64 ] )的几率。 联合熵还可看成是一个序列的熵与另一个序列的条件熵的和，即可表示为： H ( X , Y ) = H ( Y ) + H ( X / Y ) (3) 其中， H ( Y ) 表示替代时间序列Y的熵函数，且 H ( Y ) = − ∑ j = 1 n p j log 2 p j ，其中 p j 是变量Y在状态 j 出现的概率。 H ( X / Y ) 表示在Y给定情况下X的条件熵，条件熵是一个序列在另一个序列给定条件下的“不肯定度”。  EMD方法是将一个非线性、非平稳的时间序列进行分解，使最终结果成为有限个本征模函数(Intrinsic Mode Function，IMF)和一个残余量的形式，其表达形式如下(4)式所示 [ 18 ] ： s ( t ) = ∑ I M F ( t ) + r ( t ) (4) EMD方法的分解过程总结如下4个步骤： 1) 设原始的时间序列为s(t)，找出其局部极大值和局部极小值。在相邻的极值间用三次样条插值函数拟合形成原始数据s(t)的上包络线U(t)和下包络线L(t)。 2) 将上包络线和下包络线的均值记作m(t)，其中m(t) = [U(t) + L(t)]/2。将平均包络从原始信号中去除得到一个新的数据序列，表示为h(t) = x(t) − m(t)。 3) 这个新的数据序列，如果还存在负的局部极大值和正的局部极小值，说明这个新的数据序列还不是一个本征模函数，需要重复上述分解过程直到满足上述要求，得到IMF(t) = h(t)。 4) 从原始时间序列中去除这个得到的IMF量，得到剩余量r(t) = x(t) − h(t)。此时需要判断该剩余量的幅度是否小于某个预设值；该残余量已是否是单调函数，不再需要继续进行分解。但是第一次分解得到的残余量一般情况下不会达到上述两个标准，所以仍然需要继续分解。即令x(t) = r(t)，然后重复上述步骤(1)~(4)，直到达到设定的残余量满足条件为止。  联合熵是将原始函数X和由原始函数变换而来的一个替代序列Y联合计算而得到的一个熵值的结果 [ 19 ] ，本文中将利用联合熵的思想，但使用的是两组独立的序列来进行联合熵的计算。即用ECG信号和呼吸信号作为两个序列进行联合熵值计算，从而达到耦合的效果，描述这两组不同信号之间的关联性。 经验模态分解下的联合熵，是将ECG信号分别进行EMD分解 [ 20 ] ，分别得到其IMF和余量，然后再由ECG信号的IMF和呼吸信号之间进行联合熵的计算，得到耦合的结果 [ 21 ] 。"
"本文使用的数据ECG信号和呼吸信号的数据取自于PhysioBank的Combined measurement of ECG, Breathing and Seismocardiograms (cedsbd)，该数据库对20名健康志愿者进行了测量。在测量过程中，受试者以舒适的姿态静止仰卧，并保持清醒。该数据库记录了多参数的数据，包括2导ECG信号(I和II导)、1导从胸压阻带获得的呼吸信号、1导SCG信号，每导的采样率均为5000 Hz。本文实验采用20名志愿者的I导ECG信号和呼吸信号数据，其中b1到b10是记录受试者的基础状态，记为b组；记录受试者在听古典音乐的状态下数据为m1到m10，记为m组。  从20名受试者的数据中，分别取1000、2000、3000、4000、5000、6000、7000个点，分别进行ECG信号、呼吸信号的联合熵的计算，其计算结果如图1、图2所示。 其中图1表示将基础状态(b组)和音乐状态(m组)不同长度的ECG序列 [ 22 ] 作为单一的的输入信号进行联合熵的计算，图2表示b组和m组不同长度的呼吸信号作为单一输入的信号的联合熵的计算。 由图1、图2可以看出，在基础状态下和听古典音乐时的序列在不同长度时 [ 23 ] ，无论是ECG信号的联合熵还是呼吸信号的联合熵，在基础状态下的值总是小于听古典音乐时的值；但当各个序列取不同长度时，ECG信号的联合熵值和呼吸信号的联合熵值并不能清楚的呈现出音乐对人体生理节律的调制作用。 图1. 不同长度序列时ECG信号的联合熵 图2. 不同长度序列时呼吸信号的联合熵  将20名受试者的ECG信号分别进行EMD分解，分解得到的IMF分量可以体现信号的局部特征，然后将分解得到的ECG的各个IMF序列与呼吸信号使用联合熵进行耦合计算 [ 24 ] 。当各样本长度N = 4000时，计算结果如图3所示。 图3表示，当ECG和呼吸信号的序列长度为4000时，ECG的分量IMF1-IMF7和呼吸信号的联合熵的耦合计算结果。从图中可以看出，经验模态分解下的联合熵的耦合值在基础状态下即b组始终小于在听古典音乐即m组。当ECG的IMF1分量与呼吸信号耦合时的联合熵值是最大的，且能最明显的分辨出两种状态，从而清晰地体现了音乐调制人体心肺耦合关系产生的影响；而ECG的IMF2分量与呼吸信号耦合时的联合熵值是最小的，且IMF3-IMF7分量和呼吸信号的联合熵值分辨出两种状态的效果并不明显。 由于IMF1、IMF2、IMF3是属于高频的IMF分量，它们包含了信号中的大部分信息，而且心电信号的高频部分被认为是体现迷走神经活动情况的频段，迷走神经调控呼吸频率 [ 18 ] ，所以本实验采用呼吸信号与ECG信号的IMF1、IMF2、IMF3分量分别进行联合熵计算 [ 25 ] 。 继而，取这20个样本的不同长度的呼吸信号和ECG信号的序列 [ 26 ] ，然后将ECG序列分别进行EMD分解后，计算呼吸信号与ECG信号的IMF1、IMF2、IMF3分量 [ 27 ] 的联合熵值，结果如表1所示。 表1表示，在不同序列长度下，两种状态下的ECG序列在经过EMD分解后得到ECG信号的IMF1、IMF2、IMF3分量分别与对应的两种状态下的呼吸信号的耦合计算的联合熵值。可以看出，在基础状态下(b组)的各个分量的心肺耦合的联合熵值总是小于听古典音乐时(m组)的各个分量的值，表示了心肺耦合关系研究中的联合熵在不同的心电图分量下对应相同的趋势。并且验证了图3所示结果的趋势，即当ECG的IMF1分量与呼吸信号耦合时的联合熵值是最大的，呼吸作用对迷走神经活动调控的高频吨影响最大；而ECG的IMF2分量与呼吸信号耦合时的联合熵值是最小的。  从20名受试者的数据中，分别取1000、2000、3000、4000、5000、6000、7000个点，进行ECG信号、 图3. N = 4000时ECG信号的各IMF分量和呼吸信号的联合熵 Table 1 样本长度 (N) IMF1 IMF2 IMF3 音乐状态 基础状态 音乐状态 基础状态 音乐状态 基础状态 1000 3.2066 ± 0.2188 2.3475 ± 0.1823 2.1905 ± 0.4213 1.9809 ± 0.4071 2.2542 ± 0.4018 2.1526 ± 0.4005 2000 3.2767 ± 0.3187 2.6065 ± 0.3179 2.0363 ± 0.4697 1.891 ± 0.355 2.2702 ± 0.4697 2.1748 ± 0.3811 3000 3.5767 ± 0.3754 2.888 ± 0.3412 1.9663 ± 0.3216 1.8523 ± 0.3292 2.1367 ± 0.4604 2.0939 ± 0.3462 4000 3.8312 ± 0.3975 3.0441 ± 0.1687 1.9816 ± 0.637 1.8762 ± 0.5774 2.1274 ± 0.3822 2.0739 ± 0.2415 5000 3.8491 ± 0.3748 3.2977 ± 0.3735 1.9589 ± 0.313 1.81 ± 0.3091 2.0731 ± 0.2617 2.0364 ± 0.2414 6000 3.7939 ± 0.3777 3.298 ± 0.351 1.7102 ± 0.3952 1.5886 ± 0.2024 2.0014 ± 0.3097 1.9667 ± 0.2426 7000 3.7939 ± 0.3777 3.298 ± 0.351 1.9486 ± 0.3196 1.8187 ± 0.3185 1.9815 ± 0.3187 1.9186 ± 0.2786 表1. 不同长度序列时ECG信号的IMF1、IMF2、IMF3和呼吸信号的联合熵 呼吸信号的联合熵耦合计算，其结果如图4(a)所示。将表1中ECG信号的IMF1分量和呼吸信号的耦合结果绘制成图4(b)，表示音乐状态和基础状态的序列在不同长度时ECG信号的IMF1分量 [ 28 ] 与呼吸信号的联合熵。 与图1、图2相比，图4说明了相对于分析单一的心电信号或者呼吸信号，分析心电信号和呼吸信号之间的耦合关系更能明显、精准的判断机体所处的状态，反映出音乐对人体心肺耦合关系的调制作用。 图4表明无论是由联合熵计算所得的心肺耦合强度的值，还是在EMD下的联合熵值 [ 29 ] ，平常状态下(b组)的心肺耦合的联合熵值总是小于听古典音乐时(m组)的值，说明了相对于基础状态，听古典音时ECG信号和呼吸信号的相关性减小，显示出了音乐对人体心肺耦合关系产生的调制作用。同时，将ECG信号的IMF1分量和呼吸信号耦合时的联合熵值与ECG信号和呼吸信号耦合时的联合熵处理所得结果比较，不管时在基础状态还是音乐状态，在EMD下的联合熵的值总是大于同等情况下联合熵计算的值， 图4. (a) 两种状态在不同长度序列时ECG信号和呼吸信号的联合熵；(b) 两种状态在不同长度序列时ECG信号的IMF1分量与呼吸信号的联合熵 且两种状态的ECG信号的IMF1分量和呼吸信号耦合时的联合熵值差异更加明显，这些就说明了，在EMD下联合熵处理数据得到的结果的耦合作用更加明显，处理的效果更为显著。而且图4(b)在不同长度时ECG信号的IMF1分量与呼吸信号的联合熵波动趋势一致和谐，说明在EMD下联合熵处理数据得到的耦合结果能够敏锐、快速得捕捉信号中的动态信息的差异，为耦合分析提供更好的参考效果。"
"心肺耦合关系研究是一项基于体表心电图、呼吸紊乱程度和描述人体状态的技术，它将ECG信号和呼吸信号有机的结合起来，用两者的耦合强度来量化评价人体在不同生理状态下的心理平稳情况，克服了两者单独应用的缺陷。本研究表明，基于经验模态分解下的心肺耦合分析技术具备用于人体心理状态诊断的临床价值。无论是与传统的单一信号输入的联合熵还是与心脏、呼吸两种信号并用的联合熵比较，基于经验模态分解下的联合熵的耦合结果具有较高的一致性，使其在进行睡眠监测、抑郁症治疗、重症监护等方面具有明显的优势 [ 30 ] 。并且可再与其他生理信号进行组合分析，使各种信号分析结论的优势达到互补，进一步提高诊断的准确性。 呼吸运动就相当于心血管中的泵，其作用能使心血管发生反射。血压变化是随着呼吸运动改变回心血量的变化而发生变化的；压感反射是通过调节心血管中枢的交感神经及副交感神经的紧张性，再回馈反应到心脏的输出量、心率等方面，产生了一个回路 [ 31 ] 。与呼吸运动关联的血压反射调节涉及多个机制，其中心肺压力感受器接收到来自胸腔容积与胸膜压力的变化产生的刺激，此时心血管的中枢神经的被抑制了紧张性，保证了血压与血容量的稳定变化，这样获得了持续性的稳定。在心血管反射系统中，在交感神经对外周循环阻力、心脏的收缩力和血容量进行调节的同时，副交感神经也对心率进行调节，以此确保了在交感神经和副交感神经的综合作用下维持住泵的状态 [ 32 ] 。位于心脏的心肺感受器会被一些机械的牵张力和化学物质所刺激而发生激动，引起血容量的增加和血压的升高，并且这时心脏迷走神经的紧张性随着心肺感受器的紧张性增加而降低，心交感神经的紧张性则随之降低，由此一系列的活动致使心率变慢，血压降低。这个过程中，心肺系统的感受器与颈动脉窦和主动脉弓压力感受器之间也发生了激动，并且产生的兴奋为心血管的中枢神经提供了抑制作用，由此心率和动脉血压便可以维持正常状态。 机体生理、心理状态与自主神经系统活性有非常密切的联系 [ 33 ] ，其中自主神经系统活性可以由心电信号和呼吸信号间接描述，从而反映出机体所处的生理、心理状态。音乐是一种声波形式的信息，它规律性的频率变化可以作用于大脑皮层，对丘脑下部及边缘系统产生影响。通过改变大脑皮层的兴奋程度来对激素、新成代谢等进行调节，达到调控应激能力的作用，从而改变机体的生理或生理状态。本文在原有的联合熵的研究基础上，将联合熵使用在心肺的耦合分析上，并且利用EMD将ECG的原始序列进行分解后得到IMF分量，再进一步与呼吸信号进行联合熵的耦合分析。实验发现，在进行心肺耦合的联合熵研究时，人在不同的两种状态下的心肺耦合的强度不同，表明音乐对人体心肺系统耦合关系的调制作用，而且当ECG的IMF1分量与呼吸信号耦合时的联合熵值是最大的，差异效果最为明显，因此在今后的研究分析中，可以继续将这种方法用在原始数据的处理上。 联合熵的一般使用是一组数据的分析，是将原始函数和由原始函数变换而来的一个替代序列进行联合计算而得到的一个熵值的结果。而本文是利用联合熵和心肺耦合的思想，将ECG信号和呼吸信号同时代入进行联合计算，得到联合熵而得以探究人体心肺的耦合。为了使实验结果显著，本文还采用了经验模态分解法，将ECG信号的原始序列先进行经验模态分解得到其IMF分量，再用其IMF分量与呼吸信号进行耦合，这样处理后得到的结果更为明显，能更好的捕捉信号中的动态信息，也为临床医学中疾病的检测和治疗提供了更有力的辅助指标。并且，本文所采用的数据时来自于同一组健康志愿者的两种不同状态，即基础状态和听古典音乐的状态。因此，可进一步将本文所述方法应用在治疗和观测心理疾病患者的方面，便可以由EDM下的联合熵值的心肺信号耦合结果的变化得出患者情绪的变化。或者应用于情绪病的药物治疗效果的监测 [ 34 ] ，将患者的用药前与用药后的状态进行对比，便可得出药物是否有作用或者作用的有效程度。此外，也可以应用于睡眠的检测、心肺复苏、新生儿监护等多个临床医学方面。 由此得到启发，我们可以通过对大量样本的分析，进一步研究不同年龄阶段或者两种性别下的人在不同生理、心理状态下的心肺耦合关系和规律 [ 35 ] 。利用熵方法来量化分析信号之间的耦合强度，甚至可以分析信号之间的耦合方向，可以深入了解心肺系统的协同作用的生理机理，也可以探讨衰老、疾病对心肺耦合关系 [ 36 ] 的影响，还可以由心肺耦合研究不同治疗方法对不同性别的人群的有效性。"
