"针对三元复合驱缺乏科学的数学模型描述驱油机理，数值求解数值稳定性不高、精度差的问题，本文提出了一种基于全隐式有限差分的数值计算方法。首先综合三元驱替剂(碱、表面活性剂和聚合物)对油、水物理化学特性的影响，以及油水渗流方程和吸附扩散方程，建立了三元复合驱数学模型。然后采用全隐式有限差分法，引入块中心网格系统将数学模型从时间和空间上进行离散，从而将原始的偏微分方程组转化为差分代数方程组。最后，采用Newton-Raphson法进行迭代求解，得到系统的状态和输出。为了验证提出方法的效果，针对四注九采三元复合驱实例，分别采用本文方法和CMG数值模拟软件求解，仿真结果表明，本文提出的方法具有较高的求解精度。 关键词 :三元复合驱，全隐式有限差分，Newton-Raphson法，渗流机理 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"三次采油技术是指通过向油藏的驱替流体中加入化学剂、混相溶剂、热量等介质，改变油藏流体和岩层的物理和化学性质，使得采出的原油增多的技术，能在二次采油的基础上进一步提高采收率。三次采油技术包括化学驱、混相驱、热力采油、微生物采油等，其中，化学驱又可分为碱驱、表面活性剂驱、聚合物驱、复合驱等 [ 1 ] [ 2 ] 。传统的三次采油一般利用化学驱、混相驱、热力采油等，但是随着油藏开采的进行，油田地质条件发生改变，采油难度逐年增加，而且开采效果也越来越不理想，于是在众多的三次采油新技术中，三元复合驱脱颖而出，成为最具有应用前景的方法之一 [ 3 ] 。 国内外已经有很多关于聚合物驱以及聚合物二元驱、复合驱的数学模型研究。其中，李宜强等 [ 4 ] 采用相似原理建立了泡沫复合驱和三元复合驱的相似准则，并利用数值模拟和物理模拟方法对准则进行检验和敏感性分析；Thomas等 [ 5 ] 建立了表面活性剂驱油水两相的数学模型；袁士义等 [ 6 ] 研究了碱水复合驱的数学模型；侯建等 [ 7 ] 对聚合物驱模型及数值模拟方法进行了研究。杨承志等 [ 1 ] 指出，碱–表面活性剂–聚合物三元复合驱提高采收率是在碱驱、表面活性剂/聚合物驱和聚合物驱基础上发展起来的。化学驱的数学模型主要包括油水渗流方程、化学驱替剂的吸附扩散方程、油藏及各组分的物化代数方程以及各种约束条件，然而还没有对三元复合驱数学模型展开深入的研究。在求解数学模型时，包括各种数值模拟软件(如VIP，CMG等)，普遍采用有限差分法 [ 8 ] ，对偏微分方程进行离散化，转化为代数方程的非线性规划问题进行优化求解，由于问题规模庞大，求解时累积误差严重，极大地影响了结果的准确性。 但随着人们对复合驱驱油机理认识的不断加深，对三元复合驱采油过程提出了更多的问题和要求。一方面现有的复合驱数值模拟软件对三元复合驱的物理化学现象还没有完全描述清楚，对于三元复合驱的偏微分方程模型通常都采用有限差分方法求解，数值稳定性差，且该问题涉及多个复杂高阶偏微分方程，难于求解和应用，且累积误差较大。针对以上问题，本文提出了一种基于全隐式有限差分的三元复合驱渗流模型计算方法。综合考虑三元驱替剂的加入对油藏渗流的影响，建立了全面合理的三元复合驱渗流模型，并采用数值稳定性较好的全隐式有限差分法对数学模型进行离散，转化为差分代数方程组，通过Newton-Raphson法进行求解，得到整个空间状态和输出。"
"三元复合驱的数学模型主要包括油、水渗流方程和驱替剂吸附扩散方程，是一组典型的拋物型偏微分方程组。另外还包括一系列物化代数方程：碱耗方程、渗透率方程、驱替剂吸附方程、粘度方程等。对于实际的矿场，对应的物化代数方程往往根据不同的地质条件，由实验数据确定。 三元复合驱问题的基本假设条件如下： 1) 地层均质，油藏等温，且吸附现象满足Langmuir等温吸附公式； 2) 驱油体系由碱、聚合物、表面活性剂组成，驱油过程为油水两相流，水相中存在碱、聚合物和表面活性剂，油相中存在表面活性剂； 3) Darcy定律适合化学剂存在情况下的油水两相； 4) 各种吸附都达到平衡，相平衡瞬间建立，且满足广义Fick定律； 流体和岩石微可压缩，考虑重力和毛管力的影响，忽略驱替剂对水溶液质量守恒的影响，考虑驱替剂引起的水相渗透率以及水相黏度的变化，并且考虑聚合物的不可及孔隙体积。 基于以上假设条件，设油藏所在的三维区域为 Ω ∈ R 3 ， ( x , y , z ∈ Ω ) ， ∂ Ω 为区域的边界， n 表示边界的法线方向，油藏中主要含有n种组分(油、水、聚合物、表面活性剂、碱)，则三元复合驱的数学模型 [ 1 ] [ 3 ] 如下所示： 油相渗流连续性方程： ∇ ⋅ [ K k r o B o μ o ∇ ( p o − ρ o g h ) ] + q o = ∂ ∂ t [ ϕ ( 1 − S w ) B o ] , (1) 水相渗流连续性方程： ∇ ⋅ ( K k r w B w R k μ w ∇ ( p w − ρ w g h ) ) + q w = ∂ ∂ t ( ϕ S w B w ) , (2) 聚合物吸附扩散方程： ∇ ⋅ ( K k r w c p B w R k μ w ∇ ( p w − ρ w g h ) ) + ∇ ⋅ [ ( D w + D w p ) ϕ p S w B w ∇ c p ] + q c = ∂ ∂ t ( ρ r ( 1 − ϕ ) C r p + ϕ p S w c p B w ) , (3) 表面活性剂吸附扩散方程： ∇ ⋅ ( K k r w c w s B w R k μ w ∇ ( p w − ρ w g h ) ) + ∇ ⋅ ( K k r o c o s B o R k μ o ∇ ( p o − ρ o g h ) )   + ∇ ⋅ [ ( D o + D o s ) ϕ s S o B o ∇ c o s ] + ∇ ⋅ [ ( D w + D w s ) ϕ s S w B w ∇ c w s ] + q d = ∂ ∂ t ( ϕ s S o c o s B o + ϕ s S w c w s B w + ρ r ( 1 − ϕ ) C r s ) , (4) 碱组分吸附扩散方程： ∇ ⋅ ( D O H ϕ S w B w ∇ c O H ) + ∇ ⋅ ( K k r w c O H B w R k μ w ∇ ( p w − ρ w g h ) ) + R O H + q e = ∂ ∂ t [ K a ( 1 + K b c O H ) 2 ( 1 − ϕ ) S w c O H + ϕ S w c O H B w ] , (5) 初始条件： p ( x , y , z , t ) | t = 0 = p 0   ,   S w ( x , y , z , t ) | t = 0 = S w 0 ,   c Θ ( x , y , z , t ) | t = 0 = c Θ 0 ,  ( x , y , z ) ∈ Ω , (6) 边界条件： ∂ p ∂ n | ∂ Ω = 0 ,   ∂ S w ∂ n | ∂ Ω = 0 ,   ∂ c Θ ∂ n | ∂ Ω = 0 , (7) 上述模型中各符号的物理意义如下： 在所有下标中 p , s , O H 分别表示聚合物、表面活性剂、碱；K为绝对渗透率[μm 2 ]； k r o , k r w 分别为油相和水相的相对渗透率[-]； p o , p w 为油相、水相压力[MPa]； S o , S w 分别为含油饱和度、含水饱和度[-]； p c o w ( x , y , z , t ) 为毛管力[MPa]；g为重力加速度[m/s 2 ]； h ( x , y , z ) 为深度[m]，向下为正； c Θ 为相应驱替剂的浓度 Θ = { p , s , O H } 分别代表聚合物浓度[g/L]、表面活性剂质量浓度[%]、碱的质量浓度[%]， c i j 表示j在i中的质量浓度[%]； ρ o , ρ w , ρ r 分别油相、水相和岩石的密度(kg/m 3 )； B o , B w 分别油和水的体积系数[-]； μ o , μ w 为加入驱替剂后油相和水相的黏度[mPa×s]； ϕ , ϕ p , ϕ s 分别为岩石的孔隙度、聚合物可及孔隙度以及表面活性剂可及孔隙度[-]， ϕ p , s = ϕ f a , s ， f a , f s 为可及孔隙系数[-]； R k 为相对渗透率下降系数[-]； K a 为表征离子交换与吸附量大小的参数[-]； K b 为碱的吸附常数，[cm 3 /g]； v w 为渗流速度[cm/s]，流入为正； R O H 为碱耗，[1/d]； C r p , C r s 为单位质量岩石吸附聚合物、表面活性剂的质量[mg/g]； r o , r w 分别为油相和水相的流动系数[μm 2 /(mPa×s)]； q o 为油相在标准状态下的流速[1/d]，流入为正； q w 为水相在标准状态下的流速[1/d]，流入为正； q c , q d , q e 为井筒驱替剂的运移速度，单位为[g/(d×L)], [1/(100d)], [1/(100d)]； D i , i ∈ { w , o , O H } 为扩散系数[m 2 /s]， D i j , i ∈ { w , o } , j ∈ { s , p } 表示j在i中的扩散系数[m 2 /s]；t为时间[d]； ∇ 为Hamilton算子，在直角坐标系中 ∇ = ∂ ∂ x i + ∂ ∂ y j + ∂ ∂ z k ； x , y , z 为直角坐标系的三个方向，长度单位[m]。 上述代数关系式，可以通过模型中的辅助变量代入支配方程，不需要作为最优控制问题的等式约束。在上述模型中系统的状态变量为 p , S w , c Θ ，分别为油藏压力，含水饱和度和油藏中驱替剂浓度(聚合物、表面活性剂和碱)。控制变量(驱替剂的注入浓度)为 c Θ i n ，表示水井中相应驱替剂的注入浓度。 q o , q w 分别为油相和水相的流速， q c , q d , q e 为井筒驱替剂的运移速度。 q i n ( x , y , z , t ) ≥ 0 表示在位置 ( x , y , z ) 有井的注入项， q o u t ( x , y , z , t ) ≥ 0 表示在位置 ( x , y , z ) 有井的产出项。 q o , q w , q c , q i n , q o u t 以及控制变量 c Θ i n 只在有井的位置有定义。将所有注入项和所有产出项位置的集合分别记为 ψ w = { ( x , y , z ) j , k , j ∈ κ w , k ∈ ϑ w j } 和 ψ p = { ( x , y , z ) j , k , j ∈ κ p , k ∈ ϑ p } ，则方程中的流量项定义为： q o = { − ( 1 − f w ) q o u t ,     ( x , y , z ) ∈ ψ p 0 ,                                                               ( x , y , z ) ∉ ψ p (8) q w = { − f w q o u t ,     ( x , y , z ) ∈ ψ p q i n ,                             ( x , y , z ) ∈ ψ w 0 ,                                     ( x , y , z ) ∉ ψ p ∪ ψ w (9) q c = { q w c p ,                   ( x , y , z ) ∈ ψ p q w c p i n ,             ( x , y , z ) ∈ ψ w 0 ,                                 ( x , y , z ) ∉ ψ p ∪ ψ w (10) q d = { q w c w s + q o c o s ,     ( x , y , z ) ∈ ψ p q w c s i n ,                 ( x , y , z ) ∈ ψ w 0 ,                                 ( x , y , z ) ∉ ψ p ∪ ψ w (11) q e = { q w c O H ,                   ( x , y , z ) ∈ ψ p q w c O H i n ,             ( x , y , z ) ∈ ψ w 0 ,                                   ( x , y , z ) ∉ ψ p ∪ ψ w (12) 模型中，油、水体积系数均为油藏压力 p ( x , y , z , t ) 的函数，具体如下： B o = B o r / [ 1 + C o ( p − p r ) ] , (13) B w = B w r / [ 1 + C w ( p − p r ) ] , (14) 其中， p r 表示参考压力(MPa)， B w r , B o r 分别表示参考压力下的水、油体积系数， C o , C w 表示油、水压缩系数。 流动系数定义： r o = K k r o B o μ o ,   r w = K k r w B w R k μ w (15) f w ( x , y , z , t ) 为含水率是状态 p , S w , c p , c s , c O H 的函数，其定义为 [ 3 ] f w = r w r w + r o , (16) 表面活性剂浓度： c s = q w c w s + q o c o s q w + q o , (17) 物化代数方程详见附录。"
"三元复合驱的机理模型(1)~(5)是一组复杂的非线性多变量耦合偏微分方程组，其中，状态变量分别为油藏压力 p ( x , y , z , t ) 、含水饱和度 S w ( x , y , z , t ) 以及驱替剂溶液浓度 c Θ ( x , y , z , t ) , Θ = { O H , s , p } 。目前主要采用有限差分法求解偏微分方程组，该方法主要包括两类：一类是依次求解各个状态变量，如隐压显饱法，该方法先隐式求解状态压力，再显式求解含水饱和度、驱替剂浓度；另一类是联立求解方程组，同时求解各个状态变量，如全隐式法。隐压显饱法虽然在每个时间步需要的计算量较小，但是为了保证求解的稳定性，步长必须取得很小，有时候甚至小到没有实际价值。全隐式法离散化模型后得到的差分方程组往往阶数较高，需要的计算量较大，但是该方法可以选取的步长较大，具有很好的数值稳定性。此外，该方法离散三元复合驱数学模型得到的最优控制模型和伴随方程具有特殊的形式，便于编程求解。随着计算机技术的飞速发展，计算机的运行速度和存储能力都有了极大提高，结合矩阵存储以及数据处理等数值求解技术，完全可以实现全隐式方法的计算。因此，本文采用全隐式有限差分法 [ 9 ] 求解三元复合驱数学模型。  对于(1)~(5)所述的三元复合驱数学模型，优化变量为注入井的驱替剂(碱、表面活性剂和聚合物)注入浓度 c Θ i n ，状态变量为油藏空间每一个空间点的压力 p ( x , y , z , t ) 、含水饱和度 S w ( x , y , z , t ) 和驱替剂的网格浓度 c Θ ( x , y , z , t ) ，系统的输出为采出井的含水率。本节中，我们采用全隐式有限差分法进行离散 [ 9 ] ，为了使本问题的数学描述同一般优化问题一致，引入 x = [ c Θ , s w , p ] T 表示所有的空间状态变量， u = c Θ i n , Θ = { p , s , O H } 表示所有的优化变量。 将整个油藏离散化为 n x × n y × n z 个网格，其中整数 i ( i = 1 , 2 , ⋯ , n x ) ， j ( j = 1 , 2 , ⋯ , n y ) ， k ( k = 1 , 2 , ⋯ , n z ) 分别表示在 x , y , z 方向上的网格序号，即 x i , y j , z k 分别表示对应的 x , y , z 方向上的第 i , j , k 个坐标值。按照块中心网格系统 [ 10 ] 进行离散化，即网格点 ( x i , y j , z k ) 位于网格 ( i , j , k ) 的中心。那么，网格点 ( x i , y j , z k ) 处的离散状态向量可表述为 x i , j , k = x ( x i , y j , z k ) . (18) 对于网格 ( x i , y j , z k ) ，定义 x i − 1 / 2 , x i + 1 / 2 ， y j − 1 / 2 , y j + 1 / 2 ， z k − 1 / 2 , z k + 1 / 2 分别为 x , y , z 方向上的左、右边界坐标。仅在状态网格上离散化三元复合驱机理模型，根据网格系统的划分结果，状态变量的有限差分可以表述为 ∂ x ∂ t = x n + 1 − x n Δ t n , (19) ∂ x ∂ x = x i + 1 / 2 , j , k − x i − 1 / 2 , j , k Δ x , (20) ∂ x ∂ y = x i , j + 1 / 2 , k − x i , j − 1 / 2 , k Δ y , (21) ∂ x ∂ z = x i , j , k + 1 / 2 − x i , j , k − 1 / 2 Δ z , (22) 其中， n = 0 , 1 , ⋯ , N − 1 表示三元复合物的时间步，N表示总的步数， Δ t n 表示步数n的长度， x n + 1 为时间 Δ t n + 1 处的状态向量， Δ t n + 1 表示第n个时间步终点时刻的仿真时间( t N = t f )。 Δ x , Δ y , Δ z 分别表示在 x , y , z 方向上的空间步长。网格在 x - y 平面上的详细划分情况如图1所示。 图1. 有限差分网格划分原理图 采用上述有限差分法对三元复合驱数学模型(1)~(5)进行离散化，并在方程组的每一个等式两端同时乘以网格体积 V = Δ x Δ y Δ z ( m 3 ) 。采用全隐式有限差分法将模型中二阶导数项离散化后，状态变量均取 Δ t n + 1 时刻的值。则初始的三元复合驱数学模型可以被离散化为如下一般形式 G n = F n + 1 ( x ˜ n + 1 ) + W n + 1 ( x ˜ n + 1 , u n ) − [ A n + 1 ( x ˜ n + 1 ) − A n ( x ˜ n ) ] = 0 , (23) 其中， G = [ G 1 , 1 , 1 T , ⋯ , G i , j , k T , ⋯ , G n x , n y , n z T ] T ∈ R n x × n y × n z × 3 表示离散的数学模型差分方程组， x ˜ = [ x ˜ 1 , 1 , 1 T , ⋯ , x ˜ i , j , k T , ⋯ , x ˜ n x , n y , n z T ] T ∈ R n x × n y × n z × 3 表示离散的状态向量， u = [ u i , j | u i , j = c Θ i n , i , j , ( i , j ) ∈ κ w ] T ∈ R N w 表示所有注入井的驱替剂注入浓度， κ w 是注入井的位置集合， F 表示差分方程组的流动项， W 表示源汇项， A 表示累积项。 在 t n 时刻网格 ( i , j , k ) 的差分方程组 G i , j , k = [ G o i , j , k , G w i , j , k , G p i , j , k , G s i , j , k , G O H i , j , k ] T 为 G Ψ i , j , k n = F Ψ i , j , k n + 1 + W Ψ i , j , k n + 1 − A Ψ i , j , k n + 1 + A Ψ i , j , k n = 0 , Ψ = { w , o , O H , s , p } , (24) 该方程实际是五个方程的综合， Ψ 中的 w , o , O H , s , p 分别对应离散水相方程、油相方程、以及碱、表面活性剂和聚合物的吸附扩散方程。 根据式(15)以及第(8)~(12)中的流动项系数 r Ζ , Ζ = { o , w } , r c Θ , r d Θ , Θ = { O H , s , p } 定义，流动项 F i , j , k = [ F o i , j , k , F w i , j , k , F p i , j , k , F s i , j , k , F O H i , j , k ] T 的全隐式有限差分可写作 F Ζ i , j , k n + 1 = Δ y Δ z [ r Ζ i + 1 2 , j , k n + 1 Δ x ( E i + 1 , j , k n + 1 − E i , j , k n + 1 ) + r Ζ i − 1 2 , j , k n + 1 Δ x ( E i − 1 , j , k n + 1 − E i , j , k n + 1 ) ]     + Δ x Δ z [ r Ζ i , j + 1 2 , k n + 1 Δ y ( E i , j + 1 , k n + 1 − E i , j , k n + 1 ) + r Ζ i , j − 1 2 , k n + 1 Δ y ( E i , j − 1 , k n + 1 − E i , j , k n + 1 ) ]     + Δ x Δ y [ r Ζ i , j , k + 1 2 n + 1 Δ z ( E i , j , k + 1 n + 1 − E i , j , k n + 1 ) + r Ζ i , j , k − 1 2 n + 1 Δ z ( E i , j , k − 1 n + 1 − E i , j , k n + 1 ) ] , (25) F Θ i , j , k n + 1 = Δ y Δ z [ r d Θ i + 1 2 , j , k n + 1 Δ x ( c Θ i + 1 , j , k n + 1 − c Θ i , j , k n + 1 ) + r d Θ i − 1 2 , j , k n + 1 Δ x ( c Θ i − 1 , j , k n + 1 − c Θ i , j , k n + 1 ) ]     + Δ x Δ z [ r d Θ i , j + 1 2 , k n + 1 Δ y ( c Θ i , j + 1 , k n + 1 − c Θ i , j , k n + 1 ) + r d Θ i , j − 1 2 , k n + 1 Δ y ( c Θ i , j − 1 , k n + 1 − c Θ i , j , k n + 1 ) ]     + Δ x Δ y [ r d Θ i , j , k + 1 2 n + 1 Δ z ( c Θ i , j , k + 1 n + 1 − c Θ i , j , k n + 1 ) + r d Θ i , j , k − 1 2 n + 1 Δ z ( c Θ i , j , k − 1 n + 1 − c Θ i , j , k n + 1 ) ]       + Δ y Δ z [ r c Θ i + 1 2 , j , k n + 1 Δ x ( E i + 1 , j , k n + 1 − E i , j , k n + 1 ) + r c Θ i − 1 2 , j , k n + 1 Δ x ( E i − 1 , j , k n + 1 − E i , j , k n + 1 ) ] + Δ x Δ z [ r c Θ i , j + 1 2 , k n + 1 Δ y ( E i , j + 1 , k n + 1 − E i , j , k n + 1 ) + r c Θ i , j − 1 2 , k n + 1 Δ y ( E i , j − 1 , k n + 1 − E i , j , k n + 1 ) ]   + Δ x Δ y [ r c Θ i , j , k + 1 2 n + 1 Δ z ( E i , j , k + 1 n + 1 − E i , j , k n + 1 ) + r c Θ i , j , k − 1 2 n + 1 Δ z ( E i , j , k − 1 n + 1 − E i , j , k n + 1 ) ] . (26) 其中， E = p − ρ g h 表示流体的流势。 结合公式(8)~(12)以及(17)，源汇项 W i , j , k = [ W o i , j , k , W w i , j , k , W p i , j , k , W s i , j , k , W O H i , j , k ] T 可表示为 W o i , j , k n + 1 = q o i , j , k n + 1 = { − ( 1 − f w i , j , k n + 1 ) q o u t i , j n ,     ( x , y , z ) ∈ ψ p 0 ,                                                             ( x , y , z ) ∉ ψ p (27) W w i , j , k n + 1 = q w i , j , k n + 1 = { − f w i , j , k n + 1 q o u t i , j n ,         ( x , y , z ) ∈ ψ p q i n i , j n ,                           ( x , y , z ) ∈ ψ w 0 ,                                   ( x , y , z ) ∉ ψ p ∪ ψ w (28) W p i , j , k n + 1 = q c i , j , k n + 1 = { − f w i , j , k n + 1 q o u t i , j n c p i , j , k n + 1 ,     ( x , y , z ) ∈ ψ p q i n i , j n c p i n i , j n ,                 ( x , y , z ) ∈ ψ w 0 ,                                     ( x , y , z ) ∉ ψ p ∪ ψ w (29) W s i , j , k n + 1 = q d i , j , k n + 1 = { − f w i , j , k n + 1 q o u t i , j n c w s i , j , k n + 1 − ( 1 − f w i , j , k n + 1 ) q o u t i , j n c o s i , j , k n + 1 ,     ( x , y , z ) ∈ ψ p q i n i , j n c s i n i , j n ,                       ( x , y , z ) ∈ ψ w 0 ,                                       ( x , y , z ) ∉ ψ p ∪ ψ w (30) W O H i , j , k n + 1 = R O H i , j , k n + 1 + q e i , j , k n + 1 = { R O H i , j , k n + 1 − f w i , j , k n + 1 q o u t i , j n c O H i , j , k n + 1 ,     ( x , y , z ) ∈ ψ p R O H i , j , k n + 1 + q i n i , j n c O H i n i , j n ,               ( x , y , z ) ∈ ψ w 0 ,                                   ( x , y , z ) ∉ ψ p ∪ ψ w (31) 其中，式(31)为修正碱耗后的碱吸附方程源汇项， R O H 为系统碱耗。结合井参数，系统的含水率 f w i , j , k n + 1 可修正为 f w i , j , k n + 1 = W I i , j , k ( r w i , j , k + r o i , j , k ) ∑ k ′ = 1 n z W I i , j , k ′ ( r w i , j , k ′ + r o i , j , k ′ ) , (32) WI表示井指数 [ 11 ] ，定义如下 W I = 2 π K Δ z ln d e d w + S , (33) 其中， d e , d w 分别为井筒半径和井筒等效半径，S为表皮系数，当采用矩形离散化网格且渗透率非均质时 d e 表示如下 [ 12 ] d e ≅ 0.28 [ ( K y K x ) 1 2 Δ x 2 + ( K x K y ) 1 2 Δ y 2 ] 1 2 / ( K y K x ) 1 2 + ( K x K y ) 1 2 , (34) 其中， K x , K y 分别表示在 x , y 方向上的绝对渗透率。 类似地，采用全隐式有限差分可将累积项 A i , j , k = [ A o i , j , k , A w i , j , k , A p i , j , k , A s i , j , k , A O H i , j , k ] T 表示为 A o i , j , k n + 1 = V i , j , k Δ t n ϕ i , j , k n + 1 ( 1 − S w i , j , k n + 1 ) B o i , j , k n + 1 , A o i , j , k n = V i , j , k Δ t n ϕ i , j , k n ( 1 − S w i , j , k n ) B o i , j , k n , (35) A w i , j , k n + 1 = V i , j , k Δ t n ϕ i , j , k n + 1 S w i , j , k n + 1 B w i , j , k n + 1 , A w i , j , k n = V i , j , k Δ t n ϕ i , j , k n S w i , j , k n B w i , j , k n , (36) A p i , j , k n + 1 = V i , j , k Δ t n [ ρ r ( 1 − ϕ i , j , k n + 1 ) C r p i , j , k n + 1 + ϕ p i , j , k n + 1 S w i , j , k n + 1 c p i , j , k n + 1 B w i , j , k n + 1 ] , A p i , j , k n = V i , j , k Δ t n [ ρ r ( 1 − ϕ i , j , k n ) C r p i , j , k n + ϕ p i , j , k n S w i , j , k n c p i , j , k n B w i , j , k n ] , (37) A s i , j , k n + 1 = V i , j , k Δ t n [ ϕ s i , j , k n + 1 S o i , j , k n + 1 c o s i , j , k n + 1 B o i , j , k n + 1 + ϕ s i , j , k n + 1 S w i , j , k n + 1 c w s i , j , k n + 1 B w i , j , k n + 1 + ρ r ( 1 − ϕ i , j , k n + 1 ) C r s i , j , k n + 1 ] , A s i , j , k n = V i , j , k Δ t n [ ϕ s i , j , k n S o i , j , k n c o s i , j , k n B o i , j , k n + ϕ s i , j , k n S w i , j , k n c w s i , j , k n B w i , j , k n + ρ r ( 1 − ϕ i , j , k n ) C r s i , j , k n ] , (38) A O H i , j , k n + 1 = V i , j , k Δ t n [ K a ( 1 + K b c O H i , j , k n + 1 ) 2 ( 1 − ϕ i , j , k n + 1 ) S w i , j , k n + 1 c O H i , j , k n + 1 + ϕ i , j , k n + 1 S w i , j , k n + 1 c O H i , j , k n + 1 B w i , j , k n + 1 ] , A O H i , j , k n = V i , j , k Δ t n [ K a ( 1 + K b c O H i , j , k n ) 2 ( 1 − ϕ i , j , k n ) S w i , j , k n c O H i , j , k n + ϕ i , j , k n S w i , j , k n c O H i , j , k n B w i , j , k n ] , (39) 边界条件公式(7)可以表示为 ∂ x ∂ x = 0 , ∂ x ∂ y = 0 , ∂ x ∂ z = 0 , ∀ ( x , y , z ) ∈ ∂ Ω . (40) 上式可采用全隐式有限差分离散为 x 0 , j , k = x 1 , j , k , x n x + 1 , j , k = x n x , j , k , j = 1 , 2 , ⋯ , n y , k = 1 , 2 , ⋯ , n z , (41) x i , 0 , k = x i , 1 , k , x i , n y + 1 , k = x i , n y , k , i = 1 , 2 , ⋯ , n x , k = 1 , 2 , ⋯ , n z , (42) x i , j , 0 = x i , j , 1 , x i , j , n z + 1 = x i , j , n z , i = 1 , 2 , ⋯ , n x , j = 1 , 2 , ⋯ , n y . (43) 初始条件公式(6)可用全隐式有限差分离散化为 x i , j , k 0 = x ( x i , y j , z k , 0 ) , i = 1 , ⋯ , n x , j = 1 , ⋯ , n y , k = 1 , ⋯ , n z . (44) 至此，在时域和空间域上连续的三元复合驱偏微分系统公式(1)~(7)已经通过全隐式有限差分法离散化为一系列非线性隐式差分代数方程组。  针对上节得到的差分代数方程组，这里采用Newton-Raphson法 [ 13 ] 进行求解： ∂ G n ∂ x ˜ n + 1 | x ˜ n + 1 , l δ x ˜ n + 1 , l = − G n ( x ˜ n + 1 , x ˜ n , u n ) , (45) x ˜ n + 1 , l + 1 = x ˜ n + 1 , l + δ x ˜ n + 1 , l , (46) 式中，l表示迭代次数， x ˜ n + 1 , l 表示第l次迭代的离散状态向量， ∂ G n ∂ x ˜ n + 1 | x ˜ n + 1 , l 为Jacobian矩阵，计算公式如下： ∂ G n ∂ x ˜ n + 1 | x ˜ n + 1 , l = ∂ F n + 1 ∂ x ˜ n + 1 , l + ∂ W n + 1 ∂ x ˜ n + 1 , l − ∂ A n + 1 ∂ x ˜ n + 1 , l . (47) 通过求解公式(45)可得 δ x ˜ n + 1 , l ， x ˜ n + 1 , l + 1 的更新通过公式(46)实现。算法每一步迭代的具体实现过程如图2所示，其中，ε为设定的精度。在得到的隐式差分代数方程组的基础上，通过迭代求解，得到整个空间的状态。"
"对于第2节中给出的三维三元复合驱模型，假设三元复合驱油藏由四口注入井和九口采出井构成，所有的井位均匀分布，在每四口采出井中心有一口注入井。其中S表示采出井，I表示注入井。具体井位分布同图3所示。三维油藏参数：长630 m，宽630 m，厚19.990 m，总共有七层，每层厚2.857 m，净厚度为1.4286 m，油层上表面距地表2420 m，每层的孔隙度为0.3，孔隙体积为 1.1097 × 10 6 m 3 。油藏中三种驱替剂(碱、表面活性剂和聚合物)的初始网格浓度为0 g/L。初始渗透率、初始压力和初始含水饱和 图2. Newton-Raphson迭代求解原理图 图3. 井位分布图 度如图4、图5和图6所示。整个油藏分为 x , y , z 三个方向，其中 x , y 方向各等分为21个网格，z方向7个网格，总网格数为 21 × 21 × 7 。每口注入井的注入率 q i n 为83m 3 /天，采出井的采出率 q o u t 如表1所示，部分油藏参数见表2。整个驱油过程持续96个月，三元复合驱周期为48个月，后面为水驱，考虑到三元复合驱注入的初始时间点，总共有 L = 97 个时间点，总空间点为 N = 21 × 21 × 7 。  采用本文提出的方法对三元复合驱模型进行求解，为四口注入井设置相同的注入策略，对于碱、表面活性剂和聚合物的具体注入浓度如下： c O H i n = ( 3.7 , 2.8 , 1.3 ) g / L ,   c s i n = ( 2.9 , 1.3 , 0.6 ) g / L ,   c p i n = ( 2.7 , 1.4 , 1.1 ) g / L . 整个采油周期为96个月，驱替剂注入为三段塞，每个段塞持续16个月，共48个月，剩余时间为水驱。具体的注入策略如图7(a)所示，由于三维三元复合驱中考虑时间、空间和含水饱和度因素，总共五个维度，无法再三维图形中显示。为了说明建模效果，我们选取第三层中从 ( 1 , 11 , 3 ) 到 ( 21 , 11 , 3 ) 的21个网格，将结果显示在图7中。图7(b)为CMG数值模拟软件得到的空间含水饱和度，图7(c)为采用本文提出方法求解得到的含水饱和度。图8为含水饱和度的求解误差。图9为九口采出井的含水率结果对比。通过对比可以发现，本文提出的方法的求解结果与CMG2010软件的求解结果，无论是对于含水饱和度状态还是含水率都基本一致。从而说明了本文提出方法的有效性。"
"三元复合驱是一项重要的三次采油技术，由于其模型复杂，涉及变量多，油藏成分不确定等因素，目前很少有学者对三元复合驱的数学模型和计算方法进行系统的研究。本文建立了三元复合驱的渗流模 图4. 初始渗透率分布 图5. 初始压力分布 图6. 初始含水饱和度分布 图7. 求解结果对比。(a) 注入浓度；(b) CMG软件结果；(c) 本文提出方法的求解结果 图8. 含水饱和度建模误差 图9. 九口采出井含水率比较 Table 1 生产井位号 S1-1 S1-2 S1-3 S2-1 S2-2 S2-3 S3-1 S3-2 S3-3 产液量m 3 /d 20.75 41.5 20.75 83 41.5 41.5 20.75 41.5 20.75 表1. 采出井采液量 Table 2 符号 数值 符号 数值 符号 数值 M O H max 800 M s max 200 M p max 600 c O H max 2 c s max 0.5 c p max 1.5 S w 0 0.35 S o r 0.02 D p 1 × 10 − 5 D O H 1.5 × 10 − 5 D s 0.9 × 10 − 5 μ o 20 ρ o 950 μ w 0.458 ρ s 1000 ρ w 1000 ρ r 2000 ------ ------ 表2. 三元复合驱部分油藏参数 注：变量的单位为： M Θ max -kg， c Θ max -g/L，ρ-kg/m 3 ，D-m 2 /s，μ-μm 2 ，S-[-]。 型，能够科学的描述油水渗流机理，碱、表面活性剂和聚合物的吸附过程，以及对油藏物理化学特性的影响。采用全隐式有限差分法多数学模型进行离散求解，具有较好的数值稳定性和收敛性。将偏微分方程系统离散化为差分方程组后，结合Newton-Raphson法进行求解，通过与成熟数值模拟软件CMG的结果对比，验证了本文提出方法的精度和求解效果。"
"国家自然科学基金(61573378)；山东省自然科学基金(ZR2011FM002)；中央高校基本科研业务费专项基金(15CX06064A)。"
