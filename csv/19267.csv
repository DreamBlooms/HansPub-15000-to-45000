"本文采用Cortex-M4嵌入式处理器、GPS/北斗双模定位模块以及9轴MEMS传感器设计了一种可应用于车辆定位和姿态检测的低成本、微型化组合惯性导航装置。装置采用Cortex-M4处理器对GPS/北斗双模定位模块以及MEMS惯性传感器采集到的数据进行解算，解算后的数据通过UART和CAN总线发送到显示终端或者其它后端设备。实验结果表明该装置能够满足车辆定位与姿态检测的稳定性和实时性要求，具有良好的应用前景。 关键词 :全球定位系统，MEMS传感器，组合惯导，Cortex-M4"
"随着中国车联网行业的兴起与发展，车辆的各种状态信息采集与检测对车联网行业的发展起着越来越重要的作用。而车辆的定位和姿态信息作为车辆状态信息的一部分，可以用来实时检测车辆的运动状态和过程，对未来的车辆防碰撞预警或者自动驾驶具有关键作用。对于车辆的定位和姿态信息采集与检测需要用到惯性导航系统。 传统的惯性导航系统是以牛顿力学第二定律为理论基础，利用加速度传感器、陀螺仪以及地磁传感器通过载体初始的基准方向和初始位置来确定载体实时的位置、速度和姿态的导航系统 [ 1 ] 。这种导航系统由于成本价格较低、不受环境干扰、完全自主等优点已经广泛应用到各种导航系统中 [ 2 ] 。但是由于传统的惯性导航系统定位误差随所使用时间而发散，严重影响了导航的精度，在实际应用中需要进行校准与修正。利用GPS进行定位导航具有定位精度高、误差不随时间积累等优点，但是容易受到气象、建筑物等环境影响。目前比较流行的惯导设计方法是在传统的惯性导航系统基础上，增加GPS功能，通过数据融合达到利用彼此优点，同时克服或者降低彼此缺点的效果 [ 3 ] [ 4 ] 。 本文利用GPS/北斗双模定位模块以及MEMS惯性传感器设计实现了一种主要应用于车辆定位定姿的组合惯导系统，并对硬件实现部分进行了详细介绍。"
"系统由外部3.3 V电源供电，采用Cortex-M4 处理器对GPS/北斗双模定位模块以及MEMS惯性传感器采集到的数据进行解算，然后利用UART和CAN发送到显示终端或者其他设备。系统的硬件结构框图如图1所示。 GPS/MEMS组合导航系统硬件整体结构从功能上可以分为MCU模块、通信模块以及由GPS、压力传感器和9轴传感器组成的导航信息采集模块三部分。其中MCU模块完成导航信息的处理和通信控制， 图1. GPS/MEMS组合导航系统硬件整体结构框图 通信模块完成将MCU处理后的数据信息进行传输，导航信息采集模块完成车辆载体的定位定姿检测。9轴传感器采用包含有3轴加速度、3轴陀螺和3轴地磁信号的集成MEMS传感器来实现设计。  系统上电后，由MCU对所有用到的外设进行初始化，并打开定时器中断，中断周期为5 ms。经过30 s后，MCU将向UART或者CAN发送0xFF表示准备发送数据，并且开始读取GPS数据和MEMS惯导数据。在将读取到的野点数据剔除后，进行卡尔曼滤波，然后将GPS和MEMS惯导融合处理后的数据进行存储，用作下一次滤波的参考数据。每当5 ms中断到来的时候，MCU将把解算后的导航数据通过UART或者CAN发送出去。"
"MCU模块的主要功能是采集GPS、压力传感器和9轴传感器的信息，并对采集到的实时信息进行解算。被解算后的数据经过数据融合算法处理，然后进行存储或者定时器中断到来时将数据通过UART或者CAN发送给显示终端或者其他后端设备。 由于ST公司推出了支持Cortex-M4内核架构的通用函数库，使得产品设计开发变得更加容易。MCU模块部分采用ST公司具有32位Cortex-M4内核架构的STM32F405RGT6微控制器作为核心器件，其核心电路原理图如图2所示。该器件的主要特点如下： 1) 具有1 MB的内部Flash和192 + 4 KB的内部SRAM； 2) 具有3个SPI控制器接口； 3) 具有3个I2C控制器接口； 4) 具有4个USART和2个UART控制器接口； 5) 最高主频为168 MHz； 6) 采用LQFP64封装类型； 7) 具有51个GPIO； 8) 工作温度为−40℃~+85℃。  通信模块的主要功能是将MCU处理后的车辆位置和姿态相关数据发送给显示终端或者其他后端设备。通信模块采用UART和CAN两种通信方式，可以根据现场实际应用选择相应的通信方式。 图2. MCU模块的核心电路图  UART通信电路采用ADI的ADM3232E接口器件实现TTL转RS232电平转换，其电路原理图如图3所示。该芯片的主要特点为： 1) 输入与输出均提供符合IEC1000-4-2 (801.2)要求的ESD保护； 2) 具有双通道收发接口； 3) 功耗较低； 4) 3.3 V单电源供电； 数据最高速率可以达到460 kbps。  CAN通信采用TI的SN65HVD230来实现接口电路，该器件适用于较高通信速率、良好抗干扰能力和高可靠性CAN总线的串行通信，图4为CAN通信电路原理图。该芯片的主要特点为： 1) 高输入阻抗，支持高达120个节点； 2) 支持低电流等待模式，典型电流为370 uA； 3) 信号传输速率高达1 Mb/s； 4) 具有热保护、开路失效保护功能； 图3. UART通信电路原理图 图4. CAN通信电路原理图 5) 3.3 V单电源供电； 6) 具有抗瞬间干扰的ESD保护功能。  导航信息采集模块的主要作用是实时检测车辆载体的位置和姿态信息，并将采集到的信息通过串行通信方式传送给MCU模块。该模块分别采用GPS和MEMS惯导电路组成。GPS电路作为车辆载体定位定姿的主要手段，MEMS惯导电路是防止车辆载体在受环境影响，不能准确接受GPS信号时，提供辅助定位定姿信息。  GPS电路采用U-BLOX公司的MAX-M8Q卫星定位模块来实现，采用GPS+北斗双模模式进行导航定位，其电路原理图如图5所示。该模块能在较低的功耗下同时满足高灵敏度和最小采样时间的要求。该模块具有如下特点： 1) 支持NMEA-0183协议；2) 初始波特率为9600 bps；3) 支持双模接收模式，可以同时接受GPS和GLONASS，或者GPS和北斗；4) 72通道U-BLOX M8引擎；5) 定位精度为2.0 CEP；6) 冷启动时间为26 s。 图5. GPS模块电路原理图  MEMS惯导电路由三轴加速度、三轴陀螺和三轴地磁构成9轴传感器电路和压力传感器两部分电路组成。 (1) 9轴传感器电路设计 9轴传感器采用MPU9255复合芯片来实现，采用串行通信方式，它可直接输出9轴的全部数据，让开发者避开了繁琐复杂的芯片选择和外设成本，保证最佳的性能。9轴传感器相关电路如图6所示。该芯片具有以下主要特点： 1) 加速度和陀螺仪的AD分辨率为16位，地磁传感器为6位AD； 2) 具有I2C接口和SPI接口； 3) 可编程的传感器量程输出； 4) 具有业界领先的数字滤波器； 5) 能够承受10,000 g的震动冲击。 (2) 压力传感器电路设计 压力传感器主要是通过测量车辆载体周围的大气压强来计算车辆载体所处位置的海拔高度。该电路采用BOSCH的具有高精度、小体积超低功耗BMP180压力传感器芯片来设计，其电路原理图如图7所示。该芯片的主要特点为： 1) 压力范围：300~1100 hPa (海拔9000米~−500米)； 2) 支持3.3 V供电电压； 3) 在标准模式下具有5 uA的低功耗； 4) 在低功耗模式下，分辨率为0.06 hPa (0.5米)； 5) 具有I2C接口； 6) 具有温度补偿功能。"
"将MCU解算后的数据通过串口调试工具XCOM (V2.0)输出，如图8所示。 将经纬度输入Google earth进行查询，结果如图9所示，图中红色坐标位置正是进行测试的位置，定位精度小于3米。 图6. 9轴传感器电路原理图 图7. 压力传感器电路原理图 图8. 串口输出的信息 图9. 地理位置查询结果 Table 1 次数 状态 导航误差 姿态误差 Vx (m/s) Vy (m/s) Vz (m/s) Δx/m Δy/m Δz/m 1 惯导 −1.2 1.45 1.1 −67.34 56.21 50.11 78.15 组合 0.1 0.06 0.1 4.12 5.42 4.51 4.32 2 惯导 −1.5 1.4 1.2 −58.76 50.25 46.78 65.45 组合 −0.1 0.17 −0.05 −3.12 5 −2.85 4.8 3 惯导 1.5 1.2 −0.98 50.87 44.24 −35.4 70.1 组合 0.1 1.1 −0.1 3.31 3.87 −5.65 4.66 表1. 车载性能实验数据  将纯惯导INS-XXX(陀螺精度0.01˚/h)与组合惯导固定在同一钢板，调试完毕后，将其安装在试验车上，选取标准点A和标准点B，A、B两点的距离大于5 min车辆行驶距离。组合惯导的精度考核方法如下： 1) 在A点装订好初始位置，并完成初始对准； 2) 车辆行驶，组合惯导进行传递对准； 3) 惯导完成传递对准后，自动进入导航状态，车辆行驶到B点后，记录组合惯导的有关数据； 为了能真实地模拟实际情况，选择的路况包括倾斜路、斜坡路、S型路的环形路(倾斜路：300 m长，倾斜30˚；斜坡路：300 m长，斜坡陡度为30˚；S型路：半径为80 m)。 重复上述过程5次左右，根据GJB729 [ 5 ] ，姿态和高程误差可按均方误差评定，位置误差按圆概率误差评定，计算组合惯导的精度公式： 姿态误差 (1) 高程误差 (2) 水平位置误差 (3) 式中，R i 为组合惯导的位置值与标准点的径向误差。 将GPS信号接入组合惯导后，重复第一到第三过程5次左右，可考核组合导航系统的精度。经过120 s后，纯惯导和组合后的车载性能实验实测数据如表1所示。 分别按照式(1)、(2)和(3)计算得到：σA =3.89'；HE = 2.86 m；CEP = 3.08 m。"
"本文针对车辆定位定姿的惯导系统应用需求，设计了一种低成本的基于MEMS惯性传感器及GPS/北斗双模定位模块的小型组合惯导系统，并对硬件实现部分：MCU模块、通信模块以及由GPS、压力传感器和9轴传感器组成的导航信息采集模块三部分进行了详细设计。经实地车载测试证明，本惯导系统不仅性价比高，而且具有较高的精度和可靠性，具有良好的应用前景。"
