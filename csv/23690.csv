"研究区域选在AERONET在中国地区代表性较强且观测时间序列较长的SACOL站点。运用该站点的Landsat5 TM影像数据，用6S模型、MODTRAN模型、ATCOR模型在没有参数的条件下分别对这一影像进行大气校正，再用影像实地测量的参数算出更接近真实地表反射率的的地表反射率对3种不同模型算出的地表反射率进行比较研究，结合NDVI值比较。结果显示FLAASH能更好地获得地表反射率，6S能使植被更突出，ATCOR处理速度快。在今后大气校正中可结合3种模型特点校正图像。 关键词 :大气校正，6S，MODTRAN，ATCOR Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"从遥感图像获得地表反射率的过程通常叫做光学遥感的大气校正 [ 1 ] 。遥感技术因具有时效性、稳定性和能大面积观测等特点，已逐步代替了传统的地面调查统计，并在农业调查统计、监测中发挥着越来越重要的作用。卫星数据作为遥感技术的数据源，由于大气层会对太阳辐射和地面反射进行散射和吸收，使卫星初始提供的影像数据存在失真情况，而为了还原真实的地表反射率，大气校正的目的正是为了获取地物真实反射率数据。因此，精准稳定的大气校正尤为重要，是遥感定量化应用的前提和基础，而卫星遥感图像的大气校正一直是遥感定量化研究的主要难点和热点之一。近年来随着卫星技术的迅猛发展，特别是利用多源数据和多时相数据的土地利用和土地覆盖类型变化的监测、气候变化监测等的需要，使得精准稳定快速的遥感图像大气校正方法的研究越来越受到重视。 学者们提出了很多大气校正方法，可大致可归纳为：基于图像特征的相对校正法、基于地面线性回归模型法、基于大气辐射传输模型法 [ 2 ] 。在诸多的大气校正方法中校正精度高的方法是辐射传输模型法，辐射传输模型法是利用电磁波在大气中的辐射传输原理建立起来的模型对遥感图像进行大气校正的方法，其算法在原理上基本相同，差异在于不同的假设条件和适用的范围 [ 3 ] 。由于遥感成像过程复杂、大气对电磁波辐射传输影响不确定因素较多，目前的方法都存在着各自的优缺点。目前常用的大气校正辐射传输模型主要是6S (Second Simulation of the Satellite Signal in the SolarSpectrum)模型、MODTRAN (Moderate Resolution Transmission)模型、ATCOR (spatially adaptive fast atmospheric correction)模型这3种 [ 4 ] 。本文用这3种常用的大气辐射传输模型进行对比分析，为以后一些地区的大气校正该用哪些辐射传输模型比较精确提供一些参考。"
"AERONET (Aerosol Robotic Network)是美国国家宇航局(NASA)和法国家科学研究中心(CNRS)共同组建的覆盖了全球，有500多个站点，运用太阳光度计观测的气溶胶监测网，其观测数据精度较高，误差很小，通常将其测得的气溶胶光学厚度作为真值 [ 5 ] 。其对全球和区域气溶胶光学特性、环境和辐射效应、卫星遥感和数值模式产品的验证和评估等方面的研究发挥了重要作用。 研究区域选在中国地区代表性较强且观测时间序列较长的SACOL (兰州大学半干旱气候与环境观测站)站点。SACOL站点是AERONET设在中国的站点，位于甘肃省中部的榆中县，下垫面是典型的黄土高原地貌，周围植被基本都是当地原始植被。SACOL站点的地理坐标为35.946˚N，104.137˚E，海拔为1965 m，如图1所示。影像数据采用的是研究区域2011年9月29日的Landsat5 TM影像数据和由SACOL站点实测的2011年9月29日的该地点的550 nm的AOT (aerosol optical thickness)气溶胶光学厚度。"
"本文运用集成在ENVI软件中的FLAASH大气校正工具(基于MODTRAN模型)、6S_V4.1程序(基于6S模型)、集成在Erdas软件中的ATCOR模型分别对同一景影像在没有输入实测参数的条件下进行大气校正，再使用实测的气溶胶光学厚度输入6S模型中计算出更接近真实地表反射率的的地表反射率作为真值，对比这3种模型的大气校正结果，分析各自的优缺点和精度。首先是对遥感影像进行辐射定标。  辐射定标是将传感器记录的无量纲的DN值转换成具有实际物理意义的大气顶层辐射亮度值或者反射率，是将传感器记录的电压或数字量化为绝对辐射亮度值(辐射率)的过程 [ 6 ] 。辐射定标的原理是建立数字量化值与对应视场中辐射亮度值之间的定量关系，以消除传感器本身产生的误差。 首先把图像灰度值转换成具有辐射意义的亮度值，如下： L λ = ( L max − L min ) / 255 × D N + L min (1) 公式(1)中 L λ 是某个波段光谱辐射亮度， L max 、 L min 分别为最大和最小灰度值对应的辐射亮度值，DN是传感器初始的图像灰度值。公式(2)可以计算地物在大气外的顶部光谱反射率 ρ T O A (表观反射率)。 ρ T O A = ( π × L × D 2 ) / ( E λ × cos ( θ s ) ) (2) 公式(2)中，D为当时日期的日地天文单位距离； E λ 为波段λ处的大气顶部平均太阳辐照度； θ s 为当时的太阳天顶角，即太阳高度角的余角。 图1. 遥感影像地理位置  MODTARN模型是由美国空军地球物理实验室(AFGL)开发的计算大气透过率及辐射的大气辐射模型 [ 7 ] 。MODTRAN模型是在LOWTRAN模型的基础上发展来的，改进了LOWTRAN (low resolution transmission)模型的光谱分辨率较低的问题。MODTRAN模型的基本算法包括透过率计算、多次散射处理、几何路径计算等。需要输入的参数有四类：计算模式，大气参数，气溶胶参数和云模式。ENVI的FLAASH大气校正模块就是基于MODTRAN模型。因此，本文的MODTRAN模型的大气校正采用的是ENVI软件中的FLAASH大气校正工具。 用ENVI的FLAASH大气校正模块对影像数据进行大气校正。FLAASH大气校正需要输入的是经辐射定标后的影像数据，然后根据操作手册上的说明进行大气校正 [ 6 ] 。需要输入的参数有：影像的日期；影像的中心经纬度；因为选用TM数据所以传感器选择Landsat TM5，地面平均高层为1500米，大气可见度设为20 km，气候模型(Atmosphe--ric Model)选择中纬度夏季气候，气溶胶模型(Aerosol Model)选择大陆乡村模型，参数都选取完毕后进行大气校正后，就能得到FLAASH校正后的影像，如图2(b)。  6S大气校正模型是美国马里兰大学地理系Vermote等人于1997年在5S模型的基础上改进的 [ 7 ] 。6S模型可以很好地模拟太阳光在太阳－地面目标－传感器的传输过程中所受到的大气影响。相对于5S模型，6S模型考虑了地面目标的海拔高度、非朗伯平面的情况和新的吸收气体种类(CH4，N2O，CO)，提高了瑞利和气溶胶散射作用的计算精度。光谱步长提高到了2.5 nm。6S模型建立在辐射传输理论基础之上，模型应用范围广，不受研究区特点及目标类型等的影响。常用的基于6S模型的大气校正程序是6S_V4.1，所以本文的6S模型的大气校正采用的是6S_V4.1 [ 8 ] [ 9 ] [ 10 ] 。 图2. 大气校正后的图像 用大气辐射传输软件-6S_V4.1计算6S模型大气校正所需参数如下：需要输入的是影像的日期，影像的中心经纬度，卫星选取Landsat TM5，地面平均高层为1500米，大气模式选择中纬度夏季气候，气溶胶模式选择大陆型，大气可见度设为20 km，运行后得到6S模型所需大气校正参数X a 、X b 、X c 。运用公式(3)和(4)计算地表反射率 [ 7 ] 。 y = X a × L i − X b (3) ρ = y / ( 1 + X c × y ) (4) 公式4中， ρ 为校正后反射率， L i 为第i波段辐射率。运用公式3带入ENVI中的波段计算器进行6S大气校正，这里要进行6个波段的计算，再把6个波段进行叠加得到6S大气校正影像，如图2(c)。  ATCOR大气校正模型是由德国的Wessling光电研究所的Rudolf Richter博士于1990年研究并提出的一种快速大气校正模型，并且经过大量的验证和评估 [ 7 ] 。ATCOR2是一个应用于高空间分辨率光学卫星传感器的快速大气校正模型，它假定研究区域是相对平的地区并且大气状况通过一个查证表来描述。 运用Erdas的ATCOR大气校正模块。需要输入的参数是：影像的日期，影像的中心经纬度，卫星选取Landsat TM5，地面平均高层为1500米，大气模式选择中纬度夏季气候，气溶胶模式选择大陆型，大气可见度设为20 km。这里要进行6个波段的校正，再把6个波段进行叠加得到ATCOR大气校正影像，如图2(d)。"
"3种模型校正后图像的地物辨识度都比原始图像清晰，较好地消除了大气的影响，恢复了下垫面的原貌，校正后的图像均比原图更加清晰，对比度有所增加，但3种模型校正后图像都有所不同，图2为在ENVI中线性2%拉伸的结果。  地表实测参数校正反射率是用AERONET站点的数据更精确得校正地表反射率，用影像实地测量的参数算出更接近真实地表反射率的的地表反射率 [ 11 ] 。因为6S模型受研究区域和目标类型等条件的不同的影响较小，与MODTRAN模型相比，具有较高的精度，我们把AERONET站点的气溶胶数据代入到6SV代码中计算出地表反射率 [ 12 ] 。需要用到的数据是550 nm的AOT气溶胶光学厚度，由此产生的AERONET校正地表反射率数据被认为是更接近真实地表反射率的的地表反射率，因为在大气校正的最大的不确定性来自气溶胶特性，AERONET站点提供最精确的气溶胶数据 [ 13 ] 。 公式5中，为平均相对误差，X为辐射模型反射率，Y为地表实测参数校正反射率。3种模型校正后的地表反射率与地表实测参数校正反射率进行对比，结果显示FLAASH更接近真实的地表反射率，ATCOR最差，其中平均相对误差为公式5的计算结果，如表1和图3。 P = ∑ ( ( X − Y ) / Y × 100 % ) / N (5)  大气校正能够显著改善植被指数，因此，可以通过分析大气校正前后归一化植被指数的变化情况来评价大气校正的效果 [ 14 ] [ 15 ] 。对3种模型校正后的图像计算NDVI (Normalized Difference Vegetation Table 1 波段 地表实测参数校正反射率 FLAASH校正 6S校正 ATCOR校正 Band1 (Blue) 0.049 0.058 0.032 0.026 Band2 (Green) 0.093 0.093 0.076 0.064 Band3 (Red) 0.096 0.097 0.087 0.075 Band4 (NIR) 0.209 0.201 0.212 0.180 Band5 (SWIR1) 0.235 0.233 0.247 0.183 Band7 (SWIR2) 0.187 0.191 0.198 0.173 平均相对误差 4.82% 13.80% 27.20% 表1. 3种模型校正后的地表反射率与地表实测参数校正反射率对比 图3. 地表反射率对比 Index)归一化植被指数，统计NDVI最小值、最大值、平均值、标准差，如表2。结果显示经6S大气校正后的NDVI值更高，绿色植被指数更高。说明6S大气校正后，图像的绿色植被能够被更好地显示。由前文分析得出，FLAASH更接近真实的地表反射率，所以选取FLAASH校正结果的NDVI与6S校正结果的NDVI对比分析得出，两种大气校正都显著改善了植被指数，结果显示两种校正趋势保持高度一致，如图4。评价使用的是决定系数R 2 和均方根误差(root mean square error，RMSE)，决定系数R 2 越接近于1，说明相关性越高，均方根误差RMSE越接近于0，说明相差越小。"
"三种大气校正都较好地消除了大气的影响，能够准确地从图像中获取地表反射率信息并且保持了各波段的反射率趋势。虽然三种大气校正模型都是基于辐射传输方程来消除成像过程中大气效应对遥感影像的影响，但由于辐射传输方程求解复杂且受很多不同条件的影响，6S、FLAASH、ATCOR运用了不同的方法近似求解方程，使得计算出的结果必然存在着一些差异。 地表实测参数校正反射率和NDVI的对比结果显示，对于地面其他地物校正将采用FLAASH大气校正，对于植被的大气校正将采用6S模型，ATCOR能更快速的进行校正。将三种辐射传输模型方法结合使用，可更好地消除大气效应对整个研究区域的影响。从校正后图像的文件大小来看ATCOR模型校正后图像文件存储空间最小，6S模型大气校正后图像文件存储空间最大。从校正的速度来看，ATCOR模型的运行速度最快，FLAASH运行速度最慢。从校正的步骤上来看，FLAASH大气校正运行一次就能校 Table 2 大气校正模型 最小值 最大值 平均值 标准差 6S −1 1 0.264330 0.229214 FLAASH −1 1 0.232023 0.211050 ATCOR −1 1 0.129087 0.146659 表2. NDVI值对比 图4. 6S与FLAASH校正的NDVI对比 正影像的6个波段，ATCOR和6SV需要一个波段一个波段地进行校正后再把6个波段叠加成一个图像。在今后的大气校正中可以针对3种模型的不同特点和校正结果选取合适自己研究内容的大气校正模型。运用三种辐射传输模型的不同特点并结合使用，能更好地消除大气效应对研究区域的影响。"
