"针对由于构建城市三维模型工作量巨大、费用昂贵、须具备较高的制作技巧，虚拟现实技术无法广泛应用的城市规划的现状，本文以SketchUp为平台，以规划设计的总平面图、立面剖面图和方案效果图为基础数据，研究如何快速、高效、低成本的制作出浸沉感好、交互性强和构想性优越的三维场景。本文采用了SketchUp基于CAD底图和效果图两种建模方法，并通过丰富景观模型、三维模型“瘦身”和设置光影效果三种手段进一步优化三维场景，提出利用Google Earth平台调整规划方案的设想。该研究充分显示了SketchUp结合虚拟现实技术应用于城市规划的优越性。 关键词 :SketchUp，三维建模，虚拟规划，Google Earth"
"城市作为经济建设的主战场，发展最快速、信息最丰富、资本最集中，信息化进程突飞猛进、日新月异，对地理信息的需求最旺盛 [ 1 ] 。人们不断加强虚拟现实技术在城市规划中的应用，以满足生活生产的需要，虚拟规划设计应运而生。与传统的规划设计方法所不同，虚拟规划设计对于降低规划设计成本，缩短工作周期，提高工作质量起到了重要作用。借助虚拟规划设计手段，规划设计人员可以根据自己的视觉习惯使城市规划设计变得灵活直观，便于进行方案的布局调整，得到自己满意的结果，最终在虚实互动的体验中来创建城市。 在城市规划中无论采用何种虚拟现实方式，首先要解决三维建模问题 [ 2 ] ，目前常采用的方法有建模工具和建模语言。本文选取SketchUp为建模工具，以微观范围内的金泰家园小区规划为例，介绍了虚拟小区的建模方法以及后期优化技术，并进一步探讨SketchUp建模技术应用于宏观范围内的城市规划的可行性。"
"本文采用规划设计的CAD图纸和方案效果图为基础数据，大大减少了获取矢量数据和纹理数据的工作量；选取的建模工具SketchUp适合做三维建筑模型，模型文件较小，便于传输 [ 3 ] ，而且操作界面友好、精度高、拥有优秀的方案深化能力和自主的二次开发功能。应用SketchUp制作虚拟小区的技术流程如图1所示，采用SketchUp三维建模软件制作出单体三维模型，然后再组织成三维场景 [ 4 ] 。"
"空间数据的获取和空间实体的三维建模是建立三维城市模型的核心问题，也是区域三维建模领域研究的重点 [ 5 ] 。基于CAD底图建模方法，能最大化的利用现有的数据资料，节约建模人员描绘底图的时间。此外，CAD规划图显示了待建区域的地貌，有利于设计者对场地的环境及其带来的空间感受的宏观把握 [ 6 ] 。本文以其中的一栋楼为例，介绍SketchUp基于CAD底图建立三维模型的技术以及流程。 图1. 技术流程图  将CAD文件导入SketchUp，推拉出的3D模型的效果取决于CAD图的质量。规划设计的CAD图纸包含了大量与建模无关的信息，图形轮廓线可能会存在：带有微小的孤线段、转角处两条线没有相交、两条看似平行的线实际上差了一点点等问题。清理图元和纠正图元的逻辑错误工作量很大，所以作者选择在导入SketchUp后，炸开所有CAD中形成的块，将所有线归到一层、编辑成组，在这样的底图上重新描绘建模需要的图元更节省时间，虚拟小区建成后删除底图，清理后的CAD图如图2所示。 准备纹理数据和高程数据是建模前另一项重要工作。根据规划的立面剖面图，提取出每栋居民楼的层高h和层数a，总高度H = h*a；根据方案效果图准备相应的纹理数据构建纹理库，为了减小模型文件，可以在局部使用效果图纹理，并用JPG格式保存以减少数据量 [ 7 ] ，其他位置使用SketchUp材质库的纹理。  在SketchUp中根据处理后的总平面图，找到需要进行建模的建筑物所在的位置 [ 8 ] ，按照下述步骤建模：1) 拉伸出建筑物第一层的墙体；2) 根据规划的立面图在墙面上相应的位置开窗洞，向墙体内部推拉后用矩形命令画出窗框，推拉出窗框并填充玻璃材质，将建成的窗户模型编组并复制出其他相同的窗户；3) 参考墙体和窗户的建模流程，推拉出门，阳台、台阶等，赋予材质并将该层模型编组；4) 根据上述建模流程推拉出其他结构的楼层模型；5) 按照立面图的指示拼接各种结构的楼层模型，把该栋楼的模型制作成群组。 按照上述建模流程，可以建出整个小区的建筑物。由于小区住宅楼具有相似的特点 [ 9 ] ，构造相同的建筑物可以只建一个。图3是建成的一栋居民楼，使用者能从外面看到建筑物内部，并能进入内部浏览。"
"虚拟小区的休闲娱乐设施，比如广场，室外健身场所等，采用CAD建模的方法显然是很复杂的，作 图2. SketchUp中清理后的底图 图3. 建筑物模型 者采用基于图像的建模方法。本文以小区广场的方案效果图为基础数据制作广场模型，介绍SketchUp基于图像建立三维模型的技术以及流程。  为了让导入的效果图清晰显示，要在PhotoShop中将效果图切割成若干份72像素/英寸的图片，将切割成的图片用作纹理的方式导入到SketchUp中，然后将其拼合起来，拼合后的图片将会比拼合前更清楚。将拼合后的规划效果图只是简单的图片格式，不包括坐标信息，精度较低 [ 10 ] ，因此要将处理后的效果图移动到广场在总平面图的位置，旋转到正确的角度，并按照实际尺寸缩放效果图。 针对一些构造比较复杂的物体，提取出其所在的切割图片，导入SketchUp作为照片匹配，分别调整红色透视轴和绿色透视轴到选定的两个相互垂直的面，确定坐标轴原点。匹配的图片是为了后期建造广场上的复杂模型做准备。  广场上简单的模型可以根据其在效果图上的尺寸推拉、赋材质。比如草坪，花圃，台阶，道路等等。复杂的模型利用匹配好的图片为基础数据建模，以凉亭为例。坐标轴原点可定在凉亭柱子的正面和侧面的转角处，在凉亭侧面绘出一个面并推拉出一定的厚度；根据图片在侧表面上绘制出柱子边线，推拉出柱子的形态；在上表面推拉出亭子的顶部，完成细节；根据亭子的图片纹理赋材质，编辑成组。图4即为制作完成的广场模型。 图4. 广场模型"
"仅仅由大量建筑物组建的起来的虚拟小区并不能满足虚拟规划的要求，这是因为虚拟现实系统要求是实时显示，不仅要考虑场景效果，还要考虑系统的反应速度 [ 11 ] 。为了让虚拟小区达到流畅、美观的要求，并提高场景的运行速度，还需要对建成的小区进一步优化。  大量的景观模型不仅能引导视线、饱满构图、活跃场景气氛，而且能够突出建筑的造型、材质、使用功能等，对于增强虚拟小区的真实性有着不可替代的作用。SketchUp能够充分利用系统本身自带的模型库 [ 12 ] ，极大的简化了建模的工作量。本实验直接从组件库中导入花草、树木、人、垃圾桶等被抽象成点状要素的模型，放到方案效果图设计的位置。为了方便景观模型的管理，在导入模型的时候要分类型区块成组和编辑细化。  SketchUp三维模型数据量大，在一定硬件性能条件下，如果不对模型做“瘦身”，将导致整个三维系统的运行缓慢乃至崩溃 [ 13 ] ，可通过以下四个建模技巧缓解该问题：1) 删除绘图过程中不用的贴图；2) 删掉多余的线和面，看不到的地方“偷懒不建”；3) 减少线和面的数量；4) 组件占用的空间小，但是修改复杂，所以组件的应用要慎重。  为了增强三维场景的真实性和美感、评估虚拟小区的各项日照技术指标是否满足规范要求，可以启用SKetchUp 的“全球地理坐标定位”和强大“光影分析”功能 [ 14 ] 。通过模拟虚拟小区在特定时间的日照阴影效果，观察建筑物日照间距是否满足规范要求，最短采光距离：d = h (单层层高)*层数*1.5。此外，该投影特性使设计者更准确的把握模型高度、控制造型和立面的光影效果。在不需要阴影效果对建筑进行调整时，最好将阴影显示关掉，以便提高运行速度。"
"在小区的虚拟规划中实现潜在购房者与潜在购房者之间、规划设计者与潜在购房者之间交流渠道的透明、畅通，有利于最终做出最合理的规划方案。可以利用Google Earth这个良好的网络平台，建立一个用户管理系统，包括规划设计人员和一般用户 [ 15 ] 。参与者能够进入虚拟小区这个“身临其境”的仿真环境，不仅可以观察设计方案对周边已有建筑物的影响情况，如建筑外立面色与周边是否协调、建筑物高度是否影响周边建筑物的采光等，而且可以从任意距离和角度观察建筑，感受小区绿化情况、每一栋建筑的采光情况。一般用户根据实时漫游的体验结果，相互交流，提出对小区规划的意见，规划设计人员听取意见，再结合自身的专业知识修改规划计方案。根据最终设计方案制作的虚拟小区还可应用于楼盘展示系统，创造商业价值。"
"本文着重介绍了虚拟小区规划过程中的建模的技术及流程、三维场景优化，提出一种调整小区规划方案的新思路。使用SketchUp软件，能够制作出小巧精美的三维建筑模型，组建效果逼真的三维景观，利用Google Earth平台能够高质高效的实现调整规划方案。如果将这种虚拟现实技术的实现方法通过下面两种方式应用到制作虚拟城市：城市新增建筑，根据最终的三维规划方案制作的三维场景，传输到Google Earth平台；城市原有建筑根据当初二维的规划资料，制作三维场景，也传输到Google Earth平台。这样的虚拟城市真实再现并且超越了现实城市，具备虚拟化和数字化的双重特征，对于提高城市规划的水平有着非常重大的意义。"
