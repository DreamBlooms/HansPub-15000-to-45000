"本文介绍了S公司智能财务机器人共享中心建设的具体做法和取得的成效：以业务自动化为导向，实现了业务规范化和流程标准化；以智能财务机器人为基础，建设成国内外首个集注册、调度、监控于一体的机器人管控平台，实现了对多类RPA产品机器人的统一调度、管理与可视化监测，实现了多机器人的协同作业；通过将工作流与财务机器人技术相结合，实现了按流程节点执行自动化任务，实现了针对机器人资源的规划管理，丰富了用户与机器人的交互方式；构建“平台 + 业务场景”的财务机器人共享服务模式，实现了机器人应用的快速推广。推动业务处理模式由人工处理模式转变为由数字化虚拟财务员工自动处理的模式，给财务人员减压降负，提升财务数据准确性、业财数据一致性。 关键词 :智能，财务机器人，共享中心，数字化虚拟财务员工 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"智能财务机器人，又称数字化虚拟劳动力，是一种可以非侵入式连结各业务系统、代替人类员工执行各项具有明确规则工作的智能软件 [ 1 ]。智能财务机器人本质上是自动化技术在财务业务域的应用，如果将其应用于人力资源、IT服务管理等方面，就可以称其为招聘机器人、集成测试机器人等。智能财务机器人具备基于流程的自动化处理能力；具备一定的可调度能力；具备一定的高级分析能力；可以与ERP、BPM等业务应用系统进行集成，甚至可以部署在云上。尤其是近年来，人工智能技术的广泛应用，AI被逐渐引入智能财务机器人领域。通过机器学习、深度学习、图像识别和语音识别等技术，智能财务机器实现了多方式的人机互动，实现非结构化数据以及纸质单据的处理功能，实现高级别的预测分析，同时具备听、说、动手和思考的能力，成为真正的“智能财务机器人”。  S公司已经成功上线智能财务机器人应用多达30多个，从应用的情况看，智能财务机器人的应用可带来工作效率的提升、工作负荷的下降等显著成效，但是现有的智能财务机器人也存在明显的不足，主要表现在如下几个方面： 1) 调度方面：不同RPA厂商的机器人适用的业务系统并不一致，一个业务场景通常涉及多个系统，导致用户需要切换不同的机器人产品，基层用户体验效果欠佳。 2) 运营方面：分布式部署时，机器人无法协同作业，一个自动化任务只能被一个机器人执行，业务量较大时，业务处理时间较长；机器人通常基于电子表格处理数据，存在一定的信息安全风险。同时，无法形成有效的机器人资源规划，无法按一定频率或约定时间启用机器人 [ 2 ]。 3) 监控方面：机器人运行具有排他性特点，在执行过程中用户无法实时了解业务处理的进度，无法对机器人行为形成有效监测。 4) 应用推广方面：机器人运行依赖电脑环境。但是各单位电脑配置并不相同，给机器人的推广带来较大的二次开发工作。同时，分布式部署的方式也存在机器人维护难的问题。  为解决上述问题，S公司结合机器人应用情况，研究建设智能财务机器人共享中心 [ 3 ]。通过接口的形式，将S公司应用的所有机器人产品集成至智能财务机器人共享中心(以下简称共享中心)，实现在智能财务机器人共享中心可对所有机器人进行统一调度与管理，并利用工作流引擎自动实现按流程节点对不同机器人的调用，避免人工切换机器人的情况；采用集中部署的方式，将机器人统一部署在省公司本部，并统一机器人的执行环境，避免因执行环境分辨率不同带来的应用推广时的开发二次调整；同时基于本项目的实时调度技术的研究成果，共享中心可以调用多个机器人协同作业(多机器人同时处理一个工作任务)；将现有从电子表格获取业务数据处理方式改为由机器人从共享中心数据库获取数据的模式，同时对用户业务系统的账户密码进行加密处理，提升机器人运行的数字信息安全水平。通过建立自动化任务和机器人仪表盘对机器人行为和状态形成全方位的监测，用户可以基于仪表盘实时；掌握自动化的任务的完成情况。利用统一权限平台提供了工作流引擎，实现了按流程节点执行自动化任务，实现了按约定时间和按一定频率调用机器人服务，实现了针对机器人资源的规划管理。"
"智能财务机器人共享中心的理念是以集中部署的方式，将智能财务机器人进行聚集，并进行统一管理与调度规划，通过开放对外服务接口的方式供S公司各部门各业务域的人员使用，实现机器人资源应用的最大化。S公司智能财务机器人共享中心的实施主要经历业务流程优化和财务业务共享中心服务平台建设与应用两个阶段。  智能财务机器人共享中心是由一个个智能财务机器人组成的虚拟部门。上文提到由智能财务机器人处理的业务必须要有明确的业务规则，因此智能财务机器人共享中心天然地对其所处理的业务规范性存在一定的要求。在建设智能财务机器人共享中心平台以前，S公司对现有的财务流程进行梳理与分析，并基于自动化流程的特点，对现有流程进行了优化。 一是筛选自动化流程。S公司财务业务流程众多，但是并不是所有的业务流程都可以交由建设智能财务机器人共享中心来处理，如纸质会计凭证的实际归档。在智能财务机器人共享中心的业务流程选择方面，S公司结合智能财务机器人的技术特征和业务自身的特点，制定了“三大点、八小点”自动化流程选择标准。基于“三大点、八小点”实现了各业务场景的快速甄别，梳理出适合进行自动化处理的业务流程。部分业务场景的评分见表1。 “三大点、八小点”分别是：技术支持度(数字化程度、系统稳定性、明确处理规则)；业务价值(手工处理工作量、流程稳定性、业务覆盖范围)；合规与风险(合规要求、质量要求)。 二是统一和规范业务流程。从智能财务机器人的功能上分析，其处理的业务需要有明确的业务规则，需要明确告知该流程的各处理步骤。从智能财务机器人共享中心的应用范围上分析，只有统一了业务流程、规范了业务流程，智能财务机器人共享中心的虚拟劳动力才能被最大程度地应用，相应的自动化流程才能在各分公司快速推广应用。为此，S公司以业务自动化为导向，对现有流程进行梳理，分析业务流程自动化的可行性；通过集中讨论、电话会议或访谈的形式，对各单位的管理差异进行分析。在满足各单位管理的情况下，基于流程再造重新设计了S公司业务流程标准和规范，在整个集团公司层面统一了业务处理的流程、规范了业务附件的要求、统一了表单规格。 Table 1 评分项目 权重 供应商/客户主数据创建流程 光伏结算流程 往来清帐 适用流程筛选 100.00% 4.12 4.01 4.21 一、技术支持度 30% 5.00 4.00 5.00 数字化程度 40% 5.00 3.00 5.00 系统稳定性 20% 5.00 4.00 5.00 明确的处理规则 40% 5.00 5.00 5.00 二、业务价值 40% 2.80 4.40 3.40 手工处理工作量 40% 4.00 5.00 3.00 流程稳定性 20% 4.00 4.00 3.00 业务覆盖范围 40% 1.00 4.00 4.00 三、合规与风险 30% 5.00 3.50 4.50 合规要求 50% 5.00 4.00 5.00 质量要求 50% 5.00 3.00 4.00 表1. 适用流程筛选 三是打通线下线上数据通道。智能财务机器人无法直接处理纸质单据，因此交由智能财务机器人共享中心的业务流程如果涉及纸质单据，需要针对原始凭据进行电子化处理。S公司将纸质单据进行了影像化处理，可以在线审核影像资料情况，如果该流程涉及重要的业务信息如发票信息，可利用OCR技术将纸质单据中的信息先做识别处理，将非结构化数据转化为结构化数据，然后再递交智能财务机器人共享中心处理。OCR技术的应用帮助智能财务机器人打破了线上线下数据壁垒，获得处理纸质单据的能力。  智能财务机器人共享平台的实质是用户通过共享平台发起业务自动化请求，共享平台通过调度智能财务机器人替代人工完成各项工作。共享平台的架构设计和功能设计如下：  共享平台的架构设计理念体现以下三个方面： 业务流程定义：根据现代工业流程化的管理思想将各业务场景下的操作分解设计成一个个可由机器人替代处理的业务流程，同时利用统一权限平台提供的流程定义功能，在统一权限平台中将设计好的业务流程完成业务流程的定义，形成一个个系统中的流程。 机器人自动化流程：系统中的每一个流程都至少包含了“流程启动”、“机器人处理节点”、“处理结果反馈”三个节点，有点流程中甚至包含了3个以上机器人处理节点。在每个机器人节点中，智能财务机器人共享平台都会分配一个机器人，确保每一个机器人节点的任务都至少有一个机器人可供执行。这样也就按业务流程形成了机器人生产流水线，在系统中实现了基于机器人的自动化流程。 人机交互理念与设计：用户通过机器人自动化流程发起调用机器人请求，共享平台接收机器人请求后，利用工作流引擎判断当前流程节点是否为机器人节点，如果是机器人节点，则根据机器人自动化流程中的配置信息，调度机器人执行任务，机器人任务完成以后流程自动流转至下一节点；如果当前流程节点是人工节点，则共享平台直接将流程信息发送个对应人员。  在智能财务机器人共享平台的功能设计方面，S公司希望能够实现：在应用层，财务用户可以通过自动化流程应用管理功能定制不同启动方式的自动化任务；在配置层，平台通过自动化流程配置功能形成机器人资源池以供调度，并利用工作流引擎将机器人任务流程化、节点化，降低系统变更风险；在展示层，用户可以通过自动化流程监测分析功能实时监测机器人状态和任务执行情况 [ 4 ]。 因此，围绕智能财务机器人共享平台的建设，S公司在应用层面做了三个层面的分析与设计： 自动化流程监测分析：也是机器人的监测与展示层。通过工作流仪表盘监测每个自动化流程的执行情况(任务的完成情况、完成时长等)；通过机器人仪表盘监测每个机器人的运营情况(机器人的工作状态、应用频率等)；通过运行监测功能模块详细监测一个自动化任务的数据处理情况和流程流转情况；通过日志功能模块详细记录自动化任务的日志和机器人以便后续诊断分析。 自动化流程应用管理：也是机器人的应用层。该部分主要包括将统一权限平台中定义的业务流程注册至共享平台；对机器人资源形成规划管理，支撑用户按约定的启动方式(周期启动、定时启动)调用机器人；根据机器人排程创建一个个机器人任务(实例)，调度机器人处理工作。 自动化流程配置：也是机器人基础信息配置层。该部分包括将机器人信息注册至共享平台，形成机器人资源池；将机器人代码部署在平台，并分配给机器人，形成可供机器人运行的脚本；业务系统标识与地址维护；用户账户与密码的加密存储等(机器人登录业务系统所需)。 智能财务机器人共享平台的建立实现了“三个统一”：实现不同任务类型智能机器人的统一调度、实现了所有智能机器人任务包的统一管理、实现了全部智能机器人及其作业信息界面的统一展示。  1) 工作流仪表盘 以仪表盘的形式展示工作流的应用情况。工作流仪表盘包括年度实例分布情况仪表盘图表、今日实例预警仪表盘图表、年度累计实例执行情况仪表盘图表、机器人节点在运时长仪表盘图表、工作流应用仪表盘图表、实例执行情况仪表盘图表。将从实例所属单位、实例完成状态、实例完成的时间、实例所属流程、实例作业时长等维度全方位监测业务数据处理的完成情况。 2) 机器人仪表盘 机器人仪表盘主要是以仪表盘的方式展示机器人的执行情况。机器人仪表盘包括机器人负载率仪表盘图表、机器人状态仪表盘图表、机器人实时监测仪表盘图表、机器人年度作业执行情况仪表盘图表、机器人利用率排名仪表盘图表。将从负载均衡、健康状态、工作状态、作业完成情况以及利用率等维度，全方位对机器人的运营进行监测。 3) 自动化流程应用管理 本部分内容主要分为工作流注册、工作流排程管理、工作流实例管理等三个部分。具体功能如下： 工作流注册是为了将统一权限平台中定义的流程注册到业务流程自动化平台。工作流注册以后，机器人可以根据流程定义的情况，逐一按照节点任务执行业务处理。注册工作流时，需要检查检查统一权限平台是否已经存在该编码的流程，必须是已经存在才可以注册；检查业务流程自动化平台中是否已经存在该流程编码，如果不存在，可以注册；如果存在需要判断流程编码是否存在启用状态的流程，如果不存在，可以注册，如果存在，则不允许注册，相同流程编码的流程只能有一个处于启用状态。工作流注册涉及的主要功能如下： 工作流排程主要用于对机器人的资源规划。用户可以通过创建排程的形式，约定流程启动时间。排程启动以后会新增实例，机器人根据实例执行业务。排程新增时必须按照数据模板上传待处理的业务数据，可以选择优先级和定制启动方式。 工作流实例管理主要是对已经产生的实例进行管理。比如修改实例的优先级、查询实例流程流转情况、查询实例的业务数据处理情况等。新、增排程以后会产生相应的实例。一个排程可能对应多个实例，比如定时启动的排程。 4) 自动化流程配置 机器人配置：将电脑信息与机器人绑定。配置机器人时需要明确：机器人厂商、唯一主键、机器人名称、本地主机名、机器域/用户、机器密码、机器人客户、登录账户、机器人类型等信息。 业务系统维护：机器人执行过程中可能涉及多个业务系统的用户账户密码，平台将业务系统和账户密码设计成可配置型，以便机器人在登录系统时可以根据不同的业务系统读取相应账户密码。 用户参数维护：用来维护用户的业务系统账户密码。业务系统标识在业务系统维护功能模块中已经维护。在用户参数维护功能模块下，用户根据系统录入账户密码，机器人在执行该账户创建的排程时，将调用该用户对应的业务系统账户密码登录业务系统。 机器人版本管理：主要是针对机器人开发程序包进行管理。系统管理员可以将机器人开发程序包上传到业务流程自动化平台，上传机器人开发程序包时需要选择机器人执行的方式。在机器人版本管理中系统管理员可以对已经上传的机器人开发程序包进行删除。 机器人代码部署：将机器人开发程序包分配给机器人，具有机器人开发程序包的机器人才具备执行相关业务的能力。  1) 智能财务机器人集成 机器人的工作原理不同于常见的接口、数据导入导出等方式。它是通过识别屏幕像素或者元素控件来模仿人类对鼠标、键盘的操作行为，进而对各种软件和系统进行处理。这种工作方式的最大好处在于无需对现有的信息系统做出任何改造即可进行机器人的部署、最大程度上减少了对于其它系统的影响，而且为无法进行系统集成的业务场景(如纳税申报业务税局官方未开放接口)提供了解决方案。 S公司现应用的机器人产品有UiPath和Automation Anywhere，从现有产品的结构上看，上述产品均提供了对外曝露的API接口，共享平台可以通过接口实现对上述两款产品的管理。 2) 智能财务机器人调度算法 DM是Deadline Monotonic Scheduling的缩写，是在RM算法之后发展起来的一种固定优先级调度算法。在DM调度算法中，任务优先级由任务时限来决定，时限宽度越小。优先级别越高，时限宽度越长，优先级别越低。采用任务时限作为任务优先级别是基于这种思想：时限宽度越小的任务，越需要紧急处理，否则使得任务越过其时限而得不到调度。从而影响系统的实时性。 DM调度算法是非周期实时系统的主要调度算法。本项目的调度算法基于DM算法，但是也对算法中的参数做了修正，同时引入了时间变量，并考虑任务创建的时间因素。在本项目的调度算法中，假定所有的任务的时限相同，由任务的优先级决定任务被执行的顺序，同时相同优先级的顺序，先执行创建时间最早的任务。 3) 智能财务机器人作业排程技术 Quartz是开源组织Open Symphony在作业调度领域的一个开源项目，它是一个轻量级的企业级作业调度框架，完全由Java编写。Quartz它可以单独使用，也可以与J2EE应用相结合，在提供了强大任务调度机制的同时，保持了使用的简单性，可以说是开源任务调度框架中的翅首。Quartz可以创建简单的或复杂的调度，以执行几个、几十个甚至成百上千个作业，这些作业被包装成标准的Java组件，开发者可以任意地对其进行编程和执行。 Quartz的强大的特性就是支持复杂的时间调度。Quartz允许开发人员灵活地定义触发器的调度时间表，任意指定周期性的任务，并可以对触发器和任务进行关联映射，甚至还支持将任务存储到数据库中，即使重启服务器也可以继续上次没有执行的任务。当调度极其复杂，可以将其拆分成数个时间表达，分别包装在触发器中，然后添加到调度器中统一调度。  通过前期调研，S公司共发现35类流程可进行自动化处理，35类流程涉及多个业务部门、多个业务系统，财务机器人的场景应用无法一蹴而就。S公司按照“整体规划、分布实施”的策略，优先将覆盖面广的、处理耗时长的、周期性发生频率高的业务迁移至智能财务机器人共享平台，保证先消灭困扰最大的业务痛点，再逐步消除困扰基层财务人员的所有业务痛点 [ 5 ]。 S公司依托智能财务机器人共享平台，将每个财务业务应用通过自动化应用管理功能模块部署在平台中，用户不与智能机器人接触，仅通过自动化流程管理模块创建机器人任务，平台根据任务请求安排不同机器人完成各项作业，用户可以在共享平台实时查询任务完成情况和流程流转情况。 “平台 + 业务场景”的财务共享式服务的优势在于：1) 数字化劳动力的共享。机器人不属于某一个员工而是属于全体公司成员，可以被全公司所有人员使用，打破了传统的单位、职能限制。2) 流程应用共享。传统的单一的机器人应用无法直接复制至其他公司应用，必须经过二次功能的适应性调整才能应用。智能财务机器人共享平台统一了机器人的运行环境，部署在共享平台的自动化流程无法二次调整即可供各单位使用。3) 业务能力的可持续拓展。业务能力的可持续拓展一方面体现在机器人功能、自动化流程可以根据业务需要不断丰富拓展，另一方面体现在机器人这一虚拟劳动力的数量可以按需持续的增加，并且虚拟劳动力无需业务培训即可上岗处理业务。"
"现有的机器人运行时，用户无法实时了解自动化任务的处理情况。共享中心利用BI商务智能技术建立了两套仪表盘对业务处理情况和机器人状态进行可视化展示，以便用户可以实时地监测机器人的运营情况。用户可以从时间、任务的完成状态、任务的处理时长等维度有效监测机器人作业进度；从机器人的负载情况、健康状态、作业情况有效监测机器人的状态。机器人可视化仪表盘见图1。 图1. 机器人可视化仪表盘  共享中心利用工作流引擎定义各类自动化流程，维护工作流各流程节点与机器人代码的关系；完成机器人代码在共享中心的部署，并将其分配给指定的机器人。这样就形成了“流程节点–机器人代码–机器人”三者之间的联系。用户启动一个自动化服务时，共享中心基于“流程节点–机器人代码–机器人”三者之间的关系，主动调用机器人作业。在一个场景需要应用多个厂商的机器人的产品时，免除了手工启动机器人带来的不便。同时基于工作流的机器人任务管理模式，可以有效降低系统变更带来的机器人运行异常风险；通过引入人工审核节点，更进一步降低应用机器人可能产生的业务风险，有利于机器人与人工的交互。具体示例见图2。 图2. 机器人流程流转示例  共享中心通过引入了时间变量，完成对DM算法的优化，并基于“流程节点–机器人代码–机器人”三者之间的关系，实现了机器人的实时调度与协同作业。协同作业的优势在于可以同时调度多个机器人执行自动化任务，极大地压缩业务处理的时间。 将智能财务机器人作业排程技术与工作流技术相结合，共享中心实现了“立即启动”、“定时启动(一定频率启动)”、“计划启动(约定时间启动)”等多种方式启动机器人服务，提升了机器人资源规划水平。排程新增界面见图3。 图3. 新增自动化任务   S公司是资产密集型企业，财务工作涉及往来、工程、资产等各个方面，财务人员工作负荷较重，智能财务机器人共享平台利用数字化虚拟劳动力帮助财务人员完成各项工作，有效帮助财务人员减压降负。 目前S公司已经完成了分布式光伏结算、分布式光伏补助资金支付申请、供应商主数据新增、固定资产报废工作流–财务段处理等十大类流程的自动化。在上述自动化流程中，智能财务机器人成功完成了单据填制、数据核对以及报表生成等基础性财务核算工作，财务人员仅负责审核工作，极大减少了财务人员的工作负荷。  S公司的部分财务基础工作存在业务量大、业财信息核对复杂的问题，如分布式光伏结算业务每月有约1.5万笔项目需要结算，而且结算时需要核对项目的十多个信息，业务处理耗时长人工处理出错率较高。智能财务机器人共享中心建立以后，由机器人处理该类业务，业务处理的效率提升了3.5倍，同时该场景的机器人出错率为0。 从S公司智能财务机器人共享中心平台投运以来的实际情况分析，相同工作内容，智能财务机器人共享中心的工作效率是人工的3~8倍。尤其是大批量数据的核对，智能财务机器人的准确率远高于人工。  S公司在信息化建设阶段采用了信息系统分头建设的方式，信息系统分头建设造成了信息系统林立，各业务数据被存放在各自系统的数据库中，无法实现数据共享；同时由于系统集成成本、性能风险等缘故，各业务系统集成程度并不高，也造成了数据不同源、不同一等问题。S公司根据智能财务机器人特征，在不新增业务系统接口的情况下，实现业务系统的集成，驱动“业财数据共享”和“财务数据同源同一” [ 6 ]。"
