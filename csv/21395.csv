"本文首先介绍了数字图像重建中最典型的计算机断层成像技术(X-ray Computerized Tomography)的成像原理，并考虑将重建问题转化成线性方程组Ax = b的求解，重点讨论了系数矩阵A的生成。以三维实际重建问题为例，本文给出了计算直线与三维固定网格的交线长度与索引公式。最后利用MATLAB实现这一计算过程，并分析算法运行的效率。 关键词 :数字图像重建，X-Ray CT，三维固定网格，索引 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"数字图像重建是指根据物体边界测量数据，获取物体内部结构的一种方法 [ 1 ] 。常见的成像技术有全息成像，电子显微，数码相机，核磁共振，超声波，计算机断层层析成像技术等等。图像重建最典型的应用是医学上的计算机断层层析成像技术 [ 2 ] ，这是一种电子计算机技术与X射线检查技术相结合的产物，因其扫描时间快，图像清晰等特点，在成像领域有着非常重要的作用。 X射线在物体内部沿直线 传播，衰减满足Beer定理 [ 3 ] 其中 为物体对X射线的衰减系数， 为入射光强度， 为出射光强度。X-Ray CT利用这一原理，获取多组入射光强 和出射光强度 ，得到一系列的投影数据 ，并根据投影数据值重建物体内部的吸收系数 . 常见的X-Ray CT重建算法有迭代算法 [ 4 ] ，分析算法(滤波反投影 [ 5 ] ，反投影滤波 [ 6 ] )等。随着计算机技术的高速发展，迭代重建算法因其利用计算机运算速度快，适合做重复性操作的特点被人们更广泛地应用在图像重建中。迭代算法首先涉及到问题的离散化，以三维图像为例，当待测物体所在的区域被离散成三维固定网格后(共 个像素)，如图1所示，假设物体在离散后每个格点上的吸收系数是一个常数 ，沿着第 条射线上的投影值 ，可表示成 ，其中 为第 条射线与第 个像素的交线长度，这样就将重建问题转化成 的求解 [ 7 ] [ 8 ] 。我们的任务是确定矩阵 的第 个行向量中的非零元以及非零元所在列的索引。 作者吴大瑞，何钦铭在 [ 9 ] 中给出了计算直线与二维固定网格交线长度的算法，我们将这一算法进行推广，给出了计算直线与三维固定网格的交线长度的算法。此外，我们也给出了直线与三维固定网格的交线索引的公式。最后我们通过MATLAB实现这一算法 [ 10 ] [ 11 ] ，并用两组数值实验分别验证了算法的正确性和有效性。"
"为后续描述方便，我们首先定义物体的参数(见表1)。 1) 假设待测物体处于一个长、宽、高分别为 ， ， 的矩形区域内。以矩形的中心为原点建立空间直角坐标系，对矩形区域进行离散化后得每个格点的长、宽、高分别为 ， ， 。 图1. 待测物体离散化 Table 1 变量 意义 待测物体的长 待测物体的宽 待测物体的高 待测物体 方向上的分辨率，文中为偶数 待测物体 方向上的分辨率，文中为偶数 待测物体 方向上的分辨率，文中为偶数 表1. 待测物体参数 2) 我们将网格中格点依 轴依次从下往上逐层标号，以最底层格点为例对网格进行标号，从数字1开始，按图2的方法，直到标完对应的格点数 ; 按同样的方法在矩形区域内向上一层对格点进行标号，依次向上标，直到标完对应的格点数 ，以此完成对矩形区域的离散化。  假设第 根射线是由第 个光源 及探测器 所确定，则该直线所在的空间直线参数方程可表示为( 为参数) 图2. xoy平面网格标号 其中( )为直线的方向向量，可以根据确定的光源和探测器位置的坐标确定 ， ， 。为后续描述方便，需保证 按序大于0，若出现以下情况之一：(1) ，(2) ， ，(3) ， ， ，则令 即可。  1) 为确定直线与网格的交线长度，我们首先给出直线与网格的交点。设光源探测器直线与 平面的交点分别为 ( )。根据条件 删除越界的点，得到直线与 轴网格线相交 组的坐标，仍然记为 。同理，可获得直线与 轴网格线相交的 组有效坐标值，为 ，与 轴网格线相交的 组有效坐标值，为 。 将三组数据按照 坐标从小到大进行重排，若 ，则按 从小到大重排，若 且 ，则按 从小到大重排。得到一系列不重复交点，记为 。则该直线与网格的交线长度可表示为 (1) 2) 为计算直线与网格交线的索引，可以根据交线起点 找到该格点中 坐标最小的顶点，并由此顶点推断索引值 。具体的实现中，首先令 · 若 ，且 ，则修正 ; · 若 ，且 ，则修正 . 图3为几种特殊的相交情况，以此说明上述修正。 最后令 图3. 几种特殊的直线与网格相交情况。实心圆：起点 ；菱形：终点 ；空心圆：修正前的点 ；星形：修正后的点 。(a) ；(b) 且 ；(c) 且 ；(d) 且 ， 且 根据修正后的 ，可得交线所在格点的索引公式为 (2)"
"为验证算法的有效性和正确性，我们进行如下两组数值实验。算法在一台Dell电脑上完成，操作系统为Windows 7旗舰版(64位)，处理器：Intel(R) Core(TM) i7-4790，CPU@3.60 GHz，RAM:8 GB。采用Matlab R_2013a版本。  设 ， ， ， ， ， 。分别取如下4组光源和探测器。经程序计算得到结果如表2所示。此外，我们对不同光源和探测器情况作了手动计算，经过比较，我们确定两者一致，算法的正确性得到验证。 Table 2 编号 光源与探测器 与 (1) (2) (3) (4) 表2. 程序正确性检测结果  我们模拟现实的光源和探测器分布情况，假设待测物体参数设置为 光源和探测平面同时绕待测物体螺旋上升。具体参数见表3。 初始状态下光源位置设为 。与之对应的探测器平面如图4所示。 光源和探测器平面同时绕 轴旋转，第 个光源转过角度为 光源位置为 与之相对应的探测器上各点坐标为 由于系数矩阵是一个大型稀疏矩阵，在实际的迭代过程中，如果将 存入内存，是一个耗空间的做法；如果每次迭代都从外设读取数据，也是一个耗时的做法。因此我们考虑在每步迭代中，都计算一次系数矩阵。模拟实际情况，我们假设共采集 次数据，形成 组交线长度和索引标号。 图4. 平面探测器编号 Table 3 变量 意义 数据 光源到待测物体中心轴的距离 60 cm 探测平面中心到待测物体中心轴的距离 40 cm 平板探测器长度 40 cm 平板探测器高度 40 cm 平板探测器水平方向分辨率(偶数) 50 平板探测器竖直方向分辨率(偶数) 50 采集数据的旋转角(弧度) 螺距 10 cm 表3. 光源、探测器参数 采用上述程序，在MATLAB下运行，实际代码执行的时间为597.7133秒。由此，我们也可以大体估计每次迭代所用时间。根据数值实验的结果，我们发现运行效率可以接受。"
"本文以X-ray CT为例，研究重建问题中系数矩阵的生成方式，将系数矩阵元素和直线与三维固定网格相交联系起来，研究了直线与三维固定网格的交线长度与索引。最后用MATLAB程序语言实现了这一算法，并将算法应用到三维重建的系数矩阵生成上，完成一次矩阵的计算时间在10分钟以内。运算效率是可行的。"
