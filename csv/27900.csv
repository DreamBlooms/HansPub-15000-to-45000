"为了更加精确的进行径流预测，该研究针对BP神经网络训练速度慢和容易陷入局部极小值的缺点，建立了ELM神经网络模型。以兰西水文站1959~2014年径流数据为例，采用ELM神经网络对径流深进行预测，相对误差、均方误差和确定性系数作为模型合理性的验证指标，并与BP神经网络预测结果进行对比及分析。ELM模型的预测结果，其相对误差、均方误差、确定性系数均优于BP神经网络模型，这表明ELM神经网络模型对BP神经网络模型已存在缺点进行了有效规避且预测精度有了进一步的提升。因此，该研究提供的ELM模型在一定程度上能够更好的改善预测效果，证明了ELM模型在径流预报中的应用价值。 关键词 :神经网络，ELM模型，BP模型，径流预测 Copyright © 2018 by authors and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"中长期径流预报是水利水电工程设计、施工和运行管理的重要依据，在防汛、抗旱、供水、发电、养殖、旅游、航运及改善生态环境等方面能发挥显著作用 [ 1 ] 。目前，应用较为普遍的径流预测方法为人工智能算法，其中包括BP神经网络算法和极端学习机算法。BP神经网络基于前馈神经网路的架构下，通过梯度下降法，以逆向传播的方式进行学习，过程中需不断迭代更新权重和阈值，使得运算出现易陷入局部极值且训练速度慢等问题 [ 2 ] [ 3 ] [ 4 ] 。极端学习机 [ 5 ] (extreme learning machine, ELM)执行过程中不需要调整网络的输入权值以及隐含层偏差，只需设置隐含层节点数就能产生唯一最优解，因而学习速度快且泛化性能好 [ 6 ] ，恰好弥补了BP神经网络训练时间长和局部极值的缺点。ELM在回归、拟合、分类等多个领域得到国内外广泛的应用，同时不少学者对ELM提出了改进方案，使其性能得到进一步提升。例如，黄永辉等 [ 7 ] 利用ELM进行爆堆形态预测，该预测提高了爆炸对形态的准确度，而且通过实例预测表明ELM预测精度高于同期使用的BP神经网络预测结果；姜媛媛等 [ 8 ] 利用ELM对锂电池剩余寿命进行预测，并与高斯过程回归预测方法作比较，结果表明ELM算法具备较好的电池RUL预测精度；陈恒志 [ 9 ] 等利用ELM对连铸坯质量进行预测，并与BP和遗传算法优化的BP神经网络预测结果进行分析对比，结果显示该模型可对连铸坯质量进行迅速准确的分析；石炜 [ 10 ] 等利用ELM对高炉喷煤量进行预测，并与BP神经网络预测结果进行比较，结果显示ELM模型能够更快、更准确预报处高炉炼钢时所需喷煤量，能够更好的指导实际生产。但ELM在径流预测方面应用较少。因此，本文利用兰西站1959~2014年水文气象数据，以降水量、平均温度、相对湿度、蒸散发及平均温度为影响因子，构建ELM预测模型和BP神经网络模型作对比，对兰西站年径流变化规律进行了实例研究，以此探讨ELM模型在径流预测上的适用性。"
"ELM是黄广斌教授提出的一种单隐含层前馈神经网络 [ 11 ] 。ELM的出现有效的解决了前馈神经网络学习速度慢的难题。该算法只需在训练之前随机生成输入层与隐含层之间的连接权值和隐含层神经元阈值，且训练过程中无需改动 [ 12 ] [ 13 ] 。 设m、M、n分别为网络输入层、隐含层和输出层的节点数，g(x)是隐含层激活函数。对于N个不同的样本 ( x i , t i ) ,   i = 1 , 2 , ⋯ , N ，其中 x i = [ x i 1 , x i 2 , ⋯ , x i n ] T ∈ R m ， t i = [ t i 1 , t i 2 , ⋯ , t i n ] T ∈ R m ，则ELM模型可表示为： ∑ j = 1 M β i g ( w i ⋅ x i + b i ) = o j       ( j = 1 , 2 , ⋯ , N ) (1) 式中：w i 是输入层和隐含层的连接权值向量；β i 是隐含层和输出层的连接权值向量；b i 是隐含层神经元阈值；o j 为网络输出； 将N个不同的样本代入到式(1)，得： T = H β (2) 式中：H是隐含层输出矩阵；β是输出权值矩阵，T是样本集目标矩阵。 由于单隐含层前馈神经网络的输入层与隐含层连接权值和隐含层神经元阈值是随机产生的且不需要调整，所以当w j 、b i 确定后，训练过程即式(2)最小二乘法求解过程。最小二乘解即： β ^ = H T T 。 H T 为输出权值矩阵的伪逆。  BP神经网络采用误差反向传播的思想，它实质上包含两个阶段，正向传播和反向传播，正向传播输出层得不到期望输出时，则进行反向传播进而对网络的各层连接权进行修正 [ 14 ] [ 15 ] 。建模过程如下：① 初始化网络权值和阈值；② 构建网络；③ 计算输出层误差；④ 反向修正权值；⑤ 重复③、④直到达到终止循环要求；⑥ 基于上述网络利用仿真函数进行数据预测 [ 16 ] 。再将预测数据反归一化就得到了最终的网络预测输出。"
"兰西水文站位于黑龙江省绥化市呼兰河下游，居东经126˚22'12''至126˚28'6''，北纬46˚12'57''至46˚18'2''，西北高、东南低，海拔高程在116.6~209.8米，控制流域面积2770 km 2 。呼兰河为松花江流域支流，属北温带季风气候区，全长523 km。该地区多年平均降水量一般在500 mm左右，多年平均气温为20℃~22℃。  本文选用兰西水文站径流深及该水文站的四个气象站(海伦、明水、绥化、铁力)的降水量、平均气温、平均相对湿度、蒸散发和平均风速等气象数据进行研究。气象数据来自中国气象数据网(http://data.cma.cn/)，利用泰森多边形法求得离散分布的四个气象站对兰西水文站的影响程度，从而推算出兰西水文站的气象数据。ELM模型选取的输入层参数有：① 降水量；② 平均气温；③ 平均相对湿度；④ 蒸散发；⑤ 平均风速。径流深为输出层。  本文选取兰西县水文站1959~2008年的水文气象数据为训练样本，2009~2014年的数据为测试样本。见表1。ELM模型中的激活函数选择sig函数。 Table 1 年份 降水量(mm) 平均气温(℃) 平均相对湿度(%) 蒸散发(mm) 平均风速(m/s) 径流深(mm) 2009 575.96 20.91 66.94 61.08 20.68 150.89 2010 465.18 20.42 70.51 58.83 21.06 113.07 2011 430.24 25.93 68.43 59.46 20.13 73.73 2012 585.19 23.40 68.06 57.30 21.26 138.05 2013 661.87 22.74 73.45 54.81 22.48 265.32 2014 634.81 31.00 67.68 58.76 21.51 188.96 表1. 模型的输入、输出参数  本文选用相对误差(RE)、均方误差(E)、决定系数(R 2 )作为评判模型预测结果更优的标准。两模型预测结果对比如下表2所示。 Table 2 年份 实测值 ELM神经网络模型 BP神经网络模型 预测结果 RE% 预测结果 RE% 2009 150.89 148.38 1.66 143.91 4.63 2010 113.07 119.67 5.84 108.32 4.20 2011 73.73 66.54 9.75 72.07 2.26 2012 138.05 148.03 7.23 157.23 13.89 2013 265.32 288.56 8.76 313.57 18.19 2014 188.96 199.70 5.68 222.30 17.64 E 142.73 646.92 R 2 0.99 0.98 表2. ELM模型与BP神经网络模型预测结果对比  将实测值、ELM模型预测结果及BP神经网络预测结果以折线图的形式表现出来，更直观的表达了预测效果的优劣。见下图1。 从图1可以看出，ELM模型与BP神经网络模型在2009年与2011年模拟效果均较好；2011年之后的2012、2013、2014年两模型预测结果在线性趋势上均与实测值相近，但从图中可直观看出ELM预测结果与实测值更接近。从数据分析来看，本文采用相对误差、均方误差、确定性系数对预测结果进行评价，相对误差在20%以内即为合格，均方误差越小、确定性系数越接近1误差越小。从表2可以看出两模型的相对误差均在20%以内，其中ELM模型的相对误差都在10%以内，由此说明ELM模型的预测结果较为稳定。ELM模型与BP神经网络模型的决定系数分别为0.99、0.98，均方误差分别为142.73、646.92，说明ELM预测模型模拟径流数据具有更好的精确度。 图1. 结果对照图"
"本文为改善神经网络训练时间长和易陷入局部极小值的问题，建立了基于ELM神经网络的径流预测模型。采用兰西站水文气象数据进行测试，以决定系数、相对误差和均方误差对结果进行检验，结果表明ELM算法具有良好的径流预测能力，符合训练速度快、结果精确度高等优点。与BP神经网络预测结果相比较，表明本文运用的ELM预测方法具有更好的实用性。同时研究过程中也存在些许不足，本文ELM模型激活函数为sig函数，并未对其他激活函数进行测试；在训练过程中，发现ELM虽然训练速度快，但具有稳定性不高的特性；测试地区仅为兰西站，具有一定的地域特征，因此，ELM在径流预测上的适用性还需进一步探索。"
