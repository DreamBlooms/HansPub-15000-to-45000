"本文研究了变分不等式KKT系统的求解问题，利用一个新的NCP函数将变分不等式的KKT条件转化为等价的光滑方程组。并在此建立了求解NCP函数非线性互补问题的一个光滑化牛顿法 [ 1 ] ，获得算法的收敛性和局部收敛性结果，并给出数值实验结果验证理论分析的准确性。 关键词 :变分不等式问题，NCP函数，非线性互补问题，光滑牛顿法，数值实验 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"求解变分不等式问题一直是学者们研究的热点课题之一，在文献 [ 2 ] 中作者已经成功的应用最经典的互补函数 ϕ p ( a , b ) = ( | a | p + | b | p ) 1 / p − ( a + b ) 来求解了带约束的变分不等式。文献 [ 3 ] 中，又给我们介绍了四类新的NCP函数，并给出了应用这几类NCP函数来求解带约束的变分不等式问题的方法。本文将采用其中的一类NCP函数 ϕ 1 ( a , b ) = ϕ p ( a , b ) − α a + b + 来求解该问题。 定义1：函数 ϕ : R 2 → R 称为Fischer-Burmeister (FB)函数，如果满足下面的条件： ϕ F B ( a , b ) = a + b − a 2 + b 2 (1) 其中 a , b ∈ R ，此函数在(0,0)点是不光滑的，作为一个互补函数，广泛的应用于处理非线性互补问题和锥约束变分不等式问题 [ 4 ] - [ 10 ] ，如下函数被称为广义FB函数： ϕ p ( a , b ) = a + b − | a | p + | b | p (2) 其中 a , b ∈ R ， p ∈ ( 1 , + ∞ ) ，当 p = 2 时，就是特殊的FB函数 [ 11 ] 。很多学者已经研究了基于广义FB函数的非线性互补问题的几个NCP函数，并应用到于互补问题 [ 12 ] [ 13 ] 。众所周知函数(1)和(2)在(0,0)点是不可微的。这给我们在数值实验中带来了不便。如下函数是由FB函数变形得到的，本文采用该函数求解变分不等式问题： ϕ 1 ( a , b ) = ϕ p ( a , b ) − α a + b + (3) 现在我们给出变分不等式问题的定义。令 R n 是 n 维欧式空间，其内积定义为： 〈 x , y 〉 = x T y 范数为： ‖ x ‖ = ( ∑ i = 1 n x i 2 ) 1 / 2 设 X 为 n 维欧式空间 R n 中的非空闭凸集，映射 F : R n → R n ， h : R n → R l 为线性函数， g : R n → R m 为二次连续可微凸函数，则变分不等式(VI)问题： 求 x ∈ X ，使 F ( x ) T ( y − x ) ≥ 0 ， ∀ y ∈ X (4) 其中可行集为： X = { x : h ( x ) = 0 , g ( x ) ≤ 0 } (5) 变分不等式(VI)问题与其它数学规划有着密切的联系： 1) 如果 X 取为 R n 中的开集，VI为广义方程组，即： F ( x ) = 0 2) 假设 F ( x ) 的梯度 ∇ F ( x ) 为对称阵，此时VI (4)~(5)对应于凸规划的KKT条件是： min f ( x ) s .t .   A x = b (6) g ( x ) ≤ 0 其中 A ∈ R l × n ， b ∈ R l ， g : R n → R m ， f : R n → R ，当 f 是凸连续二次可微函数，问题(6)等价于以下VI问题： 求 x ∈ X ，使 〈 ∇ f ( x ) , y − x 〉 ≥ 0 , ∀ y ∈ X 其中集合 X 可表示为： X = { x ∈ R n : A X − b = 0 , − g ( x ) ≥ 0 } 自从VI问题被提出来以后，其数值解的研究发展也非常迅速，学者们已经提出了许多有效的算法来解决经典变分不等式和互补问题，其中包括投影法、内点法、非光滑方程组法、光滑方程组法和价值函数法等 [ 11 ] [ 14 ] [ 15 ] 。本文通过利用 ϕ 1 函数将非线性互补问题转化成一个非线性方程组 ψ ( x ) = 0 来求解，采用了基于NCP函数的光滑牛顿算法。"
"变分不等式问题(4)~(5)的KKT条件是： F ( x ) + J h ( x ) T μ − J g ( x ) T λ = 0 h ( x ) = 0 (7) 0 ≥ g ( x ) ⊥ λ ≥ 0 应用NCP函数(3)，从而VI等价于下述的KKT方程组： 0 = ψ i ( ε , x , μ , λ ) = [ ε L ( x , μ , λ ) − h ( x ) ϕ 1 ( ε , − g 1 ( x ) , λ 1 ) ⋮ ϕ 1 ( ε , − g m ( x ) , λ m ) ] (8) 其中 ε > 0 ， L ( x , μ , λ ) ≡ F ( x ) + J h ( x ) T μ + J g ( x ) T λ 是VI的拉格朗日函数，如果 ( ε , x , μ , λ ) 是光滑方程组(8)的解， ( x , μ , λ ) 是变分不等式问题(4)~(5)的KKT点。因此，我们的目标是获得平滑方程组(8)的数值解。对于 ε > 0 ， a , b ∈ R ， ϕ 1 的雅可比矩阵如下 [ 3 ] [ 16 ] ： J ϕ 1 ( ε , a , b ) = ( ∂ ϕ 1 ∂ ε , ∂ ϕ 1 ∂ a , ∂ ϕ 1 ∂ b ) = { ( ε p − 1 ‖ ( ε , a , b ) ‖ p p − 1 , a p − 1 ‖ ( ε , a , b ) ‖ p p − 1 − 1 − α b + ∂ a + , b p − 1 ‖ ( ε , a , b ) ‖ p p − 1 − 1 − α a + ∂ b + ) ( ε p − 1 ‖ ( ε , a , b ) ‖ p p − 1 , sgn ( a ) ⋅ a p − 1 ‖ ( ε , a , b ) ‖ p p − 1 − 1 − α b + ∂ a + , sgn ( b ) ⋅ b p − 1 ‖ ( ε , a , b ) ‖ p p − 1 − 1 − α a + ∂ b + ) (9) 根据(9)，我们可以推出 J ψ p ( ε , x , μ , λ ) 的形式。 定理1：令 ψ i : R + × R n × R l × R m → R 1 + n + l + m 被定义的映射(8)，设 ε > 0 ， ( x , μ , λ ) ∈ R n × R l × R m 是任意给定的点， a i ε ( x , λ ) = { − ( g i ( x ) ) p − 1 ‖ ( ε , g i ( x ) , λ i ) ‖ p p − 1 − 1 − α ( λ i ) + ⋅ ∂ ( − g i ( x ) + ) − sgn ( g i ( x ) ) ( g i ( x ) ) p − 1 ‖ ( ε , g i ( x ) , λ i ) ‖ p p − 1 − 1 − α ( λ i ) + ⋅ ∂ ( − g i ( x ) + ) b i ε ( x , λ ) = { − ( λ i ) p − 1 ‖ ( ε , g i ( x ) , λ i ) ‖ p p − 1 − 1 − α ( − g i ( x ) + ) ⋅ ∂ ( λ i ) + − sgn ( λ i ) ( λ i ) p − 1 ‖ ( ε , g i ( x ) , λ i ) ‖ p p − 1 − 1 − α ( λ i ) + ⋅ ∂ ( − g i ( x ) + ) D g ε = d i a g ( a 1 ε ( x , λ ) , ⋯ , a m ε ( x , λ ) ) D λ ε = d i a g ( b 1 ε ( x , λ ) , ⋯ , b m ε ( x , λ ) ) 我们计算出 ψ i ( ε , x , μ , λ ) 的Jacobian矩阵如下： J ψ i ( ε , x , μ , λ ) = [ 1 0 0 0 0 J x L ( x , μ , λ ) J h ( x ) T J g ( x ) T 0 − J h ( x ) 0 0 E 1 E 2 0 E 3 ] 其中 E 1 = [ ε p − 1 ‖ ( ε , g 1 ( x ) , λ 1 ) ‖ p p − 1 e ε p − 1 ‖ ( ε , g 2 ( x ) , λ 2 ) ‖ p p − 1 e ⋮ ε p − 1 ‖ ( ε , g m ( x ) , λ m ) ‖ p p − 1 e ] (10) E 2 = − D g ε J g E 3 = D λ ε 现在我们研究Jacobian矩阵 J ψ i 在点 ( ε , x , μ , λ ) 处的非奇异性。 定理2：设 ( ε , x , μ , λ ) ∈ R 1 + n + l + m 为任意给定的点，且 ε > 0 如果 (a) 梯度 { ∇ h j ( x ) : j = 1 , ⋯ , l } ∪ { ∇ g i ( x ) : i ∈ I 0 } 是线性无关的。 (b) J x L ( x , μ , λ ) 在梯度 { ∇ h j ( x ) : j = 1 , ⋯ , l } 的零空间内是正定的。 I 0 = { i : g i ( x ) = 0 ≤ λ i , i = 1 , 2 , ⋯ , m } 那么，Jacobian矩阵 J ψ i ( ε , x , μ , λ ) 是非奇异的。 证明：由定理1， J ψ i 是非奇异的当且仅当下面的矩阵是非奇异的，即 J 0 = [ J x L ( x , μ , λ ) J h ( x ) T J g ( x ) T − J h ( x ) 0 0 E 2 0 E 3 ] 是奇异的，因此，我们只要证明出 J 0 T 是非奇异的。设 ( u , v , t ) ∈ R n × R l × R m 是 J 0 的零空间内的任意一个向量。 J 0 T ( u , v , t ) = 0 (11) 我们只要证明 u = 0 ， v = 0 和 t = 0 即可，由(11)，我们可以得到如下三个式子： ( J x L T ) u − ( J h T ) v − ( J g T ) E 2 t = 0 (12) ( J h ) u = 0 (13) ( J g ) u + E 3 t = 0 (14) 由公式(13)，可以推出 u T ( J h T ) = 0 u T ´ (12)，可以得到 u T ( J x L T ) u = u T ( J g T ) E 2 t (15) t T ´ (14)，可以得到 t T ( J g ) u = − t T E 3 t (16) 由定理1中 E 3 定义可知， E 3 是半负定的，我们可以得到： ∑ j = 1 m ( t j ∑ i = 1 n ) = t T ( J g ) u ≥ 0 由于 a i ≤ 0 ，我们计算式子(15)的右半部分 u T ( J g T ) E 2 t = ∑ j = 1 m ( a j t j ∑ i = 1 n ) ≤ 0 之后，我们可以得到： u T ( J x L T ) u ≤ 0 由假设条件(b)可得： u = 0 (17) 因此，(12)和(14)分别成为： ( J h T ) v + ( J g T ) E 2 t = 0 (18) 和 ( D λ ) t = 0 (19) 对于任意的 i ∉ I 0 ，通过(19)式不难得到 b i ≠ 0 和 t i = 0 。令 I = { 1 , 2 , ⋯ , m } ，(18)式等价于下面的式子： ( J h T ) v + ( J g T ) E 2 t ¯ = 0 其中 t ¯ = [ t I 0 t I − I 0 ] (20) 根据假设条件(a)和(18)，不难得到： v = 0 ,     t = 0 证明完毕。"
"下面我们来研究一种光滑算法，用于求解方程组(18)，并标明该算法定义明确。令 N 表示所有非负正数的合集。对于任意点 ( ε , x , μ , λ ) ， ( ε k , x k , μ k , λ k ) ∈ R + × R n × R l × R m ，除非另有说明，否则我们总是在本文中使用以下符号： z : = ( ε , Y ) = ( ε , x , μ , λ ) z k : = ( ε k , Y k ) = ( ε k , x k , μ k , λ k ) 算法1 Step1：任意选取常数 δ , σ , γ ∈ ( 0 , 1 ) ，与 Y 0 ∈ R n × R l × R m 。取 ε 0 ∈ R + + ，故 γ ε 0 < 1 。 令 z 0 : = ( ε 0 , Y 0 ) ， ε ¯ : = ε 0 ， h : = ( ε ¯ , 0 ) ∈ R + + × R n × R l × R m 与 k : = 0 。 Step2：如果 ‖ ψ i ( z k ) ‖ = 0 ，则终止计算，否则，令 β ( z k ) : = γ min { 1 , ‖ ψ i ( z k ) ‖ } 。 Step3：求解下述方程组得到 Δ z k : = ( Δ ε k , Δ Y k ) ∈ R × R n × R l × R m J ψ i ( z k ) Δ z k = − ψ i ( z k ) + β ( z k ) h ¯ (21) 其中 J ψ i ( z k ) 表示在点 z k 处的函数 ψ i 的雅可比矩阵。 Step4：设 α k 是满足下述不等式的最小的非负整数 ‖ ψ i ( z k + α k Δ z k ) ‖ ≤ [ 1 − 2 σ ( 1 − γ ε ¯ ) α k ] ‖ ψ i ( z k ) ‖ (22) 计算 z k + 1 = z k + α k Δ z k . Step5：置 k : = k + 1 ，转到步1。 接下来我们考虑算法1的适定性及收敛性。 备注1 根据定理2，我们知道 J ψ i ( ε , Y ) 对于任意的 ( ε , Y ) ∈ R + + × R n × R l × R m 是非奇异的，故方程(21)的解存在且唯一，从而算法1的步2是适定的。 备注2 下面证明步3的适定性，即有限终止。 ε k + 1 = ε k + α k Δ ε k = ( 1 − α k ) ε k + α k ε ¯ β ( z k ) (23) 上式表明对于所有的 k ∈ N ， ε k > 0 ，通过备注1，我们知道当 ε k > 0 时， J ψ i ( z k ) 是非奇异的，因此，(21)对于所有 k ∈ N 是可解的。另一方面，令 R ( z k ) = ψ i ( z k + α Δ z k ) − ψ i ( z k ) + α J ψ i ( z k ) Δ z k (24) 由 J ψ i ( z k ) 的一致连续性知，对于 z ∈ R + + × R n ，有 lim α → 0 ‖ R k ( α ) ‖ α = 0 ，故对所有的 α ∈ ( 0 , 1 ) 及 z ∈ R + + × R n ，有 ‖ ψ 1 ( z k + α k Δ z k ) ‖ = ‖ R ( z k ) + ψ i ( z k ) + α J ψ i ( z k ) Δ z k ‖ = ‖ R ( z k ) + ( 1 − α ) ψ i ( z k ) + α β ( z k ) h ¯ ‖ ≤ ‖ R ( z k ) ‖ + ( 1 − α ) ‖ ψ i ( z k ) ‖ + α μ ¯ β ( z k ) ≤ ‖ R ( z k ) ‖ + [ 1 − α ( 1 − λ μ ¯ ) ] ‖ ψ i ( z k ) ‖ (25) 由(24)式知能找到 α ¯ ∈ ( 0 , 1 ) ，使得对所有 α ∈ ( 0 , α ¯ ) 及 z ∈ R + + × R n ，有 ‖ ψ i ( z k + α k Δ z k ) ‖ ≤ [ 1 − σ ( 1 − γ ε ¯ ) α k ] ‖ ψ i ( z k ) ‖ (26) 成立，这就证明了步3的有限终止性，证明完毕。 (a) 由(23)式不难看出序列 { ‖ ψ i ( z k ) ‖ } 是单调递减的，这也暗示着序列 { ‖ β ( z k ) ‖ } 是单调递减的。 (b) 设 J ( r ) : = { ( ε , Y ) ∈ R + × R n × R l × R m : ε ¯ β ( ε , Y ) ≤ ε } 与 z 0 ∈ J ( r ) 。实际上，对于所有的 k ∈ N ， z k ∈ J ( r ) ，由于 ε k + 1 − ε ¯ β ( z k + 1 ) = ( 1 − τ k ) ε k + τ k ε ¯ β ( z k ) − β ( z k + 1 ) ≥ ε ¯ ( β ( z k ) − β ( z k + 1 ) ) ≥ 0 (c) 结合式(23)与备注2的(4)，可以得到 ε k + 1 = ( 1 − τ k ) ε k + τ k ε ¯ β ( z k ) ≤ ( 1 − τ k ) ε k + τ k ε k = ε k 因此，序列 { ε k } 是单调递减的。"
"本节给出一个数值例子来验证算法1的有效性。我们的数值实验是应用Matlab软件进行计算。 算例1：我们考虑下面的变分不等式问题：找到 x 满足 〈 1 2 D x , y − x 〉 ≥ 0 ,     ∀ y ∈ C 其中 C = { x ∈ R n : A x − a = 0 , B x − b ≤ 0 } 是 n × n 正定矩阵， A 和 B 分别是 l × n 和 m × n 维矩阵。 d 是一个 n × 1 维向量， a 和 b 分别是 l × 1 和 m × 1 维向量，并且 l + m ≤ n 。 我们确定常数如下： a , b 和 A , B 的元素是从间隔[1,2]中随机选择的， D 的主对角线元素取[1,2]，其他元素取[0,1]。为了满足定理2的条件，我们设 A , B 是满秩的，并且 r a n k ( [ A T B T ] ) = l + m 。每个问题实例由算法1使用初始点求解，其中元素从间隔[0,1]中随机生成。在实现中，我们在方法中使用以下参数： δ = 0.5 ,   σ = 1.0 e − 1 ,   γ = 0.1 ,   ε 0 = 0.2 数值结果总结在表1中，其中n,l,Iter和Time分别表示变量的数量， A 的行向量的数量，迭代次数和CPU运行时间。 Table 1n l Iter Time Error 4 2 3 0.001893 1.00e−5 8 4 4 0.000841 2.00e−6 16 5 5 0.003516 2.00e−6 32 5 8 0.006565 3.00e−6 64 30 10 0.024259 4.00e−5 128 50 22 0.117793 4.90e−5 256 150 30 0.632780 5.00e−6 表1. 例1的数据结果 上述实验计算的是 p = 2 时的结果，和文献 [ 2 ] 中应用 ϕ p ( a , b ) 函数求解的同一个变分不等式的结果相比较，显然，本文应用 ϕ 1 ( a , b ) 的算法迭代次数更少，收敛速度更快一些。"
"本文中，我们使用了一种新的NCP函数求解了变分不等式问题，在此函数的帮助下，我们将变分不等式问题的KKT条件转化成一个方程组问题，并且在严格互补的条件下证明了映射 ψ i 的Jacobian矩阵的非奇异性，在此建立了求解NCP函数非线性互补问题的一个光滑化牛顿法，获得算法的收敛性和局部收敛性结果，并给出数值实验结果验证理论分析的准确性。"
