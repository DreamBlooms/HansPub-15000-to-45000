"随着科技的发展，智能化已经走进日常生活，智能饮水杯根据人们的生活习惯科学引导饮水，通过研究设计出一款可以不同模式工作，具有测温、测量杯内水量、计算喝水量、提醒、保温、丰富内容显示，并能通过蓝牙与手机连接用APP控制的智能饮水杯。系统采用宏晶科技公司的STC15W4K56S4单片机为控制核心，DS18B20温度传感器测温，薄膜压阻式触觉传感器测量杯内水的重量；在杯体底部与智能杯底座间设计了无线充电系统；通过人体红外感应设定功能操作。样机表明，设计功能智能化改进了传统水杯，为人们的现代生活添加了科学和时尚。 关键词 :智能化，电子设计，单片机系统，无线充电 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"在如今科技飞速发展的时代，智能家具在传统家具功能保留完好的基础上不断优化，普通百姓也从中获得无限的乐趣 [ 1 ] [ 2 ] ，智能电视、全自动洗衣机、自动调节冰箱，用手机APP控制的烤箱选择烘焙大师的智能菜谱等等，都便捷了我们的生活，带来了乐趣。人们在繁忙的工作生活中，时常忘记喝水，当感到口渴时，身体已经缺水 [ 3 ] ，通过对市场智能水杯性能研究，以方便生活，利于健康为理念，利用自动化知识设计出一款以单片机为控制核心的可以设定喝水时间提醒、水量显示和提醒、水温显示、个人饮水信息采集分析，通过蓝牙通讯模块与手机APP通信等功能，合理提醒科学饮水的多功能智能水杯。"
"智能水杯设计以单片机为控制核心 [ 4 ] ，包括显示模块、压力传感器、电阻电压转换模块、蓝牙模块、人体热释电感应模块、无线充电模块、稳压模块、温度传感器等功能模块 [ 5 ] [ 6 ] 。如图1所示。 由于STC15W4K56S4单片机为宏晶科技公司生产的一款高速、高可靠、低功耗性增强型51单片机 [ 7 ] ，机器周期可达1 T，工作电压适应范围宽：2.5~5.5 V，无需编程器利用ISP/IAP系统在线编程，提供8通道10位高速ADC，8路可复用为8路D/A的PWM发生器，内部集成一组ISP总线、一组高速SPI同步串行通信端口。 图1. 系统控制结构框图 电源系统使用5 V锂电池供电并设计了无线充电装置保证正常工作用电及保温。无线充电装置采用电磁谐振式结构 [ 8 ] ，由能量发射系统和能量接受系统两部分构成，如图2所示。能量发射系统的信号发生器和驱动电路产生200 KHz的谐振开关信号、将整流滤波后的高频逆变信号产生高频谐振、送入发射线圈，发射装置嵌入在被座内，与工频交流电相连接。能量接收系统嵌入在智能杯底部，由接收线圈、高频谐振、整流滤波电路组成，输出电能同时提供单片机系统工作和锂电池充电。 图2. 无线充电系统结构框图 稳压模块设计中选定TI公司的TPS63020为核心的稳压模块，TPS63020是一款高效、使用外围电路简单的Buck-Boost转换芯片，输入电压范围1.8~5.5 V，输出电压1.2~5.5 V可调，最高效率96%，输出电流可达1.5 A，器件的静态电流小于50 μA，带过温保护和过压保护功能。 水温测量采用达拉斯公司生产DS18B20线式温度传感器，TOP-2封装，可以程序设定9~12位的分辨率，精度为±0.5℃，设计中其数据线与单片机引脚P2.0口连接使用“一线式”数字通讯 [ 9 ] [ 10 ] 。 测重模块使用RFP602薄膜压阻式触觉传感器，感应范围20 g~6 Kg，灵敏度可调，尺寸小。压力通过传感器变形转换为电阻变化，通过电阻转换电压电路后，经AD模块完成数字化压力参量，计算后得到对应杯中水的质量。 调温模块：调温模块为加热功能，智能水杯放在杯座上(充电状态)时，可以设定杯内饮用水的温度范围，温度低于设定温度时，将给加热电阻供电，达到设定温度切断加热电阻上电流，加热电阻的电流由整流后的滤波电路提供，但通断有单片机对晶闸管MCR-100发送导通信号控制。 按键模块：因为杯体外壳面积有限，又要考虑取用方便，设计了两个独立式按键，分别与单片机P2.2、P2.1引脚连接，一个是功能转换按键，另一个是确认按键，当无蓝牙无线连接控制时功能选择。 蓝牙(Bluetooth)是一种无线通讯技术标准，实现固定设备和移动设备间短距离数据交换。日常生活中，通过蓝牙设备不需要麻烦的插拔连接就可以下载歌曲、电影、电子书或传输资料。设计中单片机以UART串口通过HC06蓝牙模块实现与人们的手机相连，接收到饮水提示和信号，方便饮水需求。连接成功后，系统自动切换到无线传送状态。 显示模块：智能水杯通过显示器向使用者显示丰富的饮水信息，市场上常见的有LCD1062，LCD12864，SDWe070C06等，普通LCD1602、LCD12864和SDWe070C06都引脚过多，体积相对水杯巨大，无法安放，考虑使用类似智能手环简单显示器，但市场搜索不到，查询均为定制产品，无法购买， 最后综合考虑使用OLED (Organic Light-Emiting Diode，有机发光二极管)显示器，OLED12864显示器具有低功耗、内置字模，通过编程指令控制显示亮度、对比度、开关升压电路等，与单片机方便连接、控制，市场有小型0.96寸显示屏，适合智能水杯设计需要，显示主要内容如图3所示。用户可通过按键或者蓝牙连接选择显示内容和工作方式。 图3. 液晶显示器显示内容 选用HC-SR505小型人体红外感应模块感应人手是否接近饮水杯，作为单片机唤醒信号，有人体感应后则显示器显示，各预设功能开关打开HC-SR505是基于红外线技术的小型人体红外感应模块，超小体积，灵敏度高，可靠性强，可低电压工作，广泛应用于自动感应电气设备中。人进入其感应范围则输出高电平，并且该模块具有可重复触发方式，即输出高电平后，在延时时间段内，如果有人体在其感应范围内活动，其输出将一直保持高电平，直到人离开后才延时将高电平变为低电平。输出的高电平信号可对单片机发起中断唤醒。"
"智能饮水杯的工作方式主要分普通方式和生病工作方式，普通方式有饮水提醒、保温范围在30℃~40℃可调，温度偏低时加热，偏高时停止加热；生病方式设置有吃药提醒和饮水提醒，默认保温30℃~45℃可调。人体靠近时红外探测器唤醒单片机系统，完成测温、测重及显示结果10 s，之后若无按键中断发生，则关闭显示器进入节能状态。两种工作模式中温度范围、提醒喝水频率、24小时饮水总量提醒均可根据个人习惯设定或采用默认工作方式。 系统程序设计构架如图4所示。智能饮水杯程序设计主要由主程序和若干功能模块子程序模块组成，子程序模块主要包含显示、温度测量、称重、红外信息采集中段、按键中断、蓝牙中断等子程序；主程序开始后对整个系统初始化后，定时循环按不同模式调用温度测量、称重、显示子程序；如果是保温模式则在设定低温点开启加热子程序，加温到设定高温点断开加热电阻电流。 图4. 系统程序框架图 系统通电后开始初始化，初始化内容主要包括点亮电源指示灯、液晶屏初始化、测温模块初始化、称重模块初始化等等。初始化完成后显示模式选择、开按键和蓝牙中断申请，等待是否更改工作模式，10秒后无中断自动进入默认工作模式：普通模式(不保温、不提醒、检测到人体靠近显示普通模式，图3中a普通饮水模式，人体离开5 s后关闭显示屏，以上参数可以调整，调整可以通过按键选择或者蓝牙链接手机APP)。"
"样机内部元件如图5所示。制作完成后进行了测试，主要性能参数及与当前市场流行智能水杯对比如表1所示。 Table 1 性能(参数) 所设计智能水杯样机 市场流行智能水杯 水量测量 薄膜压力称重(精度1 g = 1 ml) 电容感应测容积(精度20 ml) 温度测量 数字温度传感器18B20 (精度0.5℃) 三色温度段显示或精度1℃ 显示器件 OLED显示 LED、OLED等 显示内容 丰富(水量、水温、工作模式等) 简单(温度、水量) 工作模式 直接和蓝牙远程控制，多模式可选运行 运行模式固定不可选 充电方式 无线电磁感应充电 USB 提醒喝水 指示灯闪耀同时APP提示 震动杯体 保温 在杯垫上时可加热保温 依靠杯体保温 表1. 智能水杯样机主要参数及与市场流行智能水杯差别 图5. 样机内部结构"
"样机经测试技术上达到设计目标，但有许多不足及工艺难题，如：显示器的选择需要根据美观设计后定做外观和大小，充电使用只能将水杯放在充电底座上完成，模块间都是单独设计制作完成后连接组合，占空间大且稳定性较差。随着设计的进一步优化，该设计理念可以更加符合人们的健康生活，解决现代人忽略科学饮水的意义，让科技带来方便和健康。"
