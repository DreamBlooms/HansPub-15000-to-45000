"本文提出了一种有效的有限元方法来求解球域上的椭圆方程。首先，利用球坐标变换和球谐函数展开，将原问题化为一系列等价的一维问题。其次，通过引入带权的Sobolev空间，建立了每个一维问题的弱形式和相应的离散形式。另外，利用分片线性插值多项式的逼近性质证明了逼近解的误差估计。最后给出了算法的具体实现过程，并通过数值例子验证了算法的有效性。"
"有限元方法是求解微分方程常用的数值方法之一，具有数值稳定性、通用性强的特点。其思想是利用变分原理，通过构造有限维空间中的分片多项式函数来逼近原问题的真解。计算机的出现，使得有限元法在很多方面得到广泛应用，例如：物理学、材料科学、生物学(参见文献 [ 1 ] - [ 9 ] )等。 关于求解二阶椭圆方程的数值方法有很多，主要包括弱有限元法，即在多边形或多面体网格区域上求解二阶椭圆问题(参见文献 [ 10 ] [ 11 ] [ 12 ] [ 13 ] )、有限体积法和谱方法(参见文献 [ 12 ] [ 13 ] [ 14 ] [ 15 ] )等。然而，却很少在于球域上研究椭圆方程，主要是直接在球域上通过网格剖分构造基函数比较复杂和困难。 因此，本文提出了一种有效的有限元方法来求解球域上的椭圆方程。首先，利用球坐标变换和球谐函数展开，将原问题化为一系列等价的一维问题。其次，通过引入带权的Sobolev空间，建立了每个一维问题的弱形式和相应的离散形式。另外，利用分片线性插值多项式的逼近性质证明了逼近解的误差估计。最后给出了算法的具体实现过程，并通过数值例子验证了算法的有效性。 最后，简要介绍本文接下来的工作安排。在第2节，我们推导了原问题的降维格式。在第3节，引入带权的Sobolev空间，推导原问题基于降维格式的弱形式和相对应的离散格式。在第4节，证明逼近解的误差估计。在第5节，给出了该算法的具体实现过程。在第6节，提供了一些数值例子验证算法的有效性。最后，在第7节，给出了一些结论性评注。"
"作为模型问题，我们考虑下面的二阶椭圆方程： { − Δ u + α u = f ,   x ∈ Ω , u = 0 ,                                 x ∈ ∂ Ω , (2.1) 其中， Ω = { ( x , y , z ) ∈ R 3 : x 2 + y 2 + z 2 < R } ，n是边界 ∂ Ω 的单位外法向量。 为了有效地求解该问题，我们将利用球坐标变换和球谐函数展开，将原问题化为一系列等价的一维问题。定义如下的微分算子： L v = 1 r 2 ∂ ∂ r ( r 2 ∂ v ∂ r ) + 1 r 2 Δ s v (2.2) 其中 Δ s = 1 sin θ ∂ ∂ θ ( sin θ ∂ ∂ θ ) + 1 sin 2 θ ∂ 2 ∂ ϕ 2 由格林公式可知，(2.1)的弱形式为：找 u ∈ H 0 1 ( Ω ) ，使得 ∫ Ω ∇ u ∇ v ¯ d x d y d z + α ∫ Ω u v ¯ d x d y d z = ∫ Ω f v ¯ d x d y d z ， ∀ v ∈ H 0 1 ( Ω ) (2.3) 其中 v ¯ 是v的复共轭。则由球坐标变化 x = r sin θ cos ϕ , y = r sin θ sin ϕ , z = r cos θ 可得到(2.1)在球坐标系下的方程为： (2.4) φ ( R , θ , ϕ ) = 0 (2.5) 其中 φ ( r , θ , ϕ ) = u ( x , y , z ) ， g ( r , θ , ϕ ) = f ( x , y , z ) ， 。 由(2.3)可得到(2.4)，(2.5)的弱形式为： a ( φ , ψ ) = ( g , ψ ) (2.6) 其中 a ( φ , ψ ) = ∫ 0 R ∫ S r 2 L φ ψ ¯ d r d S + α ∫ 0 R ∫ S r 2 φ ψ ¯ d r d S ( g , ψ ) = ∫ 0 R ∫ S r 2 g ψ ¯ d r d S 其中S是单位球面。令 φ ( r , θ , ϕ ) = ∑ | m | = 0 ∞ ∑ | l | = 0 m φ m l Y m l ， g ( r , θ , ϕ ) = ∑ | m | = 0 ∞ ∑ | l | = 0 m g m l Y m l ，其中 Y m l 表示球调和函数，且具 有如下性质： Δ s Y m l = − m ( m + 1 ) Y m l ， m ≥ 0 ， | l | ≤ m ， ∫ S Y m l Y m ′ l ′ d S = σ m m ′ σ l l ′ (2.7) 令 l m v = 1 r 2 ( r 2 v r ) r − m ( m + 1 ) r 2 v ，则由球调和函数的性质(2.7)可知(2.4)和(2.5) 等价于如下的一系列一维问题： − l m φ m + α φ m = g m ( r ) ， r ∈ ( 0 , R ) (2.8) φ m l ( R ) = 0 (2.9) 令 r = R t ， u m l ( t ) = φ m l ( R t ) ， F m l ( t ) = g m l ( R t ) ， L m v = 1 t 2 ( t 2 v t ) t − m ( m + 1 ) t 2 v ，则(2.8)~(2.9)等价为： − L m u m l + α R 2 u m l = R 2 F m l ， t ∈ ( 0 , 1 ) (2.10) u m l ( 1 ) = 0 (2.11)"
"首先，我们引入通常的带权Sobolev空间： L ω 2 ( I ) : = { f : ∫ I ω f m 2 d t < ∞ } 相应的内积和范数分别为： ( f m , g m ) ω = ∫ I ω f m g m d t ， ‖ f m ‖ ω = ( ∫ I ω f m 2 d t ) 1 2 其中 I = ( 0 , 1 ) ， ω = x 2 为权函数。然后定义非一致带权Sobolev空间： H 0 , ω , 0 1 ( I ) : = { u 0 l : ∂ t k u 0 l ∈ L ω 2 ( I ) , u 0 l ( 1 ) = 0 , k = 0 , 1 } , m = 0 ; H 0 , ω , m 1 ( I ) : = { u m l : ∂ t k u m l ∈ L ω k 2 ( I ) , u m l ( 1 ) = 0 , k = 0 , 1 } , m ≥ 1 其相对应的内积和范数分别为： ( f 0 l , g 0 l ) 1 , ω , 0 = ∑ k = 0 1 ( ∂ t k f 0 l , ∂ t k g 0 l ) ω , ‖ f 0 l ‖ 1 , ω , 0 = ( f 0 l , f 0 l ) 1 , ω , 0 1 2 ; ( f m l , g m l ) 1 , ω , m = ∑ k = 0 1 ( ∂ t k f m l , ∂ t k g m l ) ω k , ‖ f m l ‖ 1 , ω , m = ( f m l , f m l ) 1 , ω , m 1 2 则方程(2.10)~(2.11)的弱形式为：找 u m l ∈ H 0 , ω , m 1 ( I ) ，使得 a m ( u m l , v ) = F m ( v ) ， ∀ v ∈ H 0 , ω , m 2 ( I ) (3.1) 其中： a m ( u m l , v ) = ∫ I t 2 ( u m l ) ′ v ′ + m ( m + 1 ) u m l v d t + α R 2 ∫ I t 2 u m l v d t ， F m ( v ) = R 2 ∫ I t 2 F m l v d t 。 取逼近空间 X m h = U h ∩ H 0 , ω , m 1 ( I ) ，其中 U h 是由分段线性插值基函数组成的空间，则(3.1)相对应的离散格式为：找 u m h l ∈ X m h ，使得 a m ( u m h l , v m h l ) = F m ( v m h l ) ， ∀ v m h l ∈ X m h (3.2)"
"为了简洁起见，我们使用表达式 a ≲ b 或 a ≳ b 来表示存在一个正常数C使得 a ≤ C b 或 a ≥ C b 。 定理1. 双线性形式 a m ( u m l , v ) 在 H 0 , ω , m 1 ( I ) × H 0 , ω , m 1 ( I ) 上是有界且正定的，即： | a m ( u m l , v ) | ≲ ‖ u m l ‖ 0 , ω , m ‖ v ‖ 0 , ω , m ， a m ( u m l , u m l ) ≳ ‖ u m l ‖ 0 , ω , m 2 。 证明：由Cauchy-Schwarz不等式我们可得： | a m ( u m l , v ) | = | ∫ I t 2 ( u m l ) ′ v ′ + m ( m + 1 ) u m l v d t + α R 2 ∫ I t 2 u m l v d t | ≲ ∫ I t 2 | ( u m l ) ′ v ′ | + m ( m + 1 ) | u m l v | + t 2 | u m l v | d t ≲ [ ∫ I t 2 [ ( u m l ) ′ ] 2 + t 2 ( u m l ) 2 + m ( m + 1 ) ( u m l ) 2 d t ] 1 2 [ ∫ I t 2 ( v ′ ) 2 + t 2 v 2 + m ( m + 1 ) v 2 d t ] 1 2 ≲ ‖ u m l ‖ 0 , ω , m ‖ v ‖ 0 , ω , m a m ( u m l , u m l ) = ∫ I t 2 [ ( u m l ) ′ ] 2 + m ( m + 1 ) ( u m l ) 2 d t + α R 2 ∫ I t 2 ( u m l ) 2 d t ≳ ‖ u m l ‖ 0 , ω , m 2 定理2. 如果 F m ( t ) ∈ L ω 2 ( I ) ，则 F m ( v ) 为 H 0 , ω , m 1 ( I ) 上的有界线性泛函，即： | F m ( v ) | ≲ ‖ v ‖ 0 , ω , m 。 证明：由Cauchy-Schwarz不等式有 | F m ( v ) | = | ∫ I t 2 F m l v d x | = | ∫ I ( t F m l ) ( t v ) d t | ≲ [ ∫ I ( t F m l ) 2 d t ] 1 2 [ ∫ I ( t v ) 2 d t ] 1 2 ≲ [ ∫ I ( t v ) 2 d t ] 1 2 ≲ [ ∫ I ( t v ′ ) 2 + ( t v ) 2 d t ] 1 2 = ‖ v ‖ 0 , ω , m 则由定理1，定理2和Lax-milgram定理我们有下面的定理： 定理3. 若 F m l ∈ L ω 2 ( I ) ，方程(3.1) 和(3.2)分别存在唯一解 u m l ∈ H 0 , ω , m 1 ( I ) 和 u m h l ∈ X m h 。 定义区间I上的插值投影 I h u m l ： H 0 , ω , m 1 ( I ) → U h ，由文献 [ 16 ] 中的分段线性插值理论可得如下引理。 引理1. 对于 u m l ∈ H 0 , ω , m 1 ( I ) ，若 u m l ( x ) 在区间I上有连续导数，则成立： ‖ I h u m l − u m l ‖ 0 , ω , m ≲ h 。 定理4. 假设 u m 和 u m h 分别是方程(3.1)和(3.2)的解，则下列不等式成立： ‖ u m l − u m h l ‖ 0 , ω , m ≲ h 。 证明：由(3.1) 和(3.2)我们可得 a m ( u m l , v h ) = F m ( v h ) ， ∀ v h ∈ X m h (4.1) a m ( u m h l , v h ) = F m ( v h ) ， ∀ v h ∈ X m h (4.2) 因此 a m ( u m l − u m h l , v h ) = 0 (4.3) 结合定理1和(4.3)可得 ‖ u m l − u m h l ‖ 0 , ω , m 2 ≲ a m ( u m l − u m h l , u m l − u m h l ) = a m ( u m l − u m h l , u m l + v h − v h − u m h l ) = a m ( u m l − u m h l , u m l − v h ) ≲ ‖ u m l − u m h l ‖ 0 , ω , m ‖ u m l − v h ‖ 0 , ω , m 则有 ‖ u m l − u m h l ‖ 0 , ω , m ≲ inf v h ∈ X m h ‖ u m l − v h ‖ 0 , ω , m (4.4) 结合(4.4)和引理1可得 ‖ u m l − u m h l ‖ 0 , ω , m ≲ h ."
"为了更好的验证我们算法的有效性，我们构造满足边值条件的基函数如下： φ 0 ( t ) = { 1 − t − t 0 h 1 ，                 t 0 ≤ t ≤ t 1 , 0 ，                                                                                   其 它 ， (5.1) φ i ( t ) = { 1 + t − t i h i ,               t i − 1 ≤ t ≤ t i , 1 − t − t i h i + 1 ,                 t i ≤ t ≤ t i + 1 , 0 ,                                                                                       其 它 , (5.2) 其中 i = 1 , ⋯ , N − 1 。则逼近空间可取为： X h ( m ) = span { φ 0 ( t ) , φ 1 ( t ) , ⋯ , φ N − 1 ( t ) } 。 设 a i j m = ∫ I t 2 φ ′ j φ ′ i d t ,                                                                             b i j m = m ( m + 1 ) ∫ I φ j φ i d t , c i j m = α R 2 ∫ I t 2 φ j φ i d t ,                                     f i j m = R 2 ∫ I t 2 F m l φ j d t 令 u m h = ∑ i = 0 N − 1 u i m φ i ( t ) (5.3) 将(5.3)式代入(3.2)式，把 v m h 取遍逼近空间 X h ( m ) 中的所有基函数，即可得如下的线性系统： ( A + B + C ) U m = G m (5.4) 其中 A = ( a i j m ) ， B = ( b i j m ) ， C = ( c i j m ) ， G = ( f i j m ) ， U m = ( u 0 m , u 1 m , ⋯ , u N − 1 m ) T 。 由分片线性插值基函数的性质知，(5.4)中的质量矩阵和刚度矩阵都是稀疏矩阵。"
"在这一节，我们将在MATLAB 2015a平台上进行编程计算，令 u M h ( x , y , z ) 为精确解 u ( x , y , z ) 的逼近解为， r = R t ，则有 u ( x , y , z ) = u ˜ ( t , θ , ϕ ) = ∑ | m | = 0 ∞ ∑ | l | = 0 m u m l ( t ) Y m l ， u M h ( x , y , z ) = u ˜ h ( t , θ , ϕ ) = ∑ | m | = 0 M ∑ | l | = 0 m u m h l ( t ) Y m l 。 定义精确解和数值解的误差如下： e ( u M h ( x , y , z ) , u ( x , y , z ) ) = ‖ u M h ( x , y , z ) − u ( x , y , z ) ‖ L ∞ ( Ω ) = ‖ u ˜ M h ( t , θ , ϕ ) − u ˜ ( t , θ , ϕ ) ‖ L ∞ ( D ) . 例 取 α = R = 1 且 u = ( x 2 + y 2 + z 2 − 1 ) 2 e x 2 + y 2 + z 2 ，显然u满足边值条件，将u代入(2.1)便可得到f。利用第5节中提出的算法，对于不同的M和N，我们在表1中给出了数值解与精确解的之间的误差 e ( u M h ( x , y , z ) , u ( x , y , z ) ) 。另外，为了更直观地表明算法的有效性，我们还在图1中分别给出数值解与精确解的图像，最后，为了验证该算法的有效性，我们呈现出了近似解的误差图在图2。 从表1可看出当 N ≥ 20 , M = 6 时，误差 e ( u M h ( x , y , z ) , u ( x , y , z ) ) 达到10 −6 左右的精度。同时，从图1和图2可看出我们算法是收敛的。 Table 1 N M = 2 M = 4 M = 6 M = 8 10 1.0289e−04 1.0289e−04 1.0278e−04 1.0019e−04 15 2.3553e−05 2.3553e−05 2.3553e−05 2.3553e−05 20 8.0489e−06 8.0489e−06 8.0489e−06 8.0489e−06 25 3.4570e−06 3.4570e−06 3.4570e−06 3.4570e−06 表1. 数值解与精确解的误差 e ( u M h ( x , y , z ) , u ( x , y , z ) ) 图1. 当 N = 20 , m = 12 时，精确解(左)和数值解(右)的图像分别如下所示 图2. 当 N = 10 , m = 6 (左)和 N = 25 , m = 10 (右)时，精确解和数值解的误差图"
"本文提出了一种有效的有限元法求解球域上的二阶问题，亮点在于通过引入球坐标变化和球谐函数展开，将问题转化为一系列等价的一维问题，从而克服有限元在球域上剖分的困难，使得原问题更加容易解决。同时，并对这一系列一维问题进行了相应的误差分析。最后，我们提出的算法可应用到球域上更复杂的问题。"
