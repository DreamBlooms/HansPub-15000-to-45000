"以76例乳腺肿瘤灰阶超声图像为研究对象，根据医学超声图像的特点及P-M模型的缺点，提出以图像的局部信息确定扩散门限的改进的P-M模型滤波方法，通过采用多种图像预处理算法及上述改进的P-M模型滤波法对76例乳腺肿瘤超声图像进行试验，实验结果显示，改进的P-M模型滤波方法可以更有效的滤除斑点噪声。 关键词 :医学超声图像P-M斑点噪声"
"乳腺肿瘤疾病是女性最常见的多发疾病之一，其中乳腺癌是发病率最高的女性恶性肿瘤疾病。全球每年约有50万的女性死于乳腺癌，新增的患病者超过120万[ 1 ] [ 2 ] 。 超声成像技术以其无损、实时成像，检查价格低廉等优势而被广泛应用于乳腺疾病诊断、实时监控及诊疗规划等方面。通过适当的图像预处理与分割方法，可以从医学超声图像中提取出目标区域的大小、形状和位置等信息，辅助医生进行更准确、有效的诊断和治疗。超声成像技术正确检出乳腺癌的敏感度已达到90% [ 3 ] 。 但由于医学超声成像系统受其周围环境和其成像机制的影响，超声医学图像在生成和传输的过程中，会受到各种噪声源的干扰，使得我们采集到的医学超声图像的图像质量较差。其中，由于所成像组织的不均匀性，超声成像的相干特性，导致医学超声图像中形成了一种特有的噪声，即斑点(Speckle)噪声。斑点噪声会模糊甚至掩盖医学超声图像中的一些重要的细节信息，导致医学超声图像信噪比低、图像质量较差，不易于进行半自动或自动识别和医学诊断。在临床应用上，限制了其在乳腺疾病诊断中的进一步发展和使用。而基于计算机、数字图像处理技术和计算机视觉技术等的医学图像处理技术，对医学影像设备采集到的医学影像进行处理和分析，能够辅助医生进行更准确、更有效的诊断和治疗，现在己经作为一门新兴的发展迅速的交叉科学领域受到人们越来越多的关注[ 4 ] -[ 6 ] 。"
"图像处理中，图像的多尺度描述引出了扩散这一概念。对原图像 ，如果以时间 作为方差的高斯核 去和原图像 卷积，我们就可以得到从低分辨率到高分辨率的图像的多尺度描述，如式(2.1.1)所示： (2.1.1) Hummel、Koenderink和Witkin等人认为这种多尺度描述是各向同性的热扩散方程或热传导，它在虽然可以抑制噪声，但是会导致图像边界等细节信息模糊。Malik和Perona 等人针对这一点，提出了各向异性扩散模型[ 7 ] (简称PM模型)： (2.1.2) 其中， 为引入的时间算子，抑制噪声过程与扩散持续的时间有关， 是散度算子， 是梯度算子， 表示幅度， 是扩散方程。 PM模型对图像进行噪声抑制时是求解初始值为原图像的非线性扩散方程，依据梯度幅值 的大小进行相应的平滑的。即在灰度梯度值通常较小的平坦区域实行较强的平滑，在灰度梯度值通常较大的图像的边界部分，为了保留图像的边界等细节信息，则实行较弱的平滑。Malik和Perona根据扩散系数和梯度值的关系，提出了如式(2.1.3)所示的扩散方程： (2.1.3) 式(2.1.3)中，把梯度阈值 视为扩散门限， 值愈大，扩散后的图像则愈平滑。 则视为边界检测器，若 远小于 ， 就约等于1，那么扩散增强；若 远大于 ， 就约等于0，那么扩散抑制。可见，扩散方程使得随着梯度幅值的变化扩散强度也跟着改变。 由于图像处理领域中的处理对象都是数字化的，Malik和Perona提出式(2.1.2)的离散表达式如式(2.1.4)所示。 (2.1.4) 其中，当前图像离散采样后为 ，像素 在二维网格中的坐标为 ，像素 的邻域空间为 ， 是指邻域空间 的大小， 通常情况下取值为4(图像边界除外)， 是常数，控制扩散总体强度。梯度值线性近似为： (2.1.5) 其中图1(a)是 ， ，迭代10次的滤波结果，图1(b)是 ， ，迭代20次的滤波结果，图1(c)是 ， ，迭代40次的滤波结果，图1(d)是 ， ，迭代10次的滤波结果，图1(e)是 ， ，迭代20次的滤波结果，图1(f)是 ， ，迭代40次的滤波结果。可以看出，P-M模型在滤波时，迭代次数越多，滤波后的图像会越模糊，并且扩散门限 的取值对滤波结果的影响很大，虽然已经有了几种估算梯度阈值k的方法，但是选取合适的 值也仍然是一个难点；此外，P-M模型滤波后的图像中容易出现阶梯或者集块现象，也称“块效应”，从数值上来说就是图像滤波处理后某些区域内灰度相同，这主要是由扩散方程是二阶的所引起的；另外，P-M模型对乳腺肿瘤超声图像的保持边缘效果也不是很理想，而且由于在边界处的扩散作用很小，图像边缘处的噪声抑制效果较差，整体上图像的失真程度比较大。  经典P-M模型的扩散方程中，扩散门限k值决定了扩散系数的特性，且常常取k值为一个常数。但是噪声图像中的梯度具有很大的不确定性，并且随着图像平滑程度的增加，相应的梯度会不断下降，所以k递减才能更有效的保持边缘。考虑到超声图像的成像特点，在成像过程中会产生拥有复杂统计特性的Speckle噪声的特点，考虑将医学超声图像中的Speckle噪声的统计特性综合到式(2.1.3)改进扩散方程。 (2.2.1) 其中， 是点 的散射密度， ，在式(2.2.1)中， 来反映医学超声图像的局部信息。由医学超声图像的成像特点可知，每个可分辨单元中散射元愈少，散射造成的Speckle噪声愈小，反之，散射元愈多，Speckle噪声愈大。由于 是 的递减函数，在式(2.2.1)所示的扩散方程下，在噪声小的区域，扩散减弱，在噪声大的区域，扩散则增强。 有： (2.2.2) 采用局部窗口的方差来估计 ，所以式(2.2.1)可以改写为： (2.2.3) 其中， 是指以 为中心像素，大小为m × n的局部窗口的方差， 是对数压缩范围。改进后的各向异性扩散滤波克服了扩散门限 不易选取的困难，同时也满PM模型要求在平坦区域平滑强度大，而在边界等细节信息较多的区域平滑强度小的原则。 按照扩散方程式(2.2.3)的(1)式，八邻域情况下： (2.2.4) 其中： (2.2.5) 乳腺肿瘤超声图像利用上述改进的PM模型滤波法处理后的图像结果如图2所示，图2(a)、图2(b) 和图2(c)是 ， ，窗口大小为 ，分别迭代10次、20次和40次的滤波结果，图2(d)、图2(e)和图2(f)是 ， ，窗口大小为 ，分别迭代10次、20次和40次的滤波结果。可以看出，改进的P-M模型在滤波时，由于改进后的扩散方程是一阶的，P-M模型滤波后的图像中容易出现阶梯或者集块现象，在一定程度上减弱了。由于 可以反映图像的局部信息且随着图像平滑程度的增加是递增的，比P-M模型能够更有效的保持边缘，随着迭代次数的增加，图像的模糊程度也比P-M模型弱。"
"采用自适应加权中值滤波法、双边滤波法、线性尺度滤波法、P-M模型、Catte_PM模型、改进P-M模型、非线性复数域扩散模型(CD模型)等各种预处理方法，针对76幅乳腺肿瘤超声图像做实验，将上述各种仿真结果以及经典的中值滤波、维纳滤波的仿真结果作比较，实验结果如图3。 其中，图3(a)为原始乳腺肿瘤超声图像，图3(b)为维纳滤波的结果，窗口大小为 ，图3(c)为中值滤波的结果，窗口大小为 ，图3(d)自适应加权中值滤波的结果，中心像素点权值为135，常数a取值为10，窗口大小为 ，图3(e)为采用改进的自适应加权中值滤波的结果，中心像素点权值为135，对数压缩范围为9，窗口大小为 ，图3(f)为采用线性尺度滤波的结果，窗口大小为 ，图3(g)为采 图4. PSNR曲线图 图5. MSE曲线图 型滤波法在乳腺肿瘤超声图像的滤波效果都较好，他们的滤波效果都优于传统的维纳滤波和中值滤波法。各向异性扩散滤波法由于引入异质扩散和迭代平滑概念，在处理各相邻像素时，同时考虑空间上的近邻关系和亮度上的相似性，是一种既可有效降低图像噪声又可保持图像边缘细节的滤波技术。"
"针对医学超声图像的特点和P-M模型的缺点，提出改进的P-M模型，通过对76例乳腺肿瘤超声图像进行试验，结果显示上述图像预处理方法，能够更有效的去除乳腺肿瘤超声图像的噪声外，减弱了P-M模型滤波后的图像中容易出现阶梯或者集块现象，比P-M模型能够更有效的保持边缘，随着迭代次数的增加，图像的模糊程度也比P-M模型弱。"
