"针对天地复杂背景下红外弱小目标的检测，提出了一种基于光谱成像融合top-hat变换、光谱识别的新方法。首先将改进的top-hat变换应用于红外弱小目标图像，将图像中与目标特性相似的像素进行增强，并去除云层背景对目标的干扰，得到若干疑似目标的增强结果，并结合阈值分割方法对增强结果进行筛选，剔除大部分不符合弱小红外目标特性的背景干扰点。然后采用光谱匹配算法，通过三种测度进行加权匹配，去除图像处理中对干扰物、噪声等因素的干扰，得到筛选过的目标识别结果，通过实验证明，本文提出的算法相较于传统弱小目标检测有更好的检测效果。 关键词 :光谱成像，目标识别，图像，算法 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"由于当前战争领域已经逐渐转变为局部化、小规模化、高技术化。尤其是空中武器的打击力量，在现代战争中已经变得愈发重要。因此，对于复杂环境小的小目标算法的研究，对提高预警、制导等诸多领域的准确率有很大帮助。 国际上定义小目标尺寸不超过9 * 9个像素，无形状、无纹理等特征信息。在复杂的背景和早生种，很难将小目标与背景杂波有效区分。传统图像算法使用hand-made feature，常用方法有SIFT、HOG、图像金字塔等 [ 1 ] [ 2 ] [ 3 ] [ 4 ] [ 5 ]。对于小目标的检测，传统图像算法有人工复杂度高，模型泛化性差等缺点，因此逐渐被深度学习模型取代。而这些深度学习算法需要庞大的数据库进行训练，也需要庞大的计算量。由于传统的基于红外图像的目标识别技术都是通过图像信号的变化，来确定目标位置，因此受器件、信号处理系统等方面产生的噪声影响较大，而引入光谱成像等于增加了一个维度，将能更为准确地判断出目标。因此本文通过光谱匹配的方式弥补传统小目标识别算法的不足，降低虚警率，并通过小目标识别的算法降低光谱识别的计算量，达到实时性、准确性高的要求。"
"弱小目标检测一般由背景抑制、提取潜在目标点、提取真实目标点三部分组成。远距离成像的红外图像中主要包含目标、背景以及噪声，可以用式(2-1)描述 [ 6 ] I ( m , n ) = T ( m , n ) + B ( m , n ) + N ( m , n ) (2-1) 式(2-1)中 I , T , B , N 分别表示图像总的信号，目标分量，背景分量以及噪声分量。对于红外背景，其在图像中的表现主要是大面积缓慢变化的连续部分，属于图像中的低频部分，其相邻的灰度间具有很强的相关性；对于噪声部分，在图像中表现为奇异点，但是由于噪声分布是随机的，它与背景及目标之间具有强烈的不相关性；而目标在图像中也表现为灰度奇异点，缺少轮廓及灰度信息，在单帧图像中唯一可利用的也只是目标微弱的强度信息 [ 7 ]。本文提供的算法主要是通过图1所示的几个步骤来实现的： 图1. 算法步骤图 红外弱小目标在图像的三维灰度分布上会呈峰值效应，因此红外弱小目标的检测任务即为将图像中具有峰值特性的位置从背景中完整的分割出来，并与非目标的噪声、干扰等进行区分，尽可能地降低虚警率。 1) 背景抑制 top-hat算法是一种形态学滤波算法，其算法主要有开运算和闭运算构成。在背景的预测阶段，取图像的开运算作用于红外图像来达到去除小目标的目的，使得红外图像中只剩下背景；在背景的去除阶段用原始图片减去预测的背景来提取出小目标。其算法原理如公式(2-2)所示 [ 8 ] [ 9 ]： H A T ( f ) = f − ( f ∘ g ) = f − ( f ⊖ g ) ⊕ g (2-2) 式中：g为结构元素；f代表原图像； ∘ 表示开运算； ⊖ 表示腐蚀运算； ⊕ 表示膨胀运算。所得的结果就是所预测的背景图像。形态学开运算通常用来消除较小的明亮细节，当用原图像减去开运算处理过的图像后，背景部分得到了很好的抑制，只剩下真实目标、干扰点、噪声点以及一些起伏的高频部分。 2) 阈值分割 [ 10 ] [ 11 ] [ 12 ] 图像进行背景抑制后，将剩下的部分进行阈值分割来提取目标点，阈值分割的主要目的是对目标区域进行分割，得到目标的中心位置和大小等信息。阈值分割的结果基于阈值的选取，阈值Th由式(2-3)给出 T h = E + λ σ (2-3) 式(2-3)中E为所有元素灰度的均值，而 σ 为所有元素灰度值的标准差， λ 为加权常系数。图像中灰度值大于Th的点就被选出作为潜在的目标点，记录下位置，输入到下一阶段。而加权常系数 λ 的取值可以由虚警概率给出，虚警概率P定义如式(2-4)所示： P = 1 − φ ( λ ) (2-4) 式中 φ 是标准正态分布值。可以通过确定虚警概率P后得到 λ 的值。而目标的检测概率 P D 是由 λ 和图像的信噪比SNR一起决定的： P D = 1 − φ ( λ − S N R ) (2-5) 在进行阈值分割后，对于图像上采集出的边缘以及小目标点等信号进行光谱匹配算法，用以得到最后的小目标提取结果。"
"1) 自适应变权重光谱相似性测度 采用上述模型获得的特征光谱能够最大程度地表征不同目标间的光谱特征差异，下一步需要利用光谱相似性测度进行基于特征光谱的弹道目标匹配识别。由于导弹尾焰气体辐射特性主要受高温高压条件下二氧化碳和水蒸气的影响，其在特定波段的谱线会表现出一定程度的相似性，尾焰气体组分越接近，这种相似性表现得越为明显，若只采用单一相似性测度判别会造成较大程度的误判，因此需要采用更加精确的相似性判别方法 [ 13 ] [ 14 ]。本文结合多个光谱相似性指标，提出一种能够根据匹配对象间的差异特点自动调整权重系数的新型光谱相似性测度，即SAVM。下面分别介绍SAVM所涉及的相似性指标，并给出其表达式 [ 15 ] [ 16 ]。 设 I i = ( I i 1 , I i 2 , ⋯ , I i n ) T 和 I j = ( I j 1 , I j 2 , ⋯ , I j n ) T 分别为目标红外辐射特征光谱数据和与之相匹配的特征光谱库的光谱数据， r i = ( r i 1 , r i 2 , ⋯ , r i n ) T 和 r j = ( r j 1 , r j 2 , ⋯ , r j n ) T 分别为相应谱线标准化后的响应值，n为特征光谱波段数 k = 1 , 2 , ⋯ , n ，r ik 为光谱I i 在第k个波段的响应值。 距离相似性测度(SBD) [ 17 ] 距离相似性测度可描述两光谱矢量间的几何距离，常用的表征二者光谱矢量差异的数学表达方法为欧氏距离函数 V S B D ( r i , r j ) = ∑ k = 1 N ( r i k − r j k ) 2 N 式中N为波段数， V S B D ( r i , r j ) 表示用于匹配的两光谱矢量的距离相似性测度值，取值范围为[0,1]，数值越小，距离相似程度越大。 线型相似性测度(SSD) 光谱曲线形状差异可由皮尔森相关系数表示，其数学表达式为 V S C M ( r i , r j ) = ∑ k = 1 N ( r i k − r i ¯ ) ( r j k − r j ¯ ) [ ∑ k = 1 N ( r i k − r i ¯ ) 2 ] 1 2 [ ∑ k = 1 N ( r j k − r j ¯ ) 2 ] 1 2 其取值在[−1,1]之间，其绝对值越大表示光谱线型越相似。光谱线型相似性测度表示为 V S S D ( r i , r j ) = [ 1 − V S C M ( r i , r j ) 2 ] 2 其取值范围为[0,1]，数值越小，线型相似程度越大。 信息量相似性测度(SID) 光谱信息量相似性测度是以信息论角度考虑的一种相似性测度，可通过光谱信息散度表征待匹配光谱间的信息量差异，SID表达式为 V S I D ( r i , r j ) = D ( r i ∥ r j ) + D ( r j ∥ r i ) 式中的两个值分别为r i 关于r j 的熵以及式中的两个值分别为r j 关于r i 的熵。 D ( r i ∥ r j ) = ∑ k = 1 N     p i k D k ( r i k ∥ r j k ) = ∑ k = 1 N     p i k ( I ( r i k ) − I ( r j k ) ) D ( r i ∥ r j ) = ∑ k = 1 N     p j k D k ( r j k ∥ r i k ) = ∑ k = 1 N     p j k ( I ( r j k ) − I ( r i k ) ) 式中 I ( r i k ) 为光谱在 r i 在第k个波段的自信息， I ( r j k ) 光谱在 r j 在第k个波段的自信息， I ( r i k ) = − log p i k ， p i k 为光谱 r i 在第k个波段的概率， p i k = r i k / ∑ n = 1 N r i n 。 为融合上述各相似性测度，提出的数学模型为 V = x V S B D + y V S S D + z V S I D 该模型可以将光谱的距离相似性测度、线型相似性测度和信息量相似性测度按照一定权重进行融合，形成较为全面的相似性测度函数。式中x，y，z分别为上述测度相应的自适应权重，权重系数由各测度的变异系数求得，计算公式为 { T S B D x = T S S D y = T S I D z x + y + z = 1 式中 T S B D , T S S D , T S I D 分别为相应各测度在全波段范围内的变异系数，表示两光谱数据间的变异程度，采用标准差与平均数的比值计算，可求得 x , y , z 。结合尾焰辐射模型的尾焰特征光谱可以实现对尾焰目标的识别。"
"本文通过headwall光谱相机对空中背景的小目标进行成像，包括云团、地空背景等信息。通过MATLAB以及ENVI对数据进行处理。 如图2显示了对图像进行背景抑制以及阈值分割后的图像，可以看出在背景抑制后，已明显将大部分灰度较低的信息去除，并在阈值分割之后仅留下了变化较大的边缘部分以及可能的小目标点。 图2. 图像预处理结果 通过对纯净背景下的目标进行的光谱提取得到目标的光谱图如图3。 图3. 小目标的特征光谱 将该光谱用作特征光谱，结合光谱相机拍照图片可以得到小目标的识别结果如图4。 在特征光谱提取后，对目标图像进行光谱相似度的测试，通过前文提到的四种测度进行匹配。为验证本文基于光谱成像的小目标识别算法有效，与现有仅通过图像处理的提取算法对比，主要是阈值分割检测法的结果进行对比，可以明显看出对于目标的提取数量有显著区别，即能够较好地排除噪声即干扰物等的影响。 将该光谱用作特征光谱，结合光谱相机拍照图片可以得到小目标的识别结果如图4。 图4. 小目标提取结果图 通过两种提取方法的比较，仅从数量上就能看出光谱成像的识别方法。 本文算法对比传统小目标提取算法的结果，即单通过图像处理的角度提取小目标,消除了噪声和背景等因素的干扰，在提取的精度上有了明显的提升。"
"本文提出了基于光谱成像的小目标检测算法，该算法通过top-hat算法对空域图像进行初步处理，大致划分出可能的小目标区域，节省后续光谱匹配算法的计算量，利用光谱的特性对目标进行识别，达到时效性和准确性。并且通过实验结果表明，该算法对复杂背景下的小目标识别效果显著。"
