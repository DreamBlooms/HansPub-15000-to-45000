"ShakeMap系统由美国地质调查局开发，能够在震后自动、快速地生成地震动峰值(PGA/PGV)等值图和仪器烈度分布图等产品，通过这些产品人们可以很直观地了解到哪里可能遭受的震动最强烈、破坏最严重，这为震后应急救援策略的制定和应急救援工作的展开提供科学依据和一定的参考意见。与此同时，丰富多样的ShakeMap产品还可以通过网络、移动电话和电视媒体等多种途径进行发布传播，因而公众可以在震后迅速地获得最新的地震信息，这对于维持社会稳定，避免因地震引发的慌乱，也将起到重要的作用。 ShakeMap是一套比较成熟的烈度速报系统，在美国甚至全球范围内有着广泛的应用，如在美国加州、内达华州、犹他州、夏威夷、阿拉斯加、新马德里和美国国家地震信息中心(NEIC)等都在使用ShakeMap系统，国际上如意大利等也在使用ShakeMap系统，而国内也有一些科研院所或机构在直接应用ShakeMap或进行二次开发。目前，国内相关研究不断发展成熟、理论水平也随之得到提高，地震观测台网密度不断加大，这些都为国内引进和应用ShakeMap系统打下比较坚实的基础。如何将ShakeMap系统与国内实际情况相结合，实现ShakeMap系统的区域化应用、保证处理结果真实可靠和产品内容丰富易懂等正是本文所要解决的问题。"
"ShakeMap系统的研究开始于美国1994年北岭地震之后，最初由David Wald构想。1996年加州地震台网(Wald and others, 1997)和新安装的TerraScope台网(Kanamori and others, 1991) [ 1 ] 的结合，造就了足够数量的实时强震观测台站，David Wald和Vincent Quitoriano也因此得以在同年设计和实现ShakeMap系统。基于ShakeMap系统的实用性，ShakeMap系统随着TriNet系统的发展、增强和扩展也不断演化。在南加州的成功应用，使得美国政府在不遗余力的增强ShakeMap系统软件的同时也在美国国内其它州推广这一系统。Bruce Wald (Caltech，现为USGS)和Craig Scrivner (前CDMG，加州矿产和地质部)对软件进行了重新设计。后续软件的开发作为ANSS的一部分在Worden和Quitoriano指导下进行 [ 2 ] [ 3 ] 。之后，ShakeMap系统的应用范围从美国国内其它地震活跃的州不断扩大到全球范围内的许多国家和地区。现在ShakeMap系统主要由USGS负责运营，可以处理几乎全球范围内的地震。 ShakeMap系统主要由perl语言编写，同时依赖于第三方软件，比如：使用GMT(Generic Mapping Tools，Will Smith) [ 4 ] [ 5 ] [ 6 ] [ 7 ] [ 8 ] ，一款通用制图工具进行部分计算和绘图使用MySQL数据库存储地震信息和一些运行参数，使用Subversion管理系统的各个版本，使用zip对产品进行压缩便于提供ftp下载等。 ShakeMap系统的产品非常丰富，主要包括：峰值加速度等值线图，峰值速度等值线图和仪器烈度分布图等图形产品；GIS产品可用于灾害评估，KML，KMZ文件配合可加载与GoogleEarth的强大功能，方便人们直观地了解到地震的破坏情况；ShakeMap系统的产品发布方式也比较灵活多样，产品可以通过网页、电视媒体、电子邮件和ftp站点等方式展现给公众。 ShakeMap系统的主要用途包括：1) 应急救援与损失评估2) 公众信息与教育3) 地震工程与地震研究4) 地震模拟演练。  ShakeMap系统由一系列功能模块组成，如数据提取模块、计算模块、绘图模块、网页生成模块、打印模块和邮件通知模块等，模块之间相互调用完成系统对地震事件的处理与发布。图1为ShakeMap系统的处理流程图。 表1为系统的主要模块及功能说明。当地震台网记录到一个地震事件时，在把地震三要素和台站等数据传给ShakeMap的同时会触发ShakeMap系统，ShakeMap的retrieve程序根据台站传来的数据生成系统运行的event.xml和*_dat.xml等文件(输入)，然后经过grind的计算处理后，交给mapping绘图，然后由genex生成相关的网页产品(处理)，通过transfer传送到相关web和ftp站点供网页显示与下载，最后由shakemail发送邮件通知和print进行打印(输出) (图2)。"
"福建地震观测台网在“十一五”之前由41个测震台站和1个测震台网中心组成，其中41个测震台 图1. ShakeMap系统基本流程图 图2. ShakeMap模块调用流程 Table 1 模块名称 模块功能 shake 全局模块，控制模块的调用顺序 retrieve 从台网数据库中提取地震三要素和台站数据等信息并生成相应输入文件 pending 发送一个新首页到网站，说明正在处理一个事件 grind 计算模块(插值、场地校正、烈度计算等) tag 为ShakeMap系统数据库指定该事件是什么类型的事件(普通、主震、历史地震、不可见或者余震等) mapping 读取grind的输出网格生成地震动和烈度的PS图像，等值线文件以及绘制图像所需的信息。 genex 使用grind和mapping的输出创建JPEG图像，绘制网页，生成GIS和其他文件供web展示和FTP下载。 shakemail 给不同的用户发送不同的邮件通知。 print 打印模块，供打印输出。 transfer 将genex的输出传送到web和ftp站点。 setversion 控制事件的版本信息和要保存的版本信息 cancel 取消shake模块所调用模块造成的影响 unlock 时间被锁，ShakeMap程序无法执行时，该程序可以解锁 表1. ShakeMap的模块及其功能 站分别为3个国家测震台、30个区域测震台和8个水库台网测震台。“十一五”期间，增加建设 84个地震台站，目前整个台网中心共有强震和测震台站125个。其中31台配置速度型地震仪，40台配置加速度型地震仪，54台同时配置速度型地震仪与加速度型地震仪，且台站全部为2M专线实时传输。建成后的新台网使得福建全省每个县至少有一个地震观测台站，台站间距在30公里左右(图3)，监测能力大大提高。  由于台网建设、数据传输方式、数据采集和管理方式不同，ShakeMap系统原有数据接收及地震事件监测等模块在福建省数字台网中无法正常运行，需要编写相应模块保证正常的数据接收；此外，ShakeMap系统使用xml文件及与NetCDF兼容的数据格式文件等进行数据的处理，因此需要对现有数据进行转换才能为ShakeMap系统所用。本文给出的应用方案如图4所示。关于这个图的说明也没有，让人很难理解，建议进行简单论述。首先，系统监测模块在监测到地震事件后，若满足处理要求将自动将地震信息 图3. 福建地震监测台网 图4. 区域应用方案 和数据进行保存，然后数据接收转换模块会将接受到的数据转换为ShakeMap要求的格式，并触发改造后的ShakeMap运行，绘图图片生成网页并进行产品发布。由于地震动衰减和烈度计算等方法具有较强的区域性，因此本文使用国内前人在此方面的研究成果对ShakeMap系统原有模块进行替换，期望获得反映出地震动真实情况的产品。   本文将ShakeMap系统应用于福建地区时，采用了更加符合国内实情的地震动衰减关系(见表2)替换系统原有地震动衰减。 对于0~4.0级范围内的地震，本文采用金星等人对福建地区中小震所统计的衰减关系(金星等，2008) [ 9 ] ，其形式如(1)所示： log 10 Y = B 1 + B 2 × ( R + 10 ) + B 3 × R + B 5 × M (1) 其中，Y是加速度峰值PGA(gal)或速度峰值PGV (cm/s)；R是震中距，M为震级。 本文将该衰减关系的使用范围定义为：0~4.0级； B1~B5(水平分量)的值如下表所示： 对震级范围为4.1 < M ≤ 6.4的衰减关系，本文采用康蓝池等人(康兰池，2010)对于四川地区基岩场地地震动峰值统计得到的衰减规律 [ 10 ] 。之所以选用这个衰减关系一方面是由于福建地区没有大震记录，另一方面是由于它是国内首个提出的震级在该范围内的衰减关系，比国外衰减关系能较好地反映出真实的地震动情况。其衰减关系式如(2)所示： log 10 Y = B 1 + B 2 × M + ( B 3 + B 5 × M ) × log ( R + 10 ) (2) 其中，Y是PGA(gal)或PGV(cm/s)；R是震中距，M为震级。 本文在实际使用时将其适用范围定义为：4.1~6.4级； 关系式中 B1~B5(水平分量)的值如下表所示： 同样，由于福建地区没有大震衰减关系，而国内相关方面的研究甚少，因此在实际应用中，大震方面本文仍然使用ShakeMap系统自有的用于大震的衰减关系Hazus PGV。该衰减关系是利用给定的震级和到震中一定距离得到PGA/PGV/SA，该衰减模型来自于Boore and others (1997)等人的研究 [ 11 ] ，其关系式如(3)式所示： Table 2 衰减关系 适用震级范围 Fujian_Small (金星等，2008) 0 < M ≤ 4.0 Fujian_Mediate (康兰池等，2010) 4.1 < M ≤ 6.4 Hazus PGV M > 6.4 表2. 应用于福建地区的地震动衰减关系 ln ( PGA , PSA ) = B 1 + B 2 ( M − 6 ) + B 3 ( M − 6 ) 2 − B 5 ln ( R ) − B v × ln ( V s / V a ) (3) 其中， R = R j b 2 + h 2 ，PGV从使用Newmark-Hall, 1982公式计算的1Hz PSA计算而来，R是“Joner-Boore”距离。 B1~B5、B v 和V a 等参数的值如下表所示：  由于福建地区钻孔资料较少，故场地校正仍然使用ShakeMap系统的场地校正方法，即用地形高程数据(SRTM)求出该区域的平均坡度，然后根据Wald等人统计的地形坡度、场地分类和地表以下30米的平均剪切波速之间的关系式可以估计得到福建区域的Vs30分布图(图5)，最后利用Borcherdt (1994)的方法即可求出PGA, PGV的场地放大因子，进而可以对PGA、PGV进行初步的场地校正，获取反映出地震动的真实情况的产品 [ 12 ] [ 13 ] [ 14 ] [ 15 ] 。  为了更清晰地反映出地震动分布情况，Wald et al. (1999)提出由仪器观测得到的地震动记录计算出地面烈度的方法，即ShakeMap仪器烈度。Wald et al. (1999)又挑出加州所发生的8次比较重大的地震，由当地地震网记录的强震记录结合各地地震大量的实际观测以及网络志愿值反馈的烈度调查，给出了PGA、PGV等地震动峰值和修正的麦卡利烈度(Modified Mercalli Intensity, MMI)之间的回归关系式，并给出仪器烈度的计算公式 [ 16 ] ，如下所示： I m m = { 3.66 log ( PGA ) − 1.66       ( sigma = 1.08 ) 3.47 log ( PGV ) + 2.35       ( sigma = 0.98 ) 2.20 log ( PGA ) + 1.00 2.10 log ( PGV ) + 3.40 (4) 通过比较加州8次重大地震的仪器烈度图(Wald and others，1999)，Wald等人发现计算观测的I mm ，当I mm < VII时与PGA的对应关系较好，当I mm > VII时PGV与其对应关系较好。在实际使用中，首先使用(4)式前两式进行计算，若4a) PGA计算的I mm 大于VII，则使用4b) PGV进行烈度计算；若4a)计算的 图5. 福建地区Vs30分布图 I mm 在V和VII之间，则对PGA和PGV计算的烈度进行加权 [ 2 ] ；ShakeMap系统使用的仪器烈度表如图6所示，根据不同的颜色分段和字体粗细程度来表示所使用的计算公式和仪器烈度大小。 考虑到仪器烈度计算方法与国内的区别，本文在实际应用中采用了地震仪器烈度表(DB35/T 1308~2012)中的仪器烈度算法 [ 17 ] 。地震仪器烈度表如图7所示，计算公式为： I I = 2.71 × log 10 ( A 0.5 ) + 2.39 (5) I为计算的仪器烈度，A 0.5 为有效峰值加速度，即三分向地震动加速度时程中持续时间大于等于0.5秒的幅值。 由于ShakeMap在实际处理过程中仅使用两水平分量中的最大值，因此本文在对系统进行改造时，使用了上述研究报告中给出的统计的水平分向和A 0.5 的统计关系式如式(6)和(7)所示。作者根据关系式先将PGA和PGV分别转换成各自对应的有效峰值加速度A 0.5 ，然后再带入(5)式计算仪器烈度。 log 10 ( PGA ) = 0.85 × log 10 ( A 0.5 ) + 0.46 ± 0.27 (6) log 10 ( PGV ) = 1.09 × log 10 ( A 0.5 ) − 0.81 ± 0.16 (7) 在实际应用中，对于M < 6.5级地震，本文采用(5)和(6)计算仪器烈度；对于M > 6.5级，本文采用(5)和(7)式计算仪器烈度。 图6. ShakeMap仪器烈度表 图7. 地震仪器烈度表(DB35/T 1308~2012) 最后，由于ShakeMap系统产品内容采用英文表述，不利于国内大众对于地震信息的获取和理解，本文对ShakeMap产出的产品，包括地震动峰值(PGA、PGV等)等值线图、仪器烈度分布图、网页和邮件通知等进行了本地化工作，这对于公众获取地震信息和地震信息的传播起着非常重要的作用。"
"本文对地震动衰减和仪器烈度计算进行修改后，将“改造”后的ShakeMap系统成功编译和运行在测试服务器上。为验证上述改造的可行性以及计算结果的可靠性，作者对2004年以来福建地区4.0级以上地震和台湾地区部分地震进行了处理。本文选取近年来福建地区较大的福建省莆田市仙游县M4.8级地震为例，对初步的应用成果进行展示。仙游地震的三要素信息及改造后的系统处理产品如表3所示。图8~图10分别为此次地震的仪器烈度分布图，本地化的网页显示，本地化的地震邮件通知。 从图7可以看出，震中区仪器烈度石苍乡部分区域为6度，钟山镇、游洋镇等地部分区域为5度，常太镇等地为4度，该处理结果与震后宏观烈度调查结果基本是吻合的 [ 18 ] 。另外，ShakeMap系统的本地化工作在保留原有产品信息的同时，使产品更加清晰直观。"
"通过对ShakeMap系统的研究，将前人研究的地震动衰减关系、场地校正和仪器烈度计算等关键算法应用于ShakeMap系统，并实现了ShakeMap产品内容的本地化，完成了ShakeMap系统在福建地区的改造和应用。改造后的地震实例处理结果也较为合理，表明ShakeMap系统在国内地区的改造和应用是可行的。 另外，作者认为还有以下问题亟待解决： 1) 4.0级以上地震动衰减关系，本文采用了康兰池等人对四川地区基岩台站统计的地震动峰值关系以及ShakeMap自带的Hazus衰减关系，由于地震动衰减具有较强的区域性，因此作者认为采用此类衰减关系计算的仪器烈度与真实地震动存在一定的误差。 2) 在计算仪器烈度时，为了和ShakeMap系统保持一致，采用了水平分向PGA, PGV的最大值，利用PGA, PGV和A0.5之间的统计关系进行转换，进而求取仪器烈度，这样的转换可能会对结果造成一定的影响。 图8. 莆田仙游M4.8仪器烈度分布图 图9. 本地化的网页 Table 3 地震名称 震级 时间 深度(km) 产出产品 发布形式 福建省莆田市仙游县 M4.8 2013/09/04 10 PGA, PGV, MMI分布图 GIS, overlay图等 Web, E-mail等 表3. 顺昌地震相关信息 图10. 本地化的地震事件邮件通知"
