"本文将序贯概率比检验法应用到管道音波泄漏监测系统中，针对微弱泄漏信号特征，首先采用Kalman滤波法对监测数据进行动态滤波预处理；其次，在音波定位法的基础上运用序贯概率比检验法，判断边界阈值，提高了泄漏判断的准确性。实验结果表明了该方法的有效性和适用性。 关键词 :序贯概率比检验法，卡尔曼滤波器，音波法，微小泄漏监测 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"在石油、天然气输送过程中，由于管道运输方便、快捷，该方式成为石油石化输送的主要方式 [ 1 ]。在输送过程中，由于输送介质的可燃性和污染性，如果管道一旦发生泄漏 [ 2 ]，会带来极大的环境污染和人身安全，也有可能发生爆炸和引起火灾，为此，我们开发稳定、实时的泄漏监测系统，对输送油气进行实时监测具有重要的意义 [ 3 ] [ 4 ]。"
"当管道内输送介质发生泄漏时，由于管道内外的压力差，使得泄漏的流体在通过漏点到达管道外部时形成涡流 [ 5 ] [ 6 ]，该涡流使局部管道产生了振荡变化的压力或声波，同时，泄漏到管道外部的流体与泥土、空气等物质撞击、摩擦，会产生不同频率的振动声波 [ 7 ]。这些振动源产生的声波在管壁、管道内部输送介质、管道周围介质(如土壤)等媒介中快速传播，声波传播返回至泄漏点，从而在管道内部建立声场。泄漏点产生的声场就构成信号源，声波在流体介质中主要以平面波的纵波形式传播，传播速度与管道材质、规格、输送的介质有关。通过分析管道内部的声波，可以判断出管道是否发生泄漏。 泄漏声波是压力状态下的流体和多种介质相互作用的结果，频域范围宽。泄漏声波通常会经历产生、稳定两个阶段，不同阶段其频率、幅度特性不同。由于产生阶段一般持续时间较短，对于本检测方案而言，关注泄漏声波稳定阶段的特征。由于泄漏声波的频率特性与管道输送介质的压力、流速、泄漏处孔径 大小、形状等众多因素相关，实际中泄漏情况多种多样，因此泄漏频率特性各异。资料显示输水管道泄漏频率为16 Hz~20 kHz [ 8 ]，泄漏点附近低频分量幅度更大，而输油管道泄漏的音频特性研究较少。 泄漏声波的强度随着在介质中的传播逐渐衰减，不同频率的声波衰减不同，高频信号衰减最快，因此在泄漏点处声波功率最大。泄漏点处声波强度与压差变化、泄漏口形状、流速、泄漏率等因素相关 [ 9 ] [ 10 ] [ 11 ]。通常管道内部介质压力越大、泄漏口成扩张形状、流速快、泄漏率较大的泄漏点，声波强度越大。同一条管道中介质压力、管道材质等工况相同或相近，泄漏点的声功率与流速的n (n > 1)次方近似正比关系。通过泄漏声音信号幅度强弱，可以大致判断出泄漏量的大小。"
"传统音波泄漏监测方法大多是基于信号处理算法，该方法对于小泄漏及缓变信号检测比较困难，而基于序贯概率的音波泄漏监测方法很好的解决了这一问题。利用序贯概率比检验法判断泄漏时，需要对采集信号进行一定的预处理。采用卡尔曼滤波器对数据进行滤波可得到渐进高斯分布的数据，并且卡尔曼滤波器的递推形式适于在线应用。针对管道系统信号的特点，可以建立如下的状态方程、测量方程及残差方程 [ 12 ]： x t + 1 = x t + ω t z t = x t + v t e t = z t − x t (1) 式中 ω t 为模型噪声向量， v t 为测量噪声，均是零均值高斯白噪声，且互不相关； x t 为t时刻的状态向量； z t 为t时刻的观测向量，最终得到残差 e t 符合正态分布： P ( e t ) = 1 2 π S t exp ( − e t 2 S t − 1 / 2 ) (2) 式中 S t 为递推过程中得到的参量。随着采集点数的增多 S t 趋近于常数。因此在实际的应用中可以用一个固定值的方差来代替 S t ，将得到的概率密度用于序贯检验中判断泄漏。 经过卡曼滤波预处理之后，音波信号的观测序列 x 1 , x 2 , ⋯ , x m 应该满足均值为 μ ，方差为 σ 2 的正态分布。假定管道运行正常时该序列满足原假设 H 0 : μ = μ 0 ；管道泄漏时满足备择假设： H 1 : μ = μ 0 + Δ μ 其中 Δ μ > 0 表示压力上升； Δ μ < 0 表示压力下降。同时假定 α 和 β 分别表示犯第一和第二类错误的概率，即允许的误报警率和漏报警率。在原假设 H 0 : μ = μ 0 成立的条件下和备择假设 H 1 : μ = μ 0 + Δ μ 成立的条件下，随机序列的联合概率密度为 [ 13 ]： P 0 m = 1 ( σ 2 π ) m exp ( − 1 2 σ 2 ∑ i = 1 m ( x i − μ 0 ) 2 ) (3) P 1 m = 1 ( σ 2 π ) m exp ( − 1 2 σ 2 ∑ i = 1 m ( x i − μ 0 − Δ μ ) 2 ) (4) 如果序贯概率比值满足不等式： P 1 m P 0 m ≤ β 1 − α (5) 那么，接受原假设H 0 ，判断管道运行正常。如果比值满足不等式： P 1 m P 0 m > 1 − β α (6) 那么，拒绝原假设H 0 ，判断管道上有泄漏发生。如果比值满足不等式： β 1 − α < P 1 m P 0 m < 1 − β α (7) 则无法断定是接受还是拒绝原假设，必须继续观察，直到比值满足前两种情况为止。定义检验参数 λ ( n ) = Δ μ σ 2 ∑ i = 1 n ( x i − μ 0 − Δ μ 2 ) ，则式变为(7) ln β 1 − α < λ ( n ) < ln 1 − β α (8) 进一步推导可以得到检验参数的递推公式： λ ( n + 1 ) = λ ( n ) + Δ μ σ 2 ( x n + 1 − μ 0 − Δ μ 2 ) (9) 实际应用中，首先对管道首站音波信号 p 0 ( t ) 与末站音波信号 p 1 ( t ) 经过卡尔曼滤波，使其具有准高斯分布特征，分别对这两个观测序列作序贯概率比检验计算 λ ( n ) 。序贯概率比检验参数 首次达到上边界时，0到上边界这段波形的最低点定义为泄漏发生时刻。 检验参数 λ ( n ) 初始值取为零，当检验参数超过下边界时，即可做出判断：未发生泄漏，然后检验参数的值重新从零开始计算；当检验参数超出上边界时，做出泄漏的判断，并计算泄漏时刻，检验参数 λ ( n ) 同样重新从零开始计算。只有当检验参数未超过上下边界时无法做出是否泄漏的判断，继续计算检验参数 λ ( n ) ，一旦其超出边界，则做出判断，并将检验参数做归零处理，重新开始计算。只有两个序列(首、末站信号)都做出泄漏的判断而且经分析得到的泄漏点位置合理(并非站内操作)才认为管道发生了泄漏。通过上述序贯概率法判断泄漏发生的时刻并计算泄漏点到首、末两站的时间差 Δ t ，然后代入音波定位公式： X = L + a Δ t 2 (10) 式中，X泄漏点距离管道始端测量点间的距离，L为管道的总长度。"
"本实验数据来源某音波管道泄漏监测系统，该管道系统选取的试点应用段全长41.75 km，管径660 mm，运行压力5~6 Mpa，中间设有分输站1、分输站2、分输站3，共计三个阀室。站场系统建设如图1所示。 图1. 站场系统建设图  实验数据取来自于分输站1 (上游)和分输站2 (下游)的音波数据：图2、图3上下游音波信号受噪声干扰严重，影响对泄漏信号突变拐点的准确定位，尤其对于微小泄漏来说，甚至会淹没在复杂工况产生的噪声中。 图4、图5显示了数据卡尔曼滤波后的估计值，在保持原音波信号不失真的同时可有效去除噪声干扰，得到更清晰的泄漏信号波形变化。图6、图7显示了对上、下游信号去除滤波后得到的残差序列。从中可以看出，残差序列满足渐进高斯分布。 图2. 上游音波 图3. 下游音波 图4. 上游数据Kalman滤波 图5. 下游数据Kalman滤波 图6. 上游数据残差序列(渐进高斯分布) 图7. 下游数据残差序列(渐进高斯分布) 对上下游渐进高斯分布数据计算序贯概率比检验参数 λ ( n ) 如图8、图9所示。 图8. 上游音波数据序贯概率比检验参数 图9. 下游音波数据序贯概率比检验参数 当未发生泄漏时，检验参数无明显变化，判断系统正常；当发生泄漏时，检验参数转为上升的趋势。当上下游音波数据序贯概率比检验参数均超过上限时，则判断泄漏发生，同时将两者的时间差作为定位的依据。如图8所示，上游序列 在60,000点时急速上升，此时对应上游泄漏(图)拐点；如图9所示，下游序列 在20000点时急速上升，此时对应下游泄漏(图)拐点；设计上、下游管道长度11.92 km，音波速度380 m/s，根据定位公式计算得实际泄漏点与入口处的距离为20米。"
"通过音波定位中的时间差来定位泄漏点，序贯概率法可以检测大于预设均值偏差的泄漏。根据现场实验，泄漏量小于总流量的1%时，序贯法报警时间较短，误报警较少；均值偏差越小，检测灵敏度越高，但检测所需时间会越长。实际情况下，管线配有高精度仪表并且泄漏发生时间大多较长，尤其适合对于微小泄漏的检测。"
