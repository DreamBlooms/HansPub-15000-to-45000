"经验单位线法是洪水模拟与预报中推求地面净雨汇流过程常用的方法之一。以丰乐河流域为研究区域，基于该流域1984年至2013年的降雨、径流和蒸发资料，选取了30场洪水，采用三水源新安江模型进行次洪的产流与分水源计算，以地面径流与壤中流作为直接径流，利用经验单位线法和线性水库法分别模拟直接径流和地下径流的汇流过程，通过合成直接径流与地下径流，构建了丰乐河流域洪水模拟模型。以新安江模型计算的14场率定洪水的径流深与实测径流深平均误差最小化为目标，采用遗传算法确定了新安江模型的参数。采用分析与试错相结合的方法推求了直接径流的汇流经验单位线。采用大洪水推求的单位线(980915场次)对30场洪水进行模拟，得14场率定洪水的径流深平均相对误差为7%、平均洪峰误差为8%、平均峰现误差为2.57 h，合格率分别为93%、93%和86%，平均确定性系数为0.91；16场检验洪水的径流深、洪峰和峰现的误差分别为8%、9%和3.38 h，合格率分别为88%、94%和88%，平均确定性系数为0.89。表明基于新安江模型与经验单位线所构建的模型可用于该流域的洪水预报，计算精度较高。采用基于大洪水推求的单位线进行中小洪水汇流计算时的精度较低，反之亦然。推求了相应于大、中小洪水的经验单位线对大、中小洪水分别进行汇流计算，可获得较高的模拟精度。建议在该流域根据形成次洪的降水量的大小，采用不同的经验单位线对洪水进行预报，以提高预报精度。 关键词 :洪水预报，经验单位线，新安江模型，遗传算法，丰乐河"
"新安江模型是洪水预报中常用的预报模型之一，其产流与分水源模块方法成熟，精度高 [ 1 ] 。新安江模型汇流模块因为流域的汇流存在较强非线性，且模块仍然是对流域的高度概化，尚难以直接建立模型的汇流参数与流域的自然地理特征参数间的物理关系，目前主要是通过建立两者之间的经验统计关系，以期待该关系在无资料地区的推广。经验单位线法属于黑箱模型，是在实际汇流计算中常用的简便易行且具有一定物理意义的方法 [ 2 ] 。使用经验单位线法进行汇流计算将简化汇流计算的步骤，降低预报模型使用难度，并达到较高精度，以满足基层水文预报工作者的工作需要。丰乐河流域地处江淮之间的中部，东临巢湖，西傍大别山，流经合肥市的肥西县、六安市的舒城县和金安区3个县区70余个乡镇，是巢湖的主要支流之一。其洪水预报的准确性将对流域内居民的人身财产安全和巢湖的防洪调度产生重要影响。该流域洪水预报所使用的经验单位线是上世纪90年代时推求的，由于20多年来流域水文条件的改变，该条单位线已难以满足预报精度要求。现收集到流域内1984年至2013年的时段(流域内7个雨量站测量的时段雨量步长均为6小时)降雨量、径流量和每日的蒸发量资料，用来推求新的经验单位线。共选取30场洪水，其中14场作为率定样本，16场作为检验样本。 目前单位线的研究集中于对纳西瞬时单位线 [ 3 ] 、地貌瞬时单位线 [ 4 ] 和分布式单位线 [ 5 ] 参数的推求 [ 6 ] [ 7 ] 、敏感性分析 [ 8 ] 和汇流路径计算 [ 9 ] 等方面，侧重于建立单位线的参数与流域的自然地理特征之间的关系，便于在无资料地区进行洪水汇流计算。在径流资料较丰富的流域，根据流域出口断面的流量过程和(通过产流模型)推求的净雨过程，直接推求时段单位线，是一种简便且具有一定物理意义的汇流计算方法。基于14场率定洪水资料，采用三水源新安江模型进行流域产流计算和水源划分，以计算的径流深和实测径流深的平均绝对误差最小化为目标，采用遗传算法确定模型的参数；并将地表径流和壤中流作为直接径流，采用经验单位线法将其汇流至流域出口，地下径流采用线性水库模拟，通过叠加直接径流的汇流过程和线性水库的出流，得流域出口断面的流量过程，构建丰乐河流域洪水预报模型，并对模型的模拟精度进行评定。"
"基于DEM数据 [ 10 ] (来源于由美国太空总署(NASA)和国防部国家测绘局(NIMA)联合测量的SRTM90m分辨率的原始高程数据，下载地址：http://srtm.csi.cgiar.org/SELECTION/inputCoord.asp)，采用ArcGIS10.0软件水文模块 [ 11 ] 提取出所需流域面积边界图，并根据流域内雨量站点位置使用泰森多边形法分割区域，得计算流域面雨量时的各雨量站权重，流域平均雨量计算如下： (1) 式中：d i 为第i个雨量站权重；P i 为流域内第i个雨量站雨量，mm；n为流域雨量站个数。  使用三水源新安江模型 [ 12 ] 进行流域的产流与分水源计算，以新安江模型模拟计算的洪水径流深和实测径流深的平均绝对误差最小化为目标，采用遗传算法率定模型参数 [ 13 ] ： (2) 式中：f为率定洪水径流深的平均绝对误差，mm；n为率定洪水场次；R j 为次洪实测径流深，mm； 为洪水计算径流深，mm。   实测流量的基流分割直接影响到径流量与洪峰流量的计算精度。通常采用目估法、直线切割法和退水曲线法 [ 14 ] 等方法进行基流的分割。根据不同的概念，对于基流的组成有很多种解释。这里采用线性水库法对基流进行模拟： (3) 式中：Q g ,t 为t时刻基流，m 3 /s；C Gd 为地下水时段消退系数，与日消退系数C G 之间有 ；R g ,t 为t时刻前的时段地下产流，mm；U为转换系数，U = F/(3.6Δt)(F为流域面积，km 2 ；Δt为单位线时段长，h)；n为地面径流过程历时T Q ；初始基流量Q g ,1 一般以长时间无降水后的实测初始流量表示。  模型使用经验单位线法计算直接径流至流域出口的流量过程，而推求流域经验单位线的常用方法有试错法与分析法 [ 15 ] ，试错法通过不断调整初始单位线纵坐标的值来提高流量过程的确定性系最后得到流域经验单位线，但单位线的纵坐标初始值较难确定。分析法虽可通过公式快速推求出单位线纵坐标，但纵坐标值往往会出现负值和锯齿状的情况，不能直接使用 [ 16 ] 。为更为有效地推求出流域经验单位线，可结合两种方法的优点，即采用分析法计算出单位线初值，再采用经验试错法调整纵坐标提高确定性系数，最终得到流域经验单位线。 选取率定期内一场降雨时段少(如2或3个时段)、降雨量大并且降雨空间分布均匀的洪水，利用以下公式推算此场洪水的单位线纵坐标： (4) 式中：q t 为时段单位线纵坐标，m 3 /s；Q t 为实测流量，m 3 /s；R t 为实测径流深，mm。 利用式(4)求出的单位线纵坐标作为流域经验单位线的初值。经验单位线时段长T u 为地面径流过程历时T Q 与净雨历时T R 的差值加上一个时段。随后通过不断修改单位线纵坐标值，使率定样本的平均确定性系数尽可能提高，平均确定性系数为： (5) 式中： 为第i场洪水在t时刻的计算流量，m 3 /s；Q t ,i 为第i场洪水在t时刻的实测流量，m 3 /s； 为第i场洪水实测流量均值，m 3 /s；T Q ,i 为第i场洪水地面径流过程历时，Δt；n为率定洪水场次数。 因采用的时段单位线的净雨深为10 mm，所求单位线纵坐标值须利用下式修正： (6) 式中： 为修正前单位线纵坐标值，m 3 /s。T u 为经验单位线的总时长，Δt。"
"丰乐河古称桃溪，清代称后河，又名界河，是巢湖较大的一条支流，也是舒城、肥西两县交界的河道。丰乐河流域跨六安、合肥两市，河道全长117.5 km，流域面积2124 km 2 ，其中山区350 km 2 ，占全流域面积16.48%；丘陵区面积为1430 km 2 ，占全流域面积的67.32%；平原圩区面积为344 km 2 ，占全流域面积的16.20%。河道在肥西县三河镇下游与杭埠河汇合后注入巢湖。本文所选取的桃溪水文站位于六安市舒城县桃溪镇，地处丰乐河中段，测站以上河道长度65 km，集水面积1510 km 2 ，见图1。  流域内共设配套雨量站7个，分别是东河口、张母桥、张家店、双河镇、椿树岗、山南和桃溪，各雨量站权重如表1所示。  根据丰乐河流域30年(1984年至2013年)的降雨量、流量和蒸发资料，选取30场洪水进行模拟计算。其中，14场作为率定样本用于新安江模型参数的率定与流域经验单位线的分析提取，率定出的参数如表2所示。 图1. 桃溪站控制流域与各雨量站位置图 Table 1 站名 东河口 张母桥 张家店 双河镇 椿树岗 山南 桃溪 流域权重 0.060 0.124 0.237 0.175 0.137 0.216 0.051 表1. 各雨量站权重 Table 2 参数名称 参数意义 参数值 参数名称 参数意义 参数值 K 蒸散发折算系数 0.96 I MP 不透水面积比例 0.01 b 流域蓄水容量分布曲线指数 0.38 E X 流域自由水容量分布曲线指数 1.3 C 深层散发系数 0.19 S M 自由水容量/mm 19 W M 张力水容量/mm 105 K G 地下水日出流系数 0.207 W UM 上层张力水容量/mm 17.8 K I 壤中流日出流系数 0.404 W LM 下层张力水容量/mm 67.2 C G 地下水日消退系数 0.97 表2. 新安江模型参数率定结果表 在提取经验单位线时，因水文资料时段均为6 h，故推求的经验单位线时段长Δt取为6 h。率定样本中980915场洪水降雨时段数较少(仅为2个时段)、降雨量大(12 h降雨量达到90.1 mm) (见图2)，故选取作为推求流域经验单位线的初值洪水场次。在利用公式(4)求解初始经验单位线纵坐标时，峰值出现在第5个时段，而从第6个时段起出现了振荡与负值(见表3)，显然与实际不符。利用该流域上世纪90年代的经验单位线的退水段手动修正本次推算的单位线纵坐标值(在无可参考的单位线情况下可利用退水曲线法计算)。 修正振荡后的单位线纵坐标累加值为770，与标准值 相差不多，利用式(6)修正。通过振荡修正后的经验单位线对980915场洪水进行汇流计算，得其确定性系数为0.97。 采用修正后的单位线对所有率定洪水进行汇流计算，结果显示14场洪水的平均确定性系数为0.80，最高为0.95，最低为0.23。有4场次洪的确定性系数小于0.85，其模拟和实测的流量过程如图3所示。 图3中所有洪水的计算流量在涨水阶段均大于实测流量。4场降雨的降水量和平均降水强度均小于980915场洪水的90.1 mm和7.5 mm/h，分别为78.3 mm和3.3 mm/h (020623场)、79.8 mm和3.3 mm/h (070708场)、71.3 mm和2.4 mm/h (070827场)、87.4 mm和3.6 mm/h (100902场)。980915场降雨强度大，流域汇流速度大，据此推求的经验单位线在计算降雨量和降雨强度较小的洪水汇流时，会导致峰现时间提前，峰量增加，所以在利用此条经验单位线计算降水量和降雨强度相对较小的洪水时会出现涨水阶段计算流量偏大的情况。现提出两种解决方案：1) 使用1条单位线计算所有洪水，但为了提高预报精度，需对经验单位线的纵坐标做调整；2) 使用2条不同的经验单位线分别计算由不同降水量和降雨强度形成的大洪水和中小洪水。 方案(1)：将式(6)修正后单位线涨水阶段的纵坐标值适当减少，并将减少的部分分摊到退水时段坐标值上，使模拟时率定样本平均确定性系数升高。利用调整后的单位线模拟11场率定次洪，得其平均确定性系数由0.80上升到0.91，最低的0.23也上升到了0.71，以此条单位线作为丰乐河流域汇流计算的经验单位线。 14场率定洪水的径流深平均相对误差为7%、平均洪峰误差为8%、峰现时间的误差为2.57 h，评定合格率分别为93%、93%和86%，平均确定系数为0.91；16场检验次洪的模拟径流深、洪峰与峰现时间的误差分别为8%、9%和3.38 h，合格率分别为88%、94%和88%，平均确定系数为0.89；总体平均确定性系数为0.90，为甲级预报方案。 不同单位线的比较，如表4所示。 图2. 编号980915场洪水计算图 Table 3 时段 (Δt) 单位线初值 q i (m 3 /s) 净雨 R i (mm) q i R i /10 计算流量 (m 3 /s) 实测流量 (m 3 /s) 公式(4) 修正振荡 公式(6) 14.1 20.1 1 0 0 0 14.1 0.0 0.0 0.0 2 28 28 25 20.1 35.3 0.0 35.3 38.9 3 86 86 78 109.5 50.3 159.8 141.0 4 99 99 90 126.8 156.1 282.9 271.0 5 105 105 95 134.3 180.7 315.0 304.0 6 73 96 87 122.9 191.4 314.3 284.0 7 93 76 69 97.3 175.2 272.4 240.0 8 5 60 54 76.8 138.7 215.5 192.0 9 144 48 44 62.0 109.5 171.5 154.0 10 −171 39 36 50.4 88.4 138.8 118.0 11 427 33 30 41.7 71.8 113.5 83.6 12 −795 26 24 33.2 59.4 92.5 63.8 13 1653 21 19 26.3 47.3 73.6 55.0 14 −3275 16 15 20.8 37.5 58.3 48.7 15 6620 13 11 16.1 29.7 45.8 38.0 16 −13276 9 8 11.6 22.9 34.5 30.7 17 26710 7 6 8.4 16.6 25.0 26.0 18 −53664 4 4 5.2 11.9 17.2 24.0 19 107886 3 3 3.8 7.5 11.3 22.0 20 −216833 2 2 2.6 5.5 8.0 17.7 21 435852 1 1 1.3 3.6 4.9 7.0 22 1.8 1.8 3.0 ∑ 291768 770 699 表3. 经验单位线初值计算表 Table 4 时段数 (Δt) 90年代单位线 (m 3 /s) 修正后单位线 (m 3 /s) 调整后单位线 (m 3 /s) 时段数 (Δt) 90年代单位线 (m 3 /s) 修正后单位线 (m 3 /s) 调整后单位线 (m 3 /s) 1 0 0 0 12 33 24 30 2 6 25 13 13 26 19 25 3 21 78 39 14 21 15 19 4 54 90 79 15 16 11 16 5 86 95 95 16 13 8 13 6 94 87 86 17 9 6 9 7 87 69 74 18 7 4 6 8 72 54 62 19 4 3 4 9 60 44 50 20 2 2 2 10 48 36 42 21 1 1 1 11 39 30 35 ∑ 699 699 699 表4. 不同单位线的比较表 注：表中修正后单位线即为式(6)计算的单位线；调整后单位线为最终确定的丰乐河流域经验单位线。 丰乐河流域洪水预报率定洪水精度评定表，如表5所示。 丰乐河流域洪水预报检验洪水精度评定表，如表6所示。 Table 5 序号 场次 实测径流 (mm) 计算径流 (mm) 允许误差 (mm) 合格 实测洪峰 (m 3 /s) 计算洪峰 (m 3 /s) 允许误差 (m 3 /s) 合格 峰现误差 (h) 合格 R 2 1 840606 20.6 20.5 4.1 √ 145.0 144.0 29.0 √ 0 √ 0.99 2 840612 67.7 64.6 13.5 √ 539.0 487.0 107.8 √ 0 √ 0.94 3 870525 21.5 21.5 4.3 √ 159.0 157.0 31.8 √ 0 √ 0.99 4 930917 61.6 61.8 12.3 √ 374.0 378.0 74.8 √ 0 √ 0.99 5 980816 18.9 22.7 3.8 √ 187.0 179.0 37.4 √ 0 √ 0.90 6 980915 29.9 31.2 6.0 √ 301.0 314.0 60.2 √ 6 √ 0.90 7 000905 9.9 10.4 3.0 √ 105.0 101.0 21.0 √ 0 √ 0.97 8 020623 62.3 69.4 12.5 √ 353.0 389.0 70.6 √ 0 √ 0.78 9 050829 130.3 131.1 20.0 √ 687.0 711.0 137.4 √ 0 √ 0.96 10 070827 18.6 22.6 3.7 × 128.0 180.0 25.6 × 12 × 0.71 11 070708 43.3 45.7 8.7 √ 314.0 370.0 62.8 √ 6 √ 0.88 12 090628 69.2 68.9 13.8 √ 453.0 458.0 90.6 √ 0 √ 0.86 13 120626 14.4 17.3 3.0 √ 94.0 102.0 18.8 √ 0 √ 0.97 14 130525 9.6 10.7 3.0 √ 72.0 78.0 14.4 √ 12 × 0.89 表5. 丰乐河流域洪水预报率定洪水精度评定表 注：峰现允许误差为Δt（6h）。 Table 6 序号 场次 实测径流 (mm) 计算径流 (mm) 允许误差 (mm) 合格 实测洪峰 (m 3 /s) 计算洪峰 (m 3 /s) 允许误差 (m 3 /s) 合格 峰现误差 (h) 合格 R 2 1 840830 129.0 119.0 20.0 √ 746.0 857.0 149.2 √ 6 √ 0.84 2 850912 21.8 19.7 4.4 √ 153.0 146.0 30.6 √ 0 √ 0.94 3 860715 97.9 103.6 19.6 √ 440.0 414.0 88.0 √ 0 √ 0.99 4 870701 121.8 127.9 20.0 √ 521.0 538.0 104.2 √ 0 √ 0.98 5 870820 77.0 80.4 15.4 √ 303.0 264.0 60.6 √ 12 × 0.69 6 880518 23.4 22.2 4.7 √ 203.0 167.0 40.6 √ 6 √ 0.75 7 890804 64.1 58.4 12.8 √ 474.0 409.0 94.8 √ 0 √ 0.99 8 900701 30.0 29.4 6.0 √ 265.0 247.0 53.0 √ 0 √ 0.89 9 910415 35.8 41.2 7.2 √ 356.0 352.0 71.2 √ 0 √ 0.90 10 930628 67.6 67.4 13.5 √ 557.0 589.0 111.4 √ 6 √ 0.87 11 940606 43.7 53.4 8.7 × 351.0 357.0 70.2 √ 0 √ 0.92 12 960602 33.2 35.4 6.6 √ 269.0 203.0 53.8 × 12 × 0.74 13 990621 37.7 41.3 7.5 √ 325.0 327.0 65.0 √ 0 √ 0.98 14 020505 21.7 22.3 4.3 √ 196.0 182.0 39.2 √ 0 √ 0.98 15 100902 134.6 137.0 20.0 √ 673.0 776.0 134.6 √ 6 √ 0.90 16 130705 60.4 73.5 12.1 × 364.0 411.0 72.8 √ 6 √ 0.85 表6. 丰乐河流域洪水预报检验洪水精度评定表 图3. 确定性系数不到0.85的洪水场次模拟结果 方案(2)：130525场洪水的降水量和平均降水强度分别为50.2 mm和2.1 mm/h，为洪水样本中的较小值，以该场降雨洪水作为中小洪水的代表，推求该场洪水的经验单位线；980915场洪水的降水量和平均降水强度分别为90.1 mm和7.5 mm/h，以该场降雨洪水作为大洪水的代表。推求的980915场和130525场洪水的经验单位线如图4所示，当降雨量和平均降雨强度较大时，流域汇流速度快，峰现时间提前，洪峰流量增加，经验单位线为高瘦状；而当降雨量和平均降雨强度较小时，流域汇流速度较小，峰现时间相对偏后，洪峰流量较小，经验单位线为矮胖状。 使用降水量和降水强度较大的980915场洪水推求的经验单位线对降水量和降水强度均较小的000905场洪水(降水量为40.9 mm、平均降水强度为1.4 mm/h)进行汇流计算，得其洪峰相对误差为10%，峰现误差为6.0h，确定性系数为0.89；而使用降水量和降水强度均较小的130525场洪水推求的经验单位线对该场洪水进行汇流计算，得其洪峰相对误差、峰现误差和确定性系数分别为1%、0.0 h和0.94。同理，使用降水量和降水强度较小的130525场洪水推求的经验单位线对降水量和降水强度均较大的980816场洪水(降水量为70.6 mm、平均降水强度为4.0 mm/h)进行汇流计算，得其洪峰相对误差7%，峰现误差为6.0 h，确定性系数为0.82；而使用降水量和降水强度均较大的980915场洪水推求的经验单位线对该场洪水进行汇流计算，得其洪峰相对误差、峰现误差和确定性系数分别为1%、0.0 h和0.95。可见，在使用经验单位线计算流域汇流时，可根据降雨量和降水强度的不同，采用相应于大洪水和中小洪水的的多条经验单位线分别进行汇流计算，以提高预报精度。 图4. 两场不同降雨推求的洪水经验单位线对比图"
"采用三水源新安江模型计算了流域产流和分水源，以新安江模型计算的洪水径流深和实测径流深的平均绝对误差最小化为目标，采用遗传算法确定了该模型的参数；并将地表径流和壤中流作为直接径流，采用经验单位线法将其汇流计算至流域出口，地下径流采用线性水库模拟，通过叠加直接径流的汇流过程和线性水库的出流，得流域出口断面的流量过程，构建了丰乐河流域洪水预报模型，用于该流域的洪水模拟和预报，得以下结论： 1) 基于三水源新安江模型和经验单位线法分别进行洪水的产流和汇流计算，构建丰乐河流域洪水预报模型是可行的。14场率定洪水的径流深平均相对误差为7%、平均洪峰误差为8%、平均峰现误差为2.57 h，合格率分别为93%、93%和86%，平均确定性系数为0.91；16场检验洪水的径流深、洪峰和峰现的误差分别为8%、9%和3.38 h，合格率分别为88%、94%和88%，平均确定性系数为0.89。 2) 采用基于大洪水推求的单位线进行中小洪水汇流计算时的精度较低，反之亦然。在丰乐河流域应根据降水量的不同推求出相应于大、中小洪水的经验单位线，进而可依据形成次洪的降水量的大小，采用不同的经验单位线对洪水进行预报，以提高预报精度。"
