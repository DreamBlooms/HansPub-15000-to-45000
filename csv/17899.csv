"针对温室大棚在农业领域越来越得到广泛推广，数字化采集环境因素需求越来越得到重视，设计了基于ZigBee组网控制的温室大棚环境监控系统。系统主要由温湿度采集电路、光强传感器电路、ZigBee无线传输电路、电源管理电路、GSM数据传输电路等组成。通过SHT20温湿度采集传感器以及BH1750光强传感器采集环境因素，将各节点的环境因素通过ZigBee无线传感网络汇总处理，并永久保存至云端服务器,用户通过智能手机终端可以实时监测各项数据。测试结果表明，系统实现了对大棚内环境参数的采集、处理、传输、保存功能，具有低功耗、操作简便、体积小等特点，对用户在日常大棚中环境因素的采集起到方便管理以及便于维护的功能。 关键词 :无线传感器网络，环境参数，GPRS，低功耗"
"温室是目前现代农业 [ 1 ] 领域重要的组成部分，也是我国农业发展的重点之一。人为的通过模拟改变生物生长的气候条件，在农作物不适合生长的季节中得到生长，一定程度的摆脱了自然环境下作物对环境的依赖性，这是温室大棚所带来的极大好处。与此同时，大棚的核心功能就是能够为农作物提供与外界不同的温湿度和光照度。这些环境因素直接影响了作物的发展。目前，温室的数据采集大多通过人工和有线模式进行采集，这种采集方式的缺点也是显而易见的。人工采集的工作量相当大，采集的实效性不高，无法做到定时定点的采集。同时有线采集技术相对成熟稳定，但在投入资本以及维护方便需要耗费很大的精力物力，且抗干扰能力也差，并且系统的可扩展性低，不利于各方面的优化。随着无线传感器网络(Wireless Sensor Networks)技术 [ 2 ] 的日益成熟，现代农业中开始采用无线传感器网络技术构建温室大棚环境监测系统。 无线传感器网络是一种结合了传感器技术、信息处理技术和网络通信技术的大规模多跳的自组织网络。它的结构组成主要由分布在给定区域内功能不同的无线传感器节点组成，每个节点都具有数据采集、处理和传输的功能，节点之间通过特点的网络协议实现信息的交流汇聚和处理 [ 3 ] 。体积小、造价便宜以及功耗低等各方面的特点，把无线传感网络引入至现代农业中会发挥其重要的作用。通过其智能化管理与功耗低的特性，可以大幅提供劳动生产率和作物产出率，改善温室内的环境条件。 与此同时，传感器终端节点是WSN系统的重要组成单元，它的工作寿命影响着整个网络的工作寿命。目前的基于WSN无线传感器技术的方案还有诸多缺陷，如：频率的利用率低导致系统的不稳定，传输数据少且不稳定，信号传输的距离短等问题。本文采用环境能量收集技术 [ 4 ] 从周围环境中源源不断地采集可用能量，让传感器终端节点具有能量自供给的能力。同时解决了信号不稳定导致的传输数据误差大以及传输数据近等缺点。考虑到如今手机端应用的普遍性，文献 [ 5 ] 介绍了采用PC端 + ZigBee网络节点方式进行设计，本文提出通过采用手机App + 节点数据采集端+协调器数据处理端方式进行开发，具有功能更多，成本更低，使用更方便快捷的特点，使用户不通过电脑，只要手机就能完成环境因素的监控功能，带来更好的用户体验。"
"系统总体方案如图1所示。系统由传感器节点、协调器、云端服务器和智能手机终端应用四部分组成 [ 6 ] 。传感器节点分布于不同大棚环境中，协调器建立无线网络后节点加入网络，并定时将环境传感器采集的环境数据传输至协调器中进行汇总处理，同时处理完成后的数据通过GPRS网络传输至云端服务器，服务器将数据存入数据库中进行永久保存。智能手机端应用通过访问云端服务器将保存的数据信息提取后显示在手机中方便用户进行远程的查看。 系统节点数据采集端框架如图2所示，协调器信息处理端如图3所示。 节点数据采集端即为无线传感网络的节点 [ 7 ] 。能量自收集模块产生的能量源源不断地为节点提供电源，采集的环境信息经过A/D模数转换后在处理器中进行数据处理后无线传输至协调器信息处理端进行汇总处理。协调器信息处理端即为无线传感网络的协调器。通过组建无线传感网络，将网络中的节点数据通过无线传输进行汇总处理，处理后的汇总数据经过GSM数据传输模块发送至云端服务器进行永久性存储。控制器采用的是低功耗片上系统CC2530 [ 8 ] 。"
"温湿度采集电路采用SHT20传感器。传感器首先通过设置分辨率将温度分辨率和湿度分辨率分别设置成12位以及14位。之后，管脚SDA将模拟量数据转化成两个字节的数字量数据传输至控制器处理。控制器中将两个字节的数字量进行解析并计算得到采集的温湿度，如图4所示。"
"光强采集电路采用BH1750传感器。采用CR电路在运行中控制DVI管脚电压，采集的光强参数通 图1. 系统总体框架 图2. 节点数据采集端框架图 图3. 协调器信息处理端框架图 图4. 温湿度采集电路 过IIC总线与控制器连接，数据通过SDA引脚发送至控制器，将模拟量转化为数字量，如图5所示。"
"GSM模块采用SIM900A，PWRKEY为模块开关管脚，通过控制器控制其时序变化来实行模块的开关。将PWRKEY接入控制器中，通过控制器的时序变化来引导模块的启动与关闭。同时，通过TXD和RXD管脚与控制器连接进行串口数据传输。协调器信息处理端汇总处理完成后的数据通过RXD管脚将数据发送至GSM模块。D101二极管作为工作状态指示灯判断开关状态以及工作状态。刚开机时状态灯会进行一段时间的频繁快速闪烁阶段，当模块成功注册到网络后灯的闪烁频率降低，模块正常开始运作如图6所示。"
"本系统节点采集端电路供电通过能量自收集的采集电路进行3.3 V供电。而同时，协调器信息处理端中的控制芯片需要3.3 V供电，GSM数据传输模块需要4 V进行供电以及2 A的瞬时启动电流，所以必须设计合理的电源模块使得系统能够正常运作。 从5 V电压转化为4 V电压采用的是mic29302转压芯片，其主要能够达到3 A的瞬时电流，通过外围电路设计可以有效地保护电路以及精确地转换调节电压的能力，如图7所示。 为了协调器信息处理端能够得到正常供电，系统还增加了5 V电压转3.3 V电压的电路。采用的芯片是LM1117转压芯片。此芯片可以提供输出1.8 V，2.5 V，3.3 V，5 V固定电压，可以满足系统的需求如图8所示。 图5. 光强采集电路 图6. GSM数据传输电路 图7. 5 V转4 V电路 图8. 5 V转3 V电路"
"系统通过控制器的协议栈开发，实现了定时采集环境数据、数据处理以及数据传输等功能。节点数据采集端流程如图9所示。协调器信息处理端流程如图9所示。首先协调器信息处理端进行组网工作，组网成功后等待节点加入，节点数据采集端加入协调器的网络中，采集端将传感器接收到的数据进行处理后定时发送至协调器控制模块，完成后进入休眠等待唤醒，同时协调器在收到数据后再发送至GSM数据传输模块，将数据发送至云端。"
"监测系统上位机采用Android手机应用的方式给予用户体验。应用中采用图表的方式清晰明了的绘制出温湿度以及光照强度曲线，并提供历史数据查询界面进行历史数据的追踪以及汇总。系统测试在楼道中进行。节点与协调器之间的距离在20 m左右，温湿度如图10所示。。 测试将协调器数据处理端开启后进行组网等待节点的加入，节点数据采集端上电后检测到协调器的网络存在，并加入该协调器的网络中，同时定时的开始采集温湿度环境数据，每采集一次后进入休眠状态等待下一次的唤醒。协调器数据处理端将无线传送来的数据进行处理，处理后的数据通过串口发送至GSM数据传输模块中，通过GPRS将数据上传至云端服务器永久保存，当用户打开手机端App后，应用连接至云端服务器，将保存在数据库中的数据提取并显示至手机中，当用户想知道最新的温湿度环境数据时，通过刷新图标即可获取数据库中从硬件设备中得到的最新信息。同时，提供历史查询功能，用户可以查询每一天的原始数据并进行总结。经过测试，本系统设计各项测试均能顺利稳定进行、响应迅速。 图9. 系统软件工作流程图 图10. Android手机应用展示图"
"本文设计的温室大棚环境监控系统实现了对大棚内环境参数的采集、处理、传输、保存功能，具有低功耗、操作简便、体积小等特点，对用户在日常大棚中环境因素的采集起到方便管理以及便于维护的功能。在数字化移动终端市场中有很好的应用价值。 考虑到如今手机端应用的普遍性，文献 [ 5 ] 介绍了采用PC端 + ZigBee网络节点方式进行设计，本文提出通过采用手机App+节点数据采集端+协调器数据处理端方式进行开发，通过GPRS把数据传输至智能手机终端，无需专门架线，用户通过智能手机终端可以实时监测各项参数，可在家里或者办公室实现了温室大棚多环境因子监测管理、调度和控制，有效地降低了劳动强度和生产成本，为设施农业综合生态信息自动检测、环境自动控制和智能化管理提供科学依据。相较于PC端上位机实现，本文的手机端App应用没有了PC端和硬件部分的专门架线，且真正的实现了人可以在任何时间任何时刻完成对大棚的监管，不用再在电脑面前去观察处理数据，只需手机就能完成操作，带来了诸多的方便。"
