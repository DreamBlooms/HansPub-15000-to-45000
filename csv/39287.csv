"如何科学高效地提取大尺度流域水文特征参数，为水资源管理提供基础分析数据，是当前生产需要中急需解决的问题。本文基于DEM、采用“IDDEA”算法实现了汉江流域水系河网的自动提取，采用二叉树二元编码进行河网编码，构建了汉江流域河网水系的空间概化模型，提取了汉江流域内任意涉水工程点的流域水文特征参数信息，为流域水资源管理和技术决策提供支撑。 关键词 :DEM，汉江流域，水系提取，河网编码，流域特征参数 Copyright © 2020 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"提取流域河网水系的传统方法主要是采用人工查找河流线进而得到流域的河网水系以及相关流域水文参数，不仅耗时，而且主观性较强。随着GIS技术在水文模拟领域的广泛应用，直接基于DEM提取河网水系已经成为当前获取流域水文特征信息的一种重要方法。目前，常采用“AGREE”算法进行DEM值预处理，通过实测水系信息量来修正原始DEM值，以此提高河网提取的精度。何江 [ 1 ] 在基于DEM与遥感的数字流域水系提取研究中，将从遥感信息提取DRLN修正原始DEM，以此提取秦淮河流域水系。林凯荣 [ 2 ] 等在汉江流域数字河网的构建中，利用遥感影像获得的自然流域水系矢量数据对DEM进行了处理。 本文基于GIS平台采用“IDDEA”算法叠加矢量化的主干河流水系修正DEM，依据河网密度与集水面积阈值来确定合理的集水阈值，进而实现基于DEM准确提取汉江流域水系河网。由于常规的二叉树编码存在迭代运算庞大、效率较低缺点，本文研究采用二叉树二元编码，实现汉江流域水系河网编码，构建汉江流域河网水系的空间概化模型，实现监测点–河段–子流域的拓扑关联，模型构建后可以提取流域内任意涉水工程点控制的流域水文参数信息，同时也可实现水文模型各计算要素的逻辑组织与管理，根据各要素的逻辑关系、连通性确定上下游关系进而快速的追溯源头。"
"汉江发源于秦岭南麓，襄阳以上河流总体流向东，襄阳以下转向东南，于武汉市注入长江，干流全长1577 km，流域面积约15.9*10 4 km 2 [ 3 ]。流域地势西高东低，西部秦巴山地高程1000~3000 m，中部南襄盆地及周缘丘陵高程在100~300 m，东部江汉平原高程一般在23~40 m。西部最高为太白山主峰，海拔约为3767 m，东部河口高程约为18 m，干流总落差约为1964 m。山地约占55%，主要分布在西部，为中低山区；丘陵占21%，主要分布于南襄盆地和江汉平原周缘；平原区占23%，主要为南襄盆地、江汉平原及汉江河谷阶地；湖泊约占1%，主要分布于江汉平原。  研究区DEM数据来源于中科院计算机网络信息中心国际科学数据镜像网站公开发布的V4.1版SRTM DEM数据产品，该产品由美国太空总署(NASA)和国防部国家测绘局(NIMA)联合测量，数据分为30 m和90 m分辨率两类，由于仅有90 m分辨率的DEM对外实现共享公开。因此，本文采用空间分辨率为90 m的SRTM DEM，主干河流根据WGS84坐标的影像，进行矢量化获取，并转换为shp文件进行套合。"
"由于DEM在内插处理过程中存在一定的数据异常，使得DEM数据的表面存在一些真实的洼地和假洼地。由于洼地的存在，导致基于DEM提取的河网产生不合理的中断，无法得到洼地内合理的水流方向，从而降低了提取河网的精度。因此，在进行水流方向的计算之前，应对原始的DEM数据进行预处理，采用IDDEA (Inverse Distance Drainage Enforcement Algorithm) [ 4 ] 算法对原始DEM进行修正，迫使获取正确的水流方向。 采用实测水系资料辅助修正原始DEM高程值，基于DEM提取流域河网的方法提取虚拟河网水系，对没有实测水系作为辅助信息提取河网以及有实测水系作为辅助信息的两种情况下提取河网进行对比，如图1(a)、图1(b)所示，可以看出有实测水系作为辅助信息对原始DEM进行修正，采用“IDDEA”方法提取得流域河网在中下游平原区精度更高。 图1. 有无水系辅助修正DEM提取流域河网对比示意图  研究区域内汇流累积量栅格中各个栅格单元的汇流能力是根据通过流入该栅格单元的所有栅格汇流量的总和所确定。当栅格单元的汇流累积量大于某一给定阈值时，认为该栅格为河网单元，通过栅格二值化，由此得到地表水流路径构成的栅格网络，然后通过栅格数据转矢量数据的方法得到区域内的矢量河网。汇流累积量阈值的选取对基于栅格DEM提取流域的水文特征信息影响较大，因此，如何能够准确地设置合理的汇流累积量阈值值得广泛研究。本文比较分析21组不同阈值下提取的河网水系，通过研究区域的总体面积和河网的总长度计算不同汇流累积量阈值下的河网密度。统计不同集水面积阈值下的河网长度、河网密度，如图2所示。 图2. 集水面积阈值与河网密度关系曲线图 从图2中可以看出当集水面积阈值比较小时，河网密度很大，随着集水面积阈值变大，河网密度开始有一个降低趋势，使得河网密度变化变得平缓，当集水阈值为12 km 2 时，变化趋于稳定。可以初步判断，汉江流域采用集水阈值为12 km 2 提取流域特征较为合适。 图3. 基于DEM提取水系与影像对比图 根据“IDDEA”算法以及定量确定集水阈值的方法，本文提取的汉江流域水系与影像图进行对比，见图3，结果显示：汉江流域上游山区水系吻合度较高，下游平原地区有主干河流修正情况下，主干河流吻合一致。"
"流域内复杂密集的河网数据较为庞大，如果仅通过河网属性中存储的拓扑关系运算实现流域内水系河网拓扑关联查询，必然降低计算效率。因此，需选择一种高效的编码方法，能够快速地获取河段之间的逻辑关系，其要求需满足以下两个方面：一是要求依据编码可以在河网中进行河段的直接定位，而避免低效率的遍历或搜索；二是要求编码本身具备较显著的拓扑意义，能够直接进行拓扑关系运算，便于识读。  基于DEM提取的流域河网，可根据水流方向确定水系河网中每条河段的上下游关系，如图4所示，河网中的河段之间通过河段与节点的关联构建河段之间的上下游拓扑关系。图4中箭头代表河段的水流方向，河段3的起始节点(FromNode)是河段1和河段2的末节点，河段3的末节点(ToNode)是河段4的起始节点，以此构成整个河网每个河段之间的上下游关系。 图4. 基于DEM提取流域河网拓扑结构图  在大尺度、复杂流域的河网模型构建中，河网编码尤为重要，需针对河网的复杂性提出相应的编码方案 [ 5 ]。研究二叉树的编码，主要常见的为二进制编码，在流域河网编码中常对河网进行二进制字符串编码的方法： 1) 对于出口河段的二进制编码可以记为“0”； 2) 从出口河段开始向上游搜索，记左侧二进制编码为上一级编码“0”；右侧二进制编码，当可能遇到的支流河段赋值为“1”，可能遇到的干流河段赋值“0”； 3) 重复以上步骤至遍历所有河段。 虽然，这样可以实现流域内所有河段的二进制编码(如图5(a)所示)，但是，这种编码的针对尺度较大的流域编码，编码长度有所限制。因此，需要采用二元编码方式对大流域进行编码(如图5(b)所示)。 图5. 河网的二叉树编码两种方式示意图 如图5(b)所示，流域河网中的每个河段以二元编码的形式(L m , V n )表示。其中L m 是该河段字符串的长度，V n 是该河段二进制字符串的十进制数值。从河网的拓扑结构关系得出，L m 表示河段距离流域出口的远近(二叉树节点所处的层)，V n 表示该河段距离干流的远近(二叉树节点所处层内编码)，以此来表达河网中河段之间的竖向关系。 在基于二叉树的编码中，并没有对二叉树中横向关系给出确定方法，因此不能够确定出横向两个河段的干支流关系。根据SrefanUhlenbrook等的研究，河道宽度与集水面积呈对数关系 [ 6 ] [ 7 ] ： B = α ln ( A s ) + β (1) 式中：A s 为各栅格的上游集水面积；B为河道宽度；α和β为经验参数，表现了流域中数字水系的整体特性。 根据公式2，可以得出每个河段的河道宽度随着该河段上游集水面积总和的增大而增大，所以，本文将利用每个河段的上游集水面积总和来判定流域河网中两个河段之间干支流关系，通过河网二叉树二元编码的算法实现汉江流域的河网编码，算法流程如图6所示。 流域内的水文对象其主要可分为：①点对象：通常包括流域内部的河道源点或者河段出水节点、水文监测站点、水质监测点、取排水口点、水利工程、管理站点以及涵闸泵站等。②线对象(河段)：通过交汇点将河网水系分段，主要属性有河段名称、河段长度、河段等级、河段的坡降等。③面对象(子流域)：是指使用流域产汇流模型进行计算的水文模型对象，其包括小流域，区间流域等。基于GIS平台，将流域内水文对象概化为空间的点、线、面，通过编码，从而使水文要素之间形成了完整的拓扑结构关系。 针对如何快速获取某一水文对象对应的上、下游对象，可根据河网二元编码的BSLength和BSValue两个分量值，无需迭代实现搜索： 1) 若对给定某一河段，该河段的二元编码为(BSLength, BSValue)，其上游河段进行搜素时，只需根据下式进行遍历判断搜索。 BSLengthSY ≥ BSLength (2) 式中：BSLengthSY代表其上游河段的二元编码L m 分量值；BSValueSY代表其上游河段的二元编码V n 分量值。 2) 若对给定某一河段，该河段的二元编码为(BSLength, BSValue)，其下游河段进行搜素时，只需根据式(3)进行遍历判断搜索。 BSLengthXY ≤ BSLength (3) BSValue / 2 ( BSLength-BSLengthXY ) = BSValueXY . 式中：BSLengthXY代表下游河段的二元编码L m 分量值；BSValueXY代表下游河段的二元编码V n 分量值。 图6. 河网二叉树二元编码算法图"
"在山洪灾害分析评价、水利水电工程设计、涉水工程防洪评价等项目中，通常需要计算中小流域设计洪水。推求设计洪水的方法主要有两大类：由流量资料推求设计洪水和由暴雨资料推求设计洪水。但在实际工作中，中小流域地区往往缺乏实测流量资料，而降雨资料一般较多，因此常采用暴雨资料推求设计洪水。提取流域特征信息(面积、河长、比降)是暴雨资料推求设计洪水的前提条件。然而，在设计过程中，特别是对于大流域的基础数据比较匮乏，传统手工量算流域特征信息，效率非常低。 基于DEM构建的汉江流域水系河网模型，采用GIS技术和.NET开发平台，设计研发了基于DEM的流域水文参数提取软件(软件界面见图7)，能够满足汉江流域内任意涉水工程点的水文参数自动提取与计算。结合汉江流域上游某一铁路沿线，需对沿线涉河桥梁处进行设计洪水计算，因此，需对桥梁断面位置进行流域水文特征参数提取，共计12处断面。在缺少大流域的基础数据时，若采用传统方法人工对照影像图进行分水岭判断，往往需要约3天时间完成，采用本文提出的方法和研发的软件，可在1个小时内完成所有断面处流域水文特征参数的提取。 图7. 基于DEM的流域水文参数提取软件界面"
"本文采用“IDDEA”算法叠加部分主干河流矢量水系修正SRTM DEM数据，依据河网密度与集水面积阈值来确定汉江流域水系的集水阈值为12 km 2 ，进而实现基于DEM准确提取汉江流域水系河网，并于影像数据进行对比。分析基于DEM提取的河网拓扑结构关系，研究并实现采用二叉树二元编码方法对汉江流域水系河网进行编码，构建汉江流域河网水系的空间概化模型。基于GIS以及构建的河网模型开发软件实现流域内任意涉水工程点控制的流域水文参数信息，同时也可实现流域内水文要素的拓扑组织与管理，根据各要素的逻辑关系、连通性确定上下游关系进而快速的追溯源头。 本文仅解决了标准河网的编码问题，并没有对分叉河网、十字形河网和“H”形河网 [ 8 ] [ 9 ] 等一些复杂的河网进行深入研究，在河网连通复杂的汉江下游平原地区适用性不强。另外，本文探讨的水系河网模型可以作为污染源追溯 [ 10 ] [ 11 ] 、取排水口空间合理性分析、水量平衡、分布式水文模型等的基础数据，在后续生产实践中开展深入研究。"
