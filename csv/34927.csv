"本文的目标是研究针对非完整多体系统动力学与控制问题的更简单规范的动力学建模方法。采用欧拉–拉格朗日形式的高斯原理推导了适于非完整多体系统的准坐标形式的动力学运动微分方程。与目前常用的以动力学状态函数表达的针对非完整系统的动力学微分方程相比，文中的推导方法简单直接，得到的方程维数与自由度一致，且方程以准速度的显式矩阵表达，具有较强的通用性及规范性，适用于多体系统的程式化建模及计算的要求。针对例子中的典型非完整系统，建立了准速度表达的一阶运动微分方程并进行了数值模拟以及相应的动力学特性分析，与通常用于该类问题的带乘子的Routh方程相比，文中的方法在计算速度上占优，同时在不进行额外的违约修正的前提下，可较好地解决违约及位置奇异问题。 关键词 :准速度，非完整系统，高斯原理，多体系统，准坐标 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"“完整”和“非完整”是力学上对约束和系统的分类概念。完整约束是对系统位形的限制，非完整约束是对系统运动的限制。自从Hertz于1894年首次提出非完整系统的一些重要概念以来，众多学者在非完整系统的基本原理、基本方程及在工程中的应用都取得了重要进展。 非完整系统动力学方程的建立主要依据如下力学原理：1) DLP原理(D’Almbert及Bernoulli原理)；2) Gauss原理和Jourdain原理；3) Hamilton原理。其中Gauss原理往往被认为是更具普适性的分析动力学的基本原理 [ 1 ]。 在非完整系统动力学的发展过程中，基于上述原理建立起各种不同的动力学方程，这些方程形式各异，一般可以划分为两类：1) 基于乘子理论的动力学方程，如Routh方程 [ 2 ] ；2) 约化的不带乘子的动力学方程，如Maggi方程、Appell方程等 [ 3 ]。这些方程数学上等价，但数值求解中表现的特性并不相同 [ 4 ]。 非完整多体系统的动力学建模主要基于上述几种典型的动力学方程, 上述方程的共同特点是：由表征系统运动状态的某函数(动能、Hamilton函数、加速度能等)及广义力按照规定的微分算子就能得到，思路清晰、表达简洁是其一大优点，但方程的不足之处在于建立了动力学基本函数后，还需经过微分算子的求导运算，对于比较复杂的系统，这种求导运算过程非常冗长。相比而言，Appell方程中的微分算子是最简单的，但建立复杂系统的Appell函数并非易事，Kane通过Jourdain原理，得到用准坐标表达的动力学微分方程，但在求偏速度、广义主动力及广义惯性力的过程涉及到矢量运算，符号复杂运算繁琐 [ 4 ] [ 5 ] [ 6 ] [ 7 ]。Udwadia等从Gauss原理出发，得到U-K方程，可以处理一阶非完整系统，但该方程中涉及非常复杂的广义逆矩阵的计算问题 [ 8 ] [ 9 ] [ 10 ]。 高斯原理往往被认为是更具普适性的分析力学的基本原理，可适用于完整、非完整约束系统；同时准坐标表达的方程具有很大的概括性(用广义坐标表达不过是它的特殊情形)，而且方程的结果往往很简洁，都是一阶方程。 因此，本文引进了由准坐标表达的坐标系统，采用高斯原理作为基本原理进行了动力学方程的推导。文中得到了以准速度的显式矩阵表达形式的非完整多体系统的动力学微分方程，并以此作为建模的基本方程，研究了非完整系统典型例子的动力学问题，与目前常用的Routh方程的方法进行对比分析，从而探索研究非完整系统动力学与控制问题的更简单规范的建模方法。"
"设系统由n个广义坐标描述，系统受到g个一阶非完整约束： f k ( q j , q ˙ j , t ) = 0 ( j = 1 , ⋯ , n ; k = m + 1 , ⋯ , n ; m = n − g ) (1) 其中m为系统的自由度数，可取后面 n − m = g 个准速度为： π ˙ k = ω k = f k ( q j , q ˙ j , t ) ≡ 0 ( j = 1 , ⋯ , n ; k = m + 1 , ⋯ , n ; m = n − g ) (2) 前面m个准速度可选为以 q j , q ˙ j , t 为变量的m个其它任意函数： π ˙ k = ω k = f k ( q j , q ˙ j , t ) ( j = 1 , ⋯ , n ; k = 1 , ⋯ , m ; m = n − g ) (3) 选择准速度的条件为：(2)和(3)两个式子中所包含的n个函数的Jacobi矩阵 非奇异。 由方程(1) (2)得到广义速度的表达式并微分得到： q ¨ j = ∑ s = 1 n ∂ q ˙ j ∂ q s q ˙ s + ∑ k = 1 m ∂ q ˙ j ω k ω ˙ k + ∂ q ˙ j ∂ t ( j , s = 1 , ⋯ , n ; k = 1 , ⋯ , m ) (4) 定义下列矩阵： q = [ q 1 ⋯ q n ] T , q ˙ = [ q ˙ 1 ⋯ q ˙ n ] T , q ¨ = [ q ¨ 1 ⋯ q ¨ n ] T , π = [ π 1 ⋯ π m ] T , ω = [ ω 1 ⋯ ω m ] T , ω ˙ ′ = [ ω ˙ 1 ⋯ ω ˙ m ] T , D ω = [ ∂ q ˙ j ∂ ω k ] j = 1 , ⋯ , n k = 1 , ⋯ , m , w = [ ∑ s = 1 n ∂ q ˙ j ∂ q s q ˙ s + ∂ q ˙ j ∂ t ] n × 1 . 则方程(4)可表达为矩阵形式： q ¨ = D ω ω ˙ + w (5) 对(5)求变分，得到： δ q ¨ = D ω δ ω ˙ (6)"
"Euler-Lagrange形式的Gauss原理为 [ 2 ] [ 3 ] ： ∑ s = 1 n ( ∂ T ∂ q s − d d t ∂ T ∂ q ˙ s + Q s ) δ q ¨ s = 0 (7) 将系统动能表达为广义速度的显式： T = T 2 + T 1 + T 0 = 1 2 ∑ s = 1 n ∑ k = 1 n A k s q ˙ s q ˙ k + ∑ s = 1 n B s q ˙ s + T 0 则(7)式可写为： ( A q ¨ + g − Q ) δ q ¨ = 0 (8) 其中 A = [ A k s ] n × n 为正定且对称的矩阵， g ( q , q ˙ , t ) = [ g s ] s = 1 , ⋯ , n T ，其中 g s = ∑ k = 1 n ∑ m = 1 n [ k , m ; s ] q ˙ k q ˙ m − ∑ k = 1 n ( ∂ B k ∂ q s − ∂ B s ∂ q k ) q ˙ k + ∂ B s ∂ t − ∂ T 0 ∂ q s + ∑ k = 1 n ∂ A k ∂ t q ˙ k ; Q = [ Q s ] s = 1 , ⋯ , n T Q s = ∑ i = 1 N F i ⋅ ∂ r i ∂ q s 为对应系统广义坐标的广义力； [ k , m ; s ] = 1 2 ( ∂ A k s ∂ q m + ∂ A m s ∂ q k − ∂ A k m ∂ q s ) 为系数矩阵 A = [ A k s ] n × n 的第一类Christoffel符号。 将(5)及(6)代入(8)式，得： ( A D ω ω ˙ + A w + g − Q ) T D ω δ ω ˙ = 0 (9) 则(9)式可化为： ( A ∗ ω ˙ + g ∗ − Q ∗ ) T δ ω ˙ = 0 (10) 其中： g ∗ = D ω T ( A w + g ) , Q ∗ = D ω T Q , A ∗ = D ω T A D ω 由于 δ ω ˙ 中元素的独立性，故下式成立： A ∗ ω ˙ + g ∗ − Q ∗ = 0 (11) 则根据准速度的选择方法，准加速度矢量 ω ˙ 是m维的，总是与系统的自由度数一致。"
"如图1，一刚体作平面运动，在其重心C处引与刚体固结的坐标系Cξη约束条件为在任一时刻C点速度恒沿 Cξ 方向，设刚体的质量为M，对C点之惯性矩为I C ，求刚体在任意外力作用下的运动 [ 4 ]。 图1. 非完整系统的例子 作用在刚体上的外力可简化为主矢量F (设它与x轴间的夹角为 α )及对C点的主矩L C 。 非完整约束条件为： x ˙ C tan φ − y ˙ C = 0 (12) 其中x C ，y C 为C点在固定坐标系Oxy的坐标，φ角为Cξ 轴与x轴间的夹角。令 q = [ x ˙ c , φ , y ˙ c ] T 为广义坐标矢量， ω = [ ω 1 , ω 2 ] T 为准速度矢量。  选择准速度如下： ω 1 = x ˙ C cos φ + sin φ y ˙ C ω 2 = φ ˙ ω 3 = x ˙ C tan φ − y ˙ C (13) 则： J = [ cos φ 0 sin φ 0 1 0 tan φ 0 − 1 ] ,     J ¯ = [ 0 ] n × 1 因此可通过计算得到下列矩阵： D = J − 1 = [ cos φ 0 sin φ cos φ 0 1 0 sin φ 0 − cos 2 φ ] ,     D ω = [ cos φ 0 0 1 sin φ 0 ] w = D ˙ ω ′ = [ − sin φ φ ˙ ω 1 0 cos φ φ ˙ ω 1 ] A * = D ω T A D ω = [ cos φ 0 0 1 sin φ 0 ] T [ M I C M ] [ cos φ 0 0 1 sin φ 0 ] = [ M I C ] g * = D ω T ( A w + g ) = [ 0 0 ] Q * = D ω T Q = [ cos φ 0 0 1 sin φ 0 ] T [ F cos α L C F sin α ] = [ F cos φ cos α + F sin φ sin α L C ] 将A * ，g * ，Q * 代入矩阵方程(11)，即： M ω ˙ 1 = F cos φ cos α + F sin φ sin α I c ω ˙ 2 = L c (14) 通过方程(14)计算得到 ω ˙ = [ ω ˙ 1 ω ˙ 2 ] T ，将其代入(13)，可得到广义速度，通过一次积分即可得到下一时 刻的广义坐标的值。 数值计算结果见图2，图3显示了针对约束方程(12)的违约关系图，因准坐标方法中速度约束的自动满足，使得数值结果对约束方程的误差几乎可以忽略。  由非完整系统的Routh方程可以得到： M x ¨ C = F cos α + λ tan φ M y ⃛ C = F sin α − λ I C ω ˙ 2 = L C (15) 方程组(15)连同约束方程(12)式，可以得到系统的动力学解，数值求解结果如图4及图5所示。  a. 基于方程的对比： 采用两种方法所得到的方程分别为(14)及(15)，通过消掉方程(15)中的 λ ，我们可以得出两种方法是数学上等价的；但方程(14)仅含有两个封闭的准加速度方程的微分方程组，而要采用方程(15)，需要联立约束方程(12)，需要求解包含四个方程的微分代数方程组，显然前者的求解难度要小得多； 由方程(15)的右边项可以看出： 当 φ = π 2 + k π 时， tan φ 没有意义，需要额外处理奇异问题，而方程(14)则避免了此问题。 b. 基于数值运算结果的对比： 图2及图4中，通过两种方法所计算的质心坐标在最初五个波峰前几乎是重合的，从数值层面证明了两种方法的数学等效性； 图3及图5显示了两种方法的速度违约情况，通过对比可知，Routh方法由于速度方程的违约，位移曲线随着仿真时间的增长，其违约程度越来越大。 综上所述，同传统的Routh方法相比，采用准坐标形式的动力学矩阵方程(11)来解决非完整系统的动力学问题，计算速度快，且在不需要额外修正的情况下，可有效地避免违约及位置奇异问题。"
"同目前常用的以动力学状态函数表达的针对非完整系统的动力学微分方程相比，本文采用高斯原理推导得到了以准坐标形式的动力学微分方程，它以准速度的显式矩阵形式表示，维数与自由度一致，具有较强的通用性及规范性，适用于多体系统的程式化建模及计算的要求。 图2. 质心坐标随时间变化关系图(准坐标法) 图3. 速度违约图(准坐标法) 图4. 质心坐标随时间变化关系图(Routh法) 图5. 未加修正的速度违约图(Routh法) 文中的准坐标动力学方程同现有的求解非完整约束系统的Routh方程数学上等价，但可不需要额外处理速度违约及位置奇异问题。 本文是对非完整系统动力学与控制问题的更简单规范的建模方法的探索。"
