"高精度的三维道路信息在智能交通、城市规划与管理等领域具有重要的作用。车载激光点云数据包含了道路及其周围地物的三维信息，但存在数据量大、场景复杂和地物遮挡等问题，为道路边界信息的准确提取带来挑战。OpenStreetMap (OSM)作为一种众源数据，提供了基础道路信息。本文提出一种基于OSM数据辅助，从车载激光点云数据中提取道路三维边界的方法。首先分析车载点云的空间分布特征，构建车载点云特征图，然后以OSM数据作为初始位置，通过改进的活动轮廓模型算法进行道路边界提取，得到三维矢量道路边界。本文采用StreetMapper数据进行实验，结果表明，本文提出的算法能够修复点云缺损导致的边界信息缺失，准确且完整的提取道路三维边界信息，具有较强的稳健性和适用性。 关键词 :OpenStreetMap，车载激光点云，道路边界提取，点云特征图，活动轮廓模型 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"空间信息技术正在向着三维化发展，激光雷达扫描系统能够快速准确的获取高精度的三维空间信息。从LiDAR点云中提取高精度的三维道路信息在城市规划、3D导航和智慧城市等领域具有重要作用。但是车载激光雷达点云具有密度分布不均匀，数据量大，数据不完整和场景复杂等缺陷，从而影响的道路提取的完整性和正确性。 目前存在的车载激光点云道路提取算法，可分为四大类。第一类是基于扫描线的道路信息提取 [ 1 ] [ 2 ] [ 3 ] [ 4 ] [ 5 ] ，这类算法将每条扫描线近似看作道路的一个横截面，利用相邻扫描线的空间相似性进行提取。方莉娜 [ 1 ] 基于移动窗口滤波法先提取地面点云，再根据扫描窗口内的高差、坡度、点密度的变化从地面点云中识别路坎点云，该方法依赖于大量经验阈值，且提取精度受到窗口大小影响。Guan [ 2 ] 利用轨迹信息创建道路横截面点云段，从每段点云中提取主点形成一条伪扫描线，然后根据坡度，高差提取路坎点云，由于主点不能包含全部路坎点，此方法会造成路坎位置的偏差。Elberink [ 3 ] 同样利用轨迹信息创建道路横截面数据，然后利用RANSAC算法检测路面两侧垂直面片最为路坎边界，此方法仅适用于垂直形态的路坎。这类基于扫描线的方法对于非线性的扫描仪，需要大量预处理来获取伪扫描线，降低了处理效率并且会造成精度损失。 第二类是基于聚类的道路信息提取 [ 6 ] [ 7 ] [ 8 ] ，这类算法根据道路点具有相似的几何和强度特征，将具有相似特征的点通过聚类分析提取道路点。闫利 [ 6 ] 提出一种基于法向量的模糊聚类方法进行道路提取。Ibrahim [ 7 ] 先利用点密度阈值分割地面点，然后根据地面点的高程离散度、法向量、高程梯度等信息通过高斯滤波器提取道路边界。此方法需要大量人工经验阈值的选择。Zhou [ 8 ] 通过检测高程差异进行路坎提取，然后利用KNN将路坎点聚类提取道路边界。此方法采用单一特征进行聚类分析的，导致后续需要进行大量优化工作。 第三类是基于机器学习的道路信息提取 [ 9 ] [ 10 ] ，这类算法利用机器学习算法通过人工选取一定的路坎与非路坎进行样本训练，实现路坎点云的提取。罗海峰 [ 9 ] 先构建包含相对高程、法向量方向、多尺度高程差及多尺度高程方差的点云特征向量，然后采用SVM提取路坎点云，并对提取结果进行聚类去噪优化。杨必胜和刘缘 [ 10 ] 提出BKD三维局部特征，该特征包含高斯核密度估计和二值化，然后利用随机森林分类器提取路坎和道路标线。这类方法需要进行大量样本训练，其通用性受到限制。 第四类是基于点云特征图像的道路信息提取 [ 11 ] [ 12 ] [ 13 ] [ 14 ] ，这类算法将点云数据投影到二维空间，将三维特征转化为二维平面特征，利用图像处理技术对道路进行识别提取。Jaakkolat [ 11 ] 通过计算格网之间的点云高程差异生成高程梯度图，利用图像处理算子检测路坎位置。Boyko [ 12 ] 提出了一种适用于大范围城市场景道路提取的方法，该方法利用点云高程特征和法向量特征形成特征图，然后利用活动轮廓模型算法检测出道路边缘位置，此方法仅适用于密度非常大的点云。此类方法的处理效率较高，因此本文采用此类方法，并在Boyko的方法上进行改进，提出一种效率更高且准确率更高的算法。 目前存在的算法，还存在以下问题，第一没能解决因遮挡、数据缺失、点密度分布差异等导致道路目标提取不完整或漏提取的问题，道路提取结果的正确度和完整度有待提高。其次目前方法多数集中在道路点云的分割，道路边界仍由无拓扑信息的点云构成，未能将这些点云转化成能够精确表达道路形状的三维矢量道路信息。最后还存在效率不高等问题。本文算法充分利用OSM的先验知识(位置、语义、拓扑等)，并改进活动轮廓模型算法，能够快速完整准确的提取出包括遮挡及数据缺失区域的道路边界，最终生成精确的具有语义和拓扑信息的三维矢量道路数据。"
"本文利用OSM辅助车载激光点云进行三维道路边界提取，首先利用OSM的连接关系对点云进行分段处理，对于每一段点云进行平面规则格网投影，通过分析格网内部点云的空间特征(高差、点云密度、到OSM距离)构建点云特征图像，然后利用改进的活动轮廓模型算法，改进的模型以梯度矢量流加上宽度约束作为外部能量，使其更加适用于道路提取，从而更加准确的提取道路边界。本文方法的具体流程如图1所示。   车载激光扫描获取的点云的数据量大，需要分段处理。本文依据OSM的拓扑连接性对车载点云进行分段，即利用OSM的顶点及交叉点作为分割点。因为OSM的形状和道路形状近似，在道路形状较为复杂时需要分成多段简单的道路进行处理，OSM为了表示出道路的形状顶点随之增加，因此OSM的顶点是天然的分割点，并且提取完成之后再根据这些顶点进行拼接，有效的保证拓扑不变性。 首先把车载激光点云垂直投影到XOY平面，图2是投影后的点云与OSM的叠加显示图。对于由两个顶点构成的一段OSM，以之为对称中心线做Bounding box，考虑到OSM并不位于道路中心线，为了完整保留道路，所以矩形宽度值应设定为大于道路宽度，并且考虑到分段提取完成后重新连接需要保证段与段之间有一定的重合度，所以矩形的长度值应设定为大于OSM线段长度。根据OSM端点坐标可求得Bounding box四个顶点坐标，利用判断点是否在多边形内部算法PNPoly算法求出所有位于该Bounding box内部的点，即是对应于该段OSM的点云段。 图1. 道路点云提取流程 图2. 利用OSM连接关系对点云分段(蓝色折线是OSM，红色点是折线顶点，绿色矩形框是一段OSM对应的Bounding box)  对于每一段点云，以垂直于道路方向划分格网，此方式划分的格网的每一行可以看作道路横截面，这样就可以利用到道路横截面相邻格网关系这一特征。具体法是对于一段点云，对应的OSM的两个顶点分别为A和B，如图3，首先建立点云局部坐标系，以A为原点，以AB为y轴，垂直于AB方为x轴，根据已知的OSM顶点A和B的坐标求得该坐标系与原始坐标系XOY的旋转角度为θ，通过坐标转换公式(1)，将该段点云的所有点转换到新的局部坐标系xoy坐标系下。然后根据公式(2)进行格网划分，示意图如图4，x min , y min 是该段点云在xoy坐标系下的最小值，GridSize表示格网分辨率的大小，可根据激光扫描仪的分辨率确定，i, j表示该LiDAR点(x, y)在格网中的行列号。 (1) (2)  对于上述建立的格网，通过分析每个格网内部点云的空间特征以及相邻格网特征关系确定每个格网 图3. 建立局部坐标系 图4. 格网划分示意图 的属性，即确定特征图像每个像素灰度值 [ 15 ] ，然后利用改进活动轮廓模型检测道路边缘。本文首先对点云进行格网滤波，然后利用点云高差特征和点云密度特征构建点云特征图。 为了去除路坎周围树木点云的影响，需要对车载激光点云进行高程滤波，去除非地面点。具体方法是首先分析单个格网，先认为每个格网中最低点为地面点，去除该格网内高程大于最低点一定阈值的非地面点，其次分析邻域格网，即判断该格网的最低点与邻域3 × 3格网的最低点之高差，如果高差大于一定阈值或者邻域格网超过半数都为空格网，则判断该格网内所有点为非地面点。图5为了显示出整体滤波效果，将各段滤波结果合并显示，最终滤波结果如图5(c)。图5(b)的结果是没有经过OSM框选的全部点云数据的滤波结果，可以看到距离道路两边较远的范围仍有少量屋顶和树冠被错分为地面点(图中红色的点)，对于这种情况可以通过把所有点云拟合一个平面，根据点到平面的距离将这些噪声点去除。由于这些噪声都已经超出了OSM框选的最大范围之外，所以本文并无此类噪声点。 对于城市环境的道路，路坎是在道路边缘，垂直于路面且与路面有一定高程阶跃的一种结构 [ 16 ] ，路坎的一侧是平坦的道路，另一侧是平坦的人行道。因此包含路坎点云的格网内点云高差应该在一定阈值范围之内，且大于左右两侧格网高差，用公式表达如下， (3) 式中， 表示第(i, j)个格网内的最高点与最低点的高程差值， 和 表示路坎高度范围，具体范围可根据当地公路设计规范查询。 根据车载激光扫描仪的扫描原理和投影点密度理论 [ 17 ] 可知，格网内点云密度DoPP (Density of Projecting Points)值与目标高度成正比，因此在路坎部分会出现局部点密集，即路坎所在格网的点密度应大于左右两侧格网的点密度。对于滤波后留下的围栏底部、建筑物底部以及车辆底部和路坎具有相似的高差特征且密度也大于左右格网，但建筑物和围栏以及车辆有一侧由于遮挡是几乎没有扫描点的，因此可以根据这特征设定一个格网最小点密度DoPP min 来去除滤波后建筑物和围栏以及车辆，用公式表示如下， 图5. (a) 高程赋色的全部原始点云；(b) 各段点云格网滤波结果合并显示；(c) 各段OSM框选范围内的点云滤波结果合并显示 (4) 式中， 表示第(i, j)个格网内扫描点个数， 和 是格网(i, j)的左右格网内扫描点的个数， 表示格网内点云密度最小值。 最后将满足高差和点云密度要求的格网灰度值设置为0，其余格网灰度值设置为255，得到的二值灰度特征图如图6所示，为了显示整体点云的特征图，将所有分段点云特征图拼接显示，注意实际操作中并不需要这样做。  活动轮廓(active contour model, snake)的概念最早由Kass提出 [ 18 ] ，是指一个参数化表达的曲线在内外力的影响下演化到能量最小的对象边缘位置。若轮廓曲线snake的位置用参数表达为 , s表示归一化弧长， ，则其能量函数表示成如下形式 (5) 该能量函数由三个部分组成，第一部分E int 表示内部能量，可写成如下形式 (6) 其中，α(s), β(s)是权重参数，第一项 是曲线的一阶导数，控制曲线的弹性，第二项 是曲线的二阶导数，控制曲线的刚性。第二部分E image 表示图像力，能够把snake吸引到需要的特征区域，如需定位到图像中的边缘位置，则图像能量可写成如下形式 (7) 其中 表示图像梯度。第三部分E con 表示用户自定义的一些限制力。E con 和E image 合称为外部能量E ext 。snake在内部能量和外部能量的共同控制下，在能量函数(5)达到最小化时，snake收敛于目标边缘。 由kass提出的活动轮廓模型存在两个缺点，一是对初始位置敏感，需要依赖其他机制将Snake放置 图6. 各段点云特征图合并显示 在感兴趣的图像特征附近；二是由于Snake模型的非凸性，它有可能收敛到局部极值点，甚至发散。许多学者在此基础上改进传统的snake模型，Xu [ 19 ] 提出的GVFsnake模型引入梯度矢量场 作为新的外力，通过最小化如下能量函数获取 ， (8) 其中μ是权重系数， 是从图像 中提取的边缘图像， 表示边缘图像梯度，是指向目标边缘的梯度向量，在图像同特性区域 ，因此仅使用 作为外力的传统snake模型导致仅在图像边缘区域具有捕获力。而通过最小化上式获取的梯度向量流 在图像同特性区域是缓慢变化的向量流，在图像边缘区域 ，因此GVF snake扩大了传统snake的外力作用范围，加强了对目标凹轮廓边缘的吸引力，并且增加了初始snake曲线位置放置的灵活性。传统snake模型和GVF snake模型的内外力作用方式如图7和图8所示。 图7. 以图像梯度作为外力的snake模型 图8. 以GVF作为外力的snake模型 对于车载激光点云中的道路边界，在车辆遮挡区域和道路出入口无路坎特征，会造成的道路边界特征的缺失，导致道路边界提取不完整和不准确。如图7和图8中的道路右边界，在道路边界缺失的区域，由于缺乏外力的约束会导致snake在该部分的曲线提前结束收敛而造成道路边界提取的不准确。于是本文利用道路的宽度变化是非常缓慢的这特点对活动轮廓模型进行改进，在能量函数上加上宽度约束。文献 [ 20 ] [ 21 ] [ 22 ] 的模型都加了宽度约束，但是这些模型必须具有准确的中心线位置作为初始snake，而本文中的OSM段并不是严格位于道路中心，因为OSM是车辆或行人的行驶轨迹，通常位于道路的靠左侧或者靠右侧。本文结合GVF作为外部能量，提出一种新模型，如图9所示，若用参数 表示初始曲线V即OSM， 分别表示距离左右道路边界的距离，n(s)表示OSM的单位法向量,道路的左右边界线V L ，V R 可表示为 (10) 能量函数为 (11) 式中 表示三种能量的权重系数，其中 的定义和传统snake的定义相同。 的定义使用GVF snake中的梯度矢量流 作为左右边界的外力。为了更准确的效果，应将左右梯度向量投影到 方向 能量函数的最后一项是道路宽度约束，是 的一阶导数，所以最小化该项能保证道路宽度的平缓变化，防止snake在路坎缺失的区域提前结束收敛或者收敛于道路内外侧的噪声区域。 (12) 能量函数 的最小化是通过求解三个分别对应 的欧拉方程实现的，欧 图9. 模型的参数化表达。蓝色折线是OSM作为初始snake，红色点是折线顶点，V L 和V R 是道路左右边界 拉方程的求解和传统snake模型解法相似，需要引入一个步长参数γ和时间参数t进行差分迭代求解。算法步骤如下： 步骤1：用OSM初始化曲线V 步骤2：计算法向量n(s) 步骤3：根据宽度W L (s)，W R (s)和曲线法向量n(s)更新曲线V1和V2 步骤4：计算E int 和E ext ,更新V 步骤5：更新宽度W L (s)和W R (s) 步骤6：重复步骤2-5,直至满足迭代次数要求或达到精度要求。 图10是选取了一段具有代表性的道路进行分析说明，是一段点云完整的处理流程，10(a)一段原始的点云，可以看出该段点云路边停靠多辆车辆，并且有一个道路的出入口，这些地方的路坎特征被遮挡或者无路坎特征。图10(b)是该段点云格网滤波的结果。图10(c)是该段点云生成的特征图，图中的断裂区域对应于上述的车辆遮挡和出入口。图10(d)是用本文提出的改进活动轮廓模型算法提取的道路边缘，可以看出本文算法在无路坎特征区域依然能使曲线收敛于准确的道路边缘。"
"本实验采用Street Mapper 360 MLS系统采集的城市环境扫描数据，其扫描范围约118 m × 110 m，扫描点的密度约为25~35 points/m，共7,116,542个数据点。数据中包含了大量的复杂城市地物，包括房屋，树木、草地、车辆以及电力线等，数据密度较大但有较多由于车辆造成的遮挡。 本文中使用的参数值列于表1中，其中能量函数所涉及的权重系数都使用常数。  将分段提取得到的2D道路边界重新拼接形成完整的2D道路边界，如图11(a)中的蓝色边界，拼接时可以利用OSM的拓扑关系进行拓扑重构，如果两段OSM之间是邻接关系，则它们对应的左右边界也分别邻接，只需要找出对应的交点作为邻接点。由于在第一步分段的保证了段与段之间的重叠性，因此上段边界和下段边界之间有一定的重合性，则以他们的重合点作为公共交点进行连接，为了防止没有重叠点的情况，上段边界尾点和下段边界的首点之间距离小于一定阈值，则也进行连接。最后对2D的边界线矢量化并赋予高程值，将2D的边界线转化成3D的边界线，并将OSM的语义信息赋给该3D道路边界， 图10. (a) 含有车辆遮挡和道路出入口的点云段；(b) 滤波去除非地面点；(c) 对应点云特征图；(d) 边界提取结果，蓝色线是OSM，红色线是提取的边界 图11. (a) 二维道路边界转化成三维道路边界并将OSM的语义信息赋给三维道路边界，蓝色线表示二维道路边界，红色线表示三维道路边界；(b) 三维道路边界与点云叠加显示 Table 1 Parameter Value Parameter Value Parameter Value Grid Size 0.1 m Δh min 0.1 m Δh max 0.2 m Bounding Box Width 2 Road Width DoPP min 10 points/dm 2 α 0.01 β 100 κ 1 ω 10 ψ 5 γ 10 pixels 表1. 本实验中所使用的参数值 得到的最终结果如图11，11(a)中蓝色线表示矢量化的2D边界，红色线是矢量化的3D边界，11(b)是3D矢量边界和点云的叠加显示效果。  本文软件开发环境是visual studio 2013，硬件开发环境是Intel Xeon E3处理器，3.0 GHz，16 G内存，四核cpu。在此软硬件开发环境下对上述数据进行实验最终耗时6 min，其中生成特征图耗时不到10 s，主要耗时在边缘提取部分，虽然改进活动轮廓模型耗时较长，但其提高了道路边缘提取的准确性，尤其在路坎被遮挡区域，如下图12是使用GVF模型和本文算法模型进行的对比实验，图(a)是使用GVF模型提取的边缘，可以看出在车辆遮挡的区域，特征图中此区域无边缘特征，因此缺乏外力约束，导致该部分曲线提前结束收敛造成边缘提取的不准确。而本文所提出的算法，在该区域由于宽度约束使其正确检测出道路边缘位置。"
"本文提出了一种利用二维矢量数据OpenStreetMap辅助车载LiDAR点云进行道路三维边界提取的一种方法，本文算法解决了在路坎被车辆遮挡以及道路出入口的路坎缺失造成的道路边界不完整问题，提高了路坎提取的效率和准确率，并且把OSM数据丰富的语义信息、拓扑信息和LiDAR点云的高程信息相互融合，最终形成具有语义的准确的道路三维矢量边界信息，可直接用于基础地理信息数据的更新，也可应用于三维导航、智慧城市等。本文实验未涉及复杂道路的拓扑构建，但其处理方式和本文相同， 图12. (a) 用GVF模型提取的二维边界；(b) 对应三维道路边界与点云叠加显示；(c) 用本文提出算法提取的二维道路边界；(d) 对应三维道路边界与点云叠加显示 都是利用OSM的拓扑关系来判断其对应边界的拓扑关系。本文算法的精度部分依赖于OSM的精度，但是随着移动端GPS的发展，OSM的精度已经越来越高。 本文适用于提取复杂城市街道具有规则或不规则路坎形状的道路边缘，本文只用到了点云的高程信息，因此未来的一个工作方向可以利用点云的强度、颜色以及纹理信息，提高适用性，进行乡村环境无路坎特征的道路边缘提取。此外本文也可用于建筑物的提取，此时活动轮廓模型的约束力将不再是平行约束，而是适用于建筑物的约束条件。"
