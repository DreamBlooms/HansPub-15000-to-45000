"本文依托贵州的多条隧道工程，通过跟踪施工开挖进度，对比分析施工揭露实际情况与TRT超前地质预报图像特征的关系，总结出了溶洞、破碎带、断层等岩溶地区典型不良地质现象所对应的TRT预报图像特征。根据TRT预报图像的特点，提出采用颜色直方图对比法可以较好地辅助TRT图像的判别，以溶洞和破碎带两种不良地质现象为例，基于OpenCV编制了TRT图像的颜色直方图提取与分析程序；基于TRT预报特征图像库，提出了未知图像与特征图像的匹配方法，编制了多种匹配方法的计算程序，给出了定量化的匹配度来辅助判断TRT图像反应的不良地质现象。基于直方图对比分析技术的隧道超前地质预报判译方法推动了地质预报向定量化、自动化的发展，并且在实际工程应用中获得较好的效果。 关键词 :隧道，超前地质预报，颜色直方图，匹配度 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"由于地质环境的复杂性，隧道在开挖过程中经常会遇到与设计不符的不良地质现象，从而造成突水、突泥、垮塌等事故 [ 1 ]，对隧道内施工相关人员生命财产安全造成巨大威胁，因此在隧道施工过程中，开展超前地质预报，为施工人员提供掌子面前方的准确地质情况，指导其安全施工就显得尤为重要。 自从1972年8月在芝加哥召开快速掘进与隧道工程会议以来，超前地质预报工作就一直受到各国的重视，我国也于上世纪90年代初开始了相关研究。超前导洞、超前钻探方法最先被用来勘探掌子面前方的地质情况，随后地球物理超前探测技术，包括地震发射类、电磁类、直流电法类等，也大量应用于工程实践 [ 2 ]。 李术才等提出了一种多同性源阵列观测模式，兼顾了三极测深探距大和聚焦观测抗干扰能力强的优势，在钻爆法施工隧道得到成功验证 [ 3 ]。张向东等采用反射共偏移法对某煤矿回风大巷断层情况进行了预报 [ 4 ]。姚海波等基于Google-earth全方位、多角度的地貌影像数据，识别区域构造次级构造，并建立了隧址区构造格架体系 [ 5 ]。高峰等建立基于TRT技术的井下超前预报基本程序，运用TRT6000系统，开展井下地质超前探测和预报 [ 6 ]。刘新荣等以地质雷达为超前预报的主要手段，结合TGP206地震反射波法和工程地质调查法，针对某特长隧道开展综合超前地质预报 [ 7 ]。刘斌等人针对TBM施工过程遇到的问题，提出了一套以地球物理超前地质预报和基于“岩–机关系”预测岩体主要参数的解决方法，并为TBM掘进方案决策提供依据 [ 8 ]。李术才等提出跨孔电阻率CT方法用于地铁超前预报 [ 9 ]。邱道宏等提出了基于数字钻进技术和量子遗传–径向基函数神经网络的围岩类别超前分类方法 [ 10 ]。谭信荣等根据隧道工程所处的地质环境，利用地质模型判断未开挖岩层中的岩溶发育类型、规模等情况 [ 11 ]。曹国侯等基于弹性波三维空间传播理论，应用地震波共反射面元叠加“偏移成像”和“相控阵”等技术，对掌子面前方地质情况和不良地质体高精度准确定位 [ 12 ]。李术才等通过分析突水风险孕险环境与致险因子，结合施工工程动态信息，提出并成功实施一种基于隧道施工风险评估的超前地质预报体系 [ 13 ]。王传武等将地面三维电阻率观测模式引入到隧道超前预报中，提出了基于三维电阻率的隧道超前探测新型观测模式 [ 14 ]。李术才等通过三维数值试验和模型试验研究，提出隧道瞬变电磁超前预报平行磁场响应探测方法 [ 15 ]。 现有的各种隧道超前地质预报技术都存在各自限制，因此开展综合超前地质预报已成为业界共识，如：舒森等在综合地质预报中引入三维数据处理技术以获取岩溶异常三维信息，根据三维信息制定专项钻探动态设计方案 [ 16 ]。周轮等提出采用采用宏观地质分析法、TSP地震波法、地质雷达法、掌子面围岩预判以及超前钻探相结合的方法进行综合超前地质预报，提高对不良地质体预报的准确率 [ 17 ]。江杰等提出洞外采用高密度电法，洞内采用掌子面素描和地质雷达对地铁施工进行超前地质预报 [ 18 ]。姚林林等以西藏某公路隧道为例介绍了以“前期地质工作是基础，物探工作是手段，地质分析是主线”为思路的地质预报综合技术 [ 19 ]。任涛等在总结地震区隧道灾害特征及成因的基础上，采用短距离地质分析与长距离物探监测相结合的方法进行超前地质预报工作 [ 20 ]。与此同时，还有学者在对超前地质预报探测成果解译方面进行了研究，如：陈礼彪等建立地震波反射法(TGP)成果中的反射幅度比、波轴相似度等参数对异常地质体的地震动态响应特征 [ 21 ]。李宝奇等针对隧道地质超前预报过程中探地雷达线测图解释仅依靠专家经验且存在准确率不高的问题，提出一种改进的基于压缩感知和深度置信网络的线测图分类解释模型 [ 22 ]。吴回获等对影响TSP超前地质预报准确性的相关问题进行了深入研究，提出了相应措施，有效地提高了超前地质预报的准确性 [ 23 ]。 虽然经过长期的科学研究和现场实践，超前地质预报技术得到长足的发展，但是目前仍存在预报精度不高的问题；尤其是在复杂地质条件下，预报结果可靠性不高，究其原因就是在复杂地质条件下，影响地震波(或电磁波)反射信息的因素太多；相同的不良地质现象在不同的地质条件和地质环境下其反射信息不同，因而生成的预报结果图像亦差别较大，因此对预报结果的判译往往要依靠预报工作人员的经验。本文依托贵州的多条隧道工程，采用TRT地震波反射法进行超前地质预报；通过分析TRT探测结果的图像特征，选取了HSV颜色直方图对比法来对TRT图像进行计算机图像识别，通过输出匹配度的方式对贵州岩溶地区隧道中的溶洞和破碎带两种不良地质现象加以区分，实现程序自动识别；将该套TRT图像识别方法用于多条隧道工程，实际检验效果良好。"
"TRT超前地质预报技术引进国内已有10余年，并在大量隧道工程中进行了应用，不少学者总结了不同不良地质现象的特征图像，但是如前文所述，不同地区与不同地质条件下，相同不良地质现象的特征图像往往亦存在较大差异，因此欲提高超前地质预报的精度，进一步确定工程区域各种不良地质现象的特征图像是必不可少的工作。本文通过跟踪贵州中部地区两条铁路隧道的施工开挖进度，实地对比分析施工揭露的不良地质现象与TRT图像特征的关系，建立了溶洞、破碎带、断层等典型不良地质现象所对应的TRT特征图像库，总结了这些不良地质现象的基本图像特征，为后续超前地质预报计算机自动判译提供依据。  渝黔铁路(重庆至贵阳铁路)高寨坝隧道进口在开挖到D2K320 + 270段时揭露了大型破碎带，掌子面出露大范围破碎的强风化灰岩，如图1所示，其对应的TRT图像如图2中红框范围所示，图中自上至下分别为俯视图、侧视图和立体图。 从图2可以看出，破碎带图像特征为：黄色区域和蓝色区域成斑点状离散分布，不同颜色无明显连通，彼此间颜色差异较明显，边界不清晰。 图1. 高寨坝隧道DK320 + 270所揭露破碎带 图2. 高寨坝隧道TRT成像图(掌子面里程DK320 + 250)  渝黔铁路蔡家关隧道进口在开挖至DK308 + 120附近时遇到了大型充填型溶洞，如图3所示，溶洞被流塑状饱水黏土所填充，其对应的TRT图像如图4中红框范围所示。 图3. 蔡家关隧道DK308 + 120所揭露的溶洞 图4. 蔡家关隧道TRT成像图(掌子面里程DK308 + 005) 从图4可以看出，溶洞的图像特征为：成片状分布的蓝色区域相互连通，整体呈现立体分布，与周围岩体波速差异明显；当溶洞未充填或被水充填时，蓝色波速区域成连贯的立体分布且与周围介质具有明显边界；当溶洞被土体或石块充填时，代表溶洞的蓝色区域内夹杂有黄色斑点或小范围块状分布。  织纳铁路(贵州织金至纳雍铁路)小田坝隧道出口在开挖至DK37 + 375段时揭露了一张性断层，断层面之间被大量粘土填充，如图5所示，其对应的TRT图像如图6所示。 从图6可以看出，断层的图像特征为：成片状分布的黄色或蓝色区发生明显的错动，隧道中线前方的异常区存在明显的空隙，断裂面两侧的岩性有明显的差异。 图5. 小田坝隧道于DK37 + 375所遇断层 图6. 小田坝隧道TRT成像图(掌子面里程DK37 + 385)"
"图像识别的前提条件是对图像的特征提取，选择合适的特征非常重要，其会影响到图像识别程序的设计、性能以及最终识别结果的可靠性和准确性。一般情况下描述图像特征可以用点、线、面来描述，基于特征的匹配所处理的图像一般包含的特征有颜色特征、纹理特征、形状特征、空间位置特征等。在与地质工程相关的工程及测绘领域所识别的图像大多都是同一区域不同时间段的图像，如针对遥感图像的滑坡检测、隧道衬砌裂隙识别、边坡变形监测等，这些图像的一个重要特征就是重叠部分多，特征点及特征区域明显，识别起来可行性高。 TRT图像一大特点是杂乱——没有明显的线条特征，没有能作为基准的兴趣点，而典型的图像识别技术都是基于特征点的识别，如人脸识别、指纹识别等。然而，对TRT图像的识别归根结底是对不良地质现象的识别，而不是对物体本身的识别。不良地质现象不具备稳定的视觉特征，以溶洞为例，溶洞的形态千奇百怪，有管型的、漏斗形的、纺锤形的、硐室形的，发育的方向也是难以捉摸，无法用形状特征予以描述，更不用说纹理以及高层语义特征。因此难以使用传统的基于特征点的图像识别方法对其进行识别。 但是，TRT图像中的不良地质现象也有其显著的特征——颜色，蓝色区域代表着低波速区，也就是破碎的、强度较低的区域；黄色区域代表着高波速区，也就是致密的强度较高的区域。同时，颜色也是地质类相关专业的最重要的视觉指标之一，如对岩石的确认，颜色都是作为一个非常重要的标志。因此，本文利用基于颜色的图像识别技术——颜色直方图对比法对TRT图像特征进行分析。  颜色直方图是在图像检索领域中采用最为广泛的颜色特征，它描述了一张图像中关于颜色的数量特征，可以反映图像的颜色统计分布，表示了每个颜色范围内像素数的个数(通常会进行归一化以保证适应尺度的变化)，但丢失了像素的空间信息，因此无法描述图像中的对象及物体。以最简单的灰度直方图为例，其可以定义为： H ( k ) = n k N , k = 0 ,   1 ,   2 , ⋯ , L − 1 (1) 其中，N为图像的总像素数，L为颜色直方图的颜色级数，对于灰度直方图来说就是灰度级数，表示把0~255的灰度值分割的区间数(bin)，n k 为第k级颜色区间包含的图像像素数。对于其他如RGB、HSV颜色直方图来说，原理与上式一致，只不过通道数或者特征空间数更多。 根据上述我们可以得知，颜色直方图可以理解为一个图像信息的集合，可以利用计算集合间的距离来判断两张图片的相似度。颜色分布直方图所描述的是不同色彩在整幅图像中所占的比例，而并不关心每种色彩所处的空间位置。在TRT图像识别中，这个问题可以由手动截取感兴趣的不良现象区来解决，可以使用一个模板可以对选定的不同尺寸的TRT图像进行匹配识别。  TRT图像识别基于开源代码OpenCV3 (Open Source Computer Vision Library)的算法，对其实例进行了一定程度的修改以适应对TRT图像进行识别的需求，程序基于WIN7 64位旗舰版、Microsoft Visual Studio 2010和OpenCV3，通过C++编写 [ 24 ]。 本文以破碎带和溶洞两种不良地质现象的TRT图像识别为例，程序主要采用图像匹配的方法针对TRT俯视图进行识别，将测试图像与模板图像进行匹配，根据匹配度判断测试图像所代表的不良地质现象类型。图7是上述经过现场验证的典型溶洞和破碎带特征图像，从左至右分别为溶洞图像1、溶洞图像2、破碎带图像3、破碎带图像4。 图7. TRT模板图像 在进行TRT图像直方图对比之前，我们需要手动选取待测的异常图像区，选取时对尺寸没有要求，但边界部分选取时不能有过多的非异常区(底色)存在，如图8所示。图8是渝黔铁路中寨隧道某次TRT检测结果图中待确定不良地质现象类型的局部裁剪图。 图8. 裁剪的某张TRT图像局部  TRT图像直方图对比代码实现主要包括读取图片、色彩空间转换、HSV直方图计算、直方图对比四个步骤。 1) 读取图片：配置好OpenCV后，图像读取非常便利，可以直接使用“imread”读取图片，可以直接把待检测图像放入相应的工程目录下，也可以直接引用图片的储存地址； 2) 色彩空间转换：对于TRT图像来说，颜色特征并没有自然界场景那么复杂，但由于较为成熟有效的直方图匹配技术都是基于HSV色彩空间的，所以进行直方图对比前要先进行色彩空间的转化，需要注意的是OpenCV读取彩色图像时的通道顺序为蓝绿红(BGR)，而不是我们一般讲的红绿蓝(RGB)； 3) HSV直方图计算：OpenCV中可以使用calcHist( )函数来计算直方图，在使用之前需要初始化直方图实参，选择合适的bin数及取值范围。bin可以翻译为组距，代表着每个特征空间子区段的数目，其数值为从数据中计算出的特征统计量。选择合适数目的bin可以降低直方图维数，提高识别及匹配的效率； 4) 直方图对比：OpenCV中可以使用compareHist( )函数进行直方图对比，此函数的返回值为d(H 1 , H 2 )，即两张直方图的距离。  在OpenCV中比较两个直方图的相似程度有4种不同的距离标准 [ 25 ]： 1) 相关 d ( H 1 , H 2 ) = ∑ I ( H 1 ( I ) − H 1 ¯ ) ( H 2 ( I ) − H 2 ¯ ) ∑ I ( H 1 ( I ) − H 1 ¯ ) 2 ∑ I ( H 2 ( I ) − H 2 ¯ ) 2 (2) 其中： H k ¯ = 1 N ∑ J H k ( J ) (3) N为第三步设置的bin数。 2) 卡方 d ( H 1 , H 2 ) = ∑ [ H 1 ( I ) − H 2 ( I ) ] 2 H 1 ( I ) (4) 3) 直方图相交 d ( H 1 , H 2 ) = ∑ I min [ H 1 ( I ) , H 2 ( I ) ] (5) 4) Bhattacharyya距离(巴氏距离) d ( H 1 , H 2 ) = 1 − 1 H 1 ¯ H 2 ¯ N 2 ∑ I H 1 ( I ) H 2 ( I ) (6) 按照第3.4节中的图像对比匹配步骤，采用上述4种对比方法，将图8依次与图7中的4张标准图进行对比分析，计算得到它们的匹配度，如表1所示。 Table 1对比图像 对比方法 溶洞图像1 溶洞图像2 破碎带图像3 破碎带图像4 相关法1) 0.87 0.85 0.55 0.51 卡方法2) 19.62 29.39 81.93 88.06 直方图相交法3) 24.75 26.20 28.84 27.89 巴氏距离法4) 0.35 0.39 0.38 0.40 表1. 图8与图7的匹配度 对于相关法和直方图相交法，匹配数值越高说明匹配度越高；对于卡方法和巴氏距离法，匹配数值越低匹配度越高。从表1可知，根据相关法和卡方法，图8与图7中溶洞图像1、2匹配度较高；而直方图相交法和巴氏距离法显示图8与图7中的4张图匹配度相当。 实际上在计算机图像学中，4种对比方法孰优孰劣并没有定论，为保证对比分析的稳定性和可靠性，可以通过对4种方法计算得到的匹配度进行加权平均来得出一个较为稳妥的匹配度。计算公式如式(7)所示，由于4种方法计算得到的匹配度值量值范围不一致，因此在对其进行加权平均前需要对它们进行均一化处理，如式(8)、式(9)所示： D i ¯ = ∑ j = 1 4 D i j 4           ( i = 1 ~ 4 , j = 1 ~ 4 ) (7) 式中， D i ¯ 为图7与图6中第i个图像的加权平均匹配度；D ij 为图7与图6中第i个图像采用第j种方法计算得到的均一化匹配度。 D i j = d i j ∑ i = 1 4 d i j         ( i = 1 ~ 4 , j = 1 ,   3 ) (8) D i j = 1 d i j ∑ i = 1 4 1 d i j         ( i = 1 ~ 4 , j = 2 ,   4 ) (9) 式中，d ij 为图8与图7中第i个图像采用第j种方法计算得到的匹配度。 令： D K = D 1 + D 2 (10) D F = D 3 + D 4 (11) 可以得到图8与溶洞的匹配度(D K )和破碎带的匹配度(D F )。 根据上述计算过程，可以得到图8与溶洞(D K )和破碎带(D F )的匹配度分别为0.6和0.4，说明图8反应的不良地质现象为溶洞。经现场揭露，该位置确实为一溶蚀带，发育多处小型溶穴、溶槽，个别溶穴直径达到1 m。"
"渝黔铁路中寨隧道进口施工到DK304 + 127处进行了一次TRT超前地质预报，得到预报的俯视图如图9所示，对图中红框范围内的图像进行颜色直方图对比分析，得到其与溶洞和破碎带的匹配度分别为0.64和0.36，判断该位置有溶洞发育；经实际施工揭露，该处为大型充填型溶洞(如图10所示)，与程序判断结果吻合。  织纳铁路小田坝隧道进口施工到DK34 + 401处进行了一次TRT超前地质预报，得到预报的俯视图如图11所示，对图中红框范围内的图像进行颜色直方图对比分析，得到其与溶洞和破碎带的匹配度分别为0.68和0.32，判断该位置有溶洞发育；经实际施工揭露，该处为大型充填型溶洞(如图12所示)，与程序判断结果吻合。 图9. 中寨隧道超前地质预报俯视图 图10. 中寨隧道施工揭露围岩照片 图11. 小田坝隧道超前地质预报俯视图 图12. 小田坝施工揭露围岩照片  渝黔铁路修文隧道进口施工到DK314 + 210处进行了一次TRT超前地质预报，得到预报的俯视图如图13所示，对图中红框范围内的图像进行颜色直方图对比分析，得到其与溶洞和破碎带的匹配度分别为0.48和0.52，两种不良地质现象的匹配度相当，根据计算结果应偏向于破碎带；经实际施工揭露，该处为溶蚀破碎带，存在多条小型溶沟、溶槽，沟槽内充泥，岩体破碎(图14)。 图13. 修文隧道超前地质预报俯视图 图14. 修文施工揭露围岩照片"
"本文依托贵州的多条隧道工程，采用TRT超前地质预报方法对隧道掌子面前方围岩进行探测，并利用基于颜色的图像识别技术——颜色直方图对比法对TRT图像特征进行分析，得到如下主要结论： 1) 通过跟踪施工开挖进度，实地对比分析施工揭露结果与TRT预报图像特征的关系，总结了溶洞、破碎带、断层等典型不良地质现象所对应的TRT预报图像特征； 2) 基于TRT预报图像的特点，提出采用颜色直方图对比法可以较好地辅助TRT图像的判别，以溶洞和破碎带两种不良地质现象为例，基于OpenCV编制了TRT图像的颜色直方图提取与分析程序； 3) 基于TRT预报特征图像库，提出了未知图像与特征图像的匹配方法，编制了多种匹配方法的计算程序，给出了定量化的匹配度来辅助判断TRT图像反应的不良地质现象。 基于直方图对比分析技术的隧道超前地质预报方法推动了地质预报向定量化、自动化的发展，并且在实际工程应用中获得较好的效果。"
