"分层启动压力是确定分层注水方案的主要依据，是开展多层油藏层间治理，实现精细注水的前提和基础。本文基于中原油田东濮老区油藏特性，研究了启动压力梯度随储层物性的变化规律，基于BP神经网络建立了小层启动压力预测模型，形成一套适合油藏特点的启动压力求取方法，对于指导油田精细注水、改善注水开发效果具有重要意义。 关键词 :分层启动压力，神经网络，预测技术，中原油田，精细注水 Copyright © 2020 by author(s), Yangtze University and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"中原油田属于多层砂岩复杂断块油藏，层内非均质性强，层间渗透率级差大，经过长期注水开发，层间矛盾进一步加剧。注水井各小层吸水不均匀，导致纵向上注水波及体积小，水驱效率低。渗透率较高层吸水很多，产生单层突进现象，而低渗层却不吸水 [ 1 ]。确定小层启动压力是老油田开展多层油藏层间治理、实现精细注水的前提和基础。 目前国内外有关油藏注水启动压力方面的研究极少，荣准 [ 2 ] 等人在考虑储层物性参数和油藏动态因素的基础上，基于有限的现场分层测试资料，采用神经网络方法预测注水启动压力。但由于考虑的因素不全，未考虑启动压力梯度影响，且采用的样本数据有限，因此研究成果不具备普遍推广应用价值。 常规确定注水井小层启动压力的测试方法有管柱法、氧活化测试 [ 3 ]、试井解释及分层测试等。受储层条件及井况的限制，分层启动压力测试技术难度大，成本高，测试周期长，同时由于分层启动压力测试井数少而且分散，难以形成规律性认识。 本文通过开展岩心高压驱替试验，确定注水启动压力的主要影响因素，研究启动压力梯度随储层物性的变化规律，建立小层启动压力预测模型，形成一套适合油藏特点的启动压力求取方法，对于指导油田精细注水、改善注水开发效果、提高注水效率和经济效益等，具有重要意义。"
"采用稳态法岩心驱替试验，从物性、压力、不同渗透率组合等方面开展启动压力梯度与岩石主要物性参数之间的关系研究 [ 4 ]，确定启动压力梯度的主要影响因素。 图1. 启动压力梯度与孔隙度关系图版 图2. 启动压力梯度与渗透率关系图版 从图1、图2中可以看出随着岩心孔隙度、渗透率的降低，启动压力梯度分别呈上升趋势，其中渗透率小于10 × 10 −3 μm 2 时，启动压力梯度随渗透率的减小急剧增大，注水难度增大。 通过实验分析，影响启动压力梯度的主要因素包括：孔隙度、渗透率、束缚水饱和度、残余油饱和度、含水饱和度、平均孔喉半径(粒度中值)、原油粘度等，其中某些因素的影响是显著的，某些是不敏感的。选择束缚水饱和度、黏土含量、孔隙度、渗透率、粒度中值、残余油饱和度、原油粘度、平均孔吼半径，等参数作为预考虑的影响参数。通过灰色关联分析，用灰色关联度的大小来描述因素之间联系的强弱与顺序关系。"
"以渗流力学理论为依据 [ 5 ]，采用灰色关联分析法 [ 6 ]，选择孔隙度、渗透率、油水粘度比、黏土含量、束缚水饱和度、含水饱和度、残余油饱和度、启动压力梯度、地层压力、吸水指数、吸水层有效厚度、表皮系数12个参数作为注水分层启动压力的预考虑影响因素。 根据关联度计算结果排序为地层压力 > 渗透率 > 残余油饱和度 > 含水饱和度 > 束缚水饱和度 > 启动压力梯度 > 油水粘度比 > 孔隙度 > 吸水指数 > 黏土含量 > 吸水层有效厚度 > 表皮系数。 研究表明，目的区块地层压力、渗透率、残余油饱和度、含水饱和度、束缚水饱和度、启动压力梯度、油水粘度比、孔隙度、吸水指数对分层启动压力影响显著，黏土含量、吸水层有效厚度、表皮系数对分层启动压力影响相对较弱。"
"由于启动压力是一个多因素影响下的非线性因素，利用人工神经网络原理建立启动压力的BP人工神经网络预测模型。  BP神经网络是一种按误差反向传播(误差反传)训练的多层前馈网络 [ 7 ] (见图3)。BP算法包括信号的正向传播和误差的反向传播 [ 8 ] 两个过程，即计算误差输出时按从输入到输出的方向进行，而调整权值和阈值则从输出到输入的方向进行。输入层各神经元接收来自外界的输入信息，并传递给中间层各神经元，而中间层负责信息转换，误差通过输出层，按误差梯度下降的方式修正各单元权值，向隐层、输入层逐层反传 [ 9 ]。经过反复学习训练，神经网络即能对类似样本的输入信息自行处理输出误差最小的经过非线形转换的信息(见图4)。 图3. BP网络结构 图4. 三层BP网络图 输出层的输出向量用o表示，其中列向量 o k 为输出层第k个神经元对应的输出向量；期望输出向量用d表示，其中列向量 d k 为输出层第k个神经元对应的期望输出向量；输入层到隐含层之间的权值矩阵用v表示，其中列向量 v i j 为由输入层第i个神经元输入隐含层，在隐含层中第j个神经元对应的权向量；隐含到输出层之间的权值矩阵用w 表示 ，其中列向量 w j k 为由隐含层第j个神经元输入输出层，在输出层中第k个神经元对应的权向量；i表示输入神经元个数；j表示隐含层神经元个数；k表示输出神经元个数。 对于一个单隐层的三层感知器，各层信号之间的数学关系 [ 10 ] 如下： 对于输出层： o k = f ( n e t k ) ,     k = 1 , 2 , ⋯ , l (1) n e t k = ∑ j = 0 m w j k y j ,     k = 1 , 2 , ⋯ , l (2) 对于隐含层： y j = f ( n e t j ) ,     j = 1 , 2 , ⋯ , m (3) n e t j = ∑ i = 0 n v i j x i ,     j = 1 , 2 , ⋯ , m (4) 变换函数 f ( x ) 均为单极性Sigmoid函数 f ( x ) = 1 1 + e − x (5) 当网络输出与期望输出不等时，存在输出误差E，定义如下 E = 1 2 ( d − O ) 2 = 1 2 ∑ k = 1 l ( d k − o k ) 2 (6) 对于隐层有 E = 1 2 ∑ k = 1 l [ d k − f ( n e t k ) ] 2 = 1 2 ∑ k = 1 l [ d k − f ( ∑ j = 0 m w j k y j ) ] 2 (7) 对于输入层有 E = 1 2 ∑ k = 1 l { d k − f [ ∑ j = 0 m w j k f ( n e t j ) ] } 2 = 1 2 ∑ k = 1 l { d k − f [ ∑ j = 0 m w j k f ( ∑ i = 0 n v i j x i ) ] } 2 (8) 网络输入误差是各层权值 w j k 、 v i j 的函数，调整仅值可改变误差E。调整权值的原则是使误差不断地减少，因此应使用权值的调整量与误差的梯度下降成正比，即： Δ w j k = − η ∂ E ∂ w j k ,     j = 0 , 1 , 2 , ⋯ , m ;     k = 1 , 2 , ⋯ , l (9) Δ v i j = − η ∂ E ∂ v i j ,     j = 0 , 1 , 2 , ⋯ , n ;     k = 1 , 2 , ⋯ , m (10) 式中，负号表示梯度下降，常数 η ∈ ( 0 , 1 ) 表示比例系数， η 为学习速率，y为本层输入信号， δ 为本层输出的误差信号。  基于上述BP神经网络理论方法和灰色关联分析结果，确定小层启动压力的主要影响因素，剔除无关和不敏感因素，以束缚水饱和度、地层压力、黏土含量、残余油饱和度、粒度中值、原油粘度、含水饱和度、启动压力梯度、绝对吸水量、孔隙度、吸水层有效厚度、吸水指数、渗透率等参数作为参与训练学习的影响因素参数，启动压力作为目标函数。BP神经网络通过训练学习，多次检验误差来调试模型误差达到最小，最终确定误差最小且较为合理的模型参数，建立稳定的预测模型，利用这个预测模型即可预测在诸多影响因素为已知情况下的启动压力。 收集整理W81和PNS2X两个区块的物性数据及分层启动压力测试资料作为样本数据，进行训练学习。随着样本数据训练次数的增加，各层预测误差进一步减小，拟合程度较好，网络训练后的预测值与实际值误差有较大的改善(见图5)，检测结果证明网络稳定，收敛速度快，预测的结果可信(见表1)。 图5. 网络误差随训练次数的变化图 Table 1 区 块 模 型 训练次数 训练精度 训练效率 总体相对误差 W81 模型一 20,000 0.005 0.1 7.55 模型二 20,000 0.005 0.05 7.96 PNS2X 模型一 150,000 0.005 0.5 5.99 模型二 150,000 0.005 0.3 5.30 表1. 网络训练参数与总体相对误差 根据建立的区块启动压力预测模型，分别对部分注水井小层启动压力进行了预测分析，表2列出了实验数据与预测结果，可以看出，根据启动压力预测模型计算的预测结果与实测数据符合性较好，相对误差基本控制在一定范围内，预测结果是准确的。 Table 2 井名 孔隙度(%) 渗透率(Md) 束缚水饱和度(%) 残余油饱和度(%) 粒度中值(mm) 含水饱和度(%) 启动压力实测值(MPa) 启动压力预测值(MPa) 相对误差(%) WC145-19 14.03 3.27 40.34 44.26 0.06 48.27 20.35 19.88 2.31 WC145-29 14.54 3.89 39.45 43.51 0.06 50.59 20.27 20.76 2.42 WC215-39 9.00 0.58 50.25 52.45 0.04 68.06 45.97 45.07 1.96 WC263-44 22.17 53.40 27.96 33.64 0.04 36.30 38.83 38.96 0.33 WC263-45 21.89 48.37 28.34 33.97 0.04 47.25 38.97 38.28 1.77 WC381-32 12.44 1.89 43.26 46.71 0.05 62.73 15.10 15.66 3.71 WCN150-49 16.89 8.72 35.57 40.19 0.06 47.93 17.01 16.48 3.12 WCN233-29 16.72 8.20 35.85 40.43 0.06 57.37 11.38 11.75 3.25 P3-358-33 21.97 38.33 28.31 34.32 0.07 31.24 15.36 16.12 4.95 P3-358-47 19.06 9.35 32.37 38.65 0.03 38.33 14.74 14.52 1.49 P3-360-24 20.40 17.93 30.47 36.59 0.09 31.99 20.55 21.02 2.29 P3-426-38 17.36 4.10 34.90 38.43 0.08 35.92 12.28 12.18 0.81 P3-426-40 20.92 23.02 29.75 35.83 0.06 35.61 11.11 11.54 3.87 P3-428-42 19.78 13.23 31.34 37.54 0.08 37.30 11.57 11.28 2.51 表2. 实验数据与预测结果"
"1) 结果表明：基于BP神经网络，建立综合考虑启动压力梯度、储层特性及注水条件等因素的注水小层启动压力预测技术是可行和可靠的，适用于同类油藏在没有测试资料的条件下确定各小层启动压力，可以为分层治理提供决策依据，有效指导老区精细注采，提高水驱动用程度。 2) 应用区块样本数据的准确性对于启动压力预测数据的精度有着直接的关系，建议结合油藏地质特性建立相关物性参数模型，以保证样本数据的准确性，提高小层启动压力预测的精度。 3) 分层启动压力的影响因素较多，这些因素之间又存在一定的关联，并且不同地区各影响因素之间的关联性不是一成不变的，针对目标油藏的影响因素分析及小层启动压力预测有待进一步研究和完善。"
