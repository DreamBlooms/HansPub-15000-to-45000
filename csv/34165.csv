"本文研究微电网的运行优化问题。为获取微电网系统的最优运行策略以及降低微电网在运行过程中的综合费用，文中首先建立了微电网运行的一般数学模型，并对遗传退火算法中的退温函数进行了改进，加快遗传退火算法的收敛速度，使得遗传退火算法更为高效。然后分别采用遗传算法(Genetic algorithm, GA)、模拟退火算法(Simulated annealing algorithm, SA)以及改进后的遗传退火算法(GSAA)对并网模式下微电网运行模型和孤岛模式下的微电网运行模型进行优化求解。最后，分别对并网模式和孤岛模式的两种微电网优化结果和运行策略进行分析。仿真结果表明改进后的遗传退火算法具有收敛速度更快和运行费用更低的特点。 关键词 :微电网，优化调度，遗传退火算法，模拟退火算法，遗传算法 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"伴随着经济的发展与社会的进步，各个国家对于电能的需求也越发的紧张，电网规模不断扩大。超大规模的用电系统也导致了用电成本高、运行难度大、难以满足多样化满足用户等问题。考虑到未来能源问题、电网建设成本问题以及提高电力系统的可靠性，分布式电源配合电网是未来发展的主要趋势 [ 1 ]。微电网从本质上改变了传统配电网单一电力潮流的拓扑结构，将连接在配电网等级的分布式电源与储能、负荷划分为一个小整体进行协同规划、设计、运行控制以及保护 [ 2 ] [ 3 ]。微电网是当前重要的研究热点之一，内容涉及微电网的结构设计、运行控制、电能质量、经济运营、仿真分析、示范工程等诸多研究方面 [ 4 ] [ 5 ]。随着分布式能源、储能装置和直流负荷的逐步渗透并与现有交流电力系统建立深度结合，可以最大程度地满足能源就地消纳、负荷需求响应等个性化需要，使电网规划设计更具灵活性，因此推动微电网技术的广泛应用均具有十分重要的意义。为了进一步提高微电网系统的经济效益和环境效益，科学扩展储能系统的使用范围，本文研究基于电价及环境费用机制下微电网成本最低优化运行问题 [ 6 ] [ 7 ]。 随着微电网技术的不断推广应用，如何妥善管理微电网内部分布式电源和储能的运行，实现微电网经济、技术、环境效益的最大化成为重要的研究课题 [ 8 ]。文献 [ 9 ] 使用遗传算法对微电网进行优化调度，通过给适应度函数设置权重系数将多目标函数转换为单一目标函数，并结合具体算法达到了经济运行的目的。文献 [ 10 ] 为了使得可再生能源在系统内能充分消纳，构建风能、光伏、燃气轮机以及储能系统在内的微电网模型，通过改变编码方式以及添加随机个体对遗传算法进行改进，算例结果表明了改进算法的有效性。文献 [ 11 ] 提出一种适用于微网的新型风电调度策略，并使用模拟退火算法计算输出功率的参考值，同时使用历史数据进行修正，提高了微网系统的风能利用效率。文献 [ 12 ] 采用模拟退火算法优化BP神经网络，预测发电量。实现了用电平衡，提高了微电网运行的效益。文献 [ 13 ] 提出一种混沌多目标遗传算法，即算法根据种群优化状态自适应调整搜索精度，保证优化向Pareto全局最优解集方向进行。优化结果表明，该方法降低了运行费用，提高了运行效益。文献 [ 14 ] 将电动汽车纳入微电网系统，依据电动汽车的行驶特性，建立基于电价的充放电模型，采用改进的遗传算法对微电网系统进行优化求解，实现了良好的环境效益和经济效益。文献 [ 15 ] 建立微电网优化模型，并依据实际情况和其要求使用遗传算法对微电网系统进行优化求解，得到微网各个系统的能源配置。文献 [ 16 ] 采用模拟退火算法对储能系统的放电进行预测，确认微电网运行的Pareto边际，使得微电网系统在不同运行需求下都可以得到最合适的运行规划。文献 [ 17 ] 为提高能源利用效率，降低微网运行费用，采用了源荷互动方式对负荷曲线进行优化，且将需求侧分级处理，最后使用基于模拟退火算法的遗传算法对模型进行求解。 遗传算法的群体搜索策略和遗传算子使得它拥有强大的全局寻优能力、应用的鲁棒性，是一种可规模化的求解方法。但是大量的实践和研究表明，遗传算法的局部寻优能力存在不足，且存在早熟的问题。遗传退火属于将遗传算法和模拟退火结合的混合算法，即加强了遗传算法的局部搜索能力，充分发挥两种算法的优势。一般退火过程中由于退温系数取常数，导致了算法退温时间较长，算法计算速度偏慢。。因此本文以经济成本最小为目标，建立了微电网优化调度的一般模型。运行为费用最低为微电网优化常用的目标函数，目标函数中除了成本和运维等方面的费用，还有其他的相关费用 [ 18 ]。文章采用改进的遗传退火算法进行求解，即对退火过程中的退温函数做出改进，加快了算法的收敛速度。通过算例，验证本文所建模型和所提方法的有效性。"
"微电网的优化调度是指在满足负荷需求以及确定的目标函数“约束条件的前提下，运用一定的运行策略和利用合适的软件或采用合适的解析法”智能优化算法来优化分布式电源的出力和确定系统的结构等。使得系统运行结果的经济成本“环保效益”供电可靠性和网络损耗等多目标或某一单目标函数达到最优 [ 19 ]。微电网结构如图1所示。 设离散化后的微电网含有N个子系统，其中第k个子系统的运行方程为： P k [ n ] = f k ( P k [ n − 1 ] , x k [ n − 1 ] , n − 1 ) , ( k = 1 , ⋯ , N ) (1) 约束条件为 S k : a k ≤ b k (2) 其中 P k 为第k个子系统的出力， x k ∈ R q k ( q k 为状态个数)为系统的当前状态， a k , b k ∈ R p k 为第k个子系统运行时的相关参数或者参数表达式， p k 为第k个子系统约束条件数目，n为当前时间相应的时段序号。 本文参照文献 [ 7 ]，以等效供电成本最小作为优化目标，以建设运行周期Y的调度费用F为(进行储能单元荷电状态日前计划的微电网能量优化调度时Y可取 = 24小时) [ 20 ]： min F = min ( C 0 + ∑ m = 1 N ∑ n = 1 Y C 1 [ m , n ] ) (3) C 0 = ∑ m = 1 N C m 0 (4) C 1 [ m , n ] = C O M [ m , n ] + C F U E L [ m , n ] + C E M [ m , n ] + C g r i d [ m , n ] (5) 其中 C O M [ m , n ] = Q [ m ] P m [ n ] (6) C F U E L [ m , n ] = ∂ m [ n ] F m [ n ] (7) C E M [ m , n ] = ∑ j = 1 Q β j [ m , n ] C j E M [ m , n ] (8) C g r i d [ m , n ] = γ m [ n ] E m g r i d [ n ] (9) 式中N表示子系统数量，Y表示时段的数量， C m 0 表示第m个子系统的初始成本； Q m 表示第m个子系统的运维系数， P m [ n ] 表示第m个子系统在第n个时段的出力； ∂ m , F m 分别表示第m个系统使用的燃料的单价和燃料用量； β j , C j E M 分别表示污染物j的排放量和单位排放量的惩罚金额； γ [ n ] , E g r i d [ n ] 分别表示在第n个时间段内的电交易价格和交易的电量。 图1. 微系统结构图"
"目标函数式(3)是带约束的强非线性优化问题，从最优控制的角度，可以通过引入拉格朗日(Lagrange)乘子将系统运动约束和边界条件约束转化为无条件极值问题，但微电网常常是大规模的，因此这类方法将导致优化变量数量巨大，计算量难以控制。因此，本文将采用智能优化算法对模型进行优化求解。 GA和模拟SA都是经典的寻优算法，但是GA前期个体的差异较大，父代与子代的适应度成正比，使得整个解空间都充斥着前期优秀的个体以及他们的子代，从而导致算法停滞不前，过早收敛，最终陷入局部最优。SA由于Metropolis准则的存在，使其具有较强的局部搜索能力且能够跳出局部最优解。 为充分发挥智能优化算法各自的优点，本文将传统GA和SA结合并进行改进，来求解目标函数的优化问题，即使用遗传算法完成算法前期的初始化工作，得到尽可能优秀的初始解，通过选择交叉变异操作获取优秀种群，之后再对该种群进行模拟退火处理。经典SA降温函数为指数退温函数，如式(12)所示，其中K为接近1的常数，实际运行中经常取0.99，但是这也使得算法收敛偏慢，本文为加快算法收敛速度对退温函数作出了修改，如式(13)，其中T表示当前温度， T 0 , T N E W 表示给定温度和降温之后的温度。算法具体流程如图2所示。 原退温函数： T N E W = K T (12) 其中K为常数 修改后： T N E W = exp ( T − T 0 T 0 ) T (13) 将K修改之后，算法的降温步长加大，使得到达最优解区域时间缩短，加快了算法的收敛速度。 图2. GSAA结构图"
"以广东某微电网系统为例，本实验考虑单日微电网的优化运行问题，取单位时段为1小时，即 n = 24 。验证的微电网模型包括光伏系统、风能系统、蓄电池储能系统各一个，属于并网模式且不考虑向电网售电的情况，此时 N = 3 。 微电网系统功率约束条件： P p v + P w t + P b a + P G = P L (14) 微电网与电网交换功率约束条件： P G min ≤ P G ≤ P G max (15) 式中 P p v , P w t , P b a , P L , P G 分别表示光伏系统、风能系统、蓄电池、负载的功率以及微电网与电网交换功率； P G min , Q G max , Q G 分别为微电网向电网购电的最小功率、最大功率以及在当前功率； Q w t , Q b a , Q p v 分别为风能系统、蓄电池组、光伏系统的运维系数。  光伏发电系统是将太阳能转换为电能的装置，发电量受环境温度和光照强度影响。在标准测试条件(光照强度1000 W/m 2 ，温度为25℃)下，系统的动力方程可表示为： P p v = P s t r G C G S T C [ 1 + K ( T C − T S T C ) ] (16) T C = T 1 + 30 × G C 1000 (17) 式中， P s t r 、 G S T C 和 T S T C 分别为标准测试条件下光伏额定发电功率、光照强度和环境温度； G C 和 T C 分别为当前工况下的光照强度和工作点的电池温度；K为功率温度系数； T 1 为当前周围环境温度。 光伏系统约功率平衡约束： P p v min ≤ P p v ≤ P p v max (18)  风机运行动力方程为 [ 21 ]： P W T = { 0   0 ≤ u ≤ u c i P W T , r a t e ( u − u c i ) / ( u r − u c i ) u c i ≤ u ≤ u r P W T , r a t e u r ≤ u ≤ u c o 0     u c o ≤ u (19) 式中： P W T , r a t e 为风机额定输出功率； u c i 为切入风速； u c o 为切出风速； u r 为额定风速。 风机系统功率平衡约束： P w t min ≤ P w t ≤ P w t max (20)  蓄电池在t时刻的储能状态可表示为： { E k [ n ] = E k [ n − 1 ] + P k [ n ] Δ t η c             P k [ n ] ≥ 0 E k [ n ] = E k [ n − 1 ] + P k ( t ) Δ t η d                   P k [ n ] < 0 (21) S O C = E k [ n ] E k [ n − 1 ] (22) 式中： E k 分别为蓄电池在t时刻和 t − 1 时刻的荷电量； P k ( t ) 表示时刻的充放电功率(大于０表示充电，小于０表示放电)； η d 分别表示充放电效率；本例取 Δ t = 1 小时； S O C 为蓄电池剩余电量比例。 蓄电池约束： P b a min ≤ P b a ≤ P b a max (23) S O C min ≤ S O C ≤ S O C max (24) 式中 P b a min , P b a max , P b a 表示蓄电池剩最小功率、最大功率以及当前时间段的功率。 S O C min , S O C max 分别表示粗电池最小(取0.2)和最大(取0.8)剩余电量比例， S O C 低于0.2不再放电、 S O C 高于0.8不再充电。  本文微电网系统中光伏系统额定功率为300 KW，储能系统最大放电功率为150 KW，充电功率为100 KW，风能系统30 KW电网交互功率最大为250 KW，峰谷电价如表1所示。 Table 1 时段 电价/元 谷时段 0.3042 峰时段 0.6084 平时段 1.0039 表1. 电价表 *时段规定：谷时段：0:00~8:00，22:00~0:00；平时段：8:00~9:00，12:00~19:00； 峰时段：9:00~12:00，20:00~22:00。 在改进后的GSAA中，最大迭代次数取200，种群规模取400。交叉，变异概率分别取0.6、0.01。 并网方式下进行优化时，由于该微电网中只有光伏和储能系统，不需要考虑环境效益，只需考虑经济效益。系统优化后的费用如表2所示。图3为使用改进后的SAGA优化后的迭代曲线图。图4为优化后各个子系统的出力情况。 Table 2 方法 费用/元 未使用智能优化算法 1213.4092 SA 807.1851 GA 620.1141 GSAA 597.6641 表2. 费用对比 通过优化结果对比发现，未使用优化算法时微电网的费用为1213.4092元。使用传统GA对微电网系统进行优化求解，综合费用为604.6343元，使用GSAA求解得到的综合费用为587.3853元，GSAA节约17.249元。其中蓄电池在10:00、11:00、13:00、15:00、17:00以及19:00~00:00处于放电状态，缓解峰期的用电费用，在5:00和9:00处于既不放电也不充电的状态，其他时间段处于充电状态，为用电峰期做充足的准备。整个微电网运行期间，微电网在电价谷期优先从电网购电，而其他系统的能量则储存在蓄电池中。 图3. 迭代曲线 图4. 各个系统出力图 通过三种算法的迭代曲线图可以看出，SA在对本文的微电网模型进行优化时效果最差，其次是GA，效果最好的是改进后的模拟退火算法。主要是因为GSAA综合了遗传算法和退火算法的优点，在保证的全局寻优能力的同时加强了局部寻优的能力，并且退温函数的修改，使得前期降温步长加大，加快了算法收敛速度，也使得微电网单位周期内运行费用更低。  本实验考虑单日微电网的优化运行问题，取单位时段为1小时，即 n = 24 。验证的微电网模型包括光伏系统、风能系统、蓄电池储能系统、燃气轮机各一个，产生污染气体的处理参数如表3所示。此时系统属于孤岛模式， N = 4 。 柴油发电机的燃料成本采用二次函数表达式： C D E = ∂ + β P D E + γ P D E 2 (25) 其中 C D E 表示燃料成本， P D E 表示柴油发电机的发电功率， ∂ , β , λ 表示燃料成本的系数，分别取6、0.15、8*10 −4 。 Table 3 类型 排放系数 出力系数(元/kg) MT PV WT CO 2 1.600 0 0 0.092 NO x 0.440 0 0 27.450 SO 2 0.008 0 0 6.490 表3. 温室习体排放及处理参数 本次仿真以一天为一个周期，典型日负荷数据来源于IEEE-RTS。蓄电池最大放电功率为5 kw，其他分布式电源参数如表4。 Table 4 微源 功率(kw) 运维系数 寿命 PV 0-20 0.0096 20 WT 0-12 0.0296 10 DE 0-30 0.0859 10 表4. 微源参数 Table 5 算法 费用(元) GA 658.2428 SA 661.0859 GSAA 657.3315 表5. 费用对比 图5为子系统在各个时段的出力图，光伏系统和风能系统属于不可控力，出力要尽可能的多，蓄电池只有在15:00、19:00和20:00处于充电状态，3:00、9:00、16:00处于不充电也不放电的状态，其他时段处于放电的状态，柴油发电机则弥补其余子系统与负载的差值部分。 从图6和表5可以看出，在对孤岛模型进行优化时，三种优化算法的结果分别是658.2428元、661.0859元、657.3315元，没有较大差距，但是因对遗传退火算法的退温函数做了改进，使得改进后的遗传退火算法收敛速度相比其他两种算法更快。 图5. 系统出力图 图6. 迭代曲线"
"本文首先构建了综合运行成本为目标的一般数学模型，并采用GA和SA两种经典算法以及改进后的GSAA对模型进行求解，得到了各个子系统在各个时刻的出力以及微电网的综合运行费用，通过对并网模式和孤岛模式两个微电网算例结果进行分析表明：使用改进后的算法对模型求解得到的运行成本费用低于使用GA和SA的优化结果，收敛速度也比经典算法更快。 此外，微电网的模型拓展及调度方法都是下一步研究的内容。"
