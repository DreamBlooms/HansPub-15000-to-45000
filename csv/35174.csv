"微电网技术的迅速发展使得人们在保证微电网稳定运行的同时，开始更多地关注微电网运行的经济效益。本文针对含空调群落的微电网提出一种考虑需求响应的多目标经济运行方法，首先，提出一种更能反映系统实际运行状况的动态电价机制。其次，将空调和可调负载作为需求响应资源参与微电网经济调度，建立可调负载用户收益模型和空调群落运行成本模型，并考虑了用户舒适度等一系列约束条件。然后，根据等微增率准则，建立发电成本模型，实现微电网发电侧成本最小化。最后，在MATLAB/Simulink中搭建微电网仿真模型，设计算例验证所提出方法的有效性，仿真结果表明，在本文所提出的多目标经济调度方法下，可调用户的收益提高了69.2%，在保证用户舒适度的前提下，使得空调群落的运行成本减少了18.2%，并且微电网发电侧成本实现最小化。 关键词 :微电网，需求响应，空调群落，经济运行 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"微电网(Microgrid)作为智能电网的重要组成部分，一方面，微电网为分布式电源(Distributed Generation, DG)、负荷、储能设备以及控制单位提供了有效载体，充分发挥了DG所具有的经济性、环保性和灵活性，为电能用户提供优质的电能质量，满足用户安全可靠用电；另一方面，微电网运行方式极为灵活，既可以并入大电网运行，也可以在电网系统故障时与大电网断开孤岛运行，以保障重要负荷的供电 [ 1 ] [ 2 ] [ 3 ]。 对于孤岛运行的微电网系统，经济性、可靠性以及节能型是其运行必须兼顾的3个方面 [ 4 ] [ 5 ] [ 6 ]。随着微电网控制技术的不断发展，微电网目前已经能够实现安全稳定运行，其可靠性已经有了很大的保障，因此学者们开始更多地关注微电网运行的经济性。文献 [ 7 ] 权衡了微电网停电损失和投资运行费用，提出了可靠性与经济性小协调的微电网能量优化方法，实现微电网动态经济运行。文献 [ 8 ] 建立了含热电联产系统的微电网经济性数学模型，将环保因素考虑在内，仿真结果表明蓄电池的优化调度可减少系统的综合运行成本，但并未考虑系统孤岛运行时的可靠性。文献 [ 9 ] 以电网的有功网损、污染气体排放量和系统电压稳定程度3个指标作为多目标优化目标，通过建模分析，为智能电网的监控运行提供了思路。 需求响应作为一种较为廉价的经济调度资源，不仅能够增加微电网经济调度的手段，还能够提高需求响应用户的收益 [ 10 ] [ 11 ] [ 12 ] [ 13 ]。Jindal等学者提出一种新的分析管理方案，对设备调整因素、电器优先级指标和电器产品优先级等因素进行分析，并运用不同的算法求解DR决策 [ 14 ]。Wang Y.等学者建立包含光伏、组合冷却加热、能量存储系统等基于价格的需求响应模型，通过遗传算法求解最佳运行策略，并通过实际的工程仿真验证了方法的有效性 [ 15 ]。为了使得微网总利润最大化，Nguyen D.等学者提出以一种新的智能电网实施定价方案，并基于次建立包含时变负荷的需求响应模型，最后采用交替方向乘子法进行求解 [ 16 ]。 本文在目前现有的分时电价机制的基础上，针对高可再生能源渗透率下的微电网提出一种更能反映系统运行状态的动态电价机制。接着，把空调和可调负载作为需求响应资源参与微电网经济调度，建立可调负载用户的收益函数和空调的运行成本函数，并考虑了用户舒适度等一系列约束条件。然后，根据等微增率准则，建立微型燃气轮机出力分配模型，实现微电网发电侧成本最小化。最后，在MATLAB/Simulink中搭建微电网仿真模型，设计算例验证所提出的多目标经济调度方法。"
"目前，多采用分时电价策略，根据预先设定的电价调整用户的用电行为，但该策略并不能实时反映系统运行环境的变化，尤其是对于可再生能源渗透率较高的海岛地区。大量分布式发电的接入使得海岛微电网的运行环境受环境影响较大，而海岛环境的复杂多变也使得分时电价机制时段的准确性大大降低。因此，需要一种能够反映系统实时运行状态的动态电价机制，从而更加有效地引导用户的用电行为。 动态电价的实时更新，影响着用户侧可调负荷的接入量情况，合理的动态电价机制，能够促进需求侧响应，实现用户侧收益的最大化。电价由系统运行的平均边际成本所决定，而微电网中电能主要由可再生能源发电和微型燃气轮机提供，因此动态电价机制由基准电价、可再生能源发电电价调整量和微型燃气轮机发电电价调整量三部分组成。基准电价为定值，是动态电价形成的基础。可再生能源发电电价调整量与可再生能源实际出力相关，相应地微型燃气轮机发电电价调整量与微型燃气轮机的实际出力相关。为了最大限度的消纳可再生能源，在可再生能源发电量增大的时候，动态电价应当降低，引导用户侧增大可调负荷的接入量，从而达到促进电能消耗的目的。因此，动态电价与可再生能源出力呈负相关。微型燃气轮机发电成本随着其发电量的增多而增加，导致微电网平均运行成本增大，此时为了减轻微电网发电侧的压力，动态电价应当增高，引导用户减少可调负荷的接入量。因此，动态电价与微型燃气轮机出力呈正相关。综上所述，定义动态电价如下式所示： c d ( t ) = c b − c r e g ( t ) + c m t ( t ) (1) 其中 c d ( t ) 表示t时段的动态电价， c b 表示基准电价， c r e g ( t ) 表示t时段可再生能源发电的电价调整量， c m t ( t ) 表示t时段内微型燃气轮机发电的电价调整量。 c r e g ( t ) 由 t − 1 时段系统采集的可再生能源发电总量和微电网发电总量决定如下式所示： c r e g ( t ) = k r e g ⋅ ∑ p i r e g ( t − 1 ) ∑ p i r e g ( t − 1 ) + ∑ p i m t ( t − 1 ) (2) 其中 k r e g 表示可再生能源发电的电价调整系数， p i r e g ( t − 1 ) 表示 t − 1 时段内第i个可再生能源发电的输出功率， p i m t ( t − 1 ) 表示 t − 1 时段内第i个微型燃气轮机的输出功率。从式(1)和(2)可以看出，在微型燃气轮机出力不变时，随着可再生能源的发电量增加时，可再生能源发电的电价调整量随之增大，动态价格降低，激励用户接入更多的可调负荷，促进电能的消耗。 由式(12)可得微型燃气轮机的发电成本成为其出力的二次凸函数，微型燃气轮机发电成本的增加将导致动态电价的上升，因此同样定义微型燃气轮机发电的电价调整系数为其出力的二次凸函数如下式所示： c m t ( t ) = a ⋅ ( ∑ p i m t ( t − 1 ) ) 2 + b ⋅ ( ∑ p i m t ( t − 1 ) ) (3) 其中a，b分别表示微型燃气轮机的电价调整系数，在可再生能源发电保持不变时，随着微型燃气轮机出力的增加，微型燃气轮机发电的电价调整量增大，同时由式(2)可得，可再生能源发电的电价调整量将减小，所以动态电价将升高，限制可调负荷的接入量。 系统基于上一时段可再生能源发电量和微型燃气轮机发电量，确定下一时段需要执行的动态电价，并在下一时段之前完成动态电价的更新。"
"传统的微电网经济优化模型往往单一侧重于微电网发电侧或需求侧，且忽略了用户的舒适度感受，而在未来微电网的发展中需要将发电侧和需求侧作为整体进行优化，从而提高微电网运行的经济性和可靠性。因此，基于提出的动态电价机制，本节建立统筹微电网发电侧和需求侧的多目标经济运行模型。对于需求侧，将可调负荷和空调群落作为需求响应资源进行优化调度，建立空调群落运行成本和可调用户收益模型，实现用户收益最大，并且在保证用户舒适度的条件下最小化空调群落的运行成本。对于发电侧，建立发电侧成本模型，保证微电网运行过程中发电成本的最小化。  用户侧的收益函数由效用函数和成本函数组成，效用函数表示负荷消耗电能大小与所产生的效益之间的关系，引入参数 σ i ， ω i 来描述不同可调负荷之间的用电效用，可调负荷i的用电效用可表示如下： U i ( t ) = { σ i l i f l ( t ) + ω i 2 ( l i f l ( t ) ) 2 , 0 < l i f l ( t ) < − σ i ω i σ i 2 2 ω i , l i f l ( t ) ≥ − σ i ω i (4) 其中 σ i ， ω i 为表示可调负荷i用电效用的参数，满足 ω i > 0 ， σ i > 0 ，由负荷的种类决定。 l i f l ( t ) 表示可调负荷i的在t时段的接入量， u i ( t ) 表示可调负荷k的用电效用，在 0 < l i < − σ i ω i 时， U i 随着可调负荷i接入量 l i f l ( t ) 的增加而增加；当 l i f l ( t ) ≥ − σ i ω i 时，即使可调负荷接入量 l i f l ( t ) 继续增加，可调负荷的用电效用 U i 保持不变。 成本函数表示用户侧的用电费用，遵循用户特定的用电习惯。可调负荷的用电费用可表示如下： F i ( t ) = c d ( t ) ⋅ l i f l ( t ) (5) 其中 F ( t ) 表示可调负荷i的用电费用。 综合效用函数和成本函数，可以得到用户侧的收益函数表示如下式所示： P = ∑ U i ( t ) − ∑ F i ( t ) (6) 当动态电价升高时,可调负荷的用电效用保持不变，而用电费用将增加，导致用户侧的收益降低，因此可调负荷的接入量将减少，保证用户侧获得最大的收益；而当动态电价降低时，由于用电费用的减少，可调负荷的接入量将会增加，以获得用户侧更大的收益。  空调运行时具有周期工作特性，室内温度在用户设定的温度区间之间上下波动。当制冷模式的空调开启运行时，当室内达到温度下限值 T d o w n 时，空调停止工作；当空调停止工作时，房间内温度持续上升，当室内温度达到温度上限值 T u p 时，空调再次启动运行。通过等效热参数模型(Equivalent Thermal Parameters Model, ETP)可以模拟空调的热动力过程，室内温度的计算公式如下式所示： { T i t + 1 = T 0 t − ( T 0 t − T i t ) e − Δ t R C , S = 0 T i t + 1 = T 0 t − η p R − ( T 0 t − η p R − T i t ) e − Δ t R C , S = 1 (7) 上式中， T i t + 1 和 T i t 分别表示 t + 1 和t时刻室内温度(℃)， T 0 t 表示t时刻的环境温度(℃)。p表示空调工作时的制冷/热功率(kW)，而 η 表示空调的能效比，R表示等效热阻(℃/W)，C表示等效热容(J/℃)， Δ t 表示时间间隔(s)。S表示空调的工作状态， S = 0 表示空调停止工作， S = 1 表示空调处于工作状态。 空调的运行成本函数由其用电成本函数和维护成本函数组成，其中用电成本函数用于描述空调处于工作状态时消耗的电能成本，可表示如下， N i ( t ) = c d ( t ) ⋅ p i A C ( t ) (8) 其中 p A C i 表示空调i的制冷/热功率， N i 表示其对应的用电成本。 空调的维护成本函数用于描述空调运行产生的折旧和维护费用，考虑到不同空调之间的差异性，将维护成本定义为空调工作功率的二次凸函数，可表示如下， M i ( t ) = m ⋅ ( p i A C ( t ) ) 2 + n ⋅ p i A C ( t ) + l (9) 上式中，m，n和l分别为空调的维护成本系数， M i ( t ) 表示空调的维护成本。综合空调的用电成本函数和维护成本函数，可以得到空调的运行成本函数如下式所示： W ( t ) = ∑ N i ( t ) + ∑ M i ( t ) (10) 同时，在用户的舒适度约束中引入电价影响因素，使得空调的设定温度受到电价和用户舒适感受两个因素的影响，空调的设定温度可表示如下： T s e t t + 1 = T s e t t + c 1 ⋅ c d − c d min c d max − c d min + c 2 ⋅ T s e t t − T s e t o r i T u p − T d o w n (11) 上式中， T s e t t + 1 和 T s e t t 分别表示在 t + 1 和t时刻空调的设定温度， c 1 和 c 2 分别是电价和用户舒适感受对空调设定温度的影响系数， c d max 和 c d min 为电价的最大和最小值，而 T u p 和 T d o w n 分别是用户设定温度的上下限， T s e t o r i 表示空调的初始设定温度。当动态电价升高时，空调的运行成本增大，此时空调的设定温度增大，减少空调的运行时间从而节约用电成本，而当空调的设定温度增加到一定值时，受到用户舒适感受的限制，空调的设定温度降低，保证用户的舒适度感受。  在孤岛运行的微电网中，一般忽略可再生能源的发电成本，只考虑内部微型燃气轮机的发电成本。对于传统的微型燃气轮机，其发电成本通常被定义为有功出力的二次凸函数： C i = α i ( p i m t ) 2 + β i p i m t + γ i (12) 其中 α i ， β i ， γ i 均为微型燃气轮机i的成本参数，且满足 α i > 0 ， β i > 0 ， γ i > 0 。 p i m t 表示微型燃气轮机i的有功输出， C i 表示微型燃气轮机i的发电成本。 微电网发电侧成本最小即所有微型燃气轮机的发电成本总和最小，则微电网发电侧的目标函数可表示如下式： min C = ∑ i = 1 n C i ( p i m t ) (13) 微型燃气轮机的增量成本 λ i 定义为其发电成本 C i 关于有功输出 p i 的一阶导数，表示如下： λ i = ∂ C i ( p i m t ) ∂ p i m t = 2 α i p i m t + β i (14) 根据等微增率准则，当所有微型燃气轮机的增量成本一致时，就得到了各微型燃气轮机的最优输出，此时微电网的发电成本最小。  为了保证微电网在运行过程中安全稳定地运行，引入一系列约束条件。约束条件包括等式约束和不等式约束，等式约束即保证微电网在运行过程中发电侧与用电侧的功率平衡，这是微电网稳定运行的前提。不等式约束主要考虑微电网中微型燃气轮机的出力限制以及可调负荷的接入量限制。 1) 功率平衡约束 在微电网中，可再生能源发电、储能装置以及微型燃气轮机的出力总和应与用户侧接入负荷的总和保持平衡，可表示如下： ∑ p i m t ( t ) + ∑ p i r e g ( t ) + p e s s ( t ) = ∑ l i f l ( t ) + ∑ l i c l ( t ) + ∑ p i A C ( t ) (15) 其中 p i r e g ( t ) 表示t时刻第i个可再生能源发电的输出功率， p e s s ( t ) 表示t时刻储能装置的输出功率。 2) 微型燃气轮机出力约束 微型燃气轮机出力收到自身容量等物理条件的限制，为了保证在优化过程中，微型燃气轮机合理出力，设置微型燃气轮机约束如下： min ( p i m t ) ≤ p i m t ( t ) ≤ max ( p i m t ) (16) 其中 min ( p i m t ) 和 max ( p i m t ) 分别表示第i个微型燃气轮机的最小和最大输出功率。 3) 可调负荷接入量约束 可调负荷的接入量大小随着动态电价的改变而调整，以实现用户侧收益的最大化，同样由于可调负荷自身物理条件的限制，其接入量大小受约束如下： min ( l i f l ) ≤ l i f l ( t ) ≤ max ( l i f l ) (17) 其中 min ( l i f l ) 和 max ( l i f l ) 分别表示第i个可调负荷的最小接入量和最大接入量。 4) 用户舒适度约束 为了保证用户的舒适度感受，室内温度应该维持在用户能够接受的舒适度区间之内，当室内温度大于温度上限值时，空调开始工作，降低室温；当室内温度小于温度下限值时，空调停止工作；当室内温度在舒适度区间之内时，空调根据控制指令停止工作或保持工作状态。同时，在用户的舒适度约束中引入电价影响因素，使得空调的设定温度受到电价和用户舒适感受两个因素的影响，空调的设定温度可表示如下： T d o w n < T i ( t ) < T u p (18) 式中 T u p 和 T d o w n 分别表示根据用户设定的温度上限值和下限值，上限值比用户设定温度的高2度，对应下限值比用户设定温度低2度。"
"在MATLAB/Simulink中建立运行于孤岛模式的辐射型微电网，来验证所提出的多目标经济调度方法的有效性。微电网仿真模型由12个分布式发电单元和12个负荷组成，其拓扑结构如图1所示。从图中可以看出，分布式发电单元包括微型燃气轮机 { DG i | i = 1 , 3 , 5 , 7 , 11 } 、可再生能源发电单元 { DG i | i = 2 , 6 , 8 , 9 , 10 , 12 } 以及储能系统 DG 4 ；负荷的类型可分为三种，分别是固定负荷 { Load i | i = 4 , 8 , 10 , 12 } 、可调负荷 { Load i | i = 1,3,5,11 } 以及空调群落负荷 { AC i | i = 2 , 5 , 6 , 9 } 。可再生能源发电单元包括光伏和风机，都工作于最大功率点跟踪(Maximum Power Point Tracking, MPPT)模式下，考虑到本文研究微电网有功经济调度，因此设置可再生能源发电单元不产生无功功率，在仿真过程中可再生能源发电单元出力曲线如图2所示。微型燃气轮机工作于PQ控制模式，弥补可再生能源发电与负载之间的功率缺额。由于孤岛微电网缺少大电网的支撑，因此储能系统工作于V/F模式下，作为微电网的电压和频率支撑。考虑到储能系统自身容量以及输出功率的限制，因此设置微型燃气轮机分担储能的出力大小，这样储能系统仅在负荷突变时瞬时出力，之后其输出功率又被微型燃气轮机分担，避免了储能系统的过充过放，保证微电网的安全稳定运行。 微电网中的空调负荷假设都为变频空调，其工作的最大功率为3 kW，且每个区域内的空调都由对应的中央控制器集中控制，并且假设同一个区域内的室内温度保持一致。空调负荷的具体参数详见表1。微电网中的分布式发电单元(DG)和负荷的相关参数分别列于表2和表3中。 图1. 微电网仿真模型拓扑图 图2. 可再生能源出力曲线 Table 1 序号 空调数量/台 初始设定温度/摄氏度 m n l 2 15 24 −0.328 3.42 0.80 6 12 24.5 −0.174 2.86 0.83 7 8 23 −0.360 2.32 1.00 9 10 25 −0.198 2.99 1.50 表1. 空调相关参数 Table 2 序号 有功/无功容量 模式 α β γ 1 60 kW, 40 kVar PQ 0.059 6.71 80 2 30 kW, 0 kVar MPPT - - - 3 55 kW, 42 kVar PQ 0.066 6.29 43 4 30 Ah V/F - - - 5 65 kW, 50 kVar PQ 0.046 7.53 35 6 50 kW, 0 kVar MPPT 7 60 kW, 48 kVar PQ 0.069 4.57 48 8 35 kW, 0 kVar MPPT - - - 9 45 kW, 0 kVar MPPT 10 50 kW, 0 kVar MPPT - - - 11 60 kW, 45 kVar PQ 0.058 6.65 54 12 55 kW, 0 kVar MPPT - - - 表2. DG相关参数 Table 3 序号 负载类型 有功大小 ω σ 1 可调负载 0~36 kW −0.123 9.625 2 空调群落 0~45 kW 3 可调负载 0~48 kW −0.163 13.02 4 不可调负载 30 kW 5 可调负载 0~24 kW 6 空调群落 0~36 kW −0.198 13.12 7 空调群落 0~24 kW 8 不可调负载 30 kW 9 空调群落 0~30 kW −0.207 10.99 10 不可调负载 35 kW 11 可调负载 0~28 kW 12 不可调负载 40 kW 表3. 负载相关参数 为了使得微电网仿真模型更符合实际，在模型中考虑了系统线路的损耗，设置线路的阻抗为0.641 + j0.101 Ω/km，系统电压和频率分别设置为380 V和50 Hz。  基于以上建立的微电网仿真模型，在Simulink中添加用户自定义函数库(User-defined functions library)中的MATLAB Function模块，在模块中建立用户收益模型、空调运行成本模型以及发电成本模型，并调用集中式内点优化函数fmincon对上述模型进行求解，具体步骤如下所示： 1) 读入当前时段各微型燃气轮机、储能系统出力大小、可调负荷接入量、空调群落功率大小、室内温度、环境温度以及动态电价等参数。 2) 根据当前动态电价价格，调用集中式内点优化函数fmincon对用户收益模型和空调运行成本模型进行求解，得到可调负荷的最优接入方案和空调群落的最优运行功率。 3) 将V/F控制的储能系统的输出功率分配给微型燃气轮机轮机，避免储能系统出现过充过放的情况，影响微电网的稳定运行。 4) 更新微型燃气轮机总出力，调用集中式内点优化函数fmincon对发电成本模型进行求解，保证所有的微型燃气轮机增量成本一致，实现发电成本最小化。 5) 更新可调负载接入、空调群落运行功率以及微型燃气轮机输出功率，等待下一优化时段的到来。"
"为了验证所提多目标经济调度模型的有效性，在所建立的微电网仿真模型中设计仿真算例进行验证，仿真的时长为6小时，对比分析在正常情况下和多时间经济调度策略下微电网的运行情况及经济效益，不同策略下的仿真结果如图3所示。 结合图3(e)中动态电价和(a)中可调负载接入变化可以看出，在动态电价升高时，可调负载接入量减小，减少可调负载用电费用；而当动态电价降低时，可调负载接入量增加，尽管可调负载用电费用增加，但是可调负载用电效用的增加量大于用电费用的增加，因此用户的总收益增加。对比图3(b)、图3(c)中引入需求响应经济调度方法和未引入时用户室温变化情况和空调群落功率变化，可以看出在需求响应经济调度方法下，室温在保持在用户舒适度范围的前提下，空调群落的用电功率明显低于未引入需求响应经济调度方法的情况。图3(d)为微电网系统的电压、频率以及储能系统的输出，从图中可以看出在提出的经济调度策略下，系统的电压和频率均保持稳定，仅在负荷突变时，有较小的波动，但是很快又恢复正常；储能系统也仅在负荷突变时，输出或吸收功率维持微电网系统的功率平衡，但出力部分很快又被微型燃气轮机分担，恢复到零，如此避免了储能系统过充过放情况的发生，保证了微电网运行的安全稳定性。图3(e)下图为微型燃气轮机的增量成本曲线，从图中可以看出在整个仿真时段内，微型燃气轮机的增量成本均保持一致，实现了微电网发电侧发电总成本最小化。图3(f)为可调负载用户的收益以及空调群落运行成本对比，从图中可以看出引入需求响应经济调度方法时用户的收益曲线始终在未引入时用户收益曲线上，而引入需求响应经济调度方法时空调的运行成本曲线则在大多数情况下都低于未引入时的空调群落运行成本曲线。由表4可知，引入需求响应经济调度方法的可调用户收益比未引入时用户的收益提高了69.2%，并且空调群落的运行成本降低了18.2%。 图3. 引入需求响应和未引入需求响应的仿真结果对比。(a) 可调负荷的接入量变化。(b) 室温变化。(c) 空调群落功率大小。(d) 系统电压和频率、及储能输出大小。(e) 微型燃气轮机等微增率和动态电价。(f) 空调运行成本及用户收益大小 Table 4 调度方法 用户收益(cents) 空调运行成本(cents) DR 3126 1459 Without DR 1848 1785 表4. 用户收益及空调运行成本"
"针对目前现有的分时电价机制无法反映微电网系统运行实时状态的问题，本文对高可再生能源渗透率下的微电网提出一种更能反映系统运行状态的动态电价机制。接着，把空调和可调负载作为需求响应资源参与微电网经济调度，建立可调负载用户的收益函数和空调的运行成本函数，并考虑了用户舒适度等一系列约束条件。然后，根据等微增率准则，建立微型燃气轮机出力分配模型，实现微电网发电侧成本最小化。最后，在MATLAB/Simulink中搭建微电网仿真模型，对所提出的多目标需求响应经济调度方法进行验证。从仿真算例可以得出，在本文所提出的多目标经济调度方法下，可调用户的收益提高了69.2%，并且在保证用户舒适度的前提下，使得空调群落的运行成本减少了18.2%，同时通过等微增率准则分配微型燃气轮机的输出，实现微电网发电成本最小，从而实现微电网的最优经济运行。"
