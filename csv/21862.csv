"由STC 89C 52单片机采集信息和智能控制，利用GPRS无线传输模块定时把温室大棚采集到的温度、湿度、光照强度以及CO 2 浓度等数据传输给上位机(PC机)，实时观察，同时又通过PC机对下位机(单片机)采集的信息进行分析，并发出相应指令给下位机作出相应的控制，如通风设备、喷淋装置、遮阳网等装置。 关键词 :温室大棚，远程监控，GPRS，STC 89C 52 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"我国温室大棚的应用越来越广，根据农业生产的实际需要，研究设计温室大棚信息采集系统，对于温室大棚信息采集的智能化和实时监测自动化，实现土壤诊断、合理施肥灌溉、调温以及遮阳补光等具有重要的意义 [ 1 ] 。 基于GPRS的温室大棚信息采集及控制系统的设计，通过温度传感器、湿度传感器、CO 2 传感器和光敏传感器采集大棚内温度、湿度、CO 2 浓度和光照强度等信息，由STC 89C 52单片机(下位机)分时循环收集各传感器信息并实时由GPRS模块发送到管理员室的PC机(上位机) [ 2 ] ，管理员可以通过PC机实时查询大棚的相关信息。 PC机可以对采集的信息自动数据处理，做出相应的控制，如通风设备、喷淋装置、遮阳网等装置的打开或关闭；可以定时对多个大棚数据采集和保存，保存的数据有时间记录，这便于对各批次作物成长的分析。管理员可以通过pc机对大棚环境参数值适时调整设置，实现闭环控制，对不同季节、不同农作物进行环境参数的调整，实现对大棚的高效管理 [ 3 ] [ 4 ] 。 本设计大棚内单片机系统(下位机)采用模块化的设计思路。使用STC 89C 52作为控制核心、无线传输模块使用GTM900C GPRS模块，液晶显示使用LCD12864等元器件，设计出的硬件系统使用简单，功耗低，性价比高 [ 5 ] 。"
"系统结构主要由传感器、单片机及GPRS模块(下位机)和数据中心PC机(上位机)四部分组成如图1所示。通过各传感器把采集到的信息传送至单片机，单片机把接受到的信息通过GPRS模块传输到PC机上，然后再由PC机对这些信息进行分析处理 [ 6 ] [ 7 ] 。其中一台PC机可以访问多个GPRS模块，从而实现多个温室大棚的分时控制，形成一对多的温室大棚测控系统。  硬件电路主要由信息采集、数据收发控制、信息显示、系统控制四部分组成。其中信息采集主要由温湿度传感器、光照强度以及CO 2 浓度传感器组成；数据收发控制主要由GPRS模块和PC机组成；信息显示由LCD12864组成；系统控制主要由单片机和PC机构成；其系统结构框图如图2所示。通过温度传感器、湿度传感器、光敏传感器以及CO 2 浓度传感器把采集到的信息传送至MCU和GPRS模块单元，单片机把处理好的数据在通过串口发送至GPRS模块，由LCD12864显示采集的信息，在由GPRS模块与PC机进行联通，并由GPRS模块发送至Internet网络，PC机通过访问Internet得到数据。对这些采集到的信息，PC机可以进行分析，并做出相应的控制，如打开或关闭通风设备、喷淋装置、化学反应 图1. 整机系统框图 图2. 单片机系统结构框图 装置和遮阳网等。 其中温湿度传感器是利用到了单片机的P3.7引脚进行单总线数据信息的采集和传输，光照强度传感器是利用了单片机的P3.6和P3.5两个引脚通过I 2 C 总线进行数据的采集和传输，GPRS模块利用单片机的P3.0和P3.1两个引脚进行串口通信。 温湿度传感器选用DHT11，具有响应速度快、抗干扰能力强、性价比高等优点； 光照强度传感器选用BH1750FVI，是一种数字型光强度传感器集成电路，它支持I 2 C 总线接口，具有高分辨率，抗干扰能力强； CO 2 传感器选用VC1008T，其精度高、性能稳定； GPRS模块选用华为GTM 900C 双频900/1800 MHZ，其内嵌TCP/IP协议模块，使用简单，设计成本低。GTM 900C 模块的工作原理图如图3所示。"
"程序编写主要包括信息采集和显示，单片机和GPRS的串口通信，以及控制GPRS实现联网和发送数据的功能 [ 8 ] [ 9 ] 。  系统主程序流程图如图4所示。 图3. GTM 900C 工作原理图 图4. 主程序流程图  LCD12864显示流程图、向BH1750发送单个字节流程图和连续读取数据及储存流程图如图5所示。  通过单片机和GPRS进行串口通信，把单片机采集的信息发送到上位机，其程序流程图如图6所示。 图5. 部分程序流程图 图6. GPRS联网流程图  接收数据程序流程图如图7所示。 编译程序生成应用软件后，服务器接收界面如图8所示。 图7. 上位机(PC)流程图 图8. 上位机(PC)界面图"
"依次在GSM串口调试助手程序界面输入以下AT指令，若板子正常且连网成功，且能够在TCP/UDP Socket调试工具中显示发送的数据(http)，显示如图9和图10所示，说明板子正常，能够正常连网和发送数据。 AT + CGDCONT = 1, IP, CMNET AT%ETCPIP AT%IOMODE = 0, 2, 0 AT%IPOPENX = 1, TCP, 111.164.240.229, 1001 AT%TPS = 1, 1, 3000, 1024 http 本系统通过温湿度传感器、光照强度传感器以及CO 2 浓度传感器采集信息并传送至单片机，由单片机屏显采集的信息，经GPRS模块串口通信，把采集的信息发送至上位机，上位机对接收到的信息进行相应的信息处理及管理。 图9. GPRS联网测试串口调试助手图 图10. GPRS联网测试上位机接收图  第一步：连接电源线；将串口线的端口一端与板子的端口相连，另一端与电脑的串口端口相连。如图11所示。 第二步：插入SIM卡，如图12所示。 第三步：打开电路板电源，红灯亮，黄灯闪。 第四步：打开电脑中的GSM串口调试助手程序。 第五步：在GSM串口调试助手程序界面打开串口，依次点选GSM调试专用栏的几个按钮，若板子正常，则显示如图13所示。  将温湿度传感器、光敏传感器和LCD12864插入所设计的板中，将调试好的程序烧写入单片机，打开电源开关，液晶会显示如图14所示的值，说明硬件和软件都测试成功了。  将GPRS模块与单片机通过串口连接好后，打开上位机，设置好端口和IP，将调试好的程序烧写到单片机。打开GPRS模块和开发板电源，查看上位机是否与下位机联上网。如果联上网了，上位机将接 图11. GTM 900C 模块 图12. 插入SIM卡模块图 图13. GSM串口调试助手程序界面 图14. 单片机控制显示数据测试图 图15. GPRS 传送数据测试 收到下位机发送的数据，同时会将接收到的数据在相应的窗口显示，在对接收到的数据进行分析处理后将对下位机进行相应的控制。测试成功，上位机屏显如图15所示。"
"通过硬件系统、软件系统、GPRS模块的设计，实现了温室大棚环境参数的采集、显示、传输、接收和控制。取得的主要结果如下： 1) 对GPRS模块提出的组网方案，能够符合设计要求，很好的实现了各项功能。 2) 大棚内单片机系统设计采用模块化的思路。使用STC 89C 52作为控制核心、无线传输模块使用GTM900C GPRS模块，液晶显示使用LCD12864等元器件，设计出的硬件系统使用简单，功耗低，性价比高。 3) 用C语言编写的程序简单方便。程序主要包括信息的采集和显示、单片机和GPRS模块的串口通信以及GPRS联网和数据传输的程序，以及用VB语言编写的PC机程序。 4) 经测试，上位机(pc机)定时对多个大棚数据采集和保存，保存的数据有时间记录，这便于对各批次作物成长的分析。自动定时采集数据，每30分钟对各大棚循环采集存贮一次，这样设计使数据存贮量不会太大又达到监控的效果。 5) 本设计同时可以随时通过pc机键盘手动采集数据和操作大棚的控制系统。"
