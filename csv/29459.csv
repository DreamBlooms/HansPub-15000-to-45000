"随着信息时代的不断发展，信息安全与隐私保护问题越来越受到人们的重视，由于有价值的信号可能受到恶意攻击，因此它们必须在加密的域中进行处理。本文利用Paillier密码系统的同态特性，对加密域内的待处理信号进行小波分解，提出了一种加密的自适应提升小波方法。此外，还提出了采用加密的LBP方案对细节信号进行编码的方法，这些方法用于服务器在没有私钥的情况下进行数据处理，从而避免敏感信息泄露是非常有用的。我们进行了加密域的重构实验、水印实验和掌纹分类实验，验证了我们提出加密域自适应提升小波的有效性和可行性。 关键词 :自适应提升小波，同态加密系统，加密信息处理 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着云计算的诞生与发展，其涉及的信息安全问题越来越受到人们的重视。处理用户的隐私数据成为了信号处理领域的一大热点，且能够实现数据的安全管理、传输、与处理工作变得至关重要。涉及一些个人用于个人身份识别的信息如虹膜、指纹、面部特征等成为研究的热点，相较而言掌纹具有更多的主线、皱纹、脊和细节点等特征，并且拥有非侵入性和高成本效益的优点，我们提出了一种由服务器端在加密状态下对掌纹进行自适应提升小波运算以及特征提取的过程。另外与媒体、版权许可相关的数字水印等信息，作为不可见水印镶嵌入产品时具有隐秘性，作为保护信息安全以及辨别版权真伪的关键信息，数字水印尤其是不可见水印有十分广泛的应用背景，我们所提出的加密信息处理方案同样可以应用于加密水印的嵌入和提取，即服务器端在加密图片上直接嵌入不可见水印，并且可以从中直接提取加密后的水印。在方案的实施过程中，针对可能出现的数据非整数，非正数，数域可能出现扩充等问题进行了研究和探讨，并且介绍了实验过程中必不可少的同态加密域数值比较的方法。"
"同态加密系统主要由RSA [ 1 ] ，ElGamal [ 2 ] ，Paillier [ 3 ] 和Damgard-Jurik [ 4 ] 等加密算法系统组成，本文所提出的自适应提升小波方案是基于Paillier同态加密域的算法方案。 同态加密系统由Rivest等人提出，利用这样的系统可以在不对信息解密的前提下处理加密后的信息 [ 5 ] ，显然地，找出明文和密文之间的代数计算关系是同态加密运算的关键。现有的同态加密系统都有其对应的计算方法变换法则，根据对应变换法则的特点可以将同态加密域分为加法同态加密和乘法同态系统，Pascal Paillier提出的Pailler同态系统具有加法同态性 [ 3 ] ，近年来被广泛应用在安全信息处理领域，而针对自适应提升小波原本的计算方法与加法同态的性质，我们选择该加密域进行研究与实验。Paillier加密系统的运算法则在下小节介绍。  加法同态性可以被描述为明文域的加法运算转换到密文域后变为乘法运算，令 m 1 和 m 2 表示明文，E[´]表示加密过程，D[´]表示解密过程，{pk, sk}表示一对秘钥，分别对应公钥和私钥，加密算法的加法同态性可以表示为： (1) 文献 [ 6 ] 较详细地介绍了基于第三类陷阱门技术的一种陷阱门机制，它是复合剩余类问题的一种，除了具有加法同态性，该方法同时也具有随机自约性和自束性，因此即使不改变明文也可以得到不同的密文，研究主要用到其加密的过程，这里仅介绍算法计算规则部分。  参数p和q为两个大质数并计算它们的乘积，得到N = pq，这样所得到的N很大以至于很难被分解，非零基整数g随机取 Z N 2 的子集，使其满足N整除g的阶 ( g ∈ Z N 2 * ) ，通常为了方便起见，g可以取值为N + 1。公钥 λ 由g和N共同组成，满足条件： λ = l c m ( p − 1 , q − 1 ) ，式中l cm代表最小公倍数。  规定明文m的范围为m < N，之后随机选取一个整数r < N，可以得到加密运算过程为： E p k ( m ) = g m ⋅ r N mod N 2 = c (2) 其中c表示密文 c ∈ Z N 2 * 。  令密文满足c < N 2 ，明文m可以根据以下公式计算得到： D s k ( c ) = L ( c λ mod N 2 ) L ( g λ mod N 2 ) mod N = m (3) 其中 L ( x ) = ( x − 1 ) / N 。 特别地，根据公式(2)和(3)我们可以得到以下关系式： D s k ( E p k ( m 1 ) E p k ( m 2 ) mod N 2 ) = m 1 + m 2 mod N (4) D s k ( E p k ( m 1 ) E p k ( m 2 ) − 1 mod N 2 ) = m 1 − m 2 mod N (5) D s k ( E p k ( m ) k mod N 2 ) = k m mod N (6)"
"上小节对Paillier同态加密过程进行了基本算法介绍，本节在此基础上提出了相应的同态加密域下的自适应提升小波和LBP策略，在研究过程中同样关注了同态加密域的数值比较问题。  通过对自适应提升小波算法的运算过程进行分析 [ 7 ] ，结合Paillier加密系统的加法同态性，我们提出了在同态加密域内实现该方案的具体方法： 首先，用户对大小为 N × M 原明文图像函数 f ( x , y ) 按照公式(2)进行加密运算，之后得到相同大小的加密后图像 f e ( x , y ) (下标“e”表示加密域的参数，下文中出现同样适用)，将其传送给服务器端后，服务器端在加密的情况下对密文进行相应的小波运算，特征提取等处理攻错。与传统提升小波的计算过程相类似的，本方案的准备工作为图像的像素奇偶位置重组，我们将从 f e ( x , y ) 分离得到4个密文图像子块： x e ( n , m ) = f e ( 2 n , 2 m ) ， y e h ( n , m ) = f e ( 2 n − 1 , 2 m ) ， y e v ( n , m ) = f e ( 2 n , 2 m − 1 ) ， y e d ( n , m ) = f e ( 2 n − 1 , 2 m − 1 ) 。为使该方案在明文域得到二值决策矩阵 D ( n , m ) ，八个方向相邻像素均值和偏差值关系表，需要经过以下的运算过程： μ = 1 8 [ y h ( n − 1 , m ) + y h ( n , m ) + y v ( n , m ) + y v ( n , m − 1 ) + y d ( n − 1 , m ) + y d ( n , m ) + y d ( n , m − 1 ) + y d ( n − 1 , m − 1 ) ] (7) σ ( n , m ) = | y h ( n − 1 , m ) − μ | + | y h ( n , m ) − μ | + | y v ( n , m − 1 ) − μ |                             + | y v ( n , m ) − μ | + | y d ( n − 1 , m ) − μ | + | y d ( n , m − 1 ) − μ |                             + | y d ( n , m ) − μ | + | y d ( n − 1 , m − 1 ) − μ | (8) 在公式(7)和(8)的基础上可以得到二值决策阵 D ( n , m ) 的算法： D ( n , m ) = { 0 σ ( n , m ) > T 1 σ ( n , m ) ≤ T (9) 其中T为阈值我们可以根据具体情况和需要进行调整。 近似信号 x ′ ( n , m ) 被定义为： x ′ ( n , m ) = { x ( n , m ) D ( n , m ) = 0 1 2 [ x ( n , m ) + U ] D ( n , m ) = 1 (10) 其中U为更新因子，被定义为： U = 1 4 [ y h ( n − 1 , m ) + y h ( n , m ) + y v ( n , m − 1 ) + y v ( n , m ) ] (11) 预测参数可以根据以下公式得到： p h ( n , m ) = 1 2 [ x ′ ( n − 1 , m ) + x ′ ( n , m ) ] (12) p v ( n , m ) = 1 2 [ x ′ ( n , m − 1 ) + x ′ ( n , m ) ] (13) p d ( n , m ) = 1 2 [ x ′ ( n − 1 , m − 1 ) + x ′ ( n , m ) ] (14) 根据上述的公式，细节信号参数 y ′ h ， y ′ v 和 y ′ d 可以被定义为： y ′ h ( n , m ) = | y h ( n , m ) − p h ( n , m ) | (15) y ′ v ( n , m ) = | y v ( n , m ) − p v ( n , m ) | (16) (17) 求得估计信号 x ′ ( n , m ) 和细节信号参数 y ′ h ， y ′ v 和 y ′ d 的过程包括了四则运算和绝对值运算，显然如果我们对整数进行加减乘运算并不会得到带小数的结果，但是从公式(7)~(17)可以看出，计算过程中同样包含了除法运算，因此我们无法确保计算结果都是整数，公式(9)包含了绝对值运算和两个数之间比较大小的问题，上述提到的运算在明文域进行都是十分方便的，但由于同态加密域中所有参与运算的参数和数据必须以整数形式表达出来这一特点，在同态加密系统中完成上述运算是一项重要且艰巨的挑战。 基于从加密后图像 f e ( x , y ) 分离出来的子图像 y e h ( n , m ) ， y e v ( n , m ) 和 y e d ( n , m ) ，通过对 σ ( n , m ) 和T值扩大8倍的运算，我们可以得到同态加密域下的二值决策矩阵 D e (实际上与明文域下的D相同)。具体方法如下：令 y e h 8 ( n , m ) = y e h Q ( n , m ) ， y e v 8 ( n , m ) = y e v Q ( n , m ) ， y e d 8 ( n , m ) = y e d Q ( n , m ) 其中Q = 8，再根据式(4)~式(8)，可推导出如下计算公式： μ e = y e h 8 ( n − 1 , m ) × y e h 8 ( n , m ) × y e v 8 ( n , m ) × y e v 8 ( n , m − 1 ) × y e d 8 ( n − 1 , m ) × y e d 8 ( n , m ) × y e d 8 ( n , m − 1 ) × y e d 8 ( n − 1 , m − 1 ) (18) σ e ( n , m ) = | y e h 8 ( n − 1 , m ) − μ e | e × | y e h 8 ( n , m ) − μ e | e × | y e v 8 ( n , m − 1 ) − μ e | e                             × | y e v 8 ( n , m ) − μ e | e × | y e d 8 ( n − 1 , m ) − μ e | e × | y e d 8 ( n , m − 1 ) − μ e | e                             × | y e d 8 ( n , m ) − μ e | e × | y e d 8 ( n − 1 , m − 1 ) − μ e | e (19) 其中，加密域下的绝对值运算 | x 1 − x 2 | e 可以被表示为： | x 1 − x 2 | e = { x 1 ⋅ x 2 − 1 x 1 ≥ x 2 x 2 ⋅ x 1 − 1 x 1 < x 2 (20) 式中的 x n − 1 表示 x n 的模逆。 同态加密域的二值决策矩阵 D e ( n , m ) 被定义为： D e ( n , m ) = { 0 σ e ( n , m ) > T e 1 σ e ( n , m ) ≤ T e (21) 其中 T e = E ( T , r ) 8 mod N 2 。如果将所有参数同时扩大相同倍数，他们的数值之间的大小关系并不会发生改变，进行这样运算相当于扩充了仅是为了确保加密域下的所有参数为整数，因此不难得知 D e ( n , m ) 与 D ( n , m ) 的值实际上是相同的。本文的3.3小节对同态比较方法进行了介绍。 为了在随后的计算过程中同样避免小数的产生，该运算过程中需要首先将明文域原图像素扩大16倍，并根据公式(4)~(6)的同态法则将相应的运算过程转换至密文域中。当从密文图像 f e ( x , y ) 求得决策矩阵 D e ( n , m ) 之后，可以得到同态加密域下的近似信号 x ′ e ( n , m ) 为： x ′ e ( n , m ) = { E ( x ( n , m ) ) 16 mod N 2 D e ( n , m ) = 0 E ( x ( n , m ) ) 8 × E ( U 4 ) 2 mod N 2 D e ( n , m ) = 1 (22) 其中 U 4 = y e h ( n − 1 , m ) × y e h ( n , m ) × y e v ( n , m − 1 ) × y e v ( n , m ) ，原计算公式(12)~(17)可以按法则转换到同态加密系统下，依次为： p e h ( n , m ) = x ′ e ( n − 1 , m ) × x ′ e ( n , m ) (23) p e v ( n , m ) = x ′ e ( n , m − 1 ) × x ′ e ( n , m ) (24) p e d ( n , m ) = x ′ e ( n − 1 , m − 1 ) × x ′ e ( n , m ) (25) y ′ e h ( n , m ) = | y e h Q ( n , m ) − p e h ( n , m ) | e (26) y ′ e v ( n , m ) = | y e v Q ( n , m ) − p e v ( n , m ) | e (27) y ′ e d ( n , m ) = | y e d Q ( n , m ) − p e d ( n , m ) | e (28) 其中，式(26)~(28)中的Q = 16。为了在加密域直接进行图像重构，根据式(26)~(28)中绝对值运算的过程，需要保留运算过程中的数值大小关系矩阵 C e h ( n , m ) ， C e v ( n , m ) 和 C e d ( n , m ) 。图1(a)，图1(b)分别给出了加密域下的自适应提升小波运算步骤和其逆运算的步骤。 图1. (a)加密提升小波方案；(b)加密小波逆运算方案  LBP (local binary patterns)是一种局部特征算子，近年来被广泛应用于图像的识别工作当中 [ 8 ] [ 9 ] [ 10 ] ，LBP算法的基本思想是：将图片分成数个小区域，选区每个区域中的中心点像素的灰度值作为一个阈值，取中心点邻近像素的值与阈值进行对比，根据比较的结果对图像像素进行某种规则的编码。图2是中心 像素与其邻近像素的示意图，其中 x c 表示中心像素， x p , ( p = 0 , 1 , ⋯ p − 1 ) 为邻近像素，这里选取径向距 离R = 1，p = 8，表示编码方式考虑8个不同方向，由此，每个中心像素点的编码过程可以表示如下： L B P p , R = ∑ p = 0 p − 1 s ( x p − x c ) ⋅ 2 p (29) 其中，门限函数 s ( x ) = { 1 x ≥ 0 0 x < 0 [ 11 ] ，大于等于中心点像素则赋值为1，小于则赋0值，编码顺序可以 采取顺时针或逆时针任意一种形式，并根据公式进行加权求和运算得到直方图，保留直方图中的有效数据作为特征向量进行接下来的识别工作。 图2. p= 8，R = 1相邻像素顺时针编码示意图 要在加密域进行LBP运算的核心问题依然是同态加密域下的两个数值比较大小的问题，3.3节详细介绍了所要用到的同态加密域下的比较大小策略，在我们用该方法求出加密域的 s ( x ) 的值后，式(29)依旧可以用相同的形式来计算密文图像没一个中心像素的LBP值。  对于加密域两个密文数值大小比较： c 1 = E ( m 1 , r 1 ) ， c 2 = E ( m 2 , r 2 ) ，用户需要发送 c 1 ， c 2 至服务器，并且将密文域从0到 N 2 − 1 划分为k个区间，区间的个数取决于用户在明文域的门限设置 T i ∈ Z n 。用户需要首先将数个门限值 T i 进行加密为 T e i u ： T e i u = E ( T i , r u ) = g T i r u N mod N 2 (30) 其中r u 分别等于r 1 和r 2 ， i = 1 , 2 , 3 ⋯ , k 。根据文献 [ 8 ] ，同态比较的原则是找到加密数据在整个数据段中 的位置，即被 T e i u 分段后所处的段位，根据公式(4)不难得出， E ( m u , r u ) ⋅ E ( I n c , r s ) = E ( m u + I n c , r u ⋅ r s ) 可以通过计算逐步步长Inc接近门限 T e i u 来得到。很明显， m u 与 T e i u 之间的距离可以通过给 E ( m u , r u ) 逐步乘 E ( 1 , 1 ) 直到 E ( m u + I n c , r u ) = T e i u ， ( i = 1 , 2 ⋯ , k ) 这样的方式来进行度量。具体的比较策略如下： ( s u , d u ) = arg min i , I n c ( E ( T i , r u ) − E ( m u , r u ) g I n c ) (31) 其中s u 表示与密文c u 数值上最接近的门限值，d u 衡量了与最接近的门限值之间的距离，因此通过两个密文我们可以得到两组数据 ( s 1 , d 1 ) 和 ( s 2 , d 2 ) ，密文c 1 和c 2 之间的数值大小关系比较方法为：如果s 1 > s 2 ，则c 1 > c 2 ；如果s 1 < s 2 ，则c 1 < c 2 ，如果得到的结果是s 1 = s 2 ，则比较的结果取决于d u 的值： { i f d 1 > d 2 h e n c 1 < c 2 i f d 1 < d 2 h e n c 1 > c 2 i f d 1 = d 2 h e n c 1 = c 2 (32) 以上介绍的同态数值大小的比较方法可以用于加密系统的绝对值运算，LBP运算，以及后续实验中要将用到的K近邻分类方法的计算过程中。"
"图3(a)为大小为512 × 512的灰度图像“peppers”作为我们重构实验的原图像信号，用两个大质数将其加密之后并按照2.1节提出的加密提升小波算法进行处理，并且按照公式(18)~(28)的逆运算逐步进行图像的重构过程，这里不重复介绍逆运算的细节，图3(a)~(d)分别展示了原图像，加密后的图像，重构后的加密图像以及解密后的重构图像，实验过程中MIM方案 [ 12 ] 用于减少数域的扩充问题，也就是在运算中利用MIM进行数据的除法运算，从而消除了扩张因子Q对数域扩充的影响。从图3(a)和图3(d)我们可以看出，两张图片在相同位置具有相同的像素值，这意味着解密后的重构图像与原图像完全相同，整个加密重构过程并没有出现失真的问题。 图3. (a) 原灰度图像；(b) 加密后的灰度图像；(c) 加密域重构图像；(d) 解密的重构图像  利用我们提出的自适应提升小波策略，同样在加密域进行了图像的水印实验，本次实验采用了文献 [ 13 ] 中所介绍的水印嵌入方式，嵌入水印的公式为： v ′ i = v i + α w i (33) 其中，v i 表示原图像信号，w i 为需要嵌入的水印信号，选取如图4(a)所示的陕西师范大学校徽二值图像，大小为128 × 128像素作为水印信号进行实验，参数α是从{1, 2, …, k}中随机选取的一个小整数，为适当简化加密域中的水印运算，这里我们取α = 2。值得注意的是，在实验中一般将不可见水印嵌入中频信号中以减少对原宿主图片的影响，即v i 表示图片的中频信号。因此，将原图进行两次小波分解之后，将水印信号w i 嵌入第二次分解的高频信号中，此时的高频信号对于原图像来说相当于其中频信号。 根据同态加密域的性质，水印嵌入公式(33)被改写为以下的加密形式： E ( v ′ i ) = E ( v i ) E ( w i ) α (34) 图4. (a) 校徽水印图像；(b)从明文中提取的水印图像；(c) 从密文中提取的水印图像 为了避免在水印嵌入后的重构过程中出现非整数运算，经实验验证量化因子 Q = 2 7 可以保证水印嵌入和提取过程中的可行性，图5(a)是已嵌入水印的加密图像，图5(b)是解密后的含水印图像，实验过程中同样采取了MIM方法来避免数域的扩充。 图5. (a) 已嵌入水印的加密图像；(b) 解密含水印图像 由于嵌入的水印图像为二值图像，为了确保提取出的水印像素值仅由整数构成，我们采用了门限比较方案如式(35)所示从宿主图像中提取水印图像。 w i = { 1 D [ E ( v ′ i ) E ( v i ) − 1 ] > T 0 D [ E ( v ′ i ) E ( v i ) − 1 ] ≤ T (35) 其中，由多次实验选取合适的门限值T。图4(b)，图4(c)分别展示了从明文图像提取出来的水印图像和从密文图像中提取的水印图像。我们分别采用PSNR和归一化相关系数(NC) [ 6 ] 来衡量提取水印的保真度和测量明文域和密文域提取水印信号与原水印信号的相似度。实验结果见表1。 Table 1 明文域 加密域 PSNR 50.3091 50.3094 NC 0.9590 0.9577 表1. 水印实验PSNR值和NC值 通过实验结果可以看出，加密域的水印嵌入和提取实验结果与直接在明文域进行的结果几乎可以达到近似的结果，说明了我们所提出方案的可行性与保真性。  在本小节，针对香港理工大学掌纹数据库Poly-II [ 14 ] 进行了加密系统的掌纹识别实验，该数据库由两大部分组成，包含了193个人的共386个掌纹图片，总数为7720张大小为384 × 284的掌纹灰度图像，两部分图像由两次采集组成，平均时间间隔相差了69天，每次分别针对同一个手掌图片采集十张照片，二次采集过程中相机的焦点和光源不同，因此可以看成是由不同的掌纹采集设备所得到的数据集。  本实验目的主要在于比较提出的加密算法和其明文域算法对于掌纹识别工作的准确性。由于在加密域中反复进行同态比较运算需要大量的计算时间，因此从该数据库的每部分中随机抽取了500张图片进行实验。分别以第一部分和第二部分十张图片中的前五张作为训练样本构成训练集，后五张作为测试样本，图6列举出了一些数据库的样本示例。实验提取特征的过程为：将每张图片加密后实施加密域自适应提升小波方案，得到一张近似图像和三张细节图像，再通过加密域LBP算法将每张细节图像转换为二进制编码的形式得到图像特征，在此基础上利用K近邻分类的方法对数据进行分类，表2分别列出了明文掌纹图片和加密条件下的掌纹图片进行分类的结果。 图6. 部分掌纹数据库图片 Table 2 样本数据 正确分类率(CCPs%) 明文数据集 加密数据集 第一部分数据 93.0 93.0 第二部分数据 99.6 99.2 表2. 明文域与加密域下的掌纹识别性能 从表2可以看出，本文所提出的方案在加密数据集下进行实验，与明文条件下直接进行小波运算并提取特征再分类的识别率几乎相同，并没有因为加密过程对图像像素造成的混乱而影响识别精度，即保证了信息安全的同时也可以完成相应的识别任务。  本实验的目的在于验证加密算法下的识别工作对不同聚焦光照条件下的掌纹识别工作的鲁棒性。本次实验从每部分随机抽取250张图片，两部分共500张图片，第一部分十张图片的前五张作为训练样本，第二部分的前五张作为训练样本，对样本进行加密后用本章提出的方法进行特征提取工作，与此同时，Pan [ 15 ] ，Kong [ 16 ] ，2D-Gabor小波 [ 17 ] ，以及传统的主成分分析 [ 18 ] ，线性判别分析 [ 19 ] 的方法也在这里与我们的方法进行了比较，表3分别列出了这些方法分别针对明文掌纹图像和加密掌纹图像下的识别率。 Table 3 方法 正确识别率(%) 明文数据集 加密数据集 Pan方法 96.00 30.40 Kong方法 92.80 28.80 2D-Gabor小波 97.20 37.20 主成分分析 94.00 44.40 线性判别分析 92.80 42.80 本文的方法 99.20 99.20 表3. 多种方法下的明文数据与加密数据分类正确率 通过实验结果可以看出，我们提出的方法在明文数据集下具有更好的分类性能，而在应用于加密数据上，由于加密过程造成的掌纹结构与纹理信息的混乱，导致传统方法的识别过程无法得到需要的高精度的识别结果，而我们提出的方案由于其应用于加密域时所具有的无损的性质，从而在加密的样本数据上依然保持了与明文域等同的正确识别率，这样可以得出结论是，我们的算法在加密域中具有鲁棒性，可以应用于隐私保护相关领域的识别工作。"
"本文提出了一种无精度损失的Pallier加密域自适应提升小波的实现方案，在此基础上同样提出了加密域LBP的实现方法。基于Paillier同态加密系统的性质与特点与原有的自适应提升小波思想，我们科学合理推导了其在加密域的计算公式，并给出了相关扩张因子的大小以确保计算过程无误差地进行。相较于已有的其他加密系统的SIFT，DCT等图像变换方法，我们所提出的方案通过准确扩大像素的倍数以及通过采用相对较小的扩张因子，使加密域数据的计算更加精确。相关实验分别验证了其在图像重构、水印嵌入提取和掌纹识别方面都具有良好的应用前景，即保证了敏感隐私信息的安全性，也完成了相应的图像信息处理任务。"
