"车载激光点云在城市道路资产管理、高精驾驶地图、农村宅基地调查、高速公路改扩建、智能交通等国家重大工程应用中发挥着非常重要的作用；然而，受道路环境复杂、定位信号受遮挡、定姿误差累积等影响，导致往返或不同时相的重访车载点云存在分米甚至米级的位置偏差，严重影响后续数据处理与应用。为解决上述技术瓶颈，本文提出一种城市场景重访车载点云位置一致性改正算法。首先，依据车载轨迹的加速度与角速度将车载点云数据进行层次化分段，同时保证重访段的重叠度；然后，提取分段内的二进制形状上下文(Binary Shape Context, BSC)特征，并依据视觉单词与先验信息加速同名BSC特征匹配；最后，依次进行重访粗分段和细分段点云的两两配准，并剔除不可靠的两两配准结果。实验表明，本文方法能有效改正城市场景重访车载点云中的位置不一致问题，对于不同偏差级别和时相的车载点云，具有很高的鲁棒性和时间效率。 关键词 :城市场景，两两配准，位置一致性改正，车载点云 Copyright © 2019 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"车载激光扫描系统可以高效率、高密度地获取道路环境的三维几何与纹理信息，为高分辨率对地观测提供了一种全新的技术手段。车载激光点云在城市道路资产管理、高精驾驶地图、农村宅基地调查、高速公路改扩建、智能交通等国家重大工程应用中发挥着非常重要的作用 [ 1 ] 。然而，受GNSS系统定位误差、IMU定姿误差、扫描仪测角和测距误差、多传感器安装误差、数据解算误差等的综合影响，车载激光点云的位置精度难以达到厘米级精度要求。特别是在高楼林立的城区，卫星信号遮挡严重、定位精度差，导致车载激光扫描系统往返和不同时相观测的点云之间存在分米甚至米级偏差，难以满足上述应用的精度需求 [ 2 ] [ 3 ] 。 在工程应用中，通常沿车载点云采集轨迹布设密集控制点，依据地面控制点改正车载点云的相对与绝对精度，但是存在控制点布设难度大、劳动力成本高、自动化水平低等问题 [ 4 ] 。针对重访车载点云中存在的位置不一致问题，学者进行了大量深入研究。现有方法可分为数据驱动和传感器驱动两类，数据驱动方法直接改正点云中的位置偏差，传感器驱动方法首先改正车辆轨迹的位置和姿态，然后重新解算点云数据。文献 [ 5 ] 依据轨迹关键点进行点云分段，并利用变种ICP [ 6 ] 进行分段点云间的两两配准，然后利用配准结果计算轨迹关键点的位姿，最后通过线性内插的方式获得每个轨迹点改正后的位姿。文献 [ 7 ] 首先检测车载点云中的闭合环，并利用闭合环约束改善其内部点云数据；然后利用相邻闭合环间的重叠区域改善点云数据整体质量。文献 [ 8 ] 提出一种基于位姿图的城市级点云建图方法，首先利用随机森林分类器和稳健的优化方法剔除不稳定的局部改正结果，并利用条件随机场识别和剔除动态目标，以消除动态物体对位置精度改善的负面影响。数据驱动方法利用重访点云中同名特征之间的一致性关系作为约束来改正点云位置精度 [ 9 ] [ 10 ] [ 11 ] ，该类方法假设误差在一定范围内呈线性分布，难以解决大偏差的非刚性形变 [ 12 ] 。文献 [ 13 ] 提出一种车载轨迹随时间变化的模型，利用地面控制点构建并解算该模型，从而改正轨迹误差。文献 [ 14 ] 将点云按时间均匀分段，并通过两步ICP算法得到准确的同名对应，再利用误差时变模型改正轨迹误差。文献 [ 15 ] 首先提取车载点云中不同尺度的地物目标，并利用多尺度ICP建立地物目标之间的对应关系，从而实现由粗到细的车载点云数据质量改善。该方法能够解决城市规模的车载点云数据位置一致性改正，但是其严重依赖于各类地物目标和特征提取的质量，在复杂城市场景中的可行性较差。基于“云控制”的思想，文献 [ 16 ] 首先把车载点云跟高分辨率航空影像密集匹配点云进行配准，然后根据同名点、GPS观测值、IMU观测值提供的多种约束提高车载点云位置精度。由于航空影像和车载点云的获取视角相差很大，在遮挡严重的城市场景很难找到共同观测，因此该方法在复杂城市场景中的鲁棒性较差。虽然上述方法在特定场景下取得了理想的效果，但仍然存在大量控制点依赖、适用性和鲁棒性差、无法解决大偏差的非刚性形变等局限性。 针对目前方法的缺陷，本文提出一种基于轨迹分段的重访车载点云位置一致性改正算法，主要贡献有： 1) 提出一种顾及点云误差分布特性的车载点云自适应分段方法，同时保证重访段间的重叠度，提高了车载点云分段的合理性； 2) 发展了一种视觉单词和先验信息约束的同名特征匹配算法，提高了同名特征匹配的效率和准确度； 3) 研究了一种由粗到细的车载点云两两配准策略，有效解决了重访车载点云存在的大偏差和非刚性形变等问题。"
"本文提出的城市场景重访车载点云位置一致性改正方法，主要分为顾及点云误差分布特性的自适应分段、视觉单词和先验信息约束的同名特征匹配、由粗到细的车载点云两两配准等3个步骤。城市场景重访车载点云位置一致性改正算法流程如图1。 图1. 算法流程图  为解决车载点云中存在的非刚性形变，需要将车载点云进行分段，假设段内点云不存在形变，纠正段间的非刚性形变，而车载点云中的位置偏差常常出现在采集车速度和方向急剧变化的地方，并且这些地方的误差是非线性分布的，因此可用速度和方向急剧变化的轨迹点将点云分段。此外，为解决大偏差和场景中对称性结构较多的情况，本文将细分段合并成粗分段，为后续由粗到细的两两配准提供支持。本文提出的顾及点云误差分布特性的车载点云自适应分段方法分4步：选择候选分段点、寻找重访分段点、筛选分段点、车载点云分段。 图2. 车载点云分段算法流程图，(a)依据加速度寻找分段点，(b)依据角速度寻找分段点，(c)依据轨迹交点寻找分段点，(d)当相邻分段点间距过大时，在中间插入新的分段点，(e)所有候选分段点，(f)寻找重访分段点，(g)筛选分段点，(h)合并细分段，产生粗分段，(i)图例 1) 选择候选分段点： 计算轨迹点的加速度和角速度，加速度Q a 大于阈值a th 的轨迹为速度变化点，即 Q a = { q j | | v j − v j − 1 | / ( t j − t j − 1 ) ≥ a t h } ，其中q i 为一轨迹点，其速度 v j = q j − q j − 1 / ( t j − t j − 1 ) ；角速度Q o 大于阈值 的轨迹点为角度变化点，即 Q o = { q j | ( φ j − φ j − 1 ) / ( t j − t j − 1 ) ≥ ω t h } ，其中 φ j 为轨迹点 q j 的航向角。记 q a s t a r t ， q a e n d 分别为连续速度变化轨迹段的首尾轨迹点， q o s t a r t ， q o e n d 分别为连续角度变化轨迹段的首尾轨迹点，分别沿轨迹向外扩展一定距离 d t h 1 ，取该处轨迹点为候选分段点，如图2(a)和图2(b)。寻找轨迹的交点 q c r o s s ，沿轨迹向外扩展一定距离 d t h 2 ，取该处轨迹点为候选分段点，如图2(c)。当相邻候选分段点间隔大于 d e q 时，取中点处的轨迹点为新增候选分段点，如图2(d)。 2) 寻找重访分段点： 对于每个候选分段点，寻找半径阈值d c 内最近的轨迹点，候选分段点到该轨迹点间的轨迹距离必须大于一定距离d i ，满足上述条件时，将寻找到的轨迹点作为候选分段点的重访分段点，如图2(f)。寻找重访分段点的目的在于使重访分段间的重叠度最大，使得后续两两配准更为鲁棒。 3) 筛选分段点： 步骤1)和2)找到的候选分段点分布可能不均匀，在交叉路口附近的分段点可能会过于密集，因此，需要在候选分段点中筛选得到最终的分段点。首先，删除轨迹交点中间的候选分段点，然后以一定间隔d i 将轨迹均匀分段，每段内最多保留一个分段点，且优先保留成对的分段点，如图2(g)。 4) 车载点云分段： 依据步骤3)得到的分段点，将车载点云进行分段，得到的分段为细分段，再将细分段按长度阈值d large 合并得到粗分段，如图2(h)。  本文计算二进制形状上下文(Binary Shape Context, BSC)特征 [ 17 ] 用于点云局部特征描述和同名特征匹配，为提高匹配的效率和准确度，本文提出视觉单词和先验信息约束的特征匹配方法。 1) 先验信息加速特征匹配： 暴力匹配和使用视觉单词加速的特征匹配方法只考虑了特征间的相似性，没有考虑特征点的位置约束。因此，可以依据重访车载点云初始位置和位置精度信息缩小特征搜索范围，进而提高特征匹配的准确度和效率。粗分段的BSC特征搜索半径依据车载点云初始位置精度确定，细分段的特征搜索半径依据粗分段两两配准后同名点距离残差确定。 2) 视觉单词加速特征匹配： 首先，用k-means算法对提取的BSC特征进行聚类，每个类作为视觉单词 [ 18 ] ；然后，对于源点云中的每个特征点，检索目标点云中具有相同视觉单词的特征点集合;最后，找到特征点集合中最相似的特征点。该方法可以排除大量完全不相似的目标特征，提高特征匹配效率。  当车载点云中位置偏差较大或存在对称性场景时，两两配准不够鲁棒。为解决该问题，本文提出一种由粗到细的两两配准方法。该方法分为3步：重访段探测、粗分段两两配准、细分段两两配准，如图3。粗分段的优点是能成功探测大偏差车载点云中的重访段，提高对称性场景中同名特征匹配准确度，缺点是段内非刚性形变较大；细分段的优点是段内非刚性形变小，满足段内刚性形变假设，缺点是提取到的特征少，对称性场景下同名特征匹配准确度低。因此，需要结合两者的优点，先进行粗分段两两配准，再进行细分段两两配准，从而提高算法对大偏差和对称性场景的鲁棒性。 图3. (a)重访粗分段，(b)重访细分段，PC 0 与PC 1 为重访粗分段，PC i 与PC j 为重访细分段 1) 重访段探测： 车载轨迹精度较高，重访点云段的位置偏差一般较小，可直接依据包围盒是否相交判断两段是否重访 [ 19 ] 。由于后续会剔除不可靠的两两配准结果，探测重访段只需保证没有重访段被遗漏。 2) 粗分段两两配准： 先提取所有重访分段的BSC特征，依据2.2方法进行同名特征匹配，剔除同名特征少于N feature 的重访粗分段，再依据BSC同名特征集合，计算重访粗分段点云间的相对位姿与同名点对的均方根误差，剔除同名点对中外点比率过大的两两配准结果。 3) 细分段两两配准： 将粗分段点云两两配准结果传递给细分段点云，利用粗分段两两配准结果(相对位姿与均方根误差)重新进行BSC特征匹配，剔除同名特征少于N feature 的重访细分段，再依据BSC同名特征集合，计算重访细分段点云间的相对位姿与同名点对的均方根误差，剔除同名点对中外点比率过大的两两配准结果。"
"本文使用3份重访车载点云数据验证本文方法的有效性。数据1长度约1.1 km，包含1.2亿点，最大偏差约0.24 m；数据2长度约0.85 km，包含1.57亿点，最大偏差约0.62 m；数据3长度约0.65 km，包含1.57亿点，最大偏差约0.89 m。数据1、2、3的俯瞰图如图4，实验参数及取值如表1。本文实验使用处理器为Intel(R) Core(TM) i7-6700HQ CPU @ 2.60 GHz 2.59 GHz，内存为16 GB。 图4. 实验数据俯瞰图，(a)数据1，(b)数据2，(c)数据3 Table 1 参数 参数值 参数含义 a th 1.5 m/s 2 加速度阈值 a th 8.5˚ 角速度阈值 d th 1 10 m 依据加速度与角速度确定分段点时沿轨迹外推的距离阈值 d th 2 25 m 依据轨迹交点确定分段点时沿轨迹外推的距离阈值 d eq 100 m 最大的分段长度 d c 20 m 重访分段点探测半径 d i 10 m 分段点筛选的间距阈值 N feature 40 最小同名点对数 表1. 实验参数设置   图5为数据2自适应分段结果，蓝色为车载轨迹，彩色为分段点云。由图可知，本文通过搜寻重访分段点使得往返车载点云基本在相同位置分段，重访段有很大的重叠度，保证了后续两两配准的鲁棒性，实验结果充分验证了本文提出的重访车载点云自适应分段方法的有效性与合理性。 图5. 点云分段结果，(a)车载轨迹(蓝色)，(b)分段点云  暴力匹配、视觉单词和本文方法的同名特征匹配结果如图6，定量评价结果如表2。由图表可知，暴力匹配效率最低，同名特征匹配准确度较先验位置精度信息约束的同名特征匹配差，视觉单词约束的同名特征匹配效率较高，但同名特征匹配准确度最低，本文方法的同名特征匹配效率和准确度都最高。实验表明，本文提出的依据经验或先验位置精度信息约束的同名特征匹配方法显著提高了同名特征匹配的准确度和效率。 图6. 基于不同特征匹配方法的两两粗配准结果，(a)基于暴力匹配的配准结果，(b)基于视觉单词加速的特征匹配方法的配准结果，(c)基于先验位置精度信息加速的特征匹配方法的配准结果 Table 2 匹配方法 同名特征数 匹配耗时(s) 同名点对均方根误差(m) 暴力匹配 86 165.66 0.173 视觉单词加速 68 18.66 0.199 本文方法(先验信息加速) 428 13.31 0.145 表2. 基于不同特征匹配方法的两两配准结果  3份车载点云两两配准结果分别如图7~9，定量评价结果如表3。如图所示，3份重访车载点云经由粗到细的两两配准后，位置不一致问题得到显著改善。数据1最大偏差约为0.241 m，改正后减小至0.145 m；数据2最大偏差约为0.622 m，改正后减小至0.164 m；数据3最大偏差约为0.886 m，改正后减小至0.205 m；实验表明，本文方法能有效改正重访车载点云中的位置不一致问题。 图7. 数据1的两两配准结果，(a)原始点云数据，(b)配准后点云数据 图8. 数据2的两两配准结果，(a)原始点云数据，(b)配准后点云数据 图9. 数据3的两两配准结果，(a)原始点云数据，(b)配准后点云数据 Table 3 数据 原始数据最大偏差(m) 改正后均方根误差(m) X方向 Y方向 Z方向 三维 X方向 Y方向 Z方向 三维 数据1 0.108 0.098 0.228 0.241 0.081 0.081 0.090 0.145 数据2 0.375 0.436 0.406 0.622 0.091 0.098 0.094 0.164 数据3 0.295 0.739 0.773 0.886 0.138 0.103 0.110 0.205 表3. 两两配准结果 实验表明，本文顾及点云误差分布特性的车载点云自适应分段方法，通过搜寻重访分段点保证了重访段间重叠度，通过粗细分段为后续由粗到细的两两配准策略提供了支持；视觉单词和先验信息约束的同名特征匹配方法，通过视觉单词和先验信息缩小特征搜索范围，提高了同名特征匹配的准确度和效率；由粗到细的两两配准策略，通过粗分段两两配准给细分段两两配准提供良好初值，提高了对特征稀疏、结构对称、位置偏差大等场景的适应性，能有效解决不同偏差级别的重访车载点云中的位置不一致问题。"
"本文提出了一种城市场景重访车载点云位置一致性改正的方法。提出顾及点云误差分布特性的车载点云自适应分段方法，保证重访段间重叠度和提高车载点云分段的合理性；研究视觉单词和先验信息约束的同名特征匹配方法，提高同名特征匹配的准确度和效率；发展由粗到细的车载点云两两配准策略，解决不同偏差级别重访车载点云中的位置不一致问题。实验表明，本文方法能有效解决城市场景重访车载点云的位置不一致问题，特别是对于大偏差的车载点云数据，该方法高效鲁棒。但是，本文方法也有不足之处，该方法直接纠正点云中的位置偏差，没有在两两配准结果的基础上进行整体优化。后续研究将解决上述问题，完善现有车载点云位置一致性改正算法，提高算法的改正精度和鲁棒性。"
