"针对采集的触摸屏图片存在图片整体偏暗、对比度低，背景噪声较多，难以分割图像中缺陷的问题，提出一种基于改进MSR (多尺度Retinex滤波)的小波变换图像增强算法。该算法首先对图像进行小波分解，得到图像的低频分量使用以中值滤波模板代替高斯滤波模板的改进MSR处理以增强低频系数，对高频分量进行同态滤波以限制噪声，最后通过小波逆变换重建图像。本文将改进的算法应用于采集的触摸屏表面缺陷图片，通过VS2017软件进行仿真实验，并与同态滤波算法、MSR算法进行对比。实验结果表明，使用改进MSR算法提高了算法的运行速度，该算法优于传统的MSR算法，对图像的增强、噪声的抑制有良好的效果，改善了图像的整体视觉效果且大大缩短了算法的运行时间。"
"随着社会的发展和人们生活水平的提高，手机，平板电脑等电子产品等移动通讯设备的占有率不断上升，电子触摸屏需求随之日益加大。在触摸屏生产检测系统中，针对采集的图像清晰度低、边缘细节模糊不清、对比度低等问题，需要对图像进行图像增强处理，以利于后续的图像处理。目前针对低对比度的图像增强的方法主要包括变换域法(频域法) [ 1 ]、空间域处理法(空域法)和融合法 [ 2 ]。空间域处理法主要包括直方图法 [ 3 ]、灰度变换法 [ 4 ]、Retinex算法 [ 5 ] 等，其中Retinex理论是基于人眼视觉光亮度和色彩感知模型建立的一种图像增强方法，能够很好的改善图像降质现象，因此被广泛用于图像增强的领域。常见的Retinex图像增强算法包括：单尺度Retinex算法(Single Scale Retinex—SSR)，多尺度Retinex算法 [ 6 ] (Multi-ScaleRetinex—MSR)，McCann’s Retinex算法等。由于多尺度Retinex利用了大、中、小三种不同尺度的优势，其增强效果要优于传统的单尺度Retinex算法。 小波变换 [ 7 ] 是典型的变换域图像增强算法，具有在频率域内噪声谱与图像信号不重叠，低熵性、多分辨率、去相关性和选基灵活性等优点，被广泛应用于图像处理领域。 基于多尺度Retinex算法在计算的过程中存在大量的卷积运算，降低了算法的运行效率，同时在增强过程中加大了噪声，针对上述问题，本文提出一种基于MSR的小波变换图像增强算法，低频部分采用均值模板来替代高斯卷积模板的MSR算法进行增强，高频成分使用同态滤波降噪，该算法在提高MSR算法运行速度的同时抑制了噪声，提高图像的对比度。"
"在小波选取上，选择光滑的、正交的、对称的小波来处理图像的优点是速度快、图像重构精确性高、可以避免图像处理中发生相移。满足上述条件的有db小波系与sym小波系，同db小波系相比，sym小波系有更好的对称性，更适合于图像处理。本文选取sym2小波，对图像作二层小波分解。  小波变换 [ 8 ] 具有多分辨分析能力和去相关性等特点，小波域能很好地实现信噪分离，在增强图像的同时能抑制噪声。对图像进行小波分解 [ 9 ] 得到图像的低频分量 L L ( i ) ，和水平，垂直，对角方向的高频细节 H L ( i ) ， L H ( i ) ， H H ( i ) ( i = 1 , 2 , 3 ) 。将分解得到的低频近似又进行下一层的分解，如此分解下去可得到理论上任意的高频细节和低频成分。分解的层次数目可以根据需要选择，每一层分别对应于不同的频段和分辨率，尺度越小，空间分辨率越高。二层小波分解的示意图如图1所示。 图1. 二层小波分解示意图"
"假设原图像为 S ( x , y ) ，亮度图像为 L ( x , y ) ，反射图像为 R ( x , y ) ，且亮度图像是平滑的，可得: log [ R ( x , y ) ] = log S ( x , y ) L ( x , y ) = log [ S ( x , y ) ] − log [ S ( x , y ) * G ( x , y ) ] (1) 其中， G ( x , y ) 为低通卷积函数，用来从原图像中估算亮度图像 L ( x , y ) ， G ( x , y ) 可表示为： G ( x , y ) = λ ⋅ e − ( x 2 + y 2 ) c 2 (2) 其中 λ 是常量归一矩阵，使得： ∬ G ( x , y ) d x d y = 1 (3) c 是尺度常量，决定了对入射分量的估计，即决定了最终的增强效果。 MSR是单尺度Retinex的加权平均，其在对数域中可表示为: r ( x , y ) = ∑ i = 1 N ω i { log [ S ( x , y ) ]     − log [ S ( x , y ) ] * G i ( x , y ) } (4) G i ( x , y ) 表示尺度参数为 c i 的高斯函数， N 表示尺度参数的总个数，一般情况下，MSR算法选取大、中、小3个尺度，一般为： σ 1 < 50 ， 50 < σ 2 < 10 ， σ 3 > 100 ， N = 3 。 ω i 表示加权系数，且满足: ∑ i = 1 N ω i = 1 (5) 通常权值可均取 ω i = 1 / 3 。 图像经高斯卷积后得到图像的低频信息，对图像进行高斯卷积可视为对图像进行加权平均的过程。当选用高斯卷积的尺度较大时，该模板内的数值接近于相等。图2为σ = 200时，模板大小为129 × 129 的高斯加权矩阵。可以看出，模板内的数值的差值很小，而且高斯模板权值的和近似等于1，此时可以使用129 × 129的模板均值近似代替模板中的权值，即使用129 × 129模板数值为0.609 4 × 10 −4 的均值模板来代替该高斯模板。 图2. 大尺度高斯卷积模板 由 [ 10 ] 可知，高斯滤波图与对应尺度的均值图可采用均方差当量来进行分析，其表达式为： V = ∑ i = 0 M ∑ j = 0 N ( g i , j − m i , j ) 2 / ( M ⋅ N ) (6) 上式中，M，N分别为图像的宽和高， g i , j ， m i , j 分别为高斯滤波图像和均值滤波图像上对应的(i, j)点的像素值。均方差当量越小，则说明用均值滤波代替高斯模板滤波的拟合的程度越高，对于 σ = 30 , 90 , 200 的高斯模板，可由均值模板大小分别在(30~40)，(60~70)，(125~135)的范围内选取，方差V能获得最小值。  在小波变换的基础上，将改进的MSR算法与同态滤波很好的结合，处理所得图片具有很好的视觉效果。具体流程如下： 1) 小波分解 小波多尺度分解 [ 11 ] 就是对图像进行不同尺度的分解，既可以大尺度观察图像粗略特征，也可以小尺度观察图像细节特征。对图像进行多层分解可以得到图像的更多细节信息，但是分解的级数越多，算法的效率越低，为了在对获得更多图像细节的同时保证算法的效率，因此本文对异色缺陷图进行二层小波分解。异色缺陷原图及其二级小波分解图分别如图3、图4所示。 图3. 异色缺陷原图 图4. 异色缺陷二级小波分解图 2) 各高频带系数进行同态滤波，低频系数采用改进的MSR算法处理。 对小波分解后得到的高频子带的小波系数采用参数不同指数的同态滤波器进行滤波，滤波器变换函数为： H ( j , ω h , ω v ) = ( γ 1 − γ 2 ) { 1 − exp [ − ( ω h 2 + ω v 2 ) 2 j K c ] } + γ 2 (7) 其中： γ 1 为高频增益， γ 2 为低频增益， K c 为截至系数，经过多次测试， γ 1 = 2.5 ， γ 2 = 0.3 ， K c = 2 时，对采集的同一环境下的触摸屏图像具有较好的滤波去噪效果， j 为小波分解级数。水平细节分量 H , ( ω h , ω v ) = ( 1 , 0 ) ；垂直细节分量 V , ( ω h , ω v ) = ( 0 , 1 ) ，对角细节分量 D , ( ω h , ω v ) = ( 1 , 1 ) 。 低频子带 [ 10 ] 中包含了原始图像中的主要信息，并且含有较少的噪声信号，因此只需对低频子带进行增强便能提高图像整体的对比度。对于低频部分，采用改进的MSR算法进行处理。在本文的算法中，用来替代3个高斯模板的均值滤波模板的尺度为35 × 35，65 × 65，130 × 130。 3) 通过小波逆变换 [ 12 ] 重构图像。 本文的算法流程如下图5所示。 图5. 本文算法流程图"
"本文算法在处理器Intel(R) Core(TM) i5-4210M CPU @2.60GHz，内存8 GB，操作系统为Windows 10的电脑上采用Visual Studio2017仿真实现。为了验证算法的有效性，本文选取图像大小分别为180 × 120，100 × 100，120 × 120三种不同尺寸的图片。并将改进算法实验结果与同态滤波、MSR算法进行比较，采取主客观相结合的方法对处理后的图像进行评价。下图为实验进行测试的原图以及处理之后的效果图。  图6、图7、图8为利用本文提出的算法对采集的触摸屏表面缺陷图像仿真所得的结果。从上图可以看出：利用同态滤波算法处理所得的图像在一定程度上提高了亮度和对比度，但同时出现图像噪声较多、整体泛白，边缘模糊不清现象，图像的视觉效果欠佳。传统的MSR算法能局部动态地提升了图像的对比度，突出了图像的细节显示，提高了图像亮度，但与原始图像相比出现了过度增强和噪声放大现象。本文算法与前面两种算法相比，不仅提高对比度的还抑制了噪声，图像的细节得到凸显，有效的避免了过度增强的现象，与前两种算法相比增强后的图像更加的清晰化，具有更好的视觉效果。 图6. 图a的各算法处理效果图 图7. 图b的各算法处理效果图 图8. 图c各算法处理效果图  主观评价取决于人的主观意识，没有统一的标准，评价存在很大的偏差。为了更为客观、科学地对图像进行评价，本文选取峰值信噪比(PSNR)、灰度均值(mean)、信息熵(En)、标准差(std)作为评价指标，其中峰值信噪比越高，图像抑制噪声能力就越强 [ 13 ]，信息熵 [ 14 ] 越大图像的信息量越多，标准差 [ 15 ] 越大，对比度就越大，灰度均值越高，图像越容易辨识，4个评价指标值越大则图像质量越好。 表1、表2、表3为上述各算法处理之后的数据结果，表4为分别使用高斯模板和均值模板的处理时间对比结果。 Table 1图像来源 峰值信噪比 (PNSR) 灰度均值 (mean) 信息熵 (En) 图像标准差 (std) 原图信息 28.45 73.65 4.26 8.38 同态滤波 24.39 113.34 5.23 14.23. MSR 26.18 118.08 4.74 10.58 本文算法 27.85 73.92 4.28 9.43 表1. 各算法处理图a的数据比较 Table 2图像来源 峰值信噪比 (PNSR) 灰度均值(mean) 信息熵 (En) 图像标准差 (std) 原图信息 33.21 66.95 4.40 8.13 同态滤波 27.15 102.47 5.36 17.54 MSR 24.61 51.42 5.83 19.40 本文算法 28.17 45.59 4.53 17.06 表2. 各算法处理图b的数据比较 Table 3图像来源 峰值信噪比 (PNSR) 灰度均值 (mean) 信息熵 (En) 图像标准差 (std) 原图信息 28.42 85.01 4.73 10.32 同态滤波 22.57 133.00 5.72 20.56 MSR 23.49 45.13 5.79 17.99 本文算法 24.58 40.93 4.79 16.15 表3. 各算法处理图b的数据比较 Table 4 图像来源 图a 图b 图c MSR 163.48 74.55 114.84 高斯模板 46.89 40.00 33.43 均值模板 29.15 21.34 24.65 表4. 高斯模板、均值模板处理时间的比较(ms) 由上表可以看出，本文算法处理图片的峰值信噪比最高，信息熵较低，标准差高于原图低于MSR算法和同态滤波算法，说明该算法噪声抑制能力最优，图像失真最小，噪声的减少导致处理后的图像信息熵较低，对比度增强能力低于同态滤波、MSR算法，相较原图，本文算法在一定程度上增强了图片的对比度且抑制了噪声，从表4中可以得出，由于均值模板相对简单，所以使用均值滤波模板的MSR算法运行时间更快，效率高于传统的MSR算法以及使用高斯模板的MSR算法。综上所述，本文提出的算法的增强效果和噪声抑制的整体上要优于同态滤波，MSR算法。"
"本文提出了一种新的算法，该算法将改进的MSR算法与同态滤波算法通过小波变换结合，可以有效限制触摸屏缺陷图像的噪声，增强图像的对比度同时避免过度增强，使用均值滤波模板来替代高斯滤波模板的MSR算法处理低频信息，提高了算法的处理速度，可以在满足实时处理需要的同时保持了图像的细节信息，有助于图像的后续处理。本文采用的小波变换主要考虑到它具有时频局部特性以及多分辨特性，在今后的研究工作中可以考虑引入curvelet、Ridgelet、多小波等方向信息更为丰富的方法用于图像增强。"
