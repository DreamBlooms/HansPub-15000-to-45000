"随着地质找矿工作逐步向深部空间的发展，深部矿、隐伏矿已成为找矿的主要对象。在对深部矿、隐伏矿的预测中，有效的成矿信息提取能够保证预测结果的准确性和可靠性。本文提出一种基于形状上下文的成矿构造形态控矿特征深度学习方法，以大尹格庄金矿床为研究对象，利用胶西北招平断裂带大尹格庄断离面趋势-起伏因素(waF、wbF)、断离面坡度因素(gF)、断离面陡缓转换部位综合场因素(fV)封装的三维形状上下文特征，利用深度学习中的图卷积神经网络，学习获得深层次的地质体形态控矿特征。研究表明，图卷积网络可提取更完备的地质体形态控矿特征，建立具有较好预测准确性的三维成矿预测模型。"
"随着已发现的地表、浅部、易识别矿产资源保有量迅速减少，地质找矿工作逐步向第二深度空间发展，深部矿、隐伏矿已成为找矿的主要对象 [ 1 ]，隐伏矿体三维预测已成为深部矿、隐伏矿找矿预测的关键技术。在隐伏矿体三维预测中，有效的成矿信息提取是保证预测准确性和可靠性的关键所在 [ 2 ] [ 3 ] [ 4 ]。然而，矿体的形成和就位受到不同尺度下地质体形态和分布的联合控制，地质体形态和分布作为成矿作用的控制因素及边界条件，对成矿物质溶解、聚集、运移、沉淀、保存的影响极为复杂 [ 5 ] [ 6 ]。将地质体形态和分布相关的控矿条件和找矿标志定量化为成矿构造形态初始特征，依赖于地质体形态分析。2.5 维高程面的形态分析在GIS数字地形分析中已被广泛研究，尤其是面向地貌分析提出了较为系统的方法 [ 7 ]。因地质体具有更为复杂的三维形态，2.5 维分析方法所提取的指标难以用于复杂地质体形态的描述。但在这其中，曲率分析方法采用曲面的平均曲率和高斯曲率度量地质体形态的局部变化，并不只局限于2.5维地质界面，适用于构造形态描述和找矿指标定量化 [ 8 ]。与2.5维高程面分析思想类似，趋势面分析作为一种常用的数学地质方法，亦被用于地质体形态分析 [ 9 ]。数学形态学方法被引入至地质体形态分析 [ 10 ] [ 11 ]。然而，虽然上述研究在形态分析上取得了一定进展，但存在对形态控矿作用的刻画多关注局部特征而相对忽略整体作用，反映地质体形态控矿客观规律的内在特征尚未充分揭示，影响了隐伏矿体三维预测的准确性与可靠性问题。 近年来，以深度学习为代表的机器学习方法已取得了重要的研究进展。深度学习方法利用多层神经网络结构，通过对数据的多重抽象，能够直接从数据中学习获得内在的“高层次”特征，发现其中隐含模式。在地学领域，深度学习已在岩石矿物识别 [ 12 ]、地球化学勘查及找矿预测 [ 13 ] 等领域展现了其应用价值。 为刻画地质体成矿构造形态对成矿空间的整体控矿作用，本文利用三维形状上下文对胶西北大尹格庄成矿构造形态特征进行定量化描述，通过这一特征描述成矿构造形态的整体控矿作用；为定量刻画地质体形态控矿的非线性规律，本研究构建基于封装的三维形状上下文的图卷积神经网络，希望通过深度学习中的图卷积网络，从对封装的胶西北大尹格庄三维形状上下文特征中学习出更完备的地质体形态控矿特征，为发现更客观、深层次的胶西北形态控矿规律打下坚实的数据理论基础。"
"胶东半岛位于华北克拉通东部，是我国最大的金成矿地区，金资源量超过4500 t [ 14 ]。胶东金矿中超过90%的金资源集中产于胶西北的伸展构造内，主要的控矿断裂带是三山岛断裂带、焦家断裂带和招平断裂带。断裂总体走向呈NE向，与三条主干断裂平行展布的一组近NE向次级断裂发育，少量NW向和近EW向断裂。三山岛断裂倾向SE，焦家断裂倾向NW，招平断裂倾向SE，三者形成“向、背”组合样式 [ 15 ]。招平断裂带总体展布方向为NE 30˚~40˚，局部向东或向西偏转，倾向东，倾角30˚~50˚。玲珑、台上、阜山、九曲、大尹格庄、夏甸和旧店等金矿床赋存于该断裂带中。大尹格庄金矿床位于招平断裂带中段。招平断裂带是胶东地区区规模最大的一条金矿控容矿断裂，它本质上是玲珑花岗岩与基底变质岩系的接触带，并在此基础上承生发育并经后期多期次构造活动改造的一组断裂构造的叠加组合 [ 16 ]。矿区内招平断裂带宽度为40~80 m，总体走向为北东35˚~60˚，倾向南东，沿走向、倾向均呈舒缓波状展布。矿区内招平断裂带主要沿岩性接触面发育，上盘为胶东群变质岩，下盘为玲珑花岗岩，在构造面附近存在明显的韧性、脆性变形 [ 17 ]。如图1所示为该研究区的平面示意图。 图1. 招平断裂带大尹格庄平面示意图(改自Mao X. et al., 2019 [ 18 ] )"
"为了定量表达成矿空间与构造样式的关联关系，建立构造样式描述符对发现构造样式对矿体定位的潜在制约关系具有重要意义。因此，我们引入三维形状上下文描述符，通过将样式特征抽象为高维特征向量，通过将模糊的构造样式映射至高维特征空间，以表示成矿空间立体单元受构造样式的制约关系。  三维形状上下文以三维形状直方图的方式分别表达某参考点与形状的距离、方位等空间关系。直方图基于对象所在的空间的划分，即对与直方图的区间对应的单元的完全和不相交的分解。图2显示了三种基本空间分解的2D示例 [ 19 ]：壳模型，扇区模型和组合模型。 图2. (a) 壳模型；(b) 扇区模型；(c) 组合模型 图2(a)为壳模型，3D空间被分解为围绕中心点的同心壳。该表示特别独立于物体的旋转，即物体围绕中心点的任何旋转产生相同的直方图。通过归一化形状延伸和壳半径的[0, 1]参数化，可以容易地实现尺度的不变性。然而，在半径相等的情况下，壳体积随壳指数呈二次方增长。 图2(b)为扇区模型，3D空间被分解成从形状的中心点出现的扇区。显然，这种表示在规模上是不变的，但不是旋转的。3D扇形直方图的定义和计算更加复杂。 图2(c)为组合模型，组合模型比纯壳模型和纯扇形模型表示更详细的信息。两个细粒度3D空间分解的简单组合导致高维度。然而，由于空间分解的分辨率在任何情况下都是参数，因此尺寸的数量可以容易地适应特定应用。 深部成矿构造三维形状上下文分析建立在组合模型的基础上，将2D模型扩展为3D模型：将球体在经度上36等分，维度上12等分，将球模型在3D空间中分解为围绕中心点的6个同心壳。将球体分为2592个部分。根据成矿空间大小和成矿空间某点受断裂成矿形态控制作用范围，球体的半径设定为2 km。  传统的卷积神经网络能够很好的处理图像数据，但对于高维的图数据，传统的图卷积神经网络并不能够很好的处理，本文三维形状上下文封装的数据为高维的图数据，在处理图数据领域，图卷积神经网络弥补了传统卷积神经网络的短板，图卷积神经网络可以很好的处理高维图数据 [ 20 ] [ 21 ] [ 22 ] [ 23 ] [ 24 ]。 为了探寻在胶西北大尹格庄三维形状上下文潜在的成矿规律，本文基于图卷积神经网络构建深度网络模型。 目前主流的GNNS(Graph Neural Networks)模型用于分类时，标准的方法是将图中所有的节点生成簇，然后再对所有节点的簇进行全局池化操作，这种全局池化的方法将会忽略图中可能存在的层次结构。三维形状上下文的数据具有良好的层级结构，简单的GNNS模型并不能很好的拟合，因此本文采用DIFFPOOL-GNN模型 [ 25 ] [ 26 ] [ 27 ]。 DIFFPOOL-GNN模型建立在GraphSAGE的框架之上，GraphSAGE通过采样邻居的策略将GCN有全图的训练方式改造成以节点为中心的小批量训练方式，同时还聚合邻居的操作进行了拓展。GraphSAGE算法的计算过程完全没有拉普拉斯矩阵的参与，每个节点的特征学习仅仅只和其k阶邻居相关，不需要考虑全图的结构信息。 DIFFPOOL-GNN模型在图神经网络的基础上，用一种端到端的方式为图分类学些一种有用的表示。采用如式(1)通用的“消息传递”的GNNS： H k = M ( A , H k − 1 ; θ k ) (1) [ 28 ] 其中 H k ∈ ℝ n × d 是第k层GNN的节点簇，这就是本文说的“消息”，M是一个消息传播函数，依赖于邻接矩阵A和可训练参数 θ k ，关于传播函数 的实现有很多。本文采用的是GraphSAGE。当 k = 1 ，输入的节点簇为 H 0 = F ，我们采用的DIFFPOOL-GNN模型不需要了解M的实现方式，因此直接抽象为 Z = GNN ( A , X ) 。 一个进行K次迭代公式(1)的GNN可以生成最终的节点簇， Z = H K ∈ ℝ n × d ，其中K的范围通常为2~6。 为了更好的学习三维形状上下文中的层次结构，采用一种新的粗化图的方式就是给定一个GNN模块的输出 Z = GNN ( A , X ) 和一个图的邻接矩阵 A ∈ ℝ n × n ，目标就是寻找一种方式可以的得到一个新的包含 m < n 个节点的粗化图，其中这个新图的邻接矩阵为 A ′ ∈ ℝ m × m ，节点嵌入矩阵为 Z ′ ∈ ℝ m × d 。这个新的粗化图作为下一层GNN的输入，重复L次就可以得到具有L层GNN的模型。 DIFFPOOL是首个将图粗化过程与GNN结合起来进行图分类的算法。DIFFPOOL提出了一个可学习的簇分配矩阵。具体来说，就是通过一个GNN对每个节点进行特征学习，然后通过另一个GNN为每个节点学习出所属每个簇的概率分布。 Z ( l ) = GNN l , e m b e d ( A ( l ) , X ( l ) ) (2) [ 28 ] S ( l ) = s o f t m a x ( GNN l , p o o l ( A ( l ) , X ( l ) ) ) (3) [ 28 ] 这里学习出来的S矩阵是一个软分配器，其值表示节点被分配到任意一个簇的概率，由于概率值不为0，因此这是一个下层超级节点到上层所有节点之间的全连接结构。 GNN l , e m b e d 、 GNN l , p o o l 是两个独立的GNN层，二者的输入相同，但是参数不同，学习的目的不同。需要强调的是，对于最后一层的簇分配矩阵，需要将该矩阵固定成一个全“1”的矩阵，我们此时将图粗化成一个超级节点，由此获取图的全局表示。 有了上述公式(2)和公式(3)的输出结果，我们可以对图进行粗化： X ( l + 1 ) = S ( l ) T Z ( l ) ∈ ℝ n l + 1 × d (4) [ 28 ] A ( l + 1 ) = S ( l ) T A ( l ) S ( l ) ∈ ℝ n l + 1 × n l + 1 (5) [ 28 ] 定义第l层学到的簇分配矩阵为 S ( l ) ∈ ℝ n l × n l + 1 ， n l 表示在第l层的节点数， n l + 1 表示在第 l + 1 层的节点数， n l > n l + 1 。 DIFFPOOL层 ( A ( l + 1 ) , X ( l + 1 ) ) = DIFFPOOL ( A ( l ) , Z ( l ) ) 表示粗化的输入图，式(4)是对簇内的信息执行融合操作，依据矩阵乘法的行向量计算方式，可以清楚地知道 S ( l ) T Z ( l ) 表示的是对簇内所有节点的特征向量进行加和处理。通过式(5)可以算出簇内邻接矩阵的计算。 我们将GCN和DIFFPOOL合在一起看成一个层，对输入的图数据进行任意的重新编号，输出到下一层的特征矩阵与邻接矩阵并不会改变，这种性质是非常符合直觉的：节点是否重新排序并不应该影响节点聚合成簇的结果。 本文使用的图卷积神经网络有三层基于GraphSAGE框架的GCN层加上一层DIFFPOOL层构成如图3所示。 图3. DIFFPOOL图卷积神经网络结构基础  本文的技术路线如图4所示。 图4. 本文的技术路线"
"本文结合胶西北招平断裂带大尹格庄金矿区的三维形状上下文数据封装成的图数据对图卷积神经网络的深度学习进行研究，因此，需要大尹格庄金矿区所有的三维形状上下文数据，通过这些三维形状上下文数据封装成堆积的图卷积神经网络的数据集，研究三维形状上下文这一特征在深度学习中的是否能够学习到有用的信息。 我们选取了胶西北招平断裂带大尹格庄金矿区中的16,450个地质体单元，以工业品位水平10 g/t为标准。将Au品位(g/t)值域离散化为无矿[0.0 g/t, 1.0 g/t)和有矿[1.0 g/t, ∞]两个区间。16,450个地质体单元则划分为：12,157个无矿地质体单元和4293个有矿地质体单元。部分无矿地质体单元数据和部分有矿地质体单元数据分别如表1和表2所示。 Table 1 X坐标(m) Y坐标(m) Z坐标(m) Au品位(g/t) 40530650 4121350 25 0.1 40530650 4121375 25 0.1 40530975 4120925 0 0.08 40530975 4120900 0 0.08 表1. 部分无矿地质体单元数据表 Table 2 X坐标(m) Y坐标(m) Z坐标(m) Au品位(g/t) 40531150 4120750 −50 1.41 40531075 4120850 −75 1.12 40531100 4120850 −75 1.15 40531100 4120875 −75 1.13 表2. 部分有矿地质体单元数据表 控矿地质因素是根据已有的地质资料和相关的地质知识，考虑与控矿最相关的指标因素，并根据其特点通过建立的大尹格庄三维模型(如图5所示)，对其进行提取和分析，对于胶西北的大尹格庄，确定了断离面趋势–起伏因素(waF、wbF)、断离面坡度因素(gF)、断离面陡缓转换部位综合场因素(fV)为成矿构造形态初始特征。 图5. 大尹格庄三维模型 为了更好的体现三维形状上下文的控矿作用，还加入了waF、wbF、gF、fV等特征。部分地质体单元的waF、wbF、gF、fV的数据见表3。 Table3. The data table of geological bodies’ waF、wbF、gF、fV 表3. 部分地质体单元的waF、wbF、gF、fV的数据 计算图卷积神经网络需要每个地质体单元的邻接矩阵、每个体质体单元的标签和每个地质体单元的节点属性。本文根据三维形状上下文的组合模型抽象出来的三维空间结构构建的邻接矩阵，组合模型将球体在经度上36等分，维度上12等分，将球模型在3D空间中分解为围绕中心点的6个同心壳。将球体分为2592个部分，我们将2592个部分抽象成一个个节点，每一个节点按照位置的相邻关系抽象出它们的边，那么每一个地质体单元的邻接矩阵的维度为2592 × 2592。每一个地质体单元根据Au品位(g/t)值域离散化为无矿[0.0 g/t, 1.0 g/t)和有矿[1.0 g/t, ∞]两个区间，无矿区间[0.0 g/t, 1.0 g/t)的分类为无矿地质体单元和有矿区间[1.0 g/t, ∞]分类为有矿地质体单元。每一个地质体单元都是一副图。本文将无矿地质体单元的标签记为0，有矿地质体单元的标签记为1。每个地质体单元中的每一个节点，它的属性为初始输入的特征，本文将初始特征设定为属性，它是地质体单元根据三维形状上下文的组合模型抽象出来的三维空间结构和控矿相关指标计算出的三维形状上下文。  本文通过每个地质体单元的邻接矩阵、每个体质体单元的标签和每个地质体单元的节点属性作为堆积好的图卷积神经网络的数据输入，对胶西北招平断裂带大尹格庄金矿区16,450个地质体单元则划分为的12,157个无矿地质体单元和4293个有矿地质体单元进行图卷积神经网络的训练，由此建立三维成矿预测模型。训练结果如图6所示：每一幅图的横坐标为训练的轮数(单位：epoch)，纵坐标为训练的精度(单位：%)。 图6. (a) 大尹格庄训练精度；(b) 大尹格庄验证精度；(c) 大尹格庄训练集AUC精度；(d) 大尹格庄验证集AUC精度；(e) 大尹格庄训练集loss；(f) 大尹格庄验证集loss 从图6(a)和图6(b)可以看出胶西北招平断裂带大尹格庄金矿区深度学习训练的精度为92%，验证集的精度为88%，这说明本文建立的三维成矿深度学习的模型有良好的拟合度，可以提取出有效的成矿构造形态的整体控矿特征。我们进一步采用受试者工作特征(Receiver Operating Characteristic, ROC)曲线评价预测准确性。AUC(Area Under Curve)是ROC曲线下与坐标轴围成的面积，AUC的值越接近1.0，说明预测方法的准确性越高。 从图6(c)和图6(d)可以看出胶西北招平断裂带大尹格庄金矿区深度学习的训练集AUC为0.94，验证集AUC为0.85，均远远大于0.5，本文建立的三维成矿预测模型具有较好的预测准确性。"
"三维形状上下文保证了从总体上刻画形态控矿作用，图卷积网络表征了成矿构造形态对矿体形成与分布，由此引出建立了基于形状上下文的构造形态控矿特征深度学习，将从更好地刻画构造整体形态与矿化定位间的非线性关联。验证结果表明，基于形状上下文深度学习建立的三维成矿预测模型具有较好的预测准确性。"
