"当某一条河流有多条支流汇入时，干流洪水与支流洪水的遭遇是威胁下游防洪控制点安全的主要因素，干支流洪水遭遇风险估计对于下游防洪安全具有重要意义。基于Copula函数易于将多个边缘分布构造成联合分布的优点，将其与频率组合法相结合，推导出了n维组合洪水分布函数表达式，并建立了相应的洪水遭遇风险估计模型。以雅砻江、鲜水河和庆大河洪水遭遇为例，采用双参数三维Copula函数对下游的洪水遭遇风险进行了估计，得到了下游组合洪水分布函数及防洪风险率。结果表明，该模型可以在一定程度上量化分析干支流洪水遭遇的随机性，为下游的防洪安全提供了一定的参考。 关键词 :Copula函数，频率组合法，组合洪水，防洪风险率 Copyright © 2020 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着我国各大流域联合防洪调度工作的逐渐深入，流域性洪水引发的多条河流的洪水遭遇分析工作越来越迫切。洪水遭遇风险研究对下游的防洪安全具有重要意义。传统的多变量水文分析计算方法主要包括多元正态分布 [ 1 ] [ 2 ] 、特定边缘分布构成的联合分布 [ 3 ] [ 4 ] 、非参数方法 [ 5 ] 、将多维联合分布转换成一维分布的方法 [ 6 ] 等。传统方法往往存在着一些缺陷，比如多元正态分布在数据转换时容易造成信息失真，非参数方法构造的联合分布的边缘分布类型未知等 [ 7 ]。目前，国内外针对上游有支流汇入的防洪控制点的风险估算，多是针对一条支流汇入的情况，对于多条河流汇入的情况研究较少；并且多是将干流洪水的随机性作为研究对象，区间洪水设为特定值进行计算，这样显然与实际有所偏差。因此，研究新的方法，充分考虑干支流洪水的随机性，对于上游有多条支流汇入的防洪控制点的防洪安全具有重要意义。 频率组合法是研究洪水遭遇的传统方法，目前多是针对二维水文随机变量进行实例研究，对于多维水文随机变量的研究相对较少，当涉及的维数较多时，用传统的解析方法来确定联合概率密度函数的解析式以及对其积分求解是非常困难的，因此，通常采用离散叠加法进行数值求解。但是，干支流洪水变量间往往存在相关性，在采用离散叠加法进行求解时，需要对变量进行独立性处理，此过程难免会出现数据失真。 Copula函数能够通过变量的边缘分布和相关性结构两部分来构造多维联合分布，形式灵活多样，是构建联合分布的一种非常有效的方法，近些年在水文分析计算领域中得到了广泛应用。熊立华等 [ 8 ] 采用Copula函数构造了两站年最大洪水联合分布函数，并且对经验概率和理论概率进行了拟合。李天元等 [ 9 ] 通过双参数Copula函数构造了两江洪峰之间的联合分布函数，估计了洪峰遭遇风险的条件概率。刘章君等 [ 10 ] 根据Copula函数对设计洪水地区组成进行区间估计，计算出地区组成的点估计值，并对估计的不确定性进行评价。 为此，本文结合Copula函数易于构造联合分布的特点，将Copula函数在构造联合分布函数的优势与频率组合法在计算多维联合分布函数的功能相结合，以雅砻江、鲜水河和庆大河洪水遭遇为例，进行了验证分析。相对于传统的频率组合法，此方法可以充分考虑干支流的随机性及相关性，且计算过程中不会出现信息失真；对变量边缘分布类型没有要求，适用性强；解决了频率组合法在多维问题上的求解问题，使其不再局限于求解二维问题。"
"Copula函数由Sklar在1959年提出，是定义在[0,1]上均匀分布的联合分布函数。其中Archimedean Copula函数结构简单，适应性强，在水文多变量联合分布中的应用较为广泛。n维Archimedean Copula函数表达式如下： C ( u , φ ) = φ { φ − 1 ( u 1 ) + φ − 1 ( u 2 ) + ⋯ + φ − 1 ( u n ) } , u ∈ [ 0 , 1 ] (1) 其中，算子 φ 决定了Copula函数的类型。双参数三维Archimedean Copula函数，表达式如下： C ( u 1 , u 2 , u 3 ) = φ 1 ( φ 1 − 1 ( u 1 ) + φ 1 − 1 φ 2 ( φ 2 − 1 ( u 2 ) + φ 2 − 1 ( u 3 ) ) ) (2) 双参数三维Archimedean Copula函数拥有两个发生元，因此可以较好地刻画出变量之间的相依结构。三维GH Copula、Clayton Copula、Frank Copula函数表达式分别如下： C ( u 1 , u 2 , u 3 ; θ 1 , θ 2 ) = exp { − ( [ ( − log u 3 ) θ 2 + ( − log u 2 ) θ 2 ] θ 1 / θ 2 + ( − log u 1 ) θ 1 ) 1 / θ 1 } (3) C ( u 1 , u 2 , u 3 ; θ 1 , θ 2 ) = [ ( u 3 − θ 2 + u 2 − θ 2 − 1 ) θ 1 / θ 2 + u 1 − θ 1 − 1 ] − 1 / θ 1 (4) C ( u 1 , u 2 , u 3 ; θ 1 , θ 2 ) = − θ 1 − 1 log { 1 − c 1 − 1 ( 1 − [ 1 − c 2 − 1 ( 1 − e − θ 2 u 3 ) ( 1 − e − θ 2 u 2 ) ] θ 1 / θ 2 ) ( 1 − e − θ 1 u 1 ) } (5) 其中， c 1 = 1 − e − θ 1 ， c 2 = 1 − e − θ 2 ，参数 θ 1 用来刻画 ( u 1 , u 2 ) 、 ( u 1 , u 3 ) 之间的相依性，参数 θ 2 用来刻画 ( u 2 , u 3 ) 之间的相依性。"
"当防洪控制点上游有多条区间洪水时，由于区间洪水这一不确定性因素，必须考虑区间洪水与干流洪水组合后带来的风险，其组合形式有很多种，为下游防洪控制点的防洪安全带来了极大的威胁 [ 11 ] [ 12 ] [ 13 ]。 图1. 洪水遭遇组合示意图 如图1所示，干流洪水为 X 1 ，区间洪水为 X 2 , X 3 , ⋯ , X n ，防洪控制点洪水为 ，则 W = X 1 + X 2 + ⋯ + X n 。 X 1 , X 2 , ⋯ , X n 之间可以是相关关系或相互独立。 n − 1 条区间洪水在防洪控制点上游相继汇入，为下游防洪控制点的防洪安全带来了一定的威胁，为保证下游防洪控制点的防洪安全，需要求出下游防洪控制点组合洪水的分布函数，根据频率组合法，组合洪水洪峰流量超越下游安全泄量的概率分布函数可以表示为： P ( w ≥ w 0 ) = 1 − ∫ ⋯ ∫ D h ( x 1 , x 2 , ⋯ , x n ) d x 1 d x 2 ⋯ d x n (6) 式中，D为 x 1 + x 2 + ⋯ + x n ≤ w 0 ， h ( x 1 , x 2 , ⋯ , x n ) 是随机变量 x 1 , x 2 , ⋯ , x n 的联合概率密度函数。当 w 0 为下游防洪控制点的安全泄量时，防洪控制点发生洪水的概率 P ( w ≥ w 0 ) 即为防洪风险率。 公式(6)中的联合概率密度函数 h ( x 1 , x 2 , ⋯ , x n ) 可以用Copula函数来表示，公式如下： H ( x 1 , x 2 , ⋯ , x n ) = C [ F ( x 1 ) , F ( x 2 ) , ⋯ , F ( x n ) ] (7) h ( x 1 , x 2 , ⋯ , x n ) = ∂ n H ( x 1 , x 2 , ⋯ , x n ) ∂ x 1 ∂ x 2 ⋯ ∂ x n = ∂ n C ( u 1 , u 2 , ⋯ , u n ) ∂ x 1 ∂ x 2 ⋯ ∂ x n (8) 式中， H ( x 1 , x 2 , ⋯ , x n ) 为随机变量 x 1 , x 2 , ⋯ , x n 的联合分布函数， C [ F ( x 1 ) , F ( x 2 ) , ⋯ , F ( x n ) ] 为随机变量 x 1 , x 2 , ⋯ , x n 的Copula函数， u 1 = F ( x 1 ) ,   u 2 = F ( x 2 ) ,   ⋯ , u n = F ( x n ) 分别为 x 1 , x 2 , ⋯ , x n 的边缘分布函数。其中， ∂ n C ( u 1 , u 2 , ⋯ , u n ) ∂ x 1 ∂ x 2 ⋯ ∂ x n = ∂ n C ( u 1 , u 2 , ⋯ , u n ) ∂ u 1 ∂ u 2 ⋯ ∂ u n ⋅ ∂ u 1 ∂ x 1 ⋅ ∂ u 2 ∂ x 2 ⋯ ∂ u n ∂ x n = c ( u 1 , u 2 , ⋯ , u n ) ⋅ f x 1 ( x 1 ) ⋅ f x 2 ( x 2 ) ⋯ f x n ( x n ) (9) 式中， c ( u 1 , u 2 , ⋯ , u n ) 为 C ( u 1 , u 2 , ⋯ , u n ) 的密度函数， f x 1 ( x 1 ) , f x 2 ( x 2 ) , ⋯ , f x n ( x n ) 分别为 x 1 , x 2 , ⋯ , x n 的边缘密度函数。 由上述公式可知，下游防洪控制点组合洪水的分布函数可由Copula函数密度函数以及边缘分布密度函数表示，因此利用Copula函数易于将多个边缘分布构造成多维联合分布的特点，对公式(6)进行改进可以得到新的n维组合洪水的分布函数表达式，如式(10)所示： P ( w ≥ w 0 ) = 1 − ∫ ⋯ ∫ D c ( u 1 , u 2 , ⋯ , u n ) ⋅ f x 1 ( x 1 ) ⋅ f x 2 ( x 2 ) ⋯ f x n ( x n ) d x 1 d x 2 ⋯ d x n (10) 式(10)具有以下优点：对于组合洪水问题推广至n维，适用性较强；随机变量的联合概率密度函数用Copula函数表示，可以充分考虑变量间的相关性；对于边缘分布类型没有限制，任意边缘分布都可以构造联合分布。 函数求解步骤如下： ①确定边缘分布，即洪水流量的分布函数。 ②在分析边缘分布相关性的基础上，选择合适的Copula函数。 ③对Copula函数密度函数以及边缘分布密度函数的乘积求n重积分。 式(10)具有以下优点：对于组合洪水问题推广至n维，适用性较强；随机变量的联合概率密度函数用边缘分布密度函数以及Copula函数密度函数表示，可以充分考虑变量间的相关性；对于边缘分布类型没有限制，任意边缘分布都可以构造联合分布。"
"雅砻江流域位于青藏高原东部，整个流域呈南北向条带状，流域平均长度约950 km，平均宽度约137 km，河系呈羽状发育。支流鲜水河与庆大河相继汇入雅砻江，其流域图如图2所示，对下游防洪控制点的防洪安全造成了一定的威胁，本文采用雅砻江新龙站、鲜水河道孚站、庆大河扎巴站历史洪水资料，选取同一时刻三个测站的历史流量组成三元序列对作为样本，充分考虑洪水遭遇的可能性，对下游组合洪水分布函数以及防洪风险率进行计算。 图2. 雅砻江流域图  P-III分布曲线在水文变量频率分析中应用较为普遍，其对径流、暴雨的拟合结果较好。其概率密度函数如下： f ( x ) = β γ Γ ( γ ) ( x − α ) γ − 1 exp [ − β ( x − α ) ] (11) 其中， α 、 β 、 γ 分别为P-III型分布的位置、尺度、形状参数，计算公式如下： α = 4 C s 2 , β = 2 x ¯ C v C s , γ = x ¯ ( 1 − 2 C v C s ) (12) 根据上述公式，可以计算出雅砻江洪峰、鲜水河洪峰和庆大河洪峰的P-III分布参数，由表1可知，雅砻江、鲜水河和庆大河洪水流量均服从P-III分布，以P-III分布作为雅砻江、鲜水河和庆大河洪水流量的边缘分布是合理可行的。 Table 1 雅砻江洪水流量 鲜水河洪水流量 庆大河洪水流量 均值 x ¯ 1161.53 519.6 81.73 变差系数C v 0.34 0.38 0.41 偏态系数C s 1.94 1.47 1.87 α 1.062812 1.85108 1.14387 β 0.00261 0.00689 0.031917 γ 754.39 250.96 45.89 拟合度 0.99 0.98 0.98 表1. 雅砻江、鲜水河和庆大河洪峰的P-III分布参数  首先，对雅砻江洪峰、鲜水河洪峰、庆大河洪峰进行相关性分析，判断其相关性，可以初步确定适合本文研究所应用的Copula函数类型。本文应用SPSS软件中的相关性分析对雅砻江洪峰、鲜水河洪峰和庆大河洪峰进行相关性分析。经计算，雅砻江洪峰、鲜水河洪峰之间的相关系数为0.938，雅砻江洪峰、庆大河洪峰之间的相关系数为0.946，鲜水河洪峰、庆大河洪峰之间的相关系数为0.937，t检验的显著性概率均为0 < 0.01。由此可以判断，三者之间存在着较强的正相关性。由于GH Copula和Clayton Copula适用于变量之间存在正相关关系，Frank Copula函数适用于变量之间存在正或负相关关系。因此，本文选用GH Copula、Clayton Copula和Frank Copula函数进行组合洪水的研究。  参数估计是Copula函数的核心，本文采用极大似然法对Copula函数进行参数估计。双参数三维Copula函数的极大似然估计方法如下： 1) 构建似然函数 L ( θ 1 , θ 2 ) = ∏ i = 1 n c ( ( u i 1 , u i 2 , u i 3 ) ; θ 1 , θ 2 ) (13) c ( ( u 1 , u 2 , u 3 ) ; θ 1 , θ 2 ) = ∂ 3 C ( ( u 1 , u 2 , u 3 ) ; θ 1 , θ 2 ) ∂ u 1 ∂ u 2 ∂ u 3 (14) ln ( L ( θ 1 , θ 2 ) ) = ∑ i = 1 n ln ( c ( ( u 1 , u 2 , u 3 ) ; θ 1 , θ 2 ) ) (15) 2) 似然函数最大值求解 ∂ 2 ln ( L ( θ 1 , θ 2 ) ) ∂ θ 1 ∂ θ 2 = 0 (16)  拟合优度评价主要包括Genest-Rivest方法(图形评价法)、AIC信息准则法和OLS法(离差平方和最小准则)。 Genest-Rivest方法是将经验频率和理论频率进行绘图，根据点距的分布情况，来判断Copula函数对序列的拟合情况。 经验频率公式如下： F e m p ( x i 1 , x i 2 , x i 3 ) = p ( X 1 ≤ x i 1 , X 2 ≤ x i 2 , X 3 ≤ x i 3 ) = ( ∑ g = 1 n ∑ k = 1 n ∑ l = 1 n n g k l − 0.44 ) / ( n + 0.12 ) (17) 式中， F e m p 为经验频率， n g k l 为同时满足 X 1 ≤ x i 1 , X 2 ≤ x i 2 , X 3 ≤ x i 3 的观测值个数，n为系列长度。 AIC信息准则是衡量模型拟合优劣的一种标准，AIC值越小，说明相应的Copula函数拟合越优，其表现形式如下： MSE = 1 n ∑ i = 1 n ( F e m p ( x i 1 , x i 2 , x i 3 ) − C ( u i 1 , u i 2 , u i 3 ) ) 2 (18) AIC = n ln ( MSE ) + 2 k (19) 式中， C ( u i 1 , u i 2 , u i 3 ) 为理论频率值，k为模型参数的个数。 离差平方和最小准则的判断标准和AIC准则一样，OLS值越小，拟合越优。 OLS = 1 n ∑ i = 1 n ( F e m p ( x i 1 , x i 2 , x i 3 ) − C ( u i 1 , u i 2 , u i 3 ) ) 2 (20) 由图形评价法即可得到不同Copula函数对洪峰序列的拟合效果，如图3所示。 图3. 理论与经验联合频率拟合 从图中可以看出，双参数GH Copula、Clayton Copula、Frank Copula函数所计算出的理论频率与经验频率均落在45˚线附近，且相差不大，说明三种函数对径流序列的拟合效果均较好，通过图形评价法不能直观的判断哪种函数对径流序列拟合最优，所以还需AIC信息准则和OLS法进行拟合优度评价。 计算得出不同Copula函数的AIC值和OLS值，根据AIC信息准则和OLS对拟合优度进行评价，AIC值、OLS值以及Copula函数参数θ 1 、θ 2 见表2。 Table 2 AIC OLS θ 1 θ 2 GH −171.191 0.054 4.52 4.69 Clayton −160.812 0.064 4.54 4.55 Frank −166.423 0.058 15.99 16.05 表2. 不同Copula函数的AIC、OLS值及参数 由表2可知，GH Copula函数所计算的AIC和OLS值最小，Frank Copula函数和Clayton Copula函数所计算的AIC和OLS值均大于GH Copula函数所计算的AIC和OLS值。因此GH Copula函数对洪峰序列的拟合效果最优。所以根据AIC、OLS最小准则，选取双参数三维GH Copula函数进行组合洪水的计算。  根据GH Copula函数，可以得到洪峰联合分布(图4)，其中，x轴、y轴、z轴分别表示雅砻江洪峰、鲜水河洪峰、庆大河洪峰，组合洪水频率用颜色表示。由图4可以看出任意洪峰组合发生的频率及其变化趋势。根据公式(6)~(10)可以得到下游组合洪水洪峰w大于下游防洪安全泄量w 0 的概率，设置不同的w 0 ，即可得到组合洪水分布(表3)及其分布曲线(图5)。 图4. 洪峰联合分布 Table 3 w 0 /(m 3 ∙s −1 ) P(w > w 0 )/% w 0 /(m 3 ∙s −1 ) P(w > w 0 )/% w 0 /(m 3 ∙s −1 ) P(w > w 0 )/% w 0 /(m 3 ∙s −1 ) P(w > w 0 )/% 3300 14.43 3870 6.06 4440 2.50 5010 1.03 3330 13.79 3900 5.79 4470 2.39 5040 0.98 3360 13.18 3930 5.53 4500 2.28 5070 0.97 3390 12.60 3960 5.28 4530 2.18 5100 0.94 3420 12.04 3990 5.04 4560 2.08 5130 0.90 3450 11.51 4020 4.81 4590 1.98 5160 0.88 3480 11.00 4050 4.59 4620 1.89 5190 0.85 3510 10.51 4080 4.38 4650 1.80 5220 0.82 3540 10.04 4110 4.18 4680 1.72 5250 0.80 3570 9.59 4140 3.99 4710 1.64 5280 0.77 3600 9.16 4170 3.81 4740 1.57 5310 0.75 3630 8.75 4200 3.64 4770 1.50 5340 0.73 3660 8.36 4230 3.47 4800 1.43 5370 0.71 3690 7.99 4260 3.31 4830 1.36 5400 0.69 3720 7.63 4290 3.16 4860 1.30 5430 0.67 3750 7.29 4320 3.02 4890 1.24 5460 0.65 3780 6.96 4350 2.88 4920 1.18 5490 0.64 3810 6.65 4380 2.75 4950 1.13 5520 0.62 3840 6.35 4410 2.62 4980 1.08 5550 0.60 表3. 组合洪水分布 图5. 组合洪水分布曲线 由组合洪水分布曲线可以看出，随着w 0 的增加，组合洪水洪峰大于w 0 的概率不断减小，在w 0 小于3000 m 3 /s之内，组合洪水洪峰大于w 0 的概率的减小与w 0 的增加基本上呈线性关系，当w 0 大于3000 m 3 /s后，组合洪水洪峰大于w 0 的概率随着w 0 的增加而减小的越来越缓慢，最终趋向于0。下游防洪控制点的安全泄量为4800 m 3 /s时，由表3可知，防洪风险率为1.43%。结果表明该地区的防洪安全不易受区间洪水的影响。"
"本文基于Copula函数和频率组合法，推导出n维组合洪水分布函数表达式，并构造出洪水遭遇风险估计模型。以雅砻江洪峰、鲜水河洪峰和庆大河洪峰为例，在分析其相关性基础上，采用双参数三维GH Copula、Clayton Copula、Frank Copula函数对其洪峰联合分布进行计算，通过对比分析，GH Copula函数对变量的拟合效果最优。建立了基于双参数三维GH Copula函数的三河流洪峰联合分布，然后计算得到组合洪水分布曲线，通过组合洪水分布曲线可以得到下游防洪控制点的防洪风险率以及各组合洪水发生的概率。通过实例分析证明本文所构造的模型具有可行性，且推导出的n维组合洪水分布函数对于易发生洪水遭遇地区的防洪安全提供了一定的参考。"
