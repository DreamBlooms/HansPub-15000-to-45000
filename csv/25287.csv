"随着侧扫声呐图像分辨率的不断提高，其小目标探测能力逐渐提高。针对传统侧扫声呐图像目标探测方法大都需提供样本图像，基于统计模型需参数估计，这都属于监督方法的缺陷，提出一种侧扫声呐图像小目标的非监督探测方法。首先，对图像基于扩散映射进行数据降维；其次，直接基于降维之后的图像数据，利用扩散距离定义目标得分方程，通过目标得分方程计算目标得分；最后，根据目标得分，实现小目标探测。通过含不同目标，不同背景下的侧扫声呐图像的探测实验，验证了方法的有效性。 关键词 :侧扫声呐，目标探测，数据降维，扩散映射 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着陆地资源的日益枯竭，世界各国已将资源开发和利用的重点从陆地转向海洋，我国为此制定了“海洋强国”、“一带一路”和“海上丝绸之路”战略。在这些大趋势和大战略的指引下，各种水下调查活动如火如荼开展，由此对水下目标自动探测识别的需求也日益旺盛 [ 1 ] [ 2 ] [ 3 ] 。侧扫声呐(Side Scan Sonar, SSS)系统，作为水下地貌图像的获取设备，因价格低廉、分辨率高等优点在水下目标探测和识别领域应用前景广阔 [ 4 ] 。目标探测是后续目标图像分割和识别的基础，目标准确探测对实现目标精准识别意义重大。为此，国内外学者开展了相关的目标探测方法研究，主要包括基于模板匹配的探测，显著性目标探测，基于统计模型和稀疏表达的探测方法等等。Dobeck等 [ 5 ] 基于水下似雷物体研究了一种自适应非线性匹配的目标探测算法，该方法探测速度快，但构建强鲁棒性的匹配模板很困难；Dura等 [ 6 ] 提出了一种基于稀疏表示的似雷物体探测方法，该方法需要Unmanned Underwater Vehicles (UUV)在当前测量区域提供少量的指示类别(目标、背景)样本，但复杂海洋环境作业情况下，可靠性样本数据难以丰富获取；Grasso等 [ 7 ] 提出了一种基于局部强度信息和数学形态学算子的小目标探测方法，该方法适合Autonomous Underwater Vehicle (AUV)平台下获取的图像，对AUV平台的稳定性要求很高。国内，田晓东等 [ 8 ] ，梁旭姣等 [ 9 ] 研究了基于图像灰度分布特征的目标探测方法，由于灰度统计模型参数难以准确估计，该方法对多目标及复杂地貌图像中的目标准确探测显得乏力；李娟娟等 [ 10 ] 提出了一种基于主动轮廓模型的水雷目标探测方法，该方法需提供初始目标形状；上述目标探测方法要么需要提供样本图像，要么参数难以估计，复杂地貌图像中小目标准确探测较为困难；赵小红 [ 11 ] 研究了一种基于Ping回波信号的目标探测方法，对复杂海洋环境噪声影响下获取的声学图像实施这种方法，对实验室的定性定量分析要求很高，且对信噪比有极高的要求；库安邦等 [ 12 ] 系统分析了侧扫声呐图像的分辨能力，进一步表明其可广泛用于水下大、小目标的探测，但并未给出目标探测算法。目前，侧扫声呐数据处理多采用国外软件，软件“黑箱”操作，核心模块如目标自动探测和识别功能被屏蔽 [ 13 ] [ 14 ] ，不能满足国内市场需求。因此，需进一步研究普适性强的、准确的目标探测方法。"
"侧扫声呐图像分辨率高、数据量大，这保证了其可应用于水下小目标的探测。针对大型矩阵的运算，基于Matlab存在效率低下的问题，有时甚至无法计算。为解决此问题，可首先进行数据降维。线性降维方法假设数据有全局的线性结构，随着数据分析技术的发展，研究者发现高维数据集上往往具备一些低维的非线性结构，数学上称为流形 [ 15 ] 。扩散映射(Diffusion Map)作为流形算法的一种，它在降低数据维度的同时，还为寻找数据中有意义的几何结构提供了一种有效的方法 [ 16 ] 。 扩散映射在保持数据结点间局部结构的同时，还使不在一个邻域内点之间的距离变得松弛。如果令 X = ( x 1 , x 2 , ⋯ , x n ) 为n组高维的数据集合，可以构建一个权重矩阵来度量相邻两个数据结点之间的相似性，这个权重矩阵应该是对称且非负的。标准的扩散映射算法中，权矩阵由高斯函数得到： W ( x i , x j ) = exp ( − ‖ x i − x j ‖ 2 δ 2 ) (1) 式(1)中δ为尺度参数，距离计算可采用欧几里得距离。 如果对该数据集给定一个核映射 K : X × X → R ，并且该映射满足K ij = K ji ，K ij ≥ 0。可基于W构造扩散核矩阵： K = W T W ，可知K为非负、半正定矩阵。若将(X, K)视为一个图，那么根据K的性质，可以构造出X上的一个马尔可夫(Markov)链，由此引入几个概念和符号： 1) 数据点x的度 d ( x ) = ∑ y ∈ X W ( x , y ) (2) 它反映了数据点x的“局部信息”。 2) 转移概率 P ( x , y ) = W ( x , y ) / d ( x ) (3) 此时P为一个正矩阵，不满足对称的性质。但其满足： ∑ y ∈ X P ( x , y ) = 1 (4) 如此构建得到了X数据集上的一个Markov链，其包含了原始数据集的局部几何信息，反映了数据从一个点运动到另外一个点的概率，可定义P t (x, y)为第t次转移概率。该Markov链有一个重要的性质，即其为可逆矩阵，这个性质决定了，当X为有限集的情况下对P进行特征分解，可得到正交的左、右特征向量ψ j 、φ j ；同时，可得到正特征值序列： λ 0 ≥ λ 1 ≥ λ 2 ≥ ⋯ ，则第t次获得的Markov链可表示为： P t ( x , y ) = ∑ l ≥ 0 λ l t φ l ( x ) ψ l ( y ) (5) λ 0 为一常数，根据Mishne and Cohen [ 17 ] 的研究，可进一步将扩散映射表示为： Y t : x → ( λ 1 t φ 1 ( x ) , λ 2 t φ 2 ( x ) , ⋯ , λ l t φ l ( x ) ) T 。 3) 扩散距离 扩散距离是一个抽象的距离概念，其针对一簇给定的数据而定义。这里是在扩散映射下定义的扩散距离，其实则为扩散映射的象在其空间中的欧式距离 [ 15 ] ，两个点x，y之间的扩散距离计算如式(6)： D t ( x , y ) 2 = ∑ z ∈ X ( p t ( x , z ) − p t ( y , z ) ) 2 ϕ 0 ( z ) (6) 式(6)中，p t (x,y)为P t 的元素；在迭代次数t，D t (x, y)给出了数据(x, y)之间距离的定义，它一方面反映了(x, y)之间的局部结构；另一方面它从宏观上给出了(x, y)之间的联系。如果(x, y)与很多短边相连接，那么，直观上它们之间的距离也应该很小；同时，这个距离包括了衔接(x, y)的所有路径，所以其抗干扰能力很强，一个点的微小扰动对距离的改变不大，也即这个距离具备很强的鲁棒性。 结合式(5)、(6)，D t (x, y)可以按式(7)计算： D t 2 ( x , y ) = ∑ j ≥ 1 λ j 2 t ( φ j ( x ) − φ j ( y ) ) 2 = ‖ ( Y ( x ) − Y ( y ) ) ‖ 2 (7) 经过扩散映射计算后，原始高维大数据集合X映射到一个低维的数据空间Y，而此空间中的欧式距离直接定义为扩散距离，这为计算带来很大方便；同时扩散距离反映了数据间的结构信息，为数据间的差异评定提供了度量标准。"
"根据前述扩散映射基本原理，可将分辨率高、数据量大的侧扫声呐图像降维得到扩散坐标，降低数据维数，为后续计算提供便利；进一步依据扩散距离，可判断扩散映射下各数据点之间的离散程度。因此，扩散距离可作为扩散映射下扩散坐标的度量标准，判断异常区域。当将一幅含有目标的侧扫声呐图像进行上述扩散映射之后，目标和背景的扩散距离与背景间的扩散距离差别很大，根据扩散距离差异可实现侧扫声呐图像中小目标的探测。 因此，下面需研究给出扩散坐标下，目标探测的标准，可定义一个目标得分方程，实现目标与背景区域度量。结合文献 [ 17 ] [ 18 ] 的研究，将目标得分方程定义如下： c = 1 − exp { − 1 k ∑ t = 1 k D ( p i , p j ) / 2 σ k 1 + 3 × d position ( p i , p j ) } (8) 式(8)中，d position 为欧几里得距离，D为扩散距离，k为最近邻区域大小。整个扩散映射和目标得分计算过程，不需考虑目标尺寸的先验知识，且无需样本图像，也即从理论上实现了小目标的非监督探测。"
"为验证给出方法探测侧扫声呐图像小目标的性能，首先采用图1进行实验。图像大小为128 × 128像素，图像修改自文献 [ 6 ] ，红框标注区域为明显目标(似雷物体)。从图1可看出，图像中背景纹理复杂，含其它异常高亮点离散疑似目标区域，这些都影响传统目标探测的精度。 图1. 含单一明显目标的侧扫声呐图像 首先，对图像进行扩散映射计算，得到扩散坐标。扩散坐标前三维数据图像及其坐标分布如图2(a)，图2(b)所示。图2(a)中图像颜色，不具备真实RGB色彩，仅表征扩散坐标前三维数据的大小关系。 从图2(a)，图2(b)中可看出，在一幅含有目标的侧扫声呐图像中进行扩散映射计算，得到的扩散坐标，在数值上存在差异，坐标数据分布密度不同，且可体现一定的异常空间分布状态；进一步比较图1和图2(a)，可看出，原始图像目标处，在图2(a)中存在明显区别与其它背景处的颜色表征，表征此处扩散坐标与周围背景区域存在典型差异。据此，可进行目标探测。因此，基于式(8)计算目标得分，计算时，参数k表征邻域大小，取值为64。计算所得目标得分数值结果如图3所示。 对比图1、图3，可看出，目标区域的异常得分，远大于背景图像，虽然仍有其它离散区域的得分数值高于周围背景区域，但数值上明显小于异常目标区域处，可基于简单中值滤波进行剔除。进而，基于数学形态学运算，进行目标质心提取，最终目标探测结果如图4所示。可见，论文算法未受显著背景离散异常区域影响，有效实现了侧扫声呐图像中小目标的准确探测。 为进一步验证论文算法的有效性，采用沙坡地形中目标，及含多目标的侧扫声呐图像进行目标探测实验，目标探测结果如图5所示。可见，沙坡地形中目标可准确探测，未受沙坡地形纹理及沙坡地形自成虚假目标(沙坡凸起面阻挡声波，导致其后端存在阴影区域)影响；多目标图像中由于有两个目标紧邻，被当作一个目标被探测出来，也即存在一个遗漏探测，也基本上实现了目标准确探测。 图2. 扩散坐标的前三维数据，(a) 彩色图例；(b) 坐标数据分布状况 图3. 目标得分情况 图4. 目标探测结果 图5. 沙坡地形中及含多目标的侧扫声呐图像目标探测结果 上述实验，表明论文算法可实现侧扫声呐图像中小目标准确探测，验证了算法的有效性。"
"基于扩散映射降维计算，获得扩散坐标，进而利用扩散坐标定义目标得分方程，实现了侧扫声呐图像小目标的准确探测。 实验代码基于Matlab R2014b完成，采用Intel(R) Core(TM) i7-6700 HQ @2.60GHz的CPU运算，图1计算运行耗时达到69.47 s，计算效率偏低。分析认为，计算式(1)的权重矩阵，原始输入图像虽仅为128 × 128像素，但此时计算量为16,384 × 16,384的矩阵，导致计算效率的降低。后续需通过改进计算步骤，诸如对图像随机采样，进一步降低输入数据量提高运算效率；甚至采用多尺度图像处理的方式，对图像分层处理并计算，再将结果反馈到原始图像中。 图5多目标探测结果显示存在一个遗漏探测，分析认为，仅基于目标得分方程实现目标异常目标区域判别，存在局限性，当目标紧邻，其邻域背景区域得分也会偏高，导致独立目标作为一个整体被探测出来，影响探测精度；同时，复杂海底背景图像中，诸如目标存在于珊瑚礁纹理特征下，异常高亮区域数量增加且分布复杂，仅基于扩散坐标定义目标得分方程，也难以实现目标准确探测。针对这些复杂情况，可进一步考虑将纹理特征引入目标得分方程定义公式，诸如针对人造目标，可寻找典型区分人造物体和海底背景图像的纹理特征，提高目标异常区域得分数值，实现目标准确探测。"
"为解决传统侧扫声呐图像小目标探测方法需提供样本图像，基于统计模型探测需参数估计的缺陷，给出了一种基于扩散映射(数据降维)的侧扫声呐图像小目标非监督探测方法，结论及建议如下： 1) 基于扩散映射进行数据降维，有效解决了侧扫声呐图像数据量大，Matlab计算大型矩阵效率低甚至无法进行运算的问题； 2) 利用扩散映射降维之后的扩散坐标，基于扩散距离利用目标得分方程可实现侧扫声呐图像中小目标的准确探测，且无需样本图像； 3) 目标得分方程定义方式，对目标探测结果影响很大，顾及海底复杂纹理背景差异，后续需深入研究联合图像纹理特征的目标得分方程定义公式。"
