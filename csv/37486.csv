"利用甘肃敦煌、酒泉、民勤、榆中、西峰和岷县6个气象站2004~2007年自动观测与人工观测的降水资料，对比分析了2种观测序列的差值特征，并基于BP神经网络建立了自动降水观测订正模型。研究表明，自动观测的降水量与人工观测的标准差为0.254 mm，平均偏大0.033 mm (相对偏高2.24%)；76%的自动观测与人工观测的日降水量差值在±10%以内，近11%的样本日降水量测量差值在±20%以上；日降雨量相对差值较大的样本，其日降雨量均比较小；利用BP神经网络模型订正后，自动观测的日降水量拟合差为0.05~0.52 mm，平均相对误差0.5%~8.2%，平均相对均方根误差为0.10~0.70 mm，相关系数为0.75~0.99。"
"从上世纪90年代末开始，我国陆续在气象台站布设地面自动气象观测系统，与传统的人工气象观测相比，自动观测系统能够提升地面气象观测站网的时空密度，提供更为准确、及时、有效的气象观测资料。但由于人工和自动2种观测仪器的测量原理不同，观测系统发生了根本性变化，导致观测数据也产生较大差别 [ 1 ]。这种误差的产生，不能简单地说是人工观测仪器的原因，还是自动观测仪器的原因，它只是一种相对比较得到的结果 [ 2 ]。研究表明，观测资料序列的非均一性可以由许多原因造成，但观测仪器发生改变是其中的最重要原因之一 [ 3 ] [ 4 ] [ 5 ] [ 6 ] [ 7 ]。 国内的研究学者针对不同观测仪器对资料质量的影响方面已经开展了相关研究，王颖等 [ 8 ]、顾品强等 [ 9 ] 和余君等 [ 10 ] 讨论了人工与自动观测气温数据的差异及其产生的原因；尹志宪等 [ 11 ] 通过分析自动站和人工站风观测资料，发现在日出日落、日气温最高和最低时与人工观测偏差较大；任芝花等 [ 12 ] 分析全国2005年自动与人工雨量业务观测资料，由于观测仪器不同引起的降雨测量系统误差差别，导致自动与人工观测降雨量的系统偏差。这些研究成果为继续开展人工和自动观测资料质量对比提供了有益的思路。在均一性订正方面，李军等 [ 13 ] 针对山区月平均气温订正做了初步的研究；Sun et al. [ 14 ] 和熊安元等 [ 15 ] 针对观测仪器造成的误差开展了订正研究；连志鸾 [ 16 ] 通过建立统计学订正方程，对因天气因素而造成的自动站气温观测差值进行了订正；石登科等 [ 17 ] 建立了不同观测系统空气相对湿度资料的均一订正方程。目前，均一性订正多采用基于数理统计的方法，而数理统计方法是事先规定好某种数学模型，且一般都是线性的。然而，2种仪器的对比差值很可能是一个非线性系统，其观测样本往往难以满足或仅仅是近似满足数理统计订正方法的条件，而且样本序列本身不可避免地含有噪声，这些必然影响其订正效果。 本文选用2004~2007年位于甘肃省不同气候和地理特征区域的6个气象站点，对人工和自动2种观测系统同期的降水量观测资料进行对比分析，利用BP神经网络算法建立人工观测资料序列订正模型，将人工观测数据订正到自动站观测数据上，为建立我国均一性的地面观测资料时间序列提供参考。"
"甘肃省位于北纬32˚11'~42˚57'、东经92˚13'~108˚46'，境内地貌复杂多样。选取了敦煌、酒泉、民勤、榆中、西峰和岷县6个国家基准气候站(表1)，基本代表了甘肃复杂的区域气候特征和地形特征。 Table 1 区站号 台站 经度 纬度 海拔(米) 气候区划 52418 敦煌 94˚41'E 40˚09′N 1139.0 干旱区 52533 酒泉 98˚29′E 39˚46′N 1477.2 干旱区 52681 民勤 103˚05′E 38˚38′N 1367.5 干旱区 52983 榆中 104˚09′E 35˚52′N 1874.4 半干旱区 53923 西峰 107˚38′E 35˚44′N 1421.0 半干旱区 56093 岷县 104˚01′E 34˚26′N 2315.0 湿润区 表1. 6个站点的详细情况 为了研究2种观测系统所测降水量的偏差情况，选取6个观测站点2004~2007年5~9月自动与人工雨量业务观测数据。本文以逐时自记(自动)观测降水量作为对比分析的基础，规定当人工或自动站一方录得降水时，为1次有效对比记录，共得到6个站5490个逐时降水有效对比样本和1008个日降水有效对比样本。逐时降水量是指每小时(00~59分钟)记录的降水量，日降水量是指每日8:00 (北京时间，以下同)至次日7:59记录的降水量。  对比差值直接反映了人工和自动站之间的相对偏差，而对比差值的均方根则反映了人工和自动站之间的平均偏差情况。设n为观测次数，R ui 为第i次人工观测值，R ai 为第i次自动仪器观测值，则第i次的对比差值为 X i = R u i − R a i (1) 对比差值相对百分比为 r i = ( R u i − R a i ) / R u i (2) 对比差值的平均值为 Δ R 1 = ∑ i = 1 n ( R u i − R a i ) n (3) 对比差值的均方根为 Y = ∑ i = 1 n ( R u i − R a i ) 2 n (4) 对比差值的标准差 σ = 1 n − 1 ∑ i = 1 n ( X i − X ) 2 (5) 其中，X为对比差值的平均值，X i 为第i次的对比差值。对比差值的标准差反映了人工观测观测要素与自动站观测要素之间偏差的离散程度。 利用Kolmogorov-Smirnov检验判断对比差值分布是否符合正态分布(2001)。  BP (Back Propagation)神经网络是1986年由Rumelhart和McClelland为首的科学家小组提出，是一种按误差逆传播算法训练的多层前馈网络，是目前应用最广泛的神经网络模型之一 [ 14 ]。BP网络能学习和存贮大量的输入–输出模式映射关系，而无需事前揭示描述这种映射关系的数学方程。它的学习规则是使用最速下降法，通过反向传播来不断调整网络的权值和阈值，使网络的误差平方和最小。 在建立BP网络模型选择输入矩阵的订正因子时，考虑到其他观测要素可能对所要订正要素的影响，因此选取了人工观测资料序列作为输入矩阵，即输入层节点为1，自动观测资料序列作为输出矩阵，输出节点为1，隐层节点为1。将学习矩阵加载到网络输入端，进行反复的学习训练，当误差函数趋于稳定并达到规定限值，训练结束，便得到相应的订正模型。 通过人工观测值(R u )与自动观测值(R a )的年观测偏差绝对值(以下称为原差)、拟合值(R c )与自动观测值(R a )的均差绝对值(以下称为拟合差) Δ R 2 = | 1 n ∑ i = 1 n ( R c i − R a i ) | (6) 对神经网络订正模型的拟合效果进行差值对比分析。 为了更好地检验BP神经网络订正人工观测要素的精度，本文通过平均相对误差(RE)、平均相对均方根误差(RMSE)和相关系数(R 2 )这3个评估参数来定量分析订正值相对于自动测量值的准确度。平均相对误差为 RE = [ 1 n ∑ i = 1 n | R c i − R a i | ] / 1 n ∑ i = 1 n R a i (7) 平均相对均方根误差为 RMSE = [ ∑ i = 1 n ( R c i 2 − R a i 2 ) / n ] 1 2 (8) 相关系数为 R 2 = [ 1 n ∑ i = 1 n R a i R c i − 1 n ∑ i = 1 n R a i 1 n ∑ i = 1 n R c i { [ 1 n ∑ i = 1 n R a i 2 − ( 1 n ∑ i = 1 n R a i ) 2 ] [ [ 1 n ∑ i = 1 n R c i 2 − ( 1 n ∑ i = 1 n R c i ) 2 ] ] } 1 2 ] 2 (9) 其中R c 为神经网络的订正值。"
"通过对甘肃省6个站自动与人工观测的逐时降水量资料进行计算，发现在各站降水期(5~9月)，共有83,023次人工测量无降水，83,064次自动测量无降水，二者均无降水的记录为82,609次，说明两种观测系统在无降水的情况下，仪器性能基本稳定。 对于有降水的情况，在5490个有效对比观测样本，自动观测比人工观测平均偏高0.033 mm，标准差为0.254 mm，相对偏高2.24%。自动观测与人工观测一致的样本占37.23%，自动观测小于人工观测的样本占24.74%，自动观测大于人工观测的样本占38.03%。各个台站的对比情况如表2，对比差值的平均值均为正值，为0.004~0.08 mm，6个站点对比差值平均值从大到小排序依次为西峰 > 榆中 > 敦煌 > 酒泉 > 民勤 > 岷县，其中降水样本数较少的3个站中(敦煌、酒泉、民勤站)，随着降水样本的增加，对比差值明显减小；降水样本较多的3个站中(榆中、西峰、岷县站)，对比差值最小的岷县站，而榆中和西峰站的对比差值平均值则是随着台站降水样本数的增加呈增加趋势，与较为干旱的3个站情况正好相反。各站标准差位0.1~0.3 mm，相差不大，说明对比差值在不同量级降水分布较为一致。从自动站与人工站降水对比的百分比可以看出，6个站基本都是自动观测大于人工观测、自动观测与人工观测降水量一致2种情况下的占比较大。 Table 2 台站 对比次数 平均值 标准差 自动与人工观测降水对比百分比 R a = R u R a > R u R a < R u 敦煌 248 0.0181 0.1202 44.76% 33.47% 21.77% 酒泉 401 0.0097 0.2984 40.15% 34.16% 25.69% 民勤 575 0.0045 0.2473 37.57% 31.13% 31.30% 榆中 1203 0.0443 0.1962 33.83% 44.06% 22.11% 西峰 1366 0.0852 0.3328 36.90% 44.29% 18.81% 岷县 1697 0.0004 0.2137 38.01% 32.65% 29.35% 合计 5490 0.033 0.254 37.23 % 38.03% 37.23 % 表2. 6个站2004年~2007年逐时降水量对比差值 图1为自动与人工观测对比差值随降水强度变化散点图。可以看出，对比差值多分布于零值线附近，出现在±1.0 mm之间的观测对比差值占所有误差观测值的99.11%，说明仪器稳定性比较好。负差值出现频率多于正差值，且较大误差值多出现在负值区，即大部分时候自动站测值偏大。同时发现，出现对比差值偏大区域比较分散，对比差值并不是随着雨强的变化而变化的。 图1. 6个站人工观测与自动观测逐时降水量对比差值随人工观测降水强度变化散点图 由于降水量在空间分布上是随机性较大的气象要素，这种空间分布的不均匀性，会使得即使安装在同一观测场内但不同地点的同类型雨量器带来采样差。空间采样差是降水测量过程中存在的一种客观现象，与测量仪器无关 [ 12 ]。经全国30个标准雨量站7年多次测量分析发现这种空间采样差服从正态分布规律 [ 18 ]。这说明，如果自动测量与人工测量的降水量之间的差异仅仅是由于降水量在空间分布上的不均匀性造成的，而不存在测量仪器不同造成的测量上的差异，那么两者间的差值变量必然服从正态分布。 通过对6个站5490个样本的分别做Kolmogorov-Smirnov检验，通过测试所得p值均小于0.05，表明6个站观测样本逐时差值不满足正态分布。图2为6个站自动与人工观测的差值频率分布图，可以看出逐时差值的柱状分布偏离正态分布曲线，分布图的中心略偏零线，说明同一观测场内不同位置进行的自动与人工雨量对比观测，不仅存在着降水量空间分布不均带来的采样差，同时还存在着测量仪器的不同造成的系统偏差。 图2. 6个站人工观测与自动观测的逐时降雨量差值频率分布图  对6个站自动观测与人工观测的日降水量差值分布进行了统计(表3)，可以看出，总的样本中有22%的自动观测的样本小于人工测量值，78%的样本大于人工测量值；76%的自动与人工观测的日降水量差值在10%以内，近11%的样本测量差值在20%以上。 Table 3 台站 r ≤ −20% −20% < r ≤ −10% −10% < r ≤ −5% −5% < r ≤ 0 0 < r ≤ 5% 5% < r ≤ 10% 10% < r ≤ 20% r ≥ 20% 敦煌 A 4 2 9 43 0 0 2 5 B 6.15% 3.08% 13.85% 66.15% 0.00% 0.00% 3.08% 7.69% 酒泉 A 9 7 3 57 14 4 2 7 B 8.74% 6.80% 2.91% 55.34% 13.59% 3.88% 1.94% 6.80% 民勤 A 10 9 8 65 17 8 3 12 B 7.58% 6.82% 6.06% 49.24% 12.88% 6.06% 2.27% 9.09% 榆中 A 16 18 50 114 5 5 6 9 B 7.17% 8.07% 22.42% 51.12% 2.24% 2.24% 2.69% 4.04% 西峰 A 20 41 34 68 19 4 4 5 B 10.26% 21.03% 17.44% 34.87% 9.74% 2.05% 2.05% 2.56% 岷县 A 20 12 26 120 61 30 12 9 B 6.90% 4.14% 8.97% 41.38% 21.03% 10.34% 4.14% 3.10% 合计 A 67 93 119 505 93 46 29 56 B 6.6% 9.2% 11.8% 50.1% 9.2% 4.6% 2.9% 5.6% 表3. 日降水量相对差值百分比及频次 (A) is the frequency of the relative difference of daily precipitation, and (B) is the percentage of the difference frequency. (A) 为日降水量相对差值的频次，(B) 为上述差值频次的百分比。 图3为6个站自动与人工观测相对差值与日降雨量的散点图，1008次日降水量观测值最小0.1 mm，最大93.8 mm。从图可见，大部分样本自动与人工观测的日降水量相对差值较小；日降水量相对差值较大的样本，尤其相对差值绝对值在20%以上的样本，其日降水量均比较小，相反，日降水量较大的样本，相对差值多处于10%之内。基本表现出随着降水量增大，相对差值迅速减小并呈收敛趋势。 图3. 6个站人工观测与自动观测的日降水量的相对差值与人工观测日降水量的散点图  利用日降水量人工观测与自动观测资料序列建立基于BP神经网络的订正模型。建立模型的资料样本为平行观测期间2004~2006年5~9月份降水观测资料，并以2007年观测资料作为独立样本对模型订正效果做检验。考虑到本文是使用自动观测资料序列来订正人工观测资料序列，因此训练模型的输出项设为自动观测资料序列。由表4可见，通过自动观测值(R a )与人工观测值(R u )的原差、拟合值(R c )与自动观测值(R a )的拟合差，对神经网络订正模型的拟合效果进行差值对比分析，发现日降水量拟合差为0.05~0.52 mm，除了酒泉站外，其他各站拟合差均小于原差值，且订正效果明显。 Table 4 台站 日降水量(mm) 拟合差 原差 敦煌 0.05 0.09 酒泉 0.52 0.04 民勤 0.01 0.02 榆中 0.28 0.35 西峰 0.24 0.62 岷县 0.16 0.10 表4. 原差值与神经网络拟合差值对比 为了更好地检验BP神经网络订正人工观测要素的精度，通过平均相对误差(RE)、平均相对均方根误差(RMSE)和相关系数(R 2 )这3个评估参数来定量分析订正值相对于自动测量值的准确度。由表5可以看出，日降水量的订正结果其检验样本的相关系数R 2 在0.75~0.99之间，平均相对均方根误差RMSE在0.1~0.9之间，平均相对误差RE为1.4%~14.1%。BP神经网络的订正结果与自动观测资料的相关程度较好，尤其是检验样本的相关系数R 2 ，除了榆中站日降水量的订正模型外都在0.90以上。RMSE体现了订正的观测数据与自动实测数据之间的离散程度和接近程度，除榆中站外其余各站的RMSE相差不大，数值大小变化比较平稳，即该方法的稳定性和可扩展性较好。RE反映了订正值相对于自动观测值的偏离程度大小，它能够客观地反映测量结果的准确性，各个站点的RE较小，基本在20%以下，误差较小，精度较高。 Table 5 台站 检验样本 R 2 RMSE RE 敦煌 0.99 0.30 0.016 酒泉 0.78 4.19 0.030 民勤 1.00 0.16 0.186 榆中 0.75 22.46 0.434 西峰 1.00 0.80 0.005 岷县 0.99 0.68 0.082 表5. 日降水量BP神经网络订正模型评估指标 平均相对误差、均方根差和相关系数这些参数是从整体上评估BP神经网络模型订正精度高低，具体到不同的气象观测要素、不同时次，订正观测要素的准确性又如何？以敦煌站为例，利用检验样本进一步分析不同的气象观测要素的订正效果(图4)，可以看出订正的结果与自动测量值在整个变化过程中较一致，吻合性较好，说明通过使用BP神经网络建立的订正模型结构性能较好，推广能力较强，能够从时空变率复杂的时间序列中找出一定的演变规律，对观测要素进行较高精度的拟合。 图4. 日降水量自动观测与BP拟合值对比"
"本文对比分析了甘肃省敦煌、酒泉、民勤、榆中、西峰和岷县6个气象站2004~2007年2种不同观测系统降水量的观测数据序列，计算了两种观测资料序列差值的逐时变化、日变化以及频数分布，同时，为了建立均一性的气象观测数据序列，在对比2种观测序列变化特征的基础上，利用BP神经网络，建立了人工站观测资料序列订正模型，并对订正效果进行分析，获得如下结论： (1) 各站在降水期，当人工观测无降水时，自动观测基本也表现为无降水，说明两种观测系统在无降水的情况下仪器性能基本稳定；对于有降水的情况，自动观测比人工观测的逐时降水量平均偏高，逐时降水量对比差值在±1.0 mm之间的观测对比差值占所有误差观测值的99.11%，但对比差值并不是随着雨强的变化而变化的。 (2) 同一观测场内不同位置进行的自动与人工雨量对比观测，不仅存在着降水量空间分布不均带来的采样篇差，还存在着测量仪器的不同造成的系统偏差。 (3) 对于日降水量，有22%的自动观测的日降水量样本小于人工测量值，78%的样本大于人工测量值；76%的自动与人工观测的日降水量差值在±10%以内，近11%的样本日降水量测量差值在±20%以上。日降雨量相对差值较大的样本，其日降雨量均比较小。 (4) 基于BP神经网络的人工观测资料序列的订正模型，拟合的日降水量拟合差为0.05~0.52 mm；独立检验样本的R 2 为0.75~0.99，RMSE为0.1~0.7 mm，RE为0.5%~8.2%；除个别台站外，使用BP神经网络对人工观测资料序列进行订正，自动观测序列与拟合序列均一性较好，订正效果良好，误差较小，精度较高。"
