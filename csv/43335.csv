"针对锂电池的电热耦合特性，根据产热机理，构造锂电池热模型，结合锂电池二阶Thevenin等效电路模型，构造电热耦合模型。考虑到模型误差和测量过程中的测量噪声，设计全对称多胞体滤波器，实现锂电池电热耦合特性建模。"
"随着人们燃料消耗和碳排放的日益关注，锂电池由于其能量密度高、自放率低和寿命长逐渐成为最具有发展前景的化学储能电源，被广泛应用于电力输配、可再生能源并网、辅助服务、分布式微网以及电动汽车充换电等储能领域的各个方面 [ 1 ]。锂电池作为一类典型的涉及复杂电化学反应的能量存储装置，本身存在较高的安全隐患，此外，在实际运行过程中，受到当前技术水平限制，在某些情况下会发生机、电、热滥用从而引发安全问题，因此锂电池的安全性和可靠性问题十分迫切。热故障是锂电池最重要的故障之一，具有潜在的灾难性。为了更好地检测电池热动态行为以及分析电池热故障行为，对锂电池热动态行为建模是十分必要的。 现有的锂电池热模型按照维度可以划分为集总参数模型，一维、二维和三维模型 [ 2 ]。集总参数模型是将锂电池看作一个整体，同时假定锂电池内部温度均匀分布，以此获取电池的温度。一维模型是对电池在某一维度上温度分布的研究，即只计算电池在某个方向的温度分布。二维模型是对电池在某一截面上温度分布的研究。三维模型是对整个电池温度分布的研究，与一、二维模型相比，通过三维模型描述电池温度最为准确，尤其是三维模型可以直接体现锂电池的电热耦合效应，且模型易于分析处理，在扰动信号sigma等于0.1附近建模精度可达95%以上。尽管这些模型可以实现对电池模型的实时估计，但是这些模型没有考虑到电池内部电学行为与热学行为之间的耦合关系，导致电池动态热行为检测失准。 本文主要针对现有的电池热模型中存在的不足，根据锂电池充放电过程中的电化学机理，构造二阶Thevenin等效电路模型，根据产热机理，构造锂电池热模型，以电池核心温度和表面温度为状态，结合锂电池电模型，构造电热耦合模型。考虑到模型误差和测量过程中的测量噪声，设计滤波器，实现锂电池电热耦合特性建模。"
"锂电池在充放电时，内部的锂离子在正负极发生嵌入、脱出和转移等过程，这个过程伴随着电池内部电子得失不平衡等现象 [ 3 ]。因此，采用并联的电容和电阻元件模拟这个过程。而等效电路模型就是由电容、电阻和电压源等元器件组成。同时等效电路模型可以通过电阻元件等效电压变化，通过电压源等效电池的开路电压。目前常见的有Thevenin模型、PNGV模型、Rint模型、GNL模型。与其他模型相比，Thevenin模型结构简单，同时可以很好地反映电池的动态特性，是应用最广泛的模型。二阶Thevenin模型在一阶Thevenin模型的理论基础上多加了一个RC回路，更能准确地模拟电池的充放电行为 [ 4 ]。因此采用二阶Thevenin模型作为锂电池的电模型。图1所示为二阶Thevenin模型。 图1. 二阶Thevenin模型示意图 该模型的数学表达式如下： U = U o c − R o I − U 1 − U 2 { U ˙ 1 = − 1 R 1 C p 1 U 1 + 1 C p 1 I U ˙ 2 = − 1 R 2 C p 2 U 2 + 1 C p 2 I (1) 其中， U o 为电池两端电压， U o c 为电池两端电压，R为电池内阻，I为电池电流。 R 1 和 C p 1 分别为电化学极化电阻和电容， R 2 和 C p 2 分别为浓差化电阻和电容。 U 1 和 U 2 分别为两个RC电路的压降。 选用一个双态径向热模型 [ 5 ] 描述圆柱形锂电池的热动力学，如图2所示。 T c 表示电池核心温度， T s 表示电池表面温度。双态径向模型假设锂电池表面温度相同，电池产热仅考虑两个传递过程：(1) 电池内部的热传导即电池核心到电池表面的传递，(2) 电池表面的热交换即电池表面到环境中的交换热。 图2. 双态径向热模型 双态径向热模型可以表示为： { C c T ˙ c = Q g e n + T s − T c R c C s T ˙ s = T e − T s R u − T s − T c R c (2) 式中， R c 表示电池核心与表面之间的等效热传导电阻。 R u 表示电池表面与冷却空气之间的等效对流电阻。 T e 表示环境温度。 C c 与 C s 分别表示电池内材料的热容系数和电池表面的热容系数。 Q g e n 表示电池核心的发热功率，可以表示为： Q g e n = I ( U o c − U ) + I T ∂ U o c ∂ T (3) 式中，I表示电池电流，U表示电池端电压， U o c 为电池内部电压， I ( U o c − U ) 表示焦耳热， I T ∂ U o c T 表 示不可逆热。分析电池的产热机理，起主要作用的是锂电池内部产生的焦耳热，电池内部其他产热对于焦耳热可忽略不计，因此不可逆热可忽略 [ 6 ]。 电池在工作期间产生热量，影响热模型输入。将电模型与热模型结合，得到电热耦合模型，模型的状态空间方程式可以表示为： { U ˙ 1 = − 1 R 1 C p 1 U 1 + 1 C p 1 I U ˙ 2 = − 1 R 2 C p 2 U 2 + 1 C p 2 I (4) T ˙ c = − T c R c C c + T s R c C c + I ( U 1 + U 2 + R o I ) C c T ˙ s = − T s ( 1 R c C s + 1 R u C s ) + T c R c C s + T e R u C s (5) 将发热功率 Q g e n 和环境温度 T e 作为输入，将表面温度 T s 和核心温度 T c 的测量值作为输出。经过离散化处理后，锂电池电热耦合模型为： { [ T c , k + 1 T s , k + 1 ] = [ 1 − Δ t R c C c Δ t R c C c Δ t R c C s 1 − Δ t R c C s − Δ t R u C s ] [ T c , k T s , k ] + [ Δ t C c 0 0 Δ t R u C s ] [ Q g e n , k T e , k ] + [ 1 0 0 1 ] w k [ T ¯ c , k T ¯ s , k ] = [ 1 0 0 1 ] [ T c , k T s , k ] + [ 1 0 0 1 ] v k (6) 式中， T c , k 和 T s , k 分别表示k时刻的电池核心温度和表面温度的真实值，是系统的状态向量； T ¯ c , k 和 T ¯ s , k 分别表示电池核心温度和表面温度的测量值，是系统输出向量； w k 表示扰动噪声， v k 表示测量噪声。 [ 1 − Δ t R c C c Δ t R c C c Δ t R c C s 1 − Δ t R c C s − Δ t R u C s ] 表示状态空间矩阵； [ Δ t C c 0 0 Δ t R u C s ] 表示输入矩阵。"
"全对称多胞体滤波是集员滤波的一种。集员滤波是假设过程噪声和观测噪声是未知但有界的滤波方法，其关键之处在于如何描述真实可行集的复杂形状。全对称多胞体滤波是用全对称多胞体近似实际可行集，通过求取能够包裹预测多胞体与参数可行集交集的最小容积多胞体来得到下一时刻状态变量的可能分布。 全对称多胞体的定义如下： s阶全对称多胞体 Z ⊂ R n 是超立方体 B s = [ − 1 , + 1 ] s 的仿射变换 [ 7 ]，即： Z k = p + ∑ i = 1 s α i g i = p k ⊕ G k B s = 〈 p k , G k 〉 (7) 其中， − 1 ≤ α i ≤ 1 ， p ∈ B s 称为 Z 的中心， G = { g 1 , g 2 , ⋯ , g s } ∈ ℝ n × s 称为 Z 的生成矩阵。 全对称多胞体有以下性质： 〈 p 1 , G 1 〉 ⊕ 〈 p 2 , G 2 〉 = 〈 p 1 + p 2 , [ G 1 G 2 ] 〉 (8) M ⊗ 〈 p , G 〉 = 〈 M p , M G 〉 (9) 基于电热耦合特性建模得出的电热耦合模型，定义如下离散状态空间方程： { x k + 1 = A x k + B u k + D 1 w k y k = C x k + D 2 v k (10) 其中， x k = [ T c , k T s , k ] T ∈ ℝ n 为系统状态向量， u k = [ Q g e n , k T e , k ] 为系统输入， y k = [ T ¯ c , k T ¯ s , k ] T 为系统 输出。 A = [ 1 − Δ t R c C c Δ t R c C c Δ t R c C s 1 − Δ t R c C s − Δ t R u C s ] ， B = [ Δ t C c 0 0 Δ t R u C s ] ， C = [ 1 0 0 1 ] ， D 1 = D 2 = [ 1 0 0 1 ] 。 w k ∈ ℝ w 和 v k ∈ ℝ v 分别表示系统未知但有界的扰动噪声和测量噪声，即 | w k | ≤ w ˜ ，即 | v k | ≤ v ˜ 。 假设系统(10)的初始状态，扰动噪声和测量噪声分别满足： x 0 ∈ X = 〈 p 0 , G 0 〉 w 0 ∈ W = 〈 0 , W 〉 v 0 ∈ V = 〈 0 , V 〉 (11) 其中， X 0 , W , V 分别为初始状态，扰动和噪声所在的全对称多胞体集合。 G 0 = diag ( x ˜ 0 ) ， W = diag ( w ˜ ) ， V = diag ( v ˜ ) 。针对电热耦合模型，设计全对称多胞体滤波器。该算法分为两步，预测步和更新步。 (1) 预测步 假设k时刻的状态向量 x k 对应的全对称多胞体： x k ∈ Z k = p k ⊕ G k B s = 〈 p k , G k 〉 (12) 根据全对称多胞体的性质及系统状态方程可知，第 k + 1 时刻状态向量预测集为 χ ^ k + 1 = 〈 p ^ k + 1 , G ^ k + 1 〉 (13) p ^ k + 1 = A p k + B u k G ^ k + 1 = [ A G k D 1 W ] (14) 根据 k + 1 时刻系统输出变量构造带状空间 S k + 1 ，如下式所示 S = { x k + 1 ∈ ℝ n : | C x k + 1 − y k + 1 | ≤ D 2 v ˜ } (15) (2) 更新步 求得状态预测集 χ ^ k + 1 后，寻求 k + 1 时刻的带状空间 S k + 1 与状态预测集的交集，进而得到 k + 1 时刻系统状态估计范围。 为了求解 k + 1 时刻系统状态估计范围，引入如下定理。 定理1 [ 8 ]. 给定全对称多胞体 Z = 〈 p , G 〉 、带 S = { x ∈ ℝ n : | K x − c | ≤ δ } 。若定义： p ( Λ ) = p + Λ ( c − K p ) G ( Λ ) = [ ( I n − Λ K ) G Λ Δ ] (16) 其中， G , K 是已知矩阵， p , c , δ 是已知向量， Λ = diag ( δ ) ， Δ 是指定的矩阵，则存在一个全对称多胞体能够包含 Z 与 S 的交集，满足 Z ∩ S ⊆ Z ( Λ ) = 〈 p ( Λ ) , G ( Λ ) 〉 (17) 根据引理1，则存在全对称多胞体 χ k + 1 ( L k + 1 ) = 〈 p k + 1 ( L k + 1 ) , G k + 1 ( L k + 1 ) 〉 ，满足 χ k + 1 ( L k + 1 ) ⊇ χ ^ k + 1 ∩ S k + 1 ，并由下列各式求得 p k + 1 ( L k + 1 ) = p ^ k + 1 + L k + 1 ( y k + 1 − C p ^ k + 1 ) (18) G k + 1 ( L k + 1 ) = [ ( I − L k + 1 C ) G ^ k + 1   L k + 1 D v ] (19) 其中， L k + 1 为任意矩阵， D v = diag ( D 2 v ˜ ) 。 不同的 L k + 1 对应的全对称多胞体 χ k + 1 ( L k + 1 ) 的形状和体积不同，为了使状态范围估计更加准确，增益矩阵 L k + 1 应该使得 χ k + 1 ( L k + 1 ) 的体积最小化，选取 G k + 1 ( L k + 1 ) 的Frobenius范数作为最优性准则设计滤波器的增益矩阵 L k + 1 [ 7 ]，表达式如下： L k + 1 = G ^ k + 1 G ^ k + 1 T C T × ( C G ^ k + 1 G ^ k + 1 T C T + D v D v T ) − 1 (20) 因此， k + 1 时刻的系统状态 x k + 1 的全对称多胞体集合可由公式(21)~(24)计算可得： x k + 1 ∈ χ k + 1 = 〈 p k + 1 , G k + 1 〉 (21) p k + 1 = p ^ k + 1 + L k + 1 ( y k + 1 − C p ^ k + 1 ) (22) G k + 1 = [ ( I − L k + 1 C ) G ^ k + 1   L k + 1 D v ] (23) L k + 1 = G ^ k + 1 G ^ k + 1 T C T × ( C G ^ k + 1 G ^ k + 1 T C T + D v D v T ) − 1 (24) 其中， p ^ k + 1 , G ^ k + 1 可由公式(14)计算可得。 结合全对称多胞体滤波算法，可以得到 x k + 1 的区间估计，计算公式如下： { x k + 1 + ( i ) = p k + 1 ( i ) + ∑ j = 1 s | G k + 1 ( i , j ) | ,   i = 1 , ⋯ , n x k + 1 − ( i ) = p k + 1 ( i ) − ∑ j = 1 s | G k + 1 ( i , j ) | ,   i = 1 , ⋯ , n (25) 式中， x k + 1 + ( i ) , x k + 1 − ( i ) 分别表示 k + 1 时刻状态估计的最小上界和最大下界。"
"基于锂电池电热耦合模型，设置仿真模型参数如表1所示。 在仿真开始前，电池还没有电流流过，因此RC网络端电压 U 1 和 U 2 都为0。电热耦合模型的输入 Q g e n 由等效电路模型计算得到。环境温度 T e 设为25℃，核心温度 T c 和表面温度 T s 的初始值都设为25℃。扰动和测量噪声限制为 | w k | ≤ 0.1 , | v k | ≤ 0.1 。仿真结果如图3和图4所示。图3是电池核心温度的上下界估计，图4是电池表面温度的上下界估计。黑线代表温度真实值的变化情况，红线代表全对称多胞体滤波算法的上下界。从图3和图4可以看出，全对称多胞体滤波算法可以很好地跟踪状态真值，同时算法的上下界都能包裹系统状态的真实值。由此可见，全对称多胞体滤波算法能够有效地实时估计核心温度和表面温度。 Table 1 参数 数值 R c 1.98 Ω C c 63.5 F C s 4.5 F R u 1.718 Ω R 1 0.0298 Ω C 1 1789.7 F R 2 0.03819 Ω C 2 5.26 F r 0.0501 Ω I 5 A 表1. 锂电池电热耦合模型主要参数 图3. 电池核心温度的上下界估计 图4. 电池表面温度的上下界估计"
"本文针对锂电池电热耦合动态行为和实际系统中存在的不确定但有界的噪声，结合电池产热原理与基于机理的电池等效电路模型，设计全对称多胞体滤波器，实现锂电池电热耦合特性建模，文章所提方法可以准确的提供电池核心温度和表面温度的上下界区间，且能实现对电池温度状态的紧致包裹。 基于全对称多胞体滤波的锂电池电热耦合特性建模相比于一般的电池建模，既考虑了锂电池内部电学行为与热学行为之间的耦合，又考虑了实际电池系统中的不确定但有界的噪声，有效、准确地监测电池的热学参数，具有良好的实用性，可以推广至不确定但有界的噪声下系统的状态估计。"
