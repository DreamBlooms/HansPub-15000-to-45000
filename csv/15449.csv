"在石油工业中，绞车被广泛用于钻井现场，实现起下钻、下套管、控制钻压等功能。在起下钻过程中若绞车运行不当易发生撞击井口、钢丝绳断裂等井下事故。根据石油钻井工况，设计了绞车测控系统，实现了对绞车钢丝绳张力、张力差分值、高度与速度等参数进行实时监测、对危险参数值进行实时报警等功能。基于STEP 7 MicroWIN V4.0平台设计了PLC程序，并使用WinCC flexible平台开发了人机交互界面。经过实验测试，可准确反映绞车运行参数，在石油钻井现场有实际的应用价值。 关键词 :绞车测控，PLC，WinCC，光电编码器，压力传感器"
"绞车被广泛地运用于矿山、港口、工厂、建筑和海洋等诸多领域[ 1 ] -[ 4 ] 。在石油工业中运用最广泛的是钻井绞车和铺管绞车。其中钻井绞车具有起下钻具、下套管、控制钻进过程钻压和整体起立井架等功用 [ 5 ] [ 6 ] ，它的工作特点是操作使用频繁，变速范围宽、载荷变化大 [ 7 ] [ 8 ] 。传统的绞车控制方式为手动控制，由绞车司机控制起下钻过程。由于司机无法准确判断绞车速度与起下钻压力，易发生撞击井口或钻压过大钢丝绳断裂等严重的井下事故。随着电子控制技术的发展，将电子监控技术应用于绞车控制成为绞车自动化的发展趋势 [ 9 ] - [ 14 ] 。 基于西门子PLC可编程控制器技术，通过与马丁代克测量机构相配合，设计实现了对绞车速度、高度、压力等参数的测量监控，可对危险参数进行报警，并记录压力变化曲线，可对一段时间内的压力变化进行分析。"
"绞车测控系统主要完成对绞车运行中的高度、速度、压力等参数的实时监控工作，本系统主要分为三个功能模块，如图1所示。  采集模块的主要功能为将绞车钢丝绳的位移长度与速度信号转化为PLC可读取的数字信号、将钢丝绳上的压力值转化为PLC模拟量输入模块可读取的模拟信号。为了准确测量钢丝绳位移长度，消除多股钢丝绳缠绕引起的长度误差，本系统将传感器安装在马丁代克装置上，并将钢丝绳穿过马丁代克，以达到准确测量绞车提升下降距离的目的。 采集模块分为高度采集模块与压力采集模块。 1) 高度采集模块采用固定在马丁代克装置上的光电编码器对绞车钢丝绳位移长度进行计数，光电编码器每转过一定的角度会向PLC的I/O模块发送一个脉冲信号，PLC通过高速计数器记录编码器发送的脉冲数。对脉冲数进行数据处理即可得到绞车钢丝绳位移长度。 图1. 系统组成简图 2) 压力采集模块采用固定在马丁代克装置上的压力传感器测量钢丝绳所受拉力变化。压力传感器根据压力的不同会输出0~5 V的电压模拟信号，信号通过PLC模拟量输入模块处理传递到PLC模拟量寄存器。通过对模拟量寄存器数值进行处理变换即可得到绞车钢丝绳张力值。  绞车监控系统的控制模块采用西门子S7-200系列PLC。S7-200是西门子公司开发的超小型化PLC产品系列，它适用于大部分工业检测控制环境，具有强大的CPU处理能力，其依靠实时模式下运算速度快，较完善的通性功能和良好的模块扩展性等优点广泛应用于工业控制领域。 本系统中主控PLC通过读取I/O模块的高速计数器寄存器得到光电编码器计数值，经过比例计算得到绞车钢丝绳位移长度值，即高度值。对高度值进行一阶导数计算，即可得到绞车速度值。主控PLC通过读取模拟量寄存器中的数值，进行比例计算即可得到压力传感器所受压力值。对压力值进行一阶导数计算，即可得到压力差分值。 主控PLC具有控制参数报警模块，对绞车高度、速度、所受拉压力进行监控，当绞车运行中某参数值超过设定报警值，则显示面板报警并记录，可以有效对绞车运行过程进行安全管理。  本系统的显示模块使用西门子SMART 700 IE触屏显示器，显示界面使用WinCC flexible界面开发软件进行开发。 显示模块主要分为参数显示界面、参数设置界面、张力曲线界面、报警界面等，实现以下功能： 1) 监视绞车运行过程中的各项参数值，判断绞车运行状况，若出现异常工作状况则报警。 2) 设置绞车报警参数值，包括张力参数、张力零点校准和高度参数。 3) 查看一段时间内绞车张力曲线，根据一段时间内张力曲线的变化可以判断事故发生原因，对现场环境进行分析。 4) 查看一段时间内绞车报警情况，包括报警时间，事故名称，恢复时间等信息。"
"本系统采用STEP 7 MicroWIN V4.0 sp9编程软件进行主控PLC程序设计。STEP 7 MicroWIN V4.0编程软件是西门子公司为S7-200 PLC系列单独设计的梯形图编程软件，该软件可实现与PLC实时通信、在线监控等功能。 PLC最常采用的编程语言为梯形图语言，因其与继电器线路类似而受到电气设计人员的广泛使用。本系统也使用梯形图语言进行程序设计。本系统程序需要实现的功能包括初始化参数、绞车高度速度测量与报警、绞车张力测量与报警。 程序具体功能由以下三方面组成： 1) 初始化参数。包括对高速计数器、计时器初始化；对绞车高度值、张力值调零；对高度、速度、张力、张力差分值的报警值赋予初值；对高度、张力的计算比例系数进行设置。 2) 高度速度测量报警。PLC高速计数器寄存器HC0每接收到一个光电编码器的脉冲信号自动加1，程序实时将HC0记录值以双精度整数格式转存到寄存器，并乘以比例系数a，实时得到绞车高度值；利用PLC计时器记录一定时间间隔的两个高度值，做一阶导数运算，可实时得到绞车速度值；利用PLC寄存器位作为高度与速度报警开关，使用比较语句，对绞车速度高度值是否超限进行判断，若超限则报警。 3) 压力测量报警。压力传感器与PLC模拟量采集模块相连接，模拟量值存放在AIW0寄存器中，PLC实时将AIW0中的数值以双精度格式转存到寄存器，并乘以比例系数b，即可实时得到绞车所受张力值；利用PLC计时器记录一定时间间隔的两个张力值，做一阶导数运算，可实时得到绞车张力差分值；利用PLC寄存器位作为张力与张力差分值报警开关，使用比较语句，对绞车张力与张力差分值是否超限进行判断，若超限则报警。"
"WinCC flexible是德国西门子(SIEMENS)公司开发的面向机器的HMI (Human Machine Interface)人机接口设计软件。用于设计组态用户界面以控制监视设备与机器，实现用户与PLC的交互平台。设计的界面通过RS232接口下载到西门子700 IE触屏显示器，触摸屏通过RS232接口与西门子PLC连接，实现人机实时交互控制。 绞车测控系统人机交互界面分为以下五部分： 1) 绞车参数监控界面。如图2所示，本界面可以实时监控绞车运行张力值、张力差分值、速度值和深度值。界面下方有绞车监控报警指示灯，在绞车发生超载、遇卡遇阻、超速、深度到达井口或井底时进行红灯闪烁报警，提醒监控人员注意，以防发生事故。 2) 深度速度参数设置界面。在参数监控界面点击菜单键，输入管理员密码后进入此界面。在此界面可以实现设置编码器脉冲数与绞车高度的比例参数a、微调比例参数、设置深度报警与速度报警值，校正当前深度值等功能。点击数据保存键即可保存修改后的参数。 3) 张力参数设置界面。在此界面可以实现设置张力量程值、设置张力报警值与设置遇卡遇阻报警值等功能。点击张力零点校正按钮可以对张力零点进行校正，减小重力等因素对压力传感器测量值的影响。 4) 张力曲线界面。点击张力曲线按钮进入此画面，在此界面可以观察一段时间内的张力变化曲线，可以为监控人员判断绞车运行情况与事故发生原因提供依据。 5) 报警信息界面。点击报警界面按钮进入此画面，在此画面中可以查询近期所有报警信息，可为监控人员查询事故发生原因提供直接依据。 图2. 绞车参数监控界面"
"通过对绞车测控系统的研究设计，完成了以下工作： 1) 实现绞车钢丝绳的测控。通过对采集模块、控制模块和显示模块的模块设计，实现了对绞车运行参数的实时测量、监视、控制等功能。 2) 进行了PLC编程。使用STEP 7 MicroWIN V4.0 sp9编程软件设计了主控PLC运行程序，可对系统整体进行实时在线控制。 3) 设计了人机交互界面。运用WinCC flexible设计了人机接口组态界面，通过触摸显示屏实现人机交互控制，操作方便，界面友好，监控界面直观。"
