"本文提出了一个求解非线性半定规划的线搜索精确罚函数方法。在每次迭代中通过求解一个二次半定规划产生搜索方向，某个精确罚函数作为效益函数用于线搜索确定步长。且借助信赖域子问题的最优解更新罚参数。在较温和的条件下本文证明了算法具有全局收敛性。 关键词 :非线性半定规划，线搜索，罚函数，全局收敛性 Copyright © 2019 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"本文考虑如下非线性半定规划问题(NLSDP)： min f ( x ) s .t . h ( x ) = 0, G ( x ) ≼ 0, (0.1) 其中函数 f : ℝ n → ℝ ， G : ℝ n → S m ， h : ℝ n → ℝ p 是连续可微函数。 S m 表示所有m阶实对称矩阵构成的矩阵空间。 A ≼ 0 表示A为半负定矩阵， A ≺ 0 表示A为负定矩阵。 非线性半定规划在工程设计，最优控制，经济，金融等领域有着广泛的应用(见文 [ 1 ] [ 2 ] [ 3 ] )。基于非线性规划的罚函数法思想，一些学者提出了求解非线性半定规划的罚函数型算法。文 [ 4 ] 引进了非线性半定规划罚函数，结合线搜索策略提出了一个罚函数型的序列半定规划算法；文 [ 5 ] 基于罚函数技术和二阶校正方向，提出了一个超线性收敛的序列半定规划算法；文 [ 6 ] 通过由两个具有相同系数矩阵的线性方程组产生主搜索方向，罚函数作为效益函数用于线搜索确定步长，提出非线性半定规划的一个序列线性方程组算法；文 [ 7 ] 的第3章通过引进罚函数作为效益函数建立了一个超线性收敛的序列半定规划算法。 本文是将文 [ 8 ] 中产生搜索方向的子问题的构造策略和罚参数的更新策略推广到非线性半定规划，建立一个求解非线性半定规划的线搜索精确罚函数方法。在每次迭代中通过求解一个二次半定规划产生搜索方向的某个精确罚函数作为效益函数，用于线搜索确定步长。而且构造了一个信赖域子问题，并且借助信赖域子问题的最优解更新罚参数。在较温和的条件下算法具有全局收敛性。"
"为方便起见，下面引进矩阵函数的微分算子和伴随算子的记号。 对于连续可微矩阵函数 G ( x ) : ℝ n → S m ，记其微分算子 D G ( x ) 为 D G ( x ) : = ( ∂ G ( x ) ∂ x 1 , ∂ G ( x ) ∂ x 2 , ⋯ , ∂ G ( x ) ∂ x n ) , 且对任意的 d ∈ ℝ n ，有 D G ( x ) d = ∑ i = 1 n d i ∂ G ( x ) ∂ x i . 记 D G ( x ) 的伴随算子为 D G ( x ) * ，且 ∀ Z ∈ S m ，有 D G ( x ) * Z : = ( 〈 ∂ G ( x ) ∂ x 1 , Z 〉 , 〈 ∂ G ( x ) ∂ x 2 , Z 〉 , ⋯ , 〈 ∂ G ( x ) ∂ x n , Z 〉 ) T , 其中 〈 A , B 〉 表示矩阵A与B的内积，且 〈 A , B 〉 = Tr ( A B ) , ∀ A , B ∈ S m ， Tr ( ⋅ ) 表示矩阵的迹。定义NLSDP (0.1)的Lagrange函数为 L ( x , λ , Y ) = f ( x ) + λ T h ( x ) + 〈 Y , G ( x ) 〉 , 其中 λ ∈ ℝ p , Y ∈ S m 。 定义1.1：设 x * ∈ ℝ n 是NLSDP (0.1)的可行点，若存在向量 λ * ∈ ℝ p 和矩阵 Y * ∈ S m 满足如下条件： ∇ f ( x * ) + D h ( x * ) T λ * + D G ( x * ) ∗ Y * = 0, h ( x * ) = 0, G ( x * ) ≼ 0, Y * ≽ 0, Tr ( Y * G ( x * ) ) = 0, 则称 x * 是NLSDP (0.1)的一个KKT点，称 ( λ * , Y * ) 为对应于 x * 的Lagrange乘子。 定义NLSDP (0.1)的约束违反度函数如下： v ( x ) = ‖ h ( x ) ‖ + λ 1 ( G ( x ) ) + , (1.1) 其中 λ 1 ( A ) 表示矩阵A的最大特征值， ( α ) + = max { 0, α } ， ( λ 1 ( A ) ) + 简记为 λ 1 ( A ) + ， ‖   ⋅   ‖ 表示欧氏范数。定义NLSDP (0.1)的罚函数如下： P α ( x ) = f ( x ) + α v ( x ) , (1.2) 其中 α > 0 为罚参数。设当前迭代点为 x k ∈ ℝ n ，构造约束违反度函数 v ( x ) 线性模型如下： m k ( d ) = ‖ h ( x k ) + D h ( x k ) d ‖ + λ 1 ( G ( x k ) + D G ( x k ) d ) + . (1.3) 构造罚函数 P α ( x ) 的二次模型如下： Q k α ( d ) = f ( x k ) + ∇ f ( x k ) T d + 1 2 d T B k d + α m k ( d ) , (1.4) 其中矩阵 B k ∈ ℝ n × n 是NLSDP (0.1)的Lagrange函数的Hesse阵或其近似阵。对于给定的罚参数 α ，使用(1.4)产生搜索方向，即求解如下无约束问题(简记 QM ( x k , α ) )： min d ∈ ℝ n       Q k α ( d ) . (1.5) 记上述问题的最优解为 d k ( α ) 。由于 QM ( x k , α ) ( 1.5 ) 是非光滑问题，求解较为复杂，因此将其等价转化为如下光滑问题： min d , z 1 , z 2       ∇ f ( x k ) T d + 1 2 d T B k d + α ( ‖ z 1 ‖ 2 + z 2 ) s .t .             h ( x k ) + D h ( x k ) d = z 1 ,                                                   G ( x k ) + D G ( x k ) d ≼ z 2 I m , z 2 ≥ 0 , (1.6) 其中 I m 为m阶单位矩阵。记其解为 ( d k ( α ) , z 1 k , z 2 k ) 。 为更新罚参数，类似文 [ 8 ] ，构造如下信赖域子问题(简记 LM ( x k , Δ k ) )： min m k ( d )     s .t .   ‖ d ‖ ∞ ≤ Δ k , (1.7) 其中信赖域半径 Δ k > 0 。记其解为 d L M k 。由于 LM ( x k , Δ k ) ( 1.7 ) 为非光滑问题，因此将其等价转化为如下光滑问题： min d , z 1 , z 2 ‖ z 1 ‖ + z 2 s .t h ( x k ) + D h ( x k ) d = z 1 , G ( x k ) + D G ( x k ) d ≼ z 2 I m , ‖ d ‖ ∞ ≤ Δ k , z 2 ≥ 0. (1.8) 下面给出算法的具体步骤。 算法A： 步骤0：(初始步)任取 x 0 ∈ ℝ n ， B 0 = I n (单位阵)， α 0 > 0 , ρ > 0 ， ϵ 1 ∈ ( 0,1 ] ， ϵ 2 ∈ ( 0, ϵ 1 ) ， τ , η ∈ ( 0,1 ) ， Δ 0 ∈ [ Δ min , Δ max ] 。令 k = 0 。 步骤1：求解子问题 QM ( x k , α k ) ( 1.5 ) 得最优解 d k ( α k ) 。若 d k ( α k ) = 0 并且 v ( x k ) = 0 ，则算法终止，否则转步骤2。 步骤2：若 m k ( d k ( α k ) ) = 0 且 Q k α k ( 0 ) − Q k α k ( d k ( α k ) ) ≥ ϵ 2 α k v ( x k ) ，则转步骤5。 步骤3：求解子问题 LM ( x k , Δ k ) ( 1.7 ) 得最优解 d L M k 。若 m k ( d L M k ) = v ( x k ) 且 v ( x k ) > 0 , (1.9) 则算法终止，否则转步骤4。 步骤4：(更新罚参数) 步骤4.1：若 m k ( d L M k ) = 0 ，则取 α ¯ k ≥ α k + ρ 且使得如下等式成立 m k ( d k ( α ¯ k ) ) = 0 , (1.10) 其中 d k ( α ¯ k ) 是子问题 QM ( x k , α ¯ k ) ( 1 .5 ) 的解，转步骤4.3。 步骤4.2：若 m k ( d L M k ) > 0 ，则取 α ¯ k = α k ，若如下不等式 m k ( 0 ) − m k ( d k ( α ¯ k ) ) ≥ ϵ 1 [ m k ( 0 ) − m k ( d L M k ) ] (1.11) 成立，则转步骤4.3，否则取 α ¯ k ≥ α k + ρ 使得(1.11)成立，转步骤4.3，其中 d k ( α ¯ k ) 是子问题 QM ( x k , α ¯ k ) ( 1 .5 ) 的最优解。 步骤4.3：(二次模型预估下降量)若不等式 Q k α ¯ k ( 0 ) − Q k α ¯ k ( d k ( α ¯ k ) ) ≥ ϵ 2 α ¯ k [ m k ( 0 ) − m k ( d L M k ) ] (1.12) 成立，则令 α k : = α ¯ k ，否则通过下式更新罚参数 α ¯ k ： α k : = ∇ f ( x k ) T d k ( α ¯ k ) + 1 2 ( d k ( α ¯ k ) ) T B k d k ( α ¯ k ) m k ( 0 ) − m k ( d k ( α ¯ k ) ) + ϵ 2 [ m k ( d L M k ) − m k ( 0 ) ] + ρ , (1.13) 其中 0 < ϵ 2 < ϵ 1 < 1 。 步骤4.4：求解子问题 QM ( x k , α k ) ( 1 .5 ) 得最优解 d k ( α k ) ，转步骤5。 步骤5：(线搜索)令 t k 为序列 { 1, τ , τ 2 , ⋯ } 中满足如下不等式的最大值： P α k ( x k ) − P α k ( x k + t k d k ( α k ) ) ≥ η t k [ Q k α k ( 0 ) − Q k α k ( d k ( α k ) ) ] , (1.14) 则令 x ^ = x k + t k d k ( α k ) 。 步骤6：(更新步)利用某种方式更新 B k 为对称正定矩阵 B k + 1 ，取 Δ k + 1 ∈ [ Δ min , Δ max ] ， α k + 1 : = α k ， x k + 1 : = x ^ ，转步骤1。"
"本节将分析算法A的适定性。为此，需作如下基本假设： 假设A： A1：函数 f ( x ) , h ( x ) , G ( x ) 是二阶连续可微； A2：算法A产生的序列 { x k } 包含于某个紧凸集中； A3：存在正常数a和b，使得 a ‖ y ‖ 2 ≤ y T B k y ≤ b ‖ y ‖ 2 , ∀ y ∈ ℝ n 。 现将非线性规划的稳定点和不可行稳定点的定义(见文 [ 9 ] )推广到非线性半定规划。 定义2.1：设 x ∈ ℝ n ，若对于任意非零向量 y ∈ ℝ n ，函数 w ( x ) 的方向导数 w ′ ( x ; y ) ≥ 0 ，则称x为 w ( x ) 的一个稳定点。 定义2.2：设 x ∈ ℝ n ，若对于任意向量 y ∈ ℝ n ，有 v ′ ( x ; y ) ≥ 0 ，则称x为NLSDP (0.1)的一个稳定点。同时若 v ( x ) > 0 ，则称x为NLSDP (0.1)的一个不可行稳定点。 引理2.1：设 x k 为当前迭代点，则 v ′ ( x k ; y ) = m ′ k ( 0 ; y ) , P ′ α ( x k ; y ) = ( Q k α ) ′ ( 0 ; y ) , ∀ y ∈ ℝ n . (2.1) 证明：由文 [ 4 ] 的引理5知 v ′ ( x k ; y ) = ‖ D h ( x k ) y ‖ + [ λ 1 ( ⋅ ) + ] ′ ( G ( x k ) ; D G ( x k ) y ) . (2.2) 另外，对于 d ˜ ∈ ℝ n ，由文 [ 4 ] 的引理5知 m ′ k ( d ˜ ; y ) = ‖ ( h ( x k ) + D h ( x k ) d ) ′ ( d ˜ ; y ) ‖ + [ λ 1 ( G ( x k ) + D G ( x k ) d ) + ] ′ ( d ˜ ; y ) = ‖ D h ( x k ) y ‖ + [ λ 1 ( ⋅ ) + ] ′ ( G ( x k ) + D G ( x k ) d ˜ ; D G ( x k ) y ) , 令 d ˜ = 0 ，可得 m ′ k ( 0 ; y ) = ‖ D h ( x k ) y ‖ + [ λ 1 ( ⋅ ) + ] ′ ( G ( x k ) ; D G ( x k ) y ) . (2.3) 由(2.2)和(2.3)即知(2.1)的第一个式子成立。由方向导数的定义以及(2.1)的第一个式子即知(2.1)的第二个式子成立。 引理2.2：设当前点为 x k ，则如下结论成立： (1) x k 为 P α ( x ) 的稳定点当且仅当子问题 QM ( x k , α ) ( 1.5 ) 的最优解 d k ( α ) = 0 。 (2) 若 x k 为 P α ( x ) 的稳定点且 v ( x k ) = 0 ，则 x k 是NLSDP (0.1)的一个KKT点。 (3) x k 为 v ( x ) 的稳定点当且仅当对于任意给定的信赖域半径 Δ > 0 ，子问题 LM ( x k , Δ k ) ( 1.7 ) 的最优解 d L M k 满足如下等式： m k ( d L M k ) = v ( x k ) . (2.4) 证明：(1) 子问题 QM ( x k , α ) ( 1.5 ) 的最优解 d k ( α ) = 0 当且仅当对于任意方向 y ∈ ℝ n ，有 ( Q k α ) ′ ( 0 ; y ) ≥ 0 。再由引理2.1和稳定点的定义知结论成立。 (2) 若 x k 是 P α ( x ) 的稳定点，则由结论(1)知子问题 QM ( x k , α ) ( 1.5 ) 的最优解 d k ( α ) = 0 。由子问题(1.6)的KKT条件可得 ∇ f ( x k ) + B k d k ( α ) + D h ( x k ) T λ k + D G ( x k ) ∗ Y k = 0, (2.5a) h ( x k ) + D h ( x k ) d k ( α ) = z 1 k , (2.5b) G ( x k ) + D G ( x k ) d k ( α ) ≼ z 2 k I m , (2.5c) Y k ≽ 0, (2.5d) Tr ( Y k ( G ( x k ) + D G ( x k ) d k ( α ) − z 2 k I m ) ) = 0. (2.5e) 将 d k ( α ) = 0 代入，即有 ∇ f ( x k ) + D h ( x k ) T λ k + D G ( x k ) ∗ Y k = 0, (2.6a) h ( x k ) = z 1 k , (2.6b) G ( x k ) ≼ z 2 k I m , (2.6c) Y k ≽ 0, (2.6d) Tr ( Y k ( G ( x k ) − z 2 k I m ) ) = 0. (2.6e) 由 v ( x k ) = 0 知 x k 为NLSDP (0.1)的可行点，故结合(2.6b)，(2.6c)和 z 2 k ≥ 0 知 ( z 1 k , z 2 k ) = ( 0 , 0 ) 。再结合(2.6a)，(2.6d)，(2.6e)即知 x k 是NLSDP (0.1)的KKT点。 (3) 由引理2.1知 x k 是 v ( x ) 的稳定点当且仅当0是 m k ( d ) 的稳定点，结合 m k ( d ) 是凸函数知0是 LM ( x k , Δ k ) ( 1.7 ) 的一个最优解，因此， m k ( d L M k ) = m k ( 0 ) ，结合 m k ( 0 ) = v ( x k ) 即得 m k ( d L M k ) = v ( x k ) 。反之，若 m k ( d L M k ) = m ( 0 ) ，即0是子问题 LM ( x k , Δ k ) ( 1.7 ) 的一个最优解，由此知0是 m k ( d ) 的稳定点，于是对任意方向 y ∈ ℝ n ，有 m ′ k ( 0 ; y ) ≥ 0 。由引理2.1即知 x k 是 v ( x ) 的稳定点。 为了方便起见，记 q k f ( d ) : = f ( x k ) + ∇ f ( x k ) T d + 1 2 d T B k d , (2.7) 则由(1.4)知 Q k α ( d ) = q k f ( d ) + α m k ( d ) 。下面引理给出算法A的适定性。 引理2.3：设当前点 x k 既不是NLSDP (0.1)的KKT点，也不是约束违反度函数 v ( x ) 的稳定点，则以下结论成立： (1) 若算法A执行到步骤4，则当 m k ( d L M k ) = 0 时，存在 α ¯ k > 0 ，使得(1.10)式成立；当 m k ( d L M k ) > 0 时，存在 α ¯ k > 0 ，使得(1.11)式成立。另外，若(1.12)不成立，则通过(1.13)式产生的 α k 满足如下不等式： Q k α k ( 0 ) − Q k α k ( d k ( α k ) ) ≥ ϵ 2 α k [ m k ( 0 ) − m k ( d L M k ) ] , (2.8) 其中 是子问题 QM ( x k , α k ) ( 1.5 ) 的最优解。同时该 α k 也满足不等式(1.10)和(1.11)。 (2) 若算法A执行到步骤5，则 d k ( α k ) 是罚函数 P α k ( x ) 在 x k 处的下降方向，并且总存在步长 t k > 0 ，使得(1.14)式成立。 证明：(1) 若算法A执行到步骤4，由于子问题(1.8)的最优解 ( d L M k , z 1 k , z 2 k ) 是子问题(1.6)的可行解，故有 m k ( d k ( α ¯ k ) ) ≤ m k ( d L M k ) . (2.9) 若 m k ( d L M k ) = 0 ，则由上式知(1.10)成立。若 m k ( d L M k ) > 0 ，注意到 ϵ 1 ∈ ( 0,1 ] 。由于0是子问题(1.7)的可行解，因此有 m k ( 0 ) − m k ( d L K k ) ≥ 0 。于是由(2.9)有 m k ( 0 ) − m k ( d k ( α ¯ k ) ) ≥ m k ( 0 ) − m k ( d L M k ) ≥ ϵ 1 [ m k ( 0 ) − m k ( d L M k ) ] , 故(1.11)式成立。 若(1.12)不成立，注意到当前的 α ¯ k 为步骤4.1或步骤4.2更新后的罚参数且子问题 QM ( x k , α ¯ k ) ( 1.5 ) 的最优解是 d k ( α ¯ k ) ，下面分两种情况讨论： 若 m k ( 0 ) − m k ( d L M k ) = 0 ，注意到 d k ( α ¯ k ) 是子问题 QM ( x k , α k ) ( 1.5 ) 的最优解，则有 Q k α k ( 0 ) ≥ Q k α k ( d k ( α k ) ) 。因此， Q k α k ( 0 ) − Q k α k ( d k ( α k ) ) − ϵ 2 α k [ m k ( 0 ) − m k ( d L M k ) ] ≥ 0 ，即(2.8)成立。 若 m k ( 0 ) − m k ( d L M k ) > 0 ，则 m k ( 0 ) > m k ( d L M k ) ≥ 0 ，故 m k ( 0 ) > 0 。 记 Γ : = m k ( 0 ) − m k ( d k ( α ¯ k ) ) + ϵ 2 [ m k ( d L M k ) − m k ( 0 ) ] ，往证 Γ > 0 。 若(1.10)成立，则 Γ = m k ( 0 ) + ϵ 2 [ m k ( d L M k ) − m k ( 0 ) ] = ( 1 − ϵ 2 ) m k ( 0 ) + ϵ 2 m k ( d L M k ) > 0. 若(1.11)成立，结合 0 < ϵ 2 < ϵ 1 及 m k ( 0 ) − m k ( d L M k ) > 0 ，则有 Γ ≥ ϵ 1 [ m k ( 0 ) − m k ( d L M k ) ] + ϵ 2 [ m k ( d L M k ) − m k ( 0 ) ] = ( ϵ 1 − ϵ 2 ) [ m k ( 0 ) − m k ( d L M k ) ] , 由此可知 Γ > 0 。 接下来证明 α k 满足(2.8)。由(1.13)得 α k [ m k ( 0 ) − m k ( d k ( α ¯ k ) ) ] + ϵ 2 α k [ m k ( d L M k ) − m k ( 0 ) ] = ∇ f ( x k ) T d k ( α ¯ k ) + 1 2 ( d k ( α ¯ k ) ) T B k d k ( α ¯ k ) + Γ ⋅ ρ , 结合 Γ > 0 , ρ > 0 和(1.4)，得 ϵ 2 α k [ m k ( 0 ) − m k ( d L M k ) ] ≤ − ∇ f ( x k ) T d k ( α ¯ k ) − 1 2 ( d k ( α ¯ k ) ) T B k d k ( α ¯ k ) + α k [ m k ( 0 ) − m k ( d k ( α ¯ k ) ) ] = Q k α k ( 0 ) − Q k α k ( d k ( α ¯ k ) ) ≤ Q k α k ( 0 ) − Q k α k ( d k ( α k ) ) , 即 α k 满足(3.8)。 最后证明 α k 满足(1.10)和(1.11)。设罚参数 α 1 < α 2 ，由于 d k ( α ) 是子问题 QM ( x k , α ) ( 1.5 ) 的最优解，故有 Q k α 2 ( d k ( α 1 ) ) ≥ Q k α 2 ( d k ( α 2 ) ) , Q k α 1 ( d k ( α 2 ) ) ≥ Q k α 1 ( d k ( α 1 ) ) ，即 q k f ( d k ( α 1 ) ) + α 2 m k ( d k ( α 1 ) ) ≥ q k f ( d k ( α 2 ) ) + α 2 m k ( d k ( α 2 ) ) , q k f ( d k ( α 2 ) ) + α 1 m k ( d k ( α 2 ) ) ≥ q k f ( d k ( α 1 ) ) + α 1 m k ( d k ( α 1 ) ) , 两式相减，得 m k ( d k ( α 1 ) ) ≥ m k ( d k ( α 2 ) ) ，因此， m k ( d k ( α ) ) 是关于罚参数 α 的单调减函数。由于(1.12)式不成立，故有 Q k α ¯ k ( 0 ) − Q k α ¯ k ( d k ( α ¯ k ) ) < ϵ 2 α ¯ k [ m k ( 0 ) − m k ( d L M k ) ] ，结合 Γ > 0 ，化简得 α ¯ k < ∇ f ( x k ) T d k ( α ¯ k ) + 1 2 ( d k ( α ¯ k ) ) T B k d k ( α ¯ k ) m k ( 0 ) − m k ( d k ( α ¯ k ) ) + ϵ 2 [ m k ( d L M k ) − m k ( 0 ) ] , 结合(1.13)式，可得 α ¯ k < α k ，因此有 m k ( d k ( α k ) ) ≤ m k ( d k ( α ¯ k ) ) . (3.10) 若 m k ( d L M k ) = 0 ，则由(2.10)和(2.9)得 0 ≤ m k ( d k ( α k ) ) ≤ m k ( d k ( α ¯ k ) ) ≤ m k ( d L M k ) = 0 ，故 m k ( d k ( α k ) ) = 0 ，即 α k 满足(1.10)式。 若 m k ( d L M k ) > 0 ，则由(2.10)和(2.11)得 m k ( 0 ) − m k ( d k ( α k ) ) ≥ m k ( 0 ) − m k ( d k ( α ¯ k ) ) ≥ ϵ 1 [ m k ( 0 ) − m k ( d L M k ) ] , 即 α k 满足(1.11)式。 (2) 若 x k 不是罚函数 P α k ( x ) 的稳定点，则由引理2.2 (1)知 d k ( α k ) ≠ 0 。由于 Q k α k ( d ) 是凸的且 d k ( α k ) 为 QM ( x k , α k ) ( 1.5 ) 的最优解，故有 Q k α k ( d k ( α k ) ) < Q k α k ( 0 ) 。由方向导数的定义和 Q k α k ( d ) 的凸性得 ( Q k α k ) ′ ( 0 ; d k ( α k ) ) = lim t → 0 + Q k α k ( t d k ( α k ) ) − Q k α k ( 0 ) t = lim t → 0 + Q k α k ( ( 1 − t ) 0 + t d k ( α k ) ) − Q k α k ( 0 ) t ≤ lim t → 0 + ( 1 − t ) Q k α k ( 0 ) + t Q k α k ( d k ( α k ) ) − Q k α k ( 0 ) t = Q k α k ( d k ( α k ) ) − Q k α k ( 0 ) < 0 , 因此， d k ( α k ) 是 Q k α k ( d ) 在0处的下降方向。由引理2.1可得： P ′ α k ( x k ; d k ( α k ) ) = ( Q k α k ) ′ ( 0 ; d k ( α k ) ) < 0 因此， d k ( α k ) 是罚函数 P α k ( x ) 在 x k 处的下降方向。从而当 t > 0 充分小时，有如下不等式成立： P α k ( x k + t d k ( α k ) ) < P α k ( x k ) + t η P ′ α k ( x k ; d k ( α k ) ) . (2.11) 由 Q k α k ( d ) 的凸性可得 Q k α k ( 0 + t d k ( α k ) ) ≥ Q k α k ( 0 ) + t ( Q k α k ) ′ ( 0 ; d k ( α k ) ) ，故有 − t ( Q k α k ) ′ ( 0 ; d k ( α k ) ) ≥ Q k α k ( 0 ) − Q k α k ( 0 + t d k ( α k ) ) = Q k α k ( 0 ) − Q k α k ( ( 1 − t ) 0 + t d k ( α k ) ) ≥ Q k α k ( 0 ) − ( 1 − t ) Q k α k ( 0 ) − t Q k α k ( d k ( α k ) ) = t [ Q k α k ( 0 ) − Q k α k ( d k ( α k ) ) ] , 结合引理2.1和(2.11)，可知不等式(1.14)成立。 若算法有限步终止，则由引理2.2知当前点 x k 或为NLSDP (0.1)的KKT点，或为NLSDP (0.1)的不可行稳定点。在以下讨论中，不妨假设算法A产生无穷序列 { x k } 且 x * 为其任一聚点。 类似文 [ 8 ] 的证明，可得如下引理成立。 引理2.4：若假设A成立，则对于任意 α > 0 ，子问题 QM ( x k , α ) ( 1.5 ) 的最优解 d k ( α ) 包含于如下闭球： B k : = { d | ‖ d ‖ ≤ r k } , 其中， r k = b 3 + b 4 ‖ d ¯ k ‖ , b 3 , b 4 > 0 ， d ¯ k 是子问题 LM ( x k , Δ k ) ( 1.7 ) 的解集中最小范数值点。 下面给出算法A的全局收敛性定理。 定理2.1：若假设A成立，罚参数序列 { α k } 有界，算法A产生无穷序列 { x k } 且 x * 为其任一聚点，则 (1) 若 v ( x * ) = 0 ，则 x * 为NLSDP (0.1)的一个KKT点； (2) 若 v ( x * ) > 0 ，则 x * 为NLSDP (0.1)的一个不可行稳定点。 证明：由算法A和假设可知，罚参数序列 { α k } 是单调不减且有界，因此，存在常数 α ¯ > 0 ，当k充分大时，有 α k ≡ α ¯ 。记 K ⊆ { 1,2, ⋯ } ，不失一般性，当 k ∈ K 时，设 x k → x * , B k → B * , Q k α ¯ → Q * α ¯ 。记 d * 是子问题 QM ( x * , α ¯ ) ( 1.5 ) 的最优解，往证 d * = 0 。 (反证)假设 d * ≠ 0 ，则 Q * α ¯ ( 0 ) − Q * α ¯ ( d * ) > 0 。于是有 Q k α ¯ ( 0 ) − Q k α ¯ ( d * ) → K Q * α ¯ ( 0 ) − Q * α ¯ ( d * ) > 0. 记 Q * α ¯ ( 0 ) − Q * α ¯ ( d * ) = 2 ε ，其中 ε > 0 。因此存在指标 k 0 ，当 k ( ∈ K ) > k 0 时，由上式和 Q k α ¯ ( d * ) ≥ Q k α ¯ ( d k ( α ¯ ) ) 得 Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) ≥ Q k α ¯ ( 0 ) − Q k α ¯ ( d * ) > ε . (2.12) 当 t > 0 足够小时，由引理2.4，(1.1)，(1.3)，假设A1和Taylor展开式得 v ( x k + t d k ( α ¯ ) ) − m k ( t d k ( α ¯ ) ) = ‖ h ( x k ) + t D h ( x k ) d k ( α ¯ ) + O ( ‖ t d k ( α ¯ ) ‖ 2 ) ‖ − ‖ h ( x k ) + t D h ( x k ) d k ( α ¯ ) ‖     + λ 1 ( G ( x k ) + t D G ( x k ) d k ( α ¯ ) + O ( ‖ t d k ( α ¯ ) ‖ 2 ) ) +     − λ 1 ( G ( x k ) + t D G ( x k ) d k ( α ¯ ) ) + = O ( ‖ t d k ( α ¯ ) ‖ 2 ) (2.13) 由引理2.4，(1.3)，假设A及Taylor展开式得 f ( x k + t d k ( α ¯ ) ) − q k f ( t d k ( α ¯ ) ) = f ( x k ) + t ∇ f ( x k ) T d k ( α ¯ ) + 1 2 t 2 ( d k ( α ¯ ) ) T ∇ 2 f ( ξ ) d k ( α ¯ ) − q k f ( t d k ( α ¯ ) ) = 1 2 t 2 ( d k ( α ¯ ) ) T ( ∇ 2 f ( ξ ) − B k ) d k ( α ¯ ) = O ( ‖ t d k ( α ¯ ) ‖ 2 ) , (2.14) 其中 ξ 介于 x k 与 x k + t d k ( α k ) 之间。 由(2.13)和(2.14)知当 t > 0 足够小时，有 P α ¯ ( x k + t d k ( α ¯ ) ) − Q k α ¯ ( t d k ( α ¯ ) ) = O ( ‖ t d k ( α ¯ ) ‖ 2 ) , 故存在一个常数 b 1 > 0 ，使得 | P α ¯ ( x k + t d k ( α ¯ ) ) − Q k α ¯ ( t d k ( α ¯ ) ) | ≤ b 1 ‖ t d k ( α ¯ ) ‖ 2 . (2.15) 由 Q k α ¯ ( d ) 的凸性可得 Q k α ¯ ( 0 ) − Q k α ¯ ( t d k ( α ¯ ) ) ≥ Q k α ¯ ( 0 ) − ( 1 − t ) Q k α ¯ ( 0 ) − t Q k α ¯ ( d k ( α ¯ ) ) = t ( Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) ) . (2.16) 由 P α ¯ ( x k ) , Q k α ¯ ( d ) 的定义知 P α ¯ ( x k ) = Q k α ¯ ( 0 ) ，结合(2.12)，(2.15)和(2.16)，可得 P α ¯ ( x k ) − P α ¯ ( x k + t d k ( α ¯ ) ) = ( Q k α ¯ ( 0 ) − Q k α ¯ ( t d k ( α ¯ ) ) ) + Q k α ¯ ( t d k ( α ¯ ) ) − P α ¯ ( x k + t d k ( α ¯ ) ) ≥ t ( Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) ) − b 1 ‖ t d k ( α ¯ ) ‖ 2 = η t ( Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) ) + ( 1 − η ) t ( Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) ) − b 1 ‖ t d k ( α ¯ ) ‖ 2 ≥ η t ( Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) ) + ( 1 − η ) t ε − b 1 ‖ t d k ( α ¯ ) ‖ 2 . 若 t ≤ ( 1 − η ) ε b 1 ‖ d k ( α ¯ ) ‖ 2 ，结合上式，则知(1.14)成立。由步长 t k 的选择可知， t k ≥ min { 1, τ ( 1 − η ) ε b 1 ‖ d k ( α ¯ ) ‖ 2 } . (2.17) 注意到 d k ( α ¯ ) 是子问题 QM ( x k , α ¯ ) ( 1.5 ) 的最优解，可以证明 ‖ d k ( α ¯ ) ‖ ≤ max { 2 a ( ‖ ∇ f ( x k ) ‖ + α ¯ m k ( 0 ) ) , 1 } . (2.18) (反证)假设上式不成立，则 ‖ d k ( α ¯ ) ‖ > 1 , ‖ d k ( α ¯ ) ‖ > 2 a ( ‖ ∇ f ( x k ) ‖ + α ¯ m k ( 0 ) ) 。由(1.4)，假设A2以及上式可得 Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) = − ∇ f ( x k ) T d k ( α ¯ ) − 1 2 ( d k ( α ¯ ) ) T B k d k ( α ¯ ) − α ¯ m k ( d k ( α ¯ ) ) + α ¯ m k ( 0 ) ≤ ‖ ∇ f ( x k ) ‖ ‖ d k ( α ¯ ) ‖ − 1 2 a ‖ d k ( α ¯ ) ‖ 2 + α ¯ m k ( 0 ) < ‖ ∇ f ( x k ) ‖ ‖ d k ( α ¯ ) ‖ − 1 2 a ‖ d k ( α ¯ ) ‖ ⋅ 2 a ( ‖ ∇ f ( x k ) ‖ + α ¯ m k ( 0 ) ) + α ¯ m k ( 0 ) = α ¯ m k ( 0 ) ( 1 − ‖ d k ( α ¯ ) ‖ ) < 0 , 这与“ d k ( α ¯ ) 是 QM ( x k , α ¯ ) ( 1.5 ) 的最优解”矛盾。因此不等式(2。18)成立。 由假设A1，(2.17)和(2.18)可知，存在常数 b 2 > 0 ，使得 t k > b 2 成立，于是结合(1.14)和(2.12)可得 P α ¯ ( x k ) − P α ¯ ( x k + t k d k ( α ¯ ) ) > η b 2 ε ，由此可推知 P α ¯ ( x k ) → ∞ ，这与“ P α ¯ ( x k ) 有界”矛盾。因此， d * = 0 。 于是由引理2.2 (1)知 x * 是罚函数 P α ¯ ( x ) 的稳定点。若 v ( x * ) = 0 ，则由引理2.2 (2)知 x * 为NLSDP (0.1)的KKT点，即结论(1)成立。 若 v ( x * ) > 0 ，往下证明 x * 为NLSDP (0.1)的不可行稳定点。 下面证明 m * ( d L M * ) = v ( x * ) 。由于 d k ( α ¯ ) → 0, k ∈ K ，则当 k ( ∈ K ) 充分大时 Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) → 0, (2.19) 由步骤4.3知 Q k α ¯ ( 0 ) − Q k α ¯ ( d k ( α ¯ ) ) ≥ ϵ 2 α ¯ [ m k ( 0 ) − m k ( d L M k ) ] , (2.20) 因此，由(2.19)和(2.20)有 m k ( 0 ) − m k ( d L M k ) → 0 。由此可知 m k ( 0 ) − m k ( d L M k ) → m * ( 0 ) − m * ( d L M * ) = 0 ， 从而 m * ( d L M * ) = m * ( 0 ) = v ( x * ) ，于是由引理2.2 (3)可知 x * 是 v ( x ) 的稳定点。又因 v ( x * ) > 0 ，所以 x * 是NLSDP (0.1)的不可行稳定点。"
"为了验证算法A的可行性与有效性，本节利用MATLAB (2014a)实现了算法，程序运行环境为：Windows 7 (64 bite)，RAM: 4G，CPU 3，60 GHz。测试的算例来自于文 [ 10 ] [ 11 ] [ 12 ] 中的静态反馈控制问题(SOFP)，即 min Tr ( L Q F ) s .t . A F L + L A F T + I = 0, A F L + L A F T ≼ 0, L ≻ 0, 在算法实现中，选取 [ 12 ] 的初始点为 L = 10 I ∈ R n x × n x , F = 0 ∈ R n u × n y ，其中 n x , n u , n y 为给定的数。选取的参数如下： α 0 = 80 , ρ = 100 , η 1 = 0.5 , η 2 = 0.3 , τ = 0.5 , η = 0.001. 终止准则为： ‖ d k ‖ ≤ 10 − 4 , ‖ v ( x k ) ‖ ≤ 10 − 4 。数值结果见表1，表中的主要符号含义如下： 问题：COMPl e ib算例库的算例名称； n：自变量维数； m：半定约束矩阵的阶数； p：等式约束个数； f * ：最优函数值； Iter：算法迭代次数； P * ：最优解的约束违反度函数值； Time：计算机运行时间(秒)。 Table 1 问题 n p m Iter P * f * Time AC1 24 15 5 667 4.858138e−08 2.002884e+01 2.063345e+01 AC2 24 15 5 667 4.858138e−08 2.002884e+01 2.136759e+01 AC3 23 15 5 171 4.535034e−09 2.184061e+01 3.566312e+00 AC4 12 10 4 369 5.104441e−08 1.198998e+01 1.165651e+01 AC6 36 28 7 182 1.592843e−07 1.090587e+01 7.348702e+00 AC7 47 45 9 3322 1.995717e−08 1.559962e+02 1.983689e+02 AC15 16 10 4 2980 6.315831e−11 1.590686e+02 7.697651e+01 AC17 12 10 4 135 6.463962e−09 1.462636e+01 4.201801e+00 HE2 14 10 4 45 1.267061e−09 1.187440e+01 1.268405e+00 DIS1 52 36 8 132 1.102015e−09 1.535720e+01 6.519064e+00 DIS2 10 6 3 120 5.039833e−09 8.595297e+00 4.221502e+00 DIS3 37 21 6 84 1.312657e−08 5.986639e+00 3.557754e+00 DIS4 45 21 6 110 1.514964e−09 3.957641e+00 4.589913e+00 AGS 82 78 12 78 5.434856e−09 4.942235e+01 9.242347e+00 UWV 40 36 8 1368 3.847353e−05 2.093619e+00 6.385419e+01 IH 341 231 21 73 1.276043e−08 4.229681e+01 4.684438e+01 CSE1 230 210 20 95 4.403847e−10 7.669994e+01 6.509819e+01 PSM 34 28 7 124 5.515611e−09 3.236933e+00 4.639584e+00 NN2 4 3 2 79 1.417326e−08 3.464102e+00 4.567462e+00 NN4 16 10 4 134 3.508822e−09 5.407893e+00 2.829252e+00 NN8 10 6 3 44 5.854256e−08 4.438272e+00 1.167806e+00 NN11 151 136 16 127 3.684578e−09 2.758270e+02 6.448854e+01 NN15 10 6 3 2624 3.601449e−12 4.695404e+02 8.593176e+01 NN16 52 36 8 439 4.972716e−07 1.536476e+01 2.148031e+01 HF2D13 23 15 5 1638 3.981798e−10 5.109506e−01 5.149195e+01 HF2D14 23 15 5 4468 1.019683e−09 4.556688e+00 1.815774e+02 HF2D16 23 15 5 501 5.804131e−09 3.227871e+00 1.714861e+01 HF2D17 23 15 5 586 2.309633e−09 7.647004e−01 1.991716e+01 HF2D18 19 15 5 4407 1.710919e−10 1.309318e+01 1.319252e+02 TMD 29 21 6 835 1.695120e−09 4.798488e+01 2.122048e+01 表1. 数值结果"
"本文提出了一个线搜索精确罚函数法。搜索方向由二次半定规划子问题产生，罚函数作为效益函数用于线搜素，线搜索保证效益函数的充分下降；罚参数在算法中自动更新，且罚参数的更新策略依赖信赖域子问题的最优解。在适当的条件下算法具有全局收敛性。"
