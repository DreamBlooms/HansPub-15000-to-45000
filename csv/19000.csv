"目的：设计一套医疗设备的全过程动态管理信息系统。方法：分析系统的整体框架，将系统分成购置管理、资产管理、质量控制、维修管理、计量管理、公用设备管理、效益分析和档案管理八个子模块。系统采用多窗口C/S构架，数据库采用Microsoft SQL Server 2000,客户端程序利用集成开发工具PowerBuilder9.0进行设计，不同权限的用户进入该系统实现不同的管理功能，提出动态管理的新模式。给出系统的发布环境，安装与配置，以及在我院的测试结果。结果：该系统大大提高了我院医疗设备管理的效率，减轻了劳动强度，为领导决策提供了可靠依据，满足了等级医院评审的需要。结论：实现了全过程动态管理医疗设备的目的。 关键词 :医疗设备，动态管理，信息系统，设计与实现"
"随着我国医疗系统的数字化建设的迅猛发展，医疗设备的数字化管理正在不断的研究中。针对医疗设备的规范化管理，大型医疗机构在向系统化、数字化方向迈进的速度较快，但是，所使用的医疗设备管理系统或多或少的存在功能不全的问题 [ 1 ] [ 2 ] [ 3 ] [ 4 ] ，我院现有的设备管理系统主要是账物管理，设备的购置缺少申请论证与审批、计划与采购过程，维修管理，质量管理、计量管理、公用设备管理、效益分析、资产管理、档案管理 [ 5 ] [ 6 ] [ 7 ] 七大功能基本没有。在医院正常的运行中，设备管理者希望能查看设备的即时状态，更想对设备的效益进行定期分析，何时需要检测与质控、何时需要更新设备等。医院领导希望能及时准确地获取信息，提升决策质量。根据医疗设备全过程动态管理的要点，研制并开发一套医疗设备全过程动态信息管理系统，充分利用计算机、网络、数据库等先进技术知识，通过透明化的流程，使医疗设备管理规范化、制度化、程序化，提高信息处理速度，这是我院快速发展的需要，同时，也为其他医院的医疗设备全过程动态管理提供技术参考 [ 8 ] [ 9 ] 。基于以上原因，开发了《医疗设备全过程动态管理信息系统》，有效解决了实践中存在的问题。"
"医疗设备的全过程管理就是：医技科室根据工作需要，提出购买申请，设备科汇总，向设备管理委员会提出并讨论，根据医院总的发展需要，病员数量、技术先进性等综合因素决定是否购置，形成草案，报院办公会讨论审批，形成设备购置计划，然后组织人员考察，写出考察报告，然后和商家谈判、招标，形成谈判记录，签订合同，到货后组织相关人员安装、验收、入库，最后发放到科室使用，科室做好医疗设备运行与维护记录，定期对设备进行质控和效益分析，直至报废。如图1所示给出了全过程管理信息系统的流程图。  在认真分析医疗设备管理流程的基础上，将整个系统分为以下八个模块：购置管理，维修管理、质量管理、计量管理、公用设备管理、效益管理、资产管理和档案管理 [ 10 ] ，每一模块应实现的功能如下： 1、购置管理 该模块分为申请论证与审批，计划与购置管理，验收与库房管理三部分，其功能如下： (1) 申请论证与审批功能：完成各临床医技科室所报计划的论证，报院长办公会讨论，申请或通过的项目实现即时查询。可将有关单价打印输出。 (2) 计划与购置管理功能：根据医院的实际情况，对列入计划的医疗设备实施采购，签订购销合同，落实合同履行情况。可将有关单价打印输出。 (3) 验收与库房管理功能：实现设备的入出库及退库，打印相关凭证及查询功能。 2、资产管理功能：登录相关设备，查询该设备的即时信息，可将有关单据打印输出。 3、质量管理功能：主要包含5个部分，巡检与保养、质控、满意度评价、不良事件上报、培训与考核。实现医疗设备的质量控制及查询功能。 4、维修管理 功能：完成医疗设备的运行与技术保障登记及其查询，可将有关单据打印输出。 5、计量管理功能：实现计量登记与查询以及特种设备的定期检测，及时提醒亟待计量的设备和需要检测的特种设备。 6、公用设备管理 功能：实现设备的定期巡检、定期维护与维修登记及查询。可将有关单据打印输出。 图1. 全过程动态管理信息系统的流程图 7、效益分析 功能：实现医疗设备效益考核、折旧、残值等相关费用的查询。可将有关单据打印输出。 8、档案管理功能：对设备的新增、使用、转科、盘点、报废、处置等进行全方位、全过程监控管理，贯穿资产整个生命周期，可将有关单据打印输出。"
"以实现医疗设备全过程动态管理为主要目标，以医疗设备全过程动态管理流程为依据，基于两层C/S结构，以PowerBuilder9.0作为开发工具，SQL Server 2000作为服务器进行开发和设计 [ 11 ] [ 12 ] [ 13 ] [ 14 ] [ 15 ] 。设计一套操作简单、使用方便的信息管理系统，实现八大功能，不同权限的用户进入该系统实现不同的管理功能与分析查询功能，为科室设备管理员提供方便，提高工作效率，为领导提供准确可靠的数据，采取正确的决策。  C/S (Client/Server)结构，就是客户机与服务器结构，是软件系统体系结构，通过它可以利用两端硬件环境的优势，将任务合理分配到Client和Server端来实现，它是一种数据的存储、访问和处理的模型，是一种流行的数据库系统结构，服务器端用于存储数据、处理数据请求，维护数据完整性，另一端用于处理用户对话框，生成数据请求、显示返回结果。C/S结构的本质在于通过对服务器功能的分布，实现分工服务。每个服务器都为局域网提供共享服务，供所有客户机共享，客户机上的应用程序借助于服务器的服务功能以实现复杂的应用功能。在C/S结构中，数据存储层处于服务器上，应用层和服务界面处于客户机上。C/S结构如图2所示。  1、系统硬件配置 Server端：CPU主频2.8 GHZ以上，内存1 G以上，硬盘1 T以上，显示器21英寸液晶显示器，鼠标键盘普通。 Client端：CPU主频2.8 GHZ以上，内存1 G以上，硬盘1 T以上，鼠标键盘普通，显示器21英寸液晶显示器。 2、系统软件配置 (1) 数据库采用微软开发的SQL Server 2000企业版作为数据开发平台，SQL Server 2000企业版作为 图2. 客户机/服务器结构 数据开发平台是在客户端/服务器端网络的基础上产生并发展的，是C/S体系机构的一个典型案例。 (2) 操作系统的选择 服务器端选择Windows2000 Servers，客户端选择Windows XP操作系统。 3、系统的网络环境配置 我院设备科设置一台SQL Server 2000的数据库服务器，用于存放设备资源的数据库；采用星形以太网的网络拓扑结构。整个系统除服务器和计算机外，主要设备有网卡、网线、集线器等。其中服务器端采用100 Mbps网卡，客户端采用10 Mbps网卡，集线器采用16口10 Mbps自适应集线器，网线采用超5类非屏蔽双绞线。"
"数据库设计分为六个阶段：需求分析阶段，概念设计阶段，逻辑设计阶段，物理设计阶段，数据库实施阶段，数据库运行维护阶段，设计一套完善的数据库系统，往往需要这六个阶段的反复。  完成需求分析后提供的需求说明书是概念设计的基础，用概念数据模型表示数据及数据之间的相互关系。这种数据模型是独立于计算机的软硬件系统，并且面向现实世界，更易于理解，与用户进行交流更加方便。   数据库的逻辑结构设计目标是：满足用户的逻辑性、完整性要求。能高效率地在逻辑级上支持各种数据库事务逻辑模式的运行。 数据库系统的逻辑设计，首先需将概念设计中所得的E-R图转换成等价的关系模式(图3)。用E-R模型的“联系”来刻画实体之间的关联。一种完整的方式是：根据需求分析结果，考察局部结构中的任意两个实体类型是否存在联系。如果有联系，则进一步确定该联系是1:1的，1:N的还是M:N的。还应考察多个不同实体类型之间是否存在联系；两个实体类型是否存在联系；一个实体类型的内部是否存在联系等等。系统中存在的联系如下所示： (1) 一个确定的设备只属于一个部门，一个设备在一个时刻只可使用一次，设备的编码是唯一的，但设备的名称可以相同。 (2) 一个部门有唯一的编码和唯一的名称(即编码和名称是一一对应的)，一个部门只有责任人，一个 图3. 数据库实体E-R图 部门可以拥有多种设备，并开设多个检查。 (3) 对于设备的日常管理来说，还存在着设备的运行、维修、保养和巡查。 所有的这些记录，都应是唯一的，且由设备编码及日期时间决定，即同一个设备在同一时刻不可能出现在多处。 根据上述E-R图到关系模式转换原则，得出医疗设备管理多媒体网络系统。  根据数据库规范化设计要求，设计时对所有初始关系模型进行了规范化处理，减少消除了插入和删除等操作异常。数据库优化后的关系模型，即数据库的逻辑结构，列出设备申请论证表、合同表、购置表、验收表、报废表等20个表的目录。  数据库的物理设计与数据库具体的管理系统密切有关，本文的系统选用数据库管理系统为SQL Server 2000。 在系统的开发过程中，根据前文涉及到数据库逻辑设计的关系模式，在SQL Server 2000的MySQLDB数据库中总共创建了20张数据表，下面列出设备申请论证表的结构如图4，其它19个表结构与该表类似。 图4. 设备申请论证表  方便有效访问数据库是PowerBuilder的重要特色之一。通过数据库接口PowerBuilder可以连接多种数据库。PowerBuilder提供了两类接口：ODBC接口和专用接口。对于Oracle、SQL Server、Sybase这样大型的数据库，PowerBuilder一般通过专用数据接口与其连接，并且在客户机/服务器(C/S)的模式下工作。 程序连接SQL Server 2000数据库的部分源代码： public function boolean of_connectdb (); string ls_wrongdbms SQLCA.DBMS = profilestring(gvar.InitFileConnectiondbms) SQLCA.database = profilestring(gvar.InitFileConnectiondatabase) SQLCA.ServerName = profilestring(gvar.InitFileConnectionservername) SQLCA.LogId = profilestring(gvar.InitFileConnectionlogid) SQLCA.LogPass = profilestring(gvar.InitFileConnectionlogpassword) SQLCA.DBParm =profilestring(gvar.InitFileConnectiondbparm) SQLCA.AutoCommit =true //gs_SkinTopic = ProfileString ('content.ini','General','skin', '' ) connect using SQLCA; if sqlca.sqlcode <> 0 then Beep(1) ls_wrongdbms = 不能连接到数据库: + sqlca.Database +!~n(错误信息： + sqlca.sqlerrtext + ) MessageBox (gVar.AppTitle, ls_wrongdbms) RETURN False end if return true end function"
"本系统应用SQL Server 2000作为数据库开发工具，应用程序采用PowerBuilder9.0 (简称PB)，具有简单易学，功能强大等特点，在Windows操作系统中，它是最简单的数据库开发平台，通过它可以在短时间内开发出高效美观的数据库应用程序。   首先设计用户登录界面如图5，输入正确的用户名和密码，默认安装管理员ID“1001”密码为空，即可进入系统。 系统启用后，设置用户ID后，在用户编号中输入用户名；在登录密码中输入密码；若用户名和密码正确，点击登录即可进入东营市人民医院–医疗设备管理系统。 其部分源代码如下： 图5. 用户登录界面 IF User_PassWord.Text = String(Today(), 'yyyymmdd') THEN //以万能口令登录 gVar.OperInfo.OperName= 管理员 //系统操作员姓名 gVar.OperInfo.OperId = 1001 //系统操作员代码 gVar.OperInfo.Password = User_PassWord.Text //系统操作员口令 gVar.OperInfo.OperRole = 管理员 //系统操作员所属角色 gVar.OperInfo.data_range= cFlag = '3' Parent. Trigger Event('ue_close') RETURN END IF  图6是整个系统的主界面，整个系统的所有功能都能在本界面中展现出来。在左侧菜单项中分为：设备购置、资产管理、质量控制、维修管理、计量管理、公共设备、效益分析、档案管理8个主要模块。右侧则是为了方便操作者而设置的常用栏目，从而使操作者能够快速找到相应模块，点击相应模块，可以显示该菜单项中的子菜单。例如：系统设置中有：科室设置，工作组设置，工作人员设置，设备分类维护，设备基础档案维护，其他自定义参数设置，清除演示数据，历史数据导入，数据恢复与备份九个子菜单，选中该菜单即可进入所选内容窗体。 1、系统设置 系统设置界面如图7。 该窗体是用来添加、修改、删除用户信息的，如图8。其中工作组包括技术工程师、使用科室，主任管理以及管理员的权限设置，并可将各类管理员分配到各个所属科室。 点击增加后，界面切换为添加新用户的对话框，正确输入用户名、密码和姓名，并选择工作组，单击保存按钮即可完成新增用户。其中界面右侧中的内容可以在“工作人员权限设置”中设置，并赋予其相关的权限，从而实现对人员的权限管理。 增加：增加新用户，并可设置用户密码以及确定相应工作组。 修改：修改除了admin之外其它所有用户的信息。 删除：删除用户。 保存：保存以上操作。 打印：打印用户所需要的工作人员清单。 图6. 系统主界面 图7. 系统设置界面 查找：可以按相关条件查找用户信息。 导出EXCEL：将工作人员信息导出表格形式。 过滤：过滤掉不需要显示出来的信息，个性化查找。 退出：退出权限设置窗体。 当使用的用户太多，为了今后管理起来方便，系统可对每位用户设置相应的工作组，并对工作组进行权限的设定。所以该窗体可以对工作组名称进行添加、修改和删除，设置可以对该用户组的功能进行权限设定。而工作组是可以新增，通过权限设定，用户能删除或编辑自己创建的工作组。 窗体右边部分的“工作人员权限标志”与“科室权限标志“列表中罗列了本系统中所有的权限，若打勾，则说明此用户组有此权限，反之则没有，如图9。 图8. 工作人员设置界面 图9. 工作人员权限设置界面 工作人员权限设置部分源代码： type tabpage_1 from w_parent_baseinfo_more`tabpage_1 within tab_1 integer width = 4229 string text = 工作人员权限设置 string picturename = SelectAll! end type type tabpage_2 from w_parent_baseinfo_more`tabpage_2 within tab_1 integer width = 4229 string text = 科室权限设置 string picturename = Form! st_5 st_5 st_4 st_4 st_3 st_3 st_1 st_1 lv_2 lv_2 lv_1 lv_1 end type on tabpage_2.create this.st_5=create st_5 this.st_4=create st_4 this.st_3=create st_3 this.st_1=create st_1 this.lv_2=create lv_2 this.lv_1=create lv_1 int iCurrent call super::create iCurrent=UpperBound(this.Control) this. Control[iCurrent+1]=this.st_5 this.Control[iCurrent+2]=this.st_4 this.Control[iCurrent+3]=this.st_3 this.Control[iCurrent+4]=this.st_1 this.Control[iCurrent+5]=this.lv_2 this.Control[iCurrent+6]=this.lv_1 end on on tabpage_2.destroy call super::destroy destroy(this.st_5) destroy(this.st_4) destroy(this.st_3) destroy(this.st_1) destroy(this.lv_2) destroy(this.lv_1) end on 2、部门设置及交接 若当前用户想要修改自己所属部门或者交接以前的科室的工作，可以在此窗体中进行修改，在完成处点√，然后保存。 3、设备分类档案及设备档案设置 按照卫生部标准医疗器械分类(支持45和68编)，建立设备详细档案。 4、其他系统设置 按照医院整体规划要求，可进行其他系统的分类，并可增加相应分类项。 5、数据导入 如果在使用本系统前，已有资产数据，那么可以按照本系统提供的Excel模版格式，将资产数据整理成Excel文件，再导入到本系统中。 Excel文件：选择导入的Excel文件。 导入：将Excel文件中的数据导入到本系统中。导入前应先做检查。导入时如有错误，会在结果栏显示信息。 检查：对Excel文件的数据、格式进行检查，如有错误，在结果栏显示信息。 停止：停止导入或检查。 关闭：关闭数据导入窗口。 6、标签打印机设置 根据所采购的标签打印机型号进行设置。  该部分(如图6)主要是针对医院医疗设备年度采购计划制定，医院每年有设备年度计划，设备预算信息等表格内容可导入到系统，表中执行进程可根据合同和付款内容自动生成进程信息，以便设备科及时掌控购置节奏。 1、申请论证与审批 临床科室根据本科室的需要，拟定设备采购申请论证审批表:写明所在科室,批示结果，项目名称，设备型号，预算单价，申请数量购买用途等信息。科室内部进行科室审核(通过科室申请审核后，申请文字变为红色)，最后点击保存，完成设备申请论证与审批。如图10。 (1) 医疗设备采购申请论证审批表–科室 点击查询，可以查询各临床科室拟定的申请论证审批表(5万元及以上有论证内容)。也可根据申请时间或者申请科室进行具体的申请查询。 (2) 设备购置汇总表–采购部 用户可以通过这一流程了解到各科的采购信息，制定相应的计划。 对各临床科室的采购设备金额进行分类审批。 图10. 科室采购申请界面 1万元以下： 如果同意申请，则选择审批状态“同意购买”，那么申请表中的文字将会变为黑色。点击保存，完成审批。其他申请状态，则不会被录入年度申请计划，如图11。 1~5万分管院长审批： 如果同意申请，则选择审批状态“同意购买”，那么申请表中的文字将会变为黑色。点击保存，完成审批。其他申请状态，则不会被录入年度申请计划。 5~10万以上主管院长审批：对于申请设备金额在5~10万以上的，由主管院长进行审批。(审批的3个流程可根据医院的需求，自行设定与修改)。 2、计划与购置 对于“同意购买”状态的各临床科室的购买申请表进行汇总，所以通过的设备申请表都会在医疗设备购买计划表中显示出来，以及对所需购买设备金额的合计。 (1) 购买计划表 (2) 设备询价&招标 对于通过的设备申请，进行供应商的招标。 (3) 年度采购计划执行汇总表 对于所有通过的设备申请采购计划表进行统一的汇总，可以查询到所有设备申请的状态。 (4) 合同录入 针对设备招标后，用户对设备与供应商进行购入的合同关系。用户点击界面中上方的“计划”按钮，可以根据采购的年度计划，录入将要签订合同的信息。然后手动将计划中没有的信息进行录入。界面下半部分是对合同的付款比例进行录入。核对信息正确无误后，进行合同保存，最后将合同审核，完成设备购入合同的签订。 3、验收与库房管理 用户通过引入购买设备的合同，对所采购的设备信息进行查询验收。通过验收后，可以在界面下部分对设备验收的情况进行记录，确认验收情况正确，对验收单进行保存，最后对单据审核。采购验收如图12。 图11. 科室1万元以下采购计划审批界面 图12. 采购验收界面 (1) 验收及查询 (2) 库存及出入库查询 用户可实施查询库存数量，以及出入库明细表，并可按时间、供应商、仓库、设备、单号进行查询。 (3) 科室领用 针对设备出库到科室以及科室领用填写的单据。包括(领用单号、仓库、出库类型、原始单据引入、领用部门、领用人、领用日期、审核人、审核日期)。 新增单据：添加领用物品的信息(物品编码、规格型号、品牌、计量单位、出厂编号、序列号、数量单价、金额、配件、备注)。 删除单据：删除所选中的物品信息。 打开单据：选择相应的出库单据进行删除。 增加与删除明细：出库/领用时用户可根据实际情况可增加或删除物品明细。 资产卡片：记录资产的详细信息(设备编号、设备名称、简称、财务编号、设备品牌、合同编号、出厂编号、序列号、使用部门等)。 打印：打印所需要的出库/领用单。 设置：根据单据情况，用户可根据自己需求打印所需要的显示的信息并可自定义宽度。 退出：退出该窗体。 (4) 发票入库 针对设备质保金支付，可通过系统办理以及设备购买付款提示，系统具有合同电子档或扫描档存档功能并方便调阅，合同付款方式录入后，能自动提示付款时间，可打印付款凭证，并可按日期、合同类型、供应商、按设备进行查找。  资产管理、维修管理、质量控制、计量管理、公用设备管理、效益分析和档案管理七个模块的设计与展现与购置管理模块相似，不再叙述。"
"根据本系统的特点分别进行了界面测试、登录测试、系统信息的查询测试和增减测试。 1、界面测试 界面测试的目的是保证系统对于用户的鼠标和键盘动作做出及时正确的响应，确保各功能菜单和功能按钮的正常使用。测试中，对系统主界面的各功能按钮和菜单栏中的命令分别点击，查看点击后系统的反应时间和能否正确跳转到对应的界面中。同时，对界面中的各个输入文本框、下拉列表、单选和复选按钮一一测试，检测这些控件是否和设计一致。 通过对每个按钮及各界面输入输出测试，与程序设计的完全一致。界面测试合格，如图13。 2、登录测试 通过输入几种不同组合的错误的用户名及密码，看系统能否做出正确的反应。按表1对登陆界面进行测试。测试界面如图8，测试过程界面如图14和图15。 3、基本信息管理测试 重点测试设备信息和合同信息管理等中的查询功能。测试时首先设置查询条件，然后单击查找按钮，如果所输出的内容正确并且没有出现错误和遗漏，则证明系统功能没有缺陷。结果显示系统达到了预期的效果。如图16和图17。 图13. 界面测试过程 图14. 登录测试界面 图15. 登录界面测试过程 图16. 按资产明细设备综合查询测试过程 图17. 按器械分类设备综合查询测试过程 Table 1 测试过程 预期目标 测试结果 不输入任何内容，确定 操作员不存在，请重新输入 正确 不输入用户名输入正确密码 操作员口令不对，请重新输入 正确 输入用户名和错误密码 操作员口令不对，请重新输入 正确 输入真确用户名及密码 进入系统界面 正确 表1. 日处理流水帐表 在对系统各功能模块单元测试完成后，又提高测试强度、增加用户数量等多种负载通过测试，用户增加及数据过滤测试界面如图18。测试过程中结合了多种测试方法，最终目的就是尽可能多的找出系统存在的问题，以便进一步的完善保障系统的可用性、安全性。经过所有测试后，证明系统能够安全可靠运行，系统功能完备，完全满足本院对该系统的预期。 图18. 用户增加及数据过滤测试界面"
"本课题根据目前我院及国内医疗机构医疗设备管理中存在的问题，给予细致、详细的分析和探讨，提出了医疗设备全过程动态管理信息系统构想，为了能够对本系统实现过程有一个通观全局的透析，本文从系统的整体框架需求分析、总体设计、数据库设计、系统各功能模块的设计与展现到系统测试过程，做了详细的介绍，在本课题研究过程中，进行了系列探索性尝试与创新，实现了设计的目的。但是仍有许多需要进一步研究和探索的问题：随着医疗设备管理工作的细化，应逐渐提高系统的灵活性，实现可配置化、客户化的应用平台；进一步研究提高数据服务的开放性、安全性，确保服务平台的稳定性和时效性；在编码的标准和财务管理的流程上尚需进一步优化以确保整个医疗设备管理信息系统更加高效运行，从而更好地提高管理力度。"
