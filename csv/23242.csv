"对于一般的分位数回归模型，基于非对称拉普拉斯分布提出了关于有序数据的贝叶斯推理框架。指出了非对称分布的尺度参数在估计中应该被参数化。给出选择尺度参数与模型参数的先验分布的条件，其后验分布是真实概率分布，并采用吉布斯抽样法与马尔卡夫蒙特卡洛模拟方法进行参数估计。 关键词 :贝叶斯推断，分位数回归，有序数据，非对称拉普拉斯分布，吉布斯抽样 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"1978年，Koenker and Bassett [ 1 ] 首次提出了用分位数回归方法来描述因变量的条件分位数与自变量之间的关系。分位数回归的提出引起了广泛的关注。分位数回归被广泛应用于农业、基因芯片技术、生存研究、经济学、医疗卫生、环境科学等领域。 在分位数回归估计中，算法的实现起着至关重要的作用。分位数回归模型估计方法中较经典的方法有Yu和Moyeed在2001年提出的单纯形法和内点法。其他的估计方法还有参数化方法和非参数方法。 有序数据在对事物分类的同时给出了各类的顺序，其数据仍表现为“类别”，但各类之间是有序的，可以比较优劣但其数值的大小差值却无意义。 在大多数研究领域中都会用到有序数据。目前已有大量的文献对有序数据进行了研究，但是用贝叶斯方法对有序数据进行分析目前还鲜少有人提及。"
"对于一个随机变量x，如果它服从参数为 ( μ , σ , p ) 的非对称拉普拉斯分布(Asymmetric Laplace distribution, ALD)，那么其密度函数可以写为 f ( x ; μ , σ , p ) = p ( 1 − p ) p exp { − x − μ σ ( p − 1 { x ≤ μ } ) } ,     x ∈ R (1) 其中 为位置参数， σ > 0 为尺度参数， 0 < p < 1 为偏度参数。 引理 如果随机变量 ξ ∼ A L D ( μ , σ , p ) 则其方差 Var ( ξ ) = Ψ ( σ , p ) ≥ 8 σ 2 。 证明 由于 E ( x ) = ∫ − ∞ ∞ x f ( x ; μ , σ , p ) d x = μ + σ 1 − 2 p p ( 1 − p ) 且 Ψ ( σ , p ) = ∫ − ∞ ∞ ( x − E ( ξ ) ) 2 f ( x ; μ , σ , p ) d x = σ 2 1 − 2 p + 2 p 2 p 2 ( 1 − p ) 2 . 根据函数 g ( p ) = 1 − 2 p + 2 p 2 p 2 ( 1 − p ) 2 = 1 p 2 + 1 ( 1 − p ) 2 其中 p ∈ ( 0 , 1 ) ，经计算可得 min p ∈ [ 0 , 1 ] g ( p ) = g ( 1 2 ) = 8 证毕。 如果随机变量 ξ ∼ A L D ( μ , σ , p ) ，则其分位数函数(分布函数的逆函数)为 F − 1 ( x ; μ , σ , p ) = { μ + σ 1 − p log x p , if   0 ≤ x ≤ p μ − σ p log 1 − x 1 − p , if   p < x ≤ 1 (2) 从上式中可以的到一个很重要的性质： F − 1 ( x ; μ , σ , p ) | x = p = μ (3) 即服从非对称拉普拉斯分布的随机变量在概率 p 处的分位数等于位置参数 μ 。 设 服从如下的线性回归模型， r t = Q p ( r t | x t , β ) + u t ,   t = 1 , 2 , ⋯ , n (4) 式中 Q p ( r t | x t , β ) 是在观测到 x t 的条件下， r t 在 p 概率水平下的分位数， β 是参数向量，误差项 { u t , t = 1 , 2 , ⋯ , n } 相互独立且服从非对称拉普拉斯分布，即 u t ∼ A L D ( 0 , σ , p ) 。依据非对称拉普拉斯分布的 线性变换性质，式(4)可以等价表示为 r t ~ A L D ( Q p ( r t | x t , β ) , σ , p ) 故 r t 的密度函数为： f ( r t ; Q p ( r t | x t , β ) , σ , p ) = p ( 1 − p ) p exp { − Q p ( r t | x t , β ) σ [ p − I ( r t ≤ Q p ( r t | x t , β ) ) ] } (5) t = 1 , 2 , ⋯ , n 。样本的似然函数可以表示为 L ( r | β , σ ) = p n ( 1 − p ) n σ n exp [ − 1 σ ∑ t = 1 n ρ p ( r t − Q p ( r t | x t , β ) ) ] (6) 其中 ρ p 为损失函数 ρ p ( u ) = u ( p − I ( u < 0 ) ) > 0 . 设参数 β 和 σ 相互独立，其先验密度分别为 f ( β ) 和 f ( σ ) 。根据贝叶斯定理，参数 β , σ 的联合后验密度为 π ( β , σ | r ) ∝ L ( r | β , σ ) f ( β ) f ( σ ) (7) 在已知的文献中，如Yu等 [ 2 ] ，在估计过程中将尺度参数设定为常数1。但在实际应用中，将尺度参数设为常数缺有欠妥当。若尺度参数定为常数1，则随机变量的方差将不小8。在实际的数据研究中这个约束条件的存在并不合理。事实上，尺度参数的存在使得服从非对称拉普拉斯分布的随机变量的方差能取任意正值。尺度参数影响了参数估计的质量，在实际的应用当中，它应该被当为待估参数去处理，而不是主观地被设为某个常数。 对于分位数回归中的参数，它们不存在标准的共轭先验分布。这导致在贝叶斯推理中获取参数的后验分布解析表达式有一定的困难。若选择的参数的先验分布能确保参数的后验分布为真实分布，我们就可以利用MCMC 模拟得到参数的估计。 在Yu的研究中 [ 2 ] ，尺度参数为常数时，参数 β 的先验分布是非真实均匀分布，得到的联合后验分布为真实分布。考虑到尺度参数的参数化，在无信息的前提下，参数的先验分布存在很多种可能，而被选择的先验分布可能会是非真实的分布。在这种情况下，参数 σ 与 β 满足什么条件会使得后验联合分布为真实分布。这对贝叶斯推理是很重要的一环。而下面的定理就可以保证后验分布是真实分布。 定理 对于任意 σ > 0 ，参数的似然函数由式(6)给出， β 和 σ 的先验密度分别为 f ( β ) 和 f ( σ ) 。若 β 服从不真实均匀分布， f ( σ ) 满足 ∫ 0 ∞ f ( σ ) 1 σ n d σ < ∞ 则参数的联合后验分布 π ( β , σ | r ) 是一个真实分布，即满足条件 0 < ∫ − ∞ ∞ ∫ 0 ∞ π ( β , σ | r ) d β d σ < ∞ 证明 根据式(6)与(7)有 π ( β , σ | r ) ∝ L ( r | β , σ ) f ( β ) f ( σ ) = f ( β ) f ( σ ) p n ( 1 − p ) n σ n [ − 1 σ ∑ t = 1 n     ρ p ( r t − Q p ( r t | x t , β ) ) ] 可以推知 0 < exp [ − 1 σ ∑ t = 1 n     ρ p ( r t − Q p ( r t | x t , β ) ) ] < 1 ,     0 < ∫ 0 ∞ f ( σ ) 1 σ n d σ < ∞ , 于是 0 < L ( r | β , σ ) f ( β ) f ( σ ) < f ( β ) f ( σ ) p n ( 1 − p ) n σ n 非真实先验分布是在贝叶斯推断中在无信息先验情况下常采用的一种先验分布形式，参数 β 服从非真实先验分布，则其概率密度的积分是无穷大的 [ 3 ] ，即 ∫ − ∞ ∞ f ( β ) d β = ∞ 可得 0 = ∫ − ∞ ∞ ∫ 0 ∞ 0 d β d σ < ∫ − ∞ ∞ ∫ 0 ∞ L ( r | β , σ ) f ( β ) f ( σ ) d β d σ = ∏ i = 1 n ∏ k = 1 K [ F A L ( γ p , j − x ′ i β p σ ) − F A L ( γ p , j − 1 − x ′ i β p σ ) ] I ( y i = k ) = p n ( 1 − p ) n ∫ − ∞ ∞ f ( β ) d β ∫ 0 ∞ f ( σ ) 1 σ n d σ = ∞ 因此 0 < ∫ − ∞ ∞ ∫ 0 ∞ π ( β , σ | r ) d β d σ < ∞ 证毕。"
"有序数据的分位数回归模型能够用连续的潜变量 t i 来表示 t i = x ′ i β p + ϵ i ,   i = 1 , ⋯ , n (8) 其中， x i 是 j 维的协向量， β p 是 j 维的未知参数向量，误差项 ϵ i ∼ A L D ( 0 , 1 , p ) 。 n 表示观测值的个数。潜变量与我们观测到的响应变量 y i 存在一定的关系，且响应变量有 K 个指标。我们用割点向量 γ p 来反应 t i 和 y i 的关系： γ p , k − 1 < t i < γ p , k ⇒ y i = k ,     i = 1 , ⋯ , n ;   k = 1 , ⋯ , K 其中 γ p , 0 = − ∞ ， γ p , K = ∞ 。一般而言 γ p , 1 常被设定为0 [ 4 ] 。对于给定的数据 y = ( y 1 , ⋯ , y n ) ′ ，模型的似然函数能够用包含有未知参数 ( β p , γ p , σ ) 的函数表示 f ( β p , γ p , σ ; y ) = ∏ i = 1 n ∏ k = 1 K P ( y i = k | β p , γ p , σ ) I ( y i = k ) = ∏ i = 1 n ∏ k = 1 K [ F A L ( γ p , j − x ′ i β p σ ) − F A L ( γ p , j − 1 − x ′ i β p σ ) ] I ( y i = k ) 其中 F A L ( ⋅ ) 表示非对称拉普拉斯分布的分布函数。 I ( y i = k ) 为示性函数。 为了在分位数回归中得到吉布斯算法，关于非对称拉普拉斯分布，Kozumi和Kobayashi在2011年 [ 5 ] 给出了一个基于指数分布和正态分布的混合表达式。若 ϵ i ∼ A L D ( 0 , 1 , p ) ，则有 ϵ i = θ ω i + τ ω i u i ,     i = 1 , ⋯ , n (9) 其中 ω i 和 u i 相互独立， u i ∼ N ( 0 , 1 ) ， ω i ∼ E ( 1 ) ， E 表示指数分布。式(9)中的常数项 ( θ , τ ) 为 θ = 1 − 2 p p ( 1 − p ) ,     τ = 2 p ( 1 − p ) . 非对称拉普拉斯分布的混合表达式使得在研究过程中，可以直接利用正态分布的性质。而这将对有序数据分位数回归模型的分析起到重大的作用。 贝叶斯方法来估计分位数回归模型运用到了潜变量表达式 (8)与非对称拉普拉斯分布的混合表达式(9)， p 分位回归模型能够表示为 t i = x ′ i β p + θ ω i + τ ω i u i ,     i = 1 , ⋯ , n (10) 上式中可以看出潜变量的条件分布服从正态分布，即 t i | β p , ω i ∼ N ( x ′ i β p + θ ω i , τ 2 ω i ) 。这使得我们在估计 过程当中，能够利用正态分布的性质来进行研究。 考虑结果拥有三个指标的情况，回归模型能够用下式表示 { t i = x ′ i β p + σ p ϵ i = x ′ i β p + θ ω i + τ ω i u i ,     i = 1 , ⋯ , n γ k − 1 < t i ≤ γ k y i = k ,                                                               i = 1 , ⋯ , n (11) 其中 σ p 是 p 分位水平下的尺度参数，割点向量 ( γ 0 , γ 1 , γ 2 , γ 3 ) 满足条件 γ 0 = − ∞ , γ 3 = ∞ ，且 γ 1 , γ 2 为某固定常值。 对于回归模型(11)，潜变量 t i 的条件期望包含了尺度参数 σ p ，这导致模型不能直接利用吉布斯抽样方法进行估计，但对模型进行简单的变形之后就能消除尺度参数的影响从而能利用吉布斯抽样方法来进行估计。模型(11) 能表示为 t i = x ′ i β p + θ ν i + τ σ p ν i u i (12) 其中 ν i = σ p ω i ，因此潜变量的条件分布服从正态分布，即 t i | β p , σ p , ν i ∼ N ( x ′ i β p + θ ν i , τ 2 σ p ν i ) 。接下来， 就是要设定参数的先验分布来获得参数的后验分布。设定参数的先验分布为： { β p ∼ N ( β p 0 , B p 0 ) σ p ∼ I G ( n 0 / 2 , d 0 / 2 ) ν i ∼ E ( σ p ) 其中 I G 和 E 分别表示逆伽玛分布与指数分布。通过贝叶斯定理，参数 ( t , β p , ν , σ p ) 的联合后验密度为： π ( t , β p , ν , σ p | y ) ∝ f ( y | t , β p , ν , σ p ) π ( t | β p , ν , σ p ) π ( ν | σ p ) π ( β p ) π ( σ p ) ∝ { ∏ i = 1 n f ( y i | t i , σ p ) } π ( t | β p , ν , σ p ) π ( ν | σ p ) π ( β p ) π ( σ p ) . 当切割点与潜变量已知的情况下，观测值 y i 不依赖于 ( β p , ν ) ，根据式(12)，潜变量 t i 的条件密度 π ( t | β p , ν , σ p ) 满足 π ( t | β p , ν , σ p ) = ∏ i = 1 n N ( x ′ i β p + θ ν i , τ 2 σ p ν i ) 。待估参数的后验密度为 π ( t , β p , ν , σ p | y ) ∝ { ∏ i = 1 n ∏ k = 1 3     I ( γ k − 1 < t i ≤ γ k ) N ( t i | x ′ i β p + θ ν i , τ 2 σ p ν i ) E ( ν i | σ p ) }     × N ( β p 0 , B p 0 ) I G ( n 0 / 2 , d 0 / 2 ) , 据此，我们就能根据后验密度来导出我们感兴趣的参数的条件后验密度。 β p 的条件后验密度 π ( β p | t , σ p , ν ) 正比于 π ( β p ) × f ( t | β p , σ p , ν ) π ( β p | t , σ p , ν ) ∝ exp [ − 1 2 { ∑ i = 1 n ( t i − x ′ i β p − θ ν i τ σ p ν i ) 2 + ( β p − β p 0 ) ′ B p 0 − 1 ( β p − β p 0 ) } ] = exp [ − 1 2 { β ′ p ( ∑ i = 1 n x i x ′ i τ 2 σ p ν i ) β p − β ′ p ( ∑ i = 1 n x i ( t i − θ ν i ) τ 2 σ p ν i ) − ( ∑ i = 1 n x ′ i ( t i − θ ν i ) τ 2 σ p ν i )     + ( ∑ i = 1 n ( t i − θ ν i ) 2 τ 2 σ p ν i ) + ( β p − β p 0 ) ′ B p 0 − 1 ( β p − β p 0 ) } ] ∝ exp [ − 1 2 { β ′ p ( ∑ i = 1 n x i x ′ i τ 2 σ p ν i + B p 0 − 1 ) β p − β ′ p ( ∑ i = 1 n x i ( t i − θ ν i ) τ 2 σ p ν i + B p 0 − 1 )     − ( ∑ i = 1 n x ′ i ( t i − θ ν i ) τ 2 σ p ν i + β ′ p B p 0 − 1 ) β p } ] 设 B ˜ p − 1 = ( ∑ i = 1 n x i x ′ i τ 2 σ p ν i + B p 0 − 1 ) ， β ˜ p = B ˜ p ( ∑ i = 1 n x i ( t i − θ ν i ) τ 2 σ p ν i + B p 0 − 1 β p 0 ) 则有 π ( β p | t , σ p , ν ) ∝ exp [ − 1 2 { β ′ p B ˜ p − 1 β p − β ′ p B ˜ p − 1 β ˜ p − β ′ ˜ p B ˜ p − 1 β p } ] 经过简单的变形有 π ( β p | t , σ p , ν ) ∝ exp [ − 1 2 { β ′ p B ˜ p − 1 β p − β ′ p B ˜ p − 1 β ˜ p − β ˜ ′ p B ˜ p − 1 β p + β ˜ ′ p B ˜ p − 1 β ˜ p − β ˜ ′ p B ˜ p − 1 β ˜ p } ] 因此 π ( β p | t , σ p , ν ) ∝ exp [ − 1 2 { ( β p − β ˜ p ) ′ B ˜ p − 1 ( β p − β ˜ p ) } ] 结果表明， β p 的条件后验分布为正态分布，即 β p | t , σ p , ν ∼ N ( β ˜ p , B ˜ p ) 。 尺度参数 σ p 的条件后验密度 π ( σ p | t , β p , ν ) 正比于 f ( t | β p , ν , σ p ) π ( ν | σ p ) π ( σ p ) π ( σ p | t , β p , ν ) ∝ ∏ i = 1 n { σ p − 1 / 2 exp [ − 1 2 ( t i − x ′ i β p − θ ν i τ σ p ν i ) 2 ] × σ p − 1 exp ( − ν i σ p ) } exp [ − d 0 2 σ p ] σ p − ( n 0 2 + 1 ) ∝ σ p − ( n 0 2 + + 3 n 2 + 1 ) exp [ − 1 σ p { ∑ i = 1 n ( t i − x ′ i β p − θ ν i ) 2 2 τ 2 ν i + d 0 2 + ∑ i = 1 n     ν i } ] 其中 n ˜ = n 0 + 3 n ， d ˜ = ∑ i = 1 n ( t i − x ′ i β − θ ν i ) 2 / τ 2 ν i + d 0 + 2 ∑ i = 1 n   ν i 。 σ p 的条件后验分布为逆伽玛分布即 σ p | t , β p , ν ∼ I G ( n ˜ / 2 , d ˜ / 2 ) 。 ν 的条件后验密度 π ( ν | t , β p , σ p ) 正比于 f ( t | β p , ν , σ p ) π ( ν ) 且 ν i 有如下形式 π ( ν i | w , β p , σ p ) ∝ ν i − 1 / 2 exp [ − 1 2 ( w i − x ′ i β p − θ ν i τ σ p ν i ) 2 − ν i σ p ] ∝ ν i − 1 / 2 exp [ − 1 2 σ p ( ( w i − x ′ i β p ) 2 + θ 2 ν i 2 − 2 θ ν i ( t i − x ′ i β p ) τ 2 ν i + 2 ν i ) ] = ν i − 1 / 2 exp [ − 1 2 { ( t i − x ′ i β p ) 2 τ 2 σ p ν i − 1 + ( θ 2 τ 2 σ p + 2 σ p ) ν i − 2 θ ( t i − x ′ i β p ) τ 2 σ p } ] ∝ ν i − 1 / 2 exp [ − 1 2 { ( t i − x ′ i β p ) 2 τ 2 σ p ν i − 1 + ( θ 2 τ 2 σ p + 2 σ p ) ν i } ] 设 λ ˜ i = ( t i − x ′ i β p ) 2 τ 2 σ p ， η ˜ = ( θ 2 τ 2 σ p + 2 σ p ) 则有 π ( ν i | t , β p , σ p ) ∝ ν i − 1 / 2 exp [ − 1 2 { λ ˜ i ν i − 1 + η ˜ ν i } ] ν i 的条件后验分布为广义逆伽玛分布，即 ν i | t , β p , σ p ∼ G I G ( 0.5 , λ ˜ i , η ˜ ) 。"
"我们从如下模型获得观测值 { Y i = β 0 + β 1 x + ν ,     i = 1 , 2 , ⋯ , n , x ∼ u n i f ( 0 , 10 ) , β 0 = 1 ,     β 1 = 2. β 0 与 β 1 的先验分布为 N ( 0 , 10 ) ，尺度参数 σ 的先验分布设定自由度为3的卡方分布。采用Gibbs抽样法共模拟5000次，为消除初值对抽样分布的影响，去掉前2000个抽样值。在应用Gibbs抽样算法对参数进行抽样时，特定参数的Gibbs模拟值是否是真实后验分布的合理近似，这对参数估计值的正确性意义重大，因此在统计推断之前需要对抽样分布进行检验。 图1给出了样本容量为100时， β 0 ， β 1 和 σ 在0.5分位点下的MCMC抽样值轨迹和核密度图。图中显示三个参数的3000个抽样值序列在某一个值的上下波动，因此抽样构成的马尔科夫链收敛 图2给出了样本容量为100时， β 0 ， β 1 和 σ 在0.5分位点下抽样值的自相关图。从图中可以看出随着滞后期的增加，自相关系数趋向于零。 综上，马尔科夫链收敛且自相关系数趋于零，所以在样本容量为100，各参数的贝叶斯中位数回归估计结果是可靠的。其他样本容量和分位点下的马尔科夫链均收敛，自相关系数也趋于零。表1和表2给出了不同样本容量下得到的MCMC参数估计结果。 在表1和表2中。比较 β 0 ， β 1 和 σ 参数化与未参数化下的估计结果，可以发现在一定的样本容量，特定的分位点下，当 σ 被参数化时， β 0 和 β 1 的抽样标准差均小于 σ 未参数化是各自的标准差。这表明尺度参数的参数化可以提高被估系数的精确度，从而提高待估系数假设检验的准确性。因此在用Gibbs抽样方法进行贝叶斯分位数回归估计是应该将尺度参数参数化，而不是设定为常数。此外，还可以发现， 图1. β 0 , β 1 , σ 的MCMC抽样值轨迹和核密度图 图2. β 0 , β 1 , σ 抽样值的自相关图 Table 1 样本容量 σ 未参数化 σ 参数化 β 0 ( 0.25 ) β 0 ( 0.5 ) β 0 ( 0.75 ) β 0 ( 0.25 ) β 0 ( 0.5 ) β 0 ( 0.75 ) −0.388 0.583 1.223 −0.388 0.583 1.223 25 0.335 0.253 0.687 0.377 0.230 1.134 0.281 0.267 0.282 0.221 0.227 0.224 0.256 0.889 1.871 0.256 0.889 1.871 75 0.333 0.730 0.901 0.342 1.026 1.227 0.249 0.271 0.225 0.171 0.233 0.148 0.304 1.223 1.595 0.304 1.233 1.595 100 0.212 0.760 1.018 0.097 0.878 1.427 0.291 0.202 0.235 0.139 0.166 0.134 0.263 1.036 1.742 0.263 1.036 1.742 500 0.233 0.751 1.460 0.209 0.792 1.648 0.133 0.132 0.139 0.083 0.089 0.095 表1. β 0 在不同分位数水平下的估计量 Table 2 样本容量 σ 未参数化 σ 参数化 β 1 ( 0.25 ) β 1 ( 0.5 ) β 1 ( 0.75 ) β 1 ( 0.25 ) β 1 ( 0.5 ) β 1 ( 0.75 ) 2.000 2.000 2.000 2.000 2.000 2.000 25 1.718 2.025 2.036 1.832 2.045 1.989 0.134 0.051 0.069 0.045 0.040 0.046 2.000 2.000 2.000 2.000 2.000 2.000 50 1.939 1.982 2.138 1.962 1.958 2.101 0.057 0.048 0.045 0.034 0.038 0.028 2.000 2.000 2.000 2.000 2.000 2.000 75 2.000 2.042 2.068 2.035 2.040 2.017 0.052 0.040 0.044 0.033 0.028 0.027 2.000 2.000 2.000 2.000 2.000 2.000 1000 2.004 2.044 2.036 2.011 2.041 2.010 0.024 0.022 0.026 0.015 0.015 0.016 表2. β 1 在不同分位数水平下的估计量 注：给定样本容量，未参数化和参数化情形下的数字特征中，第一行表示参数的真值，第二行和第三行数值分别表示参数估计量分布的均值和标准差。 在给定样本容量的情况下，无论 σ 是否参数化， β 1 的标准差总是小于同一分位数水平下 β 0 的标准差。对于 β 1 ，无论尺度参数是否被参数化，它的精度都随着样本量的增加而提高。"
