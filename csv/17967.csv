"本文提出了一种基于离散余弦变换与Wallis的人脸光照处理算法，该算法首先将人脸图像变换到对数域，在对数域中计算离散余弦变换(DCT)，舍弃部分低频DCT系数，再计算其离散余弦反变换。然后用Wallis算法对人脸图像的高频部分进行增强。在人脸识别阶段，采用主成分分析法(PCA)提取人脸特征，运用基于余弦距离的最近邻分类器进行分类判别。在Yale B正面人脸库中的实验结果表明，本文提出的方法可以削弱人脸光照的影响，合理选择相关参数，人脸识别率能达到好的效果。 关键词 :人脸光照处理，离散余弦变换，Wallis算法，人脸识别"
"光照问题，是人脸识别中面临的主要问题 [ 1 ] - [ 3 ] 。同一人脸因光照变化引起的差异大于不同人脸在相同条件下的差异，针对这个问题提出了许多的人脸光照处理算法，这些算法主要分为三类 [ 4 ] ：提取光照不变特征的方法、预处理和光照归一化的方法、人脸建模的方法。提取光照不变特征方法的原理是提取人脸图像中光照不敏感特征进行人脸判别。例如：Mohsen [ 5 ] 等提出SQI和局部权重二值模式相结合的光照不变性的人脸识别算法，该算法注重人脸图像的局部信息，避免了只考虑全局人脸图像而忽视了局部细节信息。Ramaiah [ 6 ] 等提出利用卷积神经网络进行人脸识别，运用人脸样本训练自动生成神经网络，进行人脸分类，但该方法需要在大样本集上训练以及测试，同时卷积神经网络的训练较复杂，很难把握卷积层和采样层的层数选择。Shermina [ 7 ] 等融合离散余弦变换与主成分分析法的光照不变性人脸识别系统，提取人脸光照不敏感特征。预处理和光照归一化的方法主要应用于人脸图像的预处理阶段，该方法在不使用任何人脸模型与表面信息的条件下改善人脸光照条件。主要方法有直方图均衡、伽玛矫正、对数变换等。该类方法在一定程度上削弱了光照变化对人脸识别的影响，但很难恢复局部阴影区域的人脸特征，特别是对人脸识别具有重要作用的人脸细节特征区域。人脸建模方法的基本原理是在空间的一些适当的子空间或流形去学习人脸图像光照条件变化的程度,如子空间投影法 [ 8 ] 、光照锥法 [ 9 ] 、curvelet局部特征 [ 10 ] 等。这类方法需要大量不同光照条件下的人脸图像作为训练样本，因此在实际应用中受到一定的限制。 本文提出了一种基于离散余弦变换与Wallis变换的人脸光照处理算法。光照处理流程框图如图1所示，首先将人脸图像变换到对数域，计算人脸图像的离散余弦变换，舍弃部分低频系数，离散余弦反变换后用Wallis算法增强人脸图像的高频成分。本文方法主要将人脸图像的高频成分作为人脸识别的重要元素，其光照处理的效果由识别率表征。"
"于任意图像 ，可以看成是反射分量 和光照分量 的乘积 [ 11 ] ： (1) 图1. 人脸图像光照处理流程框图 其中， 对应图像的快变化部分， 对应图像的慢变化部分。对式(1)两边取对数，得： (2) 从式(1)和式(2)可以看出，对于时间域的人脸图像，反射分量 与光照分量 是相乘的关系，而在对数域中却变成了相加的关系。所以在对数域中对人脸图像进行光照处理即是在对数域中减去光照分量，类似于对图像进行高通滤波。  对于图像而言，其2维DCT [ 12 ] 定义如下： (3) 反变换定义如下： (4) 其中 是图像的大小， 和 式图像时间域的坐标， 和 对应 系数坐标。 在式(3)中，当 和 都等于0时，则是(3)可以写为： (5) 变换后， 就是直流系数 位于 块DCT系数的左上角，其余的 个系数的能量分布按Z字型方式依次递减。在本文的实验中，离散余弦变换后，保留直流分量，其余系数从低频到高频按照Z字型方式逐个舍弃。  图像进行Wallis变换时，考虑到人眼的视觉特性中包含对数环节，因此在图像锐化时，首先进行对数变换，可以对暗区的细节进行较好的处理。其计算公式为： (6) 其中 ， 对应原图像， 对应Wallis变换后的图像。 对应以10为底的对数函数。 在图像进行Wallis变换时，同时应注意： 1) 为了防止对0取对数，计算时应为 ； 2) 因为对数值很小( )，所以计算时用 。其中 ；"
"本文采用Yale B正面人脸库进行实验，该数据库共包含10个人的9种不同姿态，每种姿态又包含64种不同的光照情况。因为本文只研究光照处理的问题，所以实验中只使用正面姿态的人脸图像。人脸图像的尺寸是 ，将所有图像按照入射光的不同角度分为5个子集。 1) 子集1，角度小于12度(共70个样本)。 2) 子集2，角度位于13~25度之间(共120个样本)。 3) 子集3，角度位于26~50度之间(共120个样本)。 4) 子集4，角度位于51~77度之间(共140个样本)。 5) 子集5，角度大于77度(共190个样本)。 人脸光照处理后，规范化其均值和方差分别为0和1，利用主成分分析法(PCA)提取人脸特征(特征向量数 为50)，使用基于余弦距离的最近邻分类器进行分类判别。  在Yale B正面人脸库中的实验结果如图2所示。图2显示的是人脸光照处理后的效果对比图，其中(a)列是原图，(b)列是经离散余弦变换单独处理后的人脸图像，(c)列是经Wallis变换单独处理后的人脸图像。(d)列是经本文所提方法处理后的人脸图像。从图2中可以看出，经本文方法处理后的人脸图像，其灰度范围得到很大的调整，对于极端光照的处理效果尤其明显。光照处理完成后，人脸图像不仅保留了重要的人脸识别特征，而且其特征更加明显，如人脸鼻子、嘴巴、眼睛等纹理特征、位置、大小、轮廓等。因此从本文方法光照处理后的人脸图像清晰度可以看出，该光照处理方法对光照具有很好的鲁棒性。  表1中列出了不同YaleB人脸库子集的图像作为训练样本时的最小人脸错误识别率。从表1中可以看出，子集1作为训练样本，DCT舍弃系数个数为15时，平均错误识别率为0.53%。子集2作为训练样本，DCT舍弃系数个数为17时，平均错误识别率为0.19%。子集3作为训练样本，DCT舍弃系数个数为10时，平均错误识别率为0.19%。子集4作为训练样本，DCT舍弃系数个数为16时，平均错误识别率为0。子集5作为训练样本，DCT舍弃系数个数为18时，平均错误识别率为1.33%。从所有子集作为训练集的平均识别率中可以看出，除了子集5的平均识别率稍低，其他子集的识别率都能够达到99%以上，其中子集4作为训练集时，平均识别率达到100%。从子集4和子集5作训练集时的平均识别率可以看出，本文所提方法，在处理光照条件较差时能达到理想的效果，但是在处理极端光照时又存在一定的不足。综合整个人脸识别的识别率来看，本文所提方法的光照处理效果明显。 表2中列出了部分现有人脸识别算法的人脸平均错误识别率，从表2中可以看出：DCT [ 12 ] 的平均 图2. 不同方法处理后的人脸图像 Table 1 训练组 人脸错误识别率(%) 测试组 子集1 子集2 子集3 子集4 子集5 平均 0 0 0.71 1.05 0.53 子集2 子集1 子集3 子集4 子集5 平均 0 0 0.71 0 0.19 子集3 子集1 子集2 子集4 子集5 平均 0 0.83 0 0 0.19 子集4 子集1 子集2 子集3 子集5 平均 0 0 0 0 0 子集5 子集1 子集2 子集3 子集4 平均 0 4.17 0 0.71 1.33 表1. 实验结果 Table 2 算法 DCT OLHE Tan Vu 本文算法 平均错误率 0.55 0.9 1.94 1.75 0.45 表2. 不同方法的人脸错误识别率比较 错误识别率为0.55%，OLHE [ 13 ] 的平均错误识别率为0.9%，Tan [ 14 ] 的平均错误识别率为1.94%，Vu [ 15 ] 的平均错误识别率为1.75%，本文光照处理后的人脸平均错误识别率为0.45%。因此从人脸平均错误识别率中可以看出，本文的方法在光照处理后的平均错误识别率小于现有的一些光照处理算法的平均错误识别率，即在光照处理性能方面优于现有的一些算法，因此本文所提方法对不同角度的光照具有一定的抑制作用。"
"本文提出了一种基于离散余弦变换与Wallis相结合的人脸光照处理，该算法首先将人脸图像变换到对数域，在对数域中计算图像的离散余弦变换，舍弃部分低频系数，离散余弦反变换后用Wallis变换增强人脸图像的高频成分。在人脸分类阶段，提取人脸特征的方法是主成分分析法，分类器采用的是基于余弦距离的最近邻分类器。在Yale B正面人脸库中的实验结果表明，本文所提方法对不同角度的光照具有很好的抑制作用，光照处理后的人脸识别效果优于现有的一些光照处理算法。未来的工作是在更大型的人脸库中测试本算法的有效性。"
