"本文研究了股票价格服从混合分数布朗运动模型下带跳过程的两值期权的定价问题。首先通过热传导方程理论得到了两值期权的定价公式，随后用保险精算方法得到了两值期权的级数解公式，然后应用蒙特卡洛模拟的方法和有限差分方法得到数值解。以热传导方程得到的定价公式作为标准，将其余三种方法得到的期权价格与定价公式解进行比较，通过比较的结果，得出了这种级数解和数值方法的可行性和有效性。 关键词 :混合分数布朗运动模型，跳，两值期权，蒙特卡洛模拟，有限差分法，保险精算方法 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"金融工程中的基础工具是期权，它的定价问题向来是人们的关注点，因此产生了许多关于期权的定价方法。闫海峰，刘三阳 [ 1 ] 广用保险精算的方法研究了广义Black-Scholes模型的期权定价；李红 [ 2 ] 用有限差分法研究了跳扩散模型下期权定价，车韧 [ 3 ] 等研究了分形CEV本模型下的期权定价，提供了一种采用差分思想的蒙特卡洛模拟方法，石方圆 [ 4 ] 运用保险精算的方法研究了跳–扩散及O-U过程下的期权定价。随着衍生证券的发展，一些新型期权开始出现，两值期权就是其中的一种，它被用于投机和保值，目前关于两值期权的研究有：吴云和何建敏 [ 5 ] 推导了关于两值期权定价的解析解并介绍了二叉树方法在两值期权定价中的应用；杜雪樵 [ 6 ] 用限差分的方法研究了CEV模型下两值期权的数值解，杨珊等 [ 7 ] 运用保险精算方法研究了分数跳–扩散下两值期权定价。袁国军 [ 8 ] 得到了基于半离散化CEV过程的两值期权价格的差分格式。王海叶 [ 9 ] 对两值期权的定价公式进行了推广，丁华 [ 10 ] 对于股票价格在布朗过程和泊松过程共同作用下定价模型使用了有限差分的方法进行定价，付培 [ 11 ] 研究了在混合分数布朗运动模型下的两值期权的定价。本文在前面文章的启发上，在上述文献的基础上，对在复杂的混合跳扩散分数布朗运动下的两值期权进行了研究，得到了定价公式及其差分近似下的数值解，验证了数值解法的有效性和公式的正确性。"
"S为股票现价，X为期权的执行价格， μ 为预期收益率， σ 为无跳跃时股价波动率，r为无风险率，T为期权的到期日t为当前时刻V为t时刻基于价格为S的股票的衍生证券价格。  两值期权与标准期权相比具有很大的不同，具体表现为：它的收益具有不连续性。标准期权的收益取决于到期时间的实值期权的盈利数额。 max ( 0 , S − X ) 为一个看涨期权的收益，S代表到期时标的资产的价格，X是到期时的执行价格。而对于两值看涨期权来说，如果到期是实值的，它的收益具体为一个预先确定好的固定金额。两值期权具有两种类型：一种是资产或无值看涨期，另一种是现金或无值看涨期权。前者指如果到了期权的到期日，股票价格比执行价格低，则该期权一文不值，若股票价格在期权的到期日高于执行价格，则期权价格为股票价格。后者指如果到了期权的到期日，股票价格比执行价格低那么该期权一文不值；而当股票价格超过执行价格时该期权价值为一个固定数量现金Q。 对于现金或无价值看涨期权 V C 而言，边界条件： H ( S T , T ) = { Q , S T > 0. 0 , S T ≤ 0. 对于资产或无价值看涨期权 V A 而言，其边界条件： N ( S T , T ) = { S T , S T > 0. 0 , S T ≤ 0. 其中，X为执行价格，Q为大于零的常数。"
"假设股票价格变化模型服从下面的随机微分方程： d S ( t ) = ( μ ( t ) − λ k ) S ( t ) d t + σ H S ( t ) d B t H + σ S ( t ) d B t + U S ( t ) d N t . (1) 其中 S ( t ) 为t时刻股票价格， μ ( t ) 为预期收益率， σ H ， σ 分别为股价波动率， { B t H , t ≥ 0 } 为分数布朗运动，本文假设 0 < H < 1 ， { B t , t ≥ 0 } 为布朗运动， N ( t ) 表示股价在时间段 [ 0 , T ] 内随机跳跃次数，服从参数为 λ 的泊松过程，U表示股票价格跳跃的高度，服从对数正态分布，其中 ln ( 1 + U ) ∼ N ( μ J , σ J 2 ) ， N ( μ J , σ J 2 ) 为正态分布， μ J 为均值， σ J 为标准差，k是跳跃幅度U的无条件均值，且 k = E ( U ) 。  根据李红 [ 2 ] 的方法通过混合分数伊藤公式及泰勒展开等可得混合分数跳扩散模型下期权价格满足的偏微分方程为： ∂ V ∂ t + r S ∂ V ∂ S + 1 2 [ σ 2 + 2 σ H 2 H t 2 H − 1 + λ k 2 ] S 2 ∂ 2 V ∂ S 2 − r V = 0 令 σ 1 2 = σ 2 + λ k 2 则微分方程化为(2) ∂ V ∂ t + r S ∂ V ∂ S + 1 2 [ σ 1 2 + 2 σ H 2 H t 2 H − 1 ] S 2 ∂ 2 V ∂ S 2 − r V = 0 (2) 定理1：假设 S ( t ) 服从SDE(1)，敲定价格X，到期日为T，且期权价格满足随机微分方程(2)的资产或无价值看涨期权定价公式为： V = S t N (d1) d 1 = ln S t X + r ( T − t ) + 1 2 σ 1 2 ( T − t ) + 1 2 σ H 2 ( T 2 H − t 2 H ) σ 1 2 ( T − t ) + σ H 2 ( T 2 H − t 2 H ) 证明：用王海叶 [ 9 ] 中的方法，根据热传导方程经典解理论可以得到该方程有唯一强解，由Poisson公式即可得定理1成立。 定理2：假设 S ( t ) 服从SDE(1)，敲定价格X，到期日为T，且期权价格满足随机微分方程(2)的现金或无价值看涨期权定价公式为： V = Q e − r ( T − t ) N (d2) d 2 = d 1 − σ 1 2 ( T − t ) + σ H 2 ( T 2 H − t 2 H ) 证明：用上面的方法易证定理2成立。  引理3.2.1 [ 7 ] ：假设 S ( t ) 服从SDE(1)则根据混合分数跳-扩散Ito公式，随机微分方程(1)的解为： S ( t ) = S ( 0 ) exp { ∫ 0 t [ μ ( s ) − λ k − H σ H 2 s 2 H − 1 − 1 2 σ 2 ] d s + ∫ 0 t σ H d B t H + ∫ 0 t σ d B t + ∑ i = 0 N t ln ( 1 + U i ) } . 定义3.2.1 [ 7 ] ：股票价格过程 S ( t ) 在时间段 [ 0 , t ] 上产生的期望收益率 ∫ 0 t β ( s ) d s 的定义为： exp { ∫ 0 t β ( s ) d s } = E [ S ( t ) ] S ( 0 ) . 其中 β ( t ) 是连续复利收益率。 定义3.2.2 [ 1 ] ：欧式期权的保险精算定价的定义为：在期权的到期日，若期权被执行，期权的价值为股票在到期日的折现和执行价格在到期日的折现的差在股价实际的概率分布下的期望。关于资产价格的折现，计算方法如下：无风险资产的折现按照无风险利率来折现，风险资产的折现价格按照期望收益率(定义3.2.1)来进行折现。欧式期权在到期日被执行的充要条件是： 看涨期权为： exp { − ∫ 0 T β ( s ) d s } S ( T ) > exp { − ∫ 0 T r ( s ) d s } X . 看跌期权为： exp { − ∫ 0 T β ( s ) d s } S ( T ) < exp { − ∫ 0 T r ( s ) d s } X . 引理3.2.1 [ 4 ] ：假设Y为服从正态分布的随机变量，那么有 E [ e Y I { Y > a } ] = e μ Y + σ Y 2 2 N ( − a + σ Y 2 + μ Y σ Y ) . 其中 I { ⋅ } 表示性函数， μ Y 为Y的期望， σ Y 为Y的标准差，a为常数， N ( ⋅ ) 为标准正态分布随机变量的分布函数。 定理3.2.2：设资产价格过程 S ( t ) 满足混合分数跳–扩散模型(1)，则X为敲定价格，T为到期日为的资产或无价值看涨期权定价公式为： c 1 = S ( 0 ) ∑ n = 0 + ∞ ( λ ( 1 + k ) T ) n e − λ ( 1 + k ) T n ! N ( d 1 ) d 1 = − ln X S ( 0 ) + ∫ 0 T r ( s ) d s + μ n + σ n σ n d 2 = − ln X S ( 0 ) + ∫ 0 T r ( s ) d s + μ n σ n = d 1 − σ n 证明：下面用保险精算的方法证明等式成立 由定义3.2.1知 ∫ 0 t β ( s ) d s = ∫ 0 t r ( s ) d s . 所以 e − ∫ 0 T β ( s ) d s S ( T ) = S ( 0 ) e { ∫ 0 T ( μ ( s ) − λ k − H σ H 2 s 2 H − 1 − 1 2 σ 2 ) d s + ∫ 0 T σ H d B t H + ∫ 0 T σ d B t + ∑ i = 0 N T ln ( 1 + U i ) } = S ( 0 ) e { ∫ 0 T ( − λ k − H σ H 2 s 2 H − 1 − 1 2 σ 2 ) d s + ∫ 0 T σ H d B t H + ∫ 0 T σ d B t + ∑ i = 0 N T ln ( 1 + U i ) } = S ( 0 ) e X N T (3) 记 X n = ∫ 0 T ( − λ k − H σ H 2 s 2 H − 1 − 1 2 σ 2 ) d s + ∫ 0 T σ H d B t H + ∫ 0 T σ d B t + ∑ i = 0 n ln ( 1 + U i ) . 因为由股票价格的变化方程及假设条件可知： ∫ 0 T σ H d B t H ∼ N ( 0 , ∫ 0 T 2 H σ H 2 s 2 H − 1 d s ) , ∫ 0 T σ d B t ∼ N ( 0 , ∫ 0 T σ 2 d s ) , ∑ i = 0 n ln ( 1 + U i ) ∼ N ( n ln ( 1 + k ) − n σ J 2 2 , n σ J 2 ) 令 μ n = ∫ 0 T ( − λ k − H σ H 2 s 2 H − 1 − 1 2 σ 2 ) d s + n ln ( 1 + k ) − n σ J 2 2 ,   σ n = ∫ 0 T 2 H σ H 2 s 2 H − 1 d s + ∫ 0 T σ 2 d s + n σ J 2 所以 X n ∼ N ( μ n , σ n ) 。 则可以得到 e μ n + σ n 2 = ( 1 + k ) n e − λ k T 。由(3)可以得到： e − ∫ 0 T β ( s ) d s S ( T ) > e − ∫ 0 T r ( s ) d s X ⇔ X N ( T ) > ln X S ( 0 ) − ∫ 0 T r ( s ) d s . 则资产或无价值看涨期权的价格为： c 1 = E [ e − ∫ 0 T β ( s ) d s S ( T ) I { e − ∫ 0 T β ( s ) d s S ( T ) > e − ∫ 0 T r ( s ) d s X } ] = E [ e − ∫ 0 T β ( s ) d s S ( T ) I { X N ( T ) > ln X S ( 0 ) − ∫ 0 T r ( s ) d s } ] = E [ S ( 0 ) e X n I { X n > ln X S ( 0 ) − ∫ 0 T r ( s ) d s } | N ( T ) = n ] = S ( 0 ) ∑ n = 0 + ∞ ( λ T ) n e − λ T n ! E [ e X n I { X n > ln X S ( 0 ) − ∫ 0 T r ( s ) d s } ] 由引理3.2.1得： E [ e X n I { X n > ln X S ( 0 ) − ∫ 0 T r ( s ) d s } ] = e μ n + σ n 2 N ( − ( ln X S ( 0 ) − ∫ 0 T r ( s ) d s ) + σ n 2 + μ n σ n ) = e μ n + σ n 2 N ( − ( ln X S ( 0 ) − ∫ 0 T r ( s ) d s ) + σ n + μ n σ n ) = ( 1 + k ) n e − λ k T N (d1) 所以 c 1 = E [ S ( 0 ) e X N ( T ) I { X N ( T ) > ln X S ( 0 ) − ∫ 0 T r ( s ) d s } ] = S ( 0 ) ∑ n = 0 + ∞ ( λ T ) n e − λ T n ! ( 1 + k ) n e − λ k T N ( d 1 ) = S ( 0 ) ∑ n = 0 + ∞ ( λ ( 1 + k ) T ) n e − λ ( 1 + k ) T n ! N (d1) 即 c 1 = E [ e − ∫ 0 T β ( s ) d s S ( T ) I { X N ( T ) > ln X S ( 0 ) − ∫ 0 T r ( s ) d s } ] = S ( 0 ) ∑ n = 0 + ∞ ( λ ( 1 + k ) T ) n e − λ ( 1 + k ) T n ! N (d1) 所以定理3.2.2成立。 定理3.2.3：设资产价格过程 S ( t ) 满足混合分数跳-扩散模型(1)，则敲定价格X，到期日为T的现金或无价值看涨期权定价公式为： c 2 = Q ∑ n = 0 + ∞ ( λ T ) n e − λ T n ! N ( d 2 ) . 证明：用上面的保险精算的方法易证明定理3.2.3成立。 由以上内容得到了混合分数布朗运动下带跳的看涨两值期权的定价公式，下一部分介绍此模型下两值期权的数值解。"
"根据第3.1节知期权价格满足的微分方程为： ∂ V ∂ t + r S ∂ V ∂ S + 1 2 [ σ 2 + 2 σ H 2 H t 2 H − 1 + λ k 2 ] S 2 ∂ 2 V ∂ S 2 − r V = 0 (4) 利用隐式差分法，分别对时间(从现在0时刻到两值期权到期日T时刻)，股票价格进行等间隔的分割。即对两值看涨期权价格的求解区域 A = { 0 ≤ S ≤ S max , 0 ≤ t ≤ T } 网格化。 S max 为股票可到达的最高价格，可执行价格 X ≤ S max 。假设 Δ t = T / N ，总共有 N + 1 个时间点 0 , Δ t , 2 Δ t , ⋯ , T 。同时定义 Δ S = S max / M ，考虑 M + 1 个股票价格： 0 , Δ S , 2 Δ S , ⋯ , S max 。这样就构造了一个共有 ( M + 1 ) ( N + 1 ) 个时间点的坐标方格。每一个节点 ( i , j ) 和时刻 j Δ t 以及股票价格 i Δ S 相对应， ( i = 0 , 1 , 2 , ⋯ , M ; j = 0 , 1 , 2 , ⋯ , N ) 。记 V A ( i , j ) 为节点 ( i , j ) 处资产或无价值看涨期权的价格，对于坐标方格内部的点，利用有限差分法，取： ∂ V ∂ t = V i , j + 1 − V i , j Δ t (5) ∂ V ∂ S = V i + 1 , j − V i − 1 , j 2 Δ S (6) ∂ 2 V ∂ S 2 = V i + 1 , j + V i − 1 , j − 2 V i , j Δ S 2 (7) 把上式(5) (6) (7)带入上面的微分方程(4)中，注意到 S = i Δ S ，各项进行合，并考虑V的终值条件 即 S = 0 ， S = S max 和 t = T 时的资产或无价值看涨期权价值 ，得到 ( i Δ S , j Δ t ) 网格点上的差分方程为： { a i V A ( i − 1 , j ) + b i V A ( i , j ) + c i V A ( i + 1 , j ) = V A ( i + 1 , j + 1 ) V A ( i , N ) = N ( S T , T ) V A ( 0 , j ) = 0 V A ( M , j ) = S max (8) a i = − Δ t L i + r i Δ S 2 Δ t 2 Δ S 2 , b i = Δ t L i + Δ S 2 + r Δ S 2 Δ t Δ S 2 , c i = − Δ t L i − r i Δ S 2 Δ t 2 Δ S 2 , L i = ( σ 2 + λ k 2 + 2 σ H 2 H t 2 H − 1 ) ( i Δ S ) 2 首先求解与 T − Δ t 时刻相对应的点，利用式(8)和 j = N − 1 ，可以给出 M − 1 个同时成立的方程： J M − 1 T M − 1 = Z M (9) 令 J M − 1 = [ b 1 c 1 a 2 b 2 c 2 ⋱ ⋱ ⋱ a M − 1 b M − 1 ] , T M − 1 = [ V A 1 , N − 1 V A 2 , N − 1 ⋮ V A M − 1 , N − 1 ] , Z M = [ V A 1 , N − a 1 V A 0 , N V A 2 , N ⋮ V A M − 1 , N − c M − 1 V A M , N − 1 ] 方程系数矩阵 J M − 1 为三对角矩阵，可以用追赶法来求解三对角矩阵，即可以求出方程(9)中的 M − 1 个未知数： V A 1 , N − 1 , V A 2 , N − 1 , ⋯ , V A M − 1 , N − 1 ，与 T − 2 Δ t 对应的结点也按同样方式处理，并以此类推，最后就会得到 V A 1 , 0 , V A 2 , 0 , ⋯ , V A M − 1 , 0 。  与资产或无价值看涨期权的差分过程一样，只是边界条件发生了变化，经过整理最终得到 ( i Δ S , j Δ t ) 网格点上的差分方程为： { a i V C ( i − 1 , j ) + b i V C ( i , j ) + c i V C ( i + 1 , j ) = V C ( i + 1 , j + 1 ) V C ( i , N ) = H ( S T , T ) V C ( 0 , j ) = 0 V C ( M , j ) = Q 按照上面所述的方式处理，通过从后向前递推，直到当 t = 0 时，得到一组期权值： V C 1 , 0 , V C 2 , 0 , ⋯ , V C M − 1 , 0 。  Boyle在1977年首次对欧式期权利用蒙特卡洛模拟的方法进行了定价，自此开始蒙特卡洛模拟方法在金融分析方面发挥了相当重要的作用，尤其在关于衍生产品定价和确定套期保值基本参数这些方面产生了重大作用，并且成为了一种有效的数值分析方法。 蒙特卡洛模拟方法的主要数学思想大致如下：建立一个与所求问题有关的概率模型，通过建立的概率模型使得所要求解的问题可以通过数学期望来表示，然后根据用样品估计整体的思想，对模型进行大量抽样观察，最后求解上面根据抽样得到的随机变量的平均值，并把得到的均值作为所求解的近似估计值。 用文献 [ 3 ] 中的方法进行蒙特卡洛模拟设计，文中设计的蒙特卡罗模拟数值方法首先从满足混合分数布朗运动下带跳模型假设下的资产价S的模拟开始，具体做法如下：首先对时间段 [ 0 , T ] 进行划分，把它分成N个均等时间段(其中，0代表当前时刻T表示期权的到期日)： 0 = t ( 0 ) < t ( 1 ) < t ( 2 ) < ⋯ < t ( N ) = T , Δ t = T N 对 i = 0 , 1 , 2 , ⋯ , N ;   t ( i ) = i Δ t 。则得到如下的模拟路径： S t ( i ) = S t ( i − 1 ) e ( μ − λ k − H σ H 2 t 2 H − 1 − 1 2 σ 2 ) ( t ( i ) − t ( i − 1 ) ) + σ Δ B t + σ H Δ B t H + ∑ i = 0 N t ( i ) ln ( 1 + U i ) . (10) 以欧式两值看涨期权为例，蒙特卡罗模拟方法的实现步骤如下： 1) 模拟布朗运动：产生服从标准正态分布的随机序列。 2) 模拟分数布朗运动：将满足标准正态分布的随机序列转化为分数布朗运动序列。 3) 我们模拟一个强度为 λ Δ t 的Poisson过程的随机数N。 4) 如果 N = k ，我们模拟具有规则 ln ( 1 + U i ) ∼ N ( μ J , σ J 2 ) ， i = 1 , 2 , ⋯ , N 的N个独立随机变量。 5) 把上面模拟的随机序列带入式子(10)。 Table 1 初始价格(元) 90 100 110 跳扩散模型期权 价格(元) B-S公式 48.1154 76.4816 99.2822 级数公式 48.4341 74.2996 96.2902 蒙特卡洛模拟 47.4544 76.1946 97.6908 有限差分 47.9944 76.3841 98.6876 表1. 混合分数跳扩散模型下的资产或无价值两值看涨期权定价"
"以资产或无值看涨期权为例，进行数值实验。假设这种两值期权不考虑红利支付，股票价格满足混合分数跳扩散过程的共同作用，设股票初始价格分别是90，100，110元，执行价格为100元，期权有效期为六个月，即T = 0.5，无风险利率为 r = 0.13 e − 2 ，泊松分布的参数 λ = 2 , μ J = 0.09 e − 2 , σ J 2 = 0.01 , H = 0.65 。其中，初始波动率分别为0.2，0.15，股票价格最大值为200。 下面以资产或无价值看涨期权为例，得出了微分方程法得到的公式，级数解公式，有限差分，蒙特卡洛模拟三种情况下的两值期权价格。其中以微分方程法用热传导理论得到的期权价格作为比对标准(表1)，为了减小价格的误差，级数解公式的总项数n取为1000，蒙特卡洛模拟的次数为1000次。"
