"本文提出一种基于两步Kalman滤波的GNSS分布式自主导航定轨方法。首先，给出分布式自主定轨数据流程，建立并分析GNSS导航星座星间链路双向伪距测量模型。其次，采用单点定位法计算待估卫星位置及其协方差，以此作为伪观测量，采用两步Kalman滤波法处理卫星计算轨道参数改正数，并进行时间更新。另外，针对自主定轨存在的秩亏问题，利用卫星预报星历中轨道定向参数控制星座整体旋转，给出卫星真实轨道的最佳估值。仿真结果验证了该方法的有效可行性。 关键词 :星间链路，两步Kalman滤波，分布式，自主定轨"
"GNSS (Global Navigation Satellite System，全球卫星导航系统)作为一种重要的战略性空间资源，其应用已经广泛渗入到国防和国民经济建设的各个领域，成为保障国家安全、促进经济和社会发展的重要基础设施。 星间链路技术是实现GNSS自主导航的一项关键技术，其主要目的是进行高精度卫星星历和钟差估计，进而提供高精度PNT (Positioning Navigation and Timing，定位、导航与授时)服务。星间链路自主定轨是指导航系统在没有地面运行控制系统支持条件下，利用星间测距及星间通讯维持导航系统星历的自主更新。目前针对GNSS星间链路自主定轨的研究大致有三个方面：GPS卫星的自主定轨研究、自主定轨秩亏问题、自主定轨的数学仿真和模拟等。 美国最早提出卫星自主定轨的概念。1984年Ananda利用GPS (Global Positioning System，全球定位系统)星间观测提出了卫星自主定轨的基本框架 [ 1 ] 。随后Codik对GPS自主导航的可行性进行了初步探讨 [ 2 ] 。接下来，IBM公司受美国空军航天部委托，对自主定轨系统算法进行了研究，至1990年6月，基本完成了自主定轨的理论、设计和数据模拟等工作 [ 3 ] 。随着美国现代化武器装备依赖GPS的程度日益增高，一些学者针对GPS Block IIR [ 4 ] [ 5 ] 、Block IIF [ 6 ] [ 7 ] 、Block III [ 8 ] [ 9 ] 卫星展开了一系列循序渐进的研究，保证了GPS系统的高精度自主定轨。 Ananda在研究GPS自主定轨时提出，自主定轨是秩亏的，即由于星间测距本质是相对测量，自主定轨存在星座整体旋转的问题 [ 3 ] 。刘迎春从理论上证明了星座整体旋转的不可观性使得缺少方向基准信息，从而使法方程组系数矩阵出现秩亏 [ 10 ] 。截至目前，解决该问题的方法大致分为两种：一种是通过约束轨道定向参数来控制星座整体旋转 [ 11 ] - [ 13 ] ；另一种是引入锚固站作为自主定轨系统的空间基准以控制星座整体旋转，同时还能提高自主定位精度 [ 14 ] - [ 16 ] 。 对于自主定轨的数学仿真和模拟，主要包括对新算法、评价指标、模拟平台等的仿真。宋小勇利用仿真数据验证了分布式自主定轨的两步卡尔曼滤波算法和SRIF算法(square root information filter，均方根信息滤波算法)，研究了分布式自主星历更新问题 [ 17 ] 。Eissfeller仿真得出星间测距可以明显改善卫星轨道的沿迹向和法向精度，当测距精度在厘米级时，卫星自主定轨精度优于0.1 m [ 18 ] 。曾旭平建立了导航卫星自主定轨的模拟研究平台，并提出了自适应静态逐次滤波方法，该方法能有效克服自主定轨模型误差及方程的线性化误差 [ 19 ] 。 综上所述，国内外在基于星间链路的自主定轨方面已经取得了大量有价值成果，美国GPS自主定轨也已投入运行。但是，大多数研究结果多限于部分关键技术及其解决方法的研究，还没有用于工程实现的自主定轨完整解决思路。基于此，本文系统地研究星间链路自主定轨问题。"
"基于星间链路的自主定轨由数据通讯、数据预处理、残差生成、Kalman滤波、星座旋转改正、星历拟合等部分组成。数据流程如图1所示，各模块功能如下： 数据通讯部分主要完成星间观测数据、卫星星历及协方差信息、卫星轨道面定向参数的交互收发等。本文主要指星间双向伪距。 数据预处理部分在测距帧后完成，主要完成粗差剔除、卫星观测时间归算、测距观测量误差改正及测量硬件时延改正等。 残差生成过程主要完成电离层改正、相对论改正、星间距理论值计算及星间测距数据与星间时间同步数据的解耦。通过残差分析可对观测量的数据质量进行检核。残差生成过程输入量为经过星间通讯获取的预处理后星间观测数据、上次定轨预报生成的轨道参数改正数以及由地面运控系统上载的参考轨道。输出为观测量与理论值之差。 Kalman滤波主要利用观测量及其主要误差来进行测量更新，产生改进轨道参数，重新拟合生成星历和时钟参数。 星座整体旋转改正部分主要利用轨道改进获得的每颗卫星轨道升交点经度及轨道倾角改正数计算星座整体旋转改正量，并用改正量对卫星轨道定向参数进行改进。 经过上述自主定轨流程，最终生成新的广播星历和时钟信息，用于下一个观测历元。 对于导航卫星来说，星历预报精度是系统最主要的技术指标。动力学定轨方法便于轨道预报，是导 图1. 自主定轨流程图 航卫星自主定轨的较好选择。星间链路自主定轨首先需要构建星间测距观测方程，然后依据动力学方程对应的变分方程计算卫星状态转移矩阵，最后采用Kalman滤波完成参数更新及时间更新，考虑星座整体旋转误差改正后，生成下一个观测历元的星历和时钟信息。估计参数可为卫星状态参数或轨道根数。"
"基于星间链路的卫星自主运行基本观测量为星间测距观测量，星间测距观测有多种方式，如星间激光测距、星间伪距测量、星间载波相位测量及星间多普勒测量等。我们以星间伪距测量为例，建立星间测量方程。 考虑星间时间同步误差时，星间伪距测量方程简写如下： (1) 其中 为观测时刻卫星i接收到卫星j的伪距观测量， 为卫星i与j的理论星间距， 、 分别为卫星i与j钟差， 为卫星i接收端时延， 为卫星j发射端时延， 、 分别是由于温度变化引起的发射及接收端噪声时延， 为电离层时延， 为相对论效应， 为多路径效应， 为测量随机误差。 对星间伪距观测量进行收发时延改正、双频电离层改正、相对论改正以及多路径改正后，卫星i与j的星间双向伪距测量方程可简写为： (2) (3) 其中 、 均为卫星i、j的理论星间距，表达式为： (4) 为了消除卫星钟差对定轨的影响，采用双向伪距测量法进行消除。将式(2)和(3)相加，并用参考轨道线性化，得到不含卫星钟差的线性观测方程： (5) 上式中 为利用参考轨道计算的近似星间距， 、 分别为卫星位置相对参考轨道改正量， 为星间距单位向量，其形式为 。 当采用轨道根数作为估计参数时，方程(5)可写为： (6) 其中 、 为六个轨道根数相对参考轨道改正数， 、 为观测量对轨道根数偏导数，与 之间关系为： (7) 其中 为卫星i的位置矢量 对轨道根数 的偏导数，表达式如下： (8) 上式6个元素的表达式 [ 20 ] 如下： (9) 其中 为轨道根数 及参数 的函数，详细见文献 [ 20 ] 。  考虑地球的非球形引力摄动，则卫星轨道动力学模型 [ 20 ] 表示如下： (10) 其中， 表示卫星i的位置矢量长度， 表示卫星在惯性系下的位置和速度分量， 为地球引力常数， 为二阶带谐项系数， 为地球赤道半径， 表示卫星 项之外的摄动加速度，主要为模型噪声。  利用星间伪距进行分布式定轨实质上是将卫星预报轨道作为参考点，利用星间伪距进行定轨的过程。对卫星i及其可视卫星j的星间伪距测量方程(6)变形，得到分布式星间伪距测量方程如下： (11) 研究表明，用直接Kalman滤波算法进行自主定轨解算时，当观测量有粗差或部分卫星轨道变轨造成观测量异常时，异常观测量不易检测分离。为此采用两步处理法。第一步，利用单点定位方法计算待估卫星位置及其协方差；第二步，以计算的卫星位置及协方差信息作为伪观测量采用Kalman滤波算法处理。星间伪距测量方程(11)可写为： (12) 其中 为观测量， 为卫星位置向量改正数，顾及观测量协方差，利用加权最小二乘原理可计算出卫星位置改正数及协方差如下： (13) (14) 其中 为观测权矩阵， 为单位权中误差。 将轨道动力学模型(10)在参考轨道附近线性化，并将高阶项误差用随机过程噪声表示，可得到线性化状态转移方程： (15) 其中 为扩增状态转移矩阵，定义为： (16) 其中 为状态转移矩阵，初值为单位矩阵； 为卫星状态参数对动力学参数偏导数，初值为零； 为动力学噪声向量， ； 为噪声系数矩阵； 为单位矩阵。 将卫星位置改正数及协方差作为伪观测量，根据最小方差原理，可得到Kalman滤波解算公式如下： (17) (18) (19) (20) (21) 采用Kalman滤波算法可逐卫星计算轨道参数改正数并进行时间更新。  独立采用星间测距作为定轨观测量时，由于星间测距本质上是相对测量，自主定轨是秩亏的。直观理解为：如果将导航系统整体旋转任意角度并不改变导航系统性能。因此基于星间测距的自主定轨需要约束星座整体旋转。本文针对自主定轨存在的秩亏问题，利用卫星预报星历中轨道定向参数(预报轨道的升交点经度和轨道倾角)约束星座整体旋转，给出卫星真实轨道的最佳估值。具体方法为：首先，估计卫星的六个轨道根数；然后，约束轨道倾角和升交点经度。 假设在某一历元，星间伪距测量能够确定n个卫星的定向参数 的改正数V，其中V为 向量。由于星间伪距测量是相对量，对星座整体旋转无影响，因此将星座分别沿x，y，z坐标轴旋转 。按照文献 [ 17 ] 推导的坐标系整体旋转与轨道面定向参数间的微分关系，轨道定向参数的改正数即为 ，其中 为n个 矩阵， 三分量为 。为保证V接近真值， 需要选择合理。文献 [ 17 ] 研究得出，卫星预报计算的i、Ω与真值之间的误差可控，因此 应满足： (22) 根据最小二乘理论，可计算得出： (23) 其中 为先验权阵，Menn [ 11 ] 从控制参考轨道初始误差传播方面考虑，建议 按照卫星上载的参考轨道误差取值。利用上式 可计算出新卫星轨道定向参数改正数 。其对应的约束方程为： (24) 当仅需要约束轨道面定向参数i、Ω时，可将权阵W中此分量对应值设为1，其余设为0。"
"根据国际卫星导航服务组织公开的真实GPS系统星历，对本文设计的自主定轨方法进行仿真验证。利用用户伪距误差(URE) [ 1 ] 分析在自主定轨180天的精度，它近似表示为： (25) 式(25)中，R表示卫星的径向误差，T表示卫星的切向误差，N表示卫星的法向误差。 考虑卫星全部状态量均参与滤波和定向参数i、Ω不参与滤波两种情况进行仿真。  仿真条件设定为星座中卫星全部状态量均参与滤波，即所有卫星的轨道根数均参与滤波，仿真结果如图2~图5所示。 由图2~图5可以看出，在180天的定轨弧段内，径向误差始终保持较高的精度，基本上保持在0.4m范围内，而法向、切向误差随时间增长较快，相应URE小于3.5 m。 为了更清晰地反映定轨精度，对卫星PRN30自主定轨结果的URE进行了统计，URE均方误差为0.7028 m，最大偏差为3.0852 m，平均偏差为1.4752 m。  通过约束PRN30的定向参数 来进行仿真实验，即：定向参数i、Ω不参与滤波，估计值直接引用轨道预报的先验值，其它仿真条件同状态量均参与滤波时完全一致，仿真结果如图6~图9所示。 通过对比图2~图5和图6~图9，可以看出，定向参数i、Ω被约束后，径向误差保持在0.6左右，法向误差由15 m降至10 m，切向误差由25 m降至20 m，用户伪距误差由3.5 m降至3 m。说明定向参数约束 图2. 径向误差 图3. 法向误差 图4. 切向误差 图5. 用户伪距误差 后，定轨精度变高。 另外，我们统计了两种情况下PRN30的URE结果，如表1所示。 由表1可以看出，与状态量均参与滤波时相比，约束定向参数i、Ω后，卫星PRN30的定轨精度有 图6. 径向误差 图7. 法向误差 图8. 切向误差 所提高，URE均方误差提高了0.0682 m，最大偏差提高了0.2095 m，平均偏差提高了0.1558 m。进一步说明利用预报定向参数i、Ω对轨道计算结果进行约束可以控制星座整体旋转，从而验证了本文所提算法的有效性。 图9. 用户伪距误差 Table 1仿真情况 技术指标URE (m) 均方误差 最大偏差 平均偏差 均参与滤波时 0.7028 3.0852 1.4752 约束i、Ω时 0.6346 2.8757 1.3194 两种结果之差 0.0682 0.2095 0.1558 表1. 状态量均参与滤波时与约束定向参数i，Ω时的URE比较结果"
"本文系统地研究了GNSS星间链路自主定轨问题，给出自主定轨数据流程，根据星间伪距测量模型设计一种两步Kalman滤波法，探讨星座整体旋转限制条件，并通过仿真验证了本文设计的自主定轨方法的有效可行性。"
