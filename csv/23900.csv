"用户对视频的直观体验是流畅度和清晰度，基于vMOS的评测标准，将网络侧和用户侧的因素进行综合优化将是难中之难，在不断的发展过程中，会产生更多的影响因素，加之与反馈模块进行结合，更加增加了优化难度。本文首先通过单片机与网络和用户端之间的数据传送来实现反馈的功能。其次将用户观看视频的感受进行数字化处理，并对影响视频指标vMOS的各种因素进行分析，特将vMOS的得分细化并且通过单片机和服务器之间的自动优化功能进行调节处理。最后对各因素与vMOS值之间的相关性进行分析。在排除相关性较低的变量之后，分别得到了sLoading和sStalling这两个变量，通过Matlab进行数据的初步拟合之后得到了一定的函数关系。从而实现了用单片机和服务器对影响因素进行优化，同时优化了视频质量。 关键词 :vMOS，单片机，sLoading, sStalling Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着无线宽带网络的升级，以及智能终端的普及，视频的分辨率和画面质量在不断演进和提升，屏幕技术和编解码技术在不断发展，移动网络和固定网络也都全面进入超宽带时代，视频体验已经呈现出多屏、多网络、多业务的特点 [ 1 ] 。现今越来越多的用户选择在移动智能终端上应用客户端APP观看网络视频，这是一种基于TCP的视频传输及播放。因此需要根据以用户体验为中心的评价体系标准，用统一的衡量标准，来评价不同网络，不同屏幕，不同场景应用下的视频体验的好坏。视频业务体验已成为衡量网络服务质量的关键指标。伴随着视频分辨率的不断提升，视频业务对网络的要求也越来越高。如何评价当前网络下视频业务的体验，对用户和运营商来说意义越来越重大 [ 2 ] 。 IP承载网是一个“尽力而为”的网络，网络视频业务占用带宽资源较多、实时性要求较高，并且对分组丢失、时延、抖动等网络特性非常敏感，尤其是时变的网络特性严重影响网络视频业务的质量。通过对网络视频质量的监控和反馈，可以调节编解码器或信道的参数，改善传输视频的服务质量。因此，需要实时准确地对网络视频服务质量进行监控，获得反映用户感受的视频体验质量。用户对视频的直观体验是流畅度和清晰度，在基于vMOS的评测标准 [ 3 ] ，将网络侧和用户侧的因素进行综合优化将是难中之难，在不断的发展过程中，会产生更多的影响因素，加之与反馈模块进行结合，更加增加了优化难度。本文将基于初始缓冲时延、卡顿时长占比、初始缓冲峰值速率、播放阶段平均下载速率、E2E、RTT对vMOS客服评价体系的影响关系，并用单片机和服务器对影响因素进行优化，进而对视频质量进行优化。并对影响视频指标vMOS的各种因素进行分析，并且通过单片机和服务器之间的自动优化功能进行调节处理。"
"对于观看视频的体验，每个人都会有不同的感受，而这种种不同的感受研究起来还是有点抽象，为了更利于表达情感，本文将用户的直接感受数字化，用vMOS的得分来表示用户的主观体验得分具体的计算方法如下所示： 在网络线路不拥挤时，网络传输状态可以采用DF期望值来衡量。DF期望值的计算公式为: DF = MPEGSize MediaSpeed (1) 式中，MPEGSize为IP封包的MPEG 内容大小，MediaSpeed为媒体流码率。 当通信线路发生拥塞时，vMOS测试结果更能反映网络传输状态。vMOS分的计算公式为 vMOS = sQuality ⋅ [ 1 5 ( P 1 + P 2 ) ⋅ ( P 1 ⋅ sLoading + P 2 ⋅ sStalling ) ] (2) P 1 表示sLoading权重，且其取值为0.23；P 2 表示sStalling权重，且其取值为0.27。"
"TCP加速技术的核心是设计高效的拥塞控制算法，在不丧失TCP公平性和友好性的前提下尽量提升TCP流的吞吐率。拥塞控制的基本思路是发送端根据从网络获得的拥塞反馈信息调整TCP的发送速率，基于根据何种拥塞反馈信息可以将TCP加速技术分为三类:基于显式信息反馈的TCP加速技术、基于隐式信息反馈的TCP加速技术和基于智能数据分析的TCP加速技术 [ 4 ] 。 1) 基于显式信息反馈的TCP加速技术 部分TCP加速技术提出了利用路由器配合进行显式拥塞反馈，由路由器主动向发送端通告网络的拥塞状况，发送端据此调整发送速率。比较典型的主要有：XCP和VCP等。由于该类技术对网络设备支持的依赖程度非常高，因此协议可扩展性很差，这也是该类技术至今依然停留在理论，尚未在网络中获得大规模部署的原因。 2) 基于隐式信息反馈的TCP加速技术 如果路由器不提供显式的拥塞指示，那么TCP只能利用传输过程中获取的反馈作为隐式拥塞指示，典型反馈信息主要分为丢包事件和往返时延，该类TCP加速技术通常根据其中一或两个维度来判定当前网络的拥塞程度，并在发送端做出相应的拥塞控制策略。基于隐式信息反馈的TCP加速技术依赖于丢包事件和往返时延等信息对网络拥塞判定的精确度，无论是拥塞丢包和随机丢包的判断错误，还是轻载网络时延的判定错误，都会给TCP的拥塞控制产生负面影响，因此依靠简单的隐式拥塞信息反馈来调整TCP拥塞控制难以满足应用的高吞吐率需求。 3) 基于智能数据分析的TCP加速技术 华为公司研究设计了新一代的基于智能数据分析的TCP加速技术RACE (Rapid, Adjustable, Clever, Efficient)，针对每一条TCP流收集与其相关的来自于应用和网络等多个维度的信息，通过设计智能数据分析引擎，将来自应用的真实需求信息和来自网络的真实状态信息分析处理成智能标识拥塞控制信息，指导算法更加精确地判断网络拥塞程度。华为公司提出的RACE首次将智能数据分析技术引入TCP加速技术，克服了传统TCP加速技术对网络状况判断不准确的缺陷，真正能够做到：窗口快速增长(Rapid)、目标速率可调(Adjustable)、丢包智能甄别(Clever)和自适应调整商口达到高通量(Efficient)。  用户选择(资费)，片源清晰度，终端屏幕分辨率&处理器视频能力(如编解码算法支持，最高画质支持)，及可获得带宽(如可获得带宽不足，则有可能导致实际播放的最高画质受限)。  影响sSalling得分的主要网络指标是视频全程感知速率：无线网络边缘弱覆盖导致无法获取高速率(比如UMTS LTE RSCP/RSRP低于一定门限)；话务高峰时间和区域的小区用户数过多导致容量不足；而部分视频片源的码率波动范围过大，超过容量规划中1.3倍码率的假设值，会导致实际容量的不足；高峰时段，视频服务器负载过高限速，也会导致用户感知业务速率降低，最终导致卡顿。这些都是造成视频全程感知速率低、播放过程出现卡顿的可能因素；可以从无线网络先入手，逐步拓展到业务网络层。  影响sLoading得分的主要网络指标是视频初始缓神峰值速率和E2E RTT(反映OTT视频的架构性时延)。统计研究表明，vMos与E2E RTT负相关，VMOS随E2E RIT的减少而增大；vMOS与初始缓冲峰值速率正相关，vMOS随初始缓神峰值速率增大而增大。E2E RTT大，会导致视频业务解析交互时延增大和TCP速率上限较低(即：初始缓冲峰值下载速率低，从而空口能力利用不充分)；空口峰值速率低，会导致下载速率受限，初始缓冲时延大。  通过E2E网络架构优化，进一步提升信息交互效率和空口利用率。RIT过大，除了弱覆盖或高负载因素外，更多是网络架构原因导致。架构性降时延，可以从空口能力提升/负载维持、S1传输优化及视频CDN下沉等多个维度一起使用。通过降低E2ERTT，可以进一步提高带宽利用率，改善各类交互时延，从根本上提升整体用户视频体验 [ 5 ] 。"
"由于各个得分受限于网络和硬件的质量的限制导致提升比较困难，所以通过控制收集和反馈各得分的数值，拟合函数选取最优点来达到提高vMOS数值的效果。在改变各个因素之前，需要进行数据的原始采集，同时还需具有在网络和用户侧间进行数据的双向传输的功能。在经过大量的测试之后最终选择了性价比较高的单片机来作为调控终端。通过单片机与网络和用户端之间的数据传送来实现反馈的功能，最终达到提高vMOS数值的效果。利用单片机进行数据采集流程图如图1所示。 而实现单片机和Internet网络之间的通信功能的关键之处在于单片机内部的TCP/IP协议 [ 6 ] 。但由于单片机本身的资源局限性和TCP/IP协议的复杂性，所以需要对现有的资源进行合理的分配，使其能够满足与Internet网络通信之间的存储需要，并跟上数据处理的速度，这也就需要对于TCP/IP协议进行一定的改变使其符合实时性和安全性的要求。单片机工作原理如图2所示。 同时，在目前现有的大多数系统设计开发中都引入了实时操作系统RTOS (Real Time Operating System)。这种嵌入式实时操作系统可以在固定的时间内执行相应的功能并对于外部的异常事件做出一定的响应。通过引入这个系统，不仅可以提高系统的可靠性和抗干扰性，还可以充分发挥出CPU同时执行多项任务的潜力。 而在数据传输方面，本文通过以太网控制芯片RTL8019AS [ 7 ] ，将TCP/IP协议嵌入通用单片机中，来实现检测仪表与网络之间的数据双向传输。RTL8019AS芯片是专用的以太网控制芯片，支持PNP自动探测，吞吐量较大，实时性也较强符合工程要求，通过RJ45接口来实现与网络侧间的通信效果。 图1. 数据采集流程图 图2. 单片机工作原理图   由于vMOS是评价在客户端的视屏播放质量的综合评估，特将vMOS的得分分为0.5分、1分、1.5分、2分、2.5分、3分、3.5分、4分、4.5分、5分，及其分别代表的客户的主观感受：无法观看；几乎无法观看；非常恼火；较恼火；非常烦恼；较烦恼；有感知、带有一丝情绪；有感知、较流畅；非常流畅；非常舒适。感知情况的vMOS值如表1所示。 实际测试中影响vMOS得分的主要因素有视屏源和下载速率。 由于在测试过程中发现视频质量sQuality一般不会改变也难以改变，因此，在其保持相对不变的前提下，通过大量的数据模拟采集并筛除无关变量之后，得到各因素与vMOS值之间的相关性分析。在排除相关性较低的变量之后，分别得到了初始缓冲时延和卡顿时长占比这两个变量，而他们又分别代表着sLoading与sStalling。 通过Matlab进行数据的初步拟合之后得到了一定的函数关系。 y = ( P 1 + P 2 ⋅ L n ( x 1 ) + P 3 ⋅ L n 2 ( x 1 ) ) 1 + P 6 ⋅ L n ( x 1 ) (3) P 1 ：3.34991572672259 P 2 ：3.61139962378808 P 3 ：−0.552845464443627 P 6 ：−0.133491402119899 其中在不考虑视频质量的情况下，分析可得sLoading对于vMOS总分值的影响更大，因此在进行数据的反馈时应优先考虑提升sLoading的数值。同时如果能够根据对策论的理论，充分考虑PC端硬件条件对网络质量的影响及反馈，提出相应的更高效的测试方案，则可能会更有实际意义。  在网路侧传输一个视频过来时，单片机先通过芯片RTL8019AS先采集一定的数据，记录下sLoading与sStalling两个变量的数据，然后将数据经过筛选，挑出有效数值，经过一定的计算反馈给网络侧，而 Table 1 vMOS 主观意见 主观感受 5 优秀 非常舒适 4.5 非常流畅 4 良好 有感知、较流畅 3.5 有感知、带有一丝情绪 3 一般 较烦恼 2.5 非常烦恼 2 差 较恼火 1.5 非常恼火 1 很差 几乎无法观看 0.5 无法观看 表1. vMOS值对应的感知情况 网络侧则可以根据反馈回来的数据来对于视频源进行一定的调整从而达到提升整体vMOS值的效果。 同时，在数据采集与反馈这一过程中，视频源对于用户侧的视频传输一直不停止，而对于网络侧的反馈也持续进行着，形成动态模型，在不影响速度的同时，极大的提升了vMOS的数值。  通过对系统进行测试，证明该系统能够完整的收集和反馈数据，并具有功耗低、体积小、可靠性高等特点，具有良好的可扩展性和产品开发的伸展性。"
"随着LTE网络的发展，速率越来越快，用户流量越来越多。各类视频网站、APP和直播软件的普及，使得越来越多的用户使用4G网络观看视频。为了保障用户观看视频的体验，基于语言的vMOS值对视频video的MOS分进行评定，即vMOS，如何对vMOS进行体系的分析优化，形成视频体验提升的工作思路，是目前视频优化的迫切问题。 对于生产者来说，可自动测量网络数据并形成反馈回路的系统造价低廉，实用性高，模块化的设计使其更快捷地融入现有的电子移动产品中，从根本上提升网络视频质量，提高了产品的效益，加快了电子产品的转型。 对于用户来说，高质量的视频效果是用户所希望的。因此，通过优化初始缓冲时延、卡顿时长占比、初始缓冲峰值速率、播放阶段平均下载速率、E2ERTT之间的关系，使vMOS的KPI指标达到最优。 高质量的视频服务是用户侧的直接体验，本文所构建的具备反馈模块的系统能够很好的将视频服务体验值提高，对用户有着更舒适、良好的视频观看体验提供了保障，并且此系统的诞生对移动网络视频发展具有重要的作用，对日益增加的视频体验服务的发展具有指导意义。"
