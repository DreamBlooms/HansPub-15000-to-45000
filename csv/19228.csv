"本文针对调度自动化系统网络拓扑检测辨识存在的不足，挖掘系统基础数据之间的内在联系，提出了一种基于量测平衡指标和设备状态相似度寻优的支路与母线连接关系辨识方法，该方法建立在错误量测检测、辨识及修正的基础上，通过分析支路与母线的关联关系，定义了支路与母线关联关系岛，基于岛内各支路量测满足平衡关系的特征，通过搜索使岛内各节点量测平衡指标合格并与实际采集的设备状态具有尽可能高的相似度的支路母线连接关系，给出辨识结果。仿真分析和实际应用证明了该方法的有效性。 关键词 :量测平衡指标，设备状态相似度，支路与母线连接关系，辨识"
"对调度自动化系统而言，保持网络拓扑的正确十分重要，因为它将网络物理模型转化为分析计算用的数学模型，为电力系统状态估计、潮流计算、动态安全分析、无功优化、故障分析等提供基础网络结构数据 [ 1 ] [ 2 ] [ 3 ] [ 4 ] [ 5 ] 。网络拓扑的正确性是建立在正确的遥信数据基础上 [ 6 ] [ 7 ] [ 8 ] ，因而检测、辨识和修正网络结构的错误是调度自动化系统实时信息处理的重要内容。 常用的网络拓扑检测辨识方法，是利用开关的遥信及线路潮流的遥测检查其是否对应来发现可疑的遥信，然后用搜索法根据可能存在的网络结构形式，通过状态估计检查 [ 9 ] 是否小于门槛值来判别该类网络结构形式是否正确 [ 10 ] 。这种方法的优点是比较简单，对量测配置要求也比较低。但在多个结构错误与不良数据同时错误时可能出现失败。在国内大部分调度机构的自动化系统中，广泛采用的网络结构辨识也仅是采用比较遥测、遥信信号是否一致来单独完成，且只是在基础两遥数据粗检测阶段，给出提示告警信息，但在状态估计计算时并未采取进一步的辨识修正措施，而是基于实际采集的设备状态进行网络拓扑分析，由此导致计算结果与电网实际运行情况存在较大偏差。 本文针对调度自动化系统网络拓扑检测辨识存在的不足，挖掘系统基础数据之间的内在联系，提出了一种基于量测平衡指标和设备状态相似度寻优的支路与母线连接关系辨识方法，该方法建立在错误量测检测、辨识及修正的基础上，通过分析支路与母线的关联关系，定义了支路与母线关联关系岛，基于岛内各支路量测满足平衡关系的特征，通过搜索使岛内各节点量测平衡指标合格并与实际采集的设备状态具有尽可能高的相似度的支路母线连接关系，给出辨识结果。仿真分析和实际应用证明了该方法的有效性。"
"调度自动化系统上量测、状态数据的异常将导致量测平衡指标的异常，因此通过检测分析量测平衡指标的异常可检测并辨识异常的量测、状态数据。  设母线上间隔的测量CT变比为 ，PT变比为 ，因此该间隔功率的基准值为： 调度自动化系统的实用化标准规定，有功/无功功率量侧的允许误差为基准值的1%，也就是说，如果某一间隔的功率基准值为 ，那么依据上述的标准，如母线上总共连接有 个间隔(依据网络拓扑分析结果)，则允许的母线有功/无功功率量测平衡指标： (或) 换句话说，如果检测出母线有功/无功功率量测平衡指标的绝对值超出 ，则可以判定为母线量测平衡指标异常。  若线路总共关联了 个厂站(依据网络拓扑分析结果)，那么设每个厂站端的有功量测分别为 (考虑了功率参考正方向为流出母线为正，流入母线为负)，那么线路有功功率量测平衡指标为： (1-1) 式中 表示线路有功量测平衡指标。 设每个厂站端的功率基准值分别为 ，则允许的线路有功功率量测平衡指标为： (1-2) 式中 表示线路有功功率损耗。 设统计的线损率不超过 ，则可得到： ， (1-3) 式中 表示线路输入有功总加， 表示线路输出有功总加。 若设编号为 的间隔为线路的输入端，编号 的间隔为线路的输出端，则可以得到式(1-4)、(1-5): (1-4) 式中 表示线路输入有功量测总加。 (1-5) 式中 表示线路输出有功量测总加。 取 和 中的较小者，标识为 ，并代入式(1-2)，就得出如下线路有功功率量测平衡指标判据： (1-6) 当检测出线路有功功率量测平衡指标超出式(1-6)所示的数值范围时，即可判为异常。 变压器有功功率量测平衡指标的检测依据，推导方法与线路有功功率量测平衡指标检测依据类似，此处不再赘述。"
"搜索与量测平衡指标不合格的母线关联的支路，如果支路满足以下条件：1、端口数量不少于2个；2、该支路各端口上均配置了量测。则可以对支路的量测平衡指标进行检测。仍用 表示线路的量测平衡指标，用 表示不含本侧端口 的线路量测平衡指标。 如果 满足平衡判据，而 也满足平衡判据，则认为端口 未与节点相连；如果 满足平衡判据，而 不满足平衡判据，则认为端口 与节点相连； 如果 不满足平衡判据，需要对 之外的其它支路端口的量测进行检测。当满足以下条件时：1、对于与节点连接的支路端口，其所连接的节点的量测平衡指标满足平衡判据；2、对于未与节点连接的支路端口，其量测为0；可用 替代端口 的量测，且认为端口 与节点相连。 由于实际的调度自动化系统中检测到的平衡节点和平衡支路总是占多的，因此在绝大多数情况下，可以运用“由平衡节点修正不平衡支路，由平衡支路修正不平衡节点”的交替迭代计算方法对系统中的错误量测数据进行辨识和修正。  按附表1判定母线之间的联络关系，对状态置疑的母线联络关系则保持现状。  支路与母线之间的关联关系既可能是一对一的关系，即支路仅具有到其中1个母线的连通路径；也可能是一对多的关系，即支路具有到多个母线的连通路径。支路与母线之间的这种关联关系可以用图1的方式来表达。 形成若干彼此无连接关系的拓扑岛(图1(c)为一多岛，图1(d)为一单岛)。假设岛之间是不联络的，那么对于每一个岛而言，所有与之关联的支路潮流应满足平衡关系。 Table 1 分类 是否有联通路径 是否连接 是否配置量测 量测是否为0 连接状态判定 1 有 是 是 否 合并 2 有 是 是 是 置疑 3 有 是 否 - 置疑 4 有 否 是 否 置疑 5 有 否 是 是 分列 6 有 否 否 - 置疑 表1. 母线联络关系表 图1. (a)连接方式1；(b)连接方式2；(c)支路母线关联关系图1；(d)支路母线关联关系图2 如果所有错误的支路量测均得以修正，则某一电压等级下，所有相关的支路量测应满足量测平衡关系。那么可以记录下每一个岛的量测平衡指标。如果某一个岛的量测平衡指标合格，那么它就与其它岛之间不存在联络关系，反之它必然与其它岛之间存在联络。基于这一点，可进一步对岛间联络关系进行检验，同时对量测平衡指标不合格的岛，可尝试寻找岛间联络的路径，从而形成一个新的岛来满足量测平衡关系。   当一个岛的支路量测是平衡的，那么导致岛内节点量测平衡指标不合格的原因可分成以下三类：1、母线之间的联络关系错误(联络关系置疑)；2、量测非0的支路未与连接母线；3、支路与母线的连接关系错误。 如果支路边界连接点只有到1个母线的连通路径，且到该母线的连通路径不只1条，那么由于与同一个母线连通的路径在拓扑上无差别，为了判断哪一条路径符合实际情况，引入如下的判别方法： (1) 搜索路径通过的端口是否配置量测，若有，则将此量测与支路的量测进行比较，若两者差值充分小，则认为此路径是成立的； (2) 若所有的路径上都没有配置量测的端口，则基于设备状态出错属于小概率事件，引入相似度判别的方法对路径进行选择，方法如下：路径 和 均是支路边界节点通往某一母线的路径，假设路径成立，路径 上状态正确的元件数量是 ，状态错误的元件数量是 ；路径 上状态正确的元件数量是 ，状态错误的元件数量是 。那么两条路径的设备状态的相似度分别为： ， 通过比较 和 ，选择具有更大设备状态相似度的路径。 如果支路边界连接点有到不同母线的连通路径，则和支路与母线连接关系错误的问题类似，属于支路与母线连接关系不确定。  (1) 支路与母线连接路径编码 如上节所述，遗留两个问题，分别是“母线之间的联络关系不确定”和“支路与母线连接关系不确定”。根据实际电网接线和运行方式，对一条支路而言，最多与两条母线具有联络关系。依据这一特征，对支路与母线的连接关系和母线之间的联络关系进行编码：用 来表示支路与母线的连接关系，为“1”或“0”；用 来表示母线之间的联络关系。则对于一个岛而言，可对每一种支路与母线的连接关系进行编码，设支路数为 ，联络关系置疑的母线联络数为 ，编码为： (2) 合理的支路与母线连接关系应满足的原则 一是必须使得岛内的每一个节点的量测平衡指标合格；二是必须与实际采集的支路与母线连接关系具有尽可能高的相似度。 依据上述原则，以一个实际的220千伏变电站为例，220千伏出线数量为15回,状态置疑的母线联络关系为1个，如果要对该站220千伏支路与母线的连接关系进行辨识，则需要进行65,536 (216)次的验证，显然无法满足实用要求。 (3) 基于量测平衡指标和设备状态相似度寻优的方法 为了使辨识结果与实际采集获得的设备状态具有尽可能高的相似度，引入相似度函数，假定辨识结果与实际情况相符，则用辨识结果检验实际采集获得的设备状态，用 表示正确的支路与母线连接路径数，用 表示正确的母线联络关系数，相似度表示如下： 这样在寻优的过程中，不仅判别个体是否满足使岛内各节点的量测平衡指标合格，还应判别个体与实际采集的设备状态是否具有尽可能高的相似度。相似度进行选择，应考虑自动化系统设备状态遥信的配置情况和错误概率。一般情况下按2条支路连接路径(或者支路连接路径与母线联络的组合)发生偏差考虑。对于超出2个错误的情况，由于其发生的概率很低，因此不再予以考虑。上述相似度判别原则表示如下： 步骤1： 对子串 采取小概率变异操作 [ 11 ] ，随机改变其中的1个母线联络关系。若子串发生变异，则不改变支路与母线的连接关系，计算岛内各节点的量测平衡指标。假设第 个置疑的母线联络关系发生变异，则支路与母线连接关系的编码为： ，注： 为对 取反。 若子串未发生变异，则进行如下操作： 依据支路母线关联关系图，确定与支路关联的两个母线，当以下两个条件同时满足：①两个母线分属不同的节点；②支路量测值与所连接节点的量测平衡指标同向(支路量测与所连接节点的量测平衡指标同为正，或者同为负)，则该支路作为备选的1个可调整路径的支路。搜索所有可调整路径的支路，形成可调整路径支路集 。若支路集 非空，则从支路集 中随机选择1条支路，改变支路与母线的连接路径 [ 3 ] 。若支路集 为空，则搜索两个母线属于同一节点的支路，将该支路归入可调整路径支路集 ，从支路集 中随机选择1条支路，改变支路与母线的连接路径。 设调整支路 与母线的连接路径，则支路与母线连接关系编码为： 注: 为对 取反。 步骤2： 按上述的方法，重复 次后可以获得一个规模为 的种群，种群中的每一个体均对应了一种岛内各支路与母线的连接关系，可分别计算与之对应的岛内每一节点的量测平衡指标及设备状态相似度。对于能使所有节点量测平衡指标均合格且相似度符合要求的个体，将其记录下来，不再进行进一步的操作；反之，则重复步骤1的操作。此步骤完成后，可获得第1代的种群。 步骤3： 在第1代种群的基础上，重复步骤1、2，获得新1代的种群。经过若干代的操作后，可获得所有合理的支路与母线连接关系，最终给出辨识结果。 必须指出的，采用量测平衡指标结合设备状态相似度寻优的方法辨识支路与母线的连接关系，其目标并不是寻求使节点量测平衡指标最优的解，与实际相符的解往往并非量测平衡指标最优。因此在算法设计上尽可能地保证了个体的多样性，在每一代计算中同时对多个个体进行反复变异的操作，在获得可行解之后并未停止变异操作，而只是将其记录下来归入可行解集，这样有利于保证个体的多样性，从而保证算法最终能够获得所有可行解。此外，采取对多个个体同时进行反复变异操作的方法，也使得算法能够更快地获得所有可行解。 对子串 采取小概率变异操作，随机改变其中的1个母线联络关系，用于修正可疑的母线联络关系，避免了由于母线联络关系错误导致算法长时间得不到可行解。设置可调整路径支路集 ，防止当节点量测平衡指标合格后，无法继续调整支路与母线的连接路径，从而导致算法无法得到满足设备相似度要求的可行解。"
"以泉州电网220千伏清濛变110千伏系统为例，以下是调度自动化系统反映的初始数据断面(表2)： 由于本例中110千伏系统是一个典型的双母线接线，且所有支路的量测满足平衡关系，因此110千伏系统构成了一个单岛，可以采用本文所述的基于量测平衡指标及设备状态相似度寻优的支路与母线连接关系辨识方法。 (1) 改变清龟线184所连接的母线，仿真出1个错误的支路与母线连接关系，记作案例1，计算结果如下(表3和表4)。 寻优过程最终给出了一个唯一的可行解个体，该可行解在经过第1代计算后即已获得，自第2代后未再出现新的可行解。 (2) 改变清高I回191和清店II回193所连接的母线，仿真出1个错误的支路与母线连接关系，记作案例2，计算结果如下(表5和表6)。 由表4可知，寻优过程最终给出了3个可行解个体，这两个可行解在经过第1代计算后即已获得，自第2代后未再出现新的可行解。但单个个体则最少需要3代才能获得全部可行解，部分个体经历5代计算后仍只获得其中2可行解。 由以上的仿真分析可知，多数情况下算法给出的辨识结果是一个可行解集(如案例2)，并非是一个确定的解。产生这一问题的主要原因是存在量测接近的支路。进一步分析可知，当岛内各支路量测值之间的偏差越大时，可行解集中包含的解数量就越少，最理想的情况下可辨识出唯一符合实际情况的真实解。 Table 2 支路 开关 1母刀闸 2母刀闸 线路/主变刀闸 旁路刀闸 有功量测 无功量测 3号主变 18C 1 1 0 1 0 −77.3323 −17.6243 1号主变 18A 1 1 0 1 0 −71.8373 −16.016 2号主变18B 1 0 1 1 0 −57.6977 −9.64979 清加线182 1 1 0 1 0 8.94616 3.2166 清旗线185 1 0 1 1 0 9.38174 0.402074 清树线183 1 1 0 1 0 20.1037 4.05425 清高I回191 1 0 1 1 0 21.6115 6.83527 清店II回193 1 0 1 1 0 26.805 1.77583 清龟线184 1 1 0 1 0 24.091 6.26566 清店I回192 1 1 0 1 0 39.4033 8.77863 清塔线181 1 1 0 1 0 12.9334 1.77583 清高II回189 1 1 0 1 0 42.2178 8.91265 表2. 地区电网一次模型及实时断面 Table 3代次 第1代 第2代 第3代 第4代 第5代 个体1 110101001111 110101001111 110101001111 110101001111 110101001111 个体2 110101001111 110101001111 110101001111 110101001111 110101001111 个体3 110101001111 110101001111 110101001111 110101001111 110101001111 个体4 110101001111 110101001111 110101001111 110101001111 110101001111 个体5 110101001111 110101001111 110101001111 110101001111 110101001111 个体6 110101001111 110101001111 110101001111 110101001111 110101001111 个体7 110101001111 110101001111 110101001111 110101001111 110101001111 个体8 110101001111 110101001111 110101001111 110101001111 110101001111 个体9 110101001111 110101001111 110101001111 110101001111 110101001111 个体10 110101001111 110101001111 110101001111 110101001111 110101001111 个体11 110101001111 110101001111 110101001111 110101001111 110101001111 个体12 110101001111 110101001111 110101001111 110101001111 110101001111 表3. 案例1寻优过程各代计算结果 Table 4 代次 第1代 第2代 第3代 第4代 第5代 计算时间 130 165 168 117 81 表4. 案例1寻优过程各代计算时间(秒) Table 5代次 第1代 第2代 第3代 第4代 第5代 个体1 110101001111 110101001111 110100101111 110100101111 110001111011 个体2 110001111011 110101001111 110101001111 110001111011 110001111011 个体3 110001111011 110101001111 110101001111 110100101111 110100101111 个体4 110001111011 110100101111 110100101111 110101001111 110101001111 个体5 110001111011 110001111011 110001111011 110001111011 110100101111 个体6 110101001111 110100101111 110100101111 110100101111 110001111011 个体7 110001111011 110101001111 110100101111 110101001111 110101001111 个体8 110101001111 110101001111 110001111011 110100101111 110100101111 个体9 110101001111 110101001111 110001111011 110001111011 110001111011 个体10 110100101111 110100101111 110101001111 110101001111 110001111011 个体11 110101001111 110101001111 110100101111 110101001111 110101001111 个体12 110001111011 110101001111 110100101111 110001111011 110001111011 表5. 案例2寻优过程各代计算结果 Table 6 代次 第1代 第2代 第3代 第4代 第5代 计算时间 149 55 57 68 63 表6. 案例2寻优过程各代计算时间(秒) 由于算法是基于对有功量测平衡指标和设备状态相似度进行寻优，因此在获得可行解集后尚需对各可行解做进一步验证，方法如下： 假定可行解成立，对岛内各节点的无功量测平衡指标进行验证，滤除无功量测平衡指标不合格的解。如案例2中，对可行解集中的3个解进行验证，其中解“110100101111”不满足节点2(即2母线)无功量测平衡指标要求，解“110001111011”不满足节点1、2 (即1、2母线)无功量测平衡指标要求，故这2个解均被排除，剩余的1个解“110101001111”经验证能够满足使节点1、2的无功量测平衡指标合格，因此该解作为最终的辨识结果。 大量仿真试验表明，只需对节点无功量测平衡指标进行验证就可获得与实际相符的解。当然也不排除通过节点无功量测平衡指标验证后仍存在多个可行解的情况，此时可采用与前一个数据断面比较(假定前一个数据断面下岛内各节点的有功、无功量测平衡指标均合格)的方法，由于只有进行了倒母操作才可能出现支路与母线连接关系变化，因此可以找出与母线连接关系发生变化的支路，供调度员进行确认，从而滤除与实际不符的解。仍以本节的算例进行分析，对清店I、II回进行倒母操作，若两回线路与母线的连接关系错误，则计算后将获得2个有功、无功量测平衡指标均合格的解，分别为“110101011101”和“110101001111”，由于倒母前的状态为“110101011011”，前一个解对应的状态说明1、2号主变与母线的连接关系均发生了变化，与实际情况不符，所以被排除。"
"本文所提出的支路与母线连接关系辨识方法，建立在错误量测检测、辨识及修正的基础上，通过分析支路与母线的关联关系，定义支路与母线关联关系岛，基于岛内各支路量测满足平衡关系的特征，通过搜索使岛内各节点量测平衡指标合格并与实际采集的设备状态具有尽可能高的相似度的支路母线连接关系，给出辨识结果。实际应用表明该方法具有辨识准确性高、计算速度快、实用性强的特点，对于提高调度自动化系统基础数据的准确性和可靠性起到了良好的作用。"
