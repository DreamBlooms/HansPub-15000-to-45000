"针对粗差含量较高的点云数据拟合，提出了改进的选权迭代算法：通过最小截断二乘获取稳健的初值，在迭代过程中利用混合总体最小二乘估计控制迭代次数。将该改进算法运用在点云数据平面和球面拟合中的结果表明：该方法在粗差含量较高时仍具有很好的拟合结果。 关键词 :点云数据拟合，选权迭代算法，粗差，最小截断二乘算法，混合总体最小二乘 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"为了进行目标的三维重建，一般利用三维激光扫描仪或全站扫描仪对目标进行扫描 [ 1 ] ，快速获取目标的点云数据，然后对点云数据进行特征面拟合，得到目标的几何模型。特征面拟合方法一般有最小二乘估计、总体最小二乘估计、混合总体最小二乘估计等，对于含有粗差的点云拟合，常用的方法有稳健特征值法 [ 2 ] 、随机一致性抽样法 [ 3 ] 和选权迭代法 [ 4 ] 等。 选权迭代法采用一个增长慢的函数 ρ ( v i ) 代替残差平方和 v i 2 进行最小二乘平差，通过迭代的方式来减小粗差点的权值从而平滑粗差对平差结果的影响 [ 5 ] 。但当粗差含量达到一定限度时，选权迭代法得到的几何基元将偏离基准值。鉴于此，有必要对选权迭代法进行改进：一方面，在选权迭代拟合算法中引入最小截断二乘估值作为选权迭代的初值，以有效提高算法的稳健性；另一方面，在迭代评判标准上，利用混合总体最小二乘估计代替最小二乘估计，其中混合总体最小二乘同时考虑了拟合模型中系数矩阵和观测向量存在误差。通过上述改进，拟合精度将得到提高。"
"最小截断二乘(Least Trimmed Squares, LTS)是一种稳健估计方法，与最小二乘估计中使目标函数中所有观测值的残差平方和达到最小不同，LTS估计主要思想是将观测值的残差平方和升序排列，并取排在前一半的残差平方和最小时对应的估值作为最优估计值。由于LTS估计对局外点的影响不敏感，可以达到50%的崩溃点，因此它具有很强的稳健性 [ 6 ] 。 利用最小截断二乘法进行稳健初值估计时需要考虑全部观测值中任意截断个数的所有组合，由于点云数据量大，故可采用随机抽样法对LTS估值做近似计算，具体实现操作如下： 1) 从点云数据集(总个数为p)中随机抽取n + 1个点(n为确定拟合模型参数所需的最少点个数)，利用最小二乘法估计参数； 2) 计算点云中所有点在到每次抽样估计模型中的残差，对残差平方进行升序排序，计算前h(h = int(p + n + 1)/2)个残差的平方和作为抽样拟合质量的评价指标。 3) 确定抽样次数N，重复N次上述计算，选取残差平方和最小所对应的模型参数作为选权迭代估计的初值。  选权迭代法中常用的权函数主要有Huber权函数、Hampel权函数、丹麦权函数和IGG系列权函数等。考虑到Huber权函数和丹麦权函数没有淘汰段，抗差能力与其他函数相比较弱，而Hampel权函数表达形式更为复杂，模型选择IGG III方案作为算法的权函数 [ 7 ] 。 p ¯ i = { p i | v i / m v | ≤ k 0 k 0 | v i / m v | ( k 1 − | v i / m v | k 1 − k 0 ) p i k 0 < | v i / m v | ≤ k 1 0 k 1 < | v i / m v | (1) 式中 p ¯ i 为等价权对角元素； p i 为前一次迭代计算所得权值，对于几何基元点云数据拟合，认为观测数据为等精度测量，故设定初始权矩阵为单位阵； v i 为残差，迭代开始前的残差以最小二乘估计计算求得； m v 为中误差； k 0 、 k 1 为常数，一般取 k 0 = 1.5 ， k 1 = 2.5 。  利用混合总体最小二乘进行参数估计。当本次估计参数与前次估计参数的差值小于设定值时迭代终止。 混合总体最小二乘法是将最小二乘法和总体最小二乘法结合起来，不仅解决了观测向量和系数矩阵存在随机误差时的参数估计，还顾及到系数矩阵中存在常数项的问题 [ 8 ] 。 总体最小二乘的观测方程为 ( A + Δ A ) X = L + Δ L ，当系数矩阵 A 中存在常数项时，可以对系数矩阵 进行分块，即 A = [ A 1 A 2 ] ，其中 A 1 为系数矩阵的常数列， A 2 为除去常数列后的系数矩阵。相对应的未知数 X 分块为 X = [ X 1 X 2 ] T ，其中 X 1 为 A 1 相对应的未知参数构成的矩阵， X 2 为 A 2 相对应的未知参数构成的矩阵。混合总体最小二乘的观测方程为： A 1 X 1 + ( A 2 + Δ A 2 ) X 2 = L + Δ L 。  以最小截断二乘的参数估计为初始参数，以单位权作为初始权函数，进行选权迭代计算，利用混合总体最小二乘进行迭代参数估值，当前后两次迭代参数估值的差小于某一较小数时，迭代停止，此时将后一次得到的参数估值输出作为模型参数的最优解。 根据上述步骤，改进的选权迭代算法可以由图1所示。"
"为验证改进的选权迭代拟合算法在点云数据平面拟合中的有效性，自选平面方程z = −1.70998x − 1.73205y + 14.14214，利用MATLAB编程进行拟合仿真实验。 随机从自选平面中随机抽取5000个点组成平面点云数据，将模拟点三维坐标(x,y,z)方向上均加入随机误差v~N(0,0.002)形成非粗差点，点云数据如图2所示。分别用于选权迭代法和改进的选权迭代法进行参数拟合，结果见表1和表2中粗差含量为0%的拟合结果。 设定粗差比例从5%逐次增加到30%共模拟6组数据，分别利用选权迭代法和改进的选权迭代拟合算法对平面进行拟合，结果见表1和表2。 实验发现，当不含粗差或粗差较小时，这两种方法均能较好地进行平面拟合，且精度较高，当粗差含量增大时，利用选权迭代法拟合平面精度逐渐降低，而改进的选权迭代拟合算法结果仍能保持很高的精度。 图1. 改进的选权迭代拟合算法流程图 图2. 模拟平面点云数据 图3. 模拟球面点云数据 Table 1 粗差含量 a Δa b Δb c Δc 0% −1.70997 0.00001 −1.73196 0.00009 14.14163 −0.00051 5% −1.70901 0.00097 −1.73067 0.00138 14.13920 −0.00294 10% −1.70178 0.00820 −1.72592 0.00613 14.12973 −0.01241 15% −1.70223 0.00775 −1.71821 0.01384 14.11785 −0.02429 20% −1.69908 0.01090 −1.71208 0.01997 14.11875 −0.02339 25% −1.69627 0.01371 −1.70850 0.02355 14.11378 −0.02836 30% −1.69507 0.01491 −1.70642 0.02563 14.09013 −0.05201 表1. 各粗差含量下选权迭代法平面拟合结果 Table 2 粗差含量 a Δa b Δb c Δc 0% −1.70997 0.00001 −1.73199 0.00006 14.14190 −0.00024 5% −1.70995 0.00003 −1.73204 0.00001 14.14196 −0.00018 10% −1.70999 −0.00001 −1.73206 −0.00001 14.14211 −0.00003 15% −1.71002 −0.00004 −1.73206 −0.00001 14.14242 0.00028 20% −1.71001 −0.00003 −1.73210 −0.00005 14.14252 0.00038 25% −1.71000 −0.00002 −1.73209 −0.00004 14.14246 0.00032 30% −1.70999 −0.00001 −1.73208 −0.00003 14.14231 0.00017 表2. 各粗差含量下改进的选权迭代拟合算法平面拟合结果 Table 3 粗差含量 x0 Δx0 y0 Δy0 z0 Δz0 R0 ΔR0 0% 9.99999 −0.00001 9.99995 −0.00005 0.99988 −0.00012 14.14211 −0.00002 5% 10.00005 0.00010 10.00002 0.00000 1.00005 0.00005 14.14205 −0.00008 10% 10.00060 0.00060 10.00040 0.00040 1.00072 0.00072 14.14211 −0.00002 15% 10.00093 0.00093 10.00312 0.00312 1.00393 0.00393 14.14224 0.00011 20% 10.01005 0.01005 10.00784 0.00784 1.00933 0.00933 14.14208 −0.00005 25% 10.02539 0.02539 10.02502 0.02502 1.02694 0.02694 14.14085 −0.00128 30% 10.04310 0.04310 10.04861 0.04861 1.04941 0.04941 14.14246 0.00033 表3. 各粗差含量下选权迭代法球面拟合结果 Table 4 粗差含量 x0 Δx0 y0 Δy0 z0 Δz0 R0 ΔR0 0% 9.99997 −0.00003 9.99992 −0.00008 0.99990 −0.00010 14.14214 0.00000 5% 9.99994 −0.00006 10.00003 0.00003 0.99999 −0.00001 14.14209 −0.00004 10% 9.99999 −0.00001 10.00004 0.00004 0.99999 −0.00001 14.14212 −0.00001 15% 9.99987 −0.00013 10.00000 0.00000 0.99997 −0.00003 14.14211 −0.00002 20% 9.99996 −0.00004 9.99995 −0.00005 0.99999 −0.00001 14.14209 −0.00004 25% 10.00000 0.00000 9.99992 −0.00008 0.99998 −0.00002 14.14211 −0.00002 30% 9.99995 −0.00005 9.99997 −0.00003 1.00006 0.00006 14.14209 −0.00004 表4. 各粗差含量下改进的选权迭代拟合算法球面拟合结果"
"与空间平面拟合类似，为验证改进的选权迭代拟合算法用于球面点云数据拟合的有效性，自选球面方程 ( x − 10 ) 2 + ( y − 10 ) 2 + ( z − 1 ) 2 = 200 ，利用MATLAB编程进行拟合仿真实验。 从自选平面中随机抽取5000个点组成球面点云数据，同样在所有模拟点三维坐标(x, y, z)方向上均加入随机误差v~N(0,0.002)形成非粗差点，点云数据如图3所示。 设定粗差比例从5%逐次增加到30%共模拟6组数据，分别利用选权迭代法和改进的选权迭代拟合算法对球面进行拟合，结果见表3和表4。实验结果发现，当粗差含量增多时，利用选权迭代法拟合球面精度逐渐降低，而改进的选权迭代拟合算法结果仍能保持很高的精度。"
"改进的选权迭代法首先通过最小截断二乘获取稳健的初值，其次在迭代过程中利用混合总体最小二乘估计控制迭代次数，综合考虑了系数矩阵和观测向量的误差。经过这两次改进，在粗差含量较高时也能获得很好的拟合结果。试验结果表明：当粗差含量不高时，采用选权迭代法和改进的选权迭代法均能获得较好的平面和球面拟合模型。当粗差含量逐步增加时，选权迭代模型随粗差含量的增加而导致拟合效果下降，而改进的选权迭代法仍然得到理想的拟合结果。"
