"本文提出了一种包含不确定性风电出力的随机机组组合模型。模型的目标函数考虑电力系统运行的机组启停费用和煤耗特性数学期望值的最小化。在约束中考虑在一定置信水平下满足系统备用约束，从而有利于保证系统运行的可靠性。结合本文模型的特点，基于随机规划的采样平均近似方法设计了新的组合SAA算法。最后给出10机组系统的仿真分析，验证了模型的合理性和算法的有效性。 关键词 :风电出力，机组组合，随机规划，采样平均近似算法 Copyright © 2018 by author and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"近年，风电作为一种可持续性，零碳排放的能源得到了大力的发展。受到国家政策的扶持，《可再生能源法》确定可再生能源在电网调度中优先全额上网。然而，风电的大规模并网，给电力系统的安全运行提出了更多的要求和挑战。由于风电间歇性和随机性的特点，对于风电接入的电力系统的许多问题需要用不确定性的方法来解决。 机组组合是电网调度的重要决策过程，包括制定机组最优启停计划和出力计划，是非线性混合整数规划问题。大规模风电并网，电力系统增加了很多不确定性的因素，传统的电力系统处理方法是设计有限的不确定量作为预留。这种方法并不能处理风电应用中无法预料规模的各种变化。所以，大规模风电接入要求先进的电力系统运行方式以保障系统运行的安全性。 由于风电的间歇性和随机性，含风电电力系统机组组合问题变得更加困难。为了应对这种不确定性，在含风电的机组组合问题中引入了数学中的不确定性理论，主要有随机向量及其概率理论，随机规划理论，模糊理论及模糊规划。 文献 [ 1 ] 用场景树技术模拟风电出力情况，建立含风电机组组合的两阶段随机规划模型，然后直接利用CPLEX软件求解进行了计算验证。文献 [ 2 ] 同样基于场景树技术对风电的不确定性进行建模，建立了基于机会约束规划的数学模型，算法采用了离散离子群和等微增率准则相结合的算法。重点放在对风电出力的预测和模拟方面。文献 [ 3 ] 把风电功率的区间预测信息加入到日前机组组合模型中，提出了一种有效的改进量子离散粒子群算法求解模型。这些模型的工作主要集中在用场景树或者概率预测来模型风电出力，然后建立模型求解。 文献 [ 4 ] 利用模糊理论，将大规模的间歇式电源出力和负荷作为模糊参数，建立含多模糊参数的模糊机会约束机组组合数学模型，用置信水平控制风险，用改进的二进制粒子群算法求解。文献 [ 5 ] 以概率的形式描述相关约束条件，建立了基于机会约束规划的含风电场的电力系统机组组合的两层优化数学模型。内外层规划分别用离散粒子群算法和改进粒子群算法求解，并引入启发式搜索策略。文献 [ 6 ] 建立了风电出力偏差的概率密度函数，基于机会约束规划方法构建了考虑负荷预测误差、风电出力偏差以及发电机组的故障停运等不确定随机因素的旋转备用获取模型。模型通过设定旋转备用被满足的概率大于给定的置信度水平的约束条件，反映了旋转备用充裕水平对系统经济性的影响。最后通过遗传算法求解机组模型。文献 [ 7 ] 引入风电可信度指标，风电功率用随机变量表示，然后建立关于风电功率的机会约束，并提出三种策略确保系统运行的安全性。最后利用SAA方法求解。这几类模型主要考虑在机组组合的系统约束中用随机机会约束或者模糊机会约束代替原确定性机组组合中的确定性约束。然后利用启发式的算法求解。一个重要共同点是不确定性因素影响没有在机组组合问题的目标函数中体现出来。 文献 [ 8 ] 针对风电出力并网利用率建立机会约束—两阶段随机机组组合模型，解决的问题是保证风电出力能最大程度并网的前提下机组运行费用最小。文献 [ 9 ] 同时考虑在放松管制的电力市场中电力市场价格，风电出力不确定性，最大化发电厂商利润的模型。建立了两阶段和机会约束的随机机组组合模型，不过它们的重点都是考虑风电并网利用率的保证以确保发电费用最少或者发电厂商利润最优化。 本文结合上述几类模型的特点，利用随机向量描述风电出力的不确定性。电力系统的运行费用分两部分两个阶段。第一阶段最小化机组启停费用和效用函数(即煤耗特性)的期望费用，效用函数即第二阶段目标函数是最小化电力系统的煤耗特性。第一阶段机组启停决策阶段，第二阶段考虑风电出力随机性的机组出力决策阶段。在机组组合问题约束条件里，除了确定性的约束条件以外，功率平衡约束加入了风电出力，同时旋转备用约束考虑为在一定置信水平条件下的机会约束。本文的模型保证机组出力的随机性控制在一定的水平之内，同时权衡系统运行费用和风险水平。模型的求解利用随机规划SAA方法，首先把模型转化为对应的SAA问题，设计求解SAA问题的联合算法，理论分析算法的可行性和有效性，最后在IEEE 10机组系统进行数值计算和模型验证。"
"本文模型基于数学规划里的随机规划理论。随机规划是用来描述不确定优化的主要理论之一。随机规划主要分为两大类，第一类是机会约束随机规划问题 min x ∈ X f ( x ) s .t .     P r { G ( x , ξ ) ≤ 0 } ≥ 1 − ε (1) f ( x ) 为目标函数， x 表示决策向量， X ∈ R n 表示确定性的可行域， ξ 为服从某概率分布的随机向量。 ε ∈ ( 0 , 1 ) 称作机会约束规划的风险水平或者置信水平。 P r { G ( x , ξ ) ≤ 0 } ≥ 1 − ε (2) 称作机会约束。模型表示在约束条件以概率 1 − ε 满足的条件下，求目标函数的最小值。 另一类是两阶段的随机规划 min x ∈ X c T x + E [ Q ( x , ξ ) ] s .t .     A x = b , x ≥ 0 Q ( x , ξ ) = min y f ( x , y ) s .t .     T x + W y ≤ h , y ≥ 0. (3) 其中 x 表示第一阶段的决策变量， y 表示第二阶段的决策变量， ξ 为服从某概率分布的随机向量。模型表示，第一阶段优化问题的决策先于随机向量 ξ 的实现，第二阶段优化问题，是在第一阶段决策确定，以及 ξ 完全确定后追索费用(recourse cost)的最小化。 采样平均近似法是求解两类随机问题的有效方法。文献 [ 10 ] - [ 16 ] 对SAA方法针对各种随机规划问题做了大量的详细研究。SAA方法的基本思想是用随机向量的经验分布近似其真实的分布，通过Monte Carlo采样方法产生关于随机向量的一系列样本。然后用样本统计量代替模型中涉及到的随机量。最常见的有用样本平均数去近似数学期望，用关于约束指标函数的方法去描述机会约束。把原问题转化为对应的确定性的SAA问题去求解，用SAA问题的解作为原问题的近似最优解。 本文所建立模型和涉及的算法都是基于上述随机规划的两种基本模型，采样平均近似方法，以及概率统计的相关知识。  这里直接给出随机机组组合问题的模型，关于经典的机组组合问题的模型，及其算法可参阅文献 [ 17 ] [ 18 ] [ 19 ] [ 20 ] 。针对风电随机性，用服从某种概率分布的随机变量描述风电出力。根据机组组合模型的特点目标函数分为两部分，机组启停费用和系统煤耗特性。受文献 [ 8 ] 启发，结合两阶段随机规划的特点，建立如下目标函数。 第一阶段的目标函数为 F = min u ( ∑ t = 1 T ∑ i = 1 N C i , t + E ξ [ Q ( u i , t , ξ ) ] ) (4) 第二阶段的目标函数为 Q ( u i , t , ξ ) = min P ∑ t = 1 T ∑ i = 1 N f i ( u i , t , P i , t ) (5) 式中： F 是第一阶段的目标函数，表示总的发电成本，包括机组启停费用和煤耗特性的数学期望； Q ( u i , t , ξ ) 是第二阶段的目标函数，表示随机向量 ξ 实现后的机组煤耗特性的最小值； i ， t 分别表示火电机组，时段数； T ， N 分别表示调度周期时段总数，火电机组数； u i , t 表示机组 i 在时刻 t 的启停状态，是第一阶段的决策变量， P i , t 表示火电机组 i 在时刻 j 的出力，是第二阶段的决策变量； C i , t 表示启机组 i 在 t 时刻动费用，可用分段函数表示； f i ( u i , t , P i , t ) 为火电机组的煤耗特性是二次函数，计算中可以用分段线性一次函数来近似。 与文献 [ 8 ] 不同的是，文献 [ 8 ] 中把由风电随机性产生的出力短缺量作为第二阶段的决策变量，由此把由于风电出力短缺造成的损失作为第二阶段的目标函数。  在机组组合问题中，风电接入电力系统，主要影响系统的功率平衡约束和旋转备用约束等系统约束条件。常规火电机组组合问题中的出力约束，最小开停机时间，爬坡能力约束等机组约束条件与经典模型相同。 以下只列出含风电电力系统的功率平衡约束和旋转备用约束。 1) 含风电系统的功率平衡约束。 本文的模型考虑功率平衡始终满足，火电机组和风电场同时供电，满足系统的负荷需求，类似于其他文献把风电出力直接写入功率平衡约束中 ∑ i = 1 N P i , t + P W , t ( ξ ) = P D , t (6) 其中 P W , t ( ξ ) 是随机向量，表示风电在 t 时刻的出力预测值。 2) 含风电系统的旋转备用约束 由于风电的接入，对电网的安全稳定运行带来重要影响。在确定系统旋转备用时必须考虑风电的影响。系统的旋转备用约束表示成机会约束形式 Pr ( ∑ i = 1 N u i , t P ¯ i + P W , t ( ξ ) − P D , t − R t ≥ 0 ) ≤ ε (7) 表示系统的旋转备用在一定的置信水平下满足。 ε 为备用约束成立的置信水平，置信水平的高低反应了对电力系统运行水平的要求。决策人员可以根据对电力系统了解以及风电出力预测水平的高低让电力系统在一定置信水平下预留备用。 模型的另一个特点是把两阶段的随机模型和机会约束联合到一个模型中来考虑，既分阶段考虑了机组启停和煤耗特性两部分优化问题，同时考虑了风电接入对系统约束中旋转备用的影响，以机会约束形式来描述风电接入后系统的旋转备用要求。"
"根据以上分析，为了简化记号和叙述，含风电的两阶段–机会约束随机机组组合模型可简写为如下的紧凑数学形式。 模型第一阶段优化问题如下 min   c T u + E ξ [ Q ( u , ξ ) ] s .t .     A u ≤ b , u ∈ { 0 , 1 } (8) 第二阶段优化问题是 Q ( u , ξ ) = min f ( u , p ) s .t .     W p + T u ≥ h ( ξ )             q ( u , ξ ) ≤ ε             p ≥ 0 (9) 其中 q ( u ) ≤ ε 表示旋转备用机会约束。 首先建立SAA问题，设 ξ 1 , ⋯ , ξ S 是随机向量 ξ 的 S 个样本，第一阶段目标函数中的数学期望 E ξ [ Q ( u , ξ ) ] 由样本均值函数 S − 1 ∑ n = 1 S Q ( u , ξ n ) 代替。样本均值函数是数学期望的无偏估计。 由文献 [ 11 ] 假设 q ^ S ( u ) : = S − 1 ∑ s = 1 S 1 ( 0 , ∞ ) ( G ( u , ξ s ) ) (10) 其中 G ( u , ξ s ) = u i , t P ¯ i + P W , t ( ξ s ) − P D , t − R t (11) 表示随机变量取样本 ξ s 对应旋转备用约束条件。其中 1 ( 0 , ∞ ) 是一个指标函数，当 G ( u , ξ s ) ≥ 0 ，函数值取1，否则取0。即 q ^ S ( u ) 等于所有样本中条件 G ( u , ξ ) ≥ 0 成立个数的百分比。 通过上述SAA方法，两阶段–机会约束随机机组组合模型就转化为如下的SAA问题 min c T u + S − 1 ∑ s = 1 S Q ( u , ξ s ) s .t .     A u ≤ b             H p + T u ≥ h ( ξ s )             q ^ S ( u ) ≤ γ             Q ( u , ξ s ) ≥ f ( u , p )             u ∈ { 0 , 1 } , p ≥ 0 , s = 1 , ⋯ , S (12) 上述SAA问题的解，在满足一些条件下可以收敛到原问题模型的解。 引理1 [ 12 ] 当样本数量 S 趋于无穷大时SAA问题的最优值依概率1收敛到原问题的最优值。 引理2 [ 13 ] 对于问题(2)其对应的SAA问题的近似解有如下结论 1 − P ( X ^ S δ ⊂ X ε ) ≤ | X | e − S γ ( δ , ε ) (13) 式中 X ε ， X ^ S δ 分别表示原问题最优解的某个半径为 ε 区域，对应SAA的最优解的某个半径为 δ 的区域。样本数S可以由下面的式子来估计 S ≥ 3 σ 2 ( ε ′ − δ ) 2 log ( X α ) (14) 引理3 [ 14 ] 当样本数量 S 趋于无穷大时， q ^ S ( u ) 依概率1收敛到 q ( u ) 。 由上述引理1，2，3结合本文模型的特点，容易得到如下结论 定理 对于两阶段-机会约束的随机机组组合问题(4-7)，及其对应的SAA问题(8-9)，当样本数量 S 趋于无穷大时，SAA问题的最优值依概率1收敛到原问题的最优值，SAA问题的 δ 近似解区域以一定的概率包含于原问题的 ε 最优解区域。 采样平均近似方法即SAA方法，是处理各类随机规划问题的有效方法之一，也是研究随机问题首选方法和常用方法。本节简要介绍了两阶段随机规划和机会约束的采样平均近似的基本做法。并简要叙述了证明思路。详细的关于SAA方法的理论及应用可见参考文献 [ 10 ] - [ 16 ] 。  上一节得到的SAA问题是一个确定型的问题，是混合整数线性规划。确定性机组组合问题本文参考文献 [ 14 ] - [ 19 ] ，用确定性大算法来求解。 设 v ^ S 和 v * 分别表示SAA问题的最优值和原问题的最优值，对SAA问题做 M 次数值实验，可用如下方法构造问题的统计上下界。 根据文献 [ 12 ] ，假设 v ¯ S M = 1 M ∑ m = 1 M v ^ S m (15) 上式是 E [ v ^ S ] 的一个无偏估计，那么得到 v * 的一个下界。 对于SAA问题的某一个最优解 x ¯ 。产生 S ′ 个独立样本 ξ 1 , ⋯ , ξ S ′ ，假设 g ^ S ′ ( u ¯ ) = c T u ¯ + 1 S ′ ∑ s = 1 S ′ Q ( u ¯ , ξ s ) (16) g ^ S ′ ( u ¯ ) 是 c T u ¯ + E ξ Q ( u ¯ , ξ ) 的一个无偏估计，可以看出 g ^ S ′ ( u ¯ ) 给出了原问题一个最优值的上界。  根据上述思路，可以写出求解两阶段–机会约束随机规划的算法如下 对 m = 1 , ⋯ , M ，重复下面的步骤 第一步：产生风电出力的随机样本 ξ 1 , ⋯ , ξ S a) 求解对应的SAA问题。 设 x ^ S m 为SAA问题的解向量， v ^ S m 为SAA问题的最优值。 b) 由式(15)计算 v ¯ S M 。 第二步：产生独立的随机样本 ξ 1 , ⋯ , ξ S ′ ，然后由式(16)计算估计 g ^ S ′ ( u ^ S m ) 。 第三步：对每一个 x ^ S m ， m = 1 , ⋯ , M ，估计误差 g ^ S ′ ( u ^ S m ) − v ¯ S M 。 第四步：选择 g ^ S ′ ( u ^ S m ) 作为原问题的近似最优值，选择 M 个解其中的一个作为原问题的近似最优解。"
"本文采用10机组系统算例，加入一个风电场进行计算和分析。10台常规火电机组的机组参数和负荷取值等详见文献 [ 21 ] 。加入的风电场的额定功率为50 MW，并且假设24个时段的风电出力服从多元正态分布，每一个时段风电出力的均值为10~50，每个时段的标准差设为期望值的45%。风电场的多元正态假设参考自文献 [ 8 ] 。全部仿真计算采用Matlab2012b软件编写并调用CPLEX程序，运行计算机参数为Intel Core i3-2120，CPU 3.30GHz，4G内存。 本文模型为随机规划模型，数据中包含多元正态随机变量，为检验模型的合理性和有效性，所有数值实验都是多次独立重复计算多次。算法中 M 的取值相对较小，一般取 M = 5 。  首先考虑不同置信水平对系统最小运行费用的影响。场景数选择为10，计算结果表1。 从计算结果中看出，置信水平要求越高，相应的运行费用和计算时间都在提高，置信水平越低，运行费用和计算时间相对较低。置信水平高低反映了旋转备用约束的满足情况。在对电力系统可靠性评估的基础上，可靠性比较高的系统可以考虑以更低的置信水平留系统备用，从而可以在一定程度上降低系统的运行费用。反之，为了保证系统的运行可靠性，设置更高的置信水平，则要付出更高的系统运行费用。  模型假设风电完全被吸纳，并不考虑风电建设维护等费用。在固定旋转备用机会约束的置信水平为90%下，还是选取10场景为计算的场景数。计算得机组的启停计划见表2。 从结果看出，本文模型能给出在风电接入条件下，并考虑机会约束旋转备用的电力系统的机组启停计划。实际计算表明迭代次数较少，所用时间也较短。  本文事先假设了风电出力的多元正态分布，有很多文献讨论风电出力预测的方法，并且有很好的预测结果。3.2节的定理说明模型的收敛性和收敛速度依赖于场景规模，即场景数量。接下来计算在不同场景规模下模型的仿真结果，如表3。S表示算法第一步中场景数量，即计算最优目标值下限时场景数量，S’表示算法第二步所取场景的数量，也即计算最优目标值下限的场景数量。 Table 1 置信水平 最优值/$ cpu时间/s 80% 522870 0.65 85% 523800 0.67 90% 525010 0.68 95% 525340 0.70 表1. 不同置信水平下最小费用及cpu计算时间 Table 2 T N 1 2 3 4 5 6 7 8 9 10 11 1 8 1 1 1 1 1 1 1 1 1 1 1 2 8 1 1 1 1 1 1 1 1 1 1 1 3 6 0 0 0 1 1 1 1 1 1 1 1 4 5 0 0 0 0 0 1 1 1 1 1 1 5 5 0 0 0 0 0 0 0 1 1 1 1 6 3 0 0 0 0 0 0 0 0 1 1 1 7 3 0 0 0 0 0 0 0 0 0 1 1 8 1 0 0 0 0 0 0 0 0 0 0 1 9 1 0 0 0 0 0 0 0 0 0 0 1 10 1 0 0 0 0 0 0 0 0 0 0 0 表2. 10场景置信水平为90%的机组启停机计划 Table 3 场景规模(S,S’) 下界，上界 间隙比 5，5 524690，526340 0.4% 10，10 525360，526420 0.35% 15，15 525900，527980 0.3% 20，20 525830，526890 0.2% 表3. 不同场景规模下数值实验结果 计算结果表明，随着场景规模的增大，最优目标值的上下界间隙比下降，说明其收敛速度在加快。需要说明的是计算过程中，会出现内存溢出的情况，这是因为SAA方法以及场景方法增加了计算量，因此在如何有效减少还有进一步的工作需要做。"
"风电接入电网，其随机性和间歇性使得电网调度运行的难度大大增加。本文对传统的机组组合模型进行了改进，建立了基于随机规划的两阶段和机会约束相结合的联合机组组合模型。本文以多元正态分布函数描述风电出力，最小化风电接入后的机组启停费用和煤耗特性的数学期望，同时考虑系统旋转备用的机会约束。基于随机规划的最优化SAA方法，设计了组合SAA算法，理论上保证了收敛性和收敛速度。仿真结果表明本文模型能合理解决风电接入的电力系统的机组组合问题，在有效时间内给出相应的机组启停计划，还能利用电力系统的可靠性，调整启停计划，从而节约系统运行费用。本文的模型和方法也可用于对电力系统其他随机问题的处理作参考。最后算法还可以根据风电预测结果做进一步的改进和提升。"
