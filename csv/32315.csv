"本文介绍了进行工业互联网建设的必要性，针对高速列车生产线研究了基于西门子数控系统的设备接口，阐述了生产线和上层信息管理系统的集成解决方案，提出了设备自动数据采集和系统集成方法。通过在青岛四方的实践证明，本文的研究对于在轨道交通装备制造行业中推广应用工业互联网技术具有一定的借鉴意义。 关键词 :工业互联网，设备接口，系统集成 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"为推进中国制造2025 [ 1 ] ，工信部2016年组织实施了“智能制造综合标准化与新模式应用”系列项目，高铁作为国家名片，中车青岛四方公司承担了“高速动车组关键零部件智能制造新模式应用项目”的实施。智能制造是中国制造2025的主攻方向，主要目的是实现制造业的数字化、网络化、智能化，建设工业互联网成为发达国家重塑制造业竞争优势的关键举措 [ 2 ] 。 生产线和业务系统之间存在信息交互的鸿沟，这就对制造过程信息采集和集成提出更高的要求。信息的采集和集成是现代企业实施信息化战略的迫切需求，只有将制造过程中各种信息准确采集和有效集成，才能及时准确掌握制造过程中的动态信息，从而为提高生产效率和资源利用率提供支持。建设和推广工业互联网平台是促进我国制造业提质增效和转型升级的重要抓手 [ 3 ] 。"
"在车间层进行工业互联网建设的核心内容在于对现场的不同品牌、型号以及控制系统的设备进行联网，以采集其设备状态参数、工作进度信息等基础数据。随着设备智能化水平的不断提升，车间设备数据采集技术在通讯方式上从串口通信向以太网通信方式转变，数据传输距离更远，带宽更大，速率更高，数据采集内容也变得更为丰富、细致。不同型号和控制系统的设备对于通讯接口的支持也更为全面，从之前的专有系统接口的方式，纳入了对于OPC/OPC-UA等公共体系标准的支持，大大降低了设备数据采集的门槛。 为了追求产品高质量、制造过程稳定性、少人化，企业配置一套由桁架机器人、加工中心、上下料输送系统、条码自动识别系统等组成的自动化生产线，生产线内部采用PROFIBUS或PROFINET总线实现桁架机器人和加工中心动作控制、安全连锁，同时桁架机器人配置控制中心，实现物料加工过程的流程定制，桁架机器人的动作设置等，具备一定过程数据收集能力，产线基本组成情况如图1所示。 图1. 车轴自动加工生产线 同时全面实施的制造执行系统MES，面向生产现场管理，将在制品、原材料、设备状态、质量等信息进行实时收集和汇总，在MES系统中，考虑人力资源配置，往往需要做人员能力分析和过程追溯，对生产计划可以进行有效分解。 车轴的生产采用先进自动化生产线，生产线具有自动上下料、自动调度、自动输送等功能，提升质量、效率明显，但生产线PLC系统无法实时获取到生产计划 [ 4 ] ，生产线本身可以实时获取工件、加工时间、开工、完工数据也无法向MES系统反馈，生产线已记录人员在岗情况。因上游系统和生产线、物料、人员等相互独立，导致生产线和MES系统无法互联互通，无法发挥智能制造优势。开展生产过程的物联网建设，助力企业转型升级，成为技术人员急需攻关对象。"
"通过对车轴生产线加工设备研究，设备采用西门子840D、840D SL数控系统，可提供以太网接口通讯，基于windows XP系统，网卡采用VIA Rhine III，通过数控系统的COMPANY NETWORK接口，利用TCP/IP协议，可实现机床联网。 OPC UA是一个高度集成、开放和共享的数据服务平台，可以实现工厂内的控制系统和信息系统的互联互通，以及物料、产品、设备与人的无缝集成 [ 5 ] 。西门子同时提供DDE和OPC UA接口，用于上层系统和数控系统的通讯。通过在数控系统配置DDE监测程序，将用户输入的数据或者需要读取的内容通过DDE方式传送给作为服务器的西门子840D数控系统，再由数控系统将返回的数据通过DDE发送给用户端 [ 6 ] 。西门子提供了专门用于二次开发的OPC 技术的自动化接口，使用户通过OPC接口存取NCK中的各个变量和数据 [ 7 ] 。 在840D数控系统上安装DDE GATEWAY网关，可实现设备状态和刀具参数自动采集。针对840D SL数控系统，网络直接连接PCU的X130端口，在PCU的HMI中安装DDE GATEWAY网关，实现数据采集目的。针对不支持DDE GATEWAY网关的数控设备，通过在服务器搭建OPC服务，配置840D SL数控系统的OPC UA，实现数控设备状态和刀具参数的实时采集。通过SIEMENS系统机床自带的网卡采集实时信息，如机床开机关机时间、空闲时间、空转时间、加工时间、报警时间等机床的工作状态信息 [ 8 ] ，网络系统架构见图2。 图2. 数据采集网络架构 车轴生产线的桁架控制系统采用S7-300 PLC，系统没有PCU和人机交互界面HMI，需对桁架机器人的PLC内DB数据块存储数据逐项分析，确定DB块含义、DB地址与工位对应关系。分析工件二维码、工件状态、工序步骤、桁架机器人位置、状态所在DB数据块地址。 Webservice是微软提出的基于互联网的开发模型，它通过Web通讯协议和信息格式的开放标准(Http，Xml，Soap)来为其他应用程序提供服务 [ 9 ] 。基于既有的制造执行系统MES，利用标准接口，采用WebService方式，获得车轴生产线工单，根据实时采集的制造过程数据，利用接口上传在岗人员、物料、过程、质量数据。"
"首先实施机床联网，设置生产线中840D数控系统网络的IP地址，将所有设备统一到一个网络。利用西门子高级权限进入windows系统，通过设置工厂网络的网卡IP地址，安装基于DDE相应监测程序，获得机床数据。840D的PCU在前面板，将网线连接PCU网络至工业交换机。针对车轴加工生产线桁架控制系统，采用WINSCP管理平台，利用X120端口进入西门子管理NCU界面，将X120、X130端口打开，通过设置X130端口IP地址，通过设置OPC服务，实现对X120端口访问。将所有设备连接至工业交换机，在设备层面形成物联网。 建立数据采集平台，通过在服务器搭建数据采集系统，实时采集数控设备和桁架机器人中的数据。通过服务器和设备数控系统监测程序建立连接，实时获得加工设备数据，包括机床当前工作状态、程序版本、主轴负载、转速、进给、倍率、坐标等信息，采集设备数据见图3，通过平台展示见图4。 图3. 设备采集实时数据 图4. 设备数据实时采集展示 通过Siemens S7协议实时读取桁架PLC DB块数据，采集车轴线桁架机器人PLC内数据，获得桁架位置信息、加工设备状态、工件编号、上料系统、下料系统、缓冲区物料状态，获得每个车轴的加工时序、加工时间，存储至数据库中。采集桁架机器人数据见图5。 图5. 桁架机器人实时采集数据 数据采集平台通过接收MES系统生产计划，结合实时采集到的桁架机器人、数控设备数据、在岗人员，实现生产计划和人员、物料、设备建立关联，实现计划自动开报工，打通从计划到设备数据链。在服务器端搭建B/S站点，提供网页访问服务，在客户端通过浏览器可以实时查看生产线运行情况，让管理者更加有效的掌握车间信息，详见图6。实时展示的数据统计，如利用率分析、报警信息统计、年度信息汇总和数图展现，为管理者提供决策支持，形成一套完整的生产过程决策支持系统 [ 10 ] 。 图6. 实时数据分析"
"随着边缘计算 [ 11 ] 、5G [ 12 ] 等新技术在智能制造领域中的应用，车间设备数据采集在实现路径上可能会有全新的应用模式出现。对于跨平台、跨控制系统的不同品牌设备，可以通过将类似于OPC服务的中间件部署于边缘端，同时对所采集数据进行边缘端的优化处理，降低网络传输压力，提升控制指令传输实时响应速度。5G则是对数据传输通道的一次根本性变革，传统的有线传输方式有可能在工业5G无线网络的覆盖下被彻底取消。 本文基于企业实际需求，结合中国制造2025国家战略，研究了生产线和上层制造执行系统MES的系统集成软硬件接口，通过建设数据采集平台，将设备、物料、人员和生产计划有效集成形成工业互联网。实践证明，通过对设备自动采集，结合生产计划控制，有效发挥数字化制造效能，助力企业工艺改进、合理决策提升核心竞争力。"
