"以南水北调中线工程水源区—丹江口水库和周围丹江支流淇河以及老鹳河的汇水区域为研究对象，利用已有水质监测数据，结合河流污染物混合衰减模型，采取点面、部分与整体相结合原则，以组件式GIS软件ArcEngine 9.3为开发平台，采用C#2008编程语言，以ACCESS2003为数据库，进行水环境容量计算，开发了水环境容量动态展示系统，实现了污染物不能降解、污染物浓度稳定、忽略纵向离散系数三种情况下的水环境容量计算及动态展示和空间、属性数据的显示、查询、保存及输出功能。 关键词 :南水北调，中线工程，水源地，水环境容量，动态展示 Copyright © 2018 by authors and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"南水北调中线工程(以下简称中线工程)是实现国家水资源整体优化配置、缓解华北地区水资源短缺的重大战略性基础设施，是有效缓解北方及沿线城市生活和工农业生产严重缺水状况的关键性工程。该工程从丹江口水库引水，经河南省方城县，沿唐白河流域和黄淮海平原西部边缘开挖渠道，在郑州以西用隧洞穿过黄河，沿京广铁路西侧北上，自流到北京、天津，输水总干渠全长1246 km。工程主要向湖北、河南、河北、北京及天津5省、直辖市供水，年调水量130亿m 3 ~140亿m 3 。该工程水源区主要指丹江口库区周边及上游的整个积水区域 [ 1 ] [ 2 ] [ 3 ] [ 4 ] [ 5 ] 。 水环境容量是环境容量的重要组成部分，是容量总量技术体系的核心内容之一，是环境的自然规律与社会效益等参数多变量的函数，既反映了污染物在环境中迁移、转化和积存规律，也反映特定条件下环境对污染物的承受能力，是制定水资源保护和社会经济发展规划的重要依据，并在制定水污染物排放标准、水污染控制和水资源规划、管理等方面得到广泛应用 [ 6 ] [ 7 ] [ 8 ] [ 9 ] [ 10 ] 。 本文以中线工程水源区丹江口水库和周围丹江支流淇河以及老鹳河的汇水区域为研究区域，按点面结合、部分与整体相结合原则进行水环境容量综合研究，开发基于ArcEngine的水环境容量动态展示系统，为用户提供各种水环境容量信息查询、检索和必要计算，为水源区的发展预测、规划决策、水环境建设及管理提供可靠依据。"
"结合GIS工具软件与可视化开发语言的集成二次开发方式是GIS应用的开发主流。选择熟悉的开发工具，旨在缩短开发周期、减少成本。选择功能完备、价格便宜的GIS平台，以减少软件投资。本系统采用开发平台如图1所示： 图1. 水环境容量动态展示系统开发平台  组件式GIS是基于标准的组件式平台，是以一组具有标准通信接口、允许跨语言应用组件提供的GIS，各组件之间不仅可自由、灵活地重组，且具有可视化界面和符合ActiveX控件规范的标准接口，在Delphi，Visual C++，Visual Basic，Power Builder等编程工具编制的应用程序中，可直接将GIS功能嵌入其中，实现GIS的各种功能。 ComGIS技术的基本思想就是把GIS的各大功能模块根据性质的不同划分为一个或几个控件，每个控件完成特定的功能，各个GIS控件之间，以及GIS控件与其它非GIS控件之间，通过面向对象的可视化开发工具集成起来，形成最终的GIS应用系统。组件式GIS是面向对象技术和组件技术在GIS软件技术开发中的应用，其控件与其他软件通过标准接口进行通信，实现跨程序、跨计算机、跨网络的分布式操作。 鉴于以上优点，本系统GIS平台使用ArcGIS Engine 9.3，采用ArcEngine组件技术，可使用任何支持COM编程语言对ArcGIS平台的基本控件AO (ArcObjects)基础函数进行集成和二次开发，实现能够脱离ArcGIS而独立运行的应用程序。ArcEngine可帮助用户实现地图漫游和缩放、地图要素查询和标注及专题图制作、统计分析等最基本的地图操作功能。  本系统选择高效的Visual C#，是因它完全支持ActiveX控件的应用，对数据库的支持也很完备，能提供完全可视化、面向对象的编程环境，同时还能开发出一流的用户界面，易于系统使用。 在Visual C#环境下结合ArcEngine对系统进行开发，可方便将地图处理功能嵌入应用程序中，并可编译成exe文件，脱离ArcGIS软件平台运行。同时，ArcEngine能简单快速地在数据库管理系统中嵌入地图化功能，以增强系统空间的查询和分析能力。  Access是微软公司推出的基于Windows桌面关系数据库管理系统(RDBMS)，是Office系列应用软件之一 [ 11 ] 。它提供了表、查询、窗体、报表、页、宏、模块7种用来建立数据库系统的对象；提供了多种向导、生成器、模板，把数据存储、查询、界面设计、报表生成等操作规范化。本系统数据量小，结构简单，将数据存储在Access表中，在Visual C#环境下通过数据库引擎OleDB与Access表相连，用SQL语句等方式直接访问表中数据。  本系统软件运行平台为Windows 2000及以上操作系统。此外，系统运行还需要ArcGISRunTime 9.3。"
"水质模型又称水质数学模型，是描述水质要素(BOD，DO等)在其他因素(物理、化学、生物等)作用下随时间和空间变化关系的数学表达式。污染物进入河流后就与河水混合，可按先后顺序称其为初始稀释阶段、二维扩散阶段和一维纵向分散阶段的三个阶段 [ 12 ] 。 本系统在计算时运用了一维水质模型中的河流中污染物混合衰减模型，其微分方程式 [ 13 ] 如下： (1) 式中：C代表污染物浓度(g/L)；t代表时间(s)；Ex代表纵向离均系数(m 2 /s)；x是沿程距离(m)；u是河流流速(m/s)；k为污染物综合衰减系数(d-1)。 在实际应用中，为简化计算，常采用以下简化模型： 1) 污染物浓度是稳定的 在水流处于稳定流动状态，污染源连续稳定排放情况下，水中污染物分布状况趋稳定。这时污染物在某一空间位置的浓度不随时间变化，称其为稳态 [ 14 ] 。污染物浓度稳定模型属于一维稳态水质模型，假定只在X方 向上存在污染物浓度梯度，即 ∂ C ∂ t = 0 ，则由(1)式易知： E x ∗ ∂ 2 C ∂ x 2 − u ∗ ∂ C ∂ x − k ∗ C = 0 ⇒ ∂ 2 C ∂ x 2 − u E x ∗ ∂ C ∂ x − k E x ∗ C = 0 ⇒ C ( x ) = C 0 ∗ exp [ u 2 E x ( 1 − 1 + 4 k E x u 2 ) ∗ x ] (2) 式中：C(x)为计算断面污染物浓度(mg/L)；C 0 为基准断面污染物的本底浓度(mg/L)；x为计算断面至基准断面的距离(m)。参数u、Ex、k的意义同公式(1)。 2) 污染物不能降解 此简化模型适用于特定的不易降解污染物类型，其衰减系数k = 0，则由(1)式易知： ∂ 2 C ∂ x 2 − u E x ∗ ∂ C ∂ x = 0 ⇒ C ( x ) = C 0 ∗ exp ( − u E x * x ) (3) 式中：C(x)、C 0 、u、x、Ex等参数意义同公式(2) 3) 忽略纵向离均系数 对于宽深比不大的河流，短期内污染物在断面内能均匀混合，污染物浓度在断面上横向变化不大，可用一维水质模型模拟污染物沿河流纵向迁移来计算纳污能力。在稳态或准稳态情况下，Ex = 0，则由(1)式易知： ∂ C ∂ x = − k u ∗ C ⇒ C ( x ) = C 0 ∗ exp ( − k u ∗ x ) (4) 式中：k为污染物综合衰减系数(d-1)；C(x)、C 0 、u、x等参数意义同公式(2)。 4) 均匀分布概化河段水环境计算公式 概化为均匀分布即设定污染物排放在同一个河段内沿河均匀分布，并认为污染源源强在同一功能区内沿河均匀分布，其计算公式为： m = k Q x u ∗ C ( x ) − C 0 ∗ exp ( − k x u ) 1 − exp ( − k x u ) (5) 式中：m为纳污能力(g/s)；Q为河段设计流量(m 3 /s)；其他参数意义同公式(4)。"
"水环境容量计算是掌握和评价水环境质量的重要内容，是对水环境总量进行统一配置与管理的依据。它既有描述地理特征的信息，又有反映不同时间水资源质与量的属性数据。这些信息还有分布存储、存储量大和格式繁多的特点。为此，利用GIS强大空间信息管理能力、动态分析功能和输出与打印等功能，设计基于组件式GIS技术的水环境容量动态展示系统。旨在计算机软、硬件支持下，结合河流中污染物混合衰减模型实现对水环境容量的计算、管理、查询和输出。  本系统分为数据显示、数据查询、水环境容量计算、帮助及退出五大模块。数据显示模块主要用于地图放大、缩小等基本操作；数据查询主要是连接数据库，提供几种不同监测断面水质数据查询方式；水环境容量计算是本系统的核心模块，依据三种不同水质模型，输入相应参数进行计算、展示和结果保存；帮助模块是帮助用户快速了解系统功能，熟悉操作；退出模块用于系统退出，若用户在规定时间内未有任何操作，系统将关闭。  根据系统目标、设计原则以及总体设计的要求，系统结构设计如图2： 图2. 中线工程水源区水环境容量动态展示系统结构设计图  数据库是GIS的核心部分，包括空间特征数据和属性特征数据两部分。 1) 空间数据 空间数据按便于不同部门需求信息的提取与使用、便于数据拓扑关系建立、便于数字化及后续处理工作等原则分层组织。系统所用数据为水源区河流分布图，按地图中地物类型，依ArcGIS数据分层组织方法，将地图信息分为pollutmonitors图层(点图层)、河流图层(线图层)和nydjk2图层(面图层)，各图层中都包含几何数据和属性数据。其中pollutmonitors图层含水源区断面数据；河流图层含河流数据；nydjk2图层含丹江口水库数据。 2) 属性数据 属性数据通常用关系数据库来存储管理，并对空间数据补充，主要有两个来源：一是矢量化时生成的属性数据，另一个来源是建立Access数据库，将一些地物信息存入其中。本系统应用第二种属性数据。 由于河流在一年内会经历丰水期、平水期和枯水期三阶段，各阶段水环境容量计算参数均不相同，因此系统在ACCESS中建立了断面、丰年期断面、枯年期断面和平年期断面的水质数据库。该数据库用于存储全年不同时期各断面的水质数据。其中丰年期断面水质数据库是提取丰年期各断面的监测数据，包括用于水环境容量计算的高锰酸盐、氨氮、生化需氧量和溶解氧量等污染物数据，如表1。 Table 1 河流 断面名称 高锰酸盐(g/L) 氨氮(g/L) 生化需氧量(g/L) 溶解氧(g/L) 起始断面 终止断面 距离(m) 丹江 高湾 3.21 0.12 6.53 8.89 界碑 高湾 0.236 丹江 史家湾 6.4 0.85 5.9 7.5 高湾 史家湾 0.122 丹江 界碑 5.6 0.43 4.4 6.5 界碑 0.1 丹江口水库 陶盆 3.1 0.37 2 9.82 丁河 封弯 6.77 0.94 4.55 6.42 西峡水电站 封弯 0.046 老灌河 张营 14.25 1.59 6.84 5.9 垱子岭 张营 0.145 老灌河 垱子岭 6.57 1.57 5 6.1 东台子 垱子岭 0.078 老灌河 西峡水文站 10.73 2.86 6.11 5.23 徐营 西峡水电站 0.14 老灌河 徐营 4.21 0.61 3.21 7.5 杨河 徐营 0.11 老灌河 杨河 4.74 0.89 3.47 7.39 三道河 杨河 0.41 老灌河 三道河 3.91 0.54 4.01 6.44 三道河 0.24 淇河 高湾 5.9 1.33 3.1 6.71 上河 高湾 0.224 淇河 上河 6.14 1.74 4.7 7.02 下河 上河 0.292 淇河 下河 7.24 1.13 3.83 7.01 下河 0.426 蛇尾河 东台子 5.51 0.39 2.88 7.5 封弯 东台子 0.038 表1. 丰年期断面水质数据库 数据库中“起始断面”、“终止断面”是按断面位置、河流流向及干支流关系来确定，“距离”则是在地图矢量化过程中通过计算得到。平年期、枯年期的断面水质数据库建立方法与丰年期一致。"
"系统采用Visual C#作为可视化编程语言，结合ArcEngine 9.3开发。在Visual C#环境下与Access数据库连接，用SQL语句访问表中数据，实现对水环境容量信息管理。同时利用ArcEngine组件提供的各种属性、方法和工具，能进行空间数据展示、数据查询和数据计算，以实现对水环境容量计算信息的管理。  1) 用户即水环境容量动态展示系统的使用者，作为人机交互的界面环境，需考虑人们操作习惯和接受能力，使应用程序在视觉感受、概念语义上易理解，易于操作。系统颜色搭配合理，并由菜单栏区、工具条区、地图主显示区、鹰眼显示区、状态栏区等五部分组成。 2) 主界面具有如下三个特点：① 基于面向用户，使用汉字菜单及提示，操作简单方便；② 采用基于Windows风格的用户界面，使用窗口、菜单，图标、对话符号操作来完成系统应用；③ 各类菜单、窗口、工具、按钮等保持一致，便于用户使用。  本系统包括数据显示、数据查询、水环境容量计算、帮助、退出五大模块。  数据显示模块由工具条、图层控制区、图层显示区、鹰眼显示区、状态栏及最大与最小化、关闭等组成，用于显示水源区监测点、河流及丹江口水库的基本信息，还有鹰眼功能，可实时显示屏幕放大区域在总区域范围内的位置，并在屏幕下方状态栏可动态实时显示坐标信息以及鼠标所在处点的X、Y坐标。  此模块主要用到数据库连接，提供了按时段数据、断面和条件等三种查询方式。 1) 按时段数据查询 丰年、平年、枯年水量不同，故各断面上污染物检测指标值不同，本系统提供了按丰、平、枯三种时段数据分别查询的方式，结果将以地图和表格两种形式展示。 系统还提供了对结果表格的打印输出功能。单击“打印输出”即以Excel表格形式输出，表格还可动态更新打印日期。单击“保存”即可将结果保存在合适位置。 2) 按断面查询 本系统按断面查询提供了两种实现方式，即在ComboBox中选择断面名称查询和直接通过鼠标在地图显示区点选查询。 此项查询功能也提供表格打印输出功能，操作步骤同按时段数据查询。 3) 按条件查询 此查询是对高锰酸盐、氨氮、生化需氧量和溶解氧四种污染物浓度选择查询，分别在数据项、关系下拉列表框中选择之后，在目标文本框中输入数值，单击“查询”即可，此功能也配合按时段数据查询。  该模块为系统核心模块，计算时运用了前述水质模型中的河流中污染物混合衰减模型。由污染物浓度稳定(式3-2)、污染物不能降解(式3-3)和忽略纵向离均系数(式3-4)三种简化计算公式可知，计算时需输入多个参数，因此系统分别设置了时段、计算因子、断面、计算类型供选择。计算时还需在河流流速、纵向离均系数、衰减系数等各文本框中输入相应参数，在主界面中菜单栏里单击“水环境容量计算”，即弹出水环境容量计算界面。 该模块的断面设置中提供了2种方式，即在起始断面下拉列表框里选择和直接在地图显示区单击选择。由于一个起始断面只对应唯一的一个终止断面，因此系统未提供终止断面点的选择，而是在选择起始断面同时即生成终止断面。故在断面设置后，起始断面在地图上以“START”图标来显示，终止断面以“END”图标来显示。 在计算数据设置中，按三种简化模型产生三种不同算法。 在忽略纵向离散系数计算类型中，不需输入纵向离均系数，故纵向离均系数文本框中显示“不需要此参数”，在污染物不能降解计算类型中，不需输入衰减系数，故衰减系数文本框中显示“不需要此参数”。 以起始断面西峡水文站为例，采用污染物的浓度是稳定的计算类型，单击“计算”键，出现结果界面，之后点击“保存结果”，弹出“是”或“否”将结果进行保存的提示框，之后根据需要进行结果保存。 另外，本模块还提供地图制图功能，可为地图添加边框、比例尺、指北针以及保存为*.mxd文档。  帮助模块为系统提供帮助文件，用户通过查看帮助文件即可了解系统所有功能模块及各模块的操作与说明；该模块应用AE和WinCHM软件来实现用系统功能。退出模块用于系统退出。若用户在一分钟之内不执行任何操作，系统即关闭。"
"1) 本文以南水北调中线工程水源区为研究对象，从河流中污染物混合衰减模型、数据库建立等方面着手，分析研究了水环境容量计算方法、空间和属性数据的关联及系统平台建立；同时利用水源区水系图，结合网上搜集信息，运用C# 2008开发了水源地水环境容量动态展示系统(含数据显示、数据查询、水环境容量计算、帮助和退出等模块)，实现了水环境容量计算和动态展示。 2) 为及时掌握区域水环境污染物排放削减与增加对水环境质量影响之间的动态变化，必须加强对排污总量的控制、分配和管理。作者认为，在水环境保护领域广泛引入、推广地理信息系统同时，应充分利用地理信息系统强大图形编辑、空间数据处理功能，建立综合查询平台，为决策和管理提供模拟现实的空间环境。 3) 本文对水环境容量计算与GIS结合技术进行了初步探讨，但因受多种条件限制，尚未对一些问题更深层次探讨，在今后工作中将继续完善和深入研究。"
