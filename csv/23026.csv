"针对智能变电站现场调试难度大、调试效率低和黑箱化的问题，本文从测试角度出发提出了一套可视化自动测试系统。该系统采用模块接口标准化的设计思路，将测试过程分层分类，实现高效的闭环自动测试。针对SCD (Substation Configuration Description，全站系统配置文件)文件进行深度解析，可以实现IED (Intelligent Electronic Device，智能电子设备)装置的分散布局以拓扑结构图的形式一体化显示，将装置之间的虚拟连接情况具体化显示，统一管理测试进度和智能化配置。测试时能够实现闭环自动测试，降低测试难度，测试完成后能自动形成标准格式的测试报告，极大地提高了工作的效率和可靠性。 关键词 :智能变电站，可视化自动测试系统，闭环自动测试，模块接口标准化，SCD文件 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"智能变电站以智能设备信息数字化采集、网络化通信以及标准化共享等功能为基础 [ 1 ] [ 2 ] [ 3 ] ，并遵循IEC61850标准进行设备建模。随着SV/GOOSE报文在装置中的应用，装置测试过程中除了常规的功能测试外，还需要增加模型文件一致性测试、虚端子测试、报文异常测试等，这大大增加了现场调试工作的难度和工作量 [ 4 ] [ 5 ] [ 6 ] 。目前针对智能变电站内保护测控类装置的常规功能测试已有部分厂家实现了自动测试，而对于现场整个测试过程的可视化自动测试还没有相关研究 [ 7 ] [ 8 ] [ 9 ] 。通过整站设备的可视化、测试任务的可视化，不仅提高了现场测试的效率和可靠性，更方便现场人员对整站测试任务的理解 [ 10 ] 。 本文主要对智能变电站可视化自动测试系统进行研究与开发，该系统采用可视化的设计思路 [ 11 ] ，实现了站内保护装置、测控装置、合并单元以及智能终端等装置的可视化展示，还增加了在可视化界面对各IED装置各项功能测试任务的自动调用，并增加了IED设备测试所需的测试仪配置、各测试任务测试模板的智能生成接口。对SCD文件进行深度解析，在各IED装置可视化展示的基础上，对各项测试功能进行分类，并针对不同类型的功能设计生成对应的自动测试方案。所开发的自动测试系统能够克服现场测试中测试项目抽象不易理解，测试工作效率低以及测试数据格式不统一等缺点，提高了测试的工作效率、降低人为干预以及规范了数据输出格式。"
"全站系统配置文件(substation configuration description, SCD)，SCD文件描述了智能变电站内一次系统结构、二次IED设备数据模型和各IED之间的逻辑关系，以及与其他变电站相关联的信息。SCD文件的内容遵循IEC61850协议的标准，完整描述各IED之间的关系，它将智能变电站整合成为一个功能完善的变电站自动化系统 [ 12 ] 。 SCD文件中包含了全站所有的虚拟回路信息和实际通信参数，利用SCD文件对整站各IED装置的测试进程进行可视化。首先对SCD文件进行深入解析 [ 13 ] ，提取有用信息，然后生成具备统一标准格式的概要信息文件以供整站测试时使用，同时输出每个IED的设备模型信息及配置信息，供后续测试时调用，SCD文件解析示意图如图1所示。  SCD文件各节点以树形层次结构组织起来，完整的文件由Header、Substation、Communication、IED、DataTypeTemplates五大部分组成，按照各部分功能构成分别对其进行解析，SCD文件树结构图如图2示。 在SCD文件中一个SV/GOOSE报文的完整配置包括三个部分：控制块参数(SampledValueControl, GSEControl)、通信参数(SMV, GSE)、数据集配置(DataSet)。通过比对IED的name、访问点的name、LD的实例名inst和控制块的name找到与控制块匹配的SMV/GSE；通过比对控制块的dataSet属性和数据集DataSet的name找到与控制块匹配的DataSet。 SV/GOOSE的引用描述建立虚端子连线的过程如下：Inputs节点下的任一外部引用，根据该引用指定的iedName、ldInst可找到外部信号所在的IED和逻辑设备LDevice，遍历该LDevice下所有DataSet 图1. SCD文件解析示意图 图2. SCD文件树形结构图 条目，通过比对ldInst、prefix、lnClass、lnInst、doName和daName可找到匹配的数据集条目。通过该外部引用条目订阅的外部IED下对应的SV/GOOSE控制块的对应数据集条目，建立虚端子连线。  采用制造报文规范(MMS)的C语言编程接口MMSLite的方式对SCD文件进行解析，生成整站SCD结构对象，提取可视化展示及功能测试过程中需要用到的有效的信息。提取功能设计如下： 1) 装置描述信息：将IED装置类型分为保护装置、测控装置、智能终端、合并单元等，根据name属性值自动识别出该装置的类型、电压等级、所属间隔等信息；通过对type、manufacturer、desc等属性的解析提取出该IED的装置型号、生产厂家、IED名称等内容； 2) SV/GOOSE连线信息：获取LN0节点下的SampledValueControl、GSEControl控制块，通过关联关系遍历查找到对应输出数据集，获取数据集中的所有数据信息形成本IED的SV/GOOSE输出控制块；获取LN0节点下的Inputs子节点，根据路径信息遍历整个SCD文件获取关联的IED装置下的SV/GOOSE控制块； 3) 报文参数信息：获取各SV/GOOSE控制块的MAC地址、APPID、所在IED名称、数据集名称、控制块索引、SV/GOOSE标识、ASDU数、采样率、最大允许生存时间等等参数信息，并与对应接收端控制块进行关联； 4) 设备数据模型信息：描述IED装置的逻辑设备、数据集的详细定义，以及各数据集的数据对象详细定义。包含了与测试相关的全部信息，模型信息主要用于与IED装置进行MMS通讯，获取相关定值、压板、报告等信息； 5) 物理端口信息：包括了各IED装置与站控层通讯的IP地址信息，各SV/GOOSE控制块输入或输出所用板卡号及光口号信息。"
"本文研究的智能变电站的可视化方案，特点在于对所有被测装置和装置测试任务的可视化管理。通过SCD文件解析的概要信息文件，直接绘制整个变电站结构；同时将IED装置的分散布局以拓扑结构图的形式一体化显示，将装置之间的虚拟连接情况具体化显示，统一管理测试进度，实现智能化配置，测试时能够实现闭环自动测试，降低测试难度，提高测试效率。  为了整站IED装置的测试工作变得更加直观和具体。整站可视化技术的目标主要包括以下几点： 1) 以标准格式图形模块展示各IED装置的基本信息(见图3)，包括：装置间隔描述的中文信息、全站唯一的name属性值信息、装置IP地址、SV/GOOSE控制块连接接口等； 2) 直观显示每个变电站的拓扑结构及SV/GOOSE控制块的输入输出关系，图中绿色粗线表示GOOSE网，红色粗线表示SV网；装置通过GIN、SVIN接口接收SV/GOOSE网发出的报文，通过GOUT、SVOUT将报文发送给SV/GOOSE网； 3) 增加IED装置整个测试任务测试的进入接口，包括模型文件一致性测试、虚端子测试、保护测控功能测试、联闭锁测试等，以及测试报告导出的功能； 4) 记录不同智能变电站的当前测试进度。 用TinyXML解析工具解析输出的整站概要信息文件，采用列表视图、图形视图两种方式进行可视化展示。图3为图形视图界面，列表视图详细记录近期完成或未完成的各个变电站测试任务列表，能够新建测试任务、详细显示站内所有IED的测试信息，具体包括每一个IED设备的编号、名称、描述、生产厂家、设备型号、测试人、模型测试、虚端子测试、功能测试、下载任务时间以及上传报告时间和报告 位置等信息。图形视图显示各IED之间的拓扑关系结构图，并且提供进入各IED装置各测试项的进入接口，通过接口直接进入当前项目的测试，根据当前IED的提取信息自动完成测试项目模板的生成，进入测试执行程序完成测试过程，自动生成标准格式报告 [ 14 ] 。  单装置SV/GOOSE输入输出的可视化视图直接展示当前装置与站内其它二次设备直接的通讯联系信息，见图4，可视化实现过程如下： 图3. 可视化软件整站IED连线图 图4. 可视化软件单装置连线图 1) 在概要信息文件中提取当前IED的所有SVIN、SVOUT、GOOSEIN、GOOSEOUT信息，找到与之关联的对侧装置； 2) 绘制具有连线关系的IED装置的图形视图，在概要文件中获取需要展示的描述信息； 3) 通过连线箭头展示IED装置间的输入输出关系，连线信息关联该控制块虚端子描述可视化展示的消息； 4) 各IED图形界面同样提供该装置各测试项的进入接口。  根据控制块类型的不同可分为采样值控制块虚端子、GOOSE控制块虚端子；两者关联的虚端子的数据类型不同，采样值控制块以电压值、电流值通道为主，采用整型；GOOSE控制块以表示开关量及时间信息为主的布尔类型、双位置、UTCTime类型。 虚端子连线可视化界面见图5，具体流程设计如下： 1) 获取输出端的SV/GOOSE控制块信息，绘制其可视化视图，包括IED名称、控制块报文的AppID、MAC地址及控制块关联数据集下的所有通道名称和数据类型； 2) 获取输入端Inputs中的所有通道信息，绘制输入端可视化视图，包括IED名称、各通道名称及数据类型； 3) 将输入输出端通道中具有有效连线的通道进行连线，箭头明确方向关系。"
"可视化自动测试系统整体架构分别体现为硬件和软件设计两部分。 图5. 可视化软件虚端子连线图  本测试系统硬件构成主要包括测试主机、交换机、数字测试仪以及IED装置 [ 15 ] 等，硬件结构如图6所示。 由图6可知，在测试主机上安装智能变电站可视化自动测试系统软件平台，因此所有自动测试的控制均在测试主机上完成，测试主机与测试仪、IED装置经由交换机形成闭环测试的通讯链路，数字测试仪和被测IED装置之间通过光纤连接，其他回路通过电信号的网络线连接。  可视化自动测试软件系统是实现智能变电站可视化自动测试的核心组成部分，软件系统在设计上充分考虑如下几点： 1) 在可视化的实现部分分别展示整站设备拓扑连线图、单装置相关连线图、SV/GOOSE控制块虚端子连线图，以列表方式展示整站各IED设备的测试任务及当前完成状态； 2) 能够根据从SCD中提取的概要信息文件自动生成全部或部分IED装置各测试项的测试模板，以此保证测试效率； 3) 除IED装置功能测试项目的自动测试外，增加装置设备数据模型一致性测试、虚端子测试、联闭锁测试的自动测试模板自动测试功能。 综合这三个方面的考虑，软件系统结构设计如图7所示。 由图7可知，图中SCD文件解析模块完成解析后将结果传递给IED装置模板和整站可视化及测试任务管理模块；智能生成模块完成自动测试模板的生成，整站可视化及测试任务管理模块分别以图形视图和列表视图的方式可视化展示整站设备的连线状态及测试状态；在两种视图界面都提供测试任务的进入接口，完成对测试仪配置智能生成模块、设备数据模型一致性测试模块、自动测试控制模块的调用。 自动测试控制模块加载IED装置的测试模板，根据模板定义的测试流程完成各项功能的测试。测试时的功能设计如下： 1) 自动测试控制模块调用测试仪控制模块与数字测试仪通讯，施加激励量给IED装置，同时也可控制测试仪发布、订阅GOOSE报文； 2) 自动测试控制模块也能按照模板要求，控制61850通讯模块完成与IED装置的通讯； 3) 根据测试仪的测试结果与IED装置的通讯结果，综合判断测试是否合格，并填写标准格式的测试报告。"
"以海南海甸岛110 kV海甸变#1主变保护A套现场单体调试为例，具体涉及了装置设备数据模型一致性检查、虚端子检查、保护功能检查、联闭锁功能检查等。 图6. 可视化自动测试平台硬件结构图 图7. 可视化自动测试系统软件框架图 图8. 海甸变可视化软件列表视图界面 调试准备阶段，需要根据电压等级和装置类型选择相关的国标、行标和企标，以此为依据完成调试方案的确定。根据方案要求，修改确认基础模板库、子模板库中对测试结果脚本绝对误差、相对误差的判断要求，一般除标准修订或特殊应用场合，此处确认即可，不需要修改。通过可视化自动测试系统软件智能生成测试仪配置文件、以及各测试功能的模板，可视化列表视图界面见图8，展示了站内各类保护装置、测控装置、合并单元、智能终端的装置信息及测试状态，软件通过鼠标双击消息响应函数自动调用对应设备的模型测试、虚端子测试、功能测试、联闭锁测试等界面；通过鼠标右击响应函数调用导出测试任务的测试报告、下载测试模板等。 实际现场调试阶段，只需搭好测试物理环境，保证测试主机与测试仪及相关IED装置的链路通讯正确、畅通，然后在上图界面调用对应测试任务，即可开始对应测试任务，测试过程中测试任务表格会显示“测试中”，测试完成后会自动更新为“测试完成”。 测试完成后，会根据装置类型和名称生成各测试任务的标准测试报告，报告名称中包含测试日期等信息，完成对测试历史报告的统一存放管理。 通过现场应用反馈显示，熟悉常规变电站现场测试流程的人员基本可以直接使用本可视化软件系统进行智能变电站的测试；相对于传统的手动测试的方式，自动测试的方式在保证测试可靠性的基础上将测试时间缩短到以前的1/3，极大的提高了现场测试的效率。"
"本文针对智能变电站可视化自动测试领域的问题进行分析与研究，跳出了智能变电站内各IED装置孤立测试的常规思路，提出了一套智能变电站可视化自动测试系统。首次提出可视化自动测试的思路，将站内各IED装置的测试任务进行可视化管理，实时记录各装置的测试状态，随时导出测试完成装置的测试报告，降低了智能变电站的测试难度，大大提高了测试效率。智能变电站可视化自动测试系统必然会成为站内各IED装置测试领域的发展趋势。"
