"本文研究基于强跟踪泰勒扩展卡尔曼滤波(STEKF)的暂态电能质量信号检测方法。针对泰勒卡尔曼滤波(TKF)算法状态空间的维数过大以及无法快速准确跟踪突变信号的缺点，将泰勒扩展卡尔曼滤波(TEKF)与强跟踪滤波(STF)相结合，先对幅值和相位分别进行2阶泰勒展开，再借助渐消因子根据实际残差与理论残差实时调整TEKF中的误差协方差矩阵，从而增强算法对突变信号的跟踪能力。对解析调幅信号和调相信号、Simulink搭建的三相系统故障下的电压暂降信号和三相系统整流谐波信号四种情况进行了仿真实验。实验结果表明，与TEKF算法相比，本文提出的STEKF算法具有更快的跟踪速度和更高的跟踪精度。 关键词 :暂态电能质量，电能质量检测，泰勒扩展卡尔曼滤波，强跟踪滤波 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着现代科技的飞速发展，大功率电力电子设备在电力系统中的广泛应用所造成的电能质量扰动问题越发引起人们的关注。常见的电能质量扰动问题有电压中断、幅值暂升或暂降、谐波等，它们已经给电力系统的稳定运行带来一系列的严重问题。为了保障电力系统稳定运行，研究电能质量扰动的检测方法具有重大的意义 [ 1 ] 。 常用的电能质量检测方法有快速傅里叶变换(FFT)、离散傅里叶变换(DFT)、有效值检测法(RMS)和半周期有效值检测法(HRMS)、小波变换(WT)、卡尔曼滤波(KF)等 [ 1 ] - [ 15 ] 。FFT和DFT在频域上对信号进行分析，适用于静态扰动的检测，但对于动态扰动而言其检测准确性会严重下降 [ 2 ] [ 3 ] [ 4 ] [ 5 ] 。RMS计算了一个周期内电压瞬时值的均方根值，可用于检测电压暂降 [ 6 ] 和电压闪变 [ 7 ] 。而HRMS则是在RMS的基础上进行改进，采用半周期取值代替周期取值，其信号跟踪的时效性优于RMS [ 8 ] 。WT能在时域和频域表征信号的局部特性，其检测能力容易受噪声的影响而急剧下降 [ 9 ] [ 10 ] 。KF常用于线性系统的状态估计，而对于非线性系统，KF对系统状态估计的效果受到了限制 [ 11 ] [ 12 ] 。 扩展卡尔曼滤波(EKF)由KF发展而来，将非线性系统的系统函数的泰勒展开式进行1阶或2阶截取，使非线性系统函数线性化，但存在计算Jacobi矩阵困难、滤波精度依赖截取阶数而导致计算复杂度增加的缺陷 [ 11 ] 。文献 [ 13 ] 提出了一种基于泰勒扩展卡尔曼滤波(Taylor extended Kalman filter, TEKF)的动态同步相量估计算法，通过对电气信号的幅值和相位分别做2阶泰勒级数展开构建系统的状态变量，并利用EKF对系统的状态变量进行最优估计。TEKF算法能精确测量低频振荡信号，且和泰勒卡尔曼滤波(Taylor Kalman filter, TKF) [ 14 ] 相比，TEKF没有引入复数状态变量及其导数项，减少了一定的计算量。但由于泰勒级数对非光滑函数进行展开时存在较大误差，而且在扰动的电气信号中往往会存在某个参数的突变，TEKF无法快速进行跟踪，所以TEKF算法对突变信号的跟踪精度较差。 为克服TEKF算法对突变信号的跟踪精度较差的问题，本文在TEKF算法的基础上，结合强跟踪算法 [ 15 ] ，提出一种基于强跟踪泰勒扩展卡尔曼滤波(strong tracking Taylor extended Kalman filter, STEKF)的暂态电能质量信号检测算法，引入渐消因子对误差协方差矩阵进行调整，使算法能更准确跟踪突变信号。"
"一般的，一个只含基波的离散化电气信号可表示为 y k = a k cos ( ω 1 k τ + φ k ) (1) 其中， ω 1 = 2 π f 1 ； 为基波的频率； τ 为采样间隔； a k 和 φ k 分别为基波的幅值和相位。 定义相位 ψ k = ω 1 k τ + φ k ，构建由幅值a和相位 ψ 及它们的1阶、2阶导数组成的状态变量 X k = [ a k ( 0 ) a k ( 1 ) a k ( 2 ) ψ k ( 0 ) ψ k ( 1 ) ψ k ( 2 ) ] T ，根据2阶泰勒级数展开，建立(1)式的离散状态空间描述 [ 13 ] ，即 { X k + 1 = A X k + W k y k + 1 = h ( X k + 1 ) + v k (2) 其中，状态转移矩阵为 A = [ 1 τ τ 2 2 0 0 0 0 1 τ 0 0 0 0 0 1 0 0 0 0 0 0 1 τ τ 2 2 0 0 0 0 1 τ 0 0 0 0 0 1 ] (3) 系统的量测转移函数为 h ( X k + 1 ) = a k + 1 cos ψ k + 1 ；系统的状态转移噪声 W k 由幅值和相位的2阶泰勒级数展开所产生的误差决定；系统的量测噪声 v k 为高斯白噪声。  一个含有谐波的电气信号的离散形式为 y k = a 1 | k cos ( ω 1 k τ + φ 1 | k ) + ∑ n = 2 m a n | k cos ( n ω 1 k τ + φ n | k ) (4) 其中，m为谐波的最高次数， a n | k 和 φ n | k 分别为n次谐波在k时刻的幅值和相位。 (4)式的离散状态空间描述，只需在状态转移方程中对各次谐波分量添加如下两个等式 a n ( 0 ) | k + 1 = a n ( 0 ) | k + δ a n ( 0 ) | k + 1 (5) ψ n ( 0 ) | k + 1 = ψ n ( 0 ) | k + n τ ψ 1 ( 1 ) | k + n τ 2 2 ψ 1 ( 2 ) | k + δ ψ n ( 0 ) | k + 1 (6) 此时状态变量为 X k = [ a 1 ( 0 ) | k a 1 ( 1 ) | k a 1 ( 2 ) | k a 2 ( 0 ) | k ⋯ a m ( 0 ) | k ψ 1 ( 0 ) | k ψ 1 ( 1 ) | k ψ 1 ( 2 ) | k ψ 2 ( 0 ) | k ⋯ ψ m ( 0 ) | k ] T (7) 其中， a 1 ( 0 ) | k 、 ψ 1 ( 0 ) | k 分别为基波在k时刻的幅值和相位， a 1 ( 1 ) | k 、 ψ 1 ( 1 ) | k 分别为k时刻基波幅值和相位的1阶导数， a 1 ( 2 ) | k 、 ψ 1 ( 2 ) | k 分别为k时刻基波幅值和相位的2阶导数， a m ( 0 ) | k 、 ψ m ( 0 ) | k 分别为m次谐波在k时刻的幅值和相位。则系统的量测转移函数可改写 h ( X k + 1 ) = a 1 | k + 1 cos ψ 1 | k + 1 + ∑ n = 2 m a n | k + 1 cos ψ n | k + 1 (8)"
"KF算法常用于动态相量的测量，它通过对动态相量的进行2阶泰勒展开，引入复数状态变量及其导数项，构建系统的状态空间 [ 14 ] 。在考虑谐波分量的情况下，TKF所构建的状态空间会引入更多关于各次谐波的复数状态变量及其导数项，导致状态空间的维数增加。 为了避免上述问题，TEKF算法通过对幅值和相位分别进行2阶泰勒展开，利用幅值和相位及它们的1阶、2阶导数构成状态变量。而由于谐波分量的幅值往往较低，且其相位取决于基波相位，所以TEKF仅把各次谐波分量的幅值和相位引入到状态变量中 [ 13 ] 。对一个含有n种谐波分量的电气信号，TEKF构建的状态空间中仅有 6 + 2 n 个实数状态变量，少于TKF构建的复数状态变量数 个。因此，在考虑越多的谐波分量时，TEKF可简化状态空间，减少状态变量的维数，从而减少滤波算法迭代运算所花费的时间。  EKF常用于非线性系统，其主要思路是将系统的非线性模型进行1阶泰勒级数展开以实现线性化后，再进行与线性KF类似的迭代运算，即利用k时刻的最优状态估计值预测 k + 1 时刻的状态值，根据 k + 1 时刻的量测值修正 k + 1 时刻的预测状态值得到 k + 1 时刻的最优状态估计值。而TEKF算法则是基于幅值和相位的泰勒级数展开建立系统状态空间，并利用EKF作最优状态估计 [ 13 ] 。其流程如下： 1) 预测 k + 1 时刻的状态变量 X k + 1 | k = A X k (9) 2) 预测 k + 1 时刻的误差协方差矩阵 P k + 1 | k = A P k A T + Q k (10) 3) 根据量测转移函数计算 k + 1 时刻的Jocabian矩阵 H k = ∂ h ( X k ) ∂ X k | X k = X k + 1 | k (11) 4) 计算扩展卡尔曼滤波增益 K k + 1 = P k + 1 | k H k T ( H k P k + 1 | k H k T + R k ) − 1 (12) 5) 更新 k + 1 时刻的状态变量 X k + 1 = X k + 1 | k + K k + 1 [ y k + 1 − h ( X k + 1 | k ) ] (13) 6) 更新 k + 1 时刻的误差协方差矩阵 P k + 1 = P k + 1 | k − K k + 1 H k P k + 1 | k (14)  强跟踪滤波(STF)算法在预测误差协方差矩阵的过程中引入渐消因子，对过去数据进行渐消，能更大限度地从残差中提取有效信息实时，使算法能在系统参数发生突变的时候实现准确快速的跟踪 [ 15 ] 。在渐消因子的作用下，STF算法对过程参数的突变具有很强的鲁棒性，相对于TEKF而言具有更高的估计精度 [ 16 ] [ 17 ] 。而STEKF算法对TEKF算法进行改进，在预测 k + 1 时刻误差协方差矩阵时加入渐消因子，根据实际残差与理论残差实时调整误差协方差矩阵。 在引入渐消因子后，滤波过程中预测误差协方差的(10)式变为 P k + 1 | k = λ k + 1 A P k A T + Q k (15) 其中， λ k + 1 为渐消因子。要计算渐消因子，需要先计算理论残差与实际输出残差。 理论输出残差序列为 ε k + 1 = y k + 1 − h ( X k + 1 | k ) (16) 则实际输出残差序列的协方差矩阵为 V k + 1 = { ε 1 ε 1 T                                       k = 0 ρ V k + ε k + 1 ε k + 1 T 1 + ρ               k ≥ 1 (17) 上式中，遗忘因子 ρ 一般取0.95。则渐消因子 λ k + 1 可通过以下的公式确定 [ 15 ] N k + 1 = V k + 1 − H k Q k H k T − β R k (18) M k + 1 = H k A P k A T H k T (19) λ k + 1 = { λ 0 λ 0 ≥ 1 1 λ 0 < 1 (20) λ 0 = t r [ N k + 1 ] t r [ M k + 1 ] (21) 其中，弱化因子 β 的取值影响着状态估计曲线的平滑程度，本文中取1；tr(.)表示求矩阵的迹运算。"
"图1为暂态电能质量信号检测的强跟踪泰勒扩展卡尔曼滤波算法流程图，其具体步骤为： 1) 设置状态变量 X k 的初值 X 0 、误差协方差矩阵 P k 的初值 P 0 、系统状态转移噪声的协方差Q以及量测噪声的方差R。 图1. 基于STEKF的暂态电能质量信号检测流程图 2) 根据(9)式，由状态变量 X k 预测 k + 1 时刻的状态变量 X k + 1 | k ，并由(16)~(21)式计算渐消因子λ k +1 ，根据(15)式预测 k + 1 时刻的误差协方差矩阵。 3) 利用(11)和(12)式分别计算量测转移函数Jacobian矩阵 H k 与滤波增益 K k + 1 ，根据(13)和(14)式计算 k + 1 时刻状态变量的最优估计值 X k + 1 以及误差协方差矩阵的最优估计值 P k + 1 。 4) 由步骤3中得到的状态变量最优估计值 X k + 1 中的分量，分别计算基波幅值 a 1 | k + 1 与相位 φ 1 | k + 1 ，以及各次谐波的幅值 a n | k + 1 与相位 φ n | k + 1 。 5) 返回本节的步骤2，预测 k + 2 时刻的状态变量以及误差协方差矩阵。"
"本文采用Matlab R2014a软件实现TEKF算法和STEKF算法。通过利用TEKF算法和STEKF算法对给定的调幅、调相信号以及由Simulink搭建的三相系统整流谐波信号和三相系统故障下的电压暂降信号进行仿真分析，引入均方根误差(root mean square error, RMSE)来衡量估计值与理想值之间的偏差。k时刻的RMSE定义为： σ RMSE ( k ) = 1 k ∑ i = 0 k − 1 ( c i − c i 0 ) 2 (22) 其中， c i 和 c i 0 分别是i时刻的估计值和理想值。RMSE的值表现了从0时刻至 k − 1 时刻的平均估计效果，RMSE的值越小说明算法的估计精度越高。进行仿真时，信号的采样频率 f s = 2.5   kHz ，采样时间间隔 ，基波频率 f 1 = 50   Hz ，基波幅值采用p.u.作为单位。  调幅信号的离散表达式为 y k = a k cos ( ω 1 k τ ) 。其中，幅值 a k = 1 + 0.1 cos ( 2 π f a k τ ) ，幅值频率 f a = 5   Hz ，相位 φ k = 0 。 TEKF算法和STEKF算法对调幅信号的仿真情况如图2所示。图2(a)和图2(b)分别为幅值和相位的估计曲线，(c)和(d)分别为幅值和相位的RMSE曲线。由图2可知，STEKF算法仿真得到的幅值和相位曲线与TEKF算法相比更接近于幅值和相位理论值的曲线，从幅值和相位的RMSE曲线可以看出，STEKF的RMSE值明显小于TEKF的RMSE值。表1给出了在t = 0.5 s时两种算法的幅值、相位估计值与误差情况。由表1可知STEKF算法在t = 0.5 s时幅值、相位的绝对误差分别为0.0000 p.u.和0.0002 rad，RMSE 图2. 调幅信号的幅值和相位估计 Table 1 估计值 绝对误差 RMSE/×10 −3 TEKF 幅值/p.u. 0.8999 0.0001 7.333 相位/rad −0.0004 0.0004 5.279 STEKF 幅值/p.u. 0.9000 0.0000 5.424 相位/rad −0.0002 0.0002 4.618 表1. 调幅信号的误差分析(t = 0.5 s) 值分别为5.424 × 10 −3 和4.618 × 10 −3 ，均比TEKF算法得到的幅值、相位的绝对误差与RMSE小，说明STEKF算法对调幅信号的测量精度更高，稳定性更好。而在仿真的开始阶段，由于初始参数取值的原因，两种算法对原信号的幅值和相位的跟踪情况会出现一定的偏差。  调相信号的离散表达式为 。其中，幅值 ，相位 ，幅值频率 f φ = 5   Hz 。 图3为TEKF算法和STEKF算法对调相信号的仿真情况。图3(a)和图3(b)分别为幅值和相位的估计曲线，图3(c)和图3(d)分别为幅值和相位的RMSE曲线。由图3可知，两种算法均能准确跟踪调相信号的相位变化，STEKF算法所跟踪的调相信号的幅值比TEKF算法更接近于理论值。根据表2数据，在t = 0.5 s时，STEKF算法得到的幅值、相位绝对误差分别为0.0000 p.u.和0.0003 rad，RMSE值分别为0.603 × 10 −3 和0.872 × 10 −3 ，而TEKF算法得到的幅值、相位绝对误差分别为0.0001 p.u.和0.0009 rad，RMSE值分别为2.616 × 10 −3 和4.934 × 10 −3 ，因此STEKF的误差比TEKF小，说明STEKF算法对调相信号有 图3. 调相信号的幅值和相位估计 Table 2 估计值 绝对误差 RMSE/×10 −3 TEKF 幅值/p.u. 1.0001 0.0001 2.616 相位/rad −0.1009 0.0009 4.934 STEKF 幅值/p.u. 1.0000 0.0000 0.603 相位/rad −0.1003 0.0003 0.872 表2. 调相信号的误差分析(t = 0.5 s) 图4. 故障电压信号仿真模型 更好的估计效果。  利用Simulink搭建如图4所示的故障电压仿真模型。该模型模拟了三相电源经过变压器后对三相负载端供电的情况。在t = 0.3 s时刻，系统发生A、B两相短路的故障；在t = 0.7 s时刻，故障消失，系统恢复正常工作状态。分别用TEKF算法和STEKF算法估计负载端的A相电压，得到的结果如图5所示。 图5(a)为故障电压波形，图5(b)和图5(c)分别为幅值估计曲线和RMSE曲线。由图5可知，两种算法均能跟踪故障电压突变信号，电压信号在0.3 s时发生幅值暂降，在0.7 s时恢复。表3为故障电压信号幅值的误差分析。分别计算两种算法在故障开始后的1个周波(t = 0.32 s)与故障结束后的一个周波(t = 0.72 s)时的绝对误差与RMSE值。由表3数据可知，在t = 0.32 s时STEKF得到的幅值绝对误差和RMSE分别为0.001 p.u.与44.12 × 10 −3 ，小于TEKF的幅值绝对误差和RMSE (0.005 p.u.与64.57 × 10 −3 )，而在t = 0.72 s时也可得到相同的结果。因此在故障开始和结束的1个周波内，STEKF的估计结果更接近于理论幅值，其RMSE值比TEKF算法小，说明STEKF对幅值暂降的故障电压信号估计效果更好。  利用Simulink中的通用电桥以及电阻电感串联负载模块可搭建如图6所示的谐波电压仿真模型。其中，负载的阻抗和感抗分别为20 Ω和10 mH。用TEKF算法和STEKF算法对该模型在A相产生的谐波电压信号进行估计，其结果如图7所示。 图7给出了TEKF算法和STEKF算法对基波幅值和5次谐波幅值的估计结果。图7(a)为谐波电压信号的波形，图7(b)和图7(c)分别为基波和5次谐波的幅值估计曲线，图7(d)和图7(e)分别为基波和5次谐波幅值RMSE曲线。由图7的幅值曲线以及RMSE曲线可知，STEKF算法的估计结果接近原信号真实值的速度比TEKF算法快，且由表4的数据可知，在t = 0.5 s时，STEKF估计谐波电压信号基波幅值、5次谐波幅值的绝对误差分别为0.0000 p.u.和0.0000 p.u.，RMSE分别为197.2 × 10 −3 和47.1 × 10 −3 ，均比TEKF估计的基波幅值、5次谐波幅值的绝对误差(0.0074 p.u.和0.0013 p.u.)、RMSE (207.1×10 −3 和50.2×10 −3 )小，因此STEKF算法对含谐波的电压信号的估计效果优于TEKF算法。 对于3次、7次、9次谐波的幅值，用STEKF算法进行估计也可得到相同的结论。受限于篇幅，本文没有给出它们的幅值估计和RMSE曲线，仅在表4中给出它们的数据。 图5. 故障电压信号的幅值估计 Table 3 t/s 幅值/p.u. 绝对误差/p.u. RMSE/×10 −3 TEKF 0.32 1.284 0.005 64.57 0.72 1.953 0.004 50.49 STEKF 0.32 1.290 0.001 44.12 0.72 1.948 0.001 42.36 表3. 故障电压信号幅值的误差分析 图6. 谐波电压信号仿真模型 图7. 基波&5次谐波的幅值估计 Table 4 估计值 绝对误差 RMSE/×10 −3 TEKF 基波幅值/p.u. 8.5446 0.0074 207.1 3次谐波幅值/p.u. 0.0294 0.0029 51.4 5次谐波幅值/p.u. 0.5982 0.0013 50.2 7次谐波幅值/p.u. 0.3165 0.0026 37.7 9次谐波幅值/p.u. 0.0517 0.0013 22.8 STEKF 基波幅值/p.u. 8.5520 0.0000 197.2 3次谐波幅值/p.u. 0.0265 0.0000 50.3 5次谐波幅值/p.u. 0.5995 0.0000 47.1 7次谐波幅值/p.u. 0.3139 0.0000 32.3 9次谐波幅值/p.u. 0.0530 0.0000 18.2 表4. 谐波电压信号幅值的误差分析"
"本文提出了一种基于强跟踪泰勒扩展卡尔曼滤波的暂态电能质量扰动检测的方法。通过利用电气信号幅值和相位的泰勒级数展开构建系统的状态空间模型，结合强跟踪算法，利用扩展卡尔曼滤波对电气信号进行实时跟踪。本文提出的STEKF算法在估计谐波分量时能降低状态空间的维数，减少计算时间。从仿真结果可知，STEKF算法能快速有效的跟踪参数变化的电气信号，对参数突变的暂态电能质量信号估计效果优于TEKF算法。对于STEKF算法的初值选取，以及将该算法移植到DSP硬件上进行实时应用，将是今后要研究的重点。"
