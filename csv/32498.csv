"本文在标的资产价格满足Heston随机波动率模型下讨论基于资产价的离散几何平均情形的亚式离散障碍期权定价。应用半鞅Itô公式、多维联合特征函数、Girsanov测度变换和Fourier反变换等随机分析方法，推导出了基于资产价的亚式几何平均离散障碍期权的定价公式，最后给出了数值计算实例，并分析了波动率参数对障碍期权价格的影响。 关键词 :Heston模型，障碍期权，Fourier反变换，几何平均 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"期权是风险管理的核心工具，如何给期权定价，自然是一个非常重要的问题。1973年Black与Scholes在股票价格服从几何布朗运动，利率和股票波动率均为常数的假设下，给出了欧式标准期权定价模型，即著名的Black-Scholes公式 [ 1 ] (记为B-S模型)。后来人们发现从期权市场数据计算出的波动率表现出波动的聚集性和微笑现象，这表明B-S模型计算的期权价格与实际市场表现存在一定偏差。为了解决这些偏差，许多学者对B-S模型进行了改进，如Merton [ 2 ] 和Kou [ 3 ] 等学者在标的资产的动态模型中引入跳跃风险，建立的跳扩散模型(Jump-Diffusion，简记JD模型)，并给出了类似B-S模型的期权定价公式；另外，Heston [ 4 ] 、Hull和White [ 5 ] 以及Stein和Stein [ 6 ] 等学者设定资产的波动率是随机变化的，以资产波动率的随机变化过程来刻画波动的聚集性和微笑现象，建立了随机波动率模型(Stochastic Volatility，简记SV模型)。随后，Chen和Scott [ 7 ] 、Bates [ 8 ] 、邓国和和杨向群 [ 9 ] 等学者发现把跳跃因素和波动率随机化结合起来能更好地刻画金融市场波动的聚集性和微笑现象。 障碍期权(Barrier option)是一种路径依赖型期权(Path-dependent options)，它的最终收益不仅依赖于标的资产到期日的价格，还依赖于标的资产变动的路径，当标的资产价格触及规定的障碍时，期权合约生效或失效。障碍期权合约可以降低投资者投资的风险，其价格比标准欧式期权价格便宜，因此受到市场的青睐，被广泛地应用于风险管理。障碍期权可以分为两大类：敲出期权(knock-out option)和敲入期权(knock-in options)。敲出期权是指当标的资产价格触及规定的障碍值时，合约失效；敲入期权是指当标的资产价格触及规定的障碍值时，合约生效。根据在期权有效期内标的资产价格是否大于障碍值，又可以将敲出期权分为下降敲出期权(down-and-out options)和上升敲出期权(up-and-out options)；同样也可以将敲入期权分为下降敲入期权(down-and-in options)和上升敲入期权(up-and-in options)。我们知道，在实际的金融市场中，金融衍生品的交易往往是离散情形。所以，在期权定价问题上，我们考虑离散时间情形观测到的标的资产价格会更贴近实际的金融交易。故，本文选择研究离散时间情形的障碍期权定价问题。研究离散障碍期权定价问题的文献并不多，1997年Broadie和Kou [ 10 ] 在标的资产价格满足B-S模型下给出了欧式离散障碍期权价格的近似显示式；2007年Fusai和Recchioni [ 11 ] 在Kou研究的基础上进一步研究了离散时间的障碍期权的定价方法；2011年Wystue和Griebsch [ 12 ] 在标的资产服从Heston随机波动率模型下给出离散时间欧式障碍期权价格的定价公式；2018年薛广明和邓国和 [ 13 ] 在Wystue研究的基础上进一步研究了基于Bates模型的欧式离散障碍期权的定价问题。受到上述文献的启发，本文在前人研究的基础上，结合Heston随机波动率模型和基于资产价的离散几何平均，进行亚式离散障碍期权定价的研究探讨。"
"考虑一个无套利无摩擦的金融市场。假设投资者将其财富仅投资于市场中的两种资产，其投资时期为 [ 0 , T ] ，其中一种资产B是无风险资产(如债券或存款)，其收益按无风险利率 r ≥ 0 (常数)连续复利计算。另一种是风险资产S (如股票)。假定完备概率空间 ( Ω , F , ( F t ) t ≥ 0 , P ) 具有满足通常条件的 σ -代数流 F t ， F t 由 W t 和 B t 联合生成，根据Duffie [ 14 ] 选取特定等价鞅测度的思想，本文假设概率测度P为风险中性测度，且条件数学期望 E P [ ⋅ ] 是基于概率测度P下计算。在此概率测度下，股票价格 S t 满足下列微分方程： { d S t = S t r d t + S t V t ( ρ d W t + 1 − ρ 2 d B t ) , d V t = κ ( θ − V t ) d t + σ V t d W t . (2.1) 其中 σ , κ , θ , ρ 均为常数， 2 κ θ ≥ σ 2 。此模型称为Heston随机波动率模型。 注 1 令 ρ = 1 , σ = κ = θ = 0 ，则 V t 为常数，模型(2.1)变成经典的B-S [ 1 ] 模型。 令 X t = ln S t ，由Itô公式，方程(2.1)变为 { d X t = ( r − 1 2 V t ) d t + V t ( ρ d W t + 1 − ρ 2 d B t ) , X 0 = x 0 , d V t = κ ( θ − V t ) d t + σ V t d W t , V 0 = v 0 . (2.2) 引理2.1 [ 12 ] ：设 0 = t 0 < t 1 < t 2 < ⋯ < t m = T 为 [ 0 , T ] 中的m个时间点， m ∈ ℕ + ，且 m ≥ 1 。记 X T = ( X t 1 , X t 2 , ⋯ , X t m ) T 是m维向量， u = ( u 1 , u 2 , ⋯ , u m ) 是m维实数向量，则 ( X t 1 , X t 2 , ⋯ , X t m ) 基于 t 0 时刻的联合特征函数为 φ ( u 1 , u 2 , ⋯ , u m ) = exp { ∑ k = 1 m i u k h ( t k ) − ∑ k = 1 m q ( u k ) j ( t k ) + ∑ k m B k + A m v 0 } , (2.3) 其中i为虚数单位， B k = B ( t m − k + 1 − t m − k , q ( u n − k + 1 ) + A k − 1 , p ( ∑ j = m − k + 1 m u j ) ) ， A k = A ( t m − k + 1 − t m − k , q ( u n − k + 1 ) + A k − 1 , p ( ∑ j = m − k + 1 m u j ) ) ，且 A 0 = 0 ， h ( t ) = x 0 + r t , j ( t ) = v 0 + κ θ t ， p ( u ) = ( 1 2 − κ ρ σ − 1 2 i u ( 1 − ρ 2 ) ) i u ， q ( u ) = i u ρ σ 。 A ( τ , a , b ) = d a ( 1 + e − d τ ) − ( 1 − e − d τ ) ( 2 b + κ a ) d ( 1 + e − d τ ) − ( 1 − e − d τ ) ( κ − σ 2 a ) , (2.4) B ( τ , a , b ) = κ θ σ 2 ( ( κ − d ) τ + 2 ln 2 d d ( 1 + e − d τ ) − ( 1 − e − d τ ) ( κ − σ 2 a ) ) , (2.5) 其中 d = κ 2 + 2 σ 2 b 。 推论2.1 [ 4 ] ：若股价满足Heston模型，则执行价格为K，到期日为T的标准欧式看涨期权在0时刻的价格为 C e ( t , x 0 , v 0 , K , T ) = S 0 { 1 2 + 1 π ∫ 0 + ∞ ℜ [ e − i u ln K φ 1 ( u ) i u ] d u } − K e − r T { 1 2 + 1 π ∫ 0 + ∞ ℜ [ e − i u ln K φ ( u ) i u ] d u } , (2.6) 其中 ℜ ( z ) 表示 z ∈ ℂ 的实部， φ 1 ( u ) = e − r T S t φ ( u − i ) 。"
"本节在股价满足Heston模型的条件下，应用多维特征函数，Girsanov测度变换和Fourier变换方法，推导出基于资产价的离散几何平均亚式离散障碍期权的定价公式。 障碍期权定价 考虑离散情形下欧式下降敲出看涨期权，假设 S 0 > L > K ，其中L是障碍值为常数，K为执行价格，其它情形的障碍期权可类似讨论。则具有m个离散时间点 0 = t 0 < t 1 < t 2 < ⋯ < t m = T 的欧式下降敲出看涨障碍期权在0时刻的价格为 V D O C ( m ) = E P [ e − r T ( S T − K ) + 1 ( S t 1 > L , ⋯ , S T > L ) ] , (3.1) 把资产价格用资产价的离散几何平均代替，则具有m个离散时间点 0 = t 0 < t 1 < t 2 < ⋯ < t m = T 的亚式下降敲出看涨障碍期权在0时刻的价格为 V D O C ( m ) = E P [ e − r T ( J T − K ) + 1 ( J t 1 > L , ⋯ , J T > L ) ] . (3.2) 其中 J T = ( ∏ i = 0 m S t i ) 1 m + 1 为资产价的离散几何平均。 定理3.1 在Heston模型下，具有m个离散时间点 0 = t 0 < t 1 < t 2 < ⋯ < t m = T 的基于资产价的离散几何平均亚式离散障碍期权在0时刻的价格为： V D O C ( m ) = S 0 { 1 2 m ( 1 − m t P 1 ( ln L ) + m ( m − 1 ) 2 t P 1 ( ln L , ln L ) − t P 1 ( ln L , ln L , ln L ) + ⋯     + ( − 1 ) m t P 1 ( ln L , ⋯ , ln L ) ) } − K e − r T { 1 2 m ( 1 − m t P ( ln L ) + m ( m − 1 ) 2 t P ( ln L , ln L )     − t P ( ln L , ln L , ln L ) + ⋯ + ( − 1 ) m t P ( ln L , ⋯ , ln L ) ) } , (3.3) 其中 t P ( ln L , ⋯ , ln L ) = ( − 2 ) m ( 2 π ) m ∫ ⋯ ∫ R + m Δ u 1 [ ⋯ Δ u m [ φ 0 ( u 1 , ⋯ , u m ) e − i ( u 1 + ⋯ + u m ) ln L ∏ k = 1 m i u k ] ] d u 1 ⋯ d u m , Δ u 1 [ ⋯ Δ u m [ φ ( u 1 , ⋯ , u m ) e − i ( u 1 + ⋯ + u m ) ln L ∏ k = 1 m i u k ] ] = 2 Δ u 2 ⋯ Δ u m ℜ [ φ ( u 1 , ⋯ , u m ) e − i ( u 1 + ⋯ + u m ) ln L ∏ k = 1 m i u k ] , Δ a [ f ( a ) ] = f ( a ) + f ( − a ) , φ 0 ( u 1 , ⋯ , u m ) = e ( i u 1 2 + i u 2 3 + ⋯ + i u m m + 1 ) x 0 φ ( u 1 2 ) φ ( u 2 3 , u 2 3 ) ⋯ φ ( u m m + 1 , ⋯ , u m m + 1 ) , φ 1 ( u 1 , ⋯ , u m ) = e − r T + ( i u 1 2 + i u 2 3 + ⋯ + i u m − m m + 1 ) x 0 φ ( u 1 2 ) φ ( u 2 3 , u 2 3 ) ⋯ φ ( u m − i m + 1 , ⋯ , u m − i m + 1 ) . 证明： m = 1 时，根据风险中性定价原理得 V D O C ( 1 ) = E P { e − r T ( J T − K ) + 1 ( J t 1 > L ) } = E P { e − r T J T 1 ( J t 1 > L ) } − E P { e − r T K 1 ( J t 1 > L ) } = I 1 − I 2 , (3.4) 计算 I 2 ， I 2 = K e − r T P ( J t 1 > L ) = K e − r T P ( ln J t 1 > ln L ) , (3.5) 再利用分布函数与特征函数的唯一性及Fourier反变换，即应用公式 F ( x ) = P ( X ≥ x ) = 1 2 + 1 π ∫ 0 + ∞ ℜ [ e − i u x f ( u ) i u ] d u , (3.6) 其中 f ( u ) 是随机变量X的特征函数，则 I 2 = K e − r T { 1 2 + 1 π ∫ 0 + ∞ ℜ [ e − i u ln L φ 0 ( u 1 ) i u 1 ] d u 1 } , (3.7) 其中 φ 0 ( u 1 ) = E P [ exp { i u 1 ln J t 1 } | F t ] = E P [ exp { i u 1 2 ( ln S 0 + ln S t 1 ) } | F t ] = e i u 1 2 x 0 E P [ exp { i u 1 2 X t 1 } | F t ] = e i u 1 2 x 0 φ ( u 1 2 ) . (3.8) 计算 I 1 ，应用Girsanov测度变换，定义一个新的概率测度 P 1 如下： d P 1 d P ∣ F t = e − r T J T S 0 . 显然，上述Radon-Nikodym导数存在且 E [ e − r T J T S 0 ] = 1 ，由Girsanov定理可知，概率测度 P 1 等价于P，则 I 1 = S 0 P 1 ( J t 1 > L ) = S 0 P 1 ( ln J t 1 > ln L ) = S 0 { 1 2 + 1 π ∫ 0 + ∞ ℜ [ e − i u ln L φ 1 ( u 1 ) i u 1 ] d u 1 } , (3.9) 其中 φ 1 ( u 1 ) = E P 1 [ exp { i u 1 ln J t 1 } | F t ] = E P [ e − r T J T S 0 e i u 1 ln J t 1 | F t ] = e − r T − x 0 E P [ exp { ( i u 1 + 1 ) ln J t 1 } | F t ] = e − r T + i u 1 − 1 2 x 0 φ ( u 1 − i 2 ) . (3.10) 可见， m = 1 时，结论成立。 m = 2 时，具有2个离散时间点 0 = t 0 < t 1 < t 2 = T ，根据风险中性定价原理得： V D O C ( 2 ) = E P { e − r τ ( J T − K ) + 1 ( J t 1 > L , J T > L ) } = E P { e − r T J T 1 ( J t 1 > L , J T > L ) } − E P { e − r T K 1 ( J t 1 > L , J T > L ) } = I 1 − I 2 , (3.11) 计算 I 1 和 I 2 ，由引理2.1及Shephard [ 15 ] 定理5，得 I 2 = K e − r T P ( ln J t 1 > ln L , ln J t 2 > ln L ) = K e − r T { 1 4 + 1 2 π ∫ 0 + ∞ ℜ [ e − i u 1 ln L φ 0 ( u 1 , 0 ) i u 1 ] d u 1 + 1 2 π ∫ 0 + ∞ ℜ [ e − i u 2 ln L φ 0 ( 0 , u 2 ) i u 2 ] d u 2     − 1 2 π 2 ∫ ∫ R + 2 { ℜ [ e − i ( u 1 + u 2 ) ln L φ 0 ( u 1 , u 2 ) u 1 u 2 − e − i ( u 1 − u 2 ) ln L φ 0 ( u 1 , − u 2 ) u 1 u 2 ] } d u 1 d u 2 } , (3.12) 其中 φ 0 ( u 1 , u 2 ) = E P [ exp { i u 1 ln J t 1 + i u 2 ln J T } | F t ] = E P [ exp { i u 1 2 ( ln S 0 + ln S t 1 ) + i u 2 3 ( ln S 0 + ln S t 1 + ln S t 2 ) } | F t ] = e ( i u 1 2 + i u 2 3 ) x 0 E P [ exp { i u 1 2 X t 1 + i u 2 3 ( X t 1 + X t 2 ) } | F t ] = e ( i u 1 2 + i u 2 3 ) x 0 φ ( u 1 2 ) φ ( u 2 3 , u 2 3 ) , (3.13) I 1 = S 0 P 1 ( ln J t 1 > ln L , ln J T > ln L ) = S 0 { 1 4 + 1 2 π ∫ 0 + ∞ ℜ [ e − i u 1 ln L φ 1 ( u 1 , 0 ) i u 1 ] d u 1 + 1 2 π ∫ 0 + ∞ ℜ [ e − i u 2 ln L φ 1 ( 0 , u 2 ) i u 2 ] d u 2     − 1 2 π 2 ∫ ∫ R + 2 { ℜ [ e − i ( u 1 + u 2 ) ln L φ 1 ( u 1 , u 2 ) u 1 u 2 − e − i ( u 1 − u 2 ) ln L φ 1 ( u 1 , − u 2 ) u 1 u 2 ] } d u 1 d u 2 } , (3.14) 其中 φ 1 ( u 1 , u 2 ) = E P 1 [ exp { i u 1 ln J t 1 + i u 2 ln J T } | F t ] = E P [ e − r T J T S 0 exp { i u 1 ln J t 1 + i u 2 ln J T } | F t ] = E P [ exp { − r T + i u 1 ln J t 1 + ( i u 2 + 1 ) ln J T } | F t ] / S 0 = e − r T + ( i u 1 2 + i u 2 − 2 3 ) x 0 φ ( u 1 2 ) φ ( u 2 − i 3 , u 2 − i 3 ) . (3.15) 可见， m = 2 时，结论也成立。用同样的方法也可证得 m = 3 时结论成立，进一步由数学归纳法可得(3.3)式，证毕。 推论3.1 [ 12 ] ：在Heston模型下，具有m个离散时间点 0 = t 0 < t 1 < t 2 < ⋯ < t m = T 的欧式下降敲出看涨期权((9)式)在0时刻的价格为： V D O C ( m ) = S 0 { 1 2 m ( 1 − m t P 1 ( ln L ) + m ( m − 1 ) 2 t P 1 ( ln L , ln L ) − t P 1 ( ln L , ln L , ln L ) + ⋯     + ( − 1 ) m t P 1 ( ln L , ⋯ , ln L ) ) } − K e − r T { 1 2 m ( 1 − m t P ( ln L ) + m ( m − 1 ) 2 t P ( ln L , ln L ) − t P ( ln L , ln L , ln L ) + ⋯ + ( − 1 ) m t P ( ln L , ⋯ , ln L ) ) } , (3.16) 其中 t P 1 ( ln L , ⋯ , ln L ) = ( − 2 ) m ( 2 π ) m ∫ ⋯ ∫ R + m Δ u 1 [ ⋯ Δ u m [ φ 1 ( u 1 , ⋯ , u m ) e − i ( u 1 + ⋯ + u m ) ln L ∏ k = 1 m i u k ] ] d u 1 ⋯ d u m , t P ( ln L , ⋯ , ln L ) = ( − 2 ) m ( 2 π ) m ∫ ⋯ ∫ R + m Δ u 1 [ ⋯ Δ u m [ φ ( u 1 , ⋯ , u m ) e − i ( u 1 + ⋯ + u m ) ln L ∏ k = 1 m i u k ] ] d u 1 ⋯ d u m , Δ u 1 [ ⋯ Δ u m [ φ ( u 1 , ⋯ , u m ) e − i ( u 1 + ⋯ + u m ) ln L ∏ k = 1 m i u k ] ] = 2 Δ u 2 ⋯ Δ u m ℜ [ φ ( u 1 , ⋯ , u m ) e − i ( u 1 + ⋯ + u m ) ln L ∏ k = 1 m i u k ] , Δ a [ f ( a ) ] = f ( a ) + f ( − a ) ,     φ 1 ( u 1 , ⋯ , u m ) = e − r T S 0 φ ( u 1 , ⋯ , u m − i ) ."
"本节主要以下降敲出离散障碍看涨期权为例，运用Matlab2016b和Mathematical11.0软件编程计算，分析比较了Heston模型下亚式离散障碍期权和欧式离散障碍期权价格的变化情况，并分析了Heston模型的主要参数对亚式离散障碍期权价格的影响。模型的主要参数选取如下 K = 35 , L = 40 , t 0 = 0 , T = 1 , t i = { 1 m , 2 m , ⋯ , 1 } , θ = 0.1444 , r = 0.03 , κ = 6 , v 0 = 0.15 , σ = 0.5 , ρ = − 0.7 首先，在Heston随机波动率模型下，比较亚式离散障碍期权与欧式离散障碍期权价格随股价变化和离散点改变而变化的情况。由表1，我们可以看到，两种期权的价格都是随着股价的增加而增大，随着m值的增大而减少。而且，亚式离散障碍期权的价格比欧式离散障碍期权的价格低，即基于资产价的离散几何平均情形的亚式离散障碍期权比一般的离散障碍期权价格低，这是因为亚式期权在到期日时的收益依赖于标的资产某一时间段内的平均价格，这样它通常比标准化的欧式期权的价格便宜，且该期权不易被操控。 Table 1 S 0 亚式离散障碍期权 欧式离散障碍期权 m = 1 m = 2 m = 3 m = 1 m = 2 m = 3 55 20.0781 19.2959 18.5355 21.8135 21.3125 21.0284 60 25.0259 24.4659 23.9716 26.5549 26.2211 26.0344 65 29.9648 29.4727 29.1185 31.3868 31.1660 31.0405 70 34.8953 34.4086 34.1209 36.2762 36.1302 36.0434 75 39.8207 39.3155 39.0545 41.2025 41.1054 41.0439 80 44.7432 44.2107 43.9558 46.1528 46.0878 46.0432 85 49.6643 49.1011 48.8418 51.1187 51.0749 51.0419 90 54.5846 53.9894 53.7206 56.0952 56.0653 56.0406 表1. Heston模型下亚式离散障碍期权与欧式离散障碍期权价格比较 最后考察模型的主要参数对期权价格的影响，图1是以股价 S 0 = 80 以及各参数取值不同为例研究期权价格的变化情况。由图1(a)可知， m = 1 和 m = 2 时，期权价格都是参数 σ 的增函数，而 m = 3 时期权价格随着 σ 的增大而减小；图1(b)可以看到， m = 1 和 m = 2 时，期权价格随着的 κ 增大而减小，而 m = 3 时期权价格是 κ 的增函数；由图1(c)可知，期权价格随着 θ 的增大而减小，且随着m的增大减小的幅度越大。 图1. 参数对期权价格的影响"
"本文在Heston随机波动率模型下应用Fourier变换方法和特征函数技术获得了基于资产价的离散几何平均情形的亚式离散障碍期权价格的显示解，并通过数值实例，比较了亚式和欧式离散障碍期权价格随着股价和离散点变化的情况，分析了模型参数对期权价格的影响，数值计算结果表明，模型中的参数对期权价格的影响具有不同的显著作用。本文的研究结果对进一步研究其他路径依赖型期权或美式期权有很好的借鉴作用。"
