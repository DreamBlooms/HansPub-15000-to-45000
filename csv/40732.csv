"随着国家大力推进生态文明建设，梯级水库调度中发电和生态效益之间的矛盾亟需得到协调。以清江梯级水库为研究对象，以最小下泄流量为参照，分别考虑清江最小和适宜生态流量，建立基于高斯径向基函数的梯级水库多目标调度模型，采用 NSGA-II算法求解，从水库优化调度的角度对水文学方法计算得出的生态流量进行适用性讨论。结果表明：基于高斯径向基函数的调度规则具有较好的优化效果，考虑生态效益会在一定程度上降低发电效益，且随着生态要求的增加，发电和生态效益之间的矛盾更加明显；最小生态流量比适宜生态流量更适用于清江梯级水库的生态调度；采用优化调度结果对最小生态流量进行修正，可以在保持Tennant法流量状况评价的基础上降低生态缺水量。"
"党的十八大以来，国家大力推进生态文明建设，水电工程建设和调度运行对河流生态环境的影响越来越受到重视。当河流上的单一水库发展为梯级水库时，水库的调蓄作用对河流生态系统的影响具有累积性，因而更大程度地改变了河流生态系统 [ 1 ]。减少这些负面影响最合适的办法就是改善现行的水库调度运行方式，在保证水库规划所设计的社会经济效益的前提下，尽可能地维持河流生态系统的完整性 [ 2 ]。而河道流量是支撑河流生态服务功能的主要指标，是衡量河流生态健康与否的指示因子，水库下游相关河段生态服务价值的多少与水库运行方式和水库下游河道内流量的大小直接相关 [ 3 ]。 目前，梯级水库的优化调度研究主要聚焦于多目标模型、优化算法等。如刘攀等 [ 4 ] 以清江梯级水库群长期优化调度为对象，构建了联合优化调度函数的“优化–拟合–再优化–随机仿真”框架，通过确定性动态规划方法、多元线性回归分析和非线性规划方法对所得调度函数进行检验和评价。邓乐乐等 [ 5 ] 将逐次渐近动态规划逐次优化混合算法(DPSA-POA)应用于雅砻江梯级水库调度模型中，结果表明联合优化调度的经济效益巨大。张剑亭等 [ 6 ] 研究了乌江梯级水库联合优化调度和基于信息熵求解多利益主体增益分配的方法，调动了梯级联合运行中水库参与的积极性。通过研究生态流量对梯级水库调度柔性决策的影响，杨光 [ 7 ] 认为生态流量的变化改变了水库调度的决策范围，尤其是在枯水期，而改进的动态规划法能在决策空间改变情况下产生稳定合理的计算结果。以上研究更多关注梯级水库优化带来的发电经济效益，而忽略了水库调度对下游的生态影响。 国内对满足河流下游的最小需水量等方面的研究相对较少。蔡卓森 [ 8 ] 建立了发电量最大与下游河道适宜生态流量改变度最小为目标的水库多目标优化调度模型，以金沙江下游溪洛渡–向家坝梯级水库为例，计算下游河道的适宜生态流量，并分别采用NSGA-II与INSGA2-DS算法优化典型枯水年蓄水方案，结果表明以生态为目标时适宜生态流量改变度减少22.22%，但发电量仅增加1.00%。为研究雅砻江流域梯级水库发电与生态的竞争关系，吴振天等 [ 9 ] 建立了以梯级水库发电量最大、适宜生态缺溢流量平方和最小为目标的调度模型，用NSGA-II算法求解，结果显示在枯水年的竞争关系最剧烈，发电方案流量过程相对适宜生态流量过程的偏差程度最高，丰水年和平水年偏差程度较小，竞争关系较弱。以上研究均只考虑满足河流下游的适宜需水量，没有考虑河道的最小生态流量，忽略了生态流量的等级在水库调度中应用的合理性。 针对上述问题，本文以清江流域水布垭–隔河岩–高坝洲梯级水库为研究对象，分别计算并确定代表断面的最小和适宜生态流量，建立考虑生态流量的梯级水库联合调度模型，分析讨论梯级水库的发电、生态效益以及最小和适宜生态流量的适用性，以期为清江梯级水库实施生态调度提供参考依据。"
"清江流域地处东经108˚35'~111˚35'与北纬29˚33'~30˚50'之间，夏季高温多雨，冬季温和少雨，属于亚热带季风性湿润气候。清江是贯穿湖北省西南部的长江一级支流，发源于湖北省利川市的齐岳山东麓龙洞沟，先后流经利川市、恩施市、建始县、巴东县和长阳土家族自治县，在宜都市陆城镇南岸汇入长江，其干流全长423 km，流域面积1.67万km²。 清江建有水布垭–隔河岩–高坝洲三座梯级水库。其中水布垭水库位于湖北省恩施州巴东县境内，是清江干流中下游河段三级开发的龙头梯级，是一座以发电为主，兼顾防洪、航运效益的一等大型水利水电工程；隔河岩水库水电站是清江梯级水电站中最早建设的一座以发电为主，兼顾防洪、航运效益的大型水利枢纽工程；高坝洲水电站是隔河岩电站的反调节电站，工程主要任务为发电和航运。梯级水库主要特征参数见文献 [ 10 ]。 根据水量平衡原理还原计算三库坝址的天然径流过程，并通过对原有实测资料系列的延长，得到水布垭–隔河岩–高坝洲水库1951~2020年(共69年)日时段坝址流量。  河流的最小生态流量，可以认为是在满足河流生态系统稳定和健康条件下所允许的最小流量过程；而有利于维持河道内外生态系统稳定并确保物种多样性的流量过程可以定义为适宜生态流量过程 [ 11 ]。本文中清江的生态用水考虑最小和适宜生态流量，而生态流量计算断面以梯级水库为基础，综合资料可获取性、断面代表性等考虑，选择水布垭和隔河岩两水库作为计算断面。 李千珣等 [ 12 ] 采用逐月最小生态流量法、RVA法和DC法计算了清江水布垭和隔河岩水库坝址的最小生态流量过程，采用逐月频率法计算了3种频率情景下的断面适宜生态流量，并采用Tennant法对结果进行合理性分析。水利部正式批复的长江水利委员会《2019年长江流域水工程联合调度运用计划》(《批复》)中明确规定，水布垭、隔河岩水库最小下泄流量分别不小于35 m 3 /s和46 m 3 /s。 本文进行综合考虑：对最小生态流量，每月取上述三种水文学方法计算结果的最大值；将春秋季频率75%、夏季50%和冬季80%的流量过程作为适宜生态流量。若水文学方法计算出的断面最小和适宜生态流量在某些月份低于《批复》中要求的最小下泄流量，则以最小下泄流量为生态流量。清江流域最小和适宜生态流量过程见图1。"
"1) 梯级水库发电量最大，即： E T = ∑ t = 1 T N t Δ t ,     N t = ∑ i = 1 N K i Q i , t f d H i , t (1) 式中： E T 为调度期内总发电量； N i , t 、 Q i , t f d 和 H i , t 分别为第i个水库t时段的发电出力(其中 i = 1 , 2 , 3 分别为水布垭、隔河岩和高坝洲)、发电流量和净水头； N t 为t时段梯级水库总出力；t为时段变量，本文以旬为调度时段，按水文年划分：1至36调度时段对应当年5月初至次年4月末；T为时段总数；N和T表示库群水库数和总调度时段；表示调度期内梯级水库总发电量； Δ t 为调度时段长。 图1. 清江最小和适宜生态流量过程 当时段出力不满足设计保证出力要求时，将使系统供电可靠性遭受破坏。为满足一定的发电保证率，在出力中加入惩罚项，出力计算公式变为： N ′ t = N t − σ t β ( N F − N t ) α   ,               σ t = { 0 , N t ≥ N F 1 , N t < N F (2) 式中： N ′ t 为考虑惩罚系数的梯级水库总出力；NF为梯级水库保证出力； β 为罚系数； α 视惩罚程度的不同取不同的值； σ t 为0~1变量。 2) 生态缺水量最小 [ 13 ]，即以调度期内的清江水布垭、隔河岩断面旬平均生态缺水量最小为目标函数： D i , t e f = { Q i , t e f − Q i , t f d − Q i , t q s         Q i , t e f − Q i , t f d − Q i , t q s ≥ 0 ,   i = 1 , 2 0                                                   Q i , t e f − Q i , t f d − Q i , t q s < 0 ,   i = 1 , 2 (3) C e f = ∑ i = 1 2 ∑ t = 1 T D i , t e f Δ t / T (4) 式中： C e f 为调度期内旬平均生态缺水量； Q i , t f d 、 Q i , t q s 和 Q i , t e f 分别为第i个水库t时段的引用流量、弃水流量和生态流量； D i , t e f 为时段t的出库流量相对生态流量的缺少值。  1) 水量平衡约束 V i , t + 1 = V i , t + ( Q i , t r k − Q i , t f d − Q i , t q s ) Δ t (5) 式中： V i , t + 1 、 V i , t 分别为第i个水库、t时刻水库蓄存水量。 2) 梯级水库水力联系约束 Q i , t r k = Q i − 1 , t − τ i − 1 f d + Q i − 1 , t − τ i − 1 q s + Q i , t i n f l o w (6) 式中： Q i , t r k 、 Q i , t f d 、 Q i − 1 , t − τ i − 1 q s 和 Q i , t i n f l o w 分别表示第i个水库t时刻入库流量、第 i − 1 个水库发电、弃水流量和区间入流。 3) 电站机组出力约束 N i , t min ( H i , t ) ≤ N i , t ( H i , t ) ≤ N i , t max ( H i , t ) (7) 式中： N i , t min ( H i , t ) 和 N i , t max ( H i , t ) 分别为t时刻第i个水库的最小保证出力和机组最大出力。 4) 水库调蓄和下泄流量约束 { Z i , t min ≤ Z i , t ≤ Z i , t max Q i , t min ≤ Q i , t f d + Q i , t q s ≤ Q i , t max (8) 式中： Z i , t min 和 Z i , t min 分别为第i个水库最小、最大蓄水位； Z i , t min 和 Q i , t max 分别为水库允许下泄流量的下限和上限。 5) 初始边界条件 { Z i , 1 = Z i , b Z i , T + 1 = Z i , e (9) 式中： Z i , b 为调度期初水库蓄水位； Z i , e 为调度期末水库蓄水位。 6) 相邻调度时段出库流量变幅约束 { | Q i , T o u t − Q i , T + 1 o u t | ≤ Δ Q max o u t | Z i , T − Z i , T + 1 | ≤ Δ Z max (10) 式中： Q i , T o u t 和 Q i , T + 1 o u t 分别相邻调度时段的出库流量， Δ Q max o u t 为相邻时段最大出库流量变幅； Z i , T 和 Z i , T + 1 分别相邻调度时段的水位， Δ Z max 为相邻时段最大水位变幅。  为了满足水库多目标决策需求，Yang [ 14 ] 采用高斯径向基函数计算各时段水库的出库流量，并取得较好的效果。本文考虑两种包括不同决策因子的高斯径向基函数：一是将水库入库流量、上游水位和调度时段(旬)作为决策因子；二是将未来三个调度时段水库入库流量均值作为决策因子，相关表达式如下： Q t o u t = ∑ u = 1 U ω u φ u ( X t ) + ∑ p = 1 P ω p φ p ( Y t )         t = 1 , 2 , ⋯ , T ,     0 ≤ ω i ≤ 1 ,     ∑ ω i = 1 (11) { φ u ( X t ) = exp [ − ∑ i = 1 M ( ( X t ) i − c i , u ) 2 b u 2 ]         c i , u ∈ [ − 1 , 1 ] ,       b u ∈ ( 0 , 1 ) φ p ( Y t ) = exp [ − ∑ j = 1 N ( ( Y t ) j − c j , p ) 2 b p 2 ]         c j , p ∈ [ − 1 , 1 ] ,       b p ∈ ( 0 , 1 ) (12) 式中：U和P分别为高斯径向基函数的数量；M和N分别为输入的决策因子 X t 和 Y t 的数量； ω u 、 c j , u 和 b u 为第u个高斯径向基函数对应的权重和参数， ω p 、 c j , p 和 b p 也同理。需要说明的是，输入的决策因子需要经过归一化处理；一种水库调度决策可概化为一个高斯径向基函数，对一系列决策进行加权平均得到最终的调度策略；本文中水布垭和隔河岩分别采用7 ( U = 4 ,   P = 3 )个高斯径向基函数，共有58个水库调度规则参数。 本文以最小下泄流量为约束的优化调度作为参照，由于最小下泄流量较少且容易满足，因此以发电量为单目标进行优化： f = max E T (13) 以高斯径向基函数为优化变量，根据最小和适宜生态流量两种情景，以发电量最大和生态缺水量最小为目标进行优化，获得Pareto前沿进而对多目标进行权衡： f = { max E T min C e f (14) 分别采用遗传算法(GA) [ 15 ] 和改进的非支配排序遗传算法(NSGA-II) [ 16 ] 求解单、多目标优化问题，设定交叉和变异的概率分别为0.7和0.2，种群数量为40、迭代次数为400代。"
"分别采用全调度时段总发电缺额(实际出力低于保证出力时少发的总发电量)、多年平均发电量和发电保证率(实际出力不低于保证出力的频率)衡量发电效益。图2分别在考虑最小和适宜生态流量下对比了采用NSGA-II算法优化得到的Pareto前沿与常规调度的结果。由图可知： 图2. 考虑生态流量的不同调度方案下的调度结果 1) 考虑生态流量的常规调度结果不支配Pareto前沿，说明NSGA-II算法优化解集合理，且整个解集分布范围广、可以较好地体现清江梯级水库发电效益和生态效益之间的协调关系。需要说明的是，考虑生态流量的常规调度在水库出库流量不满足生态流量的情况下增大下泄流量，属于刚性约束；而多目标优化将生态流量满足程度作为目标之一，属于柔性约束。刚性约束只根据当前调度时段的状态决定当前的出库流量，没有考虑当前蓄水对未来用水要求的满足，而柔性约束可以通过减少当前时段放水量用以缓和未来可能出现的用水短缺现象 [ 17 ]。 2) 发电缺额及发电保证率与生态缺水量呈明显的负相关关系，即考虑生态效益会在一定程度上降低发电效益，降低生态缺水量会增加发电缺额并降低发电保证率。本研究中水库出库流量可以归为以下三类：一是发电流量，用以提供发电效益，二是生态流量，提供生态效益，三是弃水，由于发电限制产生。当然，发电流量和生态流量有交集，既提供发电效益又提供生态效益，这部分共用流量产生发电和生态的联合效益；那么与此相对应的，只提供发电(生态)效益的流量，提供纯发电(生态)效益。需要说明的是，梯级水库按照规划设计所确定的保证出力运行，其各个时段出库流量相对稳定；而生态流量在汛期和非汛期有着明显的区别。若同时考虑发电和生态效益，在来水相同的情况下，那么必然有部分出库流量只能提供纯发电或生态效益，纯发电流量越多，发电缺额越低，发电保证率就越高，那么纯生态流量就越少，生态缺水量也就越大。 3) 考虑适宜生态流量的情况下的生态缺水量过大。优化目标中的生态缺水量为整个调度期内的总量，考虑最严重的情况，即按Pareto前沿中生态缺水量最大值计算，最小生态流量的旬均缺水量为31.20 × 10 6 m³，占最小生态流量的4.02%；适宜生态流量的旬均缺水量为110.36 × 10 6 m³，占年总适宜生态流量的11.27%。整体来看，生态流量要求的增加激化了发电和生态效益之间的矛盾。  由图2可知，生态效益增加的同时发电效益降低。为研究发电效益和生态效益的博弈关系，在一个较高的发电保证率下，分别统计考虑最小下泄流量、最小和适宜生态流量的优化调度结果见表1。由表1可知，随着生态流量要求从最小生态流量到适宜生态流量依次增高，梯级水库总发电量相对考虑最小下泄流量的情况依次减小0.08%和2.79%，总弃水量依次减小3.77%和6.61%。说明发电保证率较高的情况下，生态要求的提高会减少弃水、降低发电效益，最小生态流量相对适宜生态流量的优化空间更大，对清江流域生态效益的衡量来说适用性更高。 Table 1 调度指标 优化调度(最小下泄流量) 优化调度(最小生态流量) 优化调度(适宜生态流量) 发电量(亿kW·h) 水布垭 35.03 35.23 34.06 隔河岩 29.27 28.97 28.11 高坝洲 9.83 9.87 9.89 梯级 74.13 74.07 (−0.08%) 72.06 (−2.79%) 弃水量(亿m³) 水布垭 1.36 1.39 1.22 隔河岩 1.86 2.06 1.73 高坝洲 10.85 10.10 10.19 梯级 14.07 13.54 (−3.77%) 13.14 (−6.61%) 发电保证率(%) 91.6 88.61 (−2.99%) 88.31 (−3.29%) 最小/适宜生态流量缺水量(10 6 m³) - 6.41 (−15.24%) 185.46 (−8.00%) 表1. 考虑不同目标的梯级水库调度结果  清江流域最小生态流量较适宜生态流量具有更好的适用性，考虑最小生态流量情况下，绘制1984~1987年水布垭、隔河岩水库水位流量过程见图3。如图3所示，水布垭和隔河岩水库的出库流量变幅很小，除非来水发生较大改变时才有一定的波动；水布垭水库以一年或几年为调节周期，表现出一定的年调节或者多年调节能力，而隔河岩水库配合水布垭水库进行补偿调度，周期调节规律不显著。 采用表1考虑最小生态流量的优化调度生态缺水量结果对最小生态流量进行了修正，修正后的最小生态流量过程见表2；再使用基于Tennant法的评价方法 [ 12 ] 对修正后的最小生态流量过程进行评价，见表3，修正后生态流量过程较原过程具有相同的评价效果，说明优化调度结果对最小生态流量修正后的过程不影响Tennant法所划分的产卵育肥期和一般用水期的生态效益。 图3.1984~1987年水布垭和隔河岩水库水位流量过程 Table 2 月份 5 6 7 8 9 10 11 12 1 2 3 4 水布垭 201.47 232.17 126.04 64.76 67.92 50.78 45.56 35.00 35.00 42.73 55.94 133.57 隔河岩 273.71 326.90 329.71 171.49 152.63 73.03 64.98 50.22 46.00 52.34 74.08 186.64 表2. 水布垭和隔河岩最小生态流量修正结果(m³/s) Table 3 断面名称 一般用水期(10~3月) 产卵育肥期(4~9月) 占多年平均流量比例(%) Tennant法评价结果 占多年平均流量比例(%) Tennant法评价结果 水布垭(原) 37.06 好 34.30 中 隔河岩(原) 37.61 好 42.42 极好 水布垭(修正) 37.89 好 32.50 中 隔河岩(修正) 36.49 好 41.87 极好 表3. 最小生态流量修正结果评价"
"本文以清江水布垭–隔河岩–高坝洲梯级水库为研究对象，结合梯级水库优化调度模型和多目标优化算法，研究了生态流量对梯级水库发电和生态效益目标的影响并对各目标间的协调关系进行了分析，并从水库优化调度的角度讨论了水文学方法计算得出的水布垭、隔河岩断面最小和适宜生态流量的适用性，结论如下： 1) 基于高斯径向基函数的调度规则优化结果较水库现行的常规调度更能降低发电和生态缺水量，提高发电和生态效益；发电缺额及发电保证率与生态缺水量呈负相关关系，生态效益的增加会在一定程度上降低发电效益。 2) 与考虑最小下泄流量的优化调度相比，考虑最小和适宜生态流量的梯级水库优化调度发电量分别降低0.08%和2.79%，弃水量分别降低3.77%和6.61%，说明生态要求的提高会减少弃水、降低发电效益，且最小生态流量比适宜生态流量更适用于清江梯级水库的生态调度。 3) 采用考虑最小生态流量的优化调度生态缺水量结果对最小生态流量进行修正，修正后的生态过程不仅可以降低水库调度的生态缺水量，还能够较原最小生态流量值有相同的Tennant法评价结果，适用性更高。"
