"目的：探讨在i_Open 0.36T医用磁共振成像(MRI)系统上开发测试液体T 2 横向弛豫时间Carr-Purcell-Meiboom-Gill (CPMG)序列的可行性与实现方法。方法：pascal语言编辑源程序，可调参数控制激发脉冲波形，相位，幅度，持续时间等属性，回波间隔，数据采集次数，采样点数，采样时间等，编排数据记录方式，满足反演求T 2 的需要。编译源程序，上机调试实验，测试样品T 2 ，与标准值比较。结果：完成了CPMG序列源代码，编译的可行性文件能够在商业磁共振成像仪上运行，测得的CuSO 4 溶液样品的T 2 值为197.479 ms。结论：利用该方法实现的CPMG序列所测样品T 2 值与标称值一致，满足实际应用需要，利用该方法实现CPMG序列是可行的。 关键词 :核磁共振，脉冲序列，CPMG，实现应用 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"核磁共振(nuclear magnetic resonance, NMR)现象自被发现以来，应用领域不断扩大，应用层次不断深化，已发展成为许多领域举足轻重的技术 [ 1 ] [ 2 ] [ 3 ] 。物质的弛豫时间是与NMR技术应用相关的两个重要属性，CPMG序列是测量样品本征横向弛豫时间的主要方式。NMR技术的核心是脉冲序列 [ 4 ] [ 5 ] ，近十几年来，我国科研工作者开始关注序列开发实现技术 [ 6 ] [ 7 ] [ 8 ] ，但技术核心仍然掌握在发达国家手中。出于利益考虑，各大厂商的脉冲序列实现方法一直是商业机密。因此，研究脉冲序列的实现方法对于磁共振商业机器软硬件核心的国产化具有很重要的商业价值和实际意义。本文探讨基于RI谱仪的CPMG (Carr-Purcel1-Meiboom-Gill, CPMG)脉冲序列实现方法，并给出对样品的测试结果。"
"CPMG脉冲序列的时序示意图如图1所示。X方向90˚射频脉冲后间隔TE/2时间施加Y方向180˚翻转脉冲，适时开启采样命令，对信号进行采样，TE时刻出现回波峰值，−Y方向施加180˚脉冲，采集回波，±Y方向依次连续施加多个180˚脉冲，在相应时间窗口依次对相应回波采样，每隔TR时间重复上述过程，循环NS次(NS为叠加次数，即单一的序列执行次数)，原始数据(RAW data)依次存入序列预先开辟的内存空间(k空间)，完成回波数据的采集。数据可以用命令行方式以约定格式存储到硬盘，方便后续的调用和处理 [ 9 ] [ 10 ] 。 图1. CPMG序列时序示意图  我们所用设备为万东医疗公司生产的i_Open 0.36T永磁磁共振，谱仪组件来自于英国的RI公司，支持pascal语言编码脉冲序列，pascal语言虽然不够直观，但是能够控制序列中的几乎所有元素，可以实现复杂精微的功能。利用RI提供的底层接口协议层，编程语言用pascal，按照编程规范 [ 9 ] 实现各事件元素。序列首先开辟大小为SI × C25 (SI为每个回波的采样点数，C25为序列运行一次的回波数)个32字节(每个数据点是一个复数，实部虚部都是占16个字节的实数)的内存空间用于存放采集到的原始数据。如果采集次数NS大于1，则第二次以后采集的数据与原有数据进行累加，由于噪声的随机性，可使信号的SNR提高到NS 1/2 倍。序列中的各变量因素，主要包括90˚激发脉冲持续时间、幅度、相位；180˚激发脉冲持续时间、幅度、相位；90˚和180˚脉冲时间间隔；主频率控制；偏移量控制，采样间隔，采样点数等均能通过可调参数实时修改得到反馈结果。  将序列源代码与RI提供的库文件一同编译连接，得到可执行文件，加载到磁共振调试软件，通过互动界面调试，通过后再测试样品T 2 。根据实际需要初步确定实验参数，然后根据实验信号调整各个参数，T 2 反演是用我们开发的软件实现，对于测试用的某浓度CuSO 4 水溶液样品(标称值T 2 = 200 ms)最后确定一组比较理想的参数如下：激发脉冲为的高斯脉冲,脉冲宽度3 ms，TR = 3000 ms，TE = 32 ms，DW = 28 μs，SI = 512，NS = 2，C25 = 16。利用反演软件对采集数据根据反演算法求样品T 2 ，与标准值对照验证。"
"序列源文件是本系统最重要的部分，也是系统最重要的体现，在该模块中，使用者可以进行底层控制和参数内容调整，同时也可以对一些问题进行逻辑分析。  设计的脉冲序列编译后，形成一个可执行文件，然后由谱仪软件RINMR调用，加载到系统，采用图形界面的命令行方式，实时向谱仪控制软件发送指令，改变脉冲序列的参数，实现激发和数据采集功能。  利用选定参数的理论分析结果和实验采集的数据及其反演结果如图2~4所示。 图2中横坐标的数字1，2，3，……处为回波峰值的所在时间点。 图2. 理论结果：各回波峰值按T 2 参数成指数衰减的曲线 图3. 实验结果：各回波峰值按T 2 参数成指数衰减的曲线 图4. T 2 反演结果：197.479 ms"
"尽管FID实验对于设定磁共振仪器的基本参数非常有用，但也有许多缺点。主要是通过FID获取的数据波形不仅受样品本身，还与样品范围内的磁场均匀度有关。样品的本征弛豫时间数据是区分不同组织，进行图像加权技术的基础，众多科研工作者需要研究样品本身属性对核磁共振信号的影响，因此去除磁场不均匀效应对信号衰减的贡献就非常有用了 [ 11 ] ，而CPMG序列正可以实现这一目的。脉冲序列作为磁共振成像技术的核心，其各种序列参数(RF脉冲形状、幅度、相位循环；梯度形状、幅度；相位编码步；采样间隔；叠加次数；空扫次数；TR；TE；接收带宽)的设置，均可影响到信号。无论对技术人员还是诊断医生，深入理解序列参数与信号之间的关系，均具有重要的实际意义。各MRI设备生产厂家，出于技术保护等原因，生产的MRI商品只有少数参数能在极其有限的范围内改变，意义也在种种界面的包装下变得模糊不清。我们利用Tubro Pascal语言，通过变量控制的方式，设计实现各种参数可调的CPMG脉冲序列，以可执行文件形式由谱仪软件调用，加载到系统，采用图形界面的命令行方式，实时向谱仪控制软件发送指令，改变脉冲序列的参数，实现丰富而灵活的控制，对于理解NMR原理和技术实现提供了良好的桥梁。 序列中的激发脉冲形状可以在文本文件中定义，可以根据需要使用任意波形，幅度和相位分别由变量控制，可以在序列调试过程中根据反馈信号实时修改，完全由序列调试人员控制。 我国生产磁共振扫描机的企业大多采用组装的方式，核心部件谱仪大多依赖进口，序列开发的研究近年来进步较大，有系列研究发表 [ 6 ] [ 7 ] [ 8 ] ，但与国际先进水平尚有较大差距。 项目组的最终成果是能够应用于商业机器的脉冲序列，包括文本，源程序，编译的可执行文件，特色是丰富了原机器自带序列参数控制极其有限的弱点，大大增加了可实时调整的参数和因素。通过实施该项目，我们学到了很多课堂上无法学到的东西，增加了实践动手能力，培养了团结协作的团队精神，对软件产品开发的方方面面有了具体而深刻的体会，必将对将来的工作就业产生积极的影响。"
"国家级大学生创新创业训练计划项目(201510439162)。"
