"我国的农业机械化还处在起步阶段，特别是在浇水这一环节费时费力，机械化程度低，无法将浇水量控制在农作物生长所需要的最佳范围，浪费了水资源。针对这一情况，本文设计了一种基于ARM开发系统控制下的对农作物进行自动定量浇水的机器。该机在发动机的牵引下前进时，先由摄像头检测出垄上的植株位置，并通过数据线将所获取的数据传递给ARM板(ARM开发板，即以英国ARM (Advanced RISC Machines)公司的内核芯片作为CPU，同时附加其他外围功能的嵌入式开发板)。ARM板向继电器控制电路中发送控制信号，以控制电控开关的闭合，电磁阀得电打开完成浇水作业。通过试验表明该机作业性能稳定，运行平稳，易于操作，安全和调整维护方便简单，实现了对植物幼苗的自动化浇水，提高了作业效率。 关键词 :自动化，控制，田间，定量浇水 Copyright © 2018 by author and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"农业是我国经济发展的重要组成部分 [ 1 ] 。水分直接影响着植物的生长发育以及产量和品质 [ 2 ] [ 3 ] [ 4 ] [ 5 ] ，适时、适量的浇水是保证农民获得高产优质蔬菜的重要环节。 目前，节水灌溉方式主要有滴灌、喷灌、沟灌和穴灌 [ 6 ] 。 滴灌是通过安装在毛管上的滴头、孔口或滴灌带等灌水器将水一滴一滴地、均匀而又缓慢地滴入作物根区附近土壤中的灌水形式。缺点是：容易堵塞；导致盐渍化；影响农作物根系发展。 喷灌是指利用动力设备驱动相关机械，使水在压力作用下通过喷嘴(喷头)喷射到空中，然后以雨滴的状态洒落至烟田的灌溉方式，局限是受风影响大；设备投资高；耗能大。 沟灌作业一般采用单沟灌水，即一沟挨着一沟依次灌水，水分沿着水沟渗透两侧垄，沟底部分在重力的作用下浸润土壤。作业速度快，而且地温变化相对较小，作业效果优于单沟灌，但容易使土壤结构被破坏。穴灌作业时在相邻两株烟草的中间打一个直径和深度均为20 cm左右的穴(孔)，然后舀水逐穴(孔)进行灌水，每穴(孔)灌满为止，但作业费时费工 [ 7 ] 。 我国的灌溉机械还处在起步阶段，浇水这一环节费时费力，机械化程度地，无法按需浇水。实现机械自动化浇水是保障农业经济效益的有效措施。 针对这一现象，本文研制了一种基于ARM控制系统下的田间自动化定量浇水，可自动确定植株位置，精准浇水，节约水资源。"
"田间自动化定量浇水机采用自走式，主要由动力系统、传动系统、行走系统、检测控制系统、光箱、水箱、潜水泵、电瓶、电磁阀等组成，总体结构如图1所示。2个12 V蓄电池串联后作为电磁阀和潜水 图1. 自动化定量浇水机结构简图 泵的启动电压，所有负极接地。光箱通过光箱悬挂架固定在浇水机后方，光箱上方安装着监测控制系统，摄像头通过悬挂架固定在光箱中心线后方位置，摄像头尾部通过数据线与ARM板连接，光箱里面均匀布置着8个灯条安置架，每条灯条安置架上面都安装着一个12 V LED灯条和漫射板。水箱里安置一个潜水泵，通过两条输水软管与储水罐相连接，水箱里的水通过潜水泵、电磁阀和两条输水管循环起来，保证储水罐里时刻充满水。储水罐连接在光箱后方中间位置，其底部与电磁阀相连。  浇水前，首先调正浇水机，使摄像头位于烟垄中心线正上方。根据垄高调节高度调节丝杠以调整整机高度，然后调节光箱悬挂架使机器行进过程中光箱不碰触植株，且能隔绝外界大部分光线。最后调节摄像头悬挂装置，使得摄像头距离垄顶平面的垂直距离为10~15 cm，距电磁阀的水平距离为12~15 cm。 浇水机工作时，打开行走离合，变速箱将来自发动机的动力传给行走机架，带动浇水机的前进。打开ARM板开关和潜水泵开关，安装在ARM板上的摄像头在行走过程中检测植株位置，获取图像，然后将数据传递给ARM板，ARM板将摄像头取得的数据与原始设定的数据作比较，如果摄像头所获取的数据在所设定的数据范围内，则认为检测到烟草位置。此时ARM板将向继电器控制电路输出一个低电平信号，继电器控制电路接收到该信号后，位于继电器中的电控开关闭合，电磁阀得电导通，完成浇水。浇水量可以通过电磁阀打开的时间长短来控制，电磁阀打开时间通过ARM板输出的信号控制。  依据浇水农艺和浇水机功能特征要求，确定自动化定量浇水主要技术指标如表1所示。 浇水机的实物图如图2所示。"
"1) 颜色特征。这是一种全局的特征，主要描述了目标图像或者目标图像区域所对应事物的表面性质。 Table 1 参数 数值 整机尺寸(长 × 宽 × 高) (mm) 1800 × 1140 × 1040 配套动力(kW) 4~8 发动机转速(r/min) 1800 蓄电池(A∙h) 60 蓄电池电压(V) 12 行进速度(m/s) 0.46 作业行数 1 作业方式 自走式 株距(mm) 500 行距(mm) 1200 垄高(mm) 350 表1. 主要技术指标 图2. 自动化定量浇水机实物图 2) 纹理特征。纹理特征指的是图像的灰度等级变化，它反应的是物体表面的方向性、粗糙度以及物体表面所符合的某种规则性。 3) 形状特征。这是图像中一种高级的视觉特征，可以用来表示目标物体的姿态和结构 [ 8 ] 。  采集植物幼苗田图像，对图像的颜色特征进行分析。对图像中植物、黄土、黑地膜、白地膜分别随机选50个像素点，逐一提取每个目标像素点的R分量值、G分量值、B分量值，并根据提取数据画出以上四个目标的RGB分量值散点图。需要计算分析四个目标RGB三个通道数据之间的关系来确定区分植物目标的阈值 [ 9 ] [ 10 ] 。 然后分别计算四个目标的各通道分量值均值，以计算出的R、G、B分量均值作为该张图像数据中植物、黄土、黑地膜、白地膜的代表值： R = ∑ i = 1 N R i N (3-1) G = ∑ i = 1 N G i N (3-2) B = ∑ i = 1 N B i N (3-3) 1) G-R梯度变化 在G-R归一化数据图中，烟草数值最大，与烟草数据相距最近的是黑地膜数据。计算烟草数据与黑地膜数据的梯度变化。 2) G-B梯度变化 在G-B归一化数据图中，烟草数值最大，与烟草数据相距最近的是黄土数据。计算烟草数据与黄土数据的梯度变化。 3) B-R梯度变化 在B-R归一化数据图中，烟草数据介于黄土和白地膜之间，与烟草数据相距最近的是黄土数据。计算烟草数据与黄土数据的梯度变化。 4) G/B梯度变化 在G/B归一化数据图中，烟草数据最大，与烟草数据相距最近的是黄土数据，计算烟草数据与黄土数据的梯度变化。  检测控制系统是浇水机的核心部分，用以实现烟草位置的检测，电磁阀开闭的控制和浇水量大小的控制。 检测控制系统主要由ARM板、摄像头和继电器控制电路组成，检测控制系统固定在光箱顶部的检测控制系统安装口上。ARM板和继电器控制电路由两个12 V电瓶串联后，通过电源转换模块将电压转换成5 V供电，所有负极接地。其工作流程图如图3所示。 摄像头固定在光箱中的摄像头悬挂架上面，可实现摄像头前后方向和上下方向的位置调节，摄像头尾部通过数据线与ARM板相连，并通过数据线将所获取的数据传递给ARM板。 ARM板中存储着设定好的程序，不同的颜色在ARM板的程序中存储的数据是不一样的，经过大量试验，总结出在ARM板的程序中代表烟草“绿色”的合适数据范围 [ 11 ] [ 12 ] 。ARM板接收到摄像头采集的图像数据后，对数据进行分析和处理，当所获取的数据在代表“绿色”的数据范围内时，ARM板向继电器控制电路输出低电平脉冲信号，以控制继电器中电控开关的闭合。通过设定的程序可以控制低电平脉冲信号的长短，从而确定继电器中电控开关的闭合时间。 继电器控制电路用来控制电磁阀的打开和关闭。当继电器控制电路接收到ARM板发出的信号后，通过光电耦合器使该信号完成“电–光–电”的转变，从而控制继电器中电控开关得电闭合，此时电磁阀得电导通，完成浇水。当低电平脉冲信号结束时，继电器中的电控开关打开，电磁阀关闭，结束浇水。  浇水机前进，摄像头采集图像数据，提取图像中间640个像素点的RGB值，计算各像素点G-B值、 图3. 检测控制系统工作流程图 G-R值并归一化处理，当至少有70个像素点满足G-B值> 0.85且G-R值> 0.85，再提取500 × 50像素区域RGB分量，计算各像素点G-B值、G-R值并归一化处理，在计算图像数据的G-B数值与G-R数值，并进行归一化处理后，所有代表植株的G-B特征值最小为0.81，G-R特征值最小为0.8431。因此，以G-R > 0.85且G-B > 0.85作为区分植株与黄土、黑地膜、白地膜的阈值。当至少有5000个像素点满足G-B值> 0.85且G-R值> 0.85时输出控制信号，电磁阀打开，浇水量延时，输出信号结束 [ 13 ] 。 自动化浇水机检测系统设计中还需要必要的软件支持。Visual Studio是目前非常流行的，由微软公司开发的Windows平台应用程序开发环境。集成开发环境的界面增加了很多新的功能，变得更加高效，同时也更加简单明了 [ 14 ] 。本设计检测系统软件编程采用C语言程序，基于Open CV，以VS2010为开发环境进行编写。 摄像头固定在光箱中的摄像头悬挂架上面，可实现摄像头前后方向和上下方向的位置调节，摄像头尾部通过数据线与ARM板相连，并通过数据线将所获取的数据传递给ARM板。 ARM板中存储着设定好的程序，不同的颜色在ARM板的程序中存储的数据是不一样的，经过大量试验，总结出在ARM板的程序中代表烟草“绿色”的合适数据范围。ARM板接收到摄像头采集的图像数据后，对数据进行分析和处理，当所获取的数据在代表“绿色”的数据范围内时，ARM板向继电器控制电路输出低电平脉冲信号，以控制继电器中电控开关的闭合。通过设定的程序可以控制低电平脉冲信号的长短，从而确定继电器中电控开关的闭合时间。 继电器控制电路用来控制电磁阀的打开和关闭。当继电器控制电路接收到ARM板发出的信号后，通过光电耦合器使该信号完成“电–光–电”的转变，从而控制继电器中电控开关得电闭合，此时电磁阀得电导通，完成浇水。当低电平脉冲信号结束时，继电器中的电控开关打开，电磁阀关闭，结束浇水。"
