"基于近两年北京市轨道交通自动售检票(AFC)系统标准体系改革背景，对AFC设备维修管理基本现状进行描述，阐述AFC设备维修管理系统的不足，并结合下一步改革的要求，分析AFC系统的维修需求。依据标准化规范，依托北京地铁AFC系统标准软件开发经验，提出了构建新的标准化设备维修管理系统的方案。 关键词 :轨道交通，自动售检票，标准化，维修管理，系统构建 Copyright © 2018 by author and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"近年来，随着我国城市轨道交通建设迅猛发展，已经形成轨道交通网络化和多运营主体的运输格局，对网络运营组织管理提出了更高的标准和要求。AFC系统的标准化及网络化运营，进一步成为各大城市AFC系统建设及运营管理的重点 [ 1 ] 。 以北京为例，北京地铁自2015年开始实施AFC系统标准体系改革，统一全网线路技术标准和接口规范，致力解决不同集成商开发系统之间互通、兼容的问题，降低旧线改造、设备招标、系统开发、运营和维修、维护成本 [ 2 ] 。 AFC系统是典型的机电一体化设备，涉及计算机、信息电子、软件工程数据加密、机械制造、IC (interrated circuit，集成电路)芯片、网络等多学科和多种技术，维护管理作业复杂，对维护维修人员技术能力及维修管理系统要求高。AFC系统良好的维护保障，对提高系统可靠性、可用性及可维修性有着重要作用 [ 3 ] [ 4 ] 。AFC设备维修管理系统作为配套AFC设备维修的技术管理手段，能有效提升城市轨道交通运营部门设备维修管理水平，提升维修质量，为设备维修费用降低提供帮助。 随着城市轨道交通标准化改革，轨道交通运营管理模式由线路转变为线网，对AFC设备维护管理系统提出新的要求。线网化维修管理要求做到统一化、规模化和标准化，现有AFC设备维修管理系统已经无法满足AFC运营管理的需求。一个标准化的AFC设备维修管理系统亟待建立，优化AFC设备维修管理工作，提高AFC系统运行和检修工作效率、运行质量、经济效益和社会效益。 国内部分城市在网络化维修管理方面做过很多工作，主要在维修组织、计划调度和备品备件管理等方面有很多好的经验 [ 5 ] [ 6 ] [ 7 ] [ 8 ] 。但是在AFC系统标准体系改革背景下，从线网运营角度构建AFC设备维修管理系统，则鲜有成果。 本文对北京轨道交通AFC系统维修管理现状进行描述，在详细分析AFC设备维修需求的基础上，结合AFC系统标准化运营的特点，提出AFC设备标准化维修管理系统的构建方案。"
"北京地铁AFC系统标准化改革过程中，现有AFC设备维修管理系统不能满足标准化、线网化运营需求，暴露出的不足主要有以下几点。  AFC系统标准化改革前，城市轨道交通AFC系统的设备维修管理系统处在由集成商各自定制开发的阶段，不同集成商，甚至是同一集成商的不同线路、同一线路的不同期区间的设备维修管理系统特点各异、良莠不齐，互相间的兼容性和互通性不理想。往往造成新线开通时，轨道交通管理人员不熟悉维修管理系统、人为操作失误导致故障无法及时解决，影响地铁通勤效率。 目前，北京地铁平均每年有4至5条新线或区间通车 [ 9 ] ，彼时投入大量的资源对地铁运营人员进行新线维修系统使用专项技能培训，造成运营、维修、维护成本的浪费。  现有维修/保养数据的收集主要由人工完成并记录。AFC设备维修管理系统没有与AFC设备接口及上位系统对接，车站中心、线路中心以及指挥中心无法及时并准确获取现场故障、维修/保养数据。 数据没有系统整合分析利用，带来直接后果为设备维修历史无法跟踪、设备生命周期无法分析。  设备互换、关键模块互换，需要对其进行精细化管理，减少备品备件的需求，减少维护、升级和系统扩展费用，提高维护效率，降低对维护人员的要求，提高服务水平，打破垄断，形成供应商良性竞争。  有大量故障是人为造成的。严格执行设备操作规程，特别是关键流程的规程制定，例如票箱更换，拆卸、安装操作不规范，造成票箱机械故障。  AFC系统架构标准化改革后，维修管理系统不再只是设备层的维修需求，上层SC/LC/MLC也对维护系统提出了新的要求。AFC系统对于SC层和设备层的兼容性提出了更高要求，要求实现SC对下位机器的故障状态监控、参数/软件版本监控及更新等远程统一控制，减少在设备本地操作的次数和频率，降低运维成本。 同时，设备层、关键模块的接口标准化，要求维修管理系统增加模块互换测试、TPU参数下载和生效版本的查询等功能。  AFC系统标准化工作是逐级推进、分阶段实施的过程，未来几年北京地铁会继续推进各集成商底层模块的接口标准化工作，必然会对维护系统提出新的需求；另外，根据往年轨道交通发展经验，城市人口基数、新线接入等诸多因素，也会持续不断对轨道交通运营、维护提出新的需求。 维护系统面向的需求由单条线路转化为全网所有线路，这对维护系统可扩展性提出了更高的要求。"
"北京地铁已实现的ACC/AFC标准化体系结构，如表1所示。从线网角度来分析，各层系统及设备的维修需求各有特点。  为提高运营管理水平，为乘客提供良好的售检票环境，AFC系统维护管理部分应维护好系统设备，保证设备状态良好、正常运行。同时，应制订相应技术标准、设备维修流程、设备操作和日常维护保养规程、安全规则和配套的有关规章制度 [ 10 ] [ 11 ] [ 12 ] [ 13 ] 。 AFC维修管理系统的基本目标是提高AFC系统运行效率，降低故障率，延长使用寿命，并创造系统 Table 1 系统 ACC MLC/LC SC SLE 内部接口 与MLC/LC接口 与ACC接口 与SC接口 与MLC/LC接口 与SLE接口 与SC接口 与读写器接口 与其他终端模块接口 外部接口 与“一卡通”接口 - - - 操作界面 ACC工作站操作界面 MLC工作站操作界面 SC工作站操作界面 终端设备的乘客界面及维修界面 主要功能 清分管理； 票务管理； 安全密钥管理； 认证管理系统监控管理； 测试培训管理； 时钟管理。 运营管理； 参数管理 软件管理； 时钟同步； 现金收益管理； 数据管理； 权限管理等。 运营管理； 参数管理 软件管理； 时钟同步； 现金收益管理； 数据管理； 权限管理等。 业务处理； 运营管理； 登入登出管理； 数据查询； 票箱管理； 参数/软件版本管理； 设备设置等。 表1. 已实现的ACC/AFC标准化体系结构 设备“状态修”的条件。  从北京地铁现有的ACC/AFC标准化体系结构的四个层次分析，AFC线网化维修管理系统应具有以下功能。 1) ACC需求：维修维护管理实现底层票卡规范管理； 2) MLC/LC：维修维护管理主要实现维修代码、故障代码维护、设备部件信息及库存管理、设备部署管理、维修管理、维护管理、维修工区管理和部件初始化管理； 3) SC：关键流程控制：票箱、钱箱管理，票务管理；数据管理；时钟管理；参数、软件管理；运营管理；日志管理； 4) SLE：AG\TVM\BOM共通：关键部件检测、关键部件更换记录、登入/登出管理、设备管理、数据导入导出。 总结各层需求，细化得到维修管理系统包含的功能清单。以AG为例，维修管理模块包含功能清单如表2所示。  对各层级系统的功能需求进行总结归纳，依据各线路各集成商设备硬件特点、系统运行环境特点，将AFC设备标准化维修管理系统实现需求归纳为以下几种。 1) 支持远程和本地设备级运营状态、故障状态的实时监测与报警。 2) 支持远程和本地关键模块级运行状态、故障状态的实时监测与报警。 3) 支持本地关键模块维修标准互换测试，支持关键模块、非关键模块的维修记录。 4) 支持远程和本地设备级、模块级参数/软件版本查询更新、数据管理。 5) 支持本地票务管理流程引导规范操作。 6) 支持各集成商、新老线、导则线非导则线的实现统一、界面统一，实现可显示尺寸、分辨率、单体测试项目动态配置。 7) 支持可扩展，适应后期标准化工作推进。 Table 2 功能 功能分布 业务子系统 功能模块 站员管理 维护管理 站员管理 显示错误信息、显示版本信息、显示参数信息 √ 运营模式设定、服务模式设定、闸门模式设定 通道类型设定、延长运营时间、24小时运营 票箱更换 基础信息设置 本机设置、通讯设置、运营模式设定、服务模式设定、日期设置 √ 数据管理 数据导入、数据导出、版本查询、日志查询、交易查询 √ 单体测试 PID测试、设备声音测试、网络连接测试、顶棚向导测试、传感器测试、面板键测试、通行指示器测试、指示灯测试、闸门测试、票箱动作测试、回收部复位测试、全体联动测试、车票回收测试、RFID读取测试、TPU复位测试、TPU读取测试 √ 部件功能设置 人体检测设置、测试模式设置、设备音量设置、部件更换设置、时钟同步设置、闸门模式设置、通道类型设置 √ 表2. 维修管理功能清单"
"AFC设备标准维修管理系统基于Qt & C++的系统架构，如图1所示。最上层是界面及界面接口层，用于展示界面并与业务层交换数据；下面分别是业务层、标准接口层，实现完整的业务流程并与其他平台交换数据；最底层是硬件层和设备层，实现业务动作。  系统选用Qt作为界面开发工具。Qt是跨平台C++图形用户界面应用程序开发框架，设计界面非常精巧，执行效率很高；Qt使用布局概念，使得设计界面工作具备很高的灵活性，容易扩展 [ 14 ] [ 15 ] 。使用Qt开发的界面，可以实现跨平台运行，能在不同分辨率的显示屏上完美展示，界面显示、字体等属性可通过配置资源文件的方式来改变，符合北京地铁目前多系统运营、硬件设备种类复杂等特点的运营维护要求。 XML (Extensible Markup Language)是一种用于标记电子文件使其具有结构性的标记语言，是一种非常方便的数据交换与数据存储的工具。目前，XML是各种应用程序之间进行数据传输的最常用的工具。而Qt为XML提供了很好的支持，提供了读取、操作和编写XML的实现类。 本设计采用一线一XML文件，存储各线路维修需求；选择QDomDocument类来处理XML文件。结合Qt与XML技术，实现了各层各设备维修维护子系统通用功能统一化、个性功能差异化配置，实现维修管理系统界面的区别化显示。 以传感器测试为例说明，各集成商传感器测试界面中传感器数量、分布位置各不相同。在XML文件中，存储传感器数目及界面显示位置坐标，存储方法为：在传感器测试元素下，创建子元素，编辑四个属性来描述传感器的协议编号、位置坐标和显示尺寸。 一个QDomDocument类对象，代表整个XML文档，使用QFile打开要读取得XML文档，使用QDomDocument类的setContent()函数来设置整个文档的内容，它会将XML解析成一个DOM树，并保存在内存中；使用QDomNode类，来遍历整个文档，获取对应节点元素及其子节点列表；最后使用QLabel结合QPixmap，刷新示传感器测试图标，实时显示传感器状态：遮挡、非遮挡或故障。 图1. 系统架构  界面创建由xml、Qt技术结合C++实现。xml文件中存储了界面名称，为动态创建界面提供基于Qt对话框QDialog的派生类类名；C++获取xml中类名创建实例。 C++不是动态语言，所以无法从语言机制上实现类的动态创建。本文借鉴MFC中CWnd类的Create方法，结合工厂类的设计思想，利用一套继承体系中的基类作为“管理中心”，由它来维护所有派生类的必要信息，包括类名和工厂函数，这二者通过map建立映射关系。定义了一个派生类后，由工厂类自动向基类进行注册，调用工厂类公共成员函数Product* Create(int i)创建实例，即界面。 界面动态创建的设计，大幅提高了系统的可扩展性。后续标准维修管理系统的升级维护工作，仅需要改动XML文件文本内容，在上一版本系统中添加新的功能文件，无需再对原有系统代码进行修改调试，为后续的标准化改革推进工作奠定坚实基础。  参数下载流程是由MLC/LC下发到车站中心SC，并由SC转发到全站设备。维修管理系统增加了参数比对功能，对比设备的参数版本与上位的参数版本，比对结果一致即为更新成功，否则为更新失败。参数在xml配置文件中存储字段包括《北京轨道交通路网AFC系统设计与实施规范》中定义的参数ID、参数名称以及标准AFC系统软件中定义的参数宏名称，实现界面显示。  为了使运营人员、维修人员的操作更加规范，北京地铁制定了票箱更换的规范操作流程，坚持正确装卸票箱、准确记录票卡出入数目，减少票箱机械故障、RFID故障及票价流失现象。依据标准规程，标准化维修管理系统严格限定了票箱更换流程，如图2所示。不合规范、不合标准的操作被系统认定为非法维修操作，生成非法更换票箱记录。"
"依托AFC标准系统开发经验，调用AFC系统标准接口获取模块服务次数、票卡交易数量、关键模块状态等数据，与现有AFC系统深度集成，如图3所示。  终端设备维修方式转入自动排故障、状态维修为主，界面实时显示故障状态、代码及代码对应故障明细，降低维修成本，提高维修效率。  考虑AFC标准化工作的实施推进步骤，为接下来的线网设备底层库接口标准化提供可行性条件，标准维修管理系统预留了底层库测试功能接口及配置。  标准化维修管理系统通过灵活配置需求、动态生成界面，实现全线网兼容统一化，降低了培训成本、人力成本以及AFC系统升级改造成本，提高了工作效率和质量。 图2. 票箱更换流程 图3. 维修管理系统与标准AFC系统"
"各地城市轨道交通建设方兴未艾，AFC系统的标准化、线网化在逐步形成，也要求AFC维修管理系统朝着“低维修、高性能”方向发展。AFC线网化维修管理能够使得AFC系统的维修工作、维修资源规划及利用更加合理、经济和高效。 文中提出的标准化维修管理系统，目前已经在北京多条线路试点站正式运行，故障平均修复时间显著减少，同时也促进维护操作的规划化，提高了维修工作效率。 AFC设备的维修管理工作仍是一个持续性的课题，需要进行更加深入的优化 [ 16 ] [ 17 ] [ 18 ] ，之后的建设工作应关注以下几方面： 1) 建立有效、完善、合理的维修管理体系，制定严谨的维修管理制度、工单管理制度，维修记录落实到人； 2) 建立运维平台整合设备维修数据，建立自身知识库。统一全网维修管理数据，建立AFC系统可靠性分析体系，为备品备件库存管理提供科学依据，提高利用效率；利用维修知识库，积累维修经验学习，建立学习型组织，降低培训成本。"
