"本文研究一类具有未知延时的线性系统的参数辨识问题。辨识问题包括延时估计和系统参数估计。首先，把延时和参数估计问题转化为具有遗忘因子的关于延时的非线性优化问题，借助Gauss-Newton法得到延时的估计，进而基于最小二乘方法得到系统参数估计。该辨识问题以实际电路系统为研究对象，充分考虑了延时和实际噪声的影响。最后，通过搭建实际电路系统，并以其输入和状态值作为实际测量数据，用本文所提辨识方法进行延时和系统参数辨识。验证结果表明了带有延时的线性微分方程模型的科学性和辨识方法的有效性。"
"在自然科学和社会科学的许多领域中，人们越来越重视对系统进行定量的分析、仿真、控制和预测，而将研究对象模型化，是开展这些工作的前提和基础。通过对未知系统的实验或运行数据进行分析，建立一个与所测系统等价的数学模型属于系统辨识问题。系统辨识作为现代工业控制中的重要分支，在控制系统的设计与分析、监控过程参数、故障诊断、图像识别和信号处理等领域有着广泛的应用 [ 1 ] [ 2 ] [ 3 ] [ 4 ]。系统辨识包含两个部分，即模型结构辨识和参数辨识。在实际应用中，有些系统的模型可以用理论分析的方法借助于已知的定律、定理和原理推导出来，如力学原理、能量守恒定理和化学动力学原理等。在系统模型已知的条件下，确定模型中的一些未知参数属于参数辨识问题。近年来，针对不同模型的参数辨识的研究已经取得了一系列成果 [ 5 ] [ 6 ] [ 7 ] [ 8 ]。文献 [ 5 ] 研究了二阶RC等效电路模型的参数辨识问题，通过使用Levenberg-Marquard算法计算电路模型中的RC值。文献 [ 6 ] 充分考虑了摩擦系数的影响，提出带有遗忘因子的递推最小二乘辨识算法。文献 [ 7 ] 借助改进的人工鱼群算法对光伏组件的数学模型进行参数辨识。文献 [ 8 ] 将蚁群算法用于参数辨识。 许多动力系统可以用微分方程来描述其状态变化规律。然而，随着工业的发展，利用常微分方程来描述一些复杂动力系统变得越来越困难。因为许多动力系统的演化不仅依赖于系统当前的状态，还取决于系统过去某一时刻或若干时刻的状态，这类动力系统被称为延时动力系统，需要建立延时微分方程模型。延时系统广泛存在于实际应用中，例如电子电力系统、神经网络、过程控制、生物环境与医学、建筑工程等领域 [ 9 ] - [ 14 ]。在延时微分方程模型中，延迟项与其他模型参数之间存在非线性关系，这导致辨识难度增加，控制效果下降，特别是在存在测量噪声的情况下，辨识延时微分方程模型的系统参数具有很大挑战。因此，对延时系统参数辨识方法的研究具有重要的理论意义和应用价值。 关于延时线性系统的参数辨识的研究已取得一些进展 [ 15 ] - [ 20 ]。Gawthrop [ 15 ] 等提出一种用有理传递函数逼近延时的方法，但这种方法使得模型阶数增加，因此需要辨识更多参数，而且当系统延时较大时，可能会出现不可接受的近似误差。文献 [ 16 ] 使用时频方法对带有延时的线性动力系统进行参数辨识，同时解决了系统参数估计和初始条件估计问题。Sung [ 17 ] 等利用Levenberg-Marquardt方法最优化包含延时的目标函数，使预测误差达到最小，提出一种连续时间预测误差辨识方法。Orlov [ 18 ] 等针对状态向量和控制中具有有限多个延时的线性动态系统，提出一种自适应参数辨识器，可实现未知延时和系统参数的在线辨识。Ren [ 19 ] 等针对单输入单输出的连续时间延时系统，构造由参数估计误差驱动的自适应律，并引入滑模变换技术以确保参数估计的收敛性。 延时系统的参数辨识的研究大都使用仿真算例进行验证，目前很少有基于实际系统的研究结果。本文将以实际电路系统为研究对象，通过搭建实际电路系统，利用示波器采集系统的输入和状态数据来实现延时估计和参数辨识。实际数据与仿真数据不同，可能存在系统噪音和示波器的测量噪音等不能用具体模型精确描述的噪音，面向实际系统的系统辨识能够进一步检验模型结构的有效性和参数辨识方法的稳健性。本文结构如下：第2节介绍模型和本文将要用到的基本知识；第3节介绍辨识方法；第4节将所提参数辨识方法应用于实际电路系统中，以验证辨识方法的有效性。"
"考虑如下连续时间线性延时系统： ( x ˙ ( t ) = A 0 x ( t ) + A 1 x ( t − τ ) + B u ( t ) , u ( t ) = u ¯ ( t ) + ξ ( t ) , (2.1) 其中 u ¯ ( t ) ∈ ℝ r 是系统真实的输入变量， ξ ( t ) ∈ ℝ r 是系统中混杂的噪声， u ( t ) ∈ ℝ r ， x ( t ) ∈ ℝ n 是观测到的输入和状态变量， τ ∈ ℝ + 是系统的状态延时项， A 0 ∈ ℝ n × n ， A 1 ∈ ℝ n × n ， B ∈ ℝ n × r 是系统的参数矩阵，设参数矩阵 θ T = [ A 0 , A 1 , B ] 。 本文研究的问题是：利用观测到的输入变量 u ( t ) 和状态变量 x ( t ) ，构造一种参数估计算法估计系统(2.1)的延时项 τ 以及参数矩阵 θ 。  在 [ 0, T ] 时间内，取等间隔时间点 t k = k h ，离散步长 h = T N ， k = 1 , ⋯ , N 。假定输入 u ( t ) 在 [ t k , t k + 1 ] 区 间内恒定为 u ( t k ) ，采用欧拉法对系统(2.1)离散化，可得 x ( t k + 1 ) − x ( t k ) = h A 0 x ( t k ) + h A 1 x ( t k − d ) + h B u ( t k ) , (2.2) 其中 u ( t k ) 和 x ( t k ) 分别表示系统(2.1)在 t k 时刻测得的输入和状态值，d表示系统(2.1)离散化以后的时滞量，并且 d = τ h = d _ + l h , 其中 0 ≤ l < h ， d _ 是非负整数。当延时 τ 不是离散步长h的整数倍时， l ≠ 0 ， x ( k − d ) 可由 x ( k − d _ ) 与 x ( k − d _ − 1 ) 线性插值得到。若记 u ( t k ) = u k ， x ( t k ) = x k ， x ( t k + 1 ) − x ( t k ) = x k + 1 − x k = y k ，则待辨识的系统可以转化为 y k = h A 0 x k + h A 1 x k − d + h B u k = θ T φ ( k , d ) , (2.3) 其中 y k ∈ ℝ n , θ T ∈ ℝ n × ( 2 n + r ) , φ ( k , d ) = [ h x k T , h x k − d T , h u k T ] T ∈ ℝ 2 n + r . 因此，本文研究的问题转化为：构造一种参数辨识算法，首先利用观测数据 { u k , x k } , ( k = 1 , 2 , ⋯ , N ) ，估计系统(2.3)的延时d和参数矩阵 θ ，再根据倍数关系计算系统(2.1)中的延时项 τ 。"
"本节基于最小二乘算法和Gauss-Newton优化算法，提出一种线性延时系统的延时项估计和参数辨识算法，该算法可以利用观测数据 { u k , x k } , ( k = 1 , 2 , ⋯ , N ) 辨识系统延时项d和系统参数 θ 。  离线的辨识算法要求如下二次准则函数达到最小： J k ( θ , d ) = 1 2 ∑ i = 0 m − 1     e k − i T e k − i , 其中m是使用的数据长度且满足 k − m ≥ d 。 e k 是节点k处的估计误差，即 e k = y k − θ ^ k T φ ^ ( k , d ^ ) . θ ^ k 是利用节点k之前m组数据计算到的 θ 的估计值， d ^ k 是延时项d的估计值。 参数 θ ，d在节点k处的估计值 θ ^ k 和 d ^ k 可由下式得到： [ θ ^ k T , d ^ k ] = arg min θ , d J k ( θ , d ) , 当非线性时间延迟项d的估计 d ^ 已知时，线性参数 θ ^ k 可由线性最小二乘方法估计： θ ^ k ( d ^ ) = R ^ − 1 ( k , d ^ ) F ^ ( k , d ^ ) , R ^ ( k , d ^ ) = ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) , F ^ ( k , d ^ ) = ϕ ^ ( k , d ^ ) Y T ( k ) , (3.1) 其中 ϕ ^ ( k , d ^ ) = [ φ ^ ( k , d ^ ) , φ ^ ( k − 1, d ^ ) , ⋯ , φ ^ ( k − m + 1, d ^ ) ] ， Y ( k ) = [ y k , y k − 1 , ⋯ , y k − m + 1 ] 。因此准则函数 J k ( θ , d ) 可转化为如下形式： J ⌣ k ( d ) = 1 2 ∑ i = 0 m − 1     e ⌣ k − i T e ⌣ k − i , (3.2) 其中 e ⌣ k = y k − θ ^ k T ( d ^ ) φ ^ ( k , d ^ ) = y k − F ^ T ( k , d ^ ) [ R ^ − 1 ( k , d ^ ) ] T φ ^ ( k , d ^ ) 。 时间延迟d在节点k处的估计值 d ^ k 可由下式得到： d ^ k = arg min d J ⌣ k ( d ) . 可以看出准则函数(3.2)中对节点k之前m组数值的权重是一致的, 为了削弱旧数据对参数估计结果的影响，加强新数据提供的信息量，本文引入遗忘因子 λ ,将(3.2)式转化为具有遗忘因子的准则函数： J ⌣ k λ ( d ) = 1 2 ∑ i = 0 p − 1     λ i e ⌣ k − i T e ⌣ k − i = 1 2 E T ( k , d ) Λ E ( k , d ) , (3.3) 其中 λ 是遗忘因子， 0 < λ ≤ 1 ，p是准则函数 J ⌣ k λ ( d ) 使用的数据量， p < m 。 Λ = d i a g ( λ 0 I n , λ 1 I n , ⋯ , λ p − 1 I n ) , (3.4) E T ( k , d ) = [ e ⌣ k T , e ⌣ k − 1 T , ⋯ , e ⌣ k − p + 1 T ] . (3.5) 由Gauss-Newton算法知延时项d可由如下算法迭代： d k + 1 = d k + μ k , μ k = − ( ϒ T ( k , d ) ϒ ( k , d ) ) − 1 ϒ T ( k , d ) Λ E ( k , d ) , ϒ T ( k , d ) = ∂ E T ( k , d ) ∂ d ^ = [ ∂ e ⌣ k T ∂ d ^ , ∂ e ⌣ k − 1 T ∂ d ^ , ⋯ , ∂ e ⌣ k − p + 1 T ∂ d ^ ] . (3.6) 首先计算 e ⌣ k 关于 d ^ 的导数，并记为 Ψ ( k , d ) ，则： Ψ ( k , d ) = ∂ e ⌣ k ∂ d ^ = − ∂ F ^ T ( k , d ^ ) [ R ^ − 1 ( k , d ^ ) ] T φ ^ ( k , d ^ ) ∂ d ^ = − ∂ F ^ ( k , d ) ∂ d ^ [ R ^ T ( k , d ^ ) ] − 1 φ ^ ( k , d ^ )   − F ^ T ( k , d ^ ) ∂ [ R T ( k , d ^ ) ] − 1 ∂ d ^ φ ^ ( k , d ^ )   − F ^ T ( k , d ^ ) [ R ^ T ( k , d ^ ) ] − 1 ∂ φ ^ ( k , d ^ ) ∂ d ^ , (3.7) 其中 ∂ F ^ ( k , d ) ∂ d ^ = [ ∂ φ ^ ( k , d ^ ) ∂ d ^ , ∂ φ ^ ( k − 1, d ^ ) ∂ d ^ , ⋯ , ∂ φ ^ ( k − m + 1, d ^ ) ∂ d ^ ] Y T ( k ) , (3.8) ∂ [ R T ( k , d ^ ) ] − 1 ∂ d ^ = ∂ [ ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) ] − 1 ∂ d ^ = − [ ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) ] − 1 [ ∂ ϕ ^ ( k , d ^ ) ∂ d ^ ϕ ^ T + ϕ ^ ∂ ϕ ^ T ( k , d ^ ) ∂ d ^ ] [ ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) ] − 1 . (3.9) 对于 ∂ ϕ ^ ( k , d ^ ) ∂ d ^ ，先计算 ∂ ( h x k − d ^ ) ∂ d ^ ， ∂ ( h x k − d ^ ) ∂ d ^ = h ∂ x ( k − d ^ ) ∂ d ^ = h ∂ x ( k − d ^ ) ∂ ( k − d ^ ) ∂ ( k − d ^ ) ∂ d ^ = − h ∂ x ( k − d ^ ) ∂ ( k − d ^ ) = − h l i m γ → 0 x ( k − d ^ ) − x ( k − d ^ − γ ) ( k − d ^ ) − ( k − d ^ − γ ) . 根据Nyquist-Shannon采样定理 [ 20 ]，当采样周期足够小时，采样系统的 γ = 1 ，由此可得： ∂ φ ^ ( k , d ^ ) ∂ d ^ = [ 0 − h Δ x k − d ^ 0 ] , (3.10) Δ 是差分算子， Δ x k = x k − x k − 1 。  算法3.1 系统(2.1)中延时项 τ 和参数 θ 的辨识算法： 第1步：令 k = 1 ，设 k = 1 时对应的观测数据为 { u k ˜ , x k ˜ } ；给定使用的数据量m和p；设置初始值 τ 0 、遗忘因子 λ 和辨识精度 ε ； 第2步：用观测数据 { u k , x k } , ( k = 1 , 2 , ⋯ , N ) 建立信息矩阵： y k ， φ ( k , d ^ k ) ， Y ( k ) ， ϕ ( k , d ^ k ) ； 第3步：进行如下迭代过程： μ k = − ( ϒ T ( k , d ^ k ) ϒ ( k , d ^ k ) ) − 1 ϒ T ( k , d ^ k ) Λ E ( k , d ^ k ) , d ^ k + 1 = d ^ k + μ k , τ ^ k + 1 = h d ^ k + 1 . 其中 ϒ T ( k , d ^ k ) ， Λ 和 E ( k , d ^ k ) 由(3.4)~(3.10)式给出； 第4步：当 ‖ τ ^ k + 1 − τ ^ k ‖ < ε 或 k = N 时，第3步的迭代终止，用(3.1)式估计系统(2.1)中的参数 θ ，则有 θ ^ ( d ^ N ) = R ^ − 1 ( N , d ^ N ) F ^ ( N , d ^ N ) . 否则，令 k : = k + 1 ，返回第2步。 注3.1 第3步中的 d ^ k 不一定是整数，因此在算法3.1的迭代步骤中 x k − d ^ k 由 x k − d ^ _ k 和 x k − d ^ _ k − 1 线性插值得到，其中 d ^ _ k 是 d ^ k 的向下取整。 注3.2 在算法3.1的计算过程中，迭代的每一步均使用到k节点之前的m组数据，因此 k = 1 时对应的观测数据 { u k ˜ , x k ˜ } 应该满足 k ˜ > m 。"
"在实际电路系统中，通常需要知道电子元件的参数值，进而对电路系统进行参数性故障判断。然而，但由于硬件条件的限制，电子元件参数值往往难以测量或测量成本较高，因此本节将上节所提参数辨识算法3.1应用到电路模型中，辨识电路模型中的电压延迟以及电容电阻值，为实际电路系统的参数性故障诊断创造条件。 本文通过运算放大器和STM32芯片搭建延时电路模型，如图1所示。其中，实验所用的信号源是电压源，通过电压–电流转换器得到电流信号，即系统的输入 i ( t ) 。电阻R 1 、R 2 两端的电压 u 1 ( t ) 、 u 2 ( t ) 是系统的状态，延时电压 u 1 ( t − τ ) 和 u 2 ( t − τ ) 通过减法器和STM32芯片的存储功能实现，实现过程如图2所示。本文的实验平台如图3所示。 针对图1中的节点1和节点2写出如下基尔霍夫电流方程： ( i ( t ) − u 1 ( t − τ ) R d 1 − u 1 ( t ) R 1 − C 1 d u 1 d t = 0, u 1 ( t ) R 1 + C 1 d u 1 d t − u 2 ( t ) R 2 − C 2 d u 2 d t − u 2 ( t − τ ) R d 2 = 0. (4.1) 图1. 延时电路模型 图2. 延时电压的实现过程 图3. 实验平台 将上述方程转化为状态空间模型： [ u ˙ 1 ( t ) u ˙ 2 ( t ) ] = [ − 1 C 1 R 1 0 0 − 1 C 2 R 2 ] [ u 1 ( t ) u 2 ( t ) ] + [ − 1 C 1 R d 1 0 − 1 C 2 R d 2 − 1 C 2 R d 2 ] [ u 1 ( t − τ ) u 2 ( t − τ ) ] + [ 1 C 1 1 C 2 ] i ( t ) , 其中 C 1 ， C 2 ， R 1 ， R 2 ， R d 1 ， R d 2 和 τ 是待辨识的参数。 记 x ( t ) = [ u 1 ( t ) u 2 ( t ) ] ， U ( t ) = i ( t ) ， A 0 = [ − 1 C 1 R 1 0 0 − 1 C 2 R 2 ] ， A 1 = [ − 1 C 1 R d 1 0 − 1 C 2 R d 2 − 1 C 2 R d 2 ] , B = [ 1 C 1 1 C 2 ] ，则有 x ˙ ( t ) = A 0 x ( t ) + A 1 x ( t − τ ) + B U ( t ) , x ( t ) ∈ ℝ 2 , U ( t ) ∈ ℝ . (4.2) 利用算法3.1辨识系统(4.1)中的电压延迟 τ 以及电阻电容值，只需先辨识系统(4.2)中的参数矩阵 A 0 、 A 1 和B，再根据其与 C 1 、 C 2 、 R 1 、 R 2 、 R d 1 和 R d 2 之间的数量关系计算出电路系统的电阻和电容值即可。 本节用8位数字示波器在64 s内均匀采集2000组数据，即 T = 64 ， N = 2000 ，采样间隔或离散步长 h = 0.032 。在相同的实验条件下分别测量10次输入和状态值，其中一组输入和状态值 { U k , x k } , ( k = 1 , 2 , ⋯ , N ) 的测量结果如图4所示，测得的前500个状态值如图5所示，可以观察到示波器测得的原始数据噪声较大，因此本节先对原始的观测数据 { u k , x k } 进行Savitzky-Golay数据滤波，再用算法3.1进行参数辨识。 图4. 一组观测到的输入和状态值 设延时量初值为： τ 0 = 0.23 ，取 m = 900 ， p = 100 ， n = 150 ， λ = 0.95 ，利用测得的系统输入和状态值进行10次参数辨识。延时项 τ 的辨识过程如图6所示。参数和延时辨识结果与实际值的对比如表1所示。 图5. 系统(4.2)的前500个状态观测值 图6. 第1~10次实验中延时项 τ 的辨识过程 Table 1 实验结果 τ / s C 1 / μ F C 2 / μ F R 1 / Ω R 2 / Ω R d 1 / Ω R d 2 / Ω 第1次 0.4498 740.1794 683.8233 410.7704 966.3211 523.3962 506.7010 误差(%) 1.36 5.74 2.31 2.69 3.37 2.63 0.65 第2次 0.4495 747.3570 689.6497 417.0305 964.6346 519.4436 516.5465 误差(%) 1.42 6.77 1.48 4.26 3.54 1.85 1.28 第3次 0.4467 749.8180 667.0266 415.2545 958.3749 516.2745 517.7267 误差(%) 2.04 7.12 4.71 3.81 4.16 1.23 1.52 第4次 0.4603 749.3177 666.6400 424.2695 961.4248 524.0130 520.6892 误差(%) 0.94 7.05 4.77 6.07 3.86 2.75 2.10 第5次 0.4503 747.1706 688.7300 400.1934 967.0184 509.8189 521.2468 误差(%) 1.25 6.74 1.61 0.05 3.30 0.04 2.21 第6次 0.4699 738.9344 683.6488 431.2437 964.6696 537.8621 506.8381 误差(%) 3.05 5.56 2.34 7.81 3.53 5.46 0.62 第7次 0.4835 748.1611 666.3721 420.9335 960.1822 534.6097 529.4820 误差(%) 6.03 6.88 4.80 5.23 3.98 4.83 3.82 第8次 0.4488 736.2329 679.7386 408.2738 975.4522 528.9898 515.4247 误差(%) 1.58 5.18 2.89 2.07 2.45 3.72 1.06 第9次 0.4445 747.9704 686.8672 398.2981 973.8660 521.5092 500.6972 误差(%) 2.52 6.85 1.88 0.43 2.61 2.26 1.82 第10次 0.4547 756.1448 683.2641 423.6429 988.2481 505.2398 525.8043 误差(%) 0.29 8.02 2.39 5.91 1.18 0.93 2.94 标准差 0.0123 5.9563 9.3444 10.4088 8.9636 9.7923 9.0216 真实值 0.456 700 700 400 1000 510 510 表1. 电路模型(4.1)中延时项和电子元件参数值的辨识结果及实验误差 图6表明，算法3.1估计出的电压延迟 τ ^ 可以快速收敛到真实的电压延迟 τ ；表1中的结果表明，算法3.1可以在含有观测噪声的情况下准确辨识出电路模型(4.1)中的电压延迟以及电容、电阻值。"
"本文研究一类线性延时系统的延时项估计及参数辨识问题，并将所提方法应用到电路模型中。首先用欧拉法对连续系统进行离散，得到离散模型；然后利用最小二乘方法将延时项的估计问题转化为非线性最小二乘优化问题，且在目标函数中引入遗忘因子；进而用Gauss-Newton法估计系统的延时量，并利用延时量得到系统参数的最小二乘估计值；最后，将所提参数辨识方法应用到电路模型中。计算结果表明，该方法可以在含有噪声的情况下估计出电路模型中的电压延时和电子元件参数值，满足实际应用的需求。"
