"本文将Hartmann函数推广到空间情形，实现了两个异面直线的光滑拼接。但是参数变换 p ( λ , t ) 不再具备调节空间曲线的功能。在用Hartmann函数光滑拼接轴线异面管道轴线的基础上，进一步研究了椭圆管道光滑拼接问题，很好地解决了给定的两个轴线异面椭圆管道长半轴和短半轴不相对应时过渡管道的构造问题。 关键词 :Hartmann函数，异面直线，光滑拼接，参数变换，椭圆管道 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"计算机辅助几何设计主要研究曲线曲面的表示、逼近、分析和综合。在CAGD中，几何造型是基本问题之一，它有着广泛的用途 [ 1 ] [ 2 ] [ 3 ] [ 4 ]。而轴线异面管道光滑拼接问题的算法问题，属于计算几何中经典的难题基础问题。在文 [ 5 ] [ 6 ] 中Hartmann定义了一个函数，并由这个函数光滑拼接了多个共面的直线的基础上，构造了光滑拼接多个轴线共面的圆管道，取得了较好的效果。文 [ 7 ] 中刘雪峰利用Hartmann函数研究了轴线共面的椭圆管道的拼接问题。在文 [ 8 ] [ 9 ] [ 10 ] [ 11 ] 中我们用基于轴线光滑拼接的方法构造了轴线异面的管道的光滑拼接管道。本文我们将利用Hartmann函数光滑拼接异面直线，并可应用于轴线异面管道的光滑拼接。 引理 [ 6 ] 给定两条正则 C 2 连续的空间曲线 Γ 1 : x = γ 1 ( t ) , t ∈ [ 0 , 1 ] 和 ，构造过渡函数 f n ( t ) = t n + 1 t n + 1 + ( 1 − t ) n + 1 , t ∈ [ 0 , 1 ] , n ≥ 0 (1) 则过渡曲线 Γ : x ( t ) = γ 1 ( t ) ( 1 − f n ( t ) ) + γ 2 ( t ) f n ( t ) , t ∈ [ 0 , 1 ] 与 Γ 1 和 Γ 2 分别在 γ 1 ( 0 ) 和 γ 2 ( 1 ) 点处 C n 连续。我们称 f n ( t ) 为Hartmann函数。 实际上 f n ( t ) 只是一个平面曲线，图1是当 n = 2 , 3 时 f 2 ( t ) 和 f 3 ( t ) 的图像。 文 [ 7 ] 中还定义了有理参数变换 p ( λ , t ) = { t 1 − λ + λ t , 0 ≤ λ < 1 t ( 1 − λ ) 1 − λ t , − 1 < λ ≤ 0 (2) 来调整设计参数。我们在按照文献给出的参数变换公式，得不到应有的图像。可将原参数变换公式改成下面的形式 p ( λ , t ) = { t 1 − λ + λ t , 0 ≤ λ < 1 t ( 1 + λ ) 1 + λ t , − 1 < λ ≤ 0 (3) 下面是 n = 2 时，分别取 λ = 0.5 , 0.9 , − 0.5 , − 0.9 可以得到图2中一些平面曲线。 图1. n = 2, 3时， f 2 ( t ) 和 f 3 ( t ) 的图像 图2. 作参数变换后分别取 λ = 0.5 , 0.9 , − 0.5 , − 0.9 时的 f 2 ( t ) 的图像"
"仍然定义有理参数变换 f n ( t ) = t n + 1 t n + 1 + ( 1 − t ) n + 1 , t ∈ [ 0 , 1 ] , n ≥ 0 只有将Hartmann函数与待拼接的异面直线联系起来，得到光滑拼接两个异面直线的空间曲线。 设 γ 1 ( t ) : { x = x 1 + 0 ⋅ t , y = y 1 + b 1 t , z = 0 + 0 ⋅ t , 和 γ 2 ( t ) : { x = 0 + 0 ⋅ t , y = y 2 + b 2 ⋅ t , z = z 2 + c 2 t . t ∈ [ t 1 , t 2 ] 是两个异面直线，分别位于OXY平面上与Y轴平行和位于OYZ平面上与Y轴相交。利用Hartmann函数 f n ( t ) 可以光滑拼接两个轴线异面椭圆管道的轴线 Γ : γ ( t ) = γ 1 ( t ) ( 1 − f n ( t ) ) + γ 2 ( t ) f n ( t ) , t ∈ [ 0 , 1 ] ，其参数形式为 Γ : { x = ( 1 − t n + 1 t n + 1 + ( 1 − t n + 1 ) ) ⋅ x 1 + t n + 1 t n + 1 + ( 1 − t n + 1 ) ⋅ x 2 , y = ( 1 − t n + 1 t n + 1 + ( 1 − t n + 1 ) ) ⋅ y 1 + t n + 1 t n + 1 + ( 1 − t n + 1 ) ⋅ y 2 , t ∈ [ 0 , 1 ] z = ( 1 − t n + 1 t n + 1 + ( 1 − t n + 1 ) ) ⋅ z 1 + t n + 1 t n + 1 + ( 1 − t n + 1 ) ⋅ z 2 . 例1取 x 1 = 1 , y 1 = − 1 , y 2 = 1 , z 2 = 1 , b 1 = 1 , b 2 = 0 , c 2 = 1 ，则两个轴线异面管道的轴线的参数表示为 γ 1 ( t ) : { x = 1 , y = − 1 + t , z = 0. 和 γ 2 ( t ) : { x = 0 , y = 1 , z = 1 + t . t ∈ [ t 1 , t 2 ] 则 n = 2 时， Γ : γ ( t ) = γ 1 ( t ) ( 1 − f n ( t ) ) + γ 2 ( t ) f n ( t ) , t ∈ [ 0 , 1 ] 是光滑拼接异面直线 γ 1 ( t ) 和 γ 2 ( t ) 的空间曲线，图3如下。 图3. 光滑拼接轴线异面管道轴线的效果图 定义 这种将Hartmann函数与待拼接的管道的轴线联系起来得到空间曲线的方法称为推广的Hartmann函数方法。 我们还将参数变换公式(3)与异面直线联系起来，对于不同的参数 λ ，试想得到满足不同要求的光滑拼接异面直线的空间曲线。 例2 设 γ 1 ( t ) : { x = 1 , y = − 1 + t , z = 0. 和 γ 2 ( t ) : { x = 0 , y = 1 − 1 2 t , z = t . t ∈ [ t 1 , t 2 ] 当 n = 1 , 2 时， Γ : γ ( t ) = γ 1 ( t ) ( 1 − f n ( t ) ) + γ 2 ( t ) f n ( t ) , t ∈ [ 0 , 1 ] 是光滑拼接异面直线 γ 1 ( t ) 和 γ 2 ( t ) 的空间曲线。 当 n = 1 , 2 时， Γ : γ ( p ( λ , t ) ) = γ 1 ( p ( λ , t ) ) ( 1 − f n ( p ( λ , t ) ) ) + γ 2 ( t ) f n ( p ( λ , t ) ) , t ∈ [ 0 , 1 ] 是光滑拼接异面直线 γ 1 ( t ) 和 γ 2 ( t ) 的空间曲线。 但是当 λ = 0.1 , 0.3 , 0.5 , 0.7 , 0.9 和 λ = − 0.1 , − 0.3 , − 0.5 , − 0.7 , − 0.9 时，与 Γ : γ ( t ) = γ 1 ( t ) ( 1 − f n ( t ) ) + γ 2 ( t ) f n ( t ) , t ∈ [ 0 , 1 ] 重合，不再具备调节功能，图4如下。 图4. 参数变换后得到的图形与参数变换前重合"
"利用推广后的Hartmann函数，我们研究椭圆管道的拼接问题。椭圆管道拼接问题较于圆管道拼接难度更大，可以构造基于轴线光滑拼接的椭圆管道，还可以在椭圆管道两端拼接长半轴和短半轴相对应的椭圆管道。但是，对于长半轴和短半轴给定的轴线异面椭圆管道，不论对应的长半轴和短半轴是否相同，仍然存在构造的椭圆管道与两端椭圆管道长半轴和短半轴不相对应的问题，需要预处理才能实现光滑拼接。 构造基于轴线光滑拼接的过渡管道时，在轴线每一点处与轴线垂直的平面上构造圆或椭圆。确定与轴线垂直的平面的方法有多种 [ 6 ] [ 12 ] [ 13 ]。至于运用哪一种方法，根据具体情况而定。 设给定两个轴线异面的长半轴和短半轴相等的椭圆管道 Φ 1 和 Φ 2 ，其参数表示为： Φ 1 : { X = x 1 ( t ) + a ⋅ e 11 cos φ + b ⋅ e 21 sin φ , Y = y 1 ( t ) + a ⋅ e 12 cos φ + b ⋅ e 22 sin φ , t ∈ [ 0 , 1 ] , φ ∈ [ 0 , 2 π ] Z = z 1 ( t ) + a ⋅ e 13 cos φ + b ⋅ e 23 sin φ . 和 Φ 2 : { X = x 2 ( t ) + a ⋅ e ′ 11 cos φ + b ⋅ e ′ 21 sin φ , Y = y 2 ( t ) + a ⋅ e ′ 12 cos φ + b ⋅ e ′ 22 sin φ , t ∈ [ 0 , 1 ] , φ ∈ [ 0 , 2 π ] Z = z 2 ( t ) + a ⋅ e ′ 13 cos φ + b ⋅ e ′ 23 sin φ . 其中 γ i ( t ) = { x i ( t ) , y i ( t ) , z i ( t ) , ( i = 1 , 2 ) 为管道 Φ 1 , Φ 2 的轴线的参数表示， E i = ( e i 1 , e i 2 , e i 3 ) , E ′ i = ( e ′ i 1 , e ′ i 2 , e ′ i 3 ) ( i = 1 , 2 ) 分别为与轴心垂直平面的单位正交矢量。 在光滑拼接轴线异面的椭圆管道轴线上构造椭圆管道 Φ ( t , φ ) = { x ( t ) + a e ″ 11 ( t ) cos φ + b e ″ 21 ( t ) sin φ , y ( t ) + a e ″ 12 ( t ) cos φ + b e ″ 21 ( t ) sin φ , x ( t ) + a e ″ 13 ( t ) cos φ + b e ″ 23 ( t ) sin φ . t ∈ [ 0 , 1 ] , φ ∈ [ 0 , 2 π ] 假设给定的椭圆管道 Φ 1 的长半轴与过渡管道在 处的长半轴的二面角为 θ 1 ，椭圆管道 Φ 1 的长半轴与椭圆管道 的长半轴二面角为 θ 2 ，旋转过渡管道 Φ 的轴线每一点 t ∈ [ 0 , 1 ] 处长半轴和短半轴 θ 1 + ( θ 2 − θ 1 ) t 来调整过渡管道的走向，使过渡管道两端的长半轴和短半轴与待拼接的轴线异面椭圆管道的长半轴与短半轴相对应。 例3 对于给定的两个轴线异面的管道 取Hartmann函数为 f ( t ) = t 3 t 3 + ( 1 − t ) 3 则光滑拼接轴线的函数为 Γ : { x = 1 − f ( t ) , y = ( 1 − f ( t ) ) t + f ( t ) , z = f ( t ) . 光滑拼接两个轴线异面的管道的参数表示为 Φ : { X = x + 0 .2 ⋅ e ″ 11 cos φ + 0 .15 ⋅ e ″ 21 sin φ , Y = y + 0 .2 ⋅ e ″ 12 cos φ + 0 .15 ⋅ e ″ 22 sin φ , t ∈ [ 0 , 1 ] , φ ∈ [ 0 , 2 π ] Z = z + 0 .2 ⋅ e ″ 13 cos φ + 0 .15 ⋅ e ″ 23 sin φ . 其拼接效果图为图5。 将过渡管道每一点 t ∈ [ 0 , 1 ] 处长半轴和短半轴旋转 θ 1 + ( θ 2 − θ 1 ) t 角 { e ‴ 11 = − e ″ 11 sin ( θ 1 + ( θ 2 − θ 1 ) t ) + e ″ 21 cos ( θ 1 + ( θ 2 − θ 1 ) t , e ‴ 12 = − e ″ 12 sin ( θ 1 + ( θ 2 − θ 1 ) t ) + e ″ 22 cos ( θ 1 + ( θ 2 − θ 1 ) t , e ‴ 13 = − e ″ 11 sin ( θ 1 + ( θ 2 − θ 1 ) t ) + e ″ 21 cos ( θ 1 + ( θ 2 − θ 1 ) t . { e ‴ 2 1 = e ″ 11 sin ( θ 1 + ( θ 2 − θ 1 ) t ) + e ″ 21 cos ( θ 1 + ( θ 2 − θ 1 ) t , e ‴ 2 2 = e ″ 12 sin ( θ 1 + ( θ 2 − θ 1 ) t ) + e ″ 22 cos ( θ 1 + ( θ 2 − θ 1 ) t , e ‴ 2 3 = e ″ 11 sin ( θ 1 + ( θ 2 − θ 1 ) t ) + e ″ 21 cos ( θ 1 + ( θ 2 − θ 1 ) t .     t ∈ [ 0 , 1 ] 图5. 轴线异面椭圆管道与过渡椭圆管道 后过渡管道的参数表示为 Φ : { X = x + 0 .2 ⋅ e ‴ 11 cos φ + 0 .15 ⋅ e ‴ 21 sin φ , Y = y + 0 .2 ⋅ e ‴ 12 cos φ + 0 .15 ⋅ e ‴ 22 sin φ , t ∈ [ 0 , 1 ] , φ ∈ [ 0 , 2 π ] Z = z + 0 .2 ⋅ e ‴ 13 cos φ + 0 .15 ⋅ e ‴ 23 sin φ . 其效果图为图6。 图6. 轴线异面椭圆管道的光滑拼接"
"本文用Hartmann函数光滑拼接了两个轴线异面椭圆管道的轴线的基础上，研究了给定的两个轴线异面椭圆管道的光滑拼接问题，椭圆管道拼接问题相较于圆管道拼接问题难度更大，除了构造过渡椭圆管道，还需要考虑两端长半轴、短半轴相对应问题，我们很好地解决了提出的问题。"
