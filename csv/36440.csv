"目的：通过比较复杂性阑尾炎与非复杂性阑尾炎各项血液化验指标，分析复杂性阑尾炎的危险预测因素并建立预测模型。方法：记录2014年至2019年之间于青岛大学附属医院行阑尾切除术的患者，根据术后病理分为复杂性阑尾炎或非复杂性阑尾炎。采用统计分析方法比较两组间术前相关血液化验指标的差异，筛选出复杂性阑尾炎的危险因素。使用XGBoost建立模型，并使用SHAP对模型进行解释。结果：共记录阑尾切除术样本共566例，其中复杂性阑尾炎106例(复杂组)，非复杂性阑尾炎460例(非复杂组)。两组比较，其中白细胞、中性粒细胞等11项指标存在显著性差异(p < 0.001)。随机抽取总体样本的70%作为训练集建立模型，以其余30%的样本设为验证集带入模型，计算该模型准确率为81.2%，AUC为0.93。通过SHAP对模型进行分析可发现：复杂性阑尾炎中C反应蛋白(80.93 ± 60.32比13.26 ± 23.26，p < 0.001)、纤维蛋白原(4.77 ± 1.39比3.22 ± 0.99，p < 0.001)及中性粒细胞(12.11 ± 4.38比7.35 ± 4.68，p < 0.001)明显升高，而淋巴细胞百分比明显降低(8.91 ± 5.08比22.41 ± 14.54，p < 0.001)。结论：通过血常规、C反应蛋白及纤维蛋白原等作为指标建立预测模型，能够较好于手术前区分复杂性阑尾炎与分复杂性阑尾炎，对于根据阑尾炎严重程度采取不同的治疗方案有重要的意义。 关键词 :复杂性阑尾炎，血液化验，XGBoost，预测模型 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"急性阑尾炎作为常见急腹症，其发生风险约为7%~8% [ 1 ]。临床上主要分为复杂性阑尾炎和非复杂性阑尾炎。急性阑尾炎的诊断包括病史、体格检查、实验室检查及影像学检查。对于非复杂性阑尾炎，已发布的meta分析及指南指出，抗生素治疗能够取得理想的治疗效果 [ 2 ] [ 3 ]。然而，手术前区分复杂与非复杂性阑尾炎仍是一项挑战。 近年来，随着CT及MRI等方法应用，明显的提高了急性阑尾炎的诊断率，然而，影像学检查并不能如同手术及病理学检查一样直观的对阑尾情况进行判断，部分研究中甚至发现影像学检查会将一部分穿孔患者错误的归类为非复杂性阑尾炎 [ 4 ] [ 5 ]。与此同时，部分急性阑尾炎患者在接受抗生素治疗后病情出现变化，给术前判断阑尾炎严重程度带来较多困难。 部分学者研究认为血液C反应蛋白、淋巴细胞、等炎症因子能够较好的提示阑尾病理的严重程度，并对急性阑尾炎的治疗提供一定的指导，而哪种炎症因子敏感性更强，仍有争议 [ 6 ] [ 7 ] [ 8 ]。本研究的目的在于通过比较复杂性阑尾炎与非复杂性阑尾炎血液炎症因子的差异，探索复杂性阑尾炎中血液炎症因子的变化，进一步区分复杂性与非复杂性阑尾炎，为治疗方案的制定提供指导。"
"研究对象：青岛大学附属医院2014年至2020年1月诊断为急性阑尾炎，并行阑尾切除术(开放或腹腔镜手术)，术后病理提示阑尾炎的患者。 排除标准：1) 儿童大网膜较短，妊娠期子宫膨大可能影响网膜下移，故除外妊娠或年龄小于14岁的患者；2) 患血液系统疾病或结缔组织病患者；3) 同时存在其他感染性疾病患者；4) 近3个月有腹部手术史；5) 术后或病理诊断为阑尾或结直肠肿瘤的患者。 参考Bhangu [ 9 ] 等的研究，由三位经验丰富的临床医生(高鹏、张驰、李振鲁)根据术后阑尾病理类型将研究样本分类为复杂与非复杂性阑尾炎(非复杂组和复杂组)。非复杂性阑尾炎术中可表现为阑尾肿胀、出血，病理上表现为浆膜外炎、溃疡、出血以及有或无脓液；而复杂性阑尾炎患者可在术中发现紫色或黑色变的易碎阑尾、穿孔或脓肿，病理上表现为坏疽、穿孔。 收集并记录所有符合条件患者术前24小时内血液化验结果，包括：白细胞计数(White Blood Cell Count, WBC)、中性粒细胞计数(Neutrophil Count, Neut)、淋巴细胞计数(Lymphocyte Count, Lymp)、单核细胞计数(Monocytes Count, Mono)、嗜酸性粒细胞计数(Eosinophil Count, EOSR)、嗜碱性粒细胞计数(Basophil Count, BASO)、中性粒细胞百分比(Neutrophilic Granulocyte Percent, Neuper)、淋巴细胞百分比(Lymphocyte Percentage, Lymper)、单核细胞百分比(Monocytes Percentage, Monper)、嗜酸性粒细胞百分比(Eosinophil Percentage, Eosper)、嗜碱性粒细胞百分比(Basophil Percentage, Basper)、血小板计数(Platelets Count, plt)、血小板分布宽度(Platelet Distribution Width, pdw)、平均血小板体积(Mean Platelet Volume, mpv)、血小板压积(Platelet Hematocrit, pct)、C反应蛋白(C-reactive Protein, CRP)、纤维蛋白原(Fibrinogen, Fib)、谷丙转氨酶(ALT)、谷草转氨酶(AST)、凝血国际标准化比值(INR)、D-二聚体(DDimer)、性别(sex)、年龄( age)以及身体质量指(BMI)。 使用SPSS 21对两组间各项指标进行对比，方差齐(P > 0.1)结果使用t检验，对于方差不齐(P < 0.1)结果使用t′检验，计量资料采用(均数 ± 标准差)表示，使用二项Logistic对各指标的危险因素进行分析，P < 0.5表明差异有统计学意义。在Python3.6中，采用XGBoost (Boosting框架下实现的树模型机器学习算法) [ 10 ] 以复杂性阑尾炎为目标，对所有变量进行建模。并使用SHAP [ 11 ] 对模型进行解释。"
"共有566名阑尾炎患者纳入研究，其中，非复杂性阑尾炎患者406人，复杂性阑尾炎患者160人(表1)。两组中非复杂组年龄低于复杂组(36.28 ± 16.2比40.31 ± 17.97，p = 0.014 < 0.05)，两组性别分布存在差异(203/203比62/98，p = 0.016 < 0.05)。BMI、白细胞、中性粒细胞等15项指标的差异有统计学意义，其中白细胞、中性粒细胞等11项指标存在显著性差异(p < 0.001)。  以性别、年龄以及白细胞等17项指标 * ， ** 作为自变量，是否为复杂性阑尾炎为因变量，随机抽取总体样本的70%作为训练集(train)在Python3.6中使用XGboost训练模型。超参数设置：设定学习速率为0.01，并计划建立500颗树，为了避免过拟合，设树的最大深度为5，子叶节点中包含权重为5，每次学习均随机选择训练集中60%的样本及所选样本80%的特征作为自变量，当模型的错误连续50次无提升时停止计算。设置L2正则项为0.01，随机抽取样本的两组比例为4，帮助算法尽快收敛，降低运算时间。输出预测类型，以其余30%的样本设为验证集(test)用以验证模型。绘制ROC曲线并计算曲线下面积(AUC)为0.93。将验证集带入模型，计算该模型准确率为81.2%。绘制ROC曲线，计算AUC面积为0.81。再次将训练集与测试集合并，带入所建立的模型中，绘制ROC曲线，计算AUC面积为0.89 (图1)。 Table 1 Uncomplicated Appendicitis n = 406 Complicated Appendicitis n = 160 p value Sex (F/M) 203/203 62/98 p = 0.016 < 0.05 * age 36.28 ± 16.28 40.31 ± 17.97 p = 0.014 < 0.05 * BMI 23.07 ± 3.62 23.81 ± 3.63 p = 0.028 < 0.05 * WBC 9.78 ± 5.40 14.03 ± 4.94 p < 0.001 ** Neut 7.35 ± 4.68 12.11 ± 4.38 p < 0.001 ** Mono 0.57 ± 0.32 0.79 ± 0.45 p < 0.001 ** Lymp 1.84 ± 3.00 1.14 ± 0.56 p = 0.004 < 0.05 * EOSR 0.08 ± 0.11 0.03 ± 0.09 p < 0.001 ** BASO 0.03 ± 0.02 0.02 ± 0.02 p = 0.102 > 0.05 Neuper 70.50 ± 18.77 84.98 ± 6.70 p < 0.001 ** Lymper 22.41 ± 14.54 8.91 ± 5.08 p < 0.001 ** Monper 6.12 ± 2.34 5.69 ± 2.57 p = 0.055 > 0.05 EOSper 1.15 ± 1.55 0.26 ± 0.72 p < 0.001 ** BASper 0.30 ± 0.21 0.15 ± 0.12 p < 0.001 ** plt 230.01 ± 58.18 216.29 ± 62.2 p = 0.014 < 0.05 * pdw 11.95 ± 2.55 12.03 ± 2.72 p = 0.748 > 0.05 mpv 10.39 ± 1.80 10.29 ± 1.93 p = 0.586 > 0.05 pct 0.34 ± 2.32 0.21 ± 0.06 p = 0.483 > 0.05 CRP 13.26 ± 23.26 80.93 ± 60.32 p < 0.001 ** ALT 23.90 ± 15.63 24.96 ± 16.97 p = 0.49 > 0.05 AST 19.44 ± 8.11 19.11 ± 9.07 p = 0.682 > 0.05 TBil 18.85 ± 19.18 26.68 ± 15.11 p < 0.001 ** INR 1.69 ± 8.59 1.12 ± 0.14 p = 0.479 > 0.05 Fib 3.22 ± 0.99 4.77 ± 1.39 p < 0.001 ** DDimer 523.11 ± 1130.67 1668.35 ± 4105.66 p = 0.002 < 0.05 * 表1. 研究数据描述性统计 * p < 0.05; ** p < 0.001。 图1. 根据模型预测值对训练集、验证集和整体样本绘制ROC曲线  为更好的解释模型，在Python3.6中使用SHAP [ 11 ] [ 12 ] 对模型进行分析，以数据集中第48行数据为例，患者诊断为复杂性阑尾炎，其中红色表示特征值越高，发生复杂性阑尾炎的概率越大；蓝色值意味着特征值越低，发生复杂性阑尾炎的概率越大。多项特征对最后的结果产生影响，表示为发生复杂性阑尾炎的概率，如图2所示。 图2. 根据第48行数据绘制SHAP图 图3展示了SHAP摘要图，将17个特征(自变量)对模型的重要性进行排序。最高的前五项依次为：C反应蛋白(C-reactive Protein)、纤维蛋白原(Fibrinogen)、淋巴细胞百分比(Lymphocyte Percentage)、中性粒细胞计数(Neutrophil Count)及中性粒细胞百分比(Neutrophilic Granulocyte Percent)。我们可以发现CRP是模型中最重要的特征，具体来说，C反应蛋白(CRP)值的大小对模型影响最大，这可能与组织创伤、感染时加速合成CRP有关 [ 13 ]。此特征值越高，SHAP值越大，意味着发生复杂性阑尾炎的风险越高。纤维蛋白原(Fib)及淋巴细胞计数(Lymp)分别是随后的两个重要特征，其中更高的纤维蛋白原意味着更容易发生复杂性阑尾炎，而随着淋巴细胞计数的升高，发生复杂性阑尾炎的可能性反之减小。"
"1995年，Eriksson和Granstron [ 14 ] 报道了关于阑尾炎保守治疗的随机对照实验，结果显示保守治疗效果满意。非手术治疗可以避免并发症的发生，然而一旦非手术治疗失败，患者可能面临因延误手术而造成的更大风险。Vons等 [ 15 ] 在对阑尾炎治疗的研究中将保守治疗的目标定位为非复杂性阑尾炎，取得了理想的治疗效果，世界急诊外科学会的指南中 [ 3 ] 也建议对于非复杂性阑尾炎采用保守治疗的方式能够取得理想的治疗效果。在对于急性阑尾炎的治疗过程中区分复杂性阑尾炎与非复杂性阑尾炎的重要意义不言而喻 [ 15 ]。 图3. XGBoost模型的特征重要性，红色越深表示变量值越高 外科医生一般依据患者影像学检查发现含有粪石、穿孔、脓肿的阑尾炎患者定义为复杂性阑尾炎 [ 15 ] [ 16 ]。而这与病理定义及术中观察并不等同，部分诊断为非复杂性阑尾炎的患者在术后的病理检查中发现阑尾组织呈全层坏死，主要原因与CT对于复杂性阑尾炎判断的敏感度太低有关 [ 17 ] [ 18 ]。 以阑尾脓液、坏疽及穿孔为主的复杂性阑尾炎往往带来较非复杂性阑尾炎更严重的感染。通过单因素分析，我们发现复杂性阑尾炎较非复杂性阑尾炎在白细胞、中性粒细胞、C反应蛋白及纤维蛋白原等炎症因子有显著的差异(p < 0.05)，这与其他学者的研究相同 [ 17 ] [ 19 ]。进一步的建模可以发现，C反应蛋白、纤维蛋白原、淋巴细胞、中性粒细胞、D二聚体的特征值都对最后的预测结果产生较大影响。淋巴细胞在复杂性阑尾炎中显著降低，提示在严重腹腔感染时出现免疫抑制，C反应蛋白及纤维蛋白原受腹腔感染影响而升高，在判断感染严重程度上明显优于白细胞及粒细胞，这与近年发表的一份meta分析相似 [ 20 ]。 然而腹腔感染能够引起机体发生复杂的变化，单纯提炼少量的特异指标将导致局部最优，并不能对结果进行泛化，实际应用将会十分困难。由于选取的特征较多，特征之间存在复杂的线性与非线性关系，且部分自变量由于多种原因存在一定缺失，单纯的排除掉这些数据我们认为是一种极大的浪费，所以需要建立一个灵活的高级模型对自变量与因变量的关系进行模拟。在本研究中，我们使用XGboost建立了一个高级模型来区分复杂性与非复杂性阑尾炎，它将多个CART树模型集成在一起，形成一个强分类器，并加入正则化以降低模型复杂度，避免了模型过拟合。同时，多项参数可以根据实际应用情况灵活的调整。并能够充分利用机器学习的特性使各项炎症指标得到高效的使用。通过完全独立的验证集带入模型进行验证，得到了81.2%的准确率。 而大多数的机器学习模型(如XGBoost、神经网络、随机树等)表现为黑箱模型，为了更好的解释变量之间的相互关系我们采用了Scott等根据博弈论中Shapely value的原理开发的SHAP包 (https://github.com/slundberg/shap)。通过量化每个特征对机器学习模型做出的预测的贡献，使我们能够解释在某一个样本的预测中各个特征对预测结果产生的影响以及影响的正负性。 对诊断为阑尾炎的患者，可借助该模型对其阑尾炎严重程度进行评估，并采取相应的诊治方案。同时，由于建模的数据来自于患者手术前24小时血液检验结果，并无临床症状时间等因素干扰，该模型可作为患者接受非手术治疗期间阑尾病理变化的观测通道。本模型所需要的数据全部来源于实验室检验结果，减少了人为因素测量所带来的偏倚。同时，在大多数地区，中性粒细胞、白细胞等血液细胞检验往往以血常规的形式作为基础性检查，检测技术成熟，价格相对较低，检验时间短，应用方便。 本研究仍存在不足之处，首先，为了保证模型的客观性，我们在研究中并没有纳入发病时间及临床体征等主观指标，只接受了机器检验所产生的连续变量。其次，虽然CT等影像学检查对于判断复杂性阑尾炎敏感度较低，但明确发现阑尾穿孔征象仍然是区分阑尾炎严重程度的重要指标。并不能说明临床体征及影像学检查对于复杂性阑尾炎的判断无意义，对于经验丰富的外科医生而言，它们仍然是判断复杂性阑尾炎的重要手段。最后，本研究只局限于对已诊断为阑尾炎的患者进行严重程度预测，对于其他普通患者，做不到很好的鉴别。 综上所述，通过血常规、C反应蛋白及纤维蛋白原等作为指标建立预测模型，能够较好于手术前区分复杂性阑尾炎与分复杂性阑尾炎，对于根据阑尾炎严重程度采取不同的治疗方案有重要的意义。同时，该模型有助于提高临床医生对抗生素治疗效果及手术时机的预判。而任何预测手段都存在假阴性，这需要临床医生充分尊重患者的知情权与选择权，谨慎选择患者治疗方案。"
"该研究具有对受试者隐私权的保护，并通过医院伦理委员会审批，不存在各方面的利益冲突。"
