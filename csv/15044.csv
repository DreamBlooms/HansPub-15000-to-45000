"针对当前图像检索中存在的有效特征提取问题，提出了一种基于人工免疫识别系统(AIRS)的特征权值调整方法。利用人工免疫识别系统的泛化学习及记忆的特点，对训练样本的特征值进行学习，从而确定各特征之间的权值分配。实验结果表明，与传统权值调整法相比，本方法能够为各特征提供较好的权值，提高图像检索的准确率。 关键词 :遥感图像检索，有效特征，AIRS，特征权重"
"基于内容的图像检索技术作为当前遥感图像处理和计算机视觉研究的一个热点[ 1 ] -[ 3 ] ，还面临着许多问题。其中一个突出问题就是如何提取图像的有效特征，自适应确定多维特征之间的权值分配。图像特征维数升高并不一定能够提高检索的准确性，相反有些特征的存在甚至影响检索的准确性。很多学者在这方面提出了一些解决方法。Rui和Huang [ 4 ] 最早将相关反馈技术引入到图像检索中，提出了利用特征标准差的方法来调整权值，使相似性计算尽量与用户的感觉一致，该方法虽然简单，并且具有一定的数学理论支持，但是需要用户反复交互，给系统的实用性方面带来了挑战 [ 5 ] ；汪祖媛等 [ 6 ] 提出了一种基于进化规划策略的纹理图像检索方法，利用进化规划具有群体搜索和随机信息交换的优点，对图像特征矢量进行优化选取，但是由于进化算法本身存在容易陷入局部极小点，收敛速度慢的缺点，使该方法不容易找到最优特征；崔文成等 [ 7 ] 提出了一种基于遗传算法的多特征权重自动赋值方法，首先将图像检索中特征权重调整问题转换为优化问题，进一步利用遗传算法求取权重的最优解，该算法同样存在算法不能保证概率收敛的问题 [ 8 ] ；王晓翠等 [ 9 ] 提出了一种基于改进的遗传算法用于解决商标图像检索中的多特征权值分配问题，针对标准的遗传算法收敛速度慢，容易产生“早熟”现象，将遗传算法中的轮盘赌选择与最优解保存法结合，并将染色体基因重新排列后进行交叉，提高了检索系统的效率和精度，但是该系统用遗传算法分配权之后并不具有自适应能力。 人工免疫系统(Artificial Immune System，简称AIS)，是模仿自然免疫系统功能的一种智能方法，它是一种受生物免疫系统启发，通过学习外界物质的自然防御机理的学习技术，提供噪声忍耐、无教师学习、自组织、记忆等进化学习机理，结合分类器、神经网络和机器推理等系统的一些优点，因此提供了新颖的解决问题的方法和途径。其研究成果已应用于设计控制、数据处理、优化学习和故障诊断等许多领域 [ 8 ] 。文献 [ 10 ] 提出了一种基于免疫算法的图像检索模型并实现了一个原型化检索模型，该方法需要利用模糊聚类方法对图像库进行聚类，因此检索的准确性很大程度上取决于聚类的精度，而且需要用户反馈的次数相对比较多，算法精度收敛比较慢。 针对以上问题，本文借鉴了人工免疫识别系统(Artificial Immune Recognition System，AIRS)的基本思想 [ 11 ] - [ 13 ] ，将其引入到遥感图像检索的特征权值调整中，利用其自组织、记忆、泛化学习的特点，对特征权值进行调整，去除权值过小的特征，保留图像的有效特征，实现保留特征之间的权值最优分配。实验结果表明，本文方法是有效的。"
"生物免疫系统的主要任务是清除侵入体内的病原物质，并对病原体的再次入侵做好防御准备。免疫系统包括B细胞和T细胞两种淋巴细胞，每个淋巴细胞表面都存在受体分子，这些受体可以与抗原提呈细胞提呈的抗原分子按照一定的亲和力产生结合。受抗原刺激，具有抗原识别能力的淋巴细胞，通过克隆增殖、变异和进化，最后达到亲和力成熟，产生记忆细胞。AIRS的训练便是借鉴免疫系统对于一个入侵抗原的响应过程。2001年Watkin在Timmis提出的资源受限人工免疫系统的基础上，提出了人工免疫识别系统 [ 11 ] ，后又经几次改进 [ 12 ] [ 13 ] 。AIRS的中心思想是：进入免疫系统的抗原，由与之最具亲和力的记忆抗体提呈。该记忆抗体经过克隆、变异产生出大量的新抗体，即人工免疫识别球(Artificial Recognition Ball，ARB)，ARB中抗体之间再经过资源竞争，进化得到与抗原更具亲和力的抗体，更新记忆抗体集。最后得到一组能够很好识别抗原的记忆细胞。  AIRS算法包括四个基本步骤： 1) 初始化 这个步骤可以看作一个数据预处理过程，主要包括特征向量的规则化以及记忆细胞集 MC及ARB的生成。 下面是一个循环过程，对每个抗原Ag i 执行以下步骤： 2) 生成新的ARB 找出与抗原Ag i 刺激度最大的记忆细胞mc match ，由它进行克隆增值生成新的ARB。 3) 资源竞争产生新记忆细胞 ARB中抗体之间根据与抗原Ag i 亲和力的大小进行资源竞争，获胜的抗体称之为候选记忆细胞mc cand ，即有机会进入记忆细胞。 4) 候选记忆细胞进入记忆细胞集 如果候选记忆细胞mc cand 与抗原Ag i 的亲和力大于现有的记忆细胞，则将候选记忆细胞加入记忆细胞集MC，同时如果候选记忆细胞mc cand 与mc catch 之间的亲和力大于用户设定的某个阈值，则mc cand 代替mc catch 进入记忆细胞集。 对所有抗原学习完毕后，循环结束。"
"本文方法将同类样本特征向量之间的差值绝对值作为训练抗原，将特征权值作为抗体，特征权重调整的过程就是不断优化抗体，识别抗原，最后直到产生可以捕获抗原的最佳抗体过程。具体步骤如下： 1) 初始化 设训练样本中存在M幅样本图像，分为C类，记为 ，首先提取图像的特征向量 ，分别计算同类特征向量总体的均值 ，然后计算特征向量与该类型特征均值差的绝对值，记为 作为训练抗原。将记忆抗体 初始化为一组与抗原长度相同，符合高斯分布的随机向量，K为常量，抗体均值为1，方差为 ，方差为一个小值。 2) 记忆抗体训练 由抗原对记忆抗体进行训练，寻找记忆抗体中亲和力最好的N个抗体，对其进行较高变异率的克隆变异，克隆数由其亲和力mc.aff的大小及资源总数Totalres决定，与最佳个体共同生成免疫识别球ARB，重新计算抗原与ARB的亲和力，保留与之亲和力最高的N个ARB抗体，对其进行较低变异率的克隆变异，克隆数同样由其亲和力的大小及资源总数决定，计算重新生成ARB与抗原的亲和力，将亲和力最高的H个抗体代替记忆抗体中的低亲和力的H个抗体。如此循环直到对所有的抗原训练完毕。对记忆抗体集求平均值，将值小于阈值 的值置零，作为最优记忆抗体。训练过程中主要包括以下几个运算： 3) 克隆运算 克隆运算即是简单的复制，克隆数由记忆抗体亲和力mc.aff及资源总数Totalres确定，算法如下： (1) 4) 变异运算 变异运算是一个改变抗体值的过程，文中将抗体对应相乘一个符合高斯分布的随机向量，向量均值为1，方差为 ，本文中有两次变异，初次为记忆细胞的变异， 设置的值较大，避免算法陷入局部最优，二次变异为ARB变异， 设置的值较小，避免算法不收敛。 5) 亲和力运算 文中抗体与抗原之间的亲和力由它们之间的内积确定。 (2) 6) 图像检索 利用生成的最优抗体，在计算目标图像与图像库中图像之间相似度时，进行加权计算，距离采用加权欧式距离。   本文提取了图像的小波纹理特征，利用小波变换对图像进行三级小波分解，在子带B (LL，LH，HL，HH)中的第mn (m为行号，n为列号)个小波系数，在分解级数为k时记为 ，系数的能量记为 [ 14 ] ： 。提取各子带能量的一阶矩、二阶矩为特征。数学上前二阶矩定义如下： (3) (4) 提取特征后，每幅彩色图像生成60维特征向量，记为： ，M为图像数。  图像的颜色有多种表示方式，其中HSV模型对应于画家配色模型，能较好反应人对颜色的感知和鉴别能力是一种适合人们肉眼分辨的模型。此外，它还具有线性伸缩性，可感知的颜色与颜色分量的相应值得欧氏距离成比例，因此非常适合于颜色的图像相似性比较 [ 15 ] 。 在本文中，我们将HSI色彩空间非均匀量化成72维，即把色调Hue分成八份(人眼对Hue最敏感)，饱和度S和亮度I各分成三份。具体量化值如下式： 量化后，根据(5)式将图像转换为灰度图像，图像灰度G取值范围为[0，1，···，71]，计算该灰度图像的累加直方图，作为图像的颜色特征。 (5)"
"本文使用的实验图像库由2005年5月8日，用无人机搭载Canon 1DsMark-II相机，在驻马店拍摄的影像，从中抽取1000幅512 ´ 512的子图组成，图像内容包括街区，道路和植被三类区域。本文进行了两组实验，第一组只利用小波纹理进行检索，第二组组合小波纹理和颜色纹理进行检索，并对利用本文方法进行权值优化前后结果与文献 [ 4 ] 提出的利用特征标准差调整权值方法的实验结果进行了对比。  利用db4小波对训练图像进行三层小波变换，提取系数60维特征向量，初始化记忆细胞集以及抗原，记忆细胞集为60维均值为1，方差为0.01的向量组，个数为30。抗原为各特征向量与同类特征向量均值差的绝对值。 本算法在计算机处理器为双核主频2.10 GHz、内存2 G、Windows Vista、matlab 7.0环境中实现。实验中参数设置如下：资源总数为1000，记忆变异时， 设为0.1，ARB变异时， 设为0.01，权值阈值 设为0.4，小于 的权设为0。 分别从每类图像中选取10幅有代表性的图像进行检索，显示前25个结果输出。每次检索的准确率由下式计算： (6) 最后求出不加权和本文方法的平均准确率，并与利用特征标准差调整权值的结果进行对比，作为评价本文方法的最终指标。 表1给出了三种方法检索的平均准确率及总平均准确率。图1为部分检索结果。图1中显示图像次序按照与待检索图像间亲和力的大小，由大到小依次排列。从显示检索结果对比可以看出，针对不同类型的土地利用类型，本文算法检索精度相比对图像特征均赋相同权值及Rui法检索结果均有一定程度的提高。  将小波纹理特征和颜色累加直方图特征组合成图像的混合特征进行检索，对特征权值优化前后检索结果进行对比。参数设置与4.1中参数设置相同。表2给出了两种方法检索的平均准确率及总平均准确率。图2为部分检索结果。图2中图像排列顺序与图1相同，检索结果对比与图1中的结果对比一致。 Table 1 植被 街区 街区植被 植被道路 总平均准确率 不加权结果 81.2% 74.2% 68.0% 66.5% 72.5% Rui法结果 83.2% 76.4% 71.6% 72.4% 75.9% AIRSIR 89.6% 88.1% 79.6% 73.0% 82.7% 表1. 小波特征图像检索准确率对比 Table 2 植被 街区 街区植被 植被道路 总平均准确率 不加权结果 79.1% 80.9% 78.2% 84.4% 80.7% Rui法结果 84.5% 82.0% 81.6% 85.6% 83.5% AIRSIR 93.33% 86.2% 86.7% 93.3% 89.9% 表2. 小波和颜色组合特征图像检索准确率对比 图1. 小波特征图像检索部分实验结果 图2. 小波和颜色组合特征图像检索部分实验结果  实验对植被、居民地、道路植被混合用地、街区植被混合用地四类遥感图像进行了检索。 由图1和图2以及统计表对比可以得出以下结论： 1) 利用特征标准差调整权值的方法和本文方法对特征权值进行优化调整之后，图像检索的程度整体都有所提高，但是本文方法的检索准确率要优于Rui法； 2) 单一小波纹理的检索精度要低于小波纹理与颜色累加直方图组合特征的检索精度，经过特征权值优化之后，整体检索结果不变，只是植被组合特征的检索结果要稍微低于单一特征的检索结果，这与一些偶然因素有关，如人工判断因素的影响； 3) 由表1及图1可以看出，单一小波纹理的检索，对于单一土地类型的检索精度要高于混合土地类型的检索精度。经多特征权值优化之后，结果不变，原因与小波特征对图像内容表达能力有关； 4) 由表2及图2可以看出，混合特征的检索对土地类型是单一还是混合不敏感，所以在提取特征的时候，最好提取图像的多个特征进行组合。"
"本文将AIRS应用于遥感图像检索的多特征权值分配优化问题中，利用免疫算法的泛化学习、记忆及收敛快速的特点，对特征权值进行优化，很好的解决了特征权值自适应调整问题，提高了图像检索精度。由于人工免疫原理本身还处于研究和发展阶段，随着研究的不断深入，人工免疫算法的性能会不断提高，应用领域也会不断拓展，在图像检索方面必将发挥更大的作用。"
