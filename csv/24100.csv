"探地雷达对地下复杂场景中的目标进行探测时，由于地下介质的非均匀，导致回波信号在传播路径和传播衰减上的扰动，造成探地雷达记录剖面中双曲线特征的畸变、错位、缺失等现象，传统的基于双曲线顶点检测的目标定位方法不再有效。本文提出了一种基于自动阈值边缘检测和模板匹配的散射曲线顶点检测方法来抑制双曲线特征形变和噪声的影响，提高顶点检测的精度。该方法通过探地雷达记录剖面沿测线维的一维能量曲线确定目标个数的预设区间；然后基于自动匹配阈值的方式对探地雷达记录剖面进行边缘检测，得出估计的顶点坐标；再基于估计的顶点坐标建立模板并进行模板匹配，得出匹配后的目标顶点；最后对目标顶点采用聚类分析的方法进行过滤，去除虚假顶点，得出探地雷达记录剖面中的目标顶点的检测结果。通过对仿真和实测数据的处理，结果表明本方法能有效的抑制双曲特征形变和噪声的影响，具有更高的检测精度。 关键词 :探地雷达，能量曲线，自动阈值边缘检测，模板匹配，聚类分析 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"本模探地雷达是一种有效的浅层隐藏目标探测技术，利用电磁波在媒质电磁特性不连续处产生的反射和散射实现非金属覆盖区域中目标的成像探测。探地雷达回波的幅度和时延包含目标位置及电磁散射特性等信息。探地雷达沿一维测线进行空间扫描，在测线的每个孔径点处向地下区域发射电磁波并接收散射回波。每个孔径点处接收一道回波数据，多个孔径点接收的回波数据按列排列，就形成了探地雷达记录剖面。通过对探地雷达记录剖面进行处理以实现对地下未知区域的探测和参数反演，是工程界常用的一种无损检测方式。探地雷达可以在岩石、土壤、冰、淡水、公共道路等介质中穿透探测，还可以探测到地表下的物质、材质变化、空隙和裂隙等，广泛应用于道路工程、建筑工程、考古等无损探测领域。 探地雷达在扫描的过程中，当电磁波遇到与背景媒质电磁特性不同的目标时会产生电磁散射，部分散射波被探地雷达接收天线接收。随着天线的移动，地下目标的散射回波在探地雷达记录剖面中就形成了一条散射曲线。散射曲线的顶点与目标的真实空间位置相对应。从图形图像学角度分析，只需确定探地雷达记录剖面中散射曲线的顶点位置，便可以获得地下目标的空间分布。因此，探地雷达记录剖面中散射曲线顶点位置的检测算法就成了探地雷达对地探测中目标定位的关键问题。国内外对探地雷达记录剖面中的顶点检测问题进行了大量的研究。Liu等人通过对探地雷达图像中的曲线进行曲线拟合和边缘检测，对图像中的目标进行提取 [ 1 ] [ 2 ] [ 3 ] 。Wang通过对探地雷达图像中的曲线使用偏微分方程式的数学方法和模板匹配的方式，确定图像中的双曲线顶点位置，以此来对钢筋混凝土桥面腐蚀情况进行检测 [ 4 ] [ 5 ] 。Laurence Mertens基于探地雷达图像进行边缘检测结果中的边缘点生成双曲线拟合函数的目标检测方法 [ 6 ] [ 7 ] [ 8 ] 。Parneet Kaur等人基于图像的梯度特性和曲线拟合方式的双曲签名，通过集成机器学习分类的方法，来检测桥面钢筋腐蚀情况 [ 9 ] [ 10 ] [ 11 ] 。 上述方法适用于高信噪比情况下的GPR记录剖面中顶点的提取。在信噪比较低的情况下，GPR剖面记录图像中目标双曲线边缘轮廓发生变化，其平滑性、对称性等曲线特征被破坏，传统算法会造成目标顶点的漏检或误检的情况，直接影响地下目标的检测效果和定位精度 [ 12 ] 。此外，传统方法中的边缘检测需要手动调整阈值，无法自动运行。本文提出了一种基于自动阈值边缘检测和模板匹配的GPR记录剖面中的顶点提取算法。其中基于Canny算子的自动阈值边缘检测算法，提高了边缘检测的效率。在模板匹配过程中，设计了匹配相似度因子，将多个约束参数的联合优化问题转化为一个因子的优化问题，耗时更少。采用聚类分析的方法对顶点提取结果进行筛选和过滤，降低虚假顶点的干扰。得到最终的顶点检测结果。"
"Canny滤波器可用于对GPR图像的处理，它包括对图像进行高斯滤波、用一阶偏导的有限差分来计算梯度的幅值和方向、对梯度幅值进行非极大值抑制、用双阈值算法检测和连接边缘。Canny算法中所采用的Canny卷积算子，其表达式如下： S x = [ − 1 1 − 1 1 ] ,         S y = [ 1 1 − 1 − 1 ] (1) 传统的Canny检测算法，是通过手动方式调节边缘检测的阈值，需要通过多次的阈值调整，才可以最大限度的提取原图中的边缘二值图像。 本文提出自动调整阈值的Canny边缘检测方法，通过Canny边缘检测和顶点数目取值范围来自动寻找最佳的阈值。图1给出了自动阈值匹配边缘检测的处理流程。首先，对原始的GPR图像进行预处理， 设定初始阈值和结束阈值的大小，选取特定的步长进行阈值遍历，再对预处理后的探地雷达记录剖面进行边缘检测，得到一幅二值图像，然后根据二值图像估计可能存在的目标顶点数量，再根据可能存在的目标顶点数量和顶点数目取值范围来确定最佳阈值。  对原始GPR记录剖面数据去噪、去直达波，消除地表直达信号的干扰，公式如下： I ′ m × n [ p , q ] = I m × n [ p , q ] − I m × 1 [ p ] ⋅ O N E 1 × n [ q ] (2) 根据每道数据的能量，绘制成一维能量曲线 P ( x ) 。如下公式所示： P ( x ) = ∑ i = 1 m ( I ′ m × n ( i , x ) ) 2 ,     x = 1 , 2 , 3 , ⋯ , n (3) 如果该曲线中如果存在点 ( x , P ( x ) ) ，当 x ′ < x 时， P ( x ′ ) < P ( x ) ，且当 x ′ > x 时， P ( x ′ ) < P ( x ) ，则该点为该曲线的局部极大值。将所有局部极大值点的个数记为 S ，设定该探地雷达记录剖面的潜在顶点数目取值范围为 [ S min , S max ] 。  经过边缘检测之后的得到二值图像；计算二值图像中的曲线边缘的梯度，公式如下： 图1. 自动阈值匹配边缘检测流程 { G ( x , t ) = d x ( i , j ) + d t ( i , j ) d x ( x , t ) = I α ( i + 1 , j ) − I α ( i , j ) d y ( x , t ) = I α ( i , j + 1 ) − I α ( i , j ) (4) 公式(4)给出了边缘曲线求梯度的公式。以边缘点 I α ( i , j ) 建立大小为 n × m 大小的子图像。计算出子图像中边缘曲线的梯度并确定梯度的极值点，根据极值点的个数来确定可能存在的目标顶点的个数 K 。  已知边缘检测阈值范围 [ 0 , 1 ] ，设定初始阈值 α = 0.01 ，使用该阈值进行边缘检测并得到一幅二值图像 B α ( x , t ) 。通过 B α ( x , t ) 估计可能存在的目标顶点个数 K ，当 K 不在顶点数目取值范围 [ S min , S max ] 时，调整阈值以步长为d依次递加，直到 K 在区间 [ S min , S max ] 时，得出预估的顶点集 [ k , x k , t k ] , k = 1 , ⋯ , K 。取 d = 0.02 时具有较低时耗却又不是检测精度。"
"图2给出了模板匹配的流程图。根据估计出的顶点坐标建立匹配模板，使用匹配模板与边缘检测得 图2. 模板匹配的过程 到的二值图像进行模板匹配，舍弃匹配度低的顶点，得出匹配之后的目标顶点。 根据估计的目顶点建立匹配模板。设定一个 n × m 大小的模板。模板的大小随着信噪比的大小而改变。当信噪比较大时，只需要较少的边缘点匹配就可以得到一个比较精确的结果，此时对应的模板就比较小的；反之则越大。 图3给出了模板窗口和标准的匹配双曲线示意图。模板的窗口大小是随着目标的掩埋深度的不同而变化的。双曲线的开口宽度与介质的相对介电常数和埋深有关，掩埋深度越深，双曲线的开口宽度越大，对应的匹配模板宽度随之增大，高度随之变小 [ 13 ] [ 14 ] 。 模板匹配约束参数 现有的模板匹配算法是对模板多个参数的联合匹配估计，需要对多个参数进行判断和匹配估计 [ 6 ] 。本文设计了匹配相似度因子，对多个约束参数进行加权拟合，确定了一个匹配相似度因子。通过对该因子的判断，确定模板匹配结果，避免了原有算法中对每个参数进行循环判断。 图4给出了设置匹配参数的模型。记 ρ 1 、 ρ 2 、 ρ 3 、 ρ 4 、 ρ 5 和 ρ 6 分别表示缓冲区的相对边缘密度( d r e l i )、双曲线对称性规范化系数( s y m )、相对理论双曲线在t方向上与x方向上的数据范围 ( d r t i , d r x i ) 、相对于理论双曲线在t方向上的数据分布( d i s i )和缓冲区周围的边缘点的相对数量( s u r )。各参数的匹配相似度， 图3. 建立匹配模板 图4. 缓冲区模型 计算公式如下。 ρ 1 = { 1 , 0 . 5 < d e r l i < 2 . 7 0 , 其 他 ;     ρ 2 = { 1 , s y m > 0.6 0 , 其 他 ;     ρ 3 = { 1 , d r t i > 0.7 0 , 其 他 ρ 4 = { 1 , d r x i > 0.7 0 , 其 他 ;     ρ 5 = { 1 , d i s i ≥ 0.7 0 , 其 他 ;     ρ 6 = { 1 , s u r ≥ 0.7 0 , 其 他 (5) 通过对输入的图像进行边缘检测，得到边缘轮廓的二值图像 B α ( x , t ) 。设计下述公式(6)： ρ k = ( ( ρ 1 + ρ 3 + ρ 4 + ρ 5 ) ⋅ 2 + ρ 2 + ρ 6 ) ⋅ 0.1 (6) 计算模板匹配相似度 ρ k 。当 ρ i = 1 , i = 1 , ⋯ , 6 时，即 ρ 0 = 1 。如果 ρ k > ρ 0 ，则 E k ( x k , t k ) 为目标顶点，否则设置 k = k + 1 ，重复该步骤对下一个顶点进行的判断，得到所有的匹配顶点记为 V β = [ x k , t k ] , β = 1 , ⋯ , B 。本方法避免了原有算法中对每个参数进行循环判断，降低了单个参数对判断结果的影响。耗时较少，提高检测精度。"
"通过模板匹配得出的顶点集中，包含有一些虚假的顶点，其中最主要的是同一个目标可能会检测出多个目标顶点。为了提高顶点检测的准确性，本方法中采用聚类分析的方法，对匹配后的目标顶点进行空间聚类，以合并GPR散射曲线顶点附近的多个目标点，去除虚假顶点 [ 15 ] [ 16 ] 。聚类处理过程中，将 图5. 聚类分析流程图 不同的目标进行分类，提取该簇中能量值最大的顶点，确定最小时间点为所找的顶点。 图5给出了聚类分析的流程图。对匹配之后的目标顶点进行过滤：对 V β 序列进行聚类分析得到簇数 N 1 及各簇包含的顶点个数 Q n , n = 1 , ⋯ , N 1 ，设定初始值 n = 1 ; γ = 1 遍历每个簇，如果 Q n = 1 成立，则 V γ = V n ，其中 V γ 为过滤后的目标顶点；如果 Q n = 1 不成立，则针对每个簇提取能量序列 ∑ | E ( x m , t ) | 2 , m = 1 , ⋯ , Q n 的最大值对应的序号 ，此时如果 P = 1 成立的话，则选定 ( x μ , t μ ) ,   μ = m 1 为顶点估计值；否则，提取对应的序号最小时间点作为顶点估计值，即 V γ = ( x μ , t μ ) , μ = m min ；如果 n = N 1 不成立，则设定 n = n + 1 ,   γ = γ + 1 ，对下一个顶点进行上述处理过程，遍历 N 1 个簇，得到GPR记录剖面中的顶点估计序列 V γ ，也就是顶点检测结果。"
"运用本文所提出的算法分别对仿真和实测数据进行处理。下面给出原始GPR数据和处理结果。  GPR正演模拟采用GPRMax2.0仿真软件生成原始图像，进行加噪处理模拟产生含噪的实测GPR图像 [ 17 ] 。图6给出了正演模拟模型和模拟数据的B-Scan结果。正演模型中共设置三层，从上往下依次为0.05 m厚的空气层。第二层是厚度为0.2 m，介电常数为6，电导率为0.01 S/m的混凝土层。最后一层是厚度为0. 25 m， 介电常数为12，电导率为0.1 S/m的湿地层。在介质层中设置了6个目标，它们分别位于(0.4 m，0.12 m)、(0.8 m，0.22 m)、(1.2 m，0.12 m)、(1.6 m，0.32 m)、(2.0 m，0.22 m)、(0.23 m，0.12 m)处。发射源为900 MHz 的雷克子波，时间窗口8 ns，采样点数为1357，发射天线和接受天线沿着混凝土层与空气层交界处向正向移动，相邻两孔径点的采样间隔为0.25 mm，共采集了920道。 该模拟数据B-Scan是不含噪声的理想数据，通过加入随机噪声来模拟真实的GPR探测场景，在原始的剖面图像中添加10 dB随机噪声。对GPR原始图像进行预处理，利用公式(2)将图像中的直达波去除，然后利用公式(3)绘制出原始图像的一维能量曲线。图7给出了预处理后的剖面图像和一维能量曲线。 根据能量曲线 P ( x ) 的局部极大值，得到潜在的顶点个数 S = 8 ，目标个数范围 [ 4 , 40 ] 。设置初始阈 图6. GPRMax2.0正演模拟 值 α = 0.02 ，经过边缘检测得到的二值图像，根据边缘曲线的梯度估计顶点个数 K 。如果 K 不属于 S 区间，那么 α + 0.02 ，依次递加上去，每个阈值 α 给出一个顶点估计图像。随着 α 的增大，如果 K 属于 S 区间，给出顶点集 [ k , x , t ] ，图8标出自动阈值边缘检测之后的顶点集。进行后续的阈值匹配过程。 如图9所示。通过计算模板匹配相似度，过滤掉匹配相似度低的顶点，得到模板匹配的顶点序列。 图10在图像中标出模板匹配的顶点检测结果，图中红圈标注的地方只存在一个目标点，通过模板匹配检测出了冗余的顶点，接下来对目标顶点进行聚类分析，去除冗余的顶点。 图11给出了在剖面图像中添加10 dB随机噪声后顶点检测结果。 图中标出8个顶点检测结果，其中水平方向0.4 m、0.8 m、1.2 m、1.6 m、1.9 m、2.3 m处为真实的目标位置，而水平方向1.0 m、1.7 m处检测出的顶点是误检的顶点，它可能是随机噪声、目标点之间的 图7. 预处理图像和能量曲线 图8. 自动阈值边缘检测的顶点集 干扰造成的。针对不同的噪声情况做了相应的仿真验证。 图12给出了在不同噪声干扰的情况下顶点检测结果。从图中可以看出随着噪声的减小，检测出的顶个数成增加趋势；受到噪声的干扰，误检和漏检的情况在噪声较低的情况不叫明显；信噪比在10 dB以下时，通过本方法检测结果中误检和漏检的情况比较显著，信噪比在10 dB以上时，检测结果比较好，有较高的精确率；通过该图可以看出本顶点检测方法具有较好的抗噪能力，在信噪比较低的情况下也可以保证较高的检测精度。  采用中心频率为1 GHz的GPR对湖南省的邵怀高速进行沿线扫描探测，截取了其中一段数据，横向扫描长度为10 m，采样点数为512，纵向时窗为40 ns，采样点数为512。原始GPR B-Scan如图13所示。 图9. 根据顶点集建立的匹配模板 图10. 模板匹配后结果 图11. 顶点检测结果 图12. 针对不同噪声情况的顶点检测结果 图13是使用GPR扫描邵怀公路超车道所得出的实测数据记录剖面图像。横向扫描距离为10 m。 图14给出了实测数据检测结果。在图中白色点为检测出的顶点位置，总共检测出6个顶点，其中0.4 m、0.8 m、4.4 m、5.0 m、9.9 m处是位于浅层介质中，而2.0 m处位于较深层介质中。它们都位于图中双曲线的顶点位置，本次检测出的顶点位置比较精确。本法针对实测数据的检测也是具有很强的适应性和精确性。 图15给出了使用传统方法处理后的检测结果。从检测结果可以看出在0.48 m、0.6 m、1.4 m、4.6 m、4.8 m处出现了误检结果，主要是由地下介质的复杂性以及目标之间回波信号的干扰导致双曲线畸变造成的。本方法通过对畸变的双曲线与标准的模拟双曲线进行匹配，进行相似度识别，有效的抑制由双曲线 图13. GPR实测数据 图14. GPR实测数据顶点检测结果 畸变造成影响。"
"GPR记录剖面中的顶点提取是GPR探测领域的关键问题。本文提出了一种基于自动阈值边缘检测和模板匹配的GPR记录剖面中的顶点提取算法。其中基于Canny算子的自动阈值边缘检测算法，提高了边缘检测的效率。在模板匹配过程中，设计了匹配相似度因子，将多个约束参数的联合优化问题转化为一个因子的优化问题，降低了单个约束参数对匹配结果的影响，同时耗时更少。采用聚类分析的方法对顶点提取结果进行筛选和过滤，降低虚假顶点的干扰。 仿真和实测数据的处理结果，显示该算法可以有效提高GPR记录剖面的顶点提取精度。后续研究工 图15. 传统方法的检测结果 作将集中在复杂探测场景下的非规则散射曲线拟合和顶点估计上，进一步提高顶点估计算法的适应性。"
