"虚拟发电厂能够有效地整合配电网中的分布式可再生发电资源，是分布式电源大规模接入配电网并实现主动式能量管理的技术方案。为了充分利用分布式电源资源和维持主动配电网的无功平衡，本文基于虚拟发电厂的概念，提出了一种有效的分布式无功优化方法，能够将分散于主动配电网中的可控分布式电源通过先进的通讯手段进行有效整合，然后基于分布式优化的控制策略，最终在实现上级无功调度指令的同时，实现整个虚拟发电厂内部的无功优化。最后，本文给出具体的实例仿真结果，充分验证了文中所提的分布式优化策略的可行性。 关键词 :虚拟发电厂，分布式次梯度算法，下垂控制，无功优化，主动配电网 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"CIGRE定义主动配电网(Active Distribution Network, ADN)即内部具有分布式能源且具有控制和运行能力的配电网。因此，主动配电网具有“有源性”和“主动性”两大特征，由于分布式电源大规模、高渗透率接入，使得电压分布和网络损耗成为了主动配电网在完全消纳可再生能源发电功率前提下的两个最重要运行指标。主动配电网的协调优化运行目标就是通过主动调控方法尽可能降低网络损耗且使电压分布合理 [ 1 ] 。大量分布式电源接入后，潮流大小和方向的改变将影响到配电网的稳态电压，使得原有的调压方案不一定能满足接入分布式电源后的配电网电压要求 [ 2 ] 。主动式配电网中如何管理分布式电源，使其响应主动式配电网的指令需求，是实现主动式配电网的关键技术。 在传统的配电网中，主要通过调节发电机的机端电压、调整变压器的抽头变比、改变无功补偿装置的出力等措施来调整无功潮流，使得电压达到系统要求 [ 3 ] 。目前对于含分布式电源的配电网无功优化和电压控制的研究内容主要集中在以下两个方面 [ 4 ] ：一是分布式发电系统自身的优化设计和控制；二是与其他无功补偿设备的相互配合和协调优化。文献 [ 5 ] 将分布式电源与地区电网相结合，共同参与地区电网动态无功优化调度。文中以降低地区电网网损、抑制电压波动为综合目标，建立了地区电网模糊动态无功优化调度模型。文献 [ 6 ] 中利用分布式电源的无功补偿能力，建立了以配电网经济运行和无功设备容量最小(投资最省)为子目标的含DG的配电网多目标无功优化模型。 虚拟发电厂将整合配电网中的分布式发电资源，使其具有规模化聚合效应，实现主动式配电网中对分布式电源的控制效果，从而使配电运行管理更趋于合理有序 [ 7 ] 。采用先进的网络通信、实时检测与计量等技术手段对电网运行状况进行监控与分析，虚拟发电厂能够促使新能源电力与传统能源实现较好的互补与配合，在保证电网安全稳定运行的同时，兼顾经济和社会效益 [ 8 ] 。文献 [ 9 ] 中通过能源管理系统对虚拟发电厂内的几个小型水电厂实施有功和无功控制，从而保证整个虚拟发电厂的电压得到有效的控制。基于虚拟发电厂的概念，文献 [ 10 ] 提出了针对逆变接入的分布式电源有功和无功的解耦控制方法，能够有效地控制中长距离传输线上的有功和无功的功率流。文献 [ 11 ] 综合考虑虚拟发电厂内部分布式电源各自的局部代价函数，以及无功和电压的等式、不等式约束，利用分布式次梯度投影算法实现分布式电源之间的协调优化。分布式电源之间通过不断与邻居的通讯，以次梯度的分布式迭代算法不断更新自身的状态值，最终能够实现整体系统的凸优化问题的求解 [ 12 ] 。 本文中提出的主动式配电网中虚拟发电厂的分布式无功优化算法，能够基于主动式配电网中无功需求总量的要求，实现虚拟发电厂内部的分布式电源节点电压性能达到最优。整个分布式无功优化过程通过各个分布式电源的局部通讯实现。"
"主动式配电网中虚拟发电厂整合了该配电网区域中的分布式发电资源，当配电网主变电站节点发生电压降落、需要无功补偿时，该配电网区域虚拟发电厂的能量管理系统将在其内部的分布式电源之间进行协调优化，使得整个无功补偿功率在各个分布式电源之间合理分配，即能够满足配电网主变电站节点的无功补偿功率需求，也能够使得各个分布式电源在补偿无功出力的过程中，自身的电压性能指标达到最优。  本文目标函数以虚拟发电厂各分布式电源节点电压与额定值的偏差平方和最小，约束条件考虑虚拟发电厂各分布式电源节点无功补偿总量满足主动配电网变电站节点无功补偿需求，以及虚拟发电厂各分布式电源节点无功出力满足其上下限约束。 其目标函数表达为： min ∑ i = 1 n ( U i − U N ) 2 U N 2 (1) (1)式中， n 为虚拟发电厂内部分布式电源的个数， 1 ≤ i ≤ n 。 U N 为分布式电源节点的额定电压。 U i 为第 i 个分布式电源节点电压。 基于逆变器接入的分布式电源无功电压Q-V下垂特性如图1所示。由图1可见，分布式电源的无功出力与电压成线性关系，无功功率输出将影响节点电压。因此，在满足虚拟发电厂无功输出补偿总量的情况下，也应同时考虑虚拟发电厂内各分布式电源节点电压尽可能与额定电压偏差最小。 图1. 分布式电源Q-V下垂特性 设 k i 为第 个分布式电源节点Q-V下垂曲线的下垂系数，则其电压与无功的关系可表达为： U i r − U i = − k i ( Q i r − Q i ) (2) 其中 Q i 表示第 i 个分布式电源节点的无功出力， U i r 和 Q i r 分别为第 i 个分布式电源节点的电压参考值和无功功率参考值。 将式(2)代入式(1)，则目标函数(1)可表达为： min ∑ i = 1 n ( U i − U N ) 2 U N 2 = min ∑ i = 1 n ( U i r + k i ( Q i r − Q i ) − U N ) 2 U N 2 (3)  主动式配电网的虚拟发电厂将满足该区域配电网主变电站节点无功补偿需求，因此将其作为等式约束条件。同时，虚拟发电厂内部的各分布式电源无功出力也需满足各节点无功出力上下限要求。 1) 虚拟发电厂无功补偿等式约束 Q d = ∑ i = 1 n     Q i (4) 2) 各分布式电源节点无功上线限约束 Q i M I N ≤ Q i ≤ Q i M A X (5) 其中，(4)式中 Q d 为虚拟发电厂无功输出功率的总额，即该主动配电网区域主变电站的无功补偿需求。(4)式中 Q i M I N 和 Q i M A X 为第 i 个分布式电源节点无功输出功率的下限和上限。(5)式中的 U i M I N 和 U i M A X 为第 i 个节点的分布式电源电压的最小值和最大值。"
"本文提出一种新的无功电压分布式优化算法，由各分布式电源节点交互迭代优化过程数据而完成全局优化，不需要将每个节点的电压和无功数据集中传输到虚拟发电厂控制中心。无功电压分布式优化算法适用于考虑各分布式电源本地节点电压和无功约束，不需要在虚拟发电厂控制中心完成无功优化计算。 若选取第 i 个分布式电源对整个虚拟发电厂内部各个分布式电源无功出力的估计值为决策变量 x i , 1 ≤ i ≤ n ，上述凸优化问题便可以通过分布式次梯度法求解。 将上述问题整理成优化问题的标准形式： min x ∑ i = 1 n   f i ( x ) s .t .     g ( x ) ≤ 0 , h ( x ) = 0 , x ∈ X (6) (6)式中， x = [ Q 1 , ⋯ , Q n ] T 为 n 个分布式电源的无功输出， X ⊆ R m 为决策变量 x 的约束集。 f i : X → R ， f i ( x ) 为第 i 个分布式电源的局部代价函数。其中 g ( x ) 为优化问题的全局不等式约束条件， h ( x ) 为优化问题的全局等式约束条件。在整个优化过程中不等式约束表现为(4)和(5)式，等式约束表现为(4)。 根据(6)式，其对应的Lagrange函数形式如下： L ( x , λ , μ ) = ∑ i = 1 n f i ( x ) + λ T g ( x ) + μ T h ( x ) (7) 根据 [ 13 ] [ 14 ] [ 15 ] ，决策变量 x i 的迭代更新方程为： x i ( k + 1 ) = P X i { V x i ( k ) − α ( k ) ∇ L x i ( k ) } (8) V x i ( k ) = ∑ j ∈ N i a j i ( k ) x j ( k ) (9) ∇ L x i ( k ) = ∂ L ( x , λ , μ ) ∂ x i ( k ) (10) (8)式中 x i ( k + 1 ) 为 k + 1 时刻第 i 个分布式电源对整个虚拟发电厂内部分布式电源无功处理状态的估计值； P X i 定义为到决策变量 x 的约束集 X 上的映射； α ( k ) 为 k 时刻的迭代步长； ∇ L x i ( k ) 表示 k 时刻 L ( x , λ , μ ) 对 x i ( k ) 的梯度。(9)式中 V x i ( k ) 表示第 i 个分布式电源与邻居通讯来更新自身 x i 的状态，在每个时刻对通讯邻居的状态估计值 x j ( k ) 取加权和， j ∈ N i ， N i 为第 i 个分布式电源的通讯邻居 集合； a j i ( k ) 为 k 时刻双随机矩阵中的元素， a j i ( k ) 的取值情况表示 k 时刻第 i 个分布式电源节点与第 j 个分布式电源节点之间的通讯拓扑连接关系。 a j i ( k ) 有两种取值情况： 0 < a j i ( k ) < 1 时，表示两个分布式电源之间存在通讯连接关系， a j i ( k ) = 0 时，表示两个分布式电源不存在通讯连接关系。由于设定虚拟发电厂内部各个分布式电源之间的通讯连接关系是固定的，因此，每个时刻的 a j i ( k ) 是一样的。 (7)式中Lagrange松弛乘子 λ 和 μ 的迭代更新方程如下： λ i ( k + 1 ) = P λ i { V λ i ( k ) + α ( k ) ∇ L λ i ( k ) } (11) V λ i ( k ) = ∑ j ∈ N i a j i ( k ) λ j ( k ) (12) ∇ L λ i ( k ) = ∂ L ( x , λ , μ ) ∂ λ i ( k ) (13) (11)式中 为 k + 1 时刻第 i 个分布式电源对整个虚拟发电厂内部各个分布式电源Lagrange松弛乘子 λ 的估计值； P λ i 定义为到 λ i 的约束集上的映射； ∇ L λ i ( k ) 表示 k 时刻 L ( x , λ , μ ) 对 λ i ( k ) 的梯度。 V λ i ( k ) 表示第 i 个分布式电源与邻居通讯来更新自身 λ i 的状态，在每个时刻对通讯邻居的状态估计值 λ j ( k ) 取加权和。 μ i ( k + 1 ) = P μ i { V μ i ( k ) + α ( k ) ∇ L μ i ( k ) } (14) V μ i ( k ) = ∑ j ∈ N i a j i ( k ) μ j ( k ) (15) ∇ L μ i ( k ) = ∂ L ( x , λ , μ ) ∂ μ i ( k ) (16) (14)式中 μ i ( k + 1 ) 为 k + 1 时刻第 i 个分布式电源对整个虚拟发电厂内部各个分布式电源Lagrange松弛乘子 μ 的估计值； P μ i 定义为到 μ i 的约束集上的映射； ∇ L μ i ( k ) 表示 k 时刻 L ( x , λ , μ ) 对 μ i ( k ) 的梯度。 ∇ L μ i ( k ) 表示第 i 个分布式电源与邻居通讯来更新自身 μ i 的状态，在每个时刻对通讯邻居的状态估计值 μ j ( k ) 取加权和。"
"迭代步长 α ( k ) 的选取至关重要，直接关系到最终迭代过程的速度和收敛性。 根据 [ 15 ] 可知，迭代步长数列 { α ( k ) } 须满足如下条件： a) lim k → ∞ α ( k ) = 0 b) ∑ k = 0 + ∞ α ( k ) = + ∞ c) ∑ k = 0 + ∞ α ( k ) 2 < + ∞ 综上所述，考虑到速度的原因， α ( k ) 可以在前 k 步取一个合适的固定值，从 k + 1 开始取 α ( k ) = 1 k + 1 。"
"本文中，考虑虚拟发电厂包含主动式配电网中六个不同类型的分布式电源，其通讯拓扑连接关系如图2。 根据图2中通讯拓扑连接情况，可令双随机矩阵为： A = [ 0 .6 0 .2 0 .2 0 0 0 0 .2 0 .4 0 0 .2 0 .2 0 0 .2 0 0.6 0 0.2 0 0 0.2 0 0.8 0 0 0 0.2 0.2 0 0.4 0.2 0 0 0 0 0.2 0.8 ] 图3和图4为基于MATLAB的仿真结果。图3为各个分布式电源的无功出力状态，开始时，设定各个分布式电源工作于额定状态。由于每个分布式电源设定的特性参数不一样，通过不断的通讯迭代，最终每个分布式电源的无功出力状态的收敛状态不同，但总体能够达到全局的电压性能最优。 图4为虚拟发电厂内部分布式电源的无功出力总量的变化趋势。可以看出，当设定无功调度指令为110 Mvar，通过几百次的分布式迭代，最终分布式电源的无功出力之和能够达到109.98，基本上能够与无功调度指令匹配，随着迭代次数的增加，总量最终一定会与调度量相等。同时各个分布式电源电压偏差之和(整个优化的目标)少于0.15。 图2. 通讯连接图 图3. 分布式电源无功出力 图4. 分布式电源无功总量"
"本文基于虚拟发电厂的概念，以虚拟发电厂内部的分布式电源节点电压偏差最小为优化目标，并应用分布式次梯度的优化算法进行求解，最终通过实时的分布式通讯和分布式电源无功出力状态的迭代更新，能够实现虚拟发电厂内部的分布式电源的协调、优化运行。 本文提出的无功优化方法，能够有效地将虚拟发电厂内部的分布式电源整合起来，达到一定无功聚集效应，从而充分利用分布式电源无功调节能力，使整个虚拟发电厂具有充足的、可控的无功补偿能力，为整个虚拟发电厂积极地参与到无功辅助服务中，提供了可靠的技术支持，在未来的电力辅助服务市场中有极大的应用潜力。 本文的最后，选取存在一定通讯连接关系的六个分布式电源，通过MATLAB进行了仿真验证。仿真结果表明，文中所提出的无功优化方法不仅能实现在无功总量上满足调度要求，而且能够实现虚拟发电厂内部的分布式电源的协调、优化运行。"
