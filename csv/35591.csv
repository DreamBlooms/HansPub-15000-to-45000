"针对红外图像中小目标尺寸未知，空域中不同高斯核模板对图像平滑效果不同，传统高斯差分滤波在小目标检测中容易造成漏检。提出利用多尺度模板对图像进行处理，同时结合目标的稀疏性与背景的低秩性，对不同尺度高斯平滑后的图像进行低秩稀疏分解，以增强差分图像中目标的完整度。首先利用三个不同尺度的高斯模板与图像进行卷积，得到三个不同尺度抑制目标后的平滑图像；进一步对平滑后的图像使用加速近端梯度法进行低秩稀疏分解，保留低秩部分，以抑制高斯平滑图像中残留的目标信息，取每个尺度低秩矩阵的最大值为最终的背景图像；接着将原始图像与背景图像做差得到目标显著性图，最后利用图像的均值及方差对显著性图进行阈值分割，得到最终的目标检测结果。实验结果表明，将原始图像与融合不同尺度低秩矩阵得到的背景图像做差，在提高目标与背景对比度的同时也尽可能地保证了目标的完整性，与其它算法对比有较高的检测率以及较低的误警率。 关键词 :多尺度，高斯尺度空间，低秩稀疏分解，目标检测 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"随着数字图像处理技术的快速发展，红外图像处理技术如今已经渗透到被各行各业的领域中。其中红外小目标是红外图像处理中一个重要的研究领域，高检测率低误警率的目标检测算法可以在军事制导中帮助军人快速地准确判断敌军战机所在的位置，提供重要的情报，因此红外小目标检测是一门值得深入研究的学科。 红外小目标图像通常是在地面拍摄的天空中飞行物体，且成像距离较远，容易受光照、天气以及环境的影响，导致所获得的图像中目标没有具体的形态，通常只占据极少部分非零像素点，且背景结构复杂多变，因此高检测率低误警率的提取小目标一直是红外图像处理中的重点以及难点。当前，已经有很多学者根据红外图像中背景以及目标在空域及频域表现得不同特性提出了相应的目标检测算法，经典的基于空域的目标检测算法有基于形态学的Top-hat滤波 [ 1 ] [ 2 ]、基于邻域像素分析的中值滤波 [ 3 ]、局部对比度分析 [ 4 ] [ 5 ] [ 6 ] 以及高斯差分滤波器 [ 7 ]；基于频域分析的主要是频谱分析中的高通滤波器 [ 8 ] [ 9 ] 以及小波变换 [ 10 ] [ 11 ]。研究空域及频率域算法不难发现空域算法处理中模板的设计至关重要，不同的模板对图像的处理效果不同，并且模板的设计直接影响到图像的处理效果。在我们获取的小目标图像中，目标的大小是不固定的，使用单一的模板在空域中对图像进行处理容易造成漏检。在基于频谱分析的频率域算法中滤波器参数的设计至关重要，不同参数的设计造成的滤波效果不同，不能灵活地适应于不同的背景。 近年来，由于红外图像背景像素之间的相关性使得背景具有低秩性；目标图像除了仅有少部分非零像素点，其余像素则都为零，具有稀疏性。因此。越来越多的学者提出低秩稀疏分解算法应用在红外小目标检测中 [ 12 ] [ 13 ] [ 14 ] [ 15 ]。2011年Candes等人提出的鲁棒主成分分析(Robust principal component analysis, RPCA)理论，该理论将矩阵看做为一个低秩矩阵与一个稀疏误差矩阵之和，同时能够通过最小化核范数和一范数的来实现矩阵的低秩稀疏分解 [ 16 ]。2013年Gao等人提出的基于图像分块模型的红外小目标检测方法，该方法通过对红外图像进行分块，增强背景之间的相关性，之后采用RPCA理论对重新排列后的红外图像进行低秩稀疏分解，最后对稀疏部分进行阈值分割得到最终的检测结果 [ 17 ]；2017年Zhang等人在RPCA的基础上引入加权核范数理论，并对稀疏矩阵进行自适应阈值分割，提高目标检测的准确率 [ 18 ]。目前基于低秩稀疏理论的红外小目标检测算法在以云层以及简单建筑物为背景的情况下能够得到较好的检测效果，但是在背景结构复杂时在边缘部分容易产生误警。 分析以上存在的问题，本文充分利用小目标像素值的突变性以及稀疏性，背景的低秩性，采用背景抑制思想，并结合多尺度高斯模板对图像进行处理，弥补单尺度模板对图像处理能力不足的情况；同时进一步引入加速近端梯度法，在高斯尺度空间中进行低秩稀疏分解，以进一步改善空域滤波算法检测率低的情况。并在文章最后介绍三种具体的评价算法检测性能的指标，通过仿真实验与经典的目标检测算法以及最近提出的算法进行具体的对比分析，以验证本章算法的有效性。"
"本文所处理的红外小目标图像由三部分组成，分别为：背景(天空、云层、建筑物等)、小目标(飞机)、以及在采集过程中由传感器引起的噪声，如下式： F = B + H + E (1) 式中F为原始红外图像、B为背景部分、H为目标部分、E为噪声部分，由于红外小目标在图像中只占据极少部分的像素点，属于突变部分，理想的目标检测图中除了目标部分有非零像素值之外，其余像素值全都为零，因此可以认为小目标图像具有稀疏性。图像中背景部分像素值是缓慢变化，且像素值之间具有一定的相关性，对背景图像进行奇异值分解，其奇异值迅速衰减并趋近于零，具有低秩性。本文结合这些特点将基于空域中模板的平滑处理与低秩稀疏分解理论结合起来应用于红外小目标检测，以提高检测结果中目标的完整性。"
"本文算法结构框图如图1所示，主要分为三个部分。第一步首先使用不同尺度的高斯模板对原始红外图像进行平滑操作，抑制部分目标信息，得到三个低通滤波图像；第二步使用加速近端梯度法进一步对第一步所得到的三幅图像进行低秩稀疏分解分别得到三个低秩背景矩阵，取三个低秩矩阵相对应位置的最大像素值得到的图像为最终的背景图像；第三步对原始图像与第二步所得到的背景图像进行归一化并作差得到目标显著性图，最后进行阈值分割得到最终的检测结果。 图1. 算法结构框图  高斯滤波是对图像进行平滑处理的一种低通滤波器，对图像的处理分为两种：一种是基于模板卷积的空域处理，利用模板在图像上滑动，与原始图像相对应像素值的加权相乘取平均值代替中心位置的像素；另外一种是结合傅里叶变换实现对图像的频率域滤波。本文所使用的是空域滤波。 高斯尺度空间是用原始红外图像与高斯核函数卷积而得 [ 19 ] [ 20 ]，如下： L ( x , y , δ ) = F ( x , y ) ∗ G ( x , y , δ ) (2) 式中 F ( x , y ) 为原始图像， G ( x , y , δ ) 为方差为 δ 高斯核模板，也可称为尺度因子， L ( x , y , δ ) 为所生成的高斯尺度空间， G ( x , y , δ ) 的具体表达如下所示： G ( x , y , δ ) = 1 2 π δ 2 e − ( x 2 + y 2 ) / 2 δ (3) 式中 x 2 + y 2 代表着高斯模中一点与模板中心的距离，利用高斯核模板与图像进行卷积可以去除图像的高频成分以及小细节，改善图像的质量。 在高斯模板与图像进行卷积时，当方差 δ 确定，模板尺寸越大，则卷积之后所得的图像越模糊。当模板尺寸大小确定，方差 δ 越大则卷积之后图像越模糊，即小的 δ 度量的是图像的细节信息，大的 δ 度量的是图像的概貌特征。  加速近端梯度算法(Accelerated Proximal Gradient, APG) [ 21 ] [ 22 ] 是解决低秩稀疏分解问题的经典算法。将高斯平滑后的图像看做为由背景和目标组成，如下式： (4) 式中H为高斯平滑后的图像，B为背景部分，具有低秩性，H为残留的目标信息，具有稀疏性。结合RPCA问题将式(3)进一步转化为凸优化问题，如下： min ‖ B ‖ ∗ + λ ‖ H ‖ 0     s .t     L = B + H (5) 式中 ‖ B ‖ ∗ 为矩阵的核范数，是矩阵B的奇异值之和； ‖ H ‖ 0 为矩阵的零范数，是矩阵T中非零元素之和。使用APG算法求解该凸优化问题，首先将其转化为无约束优化问题 [ 23 ]： L ( B , H , μ ) = μ ( ‖ B ‖ ∗ + λ ‖ H ‖ 1 + 1 2 ‖ L − B − H ‖ F 2 ) (6) 式中 μ 为一个正参数，在求解过程中 μ 的值随着迭代次数的增长而逐渐减小，直到达到其下界 μ ˜ 。简化上式，另 L ( B , H , μ ) = g ( B , H , μ ) + f ( B , H ) ，可得： (7) f ( B , H ) = 1 2 ‖ L − B − H ‖ F 2 (8) 其中式(6)为不可微函数，式(7)是光滑并且具有Lipschitz连续性。引入两个与矩阵L大小相同的两个矩阵 Y B 和 Y H ，做 L ( B , H , μ ) 的部分二次逼近为 Q ( B , H , μ , Y B , Y H ) = g ( B , H , μ ) + f ( Y B , Y H ) + 〈 ∇ f ( Y B , Y H ) , ( B − Y B , H − Y H ) 〉         + 1 2 L f ‖ ( B − Y B , H − Y H ) ‖ F 2 (9) 进一步求解得： Q ( B , H , μ , Y B , Y H ) = g ( B , H , μ ) + f ( Y B , Y H ) + 〈 Y B − ( L − Y H ) , B − Y B 〉         + 〈 Y H − ( L − Y B ) , H − Y H 〉 + 1 2 L f ‖ B − Y B ‖ F 2 + 1 2 L f ‖ H − Y H ‖ F 2 (10) 由式(10)可以看出该算法的收敛速度很大程度上取决于 Y B , Y H 的选择，这里令 Y B = Y B k , Y H = Y H k , μ = μ k 。 当 H = H k 时，由以上公式可以推导出： B k + 1 = arg min R Q ( B , H k , μ k , Y B k , Y H k ) = S L f − 1 μ k ( Y B k + L f − 1 ( L − Y B k − Y H k ) ) (11) 当 R = R k + 1 时，可得 H k + 1 = arg min R Q ( B k + 1 , H k , μ k , Y B k , Y H k ) = S L f − 1 μ k ( Y H k + L f − 1 ( L − Y B k − Y H k ) ) (12) 式中 S L f − 1 μ k [ . ] 是奇异值收缩(Shrinkage)算子，其定义为 [ 24 ]： S ε [ z ] = { z − | ε | ,       if   z > | ε | 0 ,                       if   z ≤ | ε | (13) 设置更新 Y B 和 Y H 时的迭代更新步长参数 t k ： t k + 1 = 1 2 ( 1 + 1 + 4 t k 2 ) (14) 进一步可以得到 Y R 、 Y T 的迭代更新公式： Y B k + 1 = B k + t k + 1 − 1 ( t k − 1 ) ( B k − B k + 1 ) (15) Y H k + 1 = H k + t k − 1 ( t k − 1 ) ( H k − H k + 1 ) (16) 参数 的迭代更新为： μ k + 1 = max ( η μ k , μ ˜ ) , μ ˜ > 0 , 0 < η < 1 (17) 将上述计算应用到对经过高斯平滑后的红外图像进行处理，可以分别得到一个低秩背景 B = B k ，稀疏矩阵 H = H k 。  考虑在高斯滤波卷积模板的大小以及方差 δ 不同则对图像的平滑效果不同，且红外图像中小目标的尺寸的不确定性。本文使用三种不同尺度以及不同方差的高斯核模板与图像进行卷积，得到三个不同尺度的高斯空间，模板大小为 d × d ， d = 3 , 5 , 7 ，其方差满足 d = 2 2 δ 。 对不同的高斯尺度空间图像进行低秩稀疏分解，取三个尺度所得的低秩矩阵的最大值如式(18)所示： B b ( x , y ) = max [ B 1 ( x , y ) , B 2 ( x , y ) , B 3 ( x , y ) ] (18) 式中 B 1 ( x , y ) , B 2 ( x , y ) , B 3 ( x , y ) 分别为所得到的三个尺度空间中的低秩背景图像， B b 是本文算法所得到的最终的背景图像，对原始图像与 B b 进行归一化并做差，得到目标显著性图： H b = L − R b (19) 式中 H b 为所得目标显著性图，对其进行阈值分割，将小于阈值的像素值置零，大于阈值的保留，得到最终的目标检测结果。设阈值为 [ 20 ]： (20) 式中，TH为所计算的阈值， μ 是 H b 的均值，std是 H b 的标准差，k是加权系数。在本文算法中，k取值范围为5至10。"
"为了验证本文算法在红外小目标检测中的有效性，在此列举了五种对比算法以及本文算法对五种不同序列选取的红外图像的处理结果，五种对比算法分别为：经典的基于形态学的Top-hat滤波器、局部标准差滤波(LSD)、2019年提出的最新的基于高斯尺度空间的局部对比度算法(GSS-ELCM) [ 20 ]、基于视觉显著性的快速检测目标算法(TGDS) [ 25 ]、以及经典的基于图像分块模型与鲁棒主成分分析的IPI-RPCA算法 [ 17 ]。 图2为六种算法对红外图像的处理结果，其中(a)列是不同背景(以云层为背景、植物为背景、复杂建筑物为背景)的原始图像及其三维图。(b)列是Top-hat算法的处理结果，可以看出在简单背景中该算法的检测效果良好，但是复杂建筑物为背景的情况下容易漏警。出现这种情况主要是因为在该算法中不同结构元素的设计对图像处理的效果不同，单一结构元素的使用可能只能适应于某种背景下的红外小目标检测，而对其他背景的抑制能力会降低。(c)列是LSD算法的处理结果，可以看出该算法对高频信息以及轮廓提取有较好的效果，但是也正因为这个特点，容易将复杂背景中的建筑物轮廓提取出来，造成一定程度的误警。(d)列是GSS-EILCM算法的处理结果，该算法是在不同的高斯尺度空间中进行局部对比度分析，可以发现较前两种算法相比该算法在背景抑制方面表现效果较好，但是由于ELCM算法的影响使得在背景有较亮的像素值存在的情况时，容易造成误警，且经过高斯平滑后图像的小目标信息有所损失，直接对其进行局部对比度分析可能会使得最终检测结果中小目标信息不完整。(e)列是TGDS算法的处理结果，同GSS-ELCM算法一样，该算法在大多数情况下检测效果比传统的经典算法要好，但是当背景与目标像素值差异较小，或者有复杂的亮的建筑物背景存在时，容易造成误警。(f)列是本文所提出算法的处理结果，可以看出，本文算法能够有效的在各种复杂背景中提取出目标信息，具有较强的鲁棒性。 为了客观定量的分析各个算法的性能，在此引入信号杂波比增益(SCRG)、背景抑制因子(BSF)两个评判标准来进一步分析五种对比算法以及本文所提出算法在红外小目标检测中的情况。SCR、SCRG和BSF定义式如式(21)、(22)和式(23)所示： SCR = | T a − R a | δ b (21) SCRG = 20 log ( ( SCR ) out ( SCR ) in ) (22) BSF = 20 × log 10 C in C out (23) 图2. 六种不同算法的检测结果 式中， T a 表示目标的平均灰度值， R a 表示背景的平均灰度值， δ b 表示背景标准差， C in 和 C out 分别表示原始图像背景的标准差和检测到的红外小目标图像中背景的标准差。计算各个算法对各个图像处理后相应的SCRG与BSF值如表1与表2所示： Table 1 SCRG a1 a2 a3 a4 a5 a6 a7 Top-hat 31.54 32.48 18.38 30.79 15.59 14.66 23.72 LSD 24.90 27.71 14.64 24.85 13.27 10.04 17.30 GSS-ELCM 44.35 49.33 19.30 33.62 31.28 27.53 41.44 TGDS 33.11 30.87 24.86 29.99 18.81 25.51 40.21 IPI-RPCA 45.34 60.79 34.89 44.37 29.39 35.93 34.89 本文算法 56.33 68.18 40.73 54.71 39.73 36.09 48.74 表1. 六种不同算法的SCRG值 Table 2 SCRG a1 a2 a3 a4 a5 a6 a7 Top-hat 21.24 9.47 14.62 23.90 18.38 16.18 17.16 LSD 13.03 8.23 11.88 17.86 12.71 9.76 7.77 GSS-ELCM 40.13 30.15 22.97 33.59 41.03 28.82 37.21 TGDS 26.49 16.23 25.58 26.50 19.69 27.96 31.80 IPI-RPCA 35.06 40.23 32.14 37.61 30.27 32.39 28.67 本文算法 48.79 48.65 36.20 47.48 45.45 29.18 46.71 表2. 六种不同算法的BSF值 在表1与表2中a1~a7分别对应的图2中(a)列从上至下七幅不同的原始图像，观察表中数据，可以看出除了在(a6)中本文算法的背景抑制因子略低于IPI-RPCA算法，但是在剩余图片中本章算法的SCRG值与BSF值与其它算法相比较高，即无论是在信噪比增益的改进还是背景抑制方面都展现了很好的性能。 除此以外，引入ROC (Receive Operating Characteristic Curve)曲线来更佳直观地对比各个算法的性能，定义检测率(DR)和误警率(FR)如式(24)和式(25)所示： 检 测 率 ( DR ) = 检 测 到 目 标 像 素 个 数 ( M d ) 实 际 目 标 像 素 个 数 ( M r ) (24) 误 警 率 ( FR ) = 误 检 的 目 标 像 素 个 数 ( M f ) 实 际 目 标 像 素 个 数 ( M s ) (25) DR、FR分别为ROC曲线的横、纵坐标，观察各算法所对应的ROC曲线与横轴围成的图形的面积，面积越接近于1或者面积越大则说明该算法检测效果越好。 各个算法的ROC曲线如图3所示，其中(a1)~(a7)对应六种不同算法对图2中(a)列从上至下七幅不同的原始图像处理结果的ROC曲线，从结果可以看出在(a1)与(a7)中，本章算法略优于经典的基于图像分块的鲁棒主成分分析算法(IPI-RPCA)以及基于形态学的Tophat算法，但是在(a2)中IPI-RPCA算法略优于本章提出的算法，但是在其他图片中本文算法与其他算法相比在相同误警率的情况下本文算法的检测率较高。 图3. 六种不同算法的ROC曲线"
"本文的主要思想是利用原始图像与背景图像做差获得目标显著性图，之后阈值分割得到目标的检测结果。为了保证差分图中目标的完整性，提出了多尺度高斯空间分析算法，以改善单尺度空域模板对小目标抑制效果不足的情况；同时引入加速近端梯度法进一步抑制不同尺度空间滤波后仍然残留的目标信息，使得最终获得的背景图像中尽可能不包含和目标有关的信息，在增强差分图像中目标与背景的对比度的同时也尽可能地降低了小目标的漏检率。最后通过仿真实验对不同背景的红外图像进行处理，并与其他算法进行对比分析验证所提出算法在小目标检测中的有效性。"
