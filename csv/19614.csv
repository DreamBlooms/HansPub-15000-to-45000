"为了解决以往无线传感器节点能耗较高、太阳能供电的无线节点受天气影响较大及系统工作不稳定等问题，综合利用太阳能供电技术、传感技术和无线通信技术，设计一种新型的基于太阳能供电的无线传感器节点。依靠太阳能自主供电的无线传感器节点，解决了传感节点能耗的问题，经测试，该节点人机交互操作简单，节点可靠性高，可以满足环境参数采集和监测工作的要求。 关键词 :太阳能，CC2530，无线传感器节点，农业物联网"
"当前，人力资源成本愈发昂贵，智慧农业已经成为现代农业发展的必然趋势，而使用无线传感器节点构建的网络，则是智慧农业获取信息的主要途径 [ 1 ] 。在无线传感器网络(WSN)节点的实际应用中，节点的能量供给问题是制约WSN性能的关键问题 [ 2 ] 。WSN节点的能量供给问题关系到WSN的生存周期和整个系统工作的稳定性，已经成为无线传感网亟待解决的问题 [ 3 ] 。 目前市场上的无线传感器节点的供电方式主要有两种，一种是使用干电池为WSN节点供电，此种方法需要不断更换电量耗尽的干电池，不但成本较高，而且长期地检查和维护会浪费大量的人力资源 [ 4 ] 。另一种方法是依靠太阳能为充电电池充电，并由电池为节点实时供电，此种方法虽然省去了大量电池的成本，也降低了维护和更换电池的频率，但是在阴雨天气时，传感器会因为电压不足而无法稳定工作 [ 5 ] 。为了有效解决WSN节点的供电问题，本文将设计一种可以使WSN节点稳定工作的基于太阳能供电的农田环境监测节点。最后通过实验，判断依靠太阳能供电的节点电压是否能够满足监测要求从而正常工作。"
"WSN节点是环境监测系统最基本的组成单元，用于实时监测作物生长环境的变化。整个系统由带有处理器模块的传感器节点模块和电源供给模块组成 [ 6 ] 。其中，电源供给模块包括太阳能电池模块和充电电池模块，开关S1实现对充电锂电池的选择，开关S2实现对放电锂电池的选择。此外，还在基站点接入PC机，负责调出并显示电池的电压值及各传感器测得的环境参数值。本文通过双锂电池和太阳能电池的混合使用，克服了过去太阳能供电时电压值波动较大的问题，保证了传感器节点工作的连续性，延长了节点的使用寿命，确保节点能够稳定地采集数据。系统的总体结构设计如图1所示，太阳能电池模块经充电电路连接充电电池模块，太阳能电池模块、充电电池模块分别连接到传感器节点模块，传感器节点模块连接PC机。其中，太阳能电池模块中的太阳能电池板通过开关S1连接充电电路为锂电池供电，充电电池模块中锂电池通过开关S2为节点供电。另外，传感器节点模块中的传感器通过信号放大电路将放大后的信号送至处理器模块的CC2530芯片。CC2530通过与比较电路的交互选择供电锂电池，并通过功率放大电路和无线收发模块实现数据包的收发。"
"为了有效解决WSN节点的供电问题，本文需要设计一种可以使WSN节点稳定工作的基于太阳能供电的农田环境监测节点。根据本文的设计要求，综合考虑芯片的功耗、芯片的管脚和功能、芯片的成本等因素，本设计选用CC2530无线单片机作为处理器主芯片 [ 7 ] 。CC2530能够以较低的成本建立强大的网 图1. 系统总体结构框图 络节点，由于它有多种运行模式，各模式之间转换时间很短，所以它的功耗很低，这对于依靠太阳能供电的无线节点来说十分重要 [ 8 ] 。为了能够可靠地与其他传感器节点进行无线通信、交换控制信息和收发数据，CC2530需要完成传感器数据的A/D转换、网络信号的传输以及与上位机之间的通信等功能 [ 9 ] 。  电源供给模块包括：太阳能电池模块、充电电池模块、单刀双掷开关S1和S2。太阳能电池模块经过AD采集过程与处理器直接连接，可以实时监控电池的电压值。综合考虑电压、使用寿命和成本等因素，本文选用锂聚合物型充电电池。锂聚合物充电电池体积小、安全可靠性高、循环寿命长、容量损失少，特别适合用于节点数量大的无线传感网络。可充电锂电池作为整个系统的电源，利用不同的电压转换电路分别为传感器和处理器模块供电。经过测试，只有当电池的电压在3.4 V以上，系统才能稳定地工作。但是，由于比较电路工作和切换电池需要一定的反应时间，为了防止电池的输出电压低于3.4 V，本文设定比较电路的阈值电压为3.45 V。 在系统工作时，两块可充电锂电池首先经过比较电路，判断电压值是否达到预先设定的阈值3.45 V，并由处理器芯片驱动开关S1。当太阳能电池模块接收太阳光充电，并经过电压转换与开关S1连接后，它将为欠压的锂电池充电。此外，比较电路的输出信号接入处理器后，处理器还会驱动另一块相对饱和的锂电池经电压转换后作为电源为传感器节点提供5 V和3.3 V的电压。可充电锂电池经过开关S2与限流电路和稳压电路连接，为传感器采集模块和处理器模块提供不同的电压值，保证了在信号采集的过程中，每个模块都工作在稳定的状态，进而确保最后采集到的数据真实而准确。如果两块电池都没有达到阈值电压，则由电压较大的电池供电。最终，达到两块锂电池一充一放的效果。 此外，两块可充电电池的使用，克服了依靠单一的充电电池为节点供电时存在的电压后继不足的缺陷，即使出现连续的阴雨天气使电池的电压值过低，也可以依靠双锂电池保存的电量维持相当长的一段时间，以达到缓冲的效果，保证了节点工作的连续性，延长了节点的使用寿命，最终确保稳定地采集数据。  传感器节点模块由电源供给模块供电并实时采集电压值，它是整个系统的核心部分。传感器节点负责获取环境的各种参数值，并无线传输至基站，由PC机实时显示出来。  处理器模块涵盖了A/D转换器、射频收发器和存储器，负责控制整个传感器节点的操作存储和处理本身采集的数据以及其他节点发来的数据。处理器模块内部设有比较电路，用来判断太阳能电池模块为哪块锂电池充电、哪块锂电池为节点供电。 此外，处理器模块还含有无线收发模块，负责节点与节点、节点与基站之间的数据收发，为了提高收发效率和准确性，本设计在发送数据前先进行功率放大 [ 10 ] 。本设计的处理器使用两个晶振，即高频的32 MHz和低频的32 KHz，高频晶振在射频收发时工作，低频晶振是为了减少功耗，在芯片睡眠时关闭内部某些电路，使它们以极低的频率工作，达到低功耗的目的。  传感器模块负责监测区域内信息的采集和数据转换。传感器采集到信号后首先送入信号放大模块，放大后再送入处理器的A/D转换口。为了采集多种类型的传感器的信号，避免采集功能的单一化，WSN中的传感器类型都比较多，包括光照传感器、环境温湿度传感器、土壤水分传感器等。  虽然传感器的输出信号在A/D转换的范围内，但为了提高转换精度，本设计在传感器与处理器之间插入了一个信号放大模块。由于电信号的波动较小，利用OP-07运算放大器和ICL7660极性反转电源转换器可以达到放大电信号的目的，电信号的放大表现为检测装置的灵敏性能进一步增强，提高了转换精度。传感器模块输出的电信号经过放大模块处理后与处理器CC2530芯片的A/D转换口P0_4相连。放大电路采用反相输入，其放大倍数约为3倍。其中，极性反转电路如图2所示，信号放大电路如图3所示。"
"传感器网络中的各个节点需要进行大量的数据发送、接收及处理工作，本文涉及到的软件设计主要包括电源供给模块软件设计和节点收发模块软件设计。  电源供给模块的软件主要实现比较功能。首先，处理器分别判断两块可充电电池的电压是否达到阈值3.45 V，只有达到阈值的电池才能为系统供电，否则就接通太阳能电池电路为其充电。其次，如果由于连续的阴雨天气等原因使两块电池电压均达不到阈值，系统将比较两块电池电压，由电压相对较高的电池为节点供电。其中，开关S1实现对充电锂电池的选择，开关S2实现对放电锂电池的选择，电源供给模块的主程序流程如图4所示。  WSN节点收到发送数据的命令，或者到达预先设定的间隔时间后，向邻居汇聚节点发送连接请求。收到连接请求后，汇聚节点将根据自身情况决定是同意连接还是向邻居汇聚节点转发这个连接请求。最终，传感器节点会收到一个汇聚节点的回复消息，包括汇聚节点的地址、距离(跳数)和路由情况等。连接成功后，传感器节点即进入发送数据的状态，CC2530调用指令ISTXONCCA将经过A/D转换后的数据信息，通过无线收发器射频前端发送出去。发送结束后，WSN节点随即进入休眠状态以减少不必要的能量消耗。休眠状态下，传感器节点还会继续监测，等待下一次的发送命令。 图2. 极性反转电路 图3. 信号放大电路 图4. 电源供给模块的主程序流程图 当传感器节点收到连接请求后，节点会判断是否接收数据。如果节点在网络的最优路径上，就建立连接准备接收数据。连接成功后，接收节点通过指令ISRXON开启射频接收器，等待接收数据直到正确收到数据为止。  由于无线传感网络的节点数量巨大，部署这么多的节点进行实验难度太大，成本很高，所以本文缩减了传感器节点的数量，旨在尽可能真实地模拟无线传感网络的运行情况。传感器部署地区的jpeg格式的地图如图5所示，将传感器加入地图后可直观地看出整个网络的拓扑结构和传感器节点的粗略位置。 基站无线接收传感器节点采集到的数据，通过USB串口发送给上位机软件，实时数据采集情况如图6所示。"
"由于本系统中节点借助双锂电池供电，为了直观地反应双锂电池供电和单锂电池供电时，电源供给模块输出的电压波动情况，进行仿真实验。由于电池完全能为WSN节点连续供电20天以上，为了缩短实验时间，实验中用一个电源供给模块同时为多个传感器供电，本文将测量24小时内不同供电方式的输出电压值(选取上午的8:00~第二天8:00)。由于不同的天气会影响输出电压而产生实验误差，本文将两个系统放在同一个地方同步地工作，每隔1.5个小时记录一次数据。最终，绘制单锂电池和双锂电池的输出电压变化折线图，如图7所示。 由图7的电压变化情况的比较结果可直观地看出： 1) 在傍晚之后光照不足的情况下，依靠单电池供电的系统电压值一直在下降，尤其到后半夜，单电池的输出电压可能低于节点正常工作所需的电压值。 2) 在光照不足的情况下，依靠双电池供电的系统在电压值下降到3.45 V左右时，由于切换了供电电池，电压值陡升到了3.5 V以上。整个监测时间内，供电模块输出的电压值一直维持在3.4 V以上。 3) 整个监测时间内，单电池供电的系统电压值波动较大，双电池供电的系统输出电压值波动较小。 图5. 传感器部署示意图 图6. 实时数据采集情况 图7. 电源供给模块输出电压变化情况比较  综上所述，本文设计了一种比较简单的装置，实现了太阳能的智能供电。由各传感器的测量范围和误差可知，传感器能够对各环境参数进行采集，满足智慧农业系统一般的监测需求。本文设计的依靠双锂电池供电的电源供给模块工作稳定，较好地保证了农田环境监测节点在光照不足等恶劣天气下稳定工作，环境适应性强，保证了传感器的功能不受天气的影响。由电源供给模块电压性能测试情况可知，本文设计的依靠太阳能供电的传感器节点能够长期可靠地采集数据。"
"本文在农业物联网技术的大背景下，设计了一种新型的无线传感器节点。文中阐述了节点的软硬件设计原理、太阳能供电的流程、输出电压变化情况及分析等。经测试，本文设计的传感器节点供电系统输出的电压值稳定，成本较低，可以实现WSN节点的无间断工作，具有较高的应用价值。"
