"针对单闭环直流电子负载系统，研究了一种新型的基于双闭环线性积分的电子负载系统。外环主要利用PI调节器来消除静态偏差，同时提高转换速率，内环采用软硬件相结合的方法，利用低功耗微机控制滞环比较器，并研究了自适应控制算法用于控制PWM波的输出，使系统的功率因数得到了大幅提高。分析电子负载主要的干扰，设计光耦线性隔离方案，在负载端新添保护电路和通信接口，可以保证数据的安全性和完整性。最后实验结果表明，系统的功率因数提高至0.96，验证了该研究的可行性。 关键词 :线性积分，电子负载，自适应控制算法，功率因数"
"随着电力电子技术的发展，电子负载的出现，不但可以模拟不同特性的负载，而且具有智能化可编程的特点，相比于传统意义的负载，还具有体积小、精度高、稳定性好等优点 [ 1 ] 。普通的电子负载调节不便，功率因数低，难以抑制电源阶跃干扰，文献 [ 2 ] 提出了一种改进的锁相跟踪控制方法，使用2级式PWM变换器和环电流控制HCC提高响应速度和功率因素 [ 2 ] ，但功率管多，产生的功耗大。文献 [ 3 ] 采用LCL滤波器的并网变换器电流控制策略，有效抑制了并网时开关频率附近的高次谐波引起的谐振，提高了功率因素，增加了系统的稳定性 [ 3 ] ，但高频引起的电磁干扰并没有考虑。 本文所设计的直流电子负载采用线性积分控制单功率管，将大为降低功耗，采用光电耦合隔离负载电流谐波，自适应双闭环控制，令输出PWM波上升下降沿时延更短，速度更快，再同时改善电感工作模式，从而提高功率因数，适用于当今直流电源的测试。"
"方案一：利用单闭环线性积分控制方案。对负载电路进行采样，利用PI调节器控制输出，改变MOS管导通深度从而控制负载电流，最终实现电子负载的功能。 方案二：利用双闭环线性积分控制方案。内环利用微机进行控制，外环经过采样，隔离输出至PI调节器，新添滞环比较器，输出PWM波控制MOS管，利用buck-boost电路原理，控制负载电路上的电流，从而实现电子负载的功能 [ 3 ] 。 方案一是普遍使用的单闭环控制系统，由于MOS管处于线性导通状态，虽然纹波和噪声小，但功率因数较低，方案二的双闭环控制新方案，能自适应快速控制MOS管的导通与关闭，大大提高了功率因数，增加了系统效率，所以本文采用方案二，如图1所示。 整个直流电子负载系统采用TI的低功耗430系列的F5529作为微处理器，内置12位的高精度A/D，使得采样更加准确，从而实现恒流、恒压、恒阻和恒功率的功能。 图1. 系统框图  为了使系统的响应速度加快，本文外环设计主要采用PI调节器，PI调节器的输出表达式如下： (1) 在PI调节器前需加一个反相器，使得 为负(这样才能与反馈量形成偏差)，表达式如下： (2) (3) 其中， 是输出量， 是第一级输入量， 是第二级输入量， 是反馈量， 为PI调节器的比例系数， 为PI调节器的积分常数， 为输入量与反馈量之差，即偏差。 线性积分器由“比例和积分”两部分组成，前半部分(比例部分)快速反应调节作用，使电子负载系统具有快速性，后半部分(积分部分)最终消除静态偏差，使系统的稳定性提高 [ 4 ] [ 5 ] 。  内环控制的目的是提高功率因数，从而提高转换效率，主要从两方面来校准功率因数，一方面，功率管的上升电流和下降电压的交越时间过长会产生较大的损耗 [ 6 ] 。 本方案通过在负载端采样放大并且反馈给微控制器，微控制器通过自适应算法控制输出电平，使之与经过PI调节的信号进行比对，滞环比较器输出PWM波，快速控制以减少PWM波的上升时间和下降时间。如图2所示，功率管所接为感性负载，当输入为 ，设交越时间为 ，最大导通电流为 ，当 和 中有一个变化时，另一个保持不变，此时电流均值为 ，电压均值为 ，则可得一次交越损耗为 (4) (5) 当重复导通关闭功率管时，产生的损耗为 (6) 主要由两个因素决定，一是由滞环比较器输出的PWM波上升下降沿的斜率，二是功率管本身的响应速度。使用PI调节器可以使比较器输入时延降低，从而使得PWM波上升下降沿更为陡峭，功率管采用低导通电阻、低延时的MOS管IRF2305，上升时间为101 ns/V，下降时间为65 ns/V，使得功耗大大降低。 图2. 导通转换图 由微机控制的锯齿波频率所决定，当负载功率提高时，根据自适应算法控制 减小，从而导致损耗降低，当负载功率下降时，可适当提高 ，缓解电路拓扑带来的压力，从而提高效率。另一方面，除了电路中的无源PFC补偿外，还需要控制电感的充放电时间，使其尽量工作于断续导通模式。"
"恒流电路的工作方式：由用户在微控制器中设定电流值，经过微机处理，把模拟量输入PI调节器，输出信号，与微机反馈控制的锯齿波信号进行比较，输出驱动功率管，通过buck-boost电路，从而控制负载电流使之恒定，达到改变设定的电流值就可改变输出电流的功能 [ 7 ] - [ 9 ] 。电路设计如图3所示。 恒压电路的PI调节器及反相电路与恒流电路相同，不同在于采样电路和负载电阻，通过采样电路，分压后输入PI调节器，由于电阻分压后驱动力不足，所以采用直接耦合方式。  恒阻和恒功率电路基于恒流电路，首先通过按键设定需要的电阻值以及功率值，通过采样至微机处理，计算需要设定的电流值，通过恒流电路控制输出的电流，从而实现恒阻和恒功率的功能。  由于被测电源的未知性，负载电路往往存在不同程度的干扰。电源电路中的高频开关或者感性负载处于高频状态时易产生尖峰脉冲，其中包含的谐波丰富，将会对负载设备产生巨大的影响；当负载设备的功率加大时，由于线路的分布问题，从而会引起电场耦合和磁场耦合，从而引起电磁干扰。整个EMI干扰和谐波干扰主要来自高频开关端和负载端，负载端采用线性光耦隔离方案，在开关附近加上尖峰去除电路来消除噪声 [ 10 ] - [ 12 ] ，并且在负载端添加过流保护和过压保护电路提高系统的安全性。  微控制器主要实现两方面的内容，采集显示和自适应算法。实现方案主要如图4所示。 采集到的电压信号，电压信号输入至微控制器，通过与当前电压值比较，表1为频率数据表，多次调试并获得一个最合适频率的锯齿波，控制滞环比较器，从而使得根据获得的电流电压值算出黄金频率点，使功率因数始终处于最大值，表2为电压数据表，反馈给输入并产生偏移量。另外，微控制器对采集信号进行处理，通过串口，发送到上位机进行保存和显示。 图3. 恒流电路原理图 图4. 软件流程图 Table 1 设定电流/mA 显示电流/mA 实测电流/mA 实际误差/% 测量误差/% 10 50 100 400 800 1200 1800 12.5 53.5 102.0 404.5 812.5 1218.5 1840.0 10.8 51.8 103.8 402.7 809.9 1215.0 1832.4 8.00 3.60 3.80 0.68 1.23 1.25 1.80 15.74 3.28 1.73 0.37 0.32 0.29 0.41 表1. 恒流数据测量 Table 2 设定电压/V 显示电压/V 实测电压/V 实际误差/% 测量误差/% 0.1 0.5 1 5 10 15 18 0.115 0.525 1.050 5.030 10.025 15.015 18.010 0.112 0.527 1.055 5.030 10.031 15.072 18.102 12.00 5.40 0.50 0.60 0.31 0.48 0.57 2.68 1.44 0.47 0 0.06 0.38 0.01 表2. 恒压数据测量 Table 3 设定电阻/Ω 显示电阻/Ω 实测电阻/Ω 实际误差/% 测量误差/% 10 20 50 100 400 800 2000 11.0 21.5 52.0 102.5 403.5 805.0 2007.0 11.4 21.0 52.1 104.2 406.2 807.1 2009.8 14.00 5.00 4.20 4.20 1.55 0.89 0.49 3.51 2.38 0.19 1.63 0.66 0.26 0.14 表3. 恒电阻数据测量 Table 4 设定功率/W 显示功率/W 实测功率/W 实际误差/% 测量误差/% 0.01 0.05 0.1 0.5 1 5 20 0.011 0.052 0.100 0.505 1.010 5.070 20.185 0.010 0.051 0.103 0.508 1.025 5.082 20.260 0 2.00 3.00 1.60 2.50 1.64 1.30 10.00 1.96 3.00 0.59 1.46 0.23 0.37 表4. 恒功率数据测量"
"经过硬件实际测试，电路运行正常。实际电路测试数据如下(表1~4)： 经过测试，设定电流在50~1800 mA时，实际误差控制在4%之内，测量误差在4%之内；设定电压在1~18 V时，实际误差在1%之内，测量误差在1%之内；设定电阻在20~2000 Ω时，实际误差在5%之内，测量误差在3%之内；设定功率在0.01~20 W时，实际误差在3%之内，测量误差在10%之内。受测量精度和转换效率的影响，当设定值较小时，误差较大。总体来说，设定值在一个较大范围内能都使得输出稳定。"
"现代直流电子负载的功率因数普遍较低，即使增加PFC修正功率因数，其值也仅在0.8左右。本系统分析并设计线性积分调节器，提高系统的响应速度，利用双闭环系统自适应控制功率管，使得功率管的和输出电感的功率因数都得以修正，功率因数值比普通的PFC修正电路提高了0.15，大大提高了系统的效率。结合光电耦合电路隔离被测电源的干扰，有效地消除了电源波动，电磁干扰方面对电子负载系统带来的影响，使得系统的稳定性得到了提高 [ 13 ] ，在检测电源方面有较大的应用前景。"
