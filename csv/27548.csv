"根据实际情况，在虚拟领航编队中所有无人机因各种因素影响并不能都接受到虚拟领航者的信息，因此本文采用分布式通信控制结构，并利用图论与一致性理论设计了相应的编队控制律。以二阶系统为研究对象，通过利用设计的控制律和相应的通信拓扑网络，在仿真中实现了3架无人机虚拟领航一致性编队控制飞行，并在位置与速度信息上达到一致。 关键词 :无人机，虚拟领航，编队，一致性 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"四旋翼无人机由于其结构简单、操作性强，广泛应用于实际工程和研究中。但是单架四旋翼无人机的局限性越来越难以满足现今越发复杂的任务与环境，取而代之的是多无人机之间的协同工作。多无人机的编队则是多机协同工作的基础与关键技术，因此引起了越来越多的关注和研究。 多无人机的编队控制主要是指在执行任务过程中，为了适应任务与环境要求无人机需要形成并保持一定的几何结构。主要分为编队的形成重构和编队的保持两个方面，其主要的编队控制方法有，领航–跟随法 [ 1 ] 、虚拟结构法 [ 2 ] 、基于行为控制法 [ 3 ] 、人工势场法 [ 4 ] 以及针对群智能系统的一致性理论方法 [ 5 ] 等。 一致性理论方法可以融合上述几种编队控制方法，因此已经成为主流的编队控制方法和研究方向。文献 [ 6 ] 中给出了二位平面内一致性的无人机编队控制方法。文献 [ 7 ] 设计了领航–跟随模型下的一致性多无人机编队控制律，最终使得各机之间的位置与速度达到一致，但对领航者的通信和稳定性要求较高，一旦领航者失效编队既失效。文献 [ 8 ] 中，设计了虚拟领航的一致性多机编队控制律，虽然虚拟领航不存在领航者失效的情况，但是该文中所有跟随者仍然都能获取虚拟领航的信息，在实际情况中因为各种原因并不可能每一架无人机都能获得虚拟领航的信息，并且全局获得虚拟领航的信息也会加大对通信的负担与要求。 本文针对上述大部分文献中虚拟领航者的所有跟随者都接收虚拟领航信息的情况做了相应的改进。在新的策略中，一个集群编队中仅有个别无人机能够接收虚拟领航者的信息，其余无人机根据通信拓扑网络获得邻居无人机的信息，同时根据一致性编队控制律使得整个集群编队达到一致。"
"在惯性坐标系e和机体坐标系b下建立四旋翼无人机动力学模型，如图1所示。定义 P = ( x , y , z ) T 为惯性坐标系下的位置， V b = ( u , v , w ) T 为机体坐标系下的速度， Φ = ( ϕ , θ , ψ ) T 为惯性坐标系下的滚转、俯仰和偏航角， w b = ( p , q , r ) T 为机体坐标系下的角速度。四旋翼无人机的质量为m，转动惯量考虑四旋翼无人机整体结构完全对称，所以转动惯量 J = d i a g ( I x x , I y y , I z z ) 。 图1. 惯性与机体系 根据牛顿–欧拉法，忽略陀螺力矩，四旋翼无人机力与力矩方程表达如下： { m a = R b e F z − m g M b = J w ˙ b + w b × J w b (1) 式(1)中：g为重力加速度； 为螺旋桨产生的升力； R b e 为机体坐标系到惯性坐标系的旋转矩阵。根据文献 [ 7 ] 旋转矩阵定义如下： (2) 四旋翼无人机动力学模型主要考虑在滚转角和俯仰角小幅度运动状态下建立，当四旋翼处于悬停状态下时，质心与机体坐标系原点重合，其滚转角 ϕ 与俯仰角 θ 均接近于0 ( cos ϕ = cos θ ≈ 1 , sin ϕ ≈ ϕ , sin θ ≈ θ )，因此可认为机体坐标系下线速度 V b 和角速度 w b 与惯性坐标系下的线速度 P ˙ 和角速度 Φ ˙ 相等。根据式(1)，四旋翼非线性动力学方程如下： { m x ¨ = ( sin θ cos ϕ cos ψ + sin ϕ sin ψ ) U 1 m y ¨ = ( sin θ cos ϕ sin ψ − sin ϕ cos ψ ) U 1 m z ¨ = cos ϕ cos θ U 1 − m g ϕ ¨ = U 2 I x x + ( I y y − I z z ) θ ˙ ψ ˙ θ ¨ = U 3 I y y + ( I z z − I x x ) ϕ ˙ ψ ˙ ψ ¨ = U 4 I z z + ( I x x − I y y ) ϕ ˙ θ ˙ (3) 其中， U 1 , U 2 , U 3 , U 4 为控制输入，与四旋翼的螺旋桨转速 的关系定义如下： U = [ U 1 U 2 U 3 U 4 ] = [ C T ( w 1 2 + w 2 2 + w 3 2 + w 4 2 ) C T d / 2 ( w 1 2 − w 2 2 − w 3 2 + w 4 2 ) C T d / 2 ( w 1 2 + w 2 2 − w 3 2 − w 4 2 ) C M ( − w 1 2 + w 2 2 − w 3 2 + w 4 2 ) ] (4)"
"对于单个四旋翼无人机主要采用PID控制算法作为底层控制器，分为内环姿态环和外环位置环。PID算法系统框图如图2所示： 图2. PID控制器系统框图  位置控制环的目的主要是通过期望位置与实际位置的差值通过PID算法求解高度控制 U 1 输入、期望滚转角 ϕ d e s 和期望俯仰角 θ d e s 。定义期望位置为 P d e s ，通过如下PID算法得： ( P ¨ − P ¨ d e s ) + K p ( P − P d e s ) + K i ∫ ( P − P d e s ) + K d ( P ˙ − P ˙ d e s ) = 0 (5) 对式(3)进行线性化得到： P ¨ x d e s = g ( θ d e s cos ψ + ϕ d e s sin ψ ) P ¨ y d e s = g ( θ d e s sin ψ − ϕ d e s cos ψ ) P ¨ z d e s = U 1 / m − g (6)  姿态环控制器也是在线性化条件下设计，结合式(3)可得： I x x p ˙ = U 2 + q r ( I y y − I z z ) I y y q ˙ = U 3 + p r ( I z z − I x x ) I z z r ˙ = U 4 + p q ( I x x − I y y ) (7) 角速度的分量极小，因此式(7)右边项可以忽略不计。姿态环控制器的输入主要由位置环提供，式(6)经转换后可提供姿态环的控制输入 ϕ d e s 和 θ d e s ，期望 ψ d e s 则由轨迹规划时候一同设定。因此根据PID算法得到： U 2 d = K p , ϕ ( ϕ d e s − ϕ ) + K i , ϕ ∫ ( ϕ d e s − ϕ ) + K d , ϕ ( ϕ ˙ d e s − ϕ ˙ ) U 3 d = K p , θ ( θ d e s − θ ) + K i , θ ∫ ( θ d e s − θ ) + K d , θ ( θ ˙ d e s − θ ˙ ) U 4 d = K p , ψ ( ψ d e s − ψ ) + K i , ψ ∫ ( ψ d e s − ψ ) + K d , ψ ( ψ ˙ d e s − ψ ˙ ) (8) 根据式(5)~(8)，即可得到控制输入 U 1 , U 2 , U 3 , U 4 ，带入式(4)解算电机转速，四旋翼无人机即可到达期望的位置。"
"在整个多无人机系统中，图论是用来分析该系统中无人机个体之间相互信息交流的一种数学描述方法。一个有向图 G = ( V ( G ) , E ( G ) ) 是由一个节点集合 V ( G ) = { v 1 , ⋯ , v N } 与一个边集合 E ( G ) ⊆ { ( v i , v j ) , v i , v j ∈ V ( G ) } 所组成，其中每个节点表示一架四旋翼无人机，边则表示两两之间的影响关系。每条边 由一对节点 ( v i , v j ) 表示，当节点 v j 能够接收到节点 v i 的信息反之不行，那么 v i 为父节点， v j 为子节点。 定义有向图G的邻接矩阵为： (9) 其中， w i j 表示W中的元素，表示节点j对i的影响权重，i对j的影响权重则表示为 w j i 。 定义节点 的邻居集为： N i = { v j ∈ V ( G ) : ( v j , v i ) ∈ E ( G ) } (10) 节点的出入度为该节点发送与接收信息的个数，定义任意节点 v N 的出入度为： deg i n ( v N ) = ∑ j N w N j ,       deg o u t ( v N ) = ∑ j N w j N (11) 如果一个有向图的节点的出入度相等，既接收节点信息与发送节点信息个数相等，那么称该图是平衡的，另外一个图的拉普拉斯变换定义为 L = D − W ，D和W分别是出入度的矩阵。 如果一个图G的节点 v i 与 v j 相互之间能够获取信息，那么称为无向的。如果在无向图中，不存在孤立的结点，那么称该无向图连通.如果在一个有向图中，有一个节点至少存在一条有向路径到达其他所有节点，那么称该有向图包含生成树，如若在一个有向图中，任意两个节点之间都能通过路径相连接，则称该有向图为强连通的。 综上所述，运用拓扑结构的边来表示四旋翼无人机之间的通信，双向边表示两架无人机可相互传递信息，单向边则表示为单向传递信息。在整个多无人机系统中，可能由于各种原因每架四旋翼无人机获取信息的设置或者权重各不相同，从而构成不同的通信拓扑链路，需要根据不同的通信链路设计相应的一致性控制律。  一致性理论主要式根据多智能体之间的通信拓扑设计相应的一致性编队控制算法，最终使得多智能体之间所关注的信息与期望的信息保持一致。在本文中四旋翼无人机编队主要考虑多机之间位置与速度的一致性，因此位置环采用二阶系统模型，定义一般情况下二阶系统如下： { x ˙ i ( t ) = v i ( t ) v ˙ i ( t ) = u i ( t ) (12) 其中， i = 1 , 2 , ⋯ , N ， x i ( t ) 、 和 则分别表示系统的位置、速度和控制输入。如果 lim t → ∞ ( x i ( t ) − x j ( t ) ) = 0 ，同时 lim t → ∞ ( v i ( t ) − v j ( t ) ) = 0 ，其中 i , j = 1 , 2 , ⋯ , N ，那么表示该二阶系统获得一致。根据文献 [ 9 ] ，解决固定通信拓扑下的群二阶系统一致性算法如下： u i ( t ) = ∑ j ∈ N i w i j ( x j ( t ) − x i ( t ) ) + γ ( v j ( t ) − v i ( t ) ) (13) 其中 γ 是一个大于零的有界缩放因子。  经典的虚拟领航模型算法基于四旋翼无人机的描述如下，假设有3个四旋翼无人机(可拓展到N个)，其要构成三角形编队飞行，并以三角形的三个中线的交点为虚拟领航点。虚拟领航点则是根据整个要形成的形状，分配给每架无人机需要追踪的航点，每架四旋翼无人机根据分配的航点进行飞行，从而到达三角编队飞行的目的。二维平面下传统虚拟领航的示意图如图3所示。 图3. 虚拟领航示意图 如图3所示，每个四旋翼无人机都要知道虚拟领航者的实际位置，并解算自身需要到达的期望位置，从而达到期望的编队队形。但是，在实际中受环境、通信距离造成的信号可靠性降低以及通信带宽等因素的影响，每个四旋翼无人机并不都能从虚拟领航点接收到可靠的信息。 本节主要目的是设计虚拟领航模型下的分布式一致性编队控制算法。运用图论，在固定拓扑通信下假设有n架四旋翼无人机，虚拟领航者为第 n + 1 架四旋翼无人机，将邻接矩阵扩展到 ( n + 1 ) × ( n + 1 ) 维，虚拟领航者转换为领航者。据4.2小节的二阶一致性控制算法，根据文献 [ 10 ] 给出一致性跟踪控制算法如下所示： u i = 1 k i ∑ j = 1 n w i j [ ζ ˙ j − K r j ( ξ i − ξ j ) − K v j ( ζ i − ζ j ) ]     + 1 k i w i ( n + 1 ) [ ζ ˙ r − K r i ( ξ i − ξ r ) − K v i ( ζ i − ζ j ) ] (14) 其中， k i = ∑ j = 1 n + 1 w i j ； 和 ξ j , ζ j 分别表示自身的位置、速度信息与邻接无人机的位置、速度信息； ξ r , ζ r 则表示虚拟领航者的位置、速度信息； K r j , K v j , K r i , K v i 为 3 × 3 维的对称正定增益矩阵，分别受邻接无人机与虚拟领航者的影响。"
"在Matlab中搭建四旋翼模型，具体参数为： ， I x x = I y y = 1.395 × 10 − 5   kg ⋅ m 2 ， I z z = 2.173 × 10 − 5   kg ⋅ m 2 ， g = 9.81   m / s 2 。组建3架四旋翼无人机的编队模型，通信拓扑结构如图4所示。 图4. 仿真通信拓扑图 3架四旋翼无人机的起始坐标，1号 ( − 0.6 , 0.6 , 0 ) ，2号 ( − 1.2 , 0.6 , 0 ) ，3号 ( − 0.9 , 0.9 , 0 ) ，初始速度都为0。编队队形采用三角编队队形，相对虚拟领航者位置偏差分别为 P 1 = [ 0 , 0 , 0 ] T ， P 2 = [ − 0.25 , 0.25 , 0 ] T ， 。关于位置信息的增益矩阵 K r i = K r j = I 3 ，速度信息的增益矩阵 K v i = K v j = 2 I 3 ， I 3 为 维的单位矩阵。 轨迹主要通过5阶多项式规划，偏航角设为0，并且边界速度于加速度条件都为0，相邻端之间轨迹时间为7 s，端点如表1所示。 Table 1 坐标轴 起点1 插值点2 插值点3 插值点4 终点5 x (m) −0.6 0.6 0.6 −0.6 −0.6 y (m) 0.6 0.6 −0.6 −0.6 0.6 z (m) 0.6 0.6 0.6 0.6 0.6 表1. 轨迹规划端点 三维仿真结果如图5所示。 图5. 三机编队三维视图 二维仿真结果如图6所示。 图6. 三机编队二维视图 三机三轴速度如图7所示。 图7. 三机编队三轴速度图 从仿真图中分析可得根据所给出的一致性编队控制算法，三架无人机能很好的完成编队和轨迹跟踪飞行，并且在位置与速度上都达到了一致性。本文所给出的一致性编队控制算法仅需个别无人机获取虚拟领航者的信息，能有效的减小通信带宽符合真实的实际情况。"
"本文采用图论与一致性理论设计了虚拟领航的多无人机编队控制算法，并针对大多数文献中需要编队无人机全局获得虚拟领航者信息的缺点做出了相应的改进，给出的编队控制算法仅需个别无人机获得虚拟领航者的信息。通过Matlab验证了算法的有效性，下一阶段将会应用到实际工程中，以验证算法在实际中的有效性。"
