"随着电动汽车的发展，其换电站电池的有序充电将成为消纳风、光等可再生能源波动性的新方式。本文研究使含风力发电、光伏发电微电网的等效负荷波动性最小的电动汽车换电站电池调度方案的制定方法，将离散粒子群优化算法与动态规划算法进行比较，经过算例证明，动态规划法具有比离散粒子群算法更好的优化效果，并总结了电池数量与平抑等效负荷波动性无直接关系。 关键词 :微电网，充电策略，动态规划"
"微电网一般由随机性、波动性极大的风电、光伏发电等分布式发电装置和负荷及储能装置组成，是未来电网的发展方向。微电网接入大电网，虽然可以减少大电网的常规发电，但是要严格控制其与大电网联络线的功率波动性，此时可视联络线的功率为大电网的“等效负荷”。电动汽车换电站电池的有序充电是协同优化调度此类新能源发电的必然选择[ 1 ] -[ 3 ] 。调度目标是使大电网的等效负荷波动最小。 不考虑大电网的负荷峰谷期及其运行情况的电动汽车独立充电，是一种无序充电方式，其规模化应用之后对电网的影响反而不好，例如文献[ 4 ] 中无序充电后等效负荷曲线比原始等效负荷曲线的峰谷差更大了。文献[ 5 ] [ 7 ] 讨论了基于时间窗口的多尺度方差指导电动汽车的充电策略降低等效负荷波动性的方法。而不同时间尺度的功率波动由不同方式的储能来消纳，许多学者还对交换功率的波动性进行了相关研究 [ 8 ] -[ 11 ] 。文献[ 12 ] 指出电动汽车充放电模式主要有单向无序、单向有序和双向有序三种。不同的电池储能系统特性不同，所属soc可指导其充放电行为[ 13 ] ，智能算法在优化电池充放电功率方面也有较多应用，如文献[ 14 ] 。本文主要讨论如何制定电动汽车换电站电池的单向有序充电策略，以电池充电时间和电网余额功率为约束，使电动汽车充电后的等效负荷方差最小。"
"1) 无电池调度作用时： 余额功率，即微电网的发电功率与负荷功率之差： ；此时微电网与配电网的交换功率(即等效负荷) 与为余额功率 大小相等； 2) 换电站电池作用后： (1) 式中， ， 为 时段换电站电池的充电功率；本文设定调度时间间隔 ，总调度时段即未知量个数为n = 24， 。调度目标是在一定电池个数下，通过合理安排电池充电顺序使得交互功率波动性最小。"
"解决连续优化问题的基本粒子群算法中粒子根据如下公式更新速度和位置： (2) (3) 式中， 代表粒子个数； 是惯性权重； 、 是学习因子，通常 ； 和 是[0,1]之间的随机数； 、 表示第 个粒子的位置和速度； 和 分别是个体极值和全局极值对应的位置向量。 惯性权重 起着权衡局部最优和全局最优能力的作用。设 为最大权重， 为最小权重， 、 分别为最大迭代次数、当前迭代次数，则有： (4) 由于电池充电功率的限制，本文中的粒子只能取充电功率倍数的离散值，将基本粒子群算法中的最大速度约束为不超过该点最大可充电功率，对粒子速度和位置转换关系做如下改进： (5) 粒子位置 离散量，速度 连续量， 一块电池的充电功率；  动态规划(Dynamic Programming, DP)是寻找多阶段最优决策过程的方法。一般而言，多阶段决策过程是指根据时空特性，将整个过程分为若干个阶段，而每个阶段又包含若干个状态变量的过程。当各阶段按一定最优准则取一个决策，则整个过程可按时间顺序组成决策序列，成为最优策略。由于在每一个阶段的子问题求解中，都要用到上一个子问题的最优化结果，而每阶段的决策都是该段状态的函数，所以称为动态规划法[ 6 ] 。 本文中动态规划的阶段总数为 ，各阶段充电功率选取的最优准则：以第 个阶段的原始等效负荷调度电池后的前 个阶段的等效负荷标准差最小为第 个阶段决策的依据，即： (6) 其中， ， ， 为第 阶段的充电功率， 为截止 阶段的各阶段原始等效负荷功率序列， 为截止 阶段的各阶段充电功率序列。 图1是按前 阶段调度后的标准差最小原则求解电池调度策略的流程。 基本步骤如下： 1) 设整个调度过程分为 个阶段，在第 个阶段，有 个可选状态(包括充电功率为0，不调度电池也算一种状态)，即 种调度电池的策略。 2) 引入二维变量 ， 表示第 阶段上的第 个状态。 3) 当电池调度策略 的第一个阶段为状态 时，求 的第二个阶段的决策，可取范围： ， … ，决策费用 ， 。 4) 计算 对应的最优决策费用即调度后标准差 ， ；比较后得出第一阶段状态未知时的最优解为动态规划解。如果第一阶段状态已知则无需第(4)步。 5) 截至第 阶段的决策解向量为： 且 ， 。"
"为简化问题，使各阶段投入的电池只在当前阶段有效，设定每个调度段间隔为 ，一天共 N = 24个调度段，所有电池充电功率 (本文中只研究充电)，每块电池容量RL为30 KWh。  由文献[ 6 ] 部分数据修改后得到某一天的余额功率如图2所示。 图1. 基于动态规划法的电池调度计划 图2. 余额功率曲线  本文PSO程序的粒子群规模为N = 50，粒子维数(未知量个数) D = 24，最大迭代次数maxDT = 200。PSO算法的优化调度效果和迭代流程见图3、图4所示：  按间隔 的动态规划优化电池充电的效果如图5所示。 由表1结果可以看出：调度段1的取值在动态规划和离散PSO优化时的取值相同，即都不充电。 图3. PSO调度后等效负荷 图4. PSO调度的迭代路径图 图5. 动态规划调度后的等效负荷 Table 1 时段 PSO法 动态规划法的第一阶段所取状态 状态1 状态2 状态3 状态4 状态5 状态6 1 0 0 30 60 90 120 150 2 120 210 240 270 300 330 330 3 120 150 180 210 240 270 300 4 180 240 270 300 330 360 390 5 180 270 300 330 360 390 390 6 270 330 360 390 420 450 480 7 330 390 420 450 480 510 540 8 330 360 390 420 450 480 510 9 240 300 330 360 390 420 450 10 390 450 480 510 540 570 600 11 390 450 480 510 540 570 570 12 390 450 480 510 540 570 570 13 450 510 540 570 600 630 630 14 360 420 450 480 510 540 540 15 330 360 390 420 450 480 510 16 180 270 300 330 360 390 390 17 180 240 270 300 330 360 360 18 240 300 330 360 390 420 420 19 240 300 330 360 390 420 450 20 120 150 180 210 240 270 300 21 240 270 300 330 360 390 390 22 90 150 180 210 240 270 300 23 150 180 210 240 270 300 330 24 60 150 180 210 240 270 270 表1. 不同优化方法的电池充电功率(单位：/kw) Table 2 等效负荷 标准差/kw 电池总数/块 均值/kw 最大冲击/kw 无调度 121.966 0 433.625 504 动态规划 7.1585 230 146.125 21 离散PSO 19.9876 226 201.125 87 表2. 等效负荷调度前、后对比 表2中电池总数为一天所有阶段所调用的电池总数之和，反映电动汽车换电站的规模，电池总数越多则换电站费用越大；可见，动态规划法和离散PSO在所用费用相近的情况下，前者调度后的等效负荷的标准差、最大冲击指标更好。"
"本文提出两种优化电动汽车换电站电池有序充电的方法，即离散PSO和动态规划法，并证实了PSO优化算法的局部极限性，验证了动态规划法的全局最优性。将其优化结果进行分析得到： 1) 调度电池后等效负荷的均值与所用调度电池总数成反比； 2) 由于两种方法的电池总数近似，但优化效果差别很大，即所用电池总数与优化效果无直接关系，而安排其充电的顺序起决定性作用。 3) 将动态规划法的解作为离散PSO的全局最优解的初始值时，PSO的优化结果仍为动态规划法的解，但是仅依靠离散PSO本身一般很难寻找到此解。 考虑到电池的投入、充满切去一般不在同一个调度段及电池充电常常需要相邻的几个调度段从而有阶段的交叉，是本文方法调度电池的一个缺陷，并且需要继续研究在每个调度段投入电池时需要兼顾在该段之前、之后投入的电池影响。"
