"应用Crowbar保护电路是实现双馈风力发电机组低电压穿越广泛应用的手段，而Crowbar电阻的选取对穿越过程有着决定性的作用。目前，针对Crowbar电阻的设计虽已有很多研究，但大都是得到Crowbar电阻的大概选择范围，然后在这范围内用试凑法进行Crowbar电阻选取，从而难以到达最优设计效果且效率不高。本文提出一种基于模糊隶属函数的Crowbar电阻设计方法来提高Crowbar电路的设计效率并获得更高满意度的低电压穿越过程，首先分析电网发生三相短路时双馈风力发电机的故障特性，然后分析了Crowbar保护电路中阻值选取的约束条件，采用隶属度函数方法建立了Crowbar阻值选取目标函数，在Matlab仿真软件平台上对所选方法进行了仿真验证，仿真结果证明了基于模糊隶属函数的Crowbar电阻设计方法可以提高设计效率并获得更好的低电压穿越过程。 关键词 :双馈风力发电机，Crowbar，低电压穿越，模糊隶属度"
"随着世界各国对风力资源的开发，风力发电已经进入规模化并网的时期。为了保证风电并网后系统的安全稳定，国内外都要求风力发电机组在电网发生故障时，具有一定的低电压穿越能力(Low voltage ride through)，图1为我国对风电场的低电压穿越要求 [ 1 ] ： a) 风电场内的风电机组具有在并网点电压跌至20%额定电压时能够保证不脱网连续运行625 ms的能力； b) 风电场并网点电压在发生跌落后2 s内能够恢复到额定电压的90%时，风电场内的风电机组能够保证不脱网连续运行。 双馈风力发电机(doubly fed induction generator, DFIG)由于具有变流器容量小、有功无功可以独立解耦等优点，使得其成为了风力发电中的主力机型，但是DFIG的定子直接与电网相连也使得其对电网电压跌落比较敏感 [ 2 ] 。当电网电压发生跌落时，在转子侧感应出很大的短路电流，从而对转子侧和变流器产生威胁。电压跌落时，DFIG产生的能量不能完全送出，多余的电能会在机组内部消耗，根据磁链守恒原理，定子磁链不能发生突变，因此定子侧会产生直流电流分量从而导致定子电流增大，定子侧产生的电流直流分量切割旋转的转子绕组，在转子也会感生出过电流和过电压。定转子电流的变化也会导致电磁转矩的波动，使DFIG产生较大的机械转矩冲击。由电网电压跌落导致经网侧和转子侧变换器流入或流出直流母线的功率不平衡，导致直流母线电容电压的升高 [ 3 ] 。 目前，在双馈风力发电机中广泛使用的一种低电压穿越技术就是增加转子侧Crowbar保护电路来实现低电压穿越，即在检测到电网故障时封锁转子侧变换器驱动脉冲信号，同时投入转子回路的Crowbar电阻将转子回路短路 [ 4 ] 。其中，Crowbar电路中泄放电阻的选取是影响风电机组低电压穿越能力的关键因素，一方面，应该选择足够大的Crowbar阻值来限制转子变流器电流，阻值越大，转子电流衰减越快，电流、转矩振荡幅值也越小，另一方面，过大的阻值可能导致转子侧过电压并通过转子侧变换器注入直流母线电容，造成直流母线过电压[ 5 ] 。 虽然现在已经有一些针对低电压穿越过程中Crowbar电路电阻选取的研究工作[ 6 ] -[ 8 ] ，文献[ 6 ] 在设计双馈风力发电机Crowbar电阻时，只考虑了限制转子过流；文献[ 7 ] 和文献[ 8 ] 虽考虑了两个限制因素，但得到的电阻选择范围太大，对实际双馈风电机组Crowbar阻值的选取指导作用有限。目前，Crowbar阻值选取中虽考虑了这两方面因素，但是最后往往基于两个约束条件下采用试凑法进行选择，在实际低电压穿越过程中往往效率不高且精度不够，难以兼顾转子变流器过流或者直流母线过压，因此，提出一种更加有效的Crowbar电阻的设计方法是非常有必要的。"
"DFIG的电路框图如图2所示，其定子连接与电网和网侧变换器之间，转子接转子侧变换器和Crowbar电路。 定转子电压和磁链向量可以表示为： (1) (2) (3) 图1. 风电场低电压穿越要求 图2. 含Crowabr的双馈风电机组结构图 上式中 和 分别是双馈定转子电压， 和 分别是定转子的电阻， 和 分别是定转子的自感， 是互感， 和 分别是定转子的自感， 、 和 分别是同步电角速度、转子角速度和转差角速度，所有参数均归算至转子侧。所以定转子电流可写成： (4) 如果电压跌落在t 0 时刻，则定子磁链可表示为： (5) 上式中，p代表跌落后电压与正常电压的比例系数， 的大小由跌落后电压大小决定， 为定子磁链直流分量，它将随着定子时间常数 衰减，且 。 转子磁链可表示成： (6) 其中， 、 分别是电网电压跌落发生瞬间转子磁链直流分量和由定子励磁产生转子磁链交流分量的初始值。转子磁链的直流分量会随转子时间常数 衰减，且 。 为了研究电网发生短路故障时Crowbar保护过程中定转子流过的故障电流变化情况，作以下假设[ 9 ] ： 1) 电网电压发生故障立即切除转子侧变换器，同时接入Crowbar电路； 2) 电网电压发生跌落故障瞬间，风电机组以同步速运行； 3) 电网电压发生跌落故障前，风电机组向电网输出额定有功； 4) 三相电网电压瞬间骤降为零。 在电网电压跌落时，定子电流动态响应为： (7) 其中， 是定转子漏抗和， 是电压跌落后定子磁链初值， 。 因为激磁电感远大于漏电感，所以可以认为定转子电感值相等，定转子电流峰值也可认为相等，即： (8) 当投入Crowbar保护后，双馈电机T型等效电路如图3所示。 Crowbar电阻阻值一般比定、转子电阻大得多，所以定转子侧的等效阻抗可表示为： (9) (10) 式中， ，由此可计算出定子时间常数和转子时间常数为： (11) (12) 图3. 双馈风力发电机T型等效电路 结合上面式(9)-式(12)，定、转子电流在电压跌落过程中的瞬时值为： (13) 由上式可得，当Crowbar阻值增大时，定子时间常数比转子时间常数大得多，所以上式第二项衰减迅速，可近似认为定转子故障电流最大值为： (14) 由式(14)可以看出，Crowbar阻值越大，相应的故障电流大小越小。 一般来说，电网故障时，电压大部分是部分程度的电压跌落，而并没有跌落至零，此时双馈机组以 转速运转，这时定转子电流可表示成： (15)"
"当电网故障且Crowbar投入时，若转子线电压不超过直流母线电压，故障转子电流将完全流经Crowbar电阻。虽然考虑到机组短时承受过压、过流能力较强，但也应将最大故障转子电流限制在一定范围内，以限制故障时的瞬态电磁转矩对机组转轴系统的冲击[ 10 ] 。另外，较大的故障电流必然要求较大的IGBT的电流容量，增大系统的成本。因此，应将最大故障电流限制在一定范围之内，即： (16) 由上式可得Crowbar电阻选取的最小范围： (17) 根据上式，Crowbar电阻选的越大越好，但较大的Crowbar阻值将产生较大的转子绕组电压。当转子线电压的峰值大于直流母线电压值 时，转子电流将经转子侧变换器对直流母线电容充电，有可能损坏直流母线电容。在实际中，为防止Crowbar电阻较大造成转子侧过压及对直流母线电容反充电，则需满足： (18) 由此可得出Crowbar电阻选取的最大值选取范围： (19) 因此，Crowbar阻值的选取要同时满足式(17)及式(19)。一般来说，故障时期转子电流 不超过故障前转子电流的2倍，直流母线电压不超过正常直流母线电压的1.5倍，据此可以确定模糊隶属函数的范围。  当转子电流为额定值时，通过公式(17)获得的Crowbar阻值 ，此阻值下对模糊集的隶属度为1；当转子电流达到正常电流2倍时，取通过公式(17)计算得到的Crowbar阻值 的隶属度为0；在a - b区间内隶属度从0线性上升至1， 为当Crowbar电阻从a到b对应的模糊隶属函数，其表达式如式(20)所示。 (20) 同理，当直流母线电压为额定值时，此时通过公式(19)计算得到的Crowbar阻值 隶属度为1；当直流母线电压达到额定电压1.5倍时，取此时计算得到的Crowbar阻值 的隶属度为0；在c - d区间内隶属度从1线性下降到0，其表达式如式(21)所示。 (21) 通过式(20)、(21)把Crowbar电阻的约束方程转化为模糊隶属度函数，图4所示分别为转子电流约束和直流母线约束表达式对应的隶属函数图。 在双馈风电机组Crowbar电阻选取时，在同一坐标下，通过选择两个隶属度的交点，如图5所示。用此方法来确定Crowbar阻值 ，这样的选取方法可以最大程度上兼顾两个约束条件，获取最大满意度，从而最大程度上保护风电机组，实现低电压穿越的目的。 图6为根据双馈风电机组电阻选取约束条件，基于模糊隶属函数的Crowbar设计流程图，其步骤为： 1) 获取额定运行条件下双馈风电机组参数和电压电流参数，包括定转子电阻和漏感、定转子额定电流、额定直流母线电压等参数； 2) 在电网故障下，建立包含Crowbar电路的双馈机组等值电路模型； 3) 推导得出转子侧电流、直流母线电压与Crowbar阻值的约束关系式； 4) 根据模糊控制原理中隶属度函数概念建立两个约束方程式的模糊隶属函数 ，然后在同一坐标下确定两个隶属度函数的交点； 5) 在此点处取得的Crowbar阻值，在最大程度上兼顾了转子侧电流不超限也不使得直流电容过压。"
"将本文的方法用于双馈风力发电机Crowbar电阻设计中。采用的双馈发电机仿真参数如表1。 图4. Crowbar电阻的模糊隶属度函数 图5. Crowbar阻值选择图 图6. Crowbar电阻设计流程图 在0.5 s时电网电压发生三相对称跌落，跌落到额定电压的60%，系统检测到电压跌落立即投入Crowbar保护电路。当转子电流为额定值时，通过公式(17)获得的Crowbar阻值 ，此阻值下对模糊集的隶属度为1；当转子电流达到正常电流2倍时，取通过公式(17)计算得到的Crowbar阻值 的隶属度为0；在0.44~1.13区间内隶属度从0线性上升至1， 为当Crowbar电阻从0.44到1.13对应的模糊隶属函数。 同理，当直流母线电压为额定值时，此时通过公式(19)计算得到的Crowbar阻值 隶属度为1；当直流母线电压达到额定电压2倍时，取此时计算得到的Crowbar阻值 的隶属度 为0；在0.23~1.44区间内隶属度从1线性下降到0。 把Crowbar电阻的约束方程转化为模糊隶属度函数，分别得到转子侧电流约束和直流母线约束表达式对应的隶属函数图。在双馈风电机组Crowbar选取时，通过选择两个隶属度的交点，用此方法来确定Crowbar阻值 。图7所示为在采用该Crowbar电阻阻值的情况下，转子电流和直流母线的变化情况。在电压跌落瞬间，转子电流和直流母线电压迅速增大，但在Crowbar保护的作用下逐渐衰减，并维持到一个安全的转子电流和直流母线电压值，表2为分别采用0.75 p.u.和0.90 p.u.时得到的转子侧电 Table 1 参数 数量 额定容量(kVA) 1 额定频率(Hz) 50 极对数 2 定子侧漏感(p.u.) 0.07 转子侧漏感(p.u.) 0.03 定转子互感(p.u.) 2.15 额定电压(V) 380 直流母线电压(V) 700 表1. DFIG电机参数 Table 2 Crowbar电阻(p.u.) 转子侧电流幅值(p.u.) 直流母线电压最大幅值(V) 0.82 1.78 762 0.75 1.81 755 0.90 1.73 769 表2. 不同Crowbar电阻下的DFIG仿真数据 图7. 在设计Crowbar电阻下的DFIG仿真曲线 流和直流母线电压最大幅值，可以看出采用这样的选取方法可以最大程度上兼顾两个约束条件，获取最大满意度，从而最大程度上保护风电机组，实现低电压穿越的目的。"
"本文根据双馈风力发电机组故障转子电流、直流母线电压和Crowbar电阻的关系式，基于模糊隶属度的方法提供了一种Crowbar电阻优化设计方法，最后通过仿真验证了本设计方法的有效性。本方法得到的结果弥补了当前双馈风电机组Crowbar电路阻值选取时的不精确和效率不高的缺点，并具有较强的可操作性。"
