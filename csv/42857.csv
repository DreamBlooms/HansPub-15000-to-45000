"鉴于强制进化随机游走算法概率接受差解策略的两面性，一方面会出现差解代替仍有进化潜力的解，打断个体可能存在的进化路径，另一方面进化后期个体变异能力仍不够强，难以跳出局部最优值，提出了一种双种群变异策略。在基础种群之外，设置了2个特殊种群，周期性地接受基础种群中对应个体的当前最优解，并分别对特殊种群中个体进行接受差解概率的差异化处理，在周期结束回赋基础种群个体的最优值。通过算例验证，将改进后算法应用于换热网络优化，取得了较好的结果。"
"换热网络综合作为过程系统工程的重要领域，在实现能量综合利用的过程起到重要的作用 [ 1 ]。夹点法等分步优化法被广泛应用于工程应用领域，将换热网络优化分步为最小公用工程用量和最小换热单元数等数个子问题，这些子问题存在多个最优解，又相互影响，如果不能正确反映子问题的相互关系，即使通过分步求解使各子问题达到最优，整体问题上也很难寻找到最优解。为解决此问题，提出了同步优化方法。 常见的同步优化方法主要分为确定性方法和启发式方法 [ 2 ]，确定性方法在处理换热网络这类MINLP问题时极易陷入局部最优值，而启发式方法全局搜索能力强 [ 3 ]，且不依赖问题本身的数学性质，是处理这类问题时的较优方法 [ 4 ] [ 5 ] [ 6 ]。肖媛等 [ 7 ] 于2016年提出了新的启发式方法，强制进化随机游走算法(RWCE)，该算法通过个体换热量的随机游走变化，同步优化整型变量和连续变量，并在优化过程中完全切断种群中各个个体之间相互影响，保证个体结构进化不受其他个体的影响，使算法拥有较强的全局搜索能力 [ 8 ]。 RWCE算法在游走后的个体结构的年综合费用未能优于上一代个体费用时，仍以较小的概率选择接受差结构，是算法提高跳出局部极值能力的重要支柱。但一方面，个体接受差解容易出现个体被打断自身的优化进程，未能完全优化就被差解所替代，使得局部精细搜索不足 [ 9 ]。另一方面，当达到进化后期时，原有的接受差解几率不够高，结构的变异能力不够强，仍然无法跳出局部最优解。鉴于此，本文提出了一种采用双种群变异策略的RWCE算法，既保护原有个体结构的进化潜力，也增强个体跳出局部最优值的变异能力。"
"换热网络模型采用分级超结构模型 [ 10 ]，以年综合费用最小为优化目标。费用主要包括换热器的设备投资费用和冷热公用工程的运行费用，数学描述为 min T A C = min ∑ i = 1 N C     C C U Q C U , i + ∑ i = 1 N H     C H U Q H U , i + ∑ i = 1 N E ( C 0 + C ′ 0 A i β )   + ∑ i = 1 N C ( C 1 + C ′ 1 A C U , i β ) + ∑ i = 1 N H ( C 2 + C ′ 2 A H U , i β ) (1) 式中，C是费用计算系数，Q是换热器的换热量，A是换热器换热面积。等式右侧，前两项计算的是公用工程运行费用，后三项计算的是换热器的投资费用。换热器换热量及换热面积计算依据换热器热平衡公式。 Q i , j , k = G C p i ( T i , k i n − T i , k o u t ) = G C p j ( T j , k o u t − T j , k i n ) (2) A i , j , k = Q i , j , k U i , j Δ t i , j , k (3)  1) 单股流体上的热平衡 ( T I N , i − T O U T , i ) ⋅ G C p i = ∑ m ∈ B H ( i )     Q i , m + Q C U , i (4) ( T O U T , j − T I N , j ) ⋅ G C p j = ∑ n ∈ B C ( j )     Q j , n + Q H U , j (5) 2) 可行出口温度 t e I N , i , m − t e O U T , j , n ≥ Δ T min (6) t e O U T , i , m − t e I N , j , n ≥ Δ T min (7) 3) 冷热公共工程的热平衡 ( t e O U T , i , B H ( i ) − T O U T , i ) F i = Q C U , i (8) ( T O U T , j − t e O U T , j , B C ( j ) ) F j = Q H U , j (9)"
"RWCE算法的主要流程如下。 1) 初始化种群：设置一个初始种群，个体数目为N。赋予个体中每个换热单元随机换热量，其换热量大小按式(12) Q 1 , s = Q max ∗ ε ,   ε = 1 , 2 , ⋯ , N s (10) 式中，Q max 为最大换热量，ε是一个 ( 0 , 1 ) 区间内的随机数。N s 为每个个体包含的最大换热器个数。 2) 个体进化： 按式(13)对种群中各个个体进行更新 Q 1 , s = Q + ( 1 − 2 α ) ∗ β ∗ Δ L ,     i = 1 , ⋯ , N s ;   s = 1 , ⋯ , N s (11) 式中，α和β为 ( 0 , 1 ) 区间内的随机数，Q为上一代个体换热单元换热量，ΔL为随机游走步长。 当进化后个体中的换热器换热量 Q i + 1 , s ≤ Q min 时，则令该位置的换热器换热量为0，Q min 为可保留的最小换热量。 3) 个体选择：计算进化后个体的年综合费用，若进化后的年综合费用较优，则用进化后新个体取代原个体，并返回步骤(2)，否则进入步骤(4)。 4) 个体变异：进化后个体以一定概率δ接受差解，仍以进化后新个体取代原个体，并返回步骤(2)。当迭代步数达到最大迭代步数，迭代结束。"
"RWCE算法在个体选择阶段时，若游走后的个体结构的年综合费用未能优于上一代个体费用，仍以较小的概率选择接受差结构，其目的在于提高整型变量的变异概率，扩大搜索域，促进整体结构的变异能力，从而提高RWCE算法的全局搜索能力。接受差解概率的取值需要同时兼顾提高整型变量的变异能力和连续变量的连续性进化，不宜过大或过小。在原算法中单一固定的接受差解概率取值，往往难以兼顾两点。如果继续沿用RWCE算法中的进化流程，一方面使用较大的接受差解概率会出现差解代替仍具有进化潜力的换热网络结构，导致原有个体结构未能达到最优结构就被打断优化进程，使得局部搜索不充分；另一方面，如果使用较小的接受差解概率，在进化前期仍能快速优化，但到了进化后期，个体的变异能力不够强，优化进程仍然易于陷入局部最优解中。 为更好分析其情况，下面以文献 [ 13 ] 中10股流算例为例，算例参数如表1所示。参数如下：种群规模N = 25，最大换热量Q max = 800 kW，最大游走步长L = 50 kW。 Table 1 Stream Tin/℃ Tout/℃ W/kW·˚C −1 H1 85 45 156.3 H2 120 40 50.0 H3 125 35 23.9 H4 56 46 1250 H5 90 86 1500 H6 225 75 50.0 C1 40 55 466.7 C2 55 65 600 C3 65 165 180 C4 10 170 81.3 HU 220 198 - CU 15 20 - 表1. 10股流算例参数 从种群中选取23号个体，观察它的费用迭代曲线，从中选取一段费用迭代曲线如图1所示。可以发现，当该个体优化至一较优结构后，未能再深入进化自身的优化潜力，就在之后的进化中因接受差解，不但很难回到此较优结构，甚至可能向着较差的方向游走下去。 图1. 23号个体费用迭代曲线 针对这一问题，如果仅仅使接受差解概率为0，不接受差解，那么又容易导致个体陷入局部最优解，仍然难以得到一个较优的结果。如图2所示，在同参数下，将接受差解概率设置为0和0.01，所得的最小年综合费用迭代曲线对比。可以看出，当种群个体不接受差解时，费用下降到5,640,047 USD/A后，优化的进程就极为缓慢，个体的难有变异能力，陷入局部极值中难以跳出，最终优化出的结果也较差。相反，选择接受差解的优化结果要远远优于前者。但即使如此，但费用继续下降时，进化仍然陷入停滞中。这是由于进化后期，种群团聚现象严重，种群多样性缺失，此时需要加强个体的变异能力，提高其接受差解的概率。但因为换热网络优化属于复杂的混合整数非线性问题，由个体自动识别当前优化进程，动态调整接受差解概率，这是很难实现的。为此，本文提出了双种群变异的策略，既保护个体的进化潜力，也提高个体的变异能力。 图2. 接受差解概率为0和0.01时的费用迭代曲线  采用双种群变异策略的RWCE算法的算法流程图如图3所示。其主要思路为在基本种群之外，设置两个独立的特殊种群，这两个种群个体号与基础种群中个体号对应，在迭代步数达到周期时，将基础种群中的个体当前最优结构复制到特殊种群的对应个体中。三个种群的接受差解概率执行差异化处理。特殊种群1的接受差解概率为0，即禁止个体接受差解，最大程度挖掘个体的进化潜力。特殊种群2的接受差解概率为0.03，提高个体的变异能力，破坏其原有结构，提高其跳出局部极值的能力。这3个种群平行进化，互不干涉，直至个体产生出新的最优解，才重新回代至各个种群的对应个体。改进后的算法主要流程如下： 1) 种群初始化：设置3个规模相同的种群。按式(14)赋予基本种群初始换热量，步骤与RWCE算法相同。 2) 个体游走：种群个体按式(15)执行随机游走，若迭代步数达到周期，将基础种群个体赋值到特殊种群中执行随机游走。 3) 个体选择：如果个体游走之后的年综合费用更低，则将个体的结构更新。个体每一次更新，都将此结构输入到3个种群的对应个体中。 4) 个体变异：个体游走之后的个体结构较差，仍以一定几率δ接受此结构，其中基本种群δ设为0.01，特殊种群1的δ为0，特殊种群2的δ为0.03。迭代步数达到最大迭代步数，结束迭代，输出最优结构。 图3. 算法流程图  以20sp算例为例，采用改进后的双种群变异并行策略的RWCE算法得到的年综合费用与原算法的费用迭代曲线如图4所示。 图4. 费用迭代曲线 分析上图可以看出，采用双种群变异并行策略的RWCE算法可以得出比原RWCE算法更优秀的结果。在整个进化过程中，特殊种群发挥了极其重要的作用，特别是进化后期，新产生的全程最优解大多数都是由特殊种群中的个体进化而来。计算整体优化进程中在各种群中产生全局最优解的次数，在普通种群中产生全局最优解的次数较少，由于延用RWCE算法相同的算法流程，主要起到“筛选优秀种子”的作用，在达到周期时，向特殊种群提供有充分进化潜力的个体。特殊种群1执行保护策略，由于其不接受差解，加快进化速率，在进化前期起到的作用更大，在整个进化过程中起领头作用，并且保护个体的进化进程不被打断，达到充分进化，在局部精细搜索能力方面更强，是算法获得更优解的关键。特殊种群2执行破坏策略，在优化过程中产生的全程最优解次数最多，其使用较大的接受差解概率，提高个体的变异能力，其易使有潜力的结构被差解替代的缺陷也可以由其他两个种群补足，从而进一步加强算法的全局搜索能力。"
"将采用双种群变异策略的RWCE算法应用于换热网络分级超结构模型，选取10股流算例和9股流算例，均取得较好的结果。  算例1采用10股流算例，具体参数见表1。改进策略的RWCE算法优化后所得的换热网络结构如图5所示，优化后的年综合费用分别为5,583,749 USD/a，与文献结果对比如表2所示。 图5. 优化后结果示意图 Table 2Ref. Cold utility/kW Hot utility/kW TAC/USD·a −1 Ravagnani et al. [ 10 ] 14,924 20,529 5,672,821 Yerramsetty et al. [ 11 ] 15,140 20,745 5,666,756 Khorasanya et al. [ 12 ] 14,000 19,606 5,662,366 He et al. [ 13 ] 14,246 23,117 5,629,953 Xiao et al. [ 14 ] 14,614 20,219 5,629,748 Peng et al. [ 15 ] 14,734 20,339 5,596,079 This work 14,624 20,230 5,583,749 表2. 算例1结果对比 与文献结果相比，采取双种群变异策略的年综合费用下降明显，较之文献结果降低了11,066 USD/A。  算例2为文献中9股流算例，其相关物流参数如表3所示。算法中采用的参数均与上例相同，种群规模N = 25，最大换热量Q max = 800kW，普通种群接受差解概率δ = 0.01，特殊种群1不接受差解，特殊种群2接受差解概率δ= 0.03，最大游走步长L = 50 kW。 Table 3 Stream Tin/℃ Tout/˚C W/kW·˚C −1 H/kW·m -2 ·˚C −1 H1 327 40 100 0.5 H2 220 160 160 0.4 H3 220 60 60 0.14 H4 160 45 400 0.3 C1 100 300 100 0.35 C2 35 164 70 0.7 C3 85 138 350 0.5 C4 60 170 60 0.14 C5 140 300 200 0.6 HU 330 250 - 0.5 CU 15 30 - 0.5 表3. 9股流算例参数 采用双种群变异策略的RWCE算法优化后的换热网络结构如图6所示，其年综合费用2,926,008 USD/a，与文献结果对比如表4所示，优化结果已优于文献现有结果。在整个优化进程中，共计产生1046次新的全局最优解，其中由普通种群中产生的次数为133次，由特殊种群1中产生的次数为579次，由特殊种群2中产生的次数为334次，各种群在优化进程中所发挥的作用均符合4.3节中的分析。 图6. 9sp算例优化结果 Table 4Ref Cold utility/kW Hot utility/kW TAC/USD·a −1 Linnhoff et al. [ 6 ] 33,030 25,310 3,024,932 Linnhoff et al. [ 16 ] 32,760 25,040 2,992,494 Lewin et al. [ 17 ] 33,410 25,690 2,945,122 Peng et al. [ 15 ] 32,292 24,572 2,942,013 Chen et al. [ 18 ] 31,001 23,272 2,932,737 Peng et al. [ 15 ] 32,215 24,495 2,935,112 This work 32,391 24,672 2,926,008 表4. 算例2结果对比"
"1) 分析RWCE算法中概率接受差解策略的两面性，一方面会体接受差解容易出现个体未能完全优化就被差解所替代，精细搜索不足；另一方面，进化后期以原有的接受差解概率，个体的变异能力不够强，全局搜索能力仍不够强。 2) 本文提出了采用双种群变异并行策略的RWCE算法，在基础种群之外，设置了2个特殊种群，接受基础种群对应个体的当前最优解，分别对这两个特殊种群中个体进行保护和加大变异能力，提高了算法搜索进化能力。 3) 将采用改进策略的RWCE算法应用于换热网络分级超结构模型，用2个算例验证改进后算法优化能力更强，结果好于多数文献结果。"
