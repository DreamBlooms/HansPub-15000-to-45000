"发动机电控系统复杂程度高、开发周期长、标定变量多，导致发动机电控系统的标定数据管理难度大。本文结合研发过程中的故障案例阐述了发动机电控系统标定开发过程中对标定数据管理的基本原则和一般方法，指出严谨规范的标定数据管理在发动机电控系统项目开发过程中具有十分重要的意义。该方法同样也适应用于车辆复杂控制器软件开发匹配过程中的数据管理。 关键词 :电控系统，标定，数据管理 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"电控系统在车用发动机和非道路发动机上的应用随着排放及油耗法规的加严已经呈普及之势；而且，发动机电控系统复杂程度越来越高、需标定(调校)的参变量越来越多、开发周期也越来越长。作为一个发动机电控系统的开发匹配，在系统硬件配置及参数基本定型后，如何通过电控系统参数的标定来达到系统性能的工程目标就成为项目是否成功的关键。标定数据文件作为发动机电控系统匹配开发的最终交付物，如何行之有效的进行管理。本文将结合具体案例就其一般管理要求和方法进行阐述。"
"1) 在某车型实车评审过程中，评审人员发现发动机故障灯常亮：连接电脑设备读取故障码发现为氧传感器报信号合理性故障；读取发动机电控单元(ECU)数据版本号确认其为最新数据版本，氧传感器诊断标定已完成；经和负责OBD标定工程师对ECU数据进行比对确认，其提交的氧传感器标定DCM文件并未体现在该ECU最新数据版本中；ECU数据重新集成该DCM后进行刷新，故障灯熄灭。因此，该故障灯点亮应该是由DCM数据集成遗漏导致。 2) 在某车辆驾驶性评审中，评审人员反馈在部分油门TIP IN/TIP OUT时车辆耸动比较明显。经整车标定工程师对测量数据文件进行分析，以及检查ECU标定数据，发现ECU标定数据中防抖动(ASD)控制模块中一个开关变量未打开；更新ECU数据后重新测试，部分油门TIP IN/TIP OUT驾驶感觉有明显改善，达到可接受水平。经追查数据变更记录，发现此变量在前期ECU软件升级过程中未被正确赋值。 以上两个案例说明了在发动机电控系统开发匹配过程中，标定数据的管理不善将导致整车性能受到影响；如果标定数据的谬误迟迟未被发现，将导致项目后续开发过程中的标定工作都是基于错误的基础在进行，给项目带来的损失将不可弥补。下文将重点阐述对标定数据管理的原则和方法。"
"发动机电控系统的核心是电子控制单元(ECU)及嵌入其中的软件系统组成；ECU软件系统又由Software Code (软件代码)和Calibration Data (标定数据)组成(如图1)。它的物理表现形式通常为.HEX\.S19\.Ulp文件和.a2l文件。 本文提及的标定数据管理实际上是指包含已调校过标定数据的ECU软件管理，其包含了电控系统开发过程中ECU的软件版本升级管理和标定变量值管理；在软件版本固化后，其工作重点就集中在标定变量值的管理。"
"标定数据的首要属性就是ECU软件版本，其决定了电控系统能够实现的控制功能和定义了可调校的标定变量。同时，它也决定了标定数据的文件大小和ECU存储区的分配使用。 图1. ECU软件组成构架 [ 1 ] 图2. 标定变量的基本属性 标定变量作为标定工作的直接载体，是标定数据管理的最小单位。其基本属性定义如图2所示。 在ASAM AE Calibration Data Format v.2.0.0中，还定义了标定数据的Quality State (成熟度，如表1所示)和Owner (责任人)属性(基于PaCo V2.1 standard of MSRSW)。 同一功能模块的标定变量的属性定义有时也会发生变化，导致不同版本的ECU软件往往差异较大。发动机电控系统标定主要就是针对ECU软件中Calibration Data部分的标定变量进行调校以设定最优参数值。"
"发动机电控系统的开发匹配涉及面广、开发周期长，需要跨部门、跨公司、跨国团队的合作(如图3所示)；为满足现有法规要求，ECU软件的标定变量数量早已是数以万计。这些都对标定数据的管理提出了严峻的挑战。 为了确保开发团队基于同一基础数据开工作，做到精准的分工协作，标定数据管理须满足以下一般要求： 1) ECU软件版本管理。可以提供ECU软件版本的变更树形图，不同版本的软件留有归档文件(旧版本自动冻结)，标定变量的增减变化清晰明了； 2) 标定变量的管理。可以提供标定变量的责任人、当前标定成熟度，当前Value\Curve\MAP的在线显示及更改； 3) 标定数据更改权限的设定。可以根据项目中不同的角色定义设置不同的访问权限，标定变量只接受责任工程师提交的更改。 4) 数据变更、释放的审批流程设定。不同阶段的标定数据变更需要有不同的审批责任人，数据的变 Table 1 数值/标定成熟度 定义 changed 变量发生了变化(值，公式，…)，需额外评审 --- 软件默认值 prelimCalibrated 离线标定完成 Calibrated 台架、车辆完成 Checked 标定优化完成 completed 数据可支持批产 表1. 质量元数据状态 [ 2 ] 图3. 电控系统开发组织架构 [ 3 ] 更或释放必须得到相关责任人的许可。 5) 标定数据的存储必须安全可靠。必须是一个项目组成员都可以方便访问的网络终端，坚决杜绝数据的意外丢失、删除、篡改等现象，建议使用服务器冗余存储。 6) 标定数据的安全检查。数据上传至服务器后，能按照先前设置好的安全规则对标定数据中的关键变量进行基本的检查，最大限度地减少数据发放潜在风险。 标定数据的管理在项目的不同阶段工作重点不同。在项目前期，ECU软件功能定义尚未最终冻结，ECU软件版本升级频繁，此时的数据管理的重点放在软件控制逻辑的检查确认和标定变量的增减变化管理上；在项目中后期，ECU软件功能定义基本冻结，ECU软件版本升级频次减少，电控系统的标定工作也已开展过半，此时数据管理的重点放在标定变量设定值的变化管理上。"
"发动机电控系统的匹配标定周期长、试验费用高，最终的交付物为标定成熟的标定数据。因此，对标定数据的管理直接关系到项目的成功与否。必须确保所有的标定数据更改都是由正确的人员提交，避免不同人员提交数据更改导致前后覆盖现象的发生，同一个标定变量被的更改必须得到相关功能小组(Function Group)的评审和确认，标定数据释放前须经过责任工程师的驾驶性评价及功能性检查。 在发动机电控系统开发匹配全过程中，标定数据差异的管理和溯源始终是标定数据管理的核心。要求做到每一个变量值的更新都有支撑，每一版数据变化都能追溯到发起人、审核人。在项目进行中，标定数据的更新、发布渠道永远只有一个，标定数据的DCM文件在集成发布前必须经过实车测试、评价及相关责任工程师层层审核。 根据项目组织架构设置，标定团队各成员承担着不同的标定数据管理角色(通常由标定团队内的数据管理专员来分配设置)。数据的阶段性评审可以通过邀请各Function Group内的专家组成评审委员会来进行。结合笔者多年的标定项目管理经验，标定数据更新的管理流程推荐如图4所示。"
"标定数据的管理内容多、跨度长、要求高，如完全依靠手工则低效且容易出错，也无法满足管理信息化的要求。因此必须借助专门的数据管理工具软件。目前市面上比较常见的有AVL CRETA、VECTOR VCDM，国内天津大学和潍柴也在进行相关工具的合作开发。 标定数据的管理方法、流程和各开发单位的项目组织架构密切相关，不同公司之间存在着千差万别。因此，要求标定数据管理工具软件在人员角色定义、数据释放流程审核、检查规则的设置上有着较高的灵活性。同时标定数据管理工具的用户界面必须要简洁明了、容易上手，能迅速在项目团队内部推广开来使用。有研究表明，数据管理在整个电控系统标定开发过程中的耗时占比达到51% (如图5)。因此，通过科学的管理方法和工具提高标定数据管理的准确性和有效性对缩短项目周期亦很有意义。 成熟的商业数据管理软件大多价格昂贵，基于VB宏自主开发EXCEL数据管理工具在项目管理中也会经常被用到，诸如软件版本管理、标定数据成熟度、数据更新差异对比等等。其好处在于应用方便、配置灵活、且成本较低，但需要对A2L文件格式、软件功能模块划分有比较深入了解。"
"综上所述，发动机电控系统标定数据管理直接关系着电控系统匹配标定的最终交付物是否真实有效，对项目的顺利进行和如期交付有着保驾护航的重要意义。当前在电控系统匹配标定项目中，普遍存在着重标定试验、轻数据管理的现象，这必将导致大量的无用功和潜在的数据失效风险。因此，通 图4. 标定数据更新管理流程 图5. 标定项目时间评估 [ 4 ] 过规范的流程、科学的方法和信息化工具切实有效地提高标定数据管理水平在当前具有十分的必要性和紧迫性。"
