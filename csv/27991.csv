"本文将以青岛西海岸新区商品房价格为例，针对商品房价格呈现动态变化的特点，利用改进的GM (1, 1)模型与马尔可夫模型结合，提出一种基于时间序列的预测模型，对青岛西海岸新区的商品房价格进行预测。根据灰色GM (1, 1)模型适合对数据量较少、波动不大的短期数据进行预测，而马尔可夫模型适用于数据波动较大的预测过程的特点，通过结合改进的GM (1, 1)模型与马尔可夫模型的优点，建立房价指数的预测模型。实验结果表明，该模型的拟合精度较高，是一种较为可行的房价预测模型。 关键词 :GM (1, 1)模型，多项式拟合，马尔可夫模型，预测，房价 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"青岛西海岸新区位于山东省青岛市西岸，是由国务院于2014年6月同意批复的我国第九个国家级新区，并于27年2月入选国家重大市政工程领域PPP工作创新重点城市。与此同时，青岛西海岸新区的商品房价格也随着西海岸新区经济的飞速发展而持续飙升，房地产市场也出现供不应求的局面，引起了社会各界的广泛关注。如何有效的预判房价的走势，也成为人们心中十分关心的问题。 房价指数和影响其变化的各经济变量之间的定量关系，很难以某种常规的数学函数模型进行描述，时间序列是目前较为可行的方法之一 [ 1 ] 。商品房市场可以看作一个灰色系统来处理，GM (1, 1)预测模型是灰色系统理论的重要组成部分，是把时间序列转化成微分方程的建模过程 [ 2 ] ，主要适用于时间短、数据少、波动性不大的预测问题。马尔可夫模型是利用概率建立的一种随机型时序模型预测方法，它将时间序列看作一个随机过程，通过对事物不同状态的初始概率和各状态间的转移概率的研究，确定状态变化趋势，以预测事物的未来 [ 3 ] 。灰色预测模型与马尔可夫模型的优点可以相互补充，灰色模型用于揭示预测数据的发展趋势，马尔可夫模型用于确定状态间的转移规律。对不平稳的随机过程，可以通过部分改进方法对模型进行改进，对数据进行平滑处理，以降低波动。最终将三者结合起来，为随机波动较大的预测模型提供一种新的方法，以提高随机波动性较大的数据列的预测精度。"
"灰色系统建模是以灰色模块为基础，将无规律的原始数据进行累加，得到规律性较强的生成序列，建立基于最小二乘法的指数拟合曲线 [ 4 ] ，再将由生成模型得到的数据进行累减，得到原始数据的预测值。 假设原始序列数据为： X ( 0 ) = ( X ( 0 ) ( 1 ) , X ( 0 ) ( 2 ) , X ( 0 ) ( 3 ) ⋯ X ( 0 ) (n) ) 一次累加生成序列为： X ( 1 ) = ( X ( 1 ) ( 1 ) , X ( 1 ) ( 2 ) , X ( 1 ) ( 3 ) ⋯ X ( 1 ) (n) ) 其中： X ( 1 ) ( i ) = ∑ ( k = 1 ) i X ( 0 ) ( k ) , i = 1 , 2 , 3 , ⋯ , n 均值生成序列为： Z ( 1 ) = ( Z ( 1 ) ( 2 ) , Z ( 1 ) ( 3 ) ⋯ Z ( 1 ) (n) ) 其中： Z ( 1 ) ( k ) = X ( 1 ) ( k ) + X ( 1 ) ( k − 1 ) 2 , k = 2 , 3 , ⋯ , n 则将： X ( 0 ) ( k ) + α ⋅ Z ( 1 ) ( k ) = b 称为GM (1, 1)模型的基本形式 [ 5 ] 。  由于 X ( 1 ) 是基于时间t的序列，具有基于时间序列的变化规律，因此对 X ( 1 ) 建立关于时间t的一阶线性微分方程，得到： d x ( 1 ) ( k ) d t + α x ( 1 ) ( k ) = μ (1) 其中：α称为发展灰度，反映了累加生成序列 X ( 1 ) 的发展趋势；μ称为内生控制灰度，反映了数据间的变化关系。 由于灰色模型适用于离散型数据，所以我们利用均值生成序列 Z ( 1 ) 代替累加生成序列 X ( 1 ) ，得到： d x ( 1 ) ( k ) d t + α z ( 1 ) ( k ) = μ 又因为： d x ( 1 ) ( k ) d t = X ( 1 ) ( k ) − X ( 1 ) ( k − 1 ) 1 , k = 2 , 3 , ⋯ , n 所以将式(1)离散化后得： X ( 1 ) ( k ) − X ( 1 ) ( k − 1 ) + α z ( 1 ) ( k ) = μ , k = 2 , 3 , ⋯ , n (2) 利用最小二乘法求解式(2)，得到： [ α μ ] = ( B T B ) − 1 B T Y 其中： B = [ − z ( 1 ) ( 2 ) 1 − z ( 1 ) ( 3 ) ⋮ − z ( 1 ) ( n ) 1 ⋮ 1 ] Y = [ x ( 0 ) ( 2 ) x ( 0 ) ( 3 ) ⋮ x ( 0 ) ( n ) ] 求得α和μ后，继续求解微分方程(1)得： X ^ ( 1 ) = c e − α t + μ α (3) 其中： X ^ ( 1 ) ) 是 X ( 1 ) 序列的预测值序列，c为待定系数 将式(3)离散化，得到： X ^ ( 1 ) ( k + 1 ) = c e − α k + μ α , k = 0 , 1 , 2 , 3 , ⋯ n − 1 (4) 为求待定系数c的值，假设 X ^ ( 1 ) ( 1 ) = X ( 1 ) ( 1 ) = X ( 0 ) ( 1 ) ，则有： X ^ ( 1 ) ( 1 ) = c + μ α = X ( 0 ) (1) 可得： c = X ( 0 ) ( 1 ) − μ α 。 将c带入式(4)得： X ^ ( 1 ) ( k + 1 ) = ( X ( 0 ) ( 1 ) − μ α ) e − α k + μ α k = 0 , 1 , 2 , 3 ， ⋯ ， n − 1 (5) 式(5)表示基于微分方程生成的离散的累加预测值序列。 对式(5)做累减还原，即可得到原始序列 X ( 0 ) ) 的灰色预测值序列： X ^ ( 0 ) ( k + 1 ) = X ^ ( 1 ) ( k + 1 ) − X ^ ( 1 ) ( k ) , k = 1 , 2 , 3 , ⋯ , n − 1 (6) 将式(5)带入式(6)得： X ^ ( 0 ) ( k + 1 ) = ( X ( 0 ) ( 1 ) − μ α ) e − α k ⋅ ( 1 − e α ) (7) 式(7)即为灰色GM (1, 1)预测模型得到的最终预测值序列。  马尔可夫模型表示数学中具有马尔可夫性质的随机的基于时序的建模过程，所谓马尔可夫性质是指对于随机过程 { x n , n T } (T表示时刻的集合)和离散状态集 I = { i 1 , i 2 ⋯ } ，对于任意n T，其条件概率满足： P { x n + 1 = i n + 1 | x 0 = i 0 , x 1 = i 1 , ⋯ x n = i n } = P { x n + 1 = i n + 1 | x n = i n } 即某一时刻t系统处于状态i的概率，只与其前一个时刻的状态有关，与过去的状态无关，该性质称为马尔可夫属性。  马尔可夫模型状态区域划分：构造以中心上下对称的等宽条形带为拟合曲线 Y ^ ( k ) ，时间变化不影响各条形带宽度，每个条形区域代表一个状态 [ 6 ] ，其任一状态区间Q i 表示为 Q i = [ Q 1 i , Q 2 i ] 。 其中： Q 1 i = Y ^ ( k ) + A i 、 Q 2 i = Y ^ ( k ) + B i 且 A i = a i y ¯ , B i = b i y ¯ ， y ¯ 表示原始数据的均值，a i 、 b i 为常数。一般地，状态取灰色模型拟合曲线为中心的上下对称等宽条形带 [ 1 ] 。  将数据序列划分为若干状态，记为 { E 1 , E 2 , ⋯ E n } ，每个条形区域代表一个状态。 记：数据序列在时刻m的状态为E i ，经过m + k时刻状态转移到E j 的概率为 P i j ( k ) ，且满足： P i j ( k ) = m i j ( k ) M i m i j ( k ) 表示状态E i 经过k步转移到状态E j 的次数，M i 为状态E i 出现的总次数。 以状态转移概率 P i j ( k ) 为元素的矩阵，称为马尔可夫模型的k步状态转移概率矩阵，其满足每行 P ( k ) 之和为1 [ 7 ] 。 P ( k ) = | P 11 ( k ) P 12 ( k ) P 21 ( k ) P 22 ( k ) ⋯ P 1 n ( k ) ⋯ P 2 n ( k ) ⋮ ⋮ P n 1 ( k ) P n 2 ( k ) … ⋮ … P n n ( k ) |  若当前系统处于状态Ei，此时Pij描述了状态Ei经过一步转向状态Ej的可能性 ( j = 1 , 2 , ⋯ n ) 。按照最大概率原则，选择 { P i 1 , P i 2 , ⋯ P i n } 中最大者对应的状态，即当 P i j = max { P i 1 , P i 2 , ⋯ P i n } 时，可以预测系统下一步转向状态Ej。当系统状态确定了以后，也就确定了预测值的状态区间 Q i = [ Q 1 i , Q 2 i ] ，则其预测值可以用该区间的中位数来表示 [ 8 ] 。"
"谢乃明等 [ 4 ] 已经证明，GM (1, 1)模型的预测误差主要是由于将式(1)离散化得到式(2)过程造成的。为了改善GM (1, 1)模型的性能，降低模型的拟合误差，由此衍生出很多改进方法。田红霞 [ 9 ] 利用二次多项式拟合的方法，可以提高GM (1, 1)模型的预测精度；李瑶等 [ 10 ] 使用模糊集理论建立动态GM (1, 1)模型提高了模型的预测精度；刘呈玲等 [ 11 ] 利用弱化算子处理法也可以提高GM (1, 1)模型的预测精度。本文将基于多项式拟合法，分别利用多种不同多项式，对模型进行拟合，并最终比较选择最优方法，应用于本次实验。 改进过程: 先利用GM (1, 1)算法建立原始灰色预测模型,得到系统预测值序列，然后分别用不同拟合方法对生成的预测数据与原始实际值进行拟合修正，减小由数据离散化过程带来的系统误差，并以皮尔逊相关系数作为衡量模型拟合效果好坏的评定标准,最终选用拟合效果最佳的方法改进GM (1, 1)模型，建立改进的GM (1, 1)模型。 经实验验证，不同拟合方法拟合效果对比如下： 1) 传统GM (1, 1)算法： 预测模型为： X ( 0 ) ( t + 1 ) = ( 1 − e − 0.02092 ) ⋅ ( 10.437 − 11.4556 − 0.02092 ) e 0.02092 t 相关系数 c o r r c o e f = 0.94968753 2) 利用二次多项式拟合改进： 拟合模型为： Y ( x ) = 0.12538 X 2 + 11.428837 X − 0.707217 相关系数 c o r r c o e f = 0.92035854 3) 利用三次多项式拟合改进： 拟合模型为： Y ( x ) = 0.010056 X 3 − 0.115960 X 2 + 13.023698 X − 3.16889 相关系数 c o r r c o e f = 0.9447651 4) 利用四次多项式拟合改进： 拟合模型为： Y ( x ) = − 0.000504 X 4 + 0.0182631 X 3 − 0.2263819 X 2 + 1.383664 X + 9.4540461 相关系数 c o r r c o e f = 0.95699527 5) 利用指数多项式拟合改进： 拟合模型为： Y ( x ) = 14.5871851128 ⋅ e − 0.420828817852 x 相关系数 c o r r c o e f = 0.79140786 6) 利用对数多项式拟合改进： 拟合模型为： Y ( x ) = 1.7297367 + log ( x ) + 10.13768756 相关系数 c o r r c o e f = 0.88990066 由于随着n次多项式次数的增高，高次项的系数会变得非常小，即模型的拟合程度与高次项的相关性很低，因此本实验不再进行更高次数的多项式拟合。 上述实验数据表明，四次多项式拟合模型的皮尔逊相关系数最接近于1，表明该模型拟合程度最高，因此我们利用该四次多项式对GM (1, 1)算法进行改进，然后在利用改进后的GM (1, 1)算法进行后续工作。"
"本文选取安居客网址提供的2017年3月至2018年5月青岛市西海岸新区月平均房价为原始数据，并以此除以1000得到实验所需初始数据： Table 1 时间 真实值 GM预测值 相对误差 真实值 改进GM预测值 相对误差 2017.3 10.437 10.437 0.00% 10.437 10.629 −1.84% 2017.4 11.67 11.797 −1.09% 11.67 11.454 1.85% 2017.5 12.311 12.046 2.15% 12.311 12.020 2.36% 2017.6 12.855 12.301 4.31% 12.855 12.407 3.49% 2017.7 13.067 12.561 3.87% 13.067 12.681 2.95% 2017.8 13.192 12.827 2.77% 13.192 12.898 2.23% 2017.9 12.824 13.098 −2.13% 12.824 13.102 −2.17% 2017.1 12.693 13.375 −5.37% 12.693 13.323 −4.96% 2017.11 12.885 13.657 −5.99% 12.885 13.580 −5.39% 2017.12 13.357 13.946 −4.41% 13.357 13.879 −3.91% 2018.1 13.856 14.241 −2.78% 13.856 14.217 −2.60% 2018.2 14.42 14.542 −0.85% 14.42 14.575 −1.07% 2018.3 14.981 14.849 0.88% 14.981 14.923 0.39% 2018.4 15.59 15.163 2.74% 15.59 15.221 2.36% 2018.5 16.049 15.484 3.52% 16.049 15.415 3.95% 皮尔逊系数 0.94968 0.956995 表1. GM (1, 1)模型与改进的GM (1, 1)模型数据对比 X (0) = (10.437, 11.670, 12.311, 12.855, 13.067, 13.192, 12.824, 12.693, 12.885, 13.357, 13.856, 14.420, 14.981, 15.590, 16.049 ) 利用改进的GM (1, 1)算法建立预测模型，并用于本次实验(实验数据如表1所示)。 GM (1, 1)模型与改进的GM (1, 1)模型，对原始实际数据的拟合效果如图1所示： 图1. GM (1, 1)模型与改进的GM (1, 1)模型拟合效果对比 并以此模型得到的2018年6月份得数据预测值为15.439，还原得到青岛市西海岸新区2018年6月份的月平均房价预测值为：   根据改进的GM (1, 1)模型输出的预测值与实际数据的偏差，进行状态划分。基于表1可以看出，实验所得的相对误差范围为：−5.39%~3.95%，我们对此范围进行状态区间划分。状态区间的划分并无严格要求，但当数据量较小时，状态区间划分数量较小为宜。本实验中，我们依据上述实验误差范围，将状态均匀划分为4个区间，划分结果如表2所示。  根据状态区间分布，建立改进的灰色–马尔可夫模型状态转移概率分布矩阵： P ( 1 ) = [ 2 3 1 3 1 4 1 4 0 0 1 4 1 4 0 0 0 1 6 0 1 0 5 6 ] P ( 2 ) = [ 1 3 2 3 1 4 0 0 0 1 4 2 4 0 0 1 5 1 5 0 1 0 3 5 ] P ( 3 ) = [ 0 2 3 0 0 1 3 0 0 1 0 0 2 5 1 5 0 1 0 2 5 ] 一步转移概率矩阵 二步转移概率矩阵 三步转移概率矩阵 Table 2 真实值 改进GM预测值 相对误差 状态区间 10.437 10.629 −1.84% 2 11.67 11.454 1.85% 4 12.311 12.020 2.36% 4 12.855 12.407 3.49% 4 13.067 12.681 2.95% 4 13.192 12.898 2.23% 4 12.824 13.102 −2.17% 2 12.693 13.323 −4.96% 1 12.885 13.580 −5.39% 1 13.357 13.879 −3.91% 1 13.856 14.217 −2.60% 2 14.42 14.575 −1.07% 2 14.981 14.923 0.39% 3 15.59 15.221 2.36% 4 16.049 15.415 3.95% 4 表2. 状态区间划分 由于2018年5月份数据系统状态处于4状态，并且经过比较，状态4的1、2、3步状态转移概率如表3所示： Table 3 状态区间1 状态区间2 状态区间3 状态区间4 一步转移概率 0 1 6 0 5 6 二步转移概率 1 5 1 5 0 3 5 三步转移概率 2 5 1 5 0 2 5 合计 0.6 0.567 0 1.834 表3. 状态转移概率 所以当系统状态处于区间4时，下一步最有可能的转移情况是转移到状态4，我们用状态区间4误差范围的中位数代表该区间的平均误差，区间4的误差范围是(1.61%~3.95%)，中位数为2.78%，所以我们用此中位数作为马尔可夫模型对改进的GM (1, 1)的修正系数，修正之后的数值为 15.439 1 − 2.78 % = 15.880 经过还原得到最终由改进的灰色–马尔可夫模型预测的2018年6月青岛市西海岸新区商品房的月平均房价为15.880*1000 = 15880元/m 2 。"
"本文以传统灰色GM (1, 1)预测模型为出发点，对青岛市西海岸新区商品房价格的预测问题进行了初步分析，然后利用多项式拟合的方法，对由传统灰色GM (1, 1)模型得到的数据进行平滑性修正，最后再结合马尔可夫链的特点，利用状态转移概率矩阵，对改进的GM (1, 1)预测模型得到的预测数据进行稳定性修正，由此降低了系统生成数据的随机性。改进后的灰色–马尔可夫模型既考虑了基于时间序列的数据特点的挖掘，同时又通过后期修正，平滑了原始数据的随机波动性特征，最终得到一个精度较高，适用性较强的基于时间序列预测模型。"
