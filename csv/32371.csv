"西湖凹陷是东海陆架盆地内最大的含油气凹陷，主力烃源岩平湖组为含煤的煤系地层，煤层具有厚度薄、层数多、生烃能力强的特征，而煤层的准确厚度常难以计算。本文利用BP神经网络技术，以实际岩性为学习预测样本，以对煤层响应敏感的测井参数为输入变量，通过对建立的三层BP神经网络模型的训练测试来实现对煤层的识别。结果表明，声波时差、中子和密度对煤层的测井响应最明显，利用BP神经网络技术识别出的煤层数量比原测井解释的煤层数有所增加，能识别出薄煤层，且与实际岩性的吻合度更高。BP神经网络技术可更好地识别钻井剖面中的煤层，尤其是薄煤层，从而更准确地计算出钻井剖面中的煤层厚度，具有良好的准确性和实用性。 关键词 :BP神经网络，识别，西湖凹陷，平湖组，煤层 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"西湖凹陷位于东海陆架盆地东北部，面积逾5万平方千米，沉积厚度超15,000米，是一大型新生代断陷盆地 [ 1 ] [ 2 ] [ 3 ]，油气资源丰富 [ 4 ] [ 5 ] [ 6 ]。多年的勘探研究表明，始新统平湖组是半封闭的海湾环境和温暖–潮湿南亚热带型气候条件下沉积的暗色泥岩、砂岩夹多层薄煤层和碳质泥岩的地层 [ 7 ]。暗色泥岩是凹陷内的主力烃源岩，分布广，厚度大。煤层是凹陷内的另一主力烃源岩，层数多，单层厚度薄，生烃能力强。单层煤层厚度以1米左右为多，大多不超过2米 [ 8 ] [ 9 ] [ 10 ]。单井煤层常有数十层，累积厚度最厚近百米。因煤层单层厚度薄，又因海洋钻井岩屑录井捞样井段较长，加之钻屑细小及岩屑清洗原因，易造成部分薄煤层漏录。而测井解释时因煤层井段垮塌、煤层薄等原因，基于交汇图版的岩性解释方法也可造成薄煤层解释结果不够准确；人工解释时人为因素较大。如此常造成煤层厚度统计偏小，导致西湖凹陷油气资源量预测不准确，影响油气勘探决策部署。为此，笔者提出了基于多测井参数的BP神经网络技术识别煤层，以期从更高的精度、更快地刻画平湖组煤层，为评价西湖凹陷油气资源潜力提供扎实的基础资料。 人工神经网络理论是一门应用领域非常广泛的交叉学科。由于人工神经网络具有良好的自适应与自学习、大规模并行信息处理等特点，因此利用神经网络解决复杂非线性动态系统的预测问题就有了一条新的有效途径，具有重要的理论意义和实际应用价值，BP算法是人工神经网络中重要的一种学习算法 [ 11 ]。基于BP神经网络(BPNN)的预测方法在油气行业也有广泛应用，如储层预测、油气层预测、烃源岩评价等。应用好BP神经网络技术的前提是选择学习样本、选好输入端参数，并建立起合适的预测模型。下文就此进行阐述。"
"位于西湖凹陷西斜坡的P1井钻遇的平湖组为砂泥岩夹薄煤层(图1)，在凹陷内具有较好的代表性。我们计划以此井为研究样井，以其钻遇的岩性作为学习训练的样本，并据井中的煤层选出BP神经网络输入端参数。从图1可见，砂泥岩及煤层在自然电位(SP)、自然伽马(GR)、深侧向电阻率(RLLD)、密度(DEN)和声波时差(AC)等常规测井曲线上有较大的差异。砂岩在测井曲线上较易识别，泥岩与煤层通常也较易区分。泥岩具有“两高四低”的特征，即高密度、高自然伽马、低中子、低声波时差、低电阻率、低自然电位。煤层为“三高三低”，即高自然伽马、高中子、高声波时差、低密度、低电阻率、低自然电位。鉴于P1井平湖组上–中段岩性辨识度较好，以此井测井综合解释的岩性结果作为学习及预测的训练样本较为理想。 图1. P1井平湖组上段(部分)岩石测井特征 为了使BP神经网络计算收敛速度快、干扰小，对输入信号的裁剪是非常有必要的。煤层是本项研究的目标，因此，我们选择对煤层识别成功率高的测井参数作为输入端参数。为此，我们借助二维参数图版分析法，对P1井平湖组上–中段岩性的测井响应进行了统计分析(图2~5)。从图2~5中可以看出，密度、声波时差、中子对煤层的区分度较大，可将大部分煤层区分开来，仅部分煤层与泥岩重叠，而剩余几种测井参数都几乎无法将煤层与砂岩泥岩区分开来。 图2. P1井平湖组上–中段岩性GR-DEN数值交汇图 图3. P1井平湖组上–中段岩性RT-AC数值交汇图 图4. P1井平湖组上–中段岩性CN-CAL数值交汇图 图5. P1井平湖组上–中段岩性AC-SP数值交汇图 对图中单一测井参数识别煤层的成功率进行统计也表明(表1)，识别煤层最有效的是声波时差(AC)和中子(CN)，次为密度(DEN)、自然伽马(GR)和深侧向(LLD)，对煤层响应最不明显的是井径(CAL)和自然电位(SP)。本着全面、综合选用输入参数的原则，本次选择声波时差、中子、密度、自然伽马、深测向电阻率和井径为本项神经网络输入端参数。 Table 1 测井曲线 AC CN DEN GR LLD CAL SP 识别成功率(%) 76.1 75.7 53.2 29.4 11.5 5.4 3.9 表1. P1井平湖组上中段单个测井属性对煤层识别成功率统计表"
"人工神经网络最重要的是它不需要一个固定的数学公式，通过向样本学习获取知识并改进自身性能是它的一个重要特性。BP神经网络是一包含输入层、隐含层和输出层的多层网络，如图6所示，能很好地解决输入与输出间复杂的非线性关系。输入层有n个输入节点(神经元)，输出层有m个输出节点，隐含层有Y个节点，上、下层之间各神经元实现全连接，即上下层的每个节点都实现权联结，而每一层各神经元之间无联结 [ 12 ] [ 13 ]。 图6. BP人工神经网络原理示意图 BP人工神经网络模型训练过程实际上是对一组样本逐个进行输入、输出计算，网络将一系列输入进行连接权重加权，经隐层处理后传到输出层。输出的结果如与期望结果有误差，则误差将从输出层向输入层反向传播，在反向传播过程中重新调整各层间连接权及各层神经元偏差，再进行迭代计算，使误差逐渐缩小。反复的信息正向传播和误差反向传播是各层连接权重不断调整的过程，也是神经网络学习训练的过程。该过程一直到输出的结果符合要求为此 [ 12 ] [ 13 ]。 利用测井资料解释地层各种特性实际上是解决一个映射问题，即解决由n维输入向量(测井信息)到m维输出向量(岩性)之间的映射 [ 14 ]。采用神经网络模式识别岩性必须事先确定足够多的岩性类别，用大量的样本进行训练 [ 15 ] [ 16 ] [ 17 ]。根据以上原理，我们设计了三层神经网络预测模型，并以前文研究确定的对煤层测井响应敏感的六个参数作为输入端，建立了如图7的神经网络预测模型。依据以上预测模型，采用梯度下降算法，利用P1井平湖组上–中段地层岩性进行训练，直至训练结果符合要求。 图7. 煤层BP神经网络识别模型示意图 首先对选用的测井曲线做归一化处理。归一化的公式为： X = ( x − x min ) / ( x max − x min ) × 100 式中x为实际测井值，x max 、x min 为本条测井曲线所有采样点中的最大值和最小值，而X则为归一化后的测井值。 神经元初始权值用(1,0)和(0,1)分别代表煤层和非煤层2种结果，根据西湖凹陷实际情况设置训练初始参数为：学习步长d = 0.7，动量参数a = 0.1。设定学习次数为4000次，要求系统误差达到0.01，网络训练1126次后收敛，实际系统误差达到0.009。 利用训练好的神经网络模型，对西湖凹陷内的P2井进行煤层识别以进一步验证可靠性。从验证结果可见(图8)，原测井解释相对较厚的煤层，BP神经网络方法均能准确识别(BPNN煤)，对应性高。从图中还可见，神经网络识别出的薄煤层层数有所增加，部分煤层的解释厚度与前人综合解释的结果相比也有所增加。这也正是因为神经网络技术综合利用了多测井参数，发挥了测井数据高分辨率特性的优势。利用BP神经网络识别技术对凹陷内的P2井平湖组煤层进行识别的结果表明，该方法使用便捷，识别煤层的准确度高，可适用于西湖凹陷其他井区，并为其它地区识别煤层提供借鉴。 图8. P2井平湖组BP神经网络识别煤层结果对比图"
"1) 识别煤层最有效的是声波时差和中子，次为密度、自然伽马和深侧向，井径和自然电位对煤层的响应不是很明显。 2) 利用三层BP神经网络预测模型及对煤层测井响应相对敏感的六项参数作为输入端数据可识别出薄煤层，与实际岩性的吻合度高。 3) 建立合理的神经网络模型，选取合适的训练样本是提高预测精度的关键。优选出对样本敏感的测井响应参数，才能更快更好地获得符合客观实际的预测结果。"
