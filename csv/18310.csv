"针对采用机理分析方法得到的煤发热量存在响应速度迟缓、变负荷时动态误差大的问题，提出一种基于状态观测器的动态补偿方法。依据单元机组负荷–压力模型，由汽包压力和汽轮机一级压力构造锅炉总热量信号，采用一高阶惯性环节描述锅炉给煤量与总热量信号之间的动态关系。针对此高阶惯性环节设计状态观测器，得到具有较小惯性的中间状态信号，利用此信号除以给煤量得到煤发热量信号。实验结果表明：动态补偿后的煤发热量具有抗扰动性好、响应速度快的优点。 关键词 :煤发热量，软测量，状态观测器，动态补偿"
"近年软测量在火电厂热工参数测量中得到广泛应用，如烟气流量、飞灰含碳量软测量等等。软测量定义为：通过一定的数学方法，寻找与待测量变量相关的辅助变量，建立辅助变量与待测量变量之间的数学模型，进而得到对待测变量的最佳估计。一些通过机理分析结合数据拟合得到的软测量结果在稳态工况下使用没问题，但在动态工况下往往存在巨大的动态误差。目前大型机组都参与电网调峰及一次调频，机组负荷变化频繁，有必要研究软测量动态补偿方法，以提高测量的快速性、减小动态误差。杜文莉等人针对静态软测量无法反映工业过程的动态信息这一问题，提出一种基于最小二乘支持向量机和自回归–滑动平均模型的软测量建模方法，对静态模型增加动态校正环节，实现了对静态模型的动态校正，以改善系统动态响应特性 [ 1 ] 。文献 [ 2 ] 利用互补滤波器将计算再热蒸汽流量的稳态公式和动态公式在频域内进行融合，得到的再热蒸汽流量不仅在机组稳态时准确度高还可以快速地反映再热蒸汽流量的变化。郭喜燕等人通过分析机组非稳态过程中烟气传递给受热面的热量的分布，加入锅炉蓄热补偿得到的煤耗量在非稳态时与实际更加接近 [ 3 ] 。文献 [ 4 ] 利用机组负荷–压力动态模型得到的煤发热量实时计算模型考虑了动态补偿，计算出来的煤发热量在负荷变化时波动很小，煤质变化时响应速度更快。 热工对象往往具有大惯性、大迟延，利用状态观测器将对象中惯性小、响应速度快的中间状态进行重构，可以实现状态反馈控制，提高系统响应速度 [ 5 ] ，也可以利用状态观测器构成软测量系统实现重要参数在线测量 [ 6 ] 。这里研究一种基于状态观测器的热工参数软测量动态补偿方法，即利用重构的中间状态作为参数软测量中的辅助变量，对待测参数进行动态补偿，改善热工参数软测量的动态特性。煤质变化剧烈是当前影响火力发电机组稳定运行的一个主要因素，实现煤发热量的动态测量具有重要意义。现以煤发热量软测量为例，通过分析现有机组负荷–压力简化模型，将制粉及炉内燃烧简化为一高阶惯性环节，据此设计状态观测器，重构出具有快速响应的中间状态信号，利用此信号进行动态补偿，能够有效解决煤发热量软测量响应慢及动态误差大的问题。"
"正常工况下，煤发热量Q ar (MJ/kg)计算方法 [ 4 ] ： (1) 式中：Q b 为锅炉总热量(MW)；u B 为机组总给煤量(kg/s)。 典型机组一般采用皮带称重式给煤机，u B 由各个给煤机给煤量求和得到。根据能量平衡原理，采用以下公式得到Q b ： (2) 式中：Q 1 为锅炉汽水系统有效吸热量(MW)；Q 2 为锅炉排烟总焓(MW)；q 3 为可燃气体未完全燃烧热损失(%)；q 4 为固体未完全燃烧热损失(%)；q 5 为锅炉散热损失(%)；q 6 为灰渣物理热损失(%)。 文献 [ 7 ] 给出一系列求Q 1 ，Q 2 等中间变量的公式，代入公式(2)，求得Q b ，得到控制所需的煤发热量信号。 公式(1)在静态工况下使用是没有问题的，但在机组变负荷时，直接用公式(1)会出现巨大的动态误差。例如升负荷时，煤发热量没变，给煤量首先增加，经过给煤机、磨煤机、一次风粉管道后进入炉膛燃烧释放热量，经汽水系统吸收表现为蒸汽流量、压力变化，锅炉总热量要经过一段时间才达到稳定，导致给煤量与燃料总热量在时间上的不一致，计算出来的煤发热量在这段时间降低。另外当煤质真正变化时，由于制粉惯性和蓄热惯性，计算的煤发热量响应时间较长，不能及时反映煤质变化。针对这些问题，研究一种基于状态观测器的动态补偿方法，以提高其变负荷时的抗扰动性及变煤质时的动态响应速度。"
"以二阶对象为例，设被控对象传递函数如下： (3) 式中，U(s)为给煤量的拉氏变换(kg/s)；Y(s)为总热量的拉氏变换(MJ)；T b 为对象惯性时间(s)；K为对象增益(MJ/kg)，在实际过程中可能发生变化。 对象中存在两个状态变量，离输入最近的状态响应必然快于输出响应。给对象补偿一个惯性环节 ，其中 ，系统输出几乎不受影响，补偿后被控对象等效为： (4) 根据式(4)设计状态观测器，将重构小惯性状态 置于最靠近输入的位置，那么 对输入的响应必然快于输出对输入的响应。Wojechowsky [ 8 ] 最先提出单入单出时不变系统的PI观测器，使得状态观测器不仅可以用到当前状态，还可以利用过去的状态，受此启发，设计状态观测器时引入PID结构，如图1。图1中PID、g 2 、g 3 为状态观测器的误差校正环节，调整该环节的参数可使重构状态快速无静差的逼近真实状态； 为给煤所含的热量(MJ)；K'为直接由输出除以输入得到的对象增益(MJ/kg)；K''为利用重构状态 除以输入得到的增益(MJ/kg)。 以T b = 100，T s = 1，K = 16为例进行两种情况下的仿真：t = 250 s时输入变而增益不变如图2曲线a所示；在t = 1250 s时增益变而输入不变如曲线b所示。Y(s)如曲线c所示， 如曲线d所示，K'如曲线e所示。由于对象存在大惯性，K'在给煤量变化时动态误差大，实际增益变化时动态响应慢。 状态观测器误差校正环节的参数确定：首先采用极点配置方法确定K p 、g 2 、g 3 ，得到最靠近输入且惯性小的重构状态 ；然后根据得到的K''的仿真曲线，不断调整PID参数及g 2 、g 3 ，直到K''的响应速度、动态误差及静态误差都满足控制要求为止，如图2曲线f所示。最终确定误差校正环节的参数为：K p = 2100，K i = 500，K d = 5000，g 2 = 900，g 3 = 50。由曲线f可知，加入动态补偿后的增益，其动态特性明显改善，更接近于K的真实情况。 图1. 基于状态观测器的增益软测量动态补偿模型 图2. 增益软测量动态补偿仿真曲线  设计低通滤波器对动态补偿后的K进行滤波，要求滤波器能够消除输入量变化时造成的扰动。 研究选用的是中值限速滤波方法——先进行限速滤波再进行中值滤波。中值滤波和限速滤波均具有低通滤波特性，其中，中值滤波具有完全消除尖峰脉冲(脉冲长度小于滤波器宽度)和完全通过阶跃和斜坡的特点；限速滤波器由非线性速率限制环节构成，具有低通滤波性随输入幅值的变大而变强和快速消除尖峰脉冲的特点。 中值限速滤波器的滤波长度N = 3，一个信号为原始信号，另外两个为原始信号经过限速滤波后的信号，依靠经验选择速率限制分别为±0.25、±0.125。图2曲线g为滤波后的增益，K lv 表示。可以看出，无论是输入变化还是增益变化，动态补偿后的增益经过滤波，抗输入扰动性和动态响应速度均有显著改善。"
"根据现有的机组负荷–压力简化非线性模型给出了Matlab中simulink模型图，如图3所示。图中，u B 为给煤量(kg/s)；τ为制粉过程的迟延时间(s)；K f 为燃料动态时间(s)；r B 为锅炉燃烧率(kg/s)；K 1 为燃料增益(MJ/kg)；Q b 为锅炉总热量(MW)；μ T 为汽轮机调门开度(%)；K 2 为过热器阻力系数；C b 为锅炉蓄热系数；P d 为汽包压力(MPa)；P t 为机前压力(MPa)；P 1 为汽轮机一级压力(MPa)；K 3 为汽轮机调门指令增益；P 0 为蒸汽做功(MW)；K t 为汽轮机动态时间(s)；N e 为机组负荷(MW)。 文献 [ 4 ] 给出了煤发热量与机组负荷–压力简化模型中的燃料增益K 1 的关系： (5) 式中，Q ar 为煤发热量(MJ/kg)，η u 为机组发电效率，可由机组设计的负荷–发电煤耗曲线确定，这样煤发热量仅与K 1 相关，求得K 1 即可知煤发热量。 由图3可知，机组负荷–压力简化的非线性模型主要分为三个动态部分 [ 9 ] ：以给煤量u B 为输入、锅炉总热量Q b 为输出的制粉及炉内燃烧过程(虚线框部分)；以汽轮机调门开度μ T 和锅炉总热量Q b 为输入、机前压力P t 和蒸汽做功P 0 为输出的双入–双出系统；以蒸汽做功P 0 为输入、机组负荷N e 为输出的汽轮机动态过程。与燃料增益K 1 直接相关的状态变量是u B 、r B 和Q b ，这些变量均存在于制粉及炉内燃烧过程，如果Q b 可以测量，则该过程就可以从负荷–压力被控对象中分离出来，成为一个以给煤量为输入、锅炉总热量为输出的单入–单出系统。 由图3得锅炉总热量信号构造公式： (6) 式(6)得到的Q b 静态精度高但动态性差，文献 [ 10 ] 构造的风量–氧量热量信号Q fo 动态特性好但静态精度差，将Q b 与Q fo 进行融合，构造出研究所需的锅炉总热量信号如式(7)所示： (7) 式中：q a 为锅炉总风量(Nm 3 /s)；O 2 为锅炉排烟氧量(%)；K aq 为煤空气热量比(Nm 3 /MJ)，对于大部分煤种近似为0.263；T 0 为滤波器的惯性时间(s)，决定了滤波截止频率和带宽，目前主要靠经验选取。 联立式(6)~(7)得到了更接近实际的锅炉总热量，煤的制粉及炉内燃烧过程就简化为单入–单出环节。 图3. 机组负荷–压力非线性简化模型 采用上节思路，对此环节设计状态观测器。  对于带有纯迟延环节的系统设计状态观测器时，往往是先用高阶惯性代替纯迟延。人们建立图3的模型时为了避免繁琐的高阶结构，进行了适当的简化，其中制粉动态特性简化为纯迟延和一阶惯性。实际上，用高阶惯性描述制粉系统的动态过程更能模拟实际动态过程。 结合图3，给出制粉及炉内燃烧释放热量的高阶惯性描述： (8) 式中，T 1 表示煤在给煤机和一次风粉管道的动态时间(s)；T 2 为煤粉在炉膛内停留及燃烧的动态时间(s)； 为磨煤机动态时间(s)。 据此设计的状态观测器模型及燃料增益软测量动态补偿模型如图4所示。图中 为直接由燃料总热量除以总给煤量得到的燃料增益(MJ/kg)， 为基于状态观测器动态补偿后得到的燃料增益(MJ/kg)。"
"现以660 MW机组的负荷–压力非线性模型为例，进行基于状态观测器的煤发热量动态补偿方法验证。模型中各个参数为τ = 23，K f = 189，K 1 = 19.1，K 2 = 0.000122，K 3 = 0.537，K t = 12，C b = 7690。图3中制粉及炉内燃烧部分(虚线框)的锅炉总热量是可测的，那么虚线框部分就从模型中分离出来成为一个单入单出系统。利用响应曲线的方法，求得制粉系统高阶惯性描述中的参数为：T 1 = 8.13，T 2 = 1， 。根据式(8)设计状态观测器，将极点配置为[−1, −1, −1, −1]，首先确定K p 、g 2 、g 3 、g 4 ，再加入K i ，K d 并进行适当调整，加快重构状态逼近真实状态的速度，确定各个参数为：K p = 0，K i = 4000，K d = 0，g 2 = 2000，g 3 = 1000，g 4 = 4。最后进行滤波，滤波器采用3.2节的中值限速滤波。 图5中 为直接由燃料总热量除以总给煤量得到的燃料增益(MJ/kg)， 为基于状态观测器动态补偿后得到的燃料增益(MJ/kg)。在两种工况下进行仿真：t = 500 s时给煤量变化而燃料增益不变如图5曲线a所示；t = 1500 s时燃料增益由19.1 MJ/kg变为18.1 MJ/kg而给煤量不变如曲线b所示。直接用锅炉总热量除以给煤量得到的燃料增益如曲线c所示，可知在输入变化时存在较长时间的动态误差，燃料增益变化时响应较慢；加入动态补偿后得到的燃料增益如曲线d所示；经过滤波得到的燃料增益如曲线e所示，具有较小动态误差和较快动态响应速度。 图4. 基于状态观测器的煤发热量软测量动态补偿模型  在某600 MW机组为例，利用其运行过程中的历史数据，计算出实际的煤发热量总热量。将其作为状态观测器模型中的输入，在DCS中以组态方式实现补偿逻辑，观察各种工况下经过补偿和未经补偿的煤发热量软测量结果。 图6为机组变负荷工况下软测量结果对比，可以看出，动态补偿后得到的煤发热量经过负荷修正，基本不受负荷变化的影响，具有较好的抗负荷扰动性能。而未经补偿的煤发热量计算值，升负荷时偏低，降负荷时偏高。 在现场进行煤质变化实验非常困难，这里采用等效模拟实验方法进行验证，其思路是：保持总给煤量不变，人为减少锅炉总热量，模拟煤发热量突然降低的情况。减少锅炉总热量的做法：以式(8)所示的 图5. 基于状态观测器动态补偿的煤发热量仿真曲线 图6. 变负荷工况下计算煤发热量 图7. 模拟煤质变化工况下计算煤发热量 图8. 启/停磨工况下计算煤发热量 制粉及炉内燃烧释放热量动态过程为模拟对象，根据发电负荷曲线选择一段稳定负荷运行的工况，在t = 500 s时改变对象中的燃料增益，将式(8)的输出加入噪声修正后作为模拟所需的锅炉总热量。由图7可以看出，与补偿前相比，补偿后的煤发热量能够快速、准确的反映煤质变化。 图8为机组负荷由380 MW下降至350 MW，期间停一台磨煤机，对应停一层燃烧器情况下计算得到的煤发热量。启/停磨会对锅炉燃烧状态造成强烈扰动，可发现动态补偿后的煤发热量基本不受磨启/停影响，具有很好的抗燃烧扰动能力。"
"本文进行了基于状态观测器的热工参数软测量动态补偿方法研究，并将其应用于煤发热量软测量中，通过实验验证了该方法的可行、有效性。并得到了以下结论： 1) 利用机组负荷–压力简化模型，由汽包压力和一级压力构造锅炉热量信号，并将制粉及炉内燃烧动态过程简化为一个单入单出高阶惯性环节，便于状态观测器设计的同时也更加符合实际情况。 2) 在设计状态观测器时引入了PID结构，实现了对象增益变化后，重构状态仍可以快速、无静差的逼近真实状态。利用观测到的小惯性状态对软测量值进行动态补偿，有效提高了软测量的速度，减小了动态误差。 3) 实验表明，机组负荷变化频繁时，不加动态补偿得到的软测量结果远不能满足机组要求。采用本文动态补偿方法得到的煤发热量结果具有很好的抗负荷扰动和抗燃烧扰动能力，在煤质变化时能够快速、准确的计算出新的煤发热量值，及时反映煤质变化。"
