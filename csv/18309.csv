"荧光显微图像复原有着很多重要的应用，例如，天文成像，电子显微镜成像，单光子发射计算机断层成像术和正电子发射断层成像技术等等。传统基于全变差的分裂Bregman算法能够很好地保护图像边缘和纹理信息，但在图像的平滑区域会产生严重的阶梯效应，针对这一问题，本文提出了一种复原算法，主要考虑两点，一是采用全变差(Total Variation, TV)正则化模型，可以很好地复原模糊图像。二是引入权函数，对TV进行加权抑制阶梯效应，同时保护了图像的纹理信息。通过对参数的合理选择，获得最佳的复原效果，在模拟图像和真实荧光显微图像的实验结果验证了该算法的有效性和可行性。 关键词 :分裂Bregman算法，加权，全变差正则化，图像复原"
"荧光显微镜方法是一种新兴有效的显微镜成像技术，在生物医学研究中，它能够提供活体样本的三维图像 [ 1 ] 。但是，由于成像系统衍射和噪声干扰等 [ 2 ] 因素，荧光显微图像不可避免出现模糊和噪声等退化现象，荧光显微图像的质量通常受两个因素影响：一是由显微光学成像系统的物理限制而导致的模糊，用点扩散函数 [ 3 ] (Point Spread Function PSF)来表征；二是测量工作大多在低光子流的情况下进行，因此会产生泊松噪声。面对这些固有的光学限制，以及对高质量图像的大量需求，用数字图像处理技术去除这些模糊和噪声是一项很有意义的工作。 目前，分裂Bregman算法 [ 4 ] - [ 7 ] 是求解范数最优化问题及其相关优化问题的最有效的方法之一，它是Rudin [ 8 ] 等学者提出的一种基于Bregman距离的迭代正则化算法 [ 9 ] - [ 11 ] ，起初是用于图像去噪，后来Goldstein [ 12 ] 在此基础上提出了分裂Bregman迭代图像复原模型。 Brette等人 [ 13 ] 提出了基于各项同性扩散的目标边缘保护先验知识，即全变差正则化 [ 11 ] 。全变差图像复原是基于变分的思想，把全变差图像复原模型转化为一个偏微分方程求解的过程。目前典型求解方法是根据Wang Yilun、Yang Junfeng等 [ 14 ] 提出的基于变量分离和半二次惩罚函数法的快速全变差反卷积算法 [ 15 ] (Fast Total Variation deconvolution, FTVd)，把图像复原模型看作是一个无约束问题优化求解，实验结果验证了FTVd的有效性和稳定性。Setzer等 [ 16 ] 提出了分裂Bregman算法复原被泊松噪声污染的模糊图像，与其他的图像复原算法相比，它的优点在于不存在内部迭代及迭代过程中不产生负像素值。后来，王静等人 [ 7 ] 提出了基于分裂Bregman方法的全变差图像去模糊算法，首先利用辅助变量及其二次惩罚泛函把全变差去模糊优化问题转化成一个等价的无约束优化问题，然后基于Bregman迭代将其分解为两个子优化问题采用交替最小化方法 [ 15 ] 进行求解，接着根据子问题结构特点，采用离散傅里叶变换及收缩技术实现子优化问题的快速计算。 传统全变差分裂Bregman算法图像去模糊是假设图像在高斯噪声破坏情况下进行的，当图像实际被泊松噪声污染时，该算法虽然能在一定程度上抑制阶梯效应，但是复原效果并不理想，并且在噪声影响过大的情况下，去模糊效果会有所下降。针对图像被泊松噪声污染并且噪声影响过大去模糊效果不理想的情况，本文在传统基于分裂Bregman方法的全变差图像去模糊算法的基础上，引入TV约束模型和权函数，将加权TV约束模型与分裂Bregman方法有效地结合，既可以保留图像的边缘信息，又可以抑制平滑区域的阶梯效应，达到更好的去模糊效果。"
"图像复原就是根据一定的先验知识(如：模糊核)，从已知的的模糊图像复原真实图像，其图像退化的模型如下： (1) 其中，f、u分别是模糊图像和真实图像，K是模糊核矩阵，N是加入的噪声，“ ”表示卷积运算。  假设 和 是关于变量u的凸能量泛函，则关于u的无约束化问题的形式是： (2) 引入辅助变量d，则得到与公式(2)等价的约束优化问题的形式： s.t. (3) 根据变量分离理论，对式(3)加入Lagrange乘子 [ 16 ] ，便可到关于u和d的无约束优化问题: (4) 式中 是惩罚系数， 。基于分裂Bregman理论 [ 7 ] ，引入辅助变量 ，则得到关于u和d及 的迭代更新公式： (5) (6) 利用交替极小化的方法 [ 14 ] ，可分别得到变量u、d的更新公式： (7) (8)  参考文献 [ 6 ] [ 9 ] 保证了算法的收敛性，其证明如下： 假设 和 分别表示 和 的梯度函数， 和 ，根据平均理论有： (9) 其中，D表示Bregman距离， 为对角矩阵， ， ， 是 和 之间的值，故我们可以得到如下的公式： (10) 然后，对公式(10)两边同时乘以 ，其中 ，则公式(10)可以重新表示为： (11) 最后，对公式(11)两边同时减去f，我们可以得到公式(12)： (12) 根据以上的讨论，我们可以得到分裂Bregman算法是收敛的。"
"传统全变差分裂Bregman算法是假设图像在高斯噪声破坏的情况下进行的，当实际图像被泊松噪声破坏时，该算法虽能在一定程度上抑制阶梯效应，但当存在很大的泊松噪声时，复原效果并不理想，针对这种情况，本文提出一种新算法，即引入加权的全变差约束模型，来抑制阶梯效应，同时也保存了图像的纹理，得到了很好的复原效果。  在本文中，提出了引入加权全变差约束模型，根据变量分离理论和分裂Bregman算法，进行荧光显微图像复原。则公式(1)的目标函数如下： (13) 其中， ， 表示u在像素i水平方向和垂直方向的一阶有限差分， 表示变量u在像素i处的变差数， 表示对所有的i 求和， 设置为u， 表示t–范数，第二项 是保真项， 是正则化参数， 表示权函数，其表达式是公式(14)所示： , (14) 全变差图像去模糊的问题可以看作是一个无约束问题优化问题。因此，引入辅助变量y，式(13)可以转化为关于u和y的无约束模型： s.t. (15) 添加变量u和y的二次惩罚项，转化为与式(15)等价的关于u和y的最优化问题的模型： (16) 基于变量可分离理论和分裂Bregman迭代，可以转化为求关于u和y两个子优化问题，于是，得到关于变量u和y以及参数 的迭代更新迭代公式： (17) (18) (19) 本文图像复原算法图像边界条件设为周期型边界，K和D均是块循环矩阵。在求解子问题 时，对式(17)中的 求导并且令导数为零，可得到如下形式： (20) 采用FFT及其反变换得到与(17)式等价形式的快速求解u的迭代公式： (21) 式中“*”表示复共轭，“ ”表示分量分式乘积，F、F −1 分别表示傅里叶变换及其逆变换。 求解子问题y，根据式(18)的结构特点，可利用shrink函数求解，其定义如下： (22) 其解的形式为： (23) 其中规定 。 由式(22)和(23)，可得到子问题y的快速更新迭代公式为： (24)  本文算法是假设PSF已知，故可以由快速迭代式(21)得到目标图像 ，然后根据式(24)和(19)更新得到的数值带入到式(21)，最后得到更新后的图像 ，收敛精度tol取经验值 。表1给出了本文算法的具体流程。"
"图像复原的质量评价包括主观评价和客观评价，而主观评价包含了人的视觉特性和心理因素，其评价结果较符合实际观察到的图像质量，但有一定的随意波动性，在实际应用中因过程繁琐并且无法完全重复受到了严重的限制。本文中采用信噪比 [ 14 ] (Signal to Noise Ratio, SNR)作为客观的图像复原质量的标准： (25) 式中M和N分别表示图像长度和宽度上的像素个数，g(i,j)和f(i,j)分别是原始图像和复原图像在点(i,j)处的灰度值，信噪比的数值越大，图像质量越好。"
"为了验证本文算法的有效性，分别使用人工合成的模糊噪声图像和真实的荧光显微图像进行了验证，并且同FTVd-FM算法 [ 15 ] ，传统分裂Bregman算法 [ 7 ] 进行了比较，实验编译环境为Matlab，个人PC机：Inter Core双核，3.60 GHz，4 GB内存。使用SNR作为客观评价方法评价图像复原的质量。  在合成的模糊噪声图像上应用本文算法，图1(a)为合成图像(130 × 130像素)，图1(b)是其对应的退化图像(泊松噪声和模糊)。在我们的实验中采用高斯PSF(大小5 × 5，标准差为1.5)，复原结果如图2所示。 从图2可以看出，FTVd-FM算法存在明显的阶梯效应；传统分裂Bregman算法虽然一定程度上减轻了阶梯效应，但得到的图像边缘仍存在部分阶梯效应；本文算法得到的复原图像阶梯效应得到明显改善。  为了验证算法的有效性和实用性，本文采用了真实的荧光显微图像进行了相关实验。图3(a)是真实观察到的荧光显微图像(512 × 512像素)，由于并未知该图像的具体参数信息，因此，实验时仍然采用人工人工合成图像中的PSF值。 利用人工合成图像实验所得到的相关参数在真实荧光显微图像上进行实验。图3(b)是采用FTVd-FM算法得到的复原图像。从图中可以看出，复原的图像在明显的阶梯效应；图3(c)是使用传统分裂Bregman算法，从图中可以看出，阶梯效应得到了明显的抑制，但是仍然存在部分阶梯效应，影响复原图像的质量。图3(d)是利用本文算法得到的复原图像，从图中可以看出，使用本文算法既有效的抑制了阶梯效应，又保持了图像在平滑区域的光滑性和图像边缘区域的细节信息。 为了更加直观的观察复原结果的细节信息，我们对图3(a)中的黑色矩形框标记的区域进行了放大，图4(a)，图4(b)，图4(c)和图4(d)是分别对应图3(a)，图3(b)，图3(c)和图3(d)中相对应的区域。 Table 1 算法：改进的分裂Bregman图像复原算法 1：输入：观测图像 2：初始化参数： ， ， ， ， ， 3：while do 4：根据第k次迭代得到的图像，由式(21)计算第k+1次迭代的图像 ； 5：根据式(24)计算 ； 6：将步骤1和2中计算得到的 和 带入到式(19)计算的 ； 7：将步骤2和3中计算得到的 和 带入到步骤1中，以此重复直到满足终止条件，计算得到复原结果 ； 8：end while 9：输出：复原的图像 。 表1. 改进的分裂Bregman图像复原算法流程 图1. 合成实验图像(a)原图，(b)退化图像 图2. 图像复原结果(a) FTVd-FM算法(SNR = 45.50 dB)，(b) 传统分裂Bregman算法(SNR = 45.50 dB)，(c) 本文算法(SNR = 49.68 dB) 图3. 真实荧光显微图像图像复原结果；(a) 退化图像，(b) FTVd-FM算法，(c) 传统分裂Bregman算法，(d) 本文算法 图4. (a)图3(a)的局部放大图，(b)图3(b)的局部放大图，(c)图3(c)的局部放大图，(d)图3(d)的局部放大图"
"本文在分裂Bregman算法的基础上提出了一种新的图像复原算法，引入了权函数，通过对TV加权，抑制阶梯效应，提高图像复原效果，同时可以很好地保护图像的纹理信息。通过对参数的合理选择，获得了较好的复原效果。在合成图像和真实的荧光显微图像上的实验结果验证了算法的有效性和可行性，但是需要特别强调的是，在图像的模糊核过大的情况下，本文算法的图像复原效果会有所下降，这将是下一步研究工作中的主要任务。"
