"针对多数语音增强算法中存在的“音乐噪声残留”问题，提出一种新型先验信噪比估计算法。由于先验信噪比的估计准确度决定语音增强系统的整体性能，而融合耦合因子(CC, Convex-Combination)算法是应用最广的先验信噪比估计算法。虽然其实时性强且失真小，但其抑制音乐噪声能力欠缺。为解决这一缺陷，本文将改进先验信噪比估计中的最大似然估计部分，通过融入平滑参数将后验信噪比递归平滑，代替最大似然估计中的后验信噪比。经仿真实验结果证明，所提出的算法相对于CC算法具有更好的音乐噪声抑制能力。 关键词 :语音增强，先验信噪比，融合耦合因子，最大似然估计 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"语音交流是人与人，人与机器之间沟通最方便快捷的媒介之一。但是移动通信过程中总是无法避免地出现由非交流者带来的外界噪音，如各种交通工具产生的交通噪声，工厂设备产生的工厂噪声，电子热噪声，环境噪声等等。正是由于这些形形色色的噪声干扰，使得接收端语音识别系统受到损伤，准确性大大降低，严重影响了语音通信系统的质量和可理解性。因此，在语音处理领域抑制噪声干扰的语音增强技术应运而生，不断受到学者的高度重视 [ 1 ] 。同时，在研究过程的深入渗透下，语音增强算法应用领域广阔延伸，如：移动电话，助听器设备，军事窃听技术，语音编码与合成技术等 [ 2 ] 。 在过去的五十年历史中，为了更好地适应科学领域发展，大量的短时频域语音增强算法已经逐渐衍生出来并得到了广泛应用。其中较为著名的算法有：谱减算法 [ 3 ] 、短时谱估计算法 [ 4 ] 、子空间算法 [ 5 ] 等。由于噪声信号的随机性和非平稳特性，很多算法在真实环境下的运行效果会受到阻碍，因此单声道语音增强算法面临着亟待攻克的问题。众多算法中，经研究发现几乎所有的语音增强算法都与增益因子息息相关，而增益因子又是先验信噪比和后验信噪比的二元函数 [ 6 ] ，由于后验信噪比在算法中是已知参数，因而一个准确的先验信噪比估计在增强结果中扮演着关键性的角色。应用性较广的先验信噪比估计算法有直接判决(DD，Decision-Directed)算法 [ 4 ] ，两步噪声消除(TSNR，Two-Step Noise Reduction)算法 [ 7 ] 、改进的直接判决(MDD，Modified Decision Directed)算法 [ 8 ] ，融合耦合因子(CC，Convex-Combination)算法 [ 9 ] 等。 DD算法由于计算简洁且容易实现，是迄今最为普及的先验信噪比估计算法。由于该算法中纯净语音谱与噪声谱相互正交的不合理假设，以及采用最大似然估计算法估计当前帧先验信噪比过程中在跟踪后验信噪比时引起一帧的时延，使得该算法音乐噪声较大。针对此缺点，后续有人提出一系列改进算法。其中运行效果较理想的是融合耦合因子算法。该算法在DD算法的基础上引入两个不同平滑参数取值的先验信噪比估计，融入一个耦合参数进行调和，在实际和估计的先验信噪比中建立代价函数求出耦合参数真实值，最终得到新的先验信噪比估计值。该算法有效避免了时延问题，能够实时跟踪信噪比的快速变化，同时失真程度大大降低。但是由于该算法在DD算法估计中采用最大似然法对后验信噪比估计，以此代替当前帧的先验信噪比估计。这使得在无语音活动区产生较大波动，输出的语音信号残留孤立峰值居多，继而产生“音乐噪声”。为了解决上述问题，本文将融合耦合因子算法进行改进，用递归平滑的方式计算后验信噪比，代替传统的瞬时后验信噪比并带入最大似然估计中，有效减少了信号的波动，同时音乐噪声抑制能力有所提升。 本文首先介绍了语音增强算法的基本理论，并对经典的融合耦合因子的先验信噪比估计算法进行了理论分析；其次，提出改进算法并做出理论和公式推导；最后，用Matlab进行实验仿真，分析实验结果验证理论部分，并作出总结。"
"在语音信号的短时平稳特性下假设原始纯净语音信号与噪声信号是不相关的，则有 [ 10 ] ： y ( t ) = x ( t ) + d ( t ) (1) 其中， y ( t ) 代表带噪语音信号， 与 d ( t ) 分别表示纯净语音信号和噪声。 对等式两侧分别进行STFT变换，将其转换到频域中： Y m , k = X m , k + D m , k (2) 其中， Y m , k ， X m , k ， D m , k 分别表示为带噪语音谱、纯净语音谱和噪声谱。m和k表示为帧数和频率。 任何语音增强算法均可以表示为增益因子与带噪语音谱的乘积，即为： X ^ m , k = G m , k ⋅ Y m , k (3) 由于不同算法拥有不同形式的增益因子，而只有维纳滤波算法增益因子不受其他参数影响，仅与先验信噪比有关，为了方便且不失一般性，一般采用维纳滤波算法表示的增益因子 [ 11 ] ： G m , k = ξ m , k 1 + ξ m , k (4) 最终结合带噪语音相位对纯净语音谱进行ISTFT变换可以得到估计的纯净语音信号。 先验信噪比估计通常采用DD算法，其定义为： ξ ^ m , k D D = λ ξ ^ m − 1 , k + ( 1 − λ ) ⋅ ξ ^ m , k M L (6) 其中 λ 表示平滑参数，取值范围在0到1之间。 ξ ^ m − 1 , k 表示前一帧先验信噪比估计值， ξ ^ m , k M L 表示最大似然估计下的当前帧先验信噪比，表示为 ξ ^ m , k M L = max { η m , k − 1 , 0 } ， η m , k 为后验信噪比。 由上式可见，该估计值分为两部分：前部分是上一帧的先验信噪比估计值，后部分是当前帧先验信噪比的估计值，平滑参数在两部分中起到调节作用。当取值趋于1时，估计值由上一帧的估计结果决定，会出现帧延迟现象，并带来较为严重的语音失真。取值趋向0时，估计值则主要由最大似然方法的估值决定，此时在静音区波动剧烈，进一步引发音乐噪声。 由此可见，传统DD算法计算简单，能够很好地滤除背景噪音。但由于采用ML算法在追踪后验信噪比时产生一帧的延时，带来恼人的音乐噪声，导致估计效果准确性降低。为此，有学者提出一种融合耦合因子的先验信噪比估计算法，即将平滑参数取大值和小值的优点结合，融入一个耦合参数来达到实时性跟踪。 平滑因子取值分别为a和b (a > b)的两个DD算法估计的先验信噪比分别为： ξ ^ m , k 1 = a ξ ^ m − 1 , k + ( 1 − a ) ξ ^ m , k M L (7) ξ ^ m , k 2 = b ξ ^ m − 1 , k + ( 1 − b ) ξ ^ m , k M L (8) 其中 ξ ^ m , k 1 近似于DD算法对前一帧先验信噪比的估计值， ξ ^ m , k 2 的取值近似于最大似然方法估计的当前帧先验信噪比估计值。在两个先验信噪比中加入一个取值范围在[0,1]之间的耦合因子，控制该算法的估计值取值情况，则CC算法定义如下： ξ ^ m , k C C = μ ξ ^ m , k 1 + ( 1 − μ ) ξ ^ m , k 2 = ( μ a − μ b + b ) ξ ^ m − 1 , k + ( 1 − μ a + μ b − b ) ξ ^ m , k M L (9) 为得到自适应耦合参数，在实际先验信噪比与先验信噪比估计值之间的最小均方误差准则下建立一个代价函数： J = E { ( ξ ^ m , k C C − ξ m , k ) 2 } (10) 通过对代价函数求偏导数并运用最大似然估计方法得到的当前帧的先验信噪比估计代替先验信噪比真实值，得到该耦合参数 [ 12 ] ： μ = ( 1 − b ) ( ξ ^ m , k M L + 1 ) 2 − b ( ξ ^ m - 1 , k − ξ ^ m , k M L ) 2 ( a − b ) [ ( ξ ^ m - 1 , k − ξ ^ m , k M L ) 2 + ( ξ ^ m , k M L + 1 ) 2 ] (11) 将耦合因子带入定义式(9)，可得到CC算法的先验信噪比估计，进一步求出增益因子，与带噪语音谱相乘后再进行IDFT变换即可得到增强后的时域语音信号。该算法通过自适应地结合两个具有不同平滑参数取值的DD算法，有效减少了失真，具有实时跟踪性能。但由于最大似然估计算法对当前帧先验信噪比估计，静音区波动较大，易产生音乐噪声。"
"为解决上述缺点，可以在算法中使用平滑处理的后验信噪比来代替ML算法估计的后验信噪比。由于最大似然估计取决于后验信噪比的值，为了减少快速波动，将后验信噪比估计值进行递归平滑，即为： γ ^ m , k = β ⋅ γ ^ m − 1 , k + ( 1 − β ) ⋅ min [ γ m , k , 20 ] (12) 其中，β代表经验平滑常数，取值为0.6， γ ^ m − 1 , k 表示前一帧的后验信噪比估计值， γ m , k 表示瞬时后验信噪比，即为带噪语音功率谱与噪声谱估计的比值求得，最小值函数是为了限制后验信噪比估计值的上限，最大不能超过13 dB (=10lg(20))，同时避免信号的过度衰减 [ 13 ] 。过去的实验研究发现，后验信噪比的平滑处理了改进了带噪语音功率谱在均方误差意义下的估计 [ 13 ] 。 将平滑处理后的后验信噪比估计值带入ML算法后再代替公式(7)和(8)中的 ξ ^ m , k M L ，即： ξ ^ m , k 1 = a ξ ^ m − 1 , k + ( 1 − a ) γ ^ M L m , k (13) ξ ^ m , k 2 = b ξ ^ m − 1 , k + ( 1 − b ) γ ^ M L m , k (14) 其中 γ ^ m , k M L = max { γ ^ m , k − 1 , 0 } 为最大似然估计方法得到的当前帧先验信噪比估计值。"
"为了进一步证明改进算法相对于传统算法的优越性，通过Matlab实验仿真得到语谱图和客观评价标准数据进行对比。纯净语音来自于语音库中选取的6段语音(其中3段男声；3段为女声)，5种噪声(White, Pink, Buccaneer2, F16, M109)来自于Noisex-92噪声库，输入信噪比分别为0 dB，5 dB，10 dB，15 dB。实验中采用汉明窗进行加窗分帧处理，采样频率8kHz，帧长为256，重叠率50%，λ取0.98，a和b分别为0.99和0.60。 图1中(a)至(e)分别为纯净语音信号，带噪语音信号，DD算法，CC算法以及改进算法下增强的语音信号的语谱图对比，其中背景噪声为M109噪声，信噪比水平为10 dB。 针对以上仿真语谱图不难看出：三个算法都能有效消除背景噪声，但是DD算法在消除背景噪声的 图1. M109噪声下不同算法的语音信号语谱图(SNR = 10 dB) 基础上语音失真更为严重，尤其是在信噪比水平较低的环境下失真更显著。CC算法语音失真情况虽然较之DD算法有所提升，但是最终效果不如改进算法理想。同时，三种算法都对原始语音造成不同程度的损伤，相较来说，改进算法与原始纯净语音语谱图更加接近，即改进算法对纯净语音损伤程度最小。即改进算法的去噪能力更彻底，因此验证了理论部分的分析。 为了客观定量比较分析三种算法的性能，对三种算法增强后语音的质量、失真程度和可懂度等各种标准进行测试，常用的评价标准有分段信噪比(SegSNR) [ 14 ] ，短时客观可懂度(STOI) [ 15 ] 和对数谱距离(LSD) [ 16 ] 等。分段信噪比大小表征算法滤除噪声的能力，数值越大说明算法残余音乐噪声越少。STOI是与人的听力特性最契合的评价标准，数值越大表明增强语音质量越好。LSD表明增强语音和原始纯净语音的接近程度，数值越小说明失真程度越小，即增强效果越好。表1~表3即为三个算法在四种信噪比水平和五种背景噪声下的客观评价数值情况。 通过三个表可得，在不同背景噪声环境和输入信噪比条件下，改进算法的SegSNR和STOI数据最高，CC算法次之，DD算法的数值最低。说明改进算法可以更大限制地抑制背景噪声，提高增强后语音的信噪比水平，增强后的语音可懂度更高。在LSD输出数据上，改进算法比其他两个算法数据值更小，说明改进算法增强后的语音与原始语音更接近，同时和语谱图的结果相吻合。综上所述，改进算法比CC算 Table 1 噪声类型 输入信噪比 分段信噪比(SegSNR) DD算法 CC算法 改进算法 White 0 dB 4.3907 5.8005 7.1560 5 dB 5.8434 6.6359 7.8063 10 dB 7.0984 7.7320 8.6589 15 dB 9.1980 10.811 11.2345 Pink 0 dB 5.1565 5.2808 6.6384 5 dB 6.1975 6.2242 7.4263 10 dB 7.5781 7.6449 8.6095 15 dB 10.2558 10.7721 11.338 Buccaneer2 0 dB 4.1343 4.9211 6.1662 5 dB 5.2256 5.7149 6.8133 10 dB 6.8214 7.7139 8.5504 15 dB 8.7949 10.4505 10.8979 F16 0 dB 5.2623 5.3991 6.7674 5 dB 6.4201 6.5044 7.7754 10 dB 7.8656 7.9391 9.0580 15 dB 10.5363 10.9798 11.6437 M109 0 dB 6.2730 6.8603 8.6496 5 dB 7.4082 7.9176 9.3838 10 dB 8.9422 9.4135 10.6136 15 dB 11.4692 12.5741 13.3508 表1. 四种算法的SegSNR数据对比表 Table 2 噪声类型 输入信噪比 短时客观可懂度(STOI) DD算法 CC算法 改进算法 White 0 dB 72.2350 75.9131 77.5240 5 dB 79.8583 81.7923 82.8082 10 dB 85.4420 85.7764 86.5817 15 dB 89.7984 89.6146 90.4553 Pink 0 dB 73.0863 76.5339 77.2854 5 dB 79.3534 82.4027 83.0000 10 dB 85.9826 87.1785 87.8651 15 dB 90.3885 90.4289 91.0242 Buccaneer2 0 dB 70.8405 75.0766 75.7672 5 dB 76.9853 80.9993 81.5867 10 dB 83.5680 85.1948 85.3056 15 dB 88.4355 88.8371 88.8654 F16 0 dB 76.2078 79.5544 80.7624 5 dB 82.5660 85.0770 86.1478 10 dB 88.1948 89.2560 90.5462 15 dB 91.7398 92.1378 93.2722 M109 0 dB 76.2916 79.1938 79.9584 5 dB 82.0582 84.7726 85.9888 10 dB 87.9739 88.0564 89.5696 15 dB 90.3163 90.3722 91.5371 表2. 四种算法的STOI数据对比表 Table 3 噪声类型 输入信噪比 对数谱距离(LSD) DD算法 CC算法 改进算法 White 0 dB 6.1261 5.7423 5.0706 5 dB 5.5611 5.3879 4.8288 10 dB 5.4087 5.1224 4.6612 15 dB 5.0679 4.3266 4.0306 Pink 0 dB 5.2437 5.1120 4.4945 5 dB 4.9327 4.9294 4.3898 10 dB 4.8238 4.4972 4.0886 15 dB 4.4760 3.7501 3.5135 Buccaneer2 0 dB 5.9493 5.4718 4.8267 5 dB 5.6324 5.2619 4.6566 10 dB 5.3918 4.6995 4.2640 15 dB 5.0920 4.0812 3.8244 F16 0 dB 4.9231 4.8705 4.3207 5 dB 4.7659 4.6650 4.2287 10 dB 4.6171 4.3696 4.0078 15 dB 4.2148 3.6763 3.4605 M109 0 dB 4.3395 3.4064 3.1264 5 dB 4.1441 3.4095 3.1283 10 dB 4.1441 3.0336 2.8718 15 dB 3.6170 2.5228 2.4159 表3. 四种算法的LSD数据对比表 法的增强效果更具有优越性，进一步证实了理论部分。"
"由于各种杂乱噪声的干扰，涌现出越来越多单声道语音算法，高精度的先验信噪比估计值对语音增强系统的性能好坏起到关键性作用。由于传统的先验信噪比估计算法在跟踪后验信噪比过程中采用极大似然估计方法会出现一帧的延时，并产生音乐噪声。为了切实解决这种弊端，本文通过递归平滑的方式对后验信噪比进行估计，得到新的增强算法。最后实验仿真结果证明了改进算法有更实时的跟踪信噪比变化的性能以及更好的增强效果。"
