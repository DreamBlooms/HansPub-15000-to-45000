"我们利用多元线性回归模型处理两个总体的分类问题，首先对响应变量按一定的规则赋值，并在最小二乘法的基础上构建判别函数及判别准则，进而论证了响应值的选取对平衡及不平衡数据二分类问题的影响。此外，我们将此判别方法与经典判别分析方法如：经典马氏距离判别法、Bayes判别法进行比较，并得到它们之间的内在联系及优缺点。 关键词 :二分类问题，响应值选取，判别分析，线性回归模型，最小二乘法"
"考虑二总体的分类问题，已知有两个总体 和 ，且假定 ， 。每个个体有 种观测指标，如果进行了 次观测得到的观测矩阵 满足： ，这里 ， 。其中观测矩阵的前 行观测值来自第一个总体 ，第 行到第 行观测值来自第二个总体 ，且 。如今给定一个新的样品，判别分析的目的是根据观测矩阵 判定此新样品属于两类中的哪一类。 对上述判别分类问题，已有了一些经典的方法，如：距离判别，Bayes判别等。经典马氏距离判别的思想是：新样品距离哪个总体近就判给哪个总体。而Bayes判别的原理是考虑错判损失，依据使总平均损失最小来进行分类判别。其判别准则如下： 当 时， ；否则， 。 其中 、 为总体 、 的先验概率； 即把本属于总体 的样品错判给 时造成的损失。然而通常情况下，总体参数 ， ， 未知，需要由样本数据来估计未知参数。这里我们记： 将求得的参数估计值代入判别函数中，可用相应的判别准则对新样品判别归类。当两正态总体协方差阵相等时，我们可根据距离判别和Bayes判别准则导出两个线性判别函数。由判别函数的线性特性及判别函数中指标的多元性，我们考虑多元线性回归模型： (1.1) 其中 。这里我们按如下规则对响应变量y赋值： (1.2) 我们不妨令： ， ， 是一个 的列向量，其元素全为1。 ， 张尧庭等[ 1 ] 通过讨论回归分析与判别分析的关系指出：可以用回归分析方法来处理判别分析问题，并指出Fishe线性判别函数与线性回归方程(除常数项 以外)在形式上是一样的；Trevor等[ 2 ] 提出了分类的线性方法，并认为最小二乘回归系数与LDA (linear discriminant analysis)中的判别系数成比例；Qing 和Hui [ 3 ] 由LDA中的最小二乘公式推导并提出Lassoed判别分析。Jianqing Fan [ 4 ] 在A ROAD to Classification in High Dimensional Space中提出了Regularized Optimal Affine Discriminant的判别方法。以上方法都是用线性回归的方法做判别，这涉及到对响应变量y的值的选取问题。张尧庭等[ 1 ] 在多元统计分析引论中提出：为了使各类响应值的均值0，不妨令下(1.2)式中的 ， 。Trevor等[ 2 ] 在文章中令 分别为−1，1；而Qing和Hui [ 3 ] 则令 分别为 ， 。我们将在前人研究的基础上，进一步讨论回归分析中不同响应值的选取对判别结果的影响。"
"这里我们将用回归分析的方法来处理判别问题。首先我们对观测数据做中心化处理，如邰淑彩等[ 5 ] 中的： , ，得到(1.1)式的一个新的矩阵表达形式： (2.1) 其中 ， 。由多元线性回归模型中系数的最小二乘估计法知： (2.2) 其中 分别是 的最小二乘估计。 Theorem 2.1：在多元线性回归方程(2.1)中，参数 的最小二乘估计 满足式子： (2.3) 其中 ，特别的，当 ， 时， 满足如下式子： 由(2.2)式和(2.3)式，我们将系数的最小二乘估计代入判别函数 ，并设定判别准则如下(2.4)式，我们用此判别函数及准则对新样本判别归类时能得到下面的定理。 (2.4) Theorem 2.2：(1) 若 正定，则判别结果只与 的符号有关，而与 的取值无关。即只要 的符号 相同，用该方法判别得到的结果就相同，且无论 和 相等与否，该结论都成立。 (2) 当 且 满足 时，用该判别方法与用距离判别法对新样品分类时得到的判别函数及判别结果相同。"
"我们通过数据模拟来验证我们的结论。我们随机生成了两类数据 ， 。它们均服从 元正态分布，其中 ， 。这里我们取 ， ， ， 满足： ， (3.1) 我们采用五折交叉验证的方法，此方法被Breiman等[ 6 ] 提议并广泛应用于实际，取数据集的4/5作训练集，剩下的1/5作测试集。然后用训练集拟合判别函数，用测试集评估分类性能。我们分别在 的八种情况下，用距离判别、判别I-III这四种方法对测试集样本判别归类。其中，判别I-III即在Theorem 2.2提出的判别方法中分别取： ， ； ， ； ， 得到的三种判别方法。我们重复模拟试验1000次，最终得到各自的平均错判率如表1。 显然，在判别I-III中： 且 。由表1可知：用判别I-III三种方法判别时的模拟错判率相等，这与Theorem 2.2 (1)相符。此外，当 时，用距离判别与用判别I-III这三种方法判别时的模拟错判率相等，满足Theorem 2.2 (2)。此外，我们还可从表格中看出：用以上四种方法对平衡数据 进行判别时，模拟得到的错判率随着维数 的增加而增加，即判别效果随之降低。  基于上3.1中提到的两类数据，我们分别取p = 10,50,100，并分别在这三种情况下取 ， 。之后分别用距离判别，Bayes判别，判别I-III这五种方法对前面9种情况做判别，我们重复模拟试验1000次并取平均值，模拟结果如表2。 这里我们将用一些特定的评价标准评估不同判别方法的分类性能。当数据不平衡 时，Weiss [ 7 ] 指出：为提高分类准确率，分类器往往倾向于将新样品预测为多数类而导致少数类样本的识别率较低，所以错判率不能很好的反映判别方法对不平衡数据集的判别效果。因此我们采用不平衡数据集分类中常用的评价标准：F-value [ 8 ] 和G-mean [ 9 ] 来衡量不同方法判别效果的好坏。这里记： (3.2) Table 1 p 距离判别错判率 判别I错判率 判别II错判率 判别III错判率 10 0.0925 0.0925 0.0925 0.0925 30 0.1153 0.1153 0.1153 0.1153 50 0.1430 0.1430 0.1430 0.1430 70 0.1741 0.1741 0.1741 0.1741 90 0.2095 0.2095 0.2095 0.2095 110 0.2542 0.2542 0.2542 0.2542 130 0.3089 0.3089 0.3089 0.3089 150 0.3910 0.3910 0.3910 0.3910 表1. 四种判别方法的错判率比较 Table 2 判别标准 距离判别 Bayes判别 判别I 判别II 判别III (150, 10) 错判率 0.0897 0.0938 0.1062 0.1062 0.1062 F-value 0.8903 0.8738 0.8782 0.8782 0.8782 G-mean 0.9090 0.8886 0.9004 0.9004 0.9004 (300, 10) 错判率 0.0863 0.0942 0.1919 0.1919 0.1919 F-value 0.8417 0.7716 0.7212 0.7212 0.7212 G-mean 0.9117 0.8019 0.8567 0.8567 0.8567 (600, 10) 错判率 0.0840 0.0687 0.3002 0.3002 0.3002 F-value 0.7586 0.6874 0.4876 0.4876 0.4876 G-mean 0.9137 0.7328 0.8027 0.8027 0.8027 (150, 50) 错判率 0.1279 0.1292 0.1439 0.1439 0.1439 F-value 0.8438 0.8259 0.8364 0.8364 0.8364 G-mean 0.8693 0.8497 0.8627 0.8627 0.8627 (300, 50) 错判率 0.1058 0.1078 0.2124 0.2124 0.2124 F-value 0.8065 0.7363 0.6972 0.6972 0.6972 G-mean 0.8871 0.7766 0.8377 0.8377 0.8377 (600, 50) 错判率 0.0921 0.0743 0.3088 0.3088 0.3088 F-value 0.7346 0.6582 0.4792 0.4792 0.4792 G-mean 0.8960 0.7118 0.7949 0.7949 0.7949 (150, 100) 错判率 0.1868 0.1833 0.2020 0.2020 0.2020 F-value 0.7735 0.7559 0.7727 0.7727 0.7727 G-mean 0.8085 0.7932 0.8039 0.8039 0.8039 (300, 100) 错判率 0.1369 0.1264 0.2406 0.2406 0.2406 F-value 0.7514 0.6922 0.6642 0.6642 0.6642 G-mean 0.8482 0.7480 0.8098 0.8098 0.8098 (600, 100) 错判率 0.1047 0.0833 0.3199 0.3199 0.3199 F-value 0.6985 0.6135 0.4675 0.4675 0.4675 G-mean 0.8713 0.6815 0.7836 0.7836 0.7836 表2. 不平衡数据的判别结果比较 其中 ， ， 。P：正类(少数类)，N：负类(多数 类)。TP与TN分别表示被正确分类的正类和负类样本的数目；FN表示真实类标是正类却被误分为负类的数目，FP表示真实类标是负类而被误分为正类的数目。 ：少数类的查全率， ：多数类的查全率， ：查准率。陶新民等 [ 10 ] 指出：F-Value既考虑了查全率又考虑了查准率，只有在查全率和查准率的值都大时，F-value才会大。同样，只有少数类和多数类样本的查全率同时都大时，G-mean值才会大。因此，F-value和G-mean能综合考虑少数类和多数类两类样本的分类性能，是对不平衡数据分类性能的两个较好的评测指标。 由表2最后三列知：就错判率及不平衡数据的评价标准：F-Value，G-Mean而言，当数据不平衡 时，判别I-III的判别结果相同且 ，此时用距离判别与用判别I-III判别得到的结果不同。 此外，当数据的维数 固定不变时，随着数据不平衡程度 的增加，距离判别及Bayes判别的错判率、F-value和G-mean值变化相对较小，即受不平衡程度的影响较小，判别效果较好；当数据不平衡程度 固定不变时，随着维数p的增加，距离判别及Bayes判别得的错判率较低且F-value，G-Mean值较高，判别效果较好；然而我们可以结合线性模型的变量选择方法如：Tibshirani [ 11 ] 提出的LASSO (Least Absolute Shrinkage and Selection Operator)、Fan和Li [ 12 ] 提出的SCAD (Smoothly Clipped Absolute Deviation)、AIC、BIC及Fan和Lv [ 13 ] [ 14 ] 提出的SIS (Sure Independence Screening)等方法选择重要变量对数据降维，与此同时，用线性回归的方法对新样品判别归类。用这种方法，我们在降维的同时对数据做判别，可能会使得判别I-III的判别效果得到提高，然而这还有待我们以后做进一步研究。  此外，我们对“Wisconsin Diagnostic Breast Cancer (WDBC)”中的真实数据进行了分析。本文采用的数据来源于http://www.datatang.com/data/515。 该数据集包含了关于人体细胞核的30个相关指标(如：细胞核面积、周长、平滑度等)的大量数据，我们从第一类(未患乳腺癌)和第二类(患乳腺癌)的观测样本中各取 、 个样品，用五折交叉验证的方法，并分别用距离判别、Bayes判别、判别I-III这五种方法对这 个样品“是否患有乳腺癌”进行分析判别，并得到各自的模拟结果如表3。 Table 3 判别标准 距离判别 Bayes判别 判别I 判别II 判别III (200, 200) 错判率 0.0375 0.0375 0.0375 0.0375 0.0375 F-value 0.9632 0.9632 0.9632 0.9632 0.9632 G-mean 0.9623 0.9623 0.9623 0.9623 0.9623 (200, 100) 错判率 0.0467 0.0867 0.0700 0.0700 0.0700 F-value 0.9651 0.9389 0.9445 0.9445 0.9445 G-mean 0.9417 0.8630 0.9412 0.9412 0.9412 (200, 50) 错判率 0.0320 0.0720 0.1120 0.1120 0.1120 F-value 0.9805 0.9577 0.9243 0.9243 0.9243 G-mean 0.9216 0.7803 0.9198 0.9198 0.9198 (200, 40) 错判率 0.0292 0.0583 0.1417 0.1417 0.1417 F-value 0.9831 0.9670 0.9069 0.9069 0.9069 G-mean 0.9121 0.7734 0.9010 0.9010 0.9010 (200, 20) 错判率 0.0318 0.0409 0.1818 0.1818 0.1818 F-value 0.9825 0.9782 0.8884 0.8884 0.8884 G-mean 0.8817 0.6811 0.8719 0.8719 0.8719 (200, 10) 错判率 0.0143 0.0238 0.2524 0.2524 0.2524 F-value 0.9925 0.9877 0.8465 0.8465 0.8465 G-mean 0.8811 0.6811 0.8130 0.8130 0.8130 表3. WDBC判别结果比较 由表3知：由于判别I-III中的 相等，用判别I-III三种方法模拟的判别结果相等。当 时，距离判别与判别I-III的判别结果相同；当 时，它们的判别结果不同。而且，随着不平衡程度 的增加，距离判别及Bayes判别的错判率较低，F-value值较高，受不平衡程度的影响较小，判别效果较好。"
"本文主要研究了线性回归模型中响应值的选取对二分类问题的影响。首先，我们对响应变量按一定的规则赋值，然后用最小二乘法拟合，建立判别函数及判别准则，进而得到以下两个结论：1) 该判别方法下的判别结果只与 有关，即只要 相同，用此判别方法判别的结果就相同。2) 当 且 时，用该判别方法得的判别结果与距离判别结果相同。此外，我们用r语言[ 15 ] 分别对平衡数据、不平衡数据及真实数据WDBC进行了模拟，得到了与前面两个结论相符的模拟结果。"
