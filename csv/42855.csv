"分析了换热网络节点非结构模型在优化换热网络问题上的局限性，建立了一种改进的基于温位区间的换热网络非结构模型。该模型将模型空间基于各流股进出口温度划分为高温位区间，中温位区间和低温位区间，各流股上节点按温位区间进行分配，并对节点匹配方式做出规定，禁止热流股低温位节点和冷流股高温位节点跨区间匹配。算例验证表明，该换热网络模型大大减少不可行匹配结构出现的可能性，简化求解空间，有效提高优化效率。"
"换热网络综合作为过程系统工程的重要领域，在实现能量综合利用的过程起到重要的作用 [ 1 ]。对换热网络的节能减耗，主要针对众多换热器热集成的换热网络综合技术 [ 2 ]。通过优化冷热流股间的匹配换热结构，实现最大的能量内部回收和最小的换热网络年综合运行费用，从系统角度实现换热器热集成，提高系统整体的能量回收率和能量利用水平。 对换热网络建立更合理的数学模型表述，需要在尽可能的提高模型的求解空间的基础上，简化模型复杂度 [ 3 ]。换热网络模型主要分为分步优化模型和同步优化模型 [ 4 ]。其中同步优化模型将公用工程用量，换热器数目和换热面积三个变量参数同时兼顾，纳入一个混合整数非线性规划的数学模型中，再应用优化算法对模型优化求解 [ 5 ]。1990年，Yee和Grossmann [ 6 ] 等首次建立了换热网络分级超结构模型，是至今为止应用最为广泛的换热网络同步优化模型。该模型通过预设级数，将换热网络模型空间划分成若干级，每一级中每股热流股均可与每股冷流股形成匹配换热，由此每一级包含了所有的匹配结构。Xiao等 [ 7 ] 通过分析分级超结构的不足，提出了换热网络节点非结构模型。该模型放弃了分级超结构模型级数的限制，以在流股上布置节点作为换热单元的产生位置，以冷热节点的自由匹配，生成非结构化的换热网络，打破了固定匹配方式的约束，极大的提高模型的求解域，在优化换热网络问题上，具有极高的优化效率和研究价值。 节点非结构模型在优化进程中容易出现温度交叉的换热单元，造成了节点数的浪费，具有一定的局限性。鉴于此，本文建立了一种改进后的基于温位区间的换热网络非结构模型，可以有效减少求解空间内不可行匹配结构的产生，提高模型的优化效率。"
"换热网络节点非结构模型与传统的分级超结构模型不同，不预设一个固定的框架，也不存在模型级数的限制 [ 8 ]，其具体的建立的过程如下： 1) 换热单元位置：以 H 1 , H 2 , ⋯ , H N H 表示每股热流股，以 C 1 , C 2 , ⋯ , C N C ，表示每股冷流股。每股热流股和每股冷流股上都预设NGDH和NGDC个节点作为产生换热单元的位置，每个节点的编号用 1 , 2 , ⋯ , N G D H 和 1 , 2 , ⋯ , N G D C 来表示。 2) 连接关系生成：通过选取热流股上一节点PH和冷流股上一节点PC连接，便确定一个换热单元生成，生成的换热单元换热量为Q。换热单元k可以用s所在热流股H k ，所在冷流股C k ，热流股上节点编号NGDH k ，冷流股上节点编号NGDC k 和换热量Q k ，则换热单元数为n个的节点非结构模型可以矩阵M表示，如式(1)所示 M = [ H 1 ⋯ H k ⋯ H n C 1 ⋯ C k ⋯ C n N G D H 1 ⋯ N G D H k ⋯ N G D H n N G D C 1 ⋯ N G D C k ⋯ N G D C n Q 1 ⋯ Q k ⋯ Q n ] (1) 以2股热流股和2股冷流股为例，将节点非结构模型以直观图示表示，如图1所示。该非结构模型产生4个换热单元，公用工程在流股末端生成。 图1. 节点非结构模型示意图  节点非结构模型以换热网络年综合费用TAC最小为优化目标。年综合费用主要包括换热器的设备投资费用和冷热公用工程的运行费用，目标函数的数学描述如式(2)所示 min T A C = min ∑ i = 1 N C C C U Q C U , i + ∑ i = 1 N H C H U Q H U , i + ∑ i = 1 N E ( C 0 + C ′ 0 A i β )   + ∑ i = 1 N C ( C 1 + C ′ 1 A C U , i β ) + ∑ i = 1 N H ( C 2 + C ′ 2 A H U , i β ) (2) 式中，TAC—换热网络年综合费用，USA/A； C C U 、 C H U ——分别是冷公用工程和热公用工程运行费用系数，USA/J； C 0 、 C 0 、 C 2 ——分别是流股换热器，冷公用工程换热器和热公用工程换热器固定费用，USA； C ′ 0 、 C ′ 1 、 C ′ 2 ——分别是流股换热器，冷公用工程换热器和热公用工程换热器固定费用系数，USA/m 2 ； A β 、 C C U β 、 C H U β ——分别是流股换热器，冷公用工程换热器和热公用工程换热器面积，m 2 。 目标函数右侧，前两项计算的是冷热公用工程运行费用，后三项计算的是流股换热器，冷公用工程换热器和热公用工程换热器的投资费用。换热器换热量及换热面积计算依据换热器热平衡公式，如式(3)，式(4)所示。 Q i , j , k = G C p i ( T i , k i n − T i , k o u t ) = G C p j ( T j , k o u t − T j , k i n ) (3) A i , j , k = Q i , j , k U i , j Δ t i , j , k (4)  节点非结构需要满足如下约束条件 1) 单股流股上的热平衡 冷流股和热流股经过加热和冷却后，需要确保达到各自的目标温度。 ( T I N , i − T O U T , i ) ⋅ G C p i = ∑ m ∈ B H ( i )     Q i , m + Q C U , i (5) ( T O U T , j − T I N , j ) ⋅ G C p j = ∑ n ∈ B C ( j )     Q j , n + Q H U , j (6) 2) 换热器可行出入口温度 t e I N , i , m − t e O U T , j , n ≥ Δ T min (7) t e O U T , i , m − t e I N , j , n ≥ Δ T min (8) 3) 冷热公用工程热平衡 冷热流股换热完毕后，剩余的热负荷在流股末端由公用工程加热或冷却 ( t e O U T , i , B H ( i ) − T O U T , i ) F i = Q C U , i (9) ( T O U T , j − t e O U T , j , B C ( j ) ) F j = Q H U , j (10)   在优化节点非结构模型时，换热单元由随机在热流股和冷流股选取一个节点匹配产生，这种随机性地选取，可能会产生一个换热单元的的热流股入口温度低于冷流股的出口温度或一个换热单元的热流股的出口温度低于冷流股的入口温度的现象，称为换热单元温度交叉，以数学描述如式(11)和式(12)所示。 d t l = t i n , h − t o u t , c < 0 (11) d t r = t o u t , h − t i n , c < 0 (12) 出现温度交叉现象的换热单元，明显不符合热力学原理，在换热过程中就会因热流股的温度低于冷流股的温度而停止传热。出现此种情况时，一般采用内部公用工程和外罚函数法处理。在传热因温度交叉而停止时，在冷热流股上使用公用工程代替换热单元，继续将冷热流股加热或冷却到目标温度，这种公用工程称为内部公用工程，并对该换热单元费用加入一个基于换热温差和内部公用工程量的较大的惩罚值。 由于内部公用工程和惩罚值对费用的增加，包含温度交叉换热单元的换热网络结构不是最优的结构，目前最终优化所得的换热网络结构都是不包含温度交叉换热单元。但在优化进程中，节点非结构模型会产生很多温度交叉的换热单元，并且想要消去这些不合理的换热单元需要较多的迭代步数，花费大量的计算时间，大大降低了模型的优化效率。  节点非结构模型在分配节点时，对于每股流股均采用平均分配的方式。但对于一些温度区间跨度较小的流股，其所能匹配的流股较少，平均分配的节点分配方式毕然造成节点数的浪费，最终形成的整型变量求解空间包含众多不可行匹配换热单元。以一个3股热流股和4股冷流股的7sp算例为例，算例数据如表1所示，建立的不包含换热单元，每股流股上设置10个节点的节点非结构模型如图2所示。 Table 1 流体 T IN (℃) T OUT (℃) F (kW/℃) h (kW/(m 2 ·℃)) H1 260 100 100 0.50 H2 120 30 160 0.40 H3 60 40 60 0.14 C1 20 120 100 0.35 C2 70 140 70 0.70 C3 10 30 350 0.50 C4 120 160 60 0.14 HU 330 250 - 0.50 CU 15 30 - 0.50 表1. 7sp算例数据 换热单元面积费用公式：2000 + 70A $/year (A inm 2 )；热公用工程单位费用：60 $/(kW·year)；冷公用工程单位费用：6 $/(kW·year)。 图2. 7sp节点非结构模型 在7sp算例中，热流股H3和冷流股C4较为特殊，H3的入口温度为60℃，入口温度较低，能与其形成有效匹配结构的只有冷流股C1和C3，但在实际优化进程中，H3与冷流股C2和C4仍会形成温度交叉的换热单元，造成[10 * 10 + 10 * 10]的求解空间的浪费。同样的，对于冷流股C4，其入口温度为120℃，能与其形成有效匹配结构的只有热流股H1，与热流股H2和H3匹配形成的换热单元均为不可行结构。对于这样包含热流股入口温度较低，冷流股入口温度较高，流股温度区间跨度较小的节点非结构模型，节点在每股流股上平均分配的分配方式，就会造成求解空间包含大量的不可行匹配结构，虽然这些不可行匹配结构在优化之后均会被消去，但会浪费大量的计算时间。另外，这样的不可行匹配结构所占用的节点也会造成节点的浪费，阻碍好的匹配结构的产生，如H2与C4匹配形成换热单元后，会使用内部公用工程达成流股热平衡，造成H2温度降低与C4温度升高，其后续形成好的匹配结构难度进一步增加，降低模型的优化的效率。"
"针对上述对节点非结构模型局限性的分析可以看出，节点非结构模型对于流股温位匹配没有规定，流股自由匹配造成求解空间包含大量不可行匹配结构，模型的优化效率降低。由此，对节点非结构模型进行改进，提出了一种基于温位区间的换热网络模型。  改进后的基于温位区间的换热网络模型将模型空间基于各流股进出口温度划分为高温位区间，中温位区间和低温位区间，各流股上节点按温位区间进行分配，并对节点匹配方式做出规定，禁止热流股低温位节点和冷流股高温位节点跨区间匹配。其建立的具体过程如下： 1) 温位区间界限温度确定：将各个流股的进出口温度汇总并按从小到大的顺序排序。如总计有NK个流股参与换热，其进出口温度排序形成的数组为 { t 1 , t 2 , ⋯ , t N K } ，则将 t i n t ( N K / 3 ) + 1 作为低温位区间和中温位区间的界限温度t l -m ，将 t i n t ( 2 N K / 3 ) + 1 作为中温位区间和高温位区间的界限温度t m -h 。 2) 流股节点分配：确定各个流股的区间跨度。对于热流股，其入口温度t in ,h 高于t m -h ，出口温度t out ,h 高于t m -h ，则判断其只位于高温位区间；其t in ,h 高于t m -h ，t out ,h 低于t m -h ，高于t l -m ，则判断其跨越高温位区间和中温位区间；其t in ,h 高于t m -h ，t out ,h 低于t l -m ，则判断其跨越三个区间；其t in ,h 低于t m -h ，t out ,h 低于t m -h ，高于t l -m ，则判断其跨越中温位区间和低温位区间；其t in ,h 低于t l -m ，t out ,h 低于t l -m ，则判断其只位于低温位区间。对于冷流股采用同理的区间跨度确定方式。将节点按照流股区间跨度分配到流股上，对于不位于某温位区间上的流股该区间的节点则不分配。 3) 节点匹配：冷热流股的节点匹配方式基本遵循节点非结构模型。特别的，对于热流股低温位节点和冷流股高温位节点，禁止它们跨区间进行匹配，只可与位于自区间的节点匹配，而其余温位区间的节点仍可以自由匹配。 仍以上节的7sp算例为例，建立的基于温位区间的换热网络模型以直观图示，如图3所示。 图3. 7sp基于温位区间的换热网络模型 该算例模型确定的低温位区间和中温位区间的界限温度t l -m 为60℃，中温位区间和高温位区间的界限温度t m -h 为120℃，热流股H1跨越三个温位区间，H2跨越中温位区间和低温位区间，H3只位于低温位区间，冷流股C1跨越中温位区间和低温位区间，C2跨越中温位区间和高温位区间，C3只位于低温位区间，C4只位于高温位区间。对于节点的匹配方式，热流股H1，H2和H3的低温位区间节点只可与冷流股与C1和C3的低温位区间节点匹配，冷流股C2和C4的高温位区间节点只可与H1的高温位区间节点匹配。可以看出，对于热流股H3，只有冷流股C1和C3可以与之匹配，对于冷流股C4，只有热流股H1可以与之匹配，符合上述分析时，符合热力学原理的可行匹配结构。同时，其余的节点仍可遵循节点非结构模型节点自由匹配的方式，在减少求解空间内不可行匹配的基础上，保证了足够大的求解空间。  为了验证基于温位区间的换热网络模型的有效性，采用RWCE算法优化2个算例，与节点非结构模型的优化效率进行对比。 1) 算例1算例H6C4 算例1采用6股热流股和4股冷流股的10sp算例，算例具体参数见表2 [ 9 ]。 Table 2 流体 T IN (℃) T OUT (℃) F (kW/℃) H1 85 45 156.3 H2 120 40 50.0 H3 125 35 23.9 H4 56 46 1250 H5 90 86 1500 H6 225 75 50.0 C1 40 55 466.7 C2 55 65 600 C3 65 165 180 C4 10 170 81.3 HU 200 198 - CU 15 20 - 表2. 10sp算例数据 换热单元面积费用公式：60A $/year (A inm 2 )；热公用工程单位费用：100 $/(kW·year)；冷公用工程单位费用：15 $/(kW·year)；每个换热单元的总传热系数：0.025 kW/(m 2 ·℃)。 对10sp算例建立模型，基于各流股的进出口温度，确定高温位区间与中温位区间的界限温度为120℃，中温位区间与低温位区间的界限温度为56℃，对于流股位于中温位区间上的分段分配10个节点，高温位区间和低温位区间的分段各分配5个节点，最终形成的模型图示如图4所示。 图4. 10sp算例基于温位区间模型 对于10sp算例，只有热流股H4较为特殊，其只位于低温位区间，与冷流股C3无法形成可行匹配结构，与C2的换热温差也较小难以形成可行匹配，能与之有效换热的只有冷流股C1和C4。基于节点非结构模型优化该算例时，热流股H4往往由于在优化进程中生成大量温度交叉的换热单元，难以形成可行匹配关系的换热单元，援引文献 [ 11 ] 中采用节点非结构模型优化后所得的两个结果，其结构如图5所示，结果图5(a)中H4没有与冷股匹配换热，只以在流股末端以冷公用工程的方式冷却到目标温度，结果图5(b)中H4与C4生成了一个小换热量的换热单元，仍然需要加以大换热量的冷公用工程。 图5. 节点非结构模型优化10sp结果 采用基于温位区间的换热网络模型优化该算例所得结果，其换热网络结构如图6所示，年综合费用为5587396 $/year，相比节点非结构模型优化所得结果降低了7166 $/year。该结构在H4-C4匹配生成了一个换热量为4727.8 J的换热单元，有效增加热流股H4的换热效率，降低整体换热网络结构的年综合费用。 图7为节点非结构和基于温位区间的换热网络模型优化10sp算例的个体费用迭代曲线，可以看出，采用基于温位区间的换热网络模型优化10sp算例，费用下降更快，在相同的迭代步数下得到的结果更优。 图6. 基于温位区间模型优化10sp结果 图7. 非结构模型与改进模型费用迭代曲线 2) 算例2算例H13C7 算例2采用13股热流股7股冷流股的20sp算例，算例具体参数见表3 [ 10 ]。 Table 3 流体 T IN (℃) T OUT (℃) F (kW/℃) H1 576 437 23.1 H2 599 399 15.22 H3 530 382 15.15 H4 449 237 14.76 H5 368 177 10.7 H6 121 114 149.6 H7 202 185 258.2 H8 185 113 8.38 H9 140 120 59.89 H10 69 66 165.79 H11 120 68 8.74 H12 67 35 7.62 H13 1034.5 376 21.3 C1 123 343 10.61 C2 20 156 6.65 C3 156 157 3291 C4 20 182 26.63 C5 182 318 31.19 C6 318 320 4011.83 C7 322 923.78 17.6 HU 927 927 - CU 9 17 - 表3. 20sp算例参数 换热单元面积费用公式：4000 + 500A $/year (A inm 2 )；热公用工程单位费用：250 $/(kW·year)；冷公用工程单位费用：25 $/(kW·year)；每个换热单元的总传热系数：0.06 kW/(m 2 ·℃)。 对20sp算例建立模型，确定的高温位区间与中温位区间的界限温度为117℃，中温位区间与低温位区间的界限温度为318℃，建立的基于温位的模型图示如图8所示。 图8. 20sp基于温位区间的模型 由于20sp算例较大，各个流股的温度跨度区间差别较大，较多流股只位于单个温位区间，只有少数几个流股跨越多个区间。为保证求解区域足够，对于流股位于各个区间的分段上都分配10个节点。对比节点非结构，对每股流股均布置10个节点，单步迭代的计算时间有稍许增加。但20sp算例中，被限制节点匹配方式的流股有热流股H6, H9, H10, H11, H12和冷流股C6，C7，这些流股在节点非结构模型中会生成大量的不可行匹配结构，基于温位区间的换热网络模型的优化效率仍大大优于节点非结构模型。改进后的模型在算例越大，包含的温位区间跨度小的流股越多，其对比节点非结构模型的优势就越大。采用基于温位区间的换热网络模型优化20sp算例所得的最终结果为1,400,019 $/year，其换热网络结构示意图如图9所示，相比节点非结构模型优化后结果1,418,981 $/year，减少了18,962 $/year。基于温位区间的换热网络模型优化结果明显更优。 图9. 20sp算例优化后结果"
"1) 节点非结构模型以流股节点自由匹配的方式，使得其求解空间相比分级超结构模型更大，但也因此会出现生成的换热单元温度交叉，低温度的热流股向高温度的冷流股传热这样不符合热力学原理的换热单元使得求解空间也包含了大量的不可行匹配结构，并造成流股节点的浪费，降低了模型的优化效率。 2) 改进的基于温位区间的换热网络模型，将模型空间分为高温位，中温位和低温位区间，基于流股的进出口温度确定三个温位区间的界限温度，流股节点数按照各流股基于温位区间分段分配，并禁止热流股低温位节点和冷流股高温位节点跨区间进行匹配。 3) 采用RWCE算法优化改进后的模型，用10sp算例和20sp算例验证，基于温位区间的换热网络模型大大减少了温度交叉换热单元出现可能，相比与节点非结构模型，其优化后结果更优，优化的效率更高，并且在算例越大，包含的温位区间跨度小的流股越多时，其对比节点非结构模型的优势就越大。"
