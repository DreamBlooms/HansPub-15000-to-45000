"论文针对水下彩色图像对比度低、模糊、偏色等退化问题，研究了几何活动轮廓模型(GACM)的基本理论，结合水下图像的特点，对自适应的GACV图像分割算法进行了改进，尝试设计新的权值函数，并对模型的数值实现方法进行了改进，建立了基于改进的自适应GACV图像分割算法的水下图像分割的数学模型，并对水下图像进行仿真。仿真结果表明，该算法对具有对比度低、图像模糊特点的水下图像实现了完全分割，尤其是水下模糊图像分割效果较好，为水下图像分割研究提供了参考。 关键词 :活动轮廓模型，水平集，水下图像，图像分割 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"几何活动轮廓模型GACM (Geometric Active Contour Models)是为了解决图像处理和计算机视觉领域的广泛存在的图像分割问题而提出来的，近年来，几何活动轮廓模型已经被广泛应用于图像分割当中 [ 1 ] [ 2 ] 。活动轮廓模型的基本思想是：先建立一条轮廓演化曲线并赋予该曲线能量函数，把演化曲线(活动轮廓)隐含的表示为一个更高维函数(称为水平集函数，定义为演化曲线的符号距离函数)的零水平集，使演化曲线逼近图像中的目标边界，接下来利用图像的几何特性最小化此能量函数，将分割过程变为求解能量泛函的最小值过程，数值实现可通过求解函数对应的欧拉方程来实现，当能量达到最小时的曲线位置就是目标轮廓所在。1988年，Osher和Sethian [ 3 ] 提出的基于变分水平集的几何活动轮廓模型追踪运动界面的方法。针对图像分割，Chan和Vese [ 4 ] [ 5 ] 首先以简化的Mumford-Shah泛函 [ 6 ] 和变分水平集方法为基础,建立了分段常值的两相图像分割的变分水平集模型(Chan-Vese模型)。 基于GACM的图像分割方法根据所利用图像信息不同，在GACM当中出现了两种比较有代表性的模型，即测地线活动轮廓模型和C-V模型，其中测地线活动轮廓模型是一种基于边界的模型，主要基于图像的边缘信息，利用图像梯度信息使演化曲线在图像边界位置停止迭代。在进行边界较弱的图像分割时，测地线活动轮廓模型会出现边界泄露现象。C-V活动轮廓模型是一种基于区域的模型，主要利用图像的区域信息进行曲线演化，相比于测地线活动轮廓模型，C-V模型对弱边界图像具有很好的分割性能，但由于其利用的是图像的区域信息，对含有异质区域的图像分割效果较差。针对图像的特点选择图像的分割算法的时候，通常根据待分割图像的性质进行选择，上述两种模型在进行图像处理的过程中都具有一定的片面性，Li等人提出的GACV模型 [ 7 ] ，该模型将测地线活动轮廓模型和C-V模型相结合。在曲线演化的过程中，同时考虑了图像的边界和区域信息，大大提高了ACM进行图像分割的性能。Sagiv等人 [ 8 ] [ 9 ] 针对图像纹理的特征，提出了将边界信息和区域信息相融合的思想。文献 [ 10 ] [ 11 ] 在图像对比度信息的基础上也将基于边界的能量信息和基于区域的能量信息相结合以进行图像分割。另外，文献 [ 12 ] 在基于GACM的图像分割方法中，也同时考虑了图像的局部边界信息和全局强度信息。文献 [ 2 ] 利用两种模型相融合统一于一个曲线演化过程中，对ACM性能进行优化，在融合过程中引入权值函数，由权值函数控制两种模型在优化中所起的作用，有效的对图像异质区域和弱边界区域进行了分割，但对于图像对比度差、背景复杂的图像效果不佳。上述文献 [ 13 ] [ 14 ] [ 15 ] 均添加了一些其它方法到GACV模型当中，并没有考虑到待分割图像本身的特性，并且上述方法还存在计算复杂度较高的问题。针对具体的应用领域，还需要选择合适的ACM进行改进，本文结合水下图像光照不均匀等特点，对自适应GACV模型进行改进，并根据矢量化的自适应GACV模型建立了自适应GACV的水下图像分割模型。"
"文献 [ 2 ] 中通过对测地线活动轮廓模型和C-V模型分析，利用测地线活动轮廓模型包含边缘检测因子，可以有效地处理含有异质区域图像的分割问题，但是模型中许多图像性质的计算及约束项的控制使得模型的计算较为复杂，同时分割结果较大地依赖于演化曲线的大小与初始位置的选择；而C-V模型可以提高在出现遮挡以及边缘噪声比较严重情况下曲线演化的准确度，对初始位置不敏感且计算简单，但是对含有异质区域图像，分割效果较差。在测地线活动轮廓模型和C-V模型的基础上，提出了具有自适应特点的混合GACV模型，具体模型如公式(1)： E = χ ∫ R g ( | ∇ I | ) d x d y + ( 1 − χ ) ( ∫ R | ∇ I | d x d y + ∫ R | I − c 1 | 2 d x d y + ∫ R | I − c 2 | 2 d x d y ) = ∫ R [ χ g ( | ∇ I | ) + ( 1 − χ ) | ∇ I | ] d x d y     + ( 1 − χ ) ( ∫ R | I − c 1 | 2 d x d y + ∫ R | I − c 2 | 2 d x d y ) (1) 其中， χ 为权值函数，满足 χ ∈ [ 0 , 1 ] 。当 χ = 0 时，该模型退化为C-V模型进行轮廓曲线的演化；而当 χ = 1 时，该模型退化为测地线活动轮廓模型进行轮廓曲线的演化。当 χ ∈ ( 0 , 1 ) 时，此时两个模型同时作用，可以解决分割异质图像所出现的问题以及边缘信息较复杂图像的分割问题，从而驱动轮廓曲线演化，实现图像分割。 权值函数 χ 所起的作用是控制测地线活动轮廓模型和C-V模型对文献 [ 2 ] 提出模型的影响，测地线活动轮廓模型使得文献 [ 2 ] 方法能较好地分割异质图像；而C-V模型使得文献 [ 2 ] 方法对弱边界图像具有较好的鲁棒性。然而，针对目前的某些图像，用肉眼去辨别图像的灰度值会加大实验的误差。基于上面的讨论我们知道：在图像同质区域部分，应加强C-V模型的作用，使得 χ 趋近于0；在图像的异质或边缘区域，应加强测地线活动轮廓模型的作用，使得 χ 趋近于1。到目前为止，权值大部分都是人为的进行选择。为此，针对不同的图像区域特性，文献 [ 2 ] 构造了如下的 χ 权函数： χ = 1 2 ⋅ cos ( π ⋅ | ∇ I | 255 2 + π ) + 1 2 (2) 当图像区域表现为同质特性时， χ 随着 | ∇ I | 值的减小缓慢趋近于0，此时混合模型趋于C-V模型。当图像区域表现为异质或边界特性时， χ 随着 | ∇ I | 值的增大缓慢趋近于1，此时混合模型趋于测地线活动轮廓模型。对应的函数曲线如图1(a)所示。 1) 对权值函数的改进 在文献 [ 2 ] 中权值函数 χ 所起的作用是控制测地线活动轮廓模型和C-V模型对GACV模型的影响。在梯度值较小时，体现图像区域的同质性，需要加强C-V模型所起的作用， χ 的值要趋近于0；在梯度之较大时，体现图像区域的异质或边缘性，需要加强测地活动轮廓模型的作用，使得 χ 趋近于1。问题在于在文献 [ 2 ] 中权值函数器的作用为当图像区域表现为同质特性时， χ 随着 | ∇ I | 值的减小缓慢趋近于0，此时混合模型趋于C-V模型。当图像区域表现为异质或边界特性时， χ 随着 | ∇ I | 值的增大缓慢趋近于1，此时混合模型趋于测地活动轮廓模型。对于水下图像而言，由于光照不均匀、水体对光的散射和吸收等 图1. 权函数曲线示意图 产生的图像退化问题，导致对比度降低，从而导致图像的梯度模值整体减小，例如 | ∇ I | 的最大值为 255 2 ， 会导致权值函数处于如图1(b)所示的曲线情况。 为了适应水下图像的特点，基于以上问题对权值函数进行改进如下： a) 将权值函数 χ 改造为公式(3)，取 max ( | ∇ I | ) = 255 2 ，这时权值函数的曲线如图1(b)所示 χ 1 = 1 2 ⋅ cos ( π ⋅ | ∇ I | max ( | ∇ I | ) + π ) + 1 2 (3) b) 并尝试设计新的权值函数，代替上述权值函数进行图像分割，新权值函数 χ 改造为公式(4)，取 max ( | ∇ I | ) = 50 的时候，这时权值函数的曲线如图1(d)所示 χ 2 = 1 − e − ( | ∇ I | max ( | ∇ I | ) ) (4) 2) 基于彩色图像的自适应GACV模型改进 本文要处理的图像为水下彩色图像，需要考虑多通道图像(彩色图像)的分割问题，由于彩色图像包含更丰富的图像信息，目前已经成为图像分割的研究热点。文献 [ 16 ] 提出了一种基于区域活动轮廓模型在区域可控范围内提取强信息对图像进行分割，其中对彩色图像进行处理的时候，采用将彩色图像转化为灰度图像的方法对彩色图像进行了分割，这种方式适用于目标区域为颜色较为均匀的区域进行分割，文献 [ 17 ] [ 18 ] [ 19 ] [ 20 ] 中利用个颜色位图，分别进行分割然后进行区域融合分割，这种方式适合于目标区域中含有不同颜色的子区域需要进行分割。 本文研究的图像类型主要是目标区域为颜色较为均匀的区域进行分割，并针对水下图像对比度较低的特点，本文选取图像R、G、B位图中对比度最大的位图进行分割，设I为待分割图像，各位图对比度的算法如下： 1) 确定要求对比度的位图 Img = double(I(:,:,i)) 2) 计算四阶距 M4 = mean(mean((Img-mean(Img(:))).^4)); 3) 计算方差 delta2 = var(double(Img(:))); 4) 峰度 alfa4 = M4/(delta2.^2); 5) 计算标准差 delta = std(double(Img(:))) 6) 计算对比度 Fcon_x = delta/(alfa4^(1/4)); 然后计算R、G、B三色位图中对比度最大的位图，对其进行分割，以下公式中的I为图像R、G、B三色位图中对比度最大的位图。"
"下面对改进的自适应GACV模型进行数值离散处理，为了避免当 | ∇ I | = 0 时所提混合模型出现除数 为零，本文使用 | ∇ I | α = ( ∂ I ∂ x ) 2 + ( ∂ I ∂ y ) 2 + α 来代替 | ∇ I | ，其中 α 为一小正数，此时所提出的自适应混合模型 为： E = ∫ R [ χ g ( | ∇ I | α ) + ( 1 − χ ) | ∇ I | α ] d x d y               + ( 1 − χ ) ( ∫ R | I − c 1 | 2 d x d y + ∫ R | I − c 2 | 2 d x d y ) (5) 采用变分法得到改进的自适应GACV模型的梯度下降流形式如下： ∂ ϕ ∂ t = χ δ ( ϕ ) d i v ( g ⋅ ∇ ϕ | ∇ ϕ | ) + ( 1 − χ ) δ ( ϕ ) [ d i v ( ∇ ϕ | ∇ ϕ | ) + ( I − c 1 ) 2 + ( I − c 2 ) 2 ] (6) 其中 δ ( x ) = d H ( x ) d x ， H ( x ) 近似的表示为正则化的Heaviside函数，定义如下： H ε ( x ) = 1 2 [ 1 + 2 π arctan ( x ε ) ] (7) 则 δ ( x ) 定义为 H ε ( x ) 的导数，采用正则化的Dirac公式如下： δ ε ( x ) = H ′ ε ( x ) = 1 π ε ε 2 + x 2 (8) 其中，div(·)为散度算子，定义为： d i v ( ∇ ϕ | ∇ ϕ | ) = ∂ ∂ x ( ϕ x | ∇ ϕ | ) + ∂ ∂ y ( ϕ y | ∇ ϕ | ) 其中 d i v ( g ⋅ ∇ ϕ | ∇ ϕ | ) 采用半点差分法进行模型的数值实现方程的离散化形式为： d i v ( g ∇ ϕ | ∇ ϕ | ) i , j = ( g ∇ ϕ | ∇ ϕ | ) i + 1 2 , j − ( g ∇ ϕ | ∇ ϕ | ) i − 1 2 , j Δ x     + ( g ∇ ϕ | ∇ ϕ | ) i , j + 1 2 − ( g ∇ ϕ | ∇ ϕ | ) i , j − 1 2 Δ y (9) 上式取空间步长 Δ x = Δ y = 1 ，则公式(10)化简为： d i v ( g ∇ ϕ | ∇ ϕ | ) i , j ≈ ( g ∇ ϕ | ∇ ϕ | ) i + 1 2 , j − ( g ∇ ϕ | ∇ ϕ | ) i − 1 2 , j + ( g ∇ ϕ | ∇ ϕ | ) i , j + 1 2 − ( g ∇ ϕ | ∇ ϕ | ) i , j − 1 2 (10) 其中： ( g ∇ ϕ | ∇ ϕ | ) i + 1 2 , j ≈ g i + 1 2 , j ( ϕ i + 1 , j − ϕ i , j ) | ∇ ϕ | i , j ≈ ( g i + 1 2 , j + g i , j ) 2 ( ϕ i + 1 , j − ϕ i , j ) | ∇ ϕ | i , j ( g ∇ ϕ | ∇ ϕ | ) i − 1 2 , j ≈ g i − 1 2 , j ( ϕ i , j − ϕ i − 1 , j ) | ∇ ϕ | i , j ≈ ( g i − 1 2 , j + g i , j ) 2 ( ϕ i , j − ϕ i − 1 , j ) | ∇ ϕ | i , j ( g ∇ ϕ | ∇ ϕ | ) i , j + 1 2 ≈ g i , j + 1 2 ( ϕ i , j + i − ϕ i , j ) | ∇ ϕ | i , j ≈ ( g i , j + 1 2 + g i , j ) 2 ( ϕ i , j + i − ϕ i , j ) | ∇ ϕ | i , j ( g ∇ ϕ | ∇ ϕ | ) i , j − 1 2 i , j − 1 2 ≈ g i , j − 1 2 ( ϕ i , j − ϕ i , j − 1 ) | ∇ ϕ | i , j ≈ ( g i , j − 1 2 + g i , j ) 2 ( ϕ i , j − ϕ i , j − 1 ) | ∇ ϕ | i , j (11) 等式两边采用向前差分， ∂ t 为离散时间步长。模型的数值实现方程的离散化形式为： ∂ ϕ i , j n + 1 ∂ t = ϕ i , j n + 1 − ϕ i , j n ∂ t 则模型的数值实现过程如下： 图2. 水下图像分割 ϕ i , j n + 1 − ϕ i , j n Δ t = δ ε ( ϕ i , j n ) ⋅ ( χ ⋅ ( ( g i + 1 2 , j + g i , j ) 2 ( ϕ i + 1 , j n − ϕ i , j n ) | ∇ ϕ | i , j − ( g i − 1 2 , j + g i , j ) 2 ( ϕ i , j n − ϕ i − 1 , j n ) | ∇ ϕ | i , j     + ( g i , j + 1 2 + g i , j ) 2 ( ϕ i , j + i n − ϕ i , j n ) | ∇ ϕ | i , j − ( g i , j − 1 2 + g i , j ) 2 ( ϕ i , j n − ϕ i , j − 1 n ) | ∇ ϕ | i , j )     + ( 1 − χ ) ( ( ϕ i + 1 , j − ϕ i , j ) | ∇ ϕ n | i , j − ( ϕ i , j − ϕ i − 1 , j ) | ∇ ϕ n | i , j + ( ϕ i , j + i − ϕ i , j ) | ∇ ϕ n | i , j − ( ϕ i , j − ϕ i , j − 1 ) | ∇ ϕ n | i , j + [ ( I − c 1 ( ϕ i , j n ) ) 2 + ( I − c 2 ( ϕ i , j n ) ) 2 ] ) ) (12)"
"在实验的参数设置中，令 λ 1 = λ 2 = 1 ， μ = 1 和 α = 10 − 6 ；取 ε = 0.5 ；时间步长 Δ t = 0.1 。实验基于MATLAB 2012a软件。利用所提模型进行图像分割的过程，红色封闭曲线为最终的演化曲线，图2为迭代次数300次的分割结果，其中图2(a)~(e)中左上为原图，右上列为文献 [ 2 ] 分割结果；左下为取权值函数 χ 1 的分割结果，右下为取权值函数 χ 2 的分割结果；结果表明对于较清晰的，对比度较高的水下图像，在本模型中三种权值函数均能实现良好的分隔效果，而对于较为模糊的最后两张图像，取权值函数 χ 2 的分割结果优于前两种。"
"本文对自适应的GACV图像分割算法进行改进，将测地活动轮廓模型和C-V模型相结合过程中。本算法根据水下图像的特点对权值函数进行改进，另外，考虑到图像特性，本文将改进自适应模型应用于彩色图像当中。利用图像R、G、B三色位图中对比度最大的位图，通过用不同的权值函数对水下图像进行分割。最后，为了表明所提模型的性能，将其分别应用于水下较为清晰图像、水下模糊图像以及复杂背景等不同类型的图像上，实验结果表明本文所改进模型的有效性。为水下图像处理研究提供了参考。"
