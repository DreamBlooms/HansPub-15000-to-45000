"为缓解金沙江、雅砻江交汇处攀枝花市的防洪压力，合理利用雅砻江下游梯级水库的防洪库容，构建了以攀枝花站最大洪峰最小为目标的锦屏一级、二滩水库联合防洪调度模型，通过延长错峰历时、减小错峰流量，组合得到20组梯级联合调度方案，采用动态规划法对模型进行了求解；采用一阶季节性自回归模型模拟金沙江干流洪水，计算攀枝花站各方案的防洪风险率，运用熵权法–集对分析法对方案集进行了优选。结果表明：锦屏一级、二滩联合防洪调度可以充分利用两库的防洪库容，有效缓解攀枝花市的防洪压力。"
"洪水是最主要又频发的自然灾害之一，给国家和人民造成了重大损失，因此我国一直十分重视防洪救灾问题。防洪调度是防洪减灾的重要手段 [ 1 ]，随着研究的不断深入，有关水库群防洪调度的研究也日渐成熟。Kelman [ 2 ] [ 3 ] 等依照可控性标准对水库群联合防洪调度模型进行了构建，对各水库汛期最高蓄洪量进行了计算，获取了水库防洪调度图；陈西臻 [ 4 ] 于2015年借助聚合–分解思想构建了防洪调度模型，并借助遗传算法进行了求解，对水库群防洪优化调度予以指导。金羽 [ 5 ] 根据淮河并联水库群中各个水库的特点，运用加速遗传算法对单一水库防洪调度进行了优化，并将此优化调度的结果作为“大系统分解一协调”法第一级子问题的解，通过协调运算得到并联水库群防洪错峰调度的优化解。 防洪错峰调度是保障下游控制点安全的有效方法，现有的防洪错峰调度中，错峰期水库下泄流量一般设定为某个定值，该值小于下游控制点安全流量与干流洪水洪峰流量的差值 [ 6 ]，以此定值来指导支流水库的下泄，虽然降低了调度的难度，但下泄流量过小容易使水库水位增长过快，加大水库自身的防洪压力。目前，针对水库防洪错峰调度中错峰流量选择仍是一个值得探究的课题，为了平衡下游防洪安全和水库自身安全，有必要对错峰流量进行优选，在一定约束条件下，寻求水库错峰期最优下泄过程。 本文以雅砻江下游梯级水库群为研究对象，一方面，将原错峰流量值转化为错峰期最小下泄约束，并延长错峰时间，对现有错峰调度方法进行了改进，建立了梯级水库控泄调度–错峰调度联合调度模型，并采用动态规划算法(DP)对模型进行了求解；另一方面，在采用一节季节性自回归模型(SAR(1))模拟洪水过程的基础上对防洪风险率进行计算，并采用熵权–集对分析法对方案集进行了优选，得到最满意的梯级水库联合调度方案，为两库的防洪调度提供参考。"
"雅砻江是金沙江的第一大支流，发源于青海省玉树县境内的巴颜喀拉山南麓，于攀枝花市下游的倮果汇入金沙江。雅砻江河道全长约1570 km，流域面积约13.6万km 2 ，占金沙江(宜宾以上)集水面积的28.7%。 锦屏一级水库是雅砻江干流下游控制性水库，距坝址距雅砻江与金沙江的交汇口攀枝花市358 km，承担着发电、防洪、供水、旅游等任务，该水库具有年调节能力，在雅砻江防洪调度中具有重要的作用。水库于2005年11月12日开始建设，2006年12月4日，截流工程顺利竣工，2009年10月23日启动修建大坝工程，于2013年12月底封顶，并开始运行。 二滩水库处于雅砻江下游，坝址距雅砻江与金沙江的交汇口攀枝花市33 km，雅砻江水电基地梯级开发的第一个水电站，主要任务为发电，兼顾防洪、航运等。二滩于1991年9月开工，1998年7月第一台机组发电，2000年完工，是中国在二十世纪建成投产最大的电站，二滩水库的防洪库容可为金沙江下游及长江干流防洪削峰创造条件，获得可观的防洪效益 [ 7 ]。 流域地理位置如图1所示，锦屏一级、二滩的特征参数见表1。 图1. 雅砻江梯级水库与攀枝花市位置示意图 Table 1 水库 汛限水位/m 设计洪水位/m 校核洪水位/m 防洪库容/亿m 3 调节库容/亿m 3 锦屏一级 1859 1880.54 1882.6 16 49.1 二滩 1990 1200 1203.5 9 33.7 表1. 锦屏一级、二滩水库特征参数 攀枝花市位于金沙江、雅砻江交汇处，根据《攀枝花总体规划》中规定，河道安全流量为14,500 m 3 /s。雅砻江下游控制性水库防洪调度目标为：经锦屏一级、二滩水库调蓄后，流经攀枝花市的洪水过程尽可能平坦、洪峰流量尽可能小。本文选用1998年8月26日6时~9月10日3时典型洪水为研究案例，以3 h为步长，共120个时段，对两库联合防洪优化调度问题进行探讨，由于两库间锦屏二级和官地水库的不具备调蓄作用，因此本文以锦屏一级的出库流量加上两库区间的天然径流作为二滩的入库流量，两库间洪水传播时长为6 h。"
"对于承担防洪任务的水库，一般有固定泄量调度、补偿调度和错峰调度三种调度方式 [ 8 ]，此次研究根据雅砻江流域的特点：锦屏一级水库离攀枝花市较远，下游二滩水库距离攀枝花较近，因此锦屏一级水库的调度方式尽可能简单，锦屏一级水库采用控泄调度，二滩水库采用错峰调度。  锦屏一级采用控泄调度，控泄流量的选择标准为：锦屏一级水库与二滩水库的削峰率保持一致。在已知两库区间流量过程、二滩水库错峰期最小下泄流量前提下，即可求得锦屏一级水库的控泄流量值。调度规则如下： 1) 锦屏一级水库水位小于调度期允许最高水位1882.6 m时，水库按照固定泄量进行下泄。 2) 锦屏一级水库水位高于1882.6 m时，水库防洪目标转为保护大坝安全，水库按照来流进行下泄。  错峰调度中，错峰起止时间与干流洪水阈值有关，错峰期最小下泄流量与干流洪峰值有关。以金沙江干流洪水过程作为依据，制定二滩水库错峰调度规则如下： 1) 错峰期前，水库按满足攀枝花防洪安全约束下的最大下泄流量下泄，降低水库水位，腾出库容为错峰期水库蓄水做准备，若该下泄流量值超过本次洪水洪峰，则按照洪峰值进行下泄。 2) 在错峰期内，且水库水位小于调度期允许最高水位1203.5 m时，水库按照错峰流量要求对下泄流量进行寻优；当水库水位大于1203.5 m时，水库防洪目标转为保护大坝安全，按照来流下泄。 3) 错峰期后，且水库水位小于1203.5 m时，调度规则同错峰期前一致；当水库水位大于1203.5 m时，按照来流进行下泄。   以攀枝花站最大洪峰最小为目标，目标函数可表示为： F = min ( max ( q t 2 + Q g l ) ) (1) 其中， q t 2 为二滩水库下泄流量， Q g l 为金沙江干流流量。  调度期初水位约束 Z i _ 1 = Z i _ b e g i n (2) 水库最高水位约束 Z i _ t ≤ Z i _ max (3) 水库下泄流量约束 q i t _ min ≤ q t i ≤ q i t _ max (4) 水量平衡约束 V i ( t + 1 ) = V i t + Q i t − q i t ∗ Δ t (5) 相邻水库间的流量关系 Q 2 t = q t 1 + Q l o (6) 二滩错峰期前后流量约束 q t 2 _ 1 = min [ ( Q a − Q t ) , Q m 2 ] (7) 二滩错峰期流量约束 q t 2 _ 2 ≥ Q a − Q p m (8) 锦屏一级水库下泄流量约束 q t 1 Q m 1 = Q a − Q p m Q m 2 (9) 非负约束所有变量值在任意时刻均不为负数，其中， Z i _ 1 是i水库调度期初的计算水位， Z i _ b e g i n 为i水库调度期起始的调水位， Z i _ t 为i水库t时刻水库的水位； Z i t _ max 为i水库t时刻最高水位限制， q t i 为i水库t时刻水库的下泄流量， q i t _ min 、 q i t _ max 为i水库最小、最大下泄流量限制， Q i t 是i水库t时刻入流量， Δ t 为计算的时段步长， Q l o 为两库的区间入流流量， q t 1 是锦屏一级水库控泄流量值， q t 2 _ 1 是错峰期前、后二滩水库的下泄流量， Q a 为攀枝花市防洪标准， Q m 1 、 Q m 2 是锦屏一级、二滩入流峰值， q t 2 _ 2 为二滩水库错峰期流量约束， Q p m 为金沙江干流洪峰流量。  动态规划 [ 9 ] [ 10 ] 在最优化技术中适用范围很广，能有效解决多阶段决策问题。其基本思想是把一个复杂的系统分析问题分解成一个多阶段的决策过程，并按一定顺序，逐次求出每段的最优决策，最后采用顺序法或逆序法求得整个系统的最优决策 [ 11 ]，在水库优化调度中运用很广，本文运用动态规划算法(DP)对上述模型进行求解。 首先拟定的锦屏一级、二滩两库的初始调度方案，初始方案的目标特征值见表2，运用动态规划算法(DP)求得两库的下泄过程、水位过程线、攀枝花市经水库调蓄前后洪水过程线见图2。 由以上计算结果可知，经梯级水库优化调度后，攀枝花市的洪水过程线较优化前趋于平稳，最大流量为14,500 m 3 /s，满足攀枝花安全流量要求，能保证攀枝花市的防洪安全，且两库防洪最高水位、末水位均在安全范围内，能保障水库自身运行安全。 Table 2 调度指标 锦屏一级控泄流量(m 3 /s) 二滩非错峰期 最大下泄流量(m 3 /s) 二滩错峰期 下泄流量下限(m 3 /s) 干流流量阈值(m 3 /s) 错峰开始时段 错峰结束时段 指标值 4850 6680 4300 9500 58 100 表2. 锦屏一级、二滩梯级水库初始调度方案 图2. (a) 锦屏一级水库初始防洪优化调度图；(b) 二滩水库初始防洪优化调度图；(c) 调度前后攀枝花市洪水过程线 以初始调度方案为基础，拟定延长错峰时间和减小错峰期流量下限两种措施：以干流流量阈值9500 m 3 /s，9000 m 3 /s，8500 m 3 /s，8000 m 3 /s，7500 m 3 /s，以干流洪水过程超过所阈值的时段设为二滩水库的需要进行错峰调度的时段，取4300 m 3 /s，4100 m 3 /s，3900 m 3 /s，3700 m 3 /s几组流量值为二滩错峰期最小下泄约束，组合成20种联合调度方案，各方案组合方式如表3，运用DP算法对20组方案进行求解，得到锦屏一级、二滩水库目标特征值见表4。 Table 3 错峰时段 二滩错峰期 最小下泄约束 58~100 56~104 52~107 45~111 27~113 4300 (m 3 /s) 方案1 方案2 方案3 方案4 方案5 4100 (m 3 /s) 方案6 方案7 方案8 方案9 方案10 3900 (m 3 /s) 方案11 方案12 方案13 方案14 方案15 3700 (m 3 /s) 方案16 方案17 方案18 方案19 方案20 表3. 20组方案组合方式 Table 4 方案集 锦屏一级 二滩 水库调蓄后 攀枝花洪峰 (m 3 /s) 削峰率 (%) 控泄流量 (m 3 /s) 最高水位 (m) 末水位 (m) 最小下泄流量 (m 3 /s) 最大下泄流量 (m 3 /s) 最高水位 (m) 末水位 (m) 方案1 4850 1869.75 1868.76 4300 6680 1193.30 1191.75 14,500 35.63% 方案2 1193.93 1192.40 35.63% 方案3 1194.85 1193.45 35.63% 方案4 1196.84 1195.89 35.63% 方案5 1201.78 1200.98 35.63% 方案6 4735 1871.48 1870.73 4100 6565 1193.91 1192.43 14,300 38.62% 方案7 1194.50 1193.05 38.62% 方案8 1195.64 1194.31 38.62% 方案9 1197.63 1196.69 38.62% 方案10 1202.62 1201.92 38.62% 方案11 4600 1873.52 1872.99 3900 6430 1194.65 1193.26 14,100 41.62% 方案12 1195.24 1193.89 41.62% 方案13 1196.23 1194.94 41.62% 方案14 1199.50 1198.84 41.62% 方案15 1203.14 1202.46 41.62% 方案16 4460 1875.63 1875.3 3700 6290 1195.15 1193.84 13,900 44.61% 方案17 1195.67 1194.36 44.61% 方案18 1196.72 1195.49 44.61% 方案19 1198.67 1197.77 44.61% 方案20 1203.45 1202.62 44.61% 表4. 20组调度方案的目标特征值 由表4的数据分析可知，对于锦屏一级水库：控泄流量与最高水位成反比，与末水位成反比。这是由于，对于锦屏一级水库，控泄流量越小，则调度期内水库蓄水量越多，最高水位越高，调度期末水位越高。 对于二滩水库，相同错峰时长情况下，错峰期错峰流量越小，二滩水库最高水位越高，末水位越高；相同错峰流量情况下，错峰时长越长，二滩水库最高水位越高，末水位越高。这是由于，错峰期下泄流量越小，错峰时长越长，则错峰内水库蓄水量越多，最高水位越高，调度期末水位越高。 经计算得到梯级联合调度的20个方案，之后进行风险计算及方案优选，为决策者提供参考。"
"雅砻江梯级水库防洪调度的风险主要包括：库区淹没风险、溃坝风险和攀枝花洪水超标风险 [ 12 ]。其中库区淹没风险和溃坝风险与两库调洪高水位有关，而攀枝花洪水超标风险主要受二滩水库下泄流量和金沙江干流洪水的影响，二滩水库下泄流量是可控因素，而金沙江干流的洪水过程不可控，干流洪水峰现时间、洪水过程线等，都会对攀枝花市组合洪水流量产生影响，因此，对金沙江干流洪水过程进行模拟，是水库防洪错峰调度风险率计算的前提和基础。 本文选用一阶季节性自回归模型 [ 13 ] 对金沙江干流洪水过程进行模拟，以金沙江干流实测洪水系列为依据，通过matlab编程得到十万组模拟洪水，经分析计算，模拟洪水过程与实测洪水过程各截口统计参数均值、均方差、变差系数及偏态系数较为接近，均值相对误差均小于1%，均方差、变差系数及偏态系数，模拟结果相对误差均小于10%，模型生成洪水基本上保持了实测洪水的统计特征，模拟效果较好。将模拟出的十万组随机洪水分别看作典型洪水，按照同频率放大法，将洪峰、洪量进行放大，得到峰量同时满足要求的设计洪水过程 [ 14 ]。所得结果就是金沙江干流汇入攀枝花市的各种可能的十年一遇的洪水过程，节选5组模拟洪水过程线如图3表示。 图3. 五组干流模拟洪水过程线 攀枝花市防洪风险定义为：二滩水库下泄水量与金沙江干流洪水的组合流量超过攀枝花市安全洪量的概率。将模拟得到的十万组干流洪水，分别与各方案二滩水库下泄流量进行组合，统计其组合过程的最大值 Q max ，比较判 Q max 是否超过攀枝花安全洪量，超过的次数记为m，则水库防洪错峰调度风险率可用下式表示。 P c f = m 100000 × 100 % (10) 经计算，20个方案的防洪风险率如表5： Table 5 方案 防洪风险率(%) 方案 防洪风险率(%) 方案1 51.921% 方案11 2.389% 方案2 41.863% 方案12 0.522% 方案3 34.796% 方案13 0.056% 方案4 25.806% 方案14 0.013% 方案5 23.797% 方案15 0.007% 方案6 34.986% 方案16 1.977% 方案7 26.489% 方案17 0.330% 方案8 12.110% 方案18 0.046% 方案9 6.702% 方案19 0.016% 方案10 0.018% 方案20 0.006% 表5. 各方案防洪风险率 图4. 各方案防洪风险率 由图4可知，在保持其他指标不变的前提下，延长错峰历时和减小错峰期下泄流量两种措施，都能够有效降低攀枝花市的防洪错峰风险率，且减小错峰流量的效果较延长错峰历时的效果更加明显。  根据水库防洪调度系统的特点与经验，假设水库防洪错峰调度风险率不超过15% [ 6 ]，因此，淘汰防洪错峰风险率高于15%的方案及两库最高水位超过设计洪水位的方案，最后确定可行方案集为方案8~9、11~14及16~19共10个可行方案。运用改进熵权–集对分析方法 [ 15 ] [ 16 ]，选取如下8个指标：锦屏一级最高水位、末水位、二滩最大下泄流、最高水位、末水位、水库调蓄后攀枝花洪峰流量、削峰率、错峰风险率，对方案集进行优选。 对目标矩阵进行归一化处理后，得到各指标的相对隶属度矩阵R： R = [ 1.00 1.00 0.00 1.00 1.00 0.00 0.51 0.51 0.49 0.80 0.81 0.00 0.39 0.39 0.00 1.00 1.00 0.50 0.00 0.00 0.50 0.00 0.45 0.80 0.51 0.51 0.49 0.51 0.51 0.49 0.51 0.51 0.49 0.88 0.89 0.50 0.67 0.70 0.50 0.00 0.00 0.50 0.50 0.50 0.50 0.96 1.00 1.00 0.00 0.00 1.00 0.00 0.00 1.00 0.00 0.00 1.00 0.90 0.90 1.00 0.79 0.80 1.00 0.57 0.60 1.00 1.00 1.00 1.00 0.84 0.97 1.00 0.00 0.00 1.00 0.17 0.19 1.00 1.00 1.00 ] 由式 H i = − 1 ln n [ ∑ j = 1 n f i j ln f i j ] 和 f i j = r i j ∑ j = 1 n r i j 计算的评价指标的熵值向量： H = ( 0.754 , 0.753 , 0.877 , 0.919 , 0.922 , 0.878 , 0.878 , 0.945 ) 由式 W e i = ∑ k = 1 m H k + 1 − 2 H i ∑ i = 1 m ( ∑ k = 1 m H k + 1 − 2 H i ) 计算的熵权向量： W e = ( 0.130 , 0.130 , 0.125 , 0.123 , 0.123 , 0.124 , 0.124 , 0.122 ) T 决策者的主观权向量取值为： W s = ( 0.1 , 0.05 , 0.1 , 0.1 , 0.05 , 0.2 , 0.15 , 0.25 ) T 代入公式 W i = W s i ∗ W e i ∑ k = 1 m W s k ∗ W e k 计算得到综合权向量为： W = ( 0.104 , 0.052 , 0.100 , 0.099 , 0.049 , 0.200 , 0.150 , 0.245 ) T 综合刻画 r i j 趋势的联系数为： μ i j = a i j + b i j j + c i j i = r i j r i + r i j − r i − r i j + ( 1 + 2 r i − − r i j r i + − r i − r i j ) j + r i − r i j r i + − r i j r i + i (11) 综合上式并结合相对优属度矩阵 R = ( r i j ) 构造三元联系数决策矩阵 V = ( v i j ) v j = ∑ i = 1 m ω i a i j + ( ∑ i = 1 m ω i b i j ) j + ( ∑ i = 1 m ω i c i j ) i (12) 采用 γ 准则： γ i = 1 1 S h i ( u i ) + 1 = a i a i + c i 对各调度方案进行排序，得到如下计算结果： Table 6 调度方案 μ值 γ值 排序 方案17 0.255 + 0.724j + 0.021i 0.9235938 1 方案18 0.145 + 0.834j + 0.021i 0.8740380 2 方案16 0.060 + 0.928j + 0.011i 0.8414294 3 方案19 0.063 + 0.921j + 0.016i 0.8005570 4 方案12 0.027 + 0.955j + 0.018i 0.6079560 5 方案13 0.026 + 0.955j + 0.019i 0.5690187 6 方案11 0.022 + 0.919j + 0.059i 0.2684715 7 方案14 0.016 + 0.928j + 0.055i 0.2287556 8 方案9 0.021 + 0.724j + 0.255i 0.0764526 9 方案8 0.016 + 0.725j + 0.259i 0.0576372 10 表6. 各方案优劣排序 结果分析：根据上述排序结果可知，方案17为最满意方案。从表6可以看出，水库调蓄后攀枝花洪峰流量、二滩最大下泄流量均为方案集中的最小值，削峰率为所有方案中的最大值，同时，方案17的风险率0.330%也在所有方案指标值中占有绝对优势。与初始方案1相比，二滩最大下泄流量由6680 m 3 /s降低至6290 m 3 /s，降低了5.84%，削峰率由35.62%提高至44.61%，提高了8.98%，风险率由53.49%降低至0.33%，降低了53.16%，有效地减轻了攀枝花市的防洪压力，同时，两库的各项水位指标也都在安全运行范围内，该方案在为攀枝花市错峰的同时，也能很好地保障水库自身的防洪安全。所以综合考虑，将方案17作为梯级水库联合调度的推荐方案。"
"本文针对雅砻江、金沙江交汇处攀枝花市防洪的问题，根据雅砻江锦屏一级、二滩水库的地理位置，提出控泄调度–错峰调度结合的梯级水库防洪优化调度模型，并以攀枝花市最大洪峰流量最小为目标，运用动态规划算法进行求解。首先拟定了初始方案，求解锦屏一级、二滩最优下泄过程，并通过延长错峰时长、减小二滩水库错峰流量，得到20组联合调度方案。随后应用一节季节性自回归模型模拟金沙江干流洪水，计算各方案攀枝花市组合洪峰流量，进而求得防洪风险率。最后利用熵权法–集对分析方法，对防洪方案进行评价优选。最优防洪方案可在保证锦屏一级、二滩水库自身安全的前提下，充分利用两库的防洪库容，减轻攀枝花市的防洪压力，并使攀枝花市的防洪风险率保持在较低水平，本文研究结果可为雅砻江梯级水库汛期防洪优化调度提供参考，为水库调度管理提供支持。"
