"线性稳压电源采用STM32单片机作为主控芯片，使用内部数模转换DAC控制方法，以功率管线性电路为核心电路，实现直流线性稳压电源。单片机输出模拟电压之后，经过OP07运算放大器以及跟随器控制功率管TIP122的基极电压，进而控制输出电压。电路使用高精度采样芯片ADS1256采集直流电压反馈至单片机通过PID算法调节DAC输出的电压大小。经实际研究，改进了减少输出电压纹波的方法。本电源输出电压较为稳定，负载调整率在1%以下。本电源在市电供电时能够输出稳定0~9.9 V可调的直流电压，支持预设电压值以及电流限流值，并设有过流短路保护、输出波形改变功能，输出的电压纹波不超过30 mV。"
"稳压电源应用于各类电器，是必不可少的能源动力，随着设备的性能提升，要求稳压电源具有较高的稳定性和实用性 [ 1 ]。但由于市电整流得到的直流电具有较高的纹波，对设备的损害也较为严重，因此，设计低纹波的直流稳压电源成了必然要求。本设计基于线性电源的设计做了一定的改进，研究了数控线性稳压电源的设计。以STM32作为主控芯片，功率管的线性工作电路为核心输出稳定的直流电压。选用CBB电容以及瓷片电容用以滤除整流后以及输出电压的纹波干扰。使用高精度ADS1256模块对输出电压进行采集形成闭环控制，保证了输出电压的稳定。输出电压以及限流值通过OLED显示屏显示，可以用按键进行电压的步进、预设、电流的限流、波形的改变。电源可实现0~9.9 V的稳压输出，且限流值可从0~500 mA进行调节，实现了稳压电源的数字化和智能化，保证了系统的稳定性。"
"本电源设计采用整流滤波电路模块、单片机控制模块、功率管线性电源模块、ADS1256闭环控制模块、电流采样模块、功率电路稳压模块等部分组成。整流滤波电路模块负责将交流电转化为直流电，功率电路稳压模块负责主电路的电压和电流稳定，ADS1256、电流采样模块、单片机模块共同构成电源的反馈控制，进行稳压、限流、波形变换的输出。市电经过变压器和隔离器降压，经过整流滤波电路得到纹波降低的直流电，直流电经过L7815功率稳压电路得到稳定的15 V电压对TIP122功率管进行供电。单片机经过DAC转换，输出0~3.3 V可调的模拟电压，再通过OP07运算放大器以及跟随器，控制功率管TIP122的基极。通过控制功率管的基极开启电压，进而控制功率管的输出电压，输出电压通过CBB电容以及瓷片电容滤波后，得到纹波较小的直流电。采用ADS1256高精度24位采样芯片作为电压的采集模块采集滤波后的输出电压反馈至单片机，单片机通过内部的PID调节算法调节形成闭环控制从而稳定输出电压。同时，采用康铜丝和INA282芯片进行输出电流的采集反馈至单片机内部进行电流限流控制。电源外设5个按键，一个是状态按键，分别设有步进电压、预设电压、电流限流值预设、波形改变四个状态，单片机内部设有过流保护、短路保护的功能。OLED屏幕会实时显示当前输出的电压值、电流值以及预设的电压值和限流值。当电源的负载过小，输出电流升高超过预设值时，会自动降低输出电压进而保证输出电流的限流稳定，负载阻值变大，需要的输出电流降低，电压会自动升高电压直至预设值。经测试，电源能够稳定输出0~9.9 V的电压，负载调整率低、输出波形可调、限流过流保护正常，系统稳定性较高 [ 2 ]。系统总体设计如图1所示。 图1. 系统总体设计"
"整流滤波电路模块采用全桥整流电路作为主要整流电路，利用二极管单向导通特性将交流电转化为直流电。由于市电不稳定、二极管的特性等因素，得到的直流电会带有较高的纹波。经过理论分析和实际研究，纹波的频率成分较大的是市电频率的两倍，即100 Hz，属于较为低频的纹波噪声，于是我们采用CBB电容以及电解电容、瓷片电容并联用以滤波，得到纹波较小的直流电压。此次整流滤波电路使用的二极管是FR307，可承受的反向电压为1000 V，最大正向平均整流电流为3 A，满足此次设计需要。经过滤波之后的直流电，通过示波器测试之后，纹波有明显的降低，输出直流电较为干净。整流滤波电路如图2所示。 图2. 整流滤波电路图  主电路采用以晶体管为功率放大管的线性电源电路。在该电路中运放的主要作用是电压放大和误差放大。由于单片机DA转换器输出的信号幅值较小，首先通过一级运放将其放大，再经过二级运放稳定输出电压。考虑到对输出波形有一定的要求，因此舍弃了两个运放之间的RC滤波降噪部分。晶体管微弱的结电容效应，使得其在放大电路中具有优秀的噪声抑制能力和交流性能。由于晶体管在工作时会对运放吸入一定的电流，而运放在输出大电流时性能会急剧下降，因此需要选择放大倍数大的晶体管，一般的晶体管放大倍数无法达到，综合考量选择放大倍数为1000的TIP122达林顿管。由于输出电压要求能够达到0 V，因此选择双电源供电的OP07运放，同时其较低的失调电压可以减小放大误差，良好的交流性能将大大减小电压输出噪声 [ 3 ]。线性稳压主电路如图3所示。 图3. 线性稳压主电路图  电流采样电路使用电流感应放大芯片INA282和采样电阻。采样电阻Rs选用温漂小、性能好的康铜丝，与负载串联接与负载串联接于系统输出端，它的两端分别通过RC滤波器接于INA282的IN+和IN−引脚。INA282是高精度、宽共模范围、零漂移的电流监视器，对差分输入的信号具有50倍固定增益的放大输出。为使其增益更好的位于线性区，采用典型接法，两个基准电压值分别接于电源电压和地。同时添加电源旁路电容吸收电源高频噪声。INA282将流过采样电阻的电流信号转化为电压信号，经过RC滤波器，送入STM32单片机中进行采样处理 [ 4 ]。电流采样模块如图4所示。 图4. 电流采样模块电路图  在本设计中，选用24位AD采样芯片ADS1256进行电压的采样，可以精确采集电压小数点后三位，同时配合上内部的PID算法，能够做到电压的精准控制，在利用按键改变输出电压时，能够快速稳压到设定的电压值，且保证上下波动不超过0.05 V。在实际的使用中，选择芯片的输入方式为单端输入，将电压采样点连接到芯片的AIN0处，利用单片机的SPI通信与芯片进行通信，读取芯片中转换过来放入寄存器的值，再与单片机内设定的值进行比较，从而进行输出电压的调节。在芯片的供电中，需要提供一个单独的+5 V电源为芯片供电，保证模块不受其他电压压降的干扰，提供较为稳定的比较电平，从而得到精准的电压采样值，对电源的输出电压做到精准控制。ADS1256的芯片应用方法如图5所示。 图5. ADS1256芯片应用示意图  在整流滤波中，由于前级变压器输出的波动，经过整流后的电压也会有波动，需要在整流电路后级加上一级稳压电路来保证功率管的供电。本设计目的在于制作线性稳压电源，需要较小的纹波，同时最大输出电流能够达到1A，综合考量，选择L7815线性稳压管设计稳压电路。为了尽可能减少直流电中的脉动成分，稳定稳压器输出电压，在稳压电路输入端和输出端并联多个大容量电解电容 [ 5 ]。同时为了降低前级电路和稳压电路产生的纹波，在稳压电路输入输出端并联多个CBB电容。本电源除了在稳压电路采取纹波抑制措施减小前级电路产生的纹波，在后级功率输出部分也设计了LC滤波器以达到减小输出电压纹波的效果 [ 6 ]。功率电路稳压模块如图6所示。 图6. 功率电路稳压模块图"
"系统的软件控制主要分为系统初始化、DAC产生输出、采样程序处理、限流过流保护设计、键盘逻辑控制、OLED显示等，系统供电之后首先完成定时器、DAC、SPI通信、OLED显示、I/O端口的初始化，然后DAC进行数模转换输出预设好的模拟电压值，同时ADS1256模块反馈输出的电压值，通过PID算法调节进行闭环控制。与此同时，单片机ADC端口获得INA282计算电流的值，进行限流过流的监视。电流预设值和电压输出值在初始化是设置为输出9 V、限流500 mA。电源在运行过程中，可以通过外部按键手动控制输出电压以及限流值的设定。在程序的执行过程中，由于PID算法的运行，需要一直调节DAC的输出，需要协调各个程序的优先级，保证系统的稳定性和可靠性。由于OLED屏幕功耗较小，而且此电源的显示过程不繁琐，因此，选用OLED屏幕进行电源状态的显示，包括预设输出电压、限流值、当前输出电压、当前输出电流。通过按键可以更改电源输出状态，更改输出电压值、预设电流值、输出波形形状 [ 7 ]。软件控制主流程图如图7所示。  外设有五个按键，包括一个功能按键、四个设置按键。相应的程序内部设有四种功能，按下功能按键可以实现功能的切换，包括预设输出电压值、预设输出电流值、波形变换、自动步进电压值四个功能。根据不同的功能状态，四个设置分别对应不同的设置处理逻辑。具体的按键功能设计如图8所示。 图7. 软件控制流程图 图8. 按键设计流程图  本电源设置有限流和过流保护两个功能。限流的功能描述为：当负载过小，需要的输出电流超过预设的限流值时，为保证输出电流值的稳定，需要降低输出电压，以保证输出功率的稳定。当负载阻值调大后，相应的输出电压会自动回升，直到升到预设电压值为止。当输出端短路时，电源会自动切断输出，关闭DAC，并同时在OLED屏幕上提醒输出短路。具体的限流过流保护流程如图9所示。 图9. 限流过流保护流程图"
"1) 交流市电输入220 V，按键测试电源输出电压步进稳定情况，直流稳压电源测试范围为0~9.9 V，测试结果如表1。 Table 1 交流输入电压/V 预设输出电压/V 实际输出电压/V 220 0.1 0.105 220 1.1 1.092 220 3.0 2.998 220 5.0 5.089 220 8.2 8.235 220 9.9 9.889 表1. 电源电压输出范围 2)预设电压值为8.2 V，改变负载电阻，测试实际输出电压并计算负载调整率，测试记录如表2。 Table 2 预设电压/V 负载电流/A 电源输出电压/V 8.2 0.105 8.192 8.2 0.203 8.195 8.2 0.311 8.188 8.2 0.408 8.212 8.2 0.503 8.204 8.2 0.600 8.208 表2. 输出电压负载调整率 经过测试得到，随着负载电阻阻值的改变，输出电压在8.2 V左右波动，PID调节稳定。系统的负载调整率 反映的是电流在0~0.6 A范围变化的电压波动，计算公式如下 S 1 = | U o 2 − U o 1 U o 1 | (1) 其中S 1 为电源预设8.2 V时的负载调整率，U o 1 表示电流为0.1 A时的电压值，U o 2 表示电流为0.6 A时的电压值，S I 1 为0.195%。 3) 限流保护测试，预设输出电压为8 V，限流值为500 mA，通过改变负载电阻的大小，测试输出电流及输出电压变化，测试记录如表3。 Table 3 预设输出电压/V 负载电阻阻值/Ω 输出电流/A 实际输出电压 8 15.98 0.499 7.988 8 12.15 0.487 5.917 8 9.87 0.493 4.868 8 8.06 0.508 4.094 8 5.95 0.502 2.988 8 2.98 0.498 1.485 表3. 限流保护测试 4) 测试功能3自动扫描步进，预设输出电压值为2.2 V，设置定时器为4 s，每隔4 s输出电压自动增加1 V，实际测试如表4。 Table 4 时间/s 当前设置电压/V 实际输出电压/V 0 2.2 2.192 4 2.3 2.298 8 2.4 2.401 12 2.5 2.498 16 2.6 2.599 20 2.7 2.708 24 2.8 2.802 表4. 自动扫描步进输出电压 5) 测试功能4波形变换，通过按键可以改变输出电压波形形状，设置有输出正弦波和三角波，通过示波器测试输出电压波形变换如图10、图11所示。 图10. 输出正弦波图 图11. 输出三角波图 6) 通过示波器测试输出直流电压纹波如图12所示。 图12. 输出电压纹波测试图"
"本文主要设计改进了以STM32单片机为核心的数控线性直流稳压电源。采用DAC数模转换配合高精度24位采样芯片ADS1256采集输出电压，并通过系统内PID算法的调节，保证了电源的输出电压稳定。还设计了自动步进、预设电压、预设限流值、波形变换、限流过流保护功能，在负载电阻较小时，能够保证输出电流值不超过限流值，负载电阻变大之后，还可以将电压回升到预设电压值。改进了减小输出电压纹的方法，经实际测试，电源的输出电压稳定，电压纹波较小，限流过流保护得当，具有很好的扩展性和可调性，可以稳定、高效率地应用于多种直流供电设备。"
