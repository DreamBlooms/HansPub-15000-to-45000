"一个地区的能见度不但反映了该地区大气环境的质量，并且与人们的生活有着密切相关的联系。通常，低能见度天气也严重地影响了人们的经济生产，因此其观测具有重要意义。大气环境能见度较低的原因与气象条件有着密切的关联，低能见度的天气现象主要有雨、雪、雾霾、沙尘等。本文提出了一种基于室外单幅自然图像的低能见度天气现象识别算法，该算法通过低能见度天气现象对图像光学信息的影响，提取图像的对比度、饱和度、亮度等特征参数信息进行训练和分类，在训练过程中根据各类别特征之间的距离建立分类决策树，并为决策树构建支持向量机(SVM)分类器，对低能见度天气进行自动分类识别。通过对互联网上的大量低能见度天气光学图像的训练和测试，算法对低能见度的天气现象的平均识别率可达70%。该算法可以为分布式识别提供技术支持，然后采用分布式识别投票，最终可以把识别正确率提高到95%以上。 关键词 :低能见度天气图像，支持向量机，决策树，训练"
"随着今天高新技术的快速发展，当代社会的信息化水平越来越高，图像处理技术也在不断地发展，对室外环境的天气现象，尤其是低能见度恶劣天气的自动地检测和识别提出了更高的要求。在气象领域，对于天气现象的观测依然主要是靠人工来观测，这些观测耗费了大量的人力和物力 [ 1 ] [ 2 ] ；同时，在这个信息爆炸的时代，人们在其生产生活中有大量的信息需要处理，而这些信息大多数来源于图像信息，有研究表明，人们所获取的信息中70%来源于从眼睛获取的图像信息 [ 3 ] [ 4 ] 。在计算机时代以前，人们对于图像的处理主要是光学图像的处理方法，即对光信息进行直接的处理，优点是速度快、信息的容量大，缺点是对环境的要求较高；现在我们主要运用计算机数字图像处理技术，它是随着计算机的产生应运而生的，是将图像的光学信息转换为数字信息再进行处理，具有灵活、方便的特点，且对环境的依赖性较小 [ 1 ] [ 3 ] [ 4 ] ，已经广泛渗透到工业、医疗、运输业、军事等各个领域。本文将数字图像处理技术运用到气象观测领域，建立一种气象监测的自动化模型，使其代替人们的目视观测，因此其具备廉价、方便、灵活等特点，不但可以作为传统气象观测的有益补充，而且能够节省大量的物力、财力。基于图像处理技术的光学气象观测国内外已有不少报道。但是，主要集中在云观测 [ 5 ] - [ 12 ] 、能见度观测 [ 13 ] - [ 18 ] 等观测上。对于其他的天气现象观测，主要集中在阴天和晴天的观测识别上 [ 19 ] [ 20 ] 。对于低能见度四种天气现象(雨、雪、雾霾、沙尘)的观测识别，目前还没有公开报道。 本文旨在通过计算机视觉技术，提取室外光学图像的信息特征，通过学习训练将低能见度的天气图像进行自动地识别分类。但是如何能够准确的、有效的从海量的图像集中得到自己所必须的信息确实是一项富有挑战性的工作。近年来图像分类识别技术得到了长足的发展，出现了许许多多的智能算法，如贝叶斯分类、K-近邻算法、神经网络和支持向量机等 [ 21 ] 。特别值得指出的是，经Vapnik等人多年研究统计学习理论所得到的支持向量机(SVM)具有极好的模拟泛化能力，与往常的建立在经验风险性最小化基础上的模式辨别不同，SVM是基于统计学习理论提出的建立在结构风险最小化基础上的一种新的机器学习方法，有着很强的非线性的处理能力 [ 21 ] 。近年来，SVM已经成为机器学习和数据挖掘领域的标准工具，被越来越多地应用到模式识别、数据挖掘、智能控制以及预测中去，正在成为继模式识别和神经网络之后机器学习领域的研究热点，并将会推动机器学习的重大进步。正是由于SVM在数据分类中拥有着种种的优势，本文将该方法运用到图像的分类中，获得低能见度天气现象的自动识别。"
"图像分类(image classification)即是根据不同图像反映出的不同特征这一原理，把不同类别的图像区别开来的一种应用方法。它利用计算机处理技术，将图像或图像的某一个像元自动地划分到某一个类别中去，以此来代替人们的视觉判读。图像分类一般是先提取图像的颜色、纹理、灰度、形状等底层特征，再利用合适的分类方法进行分类。目前典型的分类方法有以下几种： 1) 神经网络分类 [ 22 ] 的方法 人工神经网络是人们对自身大脑神经网络认识理解的基础上人工构造的可以实现某种功能的网络系统。人工神经网络是对生物神经元的模拟，生物的每一个神经元相当于一个基本单元，且每个单元关联一个权值。神经网络较复杂，需要较长的时间来训练，因而这种方法比较适合训练时间长的应用。神经网络的参数大多数靠总结历史数据所得的经验所得。一般可分为以下几类：人工神经我网络从结构方面讲可以分为前馈网络(如BP网络)和反馈网络(如Hopfield)；从状态方面来讲又可分为离散性网络和连续性网络；从学习的方法方面又可分为监督学习网络(如BP、RBF网络)和无监督学习网络 [ 22 ] (如自组织网络)。 2) 贝叶斯分类 [ 23 ] 方法 这个分类方法的主要思想：先计算每个类别在训练集的分布，将这种分布看作为不同类别的概率分布，最后在测试过程中运用统计学原理和概率统计原理中的贝叶斯定理来估计某个特定样本属于某一类的概率。目前贝叶斯方法主要包括贝叶斯信念网络和朴素贝叶斯方法 [ 23 ] 两类，其中前者在当前社会应用最多，但是这种方法的训练较为复杂，用来评估的函数比较难选，这是现在需要研究解决的问题。 3) 支持向量机方法 支持向量机是在统计学及最优化的基础上来研究如何构建学习机和如何实现分类问题的。它的思想就是要在风险最小的情况下找到一个最优的分类面 [ 24 ] 。它的方法主要是选择一个合适的VC维，在一定数量的样本下，在置信区间达到一个合适的值，使各个类别之间的间距最大，从而使实际风险变小。起初，SVM是用来研究两种类别的分类问题的，但现在人们遇到了更多的分类问题，因此现在SVM的研究热点是如何对多类别问题进行分类。 以上三种方法各有优缺点。人工神经网络是一种传统方法，由于其复杂性应用受到一定限制。贝叶斯方法训练较为复杂，用来评估的函数比较难选，这是现在需要研究解决的问题。而支持向量机是在统计学及最优化的基础上来研究如何构建学习机和如何实现分类问题的。它的思想就是要在风险最小的情况下找到一个最优的分类面，应用广泛。本文将利用支持向量机进行分类。  支持向量机的产生可以称为机器学习范畴的一场伟大的革命，它不但提高了机器的学习能力和非线性处理能力，而且激发了众多学者对核函数和机器学习研究激情。自此以后，针对不同的核函数的优化方法以及支持向量机(SVM)优化算法也层出不穷，使得SVM和核函数理论得到不断地发展和完善。目前，SVM被广泛的运用于人脸识别、文本分类、书写数字识别、特征选择等领域。在前人基础上，本文主要采用图像处理技术提取低能见度天气图像的特征并根据这些特征将图像进行分类，从而构建一个支持向量机的分类器，从而实现低能见度天气现象的自动识别。图像分类的特征有主要颜征、纹理、形状、空间关系等，本文主要提取图像的颜色特征和纹理特征，运用这些特征参数使得该分类器可以准确的根据图像对天气现象进行自动地识别分类。 1) 图像颜色特征的提取 颜色特征的提取和运用这些特征对图像分类的算法是图像分类的基础，当然在选择图像特征是该特征必须是该类图像所特有并区别于其他图像，只有这样的特征才能在图像分类中真正的将目标图像分离出来，其次图像的特征还要能够表现出图像的直观视觉感受。图像的颜色特征往往与图像的场景和物体有关，与其他的视觉特征相比，它不依赖于图像本身的尺寸、方向、视角。例如，沙尘天气图像的色调偏红或黄色，明显区别于其他低能见度天气，降雪天气的图像的亮度明显要高于其他的低能见度天气图像等。 2) 图像纹理特征的提取 依据灰度共生矩阵纹理的原理和提取方法，提取能量、熵、惯性矩、相关性的均值和标准差作为最终8维纹理特征。 3) SVM分类器的设计和分类实现 支持向量机的基本原则是结构风险最小化，具有完善的数学基础和泛化性能。本文将图像分为训练集和测试集两个集合，通过对训练集的特征提取，逐步的构建出SVM分类器，然后在测试集中测试SVM分类器的准确性。对于线性不可分问题，有两种解决方式，第一种为将线性不可分的问题强制线性化，但是这种方法在线性化时需要引入松弛向量。另一种是则是通过核函数的方法解决，用高维德属性空间处理图像数据。通过合适的映射函数，不可分问题在属性空间中变成线性可分的问题。属性空间中的向量的点积与输入空间的核函数对应。这一成果极大的提高了机器的非线性处理能力。目前使用的核函数主要有：线性核函数、P阶核函数、多层感应器核函数和RBF核函数。引入核函数后各式向量的内积可以由核函数代替： ，(1) 。 (2) 对应的分类函数变为： 。 (3) 任选一个支持向量，可以求出 ： 。 (4) SVM利用核函数的方法避免了高维空间中的维度运算，解决了算法上可能出现的“维数灾难”问题，在构造判别函数时，不是对原始样本做非线性变换，然后在特征空间中求解；而是先在输入空间比较向量，对结果再做非线性变换。SVM算法中有很多种不同的核函数 [ 24 ] ，目前研究最多的有三种：多项式核函数，径向基函数(RBF)以及用Sigmoid函数作为内积等。本文根据应验选用多项式核函数模型。对于两类线性可分 [ 24 ] 的问题如图1所示，分割线1 (平面1)与分割线2 (平面2)都可以正确的将样本分开，即在风险为0的情况下，这样的分割线(分割面)有无数多个，但是如果有一条分割线(平面)到两类之间的间距最大，称为最优分类线(平面)。最优分类线(平面)的置信范围最小。 图1. SVM两类线性可分示意图 设线性可分样本集为 ( ； ， 是类别标号)。d维空间中的线性判别函数的一般形式为 ,分类面方程 。决策函数为： 。将判别函数归一化，然后等比例调节系数W和b，这样求间隔最大就转化为求 最小。 所以线性可分的问题转化为求优化问题： ，约束条件： 其中 ，为此，定义Lagrange函数： ，(5) 其中， 为Lagrange函数的系数，我们的问题是对w和b求Lagrange函数的极小值。 将式(5)分别对w和b求偏微分，令他们等于0，就可将原来的凸二次优化问题转化如下较为简单的对偶问题，即在约束条件 之下对 求解函数最大值。 应用SVM进行模式识别的主要步骤如下： ① 选择合适的核函数； ② 求解优化方程，获得支持向量和相应的Lagrange算子； ③ 写出最优分界面的方程； ④ 根据sgnf(x)的值，输出类别。"
"图像特征的提取是图像识别的关键，图像特征的提取直接影响了图像分类的效果。图像分类问题主要有两个方法上的难点，第一是如何选择和提取特征，第二是应该选择怎样的模型进行训练和测试。首先，对于选取的图像特征一定要能够将各类图像有效的、准确的区分开；其次，在处理图像时，必须能保证所得到的图像特征数据确实能够代表这一类图像。 在图2中，可以看出沙尘天气图像在色调上整体偏红或黄色，明显区别于其他的低能见度天气图像，因此从色调这一特征出发便可以将沙尘天气区分出来。 在图3中明显可以看出雾霾天气的饱和度较低，图像近灰白色。 在图4中可以看出，降雨图像雨水形成了一定的纹理，降雪天气的图像整体亮度比其他天气图像要高。 但是如果你想要得到一副沙尘天气图像的色调值，且这个值大体上能够代表沙尘天气，你应该如何 图2. 典型沙尘天气示例 图3. 典型雾霾天气示例 图4. 典型雨雪天气示例 处理每一个像素点的色调，使其得到的色调结果能够真实的反映这张图像。对于图像分类的问题来讲，分类的方法要用哪一种，如果选用支持向量机方法，选用什么样的核函数才能更加的适用。这些问题都是我们在本文中需要考虑的问题。  颜色特征是一种全局特征，表述了图像对应景物的表面性质，这些一般的颜色特征是基于每个像素点的特征，此时图像中所有的像素点都有贡献。图像特征的提取一般运用颜色直方图或颜色距的算法，这些算法容易实现且不受图像平移和旋转的变化所影响，常用的颜色空间有RGB、CMY、HSV、HSL、YUY等颜色空间，本文主要采用HSV颜色空间。 HSV颜色空间是由A.R. Smith等人根据人眼对颜色直观感受而创造出来的颜色空间，它具有三个要素：色调H (Hue)、饱和度S (saturation)、和亮度V (value)。其中亮度(V)是指人眼感受到的光的敏感程度，光能越强，亮度越大，图像亮度仅与图像的明暗有关，与图像的彩色信息无关；色调(H)是指光的颜色，它与混合光谱中的主要光波长相联系，不同的光波长对应不同颜色的光；饱和度(S) [ 11 ] 是指颜色的浓淡程度，饱和度越大，颜色越深，如深红、深蓝，饱和度信息、与人眼对图片颜色的感受紧密相连。从以上方面讲，HSV空间适合处理与色彩有关的图像处理算法。但对图像的三要素来讲，各个要素是相互独立的，因此当我们独立感知单个要素的变化会发现色调信息是最为影响人的视觉感受的特征。HSV颜色模式的直观性使得人们从内心更加容易接受，因而在计算机视觉领域、图像处理等领域应用广泛。  各类低能见度天气图像千变万化，且本文提取图像的颜色特征只能表现出图像的全局信息，但是对于降雪和雾霾图像来讲，它们颜色种类相似，仅仅利用颜色特征是很难将他们区分开来的，因此，除了选用颜色特征之外，我们还需要提取一些可以表现出图像局部信息的特征，本文所选特征为图像的纹理特征。 纹理特征是描述图像表面特征的一种方式，但是它却仅仅只能表示图像的表面特征，不能表现图像的内部属性。因此，想要得到图像的全部特征仅仅靠图像的纹理属性是不能得到的。图像特征也有其独特之处，即它表示的不是具体某个像素点的特性，而是对图像某一区域进行统计运算的而得到的。因此，这种区域性的统计往往就可以将局部的偏差掩盖或者忽略不计，更不会因为局部的偏差而导致匹配的不成功。作为一种统计学特征，它拥有较强的抵抗噪声的能力。常用的纹理特征提取和匹配方法有统计法、几何法、模型法、信号处理法。 灰度共生矩阵(GLCM)是纹理特征分析方法的一种典型代表，Gotlieb和Kreyszig等人在研究灰度共生矩阵的各种统计特征时，通过大量的实验，得到了能量、熵、惯性矩、相关性四个关键特征。该方法是建立在二阶组合条件概率的基础上的，利用灰度共生矩阵来描述纹理特征，能够很好的利用纹理现象中的各种灰度级的空间依赖关系，因此，他在纹理分析中得到了广泛的应用。本文主要通过纹理特征的分析得到了图像能量、熵、惯性矩、相关性的均值和标准差的8维纹理特征。GLCM是描述在θ方向上、相隔d像素距离的一对像素分别具有灰度层i和j的出现概率。显然GLCM是一个对称矩阵，是距离和方向的函数，其阶数由图像的灰度级决定，它可以导出14中纹理特征 [ 14 ] 。尽管GLCM拥有重重的优点，但是这种方法在计算上却是很昂贵，特别耗时，因此不断有研究者尝试对其改进。大部分的研究者采用d取1，θ取0度、45度、90度、135度的方式对特征进行提取，但是实际的效果确实与原来的结果大致相同，并没有引起分类准确率的下降。  本文中共选用了10,000幅低能见度天气图像共分为五个类别，每类1000幅来做训练样本，他们分别是降雨、降雪、雾霾、沙尘。剩余图像用来检验SVM分类器的效果，并进行合理的评估。根据需要，我们得到了各类低能见度天气图像的色调、饱和度、亮度的平均值(去除异常值后)，以及每张天气图像的各个像素点的方差(去除异常值后)和各类天气图像的方差的均值。其中我们将不属于区间(μ − 2σ, μ + 2σ)的值定义为异常值，异常值可能是有图像中人或物对光的反射产生的。 从表1中看出沙尘天气图像的色调均值明显与其他的低能见度天气图像有多不同，沙尘天气图像的色调均值为0.1083，且色调的独立性较好，所以色调信息可以作为一个颜色特征向量来区分沙尘天气图 Table 1 色调 饱和度 明度 雾霾 0.3390 0.1027 0.6321 降雨 0.3226 0.1202 0.5054 降雪 0.3928 0.0453 0.6863 沙尘 0.1083 0.5810 0.7339 表1. 各类天气图像的三要素平均值 像和非沙尘天气图像。但是，当我们注意到雾霾天气和降雨天气图像的特征分布时，色调、饱和度以及亮度的正太分布特征十分的相似，所以这三个参数不能将降雪和雾霾天气图像分离。类似的，降雨和云天阴天图像颜色特征分布中，除了色调有稍微不同外，亮度和饱和度的正太分布特征也十分的相似，因此颜色特征也不能将它们分离开。通过颜色特征的分析，我们虽然可以通过色调信息将沙尘天气图像分离出来，其次通过三种参数综合处理，将雾霾和降雪为一类，云天阴天和降雨为一类，但是降雪和雾霾天气图像，以及云天阴天和降雨还不能通过颜色特征的三个参数分开。因此，我们需要运用提取图像的纹理特征，借此将其分类。  采用灰度共生矩阵的方法，计算样本图像的图像纹理特征。纹理特征与颜色特征一样，在图像处理和分析中时常的被用到，它主要指的是图像灰度或者颜色的某种变化。我们通过灰度共生矩阵的方法来计算四个共生矩阵P，取距离为1，角度分别为0˚，45˚，90˚，135˚，以下结果为处理数据所得到图像的纹理特征(表2)。"
"在图像分类的过程中，我们之选择提取图像的主要特征，而不是直接对原始图像进行操作，是因为直接处理原始图像得到的向量维度大且不易分类。因此，提取图像的主要特征就成为了图像分类的关键。实际来讲，SVM分类是从两类问题的分类所提出的，但是现在我们所要做的工作是对多类图像进行分类，这就需要将两类的问题扩展到多类 [ 12 ] 。本文主要通过三次的分类过程将4中低能见度天气图像分类。最后，SVM分类器的评价标准表现为图像的识别准确率，用公式表示如下： (6) 图5表示将四类低能见度天气分类的具体步骤，其中判别函数为具体分类时所选用的图片特征。图5为本次实验的具体分类步骤，其中判别条件1代表各类天气图像的色调的均值信息，用其作为主要的分类依据将沙尘天气图像分离，判别条件2代表饱和度的方差及均值信息，用其将雾霾天气分离出来，判别条件3用的是图像的纹理特征，主要把降雪天气图像和降雨天气图像分离。 本文共采用了10,000张低能见度天气图像，其中每个类别天气图像2000张，1000张用来提取图像特征，建立分类器，剩下的1000张用来测试向量机的成果，下表3为是实验结果。 从实验结果来看，选取图像颜色特征和纹理特征作为图像分类参数是可行的，其中沙尘天气图像的正确识别率最高，到达82.5%，雾霾天气图像的正确识别率最低，为61.8%。从人们视觉的直观感受来看，雾霾天气图像与降雪天气图像整体上都呈现白色，两种天气的亮度和饱和度大致相同，这就容易将雾霾天气错判为降雪。 Table 2 P_mean E_mean IM_mean R_mean P_std E_std IM_std R_std 沙尘 0.0496 0.7141 0.0886 0.0889 0.0014 0.0195 0.0253 0.0014 雾霾 0.0670 0.7067 0.0315 0.1608 0.0012 0.0139 0.0077 0.0009 降雨 0.0306 0.6895 0.1126 0.0794 0.0030 0.0282 0.0315 0.0021 降雪 0.0158 0.6249 0.2431 0.0258 0.0010 0.0192 0.0565 0.0007 表2. 纹理特征表 注：P_mean表示能量的均值；E_mean表示熵的均值；IM_mean表示惯性距；R_mean相关性的均值；P_std 表示能量的标准差；E_std表示熵的标准差；IM_std表示惯性矩的标准差；R_std表示相关性的标准差 Table 3 天气类型 样本个数 正确识别率 沙尘 1000 82.5% 雾霾 1000 61.8% 降雨 1000 69.6% 降雪 1000 76.4% 表3. 向量机分类识别测试结果 图5. 基于决策树的分类识别过程"
"为进一步提高识别正确率，提高表3中的结果，我们根据同一地区同一时间可以获得同一天气现象下的多幅不同场景图像的特点 [ 2 ] [ 25 ] ，提出了分布式投票识别策略。即对于四类低能见度，每一个待测试样本至少包含3张图像，且这些图像是属于同一个地区(比如某城市某区内，根据微型天气系统尺度理论，理论上来讲图像拍摄地点的距离一般不超过5 km)同一时间(严格来讲无法获得完全时间同步的多幅拍摄图像，但是基于低能见度天气现象的短时稳定性 [ 2 ] [ 25 ] ，大量实验表明一般1小时的时差是可以忍受的，基本不会造成影响)拍摄到的同一天气现象下的多幅不同场景图像(假定为 且为奇数)，这些图像首先分别采用论文第四部分中的方法单独进行类型识别，然后进行投票决定最终识别结果。 设雨、雪、雾霾、沙尘四种天气现象的识别码分别为 。那么对于 幅图像 ，我们有 ， (7) 其中， 否则 。 我们在大连、北京、沈阳、旅顺等城市中针对低能见度天气拍摄了若干幅图像，从中随机选取了若干样本进行测试，测试结果见表4所示。 Table 4 天气类别 样本个数 正确识别率 沙尘 183 97.2% 雾霾 198 95.9% 降雨 243 97.1% 降雪 164 96.9% 表4. 分布式投票识别实验效果 从表4可以看出，其识别正确率均高于95%，远高于表3中单幅图像的识别正确率，证明了我们分布式投票识别策略的有效性。需要说明的是，样本数的选择我们采取随机策略，以避免人为主动性造成的结果倾向偏差。"
"本文利用SVM，结合自动识别模式实现了对低能见度天气图像的自动识别分类。本文主要研究了图像颜色和纹理特征的提取方法和相关的内容，实验发现了不同的特征参数对识别准确率有不可期的影响。我们知道，一个地区的能见度不但反映了该地区大气环境的质量，并且与人们的生活有着密切相关的联系。大气环境能见度较低的原因与气象条件有着密切的关联，低能见度的天气现象主要有雨、雪、雾霾、沙尘等。为了提高图像监控的实时准确性、实现低能见度天气现象的自动观测识别，本文提出了一种基于室外单幅自然图像的低能见度天气现象识别算法，该算法通过低能见度天气现象对图像光学信息的影响，提取图像的对比度、饱和度、亮度等特征参数信息进行训练和分类，在训练过程中根据各类别特征之间的距离建立分类决策树，并为决策树构建支持向量机(SVM)分类器，对低能见度天气进行自动分类识别。通过对互联网上的几万张低能见度天气光学图像的训练和测试，算法对低能见度的天气现象的平均识别率可达80%，表明该算法基本可以实现不同类别天气的自动识别，可以有效地替代人工天气现象识别。 重要的是，由于摄像光学设备广泛应用和无缝覆盖，在同一地区可能有多个不同的摄像/照相机，可以获取同一天气现象同一时间下的不同场景图像，然后用这些同一地点同一时间但是却为不同场景图像的各自分类识别，最后采取投票策略决定最终的识别结果，识别正确率高达95%以上。下一步工作我们将引入多尺度变换方法 [ 26 ] [ 27 ] ，进行多尺度上的天气现象识别。"
