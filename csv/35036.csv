"使用地下水数值模拟软件MODFLOW计算各向异性含水层地下水渗流问题时，不可避免需要考虑以下问题：MODFLOW是否可以使用渗透系数张量进行计算；何种条件下可以进行计算以及如何进行计算的问题。本文通过分析MODFLOW的数学模型、离散方法和差分公式，探讨了MODFLOW中含水层渗透系数张量使用方法、条件和可行性。经过分析认为：MODFLOW可以直接模拟特定条件下的各向异性含水层渗流问题；使用旋转网格方法可以扩展MODFLOW模拟各向异性含水层渗流的应用范围。 关键词 :地下水数值模拟，各向异性含水层，渗透系数张量，MODFLOW Copyright © 2020 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"地下水数值模拟技术广泛应用于地下水资源的评价和研究工作，并为水资源统一管理提供有效的依据 [ 1 ] [ 2 ]。目前国内外常用的地下水数值模拟软件为GMS、Visual MODFLO等软件 [ 3 ]，这些软件主要核心计算模块是采用有限差分法软件。搞清楚MODFLOW的数学模型、离散方法、差分公式等核心内容，将有助于准确的进行地下水数值模拟。 裂隙、岩溶含水层往往具有明显的各向异性渗透特性，使用渗透系数张量来表征(下文简称渗透张量)更为合理。渗透张量主值的大小、方向对地下水渗流场的影响显著，建立一个能够反映含水层的各向异性的数值模型非常关键。G. CHEN等 [ 4 ] 在其文章中认为含水层各向异性特征会对矿山涌水量计算结果带来显著差异。张奇华 [ 5 ]，吴锦亮 [ 6 ] 等学者也都明确指出各向异性含水层的渗透张量主值大小、方向对地下水渗流场模拟影响明显。 MODFLOW有多个版本，当前使用最广泛的是MODFLOW-2005 [ 7 ]。以MODFLOW为核心计算模块进行地下水各向异性渗流场模拟研究的文献有很多；李赛 [ 8 ] 、周鹏鹏 [ 9 ] 、冯爱国 [ 10 ] 、马秀媛 [ 11 ] 、田杰 [ 12 ] 等学者在其文献中都对各向异性含水层数值模拟做出了卓有成效的成果。但这些文献中并未进行较为深入的理论分析，只是设定了渗透张量主值，但没有赋值渗透张量主值的方向。通过分析MODFLOW2005的数学模型、模型单元格的离散方法以及地下水流动方程的差分公式，探讨了MODFLOW-2005中渗透张量主值大小及方向参数的赋值方法、条件和可行性；对使用MODFLOW-2005计算各向异性含水层渗流场明确了使用条件和依据，为准确的进行地下水模拟工作提供有价值的参考。并用实例验证了分析的结果，对比了渗透张量的方向赋值对各向异性含水层渗流场计算结果的影响。"
"2. 地下水运动基本方程 [ 13 ] [ 14 ] 在各向异性介质中，含水介质的渗透系数不再是标量而是一个二阶对称正定张量，在三维空间可表示为： K = [ K x x K x y K x z K y x K y y K y z K z x K z y K z z ] (1) 当坐标轴与渗透张量的主方向一致时，则有 K = [ K x 0 0 0 K y 0 0 0 K z ] (2) 式中：K为渗透系数；此时渗透系数主值K x = K xx ，K y = K yy ，K z = K zz ；K xy 、K xz 、K yx 、K yz 、K zx 、K zy 为渗透张量各分量。 由达西定律可以得出三维条件下各向异性含水层中地下水流动基本方程： ∂ ∂ x ( K x x ∂ H ∂ x ) + ∂ ∂ x ( K x y ∂ H ∂ y ) + ∂ ∂ x ( K x z ∂ H ∂ z ) + ∂ ∂ y ( K y x ∂ H ∂ x ) + ∂ ∂ y ( K y y ∂ H ∂ y ) + ∂ ∂ y ( K y z ∂ H ∂ z ) + ∂ ∂ z ( K z x ∂ H ∂ x ) + ∂ ∂ z ( K z y ∂ H ∂ y ) + ∂ ∂ z ( K z z ∂ H ∂ z ) + ω = S s ∂ H ∂ t (3) 当渗透张量主方向与坐标轴方向一致时上述方程简化为： ∂ ∂ x ( K x x ∂ H ∂ x ) + ∂ ∂ y ( K y y ∂ H ∂ y ) + ∂ ∂ z ( K z z ∂ H ∂ z ) + ω = S s ∂ H ∂ t (4) 当含水层为各向同性介质时式(4)进一步简化为： ∂ ∂ x ( K ∂ H ∂ x ) + ∂ ∂ y ( K ∂ H ∂ y ) + ∂ ∂ z ( K ∂ H ∂ z ) + ω = S s ∂ H ∂ t (5) 或： ∂ 2 H ∂ x 2 + ∂ 2 H ∂ y 2 + ∂ 2 H ∂ z 2 + ω = 1 K ( S s ∂ H ∂ t − ω ) (6) 式中：ω为地下水源汇项；S s 为含水介质的贮水率；t为时间；H为水头。 上式表明，在各向异性介质中x方向的水流一般与水力梯度的所有三个分量有关，y方向和z方向的水流也一样。通过对方程(3)~(6)的观察，地下水流动基本方程的形式与下列情况有关：1) 含水介质的渗透性的各向异性与否；2) 渗透张量主方向与坐标轴方向平行或一致与否。 方程式(5)和式(6)表示含水介质各向同性，含水层渗透性只用一个标量渗透系数K来表征即可；式(4)表示含水介质各向异性，渗透张量主方向与坐标轴方向一致，渗透张量可用式(2)表征，此方程使用范围最为广泛；式(3)表示含水介质各向异性，渗透张量主方向与坐标轴方向不一致，渗透张量用式(1)表征。式(3)的方程是一个通用的方程，但其形式复杂，很少直接使用该方程进行地下水数值计算。"
"根据MODFLOW2005手册，三维条件下地下水流经孔隙介质的过程可以使用以下偏微分方程表示 [ 9 ]： ∂ ∂ x ( K x x ∂ h ∂ x ) + ∂ ∂ y ( K y y ∂ h ∂ y ) + ∂ ∂ z ( K z z ∂ h ∂ z ) + W = S s ∂ h ∂ t (7) 式中：K xx ，K yy ，K zz 假设渗透系数主方向与坐标轴方向平行时，分表表示沿x，y，z三个坐标轴方向的渗透系数(L/T)；W表示水源和/或汇的单位体积的体积通量，其中W < 0表示从地下水系统流出，W > 0表示流入系统(T −1 )；h为地下水水头(L)；S s 为含水层贮水率(L −1 )；t为时间(T)。 MODFLOW-2005地下水流动方程有限差分法的差分公式均以式(7)为基础。不难看出式(7)与式(4)一致。可以认为：从数学模型上来看，MODFLOW-2005可以处理或计算的含水层介质为各向异性、渗透张量主方向与坐标轴一致的地下水渗流场。  MODFLOW-2005中首先是对研究范围进行空间和时间的离散化；然后赋边界条件、初始条件、源汇项；之后再对地下水流方程作用有限差分格式的变换，形成线性方程组进行迭代求解；最终得到研究范围内的地下水水头分布、流场、水量均衡等信息。 MODFLOW-2005的空间离散化方式为六面体单元格的单元中心系统，主要特点是单元格所代表的水头位置是单元中心，单元边界构成该单元的流量均衡区域。所以其在计算水量均衡方面可以得到较好的精度；此外，该方法也避开了对地下水渗流方程的各项的直接差分化，使其求解速度较快 [ 9 ]。单元间流量均衡如图1所示。 图1. 地下水由 i , j − 1 , k 单元格流入 i , j , k 单元示意图 根据图1所示，利用达西定律，两个单元格之间的流量大小可以用下式的差分公式来表示； q i , j − 1 / 2 , k = K R i , j − 1 / 2 , k Δ c i Δ v k ( h i , j − 1 , k − h i , j , k ) Δ r j − 1 / 2 (8) 式中： h i , j , k 为格点 i , j , k 中的水头值； q i , j − 1 / 2 , k 为流经单元 i , j , k 和单元 i , j − 1 , k 接触面的水流量(L 3 T −1 )； K R i , j − 1 / 2 , k 为沿行方向格点 i , j , k 和格点 i , j − 1 , k 间的水力传导系数(LT −1 )； 为垂直于行方向的单元面的面积(L 2 )； Δ r j − 1 / 2 为格点 和格点 i , j − 1 , k 间距离(L)。 同理也可以写出其它方向单元格间的水量交换。由公式(8)可得出，相邻单元格之间的水量交换需要垂直穿过两个单元接触面；在各向同性含水层中，由于渗透系数无方向性，上述差分公式可以完全满足计算要求。而当含水层渗透性为各向异性时，情况将变的复杂。 为了更好的表现含水层渗透性的各向异性，使用渗透椭圆表示含水层渗透性，如图2所示。图2A代表渗透张量主值方向与模型空间坐标轴一致，图2B代表渗透系数张量主值方向与模型空间坐标轴方向不一致。 当含水层渗透张量的主值方向与模型空间坐标轴方向一致时(图2A所示)，只要分别指定x、y方向上的渗透系就可以很好的模拟含水层渗透性的各向异性；在MODFLOW2005中提供了一个系数用于表示x，y方向渗透系数的比值；两个方向水力传导系数的差分公式为： T R i , j , k = Δ v i , j , k H K i , j , k (9) T C i , j , k = Δ v i , j , k H K i , j , k H A N I i , j , k (10) 式中： T R i , j , k ， T C i , j , k 分别表示 i , j , k 单元格沿x，y方向上的水力传导系数； H K i , j , k 表示 i , j , k 单元格x方向上的渗透系数； Δ v i , j , k 为 i , j , k 单元格厚度； H A N I i , j , k 为 i , j , k 单元格y方向与x方向的渗透系数比值。 由公式(9)，(10)可以看出MODFLOW-2005中是使用一个比值 H A N I i , j , k 来表示x，y方向上渗透系数。可以使用更为直观的表示方法，即 H A N I = K y K x (11) 在MODFLOW-2005中，垂直方向的渗透系也有类似的方法表示，此处不再赘述。 图2. 渗透系数张量椭圆 但当含水层渗透系数张量的主方向与x，y方向不一致时，如果是图2B所示，不同含水层的渗透张量主值大小不同且主方向也不相同，这种情况下如果要进行数值求解，需要计算出两个相邻单元格之间垂直于接触面方向的渗透系数值，才能计算两单元格之间的水量交换以及水头值，而不能直接使用单元渗透张量值进行计算。即式(8)不能直接套用；理论上讲，MODFLOW2005无法直接处理这一情况；也即无法处理式(3)所表征的地下水流动形式。  参考图1及式(8)的含意，可以发现，如果能使所有网格中的渗透系数张量的主值方向与网格方向一致时，式(8)仍然可以成立。也就是说可以把网格进行旋转，当旋转角度与渗透张量主值方向一致时式(8)满足。 图3所示即通过网格旋转的方式使得各网格方向与渗透张量主值方向一致时的示意图；从图中可以看出，地下水渗流模型中不需要所有单元格渗透张量完全一样，各单元格渗透张量主值方向相互平行或垂直均可。MODFLOW中可以对每一个网格独立设置渗透系数值，所以各单元格的渗透主值的大小可以不同，但对其方向性有要求。 对比图2B的情况可以发现，图3中所示的情况是图2B的一种特殊情况，尽管如此，网格旋转的方式也可以较好的扩展MODFLOW-2005的使用范围。 图3. 网格旋转与渗透张量主值方向匹配"
"本次研究实例是一个金属矿山，矿山涌水全部由1360 m的中段排水巷道集中排出地表，周边无其它明显的地下水出露点。岩性主要为三叠系碳酸盐岩地层，可概化为有统一水力联系的潜水含水层。整个含水层裂隙、岩溶强烈发育，通过野外的调查、示踪试验、抽水试验等工作，发现含水层具有强烈的各向异性。矿山所在水文地质单元地下水补给来源有降雨和地下径流。大气降雨垂直补给地下水，地下水位季节变动带变幅很大，可大于150 m。区内地下水全部向巷道汇集，周边地下水会通过导水断裂补给研究区地下水含水层 [ 15 ]。 根据区域水文地质资料，矿区周边由四条断裂围绕，可作为水文地质边界。南、北边界断裂为导水断裂，根据水量均衡分析后，可作为给定流量边界。东、西断裂为隔水边界。矿山底部为花岗岩体，为良好的隔水层。  野外进行了大量的针对构造成因的节理、裂隙测量工作；测量项目为裂隙倾向，倾角，延伸长度，密度，隙宽等属性。测量总面积约133 km 2 ，共取得地表裂隙测量数据4412组。根据节理统计规律，使用GEOFRAC [ 16 ] 方法模拟了研究区内的裂隙网络。使用等效渗透系数张量数值法 [ 17 ] 计算出了区含水层的渗透系数张量。 研究区垂向上岩溶发育呈现明显的分带特征，根据垂向岩溶发育规律，研究区含水层垂向上划分为两层。渗透张量计算结果：第一层水平方向渗透张量为 K = [ 0.64         0     0         0.43 ] m / d ，主渗透方向135˚；第二层为 K = [ 0.38         0     0         0.25 ] m / d ，主渗透方向135˚。  研究区地层概化为三层，第一和第二含水层介质岩性为碳酸盐岩，具有不同透水性；第三含水层是花岗岩，为弱透水层，作为隔水底板。第一含水层受地形和岩溶发育影响，其水水平方向渗透性为各向异性，划分为三个类型区(图4(a)，表1)，2，3区渗透系数偏小。根据岩溶发育程度研究区降雨补给区分为两个区，并依据降雨量(图5)数据计算出每一个区内月平均入渗量。其它含水层属性参数见表1。 矿山排水巷道以水平巷道为主图4(b)所示。根据巷道的尺寸、防水措施，巷道的导水率不同，划分为三个类型。各类型巷道的导水系数分别是：主出口巷道导水系数5.16 (m 2 /d)/m，主巷道导水系数25.80 (m 2 /d)/m，支巷道10.32 (m 2 /d)/m。所有巷道采用Drain计算包进行模拟。 含水层渗透张量的必须在模型网格划分时进行处理。根据渗透张量的主方向值，我们建立模型时对网格进行了围绕Z轴旋转了135˚ (图6)。降雨量及观测涌水量数据的记录时间段是2014年1月1日至2014年12月31日。模型网格尺寸为100 m × 100 m，网格数量为21,885。模型计算时，地下水流场为非稳定流模式。模型的时间应力期2014-1-1至2014-12-31，共60个计算应力期。 Table 1 参数 1_1含水层 1_2含水层 1-3含水层 含水层2 含水层3 水平渗透系数K(m/d) 0.64 0.45 0.40 0.38 0.038 水平各向异性系数(K y /K x ) 0.67 0.67 0.67 0.67 1.00 水平各向异性系数(K z /K x ) 1.50 1.00 0.80 0.80 1.00 贮水系数 0.07 0.06 0.047 0.047 0.002 孔隙率 0.07 0.06 0.047 0.047 0.002 表1. 各含水层主要参数 图4. 水文地质概念模型 图5. 实测降雨量及涌水量"
"模拟计算结束后，对Drain流量进行统计，作用巷道计算涌水量。对比模拟计算的涌水量与观测涌水量值，发现两曲线趋势总体一致(图7)。说明所建立的地下水数值模型基本符合实际情况。 图6. 数值模型网格 (B、C网格围绕Z轴旋转135°) 图7. 实测与计算涌水量对比图"
"为了能在数值模型中观察渗透张量的方向性对涌水量计算的影响，本文设计了三种网格模型进行对比分析： 1) 模型A，模型网格绕Z轴旋转135˚ (图6)，水平渗透系数各向异性(K y /K x ) 0.671(前文中已验证的模型)； 2) 模型B，模型网格绕Z轴旋转0˚ (图6)，水平渗透系数各向异性(K y /K x ) 1.0； 3) 模型C，模型网格绕Z轴旋转0˚ (图6)，水平渗透系数各向异性(K y /K x ) 0.671；三个模型都使用非稳定流计算模式，然后对比计算结果。 图8. 三种模型涌水量计算结果对比图 观察计算结果(图8)的模拟出的涌水量变化曲线，可以看出，1) 把含水层当作各向同性的均质含水层时，计算结果最大(模型B)，与实测值偏差也最大；2) 只考虑含水层渗透张量主值大小，而不考虑主方向性时，计算结果仍然明显偏大(模型C)；3) 使用网格旋转方法，即考虑了含水层渗透张量主值的大小，也实现了主方向的赋值，计算结果与实测值最为接近，效果最好(模型A)。"
"根据前文的理论分和实例模型对比，可以得到以下结论： 1) 在使用MODFLOW-2005模拟各向异性含水层地下水渗流场时，只依靠x，y方向上渗透系数的比值HANI参数，只能反映出渗透张量主值的大小，不能合理的反映渗透张量主方向； 2) MODFLOW-2005中可以使用网格旋转的方法来匹配含水层渗透张量主值的主方向；但其使用前提是各含水层渗透张量主值方向相互平行或垂直； 3) 当含水层渗透性具有明显的各向异性时，地下水渗流场的计算和模拟会明显受到含水层渗透系数张量主值的主方向的影响； 4) 对各向异性含水层而言，渗透张量主值的方向性对地下水渗流场的影响显著，尤其涉及到有方向性的线状的排导水设施，对涌水量计算结果尤为重要。"
