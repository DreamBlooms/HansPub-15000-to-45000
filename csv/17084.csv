"为了满足变压器保护可靠性、速动性和灵敏性的要求，以TI公司的DSPF28335为控制核心，编写算法设计变压器的保护装置。以二次谐波制动的方法躲过变压器合闸时的励磁涌流，利用纵联差动保护作为变压器主保护，利用过电流保护作为后备保护。利用MATLAB/Simulink搭建110 kV/11 kV等级的变压器模型，设置相应的故障，在半实物仿真平台RT-LAB上验证保护装置的性能。 关键词 :变压器，微机保护，DSP，RT-LAB"
"在电力系统中广泛地用变压器来升高或降低电压。变压器是电力系统不可缺少的重要电气设备。它的故障将对供电可靠性和系统安全性带来严重影响，同时大容量的电力变压器本身也是很贵重的装置。因此需要根据变压器容量等级和重要程度安装性能良好、动作可靠的继电保护装置[ 1 ] 。 本文将设计以DSPF28335为控制核心的变压器保护装置，保护装置的主要功能为区分变压器区内和区外故障，断开故障电路，保护能够躲过励磁涌流。在MATLAB/Simulink中搭建变压器的数学模型，进行变压器区内短路、区外短路的仿真[ 2 ] [ 3 ] 。编写相应的算法程序，纵联差动保护差动电流和过电流保护的电流有效值采用傅里叶变换计算有效值的方法，躲过励磁涌流采用二次谐波制动，也是利用傅里叶变换计算基波和二次谐波的有效值。 TMSF28335 DSP是TI公司新推出的一款浮点型数字信号处理器。这款DSP既保持了原有DSP芯片的优点，又能够执行复杂的浮点运算，频率可达到150 MHZ，具有精度高、成本低、功耗小、外设集成度高、数据及程序存储量大和AD转换更加精确等优点[ 4 ] 。 最后，在半物理仿真平台RT-LAB上验证保护装置的性能，RT-LAB实时仿真系统是加拿大Opal-RT公司开发的一套基于模型的设计和测试应用平台，广泛应用于科研和工程设计。它将Simulink、SystemBuild等建模工具所搭建的数学模型，通过上位机和多台目标机的模式，将仿真模型放置在实时仿真平台上运行，从而方便地实现对大型复杂的硬件在环和快速控制原型的实时仿真进行分布式并行计算[ 5 ] [ 6 ] 。本文的设计利用RT-LAB将短路电流输出给DSP采样，DSP输出跳闸信号给RT-LAB。"
"本设计的核心控制板中，使用DSP28335为核心处理器。变压器保护的硬件电路框图如图1所示，包括数据采集模块、CPU模块、电源电路模块、开关量输入输出模块、复位电路及JATG下载口电路模块等[ 7 ] 。 以系统硬件框图为基础为本变压器保护装置设计了基于DSPF28335的核心板，以便于程序的开发和升级。"
"根据变压器保护的需要，设计了基于DSPF28335的采样程序、差动保护的程序、过电流保护的程序。使用的开发环境是TI公司提供的CCS (Code Composer Studio)软件，本设计使用的是CCS3.3的版本。 图1. 系统硬件框图  TMS320F28335内部的A/D转换模块是一个12位具有带流水线的模数转换器。该模块包含了前端模拟多路复用开关(MUX)、采样/保持(S/H)电路等。该模块还具有16个通道，可以配置为两个独立的8通道模块，分别为ADCINA0至ADCINA7、ADCINB0至ADCINB7 [ 8 ] 。 本装置的采样程序设计为6路通道的顺序采样，使用的通道为ADCINA0~ADCINA5，设定的采样频率为2400 HZ，即一个周波(0.02 s)采样48个点，使用EPWM为采样的触发信号。采样值与转换的数字值之间的关系为： (1) 其中N为转换的数字值，V为采样的模拟值，在使用时将ADCLO端接地，因此数字值和模拟值是一个线性对应的关系。  电流的有效值是采用傅里叶变换来计算，需要计算基波的有效值，差动电流基波的有效值。 傅里叶级数算法的基本思路来自傅里叶级数，算法本身具有滤波作用。它假定被采样的模拟信号是一个周期性时间函数，除基波外还含有不衰减的直流分量和各次谐波[ 9 ] ，可表示为： (2) (3) (4) 式中：a n 、b n 分别为直流、基波和各次谐波的正选项和余弦项的振幅。 因为DSP处理的是离散信号，所以需要将连续的信号离散化，用梯形法则可以求得： (5) (6) 式中：N为基波信号的一周期采样点数； x k 为第次采样值； x 0 、x N 分别为k = 0和k = N时的采样值。 因此，可以根据，求出有效值和相角如式(7)和(8)所示： (7) (8)"
"RT-LAB半实物仿真系统结构如图2所示。半实物仿真系统由上位机、目标机以及硬件实物组成。RT-LAB实时仿真系统包括上位机和目标机。上位机装有MATLAB/Simulink等图形化建模工具和RT-LAB软件包，可以完成系统建模、在线参数调节和信号监测等工作。目标机是Opal-RT公司专为半实物仿真应用而设计的基于PC的实时仿真器，内部配置有多核处理器，装有QNX或者Redhat实时操作系统，可以完成复杂系统模型的分布式实时计算。 Simulink仿真模型在RT-LAB中的模型如图3所示，需要将6路模拟信号配置给板卡输出，将跳闸信号配置给板卡输入。将变压器的MATLAB/Simulink仿真模型放在RT-LAB中运行，将变压器高压侧和低压侧的电流以模拟信号的形式送出给保护装置采样，并设置区内和区外故障 [ 10 ] ，检验保护装置的性能。具体的保护装置和RT-LAB实验系统如图4所示。"
"图5(a)显示了差动保护的实验波形，图5(b)显示了过电流保护的实验波形。 图2. RT-LAB半实物仿真系统结构图 图3. RT-LAB半实物仿真系统结构图 图4. RT-LAB实验验证系统图 图5. 差动保护和过电流保护实验波形 在Simulink中将变压器的区内故障设定为仿真开始后5.2 s发生，故障为三相短路，图5(a)三个波形从上到下依次为变压器高压侧的电流、变压器低压侧的电流、保护装置的跳闸信号，DSP的GPIO52口在系统正常运行时输出高电平，在检测到差动电流时输出低电平，从第三个波形看出从短路发生到DSP发出跳闸信号大概经过25 ms，能够快速切除故障。 在Simulink中将变压器的区外故障设定为仿真开始后7.2 s发生，故障为三相接地短路，由于过电流保护是后备保护，延时1 s动作，图5(b)三个波形从上到下依次为变压器高压侧的电流、变压器低压侧的电流、保护装置的跳闸信号，DSP的GPIO52口在系统正常运行时输出高电平，在检测到差动电流时输出低电平，从第三个波形看出从短路发生到DSP发出跳闸信号大概经过1.026 s，能够起到保护作用，切 图6. 差动保护和过电流保护在示波器中的波形 除变压器低压母线故障。 将高压侧的a相的电流和DSP的跳闸信号输入到示波器中，利用示波器的捕捉功能将跳闸瞬间的波形捕捉，波形如图6所示图6(a)为差动保护在示波器中的波形，图6(b)为过电流保护在示波器中的波形。由于DSP只能采样0~3 V的信号，而变压器两侧的电流是正弦信号，根据变压器高压侧和低压侧正常运行和短路时电流的大小，将原边和副边的信号分别进行式(9)、(10)的变换 (9) (10) 从示波器的波形图6(a)中可以看出短路故障在35 ms发生，在60 ms时DSP发出跳闸信号，切除故障的时间约为25 ms。"
"本文结合电力行业变压器保护标准规范的要求，设计了一种基于DSP的变压器保护装置，进行了硬件、软件等的设计。通过半实物仿真平台RT-LAB的实验验证，本文设计的变压器保护装置能够满足变压器保护的可靠性、速动性、选择性的要求，能够区分变压器区内和区外故障，并且准确切除短路故障。"
