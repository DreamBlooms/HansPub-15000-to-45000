"本文在GARCH(1,1)模型的基础上，运用Pair Copula降维法探究非线性结构的股票市场间相关性。我们基于4种不同的残差分布来构建GARCH(1,1)模型，对比发现只有残差服从广义误差分布时，模型通过显著性检验，从而找到相对好的金融资产序列的边缘分布拟合模型。我们使用Pair Copula降维方法，依据AIC/BIC准则(赤池信息准则/贝叶斯信息准则)，发现D-Vine结构比C-Vine结构更适合描述股票市场间相关关系，于是最终选用D-vine结构来构建市场间相关结构的Pair Copula函数。 关键词 :Pair Copula，GARCH(1,1)，残差，股票市场 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"经济全球化的发展致使各国之间愈加紧密的经济联动，如果某一国家的金融领域发生危机，危机将在各国金融市场间快速传播。为了降低金融危机的负面影响，人们愈加重视金融市场间关联性的研究。在准确把握市场关联性的基础上进行金融对冲，投资获利的同时有效降低商业风险。 在非线性金融市场相关关系研究方面，Copula函数有着显著的优势，由Embrechts等 [ 1 ] 开创了将其应用于金融领域的先河。Copula函数的概念经由Sklar [ 2 ] 提出，文献 [ 3 ] [ 4 ] [ 5 ] [ 6 ] 对其进行进一步研究。后来为了降低高维相关性研究的难度，解决单一Copula函数的约束性，Bedford等 [ 7 ] 首次于研究中应用了藤Copula结构，Aas等 [ 8 ] 提出了藤Copula降维方法即Pair Copula降维法。 研究金融资产相关性最重要的前提条件是确定资产收益率序列的拟合模型，即边缘拟合模型。Engle Robert [ 9 ] 发明了ARCH模型(自回归条件异方差模型)，但当模型残差序列的异方差函数具有长期自相关性时，ARCH模型的拟合精度会受到影响。为此Bollerslev [ 10 ] 以ARCH模型为基础，提出了GARCH模型(广义自回归条件异方差模型)，该模型很好地描述出市场波动的异方差性和波动集群性。 在动态研究金融变量间的相依关系领域，韦艳华等 [ 11 ] 利用Copula-GARCH模型建立金融市场间的非线性相关关系，优点是边缘拟合GARCH模型残差择优服从t分布或GED分布，缺点是高维相关结构整体为Gaussian Copula函数。黄恩喜等 [ 12 ] 基于Pair Copula-GARCH-t模型研究了三只股票的相关关系，缺点是GARCH模型残差只考虑服从t分布，优点是运用藤Copula结构将高维相依分离为多个二维相依Copula，但二维Copula结构统一为t-Copula函数。宋志坚 [ 13 ] 运用Copula-GARCH模型研究国际原油价格与三种可再生能源股价的相关性，缺点是边缘拟合只考虑残差服从t分布，优点是二维相关性研究采用四种Copula函数中较适合模型。 由于，GARCH模型的残差分布影响边缘拟合的效果，在拟合边缘分布时需要多比较几种残差分布，根据模型的实际拟合效果选取较好的模型。运用C-Vine结构或D-Vine结构的Pair-Copula降维法将高维相关研究转化为多个二维相关时，两种Pair-Copula降维结构在三维时一样但其余高维存在优劣，而且转化成的二维相关性可能有各自的特点且适合不同的Copula函数。因此，本文在GARCH模型中比较了残差服从四种不同分布的情况，选出较优的边缘分布拟合模型，并在此基础上，参考李嘉琪等 [ 14 ] 研究中较全面的二维Copula函数族，使用Pair Copula降维法来研究四维股票市场联动风险特征。"
"Copula理论即可以将一个联合分布函数分解成多个边缘分布函数和一个Copula函数，适合描述多维随机变量相关关系的复杂性。 定理 [ 2 ] ：令 F 为一个 n 维随机向量的联合分布函数，其中各变量的边缘分布函数记为 F i ，那么一定存在一个Copula函数 ，使得 ，其中 F i ( x i ) ∈ ( 0 , 1 ) , i = 1 , ⋯ , n 。若边缘分布函数 F i 是连续的一元函数，则Copula函数 C 的形式是唯一确定的。 Copula理论发展出了各种形式的家族函数，经常使用的类型主要分为两类：一类是椭球Copula，常用的包括Gaussian Copula和t-Copula；另外一类是由生成函数 φ ( t ) ( t 为边缘分布)生成的阿基米德Copula，包括Clayton Copula、Gumbel Copula和Frank Copula。其中以边缘分布函数( u , v )为自变量的二元Gaussian Copula、t-Copula、Clayton Copula、Gumbel Copula、Frank Copula [ 14 ] 分布函数具体的表达式分别如式(1)~(5)所示。 C 1 ( u , v ; ρ ) = ∫ − ∞ Φ − 1 ( u ) ∫ − ∞ Φ − 1 ( v ) 1 2 π 1 − ρ 2 exp ( − ( s 2 + r 2 − 2 ρ s r ) 2 ( 1 − ρ 2 ) )   d s d r (1) 式中： Φ − 1 ( • ) 为标准正态分布函数 Φ ( • ) 的逆函数；相关系数 ρ ∈ ( − 1 , 1 ) ； s , r 分别为 的自变量。 C 2 ( u , v ; ρ , m ) = ∫ − ∞ T m − 1 ( u ) ∫ − ∞ T m − 1 ( v ) 1 2 π 1 − ρ 2 exp [ 1 + − ( s 2 + r 2 − 2 ρ s r ) m ( 1 − ρ 2 ) ] − m + 2 2 d s d r (2) 式中： T m − 1 ( • ) 为自由度是 的一元t分布函数 T m ( • ) 的逆函数；相关系数 ； 分别为 的自变量。 C 3 ( u , v ; θ ) = ( u − θ + v − θ − 1 ) − 1 θ (3) 式中：生成函数 φ ( t ) = t − θ − 1 θ , θ ∈ ( − 1 , ∞ ) \ { 0 } 。 C 4 ( u , v ; θ ) = exp ( − [ ( − ln u ) 1 θ + ( − ln v ) 1 θ ] θ ) (4) 式中：生成函数 。 C 5 ( u , v ; θ ) = − 1 θ ln ( 1 + ( e − θ u − 1 ) ( e − θ v − 1 ) e − θ − 1 ) (5) 式中：生成函数 φ ( t ) = − ln e − θ t − 1 e − θ − 1 , θ ≠ 0 。  为了降低Copula函数研究多维变量相关性的复杂程度，Aas等 [ 8 ] 提出了对Copula降维的Pair Copula分解法，即令 X = [ x 1 , x 2 , ⋯ , x n ] 为 n 维随机变量，其联合分布概率密度函数可分解为式(6)。 f ( x 1 , x 2 , ⋯ , x n ) = f n ( x n ) ⋅ f ( x n − 1 | x n ) ⋅ f ( x n − 2 | x n − 1 , x n ) ⋯ f ( x 1 | x 2 , ⋯ , x n ) (6) 以四维随机变量为例，有星型结构的C-Vine (表达式如式(7)所示)和平行结构的D-Vine (表达式如式(8)所示)两种藤结构对其四维Copula函数进行降维。 f ( x 1 , ⋯ , x 4 ) = f 1 ( x 1 ) f 2 ( x 2 ) f 3 ( x 3 ) f 4 ( x 4 ) c 12 ( F 1 ( x 1 ) , F 2 ( x 2 ) ) × c 13 ( F 1 ( x 1 ) , F 3 ( x 3 ) ) × c 14 ( F 1 ( x 1 ) , F 4 ( x 4 ) ) × c 23 | 1 ( F ( x 2 | x 1 ) , F ( x 3 | x 1 ) ) × c 24 | 1 ( F ( x 2 | x 1 ) , F ( x 4 | x 1 ) ) × c 34 | 12 ( F ( x 3 | x 1 , x 2 ) , F ( x 4 | x 1 , x 2 ) ) (7) f ( x 1 , ⋯ , x 4 ) = f 1 ( x 1 ) f 2 ( x 2 ) f 3 ( x 3 ) f 4 ( x 4 ) c 12 ( F 1 ( x 1 ) , F 2 ( x 2 ) ) × c 23 ( F 2 ( x 2 ) , F 3 ( x 3 ) ) × c 34 ( F 3 ( x 3 ) , F 4 ( x 3 ) ) × c 13 | 2 ( F ( x 1 | x 2 ) , F ( x 3 | x 2 ) ) × c 24 | 3 ( F ( x 2 | x 3 ) , F ( x 4 | x 3 ) ) × c 14 | 23 ( F ( x 1 | x 2 , x 3 ) , F ( x 4 | x 2 , x 3 ) ) (8) 式中： F ( ⋅ ) 为边缘分布函数； f ( ⋅ ) 为边缘密度函数； c ( ⋅ ) 是二维Pair Copula密度函数。  采用GARCH ( p , q ) 模型能够很好的描述收益率序列的尖峰、厚尾、非对称、波动聚集等特征，模型构建如式(9)所示。 { R n t = μ n + ε n t , ε n t = σ n t z n t , σ n t 2 = ϖ n + α n 1 ε n , t − 1 2 + ⋯ + α n q ε n , t − q 2 + β n 1 σ n , t − 1 2 + ⋯ + β n p σ n , t − p 2 , (9) 式中： μ n 是第 n 项收益率序列 R n t 的均值；误差 ε n t 的条件方差是 σ n t 2 ；残差 z n t 与 相互独立；常数 ϖ n > 0 ；常数 α n i ≥ 0 , β n j ≥ 0 且 ∑ i = 1 q α n i + ∑ j = 1 p β n j < 1 , p > 0 , q > 0 ，其中 q 是ARCH项的阶数、 p 是GARCH项的阶数。 确保模型稳定性，将阶数设为1，则本文数据边缘拟合GARCH(1,1)模型如(10)所示。 { R n t = μ n + ε n t , ε n t = σ n t z n t , σ n t 2 = ϖ n + α n 1 ε n , t − 1 2 + β n 1 σ n , t − 1 2 , (10) 式中： 、 ϖ n 、 α n 1 和 β n 1 为待估参数。 本文基于GARCH(1,1)模型拟合边缘分布，考虑了残差服从四种分布的情况，在四种残差结构中选取较优的拟合模型。如果残差 z n t 有 z n t ∼ N ( 0 , 1 ) ，误差 ε n t 有 ，则构建的边缘分布函数是GARCH(1,1)-N模型；如果残差 z n t 有 z n t ∼ t ( m n ) ，即残差 z n t 符合自由度为 m n 、均值为0以及方差为1的t分布函数，则构建的边缘分布函数是GARCH(1,1)-t模型；如果残差 z n t 的概率密度函数如式(11)所示，则构建的边缘分布函数是GARCH(1,1)-GED；如果残差 的概率密度函数如式(12)所示，则构建的边缘分布函数是GARCH(1,1)-SGED。 f ( x ; υ ) = υ Γ ( 3 / υ ) 1 / 2 2 Γ ( 1 / υ ) 3 / 2 exp [ − | x | υ [ Γ ( 3 / υ ) Γ ( 1 / υ ) ] υ / 2 ] (11) 式中： Γ ( ⋅ ) 为伽玛函数；形状参数 υ ∈ ( − ∞ , + ∞ ) 为待估参数。 (12) 式中： A= υ 2B Γ ( 1 / υ ) -1 ； B = Γ ( 1 / υ ) 1 / 2 Γ ( 3 / υ ) − 1 / 2 S ( λ ) − 1 ； G = 2 λ ⋅ D ⋅ S ( λ ) − 1 ； S ( λ ) = ( 1 + 3 λ 2 − 4 D 2 λ 2 ) 1 / 2 ； D = Γ ( 2 / υ ) Γ ( 1 / υ ) − 1 / 2 Γ ( 3 / υ ) − 1 / 2 ； sign ( ⋅ ) 为符号函数；形状参数 υ > 0 ；偏度参数 λ ∈ ( − 1 , 1 ) 。"
"本文选取基于A股产生的沪深300指数、新综指、中型综指和新指数的每日收盘价数据作为研究对象，选取的样本时间从2013年4月1日至2018年3月30日。数据来自锐思金融数据库(http://www.resset.cn/)，数据的研究与处理主要依靠Excel和R语言来完成。 算术收益率是当期资产的价格与上一期资产的价格的差再比上上一期的资产价格的比值，对数收益率是当期资产的价格比上上一期资产的价格后再对其取对数。因为对数收益率具有时间可加性而且方便建模，所以本文采用对数收益率代表股指，表达式如式(13)所示。四种指数的对数收益率随时间的波动如图1所示。 R t = 100 × ln ( P t / P t − 1 ) (13) 式中： t 是任意一个交易日； P t 定义为股指的日收盘价。 图1. 股市的四种指数的股指随时间的波动图 图1为四种指数的股指随时间的波动图。从图1可看出沪深300指数、新综指、中型综指和新指数的股指都有波动聚集的现象，即大波动紧跟着大波动、小波动紧随着小波动。 表1为股市的四种指数的对数日收益率序列的描述性统计结果。这四个指数的对数日收益率的偏度都小于0，说明这四个指数都出现了左偏的现象。而且四个指数的峰度均远大于3，表明存在“尖峰”的特征，与标准正态分布相比存在“尖峰厚尾”的现象。但是“尖峰”的特征会影响偏度的检验，故仅依据偏度和峰度的值来判断对数日收益率序列是否服从正态分布是不准确的，因此本文还进行J-B检验(Jarque-Bera test)。由J-B统计量均不服从自由度为2的卡方分布，进一步证明了收益率序列都不满足原假设，即不服从正态分布。 Table 1 分类 平均值 标准差 偏度 峰度 J−B统计量 沪深300 0.0366 1.5422 −1.0715 9.7460 2542.6188 新综指 0.0285 1.4866 −1.2834 10.4738 3169.1102 中型综指 0.0369 1.8420 −1.2188 7.5794 1365.8554 新指数 0.0566 1.7294 −1.1337 7.4751 1277.2472 表1. 股市四种指数的对数日收益率描述性统计  为了确保对数日收益率序列间相关关系的准确性，还要对样本数据进行检验，防止对对数日收益率序列构建边缘分布模型时出现伪回归的现象，即需通过ADF检验(augmented Dickey-Fuller test)来判断时间序列的平稳性，平稳性检验结果见表2。其中P值是t统计量对应的概率值，在1%显著性水平(犯错误概率)下，p值小于给定的显著性水平，而且t统计量小于1%显著性水平下的ADF临界值−3.43，所以时间序列不存在单位根，呈现平稳的趋势，即对数日收益率序列是平稳的时间序列。 Table 2 股指名称 沪深300 新综指 中型综指 新指数 t统计量值 −10.215 −10.279 −10.355 −10.086 p值 <0.01 <0.01 <0.01 <0.01 表2. 股市四种指数的平稳性检验 考虑到对数日收益率序列的波动聚集、偏斜等的异常情况，四种指数可以通过GARCH(1,1)模型进行描述，模型残差考虑服从正态分布、学生t分布、广义误差分布和带偏广义误差分布这四种假设，四种假设下的各指数的对数日收益率序列的p值差别很大，在5%显著性水平下，正态分布和带偏广义误差分布假设下存在多个参数对应的p值大于0.05，学生t分布假设下存在一个参数p值大于0.05，广义误差分布假设下不存在，因此只有残差服从广义误差分布时才通过显著性检验。。 通过显著性检验，GARCH(1,1)-GED模型下的各指数拟合的待估参数的结果如表3。其中形状参数 υ 均小于2，说明股指拟合模型的残差密度函数峰度、尾部比正态分布更尖、更厚。模型拟合之后的ARCH L-M检验结果的p值大于显著性水平5%，证明了序列不存在条件异方差，说明了模型建立正确。因此本文采用GARCH(1,1)-GED模型拟合收益率序列的边缘分布。  由于相关性函数Copula的性质要求，对收益率序列的拟合模型提取标准化残差，并对其进行概率积分变化，使数据落在Copula函数的自变量定义域的范围内，之后才可对变换后的新序列进行Pair Copula建模。 Table 3 股指名称 沪深300 新综指 中型综指 新指数 μ 0.068541 0.071690 0.149838 0.137689 0.010452 0.0082293 0.033091 0.020500 α 1 0.071061 0.0692799 0.069296 0.056595 β 1 0.925765 0.9284341 0.919116 0.935158 υ 1.147358 1.0987287 1.135483 1.242695 L-M Arch 检验 12.94044 (p = 0.37338) 14.29904 (p = 0.28202) 7.366353 (p = 0.83248) 7.339247 (p = 0.83440) 表3. GARCH(1,1)-GED模型的参数估计 表4为四个指数的Kendall秩相关系数的结果，可知4个指数间都存在着显著的正相关性，即其中一个指数出现大幅度的涨或跌，其他三个指数都会做出相同的反应。其中中型综指和新指数间的相关系数为0.8431，是所有相关系数中的最大值，说明了中型综指和新指数间的相互关系最强。 Table 4 样本 沪深300 新综指 中型综指 新指数 沪深300 1 0.8294 0.5462 0.6048 新综指 0.8294 1 0.6251 0.6527 中型综指 0.5462 0.6251 1 0.8431 新指数 0.6048 0.6527 0.8431 1 表4. 四个指数的Kendall秩相关系数 表5为利用AIC/BIC准则对两种不同类型Pair Copula模型拟合的结果，其中Copula函数的选择为Gaussian Copula，t-Copula，Clayton Copula，Gumbel Copula和Frank Copula [ 14 ] 。表中参数1和参数2分别为C-Vine Copula ((7)式)和D-Vine Copula ((8)式)中所选择Copula函数相对应参数的结果。根据表中AIC/BIC准则的检验结果，可以看出D-Vine模型的拟合效果优于C-Vine模型，因而通过D-Vine模型可得较优的四个指数间的联合分布的概率密度函数。 Table 5 藤模型 C-Vine D-Vine 参数1 参数2 参数1 参数2 c 12 t-Copula 0.96949 3.25824 c 12 t-Copula 0.96949 3.25824 c 13 Frank Copula 7.79178 0 c 13 Frank Copula 10.00244 0 c 14 t-Copula 0.81454 7.56193 c 34 t-Copula 0.97341 17.82753 c 23 | 1 t-Copula 0.53885 4.96047 c 13 | 2 t-Copula -0.27862 6.27616 c 24 | 1 t-Copula 0.43444 5.96775 c 24 | 3 t-Copula 0.32100 8.91364 c 34 | 12 t-Copula 0.86630 4.9130 c 14 | 23 t-Copula 0.46665 15.49642 AIC值 −8265.571 AIC值 −9014.635 BIC值 −8209.416 BIC值 −8958.48 表5. C-Vine和D-Vine结构下的Copula 函数参数"
"基于Pair Copula-GARCH(1,1)模型，本文引入四种不同残差分布和GARCH(1,1)模型共同建立资产序列的边缘分布，选出较优的边缘分布拟合模型，同时Pair Copula降维产生的多个二维相关根据其相关特点选取合适的Copula函数，从而可以更准确地对股票市场进行研究。 本文的研究结果表明：1) 通过对模型参数的比较分析，发现GARCH(1,1)-GED可以很好地拟合对数收益率，形成高拟合度的边缘分布函数；2) 沪深300指数、新综指、中型综指和新指数的对数收益率曲线均符合金融市场非正态、“尖峰厚尾”的特点，且相互存在较强的正相关性；3) C-Vine和D-Vine两种模型对四维对数收益率序列Copula函数降维时，根据AIC/BIC准则，可知D-Vine更适用于拟合四个指数间的相关关系；4) 根据D-Vine结构拟合出的四个指数间的概率密度函数，可以得到联合概率分布，对四个指数间的相互变化关系有大致的预判，从而当市场发生变化时，有助于作出适合自身的决策。"
