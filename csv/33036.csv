"为解决三峡水库运行后四大家鱼鱼苗丰度减小的问题，实现兼顾经济与生态的水库多目标优化调度，依据现有研究成果和生态调度经验，提出7个相关的水文指标并进行显著性检验，筛选出3个具有代表性的关键水文指标；在利用BP神经网络寻求关键水文指标与鱼苗丰度响应关系的基础上，建立以三峡水库发电量最大和四大家鱼鱼苗丰度最大为目标的优化调度模型，采用二代非支配排序遗传算法进行多目标优化调度方案求解。算例结果表明，通过优化调度的方式可以减小发电量最大和鱼苗丰度最大之间的矛盾冲突，达到在牺牲较少的发电量或几乎不减少发电量时即可大幅度提高鱼苗丰度的目的，为现阶段鱼类繁衍期的水库多目标优化调度提供了一种新思路。 关键词 :生态调度，多目标，四大家鱼，鱼苗丰度 Copyright © 2019 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"三峡工程是治理和开发长江的关键性骨干工程，具有防洪、发电、航运、供水及生态等综合利用功能。自建成以来，发挥了巨大的防洪作用，带来了显著的发电、航运等综合经济效益，但是，三峡水库蓄水，改变了长江的天然水文情势，使得在繁殖季节需要水流刺激才能正常产卵繁殖的鱼类(如“四大家鱼”)得不到应有的自然水文条件而推迟产卵或者不产卵 [ 1 ] [ 2 ] [ 3 ]。因此，国内外学者针对坝下鱼类保护的生态调度展开了大量研究，Koel [ 4 ] 等将鱼类的特定需求加入传统水文分析中，并将分析结果作为大坝的运行标准；李健等 [ 5 ] 将水力学模型和栖息地模型结合，计算得到了四大家鱼产卵期的适宜生态流量；Horne [ 6 ] 等针对特定物种对河道流量的需求给出了推荐流量；赵越等 [ 7 ] 将生态流组法应用于四大家鱼产卵期的生态水文事件分析中，推求得到了满足四大家鱼产卵需求的流量过程；梁鹏腾 [ 8 ] 等基于洪水脉冲理论在水库多目标生态调度模型中加入洪水脉冲历时控制方法，显著增加了洪水涨落历时。 目前研究成果大多只给出了四大家鱼产卵期的适宜流量过程，没有进一步将流量过程与产卵情况相结合，生态效益虽有增加，但是仍有较大提升空间。因此，为了实现兼顾发电效益与鱼类资源量的生态调度目标，仅给出适宜的生态流量过程是不够的，还需挖掘鱼类资源量与水文指标的内在联系，建立关键水文指标与四大家鱼鱼苗丰度的量化关系，为水库实施生态调度提供依据；此外，在四大家鱼大规模繁殖的五月至六月，三峡水库的运行调度可能使四大家鱼产卵所需要的洪水脉冲涨落不明显、次数减少，四大家鱼鱼苗丰度因而受到影响。因此，如何在减小影响四大家鱼产卵的情况下尽可能地发挥发电效益 [ 9 ] [ 10 ]，可理解为采用多目标优化方法寻求更为合理的水库调度方案的问题。 本文依据现有研究成果和生态调度经验，筛选出关键的水文指标，采用BP神经网络得到了四大家鱼鱼苗丰度与关键水文指标的响应关系，并采用二代非支配排序遗传算法(NSGA-II算法)求解，建立了兼顾四大家鱼鱼苗丰度与发电效益的水库多目标优化调度模型，为解决三峡下游生态系统健康问题及开展三峡水库生态调度提供理论参考及决策依据。"
"三峡水库位于长江流域，地处湖北省宜昌市，距离下游的葛洲坝水库38 km，是一座同时考虑防洪、发电、航运等多种作用的大型水利工程。三峡水库的正常蓄水位为175 m，汛限水位145 m，枯水期消落水位155 m，总库容为393亿m 3 ，死库容171.5亿m 3 ，防洪库容221.5亿m 3 ，兴利调节库容165亿m 3 。本文选取长江中游宜昌至城陵矶江段的四大家鱼作为研究对象。实际调查显示，有11处四大家鱼产卵场分布在长江中游宜昌至城陵矶江段，每年的5月至6月是四大家鱼的产卵高峰期，长江中游产卵场的产卵量占整个长江总产卵量的近50% [ 11 ] [ 12 ]。 由于四大家鱼的产卵量与涨水幅度、持续涨水时间成正比 [ 13 ] [ 14 ]，且适合四大家鱼生长繁殖的生态流量范围在8000~15,000 m 3 /s之间，因此，一定的下泄流量条件是四大家鱼产卵繁殖的必要条件。由三峡调度规程可知，水库需要在6月10日将库水位降至防洪限制水位145 m，因此，五月至六月期间内三峡水库有足够的调节库容实施生态调度，为四大家鱼的繁殖提供有利的水文条件。为了能够刺激四大家鱼产卵，2011年至今，三峡水库共进行了10余次生态调度试验，四大家鱼鱼苗丰度有了明显上升。所以，依照四大家鱼的繁殖特性进行生态调度，人为制造符合其生殖过程的水文条件，对四大家鱼的生长和保护具有十分重要的意义。"
"现有研究成果和生态调度经验表明，四大家鱼的产卵活动一般伴随涨水过程进行，江水涨水持续时间越长，鱼类产卵持续时间相应延长，且卵苗数量与江水涨水持续时间及日上涨率等水文条件密切相关，因此本文提出了7个描述四大家鱼产卵期涨水过程的水文指标：5月日平均流量、6月日平均流量(1日~10日)、日涨幅均值、最大3日累计涨水流量、最大7日累计涨水流量、涨水持续时间均值、涨水次数。 三峡水库建库运行后，下游的水文情势发生了显著变化，本文重点研究水库运行前后涨水过程在四大家鱼产卵期(5月1日~6月10日)的变化情况，将下游宜昌站1950~2016年日流量资料分为三峡水库运行前和运行后两部分，分别计算两部分的7个水文指标值作为两个独立的样本，使用SPSS对两个独立样本进行Mann-Whitney U非参数检验，该检验方法可有效判断两个独立样本是否来自相同分布的总体。检验结果见表1，从表中可以看出日涨幅均值、涨水持续时间均值和涨水次数这三个指标的渐近显著性(双尾)取值小于0.05，发生了显著性变化，且其统计值相比于运行前有所减小，说明上述三个指标的样本值在三峡水库运行前后不服从同一分布。上述检验结果说明三峡水库运行后河流水文情势的改变主要发生在涨水的幅度、涨水持续时间以及涨水次数这三个方面。 Table 1 水文指标 Mann-Whitney U统计资料 渐近显著性(双尾) 5月日平均流量 31.0 0.1330 6月日平均流量 27.0 0.0768 日涨幅均值 27.0 0.0251* 最大3日累计涨水流量 38.5 0.3031 最大7日累计涨水流量 32.0 0.1514 涨水持续时间均值 45.0 0.0130* 涨水次数 27.0 0.0059* 表1. 水文指标检验结果  利用神经网络BPNN寻求日涨幅均值、涨水持续时间均值、涨水次数与四大家鱼鱼苗丰度的相应关系。BPNN共分3层，隐含层设置5个神经元，传递函数分别为Sigmoid和线性函数，训练方法为Levenberg-Marquardt反向传播算法。针对水文数据样本量少的问题，引入Bootstrap重抽样方法，通过噪声注入，扩充样本量，提高神经网络模型的鲁棒性。为验证神经网络模型拟合效果，将其与多元线性回归Linear方法进行对比，通过5-folds交叉检验训练样本得出对比结果，见表2。从表中可以看出，神经网络模型得出的计算值与实测值之间的相关系数明显高于多元线性回归法，标准误差则小于多元线性回归法。因此，神经网络模型的拟合效果要明显优于多元线性回归法。 Table 2 交叉检验 方法 标准误差MSE R平方值 1 神经网络 3.13 0.930 线性回归 3.23 0.871 2 神经网络 2.55 0.922 线性回归 3.11 0.782 3 神经网络 1.64 0.893 线性回归 2.25 0.725 4 神经网络 0.66 0.911 线性回归 0.85 0.810 5 神经网络 0.37 0.676 线性回归 0.82 0.432 表2. 拟合效果对比  基于四大家鱼鱼苗丰度与关键水文指标的响应关系，建立以调度期内水电站发电量最大和四大家鱼鱼苗丰度最大为目标的三峡水库多目标优化调度模型，优化调度模型如下： 1) 目标函数： 目标1：三峡水电站发电量E最大： E = max ∑ t = 1 T K H t q t Δ t (1) 式中，E为总发电量，T为时段数，K为电站的出力系数， H t 为t时段的水头， q t 为电站t时段发电引用流量。 目标2：四大家鱼鱼苗丰度A最大： A = max f ( Q 1 , Q 2 , ⋯ Q T ) (2) 式中，A为四大家鱼鱼苗丰度， Q 1 , Q 2 , ⋯ Q T 为第1、2…T时段的下泄流量，f为鱼苗丰度与各时段流量的函数关系。 2) 约束条件： 水量平衡约束： V t + 1 = V t + ( I t − Q t ) × Δ t (3) 出力约束： N t min ≤ N t ≤ N t max (4) 水位约束： Z t min ≤ Z t ≤ Z t max (5) 下泄流量约束： Q t min ≤ Q t ≤ Q t max (6) 水位日变幅约束： | Z t +1 − Z t | ≤ 0.6 (7) 其中：V t 、V t + 1 分别表示水库t和t + 1时刻的水库蓄水量，I t 表示t时段的入库流量，Q t 表示t时段的出库流量； Z t min 、 Z t max 分别为电站第t个时段的水位约束， N t min 、 N t max 分别为电站第t个时段的出力约束， Q t min 、 Q t max 分别为电站第t个时段的流量约束，包括生态、航运、供水、泥沙等约束条件， Z t +1 和 Z t 分别表示水库t和t + 1时刻的水库水位。 以上模型采用NSGA-II算法进行求解，NSGA-II算法是由Deb [ 15 ] 等提出的一种后验式的多目标进化算法，采用快速非支配排序过程、精英保留策略和无参数小生境操作算子，相较于其他多目标优化算法具有运行速度快，解集收敛性好的优点。本文将NSGA-II算法应用在考虑四大家鱼鱼苗丰度与水库发电量的水库多目标优化调度求解中，采用C#编写程序，种群规模为20，最大迭代次数1000次，交叉概率为0.7，变异概率0.01，计算结果见表3。 Table 3 方案 发电量/亿kw·h 鱼苗丰度/亿尾 方案 发电量/亿kw·h 鱼苗丰度/亿尾 1 94.746 2.1157 11 94.485 3.0965 2 94.684 2.2666 12 94.182 5.6366 3 94.831 1.8893 13 94.264 4.7313 4 94.067 7.6989 14 94.934 1.7384 5 94.629 2.4929 15 94.155 6.0139 6 94.047 8.3780 16 94.557 2.7444 7 94.021 9.9876 17 94.121 6.4414 8 94.094 7.0450 18 94.421 3.4989 9 94.223 5.1337 19 94.363 4.0019 10 94.308 4.3540 20 94.031 9.1325 表3. 三峡水库多目标优化调度方案集"
"从表3的20个优化调度方案中选取方案7 (鱼苗丰度最大)、方案14 (发电量最大)和方案10 (中间方案)作为典型优化方案对三峡水库出库流量进行分析。若水库调度过程中以水电站发电量最大为主要目标时，应选择方案14，发电量可达94.934亿kw·h；以鱼苗丰度最大为主要目标时，应选择方案7，鱼苗丰度可达9.9876亿尾；若没有特别侧重的目标时，可选择方案10，发电量为94.308亿kw·h，鱼苗丰度为4.3540亿尾。在水库调度过程中，可结合实际情况选择适合的调度方案。 图1. 不同典型优化方案下三峡水库下泄流量变化过程 图1给出了三峡水库的天然来水过程和三种典型优化方案下三峡水库的下泄流量过程，从图中可以看出，经过水库的调节后，波动较大的入库径流变得较为平缓，洪水脉冲减少，造成四大家鱼的鱼苗丰度减少。对比三个方案可以发现，三个方案的区别主要在于下泄流量的波动幅度不同。方案7在5月上旬、中旬和6月上旬均发生了持续4天以上且流量日涨幅超过1000 m 3 /s的连续涨水过程，四大家鱼的产卵主要集中在这3个涨水过程中，但由于该方案在天然入流增大时加大下泄流量，造成水库长时间以较低水位运行，导致发电量较少；方案14的下泄流量过程较为平缓，仅在五月上旬出现了一次持续4天以上且流量日涨幅超过1000 m 3 /s的连续涨水过程，故方案14不利于四大家鱼产卵，鱼苗丰度最小，但该方案在前期放水较少，水库水位下降较慢，故发电量较大。对比方案14和方案7可以发现，完全优化鱼苗丰度的方案比完全优化发电量的方案鱼苗丰度增加8.25亿尾，发电量减小0.913亿kw·h。《长江三峡生态与环境公报》显示2012年监利断面的鱼苗丰度为3.97亿尾，由表3可知，方案19的鱼苗丰度最接近当年实际水平，若以该方案发电量为当年实际发电量，对比方案7和方案19可知，发电量仅减小0.342亿kw·h鱼苗丰度即可增多至9.9876亿尾。因此，优化生态调度只需牺牲较少的发电量或几乎不牺牲发电量即可有效提高鱼苗丰度，增加生态效益。"
"针对三峡水库建库运行后其下游四大家鱼繁殖规模减小的问题，根据宜昌站径流资料和生态调度经验提出7个生态水文指标，并进行指标检验。应用BP神经网络建立四大家鱼鱼苗丰度和关键水文指标的响应关系，将该模型嵌入到三峡水库多目标优化调度模型中，并应用NSGA-II算法进行了求解。结果表明牺牲较少或几乎不减小发电量即可提高生态效益，本文研究思路可为三峡水库四大家鱼繁殖期的优化调度提供理论依据和参考。但四大家鱼鱼苗丰度除受流量变化的影响外，还受水温、流速、地形、气象等其他要素的影响，因此通过完善指标类型提高BP神经网络模型的拟合精度，并基于该模型建立水库多目标优化调度模型，进而提出更加合理的生态调度方案，是下一步需要进行的研究工作。"
