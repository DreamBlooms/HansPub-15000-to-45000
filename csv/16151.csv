"图像复原是数字图像处理的重要研究内容。基于频域的维纳滤波实现图像复原，并针对复原过程中伴随的振铃效应，采用扩展边缘的方法做了消除振铃预处理。然后进一步分析点扩散函数半径、图像梯度对振铃样式的影响，并由此建立边界振铃样式数据库R。并结合轮廓提取以及边缘膨胀法，得到振铃影响域内某点到轮廓的距离，从而调用对应库里的振铃样式做振铃修正。最后基于Matlab用简单轮廓图形验证该振铃抵消方法的有效性，从而将振铃幅度控制在±2之内，极大程度的恢复了原始高清图像。 关键词 :图像复原，维纳滤波，点扩散函数，振铃，边缘提取"
"随着科技和多媒体的迅猛发展，图像已经成为人类获取信息的重要途径。图像复原的目的是尽可能恢复原始高清图像。该技术已应用于众多科学工程领域，如天文图像复原、医学影像、军事侦察等[ 1 ] 。 散焦图像给人的直观感觉是图像变模糊。图像退化的原因：光学系统的不理想、图像传输和采集过程中引入的噪声、图像运动、传感器噪声、摄像机聚焦不佳、物体与摄像机之间的相对移动等 [ 2 ] 。 散焦图像复原试图利用退化图像的某种先验知识来重建或复原被退化的图像，因此图像复原可以看成图像退化的逆过程 [ 3 ] 。由于图像复原是一个病态 [ 4 ] 的问题，在复原过程中，会伴随着振铃产生。目前的图像复原及抑制振铃方法有：基于边缘分离的去振铃复原，图像去模糊正则化恢复算法，频域循环边界算法，反卷积边界效应的快速抑制算法等 [ 5 ] - [ 8 ] 。本文提出一种通过分析影响振铃样式的影响因子，并建立振铃样式库，来抑制振铃效应的方法。"
"散焦图像的退化模型 [ 9 ] 如图1，用公式表示如公式(1)： (1) 用f表示原始的清晰图像，h表示引起图像模糊的退化函数，实质上是圆盘点扩散函数，n表示加性的高斯白噪声，g表示观察到的模糊降质图像。退化过程时域表达式如图1，其中*为卷积。 离焦模糊图像的退化模型为点扩散函数PSF，可用均匀分布的圆盘函数 [ 10 ] 表示，如下面的分段函数表达式(2)，其对应的圆盘半径是模糊半径。 图1. 离焦图像的频域复原模型 (2) 图像复原的方法有直接逆滤波、伪逆滤波、维纳滤波、最小二乘滤波等 [ 11 ] 。对比模糊半径为30时的维纳滤波和最小二乘滤波，如图2，维纳滤波能更好的恢复图像高频细节，决定采用维纳滤波。维纳滤波的过程表示为公式(3)： (3) 其中NCORR为噪声功率谱，ICORR为信号功率谱，他们的比值为噪信比NSR。"
"图像复原过程中会伴随振铃效应，表现为周期性强度急剧变化的周期性重复(如图3)。  根据振铃在复原图像中出现的位置，还可将振铃分为边界振铃和轮廓振铃。 边界振铃是在复原图像边界附近出现的一种寄生波纹。 轮廓振铃是在边缘尤其是强边缘附近出现的平坦区域出现的若干条纹，它与轮廓平行，条纹的强度与边缘的梯度幅值成正比，且沿垂直边缘的方向减弱。它的存在会混淆图像的高频特征 [ 12 ] ，从而降低复原图像的质量，对图像的目标识别和信息提取造成干扰，使得复原图像后续处理的难度增加。  引起振铃的主要因素 [ 13 ] [ 14 ] 有En、Ed、Eb： 1) 滤波器噪声振铃En：观测像素中存在不可避免的测量和量化误差。 2) 滤波器偏差振铃Ed：点扩散函数PSF频域响应有零点，正则化过程把一个不适定的问题转换成适定的，导致复原滤波器与原来的PSF的逆卷积的偏差。 3) 边界截断振铃Eb：图像在边界处梯度剧变，对图像做傅里叶变换时，周期延拓导致边界处梯度剧变，引起振铃。"
"用扩展边界预处理方法可以很好地消除边界振铃。对于比较顽固的轮廓振铃，可以通过观察不同模糊半径、轮廓处梯度对振铃样式的影响，建立振铃样式库。图像大小和轮廓曲率对振铃样式基本不影响。 通过大量实验，我们得到轮廓振铃的影响范围约在100像素以内，由此可以确定振铃影响域。以观察中间第300行、301~400列像素的振铃变化规律为例。图4(a)调整模糊半径为5，8，10，可以看出振铃周期，随PSF模糊半径变大而周期也变大，且呈现振铃周期 ≈ 模糊半径 × 2的关系。图4(b)调整图像的轮廓处梯度为50，80，110，可以看出振铃幅度与轮廓处梯度的关系，梯度越大振铃幅度越剧烈。  由此根据梯度和模糊半径对振铃样式的影响程度，建立振铃样式库R，R为大小500 × 100的矩阵。 图2. 维纳滤波与最小二乘滤波复原方法对比 图3. 模糊半径为10的带振铃复原图像 图4. 振铃样式随轮廓梯度和PSF半径变化归路图 100是振铃影响范围，即在振铃影响域内的某一点，到轮廓的距离d。我们取模糊半径1~20，梯度1~255每隔10取一个代表点，共有25个量化梯度。 例如，对于复原图像轮廓上的某一点W(i, j)，我们将调用R库里第h行第d列的振铃值R(h, d)做修正。D为振铃点到轮廓的距离为d, t为轮廓处的梯度，r为模糊半径，则h如公式(4)： (4) 假设梯度t = 183，模糊半径r = 8，振铃距离为d = 30的点，应调用h = 25 × (8 − 1) + 183/10 = 193行，即R(193, 30)的值，去修正W(i, j)，如果该点在距离轮廓的正梯度方向，则减去振铃修正值；如果在梯度负方向，则加上振铃修正值。  在实际应用中，我们很容易求得轮廓某点的梯度值t。但对于距离d，由于运算量较大，需要一些高效快捷的方法把振铃影响域内的点，到轮廓的距离d标记在矩阵D中。方法有： 1) 边缘膨胀方法。边缘提取得到主轮廓B0。对轮廓做半径为1的圆盘结构元素膨胀操作，膨胀第i + 1次的结果B2，与第i次的结果B1做异或运算，得到的平行曲线轮廓就是所有距离d = i + 1的振铃点，循环100次，得到完整的距离矩阵D。 2) 点扩散方法。边缘提取得到主轮廓B0。对于振铃影响域内的每一点，做半径从1循环到100的圆扩散，当圆与轮廓相遇时，此时的半径即为距离d，相遇点即轮廓源点。 3) 点斜式方法。边缘提取得到主轮廓B0。对于轮廓上的每一点，都可以由斜率求得其法线，在法线方向上，标记各点到轮廓源点的距离，得到矩阵D。  最后用Matlab具有简单轮廓的图验证该方法。如图5(a)和图5(c)所示，图像大小600 × 600，模糊半径为10。在验证过曲率对振铃样式不影响的基础上，可以直接调用直线的振铃样式库R。 图5. 调用振铃库做修正前后对比图 先求得振铃影响域内每一点到轮廓的距离，存在矩阵D中，针对每点调用振铃库R(h, d)来振铃修正后，肉眼看，图5(b)圆内和圆外的部分都几乎看不出振铃；数值上，振铃幅度由原来的±10，修正后控制在±2以内，效果非常好。图5(d)由于轮廓较复杂，在尖锐的轮廓处会有残余振铃，而且轮廓相隔较近处会有干扰，但整体上已消除大部分振铃。 该方法优点是：对简单轮廓、简单背景、梯度统一的图像，复原过程和振铃抑制都非常有效，几乎消除了振铃。该方法缺点是：运算量较大。对于复杂轮廓、复杂背景的图像，需要分别算出轮廓上每点的梯度，再单独标记所有由该轮廓点辐射出来的振铃，并调用振铃库R中同样的h不同的d。 由于振铃因素的多样性，比如振铃遇到边界再反射回来进一步影响振铃样式分布，当轮廓距离较近会有振铃叠加，在轮廓交点处会有环形振铃等。此类情况，需要特别考虑及修正，有待进一步研究。"
"首先通过对比选定了频域维纳滤波图像复原方法，并分析了图像离焦和产生振铃的原因。然后根据模糊半径和轮廓梯度对振铃样式的影响，提出建立振铃样式库R的方法。进一步介绍如何求得振铃点到轮廓的距离，最后对于振铃影响域内的每一点，调用R(h, d)做振铃修正。该方法很好的提升了退化图像的品质，改善视觉效果。"
