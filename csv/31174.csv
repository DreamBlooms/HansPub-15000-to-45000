"东北地区现有27个民航运输机场，其中空管系统机场均配备了多普勒天气雷达，目前，空管系统对于天气雷达基数据的使用仅限于雷达站本地，本文根据此现状，设计了东北地区机场天气雷达基数据的共享应用解决方案：针对民航通信网络带宽受限的情况，使用无损压缩技术，极大地提高了基数据的传输时效，解决了基数据传输难以满足使用需求的瓶颈；基于收集到的基数据，设计了基于Oracle的雷达数据管理系统，实现了用户对于数据的高效查询与下载；同时对收集到的各地基数据格式进行了分析与研究，实现了东北地区天气雷达组网拼图，并将拼图产品传输至各分局站，实现气象雷达资源的共享。 关键词 :天气雷达，数据压缩，基数据管理，组网拼图 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"东北地区现有27个民航运输机场，其中空管系统机场(沈阳、哈尔滨、长春、大连)均配备了多普勒天气雷达，多普勒天气雷达以多普勒效应为基础，除了能够探测降水回波的位置、强度以外，还能通过测定回波信号与发射信号间的相位差异，得出降水粒子群相对于雷达的平均径向速度和速度谱宽，在一定条件下反演出大气风场 [ 1 ] 。随着多普勒天气雷达作用的提升，雷达基数据管理的问题也随之而来。由于数据量巨大，加之民航通信网络传输带宽受限，现行民航系统规定中只将雷达生成的图片产品传输至数据库 [ 2 ] ，大量的基数据采用就地存储的方式保存，这样基数据的应用就都限制在了本地，而雷达产生的海量基数据大多数情况下都没有长期保存在计算机中，而是通过刻录的方式保存在光盘中，这给以后资料的检索以及分析研究工作带来了诸多不便。  针对空管系统雷达基数据的应用现状，本文在不影响现有业务的基础上，设计了一套天气雷达基数据组网共享方案，如图1所示，针对雷达基数据体积较大，传输带宽不足的情况，本方案采用先压缩，后上传的方式将东北地区空管系统所属天气雷达基数据汇聚至东北空管局气象中心，同时从辽宁省气象局引接了东北地区24部气象局天气雷达数据，实现了东北地区天气雷达基数据资料的统一管理，在此平台下，本文继续对雷达基数据进行解析，将不同厂商、不同格式的雷达数据组网拼图，实现了东北地区天气雷达的共享，此方案的实现不仅能够为短临预报天气以及气象科研等工作提供基础的数据保证，还能有效地弥补现有各雷达单独运行的缺陷，扩大预报员的决断范围。"
"雷达数据中数据量最大的是原始基数据。以桃仙机场CINRAD/CD多普勒天气雷达为例，雷达每一次体扫可产生12 MB左右的基数据，如果24小时不间断运行，每日就会产生3 GB左右的基数据文件，这就给数据的存储与归档带来了很大的压力，因此现空管系统各雷达站基数据均采用就地存储的方式保存，保存下来的基数据并没有长期保存在计算机中，而是通过刻录的方式保存在光盘中，给以后资料的检索与分析带来了不便。 图1. 东北地区天气雷达基数据共享平台设计方案 基数据是指天气雷达观测时采集到的所有经过整理加工的存档数据。原始数据文件由文件标识、文件头和数据记录块组成 [ 3 ] 。文件头记载雷达站名、站址、雷达型号、观测时间、扫描类型等内容。数据记录以极坐标方式顺序排列存储回波强度、径向速度以及速度谱宽，数值具有较强的相关性，采用无损压缩方式压缩，能够获得较好的压缩效果。本文选取东北空管局气象中心及各分局站气象台雷达基数据，分别采用下述4中常用压缩算法进行压缩测试，测试结果如下表1。 Table 1 站址 多普勒雷达 基数据 数据大小 (MB) LZ77 LZSS BZIP2 LZMA 压缩后 (MB) 压缩率(%) 压缩后 (MB) 压缩率 (%) 压缩后 (MB) 压缩率 (%) 压缩后 (MB) 压缩率 (%) 沈阳 2017050510110.05V 12.3 0.53 4.31 0.49 3.98 0.42 3.41 0.41 3.33 哈尔滨 QZYHBBVT 170411145957.014 25.7 2.42 9.42 2.11 8.21 1.73 6.73 1.96 7.62 长春 QZYCCBVT 170413014457.009 24.2 1.29 5.33 1.30 5.37 0.98 4.05 1.08 4.46 大连 2016112016.14A 9.35 0.52 5.56 0.51 5.45 0.46 4.81 0.49 5.20 表1. 各地区基数据压缩效果比较 由测试结果可以看出，雷达基数据压缩后体积为原大小的5%至10%，通过对同一基数据采用不同压缩算法的测试可以看出，Bzip2压缩算法的表现普遍优于其他三种算法，因此本文采用Bzip2压缩算法来对东北地区雷达基数据进行压缩处理，压缩后的基数据大小均小于2 M，传输效率可提高近20倍，可通过现有民航通信ATM网络将各分局站雷达基数据通过FTP方式传输至沈阳气象中心，由气象中心进行统一管理。  民航气象数据库系统对雷达基数据的命名方式为 [ 4 ] ： QCCCCKX1X2YYYYMMDDHHMMSS.EEE 其中各字母的含义如下： Q：表示是雷达数据文件； K：雷达数据格式的种类(雷达基数据-B)； X1：观测扫描方式码(P-PPI，R-RHI，V-VOL)； X2：要素码(Z——单回波强度，V——单径向速度，W——单速度谱宽，T——三要素)； YYMMDD：生成数据的年、月、日； HHMMSS：生成数据的时、分、秒； EEE：根据观测扫描方式码X1分别表示天线仰角或所在的方位角或体扫层数。 东北空管局气象中心现雷达基数据格式为YYYYmmddhhmmss.EEE [ 5 ] ，要想对基数据进行统一存储管理，需对数据的命名进行规范化处理，因此本文设计了基数据的重命名功能，程序可以根据设定的目录自动完成相应基数据的重命名工作，为后期的入库奠定基础，下表2为气象中心基数据重命名实例。 Table 2 归属地 雷达型号 原基数据 重命名后基数据 沈阳 CINRAD/CD 2017050510110.05V QZYTXBVT20170505101100.009 表2. 气象中心雷达基数据重命名示例"
"在分析接收到的雷达基数据中发现，部分数据在生成或传输的过程中可能存在异常，导致雷达头或雷达数据信息不全，这些异常的数据无法正常使用，为避免对系统资源造成浪费，本文对传输至气象中心的所有雷达基数据进行识别解析，如果基数据信息完整，正常进行数据处理及存储，如数据无效则可以直接删除。 天气雷达基数据类型的判别可以通过判断基数据文件名和文件内容两种方式来实现，由于部分地区基数据文件名时间与基数据实际时间存在出入，因此判断基数据文件名的方式并不准确，为满足入库的需要，本文采用读取基数据文件内容的方式来判别数据类型。 天气雷达基数据文件都是采用二进制方式存储，具有一定的格式，且包含一些参数信息，例如雷达站信息、雷达性能参数、雷达观测参数等。通过判断文件内容中的参数信息，可以分辨出基数据文件类型。 天气雷达基数据文件中，参数信息按数值的特点分三类 [ 6 ] ： 1) 不变类。这类参数数值始终不变。例如，SA基数据文件中，雷达型号参数始终为“CINRAD/SA”。 2) 区间变化类。这类参数数值在一定范围内变化。例如，表示月份的参数变化范围始终为1到12。 3) 关联类。这类参数与其它参数有一定关联，在数值上可以用等式或不等式来表达。 例如，SA基数据文件中，文件长度一定是帧数据长度和径向数的乘积。 东北空管局所属天气雷达现由三个雷达厂家生产，除空管系统雷达外，气象中心还从辽宁省气象局引接了东北地区24部气象局雷达基数据，各站址基数据信息如表3所示。 Table 3 生产厂家 雷达基数据格式 站址 北京敏视达雷达有限公司 CINRAD-SA 大连、营口 CINRAD-CB 哈尔滨、通辽、霍林郭勒、满洲里 中电锦江信息产业公司 CINRAD-CD 桃仙机场、延吉、白城、辽源、松原、白山、朝阳、海拉尔、赤峰 CINRAD-SC 沈阳 安徽四创电子股份有限公司 CINRAD-CC 龙嘉机场、太平机场、长春、九三分局、建三江、齐齐哈尔、 牡丹江、佳木斯、黑河、伊春、加格达奇 表3. 东北地区天气雷达基数据格式统计 由上表可知，本系统可收集到东北地区三个雷达厂商各型号共27部雷达的基数据，这些天气雷达的基数据格式大体分为5种，因各类型雷达基数据格式均不相同，因此可通过读取基数据内容的方式对雷达基数据信息进行判断并分类存储，各类型文件基数据的具体格式已由各雷达厂商给出，本文不再赘述。 以气象中心CINRAD-CD基数据为例，通过分析基数据中雷达文件头，可以得到该雷达的站址，经纬度信息，雷达型号，观测时间，扫描模式等信息，这些信息能够帮助系统完成对基数据的识别，分类及存储工作，如图2所示。 图2. 气象中心雷达基数据识别实例  天气雷达数据以基数据为基础，随之产生标定文件和状态信息文件。这些信息数据都需要有效存储。由于基数据数据量较大，不适宜直接存储在数据库中，只需要保存其基础信息及文件存放位置，本文设计的雷达基数据信息表如下表4。 Table 4 字段名 类型 长度 是否可以为空 序号 Int 4 否 站名 Nvarchar 20 否 经度 Float 8 否 纬度 Float 8 否 海拔高度 Float 8 否 日期 Datetime 8 否 时间 Datetime 8 否 雷达型号 Nvarchar 20 否 文件名 Nvarchar 20 否 扫描方式 Nvarchar 20 否 扫描层数 Nvarchar 20 否 存放位置 Nvarchar 50 否 表4. 雷达基数据信息表 本系统能够自动收集通过民航通信网传输至本地的雷达数据，打包压缩后长期存储，雷达数据传输至服务器后，可通过入库程序完成基数据的识别及入库，将东北地区各雷达基数据全部存储至数据库中，以方便日后的查询及使用。  雷达数据整编是一个比较繁琐的过程 [ 7 ] ，以前主要是通过人工收集、整理、压缩、存储，由于之前的基数据大都采取刻盘或拷贝至移动硬盘的方式存储，给资料的查询、共享以及应用带来了不便。依托本系统所建立的基数据数据库，本系统设计了关于雷达基数据的整编方案，以取代现有的存储模式。本文的雷达资料整编主要记录天气过程的类型、发生的时段及地点等信息，具体基数据整编信息如下表所示：通过对雷达资料的整编，用户可以根据实际需求在数据库中完成对雷达基数据的查询及下载工作，提高了工作效率。本系统设计了时间检索及个例检索两种方式以实现基数据的查询及下载，如图3所示。 图3. 基数据下载示意图"
"单部天气雷达有限的探测能力限制了雷达观测作用的进一步发挥，如果想要提高中尺度灾害性天气的预警能力，就要发挥多部雷达在联合监测天气中的作用 [ 8 ] ，即用探测范围相互重叠的多部天气雷达组成观测网。由多个雷达重复取样获得的天气信息要比由单部雷达取样更加精确，此外，雷达组网还可以很大程度上解决因单部雷达观测的波束几何学原因引起的很多问题 [ 9 ] (例如静锥区、波束展宽、波束高度、波束阻挡等)。天气雷达组网拼图对于在更大范围发挥天气雷达监视中小尺度灾害性天气的作用，提高灾害性天气的短时预报水平，进一步做好航空气象保障工作具有重要的科学意义和实用价值。  雷达基数据中包含基本反射率因子(强度Z)、径向速度(V)和谱宽(W)三个雷达回波基本量，根据这三个雷达回波基本量，可以反演出相应的天气系统 [ 9 ] ，特别是降水天气系统的某些内部特征和结构，综合使用反射率因子、径向速度以及谱宽数据，可以及时有效地监测和预警灾害性天气。反射率因子可以在雷达终端反演出当地实时的天气情况，是雷达估测降水量的基本数据之一，对雷达回波强度的分析是雷达观测中至关重要的工作，因此本系统基于反射率因子的雷达组网拼图。 雷达组网拼图中主要由雷达数据网格化、拼图处理以及投影三部分构成。  由于雷达作体扫观测时，雷达波束是在各个仰角沿方位进行360˚的锥面扫描 [ 10 ] ，因此，原始雷达观测资料常用球坐标系来存储，而在综合分析雷达资料时，使用球坐标系存储的雷达资料十分不便。因此，必须把球坐标系下的雷达资料内插到笛卡尔坐标系下的网格点上。在雷达数据网格化过程中，常用的方法有最近邻居法(NN)，径向和方位上的最近邻居和垂直线性内插法(NVI)、垂直水平线性内插法(VHI)等方法，选用合适的插值方法进行网格化处理后，原雷达基数据即可转换为笛卡尔坐标系中的网格数据。  通过插值方法把来自各个雷达的反射率场插值到统一的笛卡尔网格上之后，需要把来自多个雷达的格点反射率场拼接起来形成拼图网格，在拼图网格的很多区域，特别是在对流层中高层，有来自多个雷达的资料重叠区，拼图技术的关键是重叠区域的处理，目前的雷达拼图技术中一般采用最大值方法、最近邻居法或权重函数法。本系统从航空用户角度考虑，为了能在用户使用过程中发挥必要的预警作用，在资料重叠区域系统选用回波强度较大的值作为拼图的采样强度值。  在研究天气雷达组网时，由于雷达不再是单站，就必须考虑地球曲率对雷达网资料拼接图的影响，即最后的拼接图在平面上的显示问题。该问题类似地图投影问题，本系统采用兰伯特等角投影算法来解决该问题。  把单部雷达联合起来进行使用要解决的首要问题是资料实时处理的时效性应得到满足。单部雷达资料处理时间以6分钟为1个周期(由雷达本身扫描方式决定)，因此，要同时使用本地区27部天气雷达的资料，就必须在6分钟内完成所有雷达资料的收集、处理以及资料转发工作，系统选取了2018年4月8日的各地基数据进行测试，资料处理各环节所需时间如表5所示，经统计，资料处理时间合计为75 s，即各地用户在基数据生成后两分钟内即可收到中心分发的拼图产品，时效性满足用户使用要求。 Table 5 处理过程 基数据同步 数据解压缩 拼图处理 拼图产品压缩 资料分发 平均耗时(s) 34 2 20 2 17 合计 75 表5. 基数据处理时效性测试 拼图完成后，基数据格式转化为GRD格式的网格化数据，可由GrADs或Surfer等软件直接读取，如图4所示。 图4. 东北地区雷达拼图示例"
"本文根据东北空管局气象中心及各分局气象台雷达基数据的应用现状，提出了一套雷达基数据处理及应用的可行性方案，设计了雷达基数据共享平台，雷达基数据经压缩传输、质量控制以及格式识别等步骤后能够自动入库存储，满足在实际工作中对雷达数据长期归档保存的需求，同时将收集到的基数据用于雷达的反演与拼图，并将拼图产品分发至各地，实现了气象雷达信息的共享，为短时临近预报天气工作的开展提供了保证。"
