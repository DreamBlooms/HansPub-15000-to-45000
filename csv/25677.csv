"为了改变传统室内照明系统布线复杂，不易控制、无法满足环境采集和线性调光要求的缺点，采用ZigBee技术来操控LED灯。本论文对ZigBee网络特点，ZigBee中各层的协议，数据传输方式及网络拓扑结构进行了分析，根据系统需求提出了总体设计方案和系统硬件结构框架，完成了电源控制电路、串口通信电路、LED照明控制电路、光敏电路等硬件设计。在研究传统智能照明控制系统的基础上，以ZigBee协议为平台通过光照强度和ZigBee协调器来控制LED，以光照感应技术和协调器为基础的整体系统方案，确定将ZigBee网络作为系统的通信基础。即采用两块ZigBee功能板，一块为终端导入光敏传感器，用作信号发射，另一个用作协调器建立网络，设定为手动模式下LED灯的开关。在自动模式下当光照强度不足时，LED灯将自动变亮。在手动模式下通过协调器改变LED的亮灭。 关键词 :ZigBee技术，无线照明系统，协调器 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"传统的有线照明系统布线复杂，节能效率低，安全性差，已经满足不了信息技术飞速发展的生活的基本需求，于是无线智能照明系统应运而生。无线照明系统灵活性高、部署方便、维护成本低。本文采用低功耗、低成本、低速率的短距离无线通信标准来组建无线照明网络。 本论文以ZigBee无线技术和LED灯控制系统为研究内容，选用ZigBee通信方式，主要论述ZigBee协议组成、ZigBee组网及网络拓扑系统等相关ZigBee通信技术，并且根据系统要求对LED灯的控制撰写了总体设计方案控制、系统设计的要求。运用ZigBee硬件系统的组成网络，对ZigBee硬件的电路进行设计分析，完成了电源控制电路、串口通信电路、LED灯照明控制电路、光敏电路等硬件设计。"
"ZigBee协议是遵循IEEE802.15.4协议，ZigBee协议分为五层：应用层、应用支持层、网络层、数据链路层和物理层。ZigBee协议分工非常明确，每层都分配指定的功能和作用。如图1所示。  物理层遵循IEEE802.15.4协议 [ 1 ] ，是协议的最低层，承担的任务是与外界直接相互作用，控制RF收发器的工作，采用扩频通信。物理层通过物理层数据服务访问点(PD-SAP)提供物理层数据服务，通过物理层管理实体服务访问点(PLME-SAP)提供物理层管理服务。  同样遵循IEEE802.15.4协议，主要负责的是设备间的无线数据链路的建立、维护和结束，确认模式的数据传输和接收 [ 2 ] 。MAC子层提供两种服务：MAC层数据服务和MAC层管理服务。前者保证MAC 图1. ZigBee协议总体架构 协议数据单元在物理层数据服务中的正确收发，MAC层管理服务维护一个存储MAC子层协议状态相关信息的数据库。 MAC子层主要功能如下： 1) 协调器产生发出网络信标帧。 2) 其他设备与信标帧同步。 3) 支持PAN网络的关联(Association)和取消关联(Disassociation)操作。 4) 保证设备的安全。 5) 使用CSMA-CA机制访问信道。 6) 支持GTS(Guaranteed Time Slot，时间槽保障)机制。 7) 提供两个对等的MAC实体之间的可靠连接等。  网络层在MAC层之间提供一个合适的接口，通过刺激MAC层动作执行寻址和路由功能。它的关键任务包括： 1) 启动网络和分配网络地址。 2) 移除网络中的设备或者添加网络中的设备。 3) 通过路由器设备，将消息送往目的节点。 4) 加密已发送的数据。 5) 在网状网络中执行路由寻址并且储存路由表。  应用层用于支持维持器件的功能属性 [ 3 ] ，发现该器件工作空间中其他器件的工作，根据服务和需求使多个器件之间进行通信，ZigBee应用层中包含有应用程序支持子层，应用程序架构，送往ZigBee装置管控对象和与各厂商定义的应用程序对象。  ZigBee定义了3种类型的设备，每种设备都有自己的功能要求： 1) ZigBee协调器，在ZigBee网络中是中心主节点，所有其他ZigBee节点都是协调器的子节点，ZigBee协调器不仅要建立ZigBee通信技术的网络，还要对ZigBee通信技术的网络进行管理维护，可以说ZigBee通信技术的网络的核心。 2) ZigBee路由器，ZigBee路由器和平时生活中的路由器的作用相差不打，都是负责信息的传输，将信息派送出去 [ 4 ] 。在ZigBee的星形拓扑结构中不能使用ZigBee路由器，在ZigBee树状和网状的拓扑结构中可以使用ZigBee路由器。 3) ZigBee终端设备，是负责实现ZigBee网络中最终功能的子节点。 依据ZigBee设备类型可分为两类设备，一类是全功能设备(FFD)，可以接收和发送数据和路由功能；另一类是半功能设备(RFD)，不具备路由功能，只能收发数据。 星形拓扑结构是ZigBee三种拓扑结构中最简单的一种拓扑结构，由一个协调器和若干个终端组成，对接方式为点到点，每个终端都会连接协调器 [ 5 ] ，终端与终端之间不能进行连接，任何终端与终端的信息连接都必须经过协调器的转接发送。如图2所示。 树形拓扑结构在ZigBee三种拓扑结构中是最复杂的。由一个协调器 和若干个终端或路由器组成，层次结构非常分明，与协调器相连的每个终端和路由器都可以继续连接终端和路由，形成自己的子节点，以此类推形成树状。如图3所示。 网状拓扑结构是ZigBee三种拓扑结构中最复杂的一种拓扑结构，由一个协调器和若干个终端或路由器组成 [ 6 ] 。这种网状拓扑结构不仅拥有树形拓扑结构的特点，与协调器相连的每个终端和路由下面都可以继续连接终端和路由，形成自己的子节点；所有路由器之间可以直接进行通讯。如图4所示。"
"根据传统LED灯的缺陷与不足，并结合ZigBee无线通信技术，可以设计出智能人性化的照明系统 图2. 星形拓扑图 图3. 树形拓扑图 图4. 网状拓扑图 设计，具体要求如下： 1) 可用性：整体设计必须以人为本，整个系统必须按照要求完成它的作用，在实际中必须体现以人为本的可用性。 2) 易于管理性：方便使用者管理整个ZigBee的网络系统，和灯光控制系统，当出现任何问题时，可以得知问题的来源，方便维护修理。 3) 经济性：整体成本价格必须符合社会实际情况，且能融入到工作和生活的需求中，有良好的成本效益。 4) 稳定性：为了保证硬件的稳定和耐用，长时间的使用不会出现异常，还要从写入硬件的程序入手，提高程序设计可靠性。   协调器是由ZigBee无线模块、CC2530控制模块、串口通信、通用I/O模块、电源模块、按键模块组成 [ 7 ] 。 协调器作用：主要向终端发送需求指令和数据命令。如图5所示。 协调器各个模块的作用： CC2530内核：CC2530内核是协调器的内核处理器 [ 8 ] ，用于处理传输过的各种数据，包括按键命令，网络中终端的加入和退出请求，ZigBee网络的建立与维护。对相应的数据进行发送处理。 无线模块：无线模块是在CC2530模块中，是发送和接受终端节点的数据作用，并将这些数据传输给CC2530内核。其中规定了发送和接受的数据都必须以IEEE802.15.4协议的格式，运用ZigBee无线通信技术。 通用I/O模块：I/O模块分为I/O设备和I/O接口两个部分，分别代表单片机数据的进、出端口，输入输出I/O流可以看成对字节或者包装后的字节的读取 [ 9 ] ；强电进入系统的同时实现联动控制系统的弱电线路与被控设备的强电线路之间的转换。 电源模块：给协调器供电。 按键模块：按键模块由一个复位按钮，一个对LED灯的亮灭手动控制和自动控制的切换按钮，一个控制LED灯的亮灭按钮组成，根据用户不同的需求，对终端上的LED灯进行操作。 图5. 协调器结构图  终端由ZigBee无线模块、CC2530控制模块、光敏模块、通用I/O模块、电源模块、按键模块组成。 终端的作用：接收协调器发送过来的数据命令和需求指令，根据不同的命令实现对LED灯的控制 [ 10 ] 。如图6所示。 终端各个模块的作用： 光敏模块：光敏模块的作用是检测此时外界光照的强弱，并将采集的光照强度信息即光信号转化为电信号，再将数据发送给终端的CC2530进行处理 [ 11 ] 。 CC2530内核：用于处理传输过的各种数据，并接受来自光敏模块对外界光照强度的检测结果，最后控制LED灯是否亮灭。 无线模块：用于发送和接受终端节点的数据，与协调器的ZigBee无线模块的作用相同 [ 12 ] 。 通用I/O模块：提供直流电源，对调光信号进行输出。 电源模块：给终端供电。 LED灯：用亮灭来实现对CC2530控制模块的命令。   ZigBee底板用来插ZigBee的核心板。RST复位引脚、DEBUG_DD和DEBUG_DC下载程序的引脚 [ 13 ] 。如图7所示。  光敏电路是通过光敏模块检测外界的光的强弱 [ 14 ] ，然后将光信号转化为电信号传送给终端，整体的光敏电路是通过数模转化完成对光信号的转换，通过高低电平来确定强光时为高电平1，弱光时为低电平0。如图8所示。  电源开关电路，因为ZigBee主控需要3.3V工作电压，控制ZigBee板的开关。如图9所示。 电源指示灯电路，当ZigBee不出现障碍时，接通电源会保持常亮状态，LED灯0为电源指示灯。如图10所示。  组网指示灯电路，用来显示ZigBee网络建立状况，当协调器建立ZigBee网络终端，并且加入该网 图6. 终端图 图7. ZigBee底板电路图 图8. 光敏电路图 络之后，终端和协调ZigBee底板的组网指示灯就会亮起，说明网络建立成功。如图11所示。  复位键电路，即初始化的电路。复位电路有三种：上电复位、按钮复位、积分型上电复位，本设计采用手动复位的方式。复位电路并不会让程序消失，只会让其之前的计算数据消失，复位键电路需要复位健的输入端加上高的电平。如图12所示。 图9. 电源开关电路图 图10. 电源指示灯电路图 图11. 组网指示灯电路图 图12. 复位按键电路图 自动手动控制按键电路，LED灯有两种控制方式，一是通过光照强度检测控制，二是通过协调器控制，次按键用来切换手动控制和自动控制。如图13所示。 开关按键电路，次按键是协调器上的按键，在协调器切换到手动模式的情况下，通过协调器上的开关按键控制LED灯的亮灭。如图14所示。  将从IAR开发平台开发好的程序，通过JTAG接口写入ZigBee的核心板中，对芯片的内部进行编程，DEBUG_DD和DEBUG_DC是下载程序的引脚。如图15所示。  在5 V转3.3 V电路中，因为ZigBee主控需要3.3 V工作电压，由于外部都是5 V直流电源供电。此电源模块从外部电源的输出端取5 V直流电，然后通过AMS1117线性稳压器，转变为ZigBee主控所需要的3.3 V直流电源，从而ZigBee主控正常工作。如图16所示。 图13. 自动手动切换按键电路图 图14. 开关按键电路图 图15. 程序下载电路图 图16. 电压转换电路图"
"将协调器切换为自动模式，光敏模块对外界光照强度进行检测。实验效果如图17和图18所示。用手或者物体来挡住光照检测终端的光敏模块的光，可以看出LED灯泡处于常亮状态，实验效果与预期一致。在协调器上，此LED灯在实验中不受任何控制，保持常亮。  将协调器切换为手动模式，用协调器来控制灯的亮灭。实验效果如图19和图20所示切换开关实现 图17. 自动模式光照充足 图18. 自动模式光照不足 图19. 手动模式关 LED灯的亮灭，当用协调器向终端发送开灯指令LED灯为常亮状态，实验效果与预期效果一致。 当协调器向终端发送关灯指令LED灯熄灭，此时用手指遮住光照检测终端的光敏传感器，可以看出LED泡并没有亮，继续保持熄灭状态，实验效果与预期一致。如图21所示。"
"在本次基于ZigBee的无线照明系统终端控制设计中，对ZigBee技术与LED灯的结合运用进行了分析，将C语言程序烧入到ZigBee的核心板CC2530中。并完成自动和手动两种模式下对LED灯的控制。 本次基于ZigBee的无线照明系统终端控制设计的工作内容如下： 1) 了解当代LED灯的发展状况，分析传统照明系统的缺点，了解无线通信技术对LED灯的用途，当前主流无线通信技术选用ZigBee技术的分析比较，还有选用ZigBee技术作为当前LED灯智能化通信原因。 2) 学习ZigBee核心技术，建立明确的LED灯的总体设计方案，实现协调器与终端节点具体设计。 3) 学习C语言程序在ZigBee中的应用，运用IAR平台，写入ZigBee电路板软件程序设计和分析解释。 图20. 手动模式开 图21. 手动模式 4) 设计并实现了模拟用于家居现场的智能照明控制的。"
