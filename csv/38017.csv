"基于Copula函数分别建立金沙江和岷江年最大洪水发生时间和量级的联合分布，推求两江洪水发生时间遭遇的概率，采用联合概率、同现概率和条件概率定量分析两江洪水量级遭遇的风险，并对三种遭遇概率的计算结果进行比较，探讨这三种概率描述洪水遭遇风险的适用性与合理性。结果表明：联合概率的计算结果可能偏大，用来描述洪水遭遇风险并不理想；同现概率和条件概率的计算结果相对合理可靠，符合洪水遭遇的一般规律。 关键词 :洪水遭遇概率，Copula函数，联合分布，条件概率，比较研究 Copyright © 2020 by author(s) and Wuhan University. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"流域内干支流洪水遭遇，会使洪峰和洪量出现不同程度的叠加，形成大洪水，威胁下游河道安全。研究洪水的遭遇问题，对流域洪水规律的认识和防洪减灾具有重要意义。目前，主要采用水文分析法研究洪水遭遇的规律，对研究区域历年同步的洪水资料作统计分析 [ 1 ]。如郑静等 [ 2 ] 从洪量和洪水过程的角度出发，重点分析了金沙江中游与长江中下游洪水的遭遇规律。熊莹 [ 3 ] 分析了长江上游干支流洪水组成，考虑洪峰遭遇和洪量遭遇两种情况，研究了长江与岷江、嘉陵江及乌江的洪水遭遇规律。戴明龙和沈燕舟 [ 4 ] 采用水文分析法，从遭遇时间、遭遇次数、遭遇程度及洪峰和洪量等方面，详细地分析了长江上游与洞庭湖洪水的遭遇规律。肖天国 [ 5 ] 依据对年最大洪峰和时段洪量的统计，分析了金沙江和岷江的洪水组成和洪水遭遇规律。但传统的水文分析法只能对已经发生的洪水进行简单的统计，不能估计百年一遇或千年一遇等设计洪水的重现期和遭遇概率 [ 1 ]。 洪水遭遇的本质是一个多变量的频率组合事件，可以采用多变量的频率分析计算法对其进行研究 [ 6 ]。目前，常用的多变量水文分析方法有非参数法、特定边缘构成的联合分布法、多元正态分布法、经验法和将多维联合分布转换成一维分布的方法，但这些方法都存在一定的局限和不足 [ 7 ] [ 8 ]。近年来，Copula函数成为水文领域的研究热点，它克服了传统方法的不足，通过任意的边缘分布和相关性结构来构造多维联合分布，其形式灵活多样，求解较为简单，在暴雨、洪水和干旱的频率分析计算和洪水遭遇等问题中得到广泛的应用 [ 7 ] [ 9 ]。王占海等 [ 10 ] 引入M-Copula函数，建立长江上游干流寸滩站和宜昌站年最大洪峰的联合分布函数，分析洪水的遭遇组合及遭遇概率。甘富万等 [ 11 ] 采用Copula函数建立郁江和西江年最大洪峰的联合分布，对区域洪水遭遇进行多变量分析计算。张新田等 [ 12 ] 基于二维Copula函数建立金沙江攀枝花站与雅砻江桐子林站年最大洪峰流量联合分布，定量评价了金沙江与雅砻江不同量级洪水的遭遇概率。蒋楠等 [ 13 ] 以锦河与连锦河为研究对象，采用Copula函数构建两江洪峰的联合分布，推求两江洪水的遭遇概率。但这些研究都只考虑了洪水量级的遭遇，并没有考虑洪水的发生时间。近年来，一些学者在研究洪水遭遇问题时，同时考虑了洪水量级和洪水发生时间两个因素。如陈璐等 [ 6 ] 利用多维非对称Archimedean Copula函数，分别建立长江上游干支流洪水发生时间和洪水量级的联合分布，分析干支流洪水发生时间和量级的遭遇风险。闫宝伟等 [ 14 ] 以长江和清江为研究对象，基于二维Copula函数分别构造了两江年最大洪水发生时间以及洪水发生时间和量级的联合分布模型，估计洪水发生时间和洪水量级的遭遇概率。张超等 [ 15 ] 采用三维非对称Archimedean Copula函数建立宜昌站和城陵矶站年最大洪峰及其间隔时间的联合分布，分析长江上游与洞庭湖洪水的遭遇风险。仇红亚等 [ 9 ] 基于椭圆Copula函数，分别构造洞庭湖流域多源洪水发生时间和量级的联合分布模型，研究流域多源洪水发生时间和量级的遭遇概率。 本文以金沙江和岷江为研究对象，基于Copula函数分别建立两江年最大洪水发生时间和量级的联合分布，估算洪水发生时间的遭遇概率，采用联合概率、同现概率和条件概率分析推求洪水量级的遭遇风险，重点研究比较三种计算方法得到的洪水遭遇概率，并讨论各种方法的合理性与可行性。"
"Copula函数是定义在[0,1]区间均匀分布的多维联合分布函数。依据Sklar定理，设随机变量X，Y的边缘分布函数分别为 F X ( x ) 和 F Y ( y ) ， F ( x , y ) 是X和Y的联合分布函数，则必存在唯一的Copula函数使得 [ 16 ]： F ( x , y ) = C θ ( F X ( x ) , F Y ( y ) ) = C θ ( u , v ) (1) 式中：C为Copula函数； θ 为Copula函数的参数；u和v为边缘分布函数， u = F X ( x ) = P X ( X ≤ x ) ， v = F Y ( y ) = P Y ( Y ≤ y ) 。 Copula函数种类繁多，其中Archimedean Copula函数结构形式多样、参数少、易求解、适应性强，在水文领域得到广泛的应用。本文选用此族函数中最为常用的Clayton Copula、Gumbel-Hougaard(GH)Copula和Frank Copula，其结构形式如下 [ 7 ]： 1) Clayton Copula： C ( u , v ) = ( u − θ + v − θ − 1 ) − 1 / θ ; θ ∈ ( 0 , ∞ ) (2) 2) Gumbel-Hougaard Copula： C ( u , v ) = exp { − [ ( − ln u ) θ + ( − ln v ) θ ] 1 / θ } ; θ ∈ [ 1 , ∞ ) (3) 3) Frank Copula： C ( u , v ) = − 1 θ ln [ 1 + ( e − θ u − 1 ) ( e − θ v − 1 ) ( e − θ − 1 ) ] ; θ ∈ R (4)  在不考虑洪水量级的情况下，将洪水发生时间作为研究变量。一般流域内两江年最大洪水发生在同一天的概率极小。因此，本文假定年最大洪水发生时间的间隔不超过 Δ t 天即为遭遇，同时考虑洪水传播时间，则两江年最大洪水发生时间在第k天遭遇的概率 P k t 为： P k t = P ( t k < T i ≤ t k + 1 , t k + τ − Δ t < T j ≤ t k + 1 + τ + Δ t ) (5) 式中：i，j表示水文控制站点，i站在j站的上游； T i ， T j 为两江年最大洪水发生时间，以汛期某一天表示； t k 表示汛期时段的第k天； τ 表示洪水从i站到j站的传播时间； Δ t 表示两江年最大洪水发生时间的间隔。将汛期内洪水的日遭遇概率相加，即可得到两江年最大洪水发生时间在整个汛期遭遇的概率 P t ： P t = ∑ k = 1 N P k t (6) 式中：N为汛期的天数。  在洪水频率分析计算中，对于两变量Copula联合分布，一般研究联合概率、同现概率和条件概率。联合概率是指两个变量中至少有一个超过其设计值时事件发生的概率。变量X，Y的联合概率为： P ( X > x ∪ Y > y ) = 1 − F ( x , y ) = 1 − C ( u , v ) (7) 同现概率是指两个变量同时都超过设计值时事件发生的概率。变量X，Y的同现概率为： P ( X > x ∩ Y > y ) = 1 − F X ( x ) − F Y ( y ) + F ( x , y ) = 1 − u − v + C ( u , v ) (8) 条件概率是指给定某一变量的范围，另一变量发生的概率大小。当 X > x 时， Y > y 的条件概率为： P ( Y > y | X > x ) = P ( X > x ∩ Y > y ) P ( X > x ) = 1 − F X ( x ) − F Y ( y ) + F ( x , y ) 1 − F X ( x ) = 1 − u − v + C ( u , v ) 1 − u (9) 将洪水量级作为研究变量。如果两江洪水不是在同一天发生或发生的时间间隔较大，则不能认为洪水发生遭遇。两江洪水遭遇意味着两江发生的洪水量级在一定程度之上，且洪水发生时间的间隔在一定范围之内。因此，在研究洪水量级遭遇时，必须考虑洪水发生时间。假设洪水发生时间和洪水量级是两个相互独立的随机变量，则两江中至少有一江发生某一量级洪水遭遇的联合概率为： P T = P t ⋅ P ( Q i > q i T ∪ Q j > q j T ) (10) 考虑洪水发生时间，两江同时发生某一量级洪水遭遇的同现概率为： P T = P t ⋅ P ( Q i > q i T ∩ Q j > q j T ) (11) 同理，i江发生某一量级洪水时，j江发生另一量级洪水遭遇的条件概率为： P T = P t ⋅ P ( Q j > q j T | Q i > q i T ) (12) 式中： q i T ， q j T 为两江T年一遇的洪水设计值。"
"长江流域的洪水多由暴雨形成。流域内发生特大暴雨，上下游洪水先后叠加，易形成峰高量大的洪水，造成局部河段的洪水灾害。金沙江是长江的上游河段，全长3500 km，控制流域面积为50万km 2 。金沙江洪水主要由上游的融雪和中下游暴雨叠加形成，洪量大、历时长、涨落幅度小。金沙江流域面积大，流域形状狭长，且降雨常连续发生，使多场洪水连在一起，洪水持续时间最长可达40天。岷江为长江上游左岸的一级支流，全长735 km，流域面积13.54万km 2 。岷江洪水多由暴雨形成，历时短、洪峰高、涨落快，洪峰一般持续2~4小时。两江流向与暴雨走向大体一致，洪水易发生遭遇，形成长江上游大洪水。如1966年，金沙江发生自1939年以来实测最大洪水，同时岷江也出现年最大洪水，成为两江洪水遭遇的典型。 本文采用金沙江屏山站和岷江高场站1951~2016年共66年的汛期日径流资料，采用年最大取样法，分别得到两站年最大日流量及其发生时间的序列，作为年最大洪水样本。   方彬等 [ 17 ] 首次引入von Mises分布拟合年最大洪水发生时间，结果表明von Mises分布能较好地拟合具有周期性特征的变量。洪水发生时间往往呈现出多峰的特征，所以采用混合von Mises分布来描述其概率密度函数 [ 18 ]。 将洪水发生时间转换为弧度x， x = 2 π D j / L ，其中 D j 代表洪水发生在汛期的第j天，L为汛期的总长度，洪水发生时间X的概率密度函数为： f X ( x ) = ∑ i = 1 m p i 2 π I 0 ( k i ) exp [ k i cos ( x − u i ) ] ; 0 ≤ x ≤ 2 π , 0 ≤ u i ≤ 2 π , k i > 0 (13) 式中： p i 为混合比例的系数； k i 是尺度参数； u i 是位置参数； I 0 ( k i ) 是0阶Bessel函数；m是有限混合von Mises分布的阶，取m = 3。 采用极大似然法估计混合von Mises分布的参数，采用Kolmogorov-Smirnov法(K-S)和均方根误差法(RMSE)进行拟合检验，结果如表1所示。在显著水平为5%的情况下，K-S检验统计量均小于临界值0.164，说明两站的边缘分布都通过检验，且两站理论分布与经验频率的RMSE值都比较小。因此，采用混合von Mises分布拟合洪水发生时间是可行的。图1为屏山站和高场站年最大洪水发生时间经验点据与理论分布频率曲线的拟合图。由图可知，理论值与经验频率拟合较好。  根据《水利水电工程设计洪水计算规范》，采用P-III型分布计算设计洪水，即年最大洪水量级Y服从P-Ⅲ型分布，其概率密度函数如下 [ 19 ]： f Y ( y ) = β α Γ ( α ) ( y − δ ) α − 1 exp [ − β ( y − δ ) ] ; α > 0 , β > 0 , δ ≤ y < ∞ (14) 式中： α 、 β 和 δ 分别是P-III型分布的形状、尺度和位置参数； Γ ( ⋅ ) 是伽玛函数。 采用线性矩法估算P-III型分布的参数，采用 χ 2 检验法和均方根误差法进行拟合检验，结果如表2所示。当显著性水平为5%时，自由度为 k − r − 1 (其中r为参数个数，k为 χ 2 检验的分组数)的 χ 2 检验的p值均大于临界值0.05，说明两站的P-III型分布都通过了假设检验，且两站的RMSE值都较小。因此，可以选用P-III型分布拟合年最大洪水量级。图2为两站年最大洪水量级经验点据与理论分布频率曲线拟合图。图中，理论值与经验频率拟合情况良好。 Table 1 控制站 u i k i p i K-S检验 RMSE 4.33 68.01 0.17 屏山 5.19 7.91 0.49 0.060 (0.164) 0.020 3.40 5.69 0.34 4.23 2.22 0.64 高场 3.66 300.00 0.13 0.046 (0.164) 0.014 2.88 7.87 0.23 表1. 洪水发生时间边缘分布参数及检验结果 Table 2 控制站 α β δ χ 2 检验p值 RMSE 屏山 7.93 0.0007 5129.4 0.262 (0.05) 0.018 高场 6.57 0.0005 3522.7 0.262 (0.05) 0.222 表2. 洪水量级边缘分布参数及检验结果 图1. 洪水发生时间经验点据与理论频率曲线拟合图 图2. 洪水量级经验点据与理论频率曲线拟合图  采用Clayton Copula、GH Copula和Frank Copula函数分别建立金沙江屏山站和岷江高场站年最大洪水发生时间和洪水量级的二维联合分布，即： F ( t i , t j ) = C ( T i , T j ) (15) F ( q i , q j ) = C ( Q i , Q j ) (16) 式中： T i ， T j 分别表示金沙江屏山站和岷江高场站年最大洪水发生时间； Q i ， Q j 分别表示两站的洪水量级。 利用Kendall秩相关系数估计Archimedean Copula函数的参数，计算经验频率与理论频率的均方根误差进行拟合优度评价，结果如表3所示。由表可知，在洪水发生时间和洪水量级的联合分布中，三种Copula函数的RMSE值都相差较小，且GHCopula函数的RMSE值均最小，拟合效果最佳，故选用GHCopula函数分别建立两江洪水发生时间和量级的联合分布。图3分别为洪水发生时间和洪水量级联合分布的经验频率和理论频率关系图。由图可知，拟合效果较好，说明建立的联合分布合理可行。 Table 3 Copula函数 发生时间 洪水量级 θ RMSE θ RMSE Clayton 0.09 0.0296 0.43 0.0330 GH 1.04 0.0293 1.21 0.0269 Frank 0.39 0.0294 1.62 0.0285 表3. 洪水发生时间及量级联合分布的参数估计值及拟合检验结果 图3. 洪水发生时间和量级联合分布经验频率与理论频率拟合图   如前所述，流域内两江年最大日流量出现在同一天的概率极小。实测资料中，金沙江和岷江年最大洪水发生在同一天的情况也非常少。金沙江洪水持续时间长，涨落平缓，而岷江洪水持续时间相对较短，涨落较快，一般为5~7天。因此，认为两江年最大日流量发生时间的间隔在4天之内即为洪水发生遭遇。通过式(5)计算金沙江和岷江洪水发生时间遭遇的概率，点绘第k天遭遇的概率 P k t ，如图4所示。 由图可知，金沙江和岷江洪水在6月份以前遭遇的概率非常小，接近于0；在7月中旬~9月初易发生遭遇，遭遇概率基本维持在1.0 × 10 −3 以上；7月下旬出现遭遇的高峰期，7月24日遭遇的概率最大，达到5.0 × 10 −3 ；8月10日出现另一个小的峰值，概率为2.6 × 10 −3 。根据气候实测资料统计，金沙江和岷江的暴雨都主要集中在6月~9月，8月暴雨最多，其次是7月。由此可见，模型计算的年最大洪水发生时间遭遇结果与实测统计相一致。 图4. 金沙江和岷江洪水发生时间的日遭遇风险  本文在研究洪水量级遭遇时，考虑了洪水发生时间，认为洪水发生时间与洪水量级相互独立，根据式(10)和式(11)分别计算金沙江和岷江发生大于某重现期洪水遭遇的联合概率和同现概率，根据式(12)计算金沙江发生大于特定重现期洪水时，岷江发生某重现期洪水的条件概率。表4列出了重现期分别为5年、10年、20年、50年及100年情况下两江洪水遭遇的联合概率、同现概率和条件概率，对三种遭遇概率计算结果的分析讨论如下： 洪水发生量级遭遇的联合概率可能偏大。因为从联合概率定义的角度出发，不能保证两江都发生某一量级的洪水，若只有一江发生洪水，则不是洪水遭遇，这就会导致结果偏大。因此，在研究洪水遭遇问题时，采用联合概率描述遭遇风险并不合理，选用同现概率和条件概率更为恰当。 低重现期洪水遭遇的概率比高重现期洪水的大，且同现概率远小于条件概率。金沙江与岷江发生5年、10年、20年、50年和100年一遇洪水遭遇的同现概率分别为9.21 × 10 −3 、3.73 × 10 −3 、1.65 × 10 −3 、0.61 × 10 −3 和0.30 × 10 −3 ，随着重现期的增大，洪水量级遭遇的同现概率明显减小。而两江发生5年、10年、20年、50年和100年一遇洪水遭遇的条件概率分别为46.03 × 10 −3 、37.27 × 10 −3 、32.94 × 10 −3 、30.36 × 10 −3 和29.50 × 10 −3 ，随着重现期的增大，条件概率逐渐减小，但减小幅度不大。从同现概率和条件概率计算结果均可看出，金沙江和岷江大洪水发生遭遇的概率较小，中小洪水遭遇的概率更大，即中小洪水更容易发生遭遇，符合一般规律。 与发生小洪水相比，当上游金沙江发生大洪水时，下游岷江发生不同量级洪水的条件概率更大。金沙江发生5年一遇洪水时，岷江发生5年、10年、20年、50年和100年一遇洪水遭遇的条件概率分别为46.03 × 10 −3 、27.90 × 10 −3 、16.25 × 10 −3 、7.56 × 10 −3 和4.12 × 10 −3 ；而金沙江发生100年一遇洪水时，岷江发生5年、10年、20年、50年和100年一遇洪水遭遇的条件概率分别为82.43 × 10 −3 、68.94 × 10 −3 、56.48 × 10 −3 、40.66 × 10 −3 和29.50 × 10 −3 。由于金沙江和岷江洪水量级的Kendall相关系数为0.18，呈正相关关系，上游洪水对下游洪水有影响，且上游发生大洪水时，下游更容易发生洪水。 Table 4 河名 金沙江 遭遇概率 重现期 5 10 20 50 100 岷江 5 40.87 31.98 28.05 26.03 25.47 联合概率 10 31.98 21.31 16.41 13.82 13.08 岷江 20 28.05 16.41 10.87 7.83 6.95 联合概率 50 26.03 13.82 7.83 4.40 3.35 100 25.47 13.08 6.95 3.35 2.21 5 9.21 5.58 3.25 1.51 0.82 同现概率 10 5.58 3.73 2.37 1.21 0.69 20 3.25 2.37 1.65 0.93 0.57 50 1.51 1.21 0.93 0.61 0.41 100 0.82 0.69 0.57 0.41 0.30 5 46.03 55.80 64.99 75.60 82.43 条件概率 10 27.90 37.27 47.36 60.24 68.94 20 16.25 23.68 32.94 46.50 56.48 50 7.56 12.05 18.60 30.36 40.66 100 4.12 6.89 11.30 20.33 29.50 表4. 金沙江和岷江洪水发生量级遭遇的联合概率、同现概率和条件概率(×10 − 3 )"
"本文以金沙江屏山站和岷江高场站1951~2016年的汛期日径流资料为基础，采用混合von Mises分布拟合年最大洪水发生的时间，采用P-III型分布拟合年最大洪水的量级，基于GH Copula函数分别建立两江年最大洪水发生时间和洪水量级的联合分布，分析了金沙江和岷江洪水发生时间和量级的遭遇风险，重点研究比较了联合概率、同现概率和条件概率这三种分析计算方法描述洪水遭遇风险的合理性与可靠性，主要结论如下： 1) 金沙江和岷江洪水在6月份以前遭遇的概率接近于0，7月中旬~9月初易发生遭遇，概率基本在1.0 × 10 −3 以上，7月24日出现遭遇峰值，概率为5.0 × 10 −3 ，8月10日有另一个小的峰值，概率为2.6 × 10 −3 。 2) 考虑到联合概率的定义，不能保证两江都发生特定量级的洪水，因此认为联合概率不适合用来描述洪水量级遭遇风险，同现概率和条件概率更合理可行，二者的计算结果也符合洪水遭遇的一般规律。 3) 低重现期洪水遭遇的概率比高重现期洪水的大。金沙江与岷江发生10年一遇洪水遭遇的同现概率为3.73 × 10 −3 ，而100年一遇洪水遭遇的概率仅为0.30 × 10 −3 ，中小洪水更容易发生遭遇。 4) 洪水发生量级遭遇的同现概率远小于条件概率。两江发生100年一遇洪水遭遇的同现概率为0.30 × 10 −3 ，而条件概率为29.50 × 10 −3 。 5) 当上游金沙江发生大洪水时，下游岷江发生不同量级洪水的条件概率更大。金沙江发生5年一遇洪水时，岷江发生100年一遇洪水遭遇的概率为4.12 × 10 −3 ；金沙江发生100年一遇洪水时，岷江发生100年一遇洪水遭遇的概率为29.50 × 10 −3 。"
