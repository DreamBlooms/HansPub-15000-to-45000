"黄金具有良好的流通、保值和避险等功能，目前是世界各国储备资产的重要组成部分。黄金期货具有规避风险、获取收益的作用。黄金期货市场不仅对黄金现货市场具有重要的导向作用，而且对完善货币市场、外汇市场，对提高金融市场国际吸引力，对国民经济的又好又快发展，都具有重大意义。本文运用两状态的马尔可夫状态变换模型以及支持向量回归模型来分析期货黄金的走势上涨或者下跌的趋势，重要将使用的方法为复合似然函数，可以对国内黄金期货投资者提供一种预测方法。 关键词 :黄金期货，支持向量回归，马尔可夫状态变换模型，复合似然函数"
"黄金作为一种具有商品和金融双重属性的特殊商品，它具有良好的流通、保值和避险等功能，是投资者规避风险、获取收益的重要手段。我国黄金产业的市场化开发在2001年才开始步入市场发展道路。在2008年，上海期货交易所正式推出黄金期货合约，这标志着我国黄金市场体系的初步建成。所谓黄金期货，是指以国际黄金市场未来某时点的黄金价格为交易标的期货合约，投资人买卖黄金期货的盈亏，是由进场到出场两个时间的金价价差来衡量，契约到期后则是实物交割。最近几年，黄金期货投资在国内越来越热。因此，对于黄金的价格的涨跌预测具有十分重要的现实意义。 期货市场作为金融市场的重要组成部分，其价格走势能够反映人们，对价格未来走势的预期，期货市场具有以下作用： (1) 价格发现：所谓价格发现，是指利用市场公开竞价交易等交易制度，形成一个反映市场供求关系的市场价格，具体来说就是，市场的价格能够对市场未来走势做出预期反应，同现货市场一起，共同对未来做出预期。 (2) 套期保值：套期保值是指把期货市场当作转移价格风险的场所，利用期货合约作为将来在现货市场上买卖商品的临时替代物，对其现在买进准备以后售出商品或对将来需要买进商品的价格进行保险的交易活动。 尽管我国黄金期货上市时间不久，但是吸引了许多学者的关注。王中香(2009) [ 1 ] 运用BP神经网络模型来预测黄金期货的价格。徐伟(2009) [ 2 ] 本文分别从期货市场和现货市场两个方面对中国黄金期货价格发现障碍的原因进行分析。高扬(2010) [ 3 ] 得出我国黄金期货定价效率不高，与现货价格互动的强度较低的结论。祝合良(2012) [ 4 ] 验证了黄金期货市场进行套期保值是有效的。刘飞(2013) [ 5 ] 利用协整理论、误差修正模型、永久瞬时模型以及分位数回归等方法系统分析了我国黄金期货市场的定价效率、引导–滞后关系以及价格发现功能。仲维凯[ 6 ] 在2015年影响黄金价格的因素，并建立了预测黄金价格的ARMA模型和VAR模型。 Hamilton (1989) [ 7 ] 首先提出Markov状态转换模型，运用三状态两阶滞后的Markov机制转换模型研究了美国1953~1984年间季度实际产出增长的波动，模型回归效果良好，能够较好地刻画了实际产出增长的非线性动态和非对称特性。Gray (1996) [ 8 ] 为了解决MS-GARCH模型存在路径依赖问题，提出了一种近似的解法：通过简化假设使条件方差依赖于上一期的状态，通过极大似然法估计下一状态的方差。Hassan，Nath (2005) [ 9 ] 提出了一种基于机器学习的股票价格预测方法，采用了连续的隐含马尔科夫模型，将股票的日开盘价，最高价，最低价与收盘价作为模型输入，预测股票的未来日收盘价。Dueker，Neely(2007) [ 10 ] 利用Markov状态转换模型来预测外汇市场中汇率的变动，取得了一定的效果。周茂化(2011) [ 11 ] 与许立平(2011) [ 12 ] 分别运用GARCH族模型和ARIMA模型对黄金市场进行预测研究，GARCH族模型和ARIMA模型都属于单一状态的模型，而黄金期货市场是属于一个多状态模型(高波动，低波动)。因此本文希望能应用一个多状态模型去建立黄金期货的预测模型。而Zou，Che (2013) [ 13 ] 利用正态分布条件下复合似然函数方法，改进了Markov状态转换模型中的参数估计，对原油价格进行预测，效果良好。对于黄金期货的预测，没有人将运用基于复合似然函数方法的Markov状态转换模型运用其中，本文将此方法运用，希望能获得一个较好的结果。在Markov状态转换模型中，只用多个状态的均值去预测下一期的估计值。本文考虑到下一期的估计值应该与状态的均值与方差都有一定的关系，因此本文将尝试结合支持向量回归模型(SVR)与复合似然函数下的Markov状态转换模型来预测下一期的估计值。杨金芳(2005) [ 14 ] 将支持向量回归模型应用到时间序列。李永娜(2014) [ 15 ] 对支持向量机的回归预测进行了综述。 本文将以日度上海期货黄金指数为研究对象，运用马尔可夫状态。变换模型去预测后天的价格上涨或者下跌的情况，其中我们将选取复合似然函数方法。预测方法为向前预测方法或者支持向量回归模型。"
"设随机过程 只取整数值 ，假定， 的取值只与 有关，而与 期前S的取值无关，那么此随机过程被称为N状态下的马尔科夫链，用公式可表示为： 转移概率 代表状态 条件下 的概率，若该过程服从一阶Markov链过程，可用转移矩阵P来表示转移概率： 其中， 。  下面以正态分布为例，构建期货黄金指数的Markov模型，假定t时期的期货黄金指数为 ， 。假定存在一个不可观测变量 代表t时刻期货黄金指数所处状态，当 ， 的边缘分布为 ， 服从N状态下的一阶马尔科夫链。 Markov模型中需要估计的参数有转移概率 。我们采用EM算法去进行参数估计，关于似然函数的选择有两种方式：完全似然函数Zucchini (2009) [ 16 ] 、复合似然函数Zou (2013) [ 13 ] 。不过在Zou (2013) [ 13 ] 已经说明复合似然函数效果要好于完全似然函数。 在正态分布条件下，复合似然函数可表示为： (1) 其中， 表示 时刻为 状态而 状态。 表示 属于状态 状态的概率。 每时刻的状态都是未知的，我们可以将其作为缺失变量。因此可以利用EM算法估计参数 。利用所预测出来的参数，通过平滑概率，可以计算出当t = T时， 属于每个状态的概率。我们也可以通过参数P、 、 与第t时刻的观测值 可以预测出当t = T + 1时， 属于每个状态的概率，均值和方差。 本文运用惩罚下复合似然函数Chen (2012) [ 17 ] 作为似然函数 (2) 在这里 为序列的样本方差。由Zou (2013) [ 13 ] 可知在这种方法下迭代步骤为 在E-STEP，我们运用贝叶斯公式计算条件期望值 (3) 其中 。在EM算法中，我们假定这个变量为隐藏变量。 在M-STEP，我们最大化似然函数，则可得 (4) (5) TEP (6) 其中 和 ，其中 。  本文将采用两种预测方法，第一种基于向前预测方法，第二种为基于支持向量回归的预测方法。  在本文，主要考虑的是利用过去100天交易日的上海期货黄金价格变动数据，来预测下一天涨跌情况，并且逐步递归的进行。我们将运用向前预测方法Baum (1970) [ 18 ] 预测下一天的股票收益率。 (7) 其中 可以用向前递归方法进行预测。 通过上述公式，可以获得 的估计值。  本文所提出的基于支持向量回归方法为对公式(7)中的 与 值修正。因为每一个时间段下的 与 ， 有一定关系，但不一定为线性关系。因此，我们考虑用支持向量回归方法去拟合数据。由向前预测方法可知，估计 ，将会估计出一个 ， 。本文所提出的基于支持向量回归方法基于向前预测方法下， 分别与 ， 建立两个支持向量回归模型，设定样本所需时间为 ，并且对 进行预测。模型定义如下 ， 为因变量向高维空间的映射，在这里 。关于支持向量回归模型，我们需要极小化目标函数，即求下式最小： (8) (9) 其中令 ， 称为核函数。在这里，我们选择 ， ， 核函数为RBF函数的支持向量机。我们利用这两个支持向量回归模型分布预测第201天的波动值，记 。令 其中 ， 的计算与向前预测方法一样。 假设，向前预测方法需要100天作为训练集，获得 。需要200天去获得支持向量回归模型。因此可知，我们总共需要300作为训练样本，去预测301的数据值。因此可知预测方法为向前预测方法所需要的天数比支持向量回归模型少。"
"我们用了2008年1月到2014年12月份的上海黄金期货收盘价格做本文的价值数据(price)，计算价格变动趋势为 ， 表示第t期的黄金期货的收盘价。因此可知，当 ，表示下一交易日相对上一个交易日来说，期货价格为上涨。当 ，预测下一交易日期货价格为下跌。 假如我们在每年年初，有100元准备投资黄金期货。如果预测的 ，表示进行买进套期保值，并且一直持有。直到 ，表示卖出手头期货产品，并进行卖出套期保值。我们选择的100天作为训练天数来预测后天一天的涨跌情况因此我们预测的数据将不会从2008年1月开始，本文将选择预测结果从2009年1月到2014年12月来检验模型的有效性。如表1。 向前预测方法模型的训练天数为100天，预测第101天的价格变动，我们假定其为一个时段。因为每个时段下的两个状态所对应的均值与方差所不同，因此我们主要关心套期交换次数与年收益率。套期交换次数越少就表面了黄金期货市场具有较大上涨趋势或者下跌趋势。并且套期交换次数较少能减少交易所需要的费用。有上表1，可知向前预测模型的年平均收益率为1.09，并且年平均套期交换次数为4次，这样交易手续费将会减少。而预测方法为支持向量回归的平均年收益率为1.13。由此可知，预测方法为支持向量回归的效果要好于向前预测。不过交易次数为向前预测方法的4倍，假如考虑每笔交易将获得的收益情况，向前预测方法比支持向量回归的方法要好。但是两种方法都比淘宝招财宝的最高收益率1.06要高。 图1为复合似然函数下马尔可夫状态模型下，运用向前预测方法预测2009~2014的股票波动情况，图2为复合似然函数下马尔可夫状态模型下，运用支持向量回归方法预测2009~2014的股票波动情况。 Table 1 向前预测方法 支持向量回归 年份 收益率 套期交换次数 年份 收益率 套期交换次数 2009 26.3% 8 2009 −2.5% 15 2010 18.9% 3 2010 22.9% 19 2011 −5.9% 6 2011 21.0% 16 2012 −11.5% 6 2012 4.7% 17 2013 33.2% 6 2013 31.2% 14 2014 −4.4% 7 2014 −2.2% 18 平均值 9.4% 4.2 平均 12.53% 16.5 表1. 马尔科夫转换模型投资效果 图1. 黄金期货价格走势(Markov状态转换模型) 图2. 黄金期货价格走势(Markov状态转换模型 + SVR) 其中position为 时，我们进行卖出套期。其中position为1时，我们进行买入套期。 由图1，图2可知，两个模型所做的交易基本相似，不过在局部有点不一样，两种模型对总体的波动情况都有较好的拟合，2009~2011这种总体趋势上升的趋势能模拟的较好，对2013年总的下降趋势也能拟合的较好，在2012与2014年拟合的效果不是很好，这个原因可能为入选的变量只有收盘价格，没有考虑到别的因素。在训练复合似然函数下的马尔可夫状态转换模型中，定义训练天数为100天也会有一定的影响结果。"
"虽然本文提供的算法不能有效的预测未来黄金期货的真实价格，但是可以将其应用到期货黄金指数涨跌趋势预测，并且对期货的总体走势有较好的预测效果，按照本文的应用的交易方法可以黄金期货进行套期保值。并且通过实证分析发现，马尔可夫状态转换模型无论是基于向前预测方法还是基于SVR，都能较好预测出黄金期货的波动情况。预测方法为SVR模型的收益率要高于向前预测方法，不过单次交易的收益率要低于它。 通过预测，可以指导投资者的投资行为，进而可以规避风险以便获得更好的经济利益，另一方面又有利于采取措施建立期货预警系统，防止期货过热现象的发生。本文采用的只是用收盘一个指标做的模型，未来对期货黄金涨跌趋势的发展，可以基于本文的模型，加入更多有效的指标。本文的研究丰富了期货价格预测方法，首次将支持向量回归方法与复合似然函数下的Markov状态转换模型想结合。并且对期货价格预测有重要的理论意义和实用价值。"
