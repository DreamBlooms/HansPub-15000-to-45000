"本文首先简单介绍了统计过程控制图的产生及其发展，分析了一般的Shewhart控制图和CUSUM控制图的优缺点，其次给出了Shewhart控制图的估计方法和CUSUM控制图的理论基础及其构造方法。最后，我们比较了在过程受控与失控两种情况下的一般的Shewhart控制图和CUSUM控制图的平均运行长度，得出了CUSUM控制图对监测过程均值小漂移比一般的Shewhart控制图更灵敏的结论。 关键词 :Shewhart控制图，CUSUM控制图，平均运行长度"
"现代质量管理要求以统计技术的应用来实现过程控制，因此称为“统计过程控制”，统计过程控制强调预防为主的原则，因而在质量管理中受到管理者的青睐。实现统计过程控制的过程称其为处于“稳定受控状态”或“正常状态”或“统计稳态”。控制图是生产过程中控制过程质量的一种有效工具，它能直观地反映出加工过程质量情况。它形象直观，图上有用实线绘制的中心线和虚线绘制的上下控制线，图中有按时间先后顺序抽取的样本的点列，各点之间用直线段连接，可以清晰直观地看出变化趋势。控制图就相当于通常的正态分布旋转90度后形成的。将 ， 以及 分别标注为中心线，上控制线，下控制线，这样就得到了一个基本的控制图 [ 1 ] - [ 3 ] 。Shewhart控制图理论基础是“3σ”原理,也就是说在1000个产品中有不超过2.7个不合格品出现,，就认为该过程的波动属于正常波动；否则，就认为该过程的波动属于异常波动。Shewhat常规控制图只是利用了过程中的当前数据，而没有充分利用整个样本中的数据。Shewhart控制图对当前数据的信息进行了充分的利用，但是一旦“点出界就报警”，并且所有历史数据的权重都为0。由于Shewhart控制图是建立在数理统计的原理之上，因此在质量控制过程中需要满足样本容量要大，样本服从或接近正态分布，样本相互独立等条件。而在实际控制过程中这些条件很难被满足，从而造成Shewhart控制图在实际运用中的各种不适应性。针对这种情况人们做了大量的研究，Page基于序贯分析原理于1954年提出了累积和控制图简称为CUSUM控制图。将一系列点子(数据在控制图中的表达)的微弱信息累加起来，就对过程中的微小波动也变得灵敏了。CUSUM控制图不仅拓宽了Shewhart控制图的应用范围，而且弥补Shewhart控制图对中小漂移和异常点的检测灵敏性。控制图方法因具有捕捉异常先兆的功能，因而成为实现统计过程控制的首选方法。在统计过程控制中，应用统计技术实现过程中各个阶段的监控和诊断，捕捉到异常先兆后立即采取纠正和预防措施，将异常消灭在萌芽状态，消灭在过程之中。因而有效减少过程中的质量损失，降低成本，对保证产品质量和增加企业的经济效益都起到了非常重要的作用。"
"假定一列样本 ， 来自一生产过程，它们独立服从均值 ，标准差为 的正态分布，即 。 表示在时刻t从生产过程中抽取的 个样本，假定每个时点抽取的样本数量恒为 ，则容量为 的样本均值 。当 和 都已知时， 以 的概率落在区间内，其控制区间为 (1) 在实际操作中，取 为3，即实际生产中的 控制线。以上我们对样本 ， 作了正态性假设，但是根据中心极限定理，当样本不符合正态性假定时，只要样本数量较大一般大于50即可，那么样本也近似服从正态分布，故Shewhart控制图的结果仍然可用。  当 和 都未知时，假设我们有m个样本容量为n的样本，则均值的估计值为 (2) 又总体标准差的无偏估计为 ，设 是m组样本的极差， 是这些极差的平均值，且总体均值的估计值为 。因此，每组样本的均值 以 的概率落在区间 (3) 之内。所以在总体均值与标准差的估计值均已知的情况下，我们代入 和 的估计值就得到具体的检测过程均值的Shewhart控制图的 上控制线为： (4) 下控制线为： (5)"
"CUSUM控制图通过观测值与目标值之差的累积和来画图，充分利用了整个观测样本的信息，其理论基础就是序贯分析原理中的序贯概率比检验(Sequential Probability Ratio Test，简称SPRT)，这是一种基本的序贯检验法 [ 4 ] 。 对一个简单零假设和备择假设，假定我们有一列样本量为n的独立观测值{ }，而且假定与每个假设分别联系在一起的概率密度函数是： ， ，记此时的似然比统计量为 (6) 对于事先给定的两个常数 ， ，我们逐一抽取样本，如在抽得的样本 抽样尚不能完成，则继续抽 ，并计算 。 当 时，停止抽样，拒绝零假设；当 时，停止抽样，拒绝备择假设。 当 时，则抽取第 个样本，并计算 ，重复以上的步骤，依次进行。我们称这样的检验就为序贯概率比检验 ，简记为 。 对于一个SPRT 而言，其临界值与犯第一、二类错误概率 之间的关系为 (7) (8) 由以上式子可以看出，对于事先给定的第一二类错误概率 ，我们可以将常数 近似选定为 。  我们以检测向上漂移为例进行说明，即已知漂移量 ，则基于似然比统计量为 ，若事先选定阀值 ，如果 ， 说明到时刻n为止的过程中表明过程未进入失控状态，那么继续检测如果直到某个 则报警，认为过程在时刻n以前有某一个点发生了漂移。在实际应用中， 是未知的，因此我们常常用一个待定的参数 代替从而可得到一般的CUSUM统计量 这样CUSUM就由两个参数(k,h)所决定。 参数的选择的关键原则是用平均运行长度 ，一般情况是保证 满足条件的情况下选择使 尽可能小的k和h,这里 ：表示过程开始时处于受控状态。 ：表示过程开始时处于失控状态。 其中 表示报警所需的运行时间。 我们用上述 定义失控状态下的平均运行长度是为了研究的简化，事实上CUSUM具有无后效性即是如果某个 ，则从 开始与从1开始的过程在检测方面没有区别。 我们考察向上漂移的检测问题，以 表示受控状态下让 从 开始进行检测所需的平均运行长度，即 (9) 其中样本 为来自标准正态分布的观测值，濮晓龙 [ 5 ] 运用Page于1954年导出的积分方程： (10) 其中 与 同分布， 表示X的密度函数，那么 就是对向上漂移进行检测的平均运行长度 。 对向下漂移的检测有类似的积分方程： (11) 对双向检验的问题，Kemp证明了 (12) 如果观测样本并非来自标准正态分布，而是来自一列发生了漂移量为 的样本，那么此时的 不仅依赖于 还与 有关系。"
"控制图从检测开始到它发出生产出现问题的警号为止所抽取的平均样本数，称为平均链长 。在实际研究中，我们固定过程受控时的 ，记为 ，然后比较不同控制图在过程失控时的 记为 ，过程失控时 越小，表示该控制图检测漂移越有效。当过程受控时我们希望平均运行长度尽可能的大，这样控制图误报的几率会小一些；当过程失控时，我们希望平均运行长度尽可能的小，这样控制图检测到异常点的概率就会大一些。所以，判别控制图好坏的标准就相当于假设检验中的第一二类错误概率。一般地我们取， 。  对于Shewhart 控制图，当 取为3时，根据 原则知道，标准正态分布样本落在3以外的概率约为0.27%，即 ，所以，过程受控时其平均运行长度为 (13) 利用计算机随机产生一组服从标准正态分布，样本容量为64的随机数，计算其均值 ，判断 是否在 范围内，即 是否大于0.375。若 落在上下控制线之间，则说明该过程受控，否则继续抽样，计算均值，再判断，直到过程 落在上下线之外，记下此时抽样的次数，即为该控制图的运行长度。因一次实验存在误差，故将上述实验重复10000次，可得到Shewhart 控制图的平均运行长度。对上述实验运行5次，分别得到过程受控时的平均运行长度 (代码见附录)如下表1。 由以上运行结果可知生产过程受控时Shewhart控制图的平均运行长度约为370。 对于CUSUM控制图，计算平均运行长度，关键是确定参数k和h。我们以上单侧为例进行说明，根据参数k和h的选择原则，我们一般选择 为 ，然后不断调整控制线h直到CUSUM控制图过程受控时的平均运行长度约为370为止。首先随机产生一组服从标准正态分布，样本容量为1的随机数，然后计算出其CUSUM统计量 ，判断是否超出控制线。如果超出事先设定的上控制线，则说明该过程失控，其运行长度即为1；如果在均值和上控制线之间，说明该过程受控，则继续产生一个随机数，再计算出其统计量判断是否在均值和上控制线之间，如果超出事先设定的上控制线，则停止，记下此时取样的次数，即为该控制图的运行长度；由于误差的存在，我们通过重复实验次数来减少误差，运行10,000次即可得到CUSUM控制图的平均运行长度。 通过不断调整控制限h，保证 大致为370，发现当h大致为2.5。  (1) 当漂移量较小时： 时，对于过程失控时的Shewhart 控制图的平均运行长度结果见下表2： 对于过程失控时的CUSUM控制图平均运行长度，操作步骤基本同过程受控时，此时我们假设漂移量 ，濮晓龙 [ 5 ] 指出如果控制线 时平均运行长度为21左右，通过计算机模拟也证实了这点，结果见下表3。 由上述两张表的结果我们可以得出结论当偏移量0.5时，CUSUM控制图的平均运行长度远小于Shewhart 控制图的平均运行长度，由于两种控制图过程受控时的平均运行长度ARL0一样，所以失控时的平均运行长度 越小越好，从表中数据则足以说明CUSUM控制图检测中小漂移更加灵敏。 (2) 当漂移量较大时， 时，类似的通过计算机模拟得到如下结果：过程失控时CUSUM控制图 Table 1 序号 1 2 3 4 5 ARL0 369.47 367.08 370.53 373.51 374.57 表1. 过程受控时Shewhart控制图的平均运行长度 Table 2 序号 1 2 3 4 5 ARL1 155.2458 156.2054 153.1586 153.2689 154.2716 表2. 过程失控时Shewhart控制图的平均运行长度 Table 3 序号 1 2 3 4 5 ARL1 21.9066 21.8475 21.906 21.8391 22.0378 表3. 过程失控时CUSUM控制图的平均运行长度 平均运行长度为4，过程失控时的Shewhart 控制图的平均运行长度为1。由平均运行长度我们可以看出对于漂移量较大的过程检测，Shewhart 控制图的平均运行长度较小，说明Shewhart 控制图对检测大漂移更加灵敏有效。"
"Shewhart 控制图对过程均值的监控是以最后一次观测结果为依据的，它对检测小漂移不灵敏。而CUSUM控制图对过程的监控是以所有观测结果为依据的，它对检测小漂移比较有效。而在实际的质量控制中，如果我们联合使用累积和控制图和休哈特控制图，那么就能弥补各自的不足，达到真正的对企业质量的控制和提升企业的经济效益。"
