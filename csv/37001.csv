"本论文考虑响应变量缺失下变系数部分非线性模型的统计推断，我们采用完全数据方法下的轮廓非线性最小二乘来估计未知参数和非参函数，同时建立了估计量的渐近正态性。 关键词 :变系数部分非线性模型，轮廓非线性最小二乘，缺失响应变量 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"近几年来，变系数部分非线性模型由于半参模型的灵活性和非参模型的易解释性受到了大量的关注， Y = X T θ ( U ) + g ( Z , β ) + ε ， 其中Y是响应变量， X , Z , U 是协向量，且 X ∈ R q ， Z ∈ R r ， U ∈ R ， θ ( ⋅ ) = ( θ 1 ( ⋅ ) ， ⋯ , θ q ( ⋅ ) ) T 是q维未知的系数函数向量， g ( ⋅ , ⋅ ) 为给定的非线性函数，参数 β = ( β 1 , ⋯ , β p ) T 的维数没有必要一定和Z相等，随机误差 ε 满足 E ( ε | X , U , Z ) = 0 ， V a r ( ε | X , U , Z ) = σ 2 。 此模型最初由Li和Mei (2013) [ 1 ] 提出，且包含很多重要的子模型，像变系数模型、非线性模型、部分非线性模型和变系数部分线性模型等，因此对此模型的统计研究具有相当大的意义，他们提出用轮廓非线性最小二乘估计方法估计参数向量 β 和系数函数向量 θ ( U ) ，Zhou，Zhao和Wang (2017) [ 2 ] 采用经验似然方法获得参数和非参部分的区间估计。 据我们所知，还没有文献研究过变系数部分非线性模型的缺失响应变量的推断，此论文用完全数据法处理缺失响应变量，并对VCPNLM模型推荐轮廓非线性最小二乘估计方法。"
"我们假定随机样本 { Y i , X i , U i , Z i , i = 1 , 2 , ⋯ , n } 是从下面变系数部分非线性模型中产生 Y i = X i T θ ( U i ) + g ( Z i , β ) + ε i ， 其中 { ( X i , U i , Z i ) , i = 1 , ⋯ , n } 可以被完全观测到，响应变量 Y i 随机缺失，当 Y i 被观测到，指示变量 δ i = 1 ，当 Y i 缺失，指示变量 δ i = 0 ，选择概率函数为 P ( δ i = 1 | Y i , X i , U i , Z i ) = P ( δ i = 1 | X i , U i , Z i ) = π ( X i , U i , Z i ) ，对于选择概率函数的估计，本论文我们选取logistic模型选择概率 π ( V i , ω ) = exp ( ω 0 + ω 1 T X i + ω 2 U i + ω 3 T Z i ) 1 + exp ( ω 0 + ω 1 T X i + ω 2 U i + ω 3 T Z i ) ， 其中 V i = ( X i T , U i , Z i T ) T ， ω = ( ω 0 , ω 1 T , ω 2 , ω 3 T ) T 为未知参数向量，自然地，可以通过最大化下面的对数似然函数来估计 ω ， ln L ( ω ) = ∑ i = 1 n { δ i ln [ π ( V i , ω ) ] + ( 1 − δ i ) ln [ 1 − π ( V i , ω ) ] } ， 此时 π ( V i , ω ) 的拟似然估计量为 π ( V i , ω ^ ) ，具体细节请参考陈盼盼，冯三营和薛留根(2015) [ 3 ]。 下面模型 δ i Y i = δ i X i T θ ( U i ) + δ i g ( Z i , β ) + δ i ε i (2.1) 是完全数据下的模型，对于 u 0 领域附近的u，对 θ j ( u ) 应用泰勒展开可得， θ j ( u ) ≈ θ j ( u 0 ) + θ ′ j ( u 0 ) ( u − u 0 ) ，如果给定 β ，这时可以用局部线性估计方法并最小化下面式子得到系数函数的 θ ( u ) 估计 ∑ i = 1 n δ i { Y i − g ( Z i , β ) − ∑ j = 1 q [ θ j ( u 0 ) + θ ′ j ( u 0 ) ] ( U i − u 0 ) X i j } 2 K h 1 ( U i − u 0 ) 。 (2.2) 令 Y = ( Y 1 , ⋯ , Y n ) n ， g ( Z , β ) = ( g ( Z 1 , β ) , ⋯ , g ( Z 1 , β ) ) T ， M = ( X 1 T θ ( U 1 ) , ⋯ , X 1 T θ ( U n ) ) T ， Ψ ( u 0 ) = ( θ ( u 0 ) T , h 1 θ ′ ( u 0 ) T ) T ， W 1 ( u 0 ) = d i a g ( K 1 , h ⋅ 1 ( U 1 − u 0 ) , ⋯ , K 1 , h ⋅ 1 ( U n − u 0 ) ) ， Δ = d i a g ( δ 1 , ⋯ , δ n ) ， X h 1 ( u 0 ) = ( X 1 T h 1 − 1 ( U 1 − u 0 ) X 1 T ⋮ ⋮ X n T h 1 − 1 ( U n − u 0 ) X n T ) ， 此时最小二乘问题(2.2)的解为 Ψ ^ c ( u 0 ; β ) = [ X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X h 1 ( u 0 ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ [ Y − g ( Z , β ) ] ， 在 u 0 处系数函数向量 θ ( u ) 的估计量为 θ ^ c ( u 0 , β ) = ( I q × q , 0 q × q ) [ X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X h 1 ( u 0 ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ [ Y − g ( Z , β ) ] ， 令 M ^ = ( X 1 T θ ^ c ( U 1 ; β ) ⋮ X n T θ ^ c ( U n ; β ) ) = ^ S h 1 [ Y − g ( β ) ] ， 其中 S h 1 = ( ( X 1 T 0 1 × q ) [ X h 1 T ( U 1 ) W 1 ( U 1 ) Δ X h 1 ( U 1 ) ] − 1 X h 1 T ( U 1 ) W 1 ( U 1 ) Δ ⋮ ( X n T 0 1 × q ) [ X h 1 T ( U n ) W 1 ( U n ) Δ X h 1 ( U n ) ] − 1 X h 1 T ( U n ) W 1 ( U n ) Δ ) ， 最小化下面关于 β 的轮廓非线性最小二乘函数 Q c ( β ) = ∑ i = 1 n δ i { Y i − X i T θ ^ c ( U i , β ) − g ( Z i , β ) } 2 ， 可得完全数据方法下轮廓非线性最小二乘估计量 β ^ c ，此时把 β ^ c 代入 Ψ ^ c ( u 0 ; β ) 和 θ ^ c ( u 0 , β ) 可得 Ψ ( u 0 ; β ) 的估计量 Ψ ^ c ( u 0 ; β ^ ) 和 θ ( u 0 , β ) 的估计量 θ ^ c ( u 0 , β ^ ) 。 引入以下标记： μ 1 , j = ∫ u j K 1 , h 1 ( u ) d u ， ν 1 , j = ∫ u j K 1 , h 1 2 ( u ) d u ， Γ ( u ) = E ( π ( V ) X X T | U = u ) ， Φ ( u ) = E ( π ( V ) X g ′ ( Z , β 0 ) T | U = u ) ， 定理 2.1 设条件C1-C8成立， β 0 为参数真值，则 n ( β ^ c − β 0 ) → D N ( 0 , σ 2 Σ − 1 ) ， 其中， Σ = E [ π ( V ) g ′ ( Z , β 0 ) g ′ ( Z , β 0 ) T ] − E [ Φ ( U ) T Γ − 1 ( U ) Φ ( U ) ] 。 定理 2.2 设条件C1-C8成立，对于任意的 u 0 ∈ Ω ，有 n h 1 [ Ψ ^ c ( u 0 ; β ^ c ) − Ψ 0 ( u 0 ) − 1 2 h 1 2 μ 1 ， 2 ( θ ″ 0 ( u 0 ) 0 ) ] → D N ( 0 , Σ 1 ) 其中， Σ 1 = σ 2 f ( u 0 ) − 1 Γ − 1 ( u 0 ) ⊗ ( ν 1 , 0 0 0 ν 1 , 2 μ 1 , 2 − 2 ) 。 特殊地， n h 1 [ θ ^ c ( u 0 , β ^ c ) − θ 0 ( u 0 ) − 1 2 h 1 2 μ 1 ， 2 θ ″ 0 ( u 0 ) ] → D N ( 0 , σ 2 ν 1 ， 0 f ( u 0 ) − 1 Γ ( u 0 ) − 1 ) 。"
"本论文需要的正则假设条件如下，这些正则假设也可以从Li和 Mei (2013) [ 1 ]，Xiao和Chen (2018) [ 4 ] 以及其他一些文献中找到： C1：随机变量U具有有界支撑 Ω ，其密度函数 f ( u ) 在 Ω 上具有有界的二阶导数且在支撑 Ω 上有界远离0。 C2：所有的系数函数 { θ j ( u ) , j = 1 , ⋯ , q } 具有连续二阶导数。 C3：对于任何Z， g ( Z , β ) 是一个关于 β 的连续函数且二阶导数连续。 C4：存在一个正数 s > 2.5 使得 E ( ‖ X ‖ 2 s ) < ∞ ， E ( ‖ g ′ ( Z , β ) ‖ 2 s ) < ∞ ，且存在某个 0 < δ < 2 − s − 1 使得 n 2 δ − 1 h 1 → ∞ ，其中 ‖   ⋅   ‖ 为欧式范数。 C5： β 的某一邻域内满足 E [ g ′ ( β ) ⊗ 2 ] < ∞ ， E [ E ( g ′ ( β ) | U ) ⊗ 2 ] < ∞ ， E [ ‖ g ′ ( β ) ‖ 4 ] < ∞ ， E ‖ g ′ ( Z , β ) ‖ 4 < ∞ ， E ‖ V e c h g ″ ( Z , β ) ‖ 4 < ∞ 。 C6：核权函数 K 1 ( · ) 和 K 2 ( · ) 具有紧支撑的对称密度函数，并满足Lipschitz条件，且函数 μ 3 K 1 ( μ ) , μ 3 K ′ 1 ( μ ) 有界， ∫ μ 4 K 1 ( μ ) d μ < ∞ ，当 n → ∞ ，窗宽 h i 满足 n h i 8 → 0 ， n h i 2 / ( log n ) 2 → ∞ ， h i → 0 ， n h i → ∞ ， i = 1 , 2 。 C7： Γ ( U ) 对任何 u ∈ Ω 是非奇异的， Γ ( U ) , Γ * ( U ) , Γ ( U ) − 1 , Γ * ( U ) − 1 , Φ ( U ) , Φ * ( U ) 均满足Lipschitz。 C8：缺失概率 π ( V , ω ) 关于 ω 二阶可导且存在常数 C 0 ，使得 inf π ( V , ω ) ≥ C 0 ≥ 0 。 在证明定理2.1和定理2.2之前先给出下面引理1和引理2， 引理1 假定条件C1~C8成立，则当 n → ∞ ，有 1 n X h 1 ( u ) T W 1 ( u ) Δ X h 1 ( u ) = f ( u ) Γ ( u ) ⊗ ( 1 0 0 μ 1 ， 2 ) [ 1 + O p ( c n ) ] (3.1) 1 n X h 1 ( u ) T W 1 ( u ) Δ g ′ ( β 0 ) = f ( u ) Φ ( u ) ⊗ ( 1 , 0 ) T [ 1 + O p ( c n ) ] (3.2) 1 n X h 1 ( u ) T W 1 ( u ) Δ M 0 = Γ ( u ) θ 0 ( u ) f ( u ) ⊗ ( 1 , 0 ) T [ 1 + O p ( c n ) ] (3.3) 1 n X h 1 ( u ) T W 1 ( u ) Δ ε = O p ( { log ( 1 / h 1 ) n h 1 } 1 2 ) (3.4) 其中 c n = h 1 2 + { log ( 1 / h 1 ) n h 1 } 1 2 。 证明：容易得到以下结果 1 n X h 1 ( u ) T W 1 ( u ) Δ X h 1 ( u ) = ( 1 n ∑ i = 1 n δ i X i X i T K 1 , h 1 ( U i − u ) 1 n ∑ i = 1 n δ i X i X i T U i − u h 1 K 1 , h 1 ( U i − u ) 1 n ∑ i = 1 n δ i X i X i T U i − u h 1 K 1 , h 1 ( U i − u ) 1 n ∑ i = 1 n δ i X i X i T ( U i − u h 1 ) 2 K 1 , h 1 ( U i − u ) ) 根据Mack和Silverman (1982) [ 5 ] 命题1及迭代期望，有 1 n ∑ i = 1 n δ i X i X i T K 1 , h 1 ( U i − u ) = Γ ( u ) f ( u ) + O ( h 1 2 ) + O p ( { log ( 1 / h 1 ) n h 1 } 1 2 ) = Γ ( u ) f ( u ) [ 1 + O p ( c n ) ] (3.5) 根据和(3.5)相似的证明方式，有 1 n ∑ i = 1 n δ i X i X i T U i − u h 1 K 1 , h 1 ( U i − u ) = O ( h 1 2 ) + O p ( { log ( 1 / h 1 ) n h 1 } 1 2 ) 1 n ∑ i = 1 n δ i X i X i T ( U i − u h 1 ) 2 K 1 , h 1 ( U i − u ) = Γ ( u ) f ( u ) μ 1 ， 2 [ 1 + O p ( c n ) ] 因此，(3.1)式得证，利用相似的方式可证(3.2)，(3.3)和(3.4)式。 引理2 假定条件C1~C8成立，我们有 1 n g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) g ′ ( β 0 ) = Σ { 1 + o p ( 1 ) } (3.6) 其中 Σ = E [ π ( V ) g ′ ( Z , β 0 ) g ′ ( Z , β 0 ) T ] − E [ Φ ( U ) T Γ − 1 ( U ) Φ ( U ) ] 1 n g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) ( Y − g ( β 0 ) ) = ξ n + O p ( c n 2 ) (3.7) 其中 ξ n = 1 n ∑ i = 1 n δ i { g ′ ( Z i , β 0 ) − E [ g ′ ( Z i , β 0 ) X i T | U = U i ] Γ ( U i ) − 1 X i } ε i 证明：结合(3.1)和(3.2)式，我们可得 ( X T , 0 ) [ X h 1 ( u ) T W 1 ( u ) Δ X h 1 ( u ) ] − 1 X h 1 ( u ) T W 1 ( u ) Δ g ′ ( β 0 ) = X T Γ ( u ) − 1 Φ ( u ) [ 1 + O p ( c n ) ] 根据弱大数定律和上面的式子，有 1 n g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) g ′ ( β 0 ) = Σ ( 1 + o p ( 1 ) ) + O p ( c n 2 ) E [ Φ ( U ) T Γ − 1 ( U ) Φ ( U ) ] [ 1 + o p ( 1 ) ] 在条件C6下， c n 2 = o ( 1 ) ，因此(3.6)式成立。下一步我们证明(3.7)式 令 M 0 = ( X 1 T θ 0 ( U 1 ) , ⋯ , X n T θ 0 ( U n ) ) T ，根据(3.1)式和(3.3)式，有 ( X T , 0 ) [ X h 1 ( u ) T W 1 ( u ) Δ X h 1 ( u ) ] − 1 X h 1 ( u ) T W 1 ( u ) Δ M 0 = X T θ 0 ( u ) [ 1 + O p ( c n ) ] 因此， 1 n g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) M 0 = O p ( c n 2 ) 再根据(3.1)式，(3.4)式和 E ( ε | V ) = 0 ，有 ( X T , 0 ) [ X h 1 ( u ) T W 1 ( u ) Δ X h 1 ( u ) ] − 1 X h 1 ( u ) T W 1 ( u ) Δ ε = O p ( c n ) 此时 1 n g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) ε = ξ n + O p ( c n 2 ) 因此 1 n g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) ( Y − g ( β 0 ) ) = ξ n + O p ( c n 2 ) ，(3.7)式子得证。 定理2.1的证明：根据Li和Mei (2013) [ 1 ] 定理1的证明，可类似证明 β ^ c 的一致性，即对于充分小的a，有 lim n → ∞ P [ sup ‖ t ‖ = a Q c ( β 0 + t ) > Q c ( β 0 ) ] = 1 (3.8) 以及 t T Q ″ c ( β * ) t = 2 n { t T Σ t + O p ( ‖ t ‖ 3 ) } ，此处细节省略，下面证明 β ^ c 的渐近正态性， 又 Q c ( β ) = ∑ i = 1 n δ i { Y i − X i T θ ^ c ( U i , β ) − g ( Z i , β ) } 2 = [ Y − g ( β ) ] T ( I n − S h 1 ) T Δ ( I n − S h 1 ) [ Y − g ( β ) ] 和 Q ′ c ( β 0 ) = − 2 g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) ( Y − g ( β 0 ) ) ， 由(3.7)式，我们可以得到 1 n Q ′ c ( β 0 ) = − 2 n g ′ ( β 0 ) T ( I n − S h 1 ) T Δ ( I n − S h 1 ) ( Y − g ( β 0 ) ) = − 2 ξ n + O p ( c n 2 ) 根据泰勒展开 0 = Q ′ c ( β ^ c ) = Q ′ c ( β 0 ) + Q ″ c ( β * ) T ( β ^ c − β 0 ) ， 结合 1 2 n Q ″ c ( β * ) = Σ { 1 + o p ( 1 ) } ，有 n Σ { 1 + o p ( 1 ) } ( β ^ c − β 0 ) = n ξ n + o p ( 1 ) ， 注意到， n ξ n = 1 n ∑ i = 1 n δ i { g ′ ( Z i , β 0 ) − E [ g ′ ( Z i , β 0 ) X i T | U = u i ] Γ ( U i ) − 1 X i } ε i ， 根据Slutsky定理和中心极限定理，可得 n ( β ^ c − β 0 ) → D N ( 0 , σ 2 Σ − 1 ) 。 定理2.2的证明：根据 Ψ ^ c ( u 0 ; β ^ c ) 的定义，我们可以得到 Ψ ^ c ( u 0 ; β ^ c ) = [ X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X ( u 0 ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ M 0     + [ X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X h 1 ( u 0 ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ ε     − [ X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X h 1 ( u 0 ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ [ g ( Z , β ^ c ) − g ( Z , β 0 ) ] = d e f I 1 + I 2 − I 3 易知 I 3 = [ X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X h 1 ( u 0 ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ [ g ′ ( β 0 ) ( β ^ c − β 0 ) + O p ‖ β ^ c − β 0 ‖ 2 ] = O p ( n − 1 2 ) 下一步计算再计算 I 1 ，因为 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ M 0 = X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X h 1 ( u 0 ) Ψ 0 ( u 0 ) + 1 2 h 1 2 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ A ( u 0 )     + X h 1 T ( u 0 ) W 1 ( u 0 ) Δ I n o ( h 1 2 ) 其中， A ( u 0 ) = ( ( U 1 − u 0 h 1 ) 2 X 1 T θ ″ 0 ( u 0 ) ⋮ ( U 1 − u 0 h 1 ) X n T θ ″ 0 ( u 0 ) ) 。 又 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ A ( u 0 ) = n f ( u 0 ) Γ ( u 0 ) ⊗ ( μ 1 , 2 , 0 ) T [ 1 + O p ( c n ) ] θ ″ ( u 0 ) ， X h 1 T ( u 0 ) W 1 ( u 0 ) Δ I n o ( h 1 2 ) = n f ( u 0 ) E ( π ( V ) X | U = u 0 ) ⊗ ( 1 , 0 ) T [ 1 + O p ( c n ) ] o ( h 1 2 ) ， 此时 I 1 = [ X h 1 T ( u 0 ) W 1 ( u 0 ) Δ X h 1 ( u 0 ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ M 0 = Ψ 0 ( u 0 ) + 1 2 h 1 2 μ 1 ， 2 ( θ ″ 0 ( u 0 ) 0 ) + o p ( h 1 2 ) 因此， n h 1 [ Ψ ^ c ( u 0 ; β ^ c ) − Ψ 0 ( u 0 ) − 1 2 h 1 2 μ 1 ， 2 ( θ ″ 0 ( u 0 ) 0 ) ] = n h 1 I 2 + O p ( n h 1 5 + h 1 ) ， 容易推导 I 2 = 1 n f ( u 0 ) − 1 Γ ( u 0 ) − 1 ⊗ ( 1 0 0 μ 1 , 2 − 1 ) [ 1 + O p ( c n ) ] − 1 X h 1 T ( u 0 ) W 1 ( u 0 ) Δ ε ， 又因为 1 n X h 1 T ( u 0 ) W 1 ( u 0 ) Δ ε = ( 1 n ∑ i = 1 n δ i ε i X i K 1 , h 1 ( U i − u 0 ) 1 n ∑ i = 1 n δ i ε i X i U i − u 0 h 1 K 1 , h 1 ( U i − u 0 ) ) 和 n h 1 1 n X h 1 T ( u 0 ) W 1 ( u 0 ) Δ ε → D N ( 0 , Σ * ) ，其中 Σ * = σ 2 Γ ( u 0 ) f ( u 0 ) ⊗ ( ν 1 ， 0 0 0 ν 1 , 2 ) ， 最后我们可以得到 n h 1 I 2 = f ( u 0 ) − 1 Γ − 1 ( u 0 ) ⊗ ( 1 0 0 μ 1 ， 2 − 1 ) [ 1 + O p ( c n ) ] − 1 n h 1 1 n X h 1 T ( u 0 ) W 1 ( u 0 ) Δ ε → D N ( 0 , σ 2 f ( u 0 ) − 1 Γ − 1 ( u 0 ) ⊗ ( ν 1 ， 0 0 0 ν 1 ， 2 μ 1 ， 2 − 2 ) ) 现在定理2.2的证明完成。"
