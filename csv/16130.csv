"相比于传统卫星，敏捷卫星可沿滚动、俯仰、偏航三轴进行快速机动，其成像过程中的姿态计算问题更加复杂。本文建立了适用于任意复杂姿态摄影条件下的姿态角与角速度计算模型。对偏航角的计算，考虑了滚动角速度与俯仰角速度的影响。对角速度的计算，采用了对姿态角进行拉格朗日插值逼近后再对时间求导的方法。基于该姿态计算模型，针对敏捷卫星三种典型的成像方式——被动式扫描、俯仰匀速动态扫描与均匀地速动态扫描，分别建立了整个成像过程中的姿态角与角速度计算模型。仿真分析表明：所建的姿态角与角速度模型是合理的，对于俯仰匀速与均匀地速动态扫描，可以通过调节俯仰角速度或地速的方向与大小来改变扫描的总时长。 关键词 :敏捷卫星，偏航角，拉格朗日插值，被动式扫描，俯仰匀速，均匀地速"
"敏捷卫星[ 1 ] -[ 3 ] 是指能够在短时间内实现大角度快速机动的卫星，利用其快速姿态机动能力，能够迅速改变星上相机对地指向，实现对地面目标的高效、灵活的观测，是当今遥感卫星的重要发展方向。相比于传统卫星，敏捷卫星可沿滚动、俯仰、偏航三轴进行转动，具有快速调姿能力，其成像过程中的姿态计算问题更加复杂：滚动角与俯仰角在成像过程中可以进行连续变化，滚动与俯仰角速度会影响偏航角的计算等。 对于成像过程中的姿态角计算模型，滚动角与俯仰角的计算较为简单，偏航角的计算较为复杂。文献[ 1 ] -[ 7 ] 给出了卫星星下点摄影时的偏航角计算方法，文献[ 8 ] -[ 10 ] 对卫星星下点摄影、滚动摄影及俯仰摄影等姿态对地指向固定的方法，给出了偏航角计算公式，文献[ 11 ] 还针对滚动加俯仰姿态机动后摄影的情形建立了偏航角计算模型，但以上文献均是针对卫星无滚动与俯仰角速度成像的情形，仅有文献[ 12 ] 考虑了俯仰角速度，给出了卫星进行俯仰匀速动态扫描时的偏航角计算公式。 本文建立了适用于任意复杂姿态成像下的偏航角计算模型，充分考虑了滚动角速度与俯仰角速度的影响，针对敏捷卫星三种典型的成像方式(被动式扫描、俯仰匀速动态扫描与均匀地速动态扫描)，将偏航角计算模型具体化，并通过数值仿真分析了所建模型的合理性。"
"姿态角计算中使用到的坐标系主要有大地坐标系、地固坐标系、地心赤道J2000惯性系、卫星轨道系与卫星本体系等[ 4 ] 。五个坐标系的定义与转换关系见文献[ 13 ] 。对于地固坐标系与J2000惯性系之间的转换，为保证计算精度，考虑了岁差修正、章动修正、地球自转以及极移修正四次坐标转换。这里设定由轨道系按1-2-3的转序得到本体系，三次转动角度依次为滚动角φ，俯仰角θ与偏航角ψ。  假设某时刻t，卫星在J2000惯性系中的位置坐标为r sat,ECI ，卫星指向地面成像点为P(λ, φ′, h)，其中，λ表示大地经度，φ′表示大地纬度，h表示大地坐标下的海拔，根据大地坐标系与地固坐标系之间的转换关系，可以得到成像点在地固坐标系中的位置r P ,ECF ，根据地固坐标系到J2000惯性坐标系的转换矩阵L ECI,ECF ，可以得到成像点在J2000惯性系中的位置坐标r P ,ECI (1) 如图1所示，由r sat,ECI 与r P ,ECF 可以得到卫星与地面成像点的矢量差在J2000惯性系中的表示形式Δr ECI ： (2) 由J2000惯性坐标系到卫星轨道坐标系的转换矩阵L oi ，可以得到卫星与地面成像点矢量差在卫星轨道坐标系中的表示形式Δr orbit ： (3) 设 ，则滚动角φ和俯仰角θ的计算公式分别为： (4) (5) 其中atan2考虑了四个可能象限，返回以弧度表示并介于−π到π之间的反正切值， 。  根据速度合成定理：任一瞬时，动点P的绝对速度为其相对速度与牵连速度之矢量和[ 14 ] ，知成像点P相对于相机的速度为： (6) 这里，ω e × R表示成像点P的绝对速度，v u 为卫星绝对速度的前向分量，v r 为卫星绝对速度的径向分量，ω b 为卫星本体系具有的角速度矢量[ 9 ] 。 ω e 为地球自转角速度矢量，其大小为ω e = 7.292115146251017 × 10 −5 rad/s，R为地心到成像点的矢量，r为地心到卫星的矢量，h是卫星到成像点的矢量，ω s 为卫星的姿态角速度矢量。ω n 为轨道角速度矢量，其大小为 ，这里， ， ，μ是地球引力系数，a是轨道半长轴，e是轨道偏心率，f是真近点角。v r 为卫星绝对速度的径向分量，其大小为： 。 对于矢量式(6)，可以方便地写出其中部分量在轨道坐标系下的列阵，因此将地速矢量v在轨道坐标系下进行投影： (7) 式 中各个分量的表达式分别为： ， ， ， ， ， 根据卫星滚动角、俯仰角和卫星轨道坐标系到卫星本体坐标系的转换矩阵L bo ，计算地速在卫星本体坐标系中的矢量v b ，具体的计算公式为： (8) 由地速在卫星本体坐标系中的矢量 计算偏航角，具体计算公式为： 图1. 卫星与地面站之间的相对几何关系 (9)  卫星姿态机动过程中，其姿态角的变化是连续的，因此，计算姿态角速度时可以采用二次拉格朗日插值的数值逼近方法。 采用二次拉格朗日插值方法，首先需要获得三个不同时刻的姿态角数据。以滚动角为例，已知三个不同时刻的滚动角数据φ 1 、φ 2 、φ 3 和其对应的时刻t 1 、t 2 、t 3 ，根据二次拉格朗日插值公式，任意t t 时刻的滚动角φ t 的计算公式为： (10) 上式为二次多项式，φ t 关于时间t的导数即为滚动角φ t 对应的滚动角速度 ： (11) 在得到三个滚动角后，可根据式(11)计算任意时刻滚动角对应的滚动角速度。为保证精度，计算t 2 时刻滚动角速度时，φ 1 、φ 2 、φ 3 分别取t 2 时刻前一时刻t 1 、t 2 时刻、t 2 时刻后一时刻t 3 对应的滚动角，此时，式(11)变为： (12) 对于俯仰角速度与偏航角速度可采用同样的方法得到。"
"被动式扫描成像是指在成像过程中星体姿态的滚动角和俯仰角固定，偏航角进行偏航修正，利用卫星的姿态和与地面的相对运动进行扫描成像。如图2所示，观测目标与星下点轨迹平行，成像时卫星滚转角和俯仰角不动，只做偏航修正。 在这种成像模式中，卫星的滚动角和俯仰角固定，只有偏航角具有角速度，因此，式(7)中的(ω s ) o 变为： (13) 式(7)退化为： (14) 之后按偏航角计算模型中的步骤计算偏航角即可。 被动式扫描成像的目标是沿迹目标，即目标走向与星下点轨迹走向相同，目标以起点经度、起点纬度、目标长度的形式给出，下面介绍在扫描起始时刻已知时，如何求解整个扫描过程中卫星的姿态角与姿态角速度。 首先根据滚动角与俯仰角计算模型可以得到卫星相机指向起始点所需的滚动角、俯仰角及地速。由于卫星为被动式扫描，卫星在成像过程中始终保持滚动角与俯仰角不变，只有偏航角在变化。根据目标长度与地速可以计算得到总扫描时长，再根据姿态机动频率(或机动步长)，可以计算扫描过程总机动步数。然后，根据卫星轨道数据，以及上步求解得到的滚动角与俯仰角，可以计算卫星每个机动步长所指向的地面点的经纬度。再根据偏航角计算模型计算卫星每个机动步长所需要转动的偏航角，之后求解偏航角速度。这样我们就完成了被动式扫描成像过程中每个机动步长所对应的姿态的计算。  俯仰匀速动态扫描成像过程属于动态扫描，但特殊的是，在成像过程中卫星的滚动角不变，而俯仰角以固定的姿态角速度摆动，偏航角进行偏航修正，利用卫星的俯仰匀速机动和与地面的相对运动进行扫描成像。如图3所示，观测目标与星下点轨迹平行，这与被动式扫描的成像目标是一致的，区别在于成像过程中，被动式推扫时卫星不作俯仰机动，而本模式下，卫星沿着条带方向作俯仰匀速机动。 卫星的滚动角固定，俯仰角匀速变化，且俯仰角速度为已知量，偏航角需要根据卫星的位置和姿态变化进行计算，式 中的(ω s ) o 变为： (15) 之后按偏航角计算模型中的步骤计算偏航角即可。 与被动式扫描成像类似，俯仰匀速扫描的目标也是沿迹目标，以起点经度lon start 、起点纬度lat start 、目标长度l的形式给出，下面介绍在扫描起始时刻t start 与俯仰角速度 已知时，如何求解整个扫描过程中卫星的姿态角与姿态角速度。 首先利用滚动角与俯仰角计算模型计算得到卫星相机指向起始点所需的滚动角φ start 与俯仰角θ start 。对于总扫描时长t的计算，需要求解非线性方程得到。根据起始俯仰角θ start 、俯仰角速度 及总扫描时长t，可以计算得到结束俯仰角θ end ： (16) 图2. 被动式扫描成像示意图 图3. 俯仰匀速动态扫描成像示意图 由于过程中滚动角不变，故结束滚动角仍为φ start ，根据φ start 与θ end 可计算卫星结束时刻指向地面点的经纬度，分别lon end 、lat end 。根据起始点经纬度lon start 与lat start 、结束点经纬度lon end 与lat end ，可以计算目标长度l solve ，建立非线性方程： (17) 求解即可得到总扫描时长t。然后，计算卫星每个机动步长所对应的俯仰角，指向地面点的经纬度，偏航角以及偏航角速度。  地速为成像点相对于卫星的速度。均匀地速动态成像可以实现对地面任意走向的轨迹的扫描成像，成像全过程滚动角、俯仰角均需进行连续机动，滚动角与俯仰角变化是非线性的，滚动与俯仰角速度的变化也是非线性的，保证地速均匀，而偏航角不断进行偏航修正，来实现像移补偿。示意图如图4所示，BC为地面条带目标，在观测BC段时，滚转角和俯仰角机动，保证地速均匀，偏航角不断修正。在这种模式下，卫星具有滚动与俯仰角速度，偏航角按照2.3节计算即可。 均匀地速动态扫描的目标可以任意走向的目标，沿迹、非沿迹均可，目标一般以起点经纬度、终点经纬度的形式给出，在扫描起始时刻与扫描地速已知的情形下，整个扫描过程中的姿态计算方法如下：首先根据起点与终点经纬度可以得到目标长度，再根据扫描地速可以计算出总扫描时长，进而得到扫描结束时刻。然后根据起始点经纬度、起始时刻、结束点经纬度、结束时刻计算起点与终点之间按照一定时间间隔(即姿态机动步长)离散的所有地面成像点的经纬度。其次计算卫星每个机动步长所对应的滚动与俯仰角、滚动与俯仰角速度，再计算偏航角与偏航角速度。"
"轨道仿真起始时刻：1 Jul 2015 12:00:00.000 UTC，半长轴7050 km，偏心率0.0005，轨道倾角98˚， 图4. 均匀地速动态扫描成像示意图 近地点幅角180˚，升交点赤经260˚，平近点角0˚。下面对敏捷卫星三类典型的成像过程分别进行仿真。由上文已知，被动式扫描与俯仰匀速扫描的目标一般为沿迹条带，见表1，俯仰匀速扫描的俯仰角速度设定为0.5˚/s。均匀地速扫描的目标可以为任意走向的条带，这里，我们采用非沿迹条带，见表2，地速设定为6 km/s。为保证卫星在成像过程中侧摆角尽可能小，编写程序对起始与结束时刻进行优化，表1与表2中的起始与结束时刻即为优化后的结果。图中φ、θ、ψ分别表示卫星的滚转角、俯仰角和偏航角，即为卫星绕卫星本体系中滚转轴、俯仰轴、偏航轴的机动角度，dφ、dθ、dψ则分别表示卫星的滚转角速度、俯仰角速度和偏航角速度。 图5~图7为仿真结果，其中的二维仿真图是将前文的成像姿态模型计算得到的姿态数据加载到所开发的二维/三维仿真软件中得到的结果，姿态角与姿态角速度变化曲线是根据成像过程中的姿态数据得到的，图中平行于纵轴的虚线对应于扫描条带的起始与结束时刻。 从图5可以看出滚动角与俯仰角在整个成像过程中保持不变，滚动与俯仰角速度均为0，而偏航角不断变化，这正是被动式扫描的特点。此外，俯仰角近似为0，这是因为我们以侧摆角最小对起始时刻 Table 1 起始 起始 长度(km) 起始 结束 经度(˚) 纬度(˚) 时刻(s) 时刻(s) 被动式扫描目标条带 106.310 38.908 300.000 58224.000 - 俯仰匀速扫描目标条带 106.310 38.908 300.000 58234.000 - 表1. 被动式扫描与俯仰匀速扫描目标信息 Table 2 起始 起始 结束 结束 起始 结束 经度(˚) 纬度(˚) 经度(˚) 纬度(˚) 时刻(s) 时刻(s) 均匀地速扫描目标条带 104.174 37.916 105.015 37.907 58237.000 58251.000 表2. 均匀地速扫描目标信息 图5. 被动式扫描成像二维仿真图与姿态变化曲线图；(a) 二维仿真图；(b) 姿态角变化曲线；(c) 姿态角速度变化曲线 图6. 俯仰匀速动态扫描成像二维仿真图与姿态变化曲线图；(a) 二维仿真图；(b) 姿态角变化曲线；(c) 姿态角速度变化曲线 图7. 均匀地速动态扫描成像二维仿真图与姿态变化曲线图；(a) 二维仿真图；(b) 姿态角变化曲线；(c) 姿态角速度变化曲线 做了优化。从图6中可以看出在俯仰匀速成像过程中，滚动角保持不变，俯仰角呈线性变化，且俯仰角速度为设定的0.5˚/s，偏航角仍不断变化。俯仰匀速扫描与被动式扫描的目标为同一目标，但总成像时间却不一样，对比图5与图6，可以发现，俯仰匀速扫描的时间要少于被动式扫描的时间，这是因为我们在俯仰匀速扫描时给了正向的俯仰角速度，这样会加快对目标的扫描，这也说明了俯仰匀速扫描方式可以通过调节俯仰角速度的方向与大小来调整成像的时间。 从图7可看出，在均匀地速扫描过程中，三个姿态角一直在变化，由于偏航角的计算考虑了滚动角速度与俯仰角速度，相比于前两种成像方式，该模式下的偏航角数值较大。 从仿真结果可以看出，卫星以计算得到的姿态对条带进行扫描，扫描获得的条带与原条带完全重合，这说明了成像过程姿态规划算法的合理性。"
"本文建立了一种可适用于任意复杂姿态摄影条件下的姿态角与姿态角速度计算模型，对于偏航角的求解，引入了滚动与俯仰角速度的影响，对于角速度的求解，采用拉格朗日插值逼近后再对时间求导的方法，其精度可以通过控制插值阶数进行调节。针对敏捷卫星三种典型的成像方式—被动式扫描、俯仰匀速动态扫描与均匀地速动态扫描，将任意姿态摄影下的姿态计算模型具体化，分别给出了对应的成像过程中的姿态计算方法。本文建立的敏捷卫星成像姿态规划算法求解方便、精度较高，可以作为敏捷卫星成像姿态规划的参考。"
