"结合多维放缩方法构建长短期记忆网络(MDS-LSTM)模型，对黄金主连期货未来10日的收盘价格进行预测。首先选取黄金主连的12个指标，利用多维放缩对12个指标进行降维，然后建立MDS-LSTM、MDS-BP和LSTM神经网络模型对收盘价格进行预测，将三个模型的预测结果进行比较，结果表明MDS-LSTM模型的预测精度较高，能更好的预测期货的走势。"
"随着期货市场和期货行业改革的深入推进，期货行业将进入历史上最好的发展机遇期，期货行业将持续发展。人们也越来越关注期货的未来走势，希望可以提高收益，降低风险。近来，有许多文章都对期货价格的变化进行了研究。随着神经网络的发展，许多学者开始尝试使用神经网络模型对期货价格进行预测。 文宝石等 [ 1 ] 对股票数据进行滤波、差分及积分处理后结合LSTM模型进行预测，并与原始的LSTM模型和ARIMA模型对比发现，对数据进行多维处理后的LSTM模型有更好的性能和预测精度。马元昊 [ 2 ] 采用了多层LSTM模型对上证指数的后一日收盘价格进行预测，结果表明LSTM对股票的预测有强大的作用。肖争艳等 [ 3 ] 纳入反应中国国情的扩展指标，应用贝叶斯向量自回归模型与LSTM模型，对GDP进行动态滚动预测和固定窗口预测，结果表明LSTM模型有更好的泛化能力。李洁等 [ 4 ] 建立了基于后向传播的多时间尺度RNN模型，并对民航日客流量进行预测，并与其他几种方法对比发现该模型的预测精度更高。张可等 [ 5 ] 利用主成分分析法提取特征，建立LSTM模型对动作识别领域的7个数据集进行分析与预测，并与KNN模型和SVM模型对比，结果表明LSTM模型降低了预测难度，提高了精度。戴邵武等 [ 6 ] 引入经验模态分解法将数据分解成IMF分量和趋势项，构建LSTM模型对北京市PM2.5的浓度进行预测，与SVR模型相比较精度明显提高。"
"多维放缩(Multidimensional Scaling)是一种经典的降维方法，它可以使原始空间中样本的距离在低维空间中得到保持，因此它主要关注与高维数据内部的特征，致力于保留高维空间中的“相似度”信息。 假设m个样本在原始空间的距离矩阵为 D ∈ R m × m ，其元素 d i j 表示样本 x i 和 x j 之间的距离，原始空间的维数为d。目标是获得样本在 d ′ 维空间的表示 Z ∈ R d ′ × m , d ′ ≤ d ，且任意两个样本在 d ′ 维空间中的欧式距离等于原始空间中的距离，即 ‖ z i − z j ‖ = d i j 。 令 B = Z T Z ∈ R m × m ，其中B为降维后样本的内积矩阵， b i j = z i T z j ，有 d i j 2 = ‖ z i ‖ 2 + ‖ z j ‖ 2 − 2 z i T z j = b i i + b j j − 2 b i j (1) 为了便于讨论，令降维后的样本Z被中心化，即 ∑ i m z i = 0 。显然矩阵B的行与列之和均为零，即 ∑ i = 1 m b i j = ∑ j = 1 m b i j = 0 ，则 ∑ i = 1 m d i j 2 = ∑ i = 1 m b i i + m b j j − 2 ∑ i = 1 m b i j = t r ( B ) + m b j j (2) ∑ j = 1 m d i j 2 = ∑ j = 1 m b j j + m b i i − 2 ∑ j = 1 m b i j = t r ( B ) + m b i i (3) ∑ i = 1 m ∑ j = 1 m d i j 2 = ∑ i = 1 m ( t r ( B ) + m b i i ) = 2 m t r ( B ) (4) 其中， t r ( B ) = ∑ i m ‖ z i ‖ 2 。令 d i ⋅ 2 = 1 m ∑ j = 1 m d i j 2 (5) d ⋅ j 2 = 1 m ∑ i = 1 m d i j 2 (6) d ⋅ ⋅ 2 = 1 m 2 ∑ i = 1 m ∑ j = 1 m d i j 2 = 1 m 2 ( 2 m t r ( B ) ) = 2 m t r ( B ) (7) 于是由(1)~(7)可得 d i j = − 1 2 ( d i i 2 + d i ⋅ 2 − d ⋅ j 2 + d ⋅ ⋅ 2 ) (8) 由此即可通过原始空间的距离矩阵D求取内积矩阵B。 对矩阵B做特征分解， B = V Λ V T ，其中 Λ = d i a g ( λ 1 , λ 2 , ⋯ , λ d ) 为特征值构成的对角矩阵， λ 1 ≥ λ 2 ≥ ⋯ ≥ λ d ，V为特征向量矩阵。假定其中有d个非零特征值，它们构成对角矩阵 Λ * = d i a g ( λ 1 , λ 2 , ⋯ , λ d * ) ，令 V * 表示相应的特征向量矩阵，则Z可表示为 Z = Λ * 1 2 V * T ∈ R d * × m 。 在现实应用中为了使降维的效果更好，仅需要降维后的距离与原始空间中的距离尽可能接近，不需要完全相等，则可取 d ′ ≤ d 个最大特征值构成的对角矩阵来表示Z。  长短期记忆网络(Long Short-Term Memory)是特殊的递归神经网络，由于常规的递归神经网络不能有效的解决长时间的信息依赖问题，所以Hochreiter和Schmidhuber提出了能够解决长期依赖的长短期记忆网络。LSTM的主要结构如下： 图1. LSTM结构 LSTM最重要的结构是单元状态，如图1中横向穿过的一条直线。LSTM有特殊的门限结构，它可以有选择的让信息通过，LSTM有忘记门，输入门和输出门三种门限控制单元状态，分别对应图1中 f t ， i t 和 O t 。 忘记门 f t 根据上一时刻的输出 h t − 1 和当前时刻的输入 x t 判断哪些信息需要从单元状态中抛弃，它由sigmiod层决定，如图1中 σ 层，sigmoid层输出的数字为[0, 1]，1表示完全保留，0表示完全抛弃。 C t − 1 是上一时刻的状态值，它会随着时间的变化不断更新。 输入门 i t 决定单元状态哪些信息需要储存，它分为两步，首先输入sigmoid层决定哪些值需要更新，接下来在tanh层输入新的候选值，如图1中tanh层。下面通过忘记门和输入门选择的信息进行信息更新，变成下一时刻的新信息。 输出门 O t 首先经过sigmoid层决定单元状态哪些信息可以输出，接下来将单元状态中的信息输入到tanh函数中与sigmoid的门限值相乘，最终得到输出的信息。"
"选取黄金主连(au0001) 2009年4月14日至2020年9月25日共2785个交易日的数据。分别用开盘价、收盘价、最高价、最低价、成交量、MA.MA1、KDJ.K、KDJ.D、KDJ.J、MACD.DIFF、MACD.DEA、MACD.MACD等12个指标预测未来10日期货收盘价。在图2中可以看到黄金主连的收盘价格变化幅度较大，没有明显的规律。 图2. 黄金主连收盘价曲线  本文使用的软件为MATLAB。首先将数据进行标准化处理，消除量纲的影响，本文采用“最大最小 值”标准化方法，即 x ′ = x − x max x max − x min ，x为原始数据， x ′ 为标准化的数据， x max 为原始数据的最大值， x min 为原始数据的最小值。 将标准化后的数据进行MDS降维，首先用euclidean法计算距离矩阵，然后将数据进行降维处理，结果显示MDS方法将数据降到10维。将降维后的数据输入到LSTM神经网络中进行训练，选取前2775个数据作为训练样本，后10个数据作为测试样本，将收盘价作为输出，用前一日的特征指标预测后一日的期货收盘价格。由于Adam优化器非常适用于大规模数据，并且计算高效，所以MDS-LSTM模型选择Adam作为优化器，初始学习率为0.005，迭代次数为200次，结果如图3。 图3. MDS-LSTM预测结果  为了验证MDS-LSTM模型的效果，选取了MDS-BP模型与LSTM模型进行预测并与MDS-LSTM模型对比。MDS-BP模型选用newff法建立网络，用tansig训练隐藏层，purelin训练输出层，预测结果如图4。LSTM模型仍然选用Adam作为优化器，初始学习率为0.005，迭代次数为200次，预测结果如图5。 图4. MDS-BP预测结果 图5. LSTM预测结果 将MDS-BP模型和LSTM模型与MDS-LSTM模型进行对比，结果如图6。未来10日具体预测见表1，可以发现MDS-LSTM模型的预测效果更好，而且在期货价格波动较大时仍然有很好的拟合能力。 图6. 预测结果对比 Table 1 日期 真实值 MDS-LSTM MDS-BP LSTM 收 盘 价 2020.09.14 418.4400024 416.6134940 410.7366933 418.2308894 2020.09.15 419.7999878 416.5873396 410.6892847 418.3314404 2020.09.16 418.6400146 418.4739030 411.5838850 420.2919537 2020.09.17 415.6199951 417.0158520 410.9820331 420.6829135 收 盘 价 2020.09.18 416.9200134 413.5560229 409.1707151 418.9971440 2020.09.21 417.0100085 413.9966112 410.1771442 417.9316855 2020.09.22 407.5799866 414.7578599 409.9432455 418.0118737 2020.09.23 400.8999939 405.1827805 405.1655769 414.1995000 2020.09.24 396.5799866 400.1990371 399.7520063 410.0311776 2020.09.25 398.8800049 396.1674320 396.8202813 404.9963423 RMSE 0.0138 0.0232 0.0284 表1. 未来10日的预测结果对比"
"建立了MDS-LSTM、MDS-BP和LSTM神经网络模型，充分利用LSTM神经网络的长时间记忆性对期货价格进行预测。在对比试验中发现MDS-LSTM模型对于期货收盘价预测精度更高，LSTM模型预测精度相对较低。相比较于MDS-BP模型，MDS-LSTM模型在期货价格波动较大时有很好的拟合能力，可以更准确地预测期货的收盘价格，所以该方法有可行性。对于波动较大的收盘价格MDS-LSTM模型基本可以预测趋势，但精度有待提高，需要不断探索得到更高的准确率。"
