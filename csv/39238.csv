"本章基于DP曲线成为PH曲线的几何特征条件，利用三次PH-DP曲线，构造了互不包含的两圆之间的C型过渡曲线，并给出数值例子。"
"曲线和曲面设计中，由于几何拼接及数据插值的需要，涉及平面两曲线，特别是直线与直线，直线与圆弧，圆弧与圆弧之间的光滑连接。在公路设计，铁路设计和机器人路径设计中往往希望有一个由单螺旋段组成的两圆之间的G 2 连续过渡曲线。很多文献从不同侧面围绕过渡曲线的设计展开研究。例如：Zboinski，Woznica [ 1 ] 以铁路中的过渡曲线为例，从反射值角度对多项式过渡曲线的形状进行了优化；李重，马利庄 [ 2 ] 找到了一对合适的三次Bézier螺线，并用其构造了平面上两个相离的圆弧之间S型和C型G 2 连续的过渡曲线；高晖，寿华好 [ 3 ] 构造了在一定条件下曲率单调的类三次Bézier曲线，并用其构造两个圆弧之间半径比例不受限制的S型和C型G 2 连续过渡曲线；同时构造了两条α-曲线，其中一条可用于构造与文献 [ 4 ] 中具有相同特征的过渡曲线，另一条可用于构造两个圆弧之间不含曲率极值点的过渡曲线。为了保证过渡曲线的曲率尽可能单调，Kneek D. S.，Walton D. J. [ 5 ] 利用clothoid曲线构造了一种过渡曲线。虽然该过渡曲线曲率单调，但因为该曲线的表达式涉及到Frensel积分，所以该过渡曲线与传统的CAD/CAM系统不兼容。为克服这个缺点，文献 [ 6 ] [ 7 ] [ 8 ] [ 9 ] 分别采用三次Bézier曲线来构造曲率单调曲线段。三次Bézier曲线及三次B样条曲线次数低，几何结构简单，形状易控，有关算法在交互计算机图形环境下便于实施，是CAD及CAGD中最常用的曲线。用三次曲线构造曲率单调的过渡曲线，避免了表达形式与CAD系统的不兼容性。但另一方面，过渡曲线的弧长及等距线的表达式通常不是多项式及有理多项式形式，给实际的几何设计又带来了新的难题。随着五次PH曲线的引入，上述问题得到了有效解决。 PH曲线的主要特征是具有有理形式的等距线和多项式弧长，这些优点使得PH曲线广泛应用于等距线生成、机器人行走路径设计、道路设计、数控机械加工中，随后又推广到有理形式的PH曲线。郑志浩，汪国昭 [ 10 ] 提出用三次PH曲线构造两曲率圆内含情况下的过渡曲线，并给出这种情况下圆心距的取值范围，取得了较好的结果。刘莹莹 [ 11 ] 提出用三次PH曲线构造两曲率圆相离情况下的过渡曲线，并给出这种情况下圆心距的取值范围。而在2003年，Delagdo和Pena提出一种新的参数曲线，称其基函数为 DP基，因此构造的曲线被称为DP曲线 [ 12 ]。该曲线是由割角算法生成的，并且其基函数具有优于其他基函数的性质，因为它是保型性全正基(NTP基)，并在数值计算过程中具有稳定性，且其计算简便，计算复杂度为线性的。因此，DP曲线在计算速度方面优于Bézier曲线，并具有研究的意义。2019年，李尚蔚 [ 13 ] 基于DP曲线，构造了三次PH-DP曲线，并给出三次DP曲线成为PH曲线的控制多边形几何特征条件。本文通过PH-DP控制多边形几何特征条件，做过渡曲线，并给出数值例子。"
"设 B i n ( t ) = ( n i ) ( 1 − t ) n − i t i , 0 ≤ t ≤ 1 是Bernstein基函数，n次Bézier曲线定义为 P ( t ) = ( x ( t ) , y ( t ) ) = ∑ i = 0 n B i n ( t ) P i , (1) 其中 P i = ( x i , y i ) , i = 0 , ⋯ , n 是控制点。如果存在多项式 δ ( t ) ，使得 x ′ 2 ( t ) + y ′ 2 ( t ) = δ 2 ( t ) , 称 P ( t ) 为n次Pythagorean-hodograph曲线，当 n = 3 时简称为3次PH曲线。PH曲线的特点是其弧长及等距线表达式为多项式或有理多项式。  给定控制点 q i ，对于 ∀ t ∈ [ 0 , 1 ] ，三次DP曲线定义为 Q ( t ) = ∑ i = 0 3 q i D i , 3 ( t ) (2) 其中三次DP曲线基函数为 [ D 0 , 3 , D 1 , 3 , D 2 , 3 , D 3 , 3 ] = [ ( 1 − t ) 3 , t ( 1 − t ) ( 2 − t ) , t ( 1 − t ) ( 1 + t ) , t 3 ]  定理1 对于任意给定的三次DP曲线 Q ( t ) ，其控制顶点 q i ( i = 0 , 1 , 2 , 3 ) ，控制多边形的各 L 1 , L 2 , L 3 边长， d j , k 表示 q j 和 q k 之间的距离 ( j ≠ k ) ， L 1 = d 01 , L 2 = d 12 , L 3 = d 23 , L = d 02 顶点 q 1 , q 2 对应的角 θ 1 和 θ 2 ，则 Q ( t ) 成为三次PH-DP曲线的充要条件为 { 4 L = 9 L 1 L 2 θ 1 = θ 2 (3) 设三次PH-DP曲线的控制多边形初始端点为 P 0 ，末端点为 P 3 ，以 q 0 为原点建立直角坐标系，其中由 P 0 处曲率可以得到以 C 0 为圆心， r 0 为半径的圆 Ω 0 ；由末端点 P 3 处曲率可以得到以 C 1 为圆心， r 1 为半径的圆 Ω 1 ，曲率圆 Ω 0 、 Ω 1 如图1所示。 图1. 三次PH曲线的坐标系设定及端点曲率图 我们可以得到三次PH-DP曲线的控制点为 P 0 = ( x 0 , y 0 ) = ( 0 , 0 ) , P 1 = ( x 1 , y 1 ) = ( L 0 , 0 ) , P 2 = ( x 2 , y 2 ) = ( L 0 + L 1 cos θ , L 1 sin θ ) , P 3 = P 4 = ( x 3 , y 3 ) = ( L 0 + L 1 cos θ + L 2 cos 2 θ , L 1 sin θ + L 2 sin 2 θ ) . (4)"
"本节讨论了用三次PH-DP曲线构造两个相不包含圆之间的G 2 连续过渡曲线的存在性。通过计算得出C型过渡曲线的条件，并证明过渡曲线的唯一性，最后给出了数值例子。 定理2 当两个圆互相包含时，即 r < r 0 − r 1 时，控制多边形顶角的余弦范围 0 < cos θ < λ 且 λ = r 1 r 0 4 ，则(2)式定义的曲线为C型过渡曲线。 证明：将(4)式带入到(2)式中，得到 P ( t ) 的参数表达式为 P ( t ) = ( x ( t ) , y ( t ) ) = P 0 ( 1 − t ) 3 + P 1 t ( 1 − t ) ( 2 − t ) + P 2 t ( 1 − t ) ( 1 + t ) + P 3 t 3 其中 x ( t ) = L 0 t ( 1 − t ) ( 2 − t ) + ( L 0 + L 1 cos θ ) t ( 1 − t ) ( 1 + t ) + ( L 0 + L 1 cos θ + L 2 cos 2 θ ) t 3 y ( t ) = L 1 sin θ t ( 1 − t ) ( 1 + t ) + ( L 1 sin θ + L 2 sin 2 θ ) t 3 曲线的曲率为 k ( t ) = L 0 L 2 sin θ ( 2 L 0 ( 1 − t ) 2 + 3 L 0 L 2 cos θ t ( 1 − t ) + 2 L 2 t 2 ) 2 将 t = 0 , 1 带入 k 0 = k ( 0 ) = L 0 L 2 sin θ 4 L 0 2 k 1 = k ( 1 ) = L 0 L 2 sin θ 4 L 2 2 当 0 < θ < π 2 时， k 0 和 k 1 同号，即两圆互不包含时的过渡曲线是C的，对曲率求导，得到PH-DP曲线的曲率导数为 k ′ ( t ) = 6 L 0 L 2 sin θ ( ( L 0 L 2 cos θ − 4 3 L 0 ) ( 1 − t ) + ( L 2 − L 0 L 2 cos θ ) t ) 2 L 0 ( 1 − t ) 2 + 3 L 0 L 2 cos θ t ( 1 − t ) + 2 L 2 t 2 将 t = 0 , 1 带入 k ′ ( 0 ) = − 6 L 0 L 2 sin θ ( L 0 L 2 cos θ − 4 3 L 0 ) 8 L 0 3 k ′ ( 1 ) = − 6 L 0 L 2 sin θ ( L 2 − L 0 L 2 cos θ ) 8 L 2 3 当 0 < λ < 1 , 0 < θ < arccos λ 时 k ′ ( 0 ) ⋅ k ′ ( 1 ) < 0 此时PH-DP曲线构造的过渡曲线是C型的，且其内部含有较少的曲率极值点。 下面讨论三次PH-DP过渡曲线的唯一性。 定理3 若所构造的过渡曲线满足下面的条件，则该曲线是唯一的。 0.5176 < λ < 1 且 r 0 − r 1 < r < q ( λ ) ( r 0 − r 1 ) 其中 q ( λ ) = 9 − 8 λ 2 + 14 λ 4 − 8 λ 6 + 9 λ 8 3 ( 1 − λ 4 ) 证明 设三次带参数PH曲线的两端点分别为 P 0 和 P 3 ， P 0 的曲率圆心以及曲率半径分别为 C 0 和 r 0 ， P 3 的曲率圆心以及曲率半径分别为 C 1 和 r 1 ，则两个圆之间的圆心距向量为 C 1 − C 0 = ( P 3 ( 1 ) − r 1 sin 2 θ , P 3 ( 2 ) + r 1 cos 2 θ − r 0 ) 。 由初始点曲率 k 0 = 1 r 0 = L 0 L 2 sin θ 4 L 0 2 ，末端点曲率 k 1 = 1 r 1 = L 0 L 2 sin θ 4 L 2 2 及 λ = r 0 r 1 4 可得 L 0 = 1 4 λ r 0 sin θ L 2 = 1 4 λ 3 r 0 sin θ 经计算可得 L 1 = 3 8 λ 2 r 0 sin θ 。 构造函数 g ( θ ) = | C 1 − C 0 | 2 − r 2 。令 m = cos θ ，则 0 ≤ m < 1 。将PH-DP曲线的控制点带入 g ( θ ) 得到关于m的四次方程： g ( m ) = − 1 4 λ 4 r 0 2 m 4 + 13 16 λ 3 r 0 2 ( 1 + λ 2 ) m 3 + λ 2 16 r 0 2 ( − 1 + 11 λ − 25 4 ) m 2 − 13 16 λ 3 ( 1 + λ 2 ) m     + 1 64 ( − 64 r 2 + ( 64 − 44 λ 2 + 9 λ 4 − 44 λ 6 + 64 λ 8 ) r 0 2 ) = 0 由于 0 < m = cos θ < λ 。根据零点定理知 g ( 0 ) ⋅ g ( λ ) < 0 时，方程 g ( m ) 有根。把 0 , λ 带入 g ( m ) 后得 g ( 0 ) = 1 64 ( − 64 r 2 + ( 64 − 44 λ 2 + 9 λ 4 − 44 λ 6 + 64 λ 8 ) r 0 2 ) g ( λ ) = ( 1 − 1 16 λ 2 − 43 64 λ 4 + 299 64 λ 6 − 9 4 λ 8 ) r 0 2 − r 2 整理后分别为： g ( 0 ) = 64 − 44 λ 2 + 9 λ 4 − 44 λ 6 + 64 λ 8 64 ( 1 − λ 4 ) 2 ( r 0 − r 1 ) 2 − r 2 g ( λ ) = 43 + 299 λ 2 − 144 λ 4 64 ( 1 + λ 2 ) 2 ( r 0 − r 1 ) 2 − r 2 由 0 < λ < 1 知 0 < 43 + 299 λ 2 − 144 λ 4 8 ( 1 + λ 2 ) < 1 。因为 r > r 0 − r 1 ，所以 g ( λ ) < 0 。由此得 g ( 0 ) > 0 。 由 g ( 0 ) > 0 得 64 − 44 λ 2 + 9 λ 4 − 44 λ 6 + 64 λ 8 8 ( 1 − λ 4 ) ( r 0 − r 1 ) < 9 − 8 λ 2 + 14 λ 4 − 8 λ 6 + 9 λ 8 3 ( 1 − λ 4 ) ( r 0 − r 1 ) < r 图2. ( r 0 = 1.5 , r 1 = 1 ) 时的三次PH-DP过渡曲线 图3. ( r 0 = 1.5 , r 1 = 1 ) 时的三次PH-DP曲线曲率 经计算，当 0.5176 < λ < 1 ， g ( 0 ) > 0 成立，故方程 g ( m ) 此时在 ( 0 , λ ) 有根。 对方程 g ( m ) 求导得 g ′ ( m ) = − 13 16 λ 3 ( 1 + λ 2 ) + 1 8 λ 4 ( − 25 4 + 11 λ 2 ) h 2 + 39 16 λ 3 ( 1 + λ 2 ) h 2 − λ 4 h 3 g ′ ( 0 ) = − 13 16 λ 3 ( 1 + λ 2 ) < 0 因 g ″ ( 0 ) = 1 8 λ 4 ( − 25 4 + 11 λ 2 ) r 0 2 > 0 ， g ″ ( m ) = 1 32 λ 4 ( − 99 + 104 λ 2 ) > 0 ，所以 g ′ ( m ) 是一个单调递增函数。又因为在 ( 0 , λ ) 上 g ( m ) = 0 , g ′ ( m ) < 0 ，所以 g ′ ( m ) 是一个单调递增函数。所以 g ( m ) 有唯一根。"
"取 r 0 = 1.5 ，由 0.5176 < λ < 1 ，取 r 1 = 1 ，这时起始圆的圆心为(0,1.5)，通过计算可得过渡曲线两端点的曲率圆的圆心距的范围 r 0 − r 1 < r < 3.3833 ( r 0 − r 1 ) ，取 r = 2.3 ，解得 θ = 1.0842 ，则所生成的三次PH-DP过渡曲线如图2所示，过渡曲线的曲率如图3所示，其内部曲率极值点个数为1。"
