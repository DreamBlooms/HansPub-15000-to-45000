"为提高三偏心金属硬密封蝶阀的修改设计效率与质量，填补该类产品快速设计CAD系统的技术和市场空白，以SolidWorks系统为基础，使用VB编程，并通过API函数调用系统功能，开发完成了集零件自动建模、自动装配、工程图设计及主要零件自动有限元分析等功能于一体的三偏心蝶阀系列化产品快速设计3DCAD系统。给出了该类阀门零件参数化模型的建立方法，解决了自动装配、自动有限元分析等技术问题，为类似系统的开发提供了理论和方法参照。所开发的系统极大提高了设计效率，满足了生产实际需求。"
"三偏心金属硬密封蝶阀因其体积较小、重量较轻、操作力矩小、启闭快速、具有良好的密封效果，已经在各行业中被广泛使用，是石油、化工、机械、电气等相关部门必不可缺的流体控制设备 [ 1 ] [ 2 ] [ 3 ]。作为国民经济中大量使用并频繁更换的产品，三偏心金属硬密封蝶阀的设计和生产周期越来越短，市场竞争越来越激烈 [ 4 ]。目前，该类产品的设计大多基于已有产品2D或3D设计文件进行修改设计，设计周期长、修改效率低，易出纰漏，难以满足市场对该类产品快速设计修改的实际需求。 刘晓健等人提出，随着社会的不断发展，传统的CAD造型技术、设计方法已经不能满足企业的需求，三维参数化设计、三维数字化系统的研发已经成为制造业的趋势 [ 5 ] [ 6 ] [ 7 ] [ 8 ]。刘检化等人提出，三维数字化设计制造能力已经成为我国企业竞争的核心，是目前实现企业研制能力变革的支点和突破口 [ 9 ]。陈德航等人提出，面对市场日益多样化个性化的需求，单一品种产品很难满足要求，产品系列化设计应运而生 [ 10 ]。由于三偏心金属硬密封蝶阀零件趋向于标准化、系列化，因此，针对其系列化产品开展3D参数化快速设计技术研究与系统开发，可有效解决设计问题，满足市场需求。 徐林红等人提出了利用开发工具VB和三维设计软件SolidWorks建立系列化产品参数化设计系统的方法设想 [ 11 ] - [ 17 ]。Ma XiuHua利用可视化编程工具Visual Basic6.0对SolidWorks 2012进行重新开发，实现了井口闸阀的三维参数化设计，并在工程图模板上对相应的工程图进行了改造，然后使用SolidWorks的有限元分析模块直接进行有限元分析 [ 18 ]。这可以有效缩短闸阀的设计时间，提高工作效率。从现有的研究成果发现，通过编程开发参数化系统，并依托3DCAD系统实现阀门产品的三维参数化设计是提高设计效率和质量的有效手段。但针对该类系统进行参数化建模方法和理论的研究成果，实现自动建模、装配、成图和有限元分析的研究成果没有文献报道；三偏心金属硬密封蝶阀系列化产品的参数化快速设计系统研究成果也没有文献报道。 综上所述，针对三偏心金属硬密封蝶阀的参数化建模方法开展研究，并基于3DCAD系统开发集自动建模、自动装配、自动出图和自动分析功能于一体的三维参数化快速设计系统，可为阀门产品参数化设计系统开发提供理论和方法支持，也能够为提高该类产品的设计效率和质量提出实用的系统。本文将开发完成的三偏心金属硬密封蝶阀快速设计系统命名为Butterfly-Valve Quick CAD System (简称BVQCAD系统)。"
"BVQCAD系统分为四个模块，分别是零件建模模块、装配体模块、工程图模块和分析模块。 零件建模模块用来生成三偏心金属硬密封蝶阀每个零件的模型，并将每个零件放在固定文件夹中为装配体和工程图模块做准备；装配体模块能自动生成装配体；工程图模块可以自动生成蝶阀每个零件的工程图；分析模块实现蝶阀中重要零件的有限元分析，如阀轴、蝶板等。系统总体结构如图1所示，系统工作流程如图2所示。 图1. BVQCAD系统总体结构框图  三偏心金属硬密封蝶阀参数化设计的总体思路如下： 1) 根据客户提交的订单，提取到参数化设计系统所需的驱动参数，如蝶阀的公称尺寸DN、蝶阀的公称压力PN和蝶阀的结构长度L。 2) 根据零件的几何关系，将零件建模顺序拆分为多个特征，从每个特征中提取建立该特征所需的参数。 3) 根据零件之间的数学关系，将从零件每个特征中提取出来的参数建立起数学关系，可以根据计算公式、国家标准关系和经验公式等，找出驱动参数与这些提取的参数之间的关系，实现驱动参数带动特征参数的联动效果。 4) 结合SolidWorks API函数与数学模型，将数学模型编入VB程序中，提取驱动参数为入口参数，其他建模参数为出口参数，达到入口参数与出口参数联动的效果，以实现参数化建模。 5) 利用VB6.0可视化特点，建立人机交互界面，将编写的程序放入可视化界面中，实现人机交互参数化建模的效果。 自动建模设计方案流程图如图3所示。 图2. BVQCAD系统工作流程图 图3. 自动建模方案流程图  本系统自动装配的思路是利用SolidWorks自带的装配体自动更新功能实现自动装配。利用装配体与零件之间具有的联动关系，改变蝶阀每个零件的尺寸，使其联动的装配体也发生改变，从而实现蝶阀的自动装配。具体的操作步骤如下： 1) 制作三偏心蝶阀零件的模板文件。 2) 将蝶板零件按尺寸位置的配合约束关系手动装配在一起，制作一个蝶阀装配体模板。 3) 利用Visual Basic6.0建立装配体人机交互界面。 4) 写一段调用并更新固定文件夹内装配体的代码，插入到Visual Basic6.0建立的人机界面中。 5) 用户改变蝶阀零件的参数，装配体随着零件的改变发生联动改变，实现自动更新。  本系统自动成图的主要思路是利用零件与工程图之间的联动关系，用Visual Basic6.0建立人机交互界面，在界面中写入调用工程图并自动更新的代码。具体的操作步骤如下： 1) 制作三偏心蝶阀零件的模板文件。 2) 从三偏心蝶阀的零件图生成相应的工程图，并标注尺寸，材料明细表等内容，将其做成三偏心蝶阀工程图的模板。 3) 用Visual Basic6.0建立人机交互界面，在界面中写入调用工程图并自动更新的代码。 4) 用户改变零件图参数，零件图发生改变。 5) 更新零件模板，工程图自动更新，三偏心蝶阀系统实现自动出工程图功能。  Visual Basic6.0引用simulation模块之后即可调用simulation模块的API函数，编写有限元分析的代码，实现SolidWorks自动有限元分析。对蝶板有限元分析的思路是，根据流程找到每一步流程所涉及的API函数，建立算例，添加材料，添加约束等。蝶板静力学有限元分析的步骤如图4所示。 图4. 蝶板有限元分析流程图"
"在零件建模的总参数输入界面上，有工作压力、公称直径和结构长度的选择，如图5所示。这些参数的选择是用户在定制三偏心金属硬密封蝶阀时要求的参数，属于驱动参数。除了三个驱动参数，界面上还有参数检验，是为了检验驱动参数输入是否正确。 图5. 参数输入界面 零件建模界面如图6所示。下面以阀轴为例，说明零件建模模块系统的建立。在图6中点击“阀轴建模”，出现如图7所示的阀轴参数化设计界面。界面主要包括如下内容： 1) 自动生成的参数区域。 2) 需要选择的参数区域。 3) 视图显示区域。这块区域是阀轴的工程图，图中标注了参数，用户可以根据这些参数来更好的判断生成参数的含义和需要选择参数的含义，完成阀轴的建模。 4) 功能区域。 根据阀轴参数化模型的几何模型和数学模型，将阀轴分为7个特征，每个特征提取了各自的参数，根据这些特征和参数结合SolidWorks API函数，可以将建模步骤用编程的方式实现，将入口参数和出口参数之间的关系输入程序中，即可实现零件的参数化建模，如图8所示。 图6. 蝶阀零件建模界面 图7. 阀轴参数化设计界面 图8. 阀轴零件图  在装配体模块主界面，单击“建立装配体”即可生成三偏心金属硬密封蝶阀的装配体模型，如图9所示。上述程序在运行前，首先需要在零件建模模块更改三偏心蝶阀零部件的尺寸，然后进行“自动装配”操作，程序会自动将模板相对应的文件更新为当前新的零件。最后更新装配体，实现自动装配。 图9. 三偏心蝶阀装配体模型  进入蝶阀有限元分析模块，主界面如图10所示。本系统主要对三偏心金属硬密封蝶阀的主要零件蝶板进行静力学有限元分析，单击“有限元分析”即可生成三偏心蝶阀蝶板有限元分析的应力应变状态。如图11所示。 图10. 三偏心蝶阀有限元分析界面 图11. 蝶板静力学分析结果"
"本文以三偏心金属硬密封蝶阀为研究对象，采用参数化建模、VB程序开发，通过API函数调用SolidWorks和Simulation的建模与分析功能，完成了一套集成一体化快速修改CAD系统的开发。得到主要结论如下： 1) 开发出一套应用于三偏心金属硬密封蝶阀系列化产品进行快速设计及修改的3DCAD系统。在用户给出主要驱动参数后，系统可以实现三偏心金属硬密封蝶阀各个零件的自动建模、零件之间的自动装配、各个零件的工程图以及有限元分析报告的生成，功能全面，体现了集成一体化特性，用户界面友好，操作简便。 2) 该系统通过函数传递，功能调用及程序控制，形成了基于零件模型及参数自动传递模式下，调用Simulation功能完成零件自动有限元静力学分析的方法，解决了基于SolidWorks系统实现自动有限元分析的难题。 3) 本系统完善了集成一体化快速设计CAD系统的功能，通过正确使用API函数和程序创新，大大提升了BVQCAD系统的使用体验。设计效率和质量大幅提升，满足了三偏心金属硬密封蝶阀快速修改设计的实际需要。"
