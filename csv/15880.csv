"针对表面肌电信号微弱、易受干扰的特点，设计了一种基于ADS1294的表面肌电信号检测系统。系统采用了模拟前端ADS1294电路对表面肌电信号进行滤波、调理和采集，设计了MSP 430F 169主控制器电路将采集的肌电信号数据传输给上位机，并在LabVIEW环境下，开发了肌电信号检测系统上位机应用程序。该应用程序功能包括信号显示、数字滤波、波形记录及存储回放。实验结果表明，此系统能有效采集及显示表面肌电信号。 关键词 :表面肌电信号，ADS1294，LabVIEW"
"肌电信号是人体肌肉活动时运动单位动作电位在肌肉、皮下组织和皮肤等相互作用的电位叠加，包含着神经、肌肉的多种功能信息。通过对肌电信号的检测以及信息提取，可以广泛应用在临床医学、生物仿生和机器人控制等方面[ 1 ] -[ 3 ] 。然而表面肌电信号幅值微弱，一般在10~5000 μV，频率范围20~500 Hz，在背景噪声较大情况下使得有用信号的获取更为困难。 目前针对肌电信号采集处理系统的研究主要体现在三个方面：在成本控制前提下如何更加有效获取有用信号 [ 4 ] [ 5 ] ，背景噪声的去噪处理方法 [ 6 ] [ 7 ] ，肌电信号的特征提取及模式识别 [ 8 ] 。有效信号的检测方法分为两种方式来实现，一种是采用分立器件设计信号调理和转换电路，另一种是采用专用集成测量模拟前端电路设计 [ 9 ] [ 10 ] 。前者成本低，设计灵活，但是易于引入较大噪声，模拟前端电路将肌电信号的采集、前置放大、模数转换等功能全部集成在一个芯片内，对肌电信号进行滤波、陷波简单预处理，就能获取有用信号，具有抗噪声能力强，检测精度高，设计简单等特点，但是成本较高。 通过对比两种测量方式，本系统采用模拟前端ADS1294电路对表面肌电信号进行滤波、调理和采集，设计了MSP 430F 169主控制器电路将采集的肌电信号数据传输给上位机，在LabVIEW环境下，开发了肌电信号检测系统上位机应用程序。该应用程序实现了对硬件电路采集的信号进行数据转换、波形显示和存储回放，以及一些简单的滤波处理。"
"整个系统由基于ADS1294的表面肌电信号采集模块、主控制器MSP 430F 169模块和上位机LabVIEW模块组成，系统结构图如图1所示。基于ADS1294的表面肌电信号采集模块负责采集表面肌电信号。主控制器MSP 430F 169模块功能是将采集的数据通过SPI接口传输给上位机。上位机LabVIEW模块对接收的肌电信号波形显示、数字滤波、波形记录及存储回放。"
"肌电信号采集模块，先对电极拾取的肌电信号进行滤波和放大预处理，再由模拟前端ADS1294进行内部增益放大和AD转换。 ADS1294是TI公司专用于生物电测量的全面集成型模拟前端芯片，它集成了高转换精度的模数转换 图1. 系统结构图 模块、程控差分输入放大器、右腿驱动和Wilson电阻网络等[ 9 ] 。而且ADS1294包含了所有医疗心电图(ECG)和脑电图(EEG)应用所通常要求的所有特征。借助于其高水平的集成和出色的性能，模拟前端ADS1294可大大减小医疗仪器的尺寸、功率和总体成本。 由于ADS1294模拟前端高度集成，外围电路只需要一些去耦及增强器件稳定性的电容。主控制器MSP 430F 169通过SPI接口对ADS1294模拟前端进行寄存器配置、数据读写和运行控制操作。为了增强SPI接口的驱动能力，避免数据传输时受到干扰而出现数据传输出错，在设计时将SPI接口的时钟SPI_SCLK、数据输入SPI_DIN和数据输出SPI_DOUT三根信号线进行上拉。模拟前端ADS1294核心电路如图2所示。  MSP 430F 169微控制器是TI公司基于RISC的16位混合信号处理器，专为满足超低功耗需求而精心设计。其内部集成了同步通信(USART)/异步通信(SPI)接口和48个IO口。MSP 430F 169内部具有60 kB + 256 B的Flash，其工作最高频率可达8 MHz。 基于MSP 430F 169微控制器低功耗、设计简单、性能好的特点，本设计采用MSP 430F 169作为主控制器。主控制器MSP 430F 169模块在系统中的主要功能有以下几点：1) 利用SPI接口对ADS1294内部寄存器进行配置；2) 通过I/O口控制ADS1294采集肌电信号；3) 信号采集完后的中断识别、数据读取及Flash存储；4) 利用异步通信UASRT将存储在Flash中的肌电信号上传给上位机。其控制电路如图3所示。"
"主控制器MSP 430F 169软件设计的整体程序流程图如图4所示。系统上电后，先初始化配置ADS1294寄存器，然后开始采集，当数据准备完成产生中断，MSP 430F 169识别中断后读取ADS1294转换的数据并存储在flash中。当flash存满时，将所有采集的数据上传给上位机。  本设计以虚拟仪器LabVIEW作为上位机，对MSP 430F 169传输上来的数据进行波形显示、数字滤 图2. 模拟前端ADS1294电路图 波及存储回放等操作。在程序设计时，采用事件结构对不同的事件进行压栈和判断。当具体事件来临，将进入具体事件结构中进行循环执行，直到其他的指令发出。上位机程序流程图如图5所示。 上位机LabVIEW程序的设计首先是建立数据存储文件。为了文件的读取方便，在建立文件时，给每通道的数据进行命名，同时将每一组数据进行编号，这样也便于数据的查错。其次是数据通过串口读取后的数据处理。在程序中，每个通道的数据都需处理，因此在设计时采用子程序打包调用的方法，使程序简洁、可读性强。最后，将处理后的数据进行保存、显示及数字滤波等。"
"为测试系统的有效性，首先对系统进行了内部短路噪声测试、电极自然电位测试以及交直流静态测试。测试条件采用9 V干电池供电，采用6位半福禄克数字万用表进行标定，分别对三个通道接地，测试得到三通道的内部噪声最大波动值分别为：1.08 µV, 1.25 µV, 1.5 µV。在此基础上，对人体手臂表面肌电信号进行采集。配置ADS1294的1~3通道的差分输入为正常输入，内部程控增益为12。人体手臂做伸缩运动时，主要依靠手臂的肱二头肌、肱三头肌和三角肌的肌肉组织。测试时ADS1294的三个通道的差分电极分别贴在手臂的肱二头肌、肱三头肌和三角肌，手臂做来回的伸缩动作。测得的原始波形及经过截止频率为500 Hz低通数字滤波后的波形分别如图6、图7所示。由图可知，未滤波的肌电信号最大为几十毫伏，滤波后的肌电信号为几百µV~几毫伏，同时肱二头肌、肱三头肌和三角肌的肌电信号有差 图3. MSP 430F 169控制电路图 图4. MSP 430F 169程序流程图 图5. 上位机LabVIEW流程图 图6. 肌电信号原始波形 图7. 滤波后肌电信号波形 异，不动作时波形和文献[ 5 ] 波形相似，幅值基本没有变化。动作引起的电位信号差异如何区分需要对测量数据进行特征量提取，模式识别，在线或离线辨识，然后再执行相应的动作[ 8 ] 。"
"肌电信号测量及处理系统在生物医疗、仿生智能机器、生物康复等方面具有广阔的应用前景。肌电信号的检测是该系统设计中的一个难点，获取实时、信噪比高的肌电信号，将大幅降低信号处理的难度，同时提高识别的有效性和准确性。论文设计的基于ADS1294的肌电信号采集系统，可以完成对手臂表面肌电信号的有效采集。整个系统以MSP430为主控制器控制各个模块的工作和数据传输，并利用虚拟仪器LabVIEW设计了上位机系统，可以实现对数据的有效处理、波形显示和存储回放。该系统为分析手臂运动信号与检测肌电信号相关性提供了良好的平台，在此基础上将进一步研究肌电信号的特征提取，在线或离线模式识别。"
