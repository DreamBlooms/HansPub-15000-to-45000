"通过解算北斗卫星基线单历元时间序列，分析其误差特性，时间序列中主要包含周期性误差及高频噪声的影响。本文通过使用中值滤波和小波分析等去噪方法，对时间序列中的高频噪声进行滤波，实验结果表明，高频噪声接近正态分布特性，可归类于偶然误差，通过滤波能得到较好地抑制，小波分析相对而言更适合用于北斗单历元去噪。 关键词 :北斗单历元定位，时间序列，中值滤波，小波分析 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"北斗卫星导航系统(BDS)的设计空间星座由5颗地球静止轨道(GEO)卫星、27颗中圆地球轨道(MEO)卫星和3颗倾斜地球同步轨道(IGSO)卫星组成 [ 1 ] 。截止2018年2月12日，共发射了29颗北斗导航卫星。随着北斗系统进一步发展与完善，北斗高精度定位逐渐成为研究热点。卫星信号穿过电离层、对流层到达接收机会受到一系列干扰和延迟。在信号传播路径误差中，电离层延迟、对流层延迟可通过模型改正削弱，相对定位差分技术可大幅度削弱相关性误差，但仍然存在一定的残差。差分技术无法消除多路径误差，在消除其他强相关性误差后，多路径误差成为主要的误差源 [ 2 ] 。通过实测数据发现，北斗GEO、IGSO、MEO卫星伪距观测量中均包含严重的多路径误差，同一个卫星的多路径误差与该卫星的高度角呈强相关关系 [ 3 ] 。文献 [ 4 ] 根据基线解算结果提取了观测站的多路径误差时间序列，并通过最大相关性分析确定了多路径误差的周期，在此基础上提出了适用于北斗系统的恒星日滤波算法。文献 [ 5 ] 基于实测数据提取多路径误差并分析其所具有的特性，探讨不同定位解算方式中的多路径误差消除策略。北斗单历元时间序列中不仅包含多路径误差，还包含有高频噪声，为了提取较为纯净的多路径误差需要对时间序列进行去噪。高频噪声一般为高斯白噪声，具有单峰、有界、对称、零均值四个特性。北斗单历元时间序列由于观测误差包含有高频噪音，其去噪是一个基本问题，本文通过中值滤波、小波分析等去噪方法，对北斗单历元时间序列中的噪声进行滤波，从而移去其中的偶然误差；并从均方根误差、信噪比、平滑度的角度比较分析两种方法的特性，评价去噪效果，从而为选择滤波方法提供参考。"
"为了研究北斗单历元的误差特性，在校园内进行北斗实验数据采集，基线长度约482米，观测开始时间是2015年1月12日8时0分0秒，结束时间2015年1月12日8时59分59秒，采样率为1秒，共采集3600个历元的观测值。通过电离层残差组合和M-W组合解算北斗整周模糊度和探测周跳，使用卡尔曼滤波解算北斗单历元定位。基线解算结果在N，E，U三个方向的基线分量及其残差的直方图如图1、图2所示。 基线解算表明，北方向分量均方根误差和东方向分量均方根误差相对较小，为3.7 cm和6.3 cm，高程方向均方根相对较大，为15.7 cm。由三个方向的直方图可知，时间序列中包含有高频噪声，噪声分布服从近似正态分布，属于高斯噪声。"
"为了过滤北斗单历元时间序列中的高斯噪声，常采用中值滤波、小波分析等去噪方法，以下简单介绍去噪原理并将去噪结果进行对比分析。 图1. BDS基线解算结果 图2. BDS基线残差分布 1) 中值滤波 中值滤波是选取一定大小的窗口，将窗口内的数据按照从小到大排列，取其中值为窗口中心的替代值得一种滤波方法。其本质为一种低通滤波，具有平滑效果，可以较好地消除高斯噪声。中值滤波包括一维中值滤波和二维中值滤波，去噪效果与选取的窗口有关，窗口过大容易过度平滑，窗口太小则达不到去噪效果，因此须合理选择去噪窗口。我们共观测了一个小时1 Hz的数据，选取滤波窗口为25进行滤波，通过中值滤波得到结果如图3所示，其中滤波残差为原始信号减去滤波信号。 3600个滤波残差的统计特性如图4所示。从图4中我们可以看出，过滤残差近似服从正态分布，因此中值滤波的过滤部分属于随机偶然误差。 通过中值滤波，可获得滤波后残差，各不同方向滤波后残差的均方根误差值为：北向±5.0 mm，东向±2.9 mm，高程方向为±13.6 mm。 2) 小波去噪 小波广泛应用于图像处理、数据压缩、信号处理等应用领域，是近年来热门数据处理手段之一。相比于傅里叶变换，小波可以实现低频处频率细分，高频处时间细分，能自适应时频信号分析的要求，克服了傅里叶变换的难题。小波去噪在GPS数据处理方面有广泛的应用。以基线观测数据为研究对象，采用不同分解层数、不同阈值选取方法、不同小波函数等三种方案进行小波去噪处理，结果表明选用合适的去噪方法可以很大程度上提高基线解算的精度，反之则会降低基线解算的精度 [ 6 ] 。文献 [ 7 ] 提取GPS信号中的两颗卫星载波相位L1上的C/A码，分别通过不同历元间求出单差以及双差，再分别选取一定的小波基函数和选取特定的阈值对其进行小波分析去噪，通过信噪比、均方根误差作为小波函数和阈值 图3. 基线2021~2951东方向分量和高频噪声 图4. 残差统计 选取的标准及去噪效果的评价标准，将获取的不同小波去噪结果进行对比，根据对比的结果确定选择哪种小波，选取何种阈值，确定小波函数和阈值以后，最后选取平滑度来确定最终去噪的效果。 小波阈值去噪，是通过对信号进行小波分解，采用一定的原则进行去噪后重构信号，实现过滤噪声的目的。因此，小波去噪的一般步骤为： a) 分解过程：首先根据信号的特性和波形选择合适的小波，再对需要处理的信号进行多层分解，然后通过小波变换，得到小波变换的系数。 b) 阈值过程：根据公式计算小波阈值，得到小波阈值后再选择合适的阈值对分解后的各层系数进行降噪处理。 c) 重构过程：对降噪处理后的结果进行小波逆变换，将去噪后的信号进行恢复。 小波阈值去噪包括小波函数的选取、阈值的确定、分解层数的确定和去噪效果评价。关于小波函数的选取，当被检测的信号的震荡频率与相应的尺度函数的小波震荡频率接近时，信号获取了较大系数的小波分解，通过这种手段就可以利用小波分析将多尺度信号中的不同频率提取。可以采取熵值来度量信号和小波基之间的距离，距离越小或者是熵值越小信号则它们之间的差别越小，信号获取的分解越大。阈值选取有软阈值和硬阈值法，相比而言，用硬阈值处理后的信号比用软阈值处理后的信号显得更为粗糙 [ 7 ] 。"
"关于如何评价去噪的效果，传统的评价指标有均方根误差(RMSE)、信噪比(SNR)、平滑度(r)以及相关系数(R) [ 8 ] [ 9 ] [ 10 ] [ 11 ] 。设原始信号为 x ( i ) ，去噪后信号为 x ˜ ( i ) ，n为信号数量，则各评价指标算式如下。 1) 均方根误差 均方根误差(RMSE)主要是体现了去噪信号与原始信号之间的偏差程度，均方根误差RMSE的计算公式为： RMSE = ( x ( i ) − x ˜ ( i ) ) 2 n (1) 均方根误差值越小，偏差度就越小，去噪效果越好。 2) 信噪比 信噪比(SNR)主要是体现噪声信号在整体信号中的比重，是原始信号能力与噪声能力的比值，其计算公式为： SNR = 10 lg [ ∑ i = 1 n x ( i ) 2 ∑ i = 1 n ( x ( i ) − x ˜ ( i ) ) 2 ] (2) 其值越大说明去噪效果越好。 3) 平滑度 平滑度(r)主要是表述了信号是否有局部的突变，计算公式为： r = ∑ i = 1 n − 1 [ x ˜ ( i + 1 ) − x ˜ ( i ) ] 2 ∑ i = 1 n − 1 [ x ( i + 1 ) − x ( i ) ] 2 (3) 平滑度越小，信号越光滑，去噪效果越好。 4) 相关系数 相关系数(R)主要是体现去噪后信号与原始信号的相似度,相关系数的计算公式为： R = ∑ i = 1 n ( x ( i ) − x ( i ) ¯ ) ( x ˜ ( i ) − x ˜ ( i ) ¯ ) ∑ i = 1 n ( x ( i ) − x ( i ) ¯ ) 2 ⋅ ∑ i = 1 n ( x ˜ ( i ) − x ˜ ( i ) ¯ ) 2 (4) 相关系数越接近1，说明去噪后所得到的信号与原始信号拟合的越好，去噪效果越好。 以有大量文献对如何选取去噪指标进行研究。文献 [ 8 ] 等综合分析以上四个指标，并将其归化到[0, 1]得到总体评价指标，出现最大值时认为去噪效果最优。文献 [ 9 ] 借助最小均方根误差、信噪比及光滑度变化随小波分解尺度增加的收敛特性，提出了一种多指标融合的小波去噪最佳分解尺度选择方法。文献 [ 10 ] 针对传统评价指标应用于小波去噪质量评价的局限性，提出了一种复合评价指标。文献 [ 11 ] 论述了基于均方根误差变化率的方法、基于总体评价指标的综合法、多指标融合法及复合指标法，得出结论多指标融合法只能确定小波分解尺度的大致范围，基于总体的评价指标和复合评价指标可以准确判定小波分解层数。本文实验中，我们参考文献 [ 11 ] 提出的评价指标进行分解层数的确定及效果评价，选取db4小波函数，采用软阈值去噪方法进行去噪。"
"采用中值滤波、小波阈值去噪，对基线N,E,U三个方向进行去噪，去噪结果如图5所示(限篇幅，图5仅列出东方向)。 由图5可知，中值滤波去噪结果在边界处比较粗糙，相对而言，小波阈值去噪结果更为平滑。各方向不同滤波方法的评价指标如表1~表3所示。 图5. 去噪结果对比 Table 1 中值滤波 小波阈值去噪 RMSE (mm) 2.9 2.8 SNR 68.9 69.2 r 0.0056 0.0013 表1. 两种方法滤波结果(东方向) Table 2 中值滤波 小波阈值去噪 RMSE (mm) 4.9 4.8 SNR 37.9 38.2 r 0.0054 0.0009 表2. 两种方法滤波结果(北方向) Table 3 中值滤波 小波阈值去噪 RMSE (mm) 13.5 13.1 SNR 21.5 21.7 r 0.0056 0.0008 表3. 两种方法滤波结果(高程方向) 由表1~表3可知，采用两种去噪方法去噪后计算的均方根误差都比较接近。东方向RMSE在2.8~2.9 mm之间，SNR在68~70之间；北方向RMSE在4.8~4.9 mm之间，SNR在37~39之间；高程方向RMSE在13.1~13.5 mm之间，SNR在21~22之间，说明两种方法都可以较好地去除随机噪声。从平滑度方面分析，小波消噪结果平滑度更小，平滑度是表述了信号是否有局部的突变，平滑度越小，信号越光滑，去噪效果越好。"
"实验表明，滤去的高频噪音符合偶然误差的四个特性，可归类为偶然误差，通过滤波等方法，可以从北斗单历元时间序列中较好地移除。中值滤波效果取决于所选取的滤波窗口大小，窗口的大小通常由经验确定，难以实现对去噪结果的最优化。小波具有多分辨率的特性，去噪效果与所选的小波函数、分解层数、阈值方法有较大关系。通过选择合适的小波基函数、分解层数、阈值方法，可以获得更优的去噪结果。"
