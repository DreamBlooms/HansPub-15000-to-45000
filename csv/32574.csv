"随着钢铁行业中高附加值钢种产量的不断提高，如何通过过程控制模型，在线优化控制投入合金种类及数量，在保证钢水质量的同时最大限度地降低合金钢的生产成本是各大钢铁企业提高竞争力所要解决的重要问题。首先进行数据预处理，利用距离反比加权算法和拉依达准则对数据插补和剔除，得出计算合金元素收得率的公式，计算出C收得率为80%~100%，Mn的收得率为85%~100%；对七个自变量进行灰色关联度分析，得出影响C、Mn收得率主要影响因素为转炉终点温度和转炉终点C。建立合金最小成本控制模型，求解得到1吨HRB400B的钢产品最低成本为18359.81元，最优配料方案为：2.121988吨的锰硅合金FeMn68Si18 (合格块)、0.1708846吨的硅铁(合格块)和0.01吨的硅钙碳脱氧剂。 关键词 :收得率，线性规划，灰色关联度，距离反比加权，拉依达准则 Copyright © 2019 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着计算机技术的发展，国外早已研究出以合金收得率预测及成本优化算法为主体的自动配料模型，该模型可实现自动脱氧合金化的目的。目前，国内部分车间引进这一技术并成功应用于生产，但总体上，与国际先进国家相比仍有较大差距。对于不同的钢种在熔炼结束时，需加入不同量不同种类的合金，以使其所含合金元素达标，最终使得成品钢在某些物理性能上达到特定要求。 首先进行数据预处理，利用距离反比加权算法和拉依达准则对数据插补和剔除；通过查阅文献，得出计算合金元素收得率的公式，计算出C收得率为80%~100%，Mn的收得率为85%~100%；然后，将不同变量数据归一化，对炉终点温度、转炉终点C、转炉终点Mn、炉终点S、转炉终点P、转炉终点Si、钢水净重七个自变量做主成分因子进行分析；最后，根据求得的相关性矩阵得出影响C、Mn收得率主要影响因素为转炉终点温度和转炉终点C。首先对大量数据进行预处理，在计算出收得率后，通过建立线性规划模型，使钢水脱氧合金化成本达到最低，并给出合金配料方案。选择线性规划作为计算合金投放量的关键算法，以最低成本作为目标函数，14种合金投入量作为自变量；然后根据国家标准的内控区间列出约束条件，求解得到1吨HRB400B的钢产品的最低成本，并得出最优配料方案 [ 1 ]。"
"在钢水脱氧合金化过程中，脱氧是为了将氧含量脱除到钢种要求的范围之内，减少钢中非金属杂质含量，排除脱氧产物，并改善钢中非金属杂质的分布形态。合金化就是在出钢过程中，向钢水中加入一种或几种合金元素，使其达到成品钢的要求 [ 2 ]。事实上，一般来说脱氧和合金化是同时进行的，因为加入的合金种类冗杂，必须考虑每种合金钢带进的合金元素。 钢号为HRB400B的合金元素含量的国家标准值，并且合金钢号为HRB400B在表格中所占比例超过90%，因此，首先通过初步筛选，确定本文的研究对象就为钢号为HRB400B的合金；接着利用SPSS对各个变量的数据进行描述统计，发现数据组均接近于正态分布；由于附件所提供的数据有异常值和缺失值，根据距离反比加权算法对缺失值进行插补，并借助MATLAB软件首先建立3σ模型，将异常值剔除。 制作的思维导图如图1： 图1. 数据预处理思路图  距离反比加权插值算法：将未知点值表示为其周围已知点的加权值之和，权系数与到各已知点的距离成反比，算法简单、效率高，但容易在极点处出现“牛眼”现象。 采用距离反比加权插值法对缺失值进行填补，更大程度上保留了各变量的特性，具体计算过程如下： 设每组数据之间的距离为1，权重计算公式如下： W i = h i − 1 ∑ j = 1 n h j − 1 (1) 距离计算公式： h i = ( x − x i ) 2 (2) 填充计算公式： Z 填 充 = ∑ i = 1 n z i ω i (3)  拉依达准则指的是先假设检测数据只含有随机误差，对其计算得到标准差，按一定概率确定一个区间，超过这一区间的误差，就属于粗大误差，即异常数据，应当被剔除。它是处理异常数据用的次数最多的方法，特别地，当测量数据次数越多，可靠性越强。使用这一准则的前提条件所处理的样本数据服从或近似正态分布。 利用SPSS对附件一的数据以转炉温度为例进行描述统计，结果恰好是数据近似为正态分布，所以针对本题拉依达准则适用。计算原理： 若测量值与平均值之差大于标准差的3倍，则予以剔除。 | x i − x ¯ | > 3 S x (4) 式中， x ¯ = 1 n ∑ i = 1 n x i 为样本均值， S x = [ 1 n − 1 ∑ i = 1 n ( x i − x ¯ ) 2 ] 1 2 为样本标准偏差。 最终得出转炉温度中有72组异常数据，予以剔除。通过采用拉依达准则以及距离反比加权插值法在很大程度上确保了数据信息的完整性。"
"所得合金收得率是指脱氧合金化时被钢水吸收的合金元素的重量与加入该元素总重量之比。因此，整理得到元素收得率的计算公式如下： y i = T i × G i − ( G i + ∑ j = 1 17 M j ) × Q i ∑ j = 1 17 M j × ω i (5) 式中，y i 为i元素所对应的收得率， i = C , Mn ，钢水净重G i ，连铸正样T i ，某种合金质量M j ，j代表为某种合金，某种合金中含元素 [ 3 ] 的比例w i 。 根据计算合金元素收得率的公式，分别计算出每个炉号对应的C、Mn两种元素的历史收得率，提取出在(0,1)间的收得率，如下图2： 图2. 原始C收得率的分布图 在转炉过程中连铸正样是在转炉后测出的，对收得率没有影响，除去对收得率无影响的变量后，可得出收得率大致分布在区间(0.8,1)中，如下图3~5： 图3. 除去噪声后C收得率的分布图 图4. 原始Mn收得率的分布图 图5. 除去噪声后Mn收得率的分布图"
"灰色关联分析是指对一个系统发展变化态势的定量描述和比较的方法，其基本思想是通过确定参考数据列和若干个比较数据列的几何形状相似程度来判断其联系是否紧密，它反映了曲线间的关联程度 [ 4 ]。通常可以运用此方法来分析各个因素对于结果的影响程度，也可以运用此方法解决随时间变化的综合评价类问题，其核心是按照一定规则确立随时间变化的参考序列，把各个评估对象随时间的变化作为比较序列，求各个比较序列与参考序列的相关程度，依照相关性大小得出结论。 灰色关联分析的具体计算步骤如下 Step1：确定分析数列； 确定反映系统行为特征的参考数列和影响系统行为的比较数列。反映系统行为特征 的数据序列，称为参考数列。影响系统行为的因素组成的数据序列，称为比较数列。 参考数列为 Y = Y ( k ) k = 1 , 2 , ⋯ , n (6) 比较数列为 X i = X i ( k ) k = 1 , 2 , ⋯ , n ;   i = 1 , 2 , ⋯ , m (7) Step2：变量的无量纲化； 由于系统中各因素列中的数据可能因量纲不同，不便于比较或在比较时难以得到正确的结论。因此在进行灰色关联度分析时，一般都要进行数据的无量纲化处理。主要有 以下两种方法： 初值化处理： x i ( k ) = x i ( k ) x i ( 1 ) , k = 1 , 2 , ⋯ , n ;   i = 0 , 1 , 2 , ⋯ , m (8) 均值化处理： x i ( k ) = x i ( k ) x i ¯ , k = 1 , 2 , ⋯ , n ;   i = 0 , 1 , 2 , ⋯ , m (9) 其中k对应时间段，i对应比较数列中的一行。 Step3：计算关联系数； ξ i ( k ) = min i min k | y ( k ) − x i ( k ) | + ρ max i max k | y ( k ) − x i ( k ) | y ( k ) − x i ( k ) + ρ max i max k | y ( k ) − x i ( k ) | (10) 其中𝜌称为分辨系数，𝜌越小，分辨力越大，一般𝜌的取值区间为(0,1)具体取值可视情况而定。当 ρ ≤ 0.5463 时，分辨力最好，通常取 ρ = 0.5 。 Step4：计算关联度； 因为关联系数是比较数列与参考数列在各个时刻(即曲线中的各点)的关联程度值，所以它的数不止一个，而信息过于分散不便于进行整体性比较。因此有必要将各个时刻(即曲线中的各点)的关联系数集中为一个值，即求其平均值，作为比较数列与参考数列间关联程度的数量表示，关联度 r i 公式如下。 r i = 1 n ∑ k = 1 n ξ i ( k ) , k = 1 , 2 , ⋯ , n (11) Step5：关联度排序； 关联度按大小排序，如果 r 1 < r 2 ，则参考数列 y 与比较数列 x 2 更相似。在算出 X i ( k ) 序列与 Y ( k ) 序列的关联系数后，计算各类关联系数的平均值，平均值 r i 就称为 X i ( k ) 与 Y ( k ) 的关联度。 Step6：归一化处理 因为不同变量间是异量纲的，数值相差也悬殊，直接将它们进行加权平均不合适，并且无实际意义。为了尽可能反映实际情况，避免不合理现象发生，首先对各变量数据进行归一化处理。 z = x i − x ¯ s (12) 其中 x i 代表所选变量的具体数值， x ¯ 代表变量的均值，s代表变量的标准差。  首先依据对元素收得率的计算，在之前数据筛选的基础上，再剔除合金收得率大于1或者小于0.8的数据，并将各项数据按照钢号分类，共得151组数据。 根据上述灰色关联分析的方法，本文将有效数据中不同钢号数据分类讨论，以低合金HRB400B钢材为例，C元 Y C = Y ( k ) k = 1 , 2 , ⋯ , n , n = 128 素的收得率设为参考数列 Y Mn = Y ( k ) k = 1 , 2 , ⋯ , n , n = 128 ，Mn元素的收得率设为参考数列，将可能存在的影响因素均设置为比较数列，分别为 X i = X i ( k ) k = 1 , 2 , ⋯ , 128 ; i = 1 , 2 , ⋯ , 14 , i 1 ∼ i 14 ，分别表示转炉终点温度、转炉终点C、转炉终点Mn、转炉终点S、转炉终点P、转炉终点Si、钢水净重、钒氮合金(进口)、钒铁(FeV50-B)、硅铝钙、硅锰面、石油焦增碳剂、锰硅合金FeMn68Si18 (合格块)、碳化硅(55%)等 [ 5 ]。 对14种因素分别对C和Mn做灰色关联度分析，结果如下表1所示： Table 1 r (与C的收得率) r (与Mn的收得率) 转炉终点温度 0.975855059 0.970844789 转炉终点C 0.948269124 0.954705014 转炉终点S 0.884526696 0.800424359 转炉终点Si 0.873163541 0.869426469 钢水净重 0.898097845 0.874232018 钒铁(FeV50-B) 0.828030168 0.817617746 石油焦增碳剂 0.890447768 0.884053679 锰硅合金FeMn68Si18 0.881100762 0.873518067 碳化硅(55%) 0.741870742 0.730074774 转炉终点Mn 0.772499312 0.763513281 转炉终点P 0.588711594 0.583262979 钒氮合金(进口) 0.720169022 0.732644545 硅铝钙 0.723865033 0.716167699 硅锰面 0.735236217 0.734989288 表1. 钢号HRB400B各项因素与收得率的灰色关联度 由上表可看出：转炉终点温度，转炉终点C，钢水净重，锰硅合金FeMn68Si18，转炉终点S，转炉终点Si，钒铁(FeV50-B)，石油焦增碳剂等八大因素对收得率影响力度很大，其中转炉终点温度，转炉终点C对收得率的影响最大，这一现象直接反映出这两个变量同时对C、Mn收得率影响最大，因而可以得出影响C、Mn收得率主要影响因素为转炉终点温度和转炉终点C。"
"在脱氧合金化过程中合金元素损失的途径有：主要为元素被钢水中的氧化物氧化以及元素残留在钢渣中而没有进入钢水。影响合金氧化程度的因素有很多，在在合金化过程中，最重要的因素为：钢液氧活度、渣中不稳定氧化物活度、钢渣碱度、吹氩搅拌强度、钢水温度以及钢水质量 [ 6 ]。 由于合金收得率的预报先于合金化过程，在进行预报时，除了钢水质量，其它的影响因素值都是未知的。合金化时各影响因素的初始值对整个合金化过程有较大的影响，在规范化的冶炼操作的情况下，可以通过影响因素的初始值估计合金化过程中的影响因素水平 [ 7 ]。 在生产中，初始的影响因素数值往往也不能通过检测手段直接获得。因此，由于检测以及生产流程的限制，即使确定了收得率影响因素，也不可能使用这些影响因素对收得率进行估计，而只能通过可测的变量与影响因素问的关系，使用可测变量间接地反映收得率的水平。 虽然在进行收得率预报时，不能及时获得各个影响因素的数值，但是可以使用可测变量间接估计各个影响因素的水平。进而分析元素收得率的各个影响因素与可测变量之间的关系 [ 8 ]。"
"1) 目标函数 钢号HRB400B为一种热轧带肋钢筋，主要合金元素含量的国家标准为(表2)： Table 2 钢号 标准 元素含量(%) C Si Mn P S HRB400B 内控区间 0.19~0.25 0.50~0.65 1.30~1.60 ≤0.045 ≤0.045 目标值 0.23 0.55 1.45 0.04 0.04 表2. 各合金元素国家标准含量 设在炼制1吨HRB400B钢水时需要加入的各合金的量如下表3： Table 3 合金种类 量 合金种类 量 合金种类 量 低铝硅铁 x 1 钒铁(FeV50-A) x 2 钒铁(FeV50-B) x 3 硅铝钙 x 4 硅铝合金FeAl30Si25 x 5 硅铝锰合金球 x 6 硅锰面(硅锰渣) x 7 硅铁(合格块) x 8 硅铁FeSi75-B x 9 石油焦增碳剂 x 10 锰硅合金 FeMn64Si27 (合格块) x 11 锰硅合金 FeMn68Si18 (合格块) x 12 碳化硅(55%) x 13 硅钙碳脱氧剂 x 14 表3. 炼制1吨钢水需要的合金 所以自变量矩阵为 X = ( x 1 , x 2 , x 3 , x 4 , x 5 , x 6 , x 7 , x 8 , x 9 , x 10 , x 11 , x 12 , x 13 , x 14 ) 由表可得合金价格矩阵 A = ( 6500 , 205000 , 205000 , 11800 , 1000 , 8500 , 7600 , 6000 , 6000 , 4600 , 8150 , 8150 , 6100 , 4000 ) 合金总成本目标函数即为 Z = A X ′ (13) 2) 约束条件 由问题二求得C收得率的预测值为0.9225，Mn收得率的预测值为0.9227。通过查阅文献得1吨HRB400B钢水中某合金元素的含量计算公式为 [ 9 ] ： 合 金 元 素 i 量 = 目 标 出 钢 含 量 i − 吹 止 成 分 i 合 金 i 收 得 率 (14) 由问题附件二，1吨HRB400B钢水中五种元素有一定的波动区间，在除以各元素的收得率后得到实际需要加入的元素质量的区间变为(表4)： Table 4 标准 元素含量（%） C Si Mn P S 修正内控区间 0.206~0.271 0.5~0.65 1.409~1.734 ≤0.045 ≤0.045 表4. 加入的元素质量的区间 所以线性规划模型约束条件为 { 0.206 < ( 0 , 0.0031 , 0.0031 , 0 , 0.00374 , 0 , 0.017 , 0.0006 , 0.0006 , 0.96 , 0.017 , 0.017 , 0.3 , 0.225692308 ) X ′ < 0.271 0.5 < ( 0.74 , 0.012 , 0.012 , 0.341 , 0.285 , 0.3 , 0.072 , 0.767 , 0.767 , 0 , 0.172 , 0.172 , 0.56 , 0.392 ) X ′ < 0.65 1.409 < ( 0 , 0 , 0 , 0 , 0 , 0.3 , 0.664 , 0 , 0 , 0 , 0.664 , 0.664 , 0 , 0 ) X ′ < 1.734 0 < ( 0 , 0.0006 , 0.0006 , 0 , 0 , 0 , 0.0018 , 0.0004 , 0.0004 , 0 , 0.0018 , 0 , 0 ) X ′ ≤ 0.045 0 < ( 0 , 0.0002 , 0.0002 , 0 , 0 , 0 , 0.0002 , 0.0002 , 0.0002 , 0 , 0.0002 , 0.0002 , 0.0001 ) X ′ ≤ 0.045 运用Lingo求解得到结果为最低成本为18359.81元。其中矩阵X解得(表5)： Table 5 x 1 0.000000 x 5 0.000000 x 9 0.000000 x 13 0.000000 x 2 0.000000 x 6 0.000000 x 10 0.000000 x 14 0.01 x 3 0.000000 x 7 0.000000 x 11 0.000000 x 4 0.000000 x 8 0.1708846 x 12 2.121988 表5. 各种合金用量"
"钢水脱氧合金化主要关注C、Mn、S、P、Si五种元素的含量，问题旨在根据附件1计算C、Mn两种元素的收得率，并分析影响其收得率的主要因素。 首先进行数据预处理，利用距离反比加权算法和拉依达准则对数据插补和剔除；通过查阅文献，得出计算合金元素收得率的公式，计算出C、Mn的收得率；然后，将不同变量数据归一化，对炉终点温度、转炉终点C、转炉终点Mn、炉终点S、转炉终点P、转炉终点Si、钢水净重七个自变量做主成分因子进行分析；根据求得的相关性矩阵得出影响C、Mn收得率主要影响因素 [ 10 ]。 选择线性规划作为计算合金投放量的关键算法，以最低成本作为目标函数，14种合金投入量作为自变量；然后结合附件1所提供的内控区间列出约束条件，求解得到1吨HRB400B的钢产品的最低成本，并得出最优配料方案。 制成1吨HRB400B的钢产品最低成本为18359.81元，最优配料方案为：2.121988吨的锰硅合金FeMn68Si18 (合格块)、0.1708846吨的硅铁(合格块)和0.01吨的硅钙碳脱氧剂。"
