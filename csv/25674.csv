"依托嵌入式计算机系统及自动控制技术，潜油柱塞泵在油田原油生产过程中得到大范围普及应用，这极大地提高了原油的开采效率。潜油柱塞泵的核心是位于井下的潜油直线电机，地面通过计算机控制井下电机的冲次、冲程等运行状态，使其与油井油藏状态相适应，从而在原油生产过程中达到高效、节能的目的。目前潜油柱塞泵的冲次控制方法是建立在动液面时间序列预测和计算的基础上的，本文介绍一种基于混沌时间序列的动液面预测计算方法，并与线性预测方法进行对比分析，最终得到能够满足潜油柱塞泵冲次优化控制的动液面预测方法。本文的研究内容为潜油柱塞泵的计算机控制提供了理论和应用依据。 关键词 :潜油柱塞泵，嵌入式计算机系统，混沌时间序列，动液面预测 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着嵌入式计算机系统性能的大幅提升，依托自动控制理论和技术，各种新型油田抽油机高效、节能的智能化运行得以实现。这其中较为突出的高能效抽油机潜油柱塞泵，以其结构简单、容易操控等特性引发业内广泛关注，并在国内部分油田成规模应用生产 [ 1 ] 。 为进一步发挥潜油柱塞泵的优势，提高其在实际应用中的产油量，需要对其自动控制性能进行改进，其中最为重要的是对其冲次控制方法的优化。而若想得到较好的冲次优化效果，需要研究一种准确度较高的动液面预测方法，只有准确预测得到动液面高度数据或变化趋势，才能有针对性地采用冲次优化算法提高原油产量并降低开采机械的能耗。因此，本文的研究内容是潜油柱塞泵计算机控制优化的前提和基础，具有重要的理论和应用价值 [ 2 ] 。"
"潜油柱塞泵是一种以直线电机为驱动的新型抽油机，其结构如图1所示。潜油柱塞泵主要由井下和地面两部分组成，井下部分主要包括直线电机、抽油泵和潜油电缆等，地面部分主要是直线电机的控制装置和配电装置等。其最大的特点是，省略了传统抽油机的抽油杆，因此避免了油杆与油管的偏磨问题，而且不存在将旋转运动转换为直线运动的转换设备，可以有效而直接的利用直线电机产生的动能，因此大幅度提高了机采效率。 潜油柱塞泵的直线电机定子固定在油井底部，动子通过推杆直接与抽油泵的游动凡尔相连，抽油泵与油管相连，直线电机通过潜油电缆与地面控制及配电系统相连。潜油柱塞泵工作时，直线电机由地面控制柜内的嵌入式计算机通过潜油电缆控制，直线电机动子做往复运动，带动游动凡尔，不断将套管内 图1. 潜油往复抽油机结构示意图 液体吸入泵腔内，并将其通过油管举升至地面井口处。目前常用的潜油柱塞泵直线电机为永磁直线电机，外径110 mm、长6 m，额定电压660 V、最大输出电流50 A、最大输出功率30 KW、额定推力24,000 N、最大推力35,000 N、动子行程123 cm，其冲次可由地面控制系统设定。 随着潜油柱塞泵应用的增多，逐渐发现其在实际使用直线电机工作状态需要与油井汲液能力相匹配才能使采油效率最高，或者说嵌入式计算机控制潜油柱塞泵的冲次状态需要与井下动液面的高度相匹配，才能使抽油机械的效率最佳 [ 3 ] [ 4 ] 。"
"本文研究的潜油柱塞泵主要应用在油田开发中后期的油井或贫油井，并且有注水井配合工作。相比其他油井，这类油井的动液面是十分不稳定的，主要受到柱塞泵自身工作状态、地下油流状态及注水井状态等因素影响。有必要对潜油往复抽油机油井的动液面时间序列进行分析，以揭示其特性 [ 5 ] 。  本文对大庆油田采油厂的14口使用潜油往复抽油机的油井进行了跟踪测试，在一段时间内，所在作业区每日对油井动液面测量一次，采样时做多次测量取平均值处理。其中动液面使用超声波测距仪进行测量，记录为当日动液面测量值。通过对十余口潜油往复抽油机的测试分析，由于周围环境相对复杂，可能存在多口其他油井或注水井等，这些外在因素的影响加上泵自身状态的变化，动液面变化的周期性不明显。以葡54-12井为例，井深1202.6 m，图2和给出其动液面的变化数据。  动液面预测需要完整、丰富和准确的时间序列样本。由于实际生产过程中，动液面原始数据经常会出现不连续，并间杂很多异常值，如果直接利用这样的原始数据进行动液面预测，会降低预测的可信性和准确度。因此，需要首先对原始数据进行预处理，对异常数据、不良数据进行剔除并补足缺损数据是 图2. 葡54-12井动液面变化 进行准确、合理动液面预测的前提和基础。处理这些异常数据，首先需要找到这类数据，即数据筛选，主要的处理对象是非空缺类数据，经常采用的方法是分段阈值筛选法。针对时间序列的变化特点，将其划分为若干区段，对不同区段内的动液面变化设定上限阈值和下限阈值，利用阈值对区间内数据进行筛选，然后在通过修正方法对这些异常数据进行修正和补全 [ 6 ] [ 7 ] [ 8 ] 。 根据空缺异常数据的种类，其补全的方法主要有两种。一种是缺失值的补全，另一种是待补足数据的补全。对于非空缺类异常数据，处理方法相对较多，主要有：1) 插值法、2) 纵向对比法、3) 横向对比法、4) 经验修正法、5) 概率统计法、6) 曲线置换法等。按照非空缺类异常数据的种类，其处理方式主要是：含有冲击类的数据可采用4)、5)、6)等方法；毛刺类原始数据可采用1)、4)等方法；极值类数据可以采用2)、3)、4)、5)等方法进行处理。   关联维数法是识别混沌序列比较常用的方法。如果一个序列是随机序列，随着嵌入维数的增大，关联维数也会相应增大，不会进入饱和状态。如果一个序列的关联维数逐渐进入到饱和状态，则说明这个序列具有混沌特性。可用G-P算法计算其饱和关联维数，图3给出了葡54-12井动液面时间序列的 ln C ( r ) - ln ( r ) ， C ( r ) 是相关函数，r是 Y i 为球面中心的半径， ln C ( r ) - ln ( r ) 曲线上直线段斜率就是关联维数 [ 9 ] [ 10 ] 。  Lyapunov指数是一个定量描述混沌运动对初始条件敏感度的量。混沌运动具有对其初始条件极为敏感的特征，即便轨道是由非常靠近的初始值形成的，也会随着时间快速分离。 如果用 x n + 1 = F ( x n ) 表示一个系统，那么 | d F / d x | 的取值决定了最初的两点迭代之后是互相聚合还是互相发散。如果 | d F / d x | > 1 ，那么经过迭代，它们互相发散。如果 | d F / d x | < 1 ，那么经过迭代，它们互相聚合。在迭代的进程里， | d F / d x | 取值不是确定的，这表明它们运动的趋势也是处于不断变化的状态之中。通过将迭代次数进行平均化处理，可以在一定的时间范畴之内观察相邻状态是聚合还是发散。所以，设 λ 是平均迭代所引起的发散程度中的指数。容易得到，n次迭代后，原距离为 ε 的两点此时距离为： 图3. 动液面时间序列 ln C ( r ) - ln ( r ) 曲线 ε e n λ ( x 0 ) = | F n ( x 0 + ε ) − F n ( x 0 ) | (1) 取极限 ε → 0 ， n → ∞ ，则式(1)为： λ ( x 0 ) = lim n → ∞ lim ε → 0 1 n ln | F n ( x 0 + ε ) − F n ( x 0 ) ε | = lim n → ∞ 1 n ln | d F n ( x ) d x | x = x 0 (2) 经过简化计算得到： λ = lim n → ∞ 1 n ∑ i = 0 n − 1 ln | d F n ( x i ) d x | x = x i (3) 式(3)中， λ 为原动力系统的Lyapunov指数，其取值与选择初始值无关，表征了系统经过多次迭代后，平均每次迭代引起指数分离中的指数 [ 11 ] 。 如果 λ < 0 ，则系统具有稳定的不动点；如果 λ = 0 ，则对应了系统的周期解或者分岔点；如果 λ > 0 ，则说明系统具有混沌特征。 本文采用小数据量方法取动液面时间序列的最大Lyapunov指数。表1分别给出了演化次数为50、100、150、200、250、300时，潜油往复抽油机油井动液面时间序列的最大Lyapunov指数，图4和图5分别给出了演化次数为100和300时 y ( i ) 的变化趋势。观察表1、图4和图5能够看出，两油井动液面时间序列的最大Lyapunov指数均为正数，证明了两个时间序列都具有混沌性的判断。同时，可以观察到多数时间内，A油井的动液面时间序列的最大Lyapunov指数明显大于B油井的最大Lyapunov指数，并且其随演化次数的增加波动较大，B油井动液面时间序列的最大Lyapunov指数则相对稳定。  一个系统演化的非确定性和随机性可以形象地称之为蝴蝶效应。最大Lyapunov指数可以表征一个系统的这种蝴蝶效应的程度。它定量地描述了一个相空间中两个相邻轨迹的发散情况。混沌系统本质上是遵循某一确定性的规律的，这也说明混沌系统存在一个最大可预测时间的。要对一个混沌系统的运行轨迹进行预测，需要确定其预测时间在这个尺度之内，才能保证预测的有效性 [ 12 ] [ 13 ] 。 在系统运行的过程中，两相邻轨道距离的初始值为 δ x ( 0 ) ，经过一段时间的演化后，它们之间的最大距离分量可以表示为： δ x ( t ) = δ x ( 0 ) e λ 1 t (4) t为演化时间，当 δ x ( t ) δ x ( 0 ) 超出某个阈值c的时候，我们就认为轨道发散。这时的系统运动是不可预测的，而演化过程中的这个时间称为临界点时间 t 0 。则： c = δ x ( t ) δ x ( 0 ) = e λ 1 t 0 (5) t 0 = 1 λ 1 ln c (6) Table 1 演化步数i A井动液面时间序列 最大Lyapunov指数 B井动液面时间序列 最大Lyapunov指数 50 0.1043 0.0411 100 0.1153 0.0319 150 0.1308 0.0352 200 0.1305 0.0351 250 0.1481 0.0457 300 0.2318 0.0453 表1. 动液面时间序列的最大Lyapunov指数 图4. 动液面时间序列的最大Lyapunov指数(i = 100) 图5. 动液面时间序列的最大Lyapunov指数(i = 300) 一般情况下，当轨线间距达到原来距离的几倍或者十几倍 ( c ~ 10 , ln c ~ 1 ) 的时候，轨迹就难以确定了。因此，混沌系统的最大可预测时间简化表示为： t 0 ~ 1 λ 1 (7) 式(7)中的 t 0 为Lyapunov时间，也就是可预测的最大时间。一般情况下，最大Lyapunov指数愈大，可预测最大时间 t 0 响应的愈短，这种情况说明此系统的预测性比较差。因此，根据上一节中求得的最大Lyapunov指数，可以预估出动液面时间序列的一个可预测最大时间： 1) A井动液面时间序列的可预测最大时间 t 0 为1/0.1305~1/0.2318。所以，A井的动液面序列可预测最大时间大概为4天。 2) B井动液面时间序列的可预测最大时间 t 0 为1/0.0457~1/0.319。所以，B井的动液面序列可预测最大时间大概是31天。"
"时间序列分析中，ARMA是最常用的模型之一，它有很好的逼近平稳过程的能力。ARMA模型采用如下描述定义：如果时间序列 { X t , t = 0 , ± 1 , ⋯ } 对于每个t，期望 E ( X t 2 ) < ∞ ，且 E ( X t ) 是与t无关的常数，对于每个k，协方差 Cov ( X t , X t + k ) 与t无关，则序列 { X t } 称为平稳的。ARMA模型的建模方法同一般时间序列建模步骤类似，采用Box-Jenkins方法，这种建模只遵循序列自身的变化规律，采用外推的方式来表现时间序列的变化。建模的过程主要分为三个步骤：1) 时间序列平稳性检验；2) 模型的识别、参数估计及诊断检验；3) 模型的预测。 在实际的模型建立过程中，大多数序列都能用低阶模型取得较好的拟合效果，阶数p，q，P和Q的值通常取作0，1或2。为得到更好的拟合结果，可以将阶数 ( p , q ) × ( P , Q ) 的选择范围确定在一个区间 1 ≤ p + q ≤ λ 1 ， 1 ≤ P + Q ≤ λ 2 ，在该区间中拟合尽可能多的模型，根据BIC准则(Bayesian Information Criterion)选取拟和优度统计量最优的模型。 BIC = − 2 ln ( L ) + ( p + q + 1 ) ln ( n ) (8) 式中：L——一步预测时模型的高斯似然数； n——一步预测时的残差个数。 采用极大似然估计的方法求取模型中的参数，通过似然函数： L ( x 1 , x 2 , ⋯ , x n , θ ) = f ( x 1 , θ ) f ( x 2 , θ ) ⋯ f ( x n , θ ) (9) 选取 θ = θ ^ ，使得： L ( x 1 , x 2 , ⋯ , x n , θ ^ ) = max θ ∈ Θ { f ( x 1 , θ ) f ( x 2 , θ ) ⋯ f ( x n , θ ) } (10) 则 θ ^ = g ( x 1 , x 2 , ⋯ , x n ) 就是 θ 的极大似然估计值。 根据BIC准则，由公式(8)、公式(9)和公式(10)建立油井的动液面时间序列的ARMA模型。 BIC最小值为7.6484，对应各参量， p = 6 ， q = 4 ， ϕ 1 = − 0 .7464 ， ϕ 2 = − 0 .3726 ， ϕ 3 = − 0 .4819 ， ϕ 4 = − 1 .032 ， ϕ 5 = − 0 .2172 ， ϕ 6 = 0 .04302 ， θ 1 = 0 .499 ， θ 2 = 0 .215 ， θ 3 = 0 .3904 ， θ 4 = 0 .9314 ，不计白噪声项，油井动液面ARMA模型： X t = − 0 .7464 X t − 1 − 0 .3726 X t − 2 − 0 .4819 X t − 3 − 1 .032 X t − 4 − 0 .2172 X t − 5     + 0 .04302 X t − 6 + 0 .499 ε t − 1 + 0 .215 ε t − 2 + 0 .3904 ε t − 3 + 0 .9314 ε t − 4 (11) 以第301天到第360天的动液面数据为对象，利用式(11)确定的模型，对其进行预测，其预测误差如图6所示。 由图6可以看出，使用ARMA法进行动液面的线性预测，其预测误差在 60 米 左右。虽然这种方法的预测值也能大体上跟随动液面时间变化的趋势，并且模型相对简单，计算方便，但是其预测误差还是较大的。  Lyapunov指数是一个描述系统轨道指数发散程度的量化值，正是这个特性使它成为混沌时间序列的重要预测参数。令 Y m 表示预测的中心点。在构造的相空间中， Y k 是 Y m 的最近邻点，这个距离记为 d m ( 0 ) ， λ 1 为最大Lyapunov指数，则有： { d m ( 0 ) = min j ‖ Y m − Y j ‖ = ‖ Y m − Y k ‖ ‖ Y m − Y m + 1 ‖ = ‖ Y k − Y k + 1 ‖ e λ 1 (12) 其中， Y j 为 Y m 的邻点，并且点 Y m + 1 中唯一未知的 x ( t m + 1 + ( m − 1 ) τ ) 为最后一个分量。因此， x ( t m + 1 + ( m − 1 ) τ ) 是可以预测的，可以按式(12)来进行最大Lyapunov指数预测。 已经证明动液面时间序列具有混沌特性，因此可以使用混沌时间序列预测的方法对其进行预测。以油井的动液面历史数据作为研究对象，数据采集期为一年，每天对动液面高度进行一次测量。将测量得到的全部动液面数据分成两部分，第一部分用来构造训练样本集，以建立一个最大Lyapunov指数预测模型；第二部分动液面时间序列数据作为预测样本，用于对预测模型进行测试。最大Lyapunov指数预测模型的预测结果如图7所示。 由图7可以看出，采用最大Lyapunov指数的混沌时间序列预测方法得到的预测结果，可以比较好的跟踪真实值，尤其在动液面相对较稳定时候，预测精度较高。 图6. ARMA法预测误差 图7. 动液面高度预测曲线  为了定量的评价动液面时间序列的预测结果，我们使用以下四个误差指标进行考察： 1) 平均相对误差： MAPE = 1 n ∑ i = 1 n | ( y d ( i ) − y t ( i ) ) / y t ( i ) | × 100 % (13) 2) 均方根误差： RMSE = 1 n ∑ i = 1 n [ y d ( i ) − y t ( i ) ] 2 (14) Table 2 MAPE RMSE PERR P 0 .1 ARMA 17.66% 59.69 0.0085 59.17% 最大Lyapunov指数 11.95% 46.71 0.0052 77.34% 表2. 动液面预测误差分析 3) 平方和相对误差： PERR = ∑ i = 1 n [ y t ( i ) − y d ( i ) ] 2 / ∑ i = 1 n y t 2 ( i ) (15) 4) 相对误差在10%以内的后验概率，即 | e | ≤ 10 % 的后验概率： P 0 .1 = 1 n ∑ i = 1 n I { | ( y d ( i ) − y t ( i ) ) / y t ( i ) | ≤ 0 .1 } (16) 其中， I { A } = { 1 若 A 为 真 0 其 他 ，A表示相对误差在10%以内这一事件，n为预测样本总数， y t ( i ) 和 y d ( i ) 分别为潜油往复抽油机油井第i日的动液面高度的实际值和预测值。 表2中给出动液面预测误差评价指标的量化值，采用最大Lyapunov指数的混沌时间序列预测方法得到的动液面预测误差大大优于ARMA方法的预测误差。"
"本文首先对潜油柱塞泵的动液面时间序列的ARMA线性预测方法进行了研究。用此模型，对给定的样本进行动态测试，并给出了预测结果，发现ARMA线性方法在处理动液面预测问题上的效果并不是非常理想。针对动液面变化的混沌特性，使用混沌时间序列预测方法对动液面时间序列的预测问题进行了研究，建立了最大Lyapunov指数预测模型。本文最后，用4种误差量化指标定量地分析了两种模型的动液面预测效果。结果表明，使用混沌时间序列预测方法的预测效果更好。"
