"将小波理论和Elman神经网络相结合，采用思维进化算法对网络初始权值和阈值进行优化，建立了MEA-小波Elman神经网络预测模型，应用于光伏出力超短期预测。使用小波函数作为传递函数，提高了函数逼近能力，有效解决了预测模型在对光伏出力预测跟踪中的容易陷入局部最小值，迭代速度慢，预测精度不高等问题。最后，本文采用敦煌地区实测数据分析验证，通过与传统Elman神经网络模型进行比较，表明该模型对光伏超短期预测具有较好的效果，进而为调度人员提供决策辅助。 关键词 :光伏预测，思维进化算法，小波Elman神经网络 Copyright © 2017 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着可再生能源发电的大力发展，光伏发电作为最为成熟的清洁能源发电方式之一，已经在世界范围内得到广泛利用 [ 1 ] 。然而由于受天气因素影响较大，光伏出力具有突变性和间歇性。随着越来越多的兆瓦级光伏电厂并网运行，光伏出力是波动性增加了光伏并网运行调度的难度，对电网的经济、安全、可靠性方面的影响也愈发突出 [ 2 ] [ 3 ] [ 4 ] 。超短期预测时效一般为4小时之内，用于修正日前短期预测曲线，以提高实时预测的精度。随着我国新电改推行，实时市场即将建立 [ 5 ] ，准确预测光伏出力，尤其是超短期出力预测将有助于降低光伏出力波动性对电网的影响，进一步提高电力系统运行经济性和安全性 [ 6 ] 。 目前国内外常用的光伏出力超短期有典型趋势线性外推法 [ 7 ] 和基于地基云图法 [ 8 ] [ 9 ] 两类。前者预测方法较为简单，但预测受天气影响较大，精度有待提高。后者预测方法预测精度较高，但运算复杂，需要庞大的数据库作为支撑。本文提出一种基于MEA-小波Elman神经网络的预测方法，利用Elman神经网络特有的输入延迟特性，对光伏这种出力具有时变特性的时序数据预测更有效 [ 10 ] [ 11 ] 。同时针对Elman神经网络求解存在的早熟和局部极小值问题 [ 12 ] [ 13 ] ，提出了采用思维进化算法(Mind Evolutionary Algorithm, MEA)对网络的初始阈值和权值优化，针对模型预测精度和收敛速度的问题，采用小波函数作为Elman神经网络隐含层激励函数，使得模型的函数逼近、模式识别和容错能力增强。通过与传统Elman神经网络的预测结果进行了对比分析，验证了该预测方法具有更好的预测效果。"
"图1所示为不同天气类型下某光伏电站的单日出力曲线。 从上图可以看出，光伏出力有明显的波动性，短时间尺度下波动范围可达到装机容量的50%。同时可以看出天气对光伏出力的波动水平有显著的影响。晴天时光伏出力较为平稳；多云和阴天时，云层较多，光线受云层遮挡的影响，光伏出力波动较晴天大，短时间内波动量可超过装机容量的50%；雨雪天气时，出力波动较多云和阴雨天气时小，但光伏整体出力水平很低。可以看出在不同天气类型下，光伏发电系统的输出功率变化趋势有很大的不同，所以本文在预测数据选取时，对不同的天气类型划分不同 的训练集。同时，从图中还可以看出，光伏超短期时间尺度下出力波动较大，有较多的爬坡上升和下降，光伏出力变化的非线性、时变性和不确定性的特点很突出。因此本文选用采用基于MEA-小波Elman神经网络的预测方法进行光伏超短期预测。"
"本文采用的小波Elman神经网络结构模型如图2所示，其具有4层神经单元，比传统神经网络多出一个承接层，用于记忆隐含层单元前一时刻的输入值并返回给网络的输入，这种递归记忆使得网络对数据历史状态具有敏感性，克服了多层前馈神经网络信号无法进行反馈的缺陷，使得网络具有较好的动态性能，更加适用于光伏出力预测。小波分析方法通过尺度伸缩和平移对信号进行多尺度分析，能有效提取信号的局部信息。将小波分析与Elman神经网络进行耦合，采用小波函数作为Elman神经网络隐含层激励函数，可以构成小波Elman神经网络。它兼具小波变换与Elman神经网络的优点，增强了模型的函数逼近、模式识别和容错能力 [ 12 ] 。 图1. 某变电站不同天气下的日出力曲线 图2. 小波Elman神经网络结构 图中 为t时刻输出节点向量， 为t时刻的n维输入向量， 为m维隐含层输出， 为m维承接层输出。 为自反馈增益。 则每一时刻关联层神经元输出为 (1) 此时神经网络输入输出的动态方程可表示为： (2) 式中 为输出层神经元与隐含层神经元之间的连接权， 为隐含层神经元i于输入层神经元j之间的连接权， 为隐含层神经元i与承接层神经元k之间的连接权， 、 分别为小波伸缩系数和小波平移系数；式中 为中间层传递函数，本文选用Mexican Hat母小波基函数，其数学公式为： (3) 网络的训练采用动态梯度学习算法，用 表示网络在t时刻的期望输出，则t时刻网络输出误差为： (4) 取误差函数为 (5) 设共有N组输入，则总的输出误差为： (6)  针对遗传算法的固有缺陷–易陷入局部极小值问题，文献 [ 12 ] 提出采用思维进化算法(MEA)对网络进行优化。根据模拟生物进化中人类思维进化的方式，把群体划分成优胜子群体和临时子群体，在此基础上定义的趋同和异化操作：趋同为在子群体范围内，个体成为胜者而竞争的过程；异化为在整个解空间中，各子群体为成为胜者而竞争，不断地探测解空间中新的点。这两种操作相互促进且保持一定的独立性，使得搜索效率得以提高。MEA可以记忆每一次迭代种群和个体的进化信息，这些信息可以指导趋同和异化向着有利的方向进行。因此，MEA全局搜索能力极强，可以以较高的效率并行地大规模搜索全局最优解，减小了对原始数据准确性的依赖，避免系统出现陷入局部极小值现象，使得预测精度提高，稳定性加强。其具体进化过程如图3所示。 其中异化操作中，各子种群的竞争获胜依据为得分函数，本模型选取训练集的均方误差的倒数作为各个个体和子种群的得分函数，函数表达式为： 图3. 思维进化算法流程图 (7) 式中 表示第i个训练样本的网络输出值， 表示目标输出， 为训练样本数。 学习算法的目标是通过调节网络的权值和小波基函数系数，使得总误差 逐步减小，根据求一阶偏导的链式法则，某一时刻的导数计算依赖前一时刻的计算结果，学习过程根据时序计算所有的偏导数，随着迭代步数增加，总误差 逐步减小。  考虑到不同天气类型对光伏出力变化趋势影响较大，本文分不同天气类型对光伏出力进行预测。首先基于小波Elman神经网络预测方法建立短期预测模型，然后利用MEA的全局搜索寻优能力的优势，采用思维进化算法进行初始权值优化具体预测流程如图4所示。"
"为验证本模型预测效果，本文选取甘肃敦煌某光伏发电站作为本次研究对象，根据当地天气特点，将天气类型划分为：晴天、多云\扬沙、雨雪天气三种类型。数据采集的时间尺度为15 min，对于每种天气类型分别选取20天数据作为数据库，其中前19天数据作为训练集，第20天数据作为预测集，用于评估预测效果。 由于采用的历史数据量纲不一，所以要对数据提前进行归一化处理，归一化公式为： (8) 图4. MEA-小波Elman神经网络光伏超短期预测流程 其中 为数据序列的均值， 和 为数据序列最大最小值，经归一化处理后，消除了各维数据之间的数量级的差别，避免因为输入输出数据数量级差别较大而造成网络预测误差较大。 本文针对光伏波动较大多云/扬沙天气进行仿真分析，分别采用传统Elman算法和本文提出的MEA-小波Elman算法进行预测对比分析。为定量的评价预测效果，本文选用国际上普遍使用的总绝对误差 ，归一化绝对评价误差 ，归一化均方根误差 ，希尔不等系数 ，对预测模型的误差进行分析。其计算公式分别为： (9) (10) (11) (12) 其中 为预测值， 为实际值， 为预测样本数。 预测结果如图5所示。误差分析如表1所示。 图5. 预测误差对比 Table 1 总绝对误差/ 归一化绝对评价误差/ 归一化均方根误差/ 希尔不等系数/ Elman算法 179.9141 0.0951 0.1403 0.0092 改进Elman算法 142.2216 0.0814 0.1348 0.0068 表1. 误差分析 由图表可以看出，采用思维进化算法和小波分析优化后的Elman神经网络很好的改善传统Elman运算的收敛性和计算精度。在模型训练中与小波分析结合起来，使得人工神经网络更加适用于光伏出力的实时预测，在光伏出力波动较大时也能很好的进行跟踪预测。"
"本文将思维进化算法和小波Elman神经网络相结合起来。利用Elman神经网络具有适用时变特性的能力，对光伏实时出力进行5 min时间尺度的超短期预测。并采用思维进化算法对网络初始阈值进行优化，减小容易陷入局部最小值的问题，并使用小波函数作为传递函数，引入尺度和平移两个参数，提高拟合精度和计算速度。为光伏出力超短期预测提供了一种良好的方法。对于新能源光伏并网后日内电力市场发展和电网实时调度具有一定的应用价值。"
