"本文主要研究了在响应变量随机缺失同时非参数分量带测量误差的条件下，部分线性变系数模型的统计推断。利用局部线性光滑、profile最小二乘及偏差纠正方法，构造了模型中参数分量和非参数分量的估计；另外，为了避免使用近似正态方法构造参数置信域时估计渐近协方差，我们又利用经验似然方法研究了参数置信域的构造问题，进而给出了参数分量的置信区间，模拟研究表明经验似然方法相比正态近似方法具有更好的有限样本性质。最后使用超市生鲜产品销售量数据集进行了实例分析，得到了更好的结果。 关键词 :缺失数据，部分线性变系数模型，协变量含误差，经验似然 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"半参数部分线性变系数模型是近几十年来发展起来的一种统计模型，既含有线性模型部分，又含有变系数模型部分，是线性模型与变系数模型的结合，因此其具有线性模型便于解释和非参数模型稳健的特征。部分线性变系数模型的形式如下： Y = X τ β + Z τ α ( T ) + ε , (1.1) 其中Y是响应变量，X，Z和T为协变量，为了避免“维数祸根”，我们一般假设T为单变量， β = ( β 1 , β 2 , ⋯ , β q ) τ 是 q × 1 维的未知参数向量， α ( ⋅ ) = ( α 1 ( ⋅ ) , α 2 ( ⋅ ) , ⋯ , α p ( ⋅ ) ) τ 是 p × 1 维未知的系数函数向量， ε 为模型误差并且满足 E ( ε | X , Z , T ) = 0 ， Var ( ε | X , Z , T ) = σ 2 。这个模型是一般的且包含许多重要 的统计模型，比如：当 α ( ⋅ ) ≡ α ，其中 α 是一个常数向量时，模型(1.1)就变成通常的线性回归模型，这个模型被用到实际生活的许多方面，现在已经研究的非常成熟；当 q ≡ 1 且 Z ≡ 1 时，模型(1.1)就变成了部分线性回归模型，这个模型也用的相当广泛，Engle等 [ 1 ] 用此模型研究了气温与用电量关系之后，部分线性模型受到了统计学家的重点关注，在理论和应用中都得到了更深入的研究，并取得了一系列突破性成果；当 X ≡ 0 时，模型(1.1)就变成著名的变系数模型，由于其良好的解释能力，变系数模型得到了广泛的应用，被成功应用到非线性时间序列建模、函数型数据和纵向数据分析、空间分析以及金融计量分析等相关问题的研究中。针对此模型，Fan和Huang [ 2 ] 对参数分量提出了Profile最小二乘估计，并且基于广义似然比检验方法研究了该模型参数和非参数函数的假设检验问题；Huang和Zhang [ 3 ] 则利用经验似然方法研究了非参数分量 α ( ⋅ ) 的统计推断问题。 在实际问题分析中经常会遇到数据缺失的现象。因此，在数据缺失下的研究是非常有必要的。随机缺失(MAR)的基本思想是观测到响应变量的概率仅仅依赖于其他观测变量的值，而不依赖于那些缺失值。例如，假设得到来自 ( X , Y , δ ) 的一个不完全观测样本 { ( X i , Y i , δ i ) ,1 ≤ i ≤ n } , (1.2) 其中 X i 为可完全观测到的协变量， Y i 为响应变量且带有随机缺失(MAR)， δ 为指示变量。即，如果 δ i = 0 ，则表示 Y i 缺失；如果 δ i = 1 ，则表示 Y i 不缺失。随机缺失机制意味着给定X的条件下Y和 δ 是相对独立的，即 P r ( δ = 1 | Y , X ) = P r ( δ = 1 | X ) , (1.3) 随机缺失是在分析缺失数据时的一种常用假设，这在许多实际情况下是较为合理的。针对缺失数据的研究和处理一直被统计学家所重视，对模型(1.1)，Wei [ 4 ] 研究了在因变量随机缺失情形下参数的统计推断问题以及基于广义似然比检验方法研究了该模型参数的假设检验问题；Wei和Mei [ 5 ] 是基于广义似然比检验对参数部分X带测量误差和因变量Y随机缺失下考虑了参数的估计问题。 在许多实际应用中，我们往往无法得到协变量的精确值，只能采集到含有误差的观测值，比如在工程计算、经济学、生物医学和流行病学等领域，由于实验仪器的原因采集到的数据经常含有测量误差。在模型(1.1)中，非参数协变量Z是可精确观测的，我们所考虑的问题是 Z i 含有测量误差，即我们所观测到的是 W i 而不是 Z i ，两者之间的关系满足 W i = Z i + U i , i = 1 , 2 , ⋯ , n . (1.4) 其中 U i 是测量误差，且独立于 ( X τ , Z τ , U , δ ) τ ，其协方差阵为 Cov ( U ) = Σ U 。为了模型的可识别性，我们假设 Σ U 是已知的，如果该协方差未知，则可以利用W的重复观测数据得到 Σ U 的估计值。对于上述情况，Yang等 [ 6 ] 研究了带测量误差的部分线性模型参数的两步估计以及参数的经验似然置信域；针对模型(1.1)，You和Chen [ 7 ] 研究了当协变量X含误差时参数的估计问题；Zhang和li等 [ 8 ] 研究了在约束条件下协变量X含误差时参数的统计推断问题；Fan和Liang等 [ 9 ] 基于经验似然方法研究了当自变量X含误差时参数的估计问题，构造了参数的经验似然置信域；Feng和Xue等 [ 10 ] 研究了在约束条件下协变量Z含误差时的参数的估计和假设检验问题；Fan和Xu等 [ 11 ] 考虑了协变量Z含误差时基于带辅助信息的经验似然的参数和非参数函数的估计问题，并证明了估计的渐近性质。本文则针对模型(1.1)同时考虑响应变量随机缺失和非参数部分带测量误差。"
"我们首先基于完整数据给出模型(1.1)中系数函数 α ( ⋅ ) 的估计，假设 { Y i , δ i , X i , Z i , T i } i = 1 n 为来自模型(1.1)的观测数据，则有 δ i Y i = δ i X i τ β + δ i Z i τ α ( T i ) + δ i ε i , i = 1 , 2 , ⋯ , n , (2.1) 假定 β 已知，则模型变为如下形式的变系数模型 δ i ( Y i − X i τ β ) = δ i α 1 ( T i ) Z i 1 + δ i α 2 ( T i ) Z i 2 + ⋯ + δ i α p ( T i ) Z i p + δ i ε i , (2.2) 利用局部线性光滑的局部最小二乘法来估计未知系数函数。给定T领域内的一点t，对 { α j ( T ) , j = 1 , 2 , ⋯ , q } 利用Taylor展开有 α j ( T ) ≈ α j ( t ) + α ′ j ( t ) ( T − t ) ≡ a j + b j ( T − t ) , j = 1 , 2 , ⋯ , q , (2.3) 其中 α ′ j ( t ) = ∂ α j ( t ) / ∂ t 为 α j ( t ) 的一阶导数，对 a j ， b j 极小化 ∑ i = 1 n { ( Y i − X i τ β ) − ∑ j = 1 p [ a j + b j ( T i − t ) ] Z i j } 2 K h ( T i − t ) δ i , (2.4) 其中 K h ( ⋅ ) = K ( ⋅ / h ) / h ， K ( ⋅ ) 为核函数，h为带宽。为了表示方便，引入下面记号 a = ( a 1 , a 2 , ⋯ , a q ) τ ， b = ( b 1 , b 2 , ⋯ , b q ) τ ， Y = ( Y 1 , Y 2 , ⋯ , Y n ) τ ， X = ( X 1 , X 2 , ⋯ , X n ) τ ， W = ( W 1 , W 2 , ⋯ , W n ) τ ， Z = ( Z 1 , Z 2 , ⋯ , Z n ) τ ， ε = ( ε 1 , ε 2 , ⋯ , ε n ) τ ， ω t δ = diag ( K h ( T 1 − t ) δ 1 , K h ( T 2 − t ) δ 2 , ⋯ , K h ( T n − t ) δ n ) ， D t Z = [ Z 1 τ T 1 − t h Z 1 τ ⋮ ⋮ Z n τ T n − t h Z n τ ] , M = [ Z 1 τ α ( T 1 ) ⋮ Z n τ α ( T n ) ] , 则式(2.4)的解为 [ a ^ τ , h b ^ τ ] τ = { ( D t Z ) τ ω t δ D t Z } − 1 ( D t Z ) τ ω t δ ( Y − X β ) , (2.5) 上面在估计时假定了数据Z可以精确观测。如果我们简单的用W来代替Z，而没有考虑测量误差的情况，可以证明这样得到的估计是不相合的，为了解决这个问题，我们需要对估计进行“校正衰减”，纠偏之后的估计为 [ a ^ τ , h b ^ τ ] τ = { ( D t W ) τ ω t δ D t W − Ω δ } − 1 ( D t W ) τ ω t δ ( Y − X β ) , (2.6) 其中 D t W 和 D t Z 有相同的形式，仅仅用 W i 替代 Z i ，并且 Ω δ = ∑ i = 1 n     Σ u ⊗ [ 1 T i − t h T i − t h ( T i − t h ) 2 ] K h ( T i − t ) δ i , 其中 ⊗ 为Kronecker乘积。因此当 β 已知时，纠偏后的系数函数 α ( t ) 的估计为 α ˜ ( t ) = ( I q 0 q ) { ( D t W ) τ ω t δ D t W − Ω δ } − 1 ( D t W ) τ ω t δ ( Y − X β ) , (2.7) 其中 I q 为q阶单位阵， 0 q 是 q × q 的0矩阵。令 Q i = ( I q 0 q ) { ( D T i W ) τ ω T i δ D T i W − Ω δ } − 1 ( D T i W ) τ ω T i δ , i = 1 , 2 , ⋯ , n 。 Q = ( Q 1 τ , Q 2 τ , ⋅ ⋅ ⋅ , Q n τ ) τ ， S = ( Q 1 τ W 1 , Q 2 τ W 2 , ⋅ ⋅ ⋅ , Q n τ W n ) τ ， Y ˜ = ( I − S ) Y ， X ˜ = ( I − S ) X ，通过极小化下式 ∑ i = 1 n     δ i { Y i − X i τ β − W i τ α ^ ( T i ) } 2 − ∑ i = 1 n     δ i α ^ τ ( T i ) Σ u α ^ ( T i ) , (2.8) 可以得到参数 β 的估计 β ^ = { ∑ i = 1 n     δ i ( X ˜ i X ˜ i τ − X τ Q i τ Σ u Q i X ) } − 1 { ∑ i = 1 n     δ i ( X ˜ i Y ˜ i − X τ Q i τ Σ u Q i Y ) } , (2.9) 参数 β 估计的矩阵形式为 β ^ = { X ˜ τ Δ X ˜ − X τ Q τ Δ ⊗ Σ u Q X } − 1 { X ˜ τ Δ Y ˜ − X τ Q τ Δ ⊗ Σ u Q Y } , 其中 Δ = diag ( δ 1 , δ 2 , ⋯ , δ n ) 。 再由(2.7)式，我们可以得到系数函数 α ( t ) 的估计为 α ^ ( t ) = ( I q 0 q ) { ( D t W ) τ ω t δ D t W − Ω δ } − 1 ( D t W ) τ ω t δ ( Y − X β ^ ) . (2.10)"
"下面我们给出模型(1.1)回归参数的经验似然比，由(2.9)式可知， β ^ 是下面方程的解 ∑ i = 1 n     δ i [ X ˜ i ( Y ˜ i − X ˜ i τ β ) − X τ Q i τ Σ u Q i ( Y − X β ) ] = 0 , (3.1) 由此我们引进辅助随机变量 η i ( β ) = δ i X ˜ i ( Y ˜ i − X ˜ i τ β ) − δ i X τ Q i τ Σ u Q i ( Y − X β ) , (3.2) 通过Qin和Lawless [ 12 ]，基于经验似然方法，关于 β 的经验对数似然比函数可以定义为 L ( β ) = − 2 max { ∑ i = 1 n log ( n p i ) | p i ≥ 0 , ∑ i = 1 n     p i = 1 , ∑ i = 1 n     p i η i ( β ) = 0 } , (3.3) 使用Lagrange乘子法可以算出 p i = 1 n 1 1 + λ τ η i ( β ) , (3.4) 其中 λ 是下面方程的解 1 n ∑ i = 1 n η i ( β ) 1 + λ τ η i ( β ) = 0. (3.5) 由上可知，经验对数似然比可以表示为 L ( β ) = 2 ∑ i = 1 n log { 1 + λ τ η i ( β ) } . (3.6)"
"本节通过数值模拟来研究所提方法的有限样本性质。考虑如下的部分线性变系数含误差模型 ( y i = x i β + z 1 i α 1 ( T i ) + z 2 i α 2 ( T i ) + ε i , w 1 i = z 1 i + u 1 i , w 2 i = z 2 i + u 2 i ,         i = 1 , 2 , ⋯ , n , 其中 x i ∼ N ( 0,1 ) ， z 1 i ∼ N ( 0,1 ) ， z 2 i ∼ N ( 0,1 ) ， T i ∼ U ( 0,1 ) ， β = 2 ， α 1 ( t ) = 2 sin ( 2 π t ) ， α 2 ( t ) = − 1.5 cos ( 1.5 π t ) ， [ u 1   u 2 ] τ ∼ N 2 ( 0, Σ u ) ， Σ u 分别取 0.25 I 2 和 0.5 I 2 两种情况。为了研究模型误差对结果的影响，我们设定误差 ε i 有以下形式： ε i ∼ N ( 0,0.5 ) 。模拟中我们选取Epanechnikov核函数，即 K ( x ) = 0.75 ( 1 − x 2 ) I | x | ≤ 1 。并采用“去一个体”交叉验证的方法来选择带宽 h C V ，使其满足下列式子达到最小 CV ( h ) = 1 n ∑ i = 1 n   δ i { Y i − X i τ β ^ ( − i ) − W i τ α ^ h , ( − i ) ( T i ) } 2 − 1 n ∑ i = 1 n   δ i α ^ h , ( − i ) τ ( T i ) Σ u α ^ h , ( − i ) ( T i ) , 其中 α ^ h , ( − i ) ( T i ) 和 β ^ ( − i ) 分别为去掉第i个观测值后的 α ( u ) 和 β 的估计。分别考虑如下两种形式的缺失机制： Case I P r ( δ = 1 | X = x , Z = z , T = t ) = 0.8 ，对所有的 x , z , t ； Case II P r ( δ = 1 | X = x , Z = z , T = t ) = 0.8 + 0.2 ( | x | + | t − 0.5 | ) ，当 | x | + | t − 0.5 | ≤ 1 时，否则取0.88。 下面我们分别给出不带缺失数据和非参数分量含测量误差不纠偏的 β 的估计公式，以便于与本文得出的结果作对比。 1) 不含缺失数据： β ¯ = { X ˜ τ X ˜ − X τ Q τ I ⊗ Σ u Q X } − 1 { X ˜ τ Y ˜ − X τ Q τ I ⊗ Σ u Q Y } , α ¯ ( t ) = ( I q 0 q ) { ( D t W ) τ ω t D t W − Ω } − 1 ( D t W ) τ ω t ( Y − X β ¯ ) , 上述两个公式可以在Feng和Xue [ 10 ] 这篇文章中找到。 2) 非参数分量含测量误差不纠偏： β ˜ = [ ∑ i = 1 n     δ i X ˜ i X ˜ i τ ] − 1 [ ∑ i = 1 n     δ i X ˜ i Y ˜ i ] , α ˜ ( t ) = ( I q 0 q ) { ( D t W ) τ ω t δ D t W } − 1 ( D t W ) τ ω t δ ( Y − X β ˜ ) , 上述两个公式可以在 [ 13 ] 中找到相似的结果。 在上述两种缺失情形下，数据Y的平均缺失概率为别为0.2和0.1。在模拟过程中，对于每种情况，样本容量分别取 n = 100 , 150 , 200 ，并进行1000次模拟，得到了 β ^ , β ¯ 和 β ˜ 的均值、标准差和均方误差，结果如表1、表2、表3所示。在样本量 及响应变量Y的平均缺失概率为0.2和 Σ u = 0.5 I 2 的情形下，我们在图1中给出了模型中非参数函数的估计曲线。此外，在给定两种不同的缺失水平下，分别用经验似然方法(EL)和正态逼近方法(NA)给出参数 β 的置信水平为95%的置信区间，并计算出置信区间的平均长度及覆盖概率，结果如表4所示。 Table 1 Case Σ u n Mean SD MSE I 0.25 I 2 100 2.0224 0.1554 0.0210 150 2.0187 0.1115 0.0117 200 2.0013 0.0951 0.0099 0.5 I 2 100 1.9986 0.1962 0.0361 150 2.0129 0.1624 0.0268 200 2.0107 0.1346 0.0168 II 0.25 I 2 100 2.0032 0.1503 0.0192 150 2.0041 0.1086 0.0114 200 2.0008 0.0895 0.0086 0.5 I 2 100 1.9956 0.1853 0.0323 150 2.0082 0.1601 0.0259 200 2.0023 0.1261 0.0154 表1. 不同情况下 β ^ 的均值(Mean)、标准差(SD)和均方误差(MSE) Table 2 Case Σ u n Mean SD MSE Null 0.25 I 2 100 2.0178 0.3975 0.1581 150 1.9982 0.1687 0.0284 200 2.0027 0.0996 0.0099 0.5 I 2 100 1.9864 0.7580 0.5761 150 1.9906 0.4992 0.2490 200 2.0028 0.3664 0.1341 表2. 不同情况下 β ¯ 的均值(Mean)、标准差(SD)和均方误差(MSE) Table 3 Case Σ u n Mean SD MSE I 0.25 I 2 100 2.0191 0.1343 0.0183 150 2.0165 0.1038 0.0108 200 2.0008 0.0863 0.0085 0.5 I 2 100 1.9993 0.1864 0.0342 150 2.0119 0.1576 0.0251 200 2.0087 0.1219 0.0149 II 0.25 I 2 100 2.0045 0.1332 0.0179 150 1.9991 0.1043 0.0106 200 2.0031 0.0852 0.0081 0.5 I 2 100 1.9985 0.1771 0.0315 150 2.0061 0.1521 0.0224 200 2.0013 0.1131 0.0134 表3. 不同情况下 β ˜ 的均值(Mean)、标准差(SD)和均方误差(MSE) Table 4 Case Σ u n 平均长度 覆盖概率 NA EL NA EL I 0.25 I 2 100 0.2916 0.2713 0.881 0.903 150 0.2725 0.2593 0.904 0.919 200 0.2396 0.2119 0.912 0.921 0.5 I 2 100 0.3325 0.3109 0.883 0.892 150 0.3191 0.2867 0.890 0.910 200 0.2758 0.2610 0.907 0.918 II 0.25 I 2 100 0.2805 0.2693 0.891 0.911 150 0.2716 0.2609 0.912 0.927 200 0.2309 0.2231 0.919 0.932 0.5 I 2 100 0.3341 0.3096 0.890 0.907 150 0.3082 0.2719 0.913 0.919 200 0.2718 0.2576 0.917 0.921 表4. 不同情形下置信水平为95%的 β 的置信区间的平均长度和覆盖概率 从表1中我们可以得到三个结论： 1) 在缺失概率和测量误差协方差给定的情况下，随着样本的增加，参数估计量的标准差和均方误差都逐渐减小； 2) 在缺失概率和样本量给定的情况下，测量误差协方差越小，参数估计量的标准差和均方误差越小； 3) 在测量误差协方差和样本量给定的情况下，缺失概率越小，参数估计量的标准差和均方误差越小。 通过对表1与表2对比可以得知： 本文所用的处理缺失数据的方法与无缺失数据的结果相差不大，很好地说明了本文所论述方法的优良性。 通过对表1与表3对比可以得知： 1) 在对含测量误差不做任何处理时，得到的结果偏差较大，不能使人满意。 2) 本文所提的方法对含有测量误差数据的处理有很好的效果。 从表4中我们可以得到如下四个结论： 1) EL (经验似然法)比NA (正态近似法)有更短的置信区间和更高的覆盖率； 2) 对给定的缺失概率，随着样本量的增加，经验似然和正态近似的置信区间均会缩短； 3) 对给定的样本量，随着缺失概率的增加，经验似然和正态近似的置信区间均会增长； 4) 对给定的样本量和缺失概率，误差方差越大，不论是经验似然还是正态近似的置信区间均会增长，且覆盖率会下降。 从图1可以看出我们所提出的非参数函数的估计量(虚线)与无缺失数据(点虚线)情形下是几乎重合的，非常接近于真实(实线)曲线，而不纠偏时估计(点线)的效果显然是较差的，这表明我们所提出的非参数部分的估计量是有效的。 图1. 系数函数(左图为 ，右图为 α 2 ( t ) )的真实曲线和各类估计曲线"
"下面通过分析超市生鲜产品销售量的数据进一步说明我们方法的有效性。数据源于日本某公司分析客流量、天气、产品价格等因素对超市生鲜产品销售量影响的工作。该数据集由生鲜产品销售量和客流量、生鲜产品价格、天气情况、是否是节假日一些变量构成，其中生鲜产品销售量为2017年11月至2019年7月店铺中生鲜产品每天的销售量(包含打折数量)，九个感兴趣的协变量分别为：生鲜产品价格(PFP)、客流量(VOC)、恶劣天气程度(SWC)、平均气温(MT)、最高气温(MaxT)、平均湿度(MH)、平均降雨(MR)、最大风力(MWF)、是否是节假日(HD)。为了符号简单起见，协变量PFP，MT，MaxT，MH，MR，MWF，VOC，HD分别记为 Z 2 , Z 3 , Z 4 , Z 5 , Z 6 , Z 7 , X 1 , X 2 。 取 Z 1 = 1 为截距项，协变量 T = SWC 。研究讨论了 Z 2 , Z 3 , Z 4 , Z 5 , Z 6 , Z 7 , X 1 , X 2 以及SWC对超市生鲜产品销售量的影响，并采用部分线性变系数模型 Y = ∑ i = 1 7     α i ( T ) Z i + β 1 X 1 + β 2 X 2 + ε 来拟合给定的数据。在进行分析之前，我们首先对协变量进行标准化变换，同时需要对变量SWC进行变换使其分布为 U [ 0,1 ] 。为了证明我们所提方法的有效性，我们假定 Z 6 带有测量误差，即 W 6 = Z 6 + U 6 其中 U 6 ∼ N ( 0,0.02 ) ，响应变量有5%的缺失值，模拟中 δ 的产生是随机的，选取Epanechnikov核函数，即 K ( x ) = 0.75 ( 1 − x 2 ) I | x | ≤ 1 ，通过“去一个体”交叉验证的方法来选择带宽 h = 0.0113 ，通过本章提出的方 法所得参数分量 β 1 的估计 β ^ 1 的值为2.9711，置信区间为[2.7546, 3.1876]； β 2 的估计 β ^ 2 的值为3.3058，置信区间为[−3.0865, −3.5251]。协变量客流量 X 1 和是否是节假日 X 2 的系数估计值 β ^ 1 和 β ^ 2 分别为2.9711和3.3058，说明随着客流量的增加或当天为节假日时，生鲜产品的销售量也是递增的，销售量与协变量之间有正相关关系。这也与实际情况相符合。"
