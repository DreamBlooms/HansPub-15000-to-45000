"传统水库调度函数一般以最大化长系列多年平均发电、保证率等指标为目标函数，其内涵是水库多年运行的平均期望效益最大化，并未考虑年径流丰枯的区别。显然水库的优化调度函数与入库径流的丰枯情况有关，丰水年的优化调度函数与枯水年相比势必差异较大。为研究年径流分类对水库优化调度函数的影响，本文建立了考虑发电量及保证率的多目标优化调度模型，采用NSGA-II算法优化安康水库调度函数。结果表明：考虑径流分类，采用丰、平、枯水年的单独优化比长系列优化取得更好的效益。发电量最大非劣解提升发电量0.71%、保证率4.56%，保证率最高非劣解提升发电量1.37%、保证率2.57%。 关键词 :调度函数，多目标优化，集对分析，安康水库"
"水库调度是指根据水库承担的综合利用任务，运用水库的调蓄能力，重新分配水资源的时空分布，达到兴利、除害的目的 [ 1 ] 。根据水库特征及长系列入库径流规律制定的调度图和调度函数是目前指导水库中长期调度的主要规则 [ 2 ] 。水库调度函数的研究是水库调度理论和应用研究的一个重要分支，其理论意义和实用价值都是重大的。在来水已知的情况下，水库系统每个时段的最优决策与时段初状态、入库来水等状态有关，可以采用线性或者非线性的调度函数描述这种相关关系。 尹正杰等 [ 3 ] 采用基于模拟的遗传算法优化模型对一种水库多目标供水的调度规则参数进行优化，检验了供水调度规则的合理性。刘攀等 [ 4 ] 构建了“优化–拟合–再优化–随机仿真”框架来优化制定梯级水库群联合优化调度函数。周研来等 [ 5 ] 结合动态规划和回归分析推求大渡河梯级水库调度函数，并采用非线性规划法进行修正，修正后的调度函数能有效增加水库年均发电量。杨光等 [ 6 ] 采用NSGA-II算法，推求丹江口水库多目标调度函数集，得出兼顾丹江口水库供水和发电的多目标调度规则。 这些文献均采用长系列径流资料作为模型的输入，以多年平均发电、保证率等指标最大化为目标函数，其内涵是优化得到满足水库多年调度运行的平均期望效益最大要求的调度函数。而实际上水库的优化调度函数显然与入库径流的丰枯分类有关，丰水年的优化调度函数与枯水年相比势必差异较大，丰水年若采用长系列优化得到的调度函数进行调度运行其效益相对保守，现有优化研究较少考虑这个问题。本文试图探讨基于年径流分类的水库调度函数优化，比较年径流分类优化与传统优化方式的优劣。"
"水库每个时段的总出库流量与该时段内的可用水量有关，其中的可用水量由水库蓄水量和该时段内的入库水量组成。一般来说，调度函数是非线性的，但对于单个水库可将调度函数简化为易于处理的线性函数 [ 7 ] 。以安康水库为例，水库产生尽可能大的发电效益和保证率为调度准则，建立线性调度函数如下： (1) 式中： 为水库第t时段出库流量(m 3 /s)； 为水库第t时段的库容(m 3 )； 为水库第t时段的入库平均流量(m 3 /s)；w为单位转换系数； 和 分别为调度函数系数。 同时，以发电量最大和保证率最高为目标进行调度，目标函数如下所示： (2) (3) 式中：E为计划期T内发电量(kW·h)； 为第t时段的平均出力(kW)；K为电站综合出力系数； 为第t时段的平均发电流量(m 3 /s)； 为第t时段的平均发电水头(m)；P为发电保证率； 为保证出力； 表示梯级系统总出力大于保证出力的时段数。  (1) 水量平衡约束： (4) 式中： 为水库第t时段的库容(m 3 )； 和 分别为水库第t时段的入库和出库平均流量(m 3 /s)； 为计算时间步长； 为水库第t时段的水分损失量(m 3 )，如蒸散发、渗漏等。 (2) 水库水位约束： (5) 式中： 和 分别为水库第t时段的允许最大和最小水位(m)。 (3) 水库下泄流量约束： (6) 式中： 和 分别为水库第t时段的允许最大和最小下泄流量(m 3 /s)，一般由下游生态，航运要求和水库下游的防洪任务确定。 (4) 电站出力约束： (7) 式中： 和 分别为水库第t时段的允许最大和最小出力(kW)。 (5) 边界约束： (8) 式中： 和 分别为水库初、末时段的水位(m)。  NSGA-II算法由Deb [ 8 ] 于2000年提出，以其快速的运行效果和良好的收敛性目前被广泛应用于多目标优化计算。近年来该算法已被我国学者广泛应用于水库多目标调度的研究中，并取得了良好的效果 [ 6 ] [ 9 ] [ 10 ] 。算法的具体计算流程参阅文献 [ 11 ] ，具体计算步骤包括： (1) 随机初始化种群，并按照非劣排序方法排序分组后形成父代。 (2) 通过选择、交叉、变异产生新种群作为子代，与父代混合后进行排序，得到非劣前端。 (3) 计算所有非劣前端的拥挤距离，并按照拥挤距离排序。 (4) 按上一步排列后的顺序选择非劣前端，并通过复制、交叉和变异形成新的种群。 (5) 重复(2)~(4)直到满足终止条件，将最后得到的种群作为优化后的Pareto前端。 根据式(1)中的 和 可以确定调度函数，传统优化调度函数的方法一般直接优化调度过程，将优化后的出库流量与水库蓄水量、入库流量等决策因子进行线性拟合得到 和 。本研究采用基于“模拟–优化”模式调度函数优化方式，避免了先进行确定性优化再拟合得到调度函数，直接可以得到实现目标最优的水库调度函数，因此更高效，解的质量也更优 [ 12 ] 。利用NSGA-II优化算法将一年36个旬的 和 一共72个参数编码为染色体，以每一组 和 为决策变量进行模拟调度，计算发电量及相应保证率，其中种群个数为30，进化代数为200，交叉和变异概率分别取0.9和0.1。"
"安康水库位于汉江干流上游陕西省安康市境内，坝址位于安康市城西18 km处，上游距石泉水电站170 km，下游距湖北丹江口水库260 km，多年平均径流量192亿m 3 ，控制流域集水面积35,700 km 2 。安康水库总库容32亿m 3 ，其中，死库容为9.08亿m 3 ，兴利库容为14.72亿m 3 ，防洪库容为3.6亿m 3 ，死水位305.00 m，极限死水位300.00 m，正常蓄水位330.00 m，防洪限制水位325.00 m，设计洪水位333.00 m，校核洪水位337.33 m。 进行年径流丰枯分类的常规方法是以年径流总量为指标, 采用频率分析、均值标准差等方法确定, 没有考虑径流的年内分配情况。为了弥补常规方法的不足，王文圣等提出了一系列年径流丰枯划分的方法，如基于集对分析的年径流丰枯分类方法，该法不仅考虑了径流的大小, 而且也考虑了其时程分配，研究表明该方法简单实用，分类结果客观 [ 13 ] 。以安康水库1951~2010共60年的月均入库流量，按基于集对分析的年径流丰枯分类方法，进行年径流丰枯的划分，结果见表1。 为比较不考虑年径流分类的长系列优化方式与考虑年径流分类的丰、平、枯水年单独优化方式效益的差异，以60年长系列旬入库流量和上述集对分析法求得的丰(含特丰)、平、枯(含特枯)水年旬入库流量作为前述模型的输入，优化算法采用NSGA-II，按发电量和保证率最大为目标对优化变量(个体)进行优化。  将安康水库1951~2010年的旬入库流量作为模型的输入，绘制NSGA-II算法求解模型所得到Pareto前端，并提取Pareto前端中发电量最大、保证率最高两非劣解对应调度函数参数。采用NSGA-II算法优化得到了关于发电和保证率的Pareto前端如图1(a)所示，图中每一个非劣解对应一种安康水库优化调度函数。表2为长系列优化Pareto前端中发电量最大、保证率最高两非劣解对应调度函数部分参数。 将集对分析法划分出的丰、平、枯水年各自旬入库流量作为模型的输入，绘制NSGA-II算法求解模型所得到Pareto前端。并利用长系列优化得到发电量最大、保证率最高调度函数，结合丰、平、枯水年各自旬入库流量进行模拟调度，将其结果绘入相应Pareto前端中。由图1中可以看出，考虑年径流分类方法得到的非劣解集，均明显优于根据长系列资料优化调度函数得到的结果。表3给出了考虑年径流分类后，丰、平、枯水年各自发电量最大、保证率最高非劣解对应效益，括号中为考虑年径流分类优化方式比按长系列优化，不同年型与60年合计提升效益百分数。 由表3可以看出，随着径流分类由丰至枯变化，单独优化所能提高效益基本逐渐下降，这是因为丰水年入库来水较枯水年丰富，可供调度函数优化潜力更大，能够比长系列优化方式取得更优的效益。但当径流分类为枯时，选取发电量最大非劣解进行调度，长系列优化方式取得保证率仅为65.66%比单独优化相差6.42%，为表中相差最大数据。造成此结果的原因是，枯水年不适合采用长系列发电量最大调度函数进行调度，显然枯水年由于来水较小，按长系列发电优化调度函数进行操作下泄流量较大，将造成水库水位一直位于低位，不利于水库发电，将大幅降低发电保证率。平均而言考虑年径流分类的优化方式，发电量最大非劣解提升发电量0.71%、 保证率4.56%，保证率最高非劣解提升发电量1.37%、保证率2.57%。 通过上述讨论，可得出以下结论：考虑径流分类，采用丰、平、枯水年单独优化的方法比长系列优化方法取得更好的效益，丰水年单独优化所获得效益更加显著。而枯水年采用长系列发电量最大非劣解进行调度，将严重影响其发电保证率。为了进一步揭示考虑径流分类单独优化的方法对水库调度过程的影响，下面选取丰水年1983年、平水年2007年、枯水年1997年为典型年，对安康水库采用不同发电量最大优化方式所得调度过程进行分析。  1983年为安康水库1951~2010共60年入库资料中来水最多的一年，通过调度函数模拟调度计算可得结果见表4。丰水年优化方式与长系列相比，减小了弃水，增加了发电用水，更高效、合理运用了水资源，提高发电量1.14%。调度过程见图2(a)，从水库水位变化及出力过程可以看出，丰水年优化在汛前5月初至6月上旬出力较大，为丰水年汛期较大的来水腾空库容避免弃水，为更加合理的调度方式。两种优化方式在来水较丰的6月下旬至10月下旬相差不大，均以装机容量出力，且均抬高水库运行水位至正常蓄水位330 m，为次年的兴利提供保障。但丰水年优化在12月与1月出力较均衡，水库运行更加平稳。 Table 1 年份 集对分析法 年份 集对分析法 年份 集对分析法 1951 平 1971 枯 1991 特枯 1952 丰 1972 枯 1992 平 1953 平 1973 平 1993 丰 1954 平 1974 丰 1994 枯 1955 平 1975 丰 1995 特枯 1956 平 1976 平 1996 平 1957 特枯 1977 枯 1997 特枯 1958 特丰 1978 枯 1998 特枯 1959 枯 1979 枯 1999 特枯 1960 平 1980 丰 2000 平 1961 特丰 1981 平 2001 枯 1962 枯 1982 丰 2002 特枯 1963 特丰 1983 特丰 2003 平 1964 特丰 1984 平 2004 枯 1965 平 1985 枯 2005 平 1966 枯 1986 枯 2006 特枯 1967 特丰 1987 平 2007 平 1968 丰 1988 平 2008 枯 1969 枯 1989 丰 2009 平 1970 平 1990 枯 2010 枯 表1. 径流丰枯分类成果表 图1. NSGA-II算法优化Pareto前端(a)长系列(b)丰水年(c)平水年(d)枯水年 Table 2 非劣解 5月上旬 8月上旬 12月上旬 调度函数参数 a t b t a t b t a t b t 发电量最大 21.49 131.76 87.18 −750.57 59.96 −761.36 保证率最高 29.88 129.81 82.72 −1393.93 64.63 −761.36 表2. 非劣解参数表 Table 3 优化方式 年型 发电量最大 保证率最高 年均发电(亿kW·h) 保证率(%) 年均发电(亿kW·h) 保证率(%) 长系列 丰 33.19 89.76 32.77 91.15 平 27.63 79.57 27.02 84.33 枯 21.18 65.66 20.98 72.66 合计 26.24 76.15 25.84 81.06 考虑年径流分类 丰 33.62 (1.30%) 93.53 (4.20%) 33.22 (1.37%) 96.50 (5.87%) 平 27.83 (0.72%) 81.95 (2.99%) 27.59 (2.11%) 86.45 (2.51%) 枯 21.22 (0.19%) 69.88 (6.42%) 21.09 (0.52%) 72.88 (0.30%) 合计 26.43 (0.71%) 79.62 (4.56%) 26.20 (1.37%) 83.14 (2.57%) 表3. 效益统计表 2007年为安康水库入库径流资料通过集对分析法划分出的平水年，通过调度函数模拟调度计算可得结果见表4。平水年优化方式与长系列相比，同上述1983年情况类似，减小了弃水，增加了发电用水，更高效、合理运用了水资源，提高发电量0.16%。调度过程见图2(b)，从水库水位变化及出力过程可以看出，平水年优化在汛前5月初至7月出力较大，为7月开始325m的汛限水位限制，提前腾空库容避免弃水。同样在9月初开始， 图2. 水库丰平枯水年调度结果过程比较。(a) 丰水年；(b) 平水年；(c) 枯水年 Table 4 优化方式 年份 发电用水(亿m 3 ) 弃水(亿m 3 ) 发电量(亿kW·h) 水库平均水位(m) 长系列 1983 235.78 166.79 41.01 325.09 2007 143.83 27.67 24.32 320.68 1997 72.89 0 12.01 317.53 考虑年径流分类 1983 241.38 163.26 41.48 324.20 2007 145.36 26.14 24.36 320.09 1997 72.89 0 12.20 318.56 表4. 水库调度效益统计表 水库逐步蓄水至330 m正常蓄水位时，平水年优化方式加大了出力，与长系列相比同时蓄满，避免了弃水，为效益更佳的调度方式。同样平水年优化在12月与1月出力均衡，水库运行平稳。 1997年为安康水库1951~2010共60年入库资料中来水最少的一年，通过调度函数模拟调度计算可得结果见表4。枯水年优化方式与长系列相比，在发电用水相同的情况下，由于其平均水位高出近1m，提高发电量1.58%，发电效益增加显著。调度过程见图2(c)，从水库水位变化及出力过程可以看出，长系列优化方式在汛期6月至8月下泄流量较大，增加了出力，降低了水库运行水位，从而影响了8月至次年4年水库的发电水头。这是由于长系列优化的调度函数在汛期下泄流量偏大，以保障丰水年、平水年加大出力，不产生弃水，但对于枯水年调度不利。 对上述调度过程的分析说明，考虑年径流分类优化比长系列优化得到的调度函数更加适用于水库调度问题。长系列优化能得到满足水库多年调度运行的平均期望效益最大要求的调度函数，而实际上水库的优化调度函数显然与入库径流的丰枯分类有关。而本文选用的集对分析法不仅考虑了年径流的大小，而且也考虑了其年内时程分配，运用效果良好。该结果也可为水库常规调度方案的制定提供参考，制定常规方案如调度函数、调度图、简化运行策略等时，需利用设计枯水年进行调节计算，因径流年内时程分配会对水库调度函数制定造成影响，如何合理进行设计枯水年年径流的分配，就成为了关键问题，在常规调度方案的制定中需得到重视。"
"为了讨论年径流分类对水库优化调度函数制定的影响，本文建立了考虑发电量及保证率的多目标优化调度模型，采用NSGA-II算法优化丹江口安康水库调度函数。将利用集对分析法进行年径流分类后的优化结果与传统长系列相互比较，分析了不同优化方式对水库调度过程的影响，主要结论如下： (1) 考虑径流分类，采用丰、平、枯水年单独优化的方法比长系列优化方法取得更好的效益。发电量最大非劣解提升发电量0.71%、保证率4.56%，保证率最高非劣解提升发电量1.37%、保证率2.57%。 (2) 丰、平水年利用各自优化得出的调度函数模拟调度，可避免弃水，汛后出力均衡，水库运行平稳，调度方式更合理。枯水年采用长系列优化的调度函数在汛期下泄流量偏大，降低了水库运行水位和发电效益。"
