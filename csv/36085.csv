"谐波恢复问题是信号处理中的经典问题，对于被加性噪声污染的谐波信号，现有的多重信号分类(MUSIC)方法可以实现良好的恢复效果，但在谐波分量数未知的情况下无法发挥其超分辨率性能。本文结合实值MUSIC算法的超分辨率和逐步LSE算法的逐步估计的特点，提出了一种逐步MUSIC算法，该算法在分量数已知的情况下具有良好的估计性能。在分量数未知的情况下，我们利用该算法估计出一个模型集，并采用BIC准则估计谐波分量数。最后通过仿真实验对所提方法的性能进行了验证。 关键词 :谐波恢复，加性噪声，MUSIC算法，谐波分量数 Copyright © 2020 by author(s) and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY 4.0). http://creativecommons.org/licenses/by/4.0/"
"谐波信号是一种特殊的随机信号，它的分析与处理是统计信号处理中的一个典型问题。其参数估计在很多领域都有广泛的应用，包括：雷达目标波达角估计 [ 1 ]、传感器阵列信号处理 [ 2 ]、图像处理 [ 3 ] 等。根据背景噪声的复杂程度可以分为加性噪声中的谐波参数估计与乘性和加性噪声中的谐波参数估计两大类。当加性噪声为白噪声时，已有一些算法如超逼近方法 [ 4 ]、旋转不变子空间(Estimation of Signal Parameters via Rotational Invariance Techniques, ESPRIT)方法 [ 5 ]、预滤波ESPRIT方法 [ 6 ]、多重信号分类(Multiple Signal Classification, MUSIC)方法 [ 7 ] 和高阶统计量方法 [ 8 ] [ 9 ] [ 10 ] 等，这些算法都具有高分辨率，可以取得良好的参数估计效果。 谐波参数估计问题中，分量数是谐波信号的一个重要参数，它是建立谐波模型以及估计频率等参数的基础。考察具有代表性的MUSIC算法，准确的分量数是发挥其超分辨率的前提，而对分量数的欠估计或过估计，会导致谱峰的估计偏差。 本文考虑MUSIC算法和Prasad等 [ 11 ] 提出的逐步LSE算法的逐步估计相结合，提出了一种基于改进MUSIC算法的加性噪声中的谐波参数估计算法，该算法不需要预先判定谐波分量数，同时在低信噪比、样本量小的情况下依然保持较高的频率分辨能力。利用该算法可逐步的估计出一个模型集，并利用模型选择方法中的BIC准则估计谐波分量数。最后通过仿真实验对所提方法的性能进行了验证。"
"实际应用中的谐波信号通常为多个实值正弦信号与噪声信号的叠加，即 x ( t ) = ∑ k = 1 p A k cos ( ω k t + φ k ) + n ( t ) (1) 其中，p称为谐波的分量个数， A k , ω k , φ k 分别为第k个谐波分量的振幅、频率和相位； t = 1 , ⋯ , N 。N为采样数； n ( t ) 为加性噪声。 利用三角函数和差公式可将(1)式表示为 x ( t ) = ∑ k = 1 p [ a k cos ( ω k t ) + b k sin ( ω k t ) ] + n ( t ) (2) 其中 a k = A k cos ( φ k ) ， b k = − A k sin ( φ k ) 。 关于上述谐波信号模型的假设如下： AS1： ω k ∈ ( − π , 0 ) ∪ ( 0 , π ) , k = 1 , ⋯ , p ，并且 ω k 互不相等； AS2： φ k 是 ( − π , π ] 上的确定性常数； AS3：加性噪声 { n ( t ) , t = 1 , ⋯ , N } 为i.i.d。零均值且方差为 σ 2 的高斯随机变量序列。 为分析方便，定义一个长度为 m ( m > 2 p ) 的观测量和噪声量分别表示为观测向量 y ( t ) 和噪声向量 n ( t ) ： { y ( t ) = [ y ( t ) , y ( t + 1 ) , ⋯ , y ( t + m − 1 ) ] T n ( t ) = [ n ( t ) , n ( t + 1 ) , ⋯ , n ( t + m − 1 ) ] T (3) 则观测向量可表示为： y ( t ) = C ( ω ) s ( t ) + n ( t ) (4) 式中： C ( ω ) = [ B ( ω 1 ) , B ( ω 2 ) , ⋯ , B ( ω p ) ] m × 2 p (5) B ( ω k ) = [ 1 cos ( ω k ) ⋯ cos [ ( m − 1 ) ω k ] 0 − sin ( ω k ) ⋯ − sin [ ( m − 1 ) ω k ] ] T (6) s ( t ) = [ A 1 cos ( ω 1 t + φ 1 ) A 1 sin ( ω 1 t + φ 1 ) ⋮ A p cos ( ω p t + φ p ) A p sin ( ω p t + φ p ) ] 2 p × 1 (7)"
"文献 [ 12 ] 提出了一种实数形式的MUSIC算法，相较于常规的MUSIC算法，无需将信号转换为复频率，降低了计算量和计算复杂度。 因为 n ( t ) 与 y ( t ) 相互独立，于是可对观测向量 y ( t ) 的自相关矩阵 R y y = E { y ( t ) y T ( t ) } 做特征值分解为： R y y = C ( ω ) R s s C T ( ω ) + σ 2 I M = ∑ k = 1 M λ k μ k μ k T = U s Σ s U s T + σ 2 U n U n T (8) 其中 R s s = E { s ( t ) s T ( t ) } 是 s ( t ) 的自相关矩阵， I M 是 m × m 单位矩阵。 λ k 和 λ k 分别为 R y y 第k个特征值及其对应的特征向量，且满足 λ 1 ≥ λ 2 ≥ ⋯ ≥ λ 2 p + 1 = ⋯ = λ m = σ 2 。 Σ s 为 R y y 的前2p个特征向量构成的对角矩阵。 U s 称为 R y y 的信号子空间，由 R y y 的前2p个特征向量构成； U n 称为 R y y 的噪声子空间，由 R y y 的后 m − 2 p 个特征矢量构成。 由于特征向量相互正交，可得 U s 与 U n 正交，将式(8)右乘 U n 得： R y y U n = C ( ω ) R s s C T ( ω ) + σ 2 U n = σ 2 U n (9) 于是有： C ( ω ) R s s C T ( ω ) U n = O ⇒ U n T C ( ω ) R s s C T ( ω ) U n = O (10) 进而可以得到： C T ( ω ) U n = O (11) 即 C T ( ω ) 与 U n 正交。 将式(5)代入式(11)即有： B T ( ω ) U n = O 2 × ( m − 2 p ) ,     ω = ω 1 , ⋯ , ω p (12) 显然，当 ω ≠ ω 1 , ⋯ , ω p 时， B T ( ω ) U n ≠ O 。 将式(12)改写为标量形式，即定义如下实值MUSIC伪谱函数： P ( ω ) = 1 tr [ B T ( ω ) U n U n T B ( ω ) ] (13) 于是，若谐波模型具有p个分量，则可选取实值MUSIC伪谱函数 P ( ω ) 所对应的p个峰值点作为频率的估计。 在求解得各谐波频率的估计后，可将非线性的信号模型转为简单的线性模型，进而采用最小二乘方法估计各谐波振幅。 引入以下记号： Y = [ y ( 1 ) , y ( 2 ) , ⋯ , y ( N ) ] T α = ( a 1 , b 1 , ⋯ , a p , b p ) T E = [ n ( 1 ) , n ( 2 ) , ⋯ , n ( N ) ] T D ( ω k ) = [ cos ( ω k ) cos ( 2 ω k ) ⋯ cos ( N ω k ) sin ( ω k ) sin ( 2 ω k ) ⋯ sin ( N ω k ) ] T G ( ω ) = [ D ( ω 1 ) , D ( ω 2 ) , ⋯ , D ( ω p ) ] m × 2 p 则谐波模型(2)可改写为如下的矩阵形式： Y = G ( ω ) α + E (14) 于是，在求解得频率 ω 的估计值 ω ^ 后，上式的最小二乘解为： α ^ = [ G T ( ω ) G ( ω ) ] − 1 G T ( ω ) Y | ω = ω ^ (15) 在实际应用中，通常会出现低信噪比、样本量小或频率差小的情形，此时信号往往会被淹没掉，导致一些谱峰消失。此外，MUSIC算法需要给定准确的分量数才可以发挥其超分辨率，在分量数未知的情况下，若估计的分量数比实际的要少(即欠估计)，进行信号子空间和噪声子空间的划分时，由于部分信号子空间会被错分到噪声子空间中去，导致信号子空间的维数降低，从而也会使得一些谱峰消失。同样的，若估计的分量数比实际的要多(即过估计)，那么部分噪声子空间会被错分到信号子空间中去，导致噪声子空间的维数降低，信号子空间维数变多，此时谱峰会增加，即出现一些伪峰。 为在分量数未知的情况下也可以取得良好的凸峰效果，文献 [ 13 ] 考虑利用自相关矩阵的全部特征向量，利用权值控制不同特征向量对特征谱的作用，而适当的权系数可以减弱信号特征向量的作用，加弱权值的信号特征向量即相当于常规的MUSIC方法中只利用噪声特征向量的情形。 定义数据自相关矩阵的加权特征向量矩阵为： U = [ 1 λ 1 c μ 1 , 1 λ 2 c μ 2 , ⋯ , 1 λ m c μ M ] (16) 其中，指数c用来调节加权的效果。 于是新的MUSIC空间谱表示为： H ( ω ) = 1 tr [ B T ( ω ) U U T B ( ω ) ] (17) 利用上式，我们结合Prasad等 [ 11 ] 提出的逐步LSE算法，提出了一个简单的逐步估计算法，在谐波分量数未知情况下也可以取得良好的估计效果。 对原始数据 Y 的自相关矩阵做特征值分解，并构造加权左奇异矩阵 U ( 1 ) 。接着搜索对应的MUSIC空间谱的最大峰值，并利用式(15)求解得到振幅的估计，即： ω ^ 1 = argmax ω 1 tr [ B T ( ω ) U ( 1 ) U ( 1 ) T B ( ω ) ] (18) α ^ ( 1 ) = [ D T ( ω ) D ( ω ) ] − 1 D T ( ω ) Y | ω = ω ^ 1 (19) 则有 α ^ ( 1 ) = [ a ^ 1 ( 1 ) , b ^ 1 ( 1 ) ] T ， ( a ^ 1 ( 1 ) , b ^ 1 ( 1 ) , ω ^ 1 ) 是 ( a 1 0 , b 1 0 , ω 1 0 ) 的估计量。接着对原始数据做调整，即如下残差序列： Y ( 1 ) = Y − B ( ω ^ 1 ) α ^ ( 1 ) (20) 对调整后的数据 Y ( 1 ) 的自相关矩阵做特征值分解，并构造加权特征向量矩阵 U ( 2 ) 。接着搜索对应的MUSIC空间谱的最大峰值，即： ω ^ 2 = argmax ω 1 tr [ B T ( ω ) U ( 2 ) U ( 2 ) T B ( ω ) ] (21) 根据已有的频率估计量 ω ^ ( 2 ) = ( ω ^ 1 , ω ^ 2 ) ，利用式(22)求解前两个分量的振幅的估计量： α ^ ( 2 ) = [ G T ( ω ) G ( ω ) ] − 1 G T ( ω ) Y ( 1 ) | ω = ω ^ ( 2 ) (22) 则有 α ^ ( 2 ) = [ a ^ 1 ( 2 ) , b ^ 1 ( 2 ) , a ^ 2 ( 2 ) , b ^ 2 ( 2 ) ] T 。接着对原始数据做调整，即如下残差序列： Y ( 2 ) = Y − C ( ω ^ ( 2 ) ) α ^ ( 2 ) (23) 若谐波分量数p已知，我们将继续这一过程到第p步。加性噪声方差 σ 2 的估计给出为： σ ^ p 2 = 1 N [ Y ( p ) ] T Y ( p ) (24) 若p未知，我们将拟合到一个q阶模型，并给出对应的加性噪声方差的估计。然而q可能不等于p，且通常是一个大于p的整数。于是，我们可根据BIC准则选择分量数，针对加性高斯白噪声中的谐波模型，可给出BIC的形式如下： BIC ( k ) = N ln σ ^ k 2 + 3 k ln N (25) 对 k = 1 , ⋯ , q ，选取使得上式最小的k作为谐波分量数的估计。"
"在上节中，提出了加性噪声中谐波恢复的一种新方法——逐步MUSIC算法。本节将采用Mont Carol方法进行仿真实验，以展示我们算法的有效性。所有仿真实验均有MATLAB编写运行。 实验一 考虑以下谐波信号： x 1 ( t ) = ∑ k = 1 3 [ a k cos ( ω k t ) + b k sin ( ω k t ) ] + n ( t ) 其中， a 1 = 5 ， b 1 = 3 ， ω 1 = 0.4 ； a 2 = 4 ， b 2 = 2 ， ω 2 = 0.43 ； a 3 = 3 ， b 3 = 1.8 ， ω 3 = 0.5 。 n ( t ) 是零均值的高斯白噪声。 在谐波分量数已知的情况下，为考察本文算法在不同噪声情形下的性能，取不同信噪比分别为0和5，其中信噪比定义为： SNR = 10 log 10 min { a k 2 + b k 2 } 2 σ 2 为考察本文算法在不同样本下的性能，取不同样本量分别为 。 实验参数设置上，取观测向量长度为0.4倍样本量，频率估计采用峰值搜索法，取步长为0.0001。逐步MUSIC算法的权重参数c取0.5。进行200次Mont Carol实验。 Table 1 样本量 算法 Fr 实值MUSIC Real 0.400000 0.430000 0.500000 0.400000 0.430000 0.500000 AE 0.393588 0.430925 0.503629 0.400014 0.429950 0.500068 RMSE 2.94894e−2 1.36568e−2 2.17523e−2 7.39087e−4 8.64465e−4 8.06443e−4 逐步MUSIC Real 0.400000 0.430000 0.500000 0.400000 0.430000 0.500000 AE 0.400581 0.430229 0.499508 0.400266 0.429150 0.499930 RMSE 2.84268e−3 1.28117e−3 1.62281e−3 7.64199e−4 1.13932e−3 8.41665e−4 表1. 信噪比为0 dB时的频率估计结果 Table 2 样本量 算法 Fr 实值MUSIC Real 0.400000 0.430000 0.500000 0.400000 0.430000 0.500000 AE 0.399311 0.429568 0.499856 0.399998 0.429971 0.500018 RMSE 9.91469e−3 2.96737e−3 1.05010e−3 4.24853e−4 5.05371e−4 4.65510e−4 逐步MUSIC Real 0.400000 0.430000 0.500000 0.400000 0.430000 0.500000 AE 0.400115 0.430139 0.499498 0.400091 0.429628 0.499960 RMSE 1.60374e−3 6.62684e−4 1.05387e−3 4.42493e−4 5.92284e−4 4.65510e−4 表2. 信噪比为5 dB时的频率估计结果 在谐波分量数已知的情况下，从实验结果(表1和表2)得知，逐步MUSIC算法在高信噪比、样本量大时具有和实值MUSIC算法相当的估计性能；而在低信噪比、样本量小时，逐步MUSIC算法的估计性能超过了实值MUSIC算法。 实验二 考虑以下谐波信号： 其中， ， ， ； ， ， ； ， ， 。 是零均值的高斯白噪声。 在谐波分量数未知的情况下，我们将对 拟合谐波模型，取不同信噪比分别为−5 dB和0 dB，取样本量从 逐次递增10个到 ，最后采用BIC准则估计谐波分量数。 实验参数设置同实验一，进行500次Mont Carol实验。 图1. 不同信噪比和样本量情况下的分量数估计正确的概率 从图1的实验结果得知，在信噪比为0 dB时，逐步MUSIC算法相较于实值MUSIC算法具有更好的估计性能，且随着样本量增大分量数估计正确的概率接近于1。而在信噪比为−5 dB时，逐步MUSIC算法仍具有不错的估计准确率，但此时实值MUSIC算法已经完全失效。 综合实验一与实验二，可以得出本文所提出的逐步MUSIC算法相较于实值MUSIC算法具有更好的恢复效果。"
"本文将加性噪声中的实值MUSIC算法与逐步LSE算法相结合，提出了一种新的谐波恢复方法——逐步MUSIC算法，在谐波分量数未知的情况下，可利用该算法逐步估计出一个模型集，进而运用BIC准则估计出谐波分量数。仿真实验说明，与原有的实值MUSIC算法相比，逐步MUSIC算法具有更好的谐波恢复效果。"
