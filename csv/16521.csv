"谐波检测是有源电力滤波器(Active Power Filter, APF)的重要控制策略之一，当电网电压不平衡或畸变时，采用传统谐波检测方法会导致APF的谐波检测产生误差，最终的补偿效果变差。本文基于瞬时无功功率理论，推导了完美谐波消除法(Perfect Harmonic Cancellation, PHC)的补偿电流计算公式。PHC法检测谐波时提取了电网电压的正序基波分量，排除电网不平衡和畸变的影响，减小了谐波检测的误差。最后，本文对PHC法进行仿真验证，分别仿真了电网电压正常和电网电压畸变或畸变的情况，并与传统的p-q法和d-q法的补偿效果进行对比，证明了在电网电压不平衡或畸变的情况下，采用PHC法的APF具有更理想的补偿效果，验证了PHC法的正确性和优越性。 关键词 :有源电力滤波器，谐波检测，瞬时无功功率理论，完美谐波消除法"
"电力技术的发展为现代工业和人民生活带来巨大利益和便利，同时，它的非线性冲击性以及不平衡性给公用电网带来了大量谐波污染和无功问题，使得电能质量产生了明显的恶化。另一方面，由于数量众多的敏感设备接入电网进行使用，例如计算机，用户对公用电网的电能质量有着越来越高的要求。有源电力滤波器(Active Power Filter, APF)的出现能够很好的抑制和补偿谐波电流[ 1 ] -[ 8 ] 。 APF的控制策略包括以下两个环节：谐波检测和电流控制。谐波检测是解决谐波问题的一个重要手段[ 9 ] ，对抑制谐波有着重要的指导作用，是众多国内外学者致力研究的目标。基于此，国内外学者提出了诸多谐波检测的方法，时域中常用的方法包括基于三相瞬时无功功率理论的p-q法 [ 10 ] 、同步旋转坐标法(d-q法)和完美谐波消除法(Perfect Harmonic Cancellation, PHC) [ 11 ] [ 12 ] 等。其中p-q法在电网电压畸变或负载不对称时，无法有效地检测出谐波电流。在电网电压畸变或不对称时，d-q法的检测效果优于p-q法，但是补偿效果仍不理想。PHC法检测谐波时，以电网电压中的正序基波分量为基准，排除了电网电压畸变或者不对称带来的不利影响，补偿效果较好。 本文结合APF的工作原理，在瞬时无功功率理论的基础上推导出PHC法的补偿电流公式，然后搭建Matlab/Simulink仿真模型验证PHC法的优越性。"
"本文并联型APF为例，其结构如图1所示。并联型APF通过采样负载电流 来进行实时地计算，检测并提取出谐波分量 ，然后运用电流控制技术，使输出与谐波大小相同但方向相反的补偿电流 ，由于 ，其中 ，使电源电流 等于负载电流的基波分量 ，这样就可以补偿掉谐波[ 13 ] 。 谐波检测的目标是提取负载电流中的谐波分量 ，传统的谐波检测方法有基于瞬时无功功率理论的p-q法，以及来源于电机控制中dq变换的d-q法，PHC法是对p-q法以及d-q法的改进，它的目标是要消除所有的谐波电流以及基波无功功率，同时补偿不平衡，使得补偿后的电源电流对称正弦。如图2所示为三相并联APF的框图，设该电路中三相电压正序基波分量的瞬时值分别为 、 和 。将三相电网电压的正序基波分量变换到α-β坐标系下可得： 图1. 并联型APF系统结构 图2. APF结构框图 (1) 其中 。 因此根据瞬时无功功率理论可以得出负载的瞬时有功分量p以及瞬时无功分量q： (2) 其中 ， 、 为负载电流在α-β坐标系下的值。p、q可以分别表示为直流分量 、 与交流分量 、 之和，由此式(2)可化为： (3) 根据瞬时无功功率理论，当APF需要同时补偿谐波及无功时，负载侧参考电流为： (4) 因此，PHC法的补偿电流在α-β坐标系的等效值为： (5) 观察式(5)可以发现，PHC法的补偿电流采用电网电压的正序基波分量进行计算，当电网电压发生畸变或者不平衡时，正序基波分量保持不变，补偿电流的基准值不受影响。PHC法在电网电压畸变或者不平衡时，有很好的补偿效果。"
"本文使用Matlab/Simulink对三相三线APF的谐波检测方法进行建模，在不同的电网电压和负载条件下进行仿真，将PHC法与d-q法和p-q法的补偿效果进行对比。图3为d-q法仿真模型，图4为PHC法仿真模型，图5为p-q法仿真模型。  在三相电网电压正弦对称的条件下，补偿前A相电网电压、负载电流的仿真波形如图6(a)所示，图6(b)~(d)为分别使用三种谐波电流检测方法补偿后，电网电流、补偿电流的波形图。 仿真参数如下：三相电网电压为220 V/50 Hz，非线性负载为三相整流之后接2 mH电感和5欧电阻。使用powergui模块中的FFT Tools来测量THD，测得补偿之前负载电流THD为30.57%，使用d-q法、PHC法、p-q法补偿后电网电流的THD分别为9.91%、7.16%、8.42%。 从以上仿真波形和结果可以看出，当电网电压正弦对称时，三种算法均达到了不错的补偿效果。  在三相电网电压含谐波对称的条件下，补偿前的A相电网电压、负载电流的仿真波形如图7(a)所示，图7(b)~(d)为分别使用三种谐波电流检测方法补偿后，电网电流、补偿电流的波形图。 仿真参数如下：三相电网电压为三相220 V/50 Hz并加入35.4 V/250 Hz的三相谐波，负载为三相整流之后接2 mH电感和5欧电阻。使用powergui模块中的FFT Tools来测量THD，测得补偿前负载电流THD为31.51%，使用d-q法、PHC法、p-q法补偿后电网电流的THD分别为12.61%、7.89%、20.12%。 从以上仿真波形和结果可以看出，当电网电压含有谐波的时候，p-q法的谐波补偿效果很不理想，PHC法比较理想。  在三相电网电压含谐波不对称的条件下，补偿前的ABC相电网电压、ABC相负载电流的仿真波形如图8(a)所示，图8(b)~(d)为分别使用三种谐波电流检测方法补偿后，电网电流、ABC三相补偿电流的波形图。 仿真参数如下：三相电网电压为A、C相220 V/50 Hz，B相141 V/50 Hz并加35.4 V/250 Hz三相谐波，非线性负载为三相整流之后接2 mH电感和5欧电阻。使用powergui模块中的FFT Tools来测量THD，测得补偿前负载电流THD为29.00%，使用d-q法、PHC法、p-q法补偿后电网电流的THD分别为11.41%、7.99%、26.22%。 从以上仿真波形和结果可以看出，PHC法效果比较理想；p-q法受电网谐波和不对称的影响很大，补偿效果很差。 图3. d-q法仿真模型 图4. PHC法仿真模型 图5. p-q法仿真模型 图6. 电网电压正弦对称条件下的三种算法仿真波形图 图7. 电网电压含谐波条件下的三种算法仿真波形图 图8. 电网电压含谐波不对称条件下的三种算法仿真波形图"
"从以上仿真波形和结果可以看出，当电网电压对称正弦时，三种谐波电流检测方法均可以准确有效地检测出负载电流中所含的谐波电流分量。当电网电压出现非正弦或不对称时，d-q法和PHC法都有一定的补偿效果，由于PHC法考虑电源电压的基波正序分量，因而可以充分补偿掉谐波分量以及部分不对称分量，因此PHC法效果更好。综上所述，在三相非正弦不对称系统的应用场合，PHC法的补偿效果要好于d-q法和p-q法。"
