"针对交直流大电网调度培训仿真领域满足特定需求的运行方式调整工作量大、周期长、人工干预多的问题，提出基于灰色关联分析法的大电网调度培训基态潮流自动生成方法。定性分析了交直流大电网运行方式影响因素，划分为时间、气象、电网运行数据特征量三个维度；利用灰色关联分析法提出了运行方式综合相似度判据定量计算方法，并建立了相似日运行方式逐级筛选规则。以某实际电网为例，验证了方法的合理性、有效性。"
"基于基态潮流调整满足特定需求的目标运行方式是电网开展调度员培训演练的基本前提。电网潮流自动生成方法主要有基于人工经验法、基于相似日选择法和基于优化模型法三类 [ 1 ] [ 2 ] [ 3 ]。目前，在电网调度员培训演练中，采用的均为基于人工经验法，即在由实时状态估计获取的电网当前拓扑参数和运行方式数据的基础上，通过人工调整发电机开机方式、变压器分接头等控制变量，得到收敛的初始潮流，并在此基础上进一步调整发电机开机方式、负荷、联络线功率、中枢点电压等运行参数至目标值。此方法无需建模、编写算法和程序，在系统规模不发生变化的情况下具有一定的实用性，但是，对方式设计及调整人员要求均较高，需要对电网结构、运行特点非常熟悉，而且随着特高压交直流的建设、新能源的并网，电网结构越来越复杂，运行风险分析越来越困难，人工调整难度越来越大，耗时越来越长，调整分调规模的电网方式一般需要至少一周的时间。基于相似日选择的潮流调整法通过建模、量化待选方式与目标方式的综合相似度，利用算法进行计算比较，选择相似日潮流作为基准潮流，从中获得无功电压数据 [ 4 ]。灰色关联分析法对于一个系统发展变化态势提供了量化的度量，非常适合动态历程分析，在工程实际中得到广泛应用 [ 5 ] [ 6 ]。相对于人工经验法及基于优化模型法，基于相似日选择的潮流调整法考虑因素更为全面、计算结果更清晰、准确度更高，能得到收敛性更好的电网基态潮流，且模型复杂程度不高，可以显著减少人工调整运行方式的工作量，目前在电网运行规划、安全校核、负荷预测等领域中已得到广泛应用 [ 7 ] - [ 12 ]，但尚未在电网调度培训演练系统中推广应用。电网调度员培训演练应用场景中，由于具有在线的电网调度自动化系统的数据支撑，电网历史运行方式完备，且数据完整性、准确性较高，具备采用基于相似日选择的潮流调整法调整目标运行方式的基本条件。 为此，本文提出了适用于电网调度员培训演练应用场景的基于相似日选择的基态潮流自动生成方法。根据大电网调度培训应用场景下电网运行方式调整的需求特点，从时间、气象、电网运行数据特征量三个维度定性分析了交直流大电网运行方式影响因素，利用灰色关联分析法建立了由气象匹配度、时间匹配度、电网运行数据特征匹配度三部分组成的综合相似度计算模型，并制定了筛选优先级规则，以提高相似日方式计算速度。"
"灰色关联分析法是一种基于灰色系统理论的分析多因素不确定系统的统计分析方法，其基本思想是：以因素的数据序列为依据，用数学的方法研究因素间的几何对应关系，即序列曲线的几何形状越接近，则它们之间的灰色关联度越大，反之越小。 利用灰色关联分析法求解问题的一般步骤是：首先，通过定性分析，确定系统的特征行为及相关因素，并形成系统特征行为及因素的数据序列；然后，无量纲化及数值映射，由于系统特征行为及因素很可能具有不同量纲的物理量且其相互间的关联性可能存在负相关，因此，需要对于其数据序列进行去量纲及逆化负相关为正相关的处理(即数值映射)。  影响电网发、输、配、变、用各个环节的因素有很多，尤其是大规模新能源并网后，仅气象因素就包括风力、风速、风向、日照、降水量等，建立合理的分析维度，确定影响电网运行方式的关键因素是计算电网运行方式综合相似度的基础。 在大电网调度培训应用场景下，待调整的目标运行方式一般为近期或未来短时间内电网的典型运行方式，如丰大、丰小、枯大、枯小等，同时，可供选择的历史运行方式时间尺度可以精确到日内分钟级，且潮流计算结果完整、合理。因此，影响电网运行方式的因素可以分为时间、气象、电网运行数据特征量三个维度，具体包括： 1) 时间维度，包括：时间匹配度(日级、时间段或时刻级)、日类型(工作日、休息日、特殊日)。 2) 气象维度，包括：季节、气温、降水量。 3) 电网运行数据特征量维度，对于区域电网，运行数据特征量包括：电网拓扑结构(500kV以上)、跨区联络线传输功率、重要机组的开机方式、全网总出力、全网总负荷、跨省联络线传输功率、各省总出力、各省总负荷、中枢点电压水平。  基于灰色关联分析法建立电网运行方式综合相似度判据，如下式所示： max i S i m ( x i , x 0 ) (1) 其中，综合相似度由气象匹配度、时间匹配度、电网运行数据特征匹配度三部分组成，计算公式如下： S i m ( x i , x 0 ) = ∏ w ∈ W η i ( w ) × δ i ( t ) × ∏ k ∈ K λ i ( k ) (2) 式中， x 0 为目标运行方式； x i 为历史运行方式i；W为气象特征量w的集合，包含气温和降水量；K为电网运行数据特征量k的集合，由历史运行方式i与目标运行方式共同决定； η i ( w ) 、 δ i ( t ) 、 λ i ( k ) 分别为历史运行方式i与目标运行方式的气象特征量w的关联系数、时间匹配度及电网运行数据特征量k的关联系数。 1) 气象特征量关联系数 η i ( w ) 的计算方法 气象特征量关联系数 η i ( w ) 用于量化历史运行方式与目标运行方式在气象维度上的相似程度。其中，气象特征量包括气温和降水量两个。采用灰色关联分析法计算气象特征量关联系数，计算公式如下： η i ( w ) = min i min w Δ ′ i ( w ) + ρ max i max w Δ ′ i ( w ) Δ ′ i ( w ) + ρ max i max w Δ ′ i ( w ) (3) Δ ′ i ( w ) = Δ i ( w ) − min i Δ i ( w ) max i Δ i ( w ) − min i Δ i ( w ) (4) Δ i ( w ) = | X i ( w ) − X 0 ( w ) | (5) X i ( w ) = { T i             当 计 算 气 温 关 联 系 数 时 H i             当 计 算 降 水 量 关 联 系 数 时 (6) 式中， X i ( w ) 为历史运行方式i对应的气象特征量w的数值； T i 为历史运行方式i对应的气温值，℃； H i 为历史运行方式i对应的降水量，mm； Δ i ( w ) 为历史运行方式i与目标运行方式的气象特征量w的绝对差值； Δ ′ i ( w ) 为 Δ i ( w ) 的归一化值(无量纲化)； ρ 为分辨系数，一般取0.5； min w Δ ′ i ( w ) 为历史运行方式i 与目标运行方式的气象特征量w差值的最小值； max w Δ ′ i ( w ) 为历史运行方式i与目标运行方式的气象特征量w差值的最大值； min i min w Δ ′ i ( w ) 为所有历史运行方式中与目标运行方式的气象特征量w差值最小的特征值； max i max w Δ ′ i ( w ) 为所有历史运行方式与目标运行方式的气象特征量w差值最大的特征值。 2) 时间匹配度 δ i ( t ) 的计算方法 时间匹配度 δ i ( t ) 用于量化历史运行方式与目标运行方式在时间维度上的相似程度。时间特征量包括日类型和天数差两个，计算方法如下： δ i ( t ) = max [ α , β 1 ( 1 − s i ) int ( t / N 1 ) β 2 s i int ( t / N 2 ) ] (7) 式中： β 1 、 β 2 分别为历史运行方式i日期与目标运行方式日期的距离每增加1周和1年的相似度衰减系数，一般取0.9～0.98；t为历史运行方式i与目标运行方式的天数差； N 1 、 N 2 为常数， N 1 取值为一周的天数7，考虑到特殊日(如春节等节假日)之间的距离小于365天， N 2 取值为340。 上式中各参数含义详细说明如下： i) α ——时间匹配度下限值 天数差对电网运行方式的影响具有明显的饱和效应。例如,历史日与目标日相隔1天或相隔1星期,其电网运行方式与目标日的相似度有明显区别；但历史日与目标日相隔3星期或4星期,其相似度则没有明显区别。一些地区，夏季可能出现持续20天甚至更长时间的高温天气，然后出现降雨、突然降温，在近20天没有相似日，而如果该相似度按照某一个衰减系数持续衰减，则距离远的日期没有入选的可能性较大，影响相似度判断的准确性。因此，对于时间匹配度需设定其下限值，一般取0.1。 ii) s i ——日类型标志量 一般地，日类型划分为工作日、公休日、节假日，根据这三种类型对电网负荷水平等方面影响程度的高低，将工作日与公休日合并考虑，计为非节假日，其时间相似度以1星期(即7天)为周期计算；节假日的时间相似度以1年(340天)为周期计算。即，当历史运行方式i与目标运行方式均为节假日时， s i 取1，否则， s i 取0。 3) 电网运行数据特征量关联系数 λ i ( k ) 的计算方法 电网运行数据特征量关联系数 λ i ( k ) 用于量化历史运行方式与目标运行方式在电网运行数据特征量维度上的相似程度。对于区域电网，电网运行数据特征量包括：跨区联络线传输功率、跨省联络线传输功率、重要机组的开机方式、各省网总出力、各省网总负荷、中枢点电压水平(这些特征量支持用户在已有电网运行参数的范围内进行灵活增、减)。采用灰色关联分析法计算电网运行数据特征量关联系数，计算公式如下： λ i ( k ) = min i min k Δ ′ i ( k ) + ρ max i max k Δ ′ i ( k ) Δ ′ i ( k ) + ρ max i max k Δ ′ i ( k ) (8) Δ ′ i ( k ) = Δ i ( k ) − min i Δ i ( k ) max i Δ i ( k ) − min i Δ i ( k ) (9) Δ i ( k ) = | X i ( k ) − X 0 ( k ) | (10) X i ( k ) = { p r j c i               当 计 算 跨 区 联 络 线     j     功 率 关 联 系 数 时 ( j = 1 , ⋯ , n 1 ) p p j c i             当 计 算 跨 省 联 络 线     j     功 率 关 联 系 数 时 ( j = 1 , ⋯ , n 2 ) p G j i             当 计 算 重 要 机 组     j     有 功 出 力 关 联 系 数 时 ( j = 1 , ⋯ , n 3 ) p p G j i           当 计 算 省 网     j     全 网 总 出 力 关 联 系 数 时 ( j = 1 , ⋯ , n 4 ) p p L j i           当 计 算 省 网     j     全 网 总 负 荷 关 联 系 数 时 ( j = 1 , ⋯ , n 4 ) U m i             当 计 算 中 枢 点     m     电 压 幅 值 关 联 系 数 时 ( m = 1 , ⋯ , n 5 ) (11) 式中， X i ( k ) 为历史运行方式i中电网运行数据特征量k的数值； X 0 ( k ) 为目标运行方式中电网运行数据特征量k的数值， X i ( k ) 与 X 0 ( k ) 指历史运行方式i与目标运行方式中相同设备相同运行参数的数值，与k值无关； p r j c i 、 p p j c i 、 p G j i 、 p p G j i 、 p p L j i 、 U m i 分别为历史运行方式i的跨区联络线j功率值、跨省联络线j功率值、重要机组j有功出力值、省网j的全网总出力值、省网j的全网总负荷值、中枢点m电压幅值； n 1 , ⋯ , n 5 分别表示历史运行方式i中跨区联络线条数、跨省联络线条数、重要机组数量、省网个数、中枢点个数； Δ i ( k ) 为历史运行方式i与目标运行方式的电网运行数据特征量k的绝对差值； Δ ′ i ( k ) 为 Δ i ( k ) 的归一化值(无量纲化)； ρ 为分辨系数，一般取0.5； min k Δ ′ i ( k ) 为历史运行方式i与目标运行方式的电网运行数据特征量k差值的最小值； max k Δ ′ i ( k ) 为历史运行方式i与目标运行方式的电网运行数据特征量k差值的最大值； min i min k Δ ′ i ( k ) 为所有历史运行方式中与目标运行方式的电网运行数据特征量k差值最小的特征值； max i max k Δ ′ i ( k ) 为所有历史运行方式与目标运行方式的电网运行数据特征量k差值最大的特征值。"
"考虑到计算量和计算速度，采用分级筛选的方法筛选最终综合相似度最高的运行方式。筛选优先级顺序如图1所示。首先，根据实际需求，设置历史运行方式年度范围，例如：选择近两年所有日内运行方式。然后，计算季节相似度，选择季节相似运行方式集合，例如：近两年所有夏季日内运行方式。接着，计算气象相似度，进一步选择气象相似度较高的方式集合。计算该集合内所有方式的综合相似度，进而筛选出相似度最高的运行方式。"
"以某区域电网为例，目标运行方式为2020年迎峰度夏联合反事故演习初始运行方式，时间、气象、电网运行数据特征量目标值如表1所示。历史运行方式为2017年1月1日~2020年4月7日每日96点日内实际运行方式，与目标运行方式综合相似度排序前5的计算结果如表2所示。 图1. 相似运行方式逐级筛选规则 Table 1 时间 7月、工作日、18:00~21:00 (高峰时段) 气温 37℃ 降水量 46 mm 直流系统A运行方式 −6400 MW 直流系统B运行方式 −7200 MW 直流系统C运行方式 5400 MW 省间断面A运行方式 2600 MW 省间断面B运行方式 900 MW 省间断面C运行方式 2200 MW 全网负荷 145300 MW A省负荷 36300 MW B省负荷 28400 MW C省负荷 59100 MW D省负荷 21500 MW 表1. 某电网运行方式特征量目标值 Table 2 排序 断面名称 气象匹配度 时间匹配度 电网运行特征匹配度 综合相似度 1 20190726200146 0.7831 0.6826 0.9235 0.4937 2 20190726193042 0.7317 0.6879 0.8709 0.4384 3 20190726202613 0.7423 0.6912 0.8086 0.4149 4 20190726194527 0.7481 0.6712 0.8141 0.4088 5 20190726191527 0.7380 0.6242 0.8793 0.4051 表2. 综合相似度计算结果 由表2可知，2019年7月26日20:01的历史运行方式与2020年迎峰度夏联合反事故演习初始运行方式综合相似度最高，应选为基态潮流。同时，为了说明设定相似日运行方式逐级筛选规则的必要性，分别测算了采用逐级筛选规则与不采用逐级筛选规则的计算速度。测试结果为：当采用逐级筛选规则时，计算时间为64.24秒；当不采用逐级筛选规则时，计算规模将大幅度增加，计算时间为1373秒。"
"本文提出了基于灰色关联分析法的大电网调度培训基态潮流自动生成方法。根据大电网调度培训应用场景下电网运行方式调整的需求特点，从时间、气象、电网运行数据特征量三个维度定性分析了交直流大电网运行方式影响因素，利用灰色关联分析法建立了由气象匹配度、时间匹配度、电网运行数据特征匹配度三部分组成的综合相似度计算模型，并制定了筛选优先级规则，提高相似日方式计算速度。某实际区域电网应用验证了该方法的正确性和实用性。"
