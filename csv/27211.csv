"基于空间变系数模型的局部非线性GWR拟合方法的基础上，给出了空间变系数模型的局部非线性BGWR拟合方法。通过Gibbs抽样得到模型参数在各个地理位置处的估计值。同时，设计模拟实验，通过可视化形式，将该方法与局部非线性GWR估计方法作对比，显示出局部非线性BGWR方法的精确性。 关键词 :空间变系数模型，局部非线性GWR，局部非线性BGWR，Gibbs抽样 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"空间变系数模型是线性模型适应空间数据的进一步推广，它将数据的地理位置引入回归系数中，以系数函数在空间位置处的估计值来分析回归关系的空间非平稳性特征，该模型满足了人们对处理空间问题的需要。 Brunsdon等 [ 1 ] 首次明确提出了空间变系数模型，同时给出了该模型的地理加权回归(geographical weighed regression，简称GWR)方法，即以观测点之间的距离函数为权值的非参数光滑估计方法。Wang Ning等 [ 2 ] [ 3 ] 将变系数模型的局部线性拟合方法推广到空间变系数模型的情况，给出了局部线性GWR方法。程鹏鹏 [ 4 ] 提出了局部非线性GWR拟合方法，在降低系数函数估计的偏和边界效应上较局部线性GWR方法更显著。LeSage [ 5 ] [ 6 ] 提出了贝叶斯地理加权回归(Bayesian geographical weighed regression，简称BGWR)模型，首先运用Gibbs抽样技术给出一组参数用来修正异常观测值，由贝叶斯公式得到待估参数的条件后验概率 [ 7 ] ，保证估计结果的稳健性，之后再根据GWR方法的原理进行估计。冯金杰 [ 8 ] 通过空间加权距离构造权重矩阵，基于多元线性回归模型的贝叶斯统计推断 [ 9 ] ，得到了该模型的局部线性BGWR估计方法。 本文在局部线性BGWR拟合方法的基础上，给出空间变系数模型的局部非线性BGWR估计方法，推导出各回归系数的满条件后验分布，采取Gibbs抽样方法得到模型参数的估计。通过模拟，将此方法的参数拟合结果可视化、计算偏差均值和标准差均值，并与局部非线性GWR估计方法的结果进行对比分析。"
"本文的空间变系数自回归模型为： Y i = ∑ j = 1 p β j ( u i , v i ) X i j + ε i ,       i = 1 , 2 , ⋯ , n (1) 令模型中的 X i 1 ≡ 1 是模型所包含得空间截距项， Y = ( Y 1 , Y 2 , ⋯ , Y n ) T ， ε ~ N n ( 0 , σ 2 I n ) ε = ( ε 1 , ε 2 , ⋯ , ε n ) T ，由泰勒公式知在 ( u 0 , v 0 ) 的邻域内 β j ( u , v ) 可进行二阶泰勒展开，并用u和v的二次函数作逼近，即有 β j ( u , v ) ≈ β j ( u 0 , v 0 ) + β j ( u ) ( u 0 , v 0 ) ( u − u 0 ) + β j ( v ) ( u 0 , v 0 ) ( v − v 0 ) + 1 2 ! β j ( u u ) ( u 0 , v 0 ) ( u − u 0 ) 2                                 + 1 2 ! β j ( v v ) ( u 0 , v 0 ) ( v − v 0 ) 2 + 1 2 ! β j ( u v ) ( u 0 , v 0 ) ( u − u 0 ) ( v − v 0 ) (2) 其中 β j ( u ) ( u 0 , v 0 ) ， β j ( v ) ( u 0 , v 0 ) ， β j ( u u ) ( u 0 , v 0 ) ， β j ( v v ) ( u 0 , v 0 ) ， β j ( u v ) ( u 0 , v 0 ) 分别表示 β j ( u , v ) 关于u和v的一阶、二阶偏导数在 ( u 0 , v 0 ) 处的值。根据变系数模型的局部非线性拟合及GWR方法，选取未知参数 β j ( u 0 , v 0 ) ， β j ( v ) ( u 0 , v 0 ) ， β j ( u u ) ( u 0 , v 0 ) ， β j ( v v ) ( u 0 , v 0 ) 和 β j ( u v ) ( u 0 , v 0 ) ( j = 1 , 2 , ⋯ , q ) ，使得： ∑ i = 1 n [ Y i − ∑ j = 1 p ( β j ( u 0 , v 0 ) + β j ( u ) ( u 0 , v 0 ) ( u − u 0 ) + β j ( v ) ( u 0 , v 0 ) ( v − v 0 ) + 1 2 ! β j ( u u ) ( u 0 , v 0 ) ( u − u 0 ) 2 + 1 2 ! β j ( v v ) ( u 0 , v 0 ) ( v − v 0 ) 2 + β j ( u v ) ( u 0 , v 0 ) ( u − u 0 ) ( v − v 0 ) ) X i j ] 2 K h ( d 0 i ) (3) 达到最小，其中 ( Y i , X i 1 , X i 2 , ⋯ , X i p − 1 , X i p ) 分别为因变量Y和自变量 X 1 , X 2 , ⋯ , X p − 1 , X p 在地理位置 ( u i , v i ) 处的观测值， d 0 i 为 ( u 0 , v 0 ) 到 ( u i , v i ) 的距离， K h ( d 0 i ) = K ( d 0 i h ) = ω i ( u 0 , v 0 )     ( i = 1 , 2 , ⋯ , n ) W ( u 0 , v 0 ) = D i a g ( ω 1 ( u 0 , v 0 ) , ω 2 ( u 0 , v 0 ) , ⋯ , ω n ( u 0 , v 0 ) ) 令 P ( u 0 , v 0 ) = [ β 1 ( u 0 , v 0 ) , ⋯ , β p ( u 0 , v 0 ) , β 1 ( u ) ( u 0 , v 0 ) , ⋯ , β p ( u ) ( u 0 , v 0 ) ,           β 1 ( v ) ( u 0 , v 0 ) , ⋯ , β p ( v ) ( u 0 , v 0 ) , ⋯ , β 1 ( u u ) ( u 0 , v 0 ) , ⋯ , β p ( u u ) ( u 0 , v 0 ) ,           β 1 ( v v ) ( u 0 , v 0 ) , ⋯ , β p ( v v ) ( u 0 , v 0 ) , β 1 ( u v ) ( u 0 , v 0 ) , ⋯ , β p ( u v ) ( u 0 , v 0 ) ] T 设计矩阵为 X ( u 0 , v 0 ) = ( A 1 , A 2 , A 3 , A 4 ) ，其中： A 1 = ( X 11 ⋯ X 1 , p − 1 X 1 p X 21 ⋯ X 2 , p − 1 X 2 p ⋮ ⋮ ⋮ X n 1 ⋯ X n , p − 1 X n p ) A 2 = ( X 11 ( u 1 − u 0 ) ⋯ X 1 , p − 1 ( u 1 − u 0 ) X 1 p ( u 1 − u 0 ) X 21 ( u 2 − u 0 ) ⋯ X 2 , p − 1 ( u 2 − u 0 ) X 2 p ( u 2 − u 0 ) ⋮ ⋮ ⋮ X n 1 ( u n − u 0 ) ⋯ X n , p − 1 ( u n − u 0 ) X n p ( u n − u 0 )     X 11 ( v 1 − v 0 ) ⋯ X 1 , p − 1 ( v 1 − v 0 ) X 1 p ( v 1 − v 0 ) X 21 ( v 2 − v 0 ) ⋯ X 2 , p − 1 ( v 2 − v 0 ) X 2 p ( v 2 − v 0 ) ⋮ ⋮ ⋮ X n 1 ( v n − v 0 ) ⋯ X n , p − 1 ( v n − v 0 ) X n p ( v n − v 0 ) ) A 3 = ( X 11 ( u 1 − u 0 ) 2 ⋯ X 1 , p − 1 ( u 1 − u 0 ) 2 X 1 p ( u 1 − u 0 ) 2 X 21 ( u 2 − u 0 ) 2 ⋯ X 2 , p − 1 ( u 2 − u 0 ) 2 X 2 p ( u 2 − u 0 ) 2 ⋮ ⋮ ⋮ X n 1 ( u n − u 0 ) 2 ⋯ X n , p − 1 ( u n − u 0 ) 2 X n p ( u n − u 0 ) 2 X 11 ( v 1 − v 0 ) 2 ⋯ X 1 , p − 1 ( v 1 − v 0 ) 2 X 1 p ( v 1 − v 0 ) 2 X 21 ( v 2 − v 0 ) 2 ⋯ X 2 , p − 1 ( v 2 − v 0 ) 2 X 2 p ( v 2 − v 0 ) 2 ⋮ ⋮ ⋮ X n 1 ( v n − v 0 ) 2 ⋯ X n , p − 1 ( v n − v 0 ) 2 X n p ( v n − v 0 ) 2 ) A 4 = ( X 11 ( u 1 − u 0 ) ( v 1 − v 0 ) ⋯ X 1 , p − 1 ( u 1 − u 0 ) ( v 1 − v 0 ) X 1 p ( u 1 − u 0 ) ( v 1 − v 0 ) X 21 ( u 2 − u 0 ) ( v 2 − v 0 ) ⋯ X 2 , p − 1 ( u 2 − u 0 ) ( v 2 − v 0 ) X 2 p ( u 2 − u 0 ) ( v 2 − v 0 ) ⋮ ⋮ ⋮ X n 1 ( u n − u 0 ) ( v n − v 0 ) ⋯ X n , p − 1 ( u n − u 0 ) ( v n − v 0 ) X n p ( u n − u 0 ) ( v n − v 0 ) ) 则局部非线性GWR方法的系数函数估计值为： B ^ ( u 0 , v 0 ) = [ X T ( u 0 , v 0 ) W ( u 0 , v 0 ) X ( u 0 , v 0 ) ] − 1 X T ( u 0 , v 0 ) W ( u 0 , v 0 ) Y (4) 于是有， ，因此似然函数为： L [ B ( u 0 , v 0 ) , σ ] = ( 1 2 π σ 2 ) n 2 exp { − 1 2 σ 2 [ Y − X ( u 0 , v 0 ) B ( u 0 , v 0 ) ] T [ Y − X ( u 0 , v 0 ) B ( u 0 , v 0 ) ] } = ( 1 2 π σ 2 ) n 2 exp { − 1 2 σ 2 [ [ Y − X ( u 0 , v 0 ) B ^ ( u 0 , v 0 ) ] T [ Y − X ( u 0 , v 0 ) B ^ ( u 0 , v 0 ) ] + [ B ( u 0 , v 0 ) − B ^ ( u 0 , v 0 ) ] T X T ( u 0 , v 0 ) X ( u 0 , v 0 ) [ B ( u 0 , v 0 ) − B ^ ( u 0 , v 0 ) ] ] } = ( 1 2 π σ 2 ) n 2 exp { − 1 2 σ 2 [ Z n 2 ( n − 6 p ) + [ B ( u 0 , v 0 ) − B ^ ( u 0 , v 0 ) ] T ⋅ X T ( u 0 , v 0 ) X ( u 0 , v 0 ) [ B ( u 0 , v 0 ) − B ^ ( u 0 , v 0 ) ] ] } 其中 Z n 2 = [ Y − X ( u 0 , v 0 ) B ^ ( u 0 , v 0 ) ] T [ Y − X ( u 0 , v 0 ) B ^ ( u 0 , v 0 ) ] / ( n − 6 p ) 。 若取 π [ B ( u 0 , v 0 ) | σ ] ∝ 1 ， π ( σ ) ∝ 1 σ ，那么由贝叶斯定理可知 π ( B ( u 0 , v 0 ) , σ ) ∝ 1 σ ， σ > 0 ，且参数 β 的满条件后验分布为： π ( β ( u 0 , v 0 ) | Y , X ) ∝ L ( β ( u 0 , v 0 ) , σ | Y , X ) π ( β ( u 0 , v 0 ) , σ ) ∝ M t 3 p ( v , β ^ ( u 0 , v 0 ) , Q 0 ) (6) 其中自由度为 v = n − 6 p ，位置参数为 β ^ ( u 0 , v 0 ) ，精度矩阵为 ， Z n 2 = [ Y − X ( u 0 , v 0 ) β ^ ( u 0 , v 0 ) ] T [ Y − X ( u 0 , v 0 ) β ^ ( u 0 , v 0 ) ] / ( n − 6 p ) . 方差 σ 2 的满条件后验分布为： π ( σ 2 | Y , X ) ∝ 1 σ n + 2 exp { − ( n − 6 p ) Z n 2 2 σ 2 } ∝ I G a m m a ( n + 1 , v Z n 2 / 2 ) (7) 其中形状参数为 n + 1 ，尺度参数是 v Z n 2 / 2 。"
"本模拟实验，指定一个正方形区域，以此区域左下角为坐标原点建立直角坐标系，将横、纵坐标进行 m − 1 等分处理，以坐标系中每个点作为地理位置 ( u i , v i ) ，则样本容量为 n = m 2 。我们取 m = 25 ，有 n = 625 ，在如上建立的直角坐标系下，观测点地理位置坐标可表示为： ( u i , v i ) = ( 0.5 mod ( i − 1 25 ) , 0.5 int ( i − 1 25 ) ) , i = 1 , 2 , ⋯ , n 其中 mod ( ( i − 1 ) / m ) 表示 i − 1 除以m的余数， int ( ( i − 1 ) / m ) 表示 i − 1 除以m的商的整数部分。 从而用以产生数据的空间变系数模型为： Y i = β 1 ( u i , v i ) + β 2 ( u i , v i ) X i + ε i ,     i = 1 , 2 , ⋯ , n 其中，自变量观测值 X 1 , X 2 来自均匀分布 U ( 0 , 2 ) 中的n个随机数，误差 ε 1 , ε 2 , ⋯ , ε n 来自正态分布 N ( 0 , 0.25 ) 中的n个随机数。选取系数函数 β 1 ( u , v ) 和 β 2 ( u , v ) ： β 1 ( u , v ) = 1 6 ( u + v ) ,     β 2 ( u , v ) = 1 3 u 在模拟实验中，选择高斯函数作为核函数，光滑参数h可使用CV准则来确定。根据已推出的参数的满条件后验分布，通过Gibbs抽样实现参数的 β ( u 0 , v 0 ) 和 σ 2 的估计，让 ( u 0 , v 0 ) 遍历所有位置，可得到所有点的系数估计值。 绘制出 β 1 ， β 2 的初值曲面图(如图1)和各回归系数函数在不同参数估计方法下的估计曲面图(如图2a，2b)。相比之下，局部非线性BGWR估计方法得到的系数曲面更接近原曲面的基本特征，而局部非线性GWR估计得到的曲面边界较为粗糙。因此，在对模型系数函数估计时，局部非线性BGWR估计方法更具精确性。 分别计算两种估计方法的绝对偏差MBias和均方误差MSE的值，结果如表1。不难发现，局部非线性BGWR方法估计相比局部非线性GWR方法的 M B i a s ( β ^ j ) 和 M S E ( β ^ j ) 的值要小一些，说明局部非线性BGWR方法估计系数函数估计的精确度相比较高。 图1. 系数函数初值曲面图 图2. (a) 局部非线性GWR拟合方法的模型系数函数估计值，(b) 局部非线性BGWR拟合方法的模型系数函数估计值 Table 1 MBais MSE 局部非线性BGWR 局部非线性GWR 局部非线性BGWR 局部非线性GWR β 1 ( u , v ) 0.0912 0.2086 0.0173 0.0691 β 2 ( u , v ) 0.0887 0.0707 0.0149 0.0176 表1. 估计值MBias和MSE结果"
"本文基于对空间变系数模型的参数拟合方法研究的思想，结合局部非线性GWR方法和贝叶斯方法，提出局部非线性BGWR拟合方法，推导出各参数的满条件后验分布，采用Gibbs抽样技术得到模型的系数函数估计值。同时，本文设计模拟实验，通过可视化形式，展现出局部非线性BGWR和局部非线性GWR方法的参数拟合效果，结果显示，采用局部非线性BGWR方法估计的各估计值的绝对偏差、均方误差值和系数函数拟合图均优于局部非线性GWR参数拟合方法。"
