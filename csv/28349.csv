"针对传统腰颈椎牵引设备牵引方式单一，不能满足病患不同的症状治疗，本文提出一种多功能腰颈椎电动康复牵引床智能控制系统。采用闭环控制方式，在单片机的控制下接收触摸屏输入和拉力传感器输入，驱动电机带动牵引机构实现牵引活动，同时将输入参数和运行状态输出显示，是一种数字式触摸屏用户界面的牵引装置。用户可以根据需要设定具有保持、休息和治疗时间的静态(持续)、间断和循环牵引功能，并能够用坐标图实时显示牵引力工作状态。通过设定持续时间和拉力大小，持续牵引床体，使颈、腰椎处于被牵引的状态，从而实现对腰颈椎疾病的治疗。实验结果表明：该牵引装置不仅具有较好动态响应性能、实现牵引力的精准控制、良好的人机交互、患者信息存储和动态显示牵引力大小，而且具有较好的治疗效果，牵引过程更加平稳、安全、可靠。 关键词 :腰颈椎牵引，保持时间，牵引力，动态牵引，智能控制系统 Copyright © 2019 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"随着社会竞争加剧和生活条件改善，高速发展的现代社会使人们生活方式以及生活环境都发生巨大变化。腰颈椎病是一种严重影响人们工作生活能力的常见病、多发病。人们的身体多数处于亚健康状态，由于人体长时间缺乏活动锻炼，工作姿势长期不正确，持续时间较长，极易造成肌肉无力，血液循环不畅，引起肌肉韧带等软组织慢性劳损，导致腰椎、颈椎外源性不平衡，致使患病人群在加速增大。据国家卫生部统计，我国腰椎病患者己突破2亿，腰间盘突出症患者占全国总人数的15.2%，因腰椎病而丧失生活自理能力的人数仅次于脑血管病名列第二 [ 1 ] [ 2 ] 。多年以来腰颈椎病患者一直呈上升趋势，而且逐年以惊人的速度由中老年向青壮年扩展，腰颈椎疾病己逐渐成为威胁人民健康，阻碍经济文化发展的重要疾病之一 [ 2 ] [ 3 ] [ 4 ] [ 5 ] 。医学上治疗腰椎、颈椎疾病，一般采用推拿按摩的方法进行治疗，但是，由于医师推拿按摩过程不可能太久而且力度变化也不够精准，因此有必要借助先进医疗器械来对腰椎、颈椎病患者进行治疗。 我国的许多学者对腰颈椎牵引治疗系统进行了大量研究，山东建筑大学刘兆峰设计了一种新型随动慢牵治疗仪与信息管理系统，用于对腰椎、颈椎病的患者进行治疗，这种随动慢牵治疗仪采用永磁同步电机作为动力源，建立了随动慢牵治疗仪的矢量控制系统，研究了矢量控制的数学模型和矢量控制算法，并对矢量控制下的系统进行了仿真 [ 6 ] ；哈尔滨工业大学刘健根据牵引手法治疗机理，设计了一种主要适用于家庭的新型腰椎间盘康复机构 [ 7 ] ；山东大学仲为武采用混合式直流电机作为动力源，设计了三维牵引床 [ 8 ] 等。但是，针对牵引治疗过程中存在的非线性和时变性的特点，上述牵引治疗设备的控制系统仅仅注重了功能的实现，牵引力的控制精度不高，直接影响牵引治疗效果。针对此研究现状，笔者提出一种多种执行结构联合执行以实现复合式牵引的多功能腰颈椎电动康复牵引床智能控制系统。为了达到理想的治疗效果，要求牵引治疗仪在施力过程中，既要精准，又要缓慢，牵引力不可有大的波动。因此，在电机速度控制环节提出一种基于指数趋近率的滑模变结构控制策略；同时，针对永磁无刷直流电机运行过程中换相转矩波动问题，提出一种基于泛模型思想与预测控制的无模型预测控制方法，该方法能够很好抑制无刷直流电机换相时的转矩波动。为了提高传感器的稳定性及其精度，消除非目标参量对传感器输出特性的影响，本文提出一种基于BP神经网络的数据融合算法。"
"电动康复牵引床主要任务是实现角度、拉力的动态变化并加以控制，对患者的病例和治疗情况进行存储，从而达到治疗腰、颈椎疾病的目的。为了实现牵引角度、牵引力的动态变化和精准控制，系统采用无刷直流电机提供动力，并对电动康复牵引床的电机控制策略进行研究，使牵引力和牵引角度得到更加精准的控制。下位机完成实时控制，上位机(触摸屏)与单片机通过串口通讯，完成参数的设定、指令的发出、数据库的建立、状态的实时监控等。在上位机软件设计时，采用C编程语言建立良好的人机交互界面，通过人机界面完成参数和命令的输入，并获得牵引力的反馈数据，实时动态显示牵引力的变化。电动康复牵引床功能模块如图1所示。 图1. 电动康复牵引床控制系统总体结构 电动康复牵引床主要包括腰椎牵引治疗、颈椎牵引治疗、参数设置、病人数据库管理、绳子释放以及按键控制、床体位置调整、紧急中断保护等功能。腰(颈)椎牵引治主要包括静态牵引、间歇牵引和循环牵引，医生根据患者实际情况设置倾角大小、力度大小、牵引时间、渐退步数和渐进步数等牵引参数。病人数据库管理主要包括患者的基本信息、病状、日期、时间、牵引力参数、疼痛参数、治疗评估等信息。绳子释放以及按键控制主要包括牵引绳子的释放、牵引开始、牵引暂停、牵引停止等功能控制。床体位置调整主要根据病人的具体情况调整床体的旋角、倾角和摆角等。紧急中断保护主要用于病人出现异常情况或不适时停止牵引，如果该开关未连接或出现故障，系统不能正常工作。"
"硬件系统结构如图2所示，系统的硬件设计既要满足各种牵引模式、牵引角度、牵引力的不同变化，又要保证治疗的安全性，牵引角度和牵引力的准确度。系统硬件的设计包括PIC主控制板、数据采集输入电路、输出电路、电源等和触摸屏(上位机)部分，其中PIC主控制板负责对输入数据的处理、控制输出及数据通讯。数据采集输入电路从传感器获得数据，并将其传递给主控制板PIC单片机，输出电路主要是实现对无刷直流电机的控制，实现牵引角度和牵引力的控制，完成牵引动作。在治疗过程中，用户首先在上位机(触摸屏)设定好牵引模式和牵引力的大小等相关参数，上位机通过CAN接口电路，将命令传递给PIC控制器(下位机)，下位机执行命令，带动电机旋转，角度传感器获得牵引床的角度变化数值，并将数值传递给PIC单片机，当实际的牵引角度和设定的牵引角度一致时，电机停止转动。发出无刷直流电机转动命令，利用拉力传感器获得实时的牵引力的大小，传递给PIC单片机，PIC单片机将数据利用CAN接口电路，返回给上位机(触摸屏)，上位机将牵引力的变化情况实时显示出来。 图2. 系统硬件电路结构"
"在进行腰椎、颈椎牵引治疗时，为了达到理想的治疗效果，要求牵引治疗仪在施力过程中，既要精准，又要缓慢，牵引力不可有大的波动，这就要求牵引电机有较好的低速性能。以往的牵引在选择动力源时，大多选择异步电机或者液压电机，性能不稳定且难以维护，很难达到现在的设计要求。随着电机控制技术及各电力电子技术的迅猛发展，无刷直流电机(BLDCM)以其高性能高效率的特点脱颖而出。无刷直流电机具有调速范围宽、启动转矩大、易于控制、运行可靠等优势，被广泛应用于家用电器、汽车、航空以及康复医疗机械等行业领域 [ 9 ] [ 10 ] [ 11 ] 。为了改善电机运行性能，提高系统鲁棒性，在电机速度控制环节提出一种基于指数趋近率的滑模变结构控制策略。针对永磁无刷直流电机运行过程中换相转矩波动问题，提出一种基于泛模型思想与预测控制的无模型预测控制方法，该方法能够很好抑制无刷直流电机换相时的转矩波动。无刷直流电机控制策略流程如图3所示。 图3. BLDCM控制原理  变结构控制(SMC)是一种控制方法简单、建模要求不高、鲁棒性好、不连续的控制策略，滑模变结构控制系统主要由切换函数和控制率两部分组成，选择合适的切换函数可以使滑动模态的运动品质得到保证和改善，为了能在一定范围内消除抖振，同时一又不会延长系统的响应时间，采用动态滑模切换函数为： y = b x 1 + x 2 (1) 令状态变量为： { x 1 = n r e f − n x 2 = x ˙ 1 = − n ˙ (2) 其中， x 1 为速度误差， x 2 表示速度状态滑模变结构调节输入， n r e f 表示给定转速， n 表示电机的实际转速。 根据电机的机械运动方程 [ 12 ] ，式(2)变为： { x ˙ 1 = − n ˙ x ˙ 2 = − K T J i ˙ (3) 其中 K T 表示转矩系数， J 表示转矩惯量， i 表示稳态时绕组相电流。 当滑模动态到达切换面，即 y = 0 时，根据(1)和(2)，可得： n = n r e f − c e − b t (4) 由式(4)可看出，当 t → ∞ 时， n → n r e f ，即实际转速 n 趋近于给定转速 n r e f ，从而使系统最终达到稳定状态。 函数切换控制主要由等效控制部分和切换控制部分组成，通过函数切换机制可以减少扰动和摄动对系统带来的不确定影响。 f = f e q + f s w (5) 其中， f e q 为等效控制部分，保证系统滑模运动的控制， f s w 为切换控制部分，保证系统始终趋向于滑模面，减少扰动带来的影响。根据(1)和(3)可求得： y ˙ = b x ˙ 1 + x ˙ 2 = b x 2 − K T J i ˙ (6) 当 y ˙ = 0 时，可求得等效控制部分函数控制率为： f e q = J / K T ∫ ( d x 2 ) d t (7) 根据选取的指数趋进率以及式(4)和(6)，可求得滑模变结构调节器的输出： f = J K T ∫ [ k s + ε s i g n ( s ) + x 2 ] d t (8)  从图3可以看出，系统采用速度、电流双闭环控制结构，为了更有效的减少电机转矩波动，在电流环中加入一种无模型预测控制算法。无模型预测控制算法采用无模型控制和预测控制相融合的算法。对于无刷直流电机控制系统而言，在换相期间对非换相相电流进行控制，将非换相相电流值作为控制器的输入，待预测的未来时刻的电流值作为控制器的输出。在换相期间，以 z 相为非换相相， x 相为关断相， y 相为开通相为例。无刷直流电机数学模型如(9)所示 [ 10 ] [ 13 ] [ 14 ] 。 u x 0 + u y 0 − 2 u z 0 = − 3 R i z − 3 L s d i z d t + ( e x + e y − 2 e z ) (9) 将式(9)离散化简后得到： ( 1 + R T s / L s ) [ i z ( k + 1 ) − i z ( k ) ] − [ i z ( k ) − i z ( k − 1 ) ] = T s 3 L s { [ e ( k + 1 ) − e ( k ) ] − [ u ( k + 1 ) ) − u ( k ] } (10) 其中， T s 为采样时间， e ( k ) = e x ( k ) + e y ( k ) − 2 e z ( k ) ， u ( k ) = u x 0 ( k ) + u y 0 ( k ) − 2 u z 0 ( k ) 。 当采样时间足够短时， R T s / L s < < 1 ，因此在换相期间，式(10)可以进一步化简，从而获得BLDCM控制系统的泛模型。 [ i z ( k + 1 ) − i z ( k ) ] − [ i z ( k ) − i z ( k − 1 ) ] = φ ( k ) × { [ i z ( k ) − i z ( k − 1 ) ] − [ i z ( k − 1 ) − i z ( k − 2 ) ] } (11) 其中泛模型的特征参量为： φ ( k ) = [ e ( k + 1 ) − e ( k ) ] − [ u ( k + 1 ) − u ( k ) ] / [ e ( k ) − e ( k − 1 ) ] − [ u ( k ) − u ( k − 1 ) ] (12) 从而可以得到非换相相 z 相电流在 ( k + 1 ) T s 时刻的预测值为： i z ( k + 1 ) = φ ( k ) [ i z ( k ) − 2 i z ( k − 1 ) + i z ( k − 2 ) ] + [ 2 i z ( k ) − i z ( k − 1 ) ] (13) 根据以上分析可知，如果电机电阻电感参数的大致范围已知，并当采样时间足够小时，如果满足 R T s / L s < < 1 ，就可以抑制换相转矩波动，提高电机稳态性能。"
"目前，压力传感器通常采用压阻式传感器，其广泛地应用于航天、航空、石油化工、医疗器械等各个领域 [ 15 ] 。在医疗器械中压力是一个关键参数，传感器的输出值 u 不仅仅与被测压力 p 有关，当温度 T 或电源波动 δ 等非目标参量变化时，输出值也要变化 [ 16 ] 。为了提高传感器的稳定性及其精度，消除非目标参量对传感器输出特性的影响，提出一种基于BP神经网络的数据融合算法。压力传感器的模型 u = f ( p , T , δ ) ，为了消除工作温度和供电电源波动两个非目标参量的影响，采用逆向建模方法，如图4所示，图中 u T ， u δ 为两个非目标参量的检测电压信号， p ′ 为补偿后的输出量。 图4. 传感器数据融合系统原理 逆向建模的目的是通过神经网络的非线性映射能力，逼近 p = f − 1 ( u , T , δ ) ， p ′ = p 为网络的期望输出值。将目标参量传感器输出及各种非目标参量敏感元件的输出作为BP神经网络输入，网络根据一定的算法不断调整权值和偏置，使目标输出 p ′ 在允许的范围之内，并消除非目标参量的影响。 神经网络采用多层感知机前向神经网络结构。选输入层结点数为3，输出结点数为1，故 i = 1 , 2 , 3 ，隐层结点数 j = 1 , 2 , 3 , ⋯ , l ， l 值根据网络训练结果而定。为了使神经网络输出 y = p ′ ，采用误差反向传播 算法，则压力传感器系统目标参量的标定值之间的均方差 e = 1 n ∑ m = 1 n ( p ′ − p ¯ m ) 2 ≤ ε 为最小。其中， ε 为任意 小的正实数，即给定的允许偏差， p ′ 和 p ¯ m 均为归一化值， n 为样本数， m 为样本号。BP网络训练过程及其算法如图5所示。 图5. BP神经网络训练过程及其算法"
"为了验证无刷直流电机控制策略的可行性，对无刷直流电机运行性能进行仿真测试，其无刷直流电机相关测试参数如表1所示。仿真结果如图6，图7和图8所示。 由图6和图7可看出，转速在滑模变结构控制下很快达到给定值。负载转矩增加时，转速虽然会有所降落，但又立刻回到给定值，下降率几乎可视为0，实现无超调调速。因此，该系统极大地抑制了外界干扰的影响。 由图7可以看出，系统的启动转矩在滑模变结构控制下比较小，转矩达到稳定值所需时间也较短，增加负载转矩时的跟踪速度也较快。 Table 1 定子电阻 转动惯量 磁动系数 相电感 R = 1.2 Ω J = 0.0022 kg∙m 2 C e = 0.095 L − M = 6.3   mH 初始负载转矩 滑膜变结构参数 仿真时间 额定转速 T L = 2   N ⋅ m k = 0.01 ， ε = 100 0.2   s n e = 2500   rpm 表1. 无刷直流电机相关测试参数 图6. SMC下的转速变化波形 图7. SMC电磁转矩变化波形 图8. SMC相电流变化波形 由图8可以看出，相电流从电机启动到达稳定时所需时间较短，也就是说，响应速度较快。当负载转矩增加时，相电流的跟踪速度也变快。  为验证神经网络法的有效性，根据传感器的5组实验标定值，利用神经网络计算出被测压力 p 的融合值，如表2所示。 Table 2 温度/℃ 电源波动δ/% 被测压力p (10 4 Pa) 标定值1 融合值1 标定值2 融合值2 标定值3 融合值3 21.5 3 0 0.232 1 1.003 2 2.057 28 0 0.252 0.980 1.996 34 0 0.249 0.957 2.050 50 −2 0.233 1.033 2.023 70 −3 0.218 1.004 2.047 最大偏差 max | Δ p | 0.034 0.076 0.061 温度/℃ 电源波动δ/% 被测压力p (10 4 Pa) 标定值4 融合值4 标定值5 融合值5 标定值6 融合值6 21.5 3 3 3.008 4 3.998 5 4.997 28 2 3.032 4.001 4.999 34 1 3.029 4.003 5.001 50 −2 3.011 4.005 5.005 70 −3 3.016 4.007 5.007 最大偏差 max | Δ p | 0.024 0.009 0.010 表2. 融合处理结果 从表2可以看出，神经网络对传感器数据进行融合处理后，利用式 α p = max | Δ p | / p F S 计算传感器输出电压波动的相对值， p F S 为满量程压力标定值 [ 16 ] 。把 max | Δ p | = 0.076 × 10 4   Pa 代入 α p ，可以获得传感器输出电压波动的相对值 α p = 1.5 % 。因此，采用BP神经网络算法进行数据融合，大大降低了非目标参量对压力传感器输出结果的影响，有效地提高了传感器的输出精度。  为了验证研究的智能牵引理疗系统可行性及其相关性能，整个测控系统进行了测试(以腰椎为例)。最大拉力设置为30 kg (最大拉力范围0~90 kg)，最小拉力为10 kg，最大拉力与最小拉力的差要大于等于2 kg。保持时间设置为50 s (范围0~99 s)，休息时间设置为50 s (范围0~99 s)。上升步数设置为5步(范围0~9步)，下降步数设置为4步 (范围0~9步)。减进模式为静态模式，减退模式为静态模式，牵引模式为间歇模式，牵引时间为80 min。系统运行效果图如图9所示。 图9. 系统运行效果图 测试结果表明，该牵引装置不仅具有较好动态响应性能、实现牵引力的精准控制、良好的人机交互、患者信息存储和动态显示牵引力大小，而且具有较好的治疗效果，牵引过程更加平稳、安全、可靠。"
"本文研究的智能牵引理疗系统是采用单片机实现的用于颈椎、腰椎康复的牵引设备。该系统通过拉力传感器采集信号，单片机实时控制进行牵引理疗。本系统设计将各功能的算法分配于相应的单片机中，并对相关算法和样机进行了验证测试。该牵引装置不仅具有较好动态响应性能、实现牵引力的精准控制、良好的人机交互、患者信息存储和动态显示牵引力大小，而且具有较好的治疗效果，牵引过程更加平稳、安全、可靠。"
