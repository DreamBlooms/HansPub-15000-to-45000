"为了解决本科实验教学中光弹演示实验存在的现状,一套基于USB工业摄像机和三可变镜头的视频采集教学软件被开发了。该视频采集系统硬件安装简单，只需要将工业相机的USB接口与计算机USB连接，然后将解码器串口与计算机串口连接就可使用，人机交互界面的设计操作简单，界面友好。该系统采用VB6.0开发完成界面设计以及视频图像的获取与处理，采用VB串口通讯技术完成对三可变镜头的焦距、聚焦和光圈的控制。这套采集系统已经在教学中使用，成功解决了光弹演示实验学生观察难，实验效果不好，演示性实验教学困难等难题。 关键词 :视频采集，串口通讯，VB6.0，实验教学改革"
"光弹演示性实验是本科生《工程力学实验》课程中的一个基础演示性实验。它是一种应用光学原理的应力测试实验，在实验中要求学生观察几种典型的模型在平面或偏振光场中受力后的等差线和等倾线条纹，掌握光弹性测试的基础知识。但是，在实验教学过程中却发现只有靠近光弹实验装置附近的学生才能透过检偏镜(一般直径为150 mm左右)观察放置在其后面模型上的干涉条纹，尤其是在改变载荷大小或者偏振轴方向需要同学们同步观察此刻干涉条纹的实时变化时，很难保证每个学生都看到。这样就出现了老师费力讲解而学生却不知所云的现象，严重影响实验教学效果。如果能把模型上的干涉条纹在电脑上显示或者通过投影仪放大到显示屏上使得所有学生都能很清晰地观测到条纹变化将会显著提高实验教学效果，所以，将普通光弹仪改造成数字光弹仪迫在眉睫。但购买市面上售卖的一套光弹性软件价格非常昂贵，售价在三万左右，而软件中很多功能对于本科生演示性实验教学又使用不到，这样就造成了极大的浪费。基于这种现状，我们开发了这套针对光弹演示实验教学使用的光弹图像采集系统。"
"2. 采集系统总体设计[ 1 ] [ 2 ] 光弹图像采集系统的总体设计思路经过了几种方案的比较。 首先，传统的视频采集系统大多采用模拟摄像机和手动调焦镜头，普通模拟摄像机像素一般在七万以下，像素低，图像不清晰，图像放大后会出现马赛克现象，并且摄像机要多次经过AD/DA转换才输出视频信号，在转换的时候抽出的离散信号造成图像失真。同时，这种方案还需要在电脑中安装图像采集卡，安装是否到位将影响图像的采集，试验中发现有时会搜索不到图像采集卡以至于图像采集失败的情况。 介于上述方案的不理想，后将模拟摄像机改换为工业数字相机和手动调焦镜头，摄像机选择了分辨率为1280 × 960，CCD成像尺寸为1/3”，通过USB2.0接口，不需要额外的采集设备，即插即用，满足了视频图像清晰，采集方便的要求。但是，在实验中需要手动调节支架位置以及镜头焦距来达到改变图像大小和清晰度，操作麻烦，影响实验效果，故手动调焦镜头在后来的实验中改换成三可变镜头(焦距、聚焦和光圈可变)。这套采集系统总体框架如图1。 在功能实现上通过解码器控制电动三可变镜头，这个也是这套系统的重点解决的难题之一。在操作时只需要根据需要操作客户端界面按钮就可实现镜头的变焦、聚焦和光圈的调整，可实现实时图像的保存、浏览以及实验全过程的录像等等。这种方案的优点是安装方便，操作简单。 图1. 视频采集系统总体架构"
"3. 串口通讯技术[ 3 ] -[ 7 ]  解码器上的通讯端口是RS485，而电脑串口通讯端口是RS232，这就需要将计算机上的RS232转换成RS485。本系统直接采用RS232转RS485串口转换接口，如图2所示。 将转换器通讯端口的D+(DATA+)、D-(DATA-)、G(GND)分别与解码器DATA+、DATA-、GND端子对应连接，如图3所示。  解码器是与摄像机和电动变焦镜头设备配套使用的一种前段控制设备。在这套视频采集系统中，需要计算机通过解码器来控制三可变镜头的焦距、聚焦和光圈。首先需要选择一个通讯协议，所谓通信协议是指通信双方的一种约定。约定包括对数据格式、同步方式、传送速度、传送步骤、检纠错方式以及控制字符定义等问题做出统一规定，通信双方必须共同遵守。 本系统采用CCR-20G通讯协议，数据格式：1位起始位，8位数据位，1位停止位 (1-8-N-1)，波特率为4800 bps。然后需要设置解码器上FUNCT中1-4端子来选择不同的通讯协议，将FUNCT设置为0110，对应的通讯协议即为CCR-20G。 波特率是为了使解码器与控制设备(摄像机镜头)之间有相同的数据传输速度。本系统选用的摄像机镜头为波特率4800 bps，改变解码器上ID中7、8号端子设置解码器的波特率值。 解码器在系统中必须有一个唯一的地址号码才能供系统识别，通过改变解码器上ID中的1~6号端子来设置地址号码，该解码器地址号码为100000，如图4所示。  该采集系统的难点之一是完成对三可变镜头焦距、聚焦和光圈的控制，开发原理就是使用VB串口通讯技术向计算机串口发出相应的控制指令，通过电平将控制信号送到解码器的串口，解码器将数字信号转变为模拟信号，做出相应的反应，驱动三可变镜头里面的电动机马达，使摄像头按照控制命令调整焦距、聚焦或者光圈，从而改变采集图像的大小和清晰度。解码器与工业镜头接线图，如图5所示。  摄像机选择USB接口的彩色工业CCD，做到即插即用，使用时只需要将USB接口摄像机连接到计算机上的USB接口上，RS485-232接口连接到计算机的串行口上就可以进行视频采集了，硬件连接简单，操作方便，这套视频采集系统所有的硬件包括RS232转RS485接口、解码器、工业摄像机和镜头，硬件连接如图6所示。 视频采集现场如图7所示。 图2. RS232转RS485接口装置 图3. Pc机与解码器的串口转换接口 图4. 解码器通讯设置"
"4. 采集系统软件设计[ 8 ] [ 9 ] 通过VB6.0编程完成人机交互界面以及视频的获取与处理。软件主要功能包括：视频图像的采集、录制、图像抓拍、浏览保存的图像、控制摄像头光圈和焦距；录像回放等，还扩充了云台功能，可改变球形摄像头的方向，可上下左右转动等[ 1 ] 。界面设计如图8所示。 抓拍的实时图像保存到计算机，界面如图9所示。 浏览存储在计算机中抓拍的图像，界面设计如图10所示。"
"控制摄像机镜头光圈的程序： 图5. 解码器与工业镜头接线 图6. 采集系统硬件连接 图7. 视频采集现场 Private Sub ApBig_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single) sbStatusBar.Panels(1).Text = 摄像机镜头控制----光圈大 MSComm1.Output = Chr(&H40) & Chr(&H43) & Chr(&H1) & Chr(&H80) & Chr(&H484) End Sub 图8. 视频采集软件界面设计 图9. 实时图像抓拍保存到计算机 图10. 浏览存储在计算机中的视频图像"
"该系统采用VB6.0开发完成界面设计以及视频图像的获取与处理，采用VB串口通讯技术完成对三可变镜头的焦距、聚焦和光圈的控制。系统采集光弹图像，记录整个实验过程，并经计算机显示器或投影仪放大显示，让所有学生都能观看到实验过程。自使用以来，学生对实验现象观察清晰明了，实验原理理解更加透彻了，参加的实验人数也由原来的只能10人左右扩大到一个班级30人左右了，从而告别了原来的闹哄哄挤作一团，老师费力讲解但学生仍然不知所云的现象，提高了授课效率和实验教学质量。实际上，在本科其它科目的演示性实验过程中都或多或少的存在实验观察难的现象，这套视频实时采集系统可以普及到其它科目的演示性实验当中，让演示性实验也可以使学生看得清晰，学得透彻。"
