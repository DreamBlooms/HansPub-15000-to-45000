"提出了一种基于光电容积脉搏波(PPG)信号的血压测量系统，包括信号采集硬件设置和基于Hilber-Huang变换(HHT)的PPG信号处理方法。在设置中，使用手机(MP)作为上位控制器，在其控制下，手指夹探头产生的PPG信号被采集，放大，滤波后存储在SD卡中并传送到MP。此外，基于MATLAB软件，提出了一种改进的HHT算法。通过与小波阈值法(WT)比较，从信噪比，特征提取和血压(BP)计算的角度评估了该方法的有效性。实验结果表明，虽然两级Rigrsure小波阈值去噪方法在PPG信号去噪方面表现最好，但处理后的数据的特征信息也与实际值存在较大差异。相比之下，所提出的改进HHT算法去噪效果表现略差，但成功地保留了单个周期信号的基本特征。综上所述，本文提出了一种基于MP的PPG便携式设备和改进的HHT信号处理方法，并将其应用于BP估计，未来将在老年人日常健康检查，病人康复等方面发挥应有的作用。 关键词 :PPG信号，小波变换，改进的HHT变换，血压测量 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"光电容积脉搏波信号(PPG)是一种多指标生理信号，基于它的血压(BP)估计已被广泛研究。大致有如下几种方法：在同一心动周期中，从心电图上(ECG)的R波峰值计时到外周动脉某一部位(如手指)的PPG信号中上升支的峰值点的时间称作脉搏传输时间(PTT)，它与动脉血管壁弹性密切相关，因此可建立模型关系用于计算BP [ 1 ] [ 2 ] [ 3 ] ；由于脉搏波速度(PWV)能够定性地反映血压，所以使用双通道PPG信号来确定PWV，最终也获得血压信息 [ 4 ] ；而在最近的出版物中，通过整合Windkessel效应 [ 5 ] 与PPG信号特征的关系可以估计出舒张压(Pd)和收缩压(Ps) [ 6 ] 。所有这些方法表明，PPG信号是一种可用于BP估计的可靠有效的信号，然而PPG中存在的噪声仍然是一个亟待解决的问题 [ 7 ] 。 为了解决这个问题，去噪是必要的一个步骤。小波变换(WT)方法已被提出用于PPG信号去噪 [ 8 ] [ 9 ] [ 10 ] ，但WT主要用于静态周期性信号处理，它在去噪过程中将会改变PPG信号中的特征参数，这会导致测量结果的不准确。希尔伯特–黄变换(HHT)方法是一种可用于非线性和非平稳信号的去噪方法 [ 11 ] ，它具有很好的噪音消除以及保存细节信息的能力。目前，它被用于心电信号的处理 [ 12 ] [ 13 ] 以及生物医学 [ 14 ] 、水印 [ 15 ] 、音频等领域的应用 [ 16 ] 。但是，这种方法尚未用于PPG信号处理。 本文提出了一种改进的HHT算法，并进行了PPG信号噪声消除的研究，然后将其与Windkessel模型相结合来估算BP。为了证实所提出的HHT方法的有效性，将其与WT去噪算法进行了比较。发现虽然WT具有较强的去噪能力，经其处理后的PPG信号比HHT处理后的PPG信号更平滑，同时后者的峰值信噪比(PSNR)低于前者，但是改进的HHT算法对于BP计算具有更好的效果。通过与测量的BP值进行比较发现，用经过改进的HHT去噪后的信号估算出的BP值具有更小的偏差。这表明改进的HHT去噪相比于WT去噪更好地保留了PPG信号的主要特征。因此，本文所做的工作可以证明，所提出的HHT信号去噪算法不仅可以去除噪声干扰，而且可以保存有价值的信息。"
"提出的PPG信号检测硬件模块设计、信号去噪算法和BP算法方案如图1所示。对于PPG采集的硬件，信号去噪方法和BP估计的计算算法的详细描述将在后续部分依次介绍。 图1. 系统结构图 (a) PPG采集的硬件；(b) 信号去噪过程；(c) BP估算的计算方法  在图1(a)中，指夹探头包括一个波长为660 nm的发光二极管(LED)和一个将光信号转换为电信号的光电二极管。弱电流信号通过前置放大电路转化为电压信号，经过一系列信号处理后即可进行模数转换。微控制器(mega2560)对其进行信号采集，并将数据保存到SD卡中进行后续数据处理和BP估计。  这里将介绍两种滤除PPG信号噪声的方法——WT和HHT，具体内容如下： 在WT方法中，对于给定离散函数 x ( n ) ，内积 〈 x ( n ) , ψ a , b 〉 给出了离散小波变换(DWT)，为： D W T ( a , b ) = ∑ n = − ∞ + ∞ x ( n ) ψ a , b ( n ) (1) 其中 ψ a , b ( n ) 表示离散小波： ψ a , b ( n ) = 2 − a 2 ψ ( 2 − a n − b ) (2) 其中a是缩放变量，b是位置索引。 由于噪声存在于PPG信号的所有频带中，因此在DWT之后，对于所有尺度的分解信号都必须进行阈值收缩。小波阈值收缩过程分为三个步骤：小波分解，阈值收缩，小波重构。 在分解步骤中，Singh B. N.等人的研究证明sym8基函数与PPG信号更加一致，并且在Symlets系列中去噪性能最好 [ 17 ] ，因此选择sym8作为小波变换的基函数。当待分析信号的采样率满足采样定理(Nyquist)要求时候，可测量的归一频带必将限制在−π~+π之间，此时可分别用理想低通与理想高通滤波器H 0 与H 1 将它分解成(对正频率而言)频带在0~π/2的低频部分和频带在π/2~π的高频部分，分别对应信号的概貌和细节。处理后两路输出必定正交(因为频带不交叠)，而且由于两种输出的带宽均减半，因此采样率可以减半而不致引起信息的丢失(带通信号的采样率决定于其带宽，而不是决定于其频率上限)。类似的过程对每次分解后的低频部分可再重复进行下去，即：每一级分解把该级输入信号分解成一个低频的粗略逼近(概貌)和一个高频的细节部分，而且每级输出采样率都可以减半，这样就将原始x(n)进行了多分辨率分解。 在收缩步骤中，满足一定阈值收缩条件的小波系数将被滤波。本文比较了四种不同阈值对PPG信号去噪的影响，即Rigrsure阈值，Sqtwolog阈值，Heursure阈值和Minimax阈值。Rigrsure是一个基于Stein无偏估计的软阈值评估器。Sqtwolog使用产生阈值的固定阈值公式：sqrt(2 * log(length(x)))。Heursure是前两个阈值的组合，并且是最佳预测器阈值选择。Minimax使用Minimax原理找到一个固定的阈值，它产生最小均方误差(MMSE)的极值。 在HHT方法中，包含两个部分：第一部分是经验模式分解(EMD)，第二部分是希尔伯特频谱分析(HHP)。对于输入信号 x ( t ) ，EMD可以表示为： x ( t ) = ∑ i = 1 N h ( i ) ( t ) + d ( t ) (3) 其中， h ( i ) ( t ) 表示第i个本征模函数(IMF)。对于每个IMF h j ( t ) ，其希尔伯特变换 y j ( t ) 为： y j ( t ) = P π ∫ − ∞ + ∞ h j ( τ ) t − τ d τ (4) 其中P是柯西主值。 结合 x ( t ) 和 y ( t ) ，我们可以得到分析信号 z ( t ) ： z j ( t ) = h j ( t ) + i y j ( t ) = a j ( t ) e i φ ( t ) (5) 其中 i = − 1 ，并且 a j ( t ) = [ h j 2 ( t ) + y j 2 ( t ) ] 1 / 2 ,   φ j ( t ) = arctan ( y j ( t ) / h j ( t ) ) (6) a j 和 φ j 分别为第j阶IMF的瞬时幅度和相位。瞬时相位 φ j ( t ) 的时间导数是瞬时频率 ω j ( t ) 的物理意义，如下所示： ω j ( t ) = d φ j ( t ) d t (7) 受到WT去噪的启发，我们在重构信号之前使用硬阈值函数对每个IMF进行阈值判断。如果瞬时频率 | w i | > λ ，则保持IMFi不变，否则，令IMFi = 0。λ是固定的阈值，本文中取为0.01。判断IMF的单调性，如果输出几乎是单调或恒定的，则退出循环，最后重构所有非零IMF得到去噪后的信号 s ( t ) ： s ( t ) = Re [ ∑ j = 1 n a j ( t ) e i ∫ w j ( t ) d t ] (8)  本文采用特征点较为简化的Windkessel模型求取血压值。Windkessel模型将人体循环系统看做为一个简单电路，并将血流特征和血压的数学关系反应在该电路中，如图1(c)所示。在该模型中将血流在血管中的流动看做液体在弹性腔中的流动，并把其简化为一个含二参数的电路模型，其中血管壁的阻力和血液粘度模拟为阻值R (mmHg∙s/mL)，血管容量模拟为电容C (mL/mmHg) [ 6 ] 。血流流经弹性管可模拟为电流I(t)，而血管内的压力波模拟为电势P(t)。 根据基尔霍夫定理，可将电路模型各参数关系表示为： P ( t ) R + C d P ( t ) d t = I ( t ) (8) 将人体脉搏波信号单周期波形分解为上升支以及下降支，分别对应上升时间T s 以及下降时间T d 。单脉搏波周期下电流关系可表示为： I 0 = C 0 T c 60 ∫ 0 T s sin ( π t / T s ) d t (9) 其中C 0 为单周期PPG信号的传播常数， T c = T s + T d 。 由式(8)和(9)可推导出模型各参数与血压的关系： P s = P t s e − T s / R C + I 0 T s C π R 2 T s 2 + C 2 π 2 R 2 ( 1 + e − T s / R C ) (10) P d = P t d e − T d / R C (11) 其中P ts 为初始高压，P td 为初始低压。T s 与T d 可以从单周期PPG中求出。 利用Windkessel模型公式(10)和(11)进行血压计算。该模型的关键是建立合适的参数模型求解R、C的值。把模块三中求出的PPG特征数据按照血压值分成两组，一组为训练组，另一组为测试组，如图1(c)所示。 训练组中，把血压以及PPG特征值看做已知量，利用最小二乘的线性回归求出均方根误差值(RMSE)最小的一对参数。最后，将测试组中的PPG特征值和模型估计的参数做为已知量，解出相应的血压值，比较其与实际血压值的均方根误差，以判断两种不同去噪方法下整个系统对PPG信号的处理效果。"
"驱动电压Vt可以在PPG信号采集系统中进行控制(图1(a))。图2显示了不同Vt下采集到的PPG信号。结果表明，PPG信号随着Vt的增加而增加，为了使PPG采集系统在适当的工作条件下工作，我们选择1.73 V作为电源电压。  WT方法中，wden函数可选择不同的分解层数、阈值函数以及阈值处理过程。该函数可提供前文提到的四种阈值方法(Heursure、Sqtwolog、Minimax、Rigrsure)。分别比较四种不同阈值选择下小波阈值去噪算法的表现，并纵向讨论不同分解层数对于阈值去噪的影响，同时与改进的HHT去噪算法做了比较。由于脉搏波信号特征主要分布在0~10 Hz，故而仅对2~4层分解系数进行讨论。 本文将采用峰值信噪比(PSNR)来对比不同算法的去噪效果，PSNR的单位为dB。PSNR值越大，就代表信号质量越好，PSNR的计算公式如下： PSNR = 10 log 10 ( x max 2 MSE ) (12) 其中 x max = ( max ( x ( t ) ) , max ( s ( t ) ) ) ，MSE为均方差： MSE = 1 N ∑ t = 1 N [ x ( t ) − s ( t ) ] 2 (13) 其中N表示信号长度。 图2. 不同血压的PPG信号 图3(a)~(c)分别显示了检测到的PPG信号、2层rigrsure阈值选择下WT去噪后的PPG信号和HHT去噪后的PPG信号。图3(d)显示了不同阈值函数及不同分解层次选择下的WT方法和HHT方法的PSNR值的比较，不同的颜色代表不同的分解级别。 当分解层数大于2时，小波阈值去噪算法的处理能力呈下降趋势，其中Minimax阈值算法下降的最为明显，而3层与4层对阈值算法的影响不大。 可以看出小波变换算法处理能力受阈值选择影响，无偏风险估计(Rigrsure)阈值法对于被测脉搏波的处理效果较好。同时该算法受分解层数影响，分解层数过多反而会使信号PSNR降低。改进的HHT去噪算法是寻求单调子集的自适应性算法，其峰值信噪比优于2层Heursure阈值与Sqtwolog阈值，而其运算速度优于小波变换。  选择两层Rigrsure阈值算法和改进的HHT算法作为去噪算法，根据上述过程对数据进行处理。图4显示了血压计测得的血压与血压估算值之间的关系。x轴表示估计的BP，而y轴表示测量的BP。图4(a)显示了高压关系Ps，R2为0.90和0.98，分别代表了小波和HHT的相关系数。图4(b)显示了低压值Pd，而R2是0.88和0.96。 根据这些数据，通过比较两种算法的结果，显示了改进的HHT算法在BP计算中的优越性。使用改进的HHT算法处理数据，获得的血压更接近测量值，偏差更小。在实验中，我们发现不同算法得到的PPG信号的特征值存在一些差异，极值和周期不固定。在BP算法中，改进的HHT算法比WT算法显示出更好的特征保留能力。我们认为WT阈值条件很强，这可能会改变拐点处的信号和特征的极值。改进的HHT算法着重于降噪中的瞬时频率特性，具有更好的适应性。 图3. (a) 系统检测到的PPG信号；(b) 2层rigrsure小波去噪后的信号；(c) 改进的HHT去噪后的信号；(d) 不同算法的PSNR值比较 图4. 两种测试方法的BP值比较：(a) 收缩压(Ps)；(b) 舒张压(Pd)"
"本文设计的系统有效地获取了光电容积脉搏波(PPG)信号，但含有一定的噪声，后续实验对PPG信号进行了小波阈值去噪以及改进的HHT去噪算法的比较。在阈值函数确定的条件下，分析了四种不同阈值处理脉搏波信号的能力。实验表明用两层Rigrsure阈值条件处理脉搏波是合适的，且较低的分解层数避免了伪吉布斯现象的产生，处理所得的信号较为平稳光滑，波幅特征清晰，但同时会改变信号的一些特征值。本文提出的改进的HHT去噪方法在HHT变换基础上加入了阈值过滤步骤，去除特定频率的噪声，其在峰值信噪比上表现出不错的结果，且不包含复杂的计算过程，很好地保留了信号的特征信息。实验结果表明了改进的HHT算法对去除PPG信号中的噪声是有效的，从而为后续的血压计算奠定了基础，保证了数据的准确性，对实际的便携式设备应用系统有重要意义。"
