"本文基于Web技术，采用面向服务(SOA)的B/S(浏览器/服务器)架构及分层设计理念，数据库系统依托GIS开发平台，设计与实现四川省大气电场仪运行监控系统。该系统实现四川省大气电场探测设备运行状态的实时监控、故障报警、和实时大气电场场强数据显示、及历史场强数据的查询等功能，可对全省各台站大气电场仪探测网站信息进行智能化管理，切实有效地对全省大气电场仪运行状态进行实时监控、运行率业务可用性统计及场强数据查询，提高大气电场仪探测设备的利用效率，促进四川省大气电场探测信息的应用能力和数据资源共享。 关键词 :大气电场，面向服务(SOA)，B/S架构，运行状态，实时监控，故障报警 Copyright © 2018 by authors and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"雷电天气是全球最严重的十大自然灾害之一，具有极强的破坏性和杀伤力。近年来，雷电灾害呈增多趋势，对社会自然资源、交通、建筑物、电子信息系统和人民的生命财产及公共安全等构成了严重威胁。我国高度重视雷电的研究与防护，目前气象部门在全国范围已建成374个雷电监测站，基本形成覆盖全国经济发达地区的雷电监测网。四川省截至2013年12月已完成全省24部大气电场仪站点布网建设。然而全省24部大气电场仪从建设之初至今，虽已投入运行5年左右，到目前还没有一个以web形式访问的大气电场仪运行监控业务应用平台，能有效直观地对全省24部大气电场仪的运行状态进行实时远程监控。随着网络技术的迅猛发展和广泛应用，多年来有众多同仁开展了对气象探测设备远程监控的大量研究和开发，已经有很多成功应用的案例介绍。胡月，梨海涛 [ 1 ] 在2016年完成了基于WebGIS的雷电监测系统设计，实现对闪电定位仪这种雷电探测设备的远程监控；刘嘉唯 [ 2 ] ，余宇婷等于2016年进行了基于WebGIS的雷电数据远程服务与分析，实现了雷电数据的远程共享服务；孙逊 [ 3 ] 2015年做了基于WebGIS实时雷电监测预警系统的研究，使相关业务人员可以远程共享雷电监测预警信息；2016年，宁波 [ 4 ] 、张丽等将Web技术应用于山东省雷电灾害风险评估中管理中；袁微 [ 5 ] 、郭春辉于2017年研究开发了基于Web的肇庆天气雷达站业务工作平台，实现了天气雷达业务工作远程操作。纵观同行的研究开发及应用，很多气象探测设备已经实现了基于Web的远程实时运行监控，但目前还未见关于大气电场仪这种地面电场探测设备基于Web的远程实时监控方面的文献介绍。本文介绍利用四川省24部大气电场仪的探测资源，分析研究大气电场数据特性，设计开发的基于Web访问的四川省大气电场仪运行监控系统。该系统实现了多用户同时远程监控设备运行状态，具有很强的业务实用性和应用推广性。"
"该系统的技术架构和功能设计是在广泛调研和综合分析省级部门及各个地方台站在大气电场仪探测设备实时监控、维护维保、雷电探测数据应用等各项业务需求的基础上，应运行监控业务需要，开发集大气电场仪探测设备运行状态的实时监控、故障报警、设备运行业务可用性统计、电场数据可视化、各站点信息管理(添加、删除、修改站点的相关信息)等功能于一体的四川省大气电场仪运行监控软件，选择合适的开发平台和理想的软件架构来实现系统设计。  系统建立在各台站大气电场仪数据采集、Internet网络传输及省级探测数据接收中心三大业务基础之上，构建Web服务和数据库服务，负责大气电场仪探测网的探测数据获取，数据处理和web显示。系统拓扑结构如图1所示。  原大气电场仪厂家提供的中心站数据处理软件是采用传统的C/S [ 6 ] 架构，同时只能满足省级业务人员单一用户的使用，适用范围窄，各台站需要单独安装客户端才能查看设备状态，维护成本高。这种软件模式已经无法满足众多的气象部门业务人员和雷电科研人员对电场仪运行状态的监控和大气电场数据的分析需求。本文介绍的四川省大气电场仪运行监控系统采用面向服务(SOA)的B/S [ 6 ] 架构，具有数据共享性强、业务升级扩展方便、硬件成本低、零客户端维护等优点。符合大气电场仪运行监控系统实时性好、通用性强、运行效率高的设计原则。 系统总体架构划分为数据层、应用层、表现层分层设计。数据层主要为系统的运行提供数据支撑，其中包含探测数据以及业务数据。应用层为各种组件提供应用支撑，本系统主要采用基于GIS平台的数据管理。应用层作为系统的核心，包括数据接收、解析及处理，实时监测显示，历史数据查询，电场场强数据产品制作、输出等功能模块。表现层为应用层业务系统对外提供的表现方式，是面向用户的业务操作界面，将具体业务功能展现给业务用户。 图1. 四川省大气电场仪运行监控系统拓扑结构图"
"本着系统具备实时性好、实用性强、运行效率高的设计理念，本系统分为三大功能模块、十四个子系统组成，具体的功能划分如图2所示。"
"系统实现的各项功能，是通过用户在浏览器端发出指令，这些指令以超文本形式向web服务器发出业务请求，Web服务器接收请求后，把请求交给数据库服务器，数据库服务器进行事务处理时会对数据库里的数据进行查找、筛选、判断、增加、删除、修改、查询等操作，再把处理结果返回给 Web服务器，Web服务器将处理结果进行可视化转换，最后以文字信息、列表或图形等形式在Web界面显示出来，展现给所有用户。 按照本系统包含的功能模块、架构体系以及组件化模块化分层设计的需求。该系统数据获取和解析运用Windows Server服务技术 [ 6 ] ，图形输出运用了SVG [ 7 ] [ 8 ] (可缩放向量图形)和CSS [ 7 ] [ 8 ] (层叠样式表)技术等。后台基于C#语言，前端使用HTML，CSS，ASP即Active Server Pages等技术，并融合了Spring MVC和Hibernate [ 7 ] 等技术，选择了功能强大的Arcgis for Server10.0作为GIS [ 8 ] 的服务器 ，同时采用Microsoft SQL Server 2008 [ 9 ] 数据库进行设备运行的状态数据和大气电场数据的整体组织和存储管理，在Microsoft Visual Studio.NET 2008 E/R Studio平台下进行软件开发。  大气电场仪运行监控系统能够探测设备的状态监控和数据监控是依赖于探测设备自身运行状态数据和探测的地面大气的电场数据。因此数据获取和数据解析是整个系统的数据入口，是实现监控功能的源头，数据来源于省内所有大气电场仪向信息中心站上传的参数文件。考虑运行监控功能要求对数据的获取和解析的实时性和高频次，系统的数据获取和解析模块采用Windows Server服务技术，将大气电场仪每天分别产生的电场数据(data)文件和参数(state)文件，实时解析转换到相应的数据库字段中，同时判断探测设备所处的状态，及时更新探测设备状态数据库中的数据，并判断场强数据所到达的预警门限级别， 图2. 四川省大气电场仪运行监控系统功能模块 记录相应的雷电预警信息。当探测设备发生故障警报，还将根据故障类型产生报警信息，并将此报警信息保存到报警数据库中，以备查询时将数据信息转化传递到Web界面，展示给用户。 Windows Server服务技术的系统数据获取和解析模块是一个独立运行的应用小程序，该小程序没有用户界面，无任何可视输出。作为服务器的计算机启动时，系统数据获取和解析模块小程序会自动开始运行，不需要用户必须登录才运行，它们能在满足该系统软件在任何用户环境下运行。通过服务控制管理器，运用Windows Server服务的数据读取及解析模块小程序是人为可控的，可以手动启动和停止、及暂停，当需要时再次启动，非常适宜高频率的数据读取和实时性高的数据获取和处理需求。  运行监控系统最核心的功能就是设备状态的实时显示和故障报警。系统在接收到用户查看设备实时状态的指令后，经过Web服务器，数据库服务器一系列处理和转化后将设备的实时状态以时间序列图的形式在Web界面显示出来，完成状态显示功能，如图3所示。 运行监控系统的报警功能分为两种：一种是设备运行状态报警，当探测设备发生故障时，系统立即响应，发出即时声音警报和滚动信息提示警报，一旦监测到设备的状态故障，立即触发后台的声音警报功能模块向Web页面的用户发出声音警报，提醒值班员有设备发生故障，在图3所示的页面上对应的状态时序也会变为橙色显示，并以消息条的形式在时序图上方滚动显示故障台站提示信息，同时将故障状态数据实时更新到数据库对应表单。此项报警功能是该系统的一个重要功能模块，担负减轻探测设备监控值班人员工作压力的角色，具有重要的现实意义，其重要特点是实时性和准确性。另一种报警是设备探测到的大气电场场强数据报警，即雷电预警，当大气电场仪探测到的大气电场场强数值超过预先根据一定的历史经验和行业规范设定的报警门限值，立即发出雷电预警信息，并结合经纬度信息在GIS地图上对应台站显示相应级别的强度色班图，同时列表记录相应的雷电预警信息，如图4所示。  该系统在实现了设备状态实时监控的同时，还兼顾了数据统计和站网管理功能。通过图像输出方式展示对电场数据进行实时数据曲线显示和历史数据曲线回放，采用表格展示、柱状图展示形式实现探测 图3. 四川省大气电场仪运行状态监控Web页面 图4. 大气电场场强数据色斑显示图和报警信息 数据到报率统计和站网管理信息显示和输出，为业务人员和雷电资料研究人员分析大气电场信息，雷电灾害预警提供了方便。  系统在电场数据展示和数据到报率统计柱状图展示功能上，采用的都是图像输出展示模式。用户根据需求移动鼠标，在页面点击实时数据查询选项或历史数据查询选项界面设置选择的时间段，和台站名再点击开始查询，系统就会跳转到相应的数据曲线图页面；在到报率统计选项中设置选择需求统计时间段，和台站名(可选择单站或多站)及柱状图统计，点击开始统计，系统立刻跳转到对应的到报率统计柱状图页面。因篇幅限制，在此仅列出电场历史数据查询曲线页面截图，如图5所示。  系统在台站信息管理展示和数据到报率统计结果展示功能上，采用的都是表格输出展示模式。用户根据需求移动鼠标，在页面点击台站信息管理选项，并且在相应的对话框中输入台站号、探头号、经纬度、海拔高度等信息，再点击添加，系统便跳转到全省大气电场仪各台站的信息列表页面，点击列表的修改或删除，便可对台站信息进行修改、删除。在数据到报率统计界面设置中选择需要统计的时间段，和台站名(可选择单站或多站) 及列表统计，再点击开始统计，系统便会刷新到相应的数据曲线图页面或到报率统计柱状图页面。因篇幅限制，在此仅给出电场数据到报率统计页面截图，如图6所示。"
"相比较原厂家提供的大气电场仪数据处理系统在业务应用的局限性和不足，新设计开发的四川大气电场仪运行监控系统具有可多Web访问、远程监控、多用户浏览、历史状态查询等创新点。以列表对比展现其创新点，如表1所示。 图5. 大气电场历史数据查询曲线页面截图 图6. 大气电场数据到报率统计页面截图 Table 1 架构、功能 系统 架构 远程 访问 同时可访用户数量 历史状态查询 故障报警语音 数据 统计 故障 统计 站网信息管理 数据 下载 厂家提供中心站 电场数据处理系统 C/S 无 单一 无 无 无 无 无 无 四川大气电场仪 运行监控系统 B/S 有 多用户 有 有 有 有 有 有 表1. 四川大气电场仪运行监控系统创新点列表"
"该系统经过反复在线测试和修改，系统能稳定运行，并能顺利实现各项模块功能。系统软件自2017年7月初上线试运行以来，经省级相关业务人员和台站人员的多用户、长时间持续试用，该系统能够很好的完成对四川省已建的24部大气电场仪运行状况进行实时监测，实现了设备故障时的声音报警提示和页面滚动信息报警提示，实时数据在GIS地图上分级色标图显示，画出历史数据曲线查询图，站网信息管理(添加、删除、修改站点的相关信息)，和大气电场仪运行效率的业务可用性统计等功能。该系统的使用能够减轻大气电场仪技术保障人员的工作压力和提高设备监控工作效率及设备使用率。受2017年8月8日川北阿坝州九寨沟县7级地震影响，广元、绵阳站的大气电场仪网络传输模块受损，探测数据无法上传，该系统的声音报警和滚动信息提示报警功能发挥了显著效果，及时发出声音报警和滚动信息提示报警，运行监控值班人员立即听到了由该监控系统发出的报警声，及时告知省级探测设备保障科人员。由于该监控系统及时报警，我省探测设备保障人员第一时间到达现场快速维修，使得停运的大气电场仪设备得以快速恢复正常运行，确保探测数据的尽量完整性和持续性。"
"自该系统投入试运行以来，各功能模块经反复测试均能正运行，能够满足对大气电场仪设备的运行监控的各项需求，实现设备实时运行状态监控和历史运行状态查询；实时探测电场场强显示和历史电场数据查询和下载；故障报警、雷电预警、站网信息在线管理、信息查询及信息发布等功能。使省级和台站用户能便捷地监控该大气电场仪的运行状态，提高了我省探测设备技术保障人员的工作效率，同时促进了大气电场仪探测资料的在雷电灾害预警研究中的应用。 结合现在和未来的业务需要，进一步在系统中融合闪电定位仪探测数据，利用已发生的雷电过程，统计出大气电场仪所探测的电场能量从开始集聚到放电过程中的快变抖动，相对于闪电定位仪定位到的闪电发生时刻在时间上的先兆间隔，对大气电场场强数据在雷暴预警的效果进行评估，进一步提升电场数据在灾害性气象预警中的效力。"
