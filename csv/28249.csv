"高原牧区严重缺电、居住分散，但日照充足，因此采取独立光伏照明方案最合适。文章阐述了基于STC12C5A60S2微控制器的独立光伏照明控制系统设计与实现方法。首先分析了常见光伏照明系统的不足，随后给出了以STC12C5A60S2为控制器、PWM驱动的充放电电路，并详细讨论了系统软件设计。系统具有过充电、过放电保护、不同时间段的LED恒流控制功能。经测试表明本系统完全满足一般家庭照明需求，运行稳定可靠，成本低，容易维护的特征，且经稍加修改可应用于其它环境照明的需求，具有很好的可推广型。 关键词 :STC12C5A60S2，光伏，照明 Copyright © 2018 by author and Hans Publishers Inc. This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/"
"据调研地处高原的青海玉树、果洛等牧区由于人口稀少、居住分散等诸多因素，因而国家电网没有接入，造成这些地区严重缺电，甚至部分地区是无电生活，太阳能是取之不尽、用之不竭的清洁能源，刚好这些高原地区最大的特征就是光照十分充足，因此类似这些地区使用太阳能是今后能源的重要发展方向。同时LED被称为第四代照明光源，具有节能、环保、寿命长、体积小等特点，光效为50~200l m/W，平均寿命为100,000 h，作为冷光源热功耗很小，不含汞，钠元素等可能危害健康的物质，有利于环保，被称为“绿色照明光源”。太阳能电池板输出的是直流电能，而LED也是直流驱动光源，两者的结合更能提高整个系统的效率，太阳能的使用也免去了铺设电缆及其相关工程的费用。因此独立光伏 + LED照明方式是高原牧区今后照明的首选。 一个完整的小光伏系统，由太阳能电池、蓄电池、控制电路及照明系统构成。在这个系统中需要解决三个主要问题，第一：LED灯是低电压、大电流的驱动器件，其发光的强度由流过LED的电流决定，电流过强会引起LED的衰减，电流过弱会影响LED的发光强度，因此LED的驱动需要提供恒流电源。第二：蓄电池的过充电和过放电都会引起蓄电池寿命严重缩短，所以必需采取措施防止蓄电池的过充电和过放电。第三：必需强调节能，有效延长照明时间。 目前，光伏照明控制系统还处于研究开发阶段。现有的控制器有的采取电压比较器方式 [ 1 ] [ 2 ] ，明暗调节不便。有的仅实现恒流输出没有按时间点亮度控制及蓄电池的保护 [ 3 ] 。有的采用整体式薄型太阳能路灯设计，虽美观大方但成本太高不适合在高原分散环境使用 [ 4 ] 。有的采用单片机加片外A/D、D/A系统，电路复杂、体积大、成本高、易损坏维护困难等缺点 [ 5 ] [ 6 ] [ 7 ] 。也有的直接采用TL431进行控制，虽然电路较简单，但对照明的亮暗无法控制，不易节能 [ 8 ] 。还有的采用基于MPPT算法控制的 [ 9 ] [ 10 ] [ 11 ] [ 12 ] [ 13 ] ，这对于独立小光伏系统来讲成本太高，而且青海等高原地区日照很充足，对独立小光伏系统没必要刻意讲究最大功率点追踪。也有的采用物联网的路灯管理 [ 14 ] [ 15 ] ，这种方式具有智能性但造价太高同时也不适于高原分散居住环境。针对以上不足设计并实现了基于STC12C5A60S2单片机的智能光伏照明控制系统，直接利用片上A/D、PWM实现对蓄电池的过压、欠压保护及LED亮度控制，整个控制系统电路简单、体积小、成本低、不易损坏等优点。"
"1) 蓄电池过充电保护。白天在微控制器的控制下向蓄电池充电，当U = 14.3 V后，系统开始不断的调节充电电流，此时蓄电池处于过充状态，直到电流减小到0.1 A，表明蓄电池已充满，此时控制器切断充电回路，防止蓄电池过充电，保护蓄电池。 2) 蓄电池过放电保护。夜晚蓄电池在控制器的控制下向LED供电，当U = 10.8 V时，控制器自动切断放电回路，防止蓄电池过放电，保护蓄电池。 3) 时间控制。控制充电从早上9点开始，直到蓄电池充电完成。晚上20点开始供电，在调试过程中分三个时间段测试供电实况。在玉树囊谦地区晚上20点至21点不是很暗，用150 mA驱动LED即可，21点至0点用230 mA驱动LED，0点后再以150 mA驱动LED。(当然实际使用时没必要通晚供电，根据休寝时间人为关灯。) 4) 恒流控制。为保持LED路灯在各时段内光照度基本一致并提高蓄电池供电时间，控制器控制恒流电路使电流基本恒定。"
"整个系统由微控制器、太阳能电池板、充电电路、蓄电池、LED恒流源驱动电路及LED阵列、时钟电路及LCD构成。如图1所示。 图1. 智能太阳能LED路灯控制系统框架图 微控制器采用STC12C5A60S2单片机，这款单片机是宏晶公司生产的1T型单片机，是高速、低功耗、超强抗干扰的新一代8051单片机。内部集成有60 K的Flash，1 K的RAM，MAX810专用复位电路，2路PWM，8路高速10位A/D转换等资源，特别适合本设计需求。 选用标称功率为20 W、开路电压为18 V的太阳能电池板和额定电压为12 V、容量为7.2 AH蓄电池，选用230 mA的大功率LED，串联方式构成LED阵列。 在设计过程中采用点阵式图像LCD，用于绘制工作过程中蓄电池端电压变化曲线，实际应用中考虑成本采用字符型LCD。  用Flyback变换器将太阳能电池板和蓄电池连接起来，根据当前时间及蓄电池端电压，STC12C5A60S2输出PWM信号控制Q1开关管，达到充电回路的通断及充电电流大小的控制，当蓄电池端电压达到14.4 V停止充电。如图2所示。  LED端电压的微小变化会引起较大的电流变化和亮度变化，所以LED的驱动应尽可能地保持电流恒定。文中采用Cuk电压变换驱动串联LED的方案，其电路框图如图3所示。 系统利用Cuk变换电路提高输入电源的电压，以驱动大功率白光LED 阵列。由于LED的工作电源由蓄电池提供，因此它在工作时输出的电压并非恒定，而是在一定范围内变化，所以要求驱动电路能够在较宽的输入电压范围内均能正常工作。Cuk变换电路在满足较宽的输入电压的同时，使经过变换后的输入电压得到了提升，从而满足了串联LED工作电压较高的要求。根据当前时间和蓄电池端电压，STC12C5A60S2输出PWM信号控制Q2开关管，决定是否接通供电回路，及调整PWM的占空比调节LED的亮度。 图2. 充电电路 图3. 供电电路"
"系统软件分主程序和中断服务程序。主程序的主要任务是控制充电、过充保护、供电、亮度调节、过放电保护功能，另一个任务就是跟踪过程中蓄电池电压变化并输出到LCD屏。主程序流程图如图4所示。 中断服务程序中主要实现系统时钟调整。流程如图5所示。"
"该系统在晴天进行了测试，如图6所示为充放电过程蓄电池端电压变化。充电从早上9点开始，经大约6个小时蓄电池的端电压从10.8 V上升到14.4 V，之后到20点前蓄电池端电压基本不变。从图6可看出充电过程中起初蓄电池端电压变化快，之后变的缓慢，尤其在充电快结束时端电压变化更加缓慢，这与蓄电池充电其端电压变化特性及我们采取临界点以小电流充电方案是一致的，起到了过充电保护作用。放电从20点开始，20点至21点、0点后大约以150 mA供电，21点至0点大约以230 mA供电，从图6看出该方案能持续供电11个小时，且20点至21点、0点后蓄电池端电压变化较缓慢而21点至0点蓄电池端电压变化较快，这与蓄电池放电特性及采取的放电策略一致，不仅实现了分时间段不同恒流供电的目的，而且起到了过放电保护作用。 图4. 系统主程序流程图 图5. 中断服务程序流程图 图6. 蓄电池充放电曲线"
"从前面测试数据看，该系统对一路LED灯分时间段以150 mA、230 mA可连续供电11小时，可见该系统完全满足一个一般家庭的日常照明。另外独立光伏 + LED照明方案不仅是一劳永逸的绿色照明，而且省去了铺设电缆的昂贵造价。因此这种方案对光照充足且无国家电网铺设的高原牧区非常适用。 在本系统的基础上再加光度采集电路，通过软件控制不同光度下LED的驱动电流，使环境的光度基本稳定，就可以应用到很多场所，如太阳能草坪灯、太阳能楼道灯、太阳能街灯及蔬菜温室大棚的补光系统等。"
