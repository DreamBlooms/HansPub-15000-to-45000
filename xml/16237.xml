<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">GST</journal-id><journal-title-group><journal-title>Geomatics Science and Technology</journal-title></journal-title-group><issn pub-type="epub">2329-549X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/GST.2015.34011</article-id><article-id pub-id-type="publisher-id">GST-16237</article-id><article-categories><subj-group subj-group-type="heading"><subject>GST20150400000_12164364.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  EPS2008数据转换技术在济南市基础地理信息公共平台数据生产中的应用
  The Application of EPS2008 Data Exchange in Jinan Fundamental Geographic Information Public Platform Data Production
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>邵</surname><given-names>飞</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>魏</surname><given-names>金明</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>梁</surname><given-names>坤</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>珂</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>济南市勘察测绘研究院，山东 济南</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>360334978@qq.com(邵飞)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>22</day><month>10</month><year>2015</year></pub-date><volume>03</volume><issue>04</issue><fpage>86</fpage><lpage>90</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  介绍了清华山维EPS2008地理信息工作站数据转换的技术路线，对其在济南市基础地理信息公共平台数据生产中的应用进行研究，实现了多源数据与平台标准数据的快速整理与转换。
   This paper introduced the technical route of data exchange in EPS2008 GIS workstation. Through the study on its application on Jinan Fundamental Geographic Information Public Platform data production, it achieved the goal of quick data sorting and data exchange between multi-source data and platform data.
 
</p></abstract><kwd-group><kwd>EPS2008地理信息工作站，数据转换, EPS2008 GIS Workstation</kwd><kwd> Data Exchange</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>EPS2008数据转换技术在济南市基础地理信息公共平台数据生产中的应用<sup> </sup></title><p>邵飞<sup>*</sup>，魏金明，梁坤，陈珂</p><p>济南市勘察测绘研究院，山东 济南</p><p>Email: <sup>*</sup>360334978@qq.com</p><p>收稿日期：2015年10月5日；录用日期：2015年10月25日；发布日期：2015年10月28日</p><disp-formula id="hanspub.16237-formula276"><graphic xlink:href="http://html.hanspub.org/file/2-2840070x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>介绍了清华山维EPS2008地理信息工作站数据转换的技术路线，对其在济南市基础地理信息公共平台数据生产中的应用进行研究，实现了多源数据与平台标准数据的快速整理与转换。</p><p>关键词 :EPS2008地理信息工作站，数据转换</p><disp-formula id="hanspub.16237-formula277"><graphic xlink:href="http://html.hanspub.org/file/2-2840070x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>济南市基础地理信息公共平台(简称平台)于2012年8月完成建设并上线试运行，2013年8月通过了国家验收。其中数据生产是平台建设和正常运行的重要工作，由于原始数据的数据标准与平台数据标准不同，因此在数据生产时需要进行数据整理和转换，以满足平台运行对数据的应用需求。</p></sec><sec id="s4"><title>2. EPS2008地理信息工作站介绍</title><p>EPS2008地理信息工作站是以数据库为核心构建的集地理信息数据采集、整理、建库和测绘管理的系统，系统基于既严整又开放的模板控制技术、易学易用的脚本二次开发技术和强大的制图技术，在保证数据标准化、图库一体化的同时，为数据跨平台共享提供了极大的便利性和灵活性。</p><sec id="s4_1"><title>2.1. 模板信息映射技术</title><p>EPS工作站中的模板是一个Access数据库，内容包括地理数据结构表定义、数据分层分色方案、编码体系及符号化描述定义、系统环境用户化设置以及用户扩展属性表定义[<xref ref-type="bibr" rid="hanspub.16237-ref1">1</xref>] 。模板不但是数据标准化的有力保证，而且是不同数据标准转换的中转站，不同标准的数据可以在模板中设置转换对照关系，即利用模板的信息映射机制，可实现不同标准数据的正确无损转换，从而实现不同标准的数据共享。</p></sec><sec id="s4_2"><title>2.2. 脚本二次开发技术</title><p>EPS2008地理信息工作站提供脚本语言支持用户进行二次开发，脚本语言遵循简单易用的VBScript语言标准，使用者可根据集成命令、语言规则、函数等方法实现EPS平台数据整理、数据检查、数据转换等扩展功能。EPS脚本语言在脚本编辑器中运行，具体运行是解释性执行 [<xref ref-type="bibr" rid="hanspub.16237-ref2">2</xref>] ，可分为有模脚本和无模脚本。有模脚本对脚本功能进行封装，不支持与视图窗口进行交互操作。无模脚本允许与视图窗口进行交互操作，可以响应视图窗口的鼠标消息、按键消息和绘图消息，支持通过通用参数对话框录入参数。</p></sec></sec><sec id="s5"><title>3. EPS2008数据转换技术路线</title><p>基于EPS2008地理信息工作站进行数据转换，主要包括以下几个部分：</p><sec id="s5_1"><title>3.1. 数据标准分析与转换关系定制</title><p>对需要转换的数据标准进行详细分析，是实施正确无损转换的重要前提。不仅要对对象实体编码、几何类型的转换进行分析，还需要对对象的属性转换进行正确梳理，以满足转换后数据标准需求。转换关系定制基于模板的信息映射机制，通过制作两标准对象之间的对照表来实现。对照表中通过编码对照、几何类型对照、过滤控制、符号输出形式设置等，对转换后的数据进行控制。转换可分为导入和导出，导入是将其它标准的数据转换为现有标准数据，导出是将现有标准数据转换为其它标准数据。对照表制作示例如表1所示。</p></sec><sec id="s5_2"><title>3.2. 转换脚本的编写</title><p>转换脚本可以在模板的转换对照关系定制和数据整理完成后，实现不同数据标准之间的转换。脚本的编写采用VBScript语言，对数据转换进行控制，脚本主要内容如下：</p><p>1) 转换路径设置：对转换后数据的路径进行设置；</p><p>2) 转换格式设置：对转换数据格式进行设置，不同的数字代表不同的数据格式；</p><p>3) 转换对照表调用：对控制转换对照关系的对照表进行调用；</p><p>4) 转换范围设置：对转换后的数据范围进行设置；</p><p>5) 转换图层设置：对转换图层对照进行设置。</p><p>6) 转换数据结构设置：对转换数据属性结构进行设置，主要包括字段对照关系、转换后的字段类型、字段名称、字段长度、字段内容等。</p><p>转换脚本的编写，可根据需求嵌入数据处理内容，以在数据转换的同时对数据进行处理，扩展执行脚本的功能。</p></sec><sec id="s5_3"><title>3.3. 数据整理</title><p>数据整理是为了弥补在模板转换关系定制过程中无法满足数据需求而进行的二次加工。主要包括特定需求的符号化定制、数据处理和检查脚本的编写等。符号化定制可在模板中进行，也可在软件的地物模板设置中进行。数据处理和检查可在软件的编辑、绘图、工具菜单下进行，也可以利用脚本进行二次开发，以满足数据处理的特定需求。</p></sec><sec id="s5_4"><title>3.4. 数据转换</title><p>数据转换即利用已编写的数据转换脚本对已有数据进行转换，以达到不同标准数据共享的目的。多个数据单元可进行批量转换，转换成功与否可通过数据转换日志进行查看。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1"><xref ref-type="table" rid="table">Table </xref>1</xref></label><caption><title> <xref ref-type="table" rid="table">Table </xref>of data exchang</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Code</th><th align="center" valign="middle" >Byname</th><th align="center" valign="middle" >Object Name</th><th align="center" valign="middle" >Type</th><th align="center" valign="middle" >Layer Name</th></tr></thead><tr><td align="center" valign="middle" >27010121</td><td align="center" valign="middle" >2701012</td><td align="center" valign="middle" >干堤顶线</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >IHFCLN</td></tr><tr><td align="center" valign="middle" >21010121</td><td align="center" valign="middle" >2101012</td><td align="center" valign="middle" >地面河流岸线</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >IHYDLN</td></tr><tr><td align="center" valign="middle" >34070231</td><td align="center" valign="middle" >3407023</td><td align="center" valign="middle" >坟地A</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >IRFCPL</td></tr><tr><td align="center" valign="middle" >32150321</td><td align="center" valign="middle" >3215037</td><td align="center" valign="middle" >龙门吊骨架线</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >IRFCLN</td></tr><tr><td align="center" valign="middle" >44020041</td><td align="center" valign="middle" >4402005</td><td align="center" valign="middle" >乡村路中心线</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >IROALN</td></tr><tr><td align="center" valign="middle" >43050131</td><td align="center" valign="middle" >4305013</td><td align="center" valign="middle" >主干道范围面</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >IROAPL</td></tr><tr><td align="center" valign="middle" >43050331</td><td align="center" valign="middle" >4305033</td><td align="center" valign="middle" >支路范围面</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >IROALN</td></tr><tr><td align="center" valign="middle" >44020031</td><td align="center" valign="middle" >4402003</td><td align="center" valign="middle" >乡村路面</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >IROAPL</td></tr><tr><td align="center" valign="middle" >81050731</td><td align="center" valign="middle" >8105073</td><td align="center" valign="middle" >苗圃A</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >IVEGPL</td></tr><tr><td align="center" valign="middle" >32110111</td><td align="center" valign="middle" >3211011</td><td align="center" valign="middle" >散热塔B</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >IRFCPT</td></tr><tr><td align="center" valign="middle" >32110131</td><td align="center" valign="middle" >3211013</td><td align="center" valign="middle" >散热塔A</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >IRFCPL</td></tr><tr><td align="center" valign="middle" >45050131</td><td align="center" valign="middle" >4505012</td><td align="center" valign="middle" >过街天桥</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >ITFCPL</td></tr></tbody></table></table-wrap><p>表1. 数据转换对照表</p></sec></sec><sec id="s6"><title>4. 实际应用</title><p>EPS2008地理信息工作站的模板映射技术和脚本二次开发技术在济南市基础地理信息公共平台的数据生产中得到了广泛应用。所有转换基于2011年济南市地理信息数据标准(简称济南市数据标准，数据为济南市标准数据)进行，即其它标准数据首先转换到济南市数据标准，然后在济南市标准数据基础上进行满足平台数据标准的转换。</p><sec id="s6_1"><title>4.1. 其它标准数据与济南市标准数据的转换</title><p>其它标准数据主要包括济南市“一张蓝图”数据和济南市规划局申请的其它标准数据，皆为平台建设初期使用。其中“一张蓝图”数据包括393平方公里的1:500数据、1872平方公里的1:2000数据和1703平方公里的1:5000数据，其它标准数据主要为济南市外围的数据。数据生产过程中，通过制作模板转换对照表、编写转换脚本和处理脚本，将其它标准数据无损转换为济南市标准数据。以下为部分脚本代码：</p><p>objType = SSProcess.GetSelGeoValue (i, SSObj_Type)‘获取原有数据几何类型</p><p>ObjCode = SSProcess.GetSelGeoValue (i, [YSDM])‘获取原有数据要素代码</p><p>If objType = POINTThen ‘判断如果为点</p><p>condition = Feature.Byname =' &amp; ObjCode &amp; '‘判断是否与对照表中的代码相等</p><p>epscode = SSProcess.FindFeatureCode (FeatureCodeTB_2000MDBIN, condition ) ‘获取与旧代码对应的新编码</p><p>if epscode&lt;&gt; Then</p><p>layername=SSProcess.GetFeatureCodeInfo( epscode, LayerName )‘获取新编码的层名</p><p>Color=SSProcess.GetFeatureCodeInfo( epscode, LineColor )‘获取新编码的线颜色</p><p>SSProcess.SetSelGeoValueiSSObj_Code, CLng(epscode) ‘给此点对象赋新编码</p><p>SSProcess.SetSelGeoValueiSSObj_LayerName,layername‘给此点对象赋新层名</p><p>SSProcess.SetSelGeoValueiSSObj_Color, Color‘此点对象赋新线颜色</p><p>name = SSProcess.GetSelGeoValue(i[TEXT_])‘读取点名称</p><p>If name &lt;&gt; Then SSProcess.SetSelGeoValue i[NAME],name‘赋点名称</p><p>angle = SSProcess.GetSelGeoValue(i[ANGLE]) ‘读取点角度</p><p>If angle &lt;&gt; Then SSProcess.SetSelGeoValue i[ANGLE],angle‘赋点角度</p><p>elev = SSProcess.GetSelGeoValue(i[ELEV])‘获取高程</p><p>If elev&lt;&gt; Then SSProcess.SetSelGeoValue i[ELEV],elev‘赋高程</p><p>end if</p></sec><sec id="s6_2"><title>4.2. 济南市数据标准与公共平台数据的转换</title><p>济南市数据标准为济南市勘察测绘研究院2011年引进EPS2008地理信息工作站时结合济南市实际情况而制定的数据标准，是济南市基础地理信息动态更新数据所遵行的标准，平台标准的数据皆基于以此数据标准为基准转换后的数据进行转换。此标准数据转换到平台标准数据除需要制作转换模板、编写转换脚本之外，还需根据平台符号化的需求，对EPS数据中的部分地物符号化表现进行调整，同时进行符号化输出，以满足平台电子地图表现的需求，模板中部分符号导出的设置(Explode值设为1即表示此地物符号化导出)如表2所示。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table">Table </xref>2</label><caption><title> Symbol export setting in the templat</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Code</th><th align="center" valign="middle" >Byname</th><th align="center" valign="middle" >Object Name</th><th align="center" valign="middle" >Layer Name</th><th align="center" valign="middle" >Explode</th></tr></thead><tr><td align="center" valign="middle" >45030331</td><td align="center" valign="middle" >450303</td><td align="center" valign="middle" >并行桥</td><td align="center" valign="middle" >ITFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >27020132</td><td align="center" valign="middle" >270201</td><td align="center" valign="middle" >不能通车水闸A</td><td align="center" valign="middle" >IHFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >27020133</td><td align="center" valign="middle" >270201</td><td align="center" valign="middle" >不能走人的水闸面</td><td align="center" valign="middle" >IHFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >34060131</td><td align="center" valign="middle" >340601</td><td align="center" valign="middle" >厕所</td><td align="center" valign="middle" >IRFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >38010132</td><td align="center" valign="middle" >380101</td><td align="center" valign="middle" >城楼</td><td align="center" valign="middle" >IRFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >33010131</td><td align="center" valign="middle" >310301</td><td align="center" valign="middle" >抽水站A</td><td align="center" valign="middle" >IRESPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >27020231</td><td align="center" valign="middle" >270202</td><td align="center" valign="middle" >船闸面</td><td align="center" valign="middle" >IHFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >33060331</td><td align="center" valign="middle" >330603</td><td align="center" valign="middle" >打谷场</td><td align="center" valign="middle" >IRFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >32140031</td><td align="center" valign="middle" >321400</td><td align="center" valign="middle" >单个露天设备面</td><td align="center" valign="middle" >IRFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >46040131</td><td align="center" valign="middle" >460401</td><td align="center" valign="middle" >灯塔范围面</td><td align="center" valign="middle" >ITFCPL</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >32150631</td><td align="center" valign="middle" >321506</td><td align="center" valign="middle" >地磅A</td><td align="center" valign="middle" >IRFCPL</td><td align="center" valign="middle" >1</td></tr></tbody></table></table-wrap><p>表2. 模板中符号导出设置</p></sec></sec><sec id="s7"><title>5. 结束语</title><p>灵活的模板信息映射机制、简单易学的脚本二次开发技术是EPS2008地理信息工作站服务于济南市基础地理信息公共平台数据转换的两个核心技术，通过在平台数据实际生产工作中将以上技术整合利用，充分发挥了工作站集约、便利、灵活的优势，在规范数据生产流程和提高数据成果质量的同时，大大提高了数据生产效率。</p></sec><sec id="s8"><title>文章引用</title><p>邵飞,魏金明,梁坤,陈珂. EPS2008数据转换技术在济南市基础地理信息公共平台数据生产中的应用The Application of EPS2008 Data Exchange in Jinan Fundamental Geographic Information Public Platform Data Production[J]. 测绘科学技术, 2015, 03(04): 86-90. http://dx.doi.org/10.12677/GST.2015.34011</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16237-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">gstarer (2012) EPS2008地理信息工作站模板控制技术. http://hanspub.org/journal/Instructions.aspx?JournaID=594</mixed-citation></ref><ref id="hanspub.16237-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">王海波, 王磊 (2010) 于EPS脚本语言VBscript的二次开发研究. 大众科技, 7, 20-21, 16.</mixed-citation></ref></ref-list></back></article>