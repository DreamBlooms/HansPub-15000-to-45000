<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">OJTT</journal-id><journal-title-group><journal-title>Open Journal of Transportation Technologies</journal-title></journal-title-group><issn pub-type="epub">2326-3431</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/OJTT.2018.74028</article-id><article-id pub-id-type="publisher-id">OJTT-25767</article-id><article-categories><subj-group subj-group-type="heading"><subject>OJTT20180400000_55399899.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  一种基于历史轨迹数据的实时公交到站预测算法
  A Real-Time Bus Arrival Time Prediction Algorithm Based on Historical GPS
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>丘</surname><given-names>建栋</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>董</surname><given-names>绍轩</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>强</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>广东省交通信息工程技术研究中心，广东 深圳</addr-line></aff><aff id="aff2"><addr-line>深圳市城市交通规划设计研究中心有限公司，广东 深圳</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>631581227@qq.com(董绍)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>14</day><month>06</month><year>2018</year></pub-date><volume>07</volume><issue>04</issue><fpage>222</fpage><lpage>228</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   实时公交到站预测是智慧出行服务的重要组成部分，可靠的预测结果能够帮助乘客合理规划出行方案、减少等车时间。针对常见实时公交到站算法存在的所需数据类型多、模型复杂、应用场景单一、算法复杂度高等问题，本文提出了一种基于历史轨迹数据的实时公交到站预测算法，为乘客提供时间、剩余站点数量和剩余距离的预测结果。并开发Android应用，接入深圳市实时公交GPS数据，验证了本文所提出算法的准确性和简单性，可满足大规模应用的需求。 Real-time bus arrival time prediction is an important part of smart transit service. Reliable pre-dicting results can help passengers to reduce waiting time and plan trip reasonably. Common al-gorithms have many problems, such as many kinds of data needed, complex models, single application scenarios and high complexity of algorithms, this paper presents a real-time bus arrival time prediction algorithm based on historical GPS, providing passengers with remaining travel time, number of stations and distance. And an Android application accessing real-time GPS data in Shenzhen City is developed to verify the accuracy and simplicity of the proposed algorithm to meet the needs of large-scale application.
    
  
 
</p></abstract><kwd-group><kwd>公交，实时到站预测，GPS轨迹, Transit</kwd><kwd> Real-Time Arrival Time Prediction</kwd><kwd> GPS</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>一种基于历史轨迹数据的实时公交到站 预测算法<sup> </sup></title><p>丘建栋<sup>1</sup>，董绍轩<sup>2</sup>，李强<sup>2</sup></p><p><sup>1</sup>深圳市城市交通规划设计研究中心有限公司，广东 深圳</p><p><sup>2</sup>广东省交通信息工程技术研究中心，广东 深圳</p><p><img src="//html.hanspub.org/file/3-2760317x1_hanspub.png" /></p><p>收稿日期：2018年6月18日；录用日期：2018年6月29日；发布日期：2018年7月6日</p><disp-formula id="hanspub.25767-formula33"><graphic xlink:href="//html.hanspub.org/file/3-2760317x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>实时公交到站预测是智慧出行服务的重要组成部分，可靠的预测结果能够帮助乘客合理规划出行方案、减少等车时间。针对常见实时公交到站算法存在的所需数据类型多、模型复杂、应用场景单一、算法复杂度高等问题，本文提出了一种基于历史轨迹数据的实时公交到站预测算法，为乘客提供时间、剩余站点数量和剩余距离的预测结果。并开发Android应用，接入深圳市实时公交GPS数据，验证了本文所提出算法的准确性和简单性，可满足大规模应用的需求。</p><p>关键词 :公交，实时到站预测，GPS轨迹</p><disp-formula id="hanspub.25767-formula34"><graphic xlink:href="//html.hanspub.org/file/3-2760317x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/3-2760317x7_hanspub.png" /> <img src="//html.hanspub.org/file/3-2760317x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 研究背景</title><p>公共交通是城市经济和民众生活中最重要的基础设施之一，发展城市公共交通不仅是缓解城市交通拥堵的有效措施，也是改善城市人居环境，促进城市可持续发展的必然要求。智能交通系统通过实时交通信息发布使得出行者对即将面对的交通环境有足够了解，并据此做出合理出行规划，所以作为公交信息服务的重要组成部分，公交实时到站的可靠预测显得尤为重要 [<xref ref-type="bibr" rid="hanspub.25767-ref1">1</xref>] 。</p><p>国外关于公交到站时间的研究可追溯到上世纪70年代，根据公交调度提供的发车信息建立静态预测模型，但是由于当时并没有实时公交数据，所以并不能满足公众的出行服务需求。随着GPS定位技术、通信技术的快速发展，使得实时公交数据采集和传输成为可能，从而可以提供动态的到站预测方法 [<xref ref-type="bibr" rid="hanspub.25767-ref2">2</xref>] 。</p><p>常用的实时到站预测方法有历史平均法、神经网络模型、卡尔曼滤波模型、支持向量机模型 [<xref ref-type="bibr" rid="hanspub.25767-ref3">3</xref>] 、基于概率预测模型等 [<xref ref-type="bibr" rid="hanspub.25767-ref2">2</xref>] 。但是这些算法大多存在所需数据种类较多、算法复杂、效率不高、适用场景单一，无法进行大规模结果预测等问题 [<xref ref-type="bibr" rid="hanspub.25767-ref4">4</xref>] 。</p><p>本文提出一种基于历史数据的实施到站预测算法，实时轨迹确定车辆位置，根据历史轨迹数据预测到站时间和距离，相对于其他算法，简单、高效，能够满足深圳全市运行车辆的实时到站时间预测需求，同时预测结果也相对准确，满足实际应用需要。</p></sec><sec id="s4"><title>2. 算法思路</title><p>相同路段的交通运行状况具有周期性特征，历史数据对于公交实时到站的预测具有非常重要的参考价值。本文提出一种基于历史平均法的实时公交到站预测算法，不同于传统历史平均法，而是用站点按次序将线路打断为物理区间，如图1所示。</p><p>历史行程时间计算以物理区间为基本单元，按工作日、非工作日区分，以一个小时的时间粒度，求得各时间段内物理区间所需的行程时间分布，作为实时公交到站预测的基础。</p><p>算法主要包括历史数据处理与实时预测两部分。</p><p>图1. 线路打断</p><sec id="s4_1"><title>2.1. 历史数据处理</title><p>针对大多数方法所建立的预测模型需要多种数据支持，本文方法仅需要准备公交线路、站点数据和历史轨迹数据，对于历史轨迹的处理过程包括以下几步：</p><p>1) 数据清洗：对历史轨迹数据中位置异常和重复、无效记录进行清洗，将部分有信息缺失的记录根据其他记录进行补齐；</p><p>2) 轨迹匹配：根据轨迹点位置和方向角信息判断车辆运行方向，并匹配至公交线路最邻近点上(图2)；</p><p>3) 到站时间插值：搜索站点邻近轨迹点，对历史到站时间进行插值。为了简化估计过程，本文假设相邻轨迹点间车辆匀速运行，从而根据距离插值得到站点的到达时间。如图3所示，A、B为相邻两个轨迹点，记录时间分别为 t A 和 t B ，中间经过站点x，则到达x的时间</p><p>t x = t A + ( t B − t A ) ∗ d A x / d A B</p><p>4) 路段行程时间：计算物理区间内行程时间，并根据工作日、非工作日，以1个小时为粒度求得各时间段的平均行程时间 t A B i ，i为第i个时间段(图4)。</p></sec><sec id="s4_2"><title>2.2. 实时预测</title><p>要进行 实时公交到站时间预测，首先要确定车辆所处的线路位置，非环线的公交大都包含上行和下行两个方向，而公交GPS轨迹信息只包含它所处位置的经纬度、时间、车辆方向角等，并不包含运行方向。此时，需要通过位置和方向角判断车辆运行方向。</p><p>如图5所示，线路l有上行和下行两个方向，轨迹点P的方向角为α，与上行方向的夹角更小，并且P点到线路上行方向的最近点P’的距离|PP’| &lt; 30米，则将P点匹配到线路上行方向上的P’点处。此时，可以推出车辆位于物理区间 ( i , i + 1 ) 内，从而可以预测车辆到达后续站点 i + 1 , i + 2 , i + 3 , ⋯ , i + n 的剩余时间：</p><p>t P ′ , i + 1 = t i , i + 1 ∗ d P ′ , i + 1 / d i , i + 1</p><p>T n = t P ′ , i + 1 + t i , i + 1 + ⋯ + t n − 1 , n</p></sec></sec><sec id="s5"><title>3. 算法应用</title><p>以本文算法为核心，以深圳市一个月公交历史轨迹数据为基础进行处理分析，得到工作日和非工作日各时间段每个物理区间的行程时间分布作为时间预测基础，开发Android应用服务，接入深圳全市接入实时11,000余辆(非全样)GPS公交数据，为乘客提供全市范围内约1万个公交站点700余条线路的实时公交到站预测服务(图6)。</p><p>用户通过应用自动获取的位置信息提供最近站点信息，或者选择输入需要查询的站点信息，即可输出经过对应站点的所有线路车辆实时到站信息，同时可以显示某一条线路上所有车辆的位置信息，前端20秒刷新一次预测结果，保证信息的时效性。</p><p>图2. 轨迹匹配结果示意图</p><p>图3. 到站时间插值示意图</p><p>图4. 历史数据处理过程</p><p>图5. 实时位置获取</p><p>图6. 用户界面</p><sec id="s5_1"><title>3.1. 数据表设计</title><p>实时到站数据表设计如下，包含车辆编号、线路名称、方向名称，每条记录表达当前车辆和公交站点的相对位置和时间预测信息，以12路某辆公交车为例，实时获取其位置位于地王大厦站与市委站之间，后续站点的到站预测如表1所示。</p></sec><sec id="s5_2"><title>3.2. 算法效率分析</title><p>为满足大规模实时公交到站预测，以深圳市一天实时到站预测算法运行时间为例，测试时间包含从数据接收、处理、计算，到预测结果数据入库全过程，分时间段单次更新所需运行时间分布如图7所示。</p><p>图7可以看出，高峰期运行车辆较多导致计算成本增加，单次更新所需时间大约为5秒左右，完全满足实际刷新速度的要求，从而证明本文所提算法的简单、高效性。</p></sec><sec id="s5_3"><title>3.3. 实测验证</title><p>为验证算法有效性，笔者特进行了实地验证，以深圳市竹子林①站为例，通过7:00~9:00早高峰时期车辆到站状况与本文预测结果进行对比，实测证明，在实时接入数据缺失的情况下，本文所提方法仍可以实现70%以上的准确预测，从而证明了本文所提算法的有效性。</p></sec></sec><sec id="s6"><title>4. 总结与展望</title><p>实时公交到站预测是公交信息服务的重要组成部分，本文提出的实时公交到站算法有效解决了当前常见实时公交到站算法存在的所需数据种类多、模型复杂、计算复杂度高等问题。</p><p>但是，面对复杂的交通状况，本文算法仍需要从以下几个方面进行改进：</p><p>1) 对于行程时间预测的精细度有待进一步提高，加入车辆停靠时间、信号灯导致的延迟等因素 [<xref ref-type="bibr" rid="hanspub.25767-ref5">5</xref>] ；</p><p>2) 对于异常突发事件如事故、台风天气导致的车辆延迟情况，需要在算法中加入异常处理模块。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Data display exampl</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >车辆编号</th><th align="center" valign="middle" >站点名称</th><th align="center" valign="middle" >线路名称</th><th align="center" valign="middle" >方向名称</th><th align="center" valign="middle" >剩余站数</th><th align="center" valign="middle" >剩余时间(秒)</th><th align="center" valign="middle" >剩余距离(米)</th><th align="center" valign="middle" >更新时间</th></tr></thead><tr><td align="center" valign="middle" >粤XXXXX</td><td align="center" valign="middle" >市委</td><td align="center" valign="middle" >12路</td><td align="center" valign="middle" >火车站–福田农批市场</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >72</td><td align="center" valign="middle" >362</td><td align="center" valign="middle" >2017-12-2414:41:14</td></tr><tr><td align="center" valign="middle" >粤XXXXX</td><td align="center" valign="middle" >市总工会</td><td align="center" valign="middle" >12路</td><td align="center" valign="middle" >火车站–福田农批市场</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >208</td><td align="center" valign="middle" >933</td><td align="center" valign="middle" >2017-12-2414:41:14</td></tr><tr><td align="center" valign="middle" >粤XXXXX</td><td align="center" valign="middle" >荔园小学</td><td align="center" valign="middle" >12路</td><td align="center" valign="middle" >火车站–福田农批市场</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >310</td><td align="center" valign="middle" >1278</td><td align="center" valign="middle" >2017-12-2414:41:14</td></tr><tr><td align="center" valign="middle" >粤XXXXX</td><td align="center" valign="middle" >妇儿医院</td><td align="center" valign="middle" >12路</td><td align="center" valign="middle" >火车站–福田农批市场</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >513</td><td align="center" valign="middle" >1775</td><td align="center" valign="middle" >2017-12-2414:41:14</td></tr><tr><td align="center" valign="middle" >粤XXXXX</td><td align="center" valign="middle" >圣延苑酒店</td><td align="center" valign="middle" >12路</td><td align="center" valign="middle" >火车站–福田农批市场</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >598</td><td align="center" valign="middle" >2144</td><td align="center" valign="middle" >2017-12-2414:41:14</td></tr><tr><td align="center" valign="middle" >粤XXXXX</td><td align="center" valign="middle" >海馨苑</td><td align="center" valign="middle" >12路</td><td align="center" valign="middle" >火车站–福田农批市场</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >716</td><td align="center" valign="middle" >2856</td><td align="center" valign="middle" >2017-12-2414:41:14</td></tr><tr><td align="center" valign="middle"  colspan="8"  >…</td></tr></tbody></table></table-wrap><p>表1. 数据表示例</p><p>图7. 算法效率分析</p></sec><sec id="s7"><title>致谢</title><p>感谢深圳市科技计划项目(项目编号GGFW2016033017241891，项目名称“深圳市交通大数据公共技术服务平台”)和深圳市战略性新兴产业发展专项资金2017年第一批扶持计划(项目名称：深圳市交通碳排放工程实验室，批复文号：深发改(2017)550号)的资助。</p></sec><sec id="s8"><title>基金项目</title><p>深圳市科技计划项目(GGFW2016033017241891)，深圳市战略性新兴产业发展专项(深发改(2017)550号)。</p></sec><sec id="s9"><title>文章引用</title><p>丘建栋,董绍轩,李 强. 一种基于历史轨迹数据的实时公交到站预测算法 A Real-Time Bus Arrival Time Prediction Algorithm Based on Historical GPS[J]. 交通技术, 2018, 07(04): 222-228. https://doi.org/10.12677/OJTT.2018.74028</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.25767-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">沈旗. 基于浮动公交车的交通信息实时检测和公交车到站时间预测研究[D]: [硕士学位论文]. 杭州: 浙江大学, 2007.</mixed-citation></ref><ref id="hanspub.25767-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">向红艳, 彭学文. 公交到站时间预测研究现状与发展趋势[J]. 交通信息与安全, 2014, 32(4): 57-61.</mixed-citation></ref><ref id="hanspub.25767-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">王锐, 杨宏业, 张海鹏. 基于浮动公交车的SVM实时交通状态识别研究[J]. 内蒙古工业大学学报, 2016, 35(1): 18-23.</mixed-citation></ref><ref id="hanspub.25767-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">胡华, 高云峰, 刘志钢. 基于AVL数据的公交到站时间实时预测模型[J]. 重庆交通大学学报(自然科学版), 2012, 31(5): 1014-1017.</mixed-citation></ref><ref id="hanspub.25767-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">孙棣华, 赖云波, 廖孝勇, 等. 公交浮动车辆到站时间实时预测模型[J]. 交通运输工程学报, 2011(2): 84-89.</mixed-citation></ref></ref-list></back></article>