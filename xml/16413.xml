<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">HJDM</journal-id><journal-title-group><journal-title>Hans Journal of Data Mining</journal-title></journal-title-group><issn pub-type="epub">2163-145X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/HJDM.2015.54012</article-id><article-id pub-id-type="publisher-id">HJDM-16413</article-id><article-categories><subj-group subj-group-type="heading"><subject>HJDM20150400000_86855053.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  上海期货黄金的价格走势预测
  Forecast on the Price Trend of Shanghai Gold Futures
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>倪</surname><given-names>明明</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>费</surname><given-names>宇</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>潘</surname><given-names>建新</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>云南财经大学统计与数学学院，云南 昆明</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>13</day><month>11</month><year>2015</year></pub-date><volume>05</volume><issue>04</issue><fpage>81</fpage><lpage>88</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   黄金具有良好的流通、保值和避险等功能，目前是世界各国储备资产的重要组成部分。黄金期货具有规避风险、获取收益的作用。黄金期货市场不仅对黄金现货市场具有重要的导向作用，而且对完善货币市场、外汇市场，对提高金融市场国际吸引力，对国民经济的又好又快发展，都具有重大意义。本文运用两状态的马尔可夫状态变换模型以及支持向量回归模型来分析期货黄金的走势上涨或者下跌的趋势，重要将使用的方法为复合似然函数，可以对国内黄金期货投资者提供一种预测方法。 Gold has good functions of circulation and hedging. It is an important part of the world’s reserve assets. Gold futures have the function of avoiding risk and getting benefits. Gold futures market not only has an important role in the gold spot market, but also has great significance for improving money market and foreign exchange market, national economy and international financial markets. In this paper, we forecast the trend of the gold futures using support vector regression model and the two states of the Markov state transition model, the latter model uses composite likelihood function. This model can provide a good prediction method for the domestic gold futures investors.
    
  
 
</p></abstract><kwd-group><kwd>黄金期货，支持向量回归，马尔可夫状态变换模型，复合似然函数, Gold Futures</kwd><kwd> Support Vector Regression</kwd><kwd> Markov Transformation Model</kwd><kwd> Composite Likelihood Function</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>上海期货黄金的价格走势预测<sup> </sup></title><p>倪明明，费宇<sup>*</sup>，潘建新</p><p>云南财经大学统计与数学学院，云南 昆明</p><disp-formula id="hanspub.16413-formula444"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2015年10月25日；录用日期：2015年11月19日；发布日期：2015年11月26日</p><disp-formula id="hanspub.16413-formula445"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>黄金具有良好的流通、保值和避险等功能，目前是世界各国储备资产的重要组成部分。黄金期货具有规避风险、获取收益的作用。黄金期货市场不仅对黄金现货市场具有重要的导向作用，而且对完善货币市场、外汇市场，对提高金融市场国际吸引力，对国民经济的又好又快发展，都具有重大意义。本文运用两状态的马尔可夫状态变换模型以及支持向量回归模型来分析期货黄金的走势上涨或者下跌的趋势，重要将使用的方法为复合似然函数，可以对国内黄金期货投资者提供一种预测方法。</p><p>关键词 :黄金期货，支持向量回归，马尔可夫状态变换模型，复合似然函数</p><disp-formula id="hanspub.16413-formula446"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 研究背景</title><p>黄金作为一种具有商品和金融双重属性的特殊商品，它具有良好的流通、保值和避险等功能，是投资者规避风险、获取收益的重要手段。我国黄金产业的市场化开发在2001年才开始步入市场发展道路。在2008年，上海期货交易所正式推出黄金期货合约，这标志着我国黄金市场体系的初步建成。所谓黄金期货，是指以国际黄金市场未来某时点的黄金价格为交易标的期货合约，投资人买卖黄金期货的盈亏，是由进场到出场两个时间的金价价差来衡量，契约到期后则是实物交割。最近几年，黄金期货投资在国内越来越热。因此，对于黄金的价格的涨跌预测具有十分重要的现实意义。</p><p>期货市场作为金融市场的重要组成部分，其价格走势能够反映人们，对价格未来走势的预期，期货市场具有以下作用：</p><p>(1) 价格发现：所谓价格发现，是指利用市场公开竞价交易等交易制度，形成一个反映市场供求关系的市场价格，具体来说就是，市场的价格能够对市场未来走势做出预期反应，同现货市场一起，共同对未来做出预期。</p><p>(2) 套期保值：套期保值是指把期货市场当作转移价格风险的场所，利用期货合约作为将来在现货市场上买卖商品的临时替代物，对其现在买进准备以后售出商品或对将来需要买进商品的价格进行保险的交易活动。</p><p>尽管我国黄金期货上市时间不久，但是吸引了许多学者的关注。王中香(2009) [<xref ref-type="bibr" rid="hanspub.16413-ref1">1</xref>] 运用BP神经网络模型来预测黄金期货的价格。徐伟(2009) [<xref ref-type="bibr" rid="hanspub.16413-ref2">2</xref>] 本文分别从期货市场和现货市场两个方面对中国黄金期货价格发现障碍的原因进行分析。高扬(2010) [<xref ref-type="bibr" rid="hanspub.16413-ref3">3</xref>] 得出我国黄金期货定价效率不高，与现货价格互动的强度较低的结论。祝合良(2012) [<xref ref-type="bibr" rid="hanspub.16413-ref4">4</xref>] 验证了黄金期货市场进行套期保值是有效的。刘飞(2013) [<xref ref-type="bibr" rid="hanspub.16413-ref5">5</xref>] 利用协整理论、误差修正模型、永久瞬时模型以及分位数回归等方法系统分析了我国黄金期货市场的定价效率、引导–滞后关系以及价格发现功能。仲维凯[<xref ref-type="bibr" rid="hanspub.16413-ref6">6</xref>] 在2015年影响黄金价格的因素，并建立了预测黄金价格的ARMA模型和VAR模型。</p><p>Hamilton (1989) [<xref ref-type="bibr" rid="hanspub.16413-ref7">7</xref>] 首先提出Markov状态转换模型，运用三状态两阶滞后的Markov机制转换模型研究了美国1953~1984年间季度实际产出增长的波动，模型回归效果良好，能够较好地刻画了实际产出增长的非线性动态和非对称特性。Gray (1996) [<xref ref-type="bibr" rid="hanspub.16413-ref8">8</xref>] 为了解决MS-GARCH模型存在路径依赖问题，提出了一种近似的解法：通过简化假设使条件方差依赖于上一期的状态，通过极大似然法估计下一状态的方差。Hassan，Nath (2005) [<xref ref-type="bibr" rid="hanspub.16413-ref9">9</xref>] 提出了一种基于机器学习的股票价格预测方法，采用了连续的隐含马尔科夫模型，将股票的日开盘价，最高价，最低价与收盘价作为模型输入，预测股票的未来日收盘价。Dueker，Neely(2007) [<xref ref-type="bibr" rid="hanspub.16413-ref10">10</xref>] 利用Markov状态转换模型来预测外汇市场中汇率的变动，取得了一定的效果。周茂化(2011) [<xref ref-type="bibr" rid="hanspub.16413-ref11">11</xref>] 与许立平(2011) [<xref ref-type="bibr" rid="hanspub.16413-ref12">12</xref>] 分别运用GARCH族模型和ARIMA模型对黄金市场进行预测研究，GARCH族模型和ARIMA模型都属于单一状态的模型，而黄金期货市场是属于一个多状态模型(高波动，低波动)。因此本文希望能应用一个多状态模型去建立黄金期货的预测模型。而Zou，Che (2013) [<xref ref-type="bibr" rid="hanspub.16413-ref13">13</xref>] 利用正态分布条件下复合似然函数方法，改进了Markov状态转换模型中的参数估计，对原油价格进行预测，效果良好。对于黄金期货的预测，没有人将运用基于复合似然函数方法的Markov状态转换模型运用其中，本文将此方法运用，希望能获得一个较好的结果。在Markov状态转换模型中，只用多个状态的均值去预测下一期的估计值。本文考虑到下一期的估计值应该与状态的均值与方差都有一定的关系，因此本文将尝试结合支持向量回归模型(SVR)与复合似然函数下的Markov状态转换模型来预测下一期的估计值。杨金芳(2005) [<xref ref-type="bibr" rid="hanspub.16413-ref14">14</xref>] 将支持向量回归模型应用到时间序列。李永娜(2014) [<xref ref-type="bibr" rid="hanspub.16413-ref15">15</xref>] 对支持向量机的回归预测进行了综述。</p><p>本文将以日度上海期货黄金指数为研究对象，运用马尔可夫状态。变换模型去预测后天的价格上涨或者下跌的情况，其中我们将选取复合似然函数方法。预测方法为向前预测方法或者支持向量回归模型。</p></sec><sec id="s4"><title>2. 研究方法与模型</title><sec id="s4_1"><title>2.1. Markov链</title><p>设随机过程<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x10_hanspub.png" xlink:type="simple"/></inline-formula>只取整数值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x11_hanspub.png" xlink:type="simple"/></inline-formula>，假定，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x12_hanspub.png" xlink:type="simple"/></inline-formula>的取值只与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x13_hanspub.png" xlink:type="simple"/></inline-formula>有关，而与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x14_hanspub.png" xlink:type="simple"/></inline-formula>期前S的取值无关，那么此随机过程被称为N状态下的马尔科夫链，用公式可表示为：</p><disp-formula id="hanspub.16413-formula447"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x15_hanspub.png"  xlink:type="simple"/></disp-formula><p>转移概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x16_hanspub.png" xlink:type="simple"/></inline-formula>代表状态<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x17_hanspub.png" xlink:type="simple"/></inline-formula>条件下<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x18_hanspub.png" xlink:type="simple"/></inline-formula>的概率，若该过程服从一阶Markov链过程，可用转移矩阵P来表示转移概率：</p><disp-formula id="hanspub.16413-formula448"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x19_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x20_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec><sec id="s4_2"><title>2.2. Markov模型</title><p>下面以正态分布为例，构建期货黄金指数的Markov模型，假定t时期的期货黄金指数为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x21_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x22_hanspub.png" xlink:type="simple"/></inline-formula>。假定存在一个不可观测变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x23_hanspub.png" xlink:type="simple"/></inline-formula>代表t时刻期货黄金指数所处状态，当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x24_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x25_hanspub.png" xlink:type="simple"/></inline-formula>的边缘分布为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x26_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x27_hanspub.png" xlink:type="simple"/></inline-formula>服从N状态下的一阶马尔科夫链。</p><p>Markov模型中需要估计的参数有转移概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x28_hanspub.png" xlink:type="simple"/></inline-formula>。我们采用EM算法去进行参数估计，关于似然函数的选择有两种方式：完全似然函数Zucchini (2009) [<xref ref-type="bibr" rid="hanspub.16413-ref16">16</xref>] 、复合似然函数Zou (2013) [<xref ref-type="bibr" rid="hanspub.16413-ref13">13</xref>] 。不过在Zou (2013) [<xref ref-type="bibr" rid="hanspub.16413-ref13">13</xref>] 已经说明复合似然函数效果要好于完全似然函数。</p><p>在正态分布条件下，复合似然函数可表示为：</p><disp-formula id="hanspub.16413-formula449"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x30_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x31_hanspub.png" xlink:type="simple"/></inline-formula>时刻为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x32_hanspub.png" xlink:type="simple"/></inline-formula>状态而<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x33_hanspub.png" xlink:type="simple"/></inline-formula>状态。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x34_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x35_hanspub.png" xlink:type="simple"/></inline-formula>属于状态<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x36_hanspub.png" xlink:type="simple"/></inline-formula>状态的概率。</p><p>每时刻的状态都是未知的，我们可以将其作为缺失变量。因此可以利用EM算法估计参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x37_hanspub.png" xlink:type="simple"/></inline-formula>。利用所预测出来的参数，通过平滑概率，可以计算出当t = T时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x38_hanspub.png" xlink:type="simple"/></inline-formula>属于每个状态的概率。我们也可以通过参数P、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x39_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x40_hanspub.png" xlink:type="simple"/></inline-formula>与第t时刻的观测值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x41_hanspub.png" xlink:type="simple"/></inline-formula>可以预测出当t = T + 1时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x42_hanspub.png" xlink:type="simple"/></inline-formula>属于每个状态的概率，均值和方差。</p><p>本文运用惩罚下复合似然函数Chen (2012) [<xref ref-type="bibr" rid="hanspub.16413-ref17">17</xref>] 作为似然函数</p><disp-formula id="hanspub.16413-formula450"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x43_hanspub.png"  xlink:type="simple"/></disp-formula><p>在这里<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x44_hanspub.png" xlink:type="simple"/></inline-formula>为序列的样本方差。由Zou (2013) [<xref ref-type="bibr" rid="hanspub.16413-ref13">13</xref>] 可知在这种方法下迭代步骤为</p><p>在E-STEP，我们运用贝叶斯公式计算条件期望值</p><disp-formula id="hanspub.16413-formula451"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x45_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x46_hanspub.png" xlink:type="simple"/></inline-formula>。在EM算法中，我们假定这个变量为隐藏变量。</p><p>在M-STEP，我们最大化似然函数，则可得</p><disp-formula id="hanspub.16413-formula452"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x47_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.16413-formula453"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x48_hanspub.png"  xlink:type="simple"/></disp-formula><p>TEP</p><disp-formula id="hanspub.16413-formula454"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x49_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x50_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x51_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x52_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec><sec id="s4_3"><title>2.3. 预测方法</title><p>本文将采用两种预测方法，第一种基于向前预测方法，第二种为基于支持向量回归的预测方法。</p><sec id="s4_3_1"><title>2.3.1. 向前预测方法</title><p>在本文，主要考虑的是利用过去100天交易日的上海期货黄金价格变动数据，来预测下一天涨跌情况，并且逐步递归的进行。我们将运用向前预测方法Baum (1970) [<xref ref-type="bibr" rid="hanspub.16413-ref18">18</xref>] 预测下一天的股票收益率。</p><disp-formula id="hanspub.16413-formula455"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x53_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x54_hanspub.png" xlink:type="simple"/></inline-formula>可以用向前递归方法进行预测。</p><disp-formula id="hanspub.16413-formula456"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x55_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.16413-formula457"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x56_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.16413-formula458"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x57_hanspub.png"  xlink:type="simple"/></disp-formula><p>通过上述公式，可以获得<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x58_hanspub.png" xlink:type="simple"/></inline-formula>的估计值。</p></sec><sec id="s4_3_2"><title>2.3.2. 基于支持向量回归方法(SVR)</title><p>本文所提出的基于支持向量回归方法为对公式(7)中的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x59_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x60_hanspub.png" xlink:type="simple"/></inline-formula>值修正。因为每一个时间段下的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x61_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x62_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x63_hanspub.png" xlink:type="simple"/></inline-formula>有一定关系，但不一定为线性关系。因此，我们考虑用支持向量回归方法去拟合数据。由向前预测方法可知，估计<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x64_hanspub.png" xlink:type="simple"/></inline-formula>，将会估计出一个<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x65_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x66_hanspub.png" xlink:type="simple"/></inline-formula>。本文所提出的基于支持向量回归方法基于向前预测方法下，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x67_hanspub.png" xlink:type="simple"/></inline-formula>分别与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x68_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x69_hanspub.png" xlink:type="simple"/></inline-formula>建立两个支持向量回归模型，设定样本所需时间为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x70_hanspub.png" xlink:type="simple"/></inline-formula>，并且对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x71_hanspub.png" xlink:type="simple"/></inline-formula>进行预测。模型定义如下</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x72_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x73_hanspub.png" xlink:type="simple"/></inline-formula>为因变量向高维空间的映射，在这里<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x74_hanspub.png" xlink:type="simple"/></inline-formula>。关于支持向量回归模型，我们需要极小化目标函数，即求下式最小：</p><disp-formula id="hanspub.16413-formula459"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x75_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.16413-formula460"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1760071x76_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x77_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x78_hanspub.png" xlink:type="simple"/></inline-formula>称为核函数。在这里，我们选择<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x79_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x80_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x81_hanspub.png" xlink:type="simple"/></inline-formula>核函数为RBF函数的支持向量机。我们利用这两个支持向量回归模型分布预测第201天的波动值，记<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x82_hanspub.png" xlink:type="simple"/></inline-formula>。令</p><disp-formula id="hanspub.16413-formula461"><graphic xlink:href="http://html.hanspub.org/file/5-1760071x83_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x84_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x85_hanspub.png" xlink:type="simple"/></inline-formula>的计算与向前预测方法一样。</p><p>假设，向前预测方法需要100天作为训练集，获得<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x86_hanspub.png" xlink:type="simple"/></inline-formula>。需要200天去获得支持向量回归模型。因此可知，我们总共需要300作为训练样本，去预测301的数据值。因此可知预测方法为向前预测方法所需要的天数比支持向量回归模型少。</p></sec></sec></sec><sec id="s5"><title>3. 实证分析</title><p>我们用了2008年1月到2014年12月份的上海黄金期货收盘价格做本文的价值数据(price)，计算价格变动趋势为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x87_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x88_hanspub.png" xlink:type="simple"/></inline-formula>表示第t期的黄金期货的收盘价。因此可知，当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x89_hanspub.png" xlink:type="simple"/></inline-formula>，表示下一交易日相对上一个交易日来说，期货价格为上涨。当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x90_hanspub.png" xlink:type="simple"/></inline-formula>，预测下一交易日期货价格为下跌。</p><p>假如我们在每年年初，有100元准备投资黄金期货。如果预测的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x91_hanspub.png" xlink:type="simple"/></inline-formula>，表示进行买进套期保值，并且一直持有。直到<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x92_hanspub.png" xlink:type="simple"/></inline-formula>，表示卖出手头期货产品，并进行卖出套期保值。我们选择的100天作为训练天数来预测后天一天的涨跌情况因此我们预测的数据将不会从2008年1月开始，本文将选择预测结果从2009年1月到2014年12月来检验模型的有效性。如表1。</p><p>向前预测方法模型的训练天数为100天，预测第101天的价格变动，我们假定其为一个时段。因为每个时段下的两个状态所对应的均值与方差所不同，因此我们主要关心套期交换次数与年收益率。套期交换次数越少就表面了黄金期货市场具有较大上涨趋势或者下跌趋势。并且套期交换次数较少能减少交易所需要的费用。有上表1，可知向前预测模型的年平均收益率为1.09，并且年平均套期交换次数为4次，这样交易手续费将会减少。而预测方法为支持向量回归的平均年收益率为1.13。由此可知，预测方法为支持向量回归的效果要好于向前预测。不过交易次数为向前预测方法的4倍，假如考虑每笔交易将获得的收益情况，向前预测方法比支持向量回归的方法要好。但是两种方法都比淘宝招财宝的最高收益率1.06要高。</p><p>图1为复合似然函数下马尔可夫状态模型下，运用向前预测方法预测2009~2014的股票波动情况，图2为复合似然函数下马尔可夫状态模型下，运用支持向量回归方法预测2009~2014的股票波动情况。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Prediction performance of Markov transformation mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  colspan="3"  >向前预测方法</th><th align="center" valign="middle"  colspan="3"  >支持向量回归</th></tr></thead><tr><td align="center" valign="middle" >年份</td><td align="center" valign="middle" >收益率</td><td align="center" valign="middle" >套期交换次数</td><td align="center" valign="middle" >年份</td><td align="center" valign="middle" >收益率</td><td align="center" valign="middle" >套期交换次数</td></tr><tr><td align="center" valign="middle" >2009</td><td align="center" valign="middle" >26.3%</td><td align="center" valign="middle" >8</td><td align="center" valign="middle" >2009</td><td align="center" valign="middle" >−2.5%</td><td align="center" valign="middle" >15</td></tr><tr><td align="center" valign="middle" >2010</td><td align="center" valign="middle" >18.9%</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >2010</td><td align="center" valign="middle" >22.9%</td><td align="center" valign="middle" >19</td></tr><tr><td align="center" valign="middle" >2011</td><td align="center" valign="middle" >−5.9%</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >2011</td><td align="center" valign="middle" >21.0%</td><td align="center" valign="middle" >16</td></tr><tr><td align="center" valign="middle" >2012</td><td align="center" valign="middle" >−11.5%</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >2012</td><td align="center" valign="middle" >4.7%</td><td align="center" valign="middle" >17</td></tr><tr><td align="center" valign="middle" >2013</td><td align="center" valign="middle" >33.2%</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >2013</td><td align="center" valign="middle" >31.2%</td><td align="center" valign="middle" >14</td></tr><tr><td align="center" valign="middle" >2014</td><td align="center" valign="middle" >−4.4%</td><td align="center" valign="middle" >7</td><td align="center" valign="middle" >2014</td><td align="center" valign="middle" >−2.2%</td><td align="center" valign="middle" >18</td></tr><tr><td align="center" valign="middle" >平均值</td><td align="center" valign="middle" >9.4%</td><td align="center" valign="middle" >4.2</td><td align="center" valign="middle" >平均</td><td align="center" valign="middle" >12.53%</td><td align="center" valign="middle" >16.5</td></tr></tbody></table></table-wrap><p>表1. 马尔科夫转换模型投资效果</p><p>图1. 黄金期货价格走势(Markov状态转换模型)</p><p>图2. 黄金期货价格走势(Markov状态转换模型 + SVR)</p><p>其中position为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-1760071x95_hanspub.png" xlink:type="simple"/></inline-formula>时，我们进行卖出套期。其中position为1时，我们进行买入套期。</p><p>由图1，图2可知，两个模型所做的交易基本相似，不过在局部有点不一样，两种模型对总体的波动情况都有较好的拟合，2009~2011这种总体趋势上升的趋势能模拟的较好，对2013年总的下降趋势也能拟合的较好，在2012与2014年拟合的效果不是很好，这个原因可能为入选的变量只有收盘价格，没有考虑到别的因素。在训练复合似然函数下的马尔可夫状态转换模型中，定义训练天数为100天也会有一定的影响结果。</p></sec><sec id="s6"><title>4. 结论</title><p>虽然本文提供的算法不能有效的预测未来黄金期货的真实价格，但是可以将其应用到期货黄金指数涨跌趋势预测，并且对期货的总体走势有较好的预测效果，按照本文的应用的交易方法可以黄金期货进行套期保值。并且通过实证分析发现，马尔可夫状态转换模型无论是基于向前预测方法还是基于SVR，都能较好预测出黄金期货的波动情况。预测方法为SVR模型的收益率要高于向前预测方法，不过单次交易的收益率要低于它。</p><p>通过预测，可以指导投资者的投资行为，进而可以规避风险以便获得更好的经济利益，另一方面又有利于采取措施建立期货预警系统，防止期货过热现象的发生。本文采用的只是用收盘一个指标做的模型，未来对期货黄金涨跌趋势的发展，可以基于本文的模型，加入更多有效的指标。本文的研究丰富了期货价格预测方法，首次将支持向量回归方法与复合似然函数下的Markov状态转换模型想结合。并且对期货价格预测有重要的理论意义和实用价值。</p></sec><sec id="s7"><title>文章引用</title><p>倪明明,费 宇,潘建新. 上海期货黄金的价格走势预测 Forecast on the Price Trend of Shanghai Gold Futures[J]. 数据挖掘, 2015, 05(04): 81-88. http://dx.doi.org/10.12677/HJDM.2015.54012</p></sec><sec id="s8"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16413-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">王中香, 王凤, 何穗. 基于神经网络的黄金期货价格的预测[J]. 湖北师范学院学报(自然科学版), 2009, 29(3): 85-88.</mixed-citation></ref><ref id="hanspub.16413-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">徐伟. 中国黄金期货价格发现功能的实证研究[D]: 硕士学位论文. 杭州: 浙江大学, 2009.</mixed-citation></ref><ref id="hanspub.16413-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">高杨. 我国黄金期货市场运行效率的实证研究[D]: 硕士学位论文. 北京: 首都经济贸易大学, 2009.</mixed-citation></ref><ref id="hanspub.16413-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">祝合良, 许贵阳. 中国黄金期货市场价格发现功能实证研究[J]. 首都经济贸易大学学报 2010(5): 44-52.</mixed-citation></ref><ref id="hanspub.16413-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">刘飞, 吴卫锋, 王开科. 我国黄金期货市场定价效率与价格发现功能测算——基于5分钟高频数据的实证研究[J]. 国际金融研究, 2013(4): 74-82.</mixed-citation></ref><ref id="hanspub.16413-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">仲维凯. 国际黄金价格的影响因素分析与预测[D]: 硕士学位论文. 昆明: 云南大学, 2015.</mixed-citation></ref><ref id="hanspub.16413-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Hamilton, J. (1989) A New Approach to the Economic Analysis of Nonstationary time Series and the Business Cycle. Econometrica, 57, 357-384. &lt;br&gt;http://dx.doi.org/10.2307/1912559</mixed-citation></ref><ref id="hanspub.16413-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Gray, S. (1996) Modeling the Conditional Distribution of Interest Rates as a Regime-Switching Process. Journal of Financial Economics, 42, 27-62. &lt;br&gt;http://dx.doi.org/10.1016/0304-405X(96)00875-6</mixed-citation></ref><ref id="hanspub.16413-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Hassan, M.R., Nath, B. and Kirley, M. (2007) A Fusion Model of HMM, ANN and GA for Stock Market Forecasting. Expert Systems with Applications, 33, 171-180. &lt;br&gt;http://dx.doi.org/10.1016/j.eswa.2006.04.007</mixed-citation></ref><ref id="hanspub.16413-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Dueker, M. and Neely, C.J. (2007) Can Markov Switching Models Predict Excess Foreign Exchange Returns? Journal of Banking &amp; Finance, 31, 279-296. &lt;br&gt;http://dx.doi.org/10.1016/j.jbankfin.2006.03.002</mixed-citation></ref><ref id="hanspub.16413-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">许立平, 罗明志. 基于ARIMA模型的黄金价格短期分析预测[J]. 财经科学, 2011(1): 26-34.</mixed-citation></ref><ref id="hanspub.16413-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">周茂华, 刘骏民, 许平祥. 基于GARCH族模型的黄金市场的风险度量与预测研究[J]. 国际金融研究, 2011(5): 87-96.</mixed-citation></ref><ref id="hanspub.16413-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Zou, W. and Chen, J. (2013) A Markov Regime-Switching Model for Crude-Oil Markets: Comparison of Composite Likelihood and Full Likelihood. The Canadian Journal of Statistics, 2, 353-367. &lt;br&gt;http://dx.doi.org/10.1002/cjs.11173</mixed-citation></ref><ref id="hanspub.16413-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">杨金芳, 翟永杰, 王东风, 徐大平. 基于支持向量回归的时间序列预测[J]. 中国电机工程学报, 2005, 25(17): 110- 114.</mixed-citation></ref><ref id="hanspub.16413-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">李永娜. 基于支持向量机的回归预测综述[J]. 信息通信, 2014(11): 32-33.</mixed-citation></ref><ref id="hanspub.16413-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Zucchini, W. and MacDonald, I.L. (2009) Hidden Markov Models for Time dSeries: An Introduction Using R. CRC Press, New York. &lt;br&gt;http://dx.doi.org/10.1201/9781420010893</mixed-citation></ref><ref id="hanspub.16413-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Chen, J. and Wang, P. (2012) Composite Likelihood Approach for the Analysis of Exchange Rates. Working Paper, University of British Columbia.</mixed-citation></ref><ref id="hanspub.16413-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Baum, L.E., Petrie, T., Soules, G. and Weiss, N. (1970) A Maximum Technique Occurring in the Statistical Analysis of Probabilistic Functions of Markov Chains. Annals of Mathematical Statistics, 41, 164-171.  
&lt;br&gt;http://dx.doi.org/10.1214/aoms/1177697196</mixed-citation></ref></ref-list></back></article>