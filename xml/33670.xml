<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JWRR</journal-id><journal-title-group><journal-title>Journal of Water Resources Research</journal-title></journal-title-group><issn pub-type="epub">2166-6024</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JWRR.2020.91004</article-id><article-id pub-id-type="publisher-id">JWRR-33670</article-id><article-categories><subj-group subj-group-type="heading"><subject>JWRR20200100000_68641592.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject><subject> 合作期刊</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于三维Copula函数的组合洪水研究
  Combined Flood Research Based on Three-Dimensional Copula Function
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>梁</surname><given-names>希金</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>丽萍</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>验科</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>佳新</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>叶</surname><given-names>凯华</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>华北电力大学可再生能源学院，北京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>27</day><month>12</month><year>2019</year></pub-date><volume>09</volume><issue>01</issue><fpage>33</fpage><lpage>41</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   当某一条河流有多条支流汇入时，干流洪水与支流洪水的遭遇是威胁下游防洪控制点安全的主要因素，干支流洪水遭遇风险估计对于下游防洪安全具有重要意义。基于Copula函数易于将多个边缘分布构造成联合分布的优点，将其与频率组合法相结合，推导出了n维组合洪水分布函数表达式，并建立了相应的洪水遭遇风险估计模型。以雅砻江、鲜水河和庆大河洪水遭遇为例，采用双参数三维Copula函数对下游的洪水遭遇风险进行了估计，得到了下游组合洪水分布函数及防洪风险率。结果表明，该模型可以在一定程度上量化分析干支流洪水遭遇的随机性，为下游的防洪安全提供了一定的参考。&lt;br/&gt;When a river has multiple tributaries, the occurrence of mainstream floods and tributary floods is the main factor threatening the safety of downstream flood control points. The risk assessment of floods encountering is important for downstream flood control safety. Based on the Copula function which is easy to construct multiple edge distributions into multi-dimensional joint distribution, combining with the frequency composition method, the expression of n-dimensional combined flood distribution function is derived and the corresponding flood encounter risk estimation model is established. Taking the floods encountering of the Yalong River, the Xianshui River, and the Qingda River as an example, and using the two-parameter three-dimensional Copula function to estimate the downstream flood risk, the downstream combined flood distribution function and flood control risk rate were calculated. The results show that the model can quantitatively analyze the randomness of floods encountering and provide a certain reference for downstream flood control. 
  
 
</p></abstract><kwd-group><kwd>Copula函数，频率组合法，组合洪水，防洪风险率, Copula Function</kwd><kwd> Frequency Composition Method</kwd><kwd> Combined Flood</kwd><kwd> Flood Risk Rate of Flood Control</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于三维Copula函数的组合洪水研究<sup> </sup></title><p>梁希金，王丽萍，张验科<sup>*</sup>，张佳新，叶凯华</p><p>华北电力大学可再生能源学院，北京</p><disp-formula id="hanspub.33670-formula30"><graphic xlink:href="//html.hanspub.org/file/4-2410839x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2019年12月7日；录用日期：2019年12月20日；发布日期：2019年12月27日</p><disp-formula id="hanspub.33670-formula31"><graphic xlink:href="//html.hanspub.org/file/4-2410839x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>当某一条河流有多条支流汇入时，干流洪水与支流洪水的遭遇是威胁下游防洪控制点安全的主要因素，干支流洪水遭遇风险估计对于下游防洪安全具有重要意义。基于Copula函数易于将多个边缘分布构造成联合分布的优点，将其与频率组合法相结合，推导出了n维组合洪水分布函数表达式，并建立了相应的洪水遭遇风险估计模型。以雅砻江、鲜水河和庆大河洪水遭遇为例，采用双参数三维Copula函数对下游的洪水遭遇风险进行了估计，得到了下游组合洪水分布函数及防洪风险率。结果表明，该模型可以在一定程度上量化分析干支流洪水遭遇的随机性，为下游的防洪安全提供了一定的参考。</p><p>关键词 :Copula函数，频率组合法，组合洪水，防洪风险率</p><disp-formula id="hanspub.33670-formula32"><graphic xlink:href="//html.hanspub.org/file/4-2410839x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Wuhan University.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/4-2410839x8_hanspub.png" /> <img src="//html.hanspub.org/file/4-2410839x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着我国各大流域联合防洪调度工作的逐渐深入，流域性洪水引发的多条河流的洪水遭遇分析工作越来越迫切。洪水遭遇风险研究对下游的防洪安全具有重要意义。传统的多变量水文分析计算方法主要包括多元正态分布 [<xref ref-type="bibr" rid="hanspub.33670-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.33670-ref2">2</xref>] 、特定边缘分布构成的联合分布 [<xref ref-type="bibr" rid="hanspub.33670-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.33670-ref4">4</xref>] 、非参数方法 [<xref ref-type="bibr" rid="hanspub.33670-ref5">5</xref>] 、将多维联合分布转换成一维分布的方法 [<xref ref-type="bibr" rid="hanspub.33670-ref6">6</xref>] 等。传统方法往往存在着一些缺陷，比如多元正态分布在数据转换时容易造成信息失真，非参数方法构造的联合分布的边缘分布类型未知等 [<xref ref-type="bibr" rid="hanspub.33670-ref7">7</xref>]。目前，国内外针对上游有支流汇入的防洪控制点的风险估算，多是针对一条支流汇入的情况，对于多条河流汇入的情况研究较少；并且多是将干流洪水的随机性作为研究对象，区间洪水设为特定值进行计算，这样显然与实际有所偏差。因此，研究新的方法，充分考虑干支流洪水的随机性，对于上游有多条支流汇入的防洪控制点的防洪安全具有重要意义。</p><p>频率组合法是研究洪水遭遇的传统方法，目前多是针对二维水文随机变量进行实例研究，对于多维水文随机变量的研究相对较少，当涉及的维数较多时，用传统的解析方法来确定联合概率密度函数的解析式以及对其积分求解是非常困难的，因此，通常采用离散叠加法进行数值求解。但是，干支流洪水变量间往往存在相关性，在采用离散叠加法进行求解时，需要对变量进行独立性处理，此过程难免会出现数据失真。</p><p>Copula函数能够通过变量的边缘分布和相关性结构两部分来构造多维联合分布，形式灵活多样，是构建联合分布的一种非常有效的方法，近些年在水文分析计算领域中得到了广泛应用。熊立华等 [<xref ref-type="bibr" rid="hanspub.33670-ref8">8</xref>] 采用Copula函数构造了两站年最大洪水联合分布函数，并且对经验概率和理论概率进行了拟合。李天元等 [<xref ref-type="bibr" rid="hanspub.33670-ref9">9</xref>] 通过双参数Copula函数构造了两江洪峰之间的联合分布函数，估计了洪峰遭遇风险的条件概率。刘章君等 [<xref ref-type="bibr" rid="hanspub.33670-ref10">10</xref>] 根据Copula函数对设计洪水地区组成进行区间估计，计算出地区组成的点估计值，并对估计的不确定性进行评价。</p><p>为此，本文结合Copula函数易于构造联合分布的特点，将Copula函数在构造联合分布函数的优势与频率组合法在计算多维联合分布函数的功能相结合，以雅砻江、鲜水河和庆大河洪水遭遇为例，进行了验证分析。相对于传统的频率组合法，此方法可以充分考虑干支流的随机性及相关性，且计算过程中不会出现信息失真；对变量边缘分布类型没有要求，适用性强；解决了频率组合法在多维问题上的求解问题，使其不再局限于求解二维问题。</p></sec><sec id="s4"><title>2. Copula函数</title><p>Copula函数由Sklar在1959年提出，是定义在[0,1]上均匀分布的联合分布函数。其中Archimedean Copula函数结构简单，适应性强，在水文多变量联合分布中的应用较为广泛。n维Archimedean Copula函数表达式如下：</p><p>C ( u , φ ) = φ { φ − 1 ( u 1 ) + φ − 1 ( u 2 ) + ⋯ + φ − 1 ( u n ) } , u ∈ [ 0 , 1 ] (1)</p><p>其中，算子 φ 决定了Copula函数的类型。双参数三维Archimedean Copula函数，表达式如下：</p><p>C ( u 1 , u 2 , u 3 ) = φ 1 ( φ 1 − 1 ( u 1 ) + φ 1 − 1 φ 2 ( φ 2 − 1 ( u 2 ) + φ 2 − 1 ( u 3 ) ) ) (2)</p><p>双参数三维Archimedean Copula函数拥有两个发生元，因此可以较好地刻画出变量之间的相依结构。三维GH Copula、Clayton Copula、Frank Copula函数表达式分别如下：</p><p>C ( u 1 , u 2 , u 3 ; θ 1 , θ 2 ) = exp { − ( [ ( − log u 3 ) θ 2 + ( − log u 2 ) θ 2 ] θ 1 / θ 2 + ( − log u 1 ) θ 1 ) 1 / θ 1 } (3)</p><p>C ( u 1 , u 2 , u 3 ; θ 1 , θ 2 ) = [ ( u 3 − θ 2 + u 2 − θ 2 − 1 ) θ 1 / θ 2 + u 1 − θ 1 − 1 ] − 1 / θ 1 (4)</p><p>C ( u 1 , u 2 , u 3 ; θ 1 , θ 2 ) = − θ 1 − 1 log { 1 − c 1 − 1 ( 1 − [ 1 − c 2 − 1 ( 1 − e − θ 2 u 3 ) ( 1 − e − θ 2 u 2 ) ] θ 1 / θ 2 ) ( 1 − e − θ 1 u 1 ) } (5)</p><p>其中， c 1 = 1 − e − θ 1 ， c 2 = 1 − e − θ 2 ，参数 θ 1 用来刻画 ( u 1 , u 2 ) 、 ( u 1 , u 3 ) 之间的相依性，参数 θ 2 用来刻画 ( u 2 , u 3 ) 之间的相依性。</p></sec><sec id="s5"><title>3. 基于Copula函数的洪水遭遇风险估计模型</title><p>当防洪控制点上游有多条区间洪水时，由于区间洪水这一不确定性因素，必须考虑区间洪水与干流洪水组合后带来的风险，其组合形式有很多种，为下游防洪控制点的防洪安全带来了极大的威胁 [<xref ref-type="bibr" rid="hanspub.33670-ref11">11</xref>] [<xref ref-type="bibr" rid="hanspub.33670-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.33670-ref13">13</xref>]。</p><p>图1. 洪水遭遇组合示意图</p><p>如图1所示，干流洪水为 X 1 ，区间洪水为 X 2 , X 3 , ⋯ , X n ，防洪控制点洪水为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/4-2410839x26_hanspub.png" xlink:type="simple"/></inline-formula>，则 W = X 1 + X 2 + ⋯ + X n 。 X 1 , X 2 , ⋯ , X n 之间可以是相关关系或相互独立。 n − 1 条区间洪水在防洪控制点上游相继汇入，为下游防洪控制点的防洪安全带来了一定的威胁，为保证下游防洪控制点的防洪安全，需要求出下游防洪控制点组合洪水的分布函数，根据频率组合法，组合洪水洪峰流量超越下游安全泄量的概率分布函数可以表示为：</p><p>P ( w ≥ w 0 ) = 1 − ∫ ⋯ ∫ D h ( x 1 , x 2 , ⋯ , x n ) d x 1 d x 2 ⋯ d x n (6)</p><p>式中，D为 x 1 + x 2 + ⋯ + x n ≤ w 0 ， h ( x 1 , x 2 , ⋯ , x n ) 是随机变量 x 1 , x 2 , ⋯ , x n 的联合概率密度函数。当 w 0 为下游防洪控制点的安全泄量时，防洪控制点发生洪水的概率 P ( w ≥ w 0 ) 即为防洪风险率。</p><p>公式(6)中的联合概率密度函数 h ( x 1 , x 2 , ⋯ , x n ) 可以用Copula函数来表示，公式如下：</p><p>H ( x 1 , x 2 , ⋯ , x n ) = C [ F ( x 1 ) , F ( x 2 ) , ⋯ , F ( x n ) ] (7)</p><p>h ( x 1 , x 2 , ⋯ , x n ) = ∂ n H ( x 1 , x 2 , ⋯ , x n ) ∂ x 1 ∂ x 2 ⋯ ∂ x n = ∂ n C ( u 1 , u 2 , ⋯ , u n ) ∂ x 1 ∂ x 2 ⋯ ∂ x n (8)</p><p>式中， H ( x 1 , x 2 , ⋯ , x n ) 为随机变量 x 1 , x 2 , ⋯ , x n 的联合分布函数， C [ F ( x 1 ) , F ( x 2 ) , ⋯ , F ( x n ) ] 为随机变量 x 1 , x 2 , ⋯ , x n 的Copula函数， u 1 = F ( x 1 ) ,   u 2 = F ( x 2 ) ,   ⋯ , u n = F ( x n ) 分别为 x 1 , x 2 , ⋯ , x n 的边缘分布函数。其中，</p><p>∂ n C ( u 1 , u 2 , ⋯ , u n ) ∂ x 1 ∂ x 2 ⋯ ∂ x n = ∂ n C ( u 1 , u 2 , ⋯ , u n ) ∂ u 1 ∂ u 2 ⋯ ∂ u n ⋅ ∂ u 1 ∂ x 1 ⋅ ∂ u 2 ∂ x 2 ⋯ ∂ u n ∂ x n = c ( u 1 , u 2 , ⋯ , u n ) ⋅ f x 1 ( x 1 ) ⋅ f x 2 ( x 2 ) ⋯ f x n ( x n ) (9)</p><p>式中， c ( u 1 , u 2 , ⋯ , u n ) 为 C ( u 1 , u 2 , ⋯ , u n ) 的密度函数， f x 1 ( x 1 ) , f x 2 ( x 2 ) , ⋯ , f x n ( x n ) 分别为 x 1 , x 2 , ⋯ , x n 的边缘密度函数。</p><p>由上述公式可知，下游防洪控制点组合洪水的分布函数可由Copula函数密度函数以及边缘分布密度函数表示，因此利用Copula函数易于将多个边缘分布构造成多维联合分布的特点，对公式(6)进行改进可以得到新的n维组合洪水的分布函数表达式，如式(10)所示：</p><p>P ( w ≥ w 0 ) = 1 − ∫ ⋯ ∫ D c ( u 1 , u 2 , ⋯ , u n ) ⋅ f x 1 ( x 1 ) ⋅ f x 2 ( x 2 ) ⋯ f x n ( x n ) d x 1 d x 2 ⋯ d x n (10)</p><p>式(10)具有以下优点：对于组合洪水问题推广至n维，适用性较强；随机变量的联合概率密度函数用Copula函数表示，可以充分考虑变量间的相关性；对于边缘分布类型没有限制，任意边缘分布都可以构造联合分布。</p><p>函数求解步骤如下：</p><p>①确定边缘分布，即洪水流量的分布函数。</p><p>②在分析边缘分布相关性的基础上，选择合适的Copula函数。</p><p>③对Copula函数密度函数以及边缘分布密度函数的乘积求n重积分。</p><p>式(10)具有以下优点：对于组合洪水问题推广至n维，适用性较强；随机变量的联合概率密度函数用边缘分布密度函数以及Copula函数密度函数表示，可以充分考虑变量间的相关性；对于边缘分布类型没有限制，任意边缘分布都可以构造联合分布。</p></sec><sec id="s6"><title>4. 实例分析</title><p>雅砻江流域位于青藏高原东部，整个流域呈南北向条带状，流域平均长度约950 km，平均宽度约137 km，河系呈羽状发育。支流鲜水河与庆大河相继汇入雅砻江，其流域图如图2所示，对下游防洪控制点的防洪安全造成了一定的威胁，本文采用雅砻江新龙站、鲜水河道孚站、庆大河扎巴站历史洪水资料，选取同一时刻三个测站的历史流量组成三元序列对作为样本，充分考虑洪水遭遇的可能性，对下游组合洪水分布函数以及防洪风险率进行计算。</p><p>图2. 雅砻江流域图</p><sec id="s6_1"><title>4.1. 边缘分布的确定</title><p>P-III分布曲线在水文变量频率分析中应用较为普遍，其对径流、暴雨的拟合结果较好。其概率密度函数如下：</p><p>f ( x ) = β γ Γ ( γ ) ( x − α ) γ − 1 exp [ − β ( x − α ) ] (11)</p><p>其中， α 、 β 、 γ 分别为P-III型分布的位置、尺度、形状参数，计算公式如下：</p><p>α = 4 C s 2 , β = 2 x &#175; C v C s , γ = x &#175; ( 1 − 2 C v C s ) (12)</p><p>根据上述公式，可以计算出雅砻江洪峰、鲜水河洪峰和庆大河洪峰的P-III分布参数，由表1可知，雅砻江、鲜水河和庆大河洪水流量均服从P-III分布，以P-III分布作为雅砻江、鲜水河和庆大河洪水流量的边缘分布是合理可行的。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> P-III distribution parameters of Yalong River, Xianshui River and Qingdahe Flood Pea</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >雅砻江洪水流量</th><th align="center" valign="middle" >鲜水河洪水流量</th><th align="center" valign="middle" >庆大河洪水流量</th></tr></thead><tr><td align="center" valign="middle" >均值 x &#175;</td><td align="center" valign="middle" >1161.53</td><td align="center" valign="middle" >519.6</td><td align="center" valign="middle" >81.73</td></tr><tr><td align="center" valign="middle" >变差系数C<sub>v</sub></td><td align="center" valign="middle" >0.34</td><td align="center" valign="middle" >0.38</td><td align="center" valign="middle" >0.41</td></tr><tr><td align="center" valign="middle" >偏态系数C<sub>s</sub></td><td align="center" valign="middle" >1.94</td><td align="center" valign="middle" >1.47</td><td align="center" valign="middle" >1.87</td></tr><tr><td align="center" valign="middle" >α</td><td align="center" valign="middle" >1.062812</td><td align="center" valign="middle" >1.85108</td><td align="center" valign="middle" >1.14387</td></tr><tr><td align="center" valign="middle" >β</td><td align="center" valign="middle" >0.00261</td><td align="center" valign="middle" >0.00689</td><td align="center" valign="middle" >0.031917</td></tr><tr><td align="center" valign="middle" >γ</td><td align="center" valign="middle" >754.39</td><td align="center" valign="middle" >250.96</td><td align="center" valign="middle" >45.89</td></tr><tr><td align="center" valign="middle" >拟合度</td><td align="center" valign="middle" >0.99</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >0.98</td></tr></tbody></table></table-wrap><p>表1. 雅砻江、鲜水河和庆大河洪峰的P-III分布参数</p></sec><sec id="s6_2"><title>4.2. Copula函数类型的选择</title><p>首先，对雅砻江洪峰、鲜水河洪峰、庆大河洪峰进行相关性分析，判断其相关性，可以初步确定适合本文研究所应用的Copula函数类型。本文应用SPSS软件中的相关性分析对雅砻江洪峰、鲜水河洪峰和庆大河洪峰进行相关性分析。经计算，雅砻江洪峰、鲜水河洪峰之间的相关系数为0.938，雅砻江洪峰、庆大河洪峰之间的相关系数为0.946，鲜水河洪峰、庆大河洪峰之间的相关系数为0.937，t检验的显著性概率均为0 &lt; 0.01。由此可以判断，三者之间存在着较强的正相关性。由于GH Copula和Clayton Copula适用于变量之间存在正相关关系，Frank Copula函数适用于变量之间存在正或负相关关系。因此，本文选用GH Copula、Clayton Copula和Frank Copula函数进行组合洪水的研究。</p></sec><sec id="s6_3"><title>4.3. Copula函数参数估计</title><p>参数估计是Copula函数的核心，本文采用极大似然法对Copula函数进行参数估计。双参数三维Copula函数的极大似然估计方法如下：</p><p>1) 构建似然函数</p><p>L ( θ 1 , θ 2 ) = ∏ i = 1 n c ( ( u i 1 , u i 2 , u i 3 ) ; θ 1 , θ 2 ) (13)</p><p>c ( ( u 1 , u 2 , u 3 ) ; θ 1 , θ 2 ) = ∂ 3 C ( ( u 1 , u 2 , u 3 ) ; θ 1 , θ 2 ) ∂ u 1 ∂ u 2 ∂ u 3 (14)</p><p>ln ( L ( θ 1 , θ 2 ) ) = ∑ i = 1 n ln ( c ( ( u 1 , u 2 , u 3 ) ; θ 1 , θ 2 ) ) (15)</p><p>2) 似然函数最大值求解</p><p>∂ 2 ln ( L ( θ 1 , θ 2 ) ) ∂ θ 1 ∂ θ 2 = 0 (16)</p></sec><sec id="s6_4"><title>4.4. Copula函数拟合优度评价</title><p>拟合优度评价主要包括Genest-Rivest方法(图形评价法)、AIC信息准则法和OLS法(离差平方和最小准则)。</p><p>Genest-Rivest方法是将经验频率和理论频率进行绘图，根据点距的分布情况，来判断Copula函数对序列的拟合情况。</p><p>经验频率公式如下：</p><p>F e m p ( x i 1 , x i 2 , x i 3 ) = p ( X 1 ≤ x i 1 , X 2 ≤ x i 2 , X 3 ≤ x i 3 ) = ( ∑ g = 1 n ∑ k = 1 n ∑ l = 1 n n g k l − 0.44 ) / ( n + 0.12 ) (17)</p><p>式中， F e m p 为经验频率， n g k l 为同时满足 X 1 ≤ x i 1 , X 2 ≤ x i 2 , X 3 ≤ x i 3 的观测值个数，n为系列长度。</p><p>AIC信息准则是衡量模型拟合优劣的一种标准，AIC值越小，说明相应的Copula函数拟合越优，其表现形式如下：</p><p>MSE = 1 n ∑ i = 1 n ( F e m p ( x i 1 , x i 2 , x i 3 ) − C ( u i 1 , u i 2 , u i 3 ) ) 2 (18)</p><p>AIC = n ln ( MSE ) + 2 k (19)</p><p>式中， C ( u i 1 , u i 2 , u i 3 ) 为理论频率值，k为模型参数的个数。</p><p>离差平方和最小准则的判断标准和AIC准则一样，OLS值越小，拟合越优。</p><p>OLS = 1 n ∑ i = 1 n ( F e m p ( x i 1 , x i 2 , x i 3 ) − C ( u i 1 , u i 2 , u i 3 ) ) 2 (20)</p><p>由图形评价法即可得到不同Copula函数对洪峰序列的拟合效果，如图3所示。</p><p>图3. 理论与经验联合频率拟合</p><p>从图中可以看出，双参数GH Copula、Clayton Copula、Frank Copula函数所计算出的理论频率与经验频率均落在45˚线附近，且相差不大，说明三种函数对径流序列的拟合效果均较好，通过图形评价法不能直观的判断哪种函数对径流序列拟合最优，所以还需AIC信息准则和OLS法进行拟合优度评价。</p><p>计算得出不同Copula函数的AIC值和OLS值，根据AIC信息准则和OLS对拟合优度进行评价，AIC值、OLS值以及Copula函数参数θ<sub>1</sub>、θ<sub>2</sub>见表2。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> AIC, OLS values and parameters of different Copula function</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >AIC</th><th align="center" valign="middle" >OLS</th><th align="center" valign="middle" >θ<sub>1</sub></th><th align="center" valign="middle" >θ<sub>2</sub></th></tr></thead><tr><td align="center" valign="middle" >GH</td><td align="center" valign="middle" >−171.191</td><td align="center" valign="middle" >0.054</td><td align="center" valign="middle" >4.52</td><td align="center" valign="middle" >4.69</td></tr><tr><td align="center" valign="middle" >Clayton</td><td align="center" valign="middle" >−160.812</td><td align="center" valign="middle" >0.064</td><td align="center" valign="middle" >4.54</td><td align="center" valign="middle" >4.55</td></tr><tr><td align="center" valign="middle" >Frank</td><td align="center" valign="middle" >−166.423</td><td align="center" valign="middle" >0.058</td><td align="center" valign="middle" >15.99</td><td align="center" valign="middle" >16.05</td></tr></tbody></table></table-wrap><p>表2. 不同Copula函数的AIC、OLS值及参数</p><p>由表2可知，GH Copula函数所计算的AIC和OLS值最小，Frank Copula函数和Clayton Copula函数所计算的AIC和OLS值均大于GH Copula函数所计算的AIC和OLS值。因此GH Copula函数对洪峰序列的拟合效果最优。所以根据AIC、OLS最小准则，选取双参数三维GH Copula函数进行组合洪水的计算。</p></sec><sec id="s6_5"><title>4.5. 组合洪水的计算</title><p>根据GH Copula函数，可以得到洪峰联合分布(图4)，其中，x轴、y轴、z轴分别表示雅砻江洪峰、鲜水河洪峰、庆大河洪峰，组合洪水频率用颜色表示。由图4可以看出任意洪峰组合发生的频率及其变化趋势。根据公式(6)~(10)可以得到下游组合洪水洪峰w大于下游防洪安全泄量w<sub>0</sub>的概率，设置不同的w<sub>0</sub>，即可得到组合洪水分布(表3)及其分布曲线(图5)。</p><p>图4. 洪峰联合分布</p><table-wrap-group id="3"><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Combined flood distributio</title></caption><table-wrap id="3_1"><table><tbody><thead><tr><th align="center" valign="middle" >w<sub>0</sub>/(m<sup>3</sup>∙s<sup>−1</sup>)</th><th align="center" valign="middle" >P(w &gt; w<sub>0</sub>)/%</th><th align="center" valign="middle" >w<sub>0</sub>/(m<sup>3</sup>∙s<sup>−1</sup>)</th><th align="center" valign="middle" >P(w &gt; w<sub>0</sub>)/%</th><th align="center" valign="middle" >w<sub>0</sub>/(m<sup>3</sup>∙s<sup>−1</sup>)</th><th align="center" valign="middle" >P(w &gt; w<sub>0</sub>)/%</th><th align="center" valign="middle" >w<sub>0</sub>/(m<sup>3</sup>∙s<sup>−1</sup>)</th><th align="center" valign="middle" >P(w &gt; w<sub>0</sub>)/%</th></tr></thead><tr><td align="center" valign="middle" >3300</td><td align="center" valign="middle" >14.43</td><td align="center" valign="middle" >3870</td><td align="center" valign="middle" >6.06</td><td align="center" valign="middle" >4440</td><td align="center" valign="middle" >2.50</td><td align="center" valign="middle" >5010</td><td align="center" valign="middle" >1.03</td></tr></tbody></table></table-wrap><table-wrap id="3_2"><table><tbody><thead><tr><th align="center" valign="middle" >3330</th><th align="center" valign="middle" >13.79</th><th align="center" valign="middle" >3900</th><th align="center" valign="middle" >5.79</th><th align="center" valign="middle" >4470</th><th align="center" valign="middle" >2.39</th><th align="center" valign="middle" >5040</th><th align="center" valign="middle" >0.98</th></tr></thead><tr><td align="center" valign="middle" >3360</td><td align="center" valign="middle" >13.18</td><td align="center" valign="middle" >3930</td><td align="center" valign="middle" >5.53</td><td align="center" valign="middle" >4500</td><td align="center" valign="middle" >2.28</td><td align="center" valign="middle" >5070</td><td align="center" valign="middle" >0.97</td></tr><tr><td align="center" valign="middle" >3390</td><td align="center" valign="middle" >12.60</td><td align="center" valign="middle" >3960</td><td align="center" valign="middle" >5.28</td><td align="center" valign="middle" >4530</td><td align="center" valign="middle" >2.18</td><td align="center" valign="middle" >5100</td><td align="center" valign="middle" >0.94</td></tr><tr><td align="center" valign="middle" >3420</td><td align="center" valign="middle" >12.04</td><td align="center" valign="middle" >3990</td><td align="center" valign="middle" >5.04</td><td align="center" valign="middle" >4560</td><td align="center" valign="middle" >2.08</td><td align="center" valign="middle" >5130</td><td align="center" valign="middle" >0.90</td></tr><tr><td align="center" valign="middle" >3450</td><td align="center" valign="middle" >11.51</td><td align="center" valign="middle" >4020</td><td align="center" valign="middle" >4.81</td><td align="center" valign="middle" >4590</td><td align="center" valign="middle" >1.98</td><td align="center" valign="middle" >5160</td><td align="center" valign="middle" >0.88</td></tr><tr><td align="center" valign="middle" >3480</td><td align="center" valign="middle" >11.00</td><td align="center" valign="middle" >4050</td><td align="center" valign="middle" >4.59</td><td align="center" valign="middle" >4620</td><td align="center" valign="middle" >1.89</td><td align="center" valign="middle" >5190</td><td align="center" valign="middle" >0.85</td></tr><tr><td align="center" valign="middle" >3510</td><td align="center" valign="middle" >10.51</td><td align="center" valign="middle" >4080</td><td align="center" valign="middle" >4.38</td><td align="center" valign="middle" >4650</td><td align="center" valign="middle" >1.80</td><td align="center" valign="middle" >5220</td><td align="center" valign="middle" >0.82</td></tr><tr><td align="center" valign="middle" >3540</td><td align="center" valign="middle" >10.04</td><td align="center" valign="middle" >4110</td><td align="center" valign="middle" >4.18</td><td align="center" valign="middle" >4680</td><td align="center" valign="middle" >1.72</td><td align="center" valign="middle" >5250</td><td align="center" valign="middle" >0.80</td></tr><tr><td align="center" valign="middle" >3570</td><td align="center" valign="middle" >9.59</td><td align="center" valign="middle" >4140</td><td align="center" valign="middle" >3.99</td><td align="center" valign="middle" >4710</td><td align="center" valign="middle" >1.64</td><td align="center" valign="middle" >5280</td><td align="center" valign="middle" >0.77</td></tr><tr><td align="center" valign="middle" >3600</td><td align="center" valign="middle" >9.16</td><td align="center" valign="middle" >4170</td><td align="center" valign="middle" >3.81</td><td align="center" valign="middle" >4740</td><td align="center" valign="middle" >1.57</td><td align="center" valign="middle" >5310</td><td align="center" valign="middle" >0.75</td></tr><tr><td align="center" valign="middle" >3630</td><td align="center" valign="middle" >8.75</td><td align="center" valign="middle" >4200</td><td align="center" valign="middle" >3.64</td><td align="center" valign="middle" >4770</td><td align="center" valign="middle" >1.50</td><td align="center" valign="middle" >5340</td><td align="center" valign="middle" >0.73</td></tr><tr><td align="center" valign="middle" >3660</td><td align="center" valign="middle" >8.36</td><td align="center" valign="middle" >4230</td><td align="center" valign="middle" >3.47</td><td align="center" valign="middle" >4800</td><td align="center" valign="middle" >1.43</td><td align="center" valign="middle" >5370</td><td align="center" valign="middle" >0.71</td></tr><tr><td align="center" valign="middle" >3690</td><td align="center" valign="middle" >7.99</td><td align="center" valign="middle" >4260</td><td align="center" valign="middle" >3.31</td><td align="center" valign="middle" >4830</td><td align="center" valign="middle" >1.36</td><td align="center" valign="middle" >5400</td><td align="center" valign="middle" >0.69</td></tr><tr><td align="center" valign="middle" >3720</td><td align="center" valign="middle" >7.63</td><td align="center" valign="middle" >4290</td><td align="center" valign="middle" >3.16</td><td align="center" valign="middle" >4860</td><td align="center" valign="middle" >1.30</td><td align="center" valign="middle" >5430</td><td align="center" valign="middle" >0.67</td></tr><tr><td align="center" valign="middle" >3750</td><td align="center" valign="middle" >7.29</td><td align="center" valign="middle" >4320</td><td align="center" valign="middle" >3.02</td><td align="center" valign="middle" >4890</td><td align="center" valign="middle" >1.24</td><td align="center" valign="middle" >5460</td><td align="center" valign="middle" >0.65</td></tr><tr><td align="center" valign="middle" >3780</td><td align="center" valign="middle" >6.96</td><td align="center" valign="middle" >4350</td><td align="center" valign="middle" >2.88</td><td align="center" valign="middle" >4920</td><td align="center" valign="middle" >1.18</td><td align="center" valign="middle" >5490</td><td align="center" valign="middle" >0.64</td></tr><tr><td align="center" valign="middle" >3810</td><td align="center" valign="middle" >6.65</td><td align="center" valign="middle" >4380</td><td align="center" valign="middle" >2.75</td><td align="center" valign="middle" >4950</td><td align="center" valign="middle" >1.13</td><td align="center" valign="middle" >5520</td><td align="center" valign="middle" >0.62</td></tr><tr><td align="center" valign="middle" >3840</td><td align="center" valign="middle" >6.35</td><td align="center" valign="middle" >4410</td><td align="center" valign="middle" >2.62</td><td align="center" valign="middle" >4980</td><td align="center" valign="middle" >1.08</td><td align="center" valign="middle" >5550</td><td align="center" valign="middle" >0.60</td></tr></tbody></table></table-wrap></table-wrap-group><p>表3. 组合洪水分布</p><p>图5. 组合洪水分布曲线</p><p>由组合洪水分布曲线可以看出，随着w<sub>0</sub>的增加，组合洪水洪峰大于w<sub>0</sub>的概率不断减小，在w<sub>0</sub>小于3000 m<sup>3</sup>/s之内，组合洪水洪峰大于w<sub>0</sub>的概率的减小与w<sub>0</sub>的增加基本上呈线性关系，当w<sub>0</sub>大于3000 m<sup>3</sup>/s后，组合洪水洪峰大于w<sub>0</sub>的概率随着w<sub>0</sub>的增加而减小的越来越缓慢，最终趋向于0。下游防洪控制点的安全泄量为4800 m<sup>3</sup>/s时，由表3可知，防洪风险率为1.43%。结果表明该地区的防洪安全不易受区间洪水的影响。</p></sec></sec><sec id="s7"><title>5. 结论</title><p>本文基于Copula函数和频率组合法，推导出n维组合洪水分布函数表达式，并构造出洪水遭遇风险估计模型。以雅砻江洪峰、鲜水河洪峰和庆大河洪峰为例，在分析其相关性基础上，采用双参数三维GH Copula、Clayton Copula、Frank Copula函数对其洪峰联合分布进行计算，通过对比分析，GH Copula函数对变量的拟合效果最优。建立了基于双参数三维GH Copula函数的三河流洪峰联合分布，然后计算得到组合洪水分布曲线，通过组合洪水分布曲线可以得到下游防洪控制点的防洪风险率以及各组合洪水发生的概率。通过实例分析证明本文所构造的模型具有可行性，且推导出的n维组合洪水分布函数对于易发生洪水遭遇地区的防洪安全提供了一定的参考。</p></sec><sec id="s8"><title>基金项目</title><p>国家自然科学基金(51709105)；中央高校基本科研业务费专项资金资助(2019MS031)。</p></sec><sec id="s9"><title>文章引用</title><p>梁希金,王丽萍,张验科,张佳新,叶凯华. 基于三维Copula函数的组合洪水研究Combined Flood Research Based on Three-Dimensional Copula Function[J]. 水资源研究, 2020, 09(01): 33-41. https://doi.org/10.12677/JWRR.2020.91004</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.33670-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">KRSTANOVIC, P. F., SINGH, V. P. A multivariate stochastic flood analysis using entropy. In SINGH, V. P. (Ed.). Hydrologic frequency modeling. Dordrecht: Reidel, 1987: 515-539. &lt;br&gt;https://doi.org/10.1007/978-94-009-3953-0_37</mixed-citation></ref><ref id="hanspub.33670-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">CORREIA, F. N. Multivariate partial duration series in flood risk analysis. In SINGH, V. P. (Ed.). Hydrologic frequency modelling. Dordrecht: Reidel, 1987: 541-554. &lt;br&gt;https://doi.org/10.1007/978-94-009-3953-0_38</mixed-citation></ref><ref id="hanspub.33670-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">YUE, S. The bivariate lognormal distribution for describing joint statistical properties of a multivariate storm event. Environmetrics, 2002, 13: 811-819. &lt;br&gt;https://doi.org/10.1002/env.483</mixed-citation></ref><ref id="hanspub.33670-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">YUE, S. The gumbel logistic model for representing a multivariate storm event. Advances in Water Resource, 2001, 24: 179-185. &lt;br&gt;https://doi.org/10.1016/S0309-1708(00)00039-7</mixed-citation></ref><ref id="hanspub.33670-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">郭生练, 刘章君, 熊立华, 等. 设计洪水计算方法研究进展与评价[M]. 北京: 中国水利水电出版社, 2005. 
GUO Shenglian, LIU Zhangjun, XIONG Lihua, et al. Research progress and evaluation of design flood calculation methods. Beijing: China Water Conservancy and Hydropower Press, 2005. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">费永法. 一种计算洪水条件概率的方法[J]. 水文, 1989(1): 18-22. 
FEI Yongfa. A method for calculating the probability of flood conditions. Hydrology, 1989(1): 18-22. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">郭生练, 闫宝伟, 肖义, 等. Copula函数在多变量水文分析计算中的应用及研究进展[J]. 水文, 2008, 28(3): 1-2. 
GUO Shenglian, YAN Baowei, XIAO Yi, et al. Application and research progress of Copula function in multivariate hydrological analysis and calculation. Hydrology, 2008, 28(3): 1-2. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">熊立华, 郭生练. Copula联接函数在多变量水文频率分析中的应用[J]. 武汉大学学报, 2005, 38(6): 16-17. 
XIONG Lihua, GUO Shenglian. Application of Copulas to multivariate hydrological frequency analysis. Journal of Wuhan University, 2005, 38(6): 16-17. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">李天元, 郭生练, 罗启华, 等. 双参数Copula函数在洪水联合分布中的应用研究[J]. 水文, 2011, 31(5): 24-28. 
LI Tianyuan, GUO Shenglian, LUO Qihua, et al. Application research of two-parameter Copula function in joint distribution of flood. Hydrology, 2011, 31(5): 24-28. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">刘章君, 郭生练, 李天元, 等. 设计洪水地区组成的区间估计方法研究[J]. 水利学报, 2015, 46(5): 543-544. 
LIU Zhangjun, GUO Shenglian, LI Tianyuan, et al. Research on interval estimation method for designing flood area. Journal of Hydraulic Engineering, 2015, 46(5): 543-544. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">陈路, 郭生练, 张洪刚, 等. 长江上游干支流洪水遭遇分析[J]. 水科学进展, 2011, 22(3): 323-330. 
CHEN Lu, GUO Shenglian, ZHANG Honggang, et al. Analysis on flood encounters of main tributaries in the upper reaches of the Yangtze. Progress in Water Science, 22(3): 323-330. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">傅湘, 王丽萍, 纪昌明. 洪水遭遇组合下防洪区的洪灾风险率估算[J]. 水电能源科学, 1999, 17(4): 23-26. 
FU Xiang, WANG Liping and JI Changmin. Estimation of flood risk rate in flood control areas under flood encounters. Hydropower Energy Science, 1999, 17(4): 23-26. (in Chinese)</mixed-citation></ref><ref id="hanspub.33670-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">蔡振华, 王祥三, 李娜. 沮漳河下游洪水遭遇地区组成规律分析及计算[J]. 中国农村水利水电, 2005(4): 23-26. 
CAI Zhenhua, WANG Xiangsan and LI Na. Analysis and calculation of composition rules of flood vulnerable area at the lower reach of Zu River and Zang River. China Rural Water and Hydropower, 2005(4): 23-26. (in Chinese)</mixed-citation></ref></ref-list></back></article>