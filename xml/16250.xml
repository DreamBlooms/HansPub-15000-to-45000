<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2015.59043</article-id><article-id pub-id-type="publisher-id">CSA-16250</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20150900000_74915082.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于XML的变压器故障诊断系统数据接口设计与实现
  Design and Implementation of Data Interface for Transformer Fault Diagnosis System Based on XML
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>熊</surname><given-names>海军</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>林</surname><given-names>心昊</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>华北电力大学控制与计算机工程学院，河北 保定</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>xionghaijun@163.com(熊海)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>21</day><month>10</month><year>2015</year></pub-date><volume>05</volume><issue>09</issue><fpage>343</fpage><lpage>349</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  将不同厂家、不同格式的离线检测装置数据接入诊断系统，可综合多种参数进行变压器故障诊断，从而提高诊断的准确性。本文设计了一种基于XML的变压器故障综合诊断系统数据转换接口，该接口为油色谱、局部放电和振动数据分别设定了XML数据格式，并给出了私有格式数据文件向统一XML文件的转化方法，采用JDOM实现了统一数据接口。选取典型厂家的数据文件采用该接口进行数据格式转化，验证了方法的可行性。该方法可推进离线检测装置数据的共享应用，为变压器综合诊断提供必要的数据条件。
   Data access diagnosis system of different manufacturers, different formats can be integrated with various parameters for transformer fault diagnosis, which helps to improve the accuracy of diag-nosis. A data conversion interface based on XML for comprehensive transformer fault diagnosis system is presented. After designing different XML formats for each type of data such as chroma-tography, partial discharge, and vibration data, a method to transform the format of private data into a unified XML format is provided, and a unified data interface is presented by using JDOM. The data file of the typical factory is selected and the data format is transformed to verify the feasibility of our method. This method can advance the shared application of isolated data, and provide the necessary data for the comprehensive diagnosis of transformer.
 
</p></abstract><kwd-group><kwd>XML，数据接口，变压器，综合诊断, XML</kwd><kwd> Data Interface</kwd><kwd> Transformer</kwd><kwd> Comprehensive Diagnosis</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于XML的变压器故障诊断系统数据接口设计与实现<sup> </sup></title><p>熊海军，林心昊</p><p>华北电力大学控制与计算机工程学院，河北 保定</p><p>Email: xionghaijun@163.com</p><p>收稿日期：2015年10月8日；录用日期：2015年10月22日；发布日期：2015年10月29日</p><disp-formula id="hanspub.16250-formula437"><graphic xlink:href="http://html.hanspub.org/file/5-1540495x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>将不同厂家、不同格式的离线检测装置数据接入诊断系统，可综合多种参数进行变压器故障诊断，从而提高诊断的准确性。本文设计了一种基于XML的变压器故障综合诊断系统数据转换接口，该接口为油色谱、局部放电和振动数据分别设定了XML数据格式，并给出了私有格式数据文件向统一XML文件的转化方法，采用JDOM实现了统一数据接口。选取典型厂家的数据文件采用该接口进行数据格式转化，验证了方法的可行性。该方法可推进离线检测装置数据的共享应用，为变压器综合诊断提供必要的数据条件。</p><p>关键词 :XML，数据接口，变压器，综合诊断</p><disp-formula id="hanspub.16250-formula438"><graphic xlink:href="http://html.hanspub.org/file/5-1540495x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>近年来，国内外变压器状态监测与诊断技术的研究主要侧重于以单一参数为参照，研制了不同类型的监测装置，包括色谱、振动、超声与局部放电监测装置等[<xref ref-type="bibr" rid="hanspub.16250-ref1">1</xref>] -[<xref ref-type="bibr" rid="hanspub.16250-ref3">3</xref>] 。状态监测装置种类多、孤立运行、通信规约不统一、功能和接口各不相同，造成难以互操作、数据无法共享，无法对各设备的运行状况进行统筹分析诊断。变电站的IEC 61850建模与模型共享一直是近年来的一个热点研究问题。然而，在变压器状态监测领域，有很多监测装置不符合IEC 61850规范，仅少数色谱监测系统能满足该规范，局放、振动等监测装置有很多未遵循该规范，且存在大量的离线检测装置[<xref ref-type="bibr" rid="hanspub.16250-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.16250-ref5">5</xref>] 。现阶段，设计统一的数据格式，实现私有数据格式向统一格式的转化，在不对现有离线检测装置做任何修改的情况下，通过统一数据接口实现数据收集与综合诊断是具有重要意义的。</p><p>XML是Extensible Market Language (即可扩展的标记语言)的缩写，是一种常用的标记语言，因为其具有自描述能力且跨平台能力强，XML在数据交换、数据存储等方面已得到广泛应用[<xref ref-type="bibr" rid="hanspub.16250-ref6">6</xref>] -[<xref ref-type="bibr" rid="hanspub.16250-ref8">8</xref>] 。本文拟首先采用XML为各类监测数据分别设计统一的数据格式，其次给出格式转化方法，再次采用JDOM实现数据格式转换程序，最后选取典型实例对所提方法进行实验验证。</p></sec><sec id="s4"><title>2. XML简介</title><sec id="s4_1"><title>2.1. XML的特点</title><p>XML是Extensible Market Language (即可扩展的标记语言)的缩写，是一种常用的数据交互应用标记语言，它具有以下特点：</p><p>1) XML具有很好的兼容性。XML是在内容的基础上对数据进行格式化标注，所以可以被不同的程序用在各种不同的场合。</p><p>2) XML具有自描述性有利于搜索。随着数据量的不断增加，搜索操作越来越复杂，用户对搜索结果的准确性要求也是逐步提高。采用XML文档描述信息，会增加搜索的精确性，XML具有良好的链接能力，可以定义两个或者多个文档的扩展链接，可以提供搜索的效率。</p><p>3) XML具有良好的层次性和语义。因为XML不仅纯文本，方便修改编辑，而且可以格式化，有着对层次结构严格的定义以标识每个非常独有关键的信息片段，能用于统一数据格式，并进行信息交换。</p></sec><sec id="s4_2"><title>2.2. XML文档解析</title><p>XML文档解析模型较多，典型的有DOM，SAX和JDOM三种，下面对每种解析方法的特点进行分析。</p><p>1) DOM模型解析。DOM的全称是Document Object Model (文档对象模型)，它是以W3C制定了一套书写XML分析器的标准接口规范。DOM解析程序不和文档直接打交道，需要通过XML分析器来作为中介接触数据，分析器会读取文档，然后程序再通过DOM接口从解析器中将我们所需要的元素内容或者属性其中提取出来。</p><p>2) SAX解析模型。它虽然和DOM一样可以解析XML，但是两者的解析逻辑差异较大。SAX遇到括号后就会触发一个事件，这个事件叫做回调方法，遇到注释后，又会触发与注释有关的方法，遇到元素的开始、内容和结束也同样都会触发相应的回调方法。和DOM不同的是，SAX是按照顺序来的，与DOM的随机不一样，一旦错过了解析某个元素，想要回过头来再去访问它是不可能的。因此，SAX解析的优势是占用的内存小，不必事先将整个文档全部读入内存中，只需一行一行去解析，解析过的内容又会被后面的内容所替换，释放出内存，解析效率更高。</p><p>3) JDOM解析模型。JDOM是SUN公司的研发结晶，JDOM是一种特殊的Java工具包，用来补充SAX和DOM在文档操作当中的缺陷。JDOM基于树型结构，语言独立，JDOM还有严格的层次结构。Dom4J是一个Java的XML解析器，使用和功能与JDOM十分相似，也具有性能优异、功能强大和非常容易使用的特点，同时它也是一个开放源代码的软件。支持大文档的解析和XML文件流的读写，同时基于Java的接口可以灵活地实现插拔，而且DOM4J和Schema的第三方验证器完全匹配。</p><p>本文选取JDOM解析模型用于XML文件的生成。</p></sec></sec><sec id="s5"><title>3. 监测装置数据及特征分析</title><p>近年来，越来越多的监测装置被用于变压器状态监测系统中，包括色谱、局部放电和振动监测装置，随着各类装置的运行也产生了大量不同类型的数据，各类数据由于其特性不同、存储方法也存在较大差异。</p><p>DGA (全称是Dissolved Gas Analysis)，工程上被称作色谱分析检测法，是变压器故障内部诊断的有效手段。当在设备比如电压器内部发生放电故障、热故障或者放电兼过热故障时，会产生多种气体。这些气体会溶解于油中，根据相关规范规定了的不同故障类型产生的气体成分，可以诊断出是哪种故障。分析变压器油中溶解气体的组成及其含量并对其进行故障性质诊断是目前广泛应用的变压器故障检测手段，同时也是了解变压器内部隐患提供的有效证据。由于DGA法诊断的专业性、经验性和有效性，国内外许多学者将各种先进智能技术应用于气相色谱分析结果，受到运行部分的广泛认可，也使得诊断更加迅速、全面、准确。由于DGA用于变压器故障诊断起步较早，数据也相对较多，DGA数据的变化频率低，数据格式多采用数据库、excel等结构化方式存储。</p><p>无论是国内还是国外的研究数据都表示，在变压器中产生的内部局部放电会产生一连串理化现象，所以依照局部放电实验所表现的现象特征，专家们研究出了许多局部放电的检测方法，这些方法中就包括常规脉冲电流法。局部放电法特点包括测量过程中灵敏度高、放电量能够被标记等等。目前越来越多的变压器状态监测系统中引入了局放监测与诊断，产生了大量的局放数据。目前，由于局放数据的采样频率高(一般频率为50 K~50 M)，数据量大，数据格式多采用私有数据文件格式进行存储。</p><p>鉴于变压器器身振动信号能有效反映变压器内部绕组与铁芯的状况，应用局域波方法，通过识别信号中的振动模式，可更好地理解发生故障时振动信号包含的特征，进而可判断变压器是否出现故障。绕组的振动信号范围大多数时候集中在基频50 HZ处，铁心振动信号的范围主要集中在50 HZ~550 HZ，而超过1 KHZ以后信号很小，而且振动信号的强弱与负载电流平方成正比关系。振动监测多数情况下需要同时进行多个测点同时进行数据采集，产生的数据量也较大，目前多采用私有数据文件格式存储。</p></sec><sec id="s6"><title>4. 统一XML数据格式设计</title><p>由于不同类型的监测数据差别较大，无法采用统一的XML格式兼容各类装置的检测数据，本文分别为色谱、局放和振动分别设计了不同的XML文件格式。</p><sec id="s6_1"><title>4.1. 色谱数据格式</title><p>色谱数据中除了各类气体参数外，还有一些数据相关描述如检验员与检验时间等。色谱诊断数据的XML文档中包含数据标记及各类气体元素值，其统一格式如下所示。</p><p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;root&gt; &lt;!--色谱诊断--&gt; &lt;DGA&gt; &lt;数据&gt; &lt;ID&gt;46521&lt;/iD&gt; &lt;ChromeID&gt;22&lt;/chromeID&gt; &lt;DeviceID&gt;29&lt;/deviceID&gt; &lt;SampleDateID&gt;22&lt;/sampleDateID&gt; &lt;TestDateID&gt;22&lt;/testDateID&gt; &lt;Vol&gt;1&lt;/vol&gt; &lt;GasFrom&gt;绝缘油&lt;/gasFrom&gt; ......各类气体参数 &lt;SampleMan&gt;周晓平&lt;/sampleMan&gt; &lt;TestMan&gt;姚化亭&lt;/testMan&gt; &lt;/数据&gt;</p></sec><sec id="s6_2"><title>4.2. 局部放电数据格式</title><p>局放诊断数据的XML文档中，主要包含采样数据和实验参数。实验参数标签下是周波、采样频率、采集频带和所加电压等实验相关参数。各个厂家在处理实验参数时存在很大的差异，有的装置数据文件将其放在单独的描述文件中，有的放在数据文件头部，有的放在数据文件尾部。除了存放位置不同外，其数据文件的格式也有很大的差异。综合考虑各类情况后设计的统一XML格式如下所示。</p><p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;root&gt; &lt;!--局放离线诊断--&gt; &lt;局放数据&gt; &lt;实验参数&gt; &lt;电压&gt; &lt;/电压&gt; &lt;采样频率&gt; &lt;/采样频率&gt; &lt;记录时长&gt; &lt;/记录时长&gt; &lt;通道数&gt; &lt;/通道数&gt; &lt;校正系数&gt; &lt;/校正系数&gt; &lt;/实验参数&gt; &lt;波形数据&gt; &lt;通道一&gt; &lt;采样值1&gt;-1&lt;/采样值1&gt; &lt;采样值2&gt;-1&lt;/采样值2&gt; ...... &lt;采样值n&gt;1&lt;/采样值n&gt; &lt;/通道一&gt; ...... &lt;/波形数据&gt; &lt;/局放数据&gt;</p></sec><sec id="s6_3"><title>4.3. 振动数据格式</title><p>振动数据的XML文档中，主要包含实验参数和多个通道的采样数据，其具体格式如下所示。</p><p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;GBK&quot;?&gt; &lt;root&gt; &lt;!--变压器振动诊断--&gt; &lt;短路试验&gt; &lt;混合故障试验数据 采样频率=&quot;10KHz&quot; 记录时长=&quot;20ms&quot; 通道数=“4&quot;&gt; &lt;通道一&gt; &lt;第1组&gt;77&lt;/第1组&gt; ...... &lt;第n组&gt;58&lt;/第n组&gt; ......</p></sec></sec><sec id="s7"><title>5. 格式转化的设计与实现</title><p>各种装置数据向XML文件的转化方法相似，下面仅以局放数据转化为例进行说明。不同厂家装置的数据文件差异较大，有的装置实验参数放在文件头部，有的厂家放文件尾部，有的甚至没有放入数据文件采用额外的辅助描述文件。波形数据的存放方式也存在较大差异，有二进制文件的，也有ASCII码存储的，不同厂家的数据文件向统一XML文件转化前需要填写文件描述表格，如下表1所示。</p><p>针对不同类型的数据文件，其数据解析方式存在差别，对于ASCII码文件需要填写分隔符，数据进制及波形数据的起始顺序号；而对于二进制文件则需要填写其数据精度，大小端模式及其波形数据的起始字节位置。</p><p>填写上述对应表格后，可根据设置值读取原数据文件中数据后写入统一格式的XML文件。格式转化程序的主要任务是根据不同厂家数据自己的格式，建立数据项与XML文件条目间的对应关系，并采用JDOM完成数据格式的转化，并最终将原数据转化为XML文档供诊断系统使用。本文设计了一个关系映射与数据格式转化系统。下面用Use Case用例图来表达使用者与统一数据接口的功能，如图1所示。</p><p>图1所示数据接口用例图，说明了格式转化接口程序的功能及其相互关系。该接口程序首先将数据读入内存，并根据填写的映射关系逐一对统一XML数据格式中的内容进行填充，并最终生成XML文件。另外，除转化功能外本接口程序还有文档预览及数据的图形绘制功能。</p><p>为了验证接口程序的正确性，选取某局放监测装置生成的数据文件进行了试验验证。该为二进制文件，后缀名为dat，数据精度为16位，小端模式，数据起始位为100，采用频率为30 MHZ，记录时长为20 ms，通道数为2，通道数据未分离，校正系数为1。文件转化前要求填写表1和表2后将数据文件读入内存，采用JDOM可完成其向统一XML格式的转化。XML文件中实验参数根据表格内容设置，数据部分则需要简单计算并将各个通道数据分离后写入XML文件。</p><p>经测试，原私有格式数据文件可由接口程序转化为设定的统一XML文件格式，并被综合诊断系统使用。色谱及振动数据的映射方式与此类似，文中不再描述。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Description of data fil</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >采集频率(10 KHZ)</th><th align="center" valign="middle" >8000</th></tr></thead><tr><td align="center" valign="middle" >电压</td><td align="center" valign="middle" >10 KV</td></tr><tr><td align="center" valign="middle" >记录时长(ms)</td><td align="center" valign="middle" >20</td></tr><tr><td align="center" valign="middle" >校正系数</td><td align="center" valign="middle" >1.0</td></tr><tr><td align="center" valign="middle" >数据通道数</td><td align="center" valign="middle" >2</td></tr><tr><td align="center" valign="middle" >各通道数据是否分离</td><td align="center" valign="middle" >否</td></tr><tr><td align="center" valign="middle" >数据文件类型</td><td align="center" valign="middle" >二进制</td></tr></tbody></table></table-wrap><p>表1. 数据文件描述</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Description of data forma</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  colspan="2"  >ASCII码文件</th><th align="center" valign="middle"  colspan="2"  >二进制文件</th></tr></thead><tr><td align="center" valign="middle" >分隔符</td><td align="center" valign="middle" >‘,’</td><td align="center" valign="middle" >数据精度</td><td align="center" valign="middle" >16位</td></tr><tr><td align="center" valign="middle" >数据进制</td><td align="center" valign="middle" >16</td><td align="center" valign="middle" >小端模式</td><td align="center" valign="middle" >是</td></tr><tr><td align="center" valign="middle" >波形数据顺序号</td><td align="center" valign="middle" >50</td><td align="center" valign="middle" >波形数据起始字节</td><td align="center" valign="middle" >1</td></tr></tbody></table></table-wrap><p>表2. 数据格式描述</p><p>图1. 数据转换接口用例图</p></sec><sec id="s8"><title>6. 结论</title><p>本文给出了局部放电、油色谱及振动监测装置数据的统一XML文件格式及私有数据文件向该格式转化的方法，对私有文件格式进行了分析总结后给出了数据文件的描述表格，为离线检测装置的数据共享提供了方法。采用JAVA语言实现了数据格式转换接口程序并选取典型事例进行了验证，结果表明，本文方法可将私有格式转化为统一格式，并将离线检测装置的私有格式数据接入变压器的综合诊断系统。</p></sec><sec id="s9"><title>基金项目</title><p>国家电网公司科技项目资助。</p></sec><sec id="s10"><title>文章引用</title><p>熊海军,林心昊. 基于XML的变压器故障诊断系统数据接口设计与实现 Design and Implementation of Data Interface for Transformer Fault Diagnosis System Based on XML[J]. 计算机科学与应用, 2015, 05(09): 343-349. http://dx.doi.org/10.12677/CSA.2015.59043</p></sec><sec id="s11"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16250-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">马宏忠, 耿志慧, 陈楷, 王春宁, 李凯, 李勇 (2013) 基于振动的电力变压器绕组变形故障诊断新方法. 电力系统自动化, 8, 89-95.</mixed-citation></ref><ref id="hanspub.16250-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">许惠君, 王宗耀, 苏浩益 (2013) 基于DGA的反馈云熵模型电力变压器故障诊断方法研究. 电力系统保护与控制, 23, 115-119.</mixed-citation></ref><ref id="hanspub.16250-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">武中利 (2013) 电力变压器故障诊断方法研究. 华北电力大学, 保定.</mixed-citation></ref><ref id="hanspub.16250-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">徐晨博, 王丰华, 黄华, 金之俭 (2014) 基于IEC 61850的变压器振动监测信息建模与实现. 电力系统自动化, 4, 60-64.</mixed-citation></ref><ref id="hanspub.16250-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">石辉 (2014) 基于IEC 61850规约的在线监测信息管理系统的研究. 华北电力大学, 保定.</mixed-citation></ref><ref id="hanspub.16250-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">冯进, 丁博, 史殿习, 张瞩熹, 许凯 (2009) XML解析技术研究. 计算机工程与科学, 2, 77-80.</mixed-citation></ref><ref id="hanspub.16250-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">张海东, 张鸿, 宋鑫, 等 (2012) SCD模型到CIM/E模型的转换方法. 电力系统自动化, 15, 91-95.</mixed-citation></ref><ref id="hanspub.16250-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">王惠 (2006) 基于SAX的文档解析技术的研究和实现. 电脑知识与技术(学术交流), 36, 210-217.</mixed-citation></ref></ref-list></back></article>