<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AG</journal-id><journal-title-group><journal-title>Advances in Geosciences</journal-title></journal-title-group><issn pub-type="epub">2163-3967</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AG.2019.99087</article-id><article-id pub-id-type="publisher-id">AG-32371</article-id><article-categories><subj-group subj-group-type="heading"><subject>AG20190900000_65699923.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject></subj-group></article-categories><title-group><article-title>
 
 
  BP神经网络技术在识别西湖凹陷平湖组煤层中的应用
  The Application of BP Neural Network Technology in Identifying Coal Seam of Pinghu Formation in Xihu Sag
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>葛</surname><given-names>和平</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>高</surname><given-names>顺莉</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>周</surname><given-names>平</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>中海石油(中国)有限公司上海分公司，上海</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>09</day><month>09</month><year>2019</year></pub-date><volume>09</volume><issue>09</issue><fpage>816</fpage><lpage>822</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   西湖凹陷是东海陆架盆地内最大的含油气凹陷，主力烃源岩平湖组为含煤的煤系地层，煤层具有厚度薄、层数多、生烃能力强的特征，而煤层的准确厚度常难以计算。本文利用BP神经网络技术，以实际岩性为学习预测样本，以对煤层响应敏感的测井参数为输入变量，通过对建立的三层BP神经网络模型的训练测试来实现对煤层的识别。结果表明，声波时差、中子和密度对煤层的测井响应最明显，利用BP神经网络技术识别出的煤层数量比原测井解释的煤层数有所增加，能识别出薄煤层，且与实际岩性的吻合度更高。BP神经网络技术可更好地识别钻井剖面中的煤层，尤其是薄煤层，从而更准确地计算出钻井剖面中的煤层厚度，具有良好的准确性和实用性。 Xihu sag is the largest oil and gas-bearing depression in the East China Sea Continental Shelf Basin. Pinghu Formation, the main source rock, is a coal-bearing strata, and the coal seam is characterized by thin thickness, multiple layers and strong hydrocarbon generation ability. However, the accurate thickness of coal seam is often difficult to calculate. This paper uses BP (Back Propagation) neural network technology, takes actual lithology as the learning and prediction sample, takes the logging parameters sensitive to coal seam as the input variable, and realizes the identification of coal seam through the training and testing of the established three-layer BP neural network model. The results show that acoustic time difference, neutron and density have the most obvious logging response to coal seam, and the number of coal seams identified by BP neural network technology is increased compared with the number of coal seams interpreted by original logging, and the thin coal seams can be identified, and the coincidence degree with the actual lithology is higher. BP neural network technology can better identify the coal seam in the drilling section, especially the thin coal seam, so as to calculate the coal seam thickness in the drilling section more accurately, which has good accuracy and practicability.
    
  
 
</p></abstract><kwd-group><kwd>BP神经网络，识别，西湖凹陷，平湖组，煤层, BP Neural Network</kwd><kwd> Identify</kwd><kwd> Xihu Sag</kwd><kwd> Pinghu Formation</kwd><kwd> Coal Seam</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>BP神经网络技术在识别西湖凹陷平湖组煤层中的应用<sup> </sup></title><p>葛和平，高顺莉，周平</p><p>中海石油(中国)有限公司上海分公司，上海</p><p><img src="//html.hanspub.org/file/9-1770906x1_hanspub.png" /></p><p>收稿日期：2019年9月6日；录用日期：2019年9月20日；发布日期：2019年9月27日</p><disp-formula id="hanspub.32371-formula58"><graphic xlink:href="//html.hanspub.org/file/9-1770906x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>西湖凹陷是东海陆架盆地内最大的含油气凹陷，主力烃源岩平湖组为含煤的煤系地层，煤层具有厚度薄、层数多、生烃能力强的特征，而煤层的准确厚度常难以计算。本文利用BP神经网络技术，以实际岩性为学习预测样本，以对煤层响应敏感的测井参数为输入变量，通过对建立的三层BP神经网络模型的训练测试来实现对煤层的识别。结果表明，声波时差、中子和密度对煤层的测井响应最明显，利用BP神经网络技术识别出的煤层数量比原测井解释的煤层数有所增加，能识别出薄煤层，且与实际岩性的吻合度更高。BP神经网络技术可更好地识别钻井剖面中的煤层，尤其是薄煤层，从而更准确地计算出钻井剖面中的煤层厚度，具有良好的准确性和实用性。</p><p>关键词 :BP神经网络，识别，西湖凹陷，平湖组，煤层</p><disp-formula id="hanspub.32371-formula59"><graphic xlink:href="//html.hanspub.org/file/9-1770906x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/9-1770906x7_hanspub.png" /> <img src="//html.hanspub.org/file/9-1770906x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>西湖凹陷位于东海陆架盆地东北部，面积逾5万平方千米，沉积厚度超15,000米，是一大型新生代断陷盆地 [<xref ref-type="bibr" rid="hanspub.32371-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref3">3</xref>]，油气资源丰富 [<xref ref-type="bibr" rid="hanspub.32371-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref6">6</xref>]。多年的勘探研究表明，始新统平湖组是半封闭的海湾环境和温暖–潮湿南亚热带型气候条件下沉积的暗色泥岩、砂岩夹多层薄煤层和碳质泥岩的地层 [<xref ref-type="bibr" rid="hanspub.32371-ref7">7</xref>]。暗色泥岩是凹陷内的主力烃源岩，分布广，厚度大。煤层是凹陷内的另一主力烃源岩，层数多，单层厚度薄，生烃能力强。单层煤层厚度以1米左右为多，大多不超过2米 [<xref ref-type="bibr" rid="hanspub.32371-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref10">10</xref>]。单井煤层常有数十层，累积厚度最厚近百米。因煤层单层厚度薄，又因海洋钻井岩屑录井捞样井段较长，加之钻屑细小及岩屑清洗原因，易造成部分薄煤层漏录。而测井解释时因煤层井段垮塌、煤层薄等原因，基于交汇图版的岩性解释方法也可造成薄煤层解释结果不够准确；人工解释时人为因素较大。如此常造成煤层厚度统计偏小，导致西湖凹陷油气资源量预测不准确，影响油气勘探决策部署。为此，笔者提出了基于多测井参数的BP神经网络技术识别煤层，以期从更高的精度、更快地刻画平湖组煤层，为评价西湖凹陷油气资源潜力提供扎实的基础资料。</p><p>人工神经网络理论是一门应用领域非常广泛的交叉学科。由于人工神经网络具有良好的自适应与自学习、大规模并行信息处理等特点，因此利用神经网络解决复杂非线性动态系统的预测问题就有了一条新的有效途径，具有重要的理论意义和实际应用价值，BP算法是人工神经网络中重要的一种学习算法 [<xref ref-type="bibr" rid="hanspub.32371-ref11">11</xref>]。基于BP神经网络(BPNN)的预测方法在油气行业也有广泛应用，如储层预测、油气层预测、烃源岩评价等。应用好BP神经网络技术的前提是选择学习样本、选好输入端参数，并建立起合适的预测模型。下文就此进行阐述。</p></sec><sec id="s4"><title>2. 煤层样本输入端参数选取</title><p>位于西湖凹陷西斜坡的P1井钻遇的平湖组为砂泥岩夹薄煤层(图1)，在凹陷内具有较好的代表性。我们计划以此井为研究样井，以其钻遇的岩性作为学习训练的样本，并据井中的煤层选出BP神经网络输入端参数。从图1可见，砂泥岩及煤层在自然电位(SP)、自然伽马(GR)、深侧向电阻率(RLLD)、密度(DEN)和声波时差(AC)等常规测井曲线上有较大的差异。砂岩在测井曲线上较易识别，泥岩与煤层通常也较易区分。泥岩具有“两高四低”的特征，即高密度、高自然伽马、低中子、低声波时差、低电阻率、低自然电位。煤层为“三高三低”，即高自然伽马、高中子、高声波时差、低密度、低电阻率、低自然电位。鉴于P1井平湖组上–中段岩性辨识度较好，以此井测井综合解释的岩性结果作为学习及预测的训练样本较为理想。</p><p>图1. P1井平湖组上段(部分)岩石测井特征</p><p>为了使BP神经网络计算收敛速度快、干扰小，对输入信号的裁剪是非常有必要的。煤层是本项研究的目标，因此，我们选择对煤层识别成功率高的测井参数作为输入端参数。为此，我们借助二维参数图版分析法，对P1井平湖组上–中段岩性的测井响应进行了统计分析(图2~5)。从图2~5中可以看出，密度、声波时差、中子对煤层的区分度较大，可将大部分煤层区分开来，仅部分煤层与泥岩重叠，而剩余几种测井参数都几乎无法将煤层与砂岩泥岩区分开来。</p><p>图2. P1井平湖组上–中段岩性GR-DEN数值交汇图</p><p>图3. P1井平湖组上–中段岩性RT-AC数值交汇图</p><p>图4. P1井平湖组上–中段岩性CN-CAL数值交汇图</p><p>图5. P1井平湖组上–中段岩性AC-SP数值交汇图</p><p>对图中单一测井参数识别煤层的成功率进行统计也表明(表1)，识别煤层最有效的是声波时差(AC)和中子(CN)，次为密度(DEN)、自然伽马(GR)和深侧向(LLD)，对煤层响应最不明显的是井径(CAL)和自然电位(SP)。本着全面、综合选用输入参数的原则，本次选择声波时差、中子、密度、自然伽马、深测向电阻率和井径为本项神经网络输入端参数。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Statistics on success rate of coal seam identification by single logging attribute in upper and middle Pinghu formation of well P</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >测井曲线</th><th align="center" valign="middle" >AC</th><th align="center" valign="middle" >CN</th><th align="center" valign="middle" >DEN</th><th align="center" valign="middle" >GR</th><th align="center" valign="middle" >LLD</th><th align="center" valign="middle" >CAL</th><th align="center" valign="middle" >SP</th></tr></thead><tr><td align="center" valign="middle" >识别成功率(%)</td><td align="center" valign="middle" >76.1</td><td align="center" valign="middle" >75.7</td><td align="center" valign="middle" >53.2</td><td align="center" valign="middle" >29.4</td><td align="center" valign="middle" >11.5</td><td align="center" valign="middle" >5.4</td><td align="center" valign="middle" >3.9</td></tr></tbody></table></table-wrap><p>表1. P1井平湖组上中段单个测井属性对煤层识别成功率统计表</p></sec><sec id="s5"><title>3. 煤层BP神经网络预测模型的建立及识别结果</title><p>人工神经网络最重要的是它不需要一个固定的数学公式，通过向样本学习获取知识并改进自身性能是它的一个重要特性。BP神经网络是一包含输入层、隐含层和输出层的多层网络，如图6所示，能很好地解决输入与输出间复杂的非线性关系。输入层有n个输入节点(神经元)，输出层有m个输出节点，隐含层有Y个节点，上、下层之间各神经元实现全连接，即上下层的每个节点都实现权联结，而每一层各神经元之间无联结 [<xref ref-type="bibr" rid="hanspub.32371-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref13">13</xref>]。</p><p>图6. BP人工神经网络原理示意图</p><p>BP人工神经网络模型训练过程实际上是对一组样本逐个进行输入、输出计算，网络将一系列输入进行连接权重加权，经隐层处理后传到输出层。输出的结果如与期望结果有误差，则误差将从输出层向输入层反向传播，在反向传播过程中重新调整各层间连接权及各层神经元偏差，再进行迭代计算，使误差逐渐缩小。反复的信息正向传播和误差反向传播是各层连接权重不断调整的过程，也是神经网络学习训练的过程。该过程一直到输出的结果符合要求为此 [<xref ref-type="bibr" rid="hanspub.32371-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref13">13</xref>]。</p><p>利用测井资料解释地层各种特性实际上是解决一个映射问题，即解决由n维输入向量(测井信息)到m维输出向量(岩性)之间的映射 [<xref ref-type="bibr" rid="hanspub.32371-ref14">14</xref>]。采用神经网络模式识别岩性必须事先确定足够多的岩性类别，用大量的样本进行训练 [<xref ref-type="bibr" rid="hanspub.32371-ref15">15</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref16">16</xref>] [<xref ref-type="bibr" rid="hanspub.32371-ref17">17</xref>]。根据以上原理，我们设计了三层神经网络预测模型，并以前文研究确定的对煤层测井响应敏感的六个参数作为输入端，建立了如图7的神经网络预测模型。依据以上预测模型，采用梯度下降算法，利用P1井平湖组上–中段地层岩性进行训练，直至训练结果符合要求。</p><p>图7. 煤层BP神经网络识别模型示意图</p><p>首先对选用的测井曲线做归一化处理。归一化的公式为：</p><p>X = ( x − x min ) / ( x max − x min ) &#215; 100</p><p>式中x为实际测井值，x<sub>max</sub>、x<sub>min</sub>为本条测井曲线所有采样点中的最大值和最小值，而X则为归一化后的测井值。</p><p>神经元初始权值用(1,0)和(0,1)分别代表煤层和非煤层2种结果，根据西湖凹陷实际情况设置训练初始参数为：学习步长d = 0.7，动量参数a = 0.1。设定学习次数为4000次，要求系统误差达到0.01，网络训练1126次后收敛，实际系统误差达到0.009。</p><p>利用训练好的神经网络模型，对西湖凹陷内的P2井进行煤层识别以进一步验证可靠性。从验证结果可见(图8)，原测井解释相对较厚的煤层，BP神经网络方法均能准确识别(BPNN煤)，对应性高。从图中还可见，神经网络识别出的薄煤层层数有所增加，部分煤层的解释厚度与前人综合解释的结果相比也有所增加。这也正是因为神经网络技术综合利用了多测井参数，发挥了测井数据高分辨率特性的优势。利用BP神经网络识别技术对凹陷内的P2井平湖组煤层进行识别的结果表明，该方法使用便捷，识别煤层的准确度高，可适用于西湖凹陷其他井区，并为其它地区识别煤层提供借鉴。</p><p>图8. P2井平湖组BP神经网络识别煤层结果对比图</p></sec><sec id="s6"><title>4. 结论</title><p>1) 识别煤层最有效的是声波时差和中子，次为密度、自然伽马和深侧向，井径和自然电位对煤层的响应不是很明显。</p><p>2) 利用三层BP神经网络预测模型及对煤层测井响应相对敏感的六项参数作为输入端数据可识别出薄煤层，与实际岩性的吻合度高。</p><p>3) 建立合理的神经网络模型，选取合适的训练样本是提高预测精度的关键。优选出对样本敏感的测井响应参数，才能更快更好地获得符合客观实际的预测结果。</p></sec><sec id="s7"><title>基金项目</title><p>国家科技重大专项“近海富烃凹陷资源潜力再评价和新区、新领域勘探方向”(No. 2008ZX05023-1) (第3阶段)资助。</p></sec><sec id="s8"><title>文章引用</title><p>葛和平,高顺莉,周 平. BP神经网络技术在识别西湖凹陷平湖组煤层中的应用The Application of BP Neural Network Technology in Identifying Coal Seam of Pinghu Formation in Xihu Sag[J]. 地球科学前沿, 2019, 09(09): 816-822. https://doi.org/10.12677/AG.2019.99087</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.32371-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">周心怀, 蒋一鸣, 唐贤君. 西湖凹陷成盆背景、原型盆地演化及勘探启示[J]. 中国海上油气, 2019, 31(3): 1-10.</mixed-citation></ref><ref id="hanspub.32371-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">郭令智, 施央申, 马瑞士. 西太平洋中、新生代活动大陆边缘和岛弧构造的形成及演化[J]. 地质学报, 1983, 57(1): 11-21.</mixed-citation></ref><ref id="hanspub.32371-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">王国纯. 东海盆地的形成与演化[J]. 石油学报, 1987, 8(4): 18-25.</mixed-citation></ref><ref id="hanspub.32371-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">贾健宜, 顾惠荣. 东海西湖凹陷含油气系统与油气资源评价[M]. 北京: 地质出版社, 2002.</mixed-citation></ref><ref id="hanspub.32371-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">姜亮. 东海陆架盆地第三系煤系烃源岩油气生成与聚集[M]. 北京: 石油工业出版社, 2002.</mixed-citation></ref><ref id="hanspub.32371-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">朱伟林. 中国近海油气勘探进展[J]. 中国工程科学, 2010, 12(5): 18-24.</mixed-citation></ref><ref id="hanspub.32371-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">武法东. 东海陆架盆地西湖凹陷第三系层序地层与沉积体系分析[M]. 北京: 地质出版社, 2000.</mixed-citation></ref><ref id="hanspub.32371-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">熊斌辉, 王春红, 张锦伟, 等. 西湖凹陷古近系平湖组煤层分布及油气意义[J]. 海洋石油, 2007, 27(3): 27-33.</mixed-citation></ref><ref id="hanspub.32371-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">邓运华. 试论中国近海两个坳陷带油气地质差异性[J]. 石油学报, 2009, 30(1): 1-8.</mixed-citation></ref><ref id="hanspub.32371-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">李友川, 邓运华, 张功成. 中国近海海域烃源岩和油气的分带性[J]. 中国海上油气, 2012, 24(1): 6-12.</mixed-citation></ref><ref id="hanspub.32371-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">贺清碧. BP神经网络及应用研究[D]: [硕士学位论文]. 重庆: 重庆交通学院, 2004.</mixed-citation></ref><ref id="hanspub.32371-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">袁冰清, 程功, 郑柳刚. BP神经网络基本原理[J]. 数字通信世界, 2018(8): 28-29.</mixed-citation></ref><ref id="hanspub.32371-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">韩普, 周汉辰, 周北望. BP神经网络原理研究与实现[J]. 广播电视信息, 2018, 318(10): 121-125.</mixed-citation></ref><ref id="hanspub.32371-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">肖慈﨑, 娄建立, 谭世君. 神经网络技术用于测井解释的评述[J]. 测井技术, 1999, 23(5): 389-392+399.</mixed-citation></ref><ref id="hanspub.32371-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">席道瑛, 张涛. BP人工神经网络模型在测井资料岩性自动识别中的应用[J]. 物探化探计算技术, 1995, 17(1): 42-48.</mixed-citation></ref><ref id="hanspub.32371-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">张洪, 邹乐君, 沈晓华. BP神经网络在测井岩性识别中的应用[J]. 地质与勘探, 2002, 38(6): 63-65.</mixed-citation></ref><ref id="hanspub.32371-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">董守华, 陈辉. 利用人工神经网络自动识别煤田测井岩性[J]. 中国煤田地质, 1996, 8(1): 66-70.</mixed-citation></ref></ref-list></back></article>