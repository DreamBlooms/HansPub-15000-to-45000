<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SA</journal-id><journal-title-group><journal-title>Statistics and Application</journal-title></journal-title-group><issn pub-type="epub">2325-2251</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SA.2016.54038</article-id><article-id pub-id-type="publisher-id">SA-19327</article-id><article-categories><subj-group subj-group-type="heading"><subject>SA20160400000_66348313.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  吉布斯抽样在数据缺失中的应用及其R实现
  Application of Gibbs Sampling in Data Missing and Execution in R
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>丁</surname><given-names>霞</given-names></name><xref ref-type="aff" rid="aff1"><sub>1</sub></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>上海海事大学经济管理学院，上海</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1632198623@qq.com</email></corresp></author-notes><pub-date pub-type="epub"><day>12</day><month>12</month><year>2016</year></pub-date><volume>05</volume><issue>04</issue><fpage>359</fpage><lpage>364</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  数据缺失是统计研究中经常遇到的问题，文章在总结常见缺失数据的处理方法的基础上，提出了用Gibbs抽样方法来解决数据缺失问题，并通过R语言来实现这一过程，从而为数据缺失提供一种新的解决思路。实验结果表明，Gibbs抽样是一种效果比较理想的处理缺失数据的方法。
   Data missing is a common problem in statistical research. Based on summarizing the common so-lutions, this paper proposes to solve the problem by Gibbs sampling, and achieve this process through the R language, so as to provide a new method. The experimental results show that Gibbs sampling is an ideal method to deal with missing data.
 
</p></abstract><kwd-group><kwd>Gibbs抽样，数据缺失，R语言, Gibbs Sampling</kwd><kwd> Data Missing</kwd><kwd> R Language</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>吉布斯抽样在数据缺失中的应用及其R实现<sup> </sup></title><p>丁 霞</p><p>上海海事大学经济管理学院，上海</p><disp-formula id="hanspub.19327-formula141"><graphic xlink:href="http://html.hanspub.org/file/6-2580215x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年11月29日；录用日期：2016年12月12日；发布日期：2016年12月22日</p><disp-formula id="hanspub.19327-formula142"><graphic xlink:href="http://html.hanspub.org/file/6-2580215x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>数据缺失是统计研究中经常遇到的问题，文章在总结常见缺失数据的处理方法的基础上，提出了用Gibbs抽样方法来解决数据缺失问题，并通过R语言来实现这一过程，从而为数据缺失提供一种新的解决思路。实验结果表明，Gibbs抽样是一种效果比较理想的处理缺失数据的方法。</p><p>关键词 :Gibbs抽样，数据缺失，R语言</p><disp-formula id="hanspub.19327-formula143"><graphic xlink:href="http://html.hanspub.org/file/6-2580215x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>在进行统计学研究过程中，一般都要求数据是完整的、及时的、可靠和准确的。但在实践中，由于客观条件的限制，统计数据的及时、可靠准确问题往往容易解决，但数据完整性问题很难解决，统计数据往往是有缺失的。如果不对统计数据缺失问题进行处理，容易造成分析结果的偏差，甚至错误，从而降低统计结果的准确性和效率。所以进行统计分析最重要的一步就是对不完整的统计数据进行预处理，对缺失数据进行补充，形成一个完整的统计数据集，然后再对补充完整后的统计数据集进行统计分析，这样的分析结果才能够准确。</p></sec><sec id="s4"><title>2. 传统缺失数据处理方法</title><p>最原始的处理缺失数据的方法是直接删除法，它把存在缺失值的样本删掉，那么数据就变成完整数据了。如果某个变量有许多缺失值，那么也可以直接将该变量删去不要。如果缺失数据是非完全随机缺失，可以对完整的数据进行加权，从而减小偏差。删除法是对缺失数据处理的最简单最直接的方法，但是这会损失样本的信息，如果缺失比例比较大，就不能使用删除法。</p><p>除了删除法，常见的处理缺失数据的方法有两种 [<xref ref-type="bibr" rid="hanspub.19327-ref1">1</xref>] ，第一种是直接取最可能的值去代替缺失值，这一方法主要有：</p><p>1) 人工填写法。</p><p>让最了解数据的人去为缺失数据做补充，效果比较理想。但是当缺失值较多时，该方法会耗费大量人力物力，实操性并不强，所以在实际生活中一般不会选择这个方法。</p><p>2) 均值填充法。</p><p>如果缺失值是数值，我们采用与该缺失值相同属性的其他值的平均值来填充，如果缺失值是非数值，我们采用与该缺失值相同属性的其他值的众数来填充。</p><p>3) 特殊值填充法。</p><p>有的时候，如果某类型数据值缺失，则代表了一定的意义，比如个人信用评估中电话号码或者家庭住址的缺失，意味着此人信用存在问题的概率加大。我们可以把缺失值用一个特殊的值如“unknown”来进行填充。</p><p>第二种方法是借助于模型来完成对缺失数据的填补。该方法主要有以下几种：</p><p>1) 回归填充法</p><p>上诉缺失值填充方法并没有考虑与缺失值相关的变量的信息，利用回归填充法，我们可以做一个回归，将缺失变量作为因变量，与它相关的其他变量称为自变量，从而拟合一个线性回归模型，用相关变量的值来估计缺失变量的值。</p><p>2) 极大似然估计方法</p><p>当缺失数据为随机缺失时，我们可以通过已知信息来求得边际分布，从而对参数进行极大似然估计，比较常用的是EM算法。这种方法适用于样本数量比较大的情况，从而保证估计结果渐近无偏且服从正态分布。</p><p>均值填充法和特殊值填充法没有很好利用总体的信息，所以数据填充之后，可能并不能真实反映总体的信息，回归填充法虽然考虑了总体的信息，但是如果缺失值没有相关的变量或者相关的变量值也有缺失，那么该方法也就失效了。EM算法因为适用于大样本情况，而且计算比较复杂，需准确计算数值积分(E步)和进行导数运算(M步)，所以当样本量并不大时，该方法也不太理想。而Gibbs抽样可以解决以上问题，而且实施过程简单易行，对真实值的拟合效果也比较理想 [<xref ref-type="bibr" rid="hanspub.19327-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.19327-ref3">3</xref>] 。</p></sec><sec id="s5"><title>3. 吉布斯方法概述</title><p>1984年，D. Geman和S. Geman提出了Gibbs算法 [<xref ref-type="bibr" rid="hanspub.19327-ref4">4</xref>] ，发展至今，Gibbs抽样已经成为了一种应用广泛而且方法简单的MCMC抽样方法，Gibbs抽样的基本思想是通过满条件分布来构造马氏链转移核从而进行抽样。例如，如果要从二维联合分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x9_hanspub.png" xlink:type="simple"/></inline-formula>中进行随机抽样，但是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x10_hanspub.png" xlink:type="simple"/></inline-formula>的表达式并不清楚，或者表达式过于复杂，不方便直接抽样，与此同时，条件分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x11_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x12_hanspub.png" xlink:type="simple"/></inline-formula>已知而且表达式相对比较简单，我们则可以依照以下迭代步骤进行抽样，从而获得二维联合分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x13_hanspub.png" xlink:type="simple"/></inline-formula>的随机样本 [<xref ref-type="bibr" rid="hanspub.19327-ref5">5</xref>] 。</p><p>Gibbs抽样的基本步骤：</p><p>1) 在满足条件分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x14_hanspub.png" xlink:type="simple"/></inline-formula>的取值要求下选择<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x15_hanspub.png" xlink:type="simple"/></inline-formula></p><p>2) 从条件分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x16_hanspub.png" xlink:type="simple"/></inline-formula>中随机选取一个值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x17_hanspub.png" xlink:type="simple"/></inline-formula>(此时产生了第一对随机点列<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x18_hanspub.png" xlink:type="simple"/></inline-formula>)</p><p>3) 从条件分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x19_hanspub.png" xlink:type="simple"/></inline-formula>中随机选取一个值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x20_hanspub.png" xlink:type="simple"/></inline-formula></p><p>4) 从条件分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x21_hanspub.png" xlink:type="simple"/></inline-formula>中随机选取一个值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x22_hanspub.png" xlink:type="simple"/></inline-formula>(此时产生了第二对随机点列<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x23_hanspub.png" xlink:type="simple"/></inline-formula>)</p><p>…</p><p>重复以上步骤N次之后，去掉最开始的一部分抽样值，从而避免初始值的影响，即可得到二维联合分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x24_hanspub.png" xlink:type="simple"/></inline-formula>的随机抽样样本。</p></sec><sec id="s6"><title>4. 模拟研究以及效果评价</title><sec id="s6_1"><title>4.1. 数值实验及其R实现</title><p>本文利用一组完整数据进行缺失数据的填补实验。首先按照20%的缺失比例，随机删除部分数据,然后利用Gibbs抽样，对缺失数据进行填充，将填补后的数据与完整数据做对比，从而衡量Gibbs抽样处理缺失数据的效果。</p><p>以上海某高校大学男生(1000人)的身高体重数据为例，已知成年男子的身高体重服从二维正态分布，记身高为X，体重为Y，则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x25_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x26_hanspub.png" xlink:type="simple"/></inline-formula>分别指身高和体重的均值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x27_hanspub.png" xlink:type="simple"/></inline-formula>分别指身高和体重的方差，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x28_hanspub.png" xlink:type="simple"/></inline-formula>是身高和体重的相关系数。</p><p>当随机变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x29_hanspub.png" xlink:type="simple"/></inline-formula>，对应的条件分布为：</p><disp-formula id="hanspub.19327-formula144"><graphic xlink:href="http://html.hanspub.org/file/6-2580215x30_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.19327-formula145"><graphic xlink:href="http://html.hanspub.org/file/6-2580215x31_hanspub.png"  xlink:type="simple"/></disp-formula><p>随机删除200名男生的数据，使数据出现全数据缺失。对余下的数据进行计算，得到满条件分布，选定不完整数据的身高和体重的均值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x32_hanspub.png" xlink:type="simple"/></inline-formula>为初始值，便可用R语言开始迭代过程，产生马氏链。程序如下 [<xref ref-type="bibr" rid="hanspub.19327-ref6">6</xref>] ：</p><p>TT&lt;-10000</p><p>chain&lt;-matrix(numeric(),nr=2,nc=TT)</p><p>chain[,1]&lt;-c(172.57,62.73)</p><p>for(i in 2:TT){</p><p>chain[1,i]&lt;-rnorm(1,172.57+0.6873*(chain[2,i-1]-62.73),sqrt(23.9*(1-0.4862)))</p><p>chain[2,i]&lt;-rnorm(1,62.73+0.7074*(chain[1,i]-172.57),sqrt(24.6*(1-0.4862)))</p><p>}</p><p>为了避免初始值的影响，从而产生更优质的随机数，在迭代10000次后，剔除前面的9800对随机数，保留余下的200对。</p></sec><sec id="s6_2"><title>4.2. 效果评价</title><p>表1给出了抽样填补后的数据和原始数据的对比，我们可以看到，通过Gibbs抽样模拟之后获取的身高和体重的均值分别为173.31和63.70，方差分别为23.17和23.26，X和Y的相关系数为0.6467。填充后数据的统计值和真实完整数据的统计值相差很小。</p><p>再看填充后数据的二维散点图(图1)，该图显示模拟产生的随机数具有正态分布的特点，而且填充后数据的中心与原数据的中心(红色虚线)基本吻合。</p><p>身高和体重分别服从正态分布，作出填充后数据的身高和体重的直方图，并根据完整数据的分布作出概率密度函数曲线。从图2和图3我们可以看出，直方图的形态与概率密度函数曲线的形态较为相似，这说明Gibbs抽样填补缺失数据的模拟效果比较理想。</p><p>接下来再对原始数据和填补后的数据进行单因素方差分析，原假设H<sub>0</sub>为两种数据之间的差异不显著(<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2580215x33_hanspub.png" xlink:type="simple"/></inline-formula>)，分析结果如表2和表3所示。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Comparison between the original data and the populated dat</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >X均值</th><th align="center" valign="middle" >X方差</th><th align="center" valign="middle" >Y均值</th><th align="center" valign="middle" >Y方差</th><th align="center" valign="middle" >X和Y的相关系数</th></tr></thead><tr><td align="center" valign="middle" >原数据</td><td align="center" valign="middle" >173.11</td><td align="center" valign="middle" >23.58</td><td align="center" valign="middle" >63.19</td><td align="center" valign="middle" >25.33</td><td align="center" valign="middle" >0.7042</td></tr><tr><td align="center" valign="middle" >Gibbs抽样数据</td><td align="center" valign="middle" >173.31</td><td align="center" valign="middle" >23.17</td><td align="center" valign="middle" >63.70</td><td align="center" valign="middle" >23.26</td><td align="center" valign="middle" >0.6467</td></tr></tbody></table></table-wrap><p>表1. 原数据与填充后数据对比</p><p>图1. 填充后数据的二维散点图</p><p>从表2和表3中可以看到，两组单因素方差分析的P值均大于0.05，所以不拒绝原假设，两组数据之间无显著差异。这说明通过Gibbs抽样进行填充的数据拟合效果较好。</p><p>图2. 填充后的身高数据直方图</p><p>图3. 填充后的体重数据直方图</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> ANOVA (height</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >差异源</th><th align="center" valign="middle" >SS</th><th align="center" valign="middle" >df</th><th align="center" valign="middle" >MS</th><th align="center" valign="middle" >F</th><th align="center" valign="middle" >P-value</th><th align="center" valign="middle" >F crit</th></tr></thead><tr><td align="center" valign="middle" >组间</td><td align="center" valign="middle" >51.51623</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >51.51623</td><td align="center" valign="middle" >2.256341</td><td align="center" valign="middle" >0.133226</td><td align="center" valign="middle" >3.846117</td></tr><tr><td align="center" valign="middle" >组内</td><td align="center" valign="middle" >45617.85</td><td align="center" valign="middle" >1998</td><td align="center" valign="middle" >22.83176</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >总计</td><td align="center" valign="middle" >45669.37</td><td align="center" valign="middle" >1999</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表2. 单因素方差分析(身高)</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> ANOVA (weight</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >差异源</th><th align="center" valign="middle" >SS</th><th align="center" valign="middle" >df</th><th align="center" valign="middle" >MS</th><th align="center" valign="middle" >F</th><th align="center" valign="middle" >P-value</th><th align="center" valign="middle" >F crit</th></tr></thead><tr><td align="center" valign="middle" >组间</td><td align="center" valign="middle" >78.31466</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >78.31466</td><td align="center" valign="middle" >3.217855</td><td align="center" valign="middle" >0.07299</td><td align="center" valign="middle" >3.846117</td></tr><tr><td align="center" valign="middle" >组内</td><td align="center" valign="middle" >48626.39</td><td align="center" valign="middle" >1998</td><td align="center" valign="middle" >24.33753</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >总计</td><td align="center" valign="middle" >48704.71</td><td align="center" valign="middle" >1999</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表3. 单因素方差分析(体重)</p></sec></sec><sec id="s7"><title>5. 结论</title><p>本文总结了一些常用的处理数据缺失的方法，并提出了将Gibbs抽样应用到缺失数据的填补中。在实际操作中，只要通过已知数据得到满条件分布，就可以开始迭代产生随机数，这一迭代过程可以轻松地通过R语言实现，而且Gibbs抽样的结果与已知数据的统计特征吻合程度比较高，可以比较理想地完成缺失数据的填补过程。综上，Gibbs抽样具有简单易操作，可充分利用总体的信息，不受限于小样本，且填补结果拟合程度高的优点。</p><p>但是需要指出的是，并没有哪种处理方法是普遍适用的，在实际情况中还是要根据具体问题，充分考虑每种方法的优点和缺点以及适用情况之后再选择最合适的方法进行数据填补。还有一点值得注意的是，Gibbs抽样并非真正的随机抽样，它每一步的抽样都是上一步的函数，只是上一步的抽样是随机的，所以利用Gibbs抽样得到的数据实际上是Markov链。</p></sec><sec id="s8"><title>文章引用</title><p>丁霞. 吉布斯抽样在数据缺失中的应用及其R实现 Application of Gibbs Sampling in Data Missing and Execution in R[J]. 统计学与应用, 2016, 05(04): 359-364. http://dx.doi.org/10.12677/SA.2016.54038</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.19327-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">曾莉, 辛涛, 张淑梅. 2PL模型的两种马尔可夫蒙特卡洛缺失数据处理方法比较[J]. 心理学报, 2009, 41(3): 276- 282.</mixed-citation></ref><ref id="hanspub.19327-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">张香云. Gibbs抽样在不同缺失率下的参数估计[J]. 统计与决策, 2008(4): 23-24.</mixed-citation></ref><ref id="hanspub.19327-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">陈晓林. 基于Gibbs抽样和EM算法的生物保守序列motif识别[D]: [硕士学位论文]. 苏州: 苏州大学, 2007.</mixed-citation></ref><ref id="hanspub.19327-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Geman, S. and Geman, D. (1984) Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images. IEEE Transactions on Pattern Analysis and Machine Intelligence, PAMI-6, 721-724.  
&lt;br&gt;https://doi.org/10.1109/TPAMI.1984.4767596</mixed-citation></ref><ref id="hanspub.19327-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Hastings, W.K. (1970) Monte Carlo Sampling Methods Using Markov Chains and Their Applications. Biometrika, 57, 97-109. &lt;br&gt;https://doi.org/10.1093/biomet/57.1.97</mixed-citation></ref><ref id="hanspub.19327-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">候雅文, 王斌会. 统计实验及R语言模拟[M]. 北京: 北京大学出版社, 2015.</mixed-citation></ref></ref-list></back></article>