<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SD</journal-id><journal-title-group><journal-title>Sustainable   Development</journal-title></journal-title-group><issn pub-type="epub">2160-7540</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SD.2018.81003</article-id><article-id pub-id-type="publisher-id">SD-23421</article-id><article-categories><subj-group subj-group-type="heading"><subject>SD20180100000_74844228.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject><subject> 经济与管理</subject></subj-group></article-categories><title-group><article-title>
 
 
  改进GM(1,1)模型在城市用水量预测中的应用
  Application of Improved GM(1,1) in Forecasting City Water Demand
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>任</surname><given-names>玉忠</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>仇</surname><given-names>强</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>潍坊市水利局，山东 潍坊</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>14</day><month>12</month><year>2017</year></pub-date><volume>08</volume><issue>01</issue><fpage>19</fpage><lpage>23</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    本文在对GM(1,1)模型的不足之处进行了分析后，认为在对累加序列的拟合中，由k得到的离散解与累加序列之间存在较大误差，进而影响了模型的精度，所以提出了对k进行修正来提高预测精度，通过增加参数β，用梯度法求出β得到新的预测模型；最后将新模型应用到潍坊市用水量建模中，结果表明：本文提出的方法比之原有模型有较好的精度，由此拓宽了GM(1,1)模型的适用范围。
    After analyzing the deficiency of the traditional GM(1,1) forecasting model, the authors think that in the fitting accumulated sequence, the great error exists between accumulated sequence and discrete solution by k, and then has influenced the precision of the model. So this paper has pro-posed to amend k to improve the forecasting precision, through adding the parameter β and cal-culating the β by step method to get the new forecasting model. When applying it to the modeling of Weifang City water demand, the application result shows the method is effective and the application range is widened. 
  
 
</p></abstract><kwd-group><kwd>水资源，GM(1</kwd><kwd>1)模型，用水量，预测, Water Resources</kwd><kwd> Grey Model GM(1</kwd><kwd>1)</kwd><kwd> Water Demand</kwd><kwd> Forecasting</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>改进GM(1,1)模型在城市用水量预测中的应用<sup> </sup></title><p>任玉忠，仇强</p><p>潍坊市水利局，山东 潍坊</p><p>收稿日期：2017年12月7日；录用日期：2018年1月9日；发布日期：2018年1月16日</p><disp-formula id="hanspub.23421-formula21"><graphic xlink:href="//html.hanspub.org/file/3-1150315x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文在对GM(1,1)模型的不足之处进行了分析后，认为在对累加序列的拟合中，由k得到的离散解与累加序列之间存在较大误差，进而影响了模型的精度，所以提出了对k进行修正来提高预测精度，通过增加参数β，用梯度法求出β得到新的预测模型；最后将新模型应用到潍坊市用水量建模中，结果表明：本文提出的方法比之原有模型有较好的精度，由此拓宽了GM(1,1)模型的适用范围。</p><p>关键词 :水资源，GM(1,1)模型，用水量，预测</p><disp-formula id="hanspub.23421-formula22"><graphic xlink:href="//html.hanspub.org/file/3-1150315x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/3-1150315x7_hanspub.png" /> <img src="//html.hanspub.org/file/3-1150315x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 前言</title><p>随着经济的发展，城市规模的不断扩大，水资源的供需矛盾日趋突出。因此，进行需水量的预测将为水资源的优化配置提供重要的科学依据，并对城市供水规划和水务管理工作起着宏观指导作用。</p><p>目前，城市需水量的预测方法主要有时间序列分析法 [<xref ref-type="bibr" rid="hanspub.23421-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.23421-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.23421-ref3">3</xref>] 、结构分析法 [<xref ref-type="bibr" rid="hanspub.23421-ref4">4</xref>] 和系统分析法 [<xref ref-type="bibr" rid="hanspub.23421-ref5">5</xref>] 3种类型。采用不同的预测方法和预测模型，需水量预测结果也各不相同，有的甚至差别很大。为提高用水量的预测精度，各组合预测方法 [<xref ref-type="bibr" rid="hanspub.23421-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.23421-ref7">7</xref>] 不断出现。初步分析发现 [<xref ref-type="bibr" rid="hanspub.23421-ref8">8</xref>] ，预测精度不仅与选用的模型有关，而且也与原始序列的变化规律有关。若要提高需水量预测的精度，就必须根据原始数据的特点正确选择预测模型，这是达到预测精度要求的前提。然而，在目前的水量预测研究中，通常根据历史数据的自然状态所呈现的规律来选择模型，却忽视了时间序列的潜在变化特征，不能将其引入预测模型中，这就限制了选择范围。本文以潍坊市2003~2012年全市用水量为例，通过对GM(1,1)模型进行改进来提高预测精度，结果表明该模型具有较高的精度，可用于城市用水量预测。</p></sec><sec id="s4"><title>2. GM(1,1)模型</title><p>GM(1,1)模型是一种动态预测模型，该模型由一个单变量的一阶微分方程构成，建模过程如下。</p><p>设原始非负数据序列为： X ( 0 ) = { x ( 0 ) ( 1 ) , x ( 0 ) ( 2 ) , ⋯ , x ( 0 ) ( n ) } 对其进行一次累加得 X ( 1 ) ，其中： X ( 1 ) ( k ) = ∑ i = 1 k x ( 0 ) ( i ) ， k = 1 , 2 , ⋯ , n 。</p><p>GM(1,1)模型的微分方程为：</p><p>x ( 0 ) ( k ) + a z ( 1 ) ( k ) = u , k = 2 , 3 , ⋯ , n (1)</p><p>对应的白化方程为：</p><p>d x ( 1 ) t d t + a x ( 1 ) ( t ) = u (2)</p><p>方程(2)的解为：</p><p>x ^ ( 1 ) ( t ) = [ x ( 1 ) ( 1 ) − u a ] e − a t + u a (3)</p><p>离散化为：</p><p>x ^ ( 1 ) ( k + 1 ) = [ x ( 1 ) ( 1 ) − u a ] e − a k + u a (4)</p><p>还原得：</p><p>x ^ ( 0 ) ( k + 1 ) = x ^ ( 1 ) ( k + 1 ) − x ^ ( 1 ) ( k ) = ( 1 − e a ) [ x ( 1 ) ( 1 ) − u a ] e − a k (5)</p><p>由于式(5)中参数k得到的解组成的序列并不一定与累加序列是一一对应的，可能存在较大的误差 [<xref ref-type="bibr" rid="hanspub.23421-ref9">9</xref>] 。所以本文提出对k的修正来提高拟合度，进而提高GM(1,1)模型的预测精度。</p></sec><sec id="s5"><title>3. GM(1,1)模型修正</title><sec id="s5_1"><title>3.1. 模型参数修正</title><p>改变模型的k为k + β，并把该值代入(4)中得：</p><p>x ^ ( 1 ) ( k + 1 ) = [ x ( 1 ) ( 1 ) − u a ] e − a ( k + β ) + u a (6)</p><p>定义如下的指标函数：</p><p>J = ∑ k = 1 n − 1 [ x ^ ( 1 ) ( k + 1 ) − x ( 1 ) ( k + 1 ) ] 2 = ∑ k = 1 n − 1 { [ x ( 0 ) ( 1 ) − u a ] e − a ( k + β ) + u a − x ( 1 ) ( k + 1 ) } 2 (7)</p><p>求出指标函数J最小时的β，可以采用如下梯度法求参数β：</p><p>d J d β = − 2 a { x ( 0 ) ( 1 ) − u a } [ ∑ k = 1 n − 1 ( x ( 0 ) ( 1 ) − u a ) e − 2 a ( k + β ) + ∑ k = 1 n − 1 ( u a − x ( 1 ) ( k + 1 ) ) e − a ( k + β ) ] = 0 (8)</p><p>即：</p><p>e − 2 a β ∑ k = 1 n − 1 [ x ( 0 ) ( 1 ) − u a ] e − 2 a k + e − a β ∑ k = 1 n − 1 [ u a − x ( 1 ) ( k + 1 ) ] e − a k = 0 (9)</p><p>e − a β = ∑ k = 1 n − 1 [ x ( 1 ) ( k + 1 ) − u a ] e − a k ∑ k = 1 n − 1 [ x ( 0 ) ( 1 ) − u a ] e − 2 a k (10)</p><p>令：</p><p>q = ∑ k = 1 n − 1 [ x ( 1 ) ( k + 1 ) − u a ] e − a k ∑ k = 1 n − 1 [ x ( 0 ) ( 1 ) − u a ] e − 2 a k ， β = − ln q a (11)</p><p>求出参数β之后，可以用公式(6)进行预测。</p></sec><sec id="s5_2"><title>3.2. 模型后验差检验</title><p>后验差比：</p><p>C = S 2 S 1 (12)</p><p>式中：S<sub>1</sub>为原始数列 X ( 0 ) 的均方差；S<sub>2</sub>为残差序列 { Δ ( k ) } 的均方差。</p><p>小误差概率 p = p { | Δ ( k ) − Δ &#175; | &lt; 0.6745 S 1 }</p><p>落入区间 [ Δ &#175; − 0.6745 S 1 , Δ &#175; + 0.6745 S 1 ] 的 Δ ( k ) 的频率越大越好，一般模型精度等级按表1划分。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The level standard of inspection inde</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >模型级别</th><th align="center" valign="middle" >小误差概率P</th><th align="center" valign="middle" >后验差比值C</th></tr></thead><tr><td align="center" valign="middle" >1级(好)</td><td align="center" valign="middle" >&gt;0.95</td><td align="center" valign="middle" >&lt;0.35</td></tr><tr><td align="center" valign="middle" >2级(合格)</td><td align="center" valign="middle" >&gt;0.85</td><td align="center" valign="middle" >&lt;0.50</td></tr><tr><td align="center" valign="middle" >3级(勉强)</td><td align="center" valign="middle" >&gt;0.70</td><td align="center" valign="middle" >&lt;0.65</td></tr><tr><td align="center" valign="middle" >4级(不合格)</td><td align="center" valign="middle" >≤0.70</td><td align="center" valign="middle" >≥0.65</td></tr></tbody></table></table-wrap><p>表1. 检验指标等级标准</p></sec></sec><sec id="s6"><title>4. 模型应用</title><sec id="s6_1"><title>4.1. 研究区概况</title><p>潍坊市地处胶东半岛西部，地理位置为118˚10'E~120˚38'E，35˚43'N~37˚16'N，是我国北方严重缺水的城市之一，当地多年平均淡水资源总量27.28亿m<sup>3</sup>，人均水资源占有量仅为292 m<sup>3</sup> (2016年末数据)，不足全国平均水平的1/7，且远低于世界公认的维持一个地区经济社会发展所必须的人均水资源量1000 m<sup>3</sup>的临界值，属于人均占有量小于500 m<sup>3</sup>的严重缺水地区，水资源严重短缺成为制约经济社会发展的主要瓶颈之一。潍坊市多年平均降雨量655 mm，受季风性气候和地形条件的影响，降雨时空分布极不均衡，年降雨量的70%集中在6~9月份，致使汛期局部地区洪水成灾，干旱季度用水又极为紧张。潍坊市境内河流众多，流域面积50 km<sup>2</sup>以上的有103条，主要河流水系有潍河、弥河、白浪河、小清河、胶莱河5条。这些河流大都发源于南部山丘区，除诸城境内有南流小河外，其余均向北流入渤海莱州湾。受地理位置决定，境内河流均为季风区雨原型河流，大都源短流急，雨季流量大，枯季流量小甚至干枯。水资源与生产力布局不相匹配，既是现阶段该市的突出水情，也是今后将要长期面对的基本市情。</p></sec><sec id="s6_2"><title>4.2. 用水量预测</title><p>本文以潍坊市2003~2012年城市用水量数据为原始序列(见表2)。</p><p>依据灰色模型原理建立GM(1,1)模型，求得模型参数：a = −0.002826，μ = 157592.4，则模型计算式为：</p><p>X ^ ( 1 ) ( k ) = 55942487.7 e 0.002826 ( k − 1 ) − 55772375.7     ( k ≥ 1 )</p><p>对模型进行后验差检验。经计算，后验差比值C = 1.024 &gt; 0.65，小误差概率P = 0.667 &lt; 0.7，模型级别为不合格，需要对所得模型进行修正。</p><p>修正之后的灰色模型为：</p><p>X ^ ( 1 ) ( k ) = 55942487.7 e 0.002826 ( k − 0.9057 ) − 55772375.7     ( k ≥ 1 )</p><p>其中：β = 0.0943。</p><p>两模型的模拟结果见表2。从表2的结果中可以看出，本文所建模型的平均误差为3.17%，小于GM(1,1)模型的平均误差5.82%，具有较好的模拟精度，可以用来预测研究区的用水量；同时，这也说明了对GM(1,1)模型参数进行修正的必要性和可行性。</p></sec></sec><sec id="s7"><title>5. 结语</title><p>城市用水量系统受诸多不确定因素的影响，而且部分主要影响因素在一定的时段内并无明显的变化趋势；要精确地描述它们的发展和变化规律是有一定困难的。本文通过对GM(1,1)模型的构造原理进行</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Over the years water demand and simulation value of Weifang cit</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >年份</th><th align="center" valign="middle"  rowspan="2"  >实际值/万m<sup>3</sup></th><th align="center" valign="middle"  colspan="2"  >GM(1,1)模型</th><th align="center" valign="middle"  colspan="2"  >改进GM(1,1)模型</th></tr></thead><tr><td align="center" valign="middle" >模型值/万m<sup>3</sup></td><td align="center" valign="middle" >相对误差/%</td><td align="center" valign="middle" >模型值/万m<sup>3</sup></td><td align="center" valign="middle" >相对误差/%</td></tr><tr><td align="center" valign="middle" >2003</td><td align="center" valign="middle" >170,112</td><td align="center" valign="middle" >170,112</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >170,112</td><td align="center" valign="middle" >0</td></tr><tr><td align="center" valign="middle" >2004</td><td align="center" valign="middle" >133,158</td><td align="center" valign="middle" >121,349.9</td><td align="center" valign="middle" >8.87%</td><td align="center" valign="middle" >138,082</td><td align="center" valign="middle" >3.70%</td></tr><tr><td align="center" valign="middle" >2005</td><td align="center" valign="middle" >152,367.05</td><td align="center" valign="middle" >164,729.8</td><td align="center" valign="middle" >8.11%</td><td align="center" valign="middle" >161,037</td><td align="center" valign="middle" >5.69%</td></tr><tr><td align="center" valign="middle" >2006</td><td align="center" valign="middle" >186,598.38</td><td align="center" valign="middle" >198,754.6</td><td align="center" valign="middle" >6.51%</td><td align="center" valign="middle" >193,287</td><td align="center" valign="middle" >3.58%</td></tr><tr><td align="center" valign="middle" >2007</td><td align="center" valign="middle" >166,140.77</td><td align="center" valign="middle" >175,004.5</td><td align="center" valign="middle" >5.34%</td><td align="center" valign="middle" >168,988</td><td align="center" valign="middle" >1.71%</td></tr><tr><td align="center" valign="middle" >2008</td><td align="center" valign="middle" >169,104.1</td><td align="center" valign="middle" >169,510.0</td><td align="center" valign="middle" >0.24%</td><td align="center" valign="middle" >170,427</td><td align="center" valign="middle" >0.78%</td></tr><tr><td align="center" valign="middle" >2009</td><td align="center" valign="middle" >165,583.6</td><td align="center" valign="middle" >156,828.0</td><td align="center" valign="middle" >5.29%</td><td align="center" valign="middle" >161,529</td><td align="center" valign="middle" >2.45%</td></tr><tr><td align="center" valign="middle" >2010</td><td align="center" valign="middle" >161,156</td><td align="center" valign="middle" >147,968.1</td><td align="center" valign="middle" >8.18%</td><td align="center" valign="middle" >151,844</td><td align="center" valign="middle" >5.78%</td></tr><tr><td align="center" valign="middle" >2011</td><td align="center" valign="middle" >157,188</td><td align="center" valign="middle" >149,342.4</td><td align="center" valign="middle" >4.99%</td><td align="center" valign="middle" >151,071</td><td align="center" valign="middle" >3.89%</td></tr><tr><td align="center" valign="middle" >2012</td><td align="center" valign="middle" >149,602</td><td align="center" valign="middle" >165,619.0</td><td align="center" valign="middle" >10.71%</td><td align="center" valign="middle" >155,734</td><td align="center" valign="middle" >4.10%</td></tr></tbody></table></table-wrap><p>表2. 潍坊市历年用水量与模型模拟值</p><p>了分析，基于梯度法，提出了具有较高预测精度的GM(1,1)模型，在不考虑其他变量对系统建模的影响下，本模型仅对潍坊市用水量系统中的数据进行处理，结果表明，利用该方法对研究区用水量进行预测，不仅所需样本少、原理简单、运算方便，而且能够有效地提高模拟精度，修正之后的GM(1,1)模型是一种计算城市用水量行之有效的方法。</p></sec><sec id="s8"><title>文章引用</title><p>任玉忠,仇 强. 改进GM(1,1)模型在城市用水量预测中的应用Application of Improved GM(1,1) in Forecasting City Water Demand[J]. 可持续发展, 2018, 08(01): 19-23. http://dx.doi.org/10.12677/SD.2018.81003</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.23421-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">徐洪福, 袁一星, 赵洪宾. 灰色预测模型在年用水量预测中的应用[J]. 哈尔滨建筑大学学报, 2001, 34(4): 61-64.</mixed-citation></ref><ref id="hanspub.23421-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">何文杰, 王季震, 赵洪宾, 等. 天津市城市用水量模拟方法的研究[J]. 中国给水排水, 2001, 27(10): 43-44.</mixed-citation></ref><ref id="hanspub.23421-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Bu Hamra, S., Smaoui, N. and Gabr, M. (2003) The Box-Jenkins Analysis and Neural Networks: Predic-tion and Time Series Modeling. Applied Mathematical Modeling, 27, 805-815.</mixed-citation></ref><ref id="hanspub.23421-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Zhou, S.L., Me Mahon, T.A. and Ton, A., et al. (2002) Forecasting Operational Demand for an Urban Water Supply Zone. Journal of Hydrology, 259, 189-202.</mixed-citation></ref><ref id="hanspub.23421-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">张雅君, 刘全胜. 城市需水量灰色预测的探讨[J]. 中国给水排水, 2002, 18(3): 80-81.</mixed-citation></ref><ref id="hanspub.23421-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">田一梅, 汪泳, 迟海燕. 偏最小二乘与灰色模型组合预测城市生活需水量[J]. 天津大学学报, 2004, 37(4): 322-325.</mixed-citation></ref><ref id="hanspub.23421-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Zhang, G.P. (2003) Time Series Forecasting Using a Hybrid ARIMA and Neural Network Model. Neurocomputing, 50, 159-175.</mixed-citation></ref><ref id="hanspub.23421-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">郑爽英. 城市供水量的预测模型研究[J]. 成都科技大学学报, 1995, 87(6): 19-26.</mixed-citation></ref><ref id="hanspub.23421-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">张大海, 江世芳, 史开泉. 灰色预测公式的理论缺陷及改进[J]. 系统工程理论与实践, 2002, 22(8): 1-3.</mixed-citation></ref></ref-list></back></article>