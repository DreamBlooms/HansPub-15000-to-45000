<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2017.711119</article-id><article-id pub-id-type="publisher-id">CSA-22761</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20171100000_12565982.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  一种改进的分形图像编码方法
  An Improved Fractal Image Coding Method
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>齐</surname><given-names>凌云</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>四川大学计算机学院，四川 成都</addr-line></aff><author-notes><corresp id="cor1">* E-mail:</corresp></author-notes><pub-date pub-type="epub"><day>23</day><month>11</month><year>2017</year></pub-date><volume>07</volume><issue>11</issue><fpage>1052</fpage><lpage>1058</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   传统图像编码方法一般已成定式，发展潜力不大。分形图像编码方法思想新颖，是极具发展潜力的压缩方法，但分形编码存在编码耗时过长的缺点。本文基于分形编码思想，从编码时间、压缩比以及解压效果三个方面对Jacquin基本分形编码方法进行研究和改进，提出一种改进的分形图像编码方法。通过对多幅图像进行实验，本文的改进方法在图像压缩时间、压缩比以及峰值信噪比PSNR值上均有提高。 The traditional image coding method has become the general format; development potential is not great. The method of fractal image coding compression method is a novel idea; it has great potential for development. Based on the theory of fractal coding and from coding time, compression ratio and the decompression effect three aspects, we make research and improvement on Jacquin’s basic fractal coding method, and propose an improved fractal image coding method. Experimental results show that compared to the Jacquin’s basic fractal coding method, the method in this paper is improved on the image compression time, compression ratio and peak signal to noise ratio.
    
  
 
</p></abstract><kwd-group><kwd>分形图像编码，压缩比，解压效果, Fractal Image Coding</kwd><kwd> Compression Ratio</kwd><kwd> Decompression Effect</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>一种改进的分形图像编码方法<sup> </sup></title><p>齐凌云</p><p>四川大学计算机学院，四川 成都</p><p>收稿日期：2017年11月3日；录用日期：2017年11月16日；发布日期：2017年11月23日</p><disp-formula id="hanspub.22761-formula33"><graphic xlink:href="//html.hanspub.org/file/2-1540871x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>传统图像编码方法一般已成定式，发展潜力不大。分形图像编码方法思想新颖，是极具发展潜力的压缩方法，但分形编码存在编码耗时过长的缺点。本文基于分形编码思想，从编码时间、压缩比以及解压效果三个方面对Jacquin基本分形编码方法进行研究和改进，提出一种改进的分形图像编码方法。通过对多幅图像进行实验，本文的改进方法在图像压缩时间、压缩比以及峰值信噪比PSNR值上均有提高。</p><p>关键词 :分形图像编码，压缩比，解压效果</p><disp-formula id="hanspub.22761-formula34"><graphic xlink:href="//html.hanspub.org/file/2-1540871x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by author and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-1540871x7_hanspub.png" /> <img src="//html.hanspub.org/file/2-1540871x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>多媒体的发展离不开图像技术的发展。图像中含有的大量信息使得图像具有大的尺寸，但是图像传输却需要图像具有小尺寸。因此若没有一个高效的图像编码方法，将不可能实现图像的传输。</p><p>传统的图像压缩算法大多是通过去除冗余信息，保留高频信息来实现图像压缩，一般已成定式，发展潜力不大。分形编码技术 [<xref ref-type="bibr" rid="hanspub.22761-ref1">1</xref>] 利用图像局部与整体的自相似性或自仿射性，找到合适的迭代因子作为分形码，来实现图像压缩。相较直接存储图像数据的压缩方法，分形编码存储图像块间仿射变换参数使得图像具有较高的压缩比。但是分形编码的计算复杂性使得编码时间很长，这使得分形编码不能满足实时性要求。其编码时间主要耗费在对每个值域块要在大量虚拟码本中寻找其最佳匹配块上。</p><p>本文提出一种改进的分形图像编码方法。在编码方面，不再对基本分形编码方法中定义域块进行8种变换，以此来加快编码时间。在解压效果方面，通过加上额外的误差信息作为编码结果来提升解码效果。误差信息同样是很庞大的数据。误差存储数量的多少、所存误差是否是重要信息都会影响到图像的解压效果。在保证高压缩比以及较好的图像解码质量的前提下，如何选取误差进行存储，成为研究实验中的重点。本文通过运用统计分类思想，对误差进行分区并将其映射到指定数值模型上。之后将处理后的误差按照高频和低频信息两部分进行存储，来实现改善解压图像质量的目的。</p></sec><sec id="s4"><title>2. 基本分形编码方法</title><p>上世纪80年代，Mandelbrot在图像分析领域最先提出了分形理论和分形几何 [<xref ref-type="bibr" rid="hanspub.22761-ref2">2</xref>] 。分形几何认为自然界的事物具有自相似的层次结构，事物的局部和整体具有自相似性。它的出现使得人们用另一种眼光来看待世界。</p><p>1981年，J.E.Hutchinson将迭代函数理论(Iterated Function Theory)引入分形理论中 [<xref ref-type="bibr" rid="hanspub.22761-ref3">3</xref>] 。1989年，Barnsley最先将分形理论运用在图像压缩上，提出了基于迭代函数系统(IFS，即Iterated Function System)的分形图像压缩方法，并对特定的几幅图像实现了高达10,000:1的压缩比 [<xref ref-type="bibr" rid="hanspub.22761-ref4">4</xref>] 。该方法从图像的结构和人眼的视觉角度对图像进行压缩，打破了传统的熵压缩方法的理论极限，受到人们的高度关注，成为国内外学者的研究热点 [<xref ref-type="bibr" rid="hanspub.22761-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.22761-ref6">6</xref>] 。但是该方法中的图像分割需要专业的人员进行人机交互操作，不能自动实现。</p><p>1990年，Barnsley的学生Jacquin发表博士论文，第一次提出局部函数迭代系统 [<xref ref-type="bibr" rid="hanspub.22761-ref7">7</xref>] (LIFS，即Local Iterated Function system)，实现了第一个具有实际意义的全自动分形编码方法。该方法是基于图像块的压缩方法，使用局部块的仿射变换表示全局的仿射变换。Jacquin基本分形编码方法将待压缩图像分割成多个值域块和定义域块。对每个定义域块进行四邻域像素平均算法收缩为值域块大小，并通过8种变换(包括4个旋转，4个反射)形成8个子块，所有的这些子块就组成码本或虚拟码书。然后对每个值域块在虚拟码本中寻找其最佳匹配块。编码后的分形码包括5个参数，分别是对比度调节s、亮度偏移量o、位置参数y、x以及变换参数m。其解码是用迭代因子作用于任何初始图像迭代形成解压图像。</p><p>虽然Jacquin提出的自动分形编码方法具有思想新颖、解码方法简单又快速、解码质量与分辨率无关等优点。但也存在许多问题，例如编码计算量大、编码时间过长、压缩比不够高、解码图像存在块效应等诸多问题。后期的研究大多是在Jacquin分形图像压缩算法的基础上进行改进研究 [<xref ref-type="bibr" rid="hanspub.22761-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.22761-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.22761-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.22761-ref11">11</xref>] 。</p></sec><sec id="s5"><title>3. 改进的分形编码方法</title><p>因为分形编码本身是失真的，因此以一定图像质量的损失为代价换取编码时间加快的做法成为快速分形编码研究的主流。基本分形编码方法中的8种变换使得虚拟码本数量很大，所以本文中的方法不再对定义域块进行8种变换，以此来缩短编码时间。但为了保证图像解压效果，本文方法会附加额外的误差信息作为编码结果。误差信息量同样很庞大，实验发现很多误差值很小，其对人眼视觉影响较小，可以忽略不进行存储。本文运用统计分类思想，对误差进行分区并将其映射到指定数值模型上。对映射处理后的误差进行存储，实现改善解压图像质量的目的。同时为了提高压缩比，本文对编码数据采用固定比特数的方式来存储。</p><sec id="s5_1"><title>3.1. 编码方法</title><p>改进的编码方法的具体算法步骤如下：</p><p>1、设输入图像I，图像大小为N &#215; N。将图像I分割成互不相交的B &#215; B大小的值域块R<sub>i</sub>，且所有值域块的并集为原图像。即分割满足公式(1)。</p><p>I = ∪ i = 1 N / B &#215; N / B R i ，且 R i ∩ R j = Φ ( i ≠ j ) (1)</p><p>2、将图像I分割成可以相交的F &#215; F大小的定义域块D<sub>i</sub>，其中F = 2 &#215; B。然后对每个定义域D块进行4邻域像素均值算法收缩为B &#215; B大小的像素块，这些像素块组成“虚拟码本”。</p><p>3、在虚拟码本内，对每个值域块R<sub>i</sub>寻找其最佳匹配块D<sub>best</sub>，使得块R<sub>i</sub>可由最佳匹配块D<sub>best</sub>通过亮度变换来近似，即有 R i ≈ s ⋅ D b e s t + o ⋅ 1 ，其中1是亮度值均为1的常值块，s代表对比度收缩因子，o代表亮度偏移量。最佳匹配块D<sub>best</sub>的寻找需满足公式(2)，即满足R<sub>i</sub>与D<sub>best</sub>的仿射变换间的差异最小。公式(2)也可表示为公式(3)，其中 E ( R , D ) 表示最小平方误差。公式(3)是关于s、o的二元多项式的最小值问题，由最小二乘法可以得到s、o的值。最后将仿射变换参数s，o以及最佳匹配块的位置参数dx，dy记录在矩阵中，即完成对一个值域块的编码。遍历图像中所有值域块，完成图像编码。</p><p>min j { min s , o ∈ R ‖ R i − ( s ⋅ D j + o ⋅ 1 ) ‖ } = min s , o ∈ R R i − ( s i ⋅ D b e s t + o i ⋅ E ) (2)</p><p>E ( R , D ) = min s , o ∈ R ‖ R − ( s ⋅ D + o ⋅ 1 ) ‖ 2 (3)</p><p>4、使用基本分形解压算法得到解压图像 I ′ ，并计算误差 Δ = I − I ′ 。对误差值按递增的顺序进行排序，形成一个数列，并计算该数列的上四分位数Qu、中位数Qm、下四分位数Ql、上限 Max = Q u + 1.5 ( Q u − Q l ) 、下限 Min = max { 0 ,   Q l − 1.5 ( Q u − Q l ) } 以及误差绝对值的最大值M。其中上四分位数Qu为居于数列四分之一位置处的误差数据值，中位数Qm为居于数列中间位置处的误差数据值，下四分位数Ql为居于数列四分之三位置处的误差数据值。</p><p>5、对误差值进行区域划分并进行映射。运用分类统计思想，我们对误差进行区域划分。将绝对值处在 { 0 ,   Max } 间的误差值映射为0，不进行存储。绝对值在 { Max ,   + ∞ } 间的误差分为14个区域，并映射到数字1至14，这样只用4 bit即可将误差值保存，其中用奇数值表示正值误差，偶数值表示负值误差。又因为要将同一区域内的所有点视为相同类型点，并以该区域均值代替区域内所有误差点的值，故为了保证解压图像的PSNR值，区域间隔的选取很重要，不能过大。本文区域间隔S的取值计算方法为 S = ( M − Max ) / 7 。因此， { Max + S &#215; ( i − 1 ) ,   Max + S &#215; i } 区域误差映射为数字 2 &#215; i − 1 ( i = 1 ~ 6 ) 。 { − Max − S &#215; i ,   − Max − S &#215; ( i − 1 ) } 区域误差映射为数字 2 &#215; i − 1 ( i = 1 ~ 6 ) 。 { Max + S &#215; 6 ,   + ∞ } 区域误差映射为数字13， { − ∞ ,   − Max − S &#215; 6 } 区域误差映射为数字14。求每个区域的误差均值，设为 m e a n i ，其中 i = 1 ~ 14 。将映射关系(i, m e a n i )存入编码文件中。</p><p>6、对误差进行存储。误差的存储分为两部分。一部分是高频信息存储，选择误差最大值存储。另一部分是低频信息存储，将误差图像分为2 &#215; 2的矩阵，对矩阵中值小于4的所有误差点求均值，并以2 bit进行存储。最后将编码数据以.mat文件输出。</p></sec><sec id="s5_2"><title>3.2. 解码方法</title><p>解码的具体算法步骤如下：</p><p>1、输入编码文件F。读取编码信息并计算出原图像尺寸。</p><p>2、定义原图像大小的单位矩阵作为初始图像，设为H。同压缩过程一样将图像分割成相同大小的值域块。对于每个值域块R<sub>i</sub>依据编码数据中的位置信息找到相应的最佳匹配块 D b e s t ，对 D b e s t 块进行4邻域像素均值收缩算法和仿射变换操作，最后将结果赋值给该R<sub>i</sub>块。对所有值域块R操作完成后，经过拼贴就完成了图像的一次迭代，设此时图像为 H ′ 。</p><p>3、判断是否达到预先设定的迭代次数，若已经达到预先设定的迭代次数，则执行步骤4，否则就以图像 H ′ 作为初始图像，再次执行步骤2来继续完成图像迭代。本文中设定的迭代次数为6。迭代次数的设定选择要综合考虑解压效果和解压时间两个因素。通过对多幅图像进行不同迭代次数选择的实验，发现迭代次数达到6时，对图像的解压效果不再有明显的增强效果。</p><p>4、提取编码中存储的误差信息以及误差映射信息。依据压缩方法中误差存储的规则，反向得出误差信息。再将误差加入图像 H ′ 中，完成解码。最后输出解压图像 H ′ 。</p></sec></sec><sec id="s6"><title>4. 仿真实验结果</title><p>实验采用Windows 7、MatlabR2012b开发环境。实验中使用的图像大小均为256 &#215; 256。依据本文提出的算法对多幅图像进行实验，算法设定的值域块R大小为8 &#215; 8，定义域块D大小为16 &#215; 16。解码时图像的迭代次数为6。</p><p>另外，我们采用PSNR(Peak Signal to Noise Ratio)峰值信噪比值对解码图像的质量进行评价，其中PSNR的计算公式见式(4)和式(5)。PSNR描述了原图和被处理后图像之前的均方误差相对于信号最大值平方的对数值，是一种评价图像的客观标准。设原始灰度图像为 I = f ( i , j ) ，解压后图像为 I ′ = f ′ ( i , j ) ，均方误差为MSE，其中 i = 1 , 2 , ⋯ , Y ； j = 1 , 2 , ⋯ , X 。</p><p>MSE = 1 Y X ∑ 1 Y ∑ 1 X ( f ′ ( i , j ) − f ( i , j ) ) 2 (4)</p><p>PSNR = 10 log 255 2 MSE (5)</p>实验结果和分析<p>实验中选取了大量图片进行测试，下面选取其中3幅图像进行说明。原图如图1、图2、图3所示。</p><p>分别使用本文中的编码方法和Jacquin基本分形编码方法对上述3幅图像进行编码、解码操作。解码的最终效果如图4、图5、图6所示。其中图(a)表示使用本文方法的解压图像，图(b)表示使用基本分形编码方法的解压图像。</p><p>从图4、图5、图6的解压图像效果可以看出，相较基本分形编码方法，本文压缩方法的解压效果更好，人眼视觉效果更好，有更丰富的细节体现。此外还对两种压缩方法的编码时间、压缩比以及解压图</p><p>图1. Lena图</p><p>图2. Bird图</p><p>图3. Fruits图</p><p>像的PSNR值进行计算和比较，结果见表1。</p><p>从表1可以看出，相比基本分形编码方法，本文压缩方法在图像编码时间、压缩比和图像PSNR上均有提高，这说明本文提出的改进的分形图像编码方法是有效的。</p><p>图4. 使用本文方法和基本分形方法的lena图解压效果</p><p>图5. 使用本文方法和基本分形方法的bird图解压效果</p><p>图6. 使用本文方法和基本分形方法的fruits图解压效果</p>

<table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Experimental results using the improved coding method and the basic fractal coding metho</title></caption>
</table-wrap>
</sec>
</body>


<back><ref-list><title>References</title><ref id="hanspub.22761-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Wikipedia Fractal Compression. &lt;br&gt;https://en.wikipedia.org/wiki/Fractal_compression#cite_ref-18</mixed-citation></ref><ref id="hanspub.22761-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Mandelbrot (1982) The Fractal Geometry of Nature. Freeman W H, Mandelbrot, 466.</mixed-citation></ref><ref id="hanspub.22761-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Hutchinson, J.E. (1981) Fractals and Self-Similarity. Indiana University Mathematics Journal, 3, 713-747.  
&lt;br&gt;https://doi.org/10.1512/iumj.1981.30.30055</mixed-citation></ref><ref id="hanspub.22761-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Barnsley, M.F. (1988) A Better Way to Compress Image. Byte Magazine, 1, 215-223.</mixed-citation></ref><ref id="hanspub.22761-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Cabrelli, C.A., Falsetti, M.C. and Molter, U.M. (2002) Fractal Block-Coding: A Functional Approach for Image and Signal Processing. Computers and Mathematics with Applications, 44, 1183-1200.  
&lt;br&gt;https://doi.org/10.1016/S0898-1221(02)00225-0</mixed-citation></ref><ref id="hanspub.22761-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Kima, T., Van Dyck, R.E. and Miller, D.J. (2002) Hybrid Fractal Zero Tree Wavelet Image Coding. Signal Processing: Image Communication, 17, 347-360. &lt;br&gt;https://doi.org/10.1016/S0923-5965(02)00003-6</mixed-citation></ref><ref id="hanspub.22761-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Jacquin, A.E. (1992) Image Coding Based on a Fractal Theory of Iterated Contractive Image Transformations. IEEE Trans ImageProcess, 1, 18-30. &lt;br&gt;https://doi.org/10.1109/83.128028</mixed-citation></ref><ref id="hanspub.22761-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">王惠溧. 基于三角形分割的分形图像压缩算法[J]. 科技向导, 2013(36): 278.</mixed-citation></ref><ref id="hanspub.22761-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Tan, T. and Yan, H. (2002) The Fractal Neighbor Distance Measure. Pattern Recognition, 35, 1371-1387.</mixed-citation></ref><ref id="hanspub.22761-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">蔡芳, 徐乃平, 孙隆和. 快速分形图像压缩算法[J]. 西北工业大学学报, 1999, 17(3): 355-359.</mixed-citation></ref><ref id="hanspub.22761-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">陈家琪, 唐元刚. 小波与分形混合图像压缩编码[J]. 计算机与信息技术, 2007(35): 272-274.</mixed-citation></ref></ref-list></back></article>