<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2020.105109</article-id><article-id pub-id-type="publisher-id">CSA-35805</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20200500000_20767263.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  一种基于图像分层的红外图像目标细节增强算法
  Infrared Image Target Detail Enhancement Algorithm Based on Image Hierarchical Processing
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>贺</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>野</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>付</surname><given-names>明艳</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>63850部队，吉林 白城</addr-line></aff><aff id="aff2"><addr-line>长春理工大学，吉林 长春</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>29</day><month>04</month><year>2020</year></pub-date><volume>10</volume><issue>05</issue><fpage>1051</fpage><lpage>1056</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   为了解决高动态红外成像系统在使用传统图像压缩方法过程中产生的图像整体对比度低，目标细节的流失模糊等问题，提出了一种基于图像分层的红外图像微弱目标细节增强的算法，并从算法理论研究与仿真结果两方面入手，验证了其对目标细节的增强效果优于传统方法。该方法利用双边滤波完成图像的平滑及分层操作。采用灰度线性变换完成对背景层图像的压缩，利用自适应增益放大细节层的同时抑制噪声，线性叠加压缩后的背景层和放大后的细节层，得到目标细节增强后的8位红外图像。 In order to solve the problems of low image overall contrast and blurring of target details caused by high-dynamic infrared imaging systems using traditional image compression methods, a kind of infrared image weak target detail enhancement algorithm based on the hierarchical processing is proposed, this study has verified that the target detail enhancement effect is superior to the traditional method using theoretical research and simulation results of algorithm. The method uses bilateral filtering to smooth and layer the image, linear superposition, the background layer after compression and the detail layer after magnification can obtain the 8-bit infrared image after the target detail enhancement. 
  
 
</p></abstract><kwd-group><kwd>红外图像，双边滤波，自适应增益, Infrared Image</kwd><kwd> Bilateral Filter</kwd><kwd> Self-Adaptive Enhancement</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>一种基于图像分层的红外图像目标细节 增强算法<sup> </sup></title><p>王贺<sup>1*</sup>，李野<sup>1</sup>，付明艳<sup>2</sup></p><p><sup>1</sup>长春理工大学，吉林 长春</p><p><sup>2</sup>63850部队，吉林 白城</p><p>收稿日期：2020年5月6日；录用日期：2020年5月21日；发布日期：2020年5月28日</p><disp-formula id="hanspub.35805-formula35"><graphic xlink:href="//html.hanspub.org/file/26-1541685x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为了解决高动态红外成像系统在使用传统图像压缩方法过程中产生的图像整体对比度低，目标细节的流失模糊等问题，提出了一种基于图像分层的红外图像微弱目标细节增强的算法，并从算法理论研究与仿真结果两方面入手，验证了其对目标细节的增强效果优于传统方法。该方法利用双边滤波完成图像的平滑及分层操作。采用灰度线性变换完成对背景层图像的压缩，利用自适应增益放大细节层的同时抑制噪声，线性叠加压缩后的背景层和放大后的细节层，得到目标细节增强后的8位红外图像。</p><p>关键词 :红外图像，双边滤波，自适应增益</p><disp-formula id="hanspub.35805-formula36"><graphic xlink:href="//html.hanspub.org/file/26-1541685x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/26-1541685x8_hanspub.png" /> <img src="//html.hanspub.org/file/26-1541685x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>当下，高性能红外成像系统普遍都采用14 bits或者更高的A/D对红外焦平面探测器输出的信号进行采样及量化，从而得到高动态范围(High Dynamic Range，HDR)的红外图像数据 [<xref ref-type="bibr" rid="hanspub.35805-ref1">1</xref>]。而对于一般的显示设备来说，能显示的灰度范围仅为0到256级，因此，我们需要对高动态范围的红外图像进行动态压缩及增强。常见的高动态图像压缩及增强算法主要有直方图均衡、基于自增益的线性映射和Gamma映射等方法 [<xref ref-type="bibr" rid="hanspub.35805-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.35805-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.35805-ref4">4</xref>]。这类方法是在原始图像和目标图像之间寻找一个映射关系，虽然实现起来复杂度低、比较简单，但是会造成图像的灰度等级增强过度、增大图像中原有的噪声以及某些弱小目标细节信息丢失等问题。</p><p>近些年来，通过美国FLIR开发的数字细节增强(Digital Detail Enhancement, DDE)方法 [<xref ref-type="bibr" rid="hanspub.35805-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.35805-ref6">6</xref>]，基于图像分层的高动态目标细节增强方法被提出并且得到相应的发展。该方法的基本原理是采用平滑滤波器将原始高动态范围图像分解成背景层与细节层；背景图像主要包含对比度大、灰度变化明显的基本信息，细节图像主要包含对比度小、灰度变化较弱的细节信息；接下来对背景层和细节层分别进行动态范围压缩和细节增强处理；最后将处理后的背景层与细节层图像融合为一幅图像，从而达到增强图像中细节信息的目的。基于此，本文提出一种基于双边滤波的图像压缩与目标细节增强算法，首先通过双边滤波得到背景层与细节层图像，然后采用灰度线性变换压缩背景层图像的灰度等级，接下来利用自适应增强算法，在增强细节层图像中目标细节的同时抑制噪声的放大，最终将两幅图像融合在一起，得到目标细节增强的红外图像。</p></sec><sec id="s4"><title>2. 基于双边滤波的高动态图像增强算法</title><sec id="s4_1"><title>2.1. 双边滤波的定义</title><p>双边滤波器是以经典高斯滤波器为基础的一种非线性滤波器，它是由两个函数构成的；一个是与空间距离相关的空间滤波函数，另外一个是与像素强度相关的灰度滤波函数 [<xref ref-type="bibr" rid="hanspub.35805-ref7">7</xref>]。在二者的共同作用下，该滤波器可以较好的在抑制图像噪声的同时保留图像边缘特征。对输入的高动态红外图像进行双边滤波处理，得到的结果如下：</p><p>{ f B F ( i , j ) = 1 k ( i , j ) ∑ ( m , n ) ∈ w i , j G s ( i − m , j − n ) &#215; G r [ f I N ( i , j ) − f I N ( m , n ) ] &#215; f I N ( m , n ) f D ( i , j ) = f I N ( i , j ) − f B F ( i , j ) (1)</p><p>式中， f B F 表示经过双边滤波处理后得到的背景层图像， f I N 表示输入的原始图像， f D 表示原始图像与背景层图像相减得到的细节层图像。 ( m , n ) ∈ w i , j 表示像素点 ( m , n ) 是以 ( i , j ) 为中心像素的窗口 w i , j 的相邻像素， k ( i , j ) 为归一化系数：</p><p>k ( i , j ) = ∑ ( m , n ) ∈ w i , j G s ( i − m , j − n ) &#215; G r [ f I N ( i , j ) − f I N ( m , n ) ] (2)</p><p>式中， G s 和 G r 都是标准的高斯函数，它们的定义式如下：</p><p>G s ( i − m , j − n ) = exp [ − ( i − m ) 2 + ( j − n ) 2 2 σ s 2 ] (3)</p><p>G r [ f I N ( i , j ) − f I N ( m , n ) ] = exp [ − [ f I N ( i , j ) − f I N ( m , n ) ] 2 2 σ r 2 ] (4)</p><p>式中， G s 表示为空间域的高斯滤波函数， G r 表示为强度域的高斯滤波函数。函数 σ s 与 σ r 表示为两个高斯核函数的标准差参量，控制两个高斯核函数的扩张范围。</p></sec><sec id="s4_2"><title>2.2. 背景层的灰度线性变换</title><p>完成图像的分层操作后，我们对背景层进行处理。通过双边滤波获取背景层的灰度范围与原始的红外图像几乎一样，因此可以使用比较便捷的灰度线性变换算法，从而完成对背景层的灰度压缩变换，得到8 bit的背景层图像。通过观察背景层直方图像素灰度统计可以看出，在接近0级与16,383级这两边的像素几乎不存在，而是主要集中在中间的大部分区间中，只有少量的像素分布在此灰度级范围的之外的两端。所以在进行灰度线性压缩变换的时候，我们可以去掉图像中的灰度峰值，忽略存在区间之外两端的少量像素，从而对存在大部分像素的中间区域进行变换：</p><p>f o u t ( x , y ) = { 0 　 　 　 　 　 　 　 　 　 f B F ( x , y ) ≤ min 255 &#215; f B F ( x , y ) − min max − min 　 　 min &lt; f B F ( x , y ) &lt; max 255 　 　 　 　 　 　 　 　 f B F ( x , y ) ≥ max (5)</p><p>式中， f o u t ( x , y ) 为压缩后得到的背景层图像；假设用 f min 、 f max 分别表示未经压缩前的背景层图像灰度分布的最小值与最大值，min、max分别表示截掉一定比例后，中间区域灰度级的最小值与最大值，min和max值可以根据特定红外图像的灰度分布进行调整。</p><p>通过观察图1我们可以看出，即使纵坐标区间的变换范围从[a,b]变化到[0,255]会导致图像的少部分信息丢失，也不会对最终合成的图像产生多大的影响，这是因为那些表示小目标的有效信息已经被分离到了细节层。所以，相比较于全局范围内的线性变换，这种截取式的局部线性变换会使得大部分的像素灰度层次得到增强。</p><p>图1. 截取式灰度线性变换示意图</p><p>在对细节层进行处理时不能直接对图像进行放大，这是因为细节层图像不仅包含微小的目标细节，同时还包含了一部分噪声，如果直接对图像进行放大的话噪声也会随之被放大。通过相关研究可知，人眼对均匀区域噪声的敏感程度是要高于复杂区域的，这会对图像的视觉效果产生较大的影响。基于此，Anderson [<xref ref-type="bibr" rid="hanspub.35805-ref8">8</xref>] 等人提出了一种噪声模板的可见性函数，表达式如下：</p><p>f ( i , j ) = 1 M ( i , j ) ⋅ θ + 1 (6)</p><p>式中， θ 为可调参量，取值范围 [ 0 , 1 ] ， M ( i , j ) 表示图像的噪声模板函数。从上式可以知道，噪声模板函数与噪声可见度函数成反比例关系， M ( i , j ) 越大，表示图像中该区域灰度变化明显，则 f ( i , j ) 越小；反之， M ( i , j ) 越小，表示图像中该区域比较平缓，则 f ( i , j ) 越大。因此，使用自适应增强算法完成对细节层图像的处理。该算法可以根据图像中不同区域的信息自动调整其增益系数，相对放大图像中细节丰富的区域，较小的放大图像中平坦的区域。这样，就可以做到既增强目标细节，又能够比较好的抑制噪声的放大。自适应增强函数为：</p><p>g ( i , j ) = g min + [ 1 − f ( i , j ) ] &#215; ( g max − g min ) (7)</p><p>式中， g min 为图像中对应像素点的最低增益值，在噪声可见度函数趋近于1时取得； g max 为图像中对应像素点的最高增益值，在噪声可见度函数趋近于0时取得。为满足图像目标细节信息不被抑制的同时又要防止目标信息过度增强，因此，最低增益值通常选取为1，，最高增益值通常选取为2.5。由于双边滤波的归一化系数 k ( i , j ) 可以很好的表现出图像的灰度特征分布，所以使用 [ k ( i , j ) ] − 1 作为噪声模板函数。则最终的自适应增强函数为：</p><p>g ( i , j ) = g min + [ 1 − k ( i , j ) ] &#215; ( g max − g min ) (8)</p></sec><sec id="s4_3"><title>2.3. 图像融合</title><p>在完成对背景层图像与细节层图像相应的处理之后，我们采用线性加权合成法 [<xref ref-type="bibr" rid="hanspub.35805-ref9">9</xref>]，将包含与原始红外图像相似背景信息的8 bit背景层图像以及包含关键目标细节信息的8 bit细节层图像融合成一幅图像，从而达到更佳的视觉感知效果。</p><p>线性加权合成函数的表达式如下：</p><p>f finall ( i , j ) = β ⋅ f detail ( i , j ) + ( 1 − β ) ⋅ f out ( i , j ) (9)</p><p>其中， f finall ( i , j ) 为最终得到图像， f detail ( i , j ) 为增强后的细节层图像， f out ( i , j ) 为动态压缩后的背景层图像， β 为细节层所占的权重。 β 取值的过高或者过低都达不到目标细节增强的效果，所以通常情况下 β ∈ [ 0.3 , 0.5 ] 。</p><p>综上，本文基于双边滤波的红外图像目标细节增强算法可以用图2表示：</p><p>图2. 本文算法处理流程图</p></sec></sec><sec id="s5"><title>3. 实验结果与分析</title><p>图3表示的a，b分别表示经过自动控制增益及本文算法处理后的结果，可以看出采用自动控制增益法虽然使图像整体均匀了一些，但漏气云团信息被大幅度削弱，图像整体对比度一般；而本文算法不仅使得图像对比度得到提升，同时漏气云团得到了较明显增强。</p><p>图4的c，d分别展示了采用本文算法增强红外图像过程中背景图像和细节图像数据的压缩增强显示结果。</p><p>图3. 两种处理方法结果对比</p><p>图4. 背景层与细节层图像数据压缩结果</p><p>如表1，通过信息熵来看，本文算法的信息熵大于AGC算法，处理后的图像目标细节丰富并且突出，包含的信息量大；从标准来看也是如此，本文算法能够较好的保留图像细节信息，对比度信息同样有所改善。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Information entropy and standard deviation of different algorithm</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >算法</th><th align="center" valign="middle" >信息熵</th><th align="center" valign="middle" >标准差</th></tr></thead><tr><td align="center" valign="middle" >AGC</td><td align="center" valign="middle" >3.5143</td><td align="center" valign="middle" >24.2523</td></tr><tr><td align="center" valign="middle" >本文算法</td><td align="center" valign="middle" >6.2774</td><td align="center" valign="middle" >41.2473</td></tr></tbody></table></table-wrap><p>表1. 不同算法的信息熵与标准差</p></sec><sec id="s6"><title>4. 结束语</title><p>针对高动态红外成像系统使用传统图像压缩方法而造成的图像整体对比度低，目标细节的流失模糊等问题，提出了一种基于图像分层的红外图像在动态压缩中增强微弱目标细节的算法，并从算法理论研究与仿真结果两方面入手，验证了其对目标细节的增强效果优于传统方法。本方法利用双边滤波完成图像的平滑及分层操作，双边滤波器不但可以较好地抑制图像噪声，而且能够保留图像边缘特征，进而消除了采用一般滤波方法产生的“光晕”现象。使用灰度线性变换法压缩背景层图像的灰度范围，采用自适应增益法放大细节层的目标细节，同时减小噪声对图像的影响。</p></sec><sec id="s7"><title>文章引用</title><p>王 贺,李 野,付明艳. 一种基于图像分层的红外图像目标细节增强算法Infrared Image Target Detail Enhancement Algorithm Based on Image Hierarchical Processing[J]. 计算机科学与应用, 2020, 10(05): 1051-1056. https://doi.org/10.12677/CSA.2020.105109</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.35805-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">葛朋, 杨波, 韩庆林, 等. 一种基于引导滤波图像分层的红外图像细节增强算法[J]. 红外技术, 2018, 40(12): 1161.</mixed-citation></ref><ref id="hanspub.35805-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">苏庆旦. 红外热成像系统实现及其图像增强技术研究[D]: [硕士学位论文]. 西安: 西安电子科技大学, 2015.</mixed-citation></ref><ref id="hanspub.35805-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">周永康, 朱尤攀, 曾邦泽, 等. 宽动态红外图像增强算法综述[J]. 激光技术, 2018, 42(5): 718-719.</mixed-citation></ref><ref id="hanspub.35805-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Vickers, V.E. (1996) Plateau Equalization Algorithm for Real-Time Display of High-Quality Infrared Imagery. Optical Engineering, 35, 1921-1926. &lt;br&gt;https://doi.org/10.1117/1.601006</mixed-citation></ref><ref id="hanspub.35805-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Digital Image Detail En-hancement Technique Introductions. http://www.flir.com/</mixed-citation></ref><ref id="hanspub.35805-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">董静. 基于DDE技术分析的红外图像细节增强算法[J]. 光学与光电技术, 2012, 10(5): 51-53.</mixed-citation></ref><ref id="hanspub.35805-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">樊启明. 基于滤波分层的红外图像细节增强算法研究[D]: [硕士学位论文]. 武汉: 华中科技大学, 2017.</mixed-citation></ref><ref id="hanspub.35805-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Zuo, C., Chen, Q., Liu, N., et al. (2011) Display and Detail Enhancement for High-Dynamic-Range Infrared Images. Optical Engineering, 50, 895-900. &lt;br&gt;https://doi.org/10.1117/1.3659698</mixed-citation></ref><ref id="hanspub.35805-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">周欣. 红外图像视觉效果增强技术的研究[D]: [博士学位论文]. 天津: 天津大学, 2009.</mixed-citation></ref></ref-list></back></article>