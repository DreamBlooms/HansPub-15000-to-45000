<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SEA</journal-id><journal-title-group><journal-title>Software Engineering and Applications</journal-title></journal-title-group><issn pub-type="epub">2325-2286</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SEA.2021.102016</article-id><article-id pub-id-type="publisher-id">SEA-41580</article-id><article-categories><subj-group subj-group-type="heading"><subject>SEA20210200000_61017727.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于STM32的单相逆变器并网系统设计与实现
  Design and Implementation of Single-Phase Inverter Grid-Connected System Based on STM32
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>徐</surname><given-names>贵鑫</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>金</surname><given-names>海</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>浙江理工大学信息学院，浙江 杭州</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>07</day><month>04</month><year>2021</year></pub-date><volume>10</volume><issue>02</issue><fpage>138</fpage><lpage>148</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  本设计采用STM32单片机作为主控芯片，采用双极性SPWM调制方法，以单相全桥逆变电路为核心电路，实现双逆变器的并网供电。提出一种新型主从控制方法，通过对主从机不同的SPWM调节速度的控制，实现电流内环电压外环控制。提出了系统软启动以及过流之后重启动的控制思想，保证系统始终处于安全工作状态，并且可以快速响应。通过UART完成两单片机之间通信，实现了从路输出相位跟随主路的目标。利用SPI的通信模式与采样模块相配合，加入系统的PID算法的分段调节，实现了高精度的采样和快速的系统闭环控制。本系统输出电压较为稳定，THD在2%以下，可以实现两逆变器输出电流按比例分配为1:1、1:2、2:1，效率达到90%以上。
   This design adopts STM32 single-chip microcomputer as the main control chip, adopts bipolar SPWM modulation method, and uses single-phase full-bridge inverter circuit as the core circuit to realize grid-connected power supply of dual inverters. A new master-slave control method is pro-posed, which realizes the current inner loop voltage outer loop control by controlling the different SPWM adjustment speeds of the master and slave machines. The control idea of system soft start and restart after overcurrent is proposed to ensure that the system is always in a safe working state and can respond quickly. The communication between the two single-chip microcomputers is completed through UART, and the goal of the output phase of the slave circuit to follow the main circuit is realized. Using the SPI communication mode to cooperate with the sampling module, adding the segmented adjustment of the system’s PID algorithm, realizes high-precision sampling and fast system closed-loop control. The output voltage of this system is relatively stable, and the THD is below 2%, and the output current of the two inverters can be distributed proportionally to 1:1, 1:2, 2:1, and the efficiency reaches more than 90%.
 
</p></abstract><kwd-group><kwd>单相逆变，并联均流，STM32，SPWM，改进的主从控制法，电力电子, Single-Phase Inverter</kwd><kwd> Parallel Current Sharing</kwd><kwd> STM32</kwd><kwd> SPWM</kwd><kwd> Improved Master-Slave Control Method</kwd><kwd> Power Electronics</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>本设计采用STM32单片机作为主控芯片，采用双极性SPWM调制方法，以单相全桥逆变电路为核心电路，实现双逆变器的并网供电。提出一种新型主从控制方法，通过对主从机不同的SPWM调节速度的控制，实现电流内环电压外环控制。提出了系统软启动以及过流之后重启动的控制思想，保证系统始终处于安全工作状态，并且可以快速响应。通过UART完成两单片机之间通信，实现了从路输出相位跟随主路的目标。利用SPI的通信模式与采样模块相配合，加入系统的PID算法的分段调节，实现了高精度的采样和快速的系统闭环控制。本系统输出电压较为稳定，THD在2%以下，可以实现两逆变器输出电流按比例分配为1:1、1:2、2:1，效率达到90%以上。</p></sec><sec id="s2"><title>关键词</title><p>单相逆变，并联均流，STM32，SPWM，改进的主从控制法，电力电子</p></sec><sec id="s3"><title>Design and Implementation of Single-Phase Inverter Grid-Connected System Based on STM32</title><p>Guixin Xu, Hai Jin</p><p>School of Information, Zhejiang Sci-Tech University, Hangzhou Zhejiang</p><p><img src="//html.hanspub.org/file/9-2690510x4_hanspub.png" /></p><p>Received: Mar. 16<sup>th</sup>, 2021; accepted: Apr. 8<sup>th</sup>, 2021; published: Apr. 15<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/9-2690510x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>This design adopts STM32 single-chip microcomputer as the main control chip, adopts bipolar SPWM modulation method, and uses single-phase full-bridge inverter circuit as the core circuit to realize grid-connected power supply of dual inverters. A new master-slave control method is proposed, which realizes the current inner loop voltage outer loop control by controlling the different SPWM adjustment speeds of the master and slave machines. The control idea of system soft start and restart after overcurrent is proposed to ensure that the system is always in a safe working state and can respond quickly. The communication between the two single-chip microcomputers is completed through UART, and the goal of the output phase of the slave circuit to follow the main circuit is realized. Using the SPI communication mode to cooperate with the sampling module, adding the segmented adjustment of the system’s PID algorithm, realizes high-precision sampling and fast system closed-loop control. The output voltage of this system is relatively stable, and the THD is below 2%, and the output current of the two inverters can be distributed proportionally to 1:1, 1:2, 2:1, and the efficiency reaches more than 90%.</p><p>Keywords:Single-Phase Inverter, Parallel Current Sharing, STM32, SPWM, Improved Master-Slave Control Method, Power Electronics</p><disp-formula id="hanspub.41580-formula46"><graphic xlink:href="//html.hanspub.org/file/9-2690510x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/9-2690510x7_hanspub.png" /> <img src="//html.hanspub.org/file/9-2690510x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>新能源的高效利用已经成为能源发展的关键，因此光伏发电系统应运而生，并网逆变器是光伏发电系统安全、可靠、高效率运行的核心，同时也是发电直流端到交流负载端转换的核心技术 [<xref ref-type="bibr" rid="hanspub.41580-ref1">1</xref>]，因此多逆变器并联运行技术成为解决当前实际需求的有效手段之一。并网逆变器是整个系统的核心，并网逆变器的实质就是多个逆变电路进行并联，并且通过合理的控制算法，分配能量的流向和使用。为了满足市场需求，促进经济的发展，采用交流光伏发电系统以取代现行的直流光伏发电系统是不可避免的。目前运用的主从法并联算法大多数都存在着稳定性差的问题，并且对于控制的阐述较为晦涩，硬件设计经验研究较少，而本研究则采用单相全桥逆变电路进行电源并联，使用单片机产生SPWM波控制电路，并对模拟微电网并网策略加以改进，最终实现稳定的单相逆变器并网系统。</p></sec><sec id="s6"><title>2. 逆变器并网系统总体设计</title><p>本系统设计由STM32单片机控制模块、单相全桥逆变电路模块、同步相位模块、IR2103驱动模块、ATT7022采样模块、OLED显示模块组成。输入直流电压30 V，经过两个DC/AC单相全桥逆变电路并联，输出电压有效值为24 V，输出电流有效值最大为3 A [<xref ref-type="bibr" rid="hanspub.41580-ref2">2</xref>]。通过STM32单片机产生双极性SPWM波控制电路的MOS管，利用同步锁相模块实现主从机的相位同步，然后将逆变器并联为负载供电。通过ATT7022采样模块得到主从机的反馈信号，在单片机内部通过PID算法对SPWM波进行调节，以实现最终的并网系统输出电流和电压的调节。利用主机控制输出电压，从机控制输出电流，实现电压外环、电流内环的双闭环控制 [<xref ref-type="bibr" rid="hanspub.41580-ref3">3</xref>]，提高了逆变并网系统的稳定性。经测试，此并网系统可以输出1~3 A的负载线电流，频率为50 &#177; 0.2 Hz，交流母线电压总谐波畸变率远小于2%，且电流可以实现不同比例的分配 [<xref ref-type="bibr" rid="hanspub.41580-ref4">4</xref>]。系统的负载调整率和电压调整率低，总体供电效率平均可达到93.6%，单个逆变器工作时，效率可达91%以上。系统总体设计如图1所示：</p><p>图1. 系统总体设计</p></sec><sec id="s7"><title>3. 逆变器并网系统硬件电路设计</title><sec id="s7_1"><title>3.1. 主控芯片选择</title><p>本设计采用STM32单片机作为核心数字信号处理器，具备标准的ARM结构和高性能、低成本、低功耗的嵌入式应用专门设计的Cortex-M内核，大大提高信号处理效率。STM32F103ZET6有60个中断源，可以满足本系统数量较多的外设器件和控制逻辑，相比于其他单片机而言，它有低能耗、主频高、操作简单、调试方便、稳定性高等优点 [<xref ref-type="bibr" rid="hanspub.41580-ref5">5</xref>]。该单片机自带的UART和SPI通信模块可以满足系统中主从机通信以及交流采样通信的需求，同时自带可编程预分频器的TIMER模块和输入捕捉功能，为本设计的同步操作量身定做，6路PWM输出通道与3个占空比发生器保障了系统的电压总谐波畸变率指标，特有的死区控制设置极大程度避免了上下桥同时导通的情况，与此同时该芯片具备可选择的功耗管理技术，在效率指标上占极大优势。本设计基本将芯片的所有功能全部开发完毕，对于管脚的利用率也比较高，减少了资源浪费。</p></sec><sec id="s7_2"><title>3.2. 驱动电路设计</title><p>驱动电路的意义是赋予SPWM能量，也就是让信号具备了一定的功率，达到MOS管的启动电压，在本设计中采用的是以IR2103芯片为核心的驱动控制电路。该芯片是一个集成了双通道和栅极驱动的高度集成模块，另外这款芯片是高速高压的，恰好可以满足设计的要求，轻松驱动后级的IRF540开关管。这款芯片在MOS管的驱动电路、IFBT的驱动方案中使用十分广泛。在此选用5 V的供电电压，并且在供电端并联1 μF的电解电容，起滤波作用，C2和D1为自举电容和自举二级管，由于后级IRF540的导通电压需要，就必须设计自举电路，输出信号Ho与SPWM信号相同，输出信号Lo与SPWM信号互补。IR2103自举电路如图2所示。</p><p>图2. IR2103自举电路图</p></sec><sec id="s7_3"><title>3.3. 并网系统主电路设计</title><p>本系统主要采用单相全桥逆变电路作为主要电路，单相全桥逆变电路主要实现了直流电压到交流电压的转换。通过单片机产生SPWM波分别控制四个MOS管的开关，进而从输出端输出逆变得到的交流正弦波。本系统的核心电路设计是将两个如图3所示的单相全桥逆变电路并联。本设计对比多种MOS管后决定使用IRF540开关管作为电路的桥臂开关管，该MOS管导通的时候电阻只有44 mΩ，已经基本看成理想的导通状态，允许通过的电流最大可以达到33 A。系统通过四路SPWM控制信号分别控制Q1，Q2，Q3，Q4四个IRF540开关管，在一个周期内，通过能量的不同流动方式，在输出端得到正弦波。通过主机和从机的不同控制方式，进而控制两个逆变电路开关管的导通程度，然后得到不同均流方式并联电流。经过单相全桥逆变电路逆变得到的正弦信号并不纯净，含有较为丰富的高频分量，若想要得到标准的正弦波，必须设计合适的滤波电路，由于要求正弦波的频率是50 Hz，因此使用LC滤波器为逆变器滤波，构成滤波模块。经过综合考量，选用两个4 mH的电感和一个10 μF的CBB电容组成滤波电路。</p><p>图3. 全桥逆变电路图</p></sec><sec id="s7_4"><title>3.4. 同步隔离模块设计</title><p>本模块是实现两路逆变电路并联均流的关键部分，同步隔离模块包括了锁相部分和隔离部分，锁相的目的是使得两路逆变器输出同频同相，隔离的目的是使得单片机能够安全的采集并计算频率和相位。在此设计了过零比较器，采集每一个正弦信号的正负变化，然后通过单片机的输入捕捉模式捕捉上升沿后进行相位跟踪，同步锁相模块原理图如图4所示。其中LM393是双精度电压比较器，设置电压比较器的比较电压为0 V，即设计一个过零比较器，将主机正弦信号接入电压比较器，当信号经过0电位点方向反向时LM393的输出产生一个脉冲信号，由于LM393接入了交流端，因此特别设计了隔离部分。在此选择以6N137超高速光耦来实现隔离效果，该光耦的导通间隔只有60 ns，当LM393的脉冲输出进入6N137的输入端之后，会在其输出端产生一个同步的，波形不失真的脉冲波形，并将此脉冲波形接入从机的PWM输入捕捉模块，就可以得到该正弦信号的相位、频率信息。从机得到主机输出的正弦波相位和频率之后，首先通过定时器设置自身输出正弦波的频率，达到同频，并且在每次过零点将自身相位置零，实现相位跟踪。</p><p>图4. 同步隔离模块电路图</p></sec><sec id="s7_5"><title>3.5. 交流采样模块设计</title><p>本设计的交流采样过程为：使用交流电压、电流互感器，在互感器的另一侧得到同比缩小的交流信号，然后将此信号通过差分比例放大电路，再将信号送入正弦信号有效值运算芯片ATT7022，经过内部运算之后通过SPI的通信方式，将信号的有效值发送回单片机。ATT7022芯片的应用示意图如图5所示。</p><p>图5. ATT7022芯片应用示意图</p></sec></sec><sec id="s8"><title>4. 系统软件设计</title><sec id="s8_1"><title>4.1. 软件总体设计</title><p>系统的软件控制主要分为初始化、SPWM产生、并联均流主从双环控制法，PID分段调节算法，OLED显示等，系统供电之后首先完成包括中断，定时器，PWM模块，OLED显示子程序，I/O端口等初始化，然后开始进行SPWM调制产生双路正弦波信号，并且主机做电压的闭环控制，从机做电流的闭环控制，在主程序执行的过程中配合有各个中断的使用，需要注意的是中断子程序并不能冗余，否则会影响SPWM波的输出，系统稳定性会变差，软件控制主流程图如图6所示，核心的均流算法流程图如图7所示。</p></sec><sec id="s8_2"><title>4.2. 系统通信设计</title><p>本系统设计主要用到两个通信模块，UART通信负责主机和从机之间的通信，SPI通信负责单片机和采样模块之间的数据通信。单片机中直接集成了UART的通信端口和模块，但是由于该通信方式的传输速度相对较慢，不太适合传输大量的数据，所以本设计只是使用它来完成单片机之间的标志位配合。本设计中，设计1个停止选择位，不设奇偶校验位，同时从ICx引脚输出到输入捕捉，禁止了环回模式和休眠期间的唤醒功能，同时通过UxTx和UxRX的I/O引脚通信。本设计中的UART通信主要用于主从之间的双环控制，即主机收到采样值并进行运算和比较之后，发送给从机电流控制的标志位，若需要从机电流增加则发送“1”，否则发送“0”。</p><p>SPI通信是一种高速的，全双工，同步的通信总线，并且在芯片的管脚上只占用了四根线，该协议的工作过程如下：首先，主机向从机发送时钟序列 [<xref ref-type="bibr" rid="hanspub.41580-ref6">6</xref>]；然后，主机将自身的数据通过SDO移入移位寄存器里面，等待发送，同时从机将自身的数据通过SDI移入移位寄存器里面，等待发送；接下来在8个时钟脉冲之后时钟停顿，主机将数据发送给从机，放入接收缓存器里面，同时标志位BF和SSPIF置“1”，同理从机也进行同样的操作将数据发给主机，标志位置“1”，最后主从MCU各自检测标志位，若标志位为1，将缓存中的数据读取，完成一次通信。</p><p>图6. 软件控制主流程图</p><p>图7. 核心均流算法流程图</p></sec><sec id="s8_3"><title>4.3. 系统安全稳定性设计</title><p>在本系统中设置软启动，即避免最开始系统就要稳定至24 V，先降低目标参数Vout值至12 V，然后通过定时器逐步增加至24 V稳定状态，这样就能极大的保证了系统的稳定性，避免其产生阶跃响应导致电路发生震荡，系统软启动原理示意图如图8所示。</p><p>图8. 软启动原理图</p></sec><sec id="s8_4"><title>4.4. 系统PID闭环控制设计</title><p>本设计提出了PID分段调节算法，在电流分配时，根据主从电流差值，调节PID参数改变每一次调节幅度，在相差较大且远离阈值时增大调节幅度，反之减小，这样既可以保证系统快速稳定，又可以避免系统工作于危险状态。</p><p>PID的参数包括比例，积分和微分，PID根据给定值和实际输出值构成控制偏差 [<xref ref-type="bibr" rid="hanspub.41580-ref7">7</xref>]，即</p><p>e ( t ) = r ( t ) − y ( t ) (1)</p><p>然后对偏差按比例，积分和微分通过线性组合构成控制量，常见的传输函数的形式为 [<xref ref-type="bibr" rid="hanspub.41580-ref8">8</xref>]</p><p>U ( s ) = K p ( 1 + 1 T i s + T d s ) E ( s ) (2)</p><p>其中， K p 是PID控制器的比例增益，比例增益的实质是根据每一次的偏差决定下一次调节的增量大小，简单理解就是比例增益系数越大，当系统碰到偏差时，调整的幅度就变大，显而易见，如果该系数这只太小就会影响系统的调节速度，实际过大就会在接近目标值的时候出现过量的调节，不容易稳定在目标值， T i 是积分时间常数。积分系数的作用是系统消除稳态误差，因此在设计的过程中将积分时间常数稍微设置高一些可以减少系统的动态误差； T d 是微分时间常数，微分时间常数主要控制系统的响应速度和稳定性，可以预见系统偏差的趋势，但是微分常数并不能太大，否则会削弱系统的抗干扰能力。</p><p>因此在相对误差较大的情况下本系统采用较高的比例系数和较高的积分系数，然后随着相对误差的减小将比例系数逐渐减小，使得整个PID控制器以相对误差为自变量进行分段控制，这样既可以提高系统响应速率，又可以保证系统的稳定性。</p></sec></sec><sec id="s9"><title>5. 测试方案与结果</title><p>1) 测试逆变器1的输出电流、电压、效率及负载调整率。输入直流电压为30 V，输出电流0~2 A变化，测试结果如表1所示：</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Inverter 1 efficiency and sine wave quality inde</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >输入电压/V</th><th align="center" valign="middle" >输出电流/A</th><th align="center" valign="middle" >输出电压/V</th><th align="center" valign="middle" >输入功率</th><th align="center" valign="middle" >输出功率</th><th align="center" valign="middle" >效率(%)</th></tr></thead><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >9</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >0.4</td><td align="center" valign="middle" >9.06</td><td align="center" valign="middle" >3.9</td><td align="center" valign="middle" >3.689</td><td align="center" valign="middle" >95</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >0.6</td><td align="center" valign="middle" >9.04</td><td align="center" valign="middle" >5.7</td><td align="center" valign="middle" >5.38</td><td align="center" valign="middle" >94</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >0.8</td><td align="center" valign="middle" >8.93</td><td align="center" valign="middle" >7.6</td><td align="center" valign="middle" >7.154</td><td align="center" valign="middle" >94</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >8.87</td><td align="center" valign="middle" >9.5</td><td align="center" valign="middle" >8.87</td><td align="center" valign="middle" >93</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >1.2</td><td align="center" valign="middle" >8.90</td><td align="center" valign="middle" >11.7</td><td align="center" valign="middle" >10.75</td><td align="center" valign="middle" >92</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >1.4</td><td align="center" valign="middle" >8.92</td><td align="center" valign="middle" >13.4</td><td align="center" valign="middle" >12.379</td><td align="center" valign="middle" >92</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >1.6</td><td align="center" valign="middle" >8.86</td><td align="center" valign="middle" >15.1</td><td align="center" valign="middle" >13.91</td><td align="center" valign="middle" >92</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >1.8</td><td align="center" valign="middle" >8.85</td><td align="center" valign="middle" >16.7</td><td align="center" valign="middle" >15.537</td><td align="center" valign="middle" >93</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >1.9</td><td align="center" valign="middle" >8.86</td><td align="center" valign="middle" >18.2</td><td align="center" valign="middle" >16.532</td><td align="center" valign="middle" >91</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >8.82</td><td align="center" valign="middle" >19.2</td><td align="center" valign="middle" >17.457</td><td align="center" valign="middle" >91</td></tr></tbody></table></table-wrap><p>表1. 逆变器1效率与正弦波质量指标</p><p>经过测试得到，逆变器1的平均效率可达到93%。系统的负载调整率 S I 1 反映的是电流在0~2 A范围变化的时候电压的波动范围，计算公式如下</p><p>S I 1 = | U o 2 − U o 1 U o 1 | (3)</p><p>其中 S I 1 为逆变器1单独工作时的负载调整率， U o 1 表示电流为0 A时的电压值， U o 2 表示电流为2 A时的电压值， S I 1 经过计算为0.003。</p><p>2) 逆变器1和逆变器2共同工作，输入直流电压为30 V，测得系统负载线电流有效值在1~3 A变化过程中，逆变器1与逆变器2输出的电流比为1:1时记录如表2所示：</p><table-wrap-group id="2"><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Inverter 1 and inverter 2 output current when the output ratio is 1:</title></caption><table-wrap id="2_1"><table><tbody><thead><tr><th align="center" valign="middle" >负载电流有效值/A</th><th align="center" valign="middle" >逆变器1电流(I1)/A</th><th align="center" valign="middle" >逆变器2电流(I2)/A</th><th align="center" valign="middle" >I1:I2</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0.494</td><td align="center" valign="middle" >0.499</td><td align="center" valign="middle" >0.99:1</td></tr><tr><td align="center" valign="middle" >1.2</td><td align="center" valign="middle" >0.609</td><td align="center" valign="middle" >0.615</td><td align="center" valign="middle" >0.99:1</td></tr><tr><td align="center" valign="middle" >1.4</td><td align="center" valign="middle" >0.685</td><td align="center" valign="middle" >0.697</td><td align="center" valign="middle" >0.98:1</td></tr><tr><td align="center" valign="middle" >1.6</td><td align="center" valign="middle" >0.797</td><td align="center" valign="middle" >0.785</td><td align="center" valign="middle" >1.02:1</td></tr><tr><td align="center" valign="middle" >1.8</td><td align="center" valign="middle" >0.912</td><td align="center" valign="middle" >0.892</td><td align="center" valign="middle" >1.02:1</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0.998</td><td align="center" valign="middle" >0.989</td><td align="center" valign="middle" >1.01:1</td></tr><tr><td align="center" valign="middle" >2.2</td><td align="center" valign="middle" >1.105</td><td align="center" valign="middle" >1.112</td><td align="center" valign="middle" >0.99:1</td></tr></tbody></table></table-wrap><table-wrap id="2_2"><table><tbody><thead><tr><th align="center" valign="middle" >2.4</th><th align="center" valign="middle" >1.195</th><th align="center" valign="middle" >1.201</th><th align="center" valign="middle" >1:1</th></tr></thead><tr><td align="center" valign="middle" >2.6</td><td align="center" valign="middle" >1.287</td><td align="center" valign="middle" >1.292</td><td align="center" valign="middle" >1:1</td></tr><tr><td align="center" valign="middle" >2.8</td><td align="center" valign="middle" >1.405</td><td align="center" valign="middle" >1.414</td><td align="center" valign="middle" >0.99:1</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >1.497</td><td align="center" valign="middle" >1.501</td><td align="center" valign="middle" >1:1</td></tr></tbody></table></table-wrap></table-wrap-group><p>表2. 逆变器1与逆变器2在输出比为1:1时输出电流</p><p>3) 逆变器1和逆变器2共同工作，输入直流电压为30 V，系统负载线电流有效值在1~3 A变化过程中，逆变器1与逆变器2输出的电流比为1:2时记录如表3所示：</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Inverter 1 and inverter 2 output current when the output ratio is 1:</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >负载电流有效值/A</th><th align="center" valign="middle" >逆变器1电流(I1)/A</th><th align="center" valign="middle" >逆变器2电流(I2)/A</th><th align="center" valign="middle" >I1:I2</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0.35</td><td align="center" valign="middle" >0.68</td><td align="center" valign="middle" >1:1.94</td></tr><tr><td align="center" valign="middle" >1.2</td><td align="center" valign="middle" >0.37</td><td align="center" valign="middle" >0.71</td><td align="center" valign="middle" >1:1.92</td></tr><tr><td align="center" valign="middle" >1.4</td><td align="center" valign="middle" >0.41</td><td align="center" valign="middle" >0.81</td><td align="center" valign="middle" >1:1.98</td></tr><tr><td align="center" valign="middle" >1.6</td><td align="center" valign="middle" >0.51</td><td align="center" valign="middle" >1.05</td><td align="center" valign="middle" >1:2.06</td></tr><tr><td align="center" valign="middle" >1.8</td><td align="center" valign="middle" >0.55</td><td align="center" valign="middle" >1.15</td><td align="center" valign="middle" >1:2.09</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0.62</td><td align="center" valign="middle" >1.28</td><td align="center" valign="middle" >1:2.06</td></tr><tr><td align="center" valign="middle" >2.2</td><td align="center" valign="middle" >0.68</td><td align="center" valign="middle" >1.42</td><td align="center" valign="middle" >1:2.09</td></tr><tr><td align="center" valign="middle" >2.4</td><td align="center" valign="middle" >0.8</td><td align="center" valign="middle" >1.6</td><td align="center" valign="middle" >1:2</td></tr><tr><td align="center" valign="middle" >2.6</td><td align="center" valign="middle" >0.85</td><td align="center" valign="middle" >1.74</td><td align="center" valign="middle" >1:2.05</td></tr><tr><td align="center" valign="middle" >2.8</td><td align="center" valign="middle" >0.89</td><td align="center" valign="middle" >1.83</td><td align="center" valign="middle" >1:2.06</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >1:2</td></tr></tbody></table></table-wrap><p>表3. 逆变器1与逆变器2在输出比为1:2时输出电流</p><p>4) 逆变器1和逆变器2共同工作，输入直流电压为30 V，系统负载线电流有效值在1~3 A变化过程中，逆变器1与逆变器2输出的电流比为2:1时记录如表4所示：</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> Inverter 1 and inverter 2 output current when the output ratio is 2:</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >负载电流有效值/A</th><th align="center" valign="middle" >逆变器1电流(I1)/A</th><th align="center" valign="middle" >逆变器2电流(I2)/A</th><th align="center" valign="middle" >I1:I2</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0.68</td><td align="center" valign="middle" >0.35</td><td align="center" valign="middle" >1.94:1</td></tr><tr><td align="center" valign="middle" >1.2</td><td align="center" valign="middle" >0.79</td><td align="center" valign="middle" >0.39</td><td align="center" valign="middle" >2.03:1</td></tr><tr><td align="center" valign="middle" >1.4</td><td align="center" valign="middle" >0.88</td><td align="center" valign="middle" >0.43</td><td align="center" valign="middle" >2.05:1</td></tr><tr><td align="center" valign="middle" >1.6</td><td align="center" valign="middle" >1.05</td><td align="center" valign="middle" >0.58</td><td align="center" valign="middle" >2.1:1</td></tr><tr><td align="center" valign="middle" >1.8</td><td align="center" valign="middle" >1.18</td><td align="center" valign="middle" >0.59</td><td align="center" valign="middle" >2:1</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >1.35</td><td align="center" valign="middle" >0.67</td><td align="center" valign="middle" >2.01:1</td></tr><tr><td align="center" valign="middle" >2.2</td><td align="center" valign="middle" >1.52</td><td align="center" valign="middle" >0.76</td><td align="center" valign="middle" >2:1</td></tr><tr><td align="center" valign="middle" >2.4</td><td align="center" valign="middle" >1.6</td><td align="center" valign="middle" >0.8</td><td align="center" valign="middle" >2:1</td></tr><tr><td align="center" valign="middle" >2.6</td><td align="center" valign="middle" >1.78</td><td align="center" valign="middle" >0.88</td><td align="center" valign="middle" >2.02:1</td></tr><tr><td align="center" valign="middle" >2.8</td><td align="center" valign="middle" >1.81</td><td align="center" valign="middle" >0.91</td><td align="center" valign="middle" >1.99:1</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >2:1</td></tr></tbody></table></table-wrap><p>表4. 逆变器1与逆变器2在输出比为2:1时输出电流</p><p>5) 测得系统负载线电流有效值在1~3 A变化过程中，电流输出比为1:1时，计算负载调整率 S I 2 ，此时负载调整率 S I 2 计算式为</p><p>S I 2 = | U o 2 − U o 1 U o 1 | (4)</p><p>其中 S I 2 表示系统在双路逆变器并联工作时的负载调整率， U o 1 表示电流为1 A时的电压值， U o 2 表示电流为3 A时的电压值，经过计算 S I 2 为0.004。</p></sec><sec id="s10"><title>6. 结论</title><p>光伏并网技术是新能源开发过程中的核心技术之一，本系统主要研究了改进之后的主从法单相逆变并联均流。使用STM32单片机为控制核心，双极性SPWM的调制方法，控制两个单相逆变全桥电路输出正弦交流电。同时，设计使用了同步锁相模块，使得两个电路可以并联供电。详细介绍了各种模块的设计和软件控制的方法，并通过实际的操作进行了验证，具有很好的扩展性，能够随时切换主从机的供电比，使得多种电源同时工作时能够有效的进行切换，可以高效率的为多种场合供电。本系统设计的效率可达90%以上，通过测试，系统可以切换不同的电流比例进行供电，电流误差不大于3%，验证了系统的控制方法的有效性。</p></sec><sec id="s11"><title>文章引用</title><p>徐贵鑫,金 海. 基于STM32的单相逆变器并网系统设计与实现Design and Implementation of Single-Phase Inverter Grid-Connected System Based on STM32[J]. 软件工程与应用, 2021, 10(02): 138-148. https://doi.org/10.12677/SEA.2021.102016</p></sec><sec id="s12"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.41580-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">郑飞, 张双庆, 张军军, 李红涛. 基于DSP和FPGA的一种新型光伏并网控制方法[J]. 电力电子技术, 2012, 46(11): 29-31.</mixed-citation></ref><ref id="hanspub.41580-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">李双超. 两级结构电力电子变压器的研究与设计[D]: [硕士学位论文]. 天津: 河北工业大学, 2017.</mixed-citation></ref><ref id="hanspub.41580-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">张昌盛, 段善旭, 康勇. 基于电流内环的一种逆变器控制策略研究[J]. 电力电子技术, 2005(3): 14-16.</mixed-citation></ref><ref id="hanspub.41580-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">匡程, 朱智, 王芳慧. 基于STC15F2K60S2单片机的微电网模拟系统设计[J]. 江苏科技信息, 2019, 36(34): 42-45+77.</mixed-citation></ref><ref id="hanspub.41580-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">厉俊, 郑佳蕙. 基于STM32的开关电源模块并联供电系统[J]. 软件工程, 2020, 23(3): 4-8.</mixed-citation></ref><ref id="hanspub.41580-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">汪尧. 具有快速响应的BUCK变换器设计与实现[D]: [硕士学位论文]. 成都: 电子科技大学, 2018.</mixed-citation></ref><ref id="hanspub.41580-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">胡志坚, 孙友宏. 钻进控制模拟系统及控制算法的设计与试验[J]. 煤炭学报, 2009, 34(4): 455-460.</mixed-citation></ref><ref id="hanspub.41580-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">曹洪瑞. 激光通信系统精跟踪PID控制算法研究及实现[D]: [硕士学位论文]. 长春: 中国科学院研究生院(长春光学精密机械与物理研究所), 2015.</mixed-citation></ref></ref-list></back></article>