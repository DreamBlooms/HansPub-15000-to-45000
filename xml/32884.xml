<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2019.911224</article-id><article-id pub-id-type="publisher-id">CSA-32884</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20191100000_16473663.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  江西省水库水文自动测报系统的设计与实现
  The Design and Implementation of the Hydrological Automatic Measurement and Reporting System of the Reservoir in Jiangxi Province
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>汪</surname><given-names>国斌</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>雷</surname><given-names>声</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>飞</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>曾</surname><given-names>文</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff4"><addr-line>九江市水文局，江西 九江</addr-line></aff><aff id="aff2"><addr-line>江西省水利科学研究院，江西 南昌</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><aff id="aff3"><addr-line>江西省水文局，江西 南昌</addr-line></aff><pub-date pub-type="epub"><day>31</day><month>10</month><year>2019</year></pub-date><volume>09</volume><issue>11</issue><fpage>1993</fpage><lpage>2001</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   针对水库自动测报存在建设标准不一、数据落地分散、数据汇集共享难的问题，本文提出按照统一数据传输规约、统一数据流程、统一数据库结构标准等“六个统一”的设计理念，从系统框架、信息流程和自动测报站点等方面对方案进行了详细的研究和设计。实践证明按“六个统一”的设计理念建设水库水文自动测报系统，可以实现全省水库自动测报数据在省级平台统一落地，可有效地提高水库自动测报数据的时效性、稳定性、可靠性和可共享性。 In view of the problems of different construction standards, scattered data landing and difficult data collection and sharing, in the automatic reservoir monitoring and reporting, the paper proposes the design concept of unified data transmission protocol, unified data flow, unified database structure standard and other “six unifying”. Detailed research and design are applied to the system framework, information flow and automatic paper-measuring station. The practice has proved that the construction of reservoir hydrological automatic measuring and reporting system according to the design concept of “six unifying” can realize the unified landing of reservoir automatic monitoring and reporting data in provincial platform, and can effectively improve the timeliness, stability, reliability and sharability of reservoir automatic monitoring and reporting data. 
  
 
</p></abstract><kwd-group><kwd>自动测报，水库，水雨情监测，统一数据流程, Automatic Measuring and Reporting</kwd><kwd> Reservoir</kwd><kwd> Water and Rain Monitoring</kwd><kwd> Unified Data Flow</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>江西省水库水文自动测报系统的设计与实现<sup> </sup></title><p>汪国斌<sup>1</sup>，雷声<sup>1</sup>，张飞<sup>2</sup>，曾文<sup>3</sup></p><p><sup>1</sup>江西省水利科学研究院，江西 南昌</p><p><sup>2</sup>江西省水文局，江西 南昌</p><p><sup>3</sup>九江市水文局，江西 九江</p><p><img src="//html.hanspub.org/file/4-1541568x1_hanspub.png" /></p><p>收稿日期：2019年10月18日；录用日期：2019年11月4日；发布日期：2019年11月11日</p><disp-formula id="hanspub.32884-formula23"><graphic xlink:href="//html.hanspub.org/file/4-1541568x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对水库自动测报存在建设标准不一、数据落地分散、数据汇集共享难的问题，本文提出按照统一数据传输规约、统一数据流程、统一数据库结构标准等“六个统一”的设计理念，从系统框架、信息流程和自动测报站点等方面对方案进行了详细的研究和设计。实践证明按“六个统一”的设计理念建设水库水文自动测报系统，可以实现全省水库自动测报数据在省级平台统一落地，可有效地提高水库自动测报数据的时效性、稳定性、可靠性和可共享性。</p><p>关键词 :自动测报，水库，水雨情监测，统一数据流程</p><disp-formula id="hanspub.32884-formula24"><graphic xlink:href="//html.hanspub.org/file/4-1541568x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/4-1541568x7_hanspub.png" /> <img src="//html.hanspub.org/file/4-1541568x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>2017年5月，水利部、国家发展改革委、财政部联合印发了《加快灾后水利薄弱环节建设实施方案》，作为统筹安排和有序推进灾后水利薄弱环节建设的基本依据。水利部以补齐防灾减灾短板、完善水利基础设施网络为主要目标，针对小型水库缺乏监测预警设施问题，各地要根据水库实际，合理配置水雨情自动监测系统、防汛预警系统，力争到“十三五”末，提高工程管理信息化水平，提升基层防汛抢险救灾预警能力 [<xref ref-type="bibr" rid="hanspub.32884-ref1">1</xref>]。</p><p>近年来，省水利厅、省水文局、有关水库管理单位等结合工作需要，相继开展防汛决策支持系统、山洪灾害非工程措施、水库除险加固工程建设，各地陆续投资建设了大量的水库水文自动测报系统。2017年以前，全省已有2000余座大中小型水库安装了水文自动测报系统，这些系统的建设大大提升了水库防汛预警的能力。但由于在前期建设中没有统一的规划，资金投入分散，建设和管理脱节，同时系统设备厂商较多，包括金水燕禹、武大扬帆、深圳科皓、南京水文自动化研究所、北京新禹等十几家，各厂商的设备在硬件标准、通信协议、数据格式、传输流程等方面都存在很大差异，无法相互兼容，数据落地十分分散，水库监测数据全省汇集和共享困难，亟需进行水文自动测报系统集成整合 [<xref ref-type="bibr" rid="hanspub.32884-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.32884-ref3">3</xref>]。随着水文自动测报系统规模的扩大，业务应用范围的延伸，实现水库水文测报的标准化、规范化和信息资源的共享成为各级水旱灾害防御部门的迫切需求 [<xref ref-type="bibr" rid="hanspub.32884-ref4">4</xref>]。</p><p>针对当前江西省水库自动测报建设存在的硬件标准、通信协议、传输流程差异大，数据落地分散、数据汇集共享难等问题，本文提出按照统一数据传输规约、统一数据流程、统一数据库结构标准等“六个统一”的设计理念，从系统框架、信息流程和自动测报站点等方面对方案进行了详细的研究和设计。有效提高了江西省水库自动测报数据的时效性、稳定性、可靠性和可共享性，同时为其它省份建设水库自动测报系统提供可借鉴的经验。</p></sec><sec id="s4"><title>2. 设计思路</title><p>总体设计思路是在深入调查研究江西省水库水文自动测报建设情况基础上，从水库防汛决策业务需求分析入手，按照统一建站设计、统一数据传输规约、统一测站编码、统一数据流程、统一数据库结构标准和统一规范化管理等“六个统一”原则，利用省水利信息中心现有水利云平台，高起点搭建项目总体基础框架，设计支持整体业务的各类应用、数据接收和管理系统，比较选择恰当的基础设施与技术架构，并对项目的运行、维护、管理和发展制定组织保障、安全保障等管控体系。设计方案要求实用、先进、科学、合理、经济、安全、可靠，具有前瞻性和可扩展性。</p></sec><sec id="s5"><title>3. 系统框架</title><p>江西省水库水文自动测报系统在层次上依次分为采集层、基础设施、数据资源、应用层，系统总体框架见图1。采用微服务架构，部署在省水利信息中心水利云平台。微服务架构模式是将单一应用程序划分成一组小的服务，每个服务运行在其独立的进程中，服务之间互相协调、互相配合，为用户提供最终价值 [<xref ref-type="bibr" rid="hanspub.32884-ref5">5</xref>]。微服务框架结合当前业界主流的J2EE技术路线，满足跨硬件平台、跨操作系统的要求。</p><p>图1. 系统总体框架图</p><p>1) 采集层</p><p>是分布在水库的水文自动测报站和洪水预警监控点的基础设施，负责采集、传输水库水情、视频监测信息。</p><p>2) 基础设施</p><p>硬件设施为系统提供基础的硬件支撑环境，主要采用江西省水利信息中心的现有水利云资源，包括服务器，存储和网络硬件等，并适当扩充。</p><p>3) 数据资源</p><p>数据资源是信息汇聚平台，是对数据进行统一接收、存储、交换与管理，包括数据统一接收平台、水情交换系统及数据库。数据统一接收平台是整个平台系统的信息源，负责接收处理分布在全省各地的水库自动测报站水情信息，并监视测站运行状况。在统一的通信协议支持下，信息接收平台能够汇集不同型号、不同厂家设备的数据。数据交换平台提供信息共享功能，负责将接收到的水情信息分发到市、县、区和水库管理单位。</p><p>4) 应用支撑</p><p>应用支撑主要由各类商用支撑软件和开发类通用支撑软件共同组成，其功能分成三部分，一是对空间信息的支持；二是提供开发应用系统的中间件；三是统一的身份认证平台和用户管理系统，充分利用省水利信息中心可利用资源。</p><p>5) 应用层</p><p>应用层主要包括面向省、市、县、乡镇四级防汛业务人员的水库信息服务平台和面向社会公众的水情服务门户。分别为防汛抗旱指挥平台、运行维护管理系统和洪水预报预警系统。</p></sec><sec id="s6"><title>4. 信息流程</title><p>系统的信息流程包括省与市、县三个层级之间信息的纵向传输和省与省管大型水库之间的二级信息的纵向传输，以及系统的不同层级之间信息的横向流动。</p><p>1) 信息横向流程</p><p>信息都是通过信息采集与传输层进入到数据资源层，业务应用层在支撑平台层的基础上，通过调用数据资源层的采集数据和由支撑平台层集成而来的外部交换数据，进行业务处理，生成的业务数据通过应用交互层的两大门户为用户提供服务，具体流程如图2所示。</p><p>图2. 系统信息横向流程图</p><p>2) 信息纵向流程</p><p>各级水库工程管理机构之间的信息传输主要依托水利政务外网(防汛专网)和因特网。信息服务平台数据是以实时监测数据库为核心，平台信息流程图如图3所示。</p><p>3) 网络及系统部署</p><p>平台部署在因特网，数据统一接收，经过解码后存入省防汛专网信息接收区，水情交换系统和防汛抗旱指挥平台都集中部署在省防汛专网信息交换区、信息发布区、业务服务区和安全管理区。省防汛专网与因特网逻辑隔离。信息服务系统采用省防汛信息中心“一级部署，多级应用”的模式，各市县不再单独开发水库信息服务系统，但可在防汛指挥系统中进一步集成水库防汛管理的功能。</p><p>图3. 系统信息纵向流程图</p></sec><sec id="s7"><title>5. 自动测报站设计</title><p>1) 组成结构</p><p>自动测报站由采集与传输控制(遥测终端机)、传感器系统(水位计、雨量计)、电源系统(蓄电池、充电控制器、太阳能电池板)和通信传输系统(GPRS/GSM通信模块、GPRS/GSM天线)等4大部分组成 [<xref ref-type="bibr" rid="hanspub.32884-ref6">6</xref>]，具体结构框架图如图4所示。另外，各水库水文测报站设置1个水准点、1组水尺和观测踏步设施，便于与自动测报数据校核和应急情况下人工报汛。</p><p>水位计、雨量计主要完成水库水位和降雨量的传感测量，并将测量值变换成电信号输出到RTU。遥测终端(RTU)主要完成被测水库水位、雨量参数的数据采集、存储和传输的控制，最后通过通信传输系统将数据传输至省级统一接收平台。</p><p>图4. 自动测报站结构框架图</p><p>2) 主要技术要求</p><p>各水库按照“一库一站”标准建设水文自动测报系统，建站标准符合《水文自动测报系统技术规范》(SL61-2015)要求，水位监测和雨量监测分别符合相应规范要求。通信传输采用公网GPRS无线传输，传输协议须符合《水文监测数据通信规约》(SL651-2014)，采集的水情信息在5分钟内传送到省中心接收平台，各县、市防办和水库管理单位通过省水库监测数据中心分发数据或提供数据服务。系统总体在10 min内完成一次实时数据收集、处理和转发的要求，数据传输信道误码率要求小于等于1 &#215; 10<sup>−</sup><sup>5</sup>；雨量计分辨率为0.5 mm，测量误差&#177;4% (降雨强度0.1~4 mm/min)；水位计分辨率为1 cm，水位变化幅度大于10 m时允许误差&#177;0.3%，水位变化幅度小于等于10 m时允许误差&#177;2 cm；自动测报站单站综合MTBF不低于30000 h。</p><p>3) 工作方式及传输通信</p><p>自动测报站工作方式采用自报式、查询/应答式兼容混合式工作体制。自报式根据量级和需求设定自报时间，包括超限自报和定时自报，当雨量增加5 mm或水位涨落2 cm，且与上次发送数据时间间隔大于5 min时自动向中心发送一次数据。查询/应答式由授权用户在平台下发召测指令，测报站自动响应，采集实时水雨情数据并发送省中心。</p><p>测报站配备GPRS/GSM两种信道，互为备份，GPRS具有效率高、实时性强、建设成本低、传输功耗小等优点 [<xref ref-type="bibr" rid="hanspub.32884-ref7">7</xref>]。当GPRS信道出现故障时，系统能够自动切换到短信信道进行数据传输。水库自动测报站只向中心传递信息，自动测报站之间没有数据交换问题，即建立以省平台为数据中心的星形结构。</p><p>4) 水位计比选</p><p>在我国应用较多的水位计有浮子式、压力式(投入)、气泡式、超声波、雷达式和激光式等水位计，不同的水位计工作原理、优缺点、适用条件也不尽相同。通过综合比较和实践应用来看，超声波水位计已逐渐被淘汰，投入压力水位计可靠性差，后期维护量大，激光水位计目前技术还未完全成熟，可靠性差，且安装条件苛刻、维护成本大。因此本次工程自动测报站根据水库现场条件选择浮子、气泡和雷达三种水位计。</p><p>对于水库水位变幅不大，已有测井或适合竖管条件的，优先采用浮子式水位计进行水位观测；若水体变幅范围内有直立面，具备建设悬臂支架条件的，可采用雷达式水位计；其它情况采用气泡式水位计。</p></sec><sec id="s8"><title>6. 效果评估</title><p>2017年开始，省水利厅通过山洪灾害补充设计、2017年山洪灾害、2017水库水文自动测报及2018年水库水文自动测报等项目开展了部分水库水文自动测报站点建设和统一接收平台开发应用，结合数据转发、业务应用软件等，已经按照“六个统一”的原则建立起完整的水库水文自动测报系统。截止目前，全省已建成水库水文自动测报站的水库4136座，已招标正在施工中1236座，2019年拟继续招标实施1202座，数据已接入江西省水雨情统一数据接收平台4000余座(见图5)，实现省市县三级实时数据共享。有效改变了之前硬件标准、通信协议、数据格式、传输流程等方面的不统一，数据落地分散，数据汇集共享难的局面，提高了数据的时效性、可靠性。</p><p>以2017年水库测报项目建设的丰城市、高安市、樟树市、上高县4个标段为例，2019年3月各标段的系统通畅率为98.59%、96.21%、96.89%、99.16%，2分钟内实时数据到报率为98.64%、96.7%、96.98%、99.54%，为2019年江西遭遇强降雨期间提供了及时可靠的数据支撑，确保了水库安全。丰城市在2017年水库水文自动测报项目建设中建设自动测报站点256座，每日应到报文数6144条，2019年3月1日至25日期间实际每日接收报文数量、标段每日通畅率见图6所示，该时间段系统通畅率达98.59%。2017年水库水文自动测报项目高安市标段完成259处气泡式水位雨量站和5处浮子水位雨量站建设，经测试系统通畅率和2分钟内到报率均超过规范要求，具体站点施工效果图如图7所示。</p><p>图5. 统一接收平台接入4000余座水库实时数据</p><p>图6. 丰城市系统通畅率测试(20190301~20190325)</p></sec><sec id="s9"><title>7. 建议与对策</title><sec id="s9_1"><title>7.1. 强化自动测报站点运维管理责任</title><p>省级统一标准、统一建设，数据统一落地省级平台，有利于保障软件平台硬件设施环境和运维技术力量，但对测报站点存在基层运维管理责任意识不强。建议通过文件和制度，落实运维管理责任，明确建成的自动测报站点正式运行后由县(市、区)水利局或水库管理单位承担运行管理责任，落实运行管理费用，制定运行管理制度。在质保期内，要督促承建单位做好站点运维；已过质保期的站点，须明确维护单位，并及时开展运维。</p><p>图7. 气泡式水库水文测报站(高安市斜前水库)施工图</p></sec><sec id="s9_2"><title>7.2. 完善水库测站编码</title><p>水库测站编码是实现水雨情信息接入、汇集和共享的基础，因前期小(2)型水库未开展水情测站编码工作，建设过程中为监测数据及时入库和应用采用了临时编码，在省水文局完成全省小(2)型水库编码后需进行更换，因水库数量较多、交换节点多，更换编码工作量大且容易出错，因此在开展全省水库自动测报建设前，应提前谋划完善全省水库水情编码。</p></sec><sec id="s9_3"><title>7.3. 及时对未接入统一平台的站点进行改造</title><p>部分已建站点符合《水文监测数据通信规约》，为了避免资源浪费，在设计时优先考虑了升级方案。但由于各种原因，少数站点升级难以实现，导致少量监测数据仍未接入省统一接收平台，建议将已建但未接入统一接收平台的水库自动测报站点通过改造或重建，实现数据统一落地省中心。</p></sec></sec><sec id="s10"><title>8. 结语</title><p>江西省水库数量众多，占全国水库总数的九分之一，确保水库安全是我省水旱灾害防御工作中的一项重要工作 [<xref ref-type="bibr" rid="hanspub.32884-ref8">8</xref>]，对做好水库水文自动测报系统的建设规划、实施、运行维护具有重要意义。经实践证明，按“六个统一”的设计理念建设水库水文自动测报系统，能实现全省水库自动测报数据在省级平台统一落地，有效地提高水库测报数据的时效性、稳定性和可靠性，实现省市县三级实时水雨情数据共享。针对系统实现过程中遇到的问题，因地制宜地提出相应的对策与建议，有利于提高水库自动测报建设管理能力，保障水库测报站点长效运行，为做好水旱灾害防御工作提供坚实的数据支撑。</p></sec><sec id="s11"><title>基金项目</title><p>江西省重点研发计划项目(20161BBG70088)。</p></sec><sec id="s12"><title>文章引用</title><p>汪国斌,雷 声,张 飞,曾 文. 江西省水库水文自动测报系统的设计与实现The Design and Implementation of the Hydrological Automatic Measurement and Reporting System of the Reservoir in Jiangxi Province[J]. 计算机科学与应用, 2019, 09(11): 1993-2001. https://doi.org/10.12677/CSA.2019.911224</p></sec><sec id="s13"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.32884-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">水利部, 国家发展改革委, 财政部. 加快灾后水利薄弱环节建设实施方案[R]. 2017.</mixed-citation></ref><ref id="hanspub.32884-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">王美玲, 丁强. 基于统一标准和统一平台的水文自动测报系统集成与整合[J]. 水文, 2016, 36(3): 700-74.</mixed-citation></ref><ref id="hanspub.32884-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">李咏梅. 基于Smart Client技术的水文信息系统研究[D]: [硕士学位论文]. 南京: 河海大学, 2007.</mixed-citation></ref><ref id="hanspub.32884-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">代春兰, 汤文华, 汤宏. 基于云平台的湖北省小型水库水雨情自动测报系统设计与实践[J]. 中国农村水利水电, 2017(5): 110-113.</mixed-citation></ref><ref id="hanspub.32884-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">郭栋, 王伟, 曾国荪. 一种基于微服务架构的新型云件PaaS平台[J]. 信息网络安全, 2015(11): 15-20.</mixed-citation></ref><ref id="hanspub.32884-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">中华人民共和国水利部. SL 61-2015, 水文自动测报系统技术规范[S]. 北京: 中国水利水电出版社, 2015.</mixed-citation></ref><ref id="hanspub.32884-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">杨春华. 水文自动测报系统通讯信道设计[J]. 人民长江, 2009, 40(9): 12-14.</mixed-citation></ref><ref id="hanspub.32884-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">平其俊. 浅谈江西水库洪水调度[J]. 江西水利科技, 2002(2): 107-109+119.</mixed-citation></ref></ref-list></back></article>