<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2017.71009</article-id><article-id pub-id-type="publisher-id">CSA-19637</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20170100000_76246424.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于Hash函数的文本图像脆弱水印算法
  Fragile Watermarking Algorithm for the Text Image Based on Hash Function
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>马</surname><given-names>小雪</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>英</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>null</addr-line></aff><aff id="aff1"><addr-line>青岛大学，山东 青岛</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1182683153@qq.com(马小)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>17</day><month>01</month><year>2017</year></pub-date><volume>07</volume><issue>01</issue><fpage>67</fpage><lpage>73</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   针对文本图像内容真实性和完整性认证的实际需求，提出一种基于Hash函数的文本图像脆弱水印算法。算法思想是首先对文本图像进行分块，然后根据平滑度和连通性来计算每个分块中的可翻转像素点和不可翻转像素点，然后利用Hash函数中的MD5算法加密产生水印信息，最后将这些水印信息嵌入到可翻转像素点中。将在接收到的文本图像中提取的水印信息与之前产生的水印信息相比较，就可以实现文本图像的真实性及完整性认证。该算法有良好的篡改定位能力。 Aiming at the actual demand of authenticity and integrity authentication of text image, a fragile watermarking algorithm for text image based on Hash function is proposed. The idea of the algorithm is to first block the text image, and then calculate the reversible and non-reversible pixel points in each block based on smoothness and connectivity. The watermark information is generated by MD5 algorithm in Hash function. Finally, the watermark information is embedded into the reversible pixel points. The watermark information extracted in the received text image is compared with the previously generated watermark information, and the authenticity and inte- grity of the text image can be authenticated. The algorithm has a good ability of tampering posi- tioning.
    
  
 
</p></abstract><kwd-group><kwd>文本图像，Hash函数，脆弱水印，篡改定位, Text Image</kwd><kwd> Hash Function</kwd><kwd> Fragile Watermarking</kwd><kwd> Tampering Positioning</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于Hash函数的文本图像脆弱水印算法<sup> </sup></title><p>马小雪，王英</p><p>青岛大学，山东 青岛</p><p>收稿日期：2017年1月6日；录用日期：2017年1月21日；发布日期：2017年1月24日</p><disp-formula id="hanspub.19637-formula7"><graphic xlink:href="http://html.hanspub.org/file/9-1540661x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对文本图像内容真实性和完整性认证的实际需求，提出一种基于Hash函数的文本图像脆弱水印算法。算法思想是首先对文本图像进行分块，然后根据平滑度和连通性来计算每个分块中的可翻转像素点和不可翻转像素点，然后利用Hash函数中的MD5算法加密产生水印信息，最后将这些水印信息嵌入到可翻转像素点中。将在接收到的文本图像中提取的水印信息与之前产生的水印信息相比较，就可以实现文本图像的真实性及完整性认证。该算法有良好的篡改定位能力。</p><p>关键词 :文本图像，Hash函数，脆弱水印，篡改定位</p><disp-formula id="hanspub.19637-formula8"><graphic xlink:href="http://html.hanspub.org/file/9-1540661x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着互联网的发展，电子商务和电子政务随之兴起，重要文件资料、经济合同、电子发票等更多文本图像需要网络传送。这些文件一旦出现恶意篡改而无法证明真伪，就会造成严重后果。因此，研究文本图像认证方法，对电子政务和电子商务具有重要作用 [<xref ref-type="bibr" rid="hanspub.19637-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.19637-ref2">2</xref>] 。文本图像特点：前后景区域对比鲜明，隐藏噪声易于显现，隐藏冗余非常有限，所以在文本图像中隐藏信息的难度较大 [<xref ref-type="bibr" rid="hanspub.19637-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.19637-ref4">4</xref>] 。脆弱水印技术，由于其极容易被破坏的特性，非常适合用于图像内容的认证，可以有效检测篡改和篡改定位。文献 [<xref ref-type="bibr" rid="hanspub.19637-ref5">5</xref>] 提出利用混沌算法将水印嵌入的最不重要像素块中，视觉质量比较好，但是定位能力比较差；文献 [<xref ref-type="bibr" rid="hanspub.19637-ref6">6</xref>] 将水印嵌入文本空白处，定位效果比较好，但是视觉效果不理想。本文提出一种基于Hash函数的脆弱水印算法，利用Hash函数对输入值的高敏感性，来实现脆弱水印在文本图像的嵌入及篡改定位。</p></sec><sec id="s4"><title>2. Hash函数</title><p>Hash函数在现代密码学中起着重要作用。其有主要性质：1) 易计算：对于任意给定的消息，容易计算其哈希值；2) 压缩性：任意长度的数据，算出的摘要长度固定；3) 敏感性：对数据进行任何改动，甚至只修改1个字节，所得到的摘要会有很大区别；4) 抗碰撞性：对于给定的消息M<sub>1</sub>，要发现另一个消息M<sub>2</sub>，满足H(M<sub>1</sub>) = H(M<sub>2</sub>)在计算上是不可行的；找一对不同的消息M<sub>1</sub>，M<sub>2</sub>，使H(M<sub>1</sub>) = H(M<sub>2</sub>)在计算上是不可行的。</p><p>Hash函数主要有MDx系列和SHA系列。MDx系列包括MD5、HAVAL、RIPEMD一128等；SHA系列包括SHA0、SHA1、SHA256等。MD5和SHAl应用最广，MD5产生的摘要信息为128位，SHA产生的摘要信息为160位。</p><p>单向散列算法，即信息-摘要算法(Message-Digest Algorithm 5, MD5)，在20世纪90年代初由MIT Laboratory for Computer Science和RSA Data Security Inc的Rbnald L. Rivest开发，经MD2、MD3和MD4发展而来。MD5以512位分组处理输入文本，每个分组又划分为16个32位子分组。算法的输出由4个32位分组组成，级联成一个128位散列值 [<xref ref-type="bibr" rid="hanspub.19637-ref4">4</xref>] 。虽然2004年王小云教授在国际密码学会议公布了MD系列算法的破解，但在一般的应用场合，可以认为MD5算法是足够安全的。MD5有良好的压缩性和抗碰撞性等，通过对一段信息产生信息摘要以保证信息的安全性。</p><p>MD5摘要生成流程如图1。</p><p>第一步填充：若输入信息长度(bit)对512求余的结果不等于448，则需要填充。填充一个1和n个0，使得求余结果等于448。填充完后，信息长度为N &#215; 512 + 448；</p><p>图1. MD5计算流程</p><p>第二步记录：用64位来存储填充前信息长度。这样信息长度就变为N &#215; 512 + 448 + 64 = (N + 1) &#215; 512位。</p><p>第三步装入：装入标准幻数，物理顺序是A = (01234567)16，B = (89ABCDEF)16，C = (FEDCBA98)16，D = (76543210)16。</p><p>第四步循环：循环运算，循环次数是分组的个数(N + 1) [<xref ref-type="bibr" rid="hanspub.19637-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.19637-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.19637-ref9">9</xref>] 。</p></sec><sec id="s5"><title>3. 水印算法的设计及实现</title><sec id="s5_1"><title>3.1. 水印的生成与嵌入</title><sec id="s5_1_1"><title>3.1.1. 水印生成</title><p>1) 原始文本图像分块：分成3 m &#215; 3 n大小的块，每块标记为Ai，即每块中含有m &#215; n个3 &#215; 3的小块；</p><p>2) 可翻转像素点确定：根据MinWu提出的可翻转像素准则 [<xref ref-type="bibr" rid="hanspub.19637-ref10">10</xref>] ，统计每块中可翻转像素点以及不可翻转像素点；</p><p>3) Hash摘要生成：将每块中不可翻转像素作为MD5算法的输入，生成长度为L的二值序列，作为水印Wi；</p><p>4) 将水印Wi加密保存：用logistic混沌生成混沌序列W1，Wi与W1异或生成加密水印。存储Hash摘要要比存储原始文本图像更有效。</p><p>以分块A1为例，MD5摘要生成如表1所示。</p></sec><sec id="s5_1_2"><title>3.1.2. 水印的嵌入</title><p>1) 将原始文本图像分成3 m &#215; 3 n大小的分块，每块标记为Ai；</p><p>2) 用logistic混沌映射生成一个混沌序列W2，用W2来选定与Ai相对应的块Bi；</p><p>3) 将水印信息Wi嵌入到Ai中对应的可翻转像素中，即得到嵌入水印的文本图像。</p><p>用混沌序列指引水印嵌入块，保密水印的嵌入位置，提高水印的抗攻击能力 [<xref ref-type="bibr" rid="hanspub.19637-ref11">11</xref>] 。对可翻转像素进行翻转，对图像的视觉影响很小，所以将水印嵌入到可翻转像素中的视觉隐蔽性很高 [<xref ref-type="bibr" rid="hanspub.19637-ref10">10</xref>] 。在保证图像视觉质量的前提下，将水印均匀的嵌入到每个分块中，实现水印的脆弱性 [<xref ref-type="bibr" rid="hanspub.19637-ref12">12</xref>] 。这样含水印图像如果遭到恶意篡改，</p><p>就会导致水印发生相应的变化，根据水印的变化可以确定篡改位置。</p><p>水印嵌入流程如图2所示。</p></sec></sec><sec id="s5_2"><title>3.2. 水印提取与篡改检测</title><sec id="s5_2_1"><title>3.2.1. 水印提取</title><p>1) 把待检测文本图像分成3 m &#215; 3 n大小的分块；</p><p>2) 用logistic混沌映射确定分块Bi'；</p><p>3) 从映射块Bi&#180;中可翻转像素点提取Wi'。</p></sec><sec id="s5_2_2"><title>3.2.2. 水印篡改检测</title><p>1) 篡改检测：可以通过计算提取水印和原始水印的归一化系数(NC)判断图像是否被篡改，NC越接近于1，说明提取的水印与原始水印越接近。理论上，当NC为1时，图像未被篡改，当NC不为1时，说明图像被篡改。</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/9-1540661x10_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>2) 篡改定位：如果Wi ≠ Wi'则A_flag(x, y) = 1，可以判定图像被篡改；如果Wi = Wi'，则A_flag(x, y) = 0，则图像未被篡改，从而实现篡改区域的认证和定位。</p><p>水印提取与检测流程如图3所示。</p></sec></sec></sec><sec id="s6"><title>4. 算法仿真</title><p>建立图像库，现存50幅文本图像。在MATLAB环境下，对该算法进行仿真实验，验证算法的有效性。</p><sec id="s6_1"><title>4.1. 不可见性</title><p>图4为原始文本图像示例。图5为对应嵌入水印的文本图像示例。对50幅文本图像进行仿真，视觉</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Encryption watermarkin</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >图像类型</th><th align="center" valign="middle" >Hash摘要</th><th align="center" valign="middle" >混沌序列</th><th align="center" valign="middle" >加密水印</th></tr></thead><tr><td align="center" valign="middle" >文字文本</td><td align="center" valign="middle" >cabdd132b2e92026 704072e0c657dace</td><td align="center" valign="middle" >d7b6aa18b02ff3a1 383744f09f7a6b12</td><td align="center" valign="middle" >1d0b7b2a02c6d387 48773610592db1dc</td></tr><tr><td align="center" valign="middle" >医学单据</td><td align="center" valign="middle" >be2ae3d82199298a 04d186ee8d6e15c8</td><td align="center" valign="middle" >d7b6aa18b02ff3a1 383744f09f7a6b12</td><td align="center" valign="middle" >699c49c091b6da2b 3ce6c21e12147eda</td></tr><tr><td align="center" valign="middle" >电子发票</td><td align="center" valign="middle" >7d6671213c0bf3db 017d41b3e94a5c7e</td><td align="center" valign="middle" >d7b6aa18b02ff3a1 383744f09f7a6b12</td><td align="center" valign="middle" >aad0db398c24007a 394a05437630376c</td></tr></tbody></table></table-wrap><p>表1. 加密水印</p><p>图2. 水印嵌入流程框图</p><p>图3. 水印提取流程框图</p><p>图4. 水印提取流程框图：(a)文字文本；(b) 医学单据；(c) 电子发票</p><p>图5. 含水印图像示例：(a) 含水印文字文本；(b) 含水印医学单据；(c) 含水印电子发票</p><p>不可见性良好。客观评定用峰值信噪比PSNR，其值越高，不可见性越好。它的临界值一般取为30 dB，峰值信噪比超过30 dB，就说明含水印的图像的透明性较好。50幅文本图像的PSNR都在45 dB以上，从而证明该算法有良好的不可见性。在含水印图像中提取水印信息并计算对应的归一化系数，NC及PSNR如表2所示。</p></sec><sec id="s6_2"><title>4.2. 篡改定位</title><p>对含水印文本图像进行局部的篡改。图5(a)第6行中下午篡改为上午，第15行中静音改为震动；图5(b)第3行数据27.67篡改为45.36，第10行数据0.95改为3.08；图5(c)将单价2480改为4560，将合计金额2180篡改为4260。篡改定位仿真示例如图6所示。计算每种篡改图像的归一化系数、虚检率及漏检率，如表3所示。</p><p>仿真实验结果表明，该算法具有很好的视觉不可见性，同时对水印图像的篡改具有很高的敏感性，可以鉴别文本图像的正确性和完整性。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Invisible feature</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >图像类型</th><th align="center" valign="middle" >NC系数</th><th align="center" valign="middle" >PSNR</th></tr></thead><tr><td align="center" valign="middle" >文字文本</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >46.182 dB</td></tr><tr><td align="center" valign="middle" >医学单据</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >54.236 dB</td></tr><tr><td align="center" valign="middle" >电子发票</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >50.513 dB</td></tr></tbody></table></table-wrap><p>表2. 不可见性</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Pfa and Pfr of tampering and positionin</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >图像类型</th><th align="center" valign="middle" >NC系数</th><th align="center" valign="middle" >虚检率(%)</th><th align="center" valign="middle" >漏检率(%)</th></tr></thead><tr><td align="center" valign="middle" >文字图像</td><td align="center" valign="middle" >0.89</td><td align="center" valign="middle" >1.67</td><td align="center" valign="middle" >0.34</td></tr><tr><td align="center" valign="middle" >医学检验图像</td><td align="center" valign="middle" >0.91</td><td align="center" valign="middle" >1.93</td><td align="center" valign="middle" >0.58</td></tr><tr><td align="center" valign="middle" >电子发票</td><td align="center" valign="middle" >0.86</td><td align="center" valign="middle" >2.07</td><td align="center" valign="middle" >0.65</td></tr></tbody></table></table-wrap><p>表3. 篡改定位虚检率及漏检率</p><p>图6. 篡改定位示例</p></sec></sec><sec id="s7"><title>5. 结束语</title><p>本文提出了一种针对于文本图像认证的脆弱水印算法。通过利用Hash函数对输入值的高敏感性，来实现脆弱水印在文本图像的嵌入及篡改定位。通过将文本图像分块，然后计算出每个块中不可翻转像素和可翻转像素，然后将不可翻转像素利用Hash函数的MD5算法加密生成含有图像内容的水印信息，然后将其嵌入到不可翻转像素中就得到了嵌入水印的文本图像，此算法通过实验证明有很好的水印不可见性和篡改定位能力。</p></sec><sec id="s8"><title>致谢</title><p>在此感谢导师的指导和帮助，在我有问题不能解答的时候对我细心的指导，也感谢实验室同学和朋友的帮助，在我遇到困难的时候帮助我解决问题并给予关心，并对给予转载和引用权的资料、图片、文献、研究思想和设想的所有者，表示感谢。</p></sec><sec id="s9"><title>文章引用</title><p>马小雪,王 英. 基于Hash函数的文本图像脆弱水印算法 Fragile Watermarking Algorithm for the Text Image Based on Hash Function[J]. 计算机科学与应用, 2017, 07(01): 67-73. http://dx.doi.org/10.12677/CSA.2017.71009</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.19637-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">谭利娜. 文本图像鲁棒认证技术研究[D]: [博士学位论文]. 长沙: 湖南大学, 2012.</mixed-citation></ref><ref id="hanspub.19637-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">孙圣和, 陆哲明, 牛夏牧, 等, 著. 数字水印技术及其应用[M]. 北京: 科学出版社, 2004: 536.</mixed-citation></ref><ref id="hanspub.19637-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">秦瑶. 内容真实性认证的文本图像脆弱水印算法[D]: [硕士学位论文]. 成都: 西南交通大学, 2014.</mixed-citation></ref><ref id="hanspub.19637-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">余振山. 自然语言文本中数字水印的设计与研究[D]: [博士学位论文]. 合肥: 中国科学技术大学, 2009.</mixed-citation></ref><ref id="hanspub.19637-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">朱从旭, 陈志刚. 一种灵敏的文本图像认证混沌脆弱水印技术[J]. 小型微型计算机系统, 2006, 27(1): 151-154.</mixed-citation></ref><ref id="hanspub.19637-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">胡精易, 毛建旭, 赵希. 一种用于认证二值文本图像窜改定位的数字水印算法[J]. 计算机应用研究, 2012, 29(12): 4631-4634.</mixed-citation></ref><ref id="hanspub.19637-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">林克正, 李东勤, 李绍华. 基于Hash函数的脆弱图像水印算法[J]. 哈尔滨工程大学学报, 2008, 29(1): 61-64.</mixed-citation></ref><ref id="hanspub.19637-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">毛熠, 陈娜. MD5算法的研究与改进[J]. 计算机工程, 2012, 38(24): 111-114.</mixed-citation></ref><ref id="hanspub.19637-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Bruce, Schneier, 祝世雄. 应用密码学——协议、算法和C源程序[J]. 信息安全与通信保密, 1994(3): 312-313.</mixed-citation></ref><ref id="hanspub.19637-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">白树锋, 邓立新. 脆弱水印在电子病历中的应用[J]. 软件导刊, 2012, 11(6): 149-150.</mixed-citation></ref><ref id="hanspub.19637-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">陈善学, 彭娟, 李方伟. 基于二维Logistic混沌映射的DWT数字水印算法[J]. 重庆邮电大学学报(自然科学版), 2012, 24(4): 495-500.</mixed-citation></ref><ref id="hanspub.19637-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Wu, M., Tang, E. and Lin, B. (2000) Data Hiding in Digital Binary Image. IEEE International Conference on Multimedia and Expo, 1, 393-396. &lt;br&gt;https://doi.org/10.1109/ICME.2000.869623</mixed-citation></ref></ref-list></back></article>