<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SA</journal-id><journal-title-group><journal-title>Statistics and Application</journal-title></journal-title-group><issn pub-type="epub">2325-2251</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SA.2021.101017</article-id><article-id pub-id-type="publisher-id">SA-40746</article-id><article-categories><subj-group subj-group-type="heading"><subject>SA20210100000_91709904.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于嵌套结构的分层线性回归模型的统计推断
  Statistical Inference of Hierarchical Linear Regression Model Based on Nested Structure
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>周</surname><given-names>梦雨</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>田</surname><given-names>茂再</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>兰州财经大学统计学院，甘肃 兰州</addr-line></aff><aff id="aff3"><addr-line>中国人民大学应用统计科学研究中心，北京；中国人民大学统计学院，北京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>04</day><month>02</month><year>2021</year></pub-date><volume>10</volume><issue>01</issue><fpage>173</fpage><lpage>182</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    通常在处理模型假设检验的问题时，统计推断是通过样本数据的观测信息来推断总体的主要方法，本文提出基于嵌套结构的分层线性回归模型的系数向量诊断方法，对于分层线性回归的第一层模型系数诊断主要利用传统的线性嵌套回归模型F检验进行统计推断。该论文的创新之处在于对分层线性回归模型的第二层系数进行统计诊断，利用嵌套多元线性回归模型推广到具有嵌套结构的分层线性回归模型中，主要构建分层线性回归模型似然函数比值来构造检验统计量。通过高校数学成绩分层数据进行分析，来验证该方法的有效性和可行性。
    Generally, when dealing with the problem of model hypothesis testing, statistical inference is the main method to infer the population through the observation information of sample data. In this paper, the coefficient vector diagnosis method of Hierarchical Linear Regression Model based on nested structure is proposed. For the first level model coefficient diagnosis of hierarchical linear regression, the traditional F-test of linear nested regression model is used for statistical inference. The innovation of this paper lies in the statistical diagnosis of the second layer coefficient of Hierarchical Linear Regression Model. The nested multiple linear regression model is extended to the Hierarchical Linear Regression Model with nested structure. The likelihood function ratio of Hierarchical Linear Regression Model is mainly constructed to construct the test statistics. The effectiveness and feasibility of this method is verified by the hierarchical data analysis of college mathematics scores. 
  
 
</p></abstract><kwd-group><kwd>分层线性模型，嵌套模型，似然比，统计推断, Hierarchical Linear Model</kwd><kwd> Nested Model</kwd><kwd> Likelihood Ratio</kwd><kwd> Statistical Diagnosis</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>通常在处理模型假设检验的问题时，统计推断是通过样本数据的观测信息来推断总体的主要方法，本文提出基于嵌套结构的分层线性回归模型的系数向量诊断方法，对于分层线性回归的第一层模型系数诊断主要利用传统的线性嵌套回归模型F检验进行统计推断。该论文的创新之处在于对分层线性回归模型的第二层系数进行统计诊断，利用嵌套多元线性回归模型推广到具有嵌套结构的分层线性回归模型中，主要构建分层线性回归模型似然函数比值来构造检验统计量。通过高校数学成绩分层数据进行分析，来验证该方法的有效性和可行性。</p></sec><sec id="s2"><title>关键词</title><p>分层线性模型，嵌套模型，似然比，统计推断</p></sec><sec id="s3"><title>Statistical Inference of Hierarchical Linear Regression Model Based on Nested Structure<sup> </sup></title><p>Mengyu Zhou<sup>1</sup>, Maozai Tian<sup>2,3*</sup></p><p><sup>1</sup>School of Statistics, Lanzhou University of Finance and Economics, Lanzhou Gansu</p><p><sup>2</sup>Scientific Research Center of Applied Statistics, Renmin University of China, Beijing</p><p><sup>3</sup>School of statistics, Renmin University of China, Beijing</p><p><img src="//html.hanspub.org/file/17-2580718x4_hanspub.png" /></p><p>Received: Jan. 25<sup>th</sup>, 2021; accepted: Feb. 19<sup>th</sup>, 2021; published: Feb. 26<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/17-2580718x6_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>Generally, when dealing with the problem of model hypothesis testing, statistical inference is the main method to infer the population through the observation information of sample data. In this paper, the coefficient vector diagnosis method of Hierarchical Linear Regression Model based on nested structure is proposed. For the first level model coefficient diagnosis of hierarchical linear regression, the traditional F-test of linear nested regression model is used for statistical inference. The innovation of this paper lies in the statistical diagnosis of the second layer coefficient of Hierarchical Linear Regression Model. The nested multiple linear regression model is extended to the Hierarchical Linear Regression Model with nested structure. The likelihood function ratio of Hierarchical Linear Regression Model is mainly constructed to construct the test statistics. The effectiveness and feasibility of this method is verified by the hierarchical data analysis of college mathematics scores.</p><p>Keywords:Hierarchical Linear Model, Nested Model, Likelihood Ratio, Statistical Diagnosis</p><disp-formula id="hanspub.40746-formula21"><graphic xlink:href="//html.hanspub.org/file/17-2580718x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/17-2580718x8_hanspub.png" /> <img src="//html.hanspub.org/file/17-2580718x9_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>在实际观测数据中，数据往往具有分层结构，具有嵌套和分层结构的数据均可以使用多层线性模型进行分析，多层线性模型在处理缺失数据时不影响参数估计精度的特征，相比于多元线性回归模型，处理纵向数据有较大优势，同时对于重复测量的次数和时间跨度没有严格要求。对于分层线性回归模型的描述，不同的文献中名称是有差异的，在社会学研究中，通常被称为多层线性模型(Goldstein [<xref ref-type="bibr" rid="hanspub.40746-ref1">1</xref>], 1997)，在生物计量学应用中，称为随机效应模型(Laird [<xref ref-type="bibr" rid="hanspub.40746-ref2">2</xref>], 1982)，在统计学文献中，一般称为协方差成分模型(Dempster [<xref ref-type="bibr" rid="hanspub.40746-ref3">3</xref>], 1981)。对分层线性回归模型未知参数一般分为对随机效应和固定效应两部分对应的回归系数和方差协方差部分进行估计，在本文中，主要考虑分层线性回归模型的回归系数诊断问题，对分层线性回归模型第一层回归系数进行回归诊断，即对应的为多元线性回归系数诊断问题，针对分层线性回归模型的第二层系数的回归诊断则有少量的参考文献，本文对分层线性第二层系数的回归诊断主要通过构造分层线性回归模型似然函数比的方法来进行统计推断。在多元线性回归模型中，吴喜之 [<xref ref-type="bibr" rid="hanspub.40746-ref4">4</xref>] (2016)用线性模型来近似因变量与自变量的线性关系，并给出线性模型中参数估计的方法和关于多自变量系数复合检验过程，谢宇 [<xref ref-type="bibr" rid="hanspub.40746-ref5">5</xref>] (2013)介绍了多元线性模型中嵌套模型的具体含义，并给出了嵌套模型多个回归系数的联合检验常用的F统计量，同时给出二分因变量嵌套模型的模型评价方法，但并没有给出分层线性嵌套模型的检验过程，Lindley &amp; Smith [<xref ref-type="bibr" rid="hanspub.40746-ref6">6</xref>] (1972)针对复杂的嵌套数据给出了分层线性模型的具体形式，并针对分层线性回归模型中的未知参数给出了具体的估计方法，田茂再 [<xref ref-type="bibr" rid="hanspub.40746-ref7">7</xref>] (2006)提出了基于Guass-Seidel迭代的条件分位分层线性回归模型的算法，解决了分层模型不能全面刻画高维情况下响应变量的条件分布问题，吴密霞 [<xref ref-type="bibr" rid="hanspub.40746-ref8">8</xref>] (2013)介绍了模型参数的似然比检验，给出了具体的假设过程，刘红云 [<xref ref-type="bibr" rid="hanspub.40746-ref9">9</xref>] (2005)介绍在追踪数据分析中，对于多层线性模型，可以利用Wald检验来对固定部分参数进行显著性检验。</p><p>对于回归模型的统计推断推广中，马海强 [<xref ref-type="bibr" rid="hanspub.40746-ref10">10</xref>] (2008)给出了变系数模型的统计诊断问题，戴林送 [<xref ref-type="bibr" rid="hanspub.40746-ref11">11</xref>] (2013)研究了广义泊松回归模型的统计诊断方法，Li &amp; Lee [<xref ref-type="bibr" rid="hanspub.40746-ref12">12</xref>] (2019)通过似然函数最大化拟合半参数零膨胀负二项分布回归模型，并通过似然比评价一个假设参数泛函形式的连续协变量效应的充分性，利用数据证明其方法的有效性。费宇 [<xref ref-type="bibr" rid="hanspub.40746-ref13">13</xref>] (2013)介绍了线性混合模型和广义线性混合模型的统计诊断方法。曾婕等 [<xref ref-type="bibr" rid="hanspub.40746-ref14">14</xref>] (2017)提出了结合残差、杠杆值和系数变化三者构造诊断统计量来诊断logistic回归模型中数据的异常点或强影响点问题。Chown &amp; Ursula [<xref ref-type="bibr" rid="hanspub.40746-ref15">15</xref>] (2019)介绍了一种多协变量非参数回归模型的异方差检验方法，利用局部多项式平滑构造残差，设计检测函数验证异方差。晏振等 [<xref ref-type="bibr" rid="hanspub.40746-ref16">16</xref>] (2016)利用杠杆值抽样后的大数据集来诊断异常点问题。梁晋雯 [<xref ref-type="bibr" rid="hanspub.40746-ref17">17</xref>] (2020)基于数据删失模型和均值漂移模型构建统计量进行异常点的诊断，研究体积抽样受异常点的影响。</p><p>本文基于线性回归模型的最小二乘方法得到参数的估计值，线性回归嵌套模型主要讨论增加一个变量的回归系数是否显著，与原本的回归系数是否有实质的改变，以此确定变量保留与否。基于线性回归模型中变量讨论的基础上，进一步讨论分层线性回归模型，这也是本文主要的创新点，利用具有嵌套结构的分层线性回归模型的似然函数的比值去判断分层线性嵌套模型假设的合理性。同时本文是基于同方差的基础上讨论的，对线性回归模型中异方差情况也有其他文章做过，这里不再详细说明。</p><p>在本文中，根据多元线性嵌套模型的含义，针对多元线性嵌套模型主要利用F统计量来检验限制性模型与非限制性模型的显著性问题，并通过波士顿房价来检验统计量的有效性，同时根据多元线性模型的嵌套结构，针对分层线性模型的嵌套结构进行合理的假设检验，主要通过构造具有嵌套结构的分层线性回归模型的似然函数的比值服从卡方分布，通过给定的拒绝域，来判断限制性分层回归模型和非限制性分层回归模型的显著性问题。</p></sec><sec id="s6"><title>2. 线性嵌套模型的统计推断</title><p>若我们只考虑分层线性模型的第一层系数的回归诊断，那分层线性模型就可直接理解为多元线性回归模型的回归诊断。为了更好的进行第一层模型统计诊断，现在将第一层模型进行形式上的变换，其实际意义并无影响。</p><p>我们考虑数据存在随机线性模型的一般形式，线性模型意味着假定因变量y和自变量x之间的关系可以用线性关系来近似(吴喜之 [<xref ref-type="bibr" rid="hanspub.40746-ref4">4</xref>] 2016)：</p><p>Y i = X i Τ β + ε i , i = 1 , ⋯ , n</p><p>其中， Y i 为 n &#215; 1 的观测向量， X i 为 n &#215; p 已知的向量矩阵， β 为待估计的未知参数， ε i 是模型所无法描述的随机误差项。通常情况下，随机误差 ε i 满足3个假设：1) E ( ε i ) = 0 ；2) V a r ( ε i ) = σ 2 ；3) C o v ( ε i , ε j ) = 0 ， i ≠ j 。经常情况下，人们把未知的 σ 2 假设为相等，若这一假定不成立，则称线性回归模型存在异方差性，在存在异方差性情况下用传统的最小二乘法估计模型参数，得到的参数估计量不是有效估计量，这里不再具体介绍异方差情况下的回归诊断情况，下面线性回归诊断是基于同方差情况下介绍的。</p><p>对于线性回归模型的待估计参数 β 常用的估计参数的方法是普通最小二乘法，其目的是使得 ε = y − x β 达到最小，即 S ( β ) = ( y − x β ) 2 达到最小。即对未知参数 β 求偏导数，令函数 S ( β ) 为零，可以得到：</p><p>β ^ = ( X ′ X ) − 1 X ′ y</p><p>如果一个模型中的自变量为另一个模型的自变量的子集或者子集的线性组合，则称两个模型为嵌套模型(谢宇 [<xref ref-type="bibr" rid="hanspub.40746-ref5">5</xref>] 2013)。一个模型子集或子集的线性组合的模型称为限制性模型，对应的另一个模型称为非限制性模型，限制性模型嵌套在非限制性模型中。</p><p>对多元线性回归模型的系数提出假设如下：</p><p>H 0 : Y = X 1 β 1 + X 2 β 2 + ε     vs     H 1 : Y = X 1 β 1 + X 2 β 2 + X 3 β 3 + ε</p><p>对应的检验统计量：</p><p>F j = ( S S E H 0 − S S E H 1 ) / ( k − g ) S S E H 1 / ( n − k − 1 )</p><p>其中， S S E H 0 为原假设 H 0 对应的残差平方和， S S E H 1 为备择假设 H 1 对应的残差平方和，也称为限制性模型和非限制模型的残差平方和(谢宇 [<xref ref-type="bibr" rid="hanspub.40746-ref5">5</xref>] 2013)。这里k对应备择假设模型所包含的回归系数的数量，则 n − k − 1 对应备择假设残差平方和的自由度。其中 k − g 这个自由度增量是备择假设与原假设对应模型之间回归系数个数的差值。</p><p>对于给定的显著水平 α ，检验的拒绝域为 F j &gt; F α ( 1 , n − k − 1 ) 。由于原假设去掉部分自变量，所以理论上原假设对应的残差平方和不小于备择假设的残差平方和。</p><p>由于这里原假设与备择假设对应模型之间只差一个参数，所以也可以使用t检验统计量 t d f 2 = F 1 , d f ~ t ( n − k − 1 ) ，对于给定的显著性水平 α ，检验的拒绝域为 | t j | &gt; t α / 2 ( n − k − 1 ) 。其中F统计量的第一自由度为1，这时既可以使用F统计量也可以使用t统计量。</p><p>对于上述嵌套结构的线性回归模型，同时也可以使用判定系数增量来解释回归模型拟合优度的问题，其具体为非限制性模型的判定系数减去限制性模型的判定系数(谢宇 [<xref ref-type="bibr" rid="hanspub.40746-ref5">5</xref>] 2013)，详细过程会从以影响波士顿房价因素的模拟中体现，通过构建多元限制性模型与非限制性模型的原假设与备择假设，来考虑加入每间住宅的平均房间数 x 1 这个自变量，通过方差分析来决定对这一变量是否保留的问题。</p><p>下面模拟数据来源于波士顿房价的部分数据，以自住房屋房价中位数为因变量y，以每间住宅的平均房间数为 x 1 ，波士顿的五个就业中心加权距离为 x 2 ，城镇的学生与教师比例为 x 3 ，我们构造的线性嵌套模型检验，原假设为限制性模型，以 x 2 ， x 3 为自变量，备择假设为非限制性模型，加入每间住宅的平均房间数这一变量，以 x 1 ， x 2 ， x 3 为自变量，具体表达为：</p><p>H 0 : y = β 2 x 2 + β 3 x 3 + ε     vs     H 1 : y = β 1 x 1 + β 2 x 2 + β 3 x 3 + ε</p><p>图1. 限制性模型的散点图</p><p>图2. 非限制模型的散点图</p><p>从图1和图2可以看出在影响波士顿房价的因素中，每间住宅的平均房间数 x 1 ，波士顿的五个就业中心加权距离 x 2 以及城镇的学生与教师比例 x 3 与自住房屋房价中位数y有明显的线性关系。针对这种多元线性回归模型，我们构造限制性模型与非限制性模型，构造统计量的进行检验，具体可从下面的方差分析表中看出。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Analysis of variance of restrictive model and unrestricted mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >模型</th><th align="center" valign="middle" >残差平方和</th><th align="center" valign="middle" >残差平方和的自由度</th><th align="center" valign="middle" >嵌套模型F值</th><th align="center" valign="middle" >嵌套模型F值对应P值</th><th align="center" valign="middle" >嵌套模型t值</th><th align="center" valign="middle" >判定系数</th></tr></thead><tr><td align="center" valign="middle" >y ~ x 2 , x 3</td><td align="center" valign="middle" >603.18</td><td align="center" valign="middle" >14</td><td align="center" valign="middle"  rowspan="2"  >28.255</td><td align="center" valign="middle"  rowspan="2"  >0.000</td><td align="center" valign="middle"  rowspan="2"  >5.316</td><td align="center" valign="middle" >0.067</td></tr><tr><td align="center" valign="middle" >y ~ x 1 , x 2 , x 3</td><td align="center" valign="middle" >190.09</td><td align="center" valign="middle" >13</td><td align="center" valign="middle" >0.706</td></tr></tbody></table></table-wrap><p>表1. 限制性模型与非限制性模型的方差分析表</p><p>根据表1方差分析表可以得到，嵌套模型对应的检验统计量计算得到F值为28.255，从而根据嵌套模型F值对应的P值是明显小于显著性水平0.05，所以拒绝原假设，接受备择假设，即非限制性模型通过了显著性检验。同时这里根据F值得到的t值为5.316是大于拒绝域2.160。同时也可以根据嵌套模型计算判定系数的增量，可以看出，当限制性模型加入自变量 x 1 ，判定系数R<sup>2</sup>增加，意味着更多的平方和被非限制性模型所解释。</p><p>在多元线性回归模型统计推断中，一般包括两个方面的内容：其一是对回归模型的整体检验，另一个是对回归系数的检验。多元线性回归与一元线性回归的方差分析大致相同，对于多元线性嵌套模型，我们常常利用构造F统计量来检测限制性模型的假设，若嵌套模型的原假设与备择假设的回归自变量只差一个回归系数，也可以使用t统计量来检验，但是对于两个不嵌套的模型是不能使用F统计量检验。同时对于嵌套模型，限制性模型自变量不仅可以是非限制性模型自变量的子集，而且非限制模型自变量也可以是限制性模型中自变量的线性组合。</p></sec><sec id="s7"><title>3. 具有嵌套结构的分层线性模型统计推断</title><p>在统计数据过程中，数据往往存在分层结构，例如研究高校间不同学生的学习情况，或用于研究国家经济发展的差异如何与成人教育程度相互作用，或研究临床药物的治疗方法的差异等，这些情况中存在嵌套问题的研究，分层线性回归模型给出了良好的模型结构。分层线性模型是由Lindley和Smith [<xref ref-type="bibr" rid="hanspub.40746-ref6">6</xref>] (1972)提出的，作为对线性模型的贝叶斯估计的重要贡献，同时对复杂的嵌套结构数据给出了通用的分层线性模型的形式。</p><p>这里以两层数据模型为例，给出两层分层线性模型的具体形式，假设有 ( X , Y ) 的一组独立同分布观测值 { ( X 1 , Y 1 ) , ( X 2 , Y 2 ) , ⋯ , ( X n , Y n ) } ，其中 Y i 是实数被解释变量的值， X i 是已知的 1 &#215; d 维第一层的解释变量， β i 是未知的 d &#215; 1 维系数向量，满足第一层模型(田茂再等 [<xref ref-type="bibr" rid="hanspub.40746-ref7">7</xref>] 2006)：</p><p>Y i = X i β i + r i ， r i ~ N ( 0 , σ 2 )</p><p>其中， r i 是i.i.d不可观测随机效应变量，假定与解释变量独立，并服从均值为0，方差为 σ 2 的正态分布。</p><p>在第二层模型中，第一层模型中系数向量作为被解释变量， γ 为固定效应向量， w i 为第二层已知的解释变量矩阵：</p><p>β i = w i γ + u i ， u i ~ N ( 0 , T )</p><p>其中， u i 是第二层 d &#215; 1 维随机效应向量，假定与第二层解释变量和 r i 独立，并服从均值向量为0，协方差为T的多元分布。</p><p>将第二层模型带入第一层模型中，得到下列形式(Raudenbush和Bryk [<xref ref-type="bibr" rid="hanspub.40746-ref18">18</xref>] 1992)：</p><p>Y i = X i w i γ + X i u i + r i ， i = 1 , ⋯ , n</p><p>上述模型也称为线性混合模型，可以用于分析处理纵向数据和面板数据等各类重复测量数据，相比线性模型，对观测值的协方差矩阵可以有更灵活的设定，同时对于随机效应部分给出更方便和合理的假设。</p><p>关于对二分因变量进行嵌套模型分析的统计方法(谢宇 [<xref ref-type="bibr" rid="hanspub.40746-ref5">5</xref>] 2013)，其目的在于估计和预测成功或失败的概率是否受到协变量的影响。二分因变量解释为其取值只有两种可能，也通常称为0-1变量，常用于处理二分因变量的模型为logit模型。针对存在嵌套关系的二分因变量，常通过进行对数似然比检验来判断模型的拟合优度更佳问题，即具体为两个嵌套模型之间的对数似然比之差构造统计量，其统计量服从 χ 2 分布，相应为的统计量形式为：</p><p>Δ G 2 = G r 2 − G u 2</p><p>其中， G r 2 表示约束模型的对数似然比， G u 2 为无约束模型的对数似然比，则二分因变量嵌套模型服从的 χ 2 分布对应的自由度为无约束模型的残差自由度与约束模型的残差自由度之差。</p><p>对于上述多元线性回归模型的假定检验和二分因变量的嵌套模型检验，扩展到分层线性回归模型下，对于分层线性模型中未知参数估计主要是估计固定效应的回归系数和随机效应的方差协方差部分，具体可根据Raudenbush [<xref ref-type="bibr" rid="hanspub.40746-ref18">18</xref>] (1992)提出的利用完全数据充分统计量的条件期望代替期望步进行的迭代过程得到，这里不具体讨论参数估计过程，下面内容主要是得出分层线性模型的似然函数。</p><p>将第二层模型带入到第一层模型中， Y i 具有线性混合模型形式，已知第一层随机误差 r i ~ N ( 0 , σ 2 ) 和第二层随机误差 u i ~ N ( 0 , T ) ，所以线性混合模型 Y i 服从 y ~ N ( x w r , V ) ，相应的， V = x T x Τ + σ 2 I n 。从而给出分层线性模型的似然函数为：</p><p>L ( y ) = ∏ j = 1 J [ ( 2 π ) − n 2 | V | 1 2 exp { − 1 2 ( Y − X w r ) Τ V − 1 ( Y − X w r ) } ] = ∏ j = 1 J [ ( 2 π ) − n 2 | x j τ x j Τ + σ 2 I n | 1 2 exp { − 1 2 ( Y − X w r ) Τ | x j τ x j Τ + σ 2 I n | − 1 ( Y − X w r ) } ] = ( 2 π ) − n 2 2 | x j τ x j Τ + σ 2 I n | n 2 exp { − 1 2 ∑ i = 1 n ( Y − X w r ) Τ | x j τ x j Τ + σ 2 I n | − 1 ( Y − X w r ) }</p><p>其中， T = d i a g ( τ , ⋯ , τ ) ，且 j = 1 , ⋯ , J 。</p><p>根据上述内容，下面给出具有嵌套结构的分层线性模型的一般假定情况：</p><p>零假设情况下：</p><p>第一层： Y 1 = X β 1 + ε 1 ， ε 1 ~ N ( 0 , σ 1 2 )</p><p>第二层： β 1 ~ N ( w 1 r , T 1 )</p><p>备择假设情况下：</p><p>第一层： Y 2 = X 1 β 1 + X 2 β 2 + ε 2 ， ε 2 ~ N ( 0 , σ 2 2 )</p><p>第二层： ( β 1 β 2 ) ~ N ( ( w 1 r w 2 r ) , T 2 )</p><p>假设 L n ( θ | y ) 是参数 θ 的似然函数，其中 y = ( y 1 , ⋯ , y n ) ′ 是一个样本容量为n的样本，参数 θ 的参数空间为 Ω ，检验问题为 H 0 : θ ∈ Ω 0   vs   H 1 : θ ∉ Ω 0 ，则统计量定义似然比(吴密霞 [<xref ref-type="bibr" rid="hanspub.40746-ref8">8</xref>] 2013)为：</p><p>L R n ( y ) = sup θ ∈ Ω 0 L n ( θ | y ) sup θ ∈ Ω L n ( θ | y )</p><p>在多元分析过程中，似然比检验是常用的检验方法，统计量利用经典似然函数的比值构造为： Λ ( x 1 , ⋯ , x n ) = L ( H 0 ) / L ( H 1 ) 。这里我们构造分层嵌套检验的似然比，原假设为限制性分层线性回归模型，备择假设为非限制性分层线性回归模型，从而构造分层线性回归模型的似然比检验统计量。</p><p>零假设情况下似然函数：</p><p>L ( H 0 ) = ∏ i = 1 n [ ( 2 π ) − n 2 | V 1 | 1 2 exp { − 1 2 ( Y 1 i − X 1 i w 1 r ) Τ V 1 − 1 ( Y 1 i − X 1 i w 1 r ) } ]</p><p>其中， V 1 = x 1 T 1 x 1 Τ + σ 1 2 I n 。</p><p>备择假设情况下似然函数：</p><p>L ( H 1 ) = ∏ i = 1 n [ ( 2 π ) − n 2 | V 2 | 1 2 exp { 1 2 ( Y 2 i − X 1 i w 1 r − X 2 i w 2 r ) Τ V 2 − 1 ( Y 2 i − X 1 i w 1 r − X 2 i w 2 r ) } ]</p><p>其中， V 2 = x 1 T 1 x 1 Τ + x 2 T 2 x 2 Τ + σ 2 2 I n 。</p><p>则构造统计量为：</p><p>L ( H 0 ) L ( H 1 ) = ∏ i = 1 n [ ( 2 π ) − n 2 | V 1 | 1 2 exp { − 1 2 ( Y 1 i − X 1 i w 1 r ) Τ V 1 − 1 ( Y 1 i − X 1 i w 1 r ) } ] ∏ i = 1 n [ ( 2 π ) − n 2 | V 2 | 1 2 exp { − 1 2 ( Y 2 i − X 1 i w 1 r − X 2 i w 2 r ) Τ V 2 − 1 ( Y 2 i − X 1 i w 1 r − X 2 i w 2 r ) } ] = | V 1 | 1 2 exp { − 1 2 ∑ i = 1 n ( Y 1 i − X 1 i w 1 r ) Τ V 1 − 1 ( Y 1 i − X 1 i w 1 r ) } | V 2 | 1 2 exp { − 1 2 ∑ i = 1 n ( Y 2 i − X 1 i w 1 r − X 2 i w 2 r ) Τ V 2 − 1 ( Y 2 i − X 1 i w 1 r − X 2 i w 2 r ) }</p><p>其中，分子表示原假设的似然函数最大值，分母表示备择假设下的似然函数最大值，如果统计量的值很大，说明原假设情况的可能性比备择假设情况下的可能性要小，于是，我们有理由认为原假设不成立。</p><p>在多层线性模型中，对模型单个自变量参数估计值的统计诊断，可以通过极大似然估计得到固定部分参数估计结果已经对应的标准误，对于固定部分的显著性检验，可以用参数估计值除以标准误，即对应的 γ / s e ( γ ) 进行(刘红云 [<xref ref-type="bibr" rid="hanspub.40746-ref9">9</xref>] 2005)。</p><p>对于多层嵌套线性回归模型，构造统计量为：</p><p>Λ ( x 1 , ⋯ , x n ) = L ( H 0 ) L ( H 1 )</p><p>该统计量服从 χ 2 分布，其自由度等于备择假设参数的个数减去原假设中参数的个数，对于给出的分层线性回归零假设与备择假设情况，这里 χ 2 分布对应的自由度为1。</p><p>在显著性水平 α 下，其拒绝域为： W = { χ 2 &lt; χ 1 2 = c } ，如果落入拒绝域中，说明统计诊断不显著，则拒绝原假设，接受备择假设非限制性分层线性模型。</p></sec><sec id="s8"><title>4. 数据分析</title><p>下面数据来自于160所学校7185名学生数学成绩，采用分层线性回归模型对数据进行分析，这里我们选取其中的部分数据进行嵌套分层线性回归模型分析，对于第一层水平，即学生层面，这里选取MATHACH (学生的数学成绩)作为因变量，即 Y i j ，FEMALE(学生性别) (1表示女性，0表示男性)，SES (学生社会地位)由学生父母受教育程度、职业和收入合成作为自变量。对于第二层水平下，即学校层面，这里选取MEANSES (包含在水平1数据中，每个学校学生的平均社会地位)，DISCLIM (学科氛围)，SIZE (学校招生人数)作为第二层自变量。这里，构建限制性分层线性模型为：MATHACH作为第j所学校第i个学生因变量 Y i j ，SES作为第一层水平下第j所学校第i个学生自变量 X 1 i ，MEANSES和DISCLIM作为第二层水平下第j所学校的自变量，即 w 0 和 w 1 ，非限制性分层线性模型构建为MATHACH作为第j所学校第i个学生因变量 Y i j ，SES和FEMALE作为第一层水平下第j所学校第i个学生自变量 X 1 i 和 X 2 i ，MEANSES和DISCLIM和SIZE作为第二层水平下第j所学校的自变量，即 w 0 ， w 1 和 w 2 ，具体模型构建形式如下：</p><p>原假设为：</p><p>第一层： Y i j = β 0 j + β 1 j ∗ S E S i j + ε i j</p><p>第二层： β 0 j = γ 00 + γ 01 ∗ M E A N S E S j + u 0 j β 1 j = γ 10 + γ 11 ∗ D I S C L I M j</p><p>将第二层模型带入第一层模型得到的混合效应模型为：</p><p>Y i j = γ 00 + γ 01 ∗ M E A N S E S j + γ 10 ∗ S E S i j + γ 11 ∗ D I S C L I M j ∗ S E S i j + u 0 j + ε i j</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Estimation of fixed effects in null hypothesis hierarchical linear mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  colspan="2"  >固定效应</th><th align="center" valign="middle" >系数</th><th align="center" valign="middle" >标准误</th><th align="center" valign="middle" >t-ratio</th><th align="center" valign="middle" >d.f.</th><th align="center" valign="middle" >p值</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >β 0</td><td align="center" valign="middle" >γ 00</td><td align="center" valign="middle" >12.746</td><td align="center" valign="middle" >0.149</td><td align="center" valign="middle" >85.705</td><td align="center" valign="middle" >158</td><td align="center" valign="middle" >&lt;0.001</td></tr><tr><td align="center" valign="middle" >γ 01</td><td align="center" valign="middle" >3.739</td><td align="center" valign="middle" >0.374</td><td align="center" valign="middle" >9.987</td><td align="center" valign="middle" >158</td><td align="center" valign="middle" >&lt;0.001</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >β 1</td><td align="center" valign="middle" >γ 10</td><td align="center" valign="middle" >2.215</td><td align="center" valign="middle" >0.109</td><td align="center" valign="middle" >20.403</td><td align="center" valign="middle" >7023</td><td align="center" valign="middle" >&lt;0.001</td></tr><tr><td align="center" valign="middle" >γ 11</td><td align="center" valign="middle" >0.604</td><td align="center" valign="middle" >0.112</td><td align="center" valign="middle" >5.418</td><td align="center" valign="middle" >7023</td><td align="center" valign="middle" >&lt;0.001</td></tr></tbody></table></table-wrap><p>表2. 原假设分层线性模型中固定效应估计</p><p>表2经过6次迭代对数似然函数变化值达到最小后停止，给出了在原假设情况下固定效应变量的系数估计值和对应的标准误，其中固定效应是通过最小二乘估计得到的，通过p值可以看出变量系数估计值都通过了检验，同时分层线性回归模型第一层对应的方差为36.887。</p><p>备择假设为：</p><p>第一层： Y i j = β 0 j + β 1 j ∗ F E M A L E i j + β 2 j ∗ S E S i j + ε i j</p><p>第二层： β 0 j = γ 00 + γ 01 ∗ M E A N S E S j + u 0 j β 1 j = γ 10 + γ 11 ∗ S I Z E j β 2 j = γ 20 + γ 21 ∗ D I S C L I M j</p><p>将第二层模型带入到第一层中得到备择假设的混合效应模型：</p><p>Y i j = γ 00 + γ 01 ∗ M E A N S E S j + γ 10 ∗ F E M A L E i j + γ 11 ∗ S I Z E j ∗ F E M A L E i j + γ 20 ∗ S E S i j + γ 21 ∗ D I S C L I M j ∗ S E S i j + u 0 j + ε i j</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Estimation of fixed effects in alternative hypothesis hierarchical linear mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  colspan="2"  >固定效应</th><th align="center" valign="middle" >系数</th><th align="center" valign="middle" >标准误</th><th align="center" valign="middle" >t-ratio</th><th align="center" valign="middle" >d.f.</th><th align="center" valign="middle" >p值</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >β 0</td><td align="center" valign="middle" >γ 00</td><td align="center" valign="middle" >13.344</td><td align="center" valign="middle" >0.168</td><td align="center" valign="middle" >79.313</td><td align="center" valign="middle" >158</td><td align="center" valign="middle" >&lt;0.001</td></tr><tr><td align="center" valign="middle" >γ 01</td><td align="center" valign="middle" >3.627</td><td align="center" valign="middle" >0.367</td><td align="center" valign="middle" >9.885</td><td align="center" valign="middle" >158</td><td align="center" valign="middle" >&lt;0.001</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >β 1</td><td align="center" valign="middle" >γ 10</td><td align="center" valign="middle" >-0.524</td><td align="center" valign="middle" >0.298</td><td align="center" valign="middle" >-1.760</td><td align="center" valign="middle" >7021</td><td align="center" valign="middle" >0.078</td></tr><tr><td align="center" valign="middle" >γ 11</td><td align="center" valign="middle" >-0.001</td><td align="center" valign="middle" >0.000</td><td align="center" valign="middle" >-2.603</td><td align="center" valign="middle" >7021</td><td align="center" valign="middle" >0.009</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >β 2</td><td align="center" valign="middle" >γ 20</td><td align="center" valign="middle" >2.178</td><td align="center" valign="middle" >0.108</td><td align="center" valign="middle" >20.111</td><td align="center" valign="middle" >7021</td><td align="center" valign="middle" >&lt;0.001</td></tr><tr><td align="center" valign="middle" >γ 21</td><td align="center" valign="middle" >0.602</td><td align="center" valign="middle" >0.111</td><td align="center" valign="middle" >5.426</td><td align="center" valign="middle" >7021</td><td align="center" valign="middle" >&lt;0.001</td></tr></tbody></table></table-wrap><p>表3. 备择假设分层线性模型中固定效应估计</p><p>从表3经过6次迭代似然函数变化值达到最小，可以看出对备择假设情况下分层线性回归模型中固定效应相对应的系数估计值，且显著性检验大多在显著性水平为0.05通过了检验，系数 γ 10 在显著性水平0.01下没有通过显著性检验，同时第一层水平对应的方差为36.628。</p><p>通过计算可以得到嵌套模型分层线性的似然比结果为1.001，对应的，在显著性水平 α = 0.01 下， χ 1 2 的值为0.0002，根据给定拒绝域，所以不能拒绝原假设，故接受原假设，即接受限制性分层线性模型，说明从学校层面上引入学校招收人数变量，从学生层面引入性别这一变量，对高校学生数学成绩没有显著影响。</p></sec><sec id="s9"><title>5. 小结</title><p>本文通过多元线性嵌套模型的假设检验过程，提出具有嵌套结构的分层线性回归模型的假设检验，通过分层线性模型的似然函数比值构造检验统计量，来判断分层线性模型对于引入新的变量能否保留给出对应的理论依据，同时通过高校数学成绩数据分析分层线性模型假设检验的可行性和构造的具有嵌套结构似然比统计量的实用性。</p></sec><sec id="s10"><title>文章引用</title><p>周梦雨,田茂再. 基于嵌套结构的分层线性回归模型的统计推断Statistical Inference of Hierarchical Linear Regression Model Based on Nested Structure[J]. 统计学与应用, 2021, 10(01): 173-182. https://doi.org/10.12677/SA.2021.101017</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.40746-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Courgeau, D. and Goldstein, H. (1997) Multilevel Statistical Models. Population, 52, 1043-1046.  
https://doi.org/10.2307/1534624</mixed-citation></ref><ref id="hanspub.40746-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Laird, N.M. (1982) Random Effects Model for Longitudinal Data. Biometrics, 38, 963-974.  
https://doi.org/10.2307/2529876</mixed-citation></ref><ref id="hanspub.40746-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Dempster, A.P. and Tsutakawa, D.B.R.K. (1981) Estimation in Covariance Components Models. Journal of the American Statistical Association, 76, 341-353. https://doi.org/10.1080/01621459.1981.10477653</mixed-citation></ref><ref id="hanspub.40746-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">吴喜之. 应用回归及分类: 基于R [M]. 北京: 中国人民大学出版社, 2016.</mixed-citation></ref><ref id="hanspub.40746-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">谢宇. 回归分析[M]. 第2版. 北京: 社会科学文献出版社, 2013.</mixed-citation></ref><ref id="hanspub.40746-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Smith, D.V.L.F.M. (1972) Bayes Estimates for the Linear Model. Journal of the Royal Statistical Society, 34, 1-41.  
https://doi.org/10.1111/j.2517-6161.1972.tb00885.x</mixed-citation></ref><ref id="hanspub.40746-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">田茂再, 陈歌迈. 条件分位中的分层线性回归模型[J]. 中国科学A辑, 2006, 36(10): 1103-1118.</mixed-citation></ref><ref id="hanspub.40746-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">吴密霞. 线性混合效应模型引论[M]. 北京: 科学出版社, 2013.</mixed-citation></ref><ref id="hanspub.40746-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">刘红云. 追踪数据分析方法及其应用[M]. 北京: 教育科学出版社, 2005.</mixed-citation></ref><ref id="hanspub.40746-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">马海强. 变系数模型的统计诊断和影响分析[D]: [硕士学位论文]. 长沙: 中南大学, 2008.</mixed-citation></ref><ref id="hanspub.40746-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">戴林送, 林金官. 广义泊松回归模型的统计诊断[J]. 统计与决策, 2013(21): 29-33.</mixed-citation></ref><ref id="hanspub.40746-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Li, C.S., Lee, S.M. and Yeh, M.S. (2019) A Test for Lack-of-Fit of Zero-Inflated Negative Binomial Models. Journal of Statal Computation and Simulation, 89, 1301-1321. https://doi.org/10.1080/00949655.2019.1577856</mixed-citation></ref><ref id="hanspub.40746-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">费宇. 线性和广义线性混合模型及其统计诊断[M]. 北京: 科学出版社, 2013.</mixed-citation></ref><ref id="hanspub.40746-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">曾婕, 胡国治. Logistic回归模型的统计诊断[J]. 数理统计与管理, 2017, 36(4): 620-631.</mixed-citation></ref><ref id="hanspub.40746-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Chown, J. and Müller, U.U. (2019) Corrigendum: Detecting Heteroscedasticity in Non-Parametric Regression Using Weighted Empirical Processes. Journal of the Royal Statistical Society Series B (Statistical Methodology), 81, 805-806.  
https://doi.org/10.1111/rssb.12324</mixed-citation></ref><ref id="hanspub.40746-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">晏振, 戴晓文, 田茂再. 基于杠杆值大数据集抽样的异常点诊断[J]. 数理统计与管理, 2016, 35(5): 794-802.</mixed-citation></ref><ref id="hanspub.40746-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">梁晋雯, 田茂再. 大数据下基于体积抽样的异常点诊断及估计问题[J]. 数理统计与管理, 2020, 39(2): 223-235.</mixed-citation></ref><ref id="hanspub.40746-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Bryk, A.S. and Raudenbush, S.W. (1992) Hierarchical Linear Models: Applications and Data Analysis Methods. Journal of the American Statistical Association, 98, 436-450.</mixed-citation></ref></ref-list></back></article>