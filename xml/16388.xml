<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">MOS</journal-id><journal-title-group><journal-title>Modeling and Simulation</journal-title></journal-title-group><issn pub-type="epub">2324-8696</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/MOS.2015.44011</article-id><article-id pub-id-type="publisher-id">MOS-16388</article-id><article-categories><subj-group subj-group-type="heading"><subject>MOS20150400000_65403084.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject><subject> 工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于小波回声状态网络的时间序列预测
  Prediction of Time Series Based on Wavelet Echo State Network
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>天慧</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>周</surname><given-names>玉国</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>卢</surname><given-names>燕</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>青岛理工大学自动化工程学院，山东 青岛</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>liutianhui7217@163.com(刘天)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>23</day><month>11</month><year>2015</year></pub-date><volume>04</volume><issue>04</issue><fpage>87</fpage><lpage>94</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  为了更好的对具有多尺度特性的时间序列进行预测，运用小波分析方法与回声状态网络模型相结合来创建小波回声状态网络预测模型。利用小波方法对原始时间序列进行处理，获得不同层上的细节部分序列和概貌部分序列，根据不同层上的序列特性分别创建与之相匹配的回声状态网络模型从而得到各层预测数据，将各层预测数据进行拟合，最终得到原始时间序列的预测结果。通过对某国国民生产总值的仿真研究表明，该模型能够很好的拟合时间序列的发展趋势，预测精度较高。
   In order to forecast time series with multi-scale characteristics better, the echo state network model is combined with wavelet analysis method to create a new prediction model which is wavelet echo state network. The original time series are processed with the Mallat algorithm and Dau-bechies wavelet based on wavelet multi-scale analysis theory that can respectively get the details of the different layers and overview part of sequences. Then different echo state network forecasting models are respectively created based on the different sequence characteristics to forecast and eventually add the forecast data of detail sequences and overview sequence to obtain the original time series prediction result. The simulation examples of forecast model for a country gross national product show that this model can well fit the development trend of time series and the forecast accuracy is higher.
 
</p></abstract><kwd-group><kwd>预测，时间序列分析，小波分析，回声状态网络, Forecast</kwd><kwd> Time Series Analysis</kwd><kwd> Wavelet Analysis</kwd><kwd> Echo State Network</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于小波回声状态网络的时间序列预测<sup> </sup></title><p>刘天慧，周玉国，卢燕</p><p>青岛理工大学自动化工程学院，山东 青岛</p><disp-formula id="hanspub.16388-formula24"><graphic xlink:href="http://html.hanspub.org/file/1-2570085x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2015年10月29日；录用日期：2015年11月14日；发布日期：2015年11月23日</p><disp-formula id="hanspub.16388-formula25"><graphic xlink:href="http://html.hanspub.org/file/1-2570085x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为了更好的对具有多尺度特性的时间序列进行预测，运用小波分析方法与回声状态网络模型相结合来创建小波回声状态网络预测模型。利用小波方法对原始时间序列进行处理，获得不同层上的细节部分序列和概貌部分序列，根据不同层上的序列特性分别创建与之相匹配的回声状态网络模型从而得到各层预测数据，将各层预测数据进行拟合，最终得到原始时间序列的预测结果。通过对某国国民生产总值的仿真研究表明，该模型能够很好的拟合时间序列的发展趋势，预测精度较高。</p><p>关键词 :预测，时间序列分析，小波分析，回声状态网络</p><disp-formula id="hanspub.16388-formula26"><graphic xlink:href="http://html.hanspub.org/file/1-2570085x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>在实际应用中，获得的时间序列通常表现出非线性、非平稳性及快速变化性等动态特性，对这些时间序列进行准确的预测具有很大的挑战。因此，在面向时间序列预测的模型中研究融合了人工神经网络等智能算法。这些智能算法在各自的领域中取得了不同的预测效果。其中，递归神经网络以其良好的非线性逼近能力，被广泛应用于非线性时间序列预测问题中，并得到了学术界广泛的认同。但是，由于递归神经网络训练算法计算量过大，收敛速度缓慢，训练效率低等问题，限制了它的进一步发展及在实际中的应用。回声状态网络选用“储备池”取代传统递归神经网络的隐含层，简化了模型训练过程，只针对部分连接权进行训练，解决了传统递归神经网络训练算法繁杂，训练时间长，易陷入局部最优等一系列难题。</p><p>在实际预测中，对于同一组数据采用不同预测方法得到的预测值是不同的，有的预测结果往往差别很大。因此，针对不同预测方法的优缺点，可以把多种预测方法进行融合，从而创建出一种新的预测模型来实现数据预测，这种新的模型能够充分有效的整合大量有效信息，在最大程度上提高数据的预测精度。</p><p>为了更好的对具有多尺度特性的时间序列进行预测，本文运用小波分析方法与回声状态网络模型相结合来创建小波回声状态网络预测模型。利用小波方法对原始时间序列进行处理，获得不同层上的细节部分序列和概貌部分序列，根据不同层上的序列特性分别创建与之相匹配的回声状态网络模型从而得到各层预测数据，将各层预测数据进行拟合，最终得到原始时间序列的预测结果。通过对某国国民生产总值的仿真研究表明，该模型能够很好的拟合时间序列的发展趋势，预测精度较高。</p></sec><sec id="s4"><title>2. 小波回声状态网络模型</title><p>小波回声状态网络模型首先利用小波分析的方法对时间序列进行分解与重构，分别得到不同层上的细节部分序列和概貌部分序列，针对不同层上的序列特性分别创建相应的回声状态网络，将各层回声状态网络模型的预测数据进行拟合，最终得到原始时间序列的预测结果，以此来提高数据预测精度。模型结构如图1所示。</p><p>小波回声状态网络模型由三部分构成，分别是小波分解与重构、各层回声状态网络模型创建、各层预测数据拟合。</p><sec id="s4_1"><title>2.1. 小波分解与重构</title><p>小波分解与重构是对多尺度时间序列分析的经典方法，本文选用Mallat算法来完成原始时间序列数</p><p>图1. 小波回声状态网络模型结构图</p><p>据的小波分解，Mallat算法具体如下[<xref ref-type="bibr" rid="hanspub.16388-ref1">1</xref>] ：</p><disp-formula id="hanspub.16388-formula27"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x11_hanspub.png" xlink:type="simple"/></inline-formula>表示低通滤波器，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x12_hanspub.png" xlink:type="simple"/></inline-formula>表示高通滤波器。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x13_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x14_hanspub.png" xlink:type="simple"/></inline-formula>分别表示原始时间序列分解在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x15_hanspub.png" xlink:type="simple"/></inline-formula>下的概貌信号和细节信号，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x16_hanspub.png" xlink:type="simple"/></inline-formula>，当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x17_hanspub.png" xlink:type="simple"/></inline-formula>时，有<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x18_hanspub.png" xlink:type="simple"/></inline-formula>为原始信号，即0尺度上的信号。</p><p>在运用小波分解算法(1)对原始时间序列进行小波分解以后，生成的概貌信号和细节信号在信号点数上总是要比分解前的信号点数缩减一半，但信号点数的缩减对于预测过程是非常不利的。为了解决以上问题，通过一些算法将分解后的概貌信号和细节信号重新进行重构，重构算法[<xref ref-type="bibr" rid="hanspub.16388-ref2">2</xref>] 如下：</p><disp-formula id="hanspub.16388-formula28"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x19_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x20_hanspub.png" xlink:type="simple"/></inline-formula>表示为H的对偶算子，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x21_hanspub.png" xlink:type="simple"/></inline-formula>表示为G的对偶算子。在运用重构算法(2)对小波分解后的概貌信号和细节信号进行重构以后可以增加信号的点数。对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x22_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x23_hanspub.png" xlink:type="simple"/></inline-formula>分别进行重构，得到第1层、第2层…第J层细节信号的重构结果<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x24_hanspub.png" xlink:type="simple"/></inline-formula>和第J层概貌信号的重构结果<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x25_hanspub.png" xlink:type="simple"/></inline-formula>，并且它们同原始信号<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x26_hanspub.png" xlink:type="simple"/></inline-formula>的点数是一样的。</p></sec><sec id="s4_2"><title>2.2. 回声状态网络模型</title><sec id="s4_2_1"><title>2.2.1. 回声状态网络模型结构</title><p>回声状态网络是一种新型的递归神经网络[<xref ref-type="bibr" rid="hanspub.16388-ref3">3</xref>] ，它是通过创建一个大规模的“储备池”代替传统神经网络的隐层作来对系统的动态信息进行处理。回声状态网络的模型结构如图2所示。</p><p>回声状态网络由三部分组成，分别为输入层、储备池和输出层。输入信号<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x27_hanspub.png" xlink:type="simple"/></inline-formula>与储备池之间经由输入连接权矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x28_hanspub.png" xlink:type="simple"/></inline-formula>连接，储备池中有许多随机分布的神经元，神经元节点之间经由内部连接权矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x29_hanspub.png" xlink:type="simple"/></inline-formula>实现相互连接，网络输出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x30_hanspub.png" xlink:type="simple"/></inline-formula>经由反馈连接权矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x31_hanspub.png" xlink:type="simple"/></inline-formula>反馈到储备池，内部状态向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x32_hanspub.png" xlink:type="simple"/></inline-formula>则由神经元的输出组成，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x33_hanspub.png" xlink:type="simple"/></inline-formula>经由输出连接权矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x34_hanspub.png" xlink:type="simple"/></inline-formula>与输出层进行连接。储备池的主要作用就是对输入信号进行处理，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x35_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x36_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x37_hanspub.png" xlink:type="simple"/></inline-formula>在网络初始化阶段随机产生，在其后的训练过程中保持不变，不需要再对其进行训练。输出层的神经元数目与输入数目相等，其输出神经元是由一系列平行的神经元构成。在回声状态网络中，只需要对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x38_hanspub.png" xlink:type="simple"/></inline-formula>这一个输出连接权进行训练，而且训练过程十分简单，只需要求解一个线性回归问题。</p><p>假设回声状态网络具有<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x39_hanspub.png" xlink:type="simple"/></inline-formula>个输入单元、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x40_hanspub.png" xlink:type="simple"/></inline-formula>个输出单元、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x41_hanspub.png" xlink:type="simple"/></inline-formula>个内部信号处理单元。则输入数据单元<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x42_hanspub.png" xlink:type="simple"/></inline-formula>、输出数据单元<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x43_hanspub.png" xlink:type="simple"/></inline-formula>以及系统内部状态变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x44_hanspub.png" xlink:type="simple"/></inline-formula>在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x45_hanspub.png" xlink:type="simple"/></inline-formula>时刻的取值为[<xref ref-type="bibr" rid="hanspub.16388-ref4">4</xref>] ：</p><disp-formula id="hanspub.16388-formula29"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x46_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.16388-formula30"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x47_hanspub.png"  xlink:type="simple"/></disp-formula><p>图2. 回声状态网络模型结构图</p><disp-formula id="hanspub.16388-formula31"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x49_hanspub.png"  xlink:type="simple"/></disp-formula><p>储备池内部状态更新方程如下式：</p><disp-formula id="hanspub.16388-formula32"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x50_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x51_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x52_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x53_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x54_hanspub.png" xlink:type="simple"/></inline-formula>为内部神经元激活函数，通常情况下，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x55_hanspub.png" xlink:type="simple"/></inline-formula>采用双曲正切函数。</p><p>网络的输出方程如下式：</p><disp-formula id="hanspub.16388-formula33"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x56_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s4_2_2"><title>2.2.2. 回声状态网络的训练算法</title><p>对回声状态网络进行训练其实就是对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x57_hanspub.png" xlink:type="simple"/></inline-formula>进行训练的过程，通过预先给定的教师样本数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x58_hanspub.png" xlink:type="simple"/></inline-formula>来训练出与之相匹配的输出连接权矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x59_hanspub.png" xlink:type="simple"/></inline-formula>。假设反馈连接权<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x60_hanspub.png" xlink:type="simple"/></inline-formula>，同时假设输入到输出连接权也等于0。回声状态网络的训练过程一共有两个阶段：动态采样阶段、权值计算阶段[<xref ref-type="bibr" rid="hanspub.16388-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.16388-ref6">6</xref>] 。</p><p>1) 动态采样阶段</p><p>首先对网络进行初始化，随机生成网络的初始状态，一般情况下，取内部状态向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x61_hanspub.png" xlink:type="simple"/></inline-formula>。从0到T时刻，把教师样本输入数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x62_hanspub.png" xlink:type="simple"/></inline-formula>通过输入连接权<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x63_hanspub.png" xlink:type="simple"/></inline-formula>连接到储备池，同时把输出数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x64_hanspub.png" xlink:type="simple"/></inline-formula>通过反馈连接权<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x65_hanspub.png" xlink:type="simple"/></inline-formula>连接到储备池，然后根据储备池内部状态更新方程，实现系统内部状态的计算，以及完成相应输出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x66_hanspub.png" xlink:type="simple"/></inline-formula>的计算与收集。需要注意的是，每个时刻的内部状态<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x67_hanspub.png" xlink:type="simple"/></inline-formula>的计算，都应该把教师样本数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x68_hanspub.png" xlink:type="simple"/></inline-formula>写入到输出单元。假设从T<sub>0</sub>时刻开始，网络趋于稳定，为了消除任意选定的初始状态对系统动态特性的影响，则从T<sub>0</sub>开始收集系统内部状态变量、相应的输入部分和输出部分，从T<sub>0</sub>时刻开始，能够认为系统反映的是输入、输出样本数据之间的映射关系，以向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x70_hanspub.png" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x69_hanspub.png" xlink:type="simple"/></inline-formula>为行构成矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x71_hanspub.png" xlink:type="simple"/></inline-formula>，同时以相应的样本数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x72_hanspub.png" xlink:type="simple"/></inline-formula>构成一个列向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x73_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>2) 权值计算</p><p>在权值计算阶段，通过在动态采样阶段收集的系统内部状态矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x74_hanspub.png" xlink:type="simple"/></inline-formula>和教师样本数据来求解出输出连接权<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x75_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>由于系统内部状态变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x76_hanspub.png" xlink:type="simple"/></inline-formula>和系统实际输出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x77_hanspub.png" xlink:type="simple"/></inline-formula>呈现线性关系，同时网络进行训练的目标是让网络的实际输出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x78_hanspub.png" xlink:type="simple"/></inline-formula>最大可能的逼近期望输出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x79_hanspub.png" xlink:type="simple"/></inline-formula>，即</p><disp-formula id="hanspub.16388-formula34"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x80_hanspub.png"  xlink:type="simple"/></disp-formula><p>使计算权值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x81_hanspub.png" xlink:type="simple"/></inline-formula>(<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x82_hanspub.png" xlink:type="simple"/></inline-formula>属于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x83_hanspub.png" xlink:type="simple"/></inline-formula>)实现系统的均方误差最小化，则需求解如下的最优化问题[<xref ref-type="bibr" rid="hanspub.16388-ref7">7</xref>] ：</p><disp-formula id="hanspub.16388-formula35"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x84_hanspub.png"  xlink:type="simple"/></disp-formula><p>在数学的观点中，以上问题是一个线性回归问题，可以归结为求矩阵B的伪逆矩阵的问题，即</p><disp-formula id="hanspub.16388-formula36"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2570085x85_hanspub.png"  xlink:type="simple"/></disp-formula><p>这样就确定了回声状态网络模型的所有的参数，完成了对回声状态网络的训练。</p></sec></sec><sec id="s4_3"><title>2.3. 各层预测数据拟合</title><p>将各层预测数据进行拟合，最终得到原始时间序列的预测结果。</p></sec></sec><sec id="s5"><title>3. 模型预测仿真研究</title><sec id="s5_1"><title>3.1. 原始时间序列的分解与重构</title><p>本文中，将某国1947.1~2013.1国民生产总值季度数据作为原始样本分析数据。运用Mallat算法和Daubechies小波(Db10)实现对原始时间序列的3尺度分析。其中，经过小波分解的细节部分信号分别标记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x86_hanspub.png" xlink:type="simple"/></inline-formula>；经过小波分解的概貌部分信号标记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x87_hanspub.png" xlink:type="simple"/></inline-formula>，具体折线图如图3所示。</p></sec><sec id="s5_2"><title>3.2. 各尺度分层建模预测</title><p>1) 模型训练</p><p>首先需要随机生成系统的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x88_hanspub.png" xlink:type="simple"/></inline-formula>及<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x89_hanspub.png" xlink:type="simple"/></inline-formula>，同时令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x90_hanspub.png" xlink:type="simple"/></inline-formula>，生成一个具有回声状态属性的初始网络[<xref ref-type="bibr" rid="hanspub.16388-ref7">7</xref>] 。</p><p>然后进行网络动态采样。采样阶段根据系统内部状态更新方程收集系统内部状态：任意初始化储备池内部状态，这里令初始状态为0；将教师样本输入数据和教师样本输出数据分别通过输入连接权矩阵和反馈连接权矩阵加到储备池之中，按照内部状态状态更新方程及网络输出方程完成内部状态和相应的输出的计算及采集。</p><p>需要注意的是，本文对样本输入数据进行了特殊的处理，模型所采用的输入数据并不是在时间位置上连续的，而是采取数组形式。即假定输入向量为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x91_hanspub.png" xlink:type="simple"/></inline-formula>，该输入向量中的每一个分量本身也是由一个向量组成，例如，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x92_hanspub.png" xlink:type="simple"/></inline-formula>是时间序列<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x93_hanspub.png" xlink:type="simple"/></inline-formula>的前<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x94_hanspub.png" xlink:type="simple"/></inline-formula>个数据组成的向量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x95_hanspub.png" xlink:type="simple"/></inline-formula>则是时间序列<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x96_hanspub.png" xlink:type="simple"/></inline-formula>中提取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x97_hanspub.png" xlink:type="simple"/></inline-formula>后</p><p>图3. 小波分解重构图</p><p>接下来的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x99_hanspub.png" xlink:type="simple"/></inline-formula>个数据组成的向量，后面以此类推。在本文的模型中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2570085x100_hanspub.png" xlink:type="simple"/></inline-formula>取值为16。</p><p>最后进行权值计算，权值计算方法同前面所述。</p><p>2) 模型预测</p><p>对输入数据运用上述同样的方法进行特殊处理以后将其输入到已经训练好的模型之中，用输入数据对储备池进行激发，同时收集内部状态向量，最后利用模型训练阶段所求得的输出权值矩阵与系统内部状态进行线性组合，得到各层预测数据，各层预测效果图如图4~图7所示。</p></sec><sec id="s5_3"><title>3.3. 各尺度预测数据拟合</title><p>将各层预测数据进行拟合，最终得到原始时间序列的预测结果。</p><p>原始时间序列预测数据与原始数据对比图如图8所示。</p><p>本文采用MAPE (平均绝对百分比误差)作为评价预测模型预测效果的指标，在小波回声状态网络模型中MAPE的值为2.3122%。可见，该模型的预测精度较高。</p><p>图4. a<sub>3</sub>序列预测效果图</p><p>图5. d<sub>3</sub>序列预测效果图</p><p>图6. d<sub>2</sub>序列预测效果图</p><p>图7. d<sub>1</sub>序列预测效果图</p><p>图8. 小波回声状态网络模型预测效果图</p></sec></sec><sec id="s6"><title>4. 结论</title><p>本文提出了小波回声状态网络预测模型，针对回声状态网络模型面向多尺度时间序列分析预测的局限性，引入了小波分析方法，来提高针对多尺度时间序列预测的预测效果。小波回声状态网络预测模型首先运用小波方法对原始时间序列进行处理，对处理所得的各层数据分别创建回声状态网络模型进行预测，将各层预测数据进行拟合从而得到最终预测结果。仿真研究表明，该模型具有很好的预测效果。</p></sec><sec id="s7"><title>文章引用</title><p>刘天慧,周玉国,卢燕. 基于小波回声状态网络的时间序列预测Prediction of Time Series Based on Wavelet Echo State Network[J]. 建模与仿真, 2015, 04(04): 87-94. http://dx.doi.org/10.12677/MOS.2015.44011</p></sec><sec id="s8"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16388-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">彭玉华. 小波变换与工程应用[M]. 北京: 科学出版社, 1999.</mixed-citation></ref><ref id="hanspub.16388-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Mallat, S.G. (1989) A Theory for Multiresolution Signal Decomposition: The Wavelet Representation. IEEE Transactions on Pattern Analysis and Machine Intelligence, 11, 674-693. &lt;br&gt;http://dx.doi.org/10.1109/34.192463</mixed-citation></ref><ref id="hanspub.16388-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">罗熊, 黎江, 孙增圻. 回声状态网络的研究进展[J]. 北京科技大学学报, 2012, 34(2): 217-222.</mixed-citation></ref><ref id="hanspub.16388-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">郭阳明, 付琳娟, 冉从宝, 马捷中. 基于ESN的航空发动机状态组合预测方法[J]. 航空动力学报, 2013, 28(4): 947-953.</mixed-citation></ref><ref id="hanspub.16388-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">彭宇, 王建民, 彭喜元. 基于回声状态网络的时间序列预测方法研究[J]. 电子学报, 2010, 38(2A): 148-154.</mixed-citation></ref><ref id="hanspub.16388-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Skowronski, M.D. and Harris, J.G. (2007) Automatic Speech Recognition Using a Predictive Echo State Network Classifier. Neural Networks, 20, 414-423. &lt;br&gt;http://dx.doi.org/10.1016/j.neunet.2007.04.006</mixed-citation></ref><ref id="hanspub.16388-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">赵露莎. 基于回声状态网络的非线性时间序列预测方法研究[D]: [硕士学位论文]. 哈尔滨: 哈尔滨工业大学, 2012.</mixed-citation></ref></ref-list></back></article>