<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JWRR</journal-id><journal-title-group><journal-title>Journal of Water Resources Research</journal-title></journal-title-group><issn pub-type="epub">2166-6024</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JWRR.2020.91002</article-id><article-id pub-id-type="publisher-id">JWRR-33667</article-id><article-categories><subj-group subj-group-type="heading"><subject>JWRR20200100000_52177237.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject><subject> 合作期刊</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于Copula函数的多源径流预报误差联合分布研究
  Joint Distribution of Prediction Errors of Multi-Source Runoff Based on Copula Function
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>冲</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>纪</surname><given-names>昌明</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>验科</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>源</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>佳新</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>华北电力大学可再生能源学院，北京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>27</day><month>12</month><year>2019</year></pub-date><volume>09</volume><issue>01</issue><fpage>12</fpage><lpage>21</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   为了准确量化梯级水库群多源径流汇入的预报误差，提高优化调度方案的制作精度，采用正态分布、t分布、logistic分布和stable分布，分别对梯级水库群多源汇入径流的预报误差进行分布拟合优选，借助Copula函数具有耦合不同类型边缘分布函数的优势，构建多源径流预报误差的联合分布。锦屏一级与官地水库构成的梯级水库群的应用结果表明：锦屏一级入库的径流预报误差服从t分布，九龙河区间入流的径流预报误差服从logistic分布；采用Clayton copula函数构建的联合分布拟合效果最好，随机模拟产生的预报误差模拟值与实际值相差不大，验证了该方法的可行性，可以为水库群调度提供一定的参考依据。&lt;br/&gt;In order to accurately quantify forecasting error of the cascade reservoirs with multi-source inflows and improve the accuracy of the optimal scheduling scheme, the four distribution curves of normal distribution, t-distribution, logistic distribution and stable distribution are used to fit the error series, and the Copula function is used to construct joint distribution of multi-source runoff prediction errors. Application results of Jinping and Guandi Reservoirs show that the runoff forecast error of Jinping reservoir obeys the t-distribution, the runoff forecast error of the Jiulonghe interval inflow obeys the logistic distribution, and the joint distribution of the Clayton Copula function is the best. The simulation error generated by stochastic simulation is not much different from the actual value. The feasibility of the method is verified, which can provide a reference for reservoir group scheduling. 
  
 
</p></abstract><kwd-group><kwd>多源径流，梯级水库群，预报误差，Copula函数，联合分布, Multi-Source Runoff</kwd><kwd> Cascade Reservoirs</kwd><kwd> Prediction Error</kwd><kwd> Copula Function</kwd><kwd> Joint Distribution</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于Copula函数的多源径流预报误差联合分布 研究<sup> </sup></title><p>陈冲，纪昌明，张验科<sup>*</sup>，刘源，张佳新</p><p>华北电力大学可再生能源学院，北京</p><disp-formula id="hanspub.33667-formula19"><graphic xlink:href="//html.hanspub.org/file/2-2410843x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2019年12月7日；录用日期：2019年12月20日；发布日期：2019年12月27日</p><disp-formula id="hanspub.33667-formula20"><graphic xlink:href="//html.hanspub.org/file/2-2410843x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为了准确量化梯级水库群多源径流汇入的预报误差，提高优化调度方案的制作精度，采用正态分布、t分布、logistic分布和stable分布，分别对梯级水库群多源汇入径流的预报误差进行分布拟合优选，借助Copula函数具有耦合不同类型边缘分布函数的优势，构建多源径流预报误差的联合分布。锦屏一级与官地水库构成的梯级水库群的应用结果表明：锦屏一级入库的径流预报误差服从t分布，九龙河区间入流的径流预报误差服从logistic分布；采用Clayton copula函数构建的联合分布拟合效果最好，随机模拟产生的预报误差模拟值与实际值相差不大，验证了该方法的可行性，可以为水库群调度提供一定的参考依据。</p><p>关键词 :多源径流，梯级水库群，预报误差，Copula函数，联合分布</p><disp-formula id="hanspub.33667-formula21"><graphic xlink:href="//html.hanspub.org/file/2-2410843x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Wuhan University.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-2410843x8_hanspub.png" /> <img src="//html.hanspub.org/file/2-2410843x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>近年来，随着水文预报模型的不断更新和预报方法的不断完善，水文预报的精度得到了一定程度的提升。但由于水文预报的误差是客观存在且不可避免的 [<xref ref-type="bibr" rid="hanspub.33667-ref1">1</xref>]，为了减少预报误差对水库调度带来的不利影响以提高水库优化调度效益，一方面需要进一步提高预报模型的预测精度，另一方面也有必要研究模型产生的预报误差，统计其分布规律并进行定量分析 [<xref ref-type="bibr" rid="hanspub.33667-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.33667-ref3">3</xref>]。目前研究中，通常将径流预报误差作为随机变量，利用概率统计的方法来分析其统计特性和确定其概率分布形式 [<xref ref-type="bibr" rid="hanspub.33667-ref4">4</xref>]。左保河 [<xref ref-type="bibr" rid="hanspub.33667-ref5">5</xref>] 采用实测预报误差序列分析和谱分析相结合的方法，基于正态分布和对数正态分布对水文预报中的误差分布特性进行了研究，结果表明无论是大流域还是小流域，对数正态分布更适合描述其预报误差分布规律；董前进等 [<xref ref-type="bibr" rid="hanspub.33667-ref6">6</xref>] 通过对三峡水库汛期入库径流预报误差资料的计算分析表明，其预报误差基本服从正态分布，并利用统计图形对Laplace和Logistic的分布拟合效果进行了比较，结果显示Laplace分布更适合描述其误差分布规律。已有研究成果表明对于不同的水库，其入库径流预报误差分布规律有所不同，因此找到各自拟合度最优的分布曲线和分布函数是十分必要的，而且这些多是针对水库的单一入库径流预报误差进行的分析，对于梯级水库群来说，有多条径流汇入的情况下，使得整个梯级水库群系统具有多源输入的特性，径流预报误差存在多重不确定性，目前相关研究成果尚不多见。</p><p>研究多条径流汇入梯级水库群系统带来的不确定性，涉及到多变量问题。比较常见的多变量分析方法有多元联合分布函数、非参数方法、将多维联合分布转换成一维分布的方法以及经验频率法等 [<xref ref-type="bibr" rid="hanspub.33667-ref7">7</xref>]，这些方法在处理多变量联合分布时都有自身的局限性，难以准确描述水文数据的多元分布统计特性。近些年来，由于Copula函数可以很好描述多变量之间相关性，能对不同类型的边缘分布构造相对合理的联合分布，并具有形式灵活多样、计算较为简单等优点，在水文分析研究上受到了广泛关注 [<xref ref-type="bibr" rid="hanspub.33667-ref8">8</xref>]。例如，Favre [<xref ref-type="bibr" rid="hanspub.33667-ref9">9</xref>] 采用多维Copula函数构建了洪峰、洪量极值的联合分布，并探讨了其适用性；顾佳帅等 [<xref ref-type="bibr" rid="hanspub.33667-ref10">10</xref>] 采用4种对称Archimedean Copula函数构建了干旱历时、干旱烈度和烈度峰值的二维、三维联合分布；谢华等 [<xref ref-type="bibr" rid="hanspub.33667-ref11">11</xref>] 运用多维Frank Copula函数构建了三条河流的径流量联合分布，分析得到了不同径流量级的遭遇概率和条件概率；张冬冬 [<xref ref-type="bibr" rid="hanspub.33667-ref12">12</xref>] 等采用Copula函数计算洪峰、洪量和历时的联合分布并计算得到相应的重现期。本文以锦屏一级与官地水库构成的梯级水库群系统中两条汇入径流的预报误差分析为例，采用多种分布曲线对其进行拟合，得到效果最优的边缘分布曲线，在此基础上，采用Copula函数对两条径流预报误差服从的边缘分布构造联合分布，得到拟合效果最优的copula函数并随机抽样产生径流预报的模拟值，将模拟值与实际值进行比较，验证方法的可行性。</p></sec><sec id="s4"><title>2. 多源径流预报误差分析方法</title><sec id="s4_1"><title>2.1. 各径流预报误差描述</title><p>设 x i j 为第j条径流在第i个预报作业时刻下的预报相对误差：</p><p>x i j = q ′ i j − q i j q i j ,     i = 1 , 2 , ⋯ , m ; j = 1 , 2 , ⋯ , n (1)</p><p>式中， q ′ i j 为预报值， q i j 为实际值，m为序列长度，n为汇入梯级水库群的径流条数。</p><p>则对于具有n条径流汇入的梯级水库群系统，在第i个作业时刻下的径流预报误差为 A = [ x i 1 x i 2 ⋯ x i n ] 。n条输入的径流预报误差分别设为 x 1 , x 2 , ⋯ , x n ，其对应的边缘分布分别为 F ( x 1 ) , F ( x 2 ) , ⋯ , F ( x n ) ，密度函数分别为 f ( x 1 ) , f ( x 2 ) , ⋯ , f ( x n ) 。</p><p>对于 F ( x 1 ) , F ( x 2 ) , ⋯ , F ( x n ) 的求解通常可以选用正态分布、logistic分布、t分布、stable分布、Gamma分布、广义极值分布、对数正态分布、指数分布等等 [<xref ref-type="bibr" rid="hanspub.33667-ref13">13</xref>] 进行拟合选取。</p></sec><sec id="s4_2"><title>2.2. 多源径流预报误差联合分布</title><p>对于具有n条径流输入的梯级水库群系统来说，各条径流之间可能存在的相关性导致各径流预报误差之间也存在一定的相关性，基于此，采用Copula函数构造联合分布描述求解。为了寻求 x 1 , x 2 , ⋯ , x n 的联合分布函数 H ( x 1 , x 2 , ⋯ , x n ) ，根据n维Sklar定理可知，一定存在一个Copula函数C，使得下式成立：</p><p>H ( x 1 , x 2 , ⋯ , x n ) = C ( u 1 , u 2 , ⋯ , u n ) (2)</p><p>式中， u 1 , u 2 , ⋯ , u n 分别为随机变量 x 1 , x 2 , ⋯ , x n 的边缘分布，即 u i = F ( x i ) 。</p><p>x 1 , x 2 , ⋯ , x n 的联合概率密度函数为：</p><p>f ( x 1 , x 2 , ⋯ , x n ) = ∂ C ( F ( x 1 ) , F ( x 2 ) , ⋯ , F ( x n ) ) ∂ F ( x 1 ) ∂ F ( x 2 ) ⋯ ∂ F ( x n ) f ( x 1 ) f ( x 2 ) ⋯ f ( x n ) (3)</p><p>对于(2)式与(3)式中的Copula函数C可以考虑水文领域常用的阿基米德Copula函数，比如n元Gumbel Copula，n元Clayton Copula以及n元Frank Copula等。</p></sec><sec id="s4_3"><title>2.3. 多源径流预报误差联合分布求解步骤</title><p>1) 对n条汇入梯级水库群的径流预报误差序列数据进行分析。主要采用均值、标准差和确定性系数作为统计量描述，计算公式分别如下：</p><p>μ = ∑ i = 1 m x i m (4)</p><p>σ = ∑ i = 1 m ( x i − μ ) 2 m (5)</p><p>R 2 = 1 − ∑ i = 1 m ( q ′ i − q i ) 2 ∑ i = 1 m ( q i − q i &#175; ) 2 (6)</p><p>式中， q ′ t 为预报值， q t 为实际值，m为序列长度。</p><p>2) 对n条径流预报误差系列数据建立频率分布直方图，观察其数据分布情况选用合适的边缘分布曲线进行拟合。</p><p>3) 选取拟合效果最好的分布曲线作为边缘分布。判断依据主要为均方根误差和判定系数等。计算公式如下：</p><p>η cod = ∑ i = 1 m ( y i y ^ i ) 2 ( ∑ i = 1 m y i 2 ) ( ∑ i = 1 m y ^ i 2 ) (7)</p><p>ε RMSE = 1 m ∑ i = 1 m ( y i − y ^ i ) 2 (8)</p><p>式中： y i 为各拟合分布的离散点的概率值， y ^ i 为样本总体分布的概率密度函数值。判定系数的取值是[0,1]，其值越大表示拟合效果越好，均方根误差值越小表示拟合效果越好。</p><p>4) 选取常用的n元阿基米德copula函数对得到的n条边缘分布曲线构造联合分布并判断拟合效果。判断依据为离差平方和最小准则(OLS)和AIC信息准则法，其计算公式分别如下：</p><p>OLS = 1 m ∑ i = 1 m ( P e i − P c i ) 2 (9)</p><p>AIC = m ln ( MSE ) + 2 k (10)</p><p>其中， P e i 为联合分布的经验频率， P c i 为联合分布的理论频率，k为相应n元copula函数的参数个数。</p><p>5) 根据计算结果得到拟合效果最佳的n元copula模型参数及表达式，并根据蒙特卡洛法随机抽样，得到n条输入径流的预报误差的边缘分布值，再根据逆函数原理，通过求取第(3)步中边缘分布曲线的逆函数，从而得到模拟的n条径流预报误差值，并计算模拟值与实际值的特征值，进行比较。</p></sec></sec><sec id="s5"><title>3. 实例研究</title><p>雅砻江是金沙江最大的支流，是中国水能资源最富集的河流之一。全长1571 km，流域面积13.6万km&#178;，河口多年平均流量为1910 m&#179;/s，年径流量近600亿m&#179;，占长江上游总水量的13.3%。其干流共规划了22级水电站，总装机容量约为3000万kw，年发电量约为1500亿kw&#183;h。雅砻江下游河段是其目前水电开发的重点河段，有锦屏一级、锦屏二级、官地、二滩、桐子林五大电站。九龙河是雅砻江下游左岸的一级支流，发源于九龙县北端与康定县交界处，全长128 km，由北向南至文家坪注入雅砻江。其水能资源丰富，最高流量200 m&#179;/s，理论蕴藏发电量103.9万kw。</p><p>锦屏一级电站(锦西水库)和官地水库构成的梯级水库群系统中，上游有雅砻江汇入锦西水库，区间还有九龙河汇入官地水库，两条径流汇入使得梯级水库群存在多重不确定性，基于此，本文以锦西入库径流预报误差和九龙河区间入流预报误差作为研究对象，构建联合分布进行分析，以期为水库制作准确调度方案提供一定的参考依据。</p><sec id="s5_1"><title>3.1. 确定边缘分布</title><p>数据采用2013年6月~2014年6月锦西入库和九龙河日径流预报过程中预见期为6 h的预报值和实测值，采用均值、标准差和确定性系数三个指标作为统计量描述，对两条径流(下文简称锦西入库和区间入流)预报误差的样本做统计分析。由公式(4)、(5)、(6)计算可得各指标的结果见表1。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1"><xref ref-type="table" rid="table">Table </xref>1</xref></label><caption><title> Statistical description of runoff prediction errors in Jinxi reservoir inflow and interval inflo</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >径流序列</th><th align="center" valign="middle" >序列长度</th><th align="center" valign="middle" >均值 μ</th><th align="center" valign="middle" >标准差 σ</th><th align="center" valign="middle" >确定性系数R&#178;</th></tr></thead><tr><td align="center" valign="middle" >锦西入库</td><td align="center" valign="middle" >673</td><td align="center" valign="middle" >0.5577</td><td align="center" valign="middle" >7.7427</td><td align="center" valign="middle" >0.9720</td></tr><tr><td align="center" valign="middle" >区间入流</td><td align="center" valign="middle" >673</td><td align="center" valign="middle" >4.5347</td><td align="center" valign="middle" >27.4853</td><td align="center" valign="middle" >0.9107</td></tr></tbody></table></table-wrap><p>表1. 锦西水库入库和区间入流的径流预报误差的统计描述量</p><p>对两条径流预报误差序列数据分别建立频率分布直方图，根据分布情况选用不同分布曲线对其进行拟合，分别得到两条径流预报误差的拟合效果图，见图1、图2。</p><p>图1. 锦西水库入库径流预报误差分布拟合</p><p>图2. 区间入流径流预报误差分布拟合</p><p>由图1锦西水库入库预报误差的频率分布直方图中可以看出，频率分布直方图呈现中间高两边低，选用满足此类描述的分布，如正态分布、logistic分布、t分布和stable分布对其进行拟合，可以初步看到拟合效果好的分布情况依次是t分布 &gt; stable分布 &gt; logistic分布 &gt; 正态分布。图2中区间入流预报误差的频率直方图也大致满足中间高两边低，同样选取4种分布对其序列进行拟合，可以看出logistic分布对于峰值的拟合优于其他3个分布曲线。由公式(7)、(8)计算判定系数和均方根误差再次判断各曲线的拟合效果，计算结果见表2。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2"><xref ref-type="table" rid="table">Table </xref>2</xref></label><caption><title> Applicability judgment table for each distribution curve of Jinxi inflow and interval inflow runoff forecast erro</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >分布曲线</th><th align="center" valign="middle" >正态分布</th><th align="center" valign="middle" >t分布</th><th align="center" valign="middle" >Logistic分布</th><th align="center" valign="middle" >Stable分布</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >锦西入库</td><td align="center" valign="middle" >判定系数 η COD</td><td align="center" valign="middle" >0.6213</td><td align="center" valign="middle" >0.9349</td><td align="center" valign="middle" >0.7356</td><td align="center" valign="middle" >0.9059</td></tr><tr><td align="center" valign="middle" >均方误差 ε RMSE</td><td align="center" valign="middle" >0.0399</td><td align="center" valign="middle" >0.0260</td><td align="center" valign="middle" >0.0332</td><td align="center" valign="middle" >0.0283</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >区间入流</td><td align="center" valign="middle" >判定系数 η COD</td><td align="center" valign="middle" >0.9510</td><td align="center" valign="middle" >0.9613</td><td align="center" valign="middle" >0.9739</td><td align="center" valign="middle" >0.9720</td></tr><tr><td align="center" valign="middle" >均方误差 ε RMSE</td><td align="center" valign="middle" >0.0115</td><td align="center" valign="middle" >0.0100</td><td align="center" valign="middle" >0.0096</td><td align="center" valign="middle" >0.0098</td></tr></tbody></table></table-wrap><p>表2. 锦西水库入库和区间入流径流预报误差的各分布曲线适用性判定表</p><p>对于锦西入库径流预报误差序列，由表2可以看出，判定系数t分布0.9349 &gt; stable分布0.9059 &gt; logistic分布0.7356 &gt; 正态分布0.6213，均方根误差t分布0.026 &lt; stable分布0.0283 &lt; logistic分布0.0332 &lt; 正态分布0.0399，由判定系数越大越好和均方根误差越小越好这一判定依据，可以得到拟合效果好的分布依次是t分布 &gt; stable分布 &gt; logistic分布 &gt; 正态分布，这与图2得到的结论是相同的，所以可以得到锦西入库径流预报误差服从t分布。类似的，对于九龙河区间入流预报误差序列，由表2可以看到logistic分布的判定系数最大，均方根误差最小，所以得到九龙河区间入流预报误差服从logistic分布。</p><p>锦西入库、九龙河区入流径流预报误差拟合的4个分布曲线的参数见表3。</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3"><xref ref-type="table" rid="table">Table </xref>3</xref></label><caption><title> The distribution parameter table of runoff forecast error of Jinxi inflow and interval inflo</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >参数</th><th align="center" valign="middle" >正态分布</th><th align="center" valign="middle" >t分布</th><th align="center" valign="middle" >Logistic分布</th><th align="center" valign="middle" >Stable分布</th></tr></thead><tr><td align="center" valign="middle" >锦西入库</td><td align="center" valign="middle" >μ = 0.5577 σ = 7.7427</td><td align="center" valign="middle" >μ = 0.0786 σ = 2.6587 n = 1.3928</td><td align="center" valign="middle" >μ = 0.4263 σ = 3.5098</td><td align="center" valign="middle" >α = 1.1396 β = 0.1726 γ = 2.3844 δ = 0.0206</td></tr><tr><td align="center" valign="middle" >区间入流</td><td align="center" valign="middle" >μ = 4.5347 σ = 27.4853</td><td align="center" valign="middle" >μ = 4.4982 σ = 27.2984 n = 165.2543</td><td align="center" valign="middle" >μ = 3.8171 σ = 15.6066</td><td align="center" valign="middle" >α = 1.9741 β = 1.0000 γ = 19.2281 δ = 3.9273</td></tr></tbody></table></table-wrap><p>表3. 锦西入库、区间入流的径流预报误差各分布参数表</p><p>设锦西入库和区间入流的径流预报误差分别为x，y。由表3可以得到，锦西入库径流预报误差服从的t分布参数分别为 μ = 0.0786 , σ = 2.6587 , n = 1.3928 ，可以得到t分布表达式如下：</p><p>F ( x ) = x − 0.0786 2.6587 ∼ t ( 1.3928 ) (11)</p><p>九龙河区间入流预报误差服从的logistic分布参数 μ = 3.8171 , σ = 15.6066 ，可以得到分布函数和密度函数分别如下：</p><p>F ( y ) = 1 1 + e − y − 3.8171 15.6066 (12)</p><p>f ( y ) = e − y − 3.8171 15.6066 15.6066 ( 1 + e − y − 3.8171 15.6066 ) 2 (13)</p></sec><sec id="s5_2"><title>3.2. Copula函数构造联合分布</title><p>根据得到的锦西入库径流预报误差服从的t分布、九龙河区间入流径流预报误差服从的logistic分布采用copula函数构造联合分布。</p><p>为了研究两条径流预报误差的相关性，采用t检验进行检验。计算锦西入库(x)和九龙河区间入流(y)两条径流预报误差序列的相关系数r，其计算公式如下：</p><p>r = ∑ i = 1 n ( x i − x &#175; ) ( y i − y &#175; ) ∑ i = 1 n ( x i − x &#175; ) 2 ∑ i = 1 n ( y i − y &#175; ) 2 = n ∑ i = 1 n x i y i − ∑ i = 1 n x i ∑ i = 1 n y i n ∑ i = 1 n x i 2 − ( ∑ i = 1 n x i ) 2 ⋅ n ∑ i = 1 n y i 2 − ( ∑ i = 1 n y i ) 2 (14)</p><p>通过计算可以得到r = 0.1423，然后根据t检验构造统计量见式(15)：</p><p>t = r n − 2 1 − r 2 (15)</p><p>指定置信度 α = 0.1 ，由t分布表中查得临界值 t α = 1.288 ，由(15)计算得到 t = 3.76 &gt; t α ，所以，可以认为x和y不独立，即锦西入库和区间入流的径流预报误差两个序列并不独立，具有一定的相关性。</p><p>在此基础上选择常用的三种阿基米德Copula函数：GH Copula、Clayton Copula和Frank Copula函数，对两个径流序列构造联合分布。利用Matlab得到三个Copula函数下的联合分布函数图和密度函数图如下，见图3~5。</p><p>图3. GH copula的分布函数图和密度函数图</p><p>图4. Clayton copula的分布函数图和密度函数图</p><p>图5. Frank copula的分布函数图和密度函数图</p><p>采用极大似然法估计得到的3个Copula函数的参数，以及采用离差平方和最小准则(OLS)和AIC信息准则法对联合分布的适用性判定的结果见表4。</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4"><xref ref-type="table" rid="table">Table </xref>4</xref></label><caption><title> <xref ref-type="table" rid="table">Table </xref>of copula function parameter values and applicability judgmen</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Copula函数</th><th align="center" valign="middle" >GH copula</th><th align="center" valign="middle" >Clayton copula</th><th align="center" valign="middle" >Frank copula</th></tr></thead><tr><td align="center" valign="middle" >参数估计值</td><td align="center" valign="middle" >2.6583</td><td align="center" valign="middle" >2.1839</td><td align="center" valign="middle" >15.7759</td></tr><tr><td align="center" valign="middle" >OLS</td><td align="center" valign="middle" >0.0147</td><td align="center" valign="middle" >0.0128</td><td align="center" valign="middle" >0.0175</td></tr><tr><td align="center" valign="middle" >AIC</td><td align="center" valign="middle" >−5675.3065</td><td align="center" valign="middle" >−5862.2452</td><td align="center" valign="middle" >−5444.6998</td></tr></tbody></table></table-wrap><p>表4. Copula函数参数值及适用性判定表</p><p>采用OLS和AIC准则值均为最小为判断依据，由表4可以得到，3个Copula函数的拟合情况分别为Clayton copula &gt; GH copula &gt; Frank copula。因此选用Clayton copula构造联合分布，其参数值 θ = 2.1839 ，相应的分布函数和密度函数分别如下式：</p><p>C C l ( u , v ; θ ) = ( u − 2.1839 + v − 2.1839 − 1 ) − 1 2.1839 (16)</p><p>c C l ( u , v ; θ ) = ( 1 + 2.1839 ) ( u v ) − 2.1839 − 1 ( u − 2.1839 + v − 2.1839 − 1 ) − 2 − 1 2.1839 (17)</p><p>式中： u , v 分别为x和y的边缘分布函数即 F ( x ) , F ( y ) 。</p><p>3.3. 随机模拟</p><p>由Clayton copula函数模拟5000次锦西入库和九龙河区间入流的径流预报误差作为模拟值，并计算模拟值与实际值的特征值见表5。</p><table-wrap id="table5" ><label><xref ref-type="table" rid="table">Table </xref>5</label><caption><title> Comparison table between the simulated value and the actual value of the forecast error of Jinxi inflow and interval inflo</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >序列</th><th align="center" valign="middle"  colspan="2"  >均值</th><th align="center" valign="middle"  colspan="2"  >变差系数</th><th align="center" valign="middle"  colspan="2"  >偏差系数</th></tr></thead><tr><td align="center" valign="middle" >实际值</td><td align="center" valign="middle" >模拟值</td><td align="center" valign="middle" >实际值</td><td align="center" valign="middle" >模拟值</td><td align="center" valign="middle" >实际值</td><td align="center" valign="middle" >模拟值</td></tr><tr><td align="center" valign="middle" >锦西入库</td><td align="center" valign="middle" >0.5577</td><td align="center" valign="middle" >0.5048</td><td align="center" valign="middle" >13.8823</td><td align="center" valign="middle" >11.4024</td><td align="center" valign="middle" >−0.1805</td><td align="center" valign="middle" >−0.2010</td></tr><tr><td align="center" valign="middle" >区间入流</td><td align="center" valign="middle" >4.5347</td><td align="center" valign="middle" >4.7538</td><td align="center" valign="middle" >6.0612</td><td align="center" valign="middle" >6.8314</td><td align="center" valign="middle" >0.2220</td><td align="center" valign="middle" >0.1837</td></tr></tbody></table></table-wrap><p>表5. 锦西入库和区间入流误差模拟值与实际值特征值对比表</p><p>由表5可以看出实际值与模拟值相差不大，表明构造的联合分布可以用来模拟梯级水库群中两条径流汇入的预报误差的实际情况，以此来表征整个系统输入的不确定性。将模拟值与预报值叠加，可以产生一系列考虑径流预报误差的模拟值，能得到更接近实际的来水径流过程。</p></sec></sec><sec id="s6"><title>4. 结论</title><p>本文以锦西入库和九龙河区间入流的径流预报误差分析为例，考虑多条径流之间存在的相关性带来的梯级水库群系统的多重不确定性，基于Copula函数构建了多源径流预报误差的联合分布，得到的结论如下：</p><p>1) 对于不同的径流预报误差序列，其服从的分布规律不同。锦西入库径流预报误差服从t分布，九龙河区间入流径流预报误差服从logistic分布。</p><p>2) Clayton copula函数构建的两个径流预报误差序列的联合分布拟合效果更好。基于此函数产生的模拟值与实际值的特征值结果相差不大，说明建立的多源径流预报误差的联合分布方法具有一定的可行性，可以将产生的模拟值与预报值叠加后得到更接近实际来水的一系列径流过程，为水库调度决策提供一定的参考依据。</p></sec><sec id="s7"><title>基金项目</title><p>国家自然科学基金(51709105)；中央高校基本科研业务费专项资金资助(2019MS031)。</p></sec><sec id="s8"><title>文章引用</title><p>陈 冲,纪昌明,张验科,刘 源,张佳新. 基于Copula函数的多源径流预报误差联合分布研究Joint Distribution of Prediction Errors of Multi-Source Runoff Based on Copula Function[J]. 水资源研究, 2020, 09(01): 12-21. https://doi.org/10.12677/JWRR.2020.91002</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.33667-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">纪昌明, 李荣波, 田开华, 等. 基于来水不确定性的梯级水电站负荷调整耦合模型——以锦官电源组梯级水电站为例[J].水利学报, 2017, 48(1): 1-12. 
JI Changming, LI Rongbo, TIAN Kaihua, et al. A coupling model of load adjustment for cascade hydropower stations based on inflow uncertainty: A case study of Jinping-Guandi cascade hydropower stations. Journal of Hydraulic Engineering, 2017, 48(1): 1-12. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">张海荣. 耦合天气预报的流域短期水文预报方法研究[D]. 武汉: 华中科技大学, 2017. 
ZHANG Hairong. Watershed short-term hydrological forecast coupling with weather forecasting. Wuhan: Huazhong University of Science and Technology, 2017. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">纪昌明, 梁小青, 张验科, 等. 入库径流预报误差随机模型及其应用[J]. 水力发电学报: 1-11 [2019-0905]. 
JI Changming, LIANG Xiaoqing, ZHANG Yanke, et al. Stochastic model of reservoir runoff forecast error and its application. Journal of Hydroelectric Engineering, 1-11 [2019-0905].</mixed-citation></ref><ref id="hanspub.33667-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">何洋, 纪昌明, 田开华, 等. 基于最大熵原理的径流预报误差分布规律研究[J]. 中国农村水利水电, 2016(11): 115-120. 
HE Yang, JI Changming, TIAN Kaihua, et al. A study of the distribution law of runoff forecasting error based on maximum entropy principle. China Rural Water and Hydropower, 2016(11): 115-120. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">左保河. 实时洪水预报过程中的误差分布特性研究[J]. 华北水利水电学院学报, 1997(2): 42-47. 
ZUO Baohe. Analysis of error distribution feature in the real-time hydrologic forecast procedure. Journal of North China Institute of Water Conservancy and Hydroelectric Power, 1997(2): 42-47. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">董前进, 傅建彬, 陈森林. 基于统计图形的入库流量预报误差分布规律[J]. 水电能源科学, 2011, 29(4): 5-7. 
DONG Qianjin, FU Jianbin, CHEN Senlin. Study on distribution rule of inflow forecasting error for Three Gorges Reservoir based on statistical graphics. Water Resources and Power, 2011, 29(4): 5-7. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">FREES, E. W., Valdez, E. A. Understanding relationships using copulas. North American Actuarial Journal, 1998, 2(1): 1-25.  
&lt;br&gt;https://doi.org/10.1080/10920277.1998.10595667</mixed-citation></ref><ref id="hanspub.33667-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">林娴, 欧阳昊, 陈晓宏, 等. 基于Copula函数的组合变量联合概率分布研究及应用[J]. 水文, 2017, 37(1): 1-7. 
LIN Xian, OUYANG Hao, CHEN Xiaohong, et al. Studying probability distribution of flood elements combination based on copula. Journal of China Hydrology, 2017, 37(1): 1-7. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">FAVRE, A.-C., EL ADLOUNI, S., PERREAULT, L., THIÉMONGE, N. and BOBÉE, B. Multivariate hydrological frequency analysis using copulas. Water Resources Research, 2004, 40(1): 1-12. &lt;br&gt;https://doi.org/10.1029/2003WR002456</mixed-citation></ref><ref id="hanspub.33667-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">顾佳帅, 李琼芳, 牛铭媛, 等. 基于多维Copula函数的淮河上游气象干旱特征分析[J]. 中国农村水利水电, 2019(8): 83-87+92. 
GU Jiashuai, LI Qiongfang, NIU Mingyuan, et al. An analysis of meteorological drought characteristics in the upper reaches of Huai River based on multidimensional copula function. China Rural Water and Hydropower, 2019(8): 83-87+92. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">谢华, 罗强, 黄介生. 基于三维copula函数的多水文区丰枯遭遇分析[J]. 水科学进展, 2012, 23(2): 186-193. 
XIE Hua, LUO Qiang, HUANG Jiesheng. Synchronous asynchronous encounter analysis of multiple hydrologic regions based on 3D Copula function. Advances in Water Science, 2012, 23(2): 86-73. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">张冬冬, 鲁帆, 严登华, 等. 基于Archimedean Copula函数的洪水多要素联合概率分布研究[J]. 中国农村水利水电, 2015(1): 68-74+79. 
ZHANG Dongdong, LU Fan, YAN Denghua, et al. Research on multi-dimensional joint distribution of flood characteristics based on Archimedean Copula. China Rural Water and Hydropower, 2015(1): 68-74+79. (in Chinese)</mixed-citation></ref><ref id="hanspub.33667-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">ZHANG, J. H., CHEN, L., SINGH, V. P., CAO, H. W. and WANG, D. W. Determination of the distribution of flood forecasting error. Nat Hazard, 2015, 75(2): 1389-1402. &lt;br&gt;https://doi.org/10.1007/s11069-014-1385-z</mixed-citation></ref></ref-list></back></article>