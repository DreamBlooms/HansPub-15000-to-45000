<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2020.1012234</article-id><article-id pub-id-type="publisher-id">CSA-39242</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20201200000_94816627.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  小数据集的微地震信号震相拾取方法
  Phase Arrivals Picking Method for Microseismic Signals with Small Dataset
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>谭</surname><given-names>浩阳</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>骏海</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>怡铭</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>中国矿业大学(北京)煤炭资源与安全开采国家重点实验室，北京;</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>09</day><month>12</month><year>2020</year></pub-date><volume>10</volume><issue>12</issue><fpage>2227</fpage><lpage>2233</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   近年来，深度卷积神经网络在地震信号震相拾取的研究中得到了广泛的研究，此类模型同时拾取P波和S波震相，在天然地震台网的地震数据震相拾取中应用推广较好。但是由于此类模型需要很大的标签数据量，同时计算复杂度也很高，在标签样本较少的微地震监测中应用时受限较严重。已有研究表明，P波拾取的复杂度比S波拾取要低，只拾取P波震相时，模型复杂度可以较简单，标签需求量也较低。在P波拾取完成后，通过极化分析和旋转可以很好的提取S波特征，从而降低S波拾取的复杂度。基于此种想法，本文联合机器学习、极化分析和时频分析等方法，将P波拾取和S波拾取进行分离，降低深度卷积神经网络的模型复杂性，得到准确率较高的微震信号自动识别及到时拾取的模型，同时降低了训练所需数据量。 In recent years, deep convolutional neural network has been extensively studied in the study of seismic phase pickup of seismic signals. However, such a model can pick up both P wave and S wave seismic phases, and it is well applied and popularized in seismic phase pickup of seismic data of natural seismic network. However, due to the large amount of tag data and high computational complexity, the application of such a model in microseismic monitoring with few tag samples is severely limited. Previous studies have shown that the complexity of P wave pickup is lower than that of S wave pickup. Only when P wave shock phase is picked up, the model complexity can be simpler and the label demand is lower. After the p-wave pickup is completed, the S-wave signature can be well extracted through polarization analysis and rotation, thus reducing the complexity of s-wave pickup. Based on this idea, this paper combines machine learning, polarization analysis, time-frequency analysis and other methods to separate P-wave pickup and S-wave pickup, so as to reduce the model complexity of deep convolutional neural network, obtain a model with high accuracy for automatic identification of microseismic signals and timely pickup, and meanwhile reduce the amount of data required for training. 
  
 
</p></abstract><kwd-group><kwd>微震信号，人工智能，地震震相识别, Microseismic Signal</kwd><kwd> Artificial Intelligence</kwd><kwd> Seismic Phase Identification</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>近年来，深度卷积神经网络在地震信号震相拾取的研究中得到了广泛的研究，此类模型同时拾取P波和S波震相，在天然地震台网的地震数据震相拾取中应用推广较好。但是由于此类模型需要很大的标签数据量，同时计算复杂度也很高，在标签样本较少的微地震监测中应用时受限较严重。已有研究表明，P波拾取的复杂度比S波拾取要低，只拾取P波震相时，模型复杂度可以较简单，标签需求量也较低。在P波拾取完成后，通过极化分析和旋转可以很好的提取S波特征，从而降低S波拾取的复杂度。基于此种想法，本文联合机器学习、极化分析和时频分析等方法，将P波拾取和S波拾取进行分离，降低深度卷积神经网络的模型复杂性，得到准确率较高的微震信号自动识别及到时拾取的模型，同时降低了训练所需数据量。</p></sec><sec id="s2"><title>关键词</title><p>微震信号，人工智能，地震震相识别</p></sec><sec id="s3"><title>Phase Arrivals Picking Method for Microseismic Signals with Small Dataset</title><p>Haoyang Tan<sup>1,2</sup>, Junhai Huang<sup>1,2</sup>, Yiming Zhao<sup>1,2</sup></p><p><sup>1</sup>State Key Laboratory of Coal Resources and Safe Mining, China University of Mining and Technology (Beijing), Beijing</p><p><sup>2</sup>School of Geoscience and Surveying Engineering, China University of Mining and Technology (Beijing), Beijing</p><p><img src="//html.hanspub.org/file/9-1541931x4_hanspub.png" /></p><p>Received: Nov. 27<sup>th</sup>, 2020; accepted: Dec. 14<sup>th</sup>, 2020; published: Dec. 21<sup>st</sup>, 2020</p><p><img src="//html.hanspub.org/file/9-1541931x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>In recent years, deep convolutional neural network has been extensively studied in the study of seismic phase pickup of seismic signals. However, such a model can pick up both P wave and S wave seismic phases, and it is well applied and popularized in seismic phase pickup of seismic data of natural seismic network. However, due to the large amount of tag data and high computational complexity, the application of such a model in microseismic monitoring with few tag samples is severely limited. Previous studies have shown that the complexity of P wave pickup is lower than that of S wave pickup. Only when P wave shock phase is picked up, the model complexity can be simpler and the label demand is lower. After the p-wave pickup is completed, the S-wave signature can be well extracted through polarization analysis and rotation, thus reducing the complexity of s-wave pickup. Based on this idea, this paper combines machine learning, polarization analysis, time-frequency analysis and other methods to separate P-wave pickup and S-wave pickup, so as to reduce the model complexity of deep convolutional neural network, obtain a model with high accuracy for automatic identification of microseismic signals and timely pickup, and meanwhile reduce the amount of data required for training.</p><p>Keywords:Microseismic Signal, Artificial Intelligence, Seismic Phase Identification</p><disp-formula id="hanspub.39242-formula20"><graphic xlink:href="//html.hanspub.org/file/9-1541931x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/9-1541931x7_hanspub.png" /> <img src="//html.hanspub.org/file/9-1541931x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>微地震信号监测的过程包括了数据预处理、初至拾取、震源反演定位这三个阶段，其中，初至拾取的准确度会直接决定事件识别的精确度，是微地震信号监测的重点。为了解决在人工进行初至拾取时准确度不高，效率较低的问题，许多研究者提出了各种比较有效的方法，其中包括了自回归Akaike信息准则(AR-AIC)方法 [<xref ref-type="bibr" rid="hanspub.39242-ref1">1</xref>]，长短时窗平均比值法 [<xref ref-type="bibr" rid="hanspub.39242-ref2">2</xref>]，基于高阶统计量的方法 [<xref ref-type="bibr" rid="hanspub.39242-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.39242-ref4">4</xref>] 等。然而这些传统方法在拾取时需要进行较多人工干预，因此在处理较大数据时效率不高，这仍然是一个很大的问题。</p><p>近年来，将机器学习应用到地震学领域中的方法引起了广泛关注，机器学习可以改进传统地震检测和震相识别方法，提高传统方法的识别效率和识别精度 [<xref ref-type="bibr" rid="hanspub.39242-ref5">5</xref>]。因此，研究者们也开发出了很多利用机器学习进行初至拾取的方法，其中将卷积神经网络(CNN)和递归神经网络(RNN)应用到震相识别中的方法较为典型。与传统方法相比，利用神经网络进行震相识别有着更低的误检与漏识率，并且训练好的模型输出能力非常稳定，不需要根据噪声水平频繁调整阈值 [<xref ref-type="bibr" rid="hanspub.39242-ref6">6</xref>]。而与RNN相比 [<xref ref-type="bibr" rid="hanspub.39242-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.39242-ref8">8</xref>]，CNN在震相自动拾取设计方面更有吸引力，并在地震数据处理方面得到了更多的研究 [<xref ref-type="bibr" rid="hanspub.39242-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.39242-ref10">10</xref>]。</p><p>在以往的CNN在地震数据处理的应用研究中，人们往往都是对较大数据量的地震记录进行网络训练和地震波到时拾取。虽然有许多优秀的网络能对地震波进行较为精确的拾取，但如果将其网络应用于小数据集的地震波拾取，其拾取准确率会大大降低。一般将CNN应用于地震波拾取是对P波，S波同时进行到时拾取，这就要求网络对数据提取的特征较多，所以对训练数据量的需求也就较大。</p><p>为了解决CNN网络训练样本需求量大，难以应用于小数据集地震记录这一问题，本文提出的小数据集的微地震信号的震相拾取模型只使用CNN完成P波到时拾取，然后对地震数据进行极化，旋转和希尔伯特变换等处理后完成S波到时拾取，从而减少CNN网络对训练样本的需求。</p></sec><sec id="s6"><title>2. 震相拾取模型</title><p>本文设计的震相拾取模型如图1所示，首先对原始数据进行CNN网络训练，完成对P波到时的拾取，然后依次对原始数据进行极化处理和旋转，希尔伯特变换等处理，从而得到较为理想的S波特征，以进行S波到时拾取。</p><p>此模型将P波拾取和S波拾取进行分离，降低了深度卷积神经网络的模型复杂性，可以在保证微震信号自动识别及到时拾取准确率较高的前提下降低训练所需数据量。</p><p>图1. 震相拾取模型流程图</p></sec><sec id="s7"><title>3. 基于极化处理的S波特征提取</title><sec id="s7_1"><title>3.1. P波到时拾取网络的设计</title><p>CNN算法叫做卷积神经网络，是在人工神经网络的基础上发展而来的一种深度学习，是由多个卷积层、池化层及全连层构成的特征分类器，CNN是一种监督学习技术，可以直接应用于提取地震数据分类的幅度数据，相对于其他监督分类方法的主要优点是其空间感知和自动特征提取。</p><p>本文所用U-Net网络结构如图2所示，主要由输入层、输出层、一维卷积层(步长为1)、最大池化层(下采样)、反卷积层(上采样)以及ReLU非线性激活函数组成，其中输入层通道为3，对应三分量；输出层通道2，一通道为P的拾取的概率分布，另一通道为非p拾取的概率分布。</p><p>图2. CNN网络结构图</p><p>网络左侧为一个下采样过程，用以提取三通道微震信号的特征，由6个一维卷积层(紫色箭头)和2个最大池化层组成(棕色箭头)，每经过一个最大池化层，数据缩小为原来的1/2。网络右侧是一个上采样过程，可以理解为一个解码器，将特征进行解码还原为需要的信息。上采样过程使用的是2个反卷积(绿色箭头)，每次上采样将数据扩展为原来的2倍，然后将对应层的特征进行剪裁和复制，然后合并到上卷积的结果上(灰色箭头)。</p></sec><sec id="s7_2"><title>3.2. 地震数据的极化处理和旋转</title><p>在空间坐标系中，一个矢量u的位置应该由它与坐标轴的三个夹角所决定，这三个夹角对应u的三个方向余弦，当这三个方向余弦平方和为1时它们也就正好对应了u的三个坐标标量，从而可以证明在空间坐标系中一个质点偏振的主要方向就是其主特征向量所代表的方向，其中主特征向量是指特征值最大的特征向量。</p><p>本文中，选取P波区段N组三分量数据计算P波的偏振主轴，首先，对于三分量的地震数据，需要计算它的协方差矩阵，后计算协方差矩阵的特征值 λ 1 &gt; λ 2 &gt; λ 3 及特征向量 μ 1 &gt; μ 2 &gt; μ 3 ， μ 1 即为P波的偏振主轴。然后将坐标轴旋转使z轴与偏振主轴重合，旋转公式如下：</p><p>( Z ′ Y ′ X ′ ) = ( sin i − cos θ cos i − sin θ cos i cos i cos θ sin i sin θ sin i 0 − sin θ cos θ ) ( Z Y X ) (1)</p><p>其中i为P波的入射角， θ 为P波的方位角。</p></sec><sec id="s7_3"><title>3.3. 基于希尔伯特变换的S波特征提取</title><p>对于S波到时拾取，希尔伯特变换的方法有着较为显著的效果 [<xref ref-type="bibr" rid="hanspub.39242-ref11">11</xref>]，利用此方法可以得到S波的特征曲线，从而完成S波到时拾取的目的。首先将数据经过极化处理，后利用希尔伯特变换求取两个水平分量轨迹的分析轨迹 X ( j ) ， Y ( j ) ，即将极化处理后的X，Y分量数据 x ( j ) ， y ( j ) 分别加上各自希尔伯特变换结果的i倍如公式(2)，(3)所示，其中 H { x ( j ) } ，   H { y ( j ) } 代表X，Y分量的希尔伯特变换结果：</p><p>X ( j ) = x ( j ) + i H { x ( j ) } (2)</p><p>Y ( j ) = y ( j ) + i H { y ( j ) } (3)</p><p>其中 x ( j ) ， y ( j ) 代表经过极化处理后的X，Y分量数据，H代表进行希尔伯特变换，后计算瞬时协方差矩阵 Q ( j ) ， Q ( j ) 对于每一个j而言都有两个特征值 λ 1 ， λ 2 且有   λ 1 ≥ λ 2 ，然后取得S波特征函数：</p><p>C F S ( j ) = λ 1 ( j ) 2 (4)</p><p>S波的特征曲线如图3所示。</p></sec></sec><sec id="s8"><title>4. 模型性能分析</title><sec id="s8_1"><title>4.1. 实际数据的应用效果</title><p>在以上模型构建完成后，将实际数据带入模型进行性能分析。如图4所示，画出实际数据剖面图，并添加拾取结果，其中绿色点为P波到时，红色点为S波到时。可以看出此方法对P波和S波的拾取结果均较为准确，具有较好的泛用性。</p><p>图3. 希尔伯特变换结果。(a) x分量原始地震记录；(b) y分量原始地震记录；(c) z分量原始地震记录；(d) S波特征曲线</p><p>图4. 震相拾取模型应用结果</p></sec><sec id="s8_2"><title>4.2. 与传统短长时窗法的对比</title><p>采用传统短长时窗法对此实际数据进行P波、S波到时拾取，用以与本文所构建模型进行性能对比。如图5所示，以其中一道地震记录为例，前三条曲线为地震三分量原始数据；第四条绿色曲线为CNN网络对P波的波形模拟结果；第四条红色曲线为经过极化、旋转及希尔伯特变换等处理后得到的S波特征曲线；第五条曲线为传统短长时窗法对两种波的拾取结果。</p><p>不难看出，本文所用方法对对P波和S波的到时拾取都较为精准。相对而言传统短长时窗法对两种波的拾取准度较差，且受噪声影响较大，即在拾取准度和抗噪声强度这两个地震记录处理方法中重要的方面上，本文所用方法的性能均优于传统短长时窗法。</p><p>图5. 两种方法性能对比。(a) x分量原始地震记录；(b) y分量原始地震记录；(c) z分量原始地震记录；(d) 本文模型得到的特征曲线；(e) STA/LTA特征曲线</p></sec><sec id="s8_3"><title>4.3. 与一般CNN网络的对比</title><p>一般使用CNN网络对微震信号进行拾取会构建较为复杂的网络，对P波，S波同时进行到时拾取。本文所用对比CNN网络由8个一维卷积层，4个最大池化层，4个反卷积层组成，与本文所用CNN网络相比更为复杂，对训练样本数据量的需求也更大。如图6所示，将其对P波与S波的拾取结果与本文所用模型得到结果进行对比，可以看出两者对两种波的拾取效果相差不多，但本文所用网络的训练样本需求量大大降低，达到了本文的研究目的。</p><p>图6. 两种CNN网络性能对比。(a) x分量原始地震记录；(b) y分量原始地震记录；(c) z分量原始地震记录；(d) 本文模型得到的特征曲线；(e) 一般CNN得到的特征曲线</p></sec></sec><sec id="s9"><title>5. 结论与讨论</title><p>本文利用深度卷积神经网络，一系列地震资料处理方法及递归短长时窗法，设计了一套微震信号的自动识别与拾取流程，从结果可以看出，在保证准确率的前提下，本文所用方法实现了小样本的微震信号自动识别的机器学习训练，改善了一般CNN所面临的训练样本需求量大的问题。</p><p>当然，一般CNN在使用了大的训练样本的情况下可以不太依赖专业知识。即使缺乏专业知识和经验，也可能取得不错的效果。而本文所用方法需要在一定程度上依赖于使用者的专业知识和经验。不过对于专业人员来说，并没有地震专业知识方面的障碍，只要选取了好的特征向量，此方法就能够在较小的样本下获得很高的准确率和较强的泛化能力，在数据量不是绝对大的情况下有明显优势。</p></sec><sec id="s10"><title>致谢</title><p>感谢煤炭资源与安全开采国家重点实验室的资金支持，感谢郑晶和吴志祥对本文CNN网络设计的指导和预测模型的提供。</p></sec><sec id="s11"><title>基金项目</title><p>国家重点研发计划(2018YFB0605503)，中国矿业大学(北京)大学生创新训练项目(2018TDB065503)。</p></sec><sec id="s12"><title>文章引用</title><p>谭浩阳,黄骏海,赵怡铭. 小数据集的微地震信号震相拾取方法Phase Arrivals Picking Method for Microseismic Signals with Small Dataset[J]. 计算机科学与应用, 2020, 10(12): 2227-2233. https://doi.org/10.12677/CSA.2020.1012234</p></sec><sec id="s13"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.39242-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Wang, H., Li, M. and Shang, X.F. (2016) Developments on Micro-Seismic Data Processing. Journal of Natural Gas Science and Engineering, 32, 521-537. &lt;br&gt;https://doi.org/10.1016/j.jngse.2016.02.058</mixed-citation></ref><ref id="hanspub.39242-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Allen, R.V. (1978) Au-tomatic Earthquake Recognition and Timing from Single Traces. Bulletin of the Seismological Society of America, 68, 1521-1532.</mixed-citation></ref><ref id="hanspub.39242-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Tselentis, G., Matakis, N., Paraskevopoulos, P., Lois, A. and Sokos, E. (2012) Strategy for Automated Analysis of Passive Microseismic Data Based on Stransform, Otsu’s Thresholding, and Higher Order Statistics. Geo-physics, 7, KS43-KS54. &lt;br&gt;https://doi.org/10.1190/geo2011-0301.1</mixed-citation></ref><ref id="hanspub.39242-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Sheng, G.Q. (2019) Hydraulic Fracturing Microseismic First Arrival Picking Method Based on Non-Subsampled Shearlet Transform and Higher-Order-Statistics. Journal of Seismic Exploration, 28, 593-618.</mixed-citation></ref><ref id="hanspub.39242-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">贾佳, 王夫运, 吴庆举. 机器学习在地震检测与震相识别的应用综述[J]. 地震工程学报, 2019, 41(6): 1419-1425.</mixed-citation></ref><ref id="hanspub.39242-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">赵明, 陈石, Dave Yuen. 基于深度学习卷积神经网络的地震波形自动分类与识别[J]. 地球物理学报, 2019, 62(1): 374-382.</mixed-citation></ref><ref id="hanspub.39242-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Zheng, J., Lu, J., Peng, S. and Jiang, T. (2018) An Automatic Microseismic or Acoustic Emission Arrival Identification Scheme with Deep Recurrent Neural Networks. Geophysical Journal International, 212, 1389-1397.  
&lt;br&gt;https://doi.org/10.1093/gji/ggx487</mixed-citation></ref><ref id="hanspub.39242-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Ross, Z.E., Meier, M. and Hauksson, E. (2018) P-Wave Arrival Picking and First-Motion Polarity Determination with Deep Learning. Journal of Geophysical Research, 123, 5120-5129. &lt;br&gt;https://doi.org/10.1029/2017JB015251</mixed-citation></ref><ref id="hanspub.39242-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Zhu, W. and Beroza, G.C. (2018) Phasenet: A Deep-Neural-Network-Based Seismic Arrival Time Picking Method. Geophysical Journal International, 216, 261-273. &lt;br&gt;https://doi.org/10.1093/gji/ggy423</mixed-citation></ref><ref id="hanspub.39242-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Zheng, J., Shen, S., Jiang, T. and Zhu, W. (2019) Deep Neural Networks Design and Analysis for Automatic Phase Pickers from Three-Component Micro-Seismic Recordings. Geophysical Journal International, 220, 323-334.  
&lt;br&gt;https://doi.org/10.1093/gji/ggz441</mixed-citation></ref><ref id="hanspub.39242-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Grigoli, F., Cesca, S., et al. (2014) Automated Seismic Event Location by Waveform Coherence Analysis. Geophysical Journal International, 196, 1742-1753. &lt;br&gt;https://doi.org/10.1093/gji/ggt477</mixed-citation></ref></ref-list></back></article>