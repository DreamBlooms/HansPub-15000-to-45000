<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2017.71011</article-id><article-id pub-id-type="publisher-id">CSA-19656</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20170100000_60715253.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于耦合关系的医生用药异常分析
  Detecting Abnormal Use of Drugs Based on Coupled Relationships
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>丽珍</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>芦</surname><given-names>俊丽</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>邓</surname><given-names>世昆</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>静</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>云南大学滇池学院，理工学院，云南 昆明;云南大学，信息学院，云南 昆明</addr-line></aff><aff id="aff3"><addr-line>云南大学，信息学院，云南 昆明</addr-line></aff><aff id="aff4"><addr-line>云南大学滇池学院，理工学院，云南 昆明</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>lzhwang@ynu.edu.cn(王丽)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>17</day><month>01</month><year>2017</year></pub-date><volume>07</volume><issue>01</issue><fpage>88</fpage><lpage>99</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   近些年来，医患关系受到广泛关注。如何准确地挖掘异常用药是制约医生和缓减医患关系的关键。本文提出了一种检测医生用药异常的总体框架。该框架集成处方数据的耦合相似度度量和变色龙聚类算法，并分为三个阶段，定性分析，定量分析和异常检测。在真实处方数据上进行了充分的实验，实验验证了该框架能够有效地检测出医生用药异常。 In recent years, the doctor-patient relationship has received extensive attention. How to exactly mine the abnormal use of drugs is the vital to constrain doctors and relieve the doctor-patient relationship. This paper presents a general framework for detecting the abnormal use of drugs. The framework integrates coupled similarity and Chameleon clustering algorithm, and consists of three stages, qualitative analysis, quantitative analysis and abnormal detection. We conduct extensive experiments on real-world prescription data. The experiments evaluate that the framework can efficiently detect abnormal use of drugs. 
</p></abstract>   
 
  
 
<kwd-group><kwd>耦合关系，聚类，异常分析, Coupled Relationships</kwd><kwd> Clustering</kwd><kwd> Abnormal Analysis</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于耦合关系的医生用药异常分析<sup> </sup></title><p>王丽珍<sup>1,2</sup>，芦俊丽<sup>2</sup>，邓世昆<sup>1</sup>，张静<sup>2</sup></p><p><sup>1</sup>云南大学滇池学院，理工学院，云南 昆明</p><p><sup>2</sup>云南大学，信息学院，云南 昆明</p><p>收稿日期：2017年1月6日；录用日期：2017年1月23日；发布日期：2017年1月26日</p><disp-formula id="hanspub.19656-formula1"><graphic xlink:href="http://html.hanspub.org/file/11-1540696x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>近些年来，医患关系受到广泛关注。如何准确地挖掘异常用药是制约医生和缓减医患关系的关键。本文提出了一种检测医生用药异常的总体框架。该框架集成处方数据的耦合相似度度量和变色龙聚类算法，并分为三个阶段，定性分析，定量分析和异常检测。在真实处方数据上进行了充分的实验，实验验证了该框架能够有效地检测出医生用药异常。</p><p>关键词 :耦合关系，聚类，异常分析</p><disp-formula id="hanspub.19656-formula2"><graphic xlink:href="http://html.hanspub.org/file/11-1540696x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>近些年来，医患关系越来越引起人们的重视，尤其是对医生滥开检查单、过度用药、开大处方等问题。究其原因，一是医学的复杂性和医生的诊治水平因素；二是经济原因。医院过于市场化的发展，医务人员的收入与医院的经济效益直接关联，开单提成、药物回扣等以药养医行为屡见不鲜；三是法律规章制度。例如在医疗事故鉴定法中规定了医生在鉴定过程中举症倒置的制度，这可能导致医生对病人做大量检查、开具较多药物等“防御性”的行为 [<xref ref-type="bibr" rid="hanspub.19656-ref1">1</xref>] 。</p><p>针对上述问题，本文提出一种检测医生用药异常的框架。此框架包含三个阶段，第一阶段，定性分析，将处方划分为相似团体，在相似团体下进行医生用药异常检测。第二阶段，定量分析，首先，针对复杂的处方数据，提出了基于耦合关系的处方相似度度量方法。然后，应用变色龙算法对处方数据进行聚类。第三阶段，异常检测，应用自定义的聚类指标检测医生用药异常。</p><p>大多数相似性度量都是基于数据之间相互独立的假设，但是在处方数据中，药物之间存在紧密配合与相互影响的关系，即耦合关系。考虑了耦合关系之后的医生处方用药异常检测，能够更准确地挖掘到医生用药异常情况。</p><p>论文其余部分的组织如下：第2节描述相关工作和相关概念，包括耦合相似度计算和变色龙聚类等。第3节给出了基于耦合关系的医生用药异常分析框架，包括定性分析，定量分析和异常检测。第4节在真实处方数据上进行了充分的实验，验证了所提出的框架和挖掘方法的有效性。</p></sec><sec id="s4"><title>2. 相关工作和相关概念</title><sec id="s4_1"><title>2.1. 相关工作</title><p>相似度用于衡量对象之间的相似程度，是数据挖掘和自然语言处理的基础，在诸如聚类、异常点检测等数据挖掘技术中广泛使用。由于描述数据对象的属性多种多样，相似度计算方式也分为很多种。计算数值属性的相似度常用欧几里得距离、曼哈顿距离和闵可夫斯基距离。离散属性有二值属性和多值属性，Jaccard系数 [<xref ref-type="bibr" rid="hanspub.19656-ref2">2</xref>] 是计算具有非对称二元属性的对象间的相似度的常用方法。序数属性是指其属性值之间具有意义的序或排位，而相继值之间的量值是未知的 [<xref ref-type="bibr" rid="hanspub.19656-ref3">3</xref>] 。余弦相似度是查询检索中常用的相似度计算方法，可用来计算文档之间的相似度，也可以计算词条间的相似度 [<xref ref-type="bibr" rid="hanspub.19656-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.19656-ref5">5</xref>] 。耦合相似度是不承认属性间以及对象间的相互独立，认为属性间以及对象间存在耦合关系。耦合相似度可以对离散属性 [<xref ref-type="bibr" rid="hanspub.19656-ref6">6</xref>] 和数值属性 [<xref ref-type="bibr" rid="hanspub.19656-ref7">7</xref>] 进行度量，针对不同类型的数据，使用的具体度量公式不同。关于离散属性的耦合相似度的具体内容在2.2.1节有详细介绍。</p><p>聚类分析简称聚类，根据数据对象及其关系的信息，将数据对象划分成子集的过程 [<xref ref-type="bibr" rid="hanspub.19656-ref8">8</xref>] 。每个子集是一个簇，簇中的数据对象更加相似。因为没有提供类标号信息，所以聚类分析有时被称为无监督分类。通常情况下，主要的基本聚类算法可以分为层次聚类算法、划分式聚类算法、基于密度和网格的聚类算法和其他聚类算法等。变色龙算法 [<xref ref-type="bibr" rid="hanspub.19656-ref9">9</xref>] 通过一个图划分方法将数据对象聚类为大量相对较小的子簇，然后用层次聚类算法通过反复合并子簇得到结果簇。此算法利用动态模型的层次聚类方法，不需要提前设定参数，可发现任意形状和密度的簇。K-means聚类算法 [<xref ref-type="bibr" rid="hanspub.19656-ref10">10</xref>] 是最经典的划分式聚类算法的代表，但此算法通常会在获得一个局部最优值时终止，仅适合对数值型数据聚类，只适用于聚类结果为凸形(即类簇为凸形)的数据集。为克服K-means聚类算法的不足，研究者们提出了K-modes-CGC算法 [<xref ref-type="bibr" rid="hanspub.19656-ref11">11</xref>] ，K-modes-Huang算法 [<xref ref-type="bibr" rid="hanspub.19656-ref12">12</xref>] ，K-means-CP算法 [<xref ref-type="bibr" rid="hanspub.19656-ref13">13</xref>] 等很多新的改进的K-means 算法。DBSCAN算法 [<xref ref-type="bibr" rid="hanspub.19656-ref14">14</xref>] 是一个比较有代表性的基于密度的聚类算法，与划分和层次聚类方法不同，它将簇定义为密度相连的点的最大集合，能够把具有足够高密度的区域划分为簇，并可在噪声的空间数据库中发现任意形状的聚类。Derya等人 [<xref ref-type="bibr" rid="hanspub.19656-ref15">15</xref>] 对DBSCAN进行了与辨识核对象、噪音对象和邻近类簇相关的3个边缘扩展，进而提出一种新的基于密度的聚类算法。</p><p>聚类分析常被用于异常检测。目前异常检测已经应用到诈骗检测、入侵检测、医疗、纳税等方面 [<xref ref-type="bibr" rid="hanspub.19656-ref16">16</xref>] 。在股市中，一群隐藏的操纵者之间相互合作操纵证券价格，CHMM-CBA方法用耦合关系来检测操纵行为。此外，一种更通用的CBA框架通过捕获更广泛的耦合关系去检测基于团体的市场操纵行为 [<xref ref-type="bibr" rid="hanspub.19656-ref17">17</xref>] 。在医疗方面，针对社会上存在的一些不法分子在医疗行为上虚构事实，隐瞒真相，以骗取医保基金或医疗待遇的情况，潘 [<xref ref-type="bibr" rid="hanspub.19656-ref18">18</xref>] 、王 [<xref ref-type="bibr" rid="hanspub.19656-ref19">19</xref>] 和梁等 [<xref ref-type="bibr" rid="hanspub.19656-ref20">20</xref>] 建立数据挖掘模型，预测各种医疗消费费用，并通过一系列的数据分析和挖掘，检测到医疗消费费用的异常记录。但是，将聚类分析应用到医生用药的异常检测的相关研究还很少。本文引入耦合相似度度量和变色龙聚类算法，检测医生用药异常。</p></sec><sec id="s4_2"><title>2.2. 相关概念</title><p>本节主要介绍在定量分析中采用的耦合相似度 [<xref ref-type="bibr" rid="hanspub.19656-ref6">6</xref>] 计算和变色龙聚类算法 [<xref ref-type="bibr" rid="hanspub.19656-ref9">9</xref>] 。</p><sec id="s4_2_1"><title>2.2.1耦合相似度</title><p>本小节以信息表为例，介绍如何计算属性值的耦合相似度(CASV)，以及对象的耦合相似度(CASO) [<xref ref-type="bibr" rid="hanspub.19656-ref6">6</xref>] 。信息表如表1所示。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x9_hanspub.png" xlink:type="simple"/></inline-formula>表示第i个对象，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x10_hanspub.png" xlink:type="simple"/></inline-formula>表示第j个属性。</p><p>使用耦合关系进行相似度度量时，不承认信息表中属性间、对象间相互独立的假定。耦合分为属性内耦合和属性间耦合。</p><p>1) 属性内耦合相似度(IaASV)</p><p>同一个属性内，属性值出现的次数差异反映的是值的频率分布，同一个属性内的两个值出现的频率越相近，它们的相似度越高 [<xref ref-type="bibr" rid="hanspub.19656-ref3">3</xref>] 。两个对象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x11_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x12_hanspub.png" xlink:type="simple"/></inline-formula>的第j属性的属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x13_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x14_hanspub.png" xlink:type="simple"/></inline-formula>的属性内耦合相似度(IaASV)可以通过下式计算：</p><disp-formula id="hanspub.19656-formula3"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1540696x15_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x16_hanspub.png" xlink:type="simple"/></inline-formula>表示属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x17_hanspub.png" xlink:type="simple"/></inline-formula>对应的集合，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x18_hanspub.png" xlink:type="simple"/></inline-formula>表示属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x19_hanspub.png" xlink:type="simple"/></inline-formula>出现的次数，因此<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x20_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x21_hanspub.png" xlink:type="simple"/></inline-formula>，且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x22_hanspub.png" xlink:type="simple"/></inline-formula>，m为信息表的规模。在表1中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x23_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x24_hanspub.png" xlink:type="simple"/></inline-formula>。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x25_hanspub.png" xlink:type="simple"/></inline-formula>。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> An example of information tabl</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >U A</th><th align="center" valign="middle" >a<sub>1</sub></th><th align="center" valign="middle" >a<sub>2</sub></th><th align="center" valign="middle" >a<sub>3</sub></th></tr></thead><tr><td align="center" valign="middle" >u<sub>1</sub></td><td align="center" valign="middle" >A<sub>1</sub></td><td align="center" valign="middle" >B<sub>1</sub></td><td align="center" valign="middle" >C<sub>1</sub></td></tr><tr><td align="center" valign="middle" >u<sub>2</sub></td><td align="center" valign="middle" >A<sub>2</sub></td><td align="center" valign="middle" >B<sub>1</sub></td><td align="center" valign="middle" >C<sub>1</sub></td></tr><tr><td align="center" valign="middle" >u<sub>3</sub></td><td align="center" valign="middle" >A<sub>2</sub></td><td align="center" valign="middle" >B<sub>2</sub></td><td align="center" valign="middle" >C<sub>2</sub></td></tr><tr><td align="center" valign="middle" >u<sub>4</sub></td><td align="center" valign="middle" >A<sub>3</sub></td><td align="center" valign="middle" >B<sub>3</sub></td><td align="center" valign="middle" >C<sub>2</sub></td></tr><tr><td align="center" valign="middle" >u<sub>5</sub></td><td align="center" valign="middle" >A<sub>4</sub></td><td align="center" valign="middle" >B<sub>3</sub></td><td align="center" valign="middle" >C<sub>3</sub></td></tr><tr><td align="center" valign="middle" >u<sub>6</sub></td><td align="center" valign="middle" >A<sub>4</sub></td><td align="center" valign="middle" >B<sub>2</sub></td><td align="center" valign="middle" >C<sub>3</sub></td></tr></tbody></table></table-wrap><p>表1. 信息表的例子</p><p>2) 属性间耦合相似度(IeASV)</p><p>属性间耦合是指属性之间的相互影响。属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x26_hanspub.png" xlink:type="simple"/></inline-formula>的属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x27_hanspub.png" xlink:type="simple"/></inline-formula> (x表示此属性值在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x28_hanspub.png" xlink:type="simple"/></inline-formula>行)和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x29_hanspub.png" xlink:type="simple"/></inline-formula>的相似度，是由<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x30_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x31_hanspub.png" xlink:type="simple"/></inline-formula>受其他属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x32_hanspub.png" xlink:type="simple"/></inline-formula>的影响来计算求得。</p><disp-formula id="hanspub.19656-formula4"><graphic xlink:href="http://html.hanspub.org/file/11-1540696x33_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x34_hanspub.png" xlink:type="simple"/></inline-formula>是属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x35_hanspub.png" xlink:type="simple"/></inline-formula>的值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x36_hanspub.png" xlink:type="simple"/></inline-formula>，而<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x37_hanspub.png" xlink:type="simple"/></inline-formula>表示属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x38_hanspub.png" xlink:type="simple"/></inline-formula>出现的次数。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x39_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x40_hanspub.png" xlink:type="simple"/></inline-formula>，而<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x41_hanspub.png" xlink:type="simple"/></inline-formula>表示与属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x42_hanspub.png" xlink:type="simple"/></inline-formula>出现在同行的属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x43_hanspub.png" xlink:type="simple"/></inline-formula>的值的集合。</p><p>例如，计算<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x44_hanspub.png" xlink:type="simple"/></inline-formula>的两个属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x45_hanspub.png" xlink:type="simple"/></inline-formula>受属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x46_hanspub.png" xlink:type="simple"/></inline-formula>影响下的相似度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x47_hanspub.png" xlink:type="simple"/></inline-formula>。其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x48_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x49_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x50_hanspub.png" xlink:type="simple"/></inline-formula>的属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x51_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x52_hanspub.png" xlink:type="simple"/></inline-formula>的属性间耦合相似度(IeASV)被描述为：</p><disp-formula id="hanspub.19656-formula5"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1540696x53_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x54_hanspub.png" xlink:type="simple"/></inline-formula>是一组属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x55_hanspub.png" xlink:type="simple"/></inline-formula>的属性值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x56_hanspub.png" xlink:type="simple"/></inline-formula>，n为属性个数。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x57_hanspub.png" xlink:type="simple"/></inline-formula>是属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x58_hanspub.png" xlink:type="simple"/></inline-formula>的权重系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x59_hanspub.png" xlink:type="simple"/></inline-formula>，并且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x60_hanspub.png" xlink:type="simple"/></inline-formula>。例如在表1中，当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x61_hanspub.png" xlink:type="simple"/></inline-formula>等于0.5时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x62_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>综上，IaASV强调的是属性内的属性值出现的频率，而IeASV强调的是属性间的相互影响。属性值耦合相似度(CASV)则通过这两种度量结合得到。</p><p>3) 属性值耦合相似度(CASV)</p><p>属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x63_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x64_hanspub.png" xlink:type="simple"/></inline-formula>的耦合相似度(CASV)定义如下：</p><disp-formula id="hanspub.19656-formula6"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1540696x65_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x66_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x67_hanspub.png" xlink:type="simple"/></inline-formula>分别是IaASV和IeASV。在表1中，属性值B<sub>1</sub>和B<sub>2</sub>的CASV是</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x68_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>4) 对象耦合相似度(CASO)</p><p>对象耦合相似度(CASO)可以由属性值耦合相似度(CASV)累计得到。对象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x69_hanspub.png" xlink:type="simple"/></inline-formula>和对象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x70_hanspub.png" xlink:type="simple"/></inline-formula>的耦合相似度(CASO)被定义为：</p><disp-formula id="hanspub.19656-formula7"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1540696x71_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x72_hanspub.png" xlink:type="simple"/></inline-formula>是指CASV，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x73_hanspub.png" xlink:type="simple"/></inline-formula>分别指对象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x74_hanspub.png" xlink:type="simple"/></inline-formula>在属性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x75_hanspub.png" xlink:type="simple"/></inline-formula>上的值，并且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x76_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>在表1中，对象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x77_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x78_hanspub.png" xlink:type="simple"/></inline-formula>的耦合相似度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x79_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec><sec id="s4_2_2"><title>2.2.2. 变色龙(Chameleon)聚类算法</title><p>变色龙聚类算法是利用动态模型的层次聚类算法，可以发现同构、自然的簇。它采用动态建模的方法来确定一对簇之间的相似度，不依赖于一个静态的、用户提供的模型，能自动地适应被合并簇的内部特征。所以，当簇具有不同的形状、大小和密度时，变色龙算法也能够有效地聚类。</p><p>变色龙算法可分为构造k-最近邻图，用最大生成树划分该k-最邻近图和合并子簇形成最终簇三个阶段。在第三阶段，通过子簇C<sub>i</sub>和C<sub>j</sub>之间的相对互连性RI{C<sub>i</sub>, C<sub>j</sub>}和相对近似度RC{C<sub>i</sub>, C<sub>j</sub>}来决定两个子簇之间的相似度，然后选择使得相似度函数取值最大的两个子簇合并。</p></sec></sec></sec><sec id="s5"><title>3. 基于耦合关系的医生用药异常分析</title><p>本文提出的框架(如图1所示)由三个阶段组成：定性分析，把现有的医院的真实处方转换成合适的表示形式，处方按相似团体进行划分，为下阶段定量分析做准备。定量分析，利用耦合关系度量处方间的相似性，用变色龙算法对处方进行聚类。异常检测，利用自定义的聚类指标检测医生用药异常。</p><sec id="s5_1"><title>3.1. 定性分析</title><p>为方便说明，先给出一些相关概念。</p><p>定义1 (专向科室)：是指专门诊治某一类疾病或某一身体部位病症的科室。例如，眼科、皮肤科。</p><p>定义2 (综合科室)：除了专向科室的科室均视为综合科室，它不具体诊治某一类疾病或某一身体部位病症。例如，简易门诊、急诊。</p><p>定义3 (相似团体)：综合科室中相同疾病为一个相似团体，是跨门诊的；而专向科室中每一个科室中相同疾病为一个相似团体。</p><p>在相似团体内的处方中进行异常检测，才有意义，还可以减少计算时间，减少结果偏差。</p></sec><sec id="s5_2"><title>3.2. 定量分析</title><p>定量分析由相似度计算和聚类两部分组成。相似度计算引入了耦合。考虑药物和药物之间的耦合关系，更真实地反应药物间的相互影响。如有些药品之间是有相互辅助作用的，它们往往同时出现。</p><sec id="s5_2_1"><title>3.2.1. 相似度计算</title><p>本文以处方为数据对象，药物为属性。为方便计算相似度，采用1或0表示此处方是否使用该药物。数据组织如图2所示，其中第一列代表处方编号。</p><p>利用信息表中属性及对象的耦合相似度度量方法(2.2.1节中已介绍)对处方数据进行相似度度量，其步骤如下：</p><p>1) 使用公式(1)计算属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x80_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x81_hanspub.png" xlink:type="simple"/></inline-formula>的内耦合相似度(IaASV)；</p><p>2) 使用公式(2)计算属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x82_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x83_hanspub.png" xlink:type="simple"/></inline-formula>的间耦合相似度(IeASV)；</p><p>图1. 医生用药异常分析框架</p><p>图2. 数据组织</p><p>3) 使用公式(3)计算属性值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x86_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x87_hanspub.png" xlink:type="simple"/></inline-formula>的耦合相似度(CASV)；</p><p>4) 使用公式(4)计算对象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x88_hanspub.png" xlink:type="simple"/></inline-formula>和对象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x89_hanspub.png" xlink:type="simple"/></inline-formula>的耦合相似度(CASO)。</p><p>计算CASO的时间复杂度为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x90_hanspub.png" xlink:type="simple"/></inline-formula>，n为属性个数，R为各属性中不同属性值个数的最大值，即：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x91_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>下面举例说明CASO的计算过程，表2是由三个处方构成的实例，利用CASO计算得到各处方之间的相似度，如表3所示，表2中的处方之间越相似，表3中的相似度值越大。</p></sec><sec id="s5_2_2"><title>3.2.2. 聚类</title><p>本论文采用变色龙算法进行聚类，如算法1所示，变色龙有两个关键步骤：图划分和层次聚类。</p><p>本文中一个处方表示一个数据点。若点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x92_hanspub.png" xlink:type="simple"/></inline-formula>是点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x93_hanspub.png" xlink:type="simple"/></inline-formula>的k最邻近(或点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x94_hanspub.png" xlink:type="simple"/></inline-formula>是点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x95_hanspub.png" xlink:type="simple"/></inline-formula>的k最邻近)，则两点之间存在一条边。变色龙算法第一阶段(第1，2步)是将处方聚类成若干子簇，每个子簇含有足够多的处方以满足动态建模生成子簇。将k-最近邻图划分成几部分，极大减少割边。由于k-最邻近图中的每条边表示处方之间的相似度，最小割边的划分可以有效减少不同子簇的处方间的关系。第二阶段(第3~5步)，使用动态建模架构层次聚类数据项，合并成簇。找到子簇之后，变色龙算法使用相对接近度和相对互连度框架对子簇进行合并。</p><p>假定m是数据对象(处方)的个数，p是子簇的个数。划分图需要的时间复杂度 [<xref ref-type="bibr" rid="hanspub.19656-ref9">9</xref>] 是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x96_hanspub.png" xlink:type="simple"/></inline-formula> (第2步)，在图划分得到的p个子簇上进行凝聚层次聚类需要<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x97_hanspub.png" xlink:type="simple"/></inline-formula>时间(第3~5步)。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Examples of descriptio</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >处方编号</th><th align="center" valign="middle" >诊室</th><th align="center" valign="middle" >病患</th><th align="center" valign="middle" >医生</th><th align="center" valign="middle" >处方</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >儿科门诊</td><td align="center" valign="middle" >马**</td><td align="center" valign="middle" >刘**</td><td align="center" valign="middle" >1、氯化钠注射剂；2、氨溴索注射液；3、5%葡萄糖注射剂； 4、炎琥宁注射剂；5、头孢硫脒注射剂(限儿童)</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >儿科门诊</td><td align="center" valign="middle" >党**</td><td align="center" valign="middle" >王*</td><td align="center" valign="middle" >1、布洛芬缓释混悬液；2、四季抗病毒合剂； 3、肺力咳合剂(乙) (限儿童)；4、阿莫西林克拉维酸钾分散片</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >儿科门诊</td><td align="center" valign="middle" >叶**</td><td align="center" valign="middle" >邹*</td><td align="center" valign="middle" >1、布洛芬缓释混悬液；2、四季抗病毒合剂； 3、肺力咳合剂(乙) (限儿童)；4、阿莫西林干混悬剂</td></tr></tbody></table></table-wrap><p>表2. 处方实例</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> The CASO similarity between description</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >1</th><th align="center" valign="middle" >2</th><th align="center" valign="middle" >3</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0.218</td><td align="center" valign="middle" >0.119</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0.218</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0.873</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >0.119</td><td align="center" valign="middle" >0.873</td><td align="center" valign="middle" >0</td></tr></tbody></table></table-wrap><p>表3. 处方间CASO相似度</p><p>Algorithm 1. Chameleon</p><p>算法1. 变色龙</p></sec></sec><sec id="s5_3"><title>3.3. 异常检测</title><p>利用变色龙算法对处方聚类后，再对结果进行统计，将处方的聚类结果映射到医生。通过处方异常点率PO和簇内处方比率CP对医生用药进行异常检测，PO和CP定义为：</p><disp-formula id="hanspub.19656-formula8"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1540696x98_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.19656-formula9"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1540696x99_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x100_hanspub.png" xlink:type="simple"/></inline-formula>为聚类后相似团体t中第i个医生的异常点处方数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x101_hanspub.png" xlink:type="simple"/></inline-formula>为相似团体t中第i个医生的处方总量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x102_hanspub.png" xlink:type="simple"/></inline-formula>为在相似团体t中，第i个医生在j簇中的处方数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1540696x103_hanspub.png" xlink:type="simple"/></inline-formula>为相似团体t中j簇包含的处方总数。</p><p>公式(6)主要检测：某医生诊治某相似团体次数较多，且使用的处方大致相似(医生一般都有自己的用药习惯)，会导致该医生的处方可能自成一簇。将自成簇的医生按异常报告出来，由领域专家鉴别。</p><p>在异常检测中，PO和CP的大小分别与异常点率阈值C<sub>1</sub>和簇内处方比率阈值C<sub>2</sub>进行比较，如果PO或CP大于相应阈值，即可认定该医生在此相似团体中用药异常。其中，C<sub>1</sub>应大于该相似团体所有异常点数量与该相似团体处方总量的比值，C<sub>2</sub>的值需要考虑到该医生在此相似团体中处方比重较大的情况，因此C<sub>2</sub>应大于该医生在此相似团体中的处方数量与该相似团体中总的处方数量的比值。</p><p>例如在数据规模为500的情况下，A医生在综合诊室的上呼吸道感染这个相似团体中所开设处方104个，经聚类后该相似团体共有62个异常点，其中A医生共有5个异常点，将处方的结果映射到医生后，对A医生的聚类统计结果如表4所示。</p><p>按照上述阈值C<sub>1</sub>和C<sub>2</sub>的取值原则，C<sub>1</sub>大于62/500 = 0.124，取0.3，C<sub>2</sub>大于104/500 = 0.208，取0.4。A医生的处方群点率为5/104 = 0.048小于C<sub>1</sub>。A医生在簇2中处方比率为60/113 = 0.53大于0.４，因此可以把A医生在该相似团体的簇2中的用药情况报告出来，待专家鉴别。</p></sec></sec><sec id="s6"><title>4. 实验结果与分析</title><p>本论文中对象间耦合相似度(CASO)的计算由MATLAB 2012b完成，变色龙算法由JAVA语言实现。所有实验均在主频2.4 GHz的因特尔酷睿2处理器，1 GB内存，windows7操作系统的PC机上运行。</p><sec id="s6_1"><title>4.1. 数据集</title><p>本实验使用的是某医院的真实处方数据。本着实验数据全面、准确的原则，采用的是有多名医生诊治且每名医生都诊治较多次的相似团体——综合诊室的上呼吸道感染和消化内科的慢性胃炎两个相似团体，其中综合诊室的上呼吸道感染共涉及93个药品，经预处理后有50个药品，消化内科的慢性胃炎共涉及49个药品，即两类处方数据分别有50和49个属性，处方规模均为1000。</p></sec><sec id="s6_2"><title>4.2. Jaccard和CASO对比分析</title><p>实验利用离散属性相似度计算中应用比较广泛的Jaccard相似度与对象耦合相似度CASO进行相似度度量，对比使用两者进行变色龙聚类得到的异常处方数和子簇个数，结果如图3，图4所示。</p><p>从图3中可以看出，使用Jaccard的异常点明显多于使用CASO的异常点。且随着数据集规模的增加，使用Jaccard的异常点数量增长速度明显大于使用CASO的增长速度。但不论使用哪种方法，上呼吸道感染的异常点数量均大于慢性胃炎，这是因为慢性胃炎的治疗药物主要集中在少数几个药品中，且处方的重复率较高。从图4可以看出，使用Jaccard的簇数量多于使用CASO的簇数量。经领域专家对聚类结果进行鉴定，由CASO得到的簇和异常点更合理和准确。这是由于Jaccard仅仅考虑两个对象间同时出现的属性个数是完全不够的，还需要考虑属性间耦合作用和属性内耦合作用，比如氨溴索注射液和氨溴索注射剂是不可能在同一处方中出现的，CASO就会考虑到这种情况。</p><p>从上述实验结果可以看出，CASO计算处方间相似度时充分考虑了属性以及对象的耦合作用，在聚类时有较好的效果。但是，正因为CASO充分考虑了耦合作用，其计算时间复杂度较高，并且其时间复杂度受属性个数影响很大，3.1节已阐述。</p></sec><sec id="s6_3"><title>4.3. CASO的计算时间随着属性数量增加的变化</title><p>本节对CASO的计算时间随着属性数增加的变化情况进行了实验。从图5可以看出随着属性数量的</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> The clustering results of doctor </title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >簇中的处方数量</th><th align="center" valign="middle" >该簇中A医生的处方数量</th></tr></thead><tr><td align="center" valign="middle" >簇1</td><td align="center" valign="middle" >54</td><td align="center" valign="middle" >9</td></tr><tr><td align="center" valign="middle" >簇2</td><td align="center" valign="middle" >113</td><td align="center" valign="middle" >60</td></tr><tr><td align="center" valign="middle" >簇3</td><td align="center" valign="middle" >87</td><td align="center" valign="middle" >8</td></tr><tr><td align="center" valign="middle" >簇4</td><td align="center" valign="middle" >184</td><td align="center" valign="middle" >22</td></tr></tbody></table></table-wrap><p>表4. A医生聚类结果</p><p>图3. 数据规模增加对异常点数量的影响</p><p>图4. 数据规模增加对簇数的影响</p><p>增加，CASO的计算时间增长较快。改善CASO计算复杂度也是未来工作中的主要任务之一。</p></sec><sec id="s6_4"><title>4.4. 异常结果分析</title><p>将处方的聚类结果映射到医生，检验医生在该相似团体中用药是否异常。本文在消化科室的慢性胃炎的1000个处方中进行检验。表5为将处方聚类后的簇映射到医生时的聚类情况。而表6为每个医生的异常点数及其在该相似团体内的处方总数。</p><p>表7为异常检测结果，其中的异常情况列若为“异常点”，表示此医生所开的处方异常点比率(公式(5)所示)大于阈值C<sub>1</sub>。异常情况列若为“簇*、簇*”，表示此医生在这几个簇中的处方比重很大，被怀疑是自成簇。从表中可以看出医生B、C、D、E、F、G均有所异常，对簇中包含的主要药品进行分析可以发现，B医生偏于使用的药品有莫沙必利分散片、瑞巴派特片、泮托拉唑钠肠溶胶囊；C医生偏于使</p><p>图5. 数据规模增加对簇数的影响</p><table-wrap id="table5" ><label><xref ref-type="table" rid="table5">Table 5</xref></label><caption><title> The clustering results after matching to doctor</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >簇1</th><th align="center" valign="middle" >簇2</th><th align="center" valign="middle" >簇3</th><th align="center" valign="middle" >簇4</th><th align="center" valign="middle" >簇5</th><th align="center" valign="middle" >簇6</th><th align="center" valign="middle" >簇7</th><th align="center" valign="middle" >簇8</th><th align="center" valign="middle" >簇9</th><th align="center" valign="middle" >簇10</th></tr></thead><tr><td align="center" valign="middle" >A医生</td><td align="center" valign="middle" >48</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >14</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >13</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >3</td></tr><tr><td align="center" valign="middle" >B医生</td><td align="center" valign="middle" >53</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >16</td><td align="center" valign="middle" >30</td><td align="center" valign="middle" >24</td><td align="center" valign="middle" >18</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" >16</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0</td></tr><tr><td align="center" valign="middle" >C医生</td><td align="center" valign="middle" >52</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >11</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >33</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >3</td></tr><tr><td align="center" valign="middle" >D医生</td><td align="center" valign="middle" >152</td><td align="center" valign="middle" >110</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >85</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >42</td><td align="center" valign="middle" >0</td></tr><tr><td align="center" valign="middle" >E医生</td><td align="center" valign="middle" >11</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >1</td></tr><tr><td align="center" valign="middle" >F医生</td><td align="center" valign="middle" >32</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >17</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >17</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >24</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td></tr><tr><td align="center" valign="middle" >G医生</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >11</td></tr><tr><td align="center" valign="middle" >总计</td><td align="center" valign="middle" >350</td><td align="center" valign="middle" >112</td><td align="center" valign="middle" >53</td><td align="center" valign="middle" >126</td><td align="center" valign="middle" >50</td><td align="center" valign="middle" >43</td><td align="center" valign="middle" >38</td><td align="center" valign="middle" >61</td><td align="center" valign="middle" >45</td><td align="center" valign="middle" >18</td></tr></tbody></table></table-wrap><p>表5. 映射为医生后的聚类结果</p><table-wrap id="table6" ><label><xref ref-type="table" rid="table6">Table 6</xref></label><caption><title> The distribution of outliers after matching to doctor</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >异常点数</th><th align="center" valign="middle" >处方总数</th></tr></thead><tr><td align="center" valign="middle" >A医生</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >86</td></tr><tr><td align="center" valign="middle" >B医生</td><td align="center" valign="middle" >19</td><td align="center" valign="middle" >189</td></tr><tr><td align="center" valign="middle" >C医生</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" >123</td></tr><tr><td align="center" valign="middle" >D医生</td><td align="center" valign="middle" >37</td><td align="center" valign="middle" >434</td></tr><tr><td align="center" valign="middle" >E医生</td><td align="center" valign="middle" >14</td><td align="center" valign="middle" >41</td></tr><tr><td align="center" valign="middle" >F医生</td><td align="center" valign="middle" >18</td><td align="center" valign="middle" >112</td></tr><tr><td align="center" valign="middle" >G医生</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >15</td></tr><tr><td align="center" valign="middle" >慢性胃炎相似团体</td><td align="center" valign="middle" >104</td><td align="center" valign="middle" >1000</td></tr></tbody></table></table-wrap><p>表6. 异常点映射为医生后情况表</p><table-wrap id="table7" ><label><xref ref-type="table" rid="table7">Table 7</xref></label><caption><title> The results of abnormal detectio</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >阈值C<sub>1 </sub></th><th align="center" valign="middle" >阈值C<sub>2 </sub></th><th align="center" valign="middle" >异常情况</th></tr></thead><tr><td align="center" valign="middle" >A医生</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.3</td><td align="center" valign="middle" >无</td></tr><tr><td align="center" valign="middle" >B医生</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.3</td><td align="center" valign="middle" >簇3、簇5、簇6</td></tr><tr><td align="center" valign="middle" >C医生</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.3</td><td align="center" valign="middle" >簇8</td></tr><tr><td align="center" valign="middle" >D医生</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.6</td><td align="center" valign="middle" >簇2、簇4、簇9</td></tr><tr><td align="center" valign="middle" >E医生</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >异常点</td></tr><tr><td align="center" valign="middle" >F医生</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.35</td><td align="center" valign="middle" >簇7</td></tr><tr><td align="center" valign="middle" >G医生</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.1</td><td align="center" valign="middle" >簇10</td></tr></tbody></table></table-wrap><p>表7. 异常检测结果</p><p>用养蔚灵颗粒；D医生则更加偏于使用胶体果胶铋干混悬剂、曲美布汀胶囊、猴头菌颗粒、复方尿囊素片、二氯乙酸二异丙胺片、伊托必利片；G医生虽然关于慢性胃炎的处方较少，但大部分都集中在复方聚乙二醇电解质散；而E医生虽然因为异常点认定为在诊治慢性胃炎时用药异常，但并没有为病人使用固定药物。</p></sec></sec><sec id="s7"><title>5. 结束语</title><p>本文针对医患矛盾中的医生用药异常问题，提出一种医生用药异常检测的框架。该框架包括定性分析，定量分析和异常检测三部分。其中定量分析中集成了处方数据的耦合相似度度量方法和变色龙聚类算法。实验验证了所提出的框架能够较好的发现医生用药异常的情况。未来的工作是改进利用CASO计算处方耦合相似度的效率，以及在此框架下提出更高效的算法进行医生用药异常检测。</p></sec><sec id="s8"><title>基金项目</title><p>国家自然科学基金(61472346, 61662086)；云南省自然科学基金(2016FA026, 2015FB149)。</p></sec><sec id="s9"><title>文章引用</title><p>王丽珍,芦俊丽,邓世昆,张 静. 基于耦合关系的医生用药异常分析 Detecting Abnormal Use of Drugs Based on Coupled Relationships[J]. 计算机科学与应用, 2017, 07(01): 88-99. http://dx.doi.org/10.12677/CSA.2017.71011</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.19656-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">李璐瑒. 过度医疗——医生道德沦丧是表象医疗体制偏差是根本[J]. 首都医药, 2010(1): 20-21.</mixed-citation></ref><ref id="hanspub.19656-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Pang-Ning Tan, Michael Steinbach, Vipin Kumar, 著. 数据挖掘导论[M]. 第二版. 范明, 范宏建, 等, 译. 北京: 人民邮电出版社, 2011: 43-48.</mixed-citation></ref><ref id="hanspub.19656-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Lin, D. (1998) An Information-Theoretic Definition of Similarity. ICML, 1, 296-304.</mixed-citation></ref><ref id="hanspub.19656-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Cai, D., He, X. and Han, J. (2005) Document Clustering Using Locality Preserving Indexing. IEEE Transactions on Knowledge and Data Engineering, 17, 1624-1637. &lt;br&gt;https://doi.org/10.1109/TKDE.2005.198</mixed-citation></ref><ref id="hanspub.19656-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Figueiredo, F., Rocha, L., Couto, T., et al. (2011) Word Co-Occurrence Features for Text Classification. Information Systems, 36, 843-858. &lt;br&gt;https://doi.org/10.1016/j.is.2011.02.002</mixed-citation></ref><ref id="hanspub.19656-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Wang, C., Dong, X.J., Zhou, F. and Cao, L.B. (2015) Coupled Attribute Similarity Learning on Categorical Data. IEEE Transactions on Neural Networks and Learning Systems, 26, 781-797. &lt;br&gt;https://doi.org/10.1109/TNNLS.2014.2325872</mixed-citation></ref><ref id="hanspub.19656-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Wang, C., She, Z. and Cao, L.B. (2013) Coupled Attribute Analysis on Numerical Data. Proceedings of the 23rd International Joint Conference on Artificial Intelligence (IJCAI 2013), Beijing, 3-9 August 2013, 1736-1742.</mixed-citation></ref><ref id="hanspub.19656-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Dunn, J.C. (1974) Well-Separated Clusters and Optimal Fuzzy Partitions. Journal of Cybernetics, 4, 95-104.  
&lt;br&gt;https://doi.org/10.1080/01969727408546059</mixed-citation></ref><ref id="hanspub.19656-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Pang-Ning Tan, Michael Steinbach, Vipin Kumar, 著. 数据挖掘导论[M]. 第二版. 范明, 范宏建, 等, 译. 北京: 人民邮电出版社, 2011: 381-384.</mixed-citation></ref><ref id="hanspub.19656-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Marques, J.P., 著. 模式识别——原理方法及应用[M]. 第二版. 吴逸飞, 译. 北京: 清华大学出版社, 2002: 51-74.</mixed-citation></ref><ref id="hanspub.19656-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Chaturvedi, A.D., Green, P.E. and Carroll, J.D. (2001) K-Modes Clustering. Journal of Classification, 18, 35-56.  
&lt;br&gt;https://doi.org/10.1007/s00357-001-0004-3</mixed-citation></ref><ref id="hanspub.19656-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Huang, Z. (1998) Extensions to the K-Means Algorithm for Clustering Large Data Sets with Categorical Values. Data Mining and Knowledge Discovery, 2, 283-304.</mixed-citation></ref><ref id="hanspub.19656-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Ding, C. and He, X. (2004) K-Nearest-Neighbor in Data Clustering: Incorporating Local Information into Global Optimization. Proceedings of the ACM Symposium on Applied Computing, Nicosia, 14-17 March 2004, 584-589.</mixed-citation></ref><ref id="hanspub.19656-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Ester, M., Kriegel, H.-P., Sander, J. and Xu, X. (1996) A Density-Based Algorithm for Discovering Clusters in Large Spatial Databases with Noise. Proceedings of Second International Conference on Knowledge Discovery and Data Mining, Portland, 2-4 August 1996, 226-231.</mixed-citation></ref><ref id="hanspub.19656-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Birant, D. and Kut, A. (2007) ST-DBSCAN: An Algorithm for Clustering Spatial-Temporal Data. Data &amp; Knowledge Engineering, 60, 208-221. &lt;br&gt;https://doi.org/10.1016/j.datak.2006.01.013</mixed-citation></ref><ref id="hanspub.19656-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">张欣. 基于数据挖掘的纳税数据异常检测研究与应用[D]: [硕士学位论文]. 西安: 西安石油大学, 2009.</mixed-citation></ref><ref id="hanspub.19656-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Song, Y., Cao, L., Wu, X., et al. (2012) Coupled Behavior Analysis for Capturing Coupling Relationships in Group- Based Market Manipulations. Proceedings of the 18th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, Beijing, 12-16 August 2012, 976-984. &lt;br&gt;https://doi.org/10.1145/2339530.2339683</mixed-citation></ref><ref id="hanspub.19656-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">潘芳. 基于贝叶斯的防病患欺诈模型研究[J]. 现代商贸工业, 2014(10): 80-82.</mixed-citation></ref><ref id="hanspub.19656-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">王凯. 社保医疗消费中的异常信息检测研究[D]: [硕士学位论文]. 湖南: 中南林业科技大学, 2012.</mixed-citation></ref><ref id="hanspub.19656-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">梁俊, 孙听雪. 基于数据挖掘的标准化医疗保险监控模型构建[J]. 医学信息学杂志, 2015, 36(3): 42-46.</mixed-citation></ref></ref-list></back></article>