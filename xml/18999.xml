<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2016.611082</article-id><article-id pub-id-type="publisher-id">CSA-18999</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20161100000_51710050.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于Labview的高速数据采集与存储系统的设计
  The Design of High Speed Acquisition and Storage System Based on Labview
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>秦</surname><given-names>志一</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吕</surname><given-names>丹桔</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>黄飞</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>云鹏</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>雁</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>西南林业大学，云南 昆明</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1297215564@qq.com(秦志)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>09</day><month>11</month><year>2016</year></pub-date><volume>06</volume><issue>11</issue><fpage>665</fpage><lpage>673</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   针对市面上现有的一般的数据采集卡采样位数不高和采样内存不够，从而不能进行长时间对信号进行有效的连续采样等问题。本文设计了基于labview的高速数据采集和存储系统。该系统能够实现高精度、高数据率，还可以采用软件和硬件同步触发的方式来完成对周期信号进行多通道连续实时监测采集和存储，使数据采集存储系统的采样内存扩展至电脑的内存。本系统以NI公司的高速数据采集卡为基础，以labview 2012为上位机软件开发平台，由数据采集卡对周期信号进行数据采集再通过串口将采集到的数据上传到上位机，上位机对采集的数据进行存储、显示和分析实现了多通道模拟量的实时监测。该设计最终实现了采样通道数为2，采样速率为200 M/s，采样精度为12位，采样深度达到2000。平台有效性验证了该采集平台兼容性好、性能稳定采集信号误差小，能够尽量做到对实际信号源数据的无失真还原。本文为高速数据采集提供了一种便携的设计方案，可以广泛的应用到现代测试测量技术工程中。&lt;br&gt;In view of the existing general data acquisition card in the market, it is not enough to have high sampling and sampling memory, so that the acquisition system cannot be carried out for a long time. The design of high speed data acquisition and storage system is based on Labview. It can not only achieve high accuracy and high data rate but also use the software and hardware synchronization trigger to complete the multi-channel continuous real-time monitoring of the acquisition and storage of periodic signal which is similar to the function of the oscilloscope. This system is based on high speed data acquisition card of NI company and Labview 2012 for PC software development platform. Data acquisition card is used for data acquisition of periodic signal through the serial port and collect data upload to upper computer. Upper computer collects data for storage, display and analysis to realize the real-time monitoring of mul-ti-channel analog. The design of the sampling channel is 2, the sampling rate up to 200 M/s, the sampling precision is 12, and the sampling depth is 2000. Platform validation of the collection platform has good compatibility, performance and stability of the collection signal error is ignorable, which can be as far as possible to the actual signal source data without distortion reduction. This paper provides a portable design for high speed data acquisition, which can be widely used in the engineering of modern test and measurement technology.
    
    
    
   
    
  
 
</p></abstract><kwd-group><kwd>Labview，高速数据，实时采集，实时存储，软件和硬件同步触发, Labview</kwd><kwd> High Speed Data</kwd><kwd> Real Time Acquisition</kwd><kwd> Real Time Storage</kwd><kwd> Software and Hardware Synchronization Trigger</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于Labview的高速数据采集与 存储系统的设计<sup> </sup></title><p>秦志一<sup>*</sup>，吕丹桔，刘黄飞，吴云鹏，张雁</p><p>西南林业大学，云南 昆明</p><disp-formula id="hanspub.18999-formula34"><graphic xlink:href="http://html.hanspub.org/file/6-1540641x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年11月3日；录用日期：2016年11月20日；发布日期：2016年11月23日</p><disp-formula id="hanspub.18999-formula35"><graphic xlink:href="http://html.hanspub.org/file/6-1540641x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对市面上现有的一般的数据采集卡采样位数不高和采样内存不够，从而不能进行长时间对信号进行有效的连续采样等问题。本文设计了基于labview的高速数据采集和存储系统。该系统能够实现高精度、高数据率，还可以采用软件和硬件同步触发的方式来完成对周期信号进行多通道连续实时监测采集和存储，使数据采集存储系统的采样内存扩展至电脑的内存。本系统以NI公司的高速数据采集卡为基础，以labview 2012为上位机软件开发平台，由数据采集卡对周期信号进行数据采集再通过串口将采集到的数据上传到上位机，上位机对采集的数据进行存储、显示和分析实现了多通道模拟量的实时监测。该设计最终实现了采样通道数为2，采样速率为200 M/s，采样精度为12位，采样深度达到2000。平台有效性验证了该采集平台兼容性好、性能稳定采集信号误差小，能够尽量做到对实际信号源数据的无失真还原。本文为高速数据采集提供了一种便携的设计方案，可以广泛的应用到现代测试测量技术工程中。</p><p>关键词 :Labview，高速数据，实时采集，实时存储，软件和硬件同步触发</p><disp-formula id="hanspub.18999-formula36"><graphic xlink:href="http://html.hanspub.org/file/6-1540641x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>目前，传统的数据采集系统的设计主流是基于美国国家仪器公司(National Instrument，简称NI)的数据采集卡和上位机的系统架构方式进行设计和基于下位单片机和上位机PC的系统架构方式进行设计 [<xref ref-type="bibr" rid="hanspub.18999-ref1">1</xref>] 。本文针对市面上出售的数据采集卡内存有限不能进行大批量数据存储的问题，提出了以美国NI公司数据采集卡为基础，利用上位机Labview系统，使电脑的内存变成了数据采集存储系统的内存大大提高了存储空间，采用软件和硬件同步触发的方式可以完成对周期信号进行高速长时间的进行连续采样。该设计还会将采集到的数据以excel文件形式进行存储，为后续对该信号数据分析和处理提供了一个良好的数据采集和数据处理的平台 [<xref ref-type="bibr" rid="hanspub.18999-ref2">2</xref>] 。本次设计是采用二次开发DLL实现在高采样率 [<xref ref-type="bibr" rid="hanspub.18999-ref3">3</xref>] 。实验结果表明该系统具有设计简便、采样速度高，长时间连续进行采样等优点。利用Labview软件搭载的数据采集与存储系统能便于用户使用，给用户在对信号进行分析和处理带来了极大的便利。</p></sec><sec id="s4"><title>2. 系统的程序设计</title><p>基于Labview的高速数据采集与存储系统采用Labview程序编程虚拟仪器由程序框图与程序框图相对应的前面板组成。</p><p>如图1所示是基于Labview的高速数据采集与存储系统框图。首先对仪器进行初始化，在Labview程序里设定好合适的采样率、采样通道端口 [<xref ref-type="bibr" rid="hanspub.18999-ref4">4</xref>] 。通过设置上升沿触发为数据采集的默认触发方式和合适的采样时间来对信号数据进行采集 [<xref ref-type="bibr" rid="hanspub.18999-ref5">5</xref>] 。每当该系统接收到上升沿脉冲时该系统就会对数据进行采集，根据设置的采样率参数和采样深度系统会对采集到的数据进行累加存储。当采样时间达到程序里设置的采集时间时，程序会自动判定为该次数据采集和存储完毕，并且对数据进行存储。采集周期结束后该系统的前面板的波形图表会对采集到的数据进行显示，即一个数据采样周期完成 [<xref ref-type="bibr" rid="hanspub.18999-ref6">6</xref>] 。</p><p>图1. 高速数据采集与存储的系统框图</p><p>如图2，Labview程序框图的含有数据存储模块，作用是将所采集到的数据以数组的形式存到指定路径的文件夹下的excel的文件里 [<xref ref-type="bibr" rid="hanspub.18999-ref7">7</xref>] 。程序框图的中间部分是一个条件结构来判断是否采集到数据，若采集到数据则将数据存放在数组中 [<xref ref-type="bibr" rid="hanspub.18999-ref8">8</xref>] 。条件结构下面的程序是将该系统采集到的数据转换成动态数据通过在设定好的时间内累加在前面板显示。该设计可以完成双通道信号数据采集和存储功能，程序框图设计里用的是通道1对数据进行采集和存储的，用户可以自己的选择用通道1还是通道2进行数据采集。程序框图的右边是开始、停止和设置采样率按钮。程序里设置的采样速率为每秒2000个点，用户可根据自己的要求设定好合适的采样速率 [<xref ref-type="bibr" rid="hanspub.18999-ref9">9</xref>] 。如图3所示用户可以根据自己需要设置合适的采样率，最高采样率可以达到200 M/s能完成对数据进行高速采集的目标。</p><p>图2. 数据采集与存储的Labview程序</p><p>图3. 程序框图前面板采样率的选择</p></sec><sec id="s5"><title>3. 系统的验证</title><p>利用信号发生器和Matlab仿真软件可以对该高速数据采集与存储系统来进行本次设计的有效性验证。</p><sec id="s5_1"><title>3.1. 频率的验证</title><p>验证过程：首先我们可以用信号发生器产生一个频率1 MHZ，幅值为1的方波，系统的采样率为200 M/s。通过该高速数据采集与存储系统可以在前面板中看到现时采集到的波形和已经采集到的波形数据(如图4所示)。再通过Matlab软件可以还原采集到的波形数据(如图5所示)。</p><p>通过计算由于500 ms应的Nextkit采样率为200 M/s从图像上可以看出该信号一个周期是100个点，根据上式可以算出T = 200/(200M/s) = 1 s,f = 1/t = 1 M。根据图5，我们看出幅值为1伏左右，而且是上升沿触发该系统采集数据。接下来我们用信号发生器输入1 kHZ的信号，系统的采样率为100 k/s。</p><p>在前面板中同样看到现时采集到的波形和已经采集到的波形数据(如图6所示)，1 ms/div对应的Nextkit采样率为100 k/s从(图7)中可以看出该信号一个周期是100个点，根据上式可以算出信号的周期T = 100/(100 k/s) = 0.001 s, f = 1/t = 1 k。通过上述验证能够证明该系统可以鉴别由信号源发出不同频率的波形数据。</p><p>图4. 系统采样时的前面板</p><p>图5. Matlab对频率为1 M幅值为1 V的方波信号还原波形图</p><p>图6. 系统采样时的前面板</p><p>图7. Matlab对频率为1 K幅值为1 V的方波信号还原的波形图</p></sec><sec id="s5_2"><title>3.2. 幅值的验证</title><p>验证过程：用信号发生器产生一个频率1 KHZ，幅值为10的方波，系统上采样率1 ms/div对应的Nextkit采样率为100 k/s，从图像上可以看出该信号一个周期是100个点，幅值为10。同理，根据上式可以算出信号的周期T = 100/(100 k/s) = 0.001 s，f = 1/t = 1 k。</p><p>再利用频率验证过程中对输入1 KHZ幅值为1 V的方波的分析结果，可以验证该系统能够完成对该系统进行频率的验证。</p></sec><sec id="s5_3"><title>3.3. 相位的验证</title><p>验证过程：用信号发生器产生一个频率1 KHZ，幅值为10的正弦波(如图8所示)，系统上采样率1 ms/div对应的Nextkit采样率为100 k/s，从图像上可以看出该信号一个周期是100个点,幅值为1的正弦波(如图9所示)。同理，根据上式可以算出信号的周期T = 100/(100 k/s) = 0.001 s, f = 1/t = 1 k。</p><p>再利用频率验证过程中对输入1 KHZ幅值为1的方波(如图10所示)的分析结果，可以验证该系统能够完成对该系统进行相位的验证(如图11所示)。</p><p>验证结果汇总如表1。</p><p>图8. 系统采样时的前面板</p><p>图9. Matlab对频率1 K幅值10 V方波信号的还原波形图</p><p>图10. 系统采样时的前面板</p><p>图11. Matlab对频率为1 K幅值为1 V的正弦信号的还原波形图</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Platform validation result</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >参数验证</th><th align="center" valign="middle" >系统验证方案</th><th align="center" valign="middle" >系统验证结果</th></tr></thead><tr><td align="center" valign="middle" >幅度验证</td><td align="center" valign="middle" >输入1 Khz幅值为1的方波信号和1 Khz幅值为10的方波</td><td align="center" valign="middle" >该系统能跟踪采集到信号源幅值的变化</td></tr><tr><td align="center" valign="middle" >频率验证</td><td align="center" valign="middle" >输入1 Khz幅值为1的方波信号和1 Mhz幅值为10的方波</td><td align="center" valign="middle" >该系统能跟踪采集到信号源频率的变化</td></tr><tr><td align="center" valign="middle" >相位验证</td><td align="center" valign="middle" >输入1 Khz幅值为1的方波信号和1 Khz幅值为1的正弦信号</td><td align="center" valign="middle" >该系统能跟踪采集到信号源相位的变化</td></tr></tbody></table></table-wrap><p>表1. 平台有效性的验证结果</p></sec></sec><sec id="s6"><title>4. 结语</title><p>本设计系统利用Labview开发平台和中科泛华测控的nextkit数据采集卡为基础进行二次开发了基于Labview的高速数据采集和存储系统，该系统完成了对检测信号数据的实时显示和存储功能。克服了传统的数据采集卡采样精度和速率不高、内存不足和无法进行长时间连续不间断的对信号源进行采样。</p><p>实验结果表明该系统最高采样率可以达到200 M/s，能够满足绝大多数用户对采样率的要求，而且该系统能够将数据以excel的形式保存数据，为后续对该信号进行数字信号处理的分析时提供了一个平台。</p></sec><sec id="s7"><title>基金项目</title><p>基金项目国家自然科学基金项目(61462078)；云南省教育厅科学研究基金项目(2012C098)。</p></sec><sec id="s8"><title>文章引用</title><p>秦志一,吕丹桔,刘黄飞,吴云鹏,张 雁. 基于Labview的高速数据采集与存储系统的设计The Design of High Speed Acquisition and Storage System Based on Labview[J]. 计算机科学与应用, 2016, 06(11): 665-673. http://dx.doi.org/10.12677/CSA.2016.611082</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.18999-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">李凡生, 余小英, 黄婷, 陆桂凤, 方慧. 基于Labview的磁电系数自动化测试平台搭建[J]. 磁性材料及器件, 2016(2): 24-28.</mixed-citation></ref><ref id="hanspub.18999-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">郭会军, 张建丰, 王志林, 耿小江. 基于Labview和ARM处理器的大型称重式蒸渗仪测控系统[J]. 农业工程学报, 2013(8): 23.</mixed-citation></ref><ref id="hanspub.18999-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">吴云鹏, 吕丹桔. 基于Labview的植物微信息获取[J]. 安徽农业科学, 2015(5): 362-366.</mixed-citation></ref><ref id="hanspub.18999-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">贾正森, 林君, 朱凯光, 王佳, 李雪涛. 多通道井–地电位梯度采集系统的设计与实现[J]. 吉林大学学报, 2015(1): 153-159.</mixed-citation></ref><ref id="hanspub.18999-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">左明武, 卢孔汉, 朱郭豪, 曹欢玲. 基于Labview的虚拟温度测控系统设计[J]. 机电工程技术, 2015(3): 35-37.</mixed-citation></ref><ref id="hanspub.18999-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">车子萍. 基于Labview和声卡的数据采集及频谱分析仪设计[J]. 仪器仪表用户, 2010(4): 14-15.</mixed-citation></ref><ref id="hanspub.18999-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">陈鼐. 基于ARM的嵌入式数据采集与处理系统[D]: [硕士学位论文]. 南京: 南京航空航天大学, 2007.</mixed-citation></ref><ref id="hanspub.18999-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">庞春辉. 基于Labview的测试软件设计[J]. 电子制作, 2015(4): 79.</mixed-citation></ref><ref id="hanspub.18999-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Bhaskarwar, T.V., Giri, S.S. and Jamakar, R.G. (2015) Automation of Shell and Tube Type Heat Exchanger with PLC and LabVIEW. College of Engineering Pune, India, 28-30 May 2015.</mixed-citation></ref></ref-list></back></article>