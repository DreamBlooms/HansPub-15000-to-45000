<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2020.107143</article-id><article-id pub-id-type="publisher-id">CSA-36710</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20200700000_34166718.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  Mean Shift算法在目标跟踪领域的应用研究
  Application of Mean Shift Algorithm in Target Tracking Field
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>叶</surname><given-names>鸿源</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>胡</surname><given-names>改玲</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>姜</surname><given-names>凌奇</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>冀</surname><given-names>泓江</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>西安交通大学机械学院，陕西 西安</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>15</day><month>07</month><year>2020</year></pub-date><volume>10</volume><issue>07</issue><fpage>1391</fpage><lpage>1399</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   目标跟踪物在运动过程不断移动以及在运动过程中被遮挡的问题一直是研究的一个焦点和重点问题。本文通过阐述Mean Shift算法原理，研究了Mean Shift算法对目标物的快速跟踪过程。并通过两组实验分别对运动目标物及在遮挡条件下运动目标物进行跟踪。第一组实验中，选取移动的物体篮球为目标物，并通过Mean Shift算法，不断迭代跟踪新的篮球位置，实现对篮球的跟踪。第二个实验中，选取移动的人为目标物，目标物在移动过程中被其他人遮挡，通过将颜色灰度特征应用到Mean Shift算法中，减少了其他物体对目标物跟踪的干扰，从而实现不断跟踪新目标。实验结果证明，Mean Shift算法能够快速、有效地实现目标跟踪。 It is still a challenge to study a real-time and accurate algorithm to solve the problem of target tracker moving constantly and being blocked in the process of movement. Mean Shift algorithm is simple in calculation and can quickly track the target. The Mean Shift algorithm principle is expounded, and two groups of experiments are carried out to track moving targets and moving targets under occlusion condition respectively. The experimental results prove that Mean Shift algorithm can realize fast and effective tracking. 
  
 
</p></abstract><kwd-group><kwd>目标跟踪，目标遮挡，Mean Shift算法, Target Tracking</kwd><kwd> Target Occlusion</kwd><kwd> Mean Shift Algorithm</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>Mean Shift算法在目标跟踪领域的应用研究</title><p>叶鸿源，胡改玲<sup>*</sup>，姜凌奇，冀泓江</p><p>西安交通大学机械学院，陕西 西安</p><disp-formula id="hanspub.36710-formula14"><graphic xlink:href="//html.hanspub.org/file/10-1541806x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2020年7月6日；录用日期：2020年7月20日；发布日期：2020年7月27日</p><disp-formula id="hanspub.36710-formula15"><graphic xlink:href="//html.hanspub.org/file/10-1541806x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>目标跟踪物在运动过程不断移动以及在运动过程中被遮挡的问题一直是研究的一个焦点和重点问题。本文通过阐述Mean Shift算法原理，研究了Mean Shift算法对目标物的快速跟踪过程。并通过两组实验分别对运动目标物及在遮挡条件下运动目标物进行跟踪。第一组实验中，选取移动的物体篮球为目标物，并通过Mean Shift算法，不断迭代跟踪新的篮球位置，实现对篮球的跟踪。第二个实验中，选取移动的人为目标物，目标物在移动过程中被其他人遮挡，通过将颜色灰度特征应用到Mean Shift算法中，减少了其他物体对目标物跟踪的干扰，从而实现不断跟踪新目标。实验结果证明，Mean Shift算法能够快速、有效地实现目标跟踪。</p><p>关键词 :目标跟踪，目标遮挡，Mean Shift算法</p><disp-formula id="hanspub.36710-formula16"><graphic xlink:href="//html.hanspub.org/file/10-1541806x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/10-1541806x8_hanspub.png" /> <img src="//html.hanspub.org/file/10-1541806x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>目标跟踪在计算机视觉领域有着非常重要的应用 [<xref ref-type="bibr" rid="hanspub.36710-ref1">1</xref>]。对于目标物的跟踪，如果单纯靠人眼识别观察，不仅耗费大量时间，而且可能会出现差错。视频目标跟踪，就是确定视频序列中每幅图像运动目标的位置 [<xref ref-type="bibr" rid="hanspub.36710-ref2">2</xref>]。随着科学技术的发展，视频目标跟踪技术已经被广泛应用于智能视频监控 [<xref ref-type="bibr" rid="hanspub.36710-ref3">3</xref>]、现代化军事 [<xref ref-type="bibr" rid="hanspub.36710-ref4">4</xref>]、航空航天 [<xref ref-type="bibr" rid="hanspub.36710-ref5">5</xref>]、智能交通系统 [<xref ref-type="bibr" rid="hanspub.36710-ref6">6</xref>]、人机交互 [<xref ref-type="bibr" rid="hanspub.36710-ref7">7</xref>] 以及工业生产、检测诊断等众多领域 [<xref ref-type="bibr" rid="hanspub.36710-ref8">8</xref>]。</p><p>在进行目标跟踪时，目标速度过快，跟踪的实时性问题是跟踪技术的难点 [<xref ref-type="bibr" rid="hanspub.36710-ref9">9</xref>]，运动跟踪算法的优劣极大影响跟踪结果的好坏。Mean Shift算法是一种基于迭代收敛到概率密度的局部极大的非参数估计算法，减少了跟踪算法的计算量 [<xref ref-type="bibr" rid="hanspub.36710-ref10">10</xref>]，具有实时性好，对目标的旋转、变形、以及边缘状态遮挡不敏感的优点 [<xref ref-type="bibr" rid="hanspub.36710-ref11">11</xref>]。</p><p>而在复杂的运动环境下，物体被遮挡等其他因素干扰对目标的区分与跟踪就显得困难 [<xref ref-type="bibr" rid="hanspub.36710-ref12">12</xref>]。通过KCF算法可将灰度特征换成多通道的彩色特征，即可实现在跟踪过程中利用颜色特征，实现对目标物运动甚至遮挡条件下的跟踪。</p><p>本文通过对Mean Shift算法的研究，将算法应用到目标跟踪技术中。通过两组实验，分别对运动物体以及运动物体在遮挡条件下进行目标跟踪。</p></sec><sec id="s4"><title>2. Mean Shift目标跟踪算法</title><sec id="s4_1"><title>2.1. Mean Shift算法介绍</title><p>Mean Shift (均值漂移)是一种非参数概率密度估计的方法，一种最优的寻找概率密度极大值的梯度上升法，在解决计算机视觉底层过程中表现出了良好的鲁棒性和较高的处理速度。Mean Shift最早于1975年由Fukunaga等人在关于概率密度梯度函数的估计一文中提出 [<xref ref-type="bibr" rid="hanspub.36710-ref13">13</xref>]。Mean Shift算法一般指的是一个迭代的步骤，即先算出当前点的漂移均值，移动该点到其漂移均值，然后以此为新的起始点，继续移动，直到满足一定的条件结束。</p></sec><sec id="s4_2"><title>2.2. Mean Shift算法原理</title><p>假设在给定的空间中有n个样本点， x i ， i = 1 , ⋯ , n ，则在x点的Mean Shift向量的基本形式定义为：</p><p>M h ( x ) = 1 k ∑ x ∈ S h ( x i − x ) (1)</p><p>其中， S h 是一个半径为h的高维球区域，它是满足下面关系式的所有点的集合：</p><p>S h ( x ) = P { y : ( y − x ) T ( y − x ) ≤ h 2 } (2)</p><p>k表示的是在有多少个样本落在了上述的多样本区域中。如图1所示，大圆所圈定的范围是 S h ，小圆表示落入大圆区域的样本点 x i ，黑点代表Mean Shift的基准偏移中心x，箭头表示样本点 x i 相对于基准点的偏移向量。在式(1)中， ( x i − x ) 表示的是相关区域内的样本点相对于中心的偏移向量，所以计算得到的Mean Shift向量 M h ( x ) 是对落入区域内的所有样本点相对于中心偏移向量的平均值。由梯度的相关知识可知，非零概率密度函数的梯度总是指向概率密度函数增加最快的方向，所以平均基准点 M h ( x ) 会指向样本分布最多的区域，即概率密度函数的梯度方向。</p><p>图1. Mean Shift示意图</p></sec><sec id="s4_3"><title>2.3. Mean Shift跟踪</title><p>因为Mean Shift向量总是指向概率密度函数的梯度方向，即概率密度增加的方向，因此通过Mean Shift向量反复迭代，会定义一条通往局部极值的路径。通过Mean Shift算法利用目标的颜色特征概率密度描述运动目标区域中心位于x的目标模型，在目标中心邻域搜索窗口内以相似性度量最大为原则，寻找最优的位于y的目标模型，使得两次移动距离小于某一阈值，以达到目标的真实位置，采用Bhattacharyya系数度量目标模型概率密度函数 q ^ u 和候选模型 p ^ u ( y ) 的相似程度。模型根据目标区域颜色特征的概率密度函数来描述：</p><p>目标模型：</p><p>q ^ = { q ^ u } u = 1 , ⋯ , m ∑ u = 1 m q ^ u = 1 (3)</p><p>候选目标：</p><p>p ^ = { p ^ u ( y ) } u = 1 , ⋯ , m ∑ u = 1 m p ^ u ( y ) = 1 (4)</p><p>目标模型概率密度函数：</p><p>q ^ u = C ∑ i = 1 n k ( ‖ x i * ‖ 2 ) δ [ b ( x i * ) − u ] C = 1 ∑ i = 1 n k ( ‖ x i * ‖ 2 ) (5)</p><p>候选目标概率密度函数：</p><p>p ^ u = C k ∑ i = 1 n k ( ‖ y − x i h ‖ 2 ) δ [ b ( x i * ) − u ] C k = ∑ i = 1 n k 1 k ( | | y − x i h | | 2 ) (6)</p><p>Bhattacharyya系数相似度测度：</p><p>ρ ^ ( y ) = ρ [ p ^ ( y ) , q ^ ] = ∑ u = 1 m p ^ u q ^ u (7)</p><p>权重系数 w i ：</p><p>w i = ∑ u = 1 m q ^ u p ^ u ( y 0 ) δ [ b ( x i ) − u ] (8)</p><p>新目标位置：</p><p>y 1 ^ = ∑ i = 1 n k x i w i g ( ‖ y 0 ^ − x i h ‖ 2 ) ∑ i = 1 n k w i g ( ‖ y 0 ^ − x i h ‖ 2 ) g ( x ) = − k ′ ( x ) (9)</p><p>其中u为目标的特征值，y为最优候选区域中心。 ρ ^ ( y ) 越大，表示两模型越相似。为定位下一帧目标，应使每 ρ ^ ( y ) 最大化。</p><p>将当前帧的候选目标的中心初始为前一帧目标中心 y 0 ^ ，然后在其领域内搜索匹配目标，不断地从目标的当前位置 y 0 移动到新目标位置 y 1 ^ ，若Mean Shift向量 y 1 ^ − y 0 ^ ， ‖ y 1 ^ − y 0 ^ ‖ &lt; ε 则停止迭代，使得 ρ ^ ( y ) 最大，直到候选区域与目标区域足够相似，此时目标区域中心位置会由 y 0 ^ 移动到新位置 y 1 ^ ，如图2。</p><p>图2. Mean Shift跟踪算法</p></sec></sec><sec id="s5"><title>3. 实验验证</title><p>物体在运动过程中，通过Mean Shift算法，验证运动的物体和运动物体在遮挡条件下的跟踪效果。实验采用视频为篮球场上物体的运动和足球场上人的运动。实验一中目标跟踪物选取为运动的篮球，实验二中目标跟踪物选取为穿红衣服的人。</p><sec id="s5_1"><title>3.1. 算法实现流程</title><p>首先，在一段视频序列中选取第一帧作为初始模型，框选目标跟踪物，通过Mean Shift算法迭代计算出目标的新位置，此位置作为下一次目标的新位置，以此类推，不断得到目标的新位置，如图3所示。</p><p>图3. 程序流程</p></sec><sec id="s5_2"><title>3.2. 实验结果</title><sec id="s5_2_1"><title>3.2.1. 运动物体的跟踪</title><p>图4. 运动状态下篮球的跟踪</p><p>图4为多人在球场上打球，这里选取红色的篮球作为跟踪目标，其中有多个穿不同颜色衣服的人会对跟踪目标造成干扰，如灰色，红色，蓝色，黑色衣服。选取篮球为跟踪目标物，通过Mean Shift算法对该视频序列进行目标跟踪，图4为分别选取第1帧，第10帧，第21帧，第150帧的实验结果。在第1帧中，选取了红色的篮球为目标跟踪物，第1帧作为初始模型，通过Mean Shift算法得到目标的新位置，以此类推，不断迭代得到新的位置。第10帧中，篮球落到地上，实验结果表明这段时间通过Mean Shift算法判断的红色框与实际目标物相吻合，第21帧中篮球靠近人的手，并在之后被人投出，投出后的通过Mean Shift算法判断的红色框区域仍与篮球目标物吻合。实验结果验证，本算法能够实现对运动物体的准确跟踪。</p></sec><sec id="s5_2_2"><title>3.2.2. 运动物体遮挡条件下的跟踪</title><p>图5. 运动的人在遮挡条件下的跟踪</p><p>选取足球场上特定行人进行目标跟踪，如图5，实验中有身穿红衣服和黑衣服的人在足球场上进行走动，红衣服人与黑衣服人在移动过程中相互存在相互遮挡的情况，选取黑衣服的人进行目标跟踪。图5分别为第1帧，第15帧，第30帧，第60帧的实验结果。第一帧中选取目标模型，下一帧中，通过Mean Shift算法得到新的位置，并且将颜色灰度特征应用到Mean Shift算法中，减少了黑衣服人对红衣服人遮挡的干扰，通过Mean Shift算法不断迭代，得到目标物运动过程中的新位置，在移动过程中，如图5，第15帧及第30帧黑色衣服的人被红色衣服的人遮挡，实验结果中，通过Mean Shift算法判断的目标物红色框的新位置与实际目标物位置一致。遮挡结束后见第60帧，依然能够实现对红衣服的人的跟踪。实验证明，将颜色灰度特征应用到Mean Shift算法中，能够实现目标物在遮挡条件下的跟踪。</p></sec></sec></sec><sec id="s6"><title>4. 结语</title><p>本文主要阐述并采用Mean Shift算法对目标物进行跟踪，通过两组实验，实验结果表明了Mean Shift在运动物体跟踪中能排除其他背景的干扰，可以准确地实现运动目标物的跟踪与运动目标跟踪物在遮挡条件下的跟踪。Mean Shift因其较为简单，复杂度不高的特性，能够简便快速地实现目标跟踪的效果。</p></sec><sec id="s7"><title>基金项目</title><p>面向国际工程教育认证的机械类专业课程综合性实验体系构建与教学模式研究(西安交通大学校级：17ZX002)。</p></sec><sec id="s8"><title>文章引用</title><p>叶鸿源,胡改玲,姜凌奇,冀泓江. Mean Shift算法在目标跟踪领域的应用研究Application of Mean Shift Algorithm in Target Tracking Field[J]. 计算机科学与应用, 2020, 10(07): 1391-1399. https://doi.org/10.12677/CSA.2020.107143</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.36710-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">卢湖川, 李佩霞, 王栋. 目标跟踪算法综述[J]. 模式识别与人工智能, 2018, 31(1): 67-82.</mixed-citation></ref><ref id="hanspub.36710-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">吴佳家, 高珏, 李敏, 许华虎. 基于均值漂移和卡尔曼滤波的跟踪算法研究[J]. 计算机技术与发展, 2014(1): 5-8.</mixed-citation></ref><ref id="hanspub.36710-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">孔晓东. 智能视频监控技术研究[D].: [博士学位论文] 上海: 上海交通大学, 2008.</mixed-citation></ref><ref id="hanspub.36710-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">赵久奋, 王明海. 红外探测阵列对固体导弹尾焰跟踪定位的研究[J]. 固体火箭技术, 2000, 23(4): 65-69.</mixed-citation></ref><ref id="hanspub.36710-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">乐宁. 基于视觉的直升机飞行模拟及跟踪系统研究[D]: [硕士学位论文]. 南京: 南京理工大学, 2010.</mixed-citation></ref><ref id="hanspub.36710-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">曾锐利, 李刚, 林凌. 智能交通监控系统中多目标跟踪算法[J]. 电子器件, 2007, 30(6): 185-188.</mixed-citation></ref><ref id="hanspub.36710-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">张铁, 马琼雄. 人机交互中的人体目标跟踪算法[J]. 上海交通大学学报, 2015, 49(8): 1213-1219.</mixed-citation></ref><ref id="hanspub.36710-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">谢达奇, 梁桥康, 孙炜, 王耀南. MeanShift聚类圆拟合算法在焊点检测中的应用[J]. 计算机仿真, 2019(9): 446-451.</mixed-citation></ref><ref id="hanspub.36710-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">许棣华, 王志坚. 基于多任务学习的邮件过滤系统的研究[J]. 计算机技术与发展, 2010, 20(10): 137-140.</mixed-citation></ref><ref id="hanspub.36710-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Comaniciu, D., Ramesh, V. and Meer, P. (2002) Real-Time Tracking of Non-Rigid Objects Using Mean Shift. Proceedings IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2000 (Cat. No.PR00662), Hilton Head Island, 15 June 2000. &lt;br&gt;https://doi.org/10.1109/cvpr.2000.854761</mixed-citation></ref><ref id="hanspub.36710-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">姚放吾, 许辰铭. 基于目标质心的Meanshift跟踪算法[J]. 计算机技术与发展, 2012, 22(6): 104-106+110.</mixed-citation></ref><ref id="hanspub.36710-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">刘巧元, 王玉茹, 张金玲, 等. 基于相关滤波器的视频跟踪方法研究进展[J]. 自动化学报, 2019, 45(2): 265-275.</mixed-citation></ref><ref id="hanspub.36710-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Fukunaga, K. and Hostetler, L.O. (1975) The Estimation of the Gradient of a Density Function, with Ap-plications in Pattern Recognition. IEEE Transactions on Information Theory, 21, 32-40. &lt;br&gt;https://doi.org/10.1109/tit.1975.1055330</mixed-citation></ref></ref-list></back></article>