<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2020.1010184</article-id><article-id pub-id-type="publisher-id">CSA-38199</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20201000000_18821754.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  焊接机器人数字孪生系统的构建与实现
  Construction and Implementation of Digital Twin System for Welding Robot
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>邓</surname><given-names>润福</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>苏</surname><given-names>卫星</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>焦</surname><given-names>长平</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>天津工业大学计算机科学与软件学院，天津</addr-line></aff><aff id="aff3"><addr-line>常州匠心独具智能家居股份有限公司，江苏 常州</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>10</day><month>10</month><year>2020</year></pub-date><volume>10</volume><issue>10</issue><fpage>1739</fpage><lpage>1746</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   针对焊接车间焊接机器人品类繁杂，设备管理水平低下的问题，在Grieves教授提出的数字孪生这一理论背景下，通过构建数字孪生系统将物理世界与信息世界进行融合与交互来解决上述问题。本文通过实现焊接机器人物理实体的关键要素信息化建模、基于OPC UA的焊接机器人生产过程数据采集以及机器人物理实体与孪生模型之间的交互和实时映射这三部分关键技术，完成对数字孪生系统的框架构建。最后，基于实际焊接机器人的生产过程实现了单元级数字孪生系统，验证了方法的可行性和准确性。为焊接车间构建复杂系统级数字孪生系统奠定了基础，也为焊接车间向数字化、智能化、现代化方向迈进提供了方案。 Aiming at the problems of welding robots with multifarious categories and low equipment management level in welding workshop, under the theoretical background of digital twinning proposed by Professor Grieves, the above problems are solved by constructing digital twinning system to integrate and interact with the physical world and the information world. In this paper, the frame construction of digital twin system is completed by implementing three key technologies: information-based modeling of key elements of physical entity of welding robot, data acquisition of production process of welding robot based on OPC UA, and interaction and real-time mapping between physical entity of robot and twin model. Finally, the unit level digital twin system is realized based on the actual welding robot production process, and the feasibility and accuracy of the method are verified. This lays a foundation for the construction of complex system-level digital twin system in the welding workshop, and also provides a scheme for the welding workshop to step forward in the direction of digitization, intelligentization and modernization. 
  
 
</p></abstract><kwd-group><kwd>数字孪生，OPC UA，数据采集，实时映射, Digital Twin</kwd><kwd> OPC UA</kwd><kwd> Data Collection</kwd><kwd> Realtime Mapping</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>针对焊接车间焊接机器人品类繁杂，设备管理水平低下的问题，在Grieves教授提出的数字孪生这一理论背景下，通过构建数字孪生系统将物理世界与信息世界进行融合与交互来解决上述问题。本文通过实现焊接机器人物理实体的关键要素信息化建模、基于OPC UA的焊接机器人生产过程数据采集以及机器人物理实体与孪生模型之间的交互和实时映射这三部分关键技术，完成对数字孪生系统的框架构建。最后，基于实际焊接机器人的生产过程实现了单元级数字孪生系统，验证了方法的可行性和准确性。为焊接车间构建复杂系统级数字孪生系统奠定了基础，也为焊接车间向数字化、智能化、现代化方向迈进提供了方案。</p></sec><sec id="s2"><title>关键词</title><p>数字孪生，OPC UA，数据采集，实时映射</p></sec><sec id="s3"><title>Construction and Implementation of Digital Twin System for Welding Robot<sup> </sup></title><p>Runfu Deng<sup>1</sup>, Weixing Su<sup>1</sup>, Changping Jiao<sup>2</sup></p><p><sup>1</sup>School of Computer Science and Software, Tiangong University, Tianjin</p><p><sup>2</sup>Changzhou Qiangxin Unique Intelligent Home Co., LTD., Changzhou Jiangsu</p><p><img src="//html.hanspub.org/file/5-1541871x4_hanspub.png" /></p><p>Received: Oct. 1<sup>st</sup>, 2020; accepted: Oct. 16<sup>th</sup>, 2020; published: Oct. 23<sup>rd</sup>, 2020</p><p><img src="//html.hanspub.org/file/5-1541871x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>Aiming at the problems of welding robots with multifarious categories and low equipment management level in welding workshop, under the theoretical background of digital twinning proposed by Professor Grieves, the above problems are solved by constructing digital twinning system to integrate and interact with the physical world and the information world. In this paper, the frame construction of digital twin system is completed by implementing three key technologies: information-based modeling of key elements of physical entity of welding robot, data acquisition of production process of welding robot based on OPC UA, and interaction and real-time mapping between physical entity of robot and twin model. Finally, the unit level digital twin system is realized based on the actual welding robot production process, and the feasibility and accuracy of the method are verified. This lays a foundation for the construction of complex system-level digital twin system in the welding workshop, and also provides a scheme for the welding workshop to step forward in the direction of digitization, intelligentization and modernization.</p><p>Keywords:Digital Twin, OPC UA, Data Collection, Realtime Mapping</p><disp-formula id="hanspub.38199-formula14"><graphic xlink:href="//html.hanspub.org/file/5-1541871x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/5-1541871x7_hanspub.png" /> <img src="//html.hanspub.org/file/5-1541871x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>随着信息技术的迅速发展，“工业4.0”以及“工业互联网”等概念的提出，标志着以智能制造为目标的第四次工业革命已经来临 [<xref ref-type="bibr" rid="hanspub.38199-ref1">1</xref>]。智能制造的核心目标是通过精确的过程状态跟踪和完整的实时数据获取来监控产品生产过程，进而实现物理世界与信息世界的互联互通 [<xref ref-type="bibr" rid="hanspub.38199-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.38199-ref3">3</xref>]。智能制造的重点和难点是复杂设备的数字化和智能化 [<xref ref-type="bibr" rid="hanspub.38199-ref4">4</xref>]。近年来焊接车间的数字化系统得到了较大的发展，同时也存在了一系列问题。例如，车间的焊接机器人种类较多，在构建数字化系统时需要针对不同设备单独研发设备的接入方法，而且维护需要分别进行，耗费了大量的时间和人力成本；同时对于一些老旧的设备其本身无法接入数字化系统。本文通过使用OPC统一架构，实现了不同设备统一接入数字化系统，从而完成了焊接机器人的数字孪生系统的构建。</p></sec><sec id="s6"><title>2. 焊接机器人数字孪生系统架构</title><p>数字孪生系统根据物理实体的复杂程度对应的可分为三个等级：单元级数字孪生系统，系统级数字孪生系统，复杂系统级数字孪生系统 [<xref ref-type="bibr" rid="hanspub.38199-ref5">5</xref>]。本文针对单个焊接机器人构建单元级数字孪生系统——焊接机器人数字孪生系统(如图1所示)。此单元级系统作为焊接车间复杂级系统的基本单元，具备数字孪生系统的全部模块，即物理实体层模块、孪生模型层模块以及功能应用层模块。</p><p>物理实体层作为焊接机器人数字孪生系统的基础，主要包括生产设备实体、数据采集与传输功能部件实体和操作人员实体三部分。其中，生产设备实体主要包括焊接机器人、机器人电气控制柜、滑轨式运载龙门以及产品工件等实体；数据采集与传输功能部件实体主要包括工控机、球形摄像头、可编程逻辑控制器(PLC)以及路由器等网关设备和无线大屏等展示设备；操作人员实体则为设备操作管理人员。三部分实体相互结合，实现了对工件产品的焊接以及机器人在工件焊接加工过程中的数据采集和应用。</p><p>孪生模型层作为焊接机器人数字孪生系统的核心，主要由数字模型和孪生数据构成。数字模型是对焊接机器人焊接生产过程的实体映射，真实反映了生产过程中机器人和工件等物理实体的位置、行为和状态特征。孪生数据是指由焊接生产活动中机器人等物理实体产生的数据以及由功能应用层反馈到数字模型后产生的融合衍生数据。此两部分结合而成的孪生模型是对焊接机器人焊接过程的数字化构建，通过构建的虚拟数字空间完成对物理空间焊接机器人生产活动的再现，在虚拟空间的模型对生产活动的模拟和迭代优化，进而对物理空间生产活动再决策 [<xref ref-type="bibr" rid="hanspub.38199-ref6">6</xref>]。</p><p>功能应用层作为焊接机器人数字孪生系统的服务，根据物理实体层和孪生模型层的虚实交互以及数据采集到的孪生数据，提供对生产过程的监控、优化以及物理实体层设备的维护等服务。</p><p>图1. 焊接机器人数字孪生系统架构</p></sec><sec id="s7"><title>3. 焊接机器人焊接过程数字孪生建模</title><p>在一个焊接流程中，主要涉及到的生产要素有焊接机器人设备、操作人员、焊接工件等，因此对焊接机器人数字孪生模型定义为：M<sub>DT</sub> = (DT<sub>RB</sub>, DT<sub>OPER</sub>, DT<sub>WORK</sub>)。式中M<sub>DT</sub>为焊接机器人数字孪生模型通用参考架构，DT<sub>RB</sub>为焊接机器人设备数字孪生模型，DT<sub>OPER</sub>为操作人员数字孪生模型，DT<sub>WORK</sub>为焊接工件数字孪生模型。</p><sec id="s7_1"><title>3.1. 焊接机器人设备</title><p>焊接机器人设备在生产活动中，具有行为动作，因此在构建其孪生模型时首先要根据物理实体进行真实映射，确保其空间尺寸以及动作行为与物理实体的一致性。同时，建立的模型还应具有实时获取实体数据的功能，为此需要实现孪生模型的虚实通信机制。最后，孪生模型还应该具有运动控制，信号处理等功能，此部分通过虚拟服务实现。故焊接机器人设备数字孪生模型定义为：DT<sub>RB</sub> = (RB<sub>MODEL</sub>, RB<sub>INTERFACE</sub>, RB<sub>SERVICE</sub>)。式中RB<sub>MODEL</sub>为物理实体三维模型，RB<sub>INTERFACE</sub>为虚实通信接口，RB<sub>SERVICE</sub>为虚拟服务。</p></sec><sec id="s7_2"><title>3.2. 操作人员</title><p>操作人员孪生模型主要涉及人员的位置以及动作，利用生产监控服务实时定位人员空间位置以及动作，并实时更新人员数据。模型定义如下：DT<sub>OPER</sub> = (OP<sub>MODEL</sub>, OP<sub>INTERFACE</sub>, OP<sub>SERVICE</sub>)。式中OP<sub>MODEL</sub>为人员三维模型，OP<sub>INTERFACE</sub>为人员位置/动作数据接口，OP<sub>SERVICE</sub>为生产监控服务。</p></sec><sec id="s7_3"><title>3.3. 焊接工件</title><p>在整个焊接工艺中，针对不同工位，有不同的焊接工件，其几何形态各异，同时在一个完整的焊接流程中，一个工件还伴随着产品编号，订单号等信息。通过信息数据接口将此类数据存储于模型的虚拟标签中。最后还需要定义其焊缝的演变服务，根据其提供的数据，确定工件的完成情况。因此，焊接工件孪生模型定义为：DT<sub>WORK</sub> = (WO<sub>MODEL</sub>, WO<sub>INTERFACE</sub>, WO<sub>SERVICE</sub>)。式中WO<sub>MODEL</sub>为焊接工件的三维模型，WO<sub>INTERFACE</sub>为信息数据接口，WO<sub>SERVICE</sub>为焊缝演变服务。</p></sec></sec><sec id="s8"><title>4. 焊接机器人生产过程实时数据获取</title><sec id="s8_1"><title>4.1. 数据通信网络架构</title><p>整个网络通信架构的物理层包括以焊接机器人，PLC，工控机，传感器，以及电缆线，网线等设备。数据链路层则使用以太网协议，满足数据传输速率快与数据流量大的要求。网络层与传输层使用的是TCP/IP协议。OPC UA作为客户端服务器模式下工业自动化软件开发统一标准，其具有支持复杂数据内置、跨平台操作，提供统一的地址空间和服务等优点 [<xref ref-type="bibr" rid="hanspub.38199-ref7">7</xref>]。所以，使用OPC UA协议作为应用层的数据协议，将自动采集的数据已一定的格式传输给客户端，实现OPC UA Server与OPC UA Client的数据传输。数据通信网络架构如图2所示。</p><p>图2. 数据通信网络架构</p></sec><sec id="s8_2"><title>4.2. 数据的模型构建和获取</title><p>由数据通信网络架构可得知全部的底层实体数据都通过OPC UA服务器获取，而为了更便捷的获取各个底层设备的数据，需要在服务器上对采集的设备实行模型的构建。由于焊接车间的设备实体众多，且可能存在多个同一类型的设备，因此本文建议采用对象–节点的方式进行建模。一个设备即为一个对象，称为Groups。其下分成多个Group，每个Group中存放着一组Item，每个Item即为一个节点，每个节点都有一个唯一的地址。其格式为：ns= ； = 。其中namespace index为命名空间索引，即此节点所在分组的顺序。type为节点地址的类型，一般为字符s，表示由UTF-8编码字符组成的字符串地址。value为具体的地址数值。通过对象以及节点的地址便可访问数据源的数据。本文以焊接机器人的数据采集模型构建为例，通过对象–节点方法在服务器端构建了模型，如  图3所示。其部分地址定义如  图4所示。</p><p>数据的获取首先需要实现工控机与OPC UA服务器建立连接。通过使用以太网将服务器连接到交换机上，进而连接到工控机上。同时根据服务器的IP地址将工控机的IP设置到与服务器同一网段。然后在数字孪生系统的通信模块中，通过获取本机IP与服务器的URL进行连接。当连接建立以后通过服务器句柄以及客户端句柄两个参数确定服务器对象以及客户端对象。最后通过服务器的节点地址获取数据。为了实现实时的获取数据，在数字孪生系统中通过使用订阅的方式来触发读取数据的事件。每当订阅的数据节点发生变化时，将触发读取事件，然后调用读取函数，将对应地址的数据节点数据再次读取。</p><p>图3. 对象–节点式数据模型构建</p><p>图4. 部分数据节点地址定义</p></sec></sec><sec id="s9"><title>5. 生产过程实时映射</title><p>要构建数字孪生系统，除以上两部分外，还需要在数字空间中完成孪生模型对物理实体的映射。通过虚实交互以达到系统的以虚控实功能。本文研究中可将映射与交互概括为3部分：</p><p>1) 设备 本文中的设备主要指焊接机器人，通过对机器人的运动轨迹，位置信息，动作类型以及状态信息进行映射。其映射主要通过机器人实体的驱动信号和驱动数据完成。包括机器人的运动驱动数据，例如机器人的转轴值，运动的轨迹值等。此外还有动作驱动信号，如机器人的开关信号，这类信号通过虚拟服务对实体的高低电平信号进行捕获。</p><p>2) 操作人员 对操作人员的身份信息、空间位置以及操作动作等进行映射，实现对人员的数字可视化管理。</p><p>3) 焊接工件 工件贯穿整个生产过程，对其生产过程的实时映射，展现了工件的完整演化过程。在数字空间中通过对工件的工艺数据，焊缝数据，焊接质量数据等进行映射，同时对大量的工件数据进行统计与分析。</p><p>映射与交互的关键是要实现数据流的流转。为了实现这一功能，在孪生层与应用层之间使用了WebService技术。孪生层将来自物理层的数据通过WebService接口以实体对象的方式进行传输。应用层通过调用接口，获得一个设备实体对象，再通过调用对象的属性便得到数据。应用层获得了数据后，通过数据驱动决策，再次将决策命令以数据的形式通过接口反馈到孪生模型。孪生模型将反馈的数据通过自动化接口Write方法写入到物理实体设备。</p></sec><sec id="s10"><title>6. 实例与验证</title><p>以某焊接车间的焊接机器人焊接生产过程为案例，为其在数字空间构建孪生数据。车间的焊接配套设备为德国克鲁斯焊接设备，包括焊接主体机器人、焊接龙门、电机驱动式工件承载底座。该套焊接设备通过总线的方式将所有设备控制器整合于电气控制柜中，通过以太网将工控机与电气柜进行连接。整个电气柜中涉及到克鲁斯自主研发的QINEO控制器(URL为：opc.tcp://169.254.1.99:48010)，一个西门子s7-1500 (IP为169.254.1.15)和一个s7-1200 (IP为169.254.1.12) PLC。使用KEPServerEX作为OPC UA服务器，在其中通过对象–节点方法，针对各个设备分别创建数据节点模型，该节点模型通过地址寻址访问底层设备数据。同时使用C#语言开发目视化系统作为OPC UA客户端，该客户端通过OPC自动化接口实现与服务器建立连接和通讯。在该客户端中按照服务器节点添加数据项，通过数据项接收读取到的数据进而实现对焊接机器人设备的状态信息的监控、焊接过程的实时参数展示、设备的生产信息管理以及错误信息管理和预警。本系统通过使用OPC UA快速的完成了三个不同类型控制器的接入与数据交互。将三个不同控制器的数据共同展现在可视化界面。在可视化界面，通过历史数据的趋势清晰的反映了5小时内生产的能耗以及相应的电流电压数值变化，直观了解设备的工作效率。同时，可视化系统记录了所有的报警信息，错误信息，并对于焊接的合格状态进行了统计，通过计算得出了合格率，便于工厂的生产管理做深入分析。焊接机器人具体工位物理模型如图5所示。数据可视化系统如图6所示。</p></sec><sec id="s11"><title>7. 结束语</title><p>针对焊接机器人数字孪生系统的构建进行了研究，提出了焊接机器人数字孪生系统的架构。并以此架构为基础通过实际的系统构建验证了架构的可行性。即在虚拟空间中构建实体的3D模型和数据模型，同时使用OPC UA技术完成物理层实体数据源的数据读写，将获取到的数据映射到数据实体模型上。通过孪生数据的映射，为整个数字孪生系统的构建提供了核心支撑。所使用的OPC UA技术完成异构设备的数据采集有效地解决了焊接车间设备之间信息孤立的问题，对构建数字化、智能化、信息化的现代先进焊接车间具有重要意义。</p><p>图5. 40吨焊接机器人工位模型</p><p>图6. 数据可视化系统</p></sec><sec id="s12"><title>基金项目</title><p>矿冶过程自动控制技术国家重点实验室/矿冶过程自动控制技术北京市重点实验室开放基金项目(BGRIMM-KZSKL-2019-08)；天津市自然基金项目(18JCQNJC77200)；天津市教委科技类项目(2017KJ094)；常州市领军型创新人才引进培育项目(CQ20200044)。</p></sec><sec id="s13"><title>文章引用</title><p>邓润福,苏卫星,焦长平. 焊接机器人数字孪生系统的构建与实现Construction and Implementation of Digital Twin System for Welding Robot[J]. 计算机科学与应用, 2020, 10(10): 1739-1746. https://doi.org/10.12677/CSA.2020.1010184</p></sec><sec id="s14"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.38199-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">刘志伟, 陈伟, 杨聪彬. 基于数字孪生的零件智能制造车间调度云平台[J]. 计算机集成制造系统, 2019(6): 1444-1453.</mixed-citation></ref><ref id="hanspub.38199-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">张映锋, 张党, 任杉. 智能制造及其关键技术研究现状与趋势综述[J]. 机械科学与技术, 2019(3): 329-338.</mixed-citation></ref><ref id="hanspub.38199-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Miao, Y., Zhu, M., Chen, G., et al. (2016) A Cyber-Physical Architecture for Industry 4.0-Based Power Equipment Detection System. International Conference on Condition Monitoring &amp; Diagnosis, Xi’an, 782-785.</mixed-citation></ref><ref id="hanspub.38199-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Li, L.L., Li, H., GU, F., et al. (2019) Multidisciplinary collaborative Design Modeling Technologies for Complex Mechanical Products Based on Digital Twin. Computer Integrated Manufacturing Systems, 6, 1308-1319.</mixed-citation></ref><ref id="hanspub.38199-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Tao, F., Liu, W.R., Zhang, M., et al. (2019) Five-Dimension Digital Twin Model and Its Ten Applica-tions. Computer Integrated Manufacturing Systems, 1, 1-18.</mixed-citation></ref><ref id="hanspub.38199-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Liu, D., Huang, H.T., Wang, B.X., et al. (2019) Op-eration Paradigm for Remanufacturing Shop-Floor Based on Digital Twin. Computer Integrated Manufacturing Systems, 6, 1515-1527.</mixed-citation></ref><ref id="hanspub.38199-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">原红丽, 吕静, 刘枫. 基于OPC UA客户端/服务器的现场设备集成[J]. 西南师范大学学报: 自然科学版, 2012, 37(3): 141-145.</mixed-citation></ref></ref-list></back></article>