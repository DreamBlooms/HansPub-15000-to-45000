<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">IaE</journal-id><journal-title-group><journal-title>Instrumentation and Equipments</journal-title></journal-title-group><issn pub-type="epub">2332-6980</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/IaE.2019.73025</article-id><article-id pub-id-type="publisher-id">IaE-32365</article-id><article-categories><subj-group subj-group-type="heading"><subject>IaE20190300000_20629627.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于BP神经网络的超声流量计声道流速修正方法研究
  Research on Correction Method of Sound Channel Velocity of Ultrasound Flowmeter Based on BP Neural Network
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>晶晶</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>建民</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>晓昱</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>希文</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>晨</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>周</surname><given-names>齐</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>滕</surname><given-names>梓洁</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>史</surname><given-names>去非</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>北京市计量检测科学研究院，北京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>16</day><month>07</month><year>2019</year></pub-date><volume>07</volume><issue>03</issue><fpage>186</fpage><lpage>192</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   超声波流量计直接测量得到的流速为超声波传播路径上的线平均流速，它与管道截面平均流速不同，为了获得流量的准确值，必须对测量得到的流速进行修正。本文建立了基于BP神经网络的多声道线平均流速修正模型，根据超声波流量计实测实验获得充足的实验数据作为数据样本，对建立的模型进行训练和验证，通过对训练后模型的验证发现，建立的修正模型可以准确修正超声波流量计的声道流速。 The flow velocity measured directly by the ultrasonic flowmeter is the line average velocity along the ultrasonic propagation path, and it is different from the average flow velocity of the pipeline section. In order to obtain the exact value of flow, the measured flow velocity must be corrected. In this paper, a velocity correction model of multi-channel based on BP neural network is established. According to the experiment of ultrasonic flowmeter, sufficient experimental data are obtained as data samples to train and valid the model. Through the validation of the model after training, it is found that established model can accurately correct the flow velocity in the channel of the ultrasonic flowmeter. 
 
</p></abstract><kwd-group><kwd>流量测量，超声流量计，流速修正，BP神经网络, Flow Measurement</kwd><kwd> Ultrasonic Flowmeter</kwd><kwd> Velocity Correction</kwd><kwd> BP Neural Network</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于BP神经网络的超声流量计声道流速修正 方法研究<sup> </sup></title><p>李晶晶，王建民，吴晓昱，杨希文，李晨，周齐，滕梓洁，史去非<sup>*</sup></p><p>北京市计量检测科学研究院，北京</p><disp-formula id="hanspub.32365-formula51"><graphic xlink:href="//html.hanspub.org/file/6-2990254x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2019年8月30日；录用日期：2019年9月20日；发布日期：2019年9月27日</p><disp-formula id="hanspub.32365-formula52"><graphic xlink:href="//html.hanspub.org/file/6-2990254x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>超声波流量计直接测量得到的流速为超声波传播路径上的线平均流速，它与管道截面平均流速不同，为了获得流量的准确值，必须对测量得到的流速进行修正。本文建立了基于BP神经网络的多声道线平均流速修正模型，根据超声波流量计实测实验获得充足的实验数据作为数据样本，对建立的模型进行训练和验证，通过对训练后模型的验证发现，建立的修正模型可以准确修正超声波流量计的声道流速。</p><p>关键词 :流量测量，超声流量计，流速修正，BP神经网络</p><disp-formula id="hanspub.32365-formula53"><graphic xlink:href="//html.hanspub.org/file/6-2990254x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/6-2990254x8_hanspub.png" /> <img src="//html.hanspub.org/file/6-2990254x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 前言</title><p>超声流量计作为一种流量测量仪表，具有非接触测量、无可动扰流件、无压损、适用管径和流体范围广等优势 [<xref ref-type="bibr" rid="hanspub.32365-ref1">1</xref>] - [<xref ref-type="bibr" rid="hanspub.32365-ref6">6</xref>] 。超声流量计主要由安装在测量管道上的超声换能器、转换器及流量显示和累计系统组成，通过检测超声波脉冲信号在运动流体中沿顺流方向和逆流方向传播的时差、相位差或频差而算出流速与流量的，其中外夹式超声流量计安装方便，已经被广泛用于工业现场的流量测量 [<xref ref-type="bibr" rid="hanspub.32365-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.32365-ref8">8</xref>] 。</p><p>超声波流量计测量得到的流速为超声波传播路径上的线平均流速，它与管道截面平均流速不同，为了获得流量的准确，必须对测量得到的流速进行修正。目前，对光滑圆管中的流体流速进行修正是通过获得流体动力学修正系数进行的，而该系数主要根据流体力学半经验公式，通过获得流体的雷诺数得到，然而雷诺数又是管路内流体流速的函数，因此该修正方法在准确计算流体雷诺数时具有一定难度。此外，以上修正方法针对的管道内流场稳定的情况，当管路内流场不再均匀时，上述修正方法的准确性不高。</p><p>本文建立了基于BP神经网络的多声道线平均流速修正模型，根据超声流量计线平均流速实测实验获得充足的实验数据作为数据样本，对建立的模型进行训练和验证，克服现有修正方法受雷诺数计算以及流场影响。</p></sec><sec id="s4"><title>2. 原理介绍</title><p>以时差法外夹式超声波流量计中常用的V法安装为例，其测量原理如图1所示，通过检测超声波脉冲信号在运动流体中沿顺流方向和逆流方向传播的时间差可以算出流速，进而计算出管道内的流量。</p><p>图1. V法超声流量计测量原理示意图</p><p>两台换能器接收到超声往返信号的时间不同，存在一个时差 Δ t 。若超声波顺流时从换能器TRA到达换能器TRB所需的时间为 t 1 ，逆流时从换能器TRB到达换能器TRA所需的时间为 t 2 ，则有：</p><p>Δ t = t 1 − t 2 = 4 v L 3 c 0 2 − v 2 sin 2 θ 2 (1)</p><p>式中， θ 2 为超声波在流体中的折射角； c 0 为超声波在被检测流体中的声速。一般情况下，被测流体的流速为每秒几米以内，而流体中的声速约为1500 m/s，即满足 c 0 2 远大于 v 2 sin 2 θ 2 ，因此，线平均流速 v 的表达式如下：</p><p>v = Δ t c 0 2 4 d tan θ 2 (2)</p><p>只需测得 t 1 、 t 2 (即 Δ t )，就能得到声道上各点流速的平均值，即线平均流速 v ，经过流速修正之后可以得到截面上流体的面平均流速 v &#175; ，进而可以计算满管圆管流的体积流量。</p><p>超声波流量计测量的流速为超声射线传播路径上的线平均流速，它与管道截面平均流速是不相同的，为了准确获得流量，必须对流速v进行修正。根据流体力学半经验公式，对于光滑圆管，超声线平均流速v与面平均流速 v &#175; 之间的关系为：</p><p>v = k ⋅ v &#175; (3)</p><p>式中， k 为流量修正系数，在层流流动状态时( Re &lt; 2300 )修正系数 k = 4 3 ；当流动状态是紊流时，它的值与光滑圆管阻力系数 λ 直接相关：</p><p>k = 1 + 1.25 λ 8 (4)</p><p>λ 是流体雷诺数的函数，它可以被表示为：</p><p>λ = 0.0032 + 0.221 Re − 0.237 (5)</p><p>当雷诺数 Re 在 5 &#215; 10 3 ~ 1 &#215; 10 7 的变化范围内，超声射线的平均流速v与管道截面平均流速 v &#175; 之间的差值将在4%~8%之间变化。如果不进行修正，则可能造成较大的测量误差，从而难以保证测量精度。</p><p>本文利用BP神经网络对超声流量计多声道测量得到的线平均流速进行修正，使得超声流量计测量结果更加准确。</p></sec><sec id="s5"><title>3. BP神经网络模型</title><p>要对超声流量计多声道测量得到的线平均流速进行修正，使超声流量计测量结果更加准确，首先需要建立BP神经网络修正模型。建立的BP神经网络修正模型包括四个输入，一个输出，四个输入分别为超声流量计四声道线平均流速测量值，一个输出为标定实验中水流量标准装置的流速输出值，建立的超声流量计四声道线平均流速修正模型如图2所示。</p><p>神经网络模型具有强大的非线性逼近能力，可以模拟复杂非线性函数关系，尤其是BP(Back Propagation)神经网络具有结构简单的应用成熟的特点，而且三层BP神经网络已经被证明可以解决任意非线性函数的逼近问题 [<xref ref-type="bibr" rid="hanspub.32365-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.32365-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.32365-ref11">11</xref>] 。基于BP神经网络的特点，建立三层BP神经网络作为多声道超声流量计线平均流速的修正模型，建立的三层BP神经网络结构如图3所示。</p><p>如图3所示，建立的BP神经网络模型具有四个输出和一个输出。输入分别为流量计实测实验获得的四声道线平均流速，输出为水流量标准装置输出的流体流速准确值。BP神经网络还包括多个隐藏神经</p><p>图2. 超声流量计四声道线平均流速修正模型</p><p>图3. BP神经网络模型</p><p>节点，通过反复尝试最终确定节点数为38时，平方和误差最小。隐层fhid传递函数选取tan-sigmoid函数，输出层fout则学选取pure-line函数。神经网络的训练过程是寻找网络最优参数值得过程，判断标准则是神经网络预测值与真实值之间的平方和误差最小 [<xref ref-type="bibr" rid="hanspub.32365-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.32365-ref10">10</xref>] 。通过足够的数据样本对BP神经网络的训练，最终可以确定传递矩阵V<sup>ih</sup>和W<sup>ho</sup>。网络训练的收敛速度取决于训练算法的选择，trainlm是一种需要大量内存的优化算法，收敛速度更快，精度更高，这使得trainlm成为BP神经网络中的默认训练算法 [<xref ref-type="bibr" rid="hanspub.32365-ref11">11</xref>] [<xref ref-type="bibr" rid="hanspub.32365-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.32365-ref13">13</xref>] 。trainlm在收敛速度方面具有很大的优势，而学习速度越大，trainlm的收敛速度越快。本文使用trainlm函数训练建立的BP神经网络模型，并设置学习率为0.01。</p><p>超声流量计实测试验中，选择声道1、声道2、声道3和声道4进行超声流量计流量实测实验，四声道安装示意图及照片如图4所示。管路内流体介质选取水，流速为1 m/s。超声流量计选择唐山汇中外夹式超声流量计，按图4声道设置方式安装。实验在中国计量科学研究院流量实验室进行，实验装置为水流量标准装置，流量范围(0.3~500) m<sup>3</sup>/h，可以对内径(65~200) mm的流量计进行校准，该实验装置的原理为静态质量法，其最佳不确定度可达0.05% (k = 2)。</p><p>超声流量计实测试验时，管路内流体介质选取水，流速为1 m/s。实验开始后采集超声流量计四个声道的流速输出数据及水流量标准装置输出的流速值。实验共获得136组测量数据，选取其中116组作为BP神经网络模型的训练数据集，20组作为测试集。训练时，计算的目标精度设置为10<sup>−4</sup>，模型经过37,793步运算，耗时57 s后进入收敛状态。</p><p>图4. 四声道安装示意图及实物照片</p><p>使用预留的20组数据对训练后的修正模型进行测试，BP修正模型预测结果如图5所示，从图中可以发现，训练后的修正模型可以以较小误差逼近流速的真实值，修正模型基本达到了修正声道流速值得目标。为了验证修正模型的修正效果，将BP神经网络修正模型的修正结果与传统的计算流体动力学修正系数的修正方法进行比较。比较结果如图6所示，从图中可以发现，本文建立的修正模型修正效果要好于传统方法。</p><p>图5. BP修正模型计算结果与水流量标准装置输出值对比图</p><p>图6. BP修正模型修正结果与传统修正方法获得结果比较</p></sec><sec id="s6"><title>4. 结论</title><p>本文建立了基于BP神经网络的超声波流量计多声道线平均流速修正模型，并设计了四声道超声流量计实测实验。使用超声波流量计实测实验获得充足的实验数据作为数据样本，对建立的基于BP神经网络的四声道线平均流速修正模型进行训练和验证。通过对训练后的修正模型进行验证发现，本文建立的修正模型可以准确对超声流量计声道线平均流速进行修正，修正效果优于传统的计算流体动力学修正系数的修正效果。</p></sec><sec id="s7"><title>基金项目</title><p>本文中的研究工作受2018年国产质监领域计量科学仪器验证评价与推广项目(Z181100009518012)资助。</p></sec><sec id="s8"><title>文章引用</title><p>李晶晶,王建民,吴晓昱,杨希文,李 晨,周 齐,滕梓洁,史去非. 基于BP神经网络的超声流量计声道流速修正方法研究Research on Correction Method of Sound Channel Velocity of Ultrasound Flowmeter Based on BP Neural Network[J]. 仪器与设备, 2019, 07(03): 186-192. https://doi.org/10.12677/IaE.2019.73025</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.32365-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">周伟华. 浅谈流量计量的意义[J]. 计量与测试技术, 2008, 35(8): 85-86.</mixed-citation></ref><ref id="hanspub.32365-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">张学庆. 流量测量的意义及流量传感器的现状[J]. 石油化工自动化, 2005(5): 99-101.</mixed-citation></ref><ref id="hanspub.32365-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">川田裕郎, 等. 流量测量手册(日) [M]. 北京: 计量出版社, 1987.</mixed-citation></ref><ref id="hanspub.32365-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Han, J.P., Liu, H., Zhou, Y.Y., Zhang, R. and Li, C. (2014) Studies on the Transducers of Clamp-On Transit-Time Ultrasonic Flow Meter. 2014 4th IEEE International Conference on Information Science and Technology, Shenzhen, 26-28 April 2014, 180-183. &lt;br&gt;https://doi.org/10.1109/ICIST.2014.6920360</mixed-citation></ref><ref id="hanspub.32365-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Szebeszczyk, J.M. (1994) Application of Clamp-on Ultrasonic Flowmeter for Industrial Flow Measurements. Flow Measurement and In-strumentation, 5, 127-131. &lt;br&gt;https://doi.org/10.1016/0955-5986(94)90047-7</mixed-citation></ref><ref id="hanspub.32365-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Mahadeva, D.V. (2010) Studies of the Accuracy of Clamp-on Ultrasonic Flowmeters.</mixed-citation></ref><ref id="hanspub.32365-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">王池, 王自如, 张宝珠, 等. 流量测量技术全书[M]. 北京: 化学工业出版社, 2012.</mixed-citation></ref><ref id="hanspub.32365-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">周人, 何衍庆, 等. 流量测量和控制使用手册[M]. 北京: 化学工业出版社, 2013.</mixed-citation></ref><ref id="hanspub.32365-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Lau, C. (1992) Neural Networks: Theoretical Foundations and Analysis. IEEE Press, Piscataway, NJ.</mixed-citation></ref><ref id="hanspub.32365-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">柳松青. MATLAB神经网络BP网络研究与应用[J]. 计算机工程与设计, 2003, 24(11): 81-83.</mixed-citation></ref><ref id="hanspub.32365-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Zhao, Z., Xin, H., Ren, Y., et al. (2010) Application and Comparison of BP Neural Network Algorithm in MATLAB. 2010 Interna-tional Conference on Measuring Technology and Mechatronics Automation, Changsha City, 13-14 March 2010, 590-593. &lt;br&gt;https://doi.org/10.1109/ICMTMA.2010.492</mixed-citation></ref><ref id="hanspub.32365-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Xie, R., Wang, X., Li, Y. and Zhao, K. (2010) Re-search and Application on Improved BP Neural Network Algorithm. 2010 5th IEEE Conference on Industrial Electron-ics and Applications, Taichung, Taiwan, 15-17 June 2010, 1462-1466.</mixed-citation></ref><ref id="hanspub.32365-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Jin, W., Li, Z.J., Wei, L.S. and Zhen, H. (2000) The Improvements of BP Neural Network Learning Algorithm. 2000 5th International Conference on Signal Processing Proceedings, Beijing, 21-25 August 2000, 1647-1649.</mixed-citation></ref></ref-list></back></article>