<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2015.43028</article-id><article-id pub-id-type="publisher-id">AAM-15797</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20150300000_27841705.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  小波阈值去噪算法在XRD图谱去噪中的应用
  An Improved Wavelet Threshold Denoising Algorithm for Analysing Signals in the XRD Spectrum
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>牟</surname><given-names>丽</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>海辉</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>育浩</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>北京航空航天大学数学与系统科学学院，北京</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>muli90@buaa.edu.cn(牟丽)</email>;<email>whhmath@buaa.edu.cn(王海)</email>;<email>zhangyuhao@buaa.edu.cn(张育)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>03</day><month>08</month><year>2015</year></pub-date><volume>04</volume><issue>03</issue><fpage>224</fpage><lpage>229</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  在已有的几种阈值函数的基础上，本文提出了一种新的阈值函数，新的阈值函数继承了已有的阈值函数的优点，不仅具有连续性，而且可以减少去噪误差。实验表明，该算法更能有效去除光谱中的噪声，利于光谱的定性和定量分析。
   In this paper, a new threshold function is put forward, which is based on the introduced wavelet threshold function. The new threshold function not only has the advantage of traditional ones but also is continuous. Experiments show that the denoising algorithm based on the new wavelet threshold function can remove the noise in the XRD spectrum more effectively and is more benefi-cial for qualitative and quantitative analysis.
 
</p></abstract><kwd-group><kwd>阈值函数，去噪，XRD图谱, Threshold Function</kwd><kwd> Denoising</kwd><kwd> XRD Spectrum</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>小波阈值去噪算法在XRD图谱去噪中的应用<sup> </sup></title><p>牟丽，王海辉，张育浩</p><p>北京航空航天大学数学与系统科学学院，北京</p><p>Email: muli90@buaa.edu.cn, whhmath@buaa.edu.cn, zhangyuhao@buaa.edu.cn</p><p>收稿日期：2015年7月9日；录用日期：2015年7月27日；发布日期：2015年8月3日</p><disp-formula id="hanspub.15797-formula419"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>在已有的几种阈值函数的基础上，本文提出了一种新的阈值函数，新的阈值函数继承了已有的阈值函数的优点，不仅具有连续性，而且可以减少去噪误差。实验表明，该算法更能有效去除光谱中的噪声，利于光谱的定性和定量分析。</p><p>关键词 :阈值函数，去噪，XRD图谱</p><disp-formula id="hanspub.15797-formula420"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>X射线衍射在研究金属和合金的晶体结构等方面具有广泛的应用，通过分析XRD图谱获得材料的成分，以及材料的内部原子或分子的结构等信息。但在XRD分析的信号脉冲和数据采集实验中，实验源干扰众多，存在噪声，在寻峰过程中出现假峰和丢失弱峰[<xref ref-type="bibr" rid="hanspub.15797-ref1">1</xref>] ，对定性定量分析产生不利，因此需要对实验数据降噪处理。</p><p>小波阈值去噪算法已在诸多实践应用中得到良好的去噪效果，现在已成为主流的去噪方法之一[<xref ref-type="bibr" rid="hanspub.15797-ref2">2</xref>] 。1995年，D.L. Donoho和Johnstone在小波变换的基础上提出了小波阈值去噪的概念[<xref ref-type="bibr" rid="hanspub.15797-ref3">3</xref>] ，即软阈值和硬阈值去噪，此后，Gao和Bruce提出半软阈值函数去噪算法[<xref ref-type="bibr" rid="hanspub.15797-ref4">4</xref>] 。但是硬阈值函数不连续，采用软阈值算法去噪后的信号方差较大。为了克服这些缺点，本文在文献[<xref ref-type="bibr" rid="hanspub.15797-ref5">5</xref>] 和[<xref ref-type="bibr" rid="hanspub.15797-ref6">6</xref>] 中阈值函数的基础上，提出了一种新的阈值函数。</p></sec><sec id="s4"><title>2. 小波阈值去噪</title><p>小波阈值去噪的主要理论依据是：小波变换特别是正交小波变换具有很强的去系数相关性，它能够使信号的能量集中在一些大的小波系数中，噪声的能量分布于整个小波域中，也就是信号的小波系数幅值要大于噪声的系数幅值。因此，可以选用一个适当的阈值，把信号系数保留，而使大部分噪声系数减少至零。小波阈值去噪的过程分为下面三个步骤：</p><p>(1) 信号小波分解：选择合适的小波基函数和分解层数，对含噪信号作小波分解，得到小波系数。</p><p>(2) 高频系数阈值化：选择合适的阈值，对高频系数进行阈值处理，得到新的小波系数。</p><p>(3) 重构信号：用低频系数和阈值化后的高频系数进行小波重构，得到估计信号，即去噪后的信号。</p><p>传统的阈值函数主要有硬阈值和软阈值，如下：</p><p>(1) 硬阈值函数</p><disp-formula id="hanspub.15797-formula421"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>(2) 软阈值函数</p><disp-formula id="hanspub.15797-formula422"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x8_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，阈值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x9_hanspub.png" xlink:type="simple"/></inline-formula>的常用确定方法有：全局统一阈值，启发式阈值和stein无偏似然估计阈值等。虽然硬阈值和软阈值去噪算法在实际中有着广泛的应用，但它们本身存在着一些缺陷。硬阈值函数在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x10_hanspub.png" xlink:type="simple"/></inline-formula>处不连续，所得到的估计信号会产生附加振荡，不具有同原始信号一样的光滑性。软阈值函数虽然连续，但当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x11_hanspub.png" xlink:type="simple"/></inline-formula>时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x12_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x13_hanspub.png" xlink:type="simple"/></inline-formula>总存在恒定偏差，直接影响着信号的真实程度[<xref ref-type="bibr" rid="hanspub.15797-ref7">7</xref>] 。</p></sec><sec id="s5"><title>3. 新阈值函数的构建</title><p>为了克服硬阈值和软阈值函数的缺点，文献[<xref ref-type="bibr" rid="hanspub.15797-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.15797-ref6">6</xref>] 提出了两种改进的阈值函数，如下所示：</p><p>(1) 函数1</p><disp-formula id="hanspub.15797-formula423"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x14_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中</p><disp-formula id="hanspub.15797-formula424"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x15_hanspub.png"  xlink:type="simple"/></disp-formula><p>(2) 函数2</p><disp-formula id="hanspub.15797-formula425"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x16_hanspub.png"  xlink:type="simple"/></disp-formula><p>函数1和函数2中的阈值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x17_hanspub.png" xlink:type="simple"/></inline-formula>为全局阈值，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x18_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>本文在阈值函数1和阈值函数2的基础上提出了一种新的阈值函数:</p><disp-formula id="hanspub.15797-formula426"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x19_hanspub.png"  xlink:type="simple"/></disp-formula><p>当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x20_hanspub.png" xlink:type="simple"/></inline-formula>时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x21_hanspub.png" xlink:type="simple"/></inline-formula>，得到<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x22_hanspub.png" xlink:type="simple"/></inline-formula>，即此时<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x23_hanspub.png" xlink:type="simple"/></inline-formula>的值等于软阈值的估计值。</p><p>当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x24_hanspub.png" xlink:type="simple"/></inline-formula>时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x25_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x26_hanspub.png" xlink:type="simple"/></inline-formula>，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x27_hanspub.png" xlink:type="simple"/></inline-formula>在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x28_hanspub.png" xlink:type="simple"/></inline-formula>处是连续的。</p><p>当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x29_hanspub.png" xlink:type="simple"/></inline-formula>时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x30_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x31_hanspub.png" xlink:type="simple"/></inline-formula>，克服了软阈值函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x32_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2620183x33_hanspub.png" xlink:type="simple"/></inline-formula>总是存在恒定偏差的缺点。</p><p>同时为了克服全局阈值没有随着分解尺度变化而变化的缺点，新的阈值函数中采用自适应的阈值：</p><disp-formula id="hanspub.15797-formula427"><graphic xlink:href="http://html.hanspub.org/file/2-2620183x34_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s6"><title>4. 仿真实验</title><p>为了验证新阈值函数的去噪效果，针对含噪的Droppler信号，用软阈值、硬阈值和新阈值函数进行MATLAB仿真实验。在去噪时，选取小波基为db4，分解层数为4，软、硬阈值函数选取全局阈值，新阈值函数选取上述自适应阈值。Droppler信号的去噪效果如图1所示。</p><p>信号去噪效果可以用信噪比(SNR)和均方误差(MSE)来描述，表1是各阈值函数去噪算法的信噪比和均方差。</p><p>为了进一步验证新阈值函数的去噪效果，选取分解层数2~8，比较三种去噪算法的信噪比和均方差，得到图2。</p><p>通过对Droppler信号的仿真实验表明，新阈值函数在信噪比和均方差方面都有提高。由图2看出，新阈值去噪算法在分解层数为6时达到最优效果，具有更高的应用价值，各阈值去噪算法的信噪比和均方差如表2所示。</p><p>将新的阈值函数用到FeN元素图谱去噪中，选用小波基为db4，分解层数为3，得到如图3结果。</p><p>图1. 各阈值函数对Droppler信号去噪效果图</p><p>图2. 信噪比和均方差比较图</p><p>图3. 各阈值函数对FeN元素图谱去噪结果</p><p>为了表明新阈值函数在FeN含噪图谱去噪中的优越性，我们做出含噪信号与去噪后信号的差值图，即在去噪过程中被当做噪声滤去的信号，如图4。</p><p>用新阈值去噪算法对图4中的信号进行去噪，判断三种去噪算法丢失的细节信息，得到图5。</p><p>从图3中可以看出，硬阈值函数去噪后的光谱图含有较多噪声，软阈值去噪后的光谱图中峰值减小。从图5中可以看出，软阈值和硬阈值算法在消噪中都丢失了一些细节信息，而采用新阈值函数去噪既消除了部分噪声，又保留了信号的原始峰形特征，并且没有丢掉细节信息，有利于光谱的定性和定量分析。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Comparison of SNR and MS</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >阈值函数</th><th align="center" valign="middle" >SNR/dB</th><th align="center" valign="middle" >MSE</th></tr></thead><tr><td align="center" valign="middle" >软阈值函数</td><td align="center" valign="middle" >12.2140</td><td align="center" valign="middle" >0.1586</td></tr><tr><td align="center" valign="middle" >硬阈值函数</td><td align="center" valign="middle" >12.9523</td><td align="center" valign="middle" >0.1129</td></tr><tr><td align="center" valign="middle" >新阈值函数</td><td align="center" valign="middle" >13.2376</td><td align="center" valign="middle" >0.0990</td></tr></tbody></table></table-wrap><p>表1. 信噪比和均方差比较</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Comparison of SNR and MS</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >阈值函数</th><th align="center" valign="middle" >SNR/dB</th><th align="center" valign="middle" >MSE</th></tr></thead><tr><td align="center" valign="middle" >软阈值函数</td><td align="center" valign="middle" >11.1555</td><td align="center" valign="middle" >0.2582</td></tr><tr><td align="center" valign="middle" >硬阈值函数</td><td align="center" valign="middle" >13.1885</td><td align="center" valign="middle" >0.1012</td></tr><tr><td align="center" valign="middle" >新阈值函数</td><td align="center" valign="middle" >14.0199</td><td align="center" valign="middle" >0.0690</td></tr></tbody></table></table-wrap><p>表2. 三种去噪算法的信噪比和均方差比较</p><p>图4. 去噪中消去的信号部分</p><p>图5. 三种去噪算法丢失的细节信息</p></sec><sec id="s7"><title>5. 结论</title><p>本文提出的阈值函数既具有和软阈值函数一样的连续性，又能减少去噪误差，MATLAB的仿真实验表明了，新的阈值函数在SNR和MSE上都有改进。在XRD图谱的去噪中，有效消除了噪声，同时有用特征信息被很好的保留，为后面光谱的分析提供了有利条件。</p></sec><sec id="s8"><title>文章引用</title><p>牟丽,王海辉,张育浩. 小波阈值去噪算法在XRD图谱去噪中的应用An Improved Wavelet Threshold Denoising Algorithm for Analysing Signals in the XRD Spectrum[J]. 应用数学进展, 2015, 04(03): 224-229. http://dx.doi.org/10.12677/AAM.2015.43028</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.15797-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">葛良全, 周四春, 赖万昌 (1997) 原位X辐射取样技术. 四川科学技术出版社, 成都, 68-149.</mixed-citation></ref><ref id="hanspub.15797-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">葛哲学 (2007) 小波分析理论与MATLABR2007实现. 电子工业出版社, 北京, 67-69.</mixed-citation></ref><ref id="hanspub.15797-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Donoho, D.L. and Johnstone, J.M. (1994) Ideal spatial via wavelet shrinkage. Biometrika, 81, 425-455.  
&lt;br&gt;http://dx.doi.org/10.1093/biomet/81.3.425</mixed-citation></ref><ref id="hanspub.15797-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Gao, H. and Bruce, A. (1997) Wave shrink with firm shrinkage. Statistica, 7, 855-874.</mixed-citation></ref><ref id="hanspub.15797-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">张莲, 秦华锋, 余成波 (2008) 基于小波阈值算法的研究. 计算机工程与应用, 9, 172-173.</mixed-citation></ref><ref id="hanspub.15797-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">赵瑞珍, 宋国乡 (2000) 一种基于小波变换的白噪声消噪方法的改进. 西安电子科技大学学报, 5, 619-622.</mixed-citation></ref><ref id="hanspub.15797-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">孙延奎 (2005) 小波分析及其应用. 机械工业出版社, 北京, 233-235.</mixed-citation></ref></ref-list></back></article>