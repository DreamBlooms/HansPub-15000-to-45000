<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2021.104098</article-id><article-id pub-id-type="publisher-id">AAM-41611</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20210400000_84812360.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  一类随机抛物最优控制问题的集成蒙特卡洛隐式Euler法
  An Ensemble Monte Carlo Implicit Euler Method for a Class of Stochastic Parabolic Optimal Control Problems
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>雪芳</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>罗</surname><given-names>贤兵</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>贵州大学数学与统计学院，贵州 贵阳</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>08</day><month>04</month><year>2021</year></pub-date><volume>10</volume><issue>04</issue><fpage>899</fpage><lpage>908</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    针对扩散项带随机系数的演化方程随机最优控制问题，蒙特卡洛方法是一种非常重要的方法，针对随机量，每次抽样以后，按照以前确定问题的数值方法便可以求解，但是蒙特卡洛方法收敛速度慢，近似解误差要达到理想精度，需要大量的抽样，每次抽样需要计算一次逆矩阵，这样完成一个问题的求解，就需要计算大量的逆矩阵。我们针对一类随机抛物最优控制问题，提出一种数值求解集成蒙特卡洛隐式Euler法，即时间方向采用隐式Euler法，空间上采用线性有限元方法，随机量采用集成蒙特卡洛方法，控制量采用变分离散技巧，该方法针对所有抽样，只需要求一次逆矩阵，大大减少了计算量，通过误差分析和数值计算，该方法不影响时间方向和空间方向误差的收敛速度。
    Monte Carlo method is an important method for the stochastic optimal control problem of evolution equation with random coefficient in diffusion term. For random quantity, after each sampling, the problem can be solved using the numerical method for the corresponding deterministic problem. However, Monte Carlo method converges slowly, and the approximate solution error needs a large number of samples to achieve the desired accuracy. Each sample needs to calculate the inverse matrix. So a large number of inverse matrices need to be calculated to solve a problem. For a class of stochastic parabolic optimal control problems, we propose an ensemble Monte Carlo implicit Euler method. That is, the implicit Euler method is used for the time space, the linear finite element method is used for the space, an ensemble Monte Carlo method is used for the random coefficient, and the variational discretization technique is used for the control. This method only needs to calculate an inverse matrix once for all samples, which greatly reduces the cost. Through error analysis and numerical experiments, this method does not affect the convergence rate for time and physical space. 
  
 
</p></abstract><kwd-group><kwd>集成Monte Carlo方法，隐式Euler法，随机抛物PDEs，最优控制问题, Ensemble Monte Carlo Method</kwd><kwd> Implicit Euler Method</kwd><kwd> Random Parabolic PDEs</kwd><kwd> Optimal Control Problem</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>针对扩散项带随机系数的演化方程随机最优控制问题，蒙特卡洛方法是一种非常重要的方法，针对随机量，每次抽样以后，按照以前确定问题的数值方法便可以求解，但是蒙特卡洛方法收敛速度慢，近似解误差要达到理想精度，需要大量的抽样，每次抽样需要计算一次逆矩阵，这样完成一个问题的求解，就需要计算大量的逆矩阵。我们针对一类随机抛物最优控制问题，提出一种数值求解集成蒙特卡洛隐式Euler法，即时间方向采用隐式Euler法，空间上采用线性有限元方法，随机量采用集成蒙特卡洛方法，控制量采用变分离散技巧，该方法针对所有抽样，只需要求一次逆矩阵，大大减少了计算量，通过误差分析和数值计算，该方法不影响时间方向和空间方向误差的收敛速度。</p></sec><sec id="s2"><title>关键词</title><p>集成Monte Carlo方法，隐式Euler法，随机抛物PDEs，最优控制问题</p></sec><sec id="s3"><title>An Ensemble Monte Carlo Implicit Euler Method for a Class of Stochastic Parabolic Optimal Control Problems</title><p>Xuefang Wu, Xianbing Luo</p><p>School of Mathematics and Statistics, Guizhou University, Guiyang Guizhou</p><p><img src="//html.hanspub.org/file/10-2621547x4_hanspub.png" /></p><p>Received: Mar. 14<sup>th</sup>, 2021; accepted: Apr. 3<sup>rd</sup>, 2021; published: Apr. 16<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/10-2621547x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>Monte Carlo method is an important method for the stochastic optimal control problem of evolution equation with random coefficient in diffusion term. For random quantity, after each sampling, the problem can be solved using the numerical method for the corresponding deterministic problem. However, Monte Carlo method converges slowly, and the approximate solution error needs a large number of samples to achieve the desired accuracy. Each sample needs to calculate the inverse matrix. So a large number of inverse matrices need to be calculated to solve a problem. For a class of stochastic parabolic optimal control problems, we propose an ensemble Monte Carlo implicit Euler method. That is, the implicit Euler method is used for the time space, the linear finite element method is used for the space, an ensemble Monte Carlo method is used for the random coefficient, and the variational discretization technique is used for the control. This method only needs to calculate an inverse matrix once for all samples, which greatly reduces the cost. Through error analysis and numerical experiments, this method does not affect the convergence rate for time and physical space.</p><p>Keywords:Ensemble Monte Carlo Method, Implicit Euler Method, Random Parabolic PDEs, Optimal Control Problem</p><disp-formula id="hanspub.41611-formula3"><graphic xlink:href="//html.hanspub.org/file/10-2621547x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/10-2621547x7_hanspub.png" /> <img src="//html.hanspub.org/file/10-2621547x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>自然生活中，许多现象和工程应用都可以用微分方程来建模，自上世纪七十年代Lions的奠基性工作以来，偏微分方程及最优控制理论已经得到了广泛的研究和分析 [<xref ref-type="bibr" rid="hanspub.41611-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.41611-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.41611-ref3">3</xref>]。实际上，在自然界中存在着大量的不确定性，比如结构力学、地震学、金融数学等领域，都存在随机的因素，因此需要用随机模型来描述这些问题。如同确定型微分方程一样，这些随机问题的准确解很难求解，用数值方法来逼近这些问题的准确解是一种必然的选择。因此，随机问题的理论分析以及数值近似成为了当前研究的热点问题。</p><p>随机最优控制问题无论在数学、金融、物理还是工程上都有广泛的应用。目前，求解随机偏微分方程最优控制问题的常用方法有蒙特卡洛(MC)方法、随机有限元方法、随机配置法等。MC方法是进行数值仿真中处理随机数据时的首选方法，此方法在求解随机偏微分方程数值解时是最简单易行的方法，它在执行过程中只需不断重复求解给定样本下的一个确定的偏微分方程。众所周知，MC方法其收敛速度为 O ( N − 1 / 2 ) (N是样本点数)，为了达到某个误差精度，该方法在求解时需要大量的抽样。尽管如此，但由于方法简单，因此该方法及其改进受到了很多学者的青睐。确定型最优控制问题的数值解，需要通过多次迭代来求解状态方程和对偶状态方程。而对于随机偏微分方程最优控制问题的数值求解，MC方法对模型中的随机量进行抽样离散时，求解每个抽样点对应的确定性偏微分方程花费的计算量比直接求解确定型最优控制问题的计算量多得多。因此，随机最优控制问题的数值求解计算量是相当惊人的。</p><p>对于椭圆随机最优控制问题已有一些研究成果 [<xref ref-type="bibr" rid="hanspub.41611-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.41611-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.41611-ref6">6</xref>]。对于抛物随机最优控制问题，巩本学等人 [<xref ref-type="bibr" rid="hanspub.41611-ref7">7</xref>] 采用随机Galerkin方法对控制受限的随机抛物方程最优控制问题进行了研究，得到了控制、状态、伴随变量的先验误差估计，其中随机系数的处理是通过K-L展开，该方法是将随机量展开成一个有限维数的空间，维数越高，误差越小，但是计算量随着维数的增加而呈指数增加，“维数烦恼”在此得到体现。蒙特卡洛方法是一种简单的方法，每次抽样后，只需要按照原来确定问题的方法来求解即可，只是需要求解这样的问题很多(大量)次，计算量非常大。骆艳等人在求解随机抛物偏微分方程初边值问题时采用了一种基于时间的集成算法 [<xref ref-type="bibr" rid="hanspub.41611-ref8">8</xref>]，每个时间步迭代的矩阵是相同的，大大地提高了这种具有时间迭代的计算效率。</p><p>本文针对一类抛物随机最优控制问题，在文献 [<xref ref-type="bibr" rid="hanspub.41611-ref8">8</xref>] 的基础上利用集成MC隐式Euler法来研究其数值近似，随机系数的处理通过定义集成平均的方式使得计算量大大减少。</p></sec><sec id="s6"><title>2. 模型描述</title><p>设 ( Ω , ℜ , P ) 是完备的概率空间， Ω 是所有可能结果的集合， ℜ 是事件的 σ -代数， P : ℜ → [ 0 , 1 ] 是一个概率测度。记 L 2 ( D ) 空间上的内积和范数分别为 ( ⋅ , ⋅ ) , ‖   ⋅   ‖ 。记 W s , q ( D ) 为 L q ( D ) 空间上具有s阶导数的Sobolev空间，其中s是一个非负整数， 1 ≤ q ≤ + ∞ 。当 q = 2 时，常用 H s ( D ) 来代替 W s , 2 ( D ) ，特别地， H 0 1 ( D ) 是 H 1 ( D ) 的子空间。 H − 1 ( D ) 是 H 0 1 ( D ) 的对偶空间，其上的范数定义为 ‖ f ‖ − 1 = sup 0 ≠ v ∈ H 0 1 ( D ) ( f , v ) / ‖ ∇ v ‖ 。对于 1 ≤ p , r &lt; ∞ ，空间 L p ( Ω , W s , q ( D ) ) 包含了所有随机函数 v : Ω &#215; D → R ，它们相对于 ℜ ⊗ B ( D ) σ -代数是可测的，其中 B ( D ) 是D的 σ -代数， L p ( Ω , W s , q ( D ) ) 空间上的范数定义为</p><p>‖ v ‖ L p ( Ω , W s , q ( D ) ) = ( E [ ‖ v ‖ W s , q ( D ) p ] ) 1 / p = ( E ( ∑ | α | ≤ s ∫ D | ∂ α v | q d x ) p / q ) 1 / p</p><p>和</p><p>‖ v ‖ L ∞ ( Ω , W s , q ( D ) ) = ess   sup Ω ‖ v ‖ W s , q ( D ) .</p><p>空间 L r ( L p ( Ω , W s , q ( D ) ) , ( 0 , T ] ) 包含了所有随机函数 v : Ω &#215; D &#215; [ 0 , T ] → R ，该空间上的范数同上面定义方式一致 [<xref ref-type="bibr" rid="hanspub.41611-ref7">7</xref>]。</p><p>考虑如下一维随机抛物方程最优控制问题：</p><p>min u ∈ F J ( y , u ) = 1 2 E ( ∫ 0 T ‖ y − y d ‖ L 2 ( D ) 2 d t ) + α 2 E ( ∫ 0 T ‖ u ‖ L 2 ( D ) 2 d t ) , (1)</p><p>其中 y , u 满足如下的抛物方程初边值条件：</p><p>{ ∂ t y − ∂ x ( a ( ω , x , t ) ∂ x y ( ω , x , t ) ) = u ( ω , x , t ) ,                           ( ω , x , t ) ∈ Ω &#215; D &#215; [ 0 , T ] , y ( ω , a , t ) = y ( ω , b , t ) = 0 ,                                                                                                                                                                             ( ω , t ) ∈ Ω &#215; [ 0 , T ] , y ( ω , x , 0 ) = g 0 ( x ) ,                                                                                                                                                                                                                               ( ω , x ) ∈ Ω &#215; D . (2)</p><p>其中 D = [ a , b ] 表示空间区域， ω ∈ Ω 为随机变量，E表示对随机变量取期望， ∂ t 和 ∂ x 分别表示关于时间和空间的偏导数， y d : D &#215; [ 0 , T ] → R 给定， α &gt; 0 和 T &gt; 0 分别是一个给定的常数， F ⊂ L 2 ( L 2 ( D ) , ( 0 , T ] ) 为凸集。</p><p>对任意 t ∈ [ 0 , T ] ，为了保证问题(1)~(2)解的存在唯一性，假设系数 a ( ω , x , t ) 是有界且一致强制的，即存在 a min , a max ∈ R 使得在 Ω &#215; D &#215; [ 0 , T ] 上几乎处处成立 a min ≤ a ( ω , x , t ) ≤ a max 。</p><p>引入下列记号：</p><p>( ∂ t y , v ) = ∫ D ∂ t y v d x , b ( y , v ) = ∫ D a ∂ x y ∂ x v d x , ( u , v ) = ∫ D u v d x .</p><p>其中双线性形式 b : H 0 1 ( D ) &#215; H 0 1 ( D ) → R ，则状态方程(2)的弱形式可以表述为：对于给定的 t &gt; 0 , ω ∈ Ω ，求 y ( ω , ⋅ , t ) ∈ H 0 1 ( D ) ，使得</p><p>( ∂ t y , v ) + b ( y , v ) = ( u , v ) , ∀ v ∈ H 0 1 ( D ) .</p><p>利用Lagrange乘数法可得求解原问题(1)~(2)等价于求 y ( ω , ⋅ , t ) ∈ H 0 1 ( D ) , u ( ω , ⋅ , t ) ∈ F , p ( ω , ⋅ , t ) ∈ H 0 1 ( D ) 满足如下最优性系统：</p><p>{ ( ∂ t y , v ) + b ( y , v ) = ( u , v ) ,                                                                                       ∀ v ∈ H 0 1 , t ∈ ( 0 , T ] , y ( ω , a , t ) = y ( ω , b , t ) = 0 ,                                                                                         ( ω , t ) ∈ Ω &#215; [ 0 , T ] , y ( ω , x , 0 ) = g 0 ( x ) ,                                                                                                                         ( ω , t ) ∈ Ω &#215; D , − ( ∂ t p , q ) + b ( q , p ) = ( y − y d , q ) ,                             ∀ q ∈ H 0 1 ( D ) , t ∈ [ 0 , T ] , p ( ω , a , t ) = p ( ω , b , t ) = 0 ,                                                                                         ( ω , t ) ∈ Ω &#215; [ 0 , T ] , p ( ω , x , T ) = 0 ,                                                                                                                                                                                 ( ω , x , t ) ∈ Ω &#215; D &#215; [ 0 , T ] , ∫ 0 T ( p + α u , w − u ) d t ≥ 0 ,                                                                                                         ∀   w ∈ F .   (3)</p><p>由于F为凸集，因此数值求解具有随机系数的抛物型最优控制问题(1)~(2)，就等价于求解最优性系统(3)。问题(3)的求解需要涉及到随机抛物方程的数值模拟，以下首先介绍数值模拟抛物方程定解问题的方法，然后再介绍(3)的计算方法。</p></sec><sec id="s7"><title>3. 集成MC隐式Euler法</title><sec id="s7_1"><title>3.1. 随机抛物方程初边值问题的集成MC隐式Euler法</title><p>此处仅考虑随机抛物方程初边值问题的数值方法，因此此处将式(2)中的 u ( ω , x , t ) 替换成 f ( ω , x , t ) 并假设已知。在抛物方程初边值问题(2)的数值求解方法中，MC方法是一种非常重要的方法，在给定每个抽样(给定 ω )后，利用原来确定问题的数值方法及程序便可求解。这样为了得到式(2)的统计解，就需要将其数值求解K次，然后平均，其中第k次就相当于求解下述问题</p><p>{ ∂ t y k − ∂ x ( a ( ω k , x , t ) ∂ x y k ( ω k , x , t ) ) = f ( ω k , x , t ) ,                           ( ω k , x , t ) ∈ Ω &#215; D &#215; [ 0 , T ] , y k ( ω k , a , t ) = y k ( ω k , b , t ) = 0 ,                                                                                                                                                                                           ( ω k , t ) ∈ Ω &#215; [ 0 , T ] , y k ( ω k , x , 0 ) = g 0 ( x ) ,                                                                                                                                                                                                                                                           ( ω k , x ) ∈ Ω &#215; D . (4)</p><p>在对问题(4)进行离散时，考虑到离散格式的稳定性，常用隐式Euler法。因此对不同的k，对应不同的系数矩阵，就要算一次矩阵的逆。集成方法得到的离散格式对所有抽样只需要算一次逆矩阵，这就大大减少了计算量。下面介绍处理问题(4)的集成MC隐式Euler法。</p><p>选取一组独立同分布的随机样本 { ω k } ，对应于不同的k，有不同的 解 y k = y ( ω k , ⋅ , ⋅ ) ，其中 k = 1 , 2 , ⋯ , K 。对时间区域 [ 0 , T ] 进行均匀划分， 0 = t 0 &lt; t 1 &lt; ⋯ &lt; t N − 1 &lt; t N = T ，时间节点 t i = i τ , i = 0 , 1 , ⋯ , N ，其中步长为 τ = T / N 。定义随机系数的集成均值如下：</p><p>a &#175; i ( x ) : = a &#175; ( x , t i ) = 1 K ∑ k = 1 K a k ( ω , x , t i ) = 1 K ∑ k = 1 K a ( ω k , x , t i ) . (5)</p><p>则基于时间的状态方程可用如下的离散格式来近似，即</p><p>y k i + 1 − y k i τ − ∂ x ( a &#175; i + 1 ∂ x y k i + 1 ) − ∂ x ( ( a k i + 1 − a &#175; i + 1 ) ∂ x y k i ) = f k i + 1 , (6)</p><p>其中 a k i + 1 = a ( ω k , x , t i + 1 ) , y k i = y ( ω k , x , t i ) , f k i + 1 = f ( ω k , x , t i + 1 ) 。将式(6)变形得</p><p>y k i + 1 τ − ∂ x ( a &#175; i + 1 ∂ x y k i + 1 ) = y k i τ + ∂ x ( ( a k i + 1 − a &#175; i + 1 ) ∂ x y k i ) + f k i + 1 .</p><p>对空间 [ a , b ] 采用等距剖分 T h ，设步长为 h = ( b − a ) / M ，节点坐标为 x j = a + j h , j = 0 , 1 , ⋯ , M 。取有限元空间 V h = { v h | v h ∈ P 1 ( x ) , K ∈ T h } ，此处的K表示剖分 T h 的某个区间 [ x j , x j + 1 ] ， P 1 ( x ) 表示一次多项式。用 y k , h i ∈ V h 表示 a k ( ω , x , t i ) = a ( ω k , x , t i ) 时式(6)的近似解在 t = t i 时刻的值，即 y k , h i = y h ( ω k , x , t i ) 。则式(6)的集成MC隐式Euler格式为：求 y k , h i ∈ V h , i = 1 , ⋯ , N − 1 ，使得对任意 v h ∈ V h 有</p><p>( y k , h i + 1 − y k , h i τ , v h ) + ( a &#175; i + 1 ∂ x y k , h i + 1 , ∂ x v h ) + ( ( a k i + 1 − a &#175; i + 1 ) ∂ x y k , h i , ∂ x v h ) = ( f k i + 1 , v h ) . (7)</p><p>其中，初始条件 y k , h 0 ( ω k , x , 0 ) = g k 0 ( x ) 。</p><p>接下来考虑其矩阵形式，在 V h 上，设 φ j ( x ) 为节点基函数，则 y k , h i ( ω k , x , t i ) 可表示为</p><p>∑ j = 1 M − 1 y k , h i ( ω k , t i ) φ j ( x ) ，在式(7)中取 v h = φ l ( x ) 便可得：</p><p>∫ D ∑ j = 1 M − 1 y k , h i + 1 φ j ( x ) φ l d x + τ ∫ D ∑ j = 1 M − 1 y k , h i + 1 a &#175; i + 1 φ ′ j ( x ) φ ′ l d x + τ ∫ D ∑ j = 1 M − 1 y k , h i ( a k i + 1 − a &#175; i + 1 ) φ ′ j ( x ) φ ′ l d x = ∫ D ∑ j = 1 M − 1 y k , h i φ j ( x ) φ l d x + τ ∫ D f k i + 1 φ l d x</p><p>即</p><p>∑ j = 1 M − 1 y k , h i + 1 ∫ D φ j ( x ) φ l d x + τ ∑ j = 1 M − 1 y k , h i + 1 ∫ D a &#175; i + 1 φ ′ j ( x ) φ ′ l d x = τ ∑ j = 1 M − 1 y k , h i ∫ D ( a &#175; i + 1 − a k i + 1 ) φ ′ j ( x ) φ ′ l d x + ∑ j = 1 M − 1 y k , h i ∫ D φ j ( x ) φ l d x + τ ∫ D f k i + 1 φ l d x</p><p>记</p><p>m j , l = ∫ D φ j ( x ) φ l d x , a &#175; l , j i + 1 = ∫ D a &#175; i + 1 φ ′ j ( x ) φ ′ l d x , a k , l , j i + 1 = ∫ D ( a &#175; i + 1 − a k i + 1 ) φ ′ j ( x ) φ ′ l d x , f k , l i + 1 = ∫ D f k i + 1 φ l d x .</p><p>则式(7)的矩阵格式为</p><p>( M + τ A &#175; i + 1 ) Y k i + 1 = ( M + τ A k i + 1 ) Y k i + τ F k i + 1 . (8)</p><p>为了便于比较和分析计算效果，我们同时给出一般的，没有采用集成方法MC隐式Euler格式：求 y k , h i ∈ V h , i = 0 , 1 , ⋯ , N − 1 ，使得对任意 v h ∈ V h 有</p><p>( y k , h i + 1 − y k , h i τ , v h ) + ( a k i + 1 ∂ x y k , h i + 1 , ∂ x v h ) = ( f k i + 1 , v h ) .</p><p>其中，初始条件 y k , h 0 ( ω k , x , 0 ) = g k 0 ( x ) 。类似的方法可得其矩阵形式为：</p><p>( M + τ A k i + 1 ) Y k i + 1 = M Y k i + τ F k i + 1 . (9)</p><p>将式(8)和式(9)相比较，为了得到 Y k i + 1 ，集成方法针对不同的抽样 ω k 只需要求一次矩阵的逆 ( M + τ A &#175; i + 1 ) − 1 ，而非集成方法，针对不同的抽样 ω k ，每迭代一次都要算一次矩阵的逆 ( M + τ A k i + 1 ) − 1 ，这样，抽样次数K越大，计算逆矩阵的次数就越多，造成计算量也越大。</p></sec><sec id="s7_2"><title>3.2. 随机抛物方程初边值问题的集成MC隐式Euler格式的稳定性及误差分析</title><p>接下来先讨论集成格式(7)的稳定性，假设下述两个条件是成立的：</p><p>i) 存在一个正常数 θ ，使得对于任意的 t ∈ [ 0 , T ] ，有</p><p>P { ω ∈ Ω ; min x ∈ D &#175; a ( ω , x , t ) &gt; θ } = 1 .</p><p>ii) 存在正常数 θ − 和 θ + ，使得对于任意的 t ∈ [ 0 , T ] ，有</p><p>P { ω k ∈ Ω ; θ − ≤ | a ( ω k , x , t ) − a &#175; ( x , t ) | ≤ θ + } = 1 .</p><p>其中，条件(i)保证了问题的一致强制性，条件(ii)表示系数 a ( ω k , x , t ) 到式(5)定义的集成均值 a &#175; ( x , t ) 的距离是一致有界的。</p><p>引理 [<xref ref-type="bibr" rid="hanspub.41611-ref8">8</xref>] 3.1. 设 f k = f ( ω k , ⋅ , ⋅ ) ∈ L 2 ( ( 0 , T ] , H − 1 ( D ) ) 并且成立假设条件(i) (ii)及 θ &gt; θ + ，则集成格式(7)是稳定的，并且式(7)的数值解满足</p><p>E [ ‖ y k , h N ‖ 2 ] + θ − τ E [ ‖ y k , h N ‖ 2 ] + ( θ − θ + ) ∑ i = 1 N E [ ‖ ∂ x y k , h i ‖ 2 ] ≤ C τ ∑ i = 1 N E [ ‖ f k i ‖ − 1 2 ] + C τ E [ ‖ ∂ x y k , h 0 ‖ 2 ] + E [ ‖ y k , h 0 ‖ 2 ]</p><p>其中，C是与 K , h , τ 无关的常数。</p><p>下面对式(4)进行误差估计，设 y k i 是在 ω = ω k 和 t = t i 时式(2)的解， y k , h i 是式(7)的解，记 y k , h i = y h ( ω k , x , t i ) ，定义全离散集成MC隐式Euler格式(7)的近似为：</p><p>Φ h i = 1 K ∑ k = 1 K y k , h i .</p><p>接下来，将对 E [ y k i ] − Φ h i 进行估计，考虑到数值求解时我们采用的是MC方法进行随机抽样，因此，该式误差来源由有限元离散误差和抽样误差两部分构成，即可以写成如下</p><p>E [ y k i ] − Φ h i = ( E [ y k i ] − E [ y k , h i ] ) + ( E [ y k , h i ] − Φ h i ) .</p><p>注意到，右边第一部分为有限元离散产生的误差，第二部分是MC抽样产生的误差。</p><p>引理 [<xref ref-type="bibr" rid="hanspub.41611-ref8">8</xref>] 3.2 对于给定的 f k ∈ L 2 ( ( 0 , T ] , H − 1 ( D ) ) 和 y k 0 ∈ L 2 ( H 0 1 ( D ) , H 2 ( D ) ) ，在假设(i) (ii)及 θ &gt; θ + 成立的条件下，有下面式子成立</p><p>E [ ‖ E [ y k N ] − Φ h N ‖ 2 ] + θ − τ E [ ‖ ∂ x ( E [ y N ] − Φ h N ) ‖ 2 ] + ( θ − θ + ) τ ∑ i = 1 N E [ ‖ ∂ x ( E [ y i ] − Φ h i ) ‖ 2 ] ≤ 1 K ( C τ ∑ i = 1 N E [ ‖ f k i ‖ − 1 2 ] + C τ E [ ‖ ∂ x y k , h 0 ‖ 2 ] + E [ ‖ y k , h 0 ‖ 2 ] ) + C ( τ 2 + h 2 )</p><p>其中，C是与 K , h , τ 无关的正常数。</p></sec></sec><sec id="s8"><title>4. 随机抛物最优控制问题的集成MC隐式Euler法</title><p>现在我们来考虑随机抛物最优控制问题，对问题(2)中随机系数 a ( ω , x , t ) 的随机量进行随机抽样 { ω k } ，便得 a k ( ω , x , t ) = a ( ω k , x , t ) ，如同前面取 a &#175; i ( x ) ，在随机抛物方程初边值问题集成MC隐式Euler法的基础上，根据最优性条件(3)，采用变分离散的技巧 [<xref ref-type="bibr" rid="hanspub.41611-ref9">9</xref>]，我们可以得到问题(2)的第k次集成MC隐式Euler格式为：求 ( y k , h i , p k , h i , u k , h i ) ∈ V h &#215; V h &#215; F ，使得对任意 ( v h , q h ) ∈ V h &#215; V h 有下式成立：</p><p>( y k , h i + 1 − y k , h i τ , v h ) + ( a &#175; i + 1 ∂ x y k , h i + 1 , ∂ x v h ) + ( ( a k i + 1 − a &#175; i + 1 ) ∂ x y k , h i , ∂ x v h ) = ( f k i + 1 , v h ) , y k , h 0 ( ω k , x , 0 ) = g k 0 ( x ) , i = 0 , 1 , ⋯ , N − 1 (10)</p><p>− ( p k , h i + 1 − p k , h i τ , q h ) + ( a &#175; i ∂ x p k , h i , ∂ x q h ) + ( ( a k i − a &#175; i ) ∂ x p k , h i , ∂ x q h ) = ( y k , h i − y d i , q h ) , p k , h N = 0 , i = N − 1 , ⋯ , 1 , 0 (11)</p><p>( p k , h i + α u k , h i , w − u k , h i ) ≥ 0 ,                 ∀ w ∈ F ,                 i = 0 , 1 , ⋯ , N − 1 , N (12)</p><p>若 F = L 2 ( L 2 ( D ) , ( 0 , T ] ) ，则式(12)等价于</p><p>u k , h i = − p k , h i α , i = 0 , 1 , ⋯ , N − 1 , N .</p><p>若 F = U a d = { u | u a ≤ u ( ω , x , t ) ≤ u b , a . e .         in       Ω &#215; D &#215; [ 0 , T ] , u a &lt; u b } ，则式(12)等价于</p><p>u k , h i = P a d ( − p k , h i α ) ,         i = 0 , 1 , ⋯ , N − 1 , N .</p><p>其中 P a d ( v ) = max { u a , min { v , u b } } 。</p><p>以下考虑(10)~(12)的迭代算法，为此对任意 v ∈ L 2 ( L 2 ( D ) , ( 0 , T ] ) ，定义</p><p>| | | v | | |   = ∑ i = 1 N τ ∑ j = 1 M h ( v ( x j , t i ) ) 2 .</p><p>根据求解最优控制问题的思路，给出如下迭代算法</p><p>算法I (Algorithm I)</p><p>为了计算出目标函数的近似值，将式(1)进行离散得到：</p><p>J ( y , u ) ≈ 1 K ∑ k = 1 K J k ( y k , h , u k , h ) ,</p><p>其中 J k ( y k , h , u k , h ) 的表达式为：</p><p>J k ( y k , h , u k , h ) = 1 2 ∑ i = 1 N τ ∑ j = 1 M h ( y k , h i ( x j ) − y d ( ω k , x j , t i ) ) 2 + α 2 ∑ i = 1 N τ ∑ j = 1 M h ( u k , h i ( x j ) ) 2 .</p><p>这里我们采用的是复化右矩形公式离散第k次抽样计算得到的目标函数值的近似。</p></sec><sec id="s9"><title>5. 误差估计</title><p>考虑到数值求解(10)-(12)时我们采用的是MC方法进行随机抽样，因此，误差来源由离散误差和抽样误差两部分构成。</p><p>( u , y , p ) 和 ( u k , h i , y k , h i , p k , h i ) 分别是问题(3)和(10)-(12)的解， y ∈ L 2 ( L 2 ( Ω , H 0 1 ( D ) ) , ( 0 , T ] ) ，用样本均值 E K [ y ] 来近似 E [ y ] ，在 ω = ω k , t = t i 时， E K [ y ] 定义为</p><p>E K [ y ] = 1 K ∑ k = 1 K y ( ω k , ⋅ , t i ) ,</p><p>我们使用符号 ‖   ⋅   ‖ V : = ‖   ⋅   ‖ L 2 ( L 2 ( Ω , H 0 1 ( D ) ) , ( 0 , T ] ) ，则有如下误差</p><p>E [ ‖ E [ y ] − E K [ y ] ‖ V 2 ] = E [ ‖ E [ y ] − 1 K ∑ k = 1 K y ( ω k , ⋅ , t i ) ‖ V 2 ] = 1 K 2 E [ ‖ ∑ k = 1 K ( E [ y ] − y ( ω k , ⋅ , t i ) ) ‖ V 2 ] = 1 K 2 ∑ k = 1 K E [ ‖ ( E [ y ] − y ( ω k , ⋅ , t i ) ) ‖ V 2 ] = 1 K 2 ( E [ ‖ y ‖ V 2 ] − ‖ E [ y ] ‖ V 2 ) ≤ 1 K [ [ ‖ y ‖ V 2 ]</p><p>对上述式子两边开平方根，即</p><p>‖ E [ y ] − E K [ y ] ‖ V ≤ K − 1 / 2 ‖ y ‖ V .</p><p>接下来考虑 E [ y ] 的有限元近似 E K [ y h ] ，用同样方式有如下定义</p><p>E K [ y h ] = 1 K ∑ k = 1 K y k , h i ( ω k , ⋅ , t i ) .</p><p>对于任意的 y , y h ∈ L 2 ( L 2 ( Ω , H 0 1 ( D ) ) , ( 0 , T ] ) ，由三角不等式可得</p><p>‖ E [ y ] − E K [ y h ] ‖ V ≤ ‖ E [ y ] − E [ y h ] ‖ V + ‖ E [ y h ] − E K [ y h ] ‖ V . (13)</p><p>可以看到，式(13)右边有两部分，第一部分是有限元离散产生的估计，第二部分是MC抽样产生的估计。</p><p>首先分析第一项，根据Cauchy-Schwarz不等式可以得到</p><p>‖ E [ y ] − E [ y h ] ‖ V = ‖ E [ y − y h ] ‖ V ≤ E [ ‖ y − y h ‖ V ] ≤ C 1 ‖ y − y h ‖ V .</p><p>根据文献 [<xref ref-type="bibr" rid="hanspub.41611-ref5">5</xref>] 有下式成立</p><p>‖ y − y h ‖ V ≤ 1 α α ‖ y ‖ V 2 + max ( 1 , a min − 1 ) 2 ( ‖ y ‖ V + ‖ y d ‖ V ) 2 ( h + τ ) .</p><p>即</p><p>‖ E [ y ] − E [ y h ] ‖ V ≤ C h .</p><p>再根据</p><p>‖ y h ‖ V ≤ C 2 : = ( 2 α a min 2 + 1 ) ‖ y ‖ V 2 + 2 α ‖ y d ‖ V 2 ,</p><p>得</p><p>‖ E [ y h ] − E K [ y h ] ‖ V ≤ C K − 1 / 2 .</p><p>其中，C是一个与h无关的正常数，仅取决于 F , α , y d 。综上所述，根据引理3.2整理可得</p><p>‖ E [ y ] − E K [ y h ] ‖ V ≤ C ( K − 1 / 2 + h + τ ) 。该结论可归结为如下定理：</p><p>定理4.1 y , y h ∈ L 2 ( L 2 ( Ω , H 0 1 ( D ) ) , ( 0 , T ] ) ，对 ∀ K ∈ ℕ ，有</p><p>‖ E [ y ] − E K [ y h ] ‖ V ≤ C ( F , α , y d ) ( K − 1 / 2 + h + τ )</p><p>成立，其中 C ( F , α , y d ) &gt; 0 是一个与h无关的正常数，仅取决于 F , α , y d 。</p></sec><sec id="s10"><title>6. 数值算例</title><p>我们给出一个数值算例，通过数值模拟来验证所提方法的有效性。该算例无精确解，取空间区间为 D = [ 0 , 1 ] ，时间区间为 ( 0 , 1 ] ，目标泛函中的 α = 1 , y d = t ( t − 1 ) 2 sin ( 2 π x ) ，随机系数a表示为如下形式：</p><p>a ( ω , x ) = 8 + ( 1 + ω ) cos ( π x ) .</p><p>用Matlab软件进行数值模拟，以下只列出 h = τ = 1 / 32 时的模拟情况。计算时间情况如下表1，目标泛函 J ( y &#175; , u &#175; ) 的近似计算值见表2。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> When h = τ = 1 / 32 , the number of samples and the time of numerical simulation (s: seconds</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >K</th><th align="center" valign="middle" >集成MC</th><th align="center" valign="middle" >MC</th></tr></thead><tr><td align="center" valign="middle" >1000</td><td align="center" valign="middle" >2.0036 s</td><td align="center" valign="middle" >2.1060 s</td></tr><tr><td align="center" valign="middle" >10,000</td><td align="center" valign="middle" >18.9131 s</td><td align="center" valign="middle" >23.0782 s</td></tr><tr><td align="center" valign="middle" >100,000</td><td align="center" valign="middle" >206.8349 s</td><td align="center" valign="middle" >277.2011 s</td></tr><tr><td align="center" valign="middle" >1,000,000</td><td align="center" valign="middle" >2132.5910 s</td><td align="center" valign="middle" >2991.9607 s</td></tr></tbody></table></table-wrap><p>表1. h = τ = 1 / 32 ，抽样数与模拟时间情况(s：秒)</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> When h = τ = 1 / 32 , the calculation results of the objective function value under different samplin</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >K</th><th align="center" valign="middle" >集成MC</th><th align="center" valign="middle" >MC</th></tr></thead><tr><td align="center" valign="middle" >1000</td><td align="center" valign="middle" >0.47618391e−2</td><td align="center" valign="middle" >0.47618391e−2</td></tr><tr><td align="center" valign="middle" >10,000</td><td align="center" valign="middle" >0.47618390e−2</td><td align="center" valign="middle" >0.47618390e−2</td></tr><tr><td align="center" valign="middle" >100,000</td><td align="center" valign="middle" >0.47618390e−2</td><td align="center" valign="middle" >0.47618390e−2</td></tr><tr><td align="center" valign="middle" >1,000,000</td><td align="center" valign="middle" >0.47618390e−2</td><td align="center" valign="middle" >0.47618390e−2</td></tr></tbody></table></table-wrap><p>表2. h = τ = 1 / 32 ，不同抽样下目标函数计算结果</p></sec><sec id="s11"><title>7. 结论</title><p>本文针对一类随机抛物最优控制问题提出的集成蒙特卡洛隐式Euler法，大大减少了计算量，抽样数越大，误差越小，越节省计算量。该方法是针对处理随机系数而提出的一种减少计算量的方法，它不影响空间方向、时间方向的误差精度。该集成格式可用于其它带随机扩散系数的演化方程随机最优控制问题的数值求解。</p></sec><sec id="s12"><title>基金项目</title><p>项目名称：随机最优控制问题的高效Monte Carlo有限元法；合同编号：国家自然科学基金项目(11961008)。</p></sec><sec id="s13"><title>文章引用</title><p>吴雪芳,罗贤兵. 一类随机抛物最优控制问题的集成蒙特卡洛隐式Euler法An Ensemble Monte Carlo Implicit Euler Method for a Class of Stochastic Parabolic Optimal Control Problems[J]. 应用数学进展, 2021, 10(04): 899-908. https://doi.org/10.12677/AAM.2021.104098</p></sec><sec id="s14"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.41611-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Lions, J. (1971) Optimal Control of Systems Governed by Partial Differential Equations. Springer-Verlag, Berlin Heidelberg. &lt;br&gt;https://doi.org/10.1007/978-3-642-65024-6</mixed-citation></ref><ref id="hanspub.41611-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Evans, L.C. (2010) Partial Differential Equations: Second Edition. AMS, Rhode Island.</mixed-citation></ref><ref id="hanspub.41611-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Troltzsch, F. (2010) Optimal Control of Partial Differential Equations Theory, Methods and Applications. AMS, Provide, Rhode Island. &lt;br&gt;https://doi.org/10.1090/gsm/112/07</mixed-citation></ref><ref id="hanspub.41611-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Du, N., Shi, J. and Liu, W.B. (2013) An Effective Gradient Projection Method for Stochastic Optimal Control. International Journal of Numerical Analysis and Modeling, 10, 757-774.</mixed-citation></ref><ref id="hanspub.41611-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Ali, A.A., Ullmann, E. and Hinze, M. (2017) Multilevel Monte Carlo Analysis for Optimal Control of Elliptic PDEs with Random Coefficients. SIAM/ASA Journal on Uncertainty Quantification, 5, 466-492.  
&lt;br&gt;https://doi.org/10.1137/16M109870X</mixed-citation></ref><ref id="hanspub.41611-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Sun, T., Shen, W., Gong, B. and Liu, W.B. (2016) A Priori Error Estimate of Stochastic Galerkin Method for Optimal Control Problem Governed by Stochastic Elliptic PDE with Constrained Control. Journal of Scientific Computing, 67, 405-431. &lt;br&gt;https://doi.org/10.1007/s10915-015-0091-7</mixed-citation></ref><ref id="hanspub.41611-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Gong, B., Sun, T., Shen, W. and Liu, W.B. (2016) A Priori Error Estimate of Stochastic Galerkin Method for Optimal Control Problem Governed by Random Parabolic PDE with Constrained Control. International Journal of Computational Methods, 13, 1650028 -1-1650028-26. &lt;br&gt;https://doi.org/10.1142/S0219876216500286</mixed-citation></ref><ref id="hanspub.41611-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Luo, Y. and Wang, Z. (2018) An Ensemble Algorithm for Numerical Solutions to Deterministic and Random Parabolic PDEs. SIAM Journal on Numerical Analysis, 56, 859-876. &lt;br&gt;https://doi.org/10.1137/17M1131489</mixed-citation></ref><ref id="hanspub.41611-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Hinze, M. (2005) A Variational Discretization Concept in Control Constrained Optimization: The Linear-Quadratic Case. Computational Optimization an Applications, 30, 45-61. &lt;br&gt;https://doi.org/10.1007/s10589-005-4559-5</mixed-citation></ref></ref-list></back></article>