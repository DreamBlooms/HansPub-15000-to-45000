<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2020.91015</article-id><article-id pub-id-type="publisher-id">AAM-34018</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20200100000_95928651.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于改进Heston模型的欧式期权定价
  European Option Pricing Based on Improved Heston Model
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>江</surname><given-names>倩</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>广西大学数学与信息科学学院，广西 南宁</addr-line></aff><pub-date pub-type="epub"><day>30</day><month>12</month><year>2019</year></pub-date><volume>09</volume><issue>01</issue><fpage>120</fpage><lpage>132</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    Heston模型是一种被广泛应用于资产管理的随机波动率(SV)模型。本文设置动态的均值回复幂函数代替Heston模型采用均值回复平方根描述波动率过程，提出一种改进的Heston模型，并根据实际确定幂函数具体形式。利用∆-对冲原理构造无风险资产组合，得到该模型下期权价格满足的PDE，以及利用反演定理求期权价格的封闭形式解。实证分析表明，改进的Heston模型能有效提高模型定价的准确性。
    Heston model is a stochastic volatility (SV) model widely used in asset management. In this paper, a dynamic mean reversion power function is set to replace the Heston model which used the mean reversion square root to describe the volatility process. An improved Heston model is proposed and the specific form of power function is determined according to the actual situation. Using the ∆-hedging principle, we construct a risk-free asset portfolio, get the PDE of option price satisfying the model, and use the inversion theorem to find the closed form solution of option price. Empirical analysis shows that the improved Heston model can effectively improve the accuracy of pricing. 
  
 
</p></abstract><kwd-group><kwd>随机波动率，PDE方程，欧式期权，定价, Random Volatility</kwd><kwd> the PDE Equation</kwd><kwd> European Option</kwd><kwd> Pricing</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于改进Heston模型的欧式期权定价<sup> </sup></title><p>江倩</p><p>广西大学数学与信息科学学院，广西 南宁</p><p>收稿日期：2019年12月26日；录用日期：2020年1月10日；发布日期：2020年1月17日</p><disp-formula id="hanspub.34018-formula30"><graphic xlink:href="//html.hanspub.org/file/15-2621117x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>Heston模型是一种被广泛应用于资产管理的随机波动率(SV)模型。本文设置动态的均值回复幂函数代替Heston模型采用均值回复平方根描述波动率过程，提出一种改进的Heston模型，并根据实际确定幂函数具体形式。利用∆-对冲原理构造无风险资产组合，得到该模型下期权价格满足的PDE，以及利用反演定理求期权价格的封闭形式解。实证分析表明，改进的Heston模型能有效提高模型定价的准确性。</p><p>关键词 :随机波动率，PDE方程，欧式期权，定价</p><disp-formula id="hanspub.34018-formula31"><graphic xlink:href="//html.hanspub.org/file/15-2621117x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/15-2621117x7_hanspub.png" /> <img src="//html.hanspub.org/file/15-2621117x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>期权定价问题是资产定价的主要研究内容之一。2015年上证50ETF期权正式推出，标志着我国金融衍生品市场迎来了“期权时代”，合理为期权定价对完善和发展我国金融衍生品市场有着重要的实践意义。</p><p>为了有效地给期权定价，标的资产的定价模型尤为重要。1900年Bachelier [<xref ref-type="bibr" rid="hanspub.34018-ref1">1</xref>] 在其博士论文中首次提出用随机游动思想给出资产价格运行的随机模型。1965年Smuelson [<xref ref-type="bibr" rid="hanspub.34018-ref2">2</xref>] 对该模型进行改进，假设股票价格服从几何布朗运动，从而避免了股票价格可能为负值的情形。1973年Black和Scholes [<xref ref-type="bibr" rid="hanspub.34018-ref3">3</xref>] 在假设股票当前价格、时间、证券价格波动率和无风险利率都是客观变量且与投资者偏好不相关前提下，将所有投资者引向同一个以无风险利率作为投资回报率的风险中性世界 [<xref ref-type="bibr" rid="hanspub.34018-ref4">4</xref>]，并提出著名的B-S定价公式。然而，Fama [<xref ref-type="bibr" rid="hanspub.34018-ref5">5</xref>] 等指出市场并不像想象那般完美，资产回报的分布呈现明显的“厚尾”现象，这与假设资产价格遵循几何布朗运动不相符。在许多对Black-Soles模型“常数波动率”进行改进的方法中，常见的是利用自回归条件异方差(GARCH)模型或随机波动率(SV)模型表示资产收益波动率的时变性和波动聚集现象等，其中随机波动率模型(SV)模型对波动率具有更好的样本内拟合表现以及样本外预测能力 [<xref ref-type="bibr" rid="hanspub.34018-ref6">6</xref>]。</p><p>早期，Johnson和Shanno [<xref ref-type="bibr" rid="hanspub.34018-ref7">7</xref>]，Scott [<xref ref-type="bibr" rid="hanspub.34018-ref8">8</xref>]，Wiggins [<xref ref-type="bibr" rid="hanspub.34018-ref9">9</xref>] 通过数值的方法系统地研究了SV模型。具体而言，Johnson、Shanno和Scott采用蒙特卡罗模拟，而Wiggins提出用有限差分法求解金融衍产品的期权等相应的PDE。但是由于缺乏封闭形式的解，这两种方法在实际计算过程中都会花费较长的时间，在应用方面存在局限性。1990年Hull和White [<xref ref-type="bibr" rid="hanspub.34018-ref10">10</xref>] 提出Hull-White模型，在假设资产价格收益与波动率变动所遵循的布朗运动的相关系数为零的基础上推导出欧式期权定价公式。1991年Stein和Stein [<xref ref-type="bibr" rid="hanspub.34018-ref11">11</xref>] 提出波动遵循Ornstein-Uhlenbeck过程，并导出欧式期权价格封闭形式的解，但该模型不能防止资产价格波动方差出现负值。1993年Heston [<xref ref-type="bibr" rid="hanspub.34018-ref12">12</xref>] 应用均值回复平方根过程描述波动率方差过程，指出波动率满足非负性和均值回复性，并利用模型的仿射结构和反演定理方法给出欧式期权定价封闭形式的解，这保证了计算精度，防止利用数值解法产生的系统误差，且在参数估计方面封闭的解可以节省大量的时间和精力。Li [<xref ref-type="bibr" rid="hanspub.34018-ref13">13</xref>] 研究了timer期权与Heston模型和贝塞尔过程有关的数学建模新方法，由于timer期权结果复杂，只得到了期权价格的半封闭形式的解。马俊美 [<xref ref-type="bibr" rid="hanspub.34018-ref14">14</xref>] 等基于两类SV模型研究了欧式期权的价格和敏感性估计问题，在精确模拟算法基础上，讨论了舍取抽样技术在精确模拟算法中的有效应用。吴鑫育 [<xref ref-type="bibr" rid="hanspub.34018-ref6">6</xref>] 等基于SV模型对上证50ETF期权定价，建立两步法来估计定价模型参数，该估计方法易于实现，只需单日期权数据即可进行估计，具有较高的估计效率。H Hong [<xref ref-type="bibr" rid="hanspub.34018-ref15">15</xref>] 将SV模型应用于恒生指数的实际数据，研究了具有杠杆作用的SV模型在期权定价中的影响，结果显示随着期权到期日的增加，这种影响变得更加显著。谢超强 [<xref ref-type="bibr" rid="hanspub.34018-ref16">16</xref>] 等研究了基于Heston模型和风险偏好视角的资产负债管理，应用随机控制方法，得到了该问题最优资产配置策略的解析表达式和相应值函数的解析解。Soleymani和Barfeie [<xref ref-type="bibr" rid="hanspub.34018-ref17">17</xref>] 给出了随机波动率跳跃定价模型中空间变量离散点的非均匀生成，在这类模型下对美式和欧式期权的定价都是高效的，但需要讨论该数值方法的条件稳定性和离散方程全局收敛的充分条件。</p><p>Heston模型给出欧式期权定价封闭形式的解，有效提高参数估计方面的效力。但由于模型采用固定的均值回复平方根描述波动率过程，导致有时模型计算结果与实际有较大的误差。为了克服Heston模型的不足，本文设置动态的均值回复幂函数描述波动率过程，并根据具体的实际情况确定幂函数的具体形式，提高模型的适应性和计算精度。</p></sec><sec id="s4"><title>2. Heston模型的改进</title><p>SV模型主要基于资产价格和波动率都遵循“有偏的随机游走”，即一个漂移项加上一个随机项 [<xref ref-type="bibr" rid="hanspub.34018-ref1">1</xref>]，且随机项服从标准的布朗运动。以下是考虑资产及其方差波动率都是随机过程的Stein-stein模型与Heston。</p><sec id="s4_1"><title>2.1. Stein-Stein [<xref ref-type="bibr" rid="hanspub.34018-ref11">11</xref>] 模型</title><p>在滤子空间<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x9_hanspub.png" xlink:type="simple"/></inline-formula>上，文献 [<xref ref-type="bibr" rid="hanspub.34018-ref11">11</xref>] 建立了stein-stein模型，其资产价格<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x10_hanspub.png" xlink:type="simple"/></inline-formula>与瞬时波动率 v t 分别满足如下SV模型</p><disp-formula id="hanspub.34018-formula32"><graphic xlink:href="//html.hanspub.org/file/15-2621117x12_hanspub.png"  xlink:type="simple"/></disp-formula><p>d v t = k ( ξ − v t ) d t + σ d W t 2</p><p>其中 W t 1 和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x15_hanspub.png" xlink:type="simple"/></inline-formula>分别表示资产和波动率的随机噪声，是相关系数为 ρ 的标准布朗运动，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x17_hanspub.png" xlink:type="simple"/></inline-formula>，r表示资产回报率，q是红利率，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x18_hanspub.png" xlink:type="simple"/></inline-formula>是 v t 的波动率， ξ 是均值回复水平，k是均值回复速率。</p><p>SV模型中含dt的项均为漂移项，含 d W t 项为随机项，例如，stein-stein模型中瞬时波动率的漂移项为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x22_hanspub.png" xlink:type="simple"/></inline-formula>，随机项为 σ d W t 2 ，反映了波动率在该时刻先进行一个固定漂移再进行一定的随机变动。</p></sec><sec id="s4_2"><title>2.2. Heston [<xref ref-type="bibr" rid="hanspub.34018-ref12">12</xref>] 模型</title><p>Heston [<xref ref-type="bibr" rid="hanspub.34018-ref12">12</xref>] 改进了stein-stein模型的随机项，提出如下随机波动率模型</p><p>d S t S t = ( r − q ) d t + v t d W t 1</p><disp-formula id="hanspub.34018-formula33"><graphic xlink:href="//html.hanspub.org/file/15-2621117x25_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中 S t 、<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x27_hanspub.png" xlink:type="simple"/></inline-formula>、 W t 1 、 <inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x29_hanspub.png" xlink:type="simple"/></inline-formula>、r、q、<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x30_hanspub.png" xlink:type="simple"/></inline-formula>、k、<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x31_hanspub.png" xlink:type="simple"/></inline-formula>的意义同上。</p><p>以上二个随机波动率模型都假设瞬时波动率<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x32_hanspub.png" xlink:type="simple"/></inline-formula>满足均值回复过程，且回复速率是一个常数。由于Stein-stein模型对刻画资产价格瞬时波动率方差过程欠充分，所以不能避免波动率出现负值的情况。虽然Heston应用均值回复平方根过程克服了波动率出现负值，但模型随机项中对 v t 指数取确定的常数，有时导致定价结果与实际情况有较大差距。为此，本文在保留Heston模型的漂移项的基础数上，将随机项中 v t 幂指数用待定参数表示，并根据实际情况确定参数的取值，有效提高模型定价的准确性。</p></sec><sec id="s4_3"><title>2.3. 改进的Heston模型</title><p>在滤子空间<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x35_hanspub.png" xlink:type="simple"/></inline-formula>上，假设资产价格 S t 与瞬时波动率<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x37_hanspub.png" xlink:type="simple"/></inline-formula>满足如下新的SV模型</p><disp-formula id="hanspub.34018-formula34"><graphic xlink:href="//html.hanspub.org/file/15-2621117x38_hanspub.png"  xlink:type="simple"/></disp-formula><p>d v t = k ( ξ − v t ) d t + σ v t β d W t 2 (2-1)</p><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x40_hanspub.png" xlink:type="simple"/></inline-formula>、 W t 2 、r、q、<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x42_hanspub.png" xlink:type="simple"/></inline-formula>、k、 ξ 的意义同上， α ,β 为待定参数，且满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x45_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>显然，当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x46_hanspub.png" xlink:type="simple"/></inline-formula>时，模型(2-1)即为Stein-stein模型；当 α = 1 2 , β = 1 2 时，模型(2-1)即为Heston模型。</p></sec></sec><sec id="s5"><title>3. 改进Heston模型下欧式看涨期权的PDE</title><p>下面利用∆-对冲原理 [<xref ref-type="bibr" rid="hanspub.34018-ref18">18</xref>] 推导模型(2-1)下的欧式看涨期权的PDE。为了方便，将 S t 、 v t 分别简记为S、v，假设资产组合<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x50_hanspub.png" xlink:type="simple"/></inline-formula>由一单位的方差期权V，∆单位的资产S和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x51_hanspub.png" xlink:type="simple"/></inline-formula>单位的其他期权G组成，为了让形式更加简洁假设支付的红利为0。则资产组合<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x52_hanspub.png" xlink:type="simple"/></inline-formula>的价值变化为</p><disp-formula id="hanspub.34018-formula35"><label>(3-1)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x276_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据模型(2-1)，由伊藤引理 [<xref ref-type="bibr" rid="hanspub.34018-ref19">19</xref>] 得</p><p>d G = ∂ G ∂ t d t + ∂ G ∂ S d S + ∂ G ∂ v d v + 1 2 v 2 α S 2 ∂ 2 G ∂ S 2 d t + σ v α + β ρ S ∂ 2 G ∂ S ∂ v d t + 1 2 σ 2 v 2 β ∂ 2 G ∂ v 2 d t (3-2)</p><p>d V = ∂ V ∂ t d t + ∂ V ∂ S d S + ∂ V ∂ v d v + 1 2 v 2 α S 2 ∂ 2 V ∂ S 2 d t + σ v α + β ρ S ∂ 2 V ∂ S ∂ v d t + 1 2 σ 2 v 2 β ∂ 2 V ∂ v 2 d t (3-3)</p><p>将(2-1)、(3-2)与(3-3)代入(3-1)整理化简得</p><p>d Π = [ ∂ V ∂ t + 1 2 v 2 α S 2 ∂ 2 V ∂ S 2 + σ v α + β ρ S ∂ 2 V ∂ S ∂ v + 1 2 σ 2 v 2 β ∂ 2 V ∂ v 2 ] d t     + φ [ ∂ G ∂ t + 1 2 v 2 α S 2 ∂ 2 G ∂ S 2 + σ v α + β ρ S ∂ 2 G ∂ S ∂ v + 1 2 σ 2 v 2 β ∂ 2 G ∂ v 2 ] d t     + [ ∂ V ∂ S + Δ + φ ∂ G ∂ S ] d S + [ ∂ V ∂ v + φ ∂ G ∂ v ] d v (3-4)</p><p>根据无风险资产的假设，(3-4)右端最后两项系数均为零，即</p><p>{ ∂ V ∂ S + Δ + φ ∂ G ∂ S = 0 ∂ V ∂ v + φ ∂ G ∂ v = 0</p><p>解得</p><disp-formula id="hanspub.34018-formula36"><label>(3-5)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x58_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据无套利原则 [<xref ref-type="bibr" rid="hanspub.34018-ref19">19</xref>] 有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x59_hanspub.png" xlink:type="simple"/></inline-formula>，于是由(3-4)有</p><p>[ ∂ V ∂ t + 1 2 v 2 α S 2 ∂ 2 V ∂ S 2 + σ v α + β ρ S ∂ 2 V ∂ S ∂ v + 1 2 σ 2 v 2 β ∂ 2 V ∂ v 2 ]   + φ [ ∂ G ∂ t + 1 2 v 2 α S 2 ∂ 2 G ∂ S 2 + σ v α + β ρ S ∂ 2 G ∂ S ∂ v + 1 2 σ 2 v 2 β ∂ 2 G ∂ v 2 ] d t = r ( V + Δ S + φ G ) d t (3-6)</p><p>将(3-5)代入(3-6)整理化简得</p><p>[ ∂ V ∂ t + 1 2 v 2 α S 2 ∂ 2 V ∂ S 2 + σ v α + β ρ S ∂ 2 V ∂ S ∂ v + 1 2 σ 2 v 2 β ∂ 2 V ∂ v 2 ] − r V + r S ∂ V ∂ S ∂ V ∂ v = [ ∂ G ∂ t + 1 2 v 2 α S 2 ∂ 2 G ∂ S 2 + σ v α + β ρ S ∂ 2 G ∂ S ∂ v + 1 2 σ 2 v 2 β ∂ 2 G ∂ v 2 − r G + r S ∂ G ∂ S ] ∂ G ∂ v (3-7)</p><p>可以看出，(3-7)左右两侧分别是关于期权价格V和G的函数，且形式相同，根据Heston [<xref ref-type="bibr" rid="hanspub.34018-ref12">12</xref>] 方程左右两边都可以用同一个形式的函数如<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x62_hanspub.png" xlink:type="simple"/></inline-formula>来表示，即</p><disp-formula id="hanspub.34018-formula37"><graphic xlink:href="//html.hanspub.org/file/15-2621117x63_hanspub.png"  xlink:type="simple"/></disp-formula><p>且<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x64_hanspub.png" xlink:type="simple"/></inline-formula>满足</p><disp-formula id="hanspub.34018-formula38"><graphic xlink:href="//html.hanspub.org/file/15-2621117x65_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中 γ ( v ) 反映波动风险的价格，是波动率的线性函数，即 γ ( v ) = γ v ， γ 为常数，将其代入(3-8)得</p><p>g ( S , v , t ) = − k ξ + ( k + γ ) v</p><p>g ( S , v , t ) 为关于v的线性函数，为了更加简洁，记<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x71_hanspub.png" xlink:type="simple"/></inline-formula>，其中 λ 1 = k ξ ， λ 2 = − ( k + γ ) 将其代入(3-8)整理化简得到改进Heston模型下期权价格的PDE为</p><p>1 2 v 2 α S 2 ∂ 2 G ∂ S 2 + σ v α + β ρ S ∂ 2 G ∂ S ∂ v + 1 2 σ 2 v 2 β ∂ 2 G ∂ v 2 + r S ∂ G ∂ S + λ ( v ) ∂ G ∂ v − r G + ∂ G ∂ t = 0 (3-9)</p><p>并且(3-9)满足以下边界条件</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x277_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>其中T为到期日，K为执行价格。</p><p>当资产为零，买入期权就毫无价值；当资产价格上涨时delta接近1；当波动率增加时，买入期权就</p><p>等于资产价格，即分别对应有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x76_hanspub.png" xlink:type="simple"/></inline-formula>， ∂ G ∂ S ( ∞ , v , t ) = 1 ，和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x78_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>记 x = ln S ，代入(3-9)整理化简得</p><p>1 2 v 2 α ∂ 2 G ∂ x 2 − 1 2 v 2 α ∂ G ∂ x + σ v α + β ρ ∂ 2 G ∂ x ∂ v + 1 2 σ 2 v 2 β ∂ 2 G ∂ v 2 + r ∂ G ∂ x + λ ( v ) ∂ G ∂ v − r G + ∂ G ∂ t = 0 (3-10)</p><p>显然(3-10)与(3-9)是等价的。</p></sec><sec id="s6"><title>4. 改进Heston模型下欧式看涨期权定价公式</title><p>根据文献 [<xref ref-type="bibr" rid="hanspub.34018-ref18">18</xref>] 知(3-10)的解为</p><p>C ( K ) = S t P 1 ( S , v , t ) − K e − r τ P 2 ( S , v , t ) (4-1)</p><p>P 1 ( S , v , t ) 和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x83_hanspub.png" xlink:type="simple"/></inline-formula>分别表示欧式看涨期权按照股票价格行权的概率和在风险中性环境被行权的概率。</p><p>下面确定(4-1)中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x84_hanspub.png" xlink:type="simple"/></inline-formula>和 P 2 ( S , v , t ) 。</p><p>首先将<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x86_hanspub.png" xlink:type="simple"/></inline-formula>代入(4-1)得</p><p>C ( K ) = e x P 1 ( x , v , t ) − K e − r τ P 2 ( x , v , t ) (4-2)</p><p>(4-2)式分别求以下偏导数得</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x88_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x89_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>∂ 2 C ∂ x 2 = e x [ P 1 + 2 ∂ P 1 ∂ x + ∂ 2 P 1 ∂ x 2 ] − K e − r τ ∂ 2 P 2 ∂ x 2 ，</p><p>∂ C ∂ v = e x ∂ P 1 ∂ v − K e − r τ ∂ P 2 ∂ v ， (4-3)</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x92_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>∂ 2 C ∂ x ∂ v = [ e x ∂ P 1 ∂ v + ∂ 2 P 1 ∂ x ∂ v ] − K e − r τ ∂ 2 P 2 ∂ x ∂ v 。</p><p>将(4-3)代入(3-10)整理化简得</p><disp-formula id="hanspub.34018-formula39"><graphic xlink:href="//html.hanspub.org/file/15-2621117x94_hanspub.png"  xlink:type="simple"/></disp-formula><p>记 u j = ( − 1 2 ) j − 1 , b j = ρ σ ( 2 − j ) ,<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x97_hanspub.png" xlink:type="simple"/></inline-formula>，则上微分方程可化为</p><p>1 2 v 2 α ∂ 2 P j ∂ x 2 + σ v α + β ρ ∂ 2 P j ∂ x ∂ v + 1 2 σ 2 v 2 β ∂ 2 P j ∂ x 2 + ( r + u j v 2 α ) ∂ P j ∂ x + ( λ ( v ) + b j v α + β ) ∂ P j ∂ v + ∂ P j ∂ t = 0 (4-4)</p><p>(4-4)是<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x99_hanspub.png" xlink:type="simple"/></inline-formula>满足的偏微分方程，下面通过随机变量x的特征函数给出。</p><p>根据如下反演定理知，可通过x的特征函数给出 P j 。</p><p>引理1 [<xref ref-type="bibr" rid="hanspub.34018-ref20">20</xref>] (反演定理)若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x101_hanspub.png" xlink:type="simple"/></inline-formula>是随机变量x的特征函数，则</p><disp-formula id="hanspub.34018-formula40"><label>(4-5)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x102_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x103_hanspub.png" xlink:type="simple"/></inline-formula>为虚数单位， ϕ 为实数。</p><p>因此，为了确定 P j ( x , v , t ) ，下面将推导特征函数 <inline-formula><inline-graphic xlink:href="//html.scirp.org/file/15-2621117x278_hanspub.png" xlink:type="simple"/></inline-formula> 的计算式 ( j = 1 , 2 ) 。</p><p>根据文献 [<xref ref-type="bibr" rid="hanspub.34018-ref18">18</xref>]，随机变量x的特征函数为如下对数形式</p><disp-formula id="hanspub.34018-formula41"><label>(4-6)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x108_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中 C j ( τ ; ϕ ) 与 D j ( τ ; ϕ ) 是独立于x和v的函数，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x111_hanspub.png" xlink:type="simple"/></inline-formula>为待定参数，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x112_hanspub.png" xlink:type="simple"/></inline-formula>为实数。</p><p>根据Feynman-Kac定理 [<xref ref-type="bibr" rid="hanspub.34018-ref19">19</xref>]，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x113_hanspub.png" xlink:type="simple"/></inline-formula>与 P j 有相同的PDE，因此<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x115_hanspub.png" xlink:type="simple"/></inline-formula>满足(4-4)。当 t = T 即 τ = 0 时, x = ln S T 已知， e i ϕ x T 为常数，期望是其本身，即边界条件<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x120_hanspub.png" xlink:type="simple"/></inline-formula>，此时<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x121_hanspub.png" xlink:type="simple"/></inline-formula>， <inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x122_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>对(4-6)式分别求以下偏导数</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x123_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>∂ f j ∂ x = i ϕ f j ，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x125_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x126_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x127_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>∂ 2 f j ∂ x ∂ v = i ϕ θ D j v θ − 1 f j 。</p><p>因为 f j 满足(4-4)，所以将上述偏导数代入(4-4)式化简得</p><p>[ − 1 2 ϕ 2 + i u j ϕ ] v 2 α + [ i ρ σ 2 ϕ + b j ] θ D j v α + β + θ − 1 + 1 2 σ 2 θ ( θ − 1 ) D j v 2 β + θ − 2 + 1 2 σ 2 θ 2 D j 2 v 2 β + 2 θ − 2 + ∂ D j ∂ t v θ + [ ∂ C j ∂ t + i r ϕ ] + θ D j λ ( v ) v θ − 1 = 0 (4-7)</p><p>下面将证明 θ = 2 α 、<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x132_hanspub.png" xlink:type="simple"/></inline-formula>，以及确定<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x133_hanspub.png" xlink:type="simple"/></inline-formula>与 D j ( τ ; ϕ ) 的计算式。</p><p>1) 因为当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x135_hanspub.png" xlink:type="simple"/></inline-formula>时<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x136_hanspub.png" xlink:type="simple"/></inline-formula>，所以(4-7)可化为</p><disp-formula id="hanspub.34018-formula42"><label>(4-8)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x137_hanspub.png"  xlink:type="simple"/></disp-formula><p>假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x138_hanspub.png" xlink:type="simple"/></inline-formula>，由于(4-8)对任意<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x139_hanspub.png" xlink:type="simple"/></inline-formula>恒成立，故<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x140_hanspub.png" xlink:type="simple"/></inline-formula>的系数为零，即 i u j ϕ − 1 2 ϕ 2 = 0 。于是<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x142_hanspub.png" xlink:type="simple"/></inline-formula>或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x143_hanspub.png" xlink:type="simple"/></inline-formula>。而 ϕ 显然不恒为零，故<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x145_hanspub.png" xlink:type="simple"/></inline-formula>，即<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x146_hanspub.png" xlink:type="simple"/></inline-formula>为复数，这与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x147_hanspub.png" xlink:type="simple"/></inline-formula>为实数矛盾。因此 θ = 2 α 。</p><p>2) 将 θ = 2 α , λ ( v ) = λ 1 + λ 2 v 代入(4-8)得</p><disp-formula id="hanspub.34018-formula43"><label>(4-9)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x150_hanspub.png"  xlink:type="simple"/></disp-formula><p>i) 若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x151_hanspub.png" xlink:type="simple"/></inline-formula>，则(4-9)化为</p><p>[ − 1 2 ϕ 2 + i u j ϕ + ∂ D j ∂ t + D j λ 2 ] v + [ i ρ σ 2 ϕ + b j ] D j v β + 1 2   + 1 2 σ 2 D j 2 v 2 β + [ ∂ C j ∂ t + i r ϕ + D j λ 1 ] = 0 (4-10)</p><p>假设 β ≠ 1 2 时，由于(4-10)对任意v恒成立，故v与v<sup>0</sup>的系数都为零，从而(4-10)可化为</p><p>[ i ρ σ 2 ϕ + b j ] D j v β + 1 2 + 1 2 σ 2 D j 2 v 2 β = 0</p><p>解得 D j = 0 或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x156_hanspub.png" xlink:type="simple"/></inline-formula>，这与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x157_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x158_hanspub.png" xlink:type="simple"/></inline-formula>有关相矛盾。所以，当 α = 1 2 时，必有 β = 1 2 ，此时新SV模型即是Heston模型。</p><p>ii) 若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x161_hanspub.png" xlink:type="simple"/></inline-formula>。假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x162_hanspub.png" xlink:type="simple"/></inline-formula>，则(4-9)化为</p><disp-formula id="hanspub.34018-formula44"><label>(4-11)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x163_hanspub.png"  xlink:type="simple"/></disp-formula><p>由于(4-11)对任意v恒成立，故<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x164_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x165_hanspub.png" xlink:type="simple"/></inline-formula>的系数都为零，(4-11)可化为</p><disp-formula id="hanspub.34018-formula45"><graphic xlink:href="//html.hanspub.org/file/15-2621117x166_hanspub.png"  xlink:type="simple"/></disp-formula><p>解得<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x167_hanspub.png" xlink:type="simple"/></inline-formula>或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x168_hanspub.png" xlink:type="simple"/></inline-formula>，这与 D j ( τ ; ϕ ) 与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x170_hanspub.png" xlink:type="simple"/></inline-formula>有关相矛盾。因此有 β ≠ 1 。</p><p>假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x172_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x173_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x174_hanspub.png" xlink:type="simple"/></inline-formula>，而 α &gt; 0 且<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x176_hanspub.png" xlink:type="simple"/></inline-formula>且 β ≠ 1 ，则<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x178_hanspub.png" xlink:type="simple"/></inline-formula>， 2 β + 2 α − 2 ，</p><p>2 β + 4 α − 2 ， 2 α − 1 均不等于0且不等于<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x182_hanspub.png" xlink:type="simple"/></inline-formula>。由于(4-9)对任意v恒成立，故<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x183_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x184_hanspub.png" xlink:type="simple"/></inline-formula>的系数都为零，(4-9)可化为</p><disp-formula id="hanspub.34018-formula46"><graphic xlink:href="//html.hanspub.org/file/15-2621117x185_hanspub.png"  xlink:type="simple"/></disp-formula><p>解得<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x186_hanspub.png" xlink:type="simple"/></inline-formula>或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x187_hanspub.png" xlink:type="simple"/></inline-formula>，这与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x188_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x189_hanspub.png" xlink:type="simple"/></inline-formula>有关相矛盾。</p><p>因此，在<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x190_hanspub.png" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x191_hanspub.png" xlink:type="simple"/></inline-formula>, β ≠ 1 − 3 α 中至少有一个不成立。</p><p>若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x193_hanspub.png" xlink:type="simple"/></inline-formula>，将其代入(4-9)得</p><p>[ − 1 2 ϕ 2 + i u j ϕ + ∂ D j ∂ t + 2 α D j λ 2 ] v 2 α + 2 α [ i ρ σ 2 ϕ + b j ] D j v α + α σ 2 ( 2 α − 1 ) D j v − 2 α   + 2 σ 2 α 2 D j 2 + [ ∂ C j ∂ t + i r ϕ ] + 2 α D j λ 1 v 2 α − 1 = 0 (4-12)</p><p>由于(4-12)对任意v恒成立，故<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x195_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x196_hanspub.png" xlink:type="simple"/></inline-formula>的系数都为零，(4-12)化为</p><p>2 α [ i ρ σ 2 ϕ + b j ] D j v α + α σ 2 ( 2 α − 1 ) D j v − 2 α + 2 α D j λ 1 v 2 α − 1 = 0 (4-13)</p><p>当 α = 1 4 时，(4-13)可化为</p><p>1 2 [ i ρ σ 2 ϕ + b j ] D j v 1 4 + 1 8 D j ( 2 λ 1 − σ 2 ) v − 1 2 = 0 (4-14)</p><p>由于(4-14)对任意v恒成立，故 v 1 2 与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x201_hanspub.png" xlink:type="simple"/></inline-formula>的系数都为零，从而<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x202_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x203_hanspub.png" xlink:type="simple"/></inline-formula>或 ϕ = − b j i ρ σ 2 ，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x203_hanspub.png" xlink:type="simple"/></inline-formula> 与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x206_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x207_hanspub.png" xlink:type="simple"/></inline-formula>有关矛盾，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x208_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x209_hanspub.png" xlink:type="simple"/></inline-formula>是实数矛盾。</p><p>当 α ≠ 1 4 时，由于(4-13)对任意v恒成立，故<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x211_hanspub.png" xlink:type="simple"/></inline-formula>的系数零，(4-13)化为</p><p>2 α [ i ρ σ 2 ϕ + b j + λ 1 v α − 1 ] D j = 0</p><p>解得<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x213_hanspub.png" xlink:type="simple"/></inline-formula>或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x214_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x215_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x216_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x217_hanspub.png" xlink:type="simple"/></inline-formula>有关矛盾，而<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x218_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x219_hanspub.png" xlink:type="simple"/></inline-formula>为实数矛盾。</p><p>因此，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x220_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x221_hanspub.png" xlink:type="simple"/></inline-formula>，将其代入(4-9)得</p><p>[ − 1 2 ϕ 2 + i u j ϕ + ∂ D j ∂ t + 2 α D j λ 2 ] v 2 α + 2 α [ i ρ σ 2 ϕ + b j ] D j + α σ 2 ( 2 α − 1 ) D j v − 4 α   + 2 σ 2 α 2 D j 2 v − 2 α + [ ∂ C j ∂ t + i r ϕ ] + 2 α D j λ 1 v 2 α − 1 = 0 (4-15)</p><p>由于(4-14)对任意v恒成立，故<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x223_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x224_hanspub.png" xlink:type="simple"/></inline-formula>的系数都为零，(4-14)可化为</p><disp-formula id="hanspub.34018-formula47"><graphic xlink:href="//html.hanspub.org/file/15-2621117x225_hanspub.png"  xlink:type="simple"/></disp-formula><p>解得<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x226_hanspub.png" xlink:type="simple"/></inline-formula>或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x227_hanspub.png" xlink:type="simple"/></inline-formula>，这与 D j ( τ ; ϕ ) 与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x229_hanspub.png" xlink:type="simple"/></inline-formula>有关相矛盾。</p><p>综上所述有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x230_hanspub.png" xlink:type="simple"/></inline-formula>不成立，即有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x231_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>接下来确定<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x232_hanspub.png" xlink:type="simple"/></inline-formula>与 D j ( τ ; ϕ ) 的计算式。</p><p>将<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x234_hanspub.png" xlink:type="simple"/></inline-formula>代入模型(2-1)，(2-1)可转化为如下形式</p><disp-formula id="hanspub.34018-formula48"><label>(4-16)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x236_hanspub.png"  xlink:type="simple"/></disp-formula><p>当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x237_hanspub.png" xlink:type="simple"/></inline-formula>时，(4-16)即为Heston模型，欧式看涨期权定价公式采用Heston模型下欧式看涨期权定价公式。</p><p>当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x238_hanspub.png" xlink:type="simple"/></inline-formula>时，将 β = 1 − α 代入(4-9)得</p><p>[ − 1 2 ϕ 2 + i u j ϕ + ∂ D j ∂ t + 2 α ( i ρ σ 2 ϕ + b j ) D j + 2 α 2 σ 2 D j 2 + 2 α D j λ 2 ] v 2 α + [ ∂ C j ∂ t + i r ϕ + σ 2 α ( 2 α − 1 ) D j ] + 2 α D j λ 1 v 2 α − 1 = 0 (4-17)</p><p>由于(4-17)对任意v恒成立，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x241_hanspub.png" xlink:type="simple"/></inline-formula>的系数为0，即 λ 1 = 0 。<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x243_hanspub.png" xlink:type="simple"/></inline-formula>的系数和常数项都为零，因此可由(4-17)得</p><disp-formula id="hanspub.34018-formula49"><label>(4-18)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x244_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据文献 [<xref ref-type="bibr" rid="hanspub.34018-ref18">18</xref>] 求解(4-18)的Riccati方程得到 C j ( τ ; ϕ ) 与<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x246_hanspub.png" xlink:type="simple"/></inline-formula></p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x247_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x248_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>其中， h j ( τ , ϕ ) = [ d j − 2 α ( b j + λ 2 + i ϕ ρ σ ) ] τ − 2 ln [ 1 − e d j τ 1 − g j ] ，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x250_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x251_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>综合以上推导可得新SV模型下欧式看涨期权价格封闭解为</p><disp-formula id="hanspub.34018-formula50"><label>(4-19)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2621117x252_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中</p><p>x = ln S ，</p><p>P j = 1 2 + 1 π ∫ 0 ∞ R e [ e − i ϕ ln K f j ( x , v , t ; ϕ ) i ϕ ] d ϕ ，</p><p>f j ( x , v , t ; ϕ ) = e C j ( τ ; ϕ ) + D j ( τ ; ϕ ) v θ + i ϕ x ，</p><p>C j ( τ ; ϕ ) = r i ϕ τ + 2 α − 1 4 α h j ( τ , ϕ ) ，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x257_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x258_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>d j = 2 α ( b j + λ 2 + i ϕ ρ σ ) 2 − σ 2 ( 2 u j i ϕ − ϕ 2 ) ，</p><p>g j = 2 α ( b j + λ 2 + i ϕ ρ σ ) − d j 2 α ( b j + λ 2 + i ϕ ρ σ ) + d j ，</p><p>u j = ( − 1 2 ) j − 1 ，</p><p>b j = ρ σ ( 2 − j ) ， j = 1 , 2 。</p></sec><sec id="s7"><title>5. 数值计算实例</title><p>为了说明本文提出模型的可行性和有效性，以上证50ETF看涨期权2015至2018年四年的历史数据为例(数据来自wind数据库)，将本文提出的改进Heston模型与Heston模型隐含波动率进行比较。主要采用计算软件Matlab2018b和Stata14，根据这四年上证50ETF看涨期权的历史数据，采用文献 [<xref ref-type="bibr" rid="hanspub.34018-ref18">18</xref>] 中参数估计方法MLE，分别得到模型的参数取值如下表1。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Parameters of SV mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >参数</th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x264_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x265_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" >v 0</th><th align="center" valign="middle" >α</th><th align="center" valign="middle" >λ 1</th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x269_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x270_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x271_hanspub.png" xlink:type="simple"/></inline-formula></th></tr></thead><tr><td align="center" valign="middle" >本文SV</td><td align="center" valign="middle" >0.7224</td><td align="center" valign="middle" >−0.7082</td><td align="center" valign="middle" >0.0218</td><td align="center" valign="middle" >0.6911</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0.2637</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >Heston</td><td align="center" valign="middle" >0.8775</td><td align="center" valign="middle" >−0.6916</td><td align="center" valign="middle" >0.0198</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >7.5539</td><td align="center" valign="middle" >0.0510</td></tr></tbody></table></table-wrap><p>表1. SV模型的参数</p><p>选取2015至2018年上证50ETF看涨期权中最常见的到期日(27天、77天、127天、177天)在不同执行价格的数据，分别计算其市场隐含波动率、Heston模型隐含波动率和改进Heston模型隐含波动率，并绘制图1。</p><p>图1. 上证50ETF欧式看涨期权隐含波动率图</p><p>其中图1(a)为上证50ETF欧式看涨期权初始时间2016年5月19日，股票指数开盘价<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x273_hanspub.png" xlink:type="simple"/></inline-formula>，到期日27天的欧式看涨期权相应的隐含波动率情况；图1(b)为初始时间2015年6月17日，上证50ETF开盘价 S 0 = 2.107 ，到期日77天的欧式看涨期权相应的隐含波动率情况；图1(c)为初始时间2017年8月16日，上证50ETF开盘价<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2621117x275_hanspub.png" xlink:type="simple"/></inline-formula>，到期日127天的欧式看涨期权相应的隐含波动率情况；图1(d)为初始时间2018年12月24日，上证50ETF开盘价 S 0 = 2.289 ，到期日177天的欧式看涨期权相应的隐含波动率情况。从拟合情况来看，各种不同到期日下改进Heston模型都比Heston模型有更好的拟合效果。</p></sec><sec id="s8"><title>6. 结论</title><p>传统的Heston模型与stein-stein模型中有一些常数性假设，本文假设这些常数为可变参数得到改进的Heston模型。首先利用∆-对冲原理构造无风险资产，给出了该模型下期权价格满足的PDE方程；其次对模型参数进行了一些合理限制，并对限制条件加以证明，利用反演定理得到期权价格的封闭式解，说明该模型具有分析可处理性，并得出当参数取一定值时，Heston模型与stein-stein模型是该模型的一种特例。最后以上证50ETF看涨期权2015年至2018年四年的历史数据为例，对比了该模型与Heston模型对市场隐含波动率的拟合情况，得到该模型比Heston模型有更好的拟合效果。</p></sec><sec id="s9"><title>基金项目</title><p>广西重点研发计划项目(桂科AB17292095)；广西研究生教育创新计划项目。</p></sec><sec id="s10"><title>文章引用</title><p>江 倩. 基于改进Heston模型的欧式期权定价European Option Pricing Based on Improved Heston Model[J]. 应用数学进展, 2020, 09(01): 120-132. https://doi.org/10.12677/AAM.2020.91015</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.34018-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Bachelier, L. (1900) Théorie de la Spéculation. Annales scientifiques de l’École Normale Supérieure, 17, 21-86.  
https://doi.org/10.24033/asens.476</mixed-citation></ref><ref id="hanspub.34018-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Samuelson, P. (1965) Proof That Properly Anticipated Prices Fluctuate Randomly. Industrial Management Review, 6, 41-50.</mixed-citation></ref><ref id="hanspub.34018-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Black, F. and Scholes, M. (1973) The Pricing of Options and Corporate Liabilities. Journal of Political Economy, 81, 637-659.</mixed-citation></ref><ref id="hanspub.34018-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">黄文礼. 基于分数布朗运动模型的金融衍生品定价[D]: [博士学位论文]. 杭州: 浙江大学, 2011.</mixed-citation></ref><ref id="hanspub.34018-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Fama, E.F. (1965) The Behavior of Stock Market Prices. Journal of Business, 38, 34-105.  
https://doi.org/10.1086/294743</mixed-citation></ref><ref id="hanspub.34018-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">吴鑫育, 李心丹, 马超群. 基于随机波动率模型的上证50ETF期权定价研究[J]. 数理统计与管理, 2019, 38(1): 115-131.</mixed-citation></ref><ref id="hanspub.34018-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Johnson, H. and Shanno, D. (1987) Option Pricing When the Variance Is Changing. Journal of Financial and Quantitative Analysis, 22, 143-151. https://doi.org/10.2307/2330709</mixed-citation></ref><ref id="hanspub.34018-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Scott, L.O. (1987) Option Pricing When the Variance Changes Randomly: Theory, Estimation, and an Application. Journal of Financial and Quantitative Analysis, 22, 419-438. https://doi.org/10.2307/2330793</mixed-citation></ref><ref id="hanspub.34018-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Wiggins, B. (1987) Option Values under Stochastic Volatility: Theory and Empirical Estimates. Journal of Financial Economics, 19, 351-372. https://doi.org/10.1016/0304-405X(87)90009-2</mixed-citation></ref><ref id="hanspub.34018-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Hull, J. and White, A. (1987) The Pricing of Options on Assets with Stochastic Volatilities. The Journal of Finance, 42, 281-300. https://doi.org/10.1111/j.1540-6261.1987.tb02568.x</mixed-citation></ref><ref id="hanspub.34018-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Stein, E.M. and Stein, J.C. (1991) Stock Price Distributions with Stochastic Volatility: An Analytical Approach. Review of Financial Studies, 4, 727-752. https://doi.org/10.1093/rfs/4.4.727</mixed-citation></ref><ref id="hanspub.34018-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Heston, S.L. (1993) A Closed-Form Solution for Options with Stochastic Volatility with Applications to Bond and Currency Options. The Review of Financial Studies, 6, 327-343. https://doi.org/10.1093/rfs/6.2.327</mixed-citation></ref><ref id="hanspub.34018-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Li, C.X. (2016) Bessel Processes, Stochastic Volatility, and Timer Options. Mathematical Finance, 26, 122-148.  
https://doi.org/10.1111/mafi.12041</mixed-citation></ref><ref id="hanspub.34018-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">马俊美, 杨宇婷, 顾桂定, 徐承龙. 随机波动率模型下基于精确模拟算法的期权计算理论[J]. 同济大学学报(自然科学版), 2017, 45(10): 1539-1548.</mixed-citation></ref><ref id="hanspub.34018-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Hong, H., Bian, Z. and Chen, N. (2019) Leverage Effect on Stochastic Volatility for Option Pricing in Hong Kong: A Simulation and Empirical Study. The North American Journal of Economics and Finance, 2, 112-123.  
https://doi.org/10.1016/j.najef.2019.02.003</mixed-citation></ref><ref id="hanspub.34018-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">谢超强, 吕文元, 陈进. 基于Heston随机波动率模型和风险偏好视角的资产负债管理[J]. 运筹与管理, 2018, 27(6): 156-161.</mixed-citation></ref><ref id="hanspub.34018-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Soleymani, F. and Barfeie, M. (2019) Pricing Options under Stochastic Volatility Jump Model: A Stable Adaptive Scheme. Applied Numerical Mathematics, 145, 69-89. https://doi.org/10.1016/j.apnum.2019.05.027</mixed-citation></ref><ref id="hanspub.34018-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Rouah, F.D. (2013) The Heston Model and Its Extensions in Matlab and C. Wiley, Hoboken, 6-55.  
https://doi.org/10.1002/9781118656471</mixed-citation></ref><ref id="hanspub.34018-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Shreve, S. (2004) Stochastic Calculus for Finance II. Springer Finance, Springer-Verlag, New York.  
https://doi.org/10.1007/978-1-4757-4296-1</mixed-citation></ref><ref id="hanspub.34018-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Gil-Pelaez, J. (1951) Note on the Inversion Theorem. Biometrika, 37, 481-482.  
https://doi.org/10.1093/biomet/38.3-4.481</mixed-citation></ref></ref-list></back></article>