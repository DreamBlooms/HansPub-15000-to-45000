<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JAST</journal-id><journal-title-group><journal-title>Journal of Aerospace Science and Technology</journal-title></journal-title-group><issn pub-type="epub">2330-474X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JAST.2016.43007</article-id><article-id pub-id-type="publisher-id">JAST-18481</article-id><article-categories><subj-group subj-group-type="heading"><subject>JAST20160300000_47378990.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject><subject> 工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于两步Kalman滤波的GNSS分布式自主定轨方法
  An Autonomous Orbit Determination Method for Distributed GNSS Based on Two-Step Kalman Filter
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>冬霞</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>辛</surname><given-names>洁</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>娜</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>谭</surname><given-names>红力</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>傅</surname><given-names>嘉政</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>北京卫星导航中心，北京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>wdx2008abc@163.com(王冬)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>05</day><month>09</month><year>2016</year></pub-date><volume>04</volume><issue>03</issue><fpage>49</fpage><lpage>59</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文提出一种基于两步Kalman滤波的GNSS分布式自主导航定轨方法。首先，给出分布式自主定轨数据流程，建立并分析GNSS导航星座星间链路双向伪距测量模型。其次，采用单点定位法计算待估卫星位置及其协方差，以此作为伪观测量，采用两步Kalman滤波法处理卫星计算轨道参数改正数，并进行时间更新。另外，针对自主定轨存在的秩亏问题，利用卫星预报星历中轨道定向参数控制星座整体旋转，给出卫星真实轨道的最佳估值。仿真结果验证了该方法的有效可行性。 This article presents an autonomous orbit determination method for distributed GNSS based on two-step Kalman filter. Firstly, the paper gives the distributed autonomous orbit data process, and then builds the bidirectional pseudo-range measurement model for ISLs of GNSS navigation constellation. Secondly, the single point positioning method is adopted to obtain the position and covariance of satellite, which are the pseudo-observations to calculate the orbit correction parameters by the two-step Kalman filter. According to the problem of rank deficiency of autonomous orbit determination problem, the paper gets rid of the unobservable rotation of constellation by constraining orientation of prediction orbit, and then gives the best estimated value of the satellite orbit. The simulation and analysis results illustrate the availability of the scheme.
    
  
 
</p></abstract><kwd-group><kwd>星间链路，两步Kalman滤波，分布式，自主定轨, Inter-Satellite Links</kwd><kwd> Two-Step Kalman Filter</kwd><kwd> Distributed</kwd><kwd> Autonomous Orbit Determination</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于两步Kalman滤波的GNSS分布式自主定轨方法<sup> </sup></title><p>王冬霞，辛洁，赵娜，谭红力，傅嘉政</p><p>北京卫星导航中心，北京</p><disp-formula id="hanspub.18481-formula101"><graphic xlink:href="http://html.hanspub.org/file/1-2980051x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年8月15日；录用日期：2016年9月2日；发布日期：2016年9月5日</p><disp-formula id="hanspub.18481-formula102"><graphic xlink:href="http://html.hanspub.org/file/1-2980051x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文提出一种基于两步Kalman滤波的GNSS分布式自主导航定轨方法。首先，给出分布式自主定轨数据流程，建立并分析GNSS导航星座星间链路双向伪距测量模型。其次，采用单点定位法计算待估卫星位置及其协方差，以此作为伪观测量，采用两步Kalman滤波法处理卫星计算轨道参数改正数，并进行时间更新。另外，针对自主定轨存在的秩亏问题，利用卫星预报星历中轨道定向参数控制星座整体旋转，给出卫星真实轨道的最佳估值。仿真结果验证了该方法的有效可行性。</p><p>关键词 :星间链路，两步Kalman滤波，分布式，自主定轨</p><disp-formula id="hanspub.18481-formula103"><graphic xlink:href="http://html.hanspub.org/file/1-2980051x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>GNSS (Global Navigation Satellite System，全球卫星导航系统)作为一种重要的战略性空间资源，其应用已经广泛渗入到国防和国民经济建设的各个领域，成为保障国家安全、促进经济和社会发展的重要基础设施。</p><p>星间链路技术是实现GNSS自主导航的一项关键技术，其主要目的是进行高精度卫星星历和钟差估计，进而提供高精度PNT (Positioning Navigation and Timing，定位、导航与授时)服务。星间链路自主定轨是指导航系统在没有地面运行控制系统支持条件下，利用星间测距及星间通讯维持导航系统星历的自主更新。目前针对GNSS星间链路自主定轨的研究大致有三个方面：GPS卫星的自主定轨研究、自主定轨秩亏问题、自主定轨的数学仿真和模拟等。</p><p>美国最早提出卫星自主定轨的概念。1984年Ananda利用GPS (Global Positioning System，全球定位系统)星间观测提出了卫星自主定轨的基本框架 [<xref ref-type="bibr" rid="hanspub.18481-ref1">1</xref>] 。随后Codik对GPS自主导航的可行性进行了初步探讨 [<xref ref-type="bibr" rid="hanspub.18481-ref2">2</xref>] 。接下来，IBM公司受美国空军航天部委托，对自主定轨系统算法进行了研究，至1990年6月，基本完成了自主定轨的理论、设计和数据模拟等工作 [<xref ref-type="bibr" rid="hanspub.18481-ref3">3</xref>] 。随着美国现代化武器装备依赖GPS的程度日益增高，一些学者针对GPS Block IIR [<xref ref-type="bibr" rid="hanspub.18481-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.18481-ref5">5</xref>] 、Block IIF [<xref ref-type="bibr" rid="hanspub.18481-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.18481-ref7">7</xref>] 、Block III [<xref ref-type="bibr" rid="hanspub.18481-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.18481-ref9">9</xref>] 卫星展开了一系列循序渐进的研究，保证了GPS系统的高精度自主定轨。</p><p>Ananda在研究GPS自主定轨时提出，自主定轨是秩亏的，即由于星间测距本质是相对测量，自主定轨存在星座整体旋转的问题 [<xref ref-type="bibr" rid="hanspub.18481-ref3">3</xref>] 。刘迎春从理论上证明了星座整体旋转的不可观性使得缺少方向基准信息，从而使法方程组系数矩阵出现秩亏 [<xref ref-type="bibr" rid="hanspub.18481-ref10">10</xref>] 。截至目前，解决该问题的方法大致分为两种：一种是通过约束轨道定向参数来控制星座整体旋转 [<xref ref-type="bibr" rid="hanspub.18481-ref11">11</xref>] - [<xref ref-type="bibr" rid="hanspub.18481-ref13">13</xref>] ；另一种是引入锚固站作为自主定轨系统的空间基准以控制星座整体旋转，同时还能提高自主定位精度 [<xref ref-type="bibr" rid="hanspub.18481-ref14">14</xref>] - [<xref ref-type="bibr" rid="hanspub.18481-ref16">16</xref>] 。</p><p>对于自主定轨的数学仿真和模拟，主要包括对新算法、评价指标、模拟平台等的仿真。宋小勇利用仿真数据验证了分布式自主定轨的两步卡尔曼滤波算法和SRIF算法(square root information filter，均方根信息滤波算法)，研究了分布式自主星历更新问题 [<xref ref-type="bibr" rid="hanspub.18481-ref17">17</xref>] 。Eissfeller仿真得出星间测距可以明显改善卫星轨道的沿迹向和法向精度，当测距精度在厘米级时，卫星自主定轨精度优于0.1 m [<xref ref-type="bibr" rid="hanspub.18481-ref18">18</xref>] 。曾旭平建立了导航卫星自主定轨的模拟研究平台，并提出了自适应静态逐次滤波方法，该方法能有效克服自主定轨模型误差及方程的线性化误差 [<xref ref-type="bibr" rid="hanspub.18481-ref19">19</xref>] 。</p><p>综上所述，国内外在基于星间链路的自主定轨方面已经取得了大量有价值成果，美国GPS自主定轨也已投入运行。但是，大多数研究结果多限于部分关键技术及其解决方法的研究，还没有用于工程实现的自主定轨完整解决思路。基于此，本文系统地研究星间链路自主定轨问题。</p></sec><sec id="s4"><title>2. 自主定轨数据流程</title><p>基于星间链路的自主定轨由数据通讯、数据预处理、残差生成、Kalman滤波、星座旋转改正、星历拟合等部分组成。数据流程如图1所示，各模块功能如下：</p><p>数据通讯部分主要完成星间观测数据、卫星星历及协方差信息、卫星轨道面定向参数的交互收发等。本文主要指星间双向伪距。</p><p>数据预处理部分在测距帧后完成，主要完成粗差剔除、卫星观测时间归算、测距观测量误差改正及测量硬件时延改正等。</p><p>残差生成过程主要完成电离层改正、相对论改正、星间距理论值计算及星间测距数据与星间时间同步数据的解耦。通过残差分析可对观测量的数据质量进行检核。残差生成过程输入量为经过星间通讯获取的预处理后星间观测数据、上次定轨预报生成的轨道参数改正数以及由地面运控系统上载的参考轨道。输出为观测量与理论值之差。</p><p>Kalman滤波主要利用观测量及其主要误差来进行测量更新，产生改进轨道参数，重新拟合生成星历和时钟参数。</p><p>星座整体旋转改正部分主要利用轨道改进获得的每颗卫星轨道升交点经度及轨道倾角改正数计算星座整体旋转改正量，并用改正量对卫星轨道定向参数进行改进。</p><p>经过上述自主定轨流程，最终生成新的广播星历和时钟信息，用于下一个观测历元。</p><p>对于导航卫星来说，星历预报精度是系统最主要的技术指标。动力学定轨方法便于轨道预报，是导</p><p>图1. 自主定轨流程图</p><p>航卫星自主定轨的较好选择。星间链路自主定轨首先需要构建星间测距观测方程，然后依据动力学方程对应的变分方程计算卫星状态转移矩阵，最后采用Kalman滤波完成参数更新及时间更新，考虑星座整体旋转误差改正后，生成下一个观测历元的星历和时钟信息。估计参数可为卫星状态参数或轨道根数。</p></sec><sec id="s5"><title>3. 算法描述</title><sec id="s5_1"><title>3.1. 数学模型</title><sec id="s5_1_1"><title>3.1.1. 星间链路双向伪距测量模型</title><p>基于星间链路的卫星自主运行基本观测量为星间测距观测量，星间测距观测有多种方式，如星间激光测距、星间伪距测量、星间载波相位测量及星间多普勒测量等。我们以星间伪距测量为例，建立星间测量方程。</p><p>考虑星间时间同步误差时，星间伪距测量方程简写如下：</p><disp-formula id="hanspub.18481-formula104"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x11_hanspub.png" xlink:type="simple"/></inline-formula>为观测时刻卫星i接收到卫星j的伪距观测量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x12_hanspub.png" xlink:type="simple"/></inline-formula>为卫星i与j的理论星间距，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x13_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x14_hanspub.png" xlink:type="simple"/></inline-formula>分别为卫星i与j钟差，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x15_hanspub.png" xlink:type="simple"/></inline-formula>为卫星i接收端时延，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x16_hanspub.png" xlink:type="simple"/></inline-formula>为卫星j发射端时延，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x17_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x18_hanspub.png" xlink:type="simple"/></inline-formula>分别是由于温度变化引起的发射及接收端噪声时延，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x19_hanspub.png" xlink:type="simple"/></inline-formula>为电离层时延，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x20_hanspub.png" xlink:type="simple"/></inline-formula>为相对论效应，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x21_hanspub.png" xlink:type="simple"/></inline-formula>为多路径效应，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x22_hanspub.png" xlink:type="simple"/></inline-formula>为测量随机误差。</p><p>对星间伪距观测量进行收发时延改正、双频电离层改正、相对论改正以及多路径改正后，卫星i与j的星间双向伪距测量方程可简写为：</p><disp-formula id="hanspub.18481-formula105"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x23_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18481-formula106"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x24_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x25_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x26_hanspub.png" xlink:type="simple"/></inline-formula>均为卫星i、j的理论星间距，表达式为：</p><disp-formula id="hanspub.18481-formula107"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x27_hanspub.png"  xlink:type="simple"/></disp-formula><p>为了消除卫星钟差对定轨的影响，采用双向伪距测量法进行消除。将式(2)和(3)相加，并用参考轨道线性化，得到不含卫星钟差的线性观测方程：</p><disp-formula id="hanspub.18481-formula108"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x28_hanspub.png"  xlink:type="simple"/></disp-formula><p>上式中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x29_hanspub.png" xlink:type="simple"/></inline-formula>为利用参考轨道计算的近似星间距，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x30_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x31_hanspub.png" xlink:type="simple"/></inline-formula>分别为卫星位置相对参考轨道改正量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x32_hanspub.png" xlink:type="simple"/></inline-formula>为星间距单位向量，其形式为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x33_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>当采用轨道根数作为估计参数时，方程(5)可写为：</p><disp-formula id="hanspub.18481-formula109"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x34_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x35_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x36_hanspub.png" xlink:type="simple"/></inline-formula>为六个轨道根数相对参考轨道改正数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x37_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x38_hanspub.png" xlink:type="simple"/></inline-formula>为观测量对轨道根数偏导数，与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x39_hanspub.png" xlink:type="simple"/></inline-formula>之间关系为：</p><disp-formula id="hanspub.18481-formula110"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x40_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x41_hanspub.png" xlink:type="simple"/></inline-formula>为卫星i的位置矢量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x42_hanspub.png" xlink:type="simple"/></inline-formula>对轨道根数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x43_hanspub.png" xlink:type="simple"/></inline-formula>的偏导数，表达式如下：</p><disp-formula id="hanspub.18481-formula111"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x44_hanspub.png"  xlink:type="simple"/></disp-formula><p>上式6个元素的表达式 [<xref ref-type="bibr" rid="hanspub.18481-ref20">20</xref>] 如下：</p><disp-formula id="hanspub.18481-formula112"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x45_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x46_hanspub.png" xlink:type="simple"/></inline-formula>为轨道根数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x47_hanspub.png" xlink:type="simple"/></inline-formula>及参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x48_hanspub.png" xlink:type="simple"/></inline-formula>的函数，详细见文献 [<xref ref-type="bibr" rid="hanspub.18481-ref20">20</xref>] 。</p></sec><sec id="s5_1_2"><title>3.1.2. 轨道动力学模型</title><p>考虑地球的非球形引力摄动，则卫星轨道动力学模型 [<xref ref-type="bibr" rid="hanspub.18481-ref20">20</xref>] 表示如下：</p><disp-formula id="hanspub.18481-formula113"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x49_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x50_hanspub.png" xlink:type="simple"/></inline-formula>表示卫星i的位置矢量长度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x51_hanspub.png" xlink:type="simple"/></inline-formula>表示卫星在惯性系下的位置和速度分量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x52_hanspub.png" xlink:type="simple"/></inline-formula>为地球引力常数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x53_hanspub.png" xlink:type="simple"/></inline-formula>为二阶带谐项系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x54_hanspub.png" xlink:type="simple"/></inline-formula>为地球赤道半径，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x55_hanspub.png" xlink:type="simple"/></inline-formula>表示卫星<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x56_hanspub.png" xlink:type="simple"/></inline-formula>项之外的摄动加速度，主要为模型噪声。</p></sec></sec><sec id="s5_2"><title>3.2. 两步Kalman滤波法</title><p>利用星间伪距进行分布式定轨实质上是将卫星预报轨道作为参考点，利用星间伪距进行定轨的过程。对卫星i及其可视卫星j的星间伪距测量方程(6)变形，得到分布式星间伪距测量方程如下：</p><disp-formula id="hanspub.18481-formula114"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x57_hanspub.png"  xlink:type="simple"/></disp-formula><p>研究表明，用直接Kalman滤波算法进行自主定轨解算时，当观测量有粗差或部分卫星轨道变轨造成观测量异常时，异常观测量不易检测分离。为此采用两步处理法。第一步，利用单点定位方法计算待估卫星位置及其协方差；第二步，以计算的卫星位置及协方差信息作为伪观测量采用Kalman滤波算法处理。星间伪距测量方程(11)可写为：</p><disp-formula id="hanspub.18481-formula115"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x58_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x59_hanspub.png" xlink:type="simple"/></inline-formula>为观测量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x60_hanspub.png" xlink:type="simple"/></inline-formula>为卫星位置向量改正数，顾及观测量协方差，利用加权最小二乘原理可计算出卫星位置改正数及协方差如下：</p><disp-formula id="hanspub.18481-formula116"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x61_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18481-formula117"><label>(14)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x62_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x63_hanspub.png" xlink:type="simple"/></inline-formula>为观测权矩阵，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x64_hanspub.png" xlink:type="simple"/></inline-formula>为单位权中误差。</p><p>将轨道动力学模型(10)在参考轨道附近线性化，并将高阶项误差用随机过程噪声表示，可得到线性化状态转移方程：</p><disp-formula id="hanspub.18481-formula118"><label>(15)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x65_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x66_hanspub.png" xlink:type="simple"/></inline-formula>为扩增状态转移矩阵，定义为：</p><disp-formula id="hanspub.18481-formula119"><label>(16)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x67_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x68_hanspub.png" xlink:type="simple"/></inline-formula>为状态转移矩阵，初值为单位矩阵；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x69_hanspub.png" xlink:type="simple"/></inline-formula>为卫星状态参数对动力学参数偏导数，初值为零；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x70_hanspub.png" xlink:type="simple"/></inline-formula>为动力学噪声向量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x71_hanspub.png" xlink:type="simple"/></inline-formula>；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x72_hanspub.png" xlink:type="simple"/></inline-formula>为噪声系数矩阵；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x73_hanspub.png" xlink:type="simple"/></inline-formula>为单位矩阵。</p><p>将卫星位置改正数及协方差作为伪观测量，根据最小方差原理，可得到Kalman滤波解算公式如下：</p><disp-formula id="hanspub.18481-formula120"><label>(17)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x74_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18481-formula121"><label>(18)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x75_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18481-formula122"><label>(19)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x76_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18481-formula123"><label>(20)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x77_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18481-formula124"><label>(21)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x78_hanspub.png"  xlink:type="simple"/></disp-formula><p>采用Kalman滤波算法可逐卫星计算轨道参数改正数并进行时间更新。</p></sec><sec id="s5_3"><title>3.3. 星座整体旋转改正</title><p>独立采用星间测距作为定轨观测量时，由于星间测距本质上是相对测量，自主定轨是秩亏的。直观理解为：如果将导航系统整体旋转任意角度并不改变导航系统性能。因此基于星间测距的自主定轨需要约束星座整体旋转。本文针对自主定轨存在的秩亏问题，利用卫星预报星历中轨道定向参数(预报轨道的升交点经度和轨道倾角)约束星座整体旋转，给出卫星真实轨道的最佳估值。具体方法为：首先，估计卫星的六个轨道根数；然后，约束轨道倾角和升交点经度。</p><p>假设在某一历元，星间伪距测量能够确定n个卫星的定向参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x79_hanspub.png" xlink:type="simple"/></inline-formula>的改正数V，其中V为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x80_hanspub.png" xlink:type="simple"/></inline-formula>向量。由于星间伪距测量是相对量，对星座整体旋转无影响，因此将星座分别沿x，y，z坐标轴旋转<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x81_hanspub.png" xlink:type="simple"/></inline-formula>。按照文献 [<xref ref-type="bibr" rid="hanspub.18481-ref17">17</xref>] 推导的坐标系整体旋转与轨道面定向参数间的微分关系，轨道定向参数的改正数即为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x82_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x83_hanspub.png" xlink:type="simple"/></inline-formula>为n个<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x84_hanspub.png" xlink:type="simple"/></inline-formula>矩阵，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x85_hanspub.png" xlink:type="simple"/></inline-formula>三分量为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x86_hanspub.png" xlink:type="simple"/></inline-formula>。为保证V接近真值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x87_hanspub.png" xlink:type="simple"/></inline-formula>需要选择合理。文献 [<xref ref-type="bibr" rid="hanspub.18481-ref17">17</xref>] 研究得出，卫星预报计算的i、Ω与真值之间的误差可控，因此<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x88_hanspub.png" xlink:type="simple"/></inline-formula>应满足：</p><disp-formula id="hanspub.18481-formula125"><label>(22)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x89_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据最小二乘理论，可计算得出：</p><disp-formula id="hanspub.18481-formula126"><label>(23)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x90_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x91_hanspub.png" xlink:type="simple"/></inline-formula>为先验权阵，Menn [<xref ref-type="bibr" rid="hanspub.18481-ref11">11</xref>] 从控制参考轨道初始误差传播方面考虑，建议<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x92_hanspub.png" xlink:type="simple"/></inline-formula>按照卫星上载的参考轨道误差取值。利用上式<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x93_hanspub.png" xlink:type="simple"/></inline-formula>可计算出新卫星轨道定向参数改正数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2980051x94_hanspub.png" xlink:type="simple"/></inline-formula>。其对应的约束方程为：</p><disp-formula id="hanspub.18481-formula127"><label>(24)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x95_hanspub.png"  xlink:type="simple"/></disp-formula><p>当仅需要约束轨道面定向参数i、Ω时，可将权阵W中此分量对应值设为1，其余设为0。</p></sec></sec><sec id="s6"><title>4. 算法仿真</title><p>根据国际卫星导航服务组织公开的真实GPS系统星历，对本文设计的自主定轨方法进行仿真验证。利用用户伪距误差(URE) [<xref ref-type="bibr" rid="hanspub.18481-ref1">1</xref>] 分析在自主定轨180天的精度，它近似表示为：</p><disp-formula id="hanspub.18481-formula128"><label>(25)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2980051x96_hanspub.png"  xlink:type="simple"/></disp-formula><p>式(25)中，R表示卫星的径向误差，T表示卫星的切向误差，N表示卫星的法向误差。</p><p>考虑卫星全部状态量均参与滤波和定向参数i、Ω不参与滤波两种情况进行仿真。</p><sec id="s6_1"><title>4.1. 状态量均参与滤波时的定轨结果</title><p>仿真条件设定为星座中卫星全部状态量均参与滤波，即所有卫星的轨道根数均参与滤波，仿真结果如图2~图5所示。</p><p>由图2~图5可以看出，在180天的定轨弧段内，径向误差始终保持较高的精度，基本上保持在0.4m范围内，而法向、切向误差随时间增长较快，相应URE小于3.5 m。</p><p>为了更清晰地反映定轨精度，对卫星PRN30自主定轨结果的URE进行了统计，URE均方误差为0.7028 m，最大偏差为3.0852 m，平均偏差为1.4752 m。</p></sec><sec id="s6_2"><title>4.2. 约束定向参数时的定轨结果</title><p>通过约束PRN30的定向参数 来进行仿真实验，即：定向参数i、Ω不参与滤波，估计值直接引用轨道预报的先验值，其它仿真条件同状态量均参与滤波时完全一致，仿真结果如图6~图9所示。</p><p>通过对比图2~图5和图6~图9，可以看出，定向参数i、Ω被约束后，径向误差保持在0.6左右，法向误差由15 m降至10 m，切向误差由25 m降至20 m，用户伪距误差由3.5 m降至3 m。说明定向参数约束</p><p>图2. 径向误差</p><p>图3. 法向误差</p><p>图4. 切向误差</p><p>图5. 用户伪距误差</p><p>后，定轨精度变高。</p><p>另外，我们统计了两种情况下PRN30的URE结果，如表1所示。</p><p>由表1可以看出，与状态量均参与滤波时相比，约束定向参数i、Ω后，卫星PRN30的定轨精度有</p><p>图6. 径向误差</p><p>图7. 法向误差</p><p>图8. 切向误差</p><p>所提高，URE均方误差提高了0.0682 m，最大偏差提高了0.2095 m，平均偏差提高了0.1558 m。进一步说明利用预报定向参数i、Ω对轨道计算结果进行约束可以控制星座整体旋转，从而验证了本文所提算法的有效性。</p><p>图9. 用户伪距误差</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> URE of all orbital elements in filtering compared with URE of constraint orientation parameters i, </title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >仿真情况</th><th align="center" valign="middle"  colspan="3"  >技术指标URE (m)</th></tr></thead><tr><td align="center" valign="middle" >均方误差</td><td align="center" valign="middle" >最大偏差</td><td align="center" valign="middle" >平均偏差</td></tr><tr><td align="center" valign="middle" >均参与滤波时</td><td align="center" valign="middle" >0.7028</td><td align="center" valign="middle" >3.0852</td><td align="center" valign="middle" >1.4752</td></tr><tr><td align="center" valign="middle" >约束i、Ω时</td><td align="center" valign="middle" >0.6346</td><td align="center" valign="middle" >2.8757</td><td align="center" valign="middle" >1.3194</td></tr><tr><td align="center" valign="middle" >两种结果之差</td><td align="center" valign="middle" >0.0682</td><td align="center" valign="middle" >0.2095</td><td align="center" valign="middle" >0.1558</td></tr></tbody></table></table-wrap><p>表1. 状态量均参与滤波时与约束定向参数i，Ω时的URE比较结果</p></sec></sec><sec id="s7"><title>5. 结论</title><p>本文系统地研究了GNSS星间链路自主定轨问题，给出自主定轨数据流程，根据星间伪距测量模型设计一种两步Kalman滤波法，探讨星座整体旋转限制条件，并通过仿真验证了本文设计的自主定轨方法的有效可行性。</p></sec><sec id="s8"><title>基金项目</title><p>国家高技术研究发展计划(“863”计划) (批准号：2013AA122401)资助项目，国家自然科学基金项目(批准号：61603397)。</p></sec><sec id="s9"><title>文章引用</title><p>王冬霞,辛 洁,赵 娜,谭红力,傅嘉政. 基于两步Kalman滤波的GNSS分布式自主定轨方法 An Autonomous Orbit Determination Method for Distributed GNSS Based on Two-Step Kalman Filter[J]. 国际航空航天科学, 2016, 04(03): 49-59. http://dx.doi.org/10.12677/JAST.2016.43007</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.18481-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Ananda, M.P., Berstein, H., Bruce, R.W., et al. (1984) Autonomous Navigation of the Global Positioning System Satellite. AIAA Guidance and Control Conference, Seattle, 20-22 August 1984, 321-327.</mixed-citation></ref><ref id="hanspub.18481-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Codik, A. (1985) Autonomous Navigation of GPS Satellites—A Challenge for the Future. Proceedings of the ION 59th Annual Meeting, 32, 67-70.</mixed-citation></ref><ref id="hanspub.18481-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Ananda, M.P., Bernstein, H., Cunninggham, W.A., et al. (1990) Global Positioning System (GPS) Autonomous Navigation. IEEE Position Location &amp; Navigation Symposium, 27, 497-508. &lt;br&gt;http://dx.doi.org/10.1109/PLANS.1990.66220</mixed-citation></ref><ref id="hanspub.18481-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Fliegel, H.F. and Gallini, T.E. (1996) Solar Force Modeling of Block IIR Global Positioning System Satellites. Journal of Spacecraft and Rockets, 33, 863-866. &lt;br&gt;http://dx.doi.org/10.2514/3.26851</mixed-citation></ref><ref id="hanspub.18481-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Rajan, J.A. (2003) On-Orbit Validation of GPS IIR Autonomous Navigation. Proceedings of the ION 59th Annual Meeting, Albuquerque, 9-12 September 2003, 411-419.</mixed-citation></ref><ref id="hanspub.18481-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Ghassemiand, K. and Fisher, S.C. (1999) GPS IIF—The Next Generation. Proceedings of the IEEE, 87, 24-47.</mixed-citation></ref><ref id="hanspub.18481-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Balbach, O., Eissfeller, B. and Hein, G.W. (1999) GPS Navigation of Geostationary Satellites Using GPS Block IIF Space Pointing Antennas. IONGPS’99, 14-17 September 1999, Nashville, 2335-2339.</mixed-citation></ref><ref id="hanspub.18481-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Podlesney, D. (2009) GPS III Space Segment. Official US Government, Washington DC.</mixed-citation></ref><ref id="hanspub.18481-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Lazar, S. (2002) Satellite Navigation: Modernization and GPS III Crosslink. The Aerospace Corporation Magazine of Advance in Aerospace Technology, 22, 42-53.</mixed-citation></ref><ref id="hanspub.18481-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">刘迎春, 刘林, 王昌彬. 关于星–星跟踪的定轨问题[J]. 紫金山天文台台刊, 2000, 19(2): 117-120.</mixed-citation></ref><ref id="hanspub.18481-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Menn, M.D. and Berstein, H. (1994) Ephemeris Observability Issues in the Global Positioning System Autonomous Navigation. Proceedings of IEEE in Position Location &amp; Navigation Symposium, 1994, 677-680.</mixed-citation></ref><ref id="hanspub.18481-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">李博. 基于星间定向观测的导航星座长期自主定轨技术研究[D]: [硕士学位论文]. 南京: 南京航空航天大学, 2010.</mixed-citation></ref><ref id="hanspub.18481-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Abusali, P.A., Tapley, B.D. and Schutz, B.E. (1998) Autonomous Navigation of Global Positioning System Satellites Using Cross-Link Measurements. Journal of Guidance, Control, and Dynamics, 21, 321-327.  
&lt;br&gt;http://dx.doi.org/10.2514/2.4238</mixed-citation></ref><ref id="hanspub.18481-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">尚琳, 刘国华, 刘善伍, 等. 地面锚固站消除自主导航中星座旋转误差的性能评估[C]. 第三届中国卫星导航年会, 广州, 2012.</mixed-citation></ref><ref id="hanspub.18481-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">杨力, 郭飞霄, 文援兰, 等. 单锚固站辅助导航星座自主定轨分析[J]. 飞行器测控学报, 2013, 32(5): 444-448.</mixed-citation></ref><ref id="hanspub.18481-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">尚琳, 任前义, 张锐, 等. 利用锚固站时序差分测量消除星座旋转误差[J]. 武汉大学学报: 信息科学版, 2013, 38(8): 920-924.</mixed-citation></ref><ref id="hanspub.18481-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">宋小勇. COMPASS导航卫星定轨研究[D]: [博士学位论文]. 西安: 长安大学, 2009.</mixed-citation></ref><ref id="hanspub.18481-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Eissfeller, B., Zink, T. and Wolf, R. (2000) Autonomous Satellite State Determination by Use of Two-Directional Links. International Journal of Satellite Communications, 18, 325-346.  
&lt;br&gt;http://dx.doi.org/10.1002/1099-1247(200007/10)18:4/5&lt;325::AID-SAT680&gt;3.0.CO;2-8</mixed-citation></ref><ref id="hanspub.18481-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">曾旭平. 导航卫星自主定轨研究及模拟结果[D]:[ 博士学位论文]. 武汉: 武汉大学, 2004.</mixed-citation></ref><ref id="hanspub.18481-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">刘林. 航天器轨道理论[M]. 北京: 国防工业出版社, 2000.</mixed-citation></ref></ref-list></back></article>