<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JISP</journal-id><journal-title-group><journal-title>Journal of Image and Signal Processing</journal-title></journal-title-group><issn pub-type="epub">2325-6753</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JISP.2016.51003</article-id><article-id pub-id-type="publisher-id">JISP-16752</article-id><article-categories><subj-group subj-group-type="heading"><subject>JISP20160100000_76600563.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于改进熵率超像素和区域合并的岩屑图像分割
  Rock Image Segmentation Based on Improved Entropyrate Superpixel and Region Merging
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>杰</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>小强</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>熊</surname><given-names>淑华</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>亚静</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>何</surname><given-names>小海</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>四川大学电子信息学院，四川 成都</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>fullnamefull@163.com(吴小)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>01</day><month>12</month><year>2015</year></pub-date><volume>05</volume><issue>01</issue><fpage>16</fpage><lpage>24</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   岩屑颗粒的分割与提取在地质分析、矿物处理中起着关键的作用，是岩性识别和分析的基础。针对岩屑颗粒图像纹理、阴影、形状、边缘特征复杂的特点，本文提出一种改进熵率超像素分割和区域合并后续处理方法。熵率超像素算法提出具有紧凑性、区域一致性约束的目标函数，考虑岩屑颗粒的形状，对此目标函数加入基于镜面对称系数的几何对称性约束条件，用此目标函数对岩屑颗粒聚类超像素分割，使岩屑颗粒图像分割边缘定位更加准确。针对超像素过分割严重的特征，提出基于和差直方图的最大相似度合并算法，降低岩屑图像过分割率。实验结果表明，此算法用于岩屑的分割，比其他算法取得较好的分割结果。 Detection and segmentation of rocks plays an important role in many applications such as geological analysis and mining processes, and it is the foundation of the analysis and recognition. Rocks are usually segmented using a variety of features such as texture, shading, shape and edges. In this paper, an improved algorithm based on entropy rate superpixel and region merging is provided. The entropy rate superpixel segmentation algorithm proposes an objective function, which favors formation of compact and homogeneous clusters. Considering the shape of Rocks, the mirror sym- metry coefficient is integrated into the objective function. If rock images were then segmented by superpixel algorithms with this objective function, the results would adhere more accurately to rock boundaries. Furthermore, we propose an improved maximal similar region merging algorithm based on the sum and difference histograms for function reducing the over-segmentation. The experiment results show that applying this algorithm to rock images performs very well.
    
  
 
</p></abstract><kwd-group><kwd>岩屑图像，图像分割，熵率超像素，区域合并, Rock Image</kwd><kwd> Image Segmentation</kwd><kwd> Entropy Rate Superpixel</kwd><kwd> Region Merging</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于改进熵率超像素和区域合并的 岩屑图像分割<sup> </sup></title><p>李杰，吴小强<sup>*</sup>，熊淑华，王亚静，何小海</p><p>四川大学电子信息学院，四川 成都</p><disp-formula id="hanspub.16752-formula71"><graphic xlink:href="http://html.hanspub.org/file/3-2670065x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2015年12月26日；录用日期：2016年1月10日；发布日期：2016年1月13日</p><disp-formula id="hanspub.16752-formula72"><graphic xlink:href="http://html.hanspub.org/file/3-2670065x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>岩屑颗粒的分割与提取在地质分析、矿物处理中起着关键的作用，是岩性识别和分析的基础。针对岩屑颗粒图像纹理、阴影、形状、边缘特征复杂的特点，本文提出一种改进熵率超像素分割和区域合并后续处理方法。熵率超像素算法提出具有紧凑性、区域一致性约束的目标函数，考虑岩屑颗粒的形状，对此目标函数加入基于镜面对称系数的几何对称性约束条件，用此目标函数对岩屑颗粒聚类超像素分割，使岩屑颗粒图像分割边缘定位更加准确。针对超像素过分割严重的特征，提出基于和差直方图的最大相似度合并算法，降低岩屑图像过分割率。实验结果表明，此算法用于岩屑的分割，比其他算法取得较好的分割结果。</p><p>关键词 :岩屑图像，图像分割，熵率超像素，区域合并</p><disp-formula id="hanspub.16752-formula73"><graphic xlink:href="http://html.hanspub.org/file/3-2670065x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>在计算机视觉应用中，超像素具有减少算法复杂度的优点，常应用于图像处理的许多领域，如目标识别 [<xref ref-type="bibr" rid="hanspub.16752-ref1">1</xref>] 、图像分割 [<xref ref-type="bibr" rid="hanspub.16752-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.16752-ref3">3</xref>] 和3D重建 [<xref ref-type="bibr" rid="hanspub.16752-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.16752-ref5">5</xref>] 。目前国内外已有大量的超像素分割算法，大致可以分为基于图论的分割算法和基于梯度下降的超像素两类 [<xref ref-type="bibr" rid="hanspub.16752-ref6">6</xref>] ，代表性算法分别为Felzenswalb等人 [<xref ref-type="bibr" rid="hanspub.16752-ref7">7</xref>] 提出的FH算法和Vincent等人 [<xref ref-type="bibr" rid="hanspub.16752-ref8">8</xref>] 提出的分水岭(Water Sheds)算法，把这些算法应用在岩屑颗粒图像的分割上，尽管都有各自的优势特点，但很难同时保证在分割准确率和时间效率两个衡量图像分割优劣核心指标。王亚静等人 [<xref ref-type="bibr" rid="hanspub.16752-ref9">9</xref>] 采用熵率超像素分割算法 [<xref ref-type="bibr" rid="hanspub.16752-ref10">10</xref>] 对岩屑图像进行分割，取得了较好的分割效果。熵率超像素分割算法提出了包含两项的目标函数：1) 图上随机游走熵率，2) 平衡函数项，运用贪心算法迭代目标函数策略最大化目标函数。本文在分析熵率超像素算法图像分割基础上，对算法目标函数加入基于镜面对称系数的几何对称性约束条件,以改进熵率岩屑分割效果。该算法考虑岩屑颗粒形状信息，可得岩屑颗粒图像边缘附着性好、分割区域紧致、均匀的分割结果。最后，针对超像素分割过分割严重的问题，提出改进的最大相似度区域合并(MSRM)算法，以对岩屑颗粒分割图像后处理，改善最终分割结果。本文算法的主要框架如下图1。</p></sec><sec id="s4"><title>2. 改进熵率超像素分割</title><sec id="s4_1"><title>2.1. 熵率超像素分割</title><p>1) 熵率：熵率超像素分割结合数学基础、图论、随机游走模型和信息熵的理论，假设原图为加权的</p><p>图1. 算法框架</p><p>无向图<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x11_hanspub.png" xlink:type="simple"/></inline-formula>，原图像的像素为图的节点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x12_hanspub.png" xlink:type="simple"/></inline-formula>，相邻像素为图的边<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x13_hanspub.png" xlink:type="simple"/></inline-formula>，像素相似度为边权重<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x14_hanspub.png" xlink:type="simple"/></inline-formula>：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x15_hanspub.png" xlink:type="simple"/></inline-formula>，令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x16_hanspub.png" xlink:type="simple"/></inline-formula>为图<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x17_hanspub.png" xlink:type="simple"/></inline-formula>随机游走过程，采用文献 [<xref ref-type="bibr" rid="hanspub.16752-ref12">12</xref>] 随机游走模型，定义转移概率：</p><disp-formula id="hanspub.16752-formula74"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x18_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x19_hanspub.png" xlink:type="simple"/></inline-formula>表示节点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x20_hanspub.png" xlink:type="simple"/></inline-formula>相邻边权重之和。</p><p>定义静态分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x21_hanspub.png" xlink:type="simple"/></inline-formula>如下：</p><disp-formula id="hanspub.16752-formula75"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x22_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x23_hanspub.png" xlink:type="simple"/></inline-formula>为归一化常量。</p><p>对于图的划分，目标是使图相邻边聚集为子图<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x24_hanspub.png" xlink:type="simple"/></inline-formula>这样所得图<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x25_hanspub.png" xlink:type="simple"/></inline-formula>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x26_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x27_hanspub.png" xlink:type="simple"/></inline-formula>为划分子图数，也就是区域数目，为了获得区域一致性与紧致性的聚类区域，结合图理论，随机游走转移概率映射变换定义如下：</p><disp-formula id="hanspub.16752-formula76"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x28_hanspub.png"  xlink:type="simple"/></disp-formula><p>图<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x29_hanspub.png" xlink:type="simple"/></inline-formula>随机游走熵率值函数：</p><disp-formula id="hanspub.16752-formula77"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x30_hanspub.png"  xlink:type="simple"/></disp-formula><p>2) 平衡项函数：为使聚类的簇具有相似大小，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x31_hanspub.png" xlink:type="simple"/></inline-formula>为选择边集，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x32_hanspub.png" xlink:type="simple"/></inline-formula>为图聚类数目，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x33_hanspub.png" xlink:type="simple"/></inline-formula>为聚类分布，图划分后边集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x34_hanspub.png" xlink:type="simple"/></inline-formula>，由此<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x35_hanspub.png" xlink:type="simple"/></inline-formula>分布为：</p><disp-formula id="hanspub.16752-formula78"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x36_hanspub.png"  xlink:type="simple"/></disp-formula><p>则平衡项：</p><disp-formula id="hanspub.16752-formula79"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x37_hanspub.png"  xlink:type="simple"/></disp-formula><p>熵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x38_hanspub.png" xlink:type="simple"/></inline-formula>促使形成的簇具有类似的尺寸，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x39_hanspub.png" xlink:type="simple"/></inline-formula>使聚类的数目尽可能少。</p><p>3) 目标函数：结合熵率与平衡项的目标函数：</p><disp-formula id="hanspub.16752-formula80"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x40_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x41_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x42_hanspub.png" xlink:type="simple"/></inline-formula>为用户输入的系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x43_hanspub.png" xlink:type="simple"/></inline-formula>为聚类数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x44_hanspub.png" xlink:type="simple"/></inline-formula>按如下公式计算：增加一条边后熵率值增加与平衡项函数值增加的比率：</p><disp-formula id="hanspub.16752-formula81"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x45_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s4_2"><title>2.2. 改进的熵率算法——融合几何对称性约束的熵率超像素分割</title><p>对于岩屑颗粒图像的研究发现，无论是什么样的岩屑颗粒，它们具有一定的对称性，熵率超像素分割算法利用像素的亮度信息以及空间位置距离关系分割图像，没有考虑像素之间的对称性特点。文献 [<xref ref-type="bibr" rid="hanspub.16752-ref11">11</xref>] 中提出了一种表示和度量一对像素之间镜面对称性的关系方法—镜面对称系数，用于对具有对称性图像的轮廓提取，本节通过对镜面对称系数的介绍，引入镜面对称系数到熵率超像素岩屑颗粒分割目标函数里，从而对目标函数提出了一种基于镜面对称系数的几何对称性约束条件，增加了岩屑图像分割的准确性。</p><p>镜面对称系数 [<xref ref-type="bibr" rid="hanspub.16752-ref11">11</xref>] 定义：</p><p>设I是灰度图像，p是图像I中的一个像素<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x46_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x47_hanspub.png" xlink:type="simple"/></inline-formula>是圆<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x48_hanspub.png" xlink:type="simple"/></inline-formula>中的一个单位圆，以p为中心在R为半径的范围搜索对比度最大的像素点记为q，本文取R = 3，其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x49_hanspub.png" xlink:type="simple"/></inline-formula>的一个单位切向量，其方向垂直于像素p与像素q的连线。这里，对于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x50_hanspub.png" xlink:type="simple"/></inline-formula>和与其相关的角度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x51_hanspub.png" xlink:type="simple"/></inline-formula>，定义 v的反射矩阵为：</p><disp-formula id="hanspub.16752-formula82"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x52_hanspub.png"  xlink:type="simple"/></disp-formula><p>设p和q是空间内有明显差异的两个点，它们通过单位的切向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x53_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x54_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x55_hanspub.png" xlink:type="simple"/></inline-formula>联系在一起。如果满足条件(10)则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x56_hanspub.png" xlink:type="simple"/></inline-formula>是镜面对称。</p><disp-formula id="hanspub.16752-formula83"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x57_hanspub.png"  xlink:type="simple"/></disp-formula><p>为了简单描述，称p和q是镜面对称的，而不称它们的切向量是镜面对称。这里，用镜面对称系数对两个不同像素点p和q之间的镜面对称性进行定量的表示，定义式如下(11)。</p><disp-formula id="hanspub.16752-formula84"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x58_hanspub.png"  xlink:type="simple"/></disp-formula><p>两个不同像素点p和q之间的镜面对称性<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x59_hanspub.png" xlink:type="simple"/></inline-formula>表示为式(12)。</p><disp-formula id="hanspub.16752-formula85"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x60_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x61_hanspub.png" xlink:type="simple"/></inline-formula>，值越大说明两个像素p和q越对称。</p><p>定义几何对称性约束函数为：</p><disp-formula id="hanspub.16752-formula86"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x62_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，图A为选择的边集，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x63_hanspub.png" xlink:type="simple"/></inline-formula>表示图A中相邻像素i, j之间由镜面对称系数度量的对称性。</p><p>熵函数随着<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x64_hanspub.png" xlink:type="simple"/></inline-formula>的增大，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x65_hanspub.png" xlink:type="simple"/></inline-formula>值趋向于1.0是递增的，每次向随机游走模型中加入一条新的边，就会增加随机游走模型的不确定性，随机游走模型的不确定性越大，则熵率越大，所以，这个随机游走模型的几何对称性约束函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x66_hanspub.png" xlink:type="simple"/></inline-formula>是一个单调递增的函数。另外，在向随机游走模型中加入边时，随着边的逐渐增加，新加入的边对模型的不确定性的影响力就会逐渐减弱，因此函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x67_hanspub.png" xlink:type="simple"/></inline-formula>也是一个满足收益递减属性，即子模性。综上分析，图<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x68_hanspub.png" xlink:type="simple"/></inline-formula>的随机游走模型的几何对称性约束函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x69_hanspub.png" xlink:type="simple"/></inline-formula>是一个单调递增的满足子模性要求的函数 [<xref ref-type="bibr" rid="hanspub.16752-ref10">10</xref>] 。</p></sec><sec id="s4_3"><title>2.3. 改进熵率超像素岩屑分割算法</title><p>为了得到具有同质性、大小均匀、形状规则具有一定对称性的超像素，就必须使用熵率来实现颜色相似度度量的要求，使用平衡项来实现大小控制的要求，使用几何对称性约束来实现超像素形状规则具有对称性的要求，所以本文提出了一个新的目标函数，即由2.1节中介绍的熵率函数、平衡项函数与本节提出的基于镜面对称系数的几何对称性约束函数组成。通过最大化关于边集的目标函数式(14)来得到分割结果。</p><disp-formula id="hanspub.16752-formula87"><label>(14)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x70_hanspub.png"  xlink:type="simple"/></disp-formula><p>对于选择的边集A，使其满足<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x71_hanspub.png" xlink:type="simple"/></inline-formula>，参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x72_hanspub.png" xlink:type="simple"/></inline-formula>是平衡项的权重，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x73_hanspub.png" xlink:type="simple"/></inline-formula>是几何对称性约束项的权重，并且都是正实数，所以，由三个函数相加的组合成的新目标函数保持了单调性和子模性。通过最大化上述目标函数，采用贪心策略实现图像的分割。</p><p>这里，采用2.1小节中介绍的平衡项的权重系数自动调节类似的方法进行几何对称项系数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x74_hanspub.png" xlink:type="simple"/></inline-formula>的自动估计：</p><p>1) 遍历所有的边，按照式(14)介绍的目标函数的计算方法，计算出所有边的熵率增益和几何对称项增益，并且找出熵率的最大增益<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x75_hanspub.png" xlink:type="simple"/></inline-formula>和几何对称的最大增益<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x76_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>2) 计算几何对称项系数：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x77_hanspub.png" xlink:type="simple"/></inline-formula>。其中K为期望产生的聚类数目，即超像素数目，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x78_hanspub.png" xlink:type="simple"/></inline-formula>为用户自己输入的一个起始系数。本文使用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x79_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x80_hanspub.png" xlink:type="simple"/></inline-formula>是依据如下公式自动计算出的一个值。</p><disp-formula id="hanspub.16752-formula88"><label>(15)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x81_hanspub.png"  xlink:type="simple"/></disp-formula><p>算法具体步骤如下：</p><p>步骤1：把图像像素视为结点进行图的构造，初始化结点和边，相邻结点之间边的权重由如下式(16)获得。</p><disp-formula id="hanspub.16752-formula89"><label>(16)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x82_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x83_hanspub.png" xlink:type="simple"/></inline-formula>表示像素坐标，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x84_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x85_hanspub.png" xlink:type="simple"/></inline-formula>的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x86_hanspub.png" xlink:type="simple"/></inline-formula>距离，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x87_hanspub.png" xlink:type="simple"/></inline-formula>表示亮度绝对值，核带宽根据实验结果设为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x88_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>步骤2：按照2.2.1小节中介绍的方法计算相邻结点之间表征几何对称性的镜面对称系数：对组成结点的像素进行八邻域内搜索，标记出组成与相邻结点之间公共边界的一系列像素点，对这些边界处的像素点按照式(12)分别计算出镜面对称系数，用计算出的所有镜面对称系数的均值作为相邻结点间的对称性度量。</p><p>步骤3：根据式(14)计算所有边的目标函数增益，对目标函数增益建立一个最大堆，采用贪心算法进行图的划分，同时每加入一条边，需要对这个堆进行相关更新，直到目标数目等于预先设定的目标数目，得到分割结果。</p></sec></sec><sec id="s5"><title>3. 基于和差直方图的最大相似度(MSRM)合并</title><p>经过实验结果得知，尽管改进熵率超像素算法对岩屑颗粒图像分割取得了很好的效果，但仍然存在过分割的区域，本文引用最大相似度优化合并算法对岩屑图像分割结果后处理，进一步提高分割准确度。最大相似度融合算法(MRSM) [<xref ref-type="bibr" rid="hanspub.16752-ref13">13</xref>] 使用超像素作为处理单位，具有不需要阈值，自适应选择合并区域的特点，因此，相比于传统合并算法具有很大的鲁棒性优势，但原始MSRM算法计算维度多，计算量大，为此，本文采用符合岩屑颗粒特征描述的差直方图的绝对值提取目标区域相似度，改进MSRM算法的计算维度问题，这将极大的减少复杂度。</p><p>和差直方图描述图像灰度和与差的概率分布情况，反映了图像关于方向、相邻间隔、变化幅度的综合信息，具体描述如下：</p><p>考虑<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x89_hanspub.png" xlink:type="simple"/></inline-formula>的灰度图像，灰度级图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x91_hanspub.png" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x90_hanspub.png" xlink:type="simple"/></inline-formula>的两个像素<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x92_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x93_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x95_hanspub.png" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x94_hanspub.png" xlink:type="simple"/></inline-formula>表示分析区域，对于相对偏移<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x96_hanspub.png" xlink:type="simple"/></inline-formula>和差定义：</p><disp-formula id="hanspub.16752-formula90"><label>(17)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x97_hanspub.png"  xlink:type="simple"/></disp-formula><p>归一化的和差直方图定义：</p><disp-formula id="hanspub.16752-formula91"><label>(18)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x98_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x99_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x100_hanspub.png" xlink:type="simple"/></inline-formula>的像素分布，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x101_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x102_hanspub.png" xlink:type="simple"/></inline-formula>的像素分布，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x103_hanspub.png" xlink:type="simple"/></inline-formula>代表区域<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x104_hanspub.png" xlink:type="simple"/></inline-formula>像素总数量，在像素八邻域内，为了简单，我们取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x105_hanspub.png" xlink:type="simple"/></inline-formula>四个方向<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x106_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>设区域QR为相邻区域，利用巴氏系数作为区域R与区域Q之间相似度的衡量标准，使用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x107_hanspub.png" xlink:type="simple"/></inline-formula>描述两区间的相似度，则有：</p><disp-formula id="hanspub.16752-formula92"><label>(19)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x108_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x109_hanspub.png" xlink:type="simple"/></inline-formula>为区域差直方图，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x110_hanspub.png" xlink:type="simple"/></inline-formula>为彩色图像灰度量化值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x111_hanspub.png" xlink:type="simple"/></inline-formula>越大时，说明两直方图的相似度越高，反之，两区域的直方图相似度就越低，表现在图像上的差异就比较大。</p><p>MSRM算法使用了一种自适应于图像内容的区域融合策略，设超像素区域Q与超像素区域R相邻，统计区域Q的所有邻接超像素区域，并将其邻接区域集合定义为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x112_hanspub.png" xlink:type="simple"/></inline-formula>，显然有<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2670065x113_hanspub.png" xlink:type="simple"/></inline-formula>，通过巴氏系数确定区域Q与其所有邻接区域的相似度，并记作：</p><disp-formula id="hanspub.16752-formula93"><label>(20)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x114_hanspub.png"  xlink:type="simple"/></disp-formula><p>若区域Q与区域R相似度满足式(21)</p><disp-formula id="hanspub.16752-formula94"><label>(21)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2670065x115_hanspub.png"  xlink:type="simple"/></disp-formula><p>则合并两区域，图2显示两相邻区域合并前后效果示意图。</p><p>结合第2节与第3节所述，可得本文算法流程图如图3。</p></sec><sec id="s6"><title>4. 实验结果与分析</title><p>文中首先对原始彩色岩屑颗粒图像进行高斯金字塔滤波预处理，然后对图像运用改进的熵率超像素分割图像，最后对过分割图像进行合并得到最终结果，软件程序均采用C++语言实现。</p><p>图4为本文算法与合并分水岭 [<xref ref-type="bibr" rid="hanspub.16752-ref14">14</xref>] 、FH算法 [<xref ref-type="bibr" rid="hanspub.16752-ref7">7</xref>] 、TurboPixels算法 [<xref ref-type="bibr" rid="hanspub.16752-ref15">15</xref>] 对比，为达到实验结果准确性，所有的算法均采用所给论文最优参数。从图中可以看出:分水岭算法边缘定位准确，但存在非常多的过分割区域，尽管采用合并算法减少过分割，但仍然在某些区域不尽人意，FH在边缘处产生较多重复边缘，TurboPixel不仅过分割严重，且边缘定位不准，熵率超像素对岩屑图像的分割具有紧凑性与一致性的特点，由(e)、(f)可知：本文算法相对于原始熵率超像素边界定位更准，边缘依附性更好，增加了目标提取的精确度。</p><p>图5表示在分割过后对区域进行合并后结果，图(b)表示文献 [<xref ref-type="bibr" rid="hanspub.16752-ref16">16</xref>] 基于颜色相似度与长短边界信息合</p><p>图2. 区域合并对比图</p><p>图3. 算法流程图</p><p>并方法的合并结果，图(c)为文献 [<xref ref-type="bibr" rid="hanspub.16752-ref17">17</xref>] 基于颜色相似度与真假边缘分析方法的合并结果图，图(d)为本文基于差的绝对值直方图最大相似度合并结果，从图中可知，文献 [<xref ref-type="bibr" rid="hanspub.16752-ref16">16</xref>] [<xref ref-type="bibr" rid="hanspub.16752-ref17">17</xref>] 需要有用户输入阈值，而最大相似度合并不需要，且差直方图提取了岩屑颗粒纹理信息与颜色信息，比传统合并算法只基于颜色相似度更加精确，更能适合岩屑颗粒图像的合并。</p><p>图4. 改进熵率超像素与其他算法分割结果图对比</p><p>图5. 合并算法结果</p></sec><sec id="s7"><title>5. 结束语</title><p>本文提出一种岩屑颗粒图像分割方法：基于岩屑图像对称系数的熵率超像素分割，该方法不仅使岩屑分割边缘附着性好，且考虑岩屑形状信息，使得分割结果更加准确。通过加入岩屑颜色、纹理区域特征的改进最大相似度合并算法，对分割结果进行进一步处理，提高分割准确性，且与原MSRM算法相比，加快了合并时间。</p></sec><sec id="s8"><title>文章引用</title><p>李 杰,吴小强,熊淑华,王亚静,何小海. 基于改进熵率超像素和区域合并的岩屑图像分割Rock Image Segmentation Based on Improved Entropyrate Superpixel and Region Merging[J]. 图像与信号处理, 2016, 05(01): 16-24. http://dx.doi.org/10.12677/JISP.2016.51003</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16752-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Mori, G., Ren, X., Efros, A.A. and Malik, J. (2004) Recovering Human Body Configurations: Combining Segmentation and Recognition. In CVPR.</mixed-citation></ref><ref id="hanspub.16752-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Ren, X. and Malik, J. (2003) Learning a Classification Model for Segmentation. In ICCV.  
&lt;br&gt;http://dx.doi.org  /10.1109/iccv.2003.1238308</mixed-citation></ref><ref id="hanspub.16752-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Kohli, P., Ladicky, L. and Torr, P. (2009) Robust Higher Order Potentials for Enforcing Label Consistency. IJCV, 82, 302-324. &lt;br&gt;http://dx.doi.org  /10.1007/s11263-008-0202-0</mixed-citation></ref><ref id="hanspub.16752-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Hoiem, D., Stein, A.N., Efros, A.A. and Hebert, M. (2007) Recovering Occlusion Boundaries from a Single Image. In ICCV. &lt;br&gt;http://dx.doi.org  /10.1109/iccv.2007.4408985</mixed-citation></ref><ref id="hanspub.16752-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Ramalingam, S., Kohli, P., Alahari, K. and Torr, P.H.S. (2008) Exactinference in Multi-Label Crfs with Higher Order Cliques. In CVPR.</mixed-citation></ref><ref id="hanspub.16752-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">王春瑶, 陈俊周, 李炜. 超像素分割算法研究综述[J]. 计算机应用研究, 2014, 31(1): 6-12.</mixed-citation></ref><ref id="hanspub.16752-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Felzenszwalb, P.F. (2004) Efficient Graph-Based Image Segmentation. International Journal of Computer Vision, 59, 167-181. &lt;br&gt;http://dx.doi.org  /10.1023/B:VISI.0000022288.19776.77</mixed-citation></ref><ref id="hanspub.16752-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Vincent, L. and Soille, P. (1991) Watersheds in Digital Spaces: An Efficient Algorithm Based on Immersion Simulations. IEEE Transactions on Pattern Analysis and Machine Intelligence, 13, 583-598.  
&lt;br&gt;http://dx.doi.org  /10.1109/34.87344</mixed-citation></ref><ref id="hanspub.16752-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">王亚静, 王正勇, 等. 基于熵率超像素和区域合并的岩屑颗粒图像分割[J]. 计算机工程与设计, 2014, 35(12): 4223-4227.</mixed-citation></ref><ref id="hanspub.16752-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Liu, M.Y., Tuzel, O., Ramalingam, S. and Chellappa, R. (2014) Entropy-Rate Clustering: Cluster Analysis via Maximizing a Submodular Function Subject to a Matroid Constraint. IEEE Transactions on Pattern Analysis and Machine Intelligence, 36, 99-112.</mixed-citation></ref><ref id="hanspub.16752-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Cicconet, M., Geiger, D., Gunsalus, K.C., et al. (2014) Mirror Symmetry Histograms for Capturing Geometric Properties in Images. IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2981-2986.</mixed-citation></ref><ref id="hanspub.16752-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Cover, T.M. and Thomas, J.A. (1991) Elements of Information Theory. 2nd Edition, John Wiley &amp; Sons.  
&lt;br&gt;http://dx.doi.org  /10.1002/0471200611</mixed-citation></ref><ref id="hanspub.16752-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Ning, J.F., Zhang, L., Zhang, D. and Wu, C.K. (2010) Interactive Image Segmentation by Maximal Similarity Based Region Merging. Pattern Recognition, 43, 445-456.</mixed-citation></ref><ref id="hanspub.16752-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">杨振威. 岩屑图像分析及边缘检测技术的研究与实现[D]. 成都: 四川大学, 2012.</mixed-citation></ref><ref id="hanspub.16752-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Levinshtein, A., Stere, A., Kutulakos, K.N., Fleet, D.J. and Dickinson, S.J. (2009) Fast Superpixels Using Geometric Flows. IEEE Transactions on Pattern Analysis and Machine Intelligence, 31, 2290-2297.</mixed-citation></ref><ref id="hanspub.16752-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">何艳. 岩屑图像分割算法研究[D]. 成都: 四川大学, 2013.</mixed-citation></ref><ref id="hanspub.16752-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">王倩. 岩屑图像分割相关技术研究及应用[D]. 成都: 四川大学, 2014.</mixed-citation></ref></ref-list></back></article>