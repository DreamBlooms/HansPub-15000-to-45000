<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">BIPHY</journal-id><journal-title-group><journal-title>Biophysics</journal-title></journal-title-group><issn pub-type="epub">2330-1686</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/BIPHY.2019.71001</article-id><article-id pub-id-type="publisher-id">BIPHY-28723</article-id><article-categories><subj-group subj-group-type="heading"><subject>BIPHY20190100000_81129746.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject><subject> 生命科学</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于平滑先验法的两种熵研究
   Two Entropy Studies Based on Smooth Prior Approach
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>园园</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>锦</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>焦</surname><given-names>得钊</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>陕西师范大学，物理学与信息技术学院，陕西 西安</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>30</day><month>01</month><year>2019</year></pub-date><volume>07</volume><issue>01</issue><fpage>1</fpage><lpage>9</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   从心电系统中采集的心率变异性(Heart Rate Variability, HRV)信号，不可避免的混入噪声和各种趋势，消除这些趋势的干扰，有助于非线性系统复杂动力学分析的准确性。本文采用平滑先验法消除健康人白天和夜间的HRV信号中所叠加的不同趋势项，使用近似熵和基本尺度熵对其进行复杂性计算，对比分析去趋势处理前、后近似熵和基本尺度熵的稳定性变化。研究发现：去趋势处理后，平滑先验法能够有效去除HRV信号的各种趋势项，且较大幅度地提高了近似熵的稳定性，而基本尺度熵在去趋势处理前、后均呈现出较强的稳定性。研究结果表明去趋势处理后，两种熵测度都可以区分开健康人白天和夜间的HRV信号，充分体现出平滑先验法可以提高熵测度的稳定性和识别性，为临床的生理病理诊断提供了重要的理论依据。
    The heart rate variability (HRV) signals collected from the ECG system are affected with noise and various trends inevitably. Eliminating the interference of these trends contributes to the accuracy of complex dynamic analysis of these nonlinear systems. In this paper, we use the smoothness prior method to eliminate the different trends superimposed in the HRV signals of healthy people during the day and night, and use the approximate entropy and the basic scale entropy to calculate the complexity. Before and after removing the trending interference, we contrast and analyze the stability changes of approximate entropy and base-scale entropy. The results showed that after detrending processing, the smooth prior method can effectively remove various trend interference from the recordings, and can greatly improve the stability of approximate entropy. The experimental results also showed that the base-scale entropy indicates strong stability regardless of whether or not to use detrending processing. After detrending, the two entropy measures can distinguish the HRV signals of healthy people during the day and night. It fully reflects that the smoothness prior method can improve the stability and recognition of the entropy measure, and provide an important theoretical basis for clinical physiology and pathological diagnosis. 
  
 
</p></abstract><kwd-group><kwd>平滑先验法，心率变异性，基本尺度熵，近似熵，稳定性,  Smoothness Prior Method</kwd><kwd> Heart Rate Variability</kwd><kwd> Base-Scale Entropy</kwd><kwd> Approximate Entropy</kwd><kwd> Stability</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于平滑先验法的两种熵研究<sup> </sup></title><p>郭园园<sup>*</sup>，李锦<sup>#</sup>，焦得钊</p><p>陕西师范大学，物理学与信息技术学院，陕西 西安</p><p><img src="//html.hanspub.org/file/1-2790056x1_hanspub.png" /></p><p>收稿日期：2019年1月11日；录用日期：2019年1月23日；发布日期：2019年1月30日</p><disp-formula id="hanspub.28723-formula13"><graphic xlink:href="//html.hanspub.org/file/1-2790056x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>从心电系统中采集的心率变异性(Heart Rate Variability, HRV)信号，不可避免的混入噪声和各种趋势，消除这些趋势的干扰，有助于非线性系统复杂动力学分析的准确性。本文采用平滑先验法消除健康人白天和夜间的HRV信号中所叠加的不同趋势项，使用近似熵和基本尺度熵对其进行复杂性计算，对比分析去趋势处理前、后近似熵和基本尺度熵的稳定性变化。研究发现：去趋势处理后，平滑先验法能够有效去除HRV信号的各种趋势项，且较大幅度地提高了近似熵的稳定性，而基本尺度熵在去趋势处理前、后均呈现出较强的稳定性。研究结果表明去趋势处理后，两种熵测度都可以区分开健康人白天和夜间的HRV信号，充分体现出平滑先验法可以提高熵测度的稳定性和识别性，为临床的生理病理诊断提供了重要的理论依据。</p><p>关键词 :平滑先验法，心率变异性，基本尺度熵，近似熵，稳定性</p><disp-formula id="hanspub.28723-formula14"><graphic xlink:href="//html.hanspub.org/file/1-2790056x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/1-2790056x8_hanspub.png" /> <img src="//html.hanspub.org/file/1-2790056x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>心率变异性信号，又称RR间期信号，是指逐次心跳周期差异的变化情况 [<xref ref-type="bibr" rid="hanspub.28723-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.28723-ref2">2</xref>] ，蕴含有关心血管调节的大量信息。由于心脏系统本身是一个非常复杂的非线性系统，为了找出适合HRV信号的稳定性分析方法，国内外学者提出了一系列的非线性分析方法，如：小波分析、去趋势波动分析、多重分形、散点图、熵分析等。在这些众多的非线性分析方法中，熵分析是其中比较具有代表性的，而且被公认为效果比较好的方法 [<xref ref-type="bibr" rid="hanspub.28723-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.28723-ref4">4</xref>] 。</p><p>然而在心电信号采集过程中，心电信号容易受到诸如人体呼吸、出汗和电极轻微移动，甚至是肌肉的缓慢运动等各种低频噪声的浸染，而这些低频噪声干扰或趋势项渗入通常不利于信号的分析。因此，减小和消除测试信号中的趋势项是数据处理的一个重要步骤 [<xref ref-type="bibr" rid="hanspub.28723-ref5">5</xref>] 。</p><p>目前，去趋势处理的常用方法主要有差分法、低通滤波法、滑动平均法、最小二乘拟合法、小波法以及经验模态法 [<xref ref-type="bibr" rid="hanspub.28723-ref6">6</xref>] 等。前4种方法需要预先假设趋势项类型，如线性、多项式或指数趋势等，不适合处理信号中趋势随机或复杂变化的情况；而后两种方法对小波基的选择或分解层次要求比较复杂，很难准确提取需要的特征值或特征向量。平滑先验法是一种改进的消除非平稳趋势项算法 [<xref ref-type="bibr" rid="hanspub.28723-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.28723-ref8">8</xref>] ，能有效去除待处理信号中的趋势项，同时保留感兴趣的信号。而且在实际计算中，平滑先验法计算简单，可用于实时计算。本文使用平滑先验法来消除标准心电数据库中健康人昼夜节律心率变异性信号所叠加的各种趋势项，同时对去趋势处理前、后的实验数据进行近似熵和基本尺度熵 [<xref ref-type="bibr" rid="hanspub.28723-ref9">9</xref>] 计算，分析两种熵分析方法的稳定性以及临床应用前景。</p></sec><sec id="s4"><title>2. 理论基础</title><sec id="s4_1"><title>2.1. 平滑先验法及其频率响应</title><sec id="s4_1_1"><title>2.1.1. 平滑先验法原理</title><p>平滑先验法(Smoothness Priors Approach, SPA)是芬兰库奥皮奥大学的Karjalainen博士 [<xref ref-type="bibr" rid="hanspub.28723-ref10">10</xref>] 提出的一种信号非线性去趋势方法，该算法假设原始数据信号，即时间序列z由两部分组成：</p><p>z = z s + z t (1)</p><p>在上面公式(1)中， z s 是平稳项； z t 是非线性的低频趋势成分，且可用下面公式表示为：</p><p>z t = H θ + v (2)</p><p>在公式(2)中， H ∈ R N &#215; M 为观测矩阵， θ ∈ R M 为回归参数，v为观测误差，那么任务就转化为采取优化方法估计参数θ，从而使 z t ^ = H θ ^ 来估计原信号中的趋势项。估计参数θ的常用方法是最小二乘法，平滑先验法在寻优过程中加入了微分项 ‖ D d ( H θ ) ‖ ，并使之达到最小来保证 H θ 滤去的是信号中的趋势项部分：</p><p>θ λ = arg min θ { ‖ H θ − z ‖ 2 + λ 2 ‖ D d ( H θ ) ‖ 2 } (3)</p><p>式中：λ为正规则化参数，D<sub>d</sub>为离散化的d阶微分算子矩阵。矩阵D<sub>d</sub>的求解方式如下：</p><p>设序列z中含有N个局部极值点，可用列项量 R = [ R 1 , R 2 , ⋯ R N ] T ∈ R N 表示，R的一阶趋势表示为： R 1 = [ R 2 − R 1 , ⋯ , R N − R N − 1 ] T ，二阶趋势可表示为：</p><p>R 2 = [ R 3 − R 2 − ( R 2 − R 1 ) , R 4 − R 3 − ( R 3 − R 2 ) , ⋯ , R N − R N − 1 − ( R N − 1 − R N − 2 ) ] T (4)</p><p>以此类推，就可得到R的任意阶趋势的离散表示形式，即R的d阶微分可用D<sub>d</sub>表示为：</p><p>D d = [ d ( R d ) 1 / d R 1 ⋯ d ( R d ) 1 / d R N ⋮ ⋮ d ( R d ) N − d / d R 1 ⋯ d ( R d ) N − d / d R N ] (5)</p><p>式(5)中的解为 θ λ ^ = ( H T H + λ 2 H T D d T D d H ) − 1 H T z 和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/1-2790056x25_hanspub.png" xlink:type="simple"/></inline-formula>，其中 z t ^ 就是需要去除的趋势项的估计值。</p><p>矩阵H可以通过分析原信号z的特性获取，为了分析简便，H采用单位矩阵 I ∈ R N &#215; N 。对于矩阵D<sub>d</sub>，当阶数为2时可以很好地估计信号中的非周期趋势项，因此D<sub>d</sub>的阶数取2， D 2 ∈ R ( N − 2 ) &#215; N 可表示为：</p><p>D 2 = [ 1 − 2 1 0 ⋯ 0 0 1 − 2 1 ⋯ ⋮ ⋮ ⋮ ⋮ ⋮ 0 0 ⋯ 0 1 − 2 1 ] (6)</p><p>因此，原信号去除趋势项后的平稳部分可以表示为：</p><p>z s ^ = z − H θ ^ λ = [ I − ( I + λ 2 D 2 T D 2 ) − 1 ] z = L z (7)</p><p>公式(7)中令 L = [ I − ( I + λ 2 D 2 T D 2 ) − 1 ] ，则有 z s ^ = L z 。</p></sec><sec id="s4_1_2"><title>2.1.2. 频率响应</title><p>在上式(7)中，矩阵L的作用相当于一个高通滤波器。通过对矩阵L的任意一行做傅立叶变换，可以得到其频率特性。取N = 50，λ = 50，根据式(6)和式(7)用MATLAB编程计算，得到L的频率响应如下图1所示。</p><p>在图1中，x轴是归一化后的频率f，z轴代表幅值，由于对称性的原理，y轴中的N只取了1~25之间的数据。由下图1可以看出，L的滤波作用绝大部分是平顺的，只有在信号的初始段和末段，滤波效果不太理想。让规则化参数λ取不同的值，对L的第N/2行作傅立叶变换，从而得到不同λ值对应的频率响应，结果如下图2所示。</p><p>图1. L的频率响应</p><p>图2. 不同λ下的频率响应</p><p>频率响应是电子学领域中用来衡量线性电子学系统性能的主要指标 [<xref ref-type="bibr" rid="hanspub.28723-ref11">11</xref>] ，心电信号的主要成分的频率范围在1~100 Hz，趋势项的频率一般集中在低频范围中，因此一般在预处理中将HRV信号的采样频率降低为4 Hz。由下面表1可以看出，当λ = 100时，对应的截至频率为0.0296 &#215; 4 = 0.1184 Hz，基本可以保证原始数据中低频趋势项的消除，同时保留感兴趣的信号成分。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Regularization parameter and the corresponding cut-off frequenc</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >参数λ</th><th align="center" valign="middle" >1</th><th align="center" valign="middle" >2</th><th align="center" valign="middle" >5</th><th align="center" valign="middle" >10</th><th align="center" valign="middle" >20</th><th align="center" valign="middle" >100</th></tr></thead><tr><td align="center" valign="middle" >相对截止频率</td><td align="center" valign="middle" >0.2241</td><td align="center" valign="middle" >0.1518</td><td align="center" valign="middle" >0.0942</td><td align="center" valign="middle" >0.0660</td><td align="center" valign="middle" >0.0499</td><td align="center" valign="middle" >0.0296</td></tr></tbody></table></table-wrap><p>表1. 正则化参数与相对截止频率</p></sec></sec><sec id="s4_2"><title>2.2. 近似熵</title><p>近似熵主要是从衡量时间序列复杂性的角度来度量信号中产生的新模式概率的大小，产生新模式的概率越大、序列的复杂性越大，相应的近似熵也越大 [<xref ref-type="bibr" rid="hanspub.28723-ref12">12</xref>] 。</p><p>本文采用标准近似熵(2, r, N)分析颠倒作息HRV时间序列，其中嵌入维数m = 2，r为相似容限(通常取0.1~0.5 SD，本文取r = 0.2 SD [<xref ref-type="bibr" rid="hanspub.28723-ref13">13</xref>] ) (SD代表信号的标准差)。</p></sec><sec id="s4_3"><title>2.3. 基本尺度熵</title><p>基本尺度熵的本质是定量的分析m-words组合出现的不确定性 [<xref ref-type="bibr" rid="hanspub.28723-ref14">14</xref>] ，熵值越大表示m-words的组合形式出现的更加不确定，即波动模式越复杂 [<xref ref-type="bibr" rid="hanspub.28723-ref15">15</xref>] 。对于颠倒作息HRV序列，本文取嵌入维数m = 2，特殊参数α = 0.2，α的取值是利用Wessel [<xref ref-type="bibr" rid="hanspub.28723-ref16">16</xref>] 等的测试方法得到。(若 m = 3 , 4 , 5 , 6 , 7 ，结果无任何影响，改变α值从0.1~2，结果也无明显的不同)。</p></sec></sec><sec id="s5"><title>3. HRV信号的去趋势项及仿真分析</title><p>本文的HRV数据来自Physionet当中的BIH/MIT Normal Sinnus Rhythm数据库，其中包含18名(平均年龄为20~50岁，采样频率为128 Hz)健康人白天和夜间的HRV信号(即健康人24 h昼夜节律下的HRV信号) [<xref ref-type="bibr" rid="hanspub.28723-ref17">17</xref>] [<xref ref-type="bibr" rid="hanspub.28723-ref18">18</xref>] 。本文对每一组RR间期信号，分别选取白天和夜间HRV信号作为原始信号，对其进行去除趋势项分析。为了能够清楚显示信号的细节，我们对两种样本信号选取了3000个采样点，消除趋势后的HRV信号的波形和原始信号的波形对比图如图3所示。</p><p>图3. 平滑先验法消除HRV信号趋势前后的波形</p><p>图3代表一个健康人在白天和夜间的RR间期使用平滑先验法消除趋势项前后的波形对比图(其余受试者RR间期去趋势前后波形对比图变化规律与此相似)，观察图3(a)和图3(b)可以明显看到：健康人白天RR间期明显小于健康人夜间的RR间期，心率变异性变化呈现出白天升高，夜间降低的特点；从图3中还可以看出，HRV信号的趋势项得到了有效消除，同时保留了感兴趣的HRV信号成分。</p></sec><sec id="s6"><title>4. 基于SPA算法的两种熵分析</title><p>为了研究SPA去趋势处理算法对两种熵测度稳定性的影响，我们对健康人白天和夜间的HRV信号进行去趋势处理前、后的近似熵(m = 2, r = 0.2)和基本尺度熵(m = 2, α = 0.25)计算，其中线性趋势参数(A<sub>l</sub> = 0.001)、周期性趋势参数(As = 0.2, T = 500)、幂律性趋势参数(Ap = 2, i = 0.2)，其计算结果如图4、图5所示。</p><p>图4(a)和图4(b)分别是平滑先验法消除RR间期信号在不同趋势前、后的基本尺度熵的计算结果，具体统计计算结果分别如表2和表3所示。从表2中可以看出健康人白天的近似熵值大于健康人夜间的近似熵值，这与近似熵结果相反。这是因为睡眠会使迷走神经的调节活动增强，而抑制睡眠的交感神经活动减弱，使得近似熵值增强，基本尺度熵值减小 [<xref ref-type="bibr" rid="hanspub.28723-ref19">19</xref>] 。且如表2所示，经t检验 [<xref ref-type="bibr" rid="hanspub.28723-ref20">20</xref>] ，P (白天，夜间) &lt; 0.05，即基本尺度熵可以区分开不同的两组样本；同时，当样本具有不同趋势时，P (白天，夜间) &lt; 0.05，这表明基本尺度熵不会受信号中的各种趋势影响，可以准确的区分开健康人正常作息下的昼夜节律变化，充分体现出基本尺度熵的稳定性和有效性。作为比较，当我们使用平滑先验法去趋势处理后，如图4(b)所示，不管是HRV信号具有单一趋势还是由单一趋势叠加而成的混合趋势，基本尺度熵值均保持不变，如表3所示，经t检验，P (白天，夜间) &lt; 0.05，这说明经过去趋势处理前、后，基本尺度熵值均可有效区分不同状态下的两组样本，且不会受趋势干扰影响实验结果的准确性，这是其他算法所不具备的优点。</p><p>图4. 两组样本在去趋势处理前(a)和去趋势处理后(b)的基本尺度熵</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Base-scale entropy statistical analysis of HRV signals (mean &#177; standard</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >基本尺度熵</th><th align="center" valign="middle" >原始信号</th><th align="center" valign="middle" >线性趋势</th><th align="center" valign="middle" >周期性趋势</th><th align="center" valign="middle" >幂律性趋势</th><th align="center" valign="middle" >混合趋势</th></tr></thead><tr><td align="center" valign="middle" >健康人白天</td><td align="center" valign="middle" >4.1289 &#177; 0.1841</td><td align="center" valign="middle" >3.7142 &#177; 0.1386</td><td align="center" valign="middle" >3.6463 &#177; 0.1397</td><td align="center" valign="middle" >3.6114 &#177; 0.1485</td><td align="center" valign="middle" >3.6639 &#177; 0.1246</td></tr><tr><td align="center" valign="middle" >健康人夜间</td><td align="center" valign="middle" >3.7615 &#177; 0.1879</td><td align="center" valign="middle" >3.5260 &#177; 0.1510</td><td align="center" valign="middle" >3.4979 &#177; 0.1491</td><td align="center" valign="middle" >3.4805 &#177; 0.1476</td><td align="center" valign="middle" >3.5226 &#177; 0.1480</td></tr><tr><td align="center" valign="middle" >P值</td><td align="center" valign="middle" >1.777 &#215; 10 − 6</td><td align="center" valign="middle" >5.953 &#215; 10 − 4</td><td align="center" valign="middle" >0.0051</td><td align="center" valign="middle" >0.0144</td><td align="center" valign="middle" >0.0049</td></tr></tbody></table></table-wrap><p>表2. HRV信号基本尺度熵统计结果(平均值 &#177; 标准差)</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Base-scale entropy statistical analysis of HRV signals after detrending processing (mean &#177; standard</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >基本尺度熵</th><th align="center" valign="middle" >消除原始信号趋势</th><th align="center" valign="middle" >消除线性趋势</th><th align="center" valign="middle" >消除周期性趋势</th><th align="center" valign="middle" >消除幂律性趋势</th><th align="center" valign="middle" >消除混合趋势</th></tr></thead><tr><td align="center" valign="middle" >健康人白天</td><td align="center" valign="middle" >3.7282 &#177; 0.1061</td><td align="center" valign="middle" >3.7282 &#177; 0.1061</td><td align="center" valign="middle" >3.7286 &#177; 0.1061</td><td align="center" valign="middle" >3.7282 &#177; 0.1061</td><td align="center" valign="middle" >3.7282 &#177; 0.1061</td></tr><tr><td align="center" valign="middle" >健康人夜间</td><td align="center" valign="middle" >3.6286 &#177; 0.1636</td><td align="center" valign="middle" >3.6286 &#177; 0.1636</td><td align="center" valign="middle" >3.6285 &#177; 0.1638</td><td align="center" valign="middle" >3.6286 &#177; 0.1636</td><td align="center" valign="middle" >3.6286 &#177; 0.1636</td></tr><tr><td align="center" valign="middle" >P值</td><td align="center" valign="middle" >0.0427</td><td align="center" valign="middle" >0.0427</td><td align="center" valign="middle" >0.0420</td><td align="center" valign="middle" >0.0427</td><td align="center" valign="middle" >0.0427</td></tr></tbody></table></table-wrap><p>表3. 去趋势处理后HRV信号基本尺度熵统计结果(平均值 &#177; 标准差)</p><p>图5显示了平滑先验法消除RR间期信号在不同趋势前、后的近似熵的计算结果，具体统计计算结果分别如表4和表5所示。从表4可以看出，对于原始信号，即不含趋势的样本信号，健康人白天的近似熵值小于健康人夜间的近似熵值。经t检验，P (白天，夜间) &lt; 0.05，即近似熵可以区分开不同的两组样本。然而，当样本具有线性、幂律以及三种趋势叠加的混合趋势时，P (白天，夜间) &gt; 0.05，这表明近似熵易受到信号中不同趋势影响，使得近似熵不能准确的区分开健康人正常作息下的昼夜节律变化，体现出近似熵的不稳定性。作为比较，当我们使用平滑先验法去趋势处理后，如图5(b)所示，不论是HRV信号具有单一趋势或是具有由单一趋势叠加而成的混合趋势，近似熵值均保持恒定。如表5所示，经t检验，P (白天，夜间) &lt; 0.05。这说明平滑先验法消除信号中掺杂的趋势项效果明显，大大提高了近似熵分析的准确度和稳定性，使之具有了和基本尺度熵同等的优势，这为以后信号的非线性处理提供了一个很好的思路。</p><p>图5. 两组样本在去趋势处理前(a)和去趋势处理后(b)的近似熵</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> Approximate entropy statistical analysis of HRV signal</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >近似熵</th><th align="center" valign="middle" >原始信号</th><th align="center" valign="middle" >线性趋势</th><th align="center" valign="middle" >周期性趋势</th><th align="center" valign="middle" >幂律性趋势</th><th align="center" valign="middle" >混合趋势</th></tr></thead><tr><td align="center" valign="middle" >健康人白天</td><td align="center" valign="middle" >0.5462 &#177; 0.3586</td><td align="center" valign="middle" >0.0419 &#177; 0.0184</td><td align="center" valign="middle" >0.2774 &#177; 0.1734</td><td align="center" valign="middle" >0.0270 &#177; 0.0112</td><td align="center" valign="middle" >0.0366 &#177; 0.0201</td></tr><tr><td align="center" valign="middle" >健康人夜间</td><td align="center" valign="middle" >0.9766 &#177; 0.3643</td><td align="center" valign="middle" >0.0884 &#177; 0.0419</td><td align="center" valign="middle" >0.5617 &#177; 0.2209</td><td align="center" valign="middle" >0.0527 &#177; 0.0281</td><td align="center" valign="middle" >0.0744 &#177; 0.0396</td></tr><tr><td align="center" valign="middle" >P值</td><td align="center" valign="middle" >0.0014</td><td align="center" valign="middle" >0.2056</td><td align="center" valign="middle" >0.0196</td><td align="center" valign="middle" >0.4281</td><td align="center" valign="middle" >0.2013</td></tr></tbody></table></table-wrap><p>表4. HRV信号近似熵统计结果</p><table-wrap id="table5" ><label><xref ref-type="table" rid="table5">Table 5</xref></label><caption><title> Approximate entropy statistical analysis of HRV signals after detrending processin</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >近似熵</th><th align="center" valign="middle" >消除原始信号趋势</th><th align="center" valign="middle" >消除线性趋势</th><th align="center" valign="middle" >消除周期性趋势</th><th align="center" valign="middle" >消除幂律性趋势</th><th align="center" valign="middle" >消除混合趋势</th></tr></thead><tr><td align="center" valign="middle" >健康人白天</td><td align="center" valign="middle" >1.0462 &#177; 0.4066</td><td align="center" valign="middle" >1.0462 &#177; 0.4066</td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/1-2790056x89_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >1.0462 &#177; 0.4066</td><td align="center" valign="middle" >1.0462 &#177; 0.4066</td></tr><tr><td align="center" valign="middle" >健康人夜间</td><td align="center" valign="middle" >1.3480 &#177; 0.2510</td><td align="center" valign="middle" >1.3480 &#177; 0.2510</td><td align="center" valign="middle" >1.3466 &#177; 0.2508</td><td align="center" valign="middle" >1.3480 &#177; 0.2510</td><td align="center" valign="middle" >1.3480 &#177; 0.2510</td></tr><tr><td align="center" valign="middle" >P值</td><td align="center" valign="middle" >0.0232</td><td align="center" valign="middle" >0.0232</td><td align="center" valign="middle" >0.0238</td><td align="center" valign="middle" >0 .0232</td><td align="center" valign="middle" >0.0232</td></tr></tbody></table></table-wrap><p>表5. 去趋势处理后HRV信号近似熵统计结果</p></sec><sec id="s7"><title>5. 结论</title><p>本文首先通过对健康人昼夜节律下的心率变异性信号分别叠加不同的线性、周期性、幂律性趋势以及几种趋势的混合，运用近似熵和基本熵对其进行两种熵分析。结果表明近似熵对信号中存在的趋势较为敏感，即在趋势的掩盖下，严重影响了近似熵对HRV信号的复杂性分析；而基本熵受趋势影响较小，表现出良好的稳定性和有效性。当联合平滑先验去趋势方法之后，再次使用两种熵算法对健康人昼夜节律下的HRV信号叠加各类不同趋势进行分析时，研究结果发现：平滑先验法很好地消除了心率变异性信号中存在的各类趋势，使得近似熵对信号内部复杂性的区别有了很好的稳定性和分辨性；在不同趋势随机变化的影响下，近似熵在去趋势处理前、后熵值变化很大，而基本尺度熵在经过去趋势处理前、后的熵值变化均具有较高的稳定性。并且去趋势处理后，两种熵测度都可以区分开健康人白天和夜间的HRV信号。这充分体现出平滑先验法可以提高熵测度的稳定性和区分性，以后我们也可以研究平滑先验法是否能提高其他非线性分析方法的稳定性，为临床的生理病理诊断和以后的科学研究提供了又一良好的参考价值。</p></sec><sec id="s8"><title>基金项目</title><p>国家自然科学基金(批准号：61102094)、陕西省自然科学基金(批准号：2010JM1007)和中央高校基本科研业务费(批准号：GK200902053)资助的课题。</p></sec><sec id="s9"><title>文章引用</title><p>郭园园,李 锦,焦得钊. 基于平滑先验法的两种熵研究 Two Entropy Studies Based on Smooth Prior Approach[J]. 生物物理学, 2019, 07(01): 1-9. https://doi.org/10.12677/BIPHY.2019.71001</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.28723-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Acharya, U.R., Joseph, K.P., Kannathal, N., Lim, C.M. and Suri, J.S. (2006) Heart Rate Variability: A Review. Medical &amp; Biological Engineering &amp; Computing, 44, 1031-1051. &lt;br&gt;https://doi.org/10.1007/s11517-006-0119-0</mixed-citation></ref><ref id="hanspub.28723-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Mendia-Iztueta, I., Monahan, K., Kyrolainen, H., et al. (2016) Assessment of Heart Rate Variability Thresholds from Incremental Treadmill Tests in Five Cross-Country Skiing Techniques. PloS One, 11, e0145875.  
&lt;br&gt;https://doi.org/10.1371/journal.pone.0145875</mixed-citation></ref><ref id="hanspub.28723-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">宁新宝. 生物医学信号时间属性及其分析研究的进展[J]. 数据采集与处理, 2013, 28(5): 529-538.</mixed-citation></ref><ref id="hanspub.28723-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">张璇, 李锦, 徐文敏. 昼夜节律颠倒影响心率变异性信号的非线性特性研究[J]. 陕西师范大学学报(自科版), 2016, 44(2): 48-53.</mixed-citation></ref><ref id="hanspub.28723-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Matsoukas, C., Islam, S. and Iturbe, I.R. (2000) Detrended Fluctuation Analysis of Rainfall and Streamflow Tine Series. Journal of Geophysical Research, 105, 29165-29172. &lt;br&gt;https://doi.org/10.1029/2000JD900419</mixed-citation></ref><ref id="hanspub.28723-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Gu H, and Song B F. (2009) Study on Effectiveness Evaluation of Weapon Systems Based on Grey Relational Analysis and TOPSIS. Journal of Systems Engineering and Electronics, 20, 106-111.</mixed-citation></ref><ref id="hanspub.28723-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Huang, N.E., Shen, Z., Long, S.R., et al. (1998) The Empirical Mode Decomposition and the Hilbert Spectrum for Nonlinear and Non-Stationary Time Series Analysis. Proceedings of the Royal Society of London Series A, 454, 903-995. &lt;br&gt;https://doi.org/10.1098/rspa.1998.0193</mixed-citation></ref><ref id="hanspub.28723-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Tarvainen, M.P., Ranta-Aho, P.O. and Karjalainen, P.A. (2002) An Advanced Detrending Method with Application to HRV Analysis. IEEE Transactions on Biomedical Engineering, 49, 172-175. &lt;br&gt;https://doi.org/10.1109/10.979357</mixed-citation></ref><ref id="hanspub.28723-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">李锦, 宁新宝. 短时心率变异性信号的基本尺度熵分析[J]. 科学通报, 2005, 50(14): 1438-1441.</mixed-citation></ref><ref id="hanspub.28723-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Karjalainen, P.A. (1997) Regulatization and Bayesian Methods for Evoked Potential Estimation. Kuopio University, Kuopio, 50-52.</mixed-citation></ref><ref id="hanspub.28723-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">杨红超. 基于移动平台的心电信号实时监控系统[D]: [硕士学位论文]. 上海: 东华大学, 2013.</mixed-citation></ref><ref id="hanspub.28723-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Pincuse, S.M. (1991) Approximate Entropy as a Measure of System Complexity. Proceedings of the National Academy of Sciences of the United States of America, 88, 2297-2301. &lt;br&gt;https://doi.org/10.1073/pnas.88.6.2297</mixed-citation></ref><ref id="hanspub.28723-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Pincuse, S.M. and Goldberger, A.L. (1994) Physiological Time-Series Analysis: What Does Regularity Quantify? American Journal of Physiology-Heart and Circulatory Physiology, 266, 1643-1656.</mixed-citation></ref><ref id="hanspub.28723-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Li, J. and Ning, X.B. (2005) The Base-Scale Entropy Analysis of Short-Time Heart Rate Variability Signal. Chinese Science Bulletin, 50, 1269-1273. &lt;br&gt;https://doi.org/10.1360/982005-94</mixed-citation></ref><ref id="hanspub.28723-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">李锦, 刘大钊. 昼夜节律下心率变异性信号的熵信息和谱特征[J]. 物理学报, 2012, 61(20): 547-552.</mixed-citation></ref><ref id="hanspub.28723-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Wessel, N., Ziehmann, C., Kurths, J., Meyerfeldt, U., Schirdewan, A. and Voss, A. (2000) Short-Term Forecasting of Life-Threatening Cardiac Arrhythmias Based on Symbolic Dynamics and Fi-nite-Time Growth Rates. Physical Review E, 61, 733.</mixed-citation></ref><ref id="hanspub.28723-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Scheer, F.A., van Doornen, L.J. and Buijs, R.M. (1999) Light and Diurnal Cycle Affect Human Heart Rate: Possible Role for the Circadian Pacemaker. Journal of Biological Rhythms, 14, 202-212.  
&lt;br&gt;https://doi.org/10.1177/074873099129000614</mixed-citation></ref><ref id="hanspub.28723-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Guo, Y.F. and Stein, P.K. (2003) Circadian Rhythm in the Cardiovascular System: Chronocardiology. American Heart Journal, 145, 779-786. &lt;br&gt;https://doi.org/10.1016/S0002-8703(02)94797-6</mixed-citation></ref><ref id="hanspub.28723-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Jin, L. and Jun, W. (2013) Entropy Information of Heart Rate Variability and Its Power Spectrum during Day and Night. Europhysics, 103, Article ID: 28002.</mixed-citation></ref><ref id="hanspub.28723-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">李镒冲, 李晓松. 两种测量方法定量测量结果的一致性评价[J]. 现代预防医学, 2007, 34(17): 3263-3266.</mixed-citation></ref></ref-list></back></article>