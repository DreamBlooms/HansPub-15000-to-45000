<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2019.96121</article-id><article-id pub-id-type="publisher-id">CSA-30891</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20190600000_12789374.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  室内定位技术发展综述
  Review on the Development of Indoor Positioning Technology
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>丘</surname><given-names>建栋</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>梁</surname><given-names>嘉贤</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>柯</surname><given-names>尼</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>庄</surname><given-names>立坚</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>深圳市城市交通规划设计研究中心有限公司，广东 深圳</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>18</day><month>06</month><year>2019</year></pub-date><volume>09</volume><issue>06</issue><fpage>1072</fpage><lpage>1084</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   随着城市化的建设，大型室内场所由于其面积大、空间布局结构复杂等原因，人们对室内场所的定位需求日渐迫切，结合物联网技术的飞速发展和硬件技术的成熟，室内定位技术得到很多学者和机构的关注。本文对室内导航定位技术的发展进行系统介绍，包括室内定位技术、室内定位原理、室内定位算法模型和定位技术融合模型。最后对室内定位技术发展趋势进行了总结和展望。 As the urbanization construction, due to large area, complex space layout structure, and so on, of the large indoor places, people’s demand for indoor positioning is increasingly urgent. With the rapid development of Internet of things technology and the maturity of hardware technology, indoor positioning technology has attracted the attention of many scholars and institutions. This paper systematically introduces the development of indoor navigation and positioning technology, including indoor positioning technology, indoor positioning principle, indoor positioning algorithm model and positioning technology integration model. Finally, the development trend of indoor positioning technology is summarized and prospected. 
  
 
</p></abstract><kwd-group><kwd>室内定位技术，室内定位原理，室内定位技术融合, Indoor Positioning Technology</kwd><kwd> Indoor Positioning Principle</kwd><kwd> Integration of Indoor Positioning Technology</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>室内定位技术发展综述<sup> </sup></title><p>丘建栋<sup>*</sup>，梁嘉贤，柯尼，庄立坚</p><p>深圳市城市交通规划设计研究中心有限公司，广东 深圳</p><disp-formula id="hanspub.30891-formula68"><graphic xlink:href="//html.hanspub.org/file/5-1541421x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2019年6月1日；录用日期：2019年6月13日；发布日期：2019年6月24日</p><disp-formula id="hanspub.30891-formula69"><graphic xlink:href="//html.hanspub.org/file/5-1541421x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>随着城市化的建设，大型室内场所由于其面积大、空间布局结构复杂等原因，人们对室内场所的定位需求日渐迫切，结合物联网技术的飞速发展和硬件技术的成熟，室内定位技术得到很多学者和机构的关注。本文对室内导航定位技术的发展进行系统介绍，包括室内定位技术、室内定位原理、室内定位算法模型和定位技术融合模型。最后对室内定位技术发展趋势进行了总结和展望。</p><p>关键词 :室内定位技术，室内定位原理，室内定位技术融合</p><disp-formula id="hanspub.30891-formula70"><graphic xlink:href="//html.hanspub.org/file/5-1541421x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/5-1541421x8_hanspub.png" /> <img src="//html.hanspub.org/file/5-1541421x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着城市化的建设，越来越多的大型商务建筑、大型枢纽出现在人们的生活中，当人们在室内活动时，尤其是当人们进入大型超市、商场、展览馆、地下停车场等大型室内场所时，由于其面积较大，空间布局结构复杂，通道走廊交叉分布，人们难以较快得知自身的位置和周边的情况。GPS定位只能在室外接收卫星信号的位置，使得对室内定位导航技术的需求越来越迫切 [<xref ref-type="bibr" rid="hanspub.30891-ref1">1</xref>] 。上世纪90年代，剑桥AT&amp;T研究室提出的Active Badge系统——典型的基于红外线的室内定位系统，但红外线的视距传输特性使得系统要求物体必须和红外阅读器成一条直线，且定位精度不高 [<xref ref-type="bibr" rid="hanspub.30891-ref2">2</xref>] 。1998年，微软公司提出了基于RADAR的室内定位技术解决方案，利用了无线射频信号的强度值(RSSI)来进行测距定位 [<xref ref-type="bibr" rid="hanspub.30891-ref3">3</xref>] 。随着物联网技术的飞速发展和硬件技术的成熟，室内定位技术的发展得到了关注。2002年，加利福尼亚大学的学者提出了Calamari定位系统，将到达时间与RSSI两种定位技术进行了融合 [<xref ref-type="bibr" rid="hanspub.30891-ref4">4</xref>] ；2004年，香港科技大学研发了基于RFID技术的LANDMARC定位系统，通过在区域内放置活性参考标签，利用射频阅读器采样标签信息完成无线环境下的数据采集，进一步估算目标点位置 [<xref ref-type="bibr" rid="hanspub.30891-ref5">5</xref>] ；2006年，北京航空航天大学利用差值模型对RSS进行定位前预处理，提出Weyes定位系统，大大地提高了定位精度 [<xref ref-type="bibr" rid="hanspub.30891-ref6">6</xref>] ；2011年北京邮电大学提出室内外无缝衔接的TC-OFDM定位系统，水平定位精度达到 3 米以内，垂直定位精度可在1米以内 [<xref ref-type="bibr" rid="hanspub.30891-ref7">7</xref>] ；2013年，苹果公司推出了iBeacon技术，这项技术以蓝牙4.0为基础，获取用户准确位置信息，美国加州科学院和旧金山的Westfield购物中心先后开启了基于iBeacon的室内定位功能 [<xref ref-type="bibr" rid="hanspub.30891-ref8">8</xref>] ；在国内，很多公司也开发了基于iBeacon的室内定位产品，包括四月兄弟的“April Beacon”、智石科技的“Bright Beacon”和ebeoo的Beacon CS公共服务平台。推动iBeacon技术爆发性增长的是2015年，受益于几大互联网巨头公司的推动，腾讯公司利用iBeacon近场感知功能推出微信摇一摇，并在这基础上，开发了一系列互动、室内导航、餐饮行业搭配服务行业等场景化的营销方式。高德公司提出将为大型商场用户提供商场室内地图绘制、室内定位技术和室内路线导航等服务。阿里巴巴公司的逛街应用软件“喵街”上线，“喵街”则是利用了蓝牙iBeacon技术，提供用户在商场里的室内导航以及停车场的智能停车等服务。2016年3月，百度开发者中心提出了百度地图的室内定位技术，并已经将自身领先的室内定位技术应用在大型商场，结合蓝牙、地磁和Wi-Fi三种定位技术融一体进行混合定位，百度地图的室内地图目前已应用在北京地区的部分商场。</p><p>综上，室内定位技术已成为工业界和学术界的研究热点。因此，本文根据室内定位技术的主要研究内容进行回顾，包括室内定位技术、室内定位原理、室内定位算法模型和定位技术融合模型。</p></sec><sec id="s4"><title>2. 室内定位技术</title><sec id="s4_1"><title>2.1. 蓝牙iBeacon定位技术 [<xref ref-type="bibr" rid="hanspub.30891-ref9">9</xref>]</title><p>蓝牙是一种短距离无线通信技术。该技术遵循一种通用式的技术规范，任何两种设备只要遵循了该规范，两者之间就可进行短距离的无线数据通信。蓝牙技术最早由爱立信公司1994年发起，现已发展到了集传统蓝牙与低功耗于一体的蓝牙4.0。蓝牙4.0将三种规格集于一体，即传统蓝牙、高速连接与低功耗技术，强化了数据传输过程中的低功耗性能，使其成为设备之间进行短距离无线通信最简单便巧的方法，同时也是市场上支持范围最广、功能最丰富的无线标准。</p><p>iBeacon是一种信标设备，最早由苹果公司2013年提出。该技术主要通过在小型硬件设备上集成低功耗蓝牙模块，进而使该设备作为一个蓝牙基站设备来使用。当有终端目标设备进入该蓝牙基站设备信号所覆盖的区域后，终端设备的应用程序就会扫描到此基站的信号强度值和其它的一些广播数据。通过适当的布置多个蓝牙基站设备，就可形成一个大面积的蓝牙信号覆盖网络。当终端设备进入此网络并获取到多个蓝牙基站的广播数据后，就可以利用这些数据进行定位计算。</p><p>蓝牙iBeacon定位技术具备以下六大特征，如表1所示，包括1) 适用广泛；2) 功耗低；3) 定位精准延时少；4) 安全性高；5) 成本低；6) 设计开发难度小，市场推广性强。蓝牙定位的精度在很大程度上依赖于蓝牙信号传感器的布设密度，且信号传感器的电池有一定的使用周期，需要在定期更换，若更换不及时将会影响定位效果。对于复杂的空间环境，蓝牙定位系统的稳定性稍差，信号传输还容易受到噪声的影响。</p></sec><sec id="s4_2"><title>2.2. Wi-Fi定位技术 [<xref ref-type="bibr" rid="hanspub.30891-ref10">10</xref>]</title><p>Wi-Fi是一种允许电子设备连接到一个无线局域网(WLAN)的技术。1997年电气电子工程师协会IEEE为无线局域网制定了第一个版本标准802.11，该标准规定物理层工作在2.4 GHz频段上，可采用红外线、直接扩频方式和跳频扩频方式这三种物理介质。数据链路层采用载波监听多路访问/冲突检测(Carrier Sense Multiple Access/Collision Detect, CSMA/CA)机制。随着无线局域网技术的发展，工业界众多领先公司组成了Wi-Fi联盟，致力于解决符合标准的产品产和设备兼容性问题，802.11标准得到了补充和完善，并推出了一系列标准，出现了802.11a、802.11b、802.11e、802.11g等协议，其中802.11b 应用较为广泛。</p><p>Wi-Fi自上世纪90年代发明，经过不断地更新和推广，目前广泛用于城市公共接入热点，家庭以及办公网络，全面渗透人们每日的生活和出行，具有五大技术特征，包括1) 无需布线；2) 覆盖范围广；3) 传输速度快且稳定；4) 综合成本低；5) 稳定可靠，如表1所示。</p><p>Wi-Fi定位的精度和无线AP热点的密集程度有关，AP热点越密集，定位的效果越好，定位精度一般为3~5 m。但是，Wi-Fi定位的前提是用户终端在定位过程中需要始终打开Wi-Fi功能，一旦关闭就无法实现定位，对其依赖性强。</p></sec><sec id="s4_3"><title>2.3. 地磁定位技术 [<xref ref-type="bibr" rid="hanspub.30891-ref11">11</xref>]</title><p>地磁定位是利用地磁场的地磁三分量、地磁总场以及磁偏角等参数，量化地磁空间点的地磁场特征，进行准确定位。</p><p>在划分地磁场的时候，依据地磁场的不同特征，可以将其划分为以下两类：第一类，正常地磁场；第二类，异常地磁场。如果地壳异常场的规模较大，此时正常场就是指地核主磁场；如果区域异常场的规模较小，此时正常场是地核主磁场与异常场的组合。从空间角度而言，地壳异常场的分布具有复杂性特征，但地壳异常场的分布不会随着时间的发展而产生变化。由于异常场中的数据信息非常庞大，在构建数据基准地磁图时，往往以磁异常场为基础，如此有助于准确定位和导航。</p><p>在室内的情况下，利用室内环境所造成的异常地磁场环境，提供定位磁场特征依据。先使用带有磁场传感器的测量设备遍历待定位的区域，记录位置和磁场强度特征对应关系，并绘制磁场定位基准图，然后在实际定位过程中，通过节点的移动将即时搜集的一维磁场信息记录下来，通过对应信息处理手段，比较分析现场所测磁场资料于先前搜集并设计的地磁场基准图，依据一定的度量计算实时数据序列和地磁图中序列的相似度，在地磁图中匹配到相似度最高的数据序列对应的实际区域，最终实现目标定位。</p><p>利用地磁场作为位置匹配信息进行定位最开始于机器人自定位领域被提出，除了可以用作方向判断外，还可以利用地磁信息经过室内结构的扰动造成的特异性进行机器人的自定位，通过对地磁信息的收集和匹配，完成了在走廊中的大体位置的确定。随着地磁定位技术的不断发展，逐渐被人们所认知，越来越多的研究者投身于该领域，该技术的技术特征可归纳为：1) 无需硬件设备；2) 累积误差小；3) 成本较低，精度较高；4) 地磁数据采集量大；5) 技术门槛过高，如表1所示。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Indoor positioning technical characteristic</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >定位技术</th><th align="center" valign="middle" >蓝牙iBeacon定位技术</th><th align="center" valign="middle" >Wi-Fi定位技术</th><th align="center" valign="middle" >地磁定位技术</th></tr></thead><tr><td align="center" valign="middle" >定位精度</td><td align="center" valign="middle" >3~5米</td><td align="center" valign="middle" >3-10米</td><td align="center" valign="middle" >2-5米</td></tr><tr><td align="center" valign="middle" >安全性</td><td align="center" valign="middle" >较高</td><td align="center" valign="middle" >较高</td><td align="center" valign="middle" >较高</td></tr><tr><td align="center" valign="middle" >穿透性</td><td align="center" valign="middle" >一般</td><td align="center" valign="middle" >一般</td><td align="center" valign="middle" >无关</td></tr><tr><td align="center" valign="middle" >抗干扰</td><td align="center" valign="middle" >较弱</td><td align="center" valign="middle" >较强</td><td align="center" valign="middle" >极弱</td></tr><tr><td align="center" valign="middle" >功耗</td><td align="center" valign="middle" >较低</td><td align="center" valign="middle" >高</td><td align="center" valign="middle" >较低</td></tr><tr><td align="center" valign="middle" >辐射</td><td align="center" valign="middle" >较低</td><td align="center" valign="middle" >较高</td><td align="center" valign="middle" >无</td></tr><tr><td align="center" valign="middle" >传输距离</td><td align="center" valign="middle" >10米</td><td align="center" valign="middle" >30-50米</td><td align="center" valign="middle" >无关</td></tr><tr><td align="center" valign="middle" >优点</td><td align="center" valign="middle" >设备体积小、短距离、 低功耗、易集成、易部署</td><td align="center" valign="middle" >网络广泛、通行能力强</td><td align="center" valign="middle" >无硬件、无累积误差、低成本</td></tr><tr><td align="center" valign="middle" >缺点</td><td align="center" valign="middle" >传播距离短、稳定性差</td><td align="center" valign="middle" >易受环境干扰</td><td align="center" valign="middle" >地磁数据采集工作量大、 信号干扰、初始位置获取问题</td></tr><tr><td align="center" valign="middle" >应用场景</td><td align="center" valign="middle" >商场、交通枢纽、 会议与展馆、医院等</td><td align="center" valign="middle" >医疗机构、商场、 景区与园区</td><td align="center" valign="middle" >与其它定位技术融合的商业应用</td></tr></tbody></table></table-wrap><p>表1. 室内定位技术特征表</p></sec></sec><sec id="s5"><title>3. 室内定位原理</title><sec id="s5_1"><title>3.1. 基于信号时间和角度的定位原理</title><p>1) 基于到达时间(TOA) [<xref ref-type="bibr" rid="hanspub.30891-ref12">12</xref>]</p><p>基于到达时间TOA定位算法实现原理依赖于无线电理论的成熟，在二维空间中布置N个信号基站，当待定位终端处于信号基站的通讯范围内时，通过移动终端向三个已知坐标的基站发射无线信号，测量终端接收基站信号的时间，通过发射接收时间差计算出移动终端距离三个已知基站的距离，进而求出移动终端所在位置。</p><p>算法的重心之处是终端到信号基站之间的距离，而距离是由信号发射时刻和终端接收时刻的时间差计算而得，因此要求信号基站和终端之间的时钟严格同步，但是实际环境中，由于室内环境空间相对狭小，信号的传播受到障碍物的干扰，带来相应的传播时间延迟，也会带来时延的叠加，往往导致时间难以精确，因此算法在系统实现时对硬件的要求较高，系统复杂性较大，成本投入高。</p><p>2) 基于到达时间差(TDOA) [<xref ref-type="bibr" rid="hanspub.30891-ref13">13</xref>]</p><p>基于到达时间差TDOA算法是利用信号到达的时间差进行定位的方法，首先测得各个监测站发射的信号到达终端设备的时间差，采用广义互相关模型，即对待定位终端接收到的两组监测站的信号进行互相关计算，得到两者的时间差值。接收多组数据后进行整理，可得到关于待定位终端的双曲线方程组，而这个方程组的解就是待定位终端的位置。</p><p>该算法相对于TOA算法有了很大的改进。①该算法不需要设备之间有严格的时钟同步，降低了硬件成本。②该算法计算的是信号到达的时间差，这有效的抵消了多径效应带来的误差，提高了定位精度。③在TDOA算法中，接收信号装置的天线采用的是普通的检测天线，而不是复杂的测向天线。这不仅在一定程度上消除了天线间互耦的影响，同时也使系统结构变的较为简单。但是因为基于到达时间差算法的定位系统所需要的监测站组成中包括接收机、天线和时间同步模块，而这些模块如果集成在智能终端中，需要花费的成本将大幅度提升。</p><p>3) 基于到达角度(AOA) [<xref ref-type="bibr" rid="hanspub.30891-ref14">14</xref>]</p><p>到达角度定位法通常也被称为基于信号的到达方向角定位算法。该算法需要多个基站设备进行信号检测，并且这些基站设备都应该具有能够感知方向的天线阵列，这样才能够计算出目标节点所发射信号的到达角度。最终通过一组带有方向射线的交点来确定目标节点的位置。</p><p>该方法计算量较小，部署比较方便，而且还能够额外的提供目标节点的方向信息。但是该算法如果想要达到一定的定位精度，对基站天线阵列的灵敏度提出了较高的要求，这无疑是增加了硬件成本，使系统更加难以控制。与此同时，在室内环境中，由于周边环境的复杂多变，信号在传播过程中很容易受到这些复杂因素的影响，从而会对信号的到达角度产生很大的干扰。因此在室内环境下该法并不是最佳的选择。</p></sec><sec id="s5_2"><title>3.2. 基于信号强度指示(RSSI)定位原理 [<xref ref-type="bibr" rid="hanspub.30891-ref15">15</xref>]</title><p>由于室内环境十分复杂，经常有各种信号多径传播干涉，以及在近距离状态下参考时钟的不精确性导致距离将误差过大，因为这些不确定因素，使基于测距的传统方法如TOA、TDOA、AOA等方法在室内定位中误差过大。而基于接收信号强度指示RSSI的距离测量方法的基本工作原理是利用了RSSI值与距离之间存在的关系。在参考节点发射功率已知的前提下，待定位节点通过读取参考节点的RSSI值信息并把该信息代入RSSI-d关系模型就可获得参考节点与待定位节点之间的距离。其室内定位是一种通过获取接收信号强度指示，并将接收信号强度指示代入到所建立的传播路径损耗模型中，再利用相应的定位算法进行室内定位的方法。相比基于信号时间和角度的定位方法，基于RSSI的定位方法无需添加额外的硬件，具有检测设备成本低，测量信号稳定性好，定位方法简单等优点。基于接收信号强度指示RSSI距离测量技术的定位原理主要可分为两类：传播模型法和位置指纹法。</p><p>1) 基于传播模型定位</p><p>RSSI是接收信号的强度指示，信号要在室内环境中传播，由于室内环境复杂性的影响，信号传输时的波动和起伏都很大，对信号造成一定的损耗，要对其直接进行测量和监控比较困难，因此可采用空间传播模型进行建模，利用室内定位算法模型(详见第3章)进行室内定位，常见的空间传播模型主要有：传统室内路径损耗模型、多径衰落损耗模型、对数距离路径损耗模型、衰减因子模型、MK模型等。</p><p>2) 基于位置指纹定位</p><p>“位置指纹”是把实际环境中的位置和某种“指纹”联系起来，一个位置对应一个独特的指纹。这个指纹可以是单维或多维的，比如待定位设备在接收或者发送信息时，指纹可以是这个信息或信号的一个特征或多个特征(最常见的是信号强度)。</p><p>位置指纹定位可划分为两个阶段，一是离线阶段，系统在定位服务区域内选取一些位置点作为采集点，在每个采集点处设定一定的频率去采集一组信号强度数据，然后通过信号收集设备收集这些位置点上的射频指纹，并通过这些数据估算出每个釆集点的信号强度将这信号数据与釆集点的位置信息存入数据库中，构建信号位置指纹数据库。在离线阶段需要测量记录大量参考点的信号强度，若定位服务区域较大，则训练阶段工作量也会非常巨大；二是在线阶段，当移动设备发出定位请求时，会按一定的频率去采集一组信号强度数据，将移动设备收集到的带测点信号数据发送给服务器端，服务器端将该数据与已有位置指纹数据库中的指纹进行比对，然后结合某种匹配算法确定移动设备的位置，从而估算出待测点现在的位置。</p><p>基于信号强度的指纹定位方法，因为有信号指纹库，与基于传播模型的定位方法相比有更高的定位精度，但是它也有一些缺点。比如，在一般条件下，校准数据的数量越多，校准数据的质量越好，定位会更精确。但较多的校准数据必然带来人力工作量的增加。所以在离线阶段存在的主要挑战是如何处理校准数据让定位更加精确以及如何减少采集工作量。</p></sec></sec><sec id="s6"><title>4. 室内定位算法模型</title><sec id="s6_1"><title>4.1. 近邻法</title><p>近邻法是确定性定位匹配算法中最具代表性的一种算法，通过计算实时RSSI样本向量与数据库中各个指纹应的RSSI均值向最之间的欧式距离，得到距离最近或最相似的一个或多个指纹，再经过对选取指纹的位置坐标进行平均或加权平均得出待测点的位置。</p><p>1) 最近邻算法(NN算法)</p><p>最近邻算法(Nearest Neighborhood, NN)是最基本的近邻法。由公式(1)可计算出RSS测试样本向量与指纹均值向量间的欧式距离：</p><p>d i = ∑ j = 1 m ( R S S I i j &#175; − R S S I j ) 2 (1)</p><p>式中， R S S I j 为实时测量的第j个AP的RSSI值， R S S I i j &#175; 为在第i ( i = 1 , 2 , 3 , ⋯ , n )个参考点上来自于第j个AP的RSS均值，其值存储在数据库中，n为选取参考点个数，m为AP的个数。</p><p>2) K近邻算法(KNN算法)</p><p>K近邻算法(K Nearest Neighborhood, KNN)是基础NN算法的改进算法，在计算出各个参考点相对于实时RSSI值的欧式距离序列后，对距离序列进行升序排列，选取距离最小的前K (K = 2)个参考点作为候选点，对其位置信息进行均值处理后即可得到用户的最后位置坐标：</p><p>( x , y ) = 1 K ∑ i = 1 K ( x i , y i ) (2)</p><p>式中，(x, y)为第i个候选点所对应的：二维位置坐标，(x, y)为返回的用户二维位置坐标。</p></sec><sec id="s6_2"><title>4.2. 三点定位法</title><p>三点定位法通过测量已知不在同一直线上的三个点到未知节点的距离，求得未知节点的具体坐标。根据计算出的三条边的距离长度，结合三个节点已知的坐标，求出三个圆相交处的坐标，即未知节点所在的位置坐标。</p><p>图1. 三点定位法示意图</p><p>三个已知节点A、B、C的坐标分别为 ( x 1 , y 1 ) ， ( x 2 , y 2 ) ， ( x 3 , y 3 ) ，它们到未知节点(x, y)的直线距离分别是 d 1 ， d 2 ， d 3 ，如图1所示，据此假设可得出以下公式：</p><p>[ ( x 1 − x ) 2 + ( y 1 − y ) 2 ( x 2 − x ) 2 + ( y 2 − y ) 2 ( x 3 − x ) 2 + ( y 3 − y ) 2 ] = [ d 1 2 d 2 2 d 3 2 ] (3)</p><p>根据上式，可以求出未知节点的坐标为公式(4)所示：</p><p>[ x y ] = [ 2 ( x 1 − x 3 ) 2 ( y 1 − y 3 ) 2 ( x 2 − x 3 ) 2 ( y 2 − y 3 ) ] − 1 [ x 1 2 − x 3 2 + y 1 2 − y 3 2 + d 3 2 − d 1 2 x 1 2 − x 3 2 + y 2 2 − y 3 2 + d 3 2 − d 1 2 ] (4)</p></sec><sec id="s6_3"><title>4.3. 最小二乘法</title><p>当定位环境中包含三个或三个以上信标节点时，设信标节点坐标为 ( x 1 , y 1 ) , ( x 2 , y 2 ) , ( x 3 , y 3 ) , ⋯ , ( x k , y k ) ，待定位节点坐标为 ( x 0 , y 0 ) 。P到各个信标节点的距离分别为 d 1 , d 2 , d 3 , ⋯ , d k ，可建立以下方程组：</p><p>{ ( x 0 − x 1 ) 2 + ( y 0 − y 1 ) 2 = d 1 2                             ⋮ ( x 0 − x k ) 2 + ( y 0 − y k ) 2 = d k 2 (5)</p><p>分别用前面方程减去后面方程，得到结果为：</p><p>{ d 1 2 − d k 2 − ( x 1 2 + y 1 2 ) + ( x k 2 + y k 2 ) = 2 ( x k − x 1 ) x 0 + 2 ( y k − y 1 ) y 0                                                                                       ⋮ d k − 1 2 − d k 2 − ( x k − 1 2 + y k − 1 2 ) + ( x k 2 + y k 2 ) = 2 ( x k − x 1 ) x 0 + 2 ( y k − y k − 1 ) y 0 (6)</p><p>记上式为 A x = b ，其中：</p><p>A = [ 2 ( x k − x 1 ) 2 ( x k − x 2 ) ⋮ 2 ( x k − x k − 1 ) 2 ( y k − y 1 ) 2 ( y k − y 2 ) ⋮ 2 ( y k − y k − 1 ) ] ,   x = [ x 0 y 0 ] ,   b = [ x k 2 − x 1 2 + y k 2 − y 1 2 + d 1 2 − d k 2 x k 2 − x 2 2 + y k 2 − y 1 2 + d 2 2 − d k 2 ⋮ x k 2 − x k − 1 2 + y k 2 − y k − 1 2 + d k − 1 2 − d k 2 ] (7)</p><p>由于信号在测量过程中会存在误差，设误差向量为 N = b − A x ，则当误差向量值最小时，定位节点的坐标即为最优解。</p><p>根据最小二乘原理，设：</p><p>Q ( x ) = ‖ N ‖ 2 = ‖ b − A x ‖ 2 (8)</p><p>若要求最小值，对其求导得：</p><p>d Q ( x ) d x = 2 A A T x − 2 A b = 0 (9)</p><p>如果 A A T 非奇异，则可求得： x = ( A T A ) − 1 A T b 。求得的x坐标即为待定位节点的位置坐标。</p></sec></sec><sec id="s7"><title>5. 定位技术融合模型</title><p>为了适应室内环境的改变和满足不同应用场景的需求，同时弥补单一定位技术带来的局限性，多种定位技术的融合方案正被越来越多的学者研究和应用。</p><sec id="s7_1"><title>5.1. Wi-Fi定位与惯性传感器的融合模型</title><p>基于Wi-Fi和惯性传感器室内定位系统的设计如下图2所示，系统由定位终端(包含基于行人轨迹推算PDR算法)、服务器端(指纹定位算法和位置指纹数据库)、AP等几部分组成。</p><p>图2. 基于Wi-Fi和惯性传感器室内定位系统设计方案</p><p>用户水平手持定位终端行走，其定位流程为：</p><p>1) 确定待定位区域AP部署及提取室内墙元素数据：依据Wi-Fi室内传播模型建立模拟位置指纹数据库；</p><p>2) 将实时测量的RSSI值与指纹库RSSI值进行匹配，根据Wi-Fi指纹定位算法求解位置；</p><p>3) 根据惯性传感器采集到的加速度和方位角数据，定位终端采用PDR算法获得一个位置信息；</p><p>4) 定位终端利用融合算法输出用户位置信息，得到最终的定位位置，并显示在定位终端UI界面上。</p><p>其中，Wi-Fi指纹定位算法基于指纹数据库，工作模式主要分为两个步骤：离线阶段通过室内传播模型建立位置指纹数据库，在线匹配计算行人位置。基于传播模型的模拟指纹库建立在计算机上运行，并且用于仿真计算出每一个参考位置的无线信号强度估计值。在线定位阶段为了使实时测量的RSSI数据与位置指纹库中数据建立一一对应的映射关系，定位匹配算法结合了所有检测到的无线接入点信息。</p><p>基于惯性传感器室内定位技术主要采取航迹推算定位法(PDR算法)，因为它对传感器精度要求要低，且算法效率更高，这里不对PDR算法做详细介绍。</p><p>同GPS定位系统相似，基于Wi-Fi信号强度的室内定位系统具有低频响应特性。且可以实时输出行人的绝对位置坐标，且误差不随时间积累，但其主要缺点是由于无线信号易受障碍物(如墙壁家具等)遮挡而迅速减弱，同时易受到多路径效应等因素的干扰，使得Wi-Fi指纹定位时常解算的位置具有跳跃和者扎堆等不稳定现象。航位推算是以几何学原理为基础，通过传感器检测到惯性测量信号统计步数，估计每一步的步长和航向数据，通常使用其他的定位方法获取初始位置，再此基础上进行当前位置的推算，具有短时高精度的优点，但其主要缺点是定位推算结存在累积误差，其定位误差与行走距离成正比，无法满足长时间高精度定位要求。</p><p>设计基于Wi-Fi和PDR融合定位算法，利用二者较强的非相似性和互补性，可以充分发挥各自的优势。具体算法步骤算法如下，如图3所示：</p><p>1) 通过Wi-Fi指纹定位获取行人初始位置。</p><p>2) 当行人停止前行时通过Wi-Fi指纹多次定位的均值作为输出位置。</p><p>3) 由于PDR算法具有短时高精度的优势，因此当移动终端得到初始位置后，首先使用PDR推算行人位置。</p><p>4) 当使用一段时间通过PDR推算定位位置时，误差不断累积使得定位结果越来越偏离真是位置，因此需要设置一个合理的时间间隔t，避免带来累积误差，这里把行人行进5步作为间隔时间t。</p><p>5) 若时间间隔t和Wi-Fi定位精度不同时满足，则使用PDR定位，否则使用Wi-Fi + PDR定位融合，并重新计时。</p></sec><sec id="s7_2"><title>5.2. 蓝牙定位与Wi-Fi定位的融合模型</title><p>现在几乎每一部智能手机都具备蓝牙和Wi-Fi功能，蓝牙具有短距离定位精度较高，信号不易受干扰，目前正在蓬勃发展阶段，用途越来越广泛；Wi-Fi具有分布范围广，无需充电，信号较稳定，定位无误差累积等优势。若能将蓝牙和Wi-Fi定位所得结果有效的融合在一起，将会提高定位的精度。</p><p>在蓝牙和Wi-Fi分别独立完成定位的基础上，提出了两种基于决策层融合的蓝牙/Wi-Fi融合室内定位方法。首先在Wi-Fi模块进行定位时，在获取Wi-Fi接入点的信号强度值时加入一个卡尔曼滤波器，旨在剔除掉一些信号强度值大突变的跳动，改良原始数据，提高定位精度。在Wi-Fi和蓝牙模块分别独立进行定位后，在决策层对两者结果进行融合。这里给出了两种融合方案，下面进行详细介绍。</p><p>1) Wi-Fi实时信号强度测量的卡尔曼滤波优化</p><p>用户终端在某固定点测量得到的Wi-Fi接入点信号强度值大小并不稳定，存在波动，在实时定位阶段，一些突变跳动的点会造成定位精度下降，考虑采用某种方法剔除掉这些点。所以选择离散卡尔曼滤波器来对接收到的信号强度值进行优化。</p><p>卡尔曼滤波的实质可以理解为，将模型预测值与传感器测量得到的值进行加权求和，获得最佳估计</p><p>图3. 基于Wi-Fi和PDR融合定位算法流程图</p><p>值，同时此结果作为下一卡尔曼滤波周期的模型预测值，以此进行循环迭代。过程激励噪声协方差矩阵Q和观测噪声协方差矩阵R的选择决定了卡尔曼滤波效果的优劣，错误的选取Q和R的值会导致滤波发散。一般通过经验和实际实验，可以确定它们的取值。利用离散卡尔曼滤波器可以有效提出信号强度值数据中的突变数据和大的噪声波动，提高定位精度，尤其是动态定位时的定位精度。</p><p>2) 基于改进贝叶斯的蓝牙/Wi-Fi融合定位算法</p><p>在静态定位时，系统会得到大量的蓝牙和Wi-Fi定位结果，利用统计学中的原理可以从中得出最优的融合定位结果。贝叶斯统计理论给出了一种计算后验概率分布的方法，将观测值样本作为待估参数的总体样本，贝叶斯理论认为待估参数并不是一个确定的值，将其当做服从一定分布规律的随机变量，将经典统计中的概率视为条件概率。根据先验分布密度函数和样本观测值可以得出后验密度函数。因此，运用贝叶斯理论估算问题时，需要观测值样本及先验信息，其中先验信息的使用是关键环节。在室内定位范畴内，贝叶斯先验样本信息为蓝牙和Wi-Fi模块分别对同一点定位得到的两组坐标向量，记为</p><p>L w i f i = ( L w 1 , L w 2 , ⋯ , L w m ) ,     L b l e = ( L b 1 , L b 2 , ⋯ , L b m ) (10)</p><p>从样本数据中抽取n个坐标数据作为贝叶斯观测值样本，记为</p><p>Z = ( Z 1 , Z 2 , ⋯ , Z n ) (11)</p><p>得到观测值样本后，需要确定先验信息。共轭分布法是常用的一种确定参数估计的方法，若先验分布和后验分布都符合同一个概率分布组，那么就称先验分布和后验分布是共轭分布的，先验分布 π ( θ ) 和似然函数 f ( Z | θ ) 是共轭的。可以通过样本Z确定参数θ的似然函数 f ( Z | θ ) ，根据共轭分布表确定共轭分布簇后，再得到先验分布，最后根据贝叶斯定理，得到后验分布 h ( θ | Z ) 。</p><p>这里将蓝牙和Wi-Fi得到的两组坐标向量中所有值求平均μ，定为坐标原点，计算每个坐标点到坐标原点的距离，看作定位偏差，假设偏移距离服从高斯分布， D ∼ N ( 0 , σ 2 ) ，记 θ = σ 2 ，则样本观测值的条件密度概率为</p><p>f ( D | θ ) = 1 2 π θ exp ( − D 2 / 2 θ ) (12)</p><p>根据共轭分布表，其先验分布为逆伽马分布， θ ∼ Γ ( α , β ) ， θ &gt; 0 , α &gt; 0 , β &gt; 0 ，则</p><p>π ( θ ) = β α θ − ( α + 1 ) e − β / θ Γ ( α ) (13)</p><p>因为 D ∼ N ( 0 , σ 2 ) ，服从零均值的高斯分布，可以认为 D 2 = ( d 1 2 , d 2 2 , ⋯ , d m 2 ) 为取自总体 θ ∼ Γ ( α , β ) 的一个样本，用矩法对逆伽马分布中的参数α，β做估计，可得</p><p>α ^ = E ( θ ^ ) [ 1 + E ( θ ^ ) D ( θ ^ ) ] ,       β ^ = 2 + E ( θ ^ ) 2 D ( θ ^ ) (14)</p><p>根据上式可以分别得到蓝牙定位和Wi-Fi定位的先验分布 π b ( θ ) 和 π w ( θ ) ，根据先验分布和先验信息源样本 L b l e 和 L w i f i ，进行信息的融合。令样本信息L和Z的分布函数分别为F(L)和F(Z)，m&gt;n。这里使用假设检验：</p><p>原假设为：</p><p>H 0 / F ( L ) ≡ F ( Z ) (15)</p><p>备选假设为</p><p>H 1 / 样 本   L   和 样 本   Z   不 属 于 同 一 总 体 (16)</p><p>将Wi-Fi定位样本 L b l e 和 L w i f i 分别与样本Z合并在一起成为两个混合样本，记为 M b l e 和 M w i f i ，设 Z 1 , Z 2 , ⋯ , Z n 在混合样本M中的秩为 T = r 1 , r 2 , ⋯ , r n ，令 T = r 1 , r 2 , ⋯ , r n ，则T被称作样本Z的秩和。秩和T近似服从高斯分布， T ∼ N ( n ( m + n + 1 ) / 2 , m n ( m + n + 1 ) / 12 ) ，可以运用正态分布的U检验，显著水平为α，据情况设定，在 1 − α / 2 的置信度下时，认为假设 H 0 / F ( L ) ≡ F ( Z ) 成立，即两样本属于同一总体。</p><p>由上述可以知道，在Wi-Fi定位的先验信息条件下，Wi-Fi先验样本信息和样样本信息Z属于同一个分布的概率为 P ( H 0 | M w ) = 1 − α w ，不属于同一个分布的概率为 α w ；在蓝牙定位的先验信息条件下，蓝牙先验样本信息和抽样样信息Z属于同一个分布的概率为 P ( H 0 | M b ) = 1 − α b ，不属于同一个分布的概率为 α b 。以此可以得到Wi-Fi定位的可信度 ω w 和蓝牙定位 ω b 的可信度。</p><p>由上文可知，Wi-Fi和蓝牙定位的距离偏差平方的先验分布分别为 π w ( θ ) 和 π b ( θ ) ，可以得到融合的先验分布</p><p>π ( θ ) = ω w π w ( θ ) + ω b π b ( θ ) (17)</p><p>对Wi-Fi定位的先验坐标值和蓝牙定位的先验坐标值进行加权计算，得到融合的先验坐标值。得到先验坐标值后，将Z与坐标原点，即坐标均值的间距记做 Δ D = ( Δ d 1 , Δ d 2 , ⋯ , Δ d n ) ，根据条件密度函数和先验分布函数，得到后验密度函数</p><p>h ( θ | Δ D ) ∼ Γ ( α + n / 2 , β + s / 2 ) (18)</p><p>利用贝叶斯估计求θ的估计值时，选择平方损失函数，即θ的贝叶斯估计值为后验分布的数学期望：</p><p>θ ^ = E ( θ | D ) = 2 α + s 2 β + n − 2 = w E ( θ ) + v σ ^ 2 (19)</p><p>从以上公式可以得出，后验分布数学期望可看作是先验分布数学期望和抽样样本信息的加权求和，抽样样本容量决定了权值w和v的大小，当抽样样本容量n增大时，w减小，v增加；当抽样样本容量n减小时，w增大，v减小。为先验分布均值，为抽样样本中参数的无偏估计。利用上式可以得到Wi-Fi定位和蓝牙定位融合后的坐标偏移估计，结合先验定位坐标，可以得出最终的融合定位坐标</p><p>x = x &#175; + θ ^ x y = y &#175; + θ ^ y (20)</p></sec></sec><sec id="s8"><title>6. 结语</title><p>随着室内定位的需求持续增加，结合人们的生活服务目的，室内定位相关的研究和技术的发展将呈现以下几个趋势：</p><p>1) 由于各种室内定位在不同方面的优势和精确度，用户可基于不同的使用需求选择合适的定位方式，综合技术更新和推广趋势，基于低功耗蓝牙4.0的室内定位技术将逐渐成为室内定位的主流方式，得到越来越广泛的应用，未来该项技术将会引入信息的推送、移动室内导航、移动支付等服务应用，为学校、商场、养老院、智慧社区等日常场所提供更加个性化的服务。</p><p>2) 混合定位将成为流行，以适应室内环境的改变和满足不同应用场景的需求，同时弥补单一定位技术带来的局限性。目前，基于结合Wi-Fi技术、蓝牙技术、惯性导航和GPS定位技术混合的定位方案正在被研究，更加完整地满足用户的需求，实现室内外环境中定位的无缝切换，并根据定位精度的高低需求实现随意转换精度。</p><p>3) 情境检测和室内定位的分离与独立。采用独立的芯片进行情境感知、数据融合、运动信息和定位处理等，减少数据感知层对定位应用处理器的唤醒次数，实现优化和降低功耗的作用。</p><p>4) 定位应用场景综合化。未来在线下将开展综合布局，面向商场、停车场、大型超市、火车站和养老社区等提供完整的室内定位解决方案，提供免费的室内地图、定位导航、商业广告、消息推送等服务。</p></sec><sec id="s9"><title>致谢</title><p>感谢深圳市科技计划项目(项目编号JSGG20170413170917828，项目名称“室内停车位导航的关键技术研发”)的资助。</p></sec><sec id="s10"><title>文章引用</title><p>丘建栋,梁嘉贤,柯 尼,庄立坚. 室内定位技术发展综述Review on the Development of Indoor Positioning Technology[J]. 计算机科学与应用, 2019, 09(06): 1072-1084. https://doi.org/10.12677/CSA.2019.96121</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.30891-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">卢伟, 魏峰远, 张硕, 等. 室内路网模型的构建方法研究与实现[J]. 导航定位学报, 2014, 2(4): 63-67.</mixed-citation></ref><ref id="hanspub.30891-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Want, R. (1992) Active Badges and Personal Interactive Computing Objects. IEEE Transactions on Consumer Electronics, 38, 10-20.</mixed-citation></ref><ref id="hanspub.30891-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Edrich, M. and Schroeder, A. (2013) Multiband Multistatic Passive Radar System for Airspace Surveillance: A Step towards Mature PCL Imple-mentations. International Conference on Radar, Adelaide, 9-12 September 2013, 218-223.  
&lt;br&gt;https://doi.org/10.1109/RADAR.2013.6651988</mixed-citation></ref><ref id="hanspub.30891-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Yuasa, M. and Ohyama, M. (2005) Support Tool Using Positions of Con-tents for Voice/Gaze-Controlled Browsers. IEEE Region 10 Conference, Melbourne, 21-24 November 2005, 1-6. &lt;br&gt;https://doi.org/10.1109/TENCON.2005.301315</mixed-citation></ref><ref id="hanspub.30891-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Ni, L.M., Liu, Y., Lau, Y.C., et al. (2004) LANDMARC: Indoor Location Sensing Using Active RFID. Proceedings of the 1st IEEE International Conference on Pervasive Computing and Communications, Fort Worth, 26 March 2003, 407-415. &lt;br&gt;https://doi.org/10.1023/B:WINE.0000044029.06344.dd</mixed-citation></ref><ref id="hanspub.30891-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">郎昕培, 许可. 基于无线局域网的位置定位技术研究和发展[J]. 计算机科学, 2006, 33(6): 21-24.</mixed-citation></ref><ref id="hanspub.30891-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">邓中亮, 尹露. 基于TC-OFDM体制的室内定位系统[J]. 电信网技术, 2015(3): 32-35.</mixed-citation></ref><ref id="hanspub.30891-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">牛帅. iBeacon: 室内定位新利器[J]. 世界知识, 2013(23): 11.</mixed-citation></ref><ref id="hanspub.30891-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Deng, Z., Fu, X. and Wang, H. (2018) An IMU-Aided Body-Shadowing Error Compensation Method for Indoor Bluetooth Positioning. Sensors, 18, pii: E304. &lt;br&gt;https://doi.org/10.3390/s18010304</mixed-citation></ref><ref id="hanspub.30891-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">郑玉峰. 基于WLAN的室内定位技术研究与实现[D]: [硕士学位论文]. 北京: 北京邮电大学, 2017.</mixed-citation></ref><ref id="hanspub.30891-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">刘钊, 陈卫卫, 李志刚. 一种基于磁场信息匹配的返航导航算法[J]. 军事通信技术, 2016, 37(1): 80-84.</mixed-citation></ref><ref id="hanspub.30891-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Venkatraman, S., Jr., J.C. and You, H.R. (2004) A Novel TOA Location Algorithm Using LOS Range Estimation for NLOS Environments. IEEE Transactions on Vehicular Technology, 53, 1515-1524.  
&lt;br&gt;https://doi.org/10.1109/TVT.2004.832384</mixed-citation></ref><ref id="hanspub.30891-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Ho, K.C. (1993) Solution and Performance Analysis of Geolocation by TDOA. IEEE Transactions on Aerospace and Electronic Systems, 29, 1311-1322. &lt;br&gt;https://doi.org/10.1109/7.259534</mixed-citation></ref><ref id="hanspub.30891-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Rodríguez-Navarro, D., Lázaro-Galilea, J., De-La-Llana-Calvo, Á., et al. (2017) Indoor Positioning System Based on a PSD Detector, Precise Positioning of Agents in Motion Using AoA Techniques. Sensors, 17, pii: E2124.  
&lt;br&gt;https://doi.org/10.3390/s17092124</mixed-citation></ref><ref id="hanspub.30891-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Wu, Z., Fu, K., Jedari, E., et al. (2016) A Fast and Resource Efficient Method for Indoor Positioning Using Received Signal Strength. IEEE Transactions on Vehicular Technology, 65, 9747-9758.</mixed-citation></ref></ref-list></back></article>