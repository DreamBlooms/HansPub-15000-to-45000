<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">PM</journal-id><journal-title-group><journal-title>Pure  Mathematics</journal-title></journal-title-group><issn pub-type="epub">2160-7583</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/PM.2020.105067</article-id><article-id pub-id-type="publisher-id">PM-35791</article-id><article-categories><subj-group subj-group-type="heading"><subject>PM20200500000_34933336.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于等价性检验和特征聚类的《红楼梦》作者分析
  An Analysis of the Authors of A Dream of Red Mansions Based on Equivalence Checking and Feature Clustering
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>程</surname><given-names>东波</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>柯</surname><given-names>小玲</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>林</surname><given-names>施鑫</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>null</addr-line></aff><aff id="aff1"><addr-line>闽江学院数学与数据科学学院，福建 福州</addr-line></aff><pub-date pub-type="epub"><day>30</day><month>04</month><year>2020</year></pub-date><volume>10</volume><issue>05</issue><fpage>549</fpage><lpage>555</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   引入等价性检验模型，选取“红”、“玉”二字统计频数，计算检验统计量U与p值。根据U检验值与概率对照表，初步得出前80章与后40章存在差异，并非一人所著。同时选取K均值聚类与凝聚聚类，根据词频聚类出多种情况。结果表明，《红楼梦》全书使用词频均存在着差异，其作者不止一人。 The equivalence checking model is introduced to calculate the test statistics U and p values by se-lecting the statistical frequency of “red” and “jade”. According to U-tests and probability compara-tive table, differences between the first 80 chapters and the last 40 chapters are preliminarily concluded. Many cases are clustered by word frequency with K-means clustering and agglomerative clustering. The results show that there are differences in word frequency used in A Dream of Red Mansions, and there is more than one author. 
 
</p></abstract><kwd-group><kwd>等价性检验，特征聚类，K-均值聚类，凝聚聚类, Equivalence Checking</kwd><kwd> Feature Clustering</kwd><kwd> K-Means Clustering</kwd><kwd> Agglomerative Clustering</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于等价性检验和特征聚类的《红楼梦》作者分析<sup> </sup></title><p>程东波，柯小玲<sup>*</sup>，林施鑫</p><p>闽江学院数学与数据科学学院，福建 福州</p><p>收稿日期：2020年4月27日；录用日期：2020年5月20日；发布日期：2020年5月27日</p><disp-formula id="hanspub.35791-formula43"><graphic xlink:href="//html.hanspub.org/file/19-1251041x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>引入等价性检验模型，选取“红”、“玉”二字统计频数，计算检验统计量U与p值。根据U检验值与概率对照表，初步得出前80章与后40章存在差异，并非一人所著。同时选取K均值聚类与凝聚聚类，根据词频聚类出多种情况。结果表明，《红楼梦》全书使用词频均存在着差异，其作者不止一人。</p><p>关键词 :等价性检验，特征聚类，K-均值聚类，凝聚聚类</p><disp-formula id="hanspub.35791-formula44"><graphic xlink:href="//html.hanspub.org/file/19-1251041x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/19-1251041x8_hanspub.png" /> <img src="//html.hanspub.org/file/19-1251041x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>《红楼梦》是中国古典四大名著之一，清代作家曹雪芹创作的章回体长篇小说。由于其在传播和保留过程中出现缺失，当下普遍的观点是前80回是曹雪芹所著，高鹗续写后40回。</p><p>前人的论述已经多从文学用语和数理统计学两大方面反复地论证过，并且得出结论：《红楼梦》前80回与后40回的作者并非同一人，甚至《红楼梦》全书也非一个作者所著。瑞典汉学家高本汉(B. Karlgren) 早在1952 年用统计学方法分析了32个语法和京话与口语词汇的用字习惯，认为全部120回均为曹雪芹所著 [<xref ref-type="bibr" rid="hanspub.35791-ref1">1</xref>]；而胡适先生在20世纪20年代用文本的文学分析和文献考证方法认定前80回为曹雪芹所著，而后40回为高鹗所著 [<xref ref-type="bibr" rid="hanspub.35791-ref2">2</xref>]；至今，更加有人认为，前80回也并非出自同一人之手 [<xref ref-type="bibr" rid="hanspub.35791-ref3">3</xref>]。</p><p>采用统计方法进行研究的主要有：李国强 [<xref ref-type="bibr" rid="hanspub.35791-ref4">4</xref>] 等根据《红楼梦》的词频及其相关性进行研究，得到前中后各40回的相关度很高，但两两相关度很低的结论。而施建军 [<xref ref-type="bibr" rid="hanspub.35791-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.35791-ref6">6</xref>] 利用支持向量机方法得到了前80回和后40回在写作风格上存在明显差别的结论，但其聚类方法不能为判断作者提供可靠的依据。叶雷 [<xref ref-type="bibr" rid="hanspub.35791-ref7">7</xref>] 则使用文体特征进行K-means聚类，得到了后40回不是前80回作者所著的结论。</p><p>本文主要利用特征聚类对《红楼梦》前80回和后40回进行文本分析。分析《红楼梦》120回的词量、词频，确认其是否为同一作者所著，并用等价性检验模型进行验证。</p></sec><sec id="s4"><title>2. 基于等价性检验的《红楼梦》作者分析模型</title><sec id="s4_1"><title>2.1. 数据预处理</title><p>统计全文中“红”、“玉”的字频，得到表1所示数据。根据表1的数据可以绘制“红”、“玉”二字在前80回和后40回的频率，如图1所示。由此，容易看出“红”、“玉”两字在前80回与后40回的频率存在差异。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Statistics of frequency of “red” and “jade” in the full tex</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >前80回</th><th align="center" valign="middle" >后40回</th><th align="center" valign="middle" >前80回频率</th><th align="center" valign="middle" >后40回频率</th></tr></thead><tr><td align="center" valign="middle" >“红”</td><td align="center" valign="middle" >470</td><td align="center" valign="middle" >153</td><td align="center" valign="middle" >0.0838%</td><td align="center" valign="middle" >0.0553%</td></tr><tr><td align="center" valign="middle" >“玉”</td><td align="center" valign="middle" >3264</td><td align="center" valign="middle" >1720</td><td align="center" valign="middle" >0.5817%</td><td align="center" valign="middle" >0.6217%</td></tr><tr><td align="center" valign="middle" >合计</td><td align="center" valign="middle" >3734</td><td align="center" valign="middle" >1873</td><td align="center" valign="middle" >0.6655%</td><td align="center" valign="middle" >0.6770%</td></tr><tr><td align="center" valign="middle" >总字数</td><td align="center" valign="middle" >561,093</td><td align="center" valign="middle" >276,659</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表1. 全文中“红”和“玉”的频数统计表</p><p>图1. 《红楼梦》中“红”“玉”二字在前80回频率和后40回频率</p></sec><sec id="s4_2"><title>2.2. 等价性检验模型的建立与求解</title><p>选取等价性检验模型，假设前80章与后40章两个样本并未存在显著差异，即作者为同一人。根据表1，《红楼梦》前80章回和后40章回的“红”字和“玉”字出现的频数分析数理统计学的问题，求解等价性检验模型。这一检验问题可化为两个相互独立的二项总体的等价性检验，此时： X 1 ~ b ( n 1 , p 1 ) 表示前80回的二项分布，其中 n 1 = 561093 ， X 1 表示前80章回的“红”字出现的频数，其实测值为 x 1 = 470 ， p 1 表示前80章回“红”字出现的频率； X 2 ~ b ( n 2 , p 2 ) 表示后40回的二项分布，其中 n 2 = 276659 ， X 2 表示后40章回的“红”字出现的频数，其实测值为 x 2 = 153 ， p 2 表示后40章回“红”字出现的频率。</p><p>采用渐进正态检验，计算检验统计量U，进而计算检验的p值，即：否定原假设而犯错误的概率。解得记“红”字的检验统计量 U 1 ≈ 4.494465 。重复上述步骤解得“玉”字的检验统计量 U 2 ≈ 2.238018 。等价性检验模型的U检验值与概率对照表如表2所示。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Comparison between U test value and probabilit</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >U检验值</th><th align="center" valign="middle" >p-值</th><th align="center" valign="middle" >可信概率%</th></tr></thead><tr><td align="center" valign="middle" >2.4360</td><td align="center" valign="middle" >0.0074</td><td align="center" valign="middle" >99.26%</td></tr><tr><td align="center" valign="middle" >2.3590</td><td align="center" valign="middle" >0.0092</td><td align="center" valign="middle" >99.08%</td></tr><tr><td align="center" valign="middle" >1.8622</td><td align="center" valign="middle" >0.0313</td><td align="center" valign="middle" >96.87%</td></tr><tr><td align="center" valign="middle" >1.5811</td><td align="center" valign="middle" >0.0569</td><td align="center" valign="middle" >94.31%</td></tr><tr><td align="center" valign="middle" >1.4325</td><td align="center" valign="middle" >0.0760</td><td align="center" valign="middle" >92.40%</td></tr></tbody></table></table-wrap><p>表2. U检验值与概率对照表</p><p>通过表2可得：U检验值越大，则可信概率就越大，即：拒绝原假设，差异就越显著。从数值模拟获得的数据分析，“红”、“玉”两字的U检验量足够大，表明前80回与后40回确实存在显著差异。</p><p>但无论观察图表，或是对照等价性检验的结论，都可以发现其中明显的问题：等价性检验所呈现的结果存在偏差，寻找其原因也能很容易发现，“玉”字与主角名字有很大的关系，而主角之一的“林黛玉”在后40章已经去世，这就对这个字的频数造成一定的影响。</p><p>综上，该方法中存在两个缺陷。其一，适用性差。因为需要抽取样本逐一进行等价性检验，对多个样本重复操作的过程将会十分繁琐；其二，模型稳定性差。针对于“红”和“玉”两个样本，出现了U检验值不小的差异，足以说明不同样本之间存在的差异性会受到其余因素的影响，且每个样本之间可能会出现矛盾。</p><p>所以，进一步选取特征聚类验证继续验证猜想。</p></sec></sec><sec id="s5"><title>3. 基于聚类分析的《红楼梦》作者分析</title><sec id="s5_1"><title>3.1. 数据处理</title><p>以每十章回为样本，分别对特征词频进行统计，选取代词进行统计，结果如图2。</p><p>图2. 按照词性(词性)分词后统计的词频示例</p><p>根据分词结果统计每十回的代词词量，如下表3所示。</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Number of pronouns per decad</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >1~10回</th><th align="center" valign="middle" >11~20回</th><th align="center" valign="middle" >21~30回</th><th align="center" valign="middle" >31~40回</th><th align="center" valign="middle" >41~50回</th><th align="center" valign="middle" >51~60回</th><th align="center" valign="middle" >61~70回</th><th align="center" valign="middle" >71~80回</th><th align="center" valign="middle" >81~90回</th><th align="center" valign="middle" >91~100回</th><th align="center" valign="middle" >101~110回</th><th align="center" valign="middle" >111~120回</th></tr></thead><tr><td align="center" valign="middle" >218</td><td align="center" valign="middle" >188</td><td align="center" valign="middle" >158</td><td align="center" valign="middle" >169</td><td align="center" valign="middle" >155</td><td align="center" valign="middle" >187</td><td align="center" valign="middle" >179</td><td align="center" valign="middle" >174</td><td align="center" valign="middle" >139</td><td align="center" valign="middle" >148</td><td align="center" valign="middle" >148</td><td align="center" valign="middle" >163</td></tr></tbody></table></table-wrap><p>表3. 每十回的代词词量</p><p>其次，将各个代词的词频按照递减的顺序排列，选取词频排行前50的代词词频来作为第一次选取的特征向量，如图3。</p><p>图3. 第一特征向量</p><p>显然在第一特征向量的代词中，并不是每个样本的第一特征向量的元素都相同，因此进一步提取数据。在第一特征向量中，统计在每个样本中都出现的元素，如图4。</p><p>根据我们划分样本的方式，上图中的数字为12的即表示每个样本中都包含的元素。因此，将每个样本中都包含的元素作为第二特征向量，每个向量中包含27个元素，即为最终选取的特征向量。并将每个样本中的数据进行提取，最终的数据提取的结果如图5所示。</p><p>图4. 每个样本中包含的元素情况</p><p>图5. 最终选取的数据实例</p><p>根据选取的27个特征值，依次提取相应的词频，组成特征向量，如图6。</p><p>图6. 12个样本的特征向量数据</p></sec><sec id="s5_2"><title>3.2. K均值聚类和凝聚聚类的聚类结果分析</title><p>使用python机器学习模块Scikit-Learn模块进行求解。</p><p>将K均值聚类模型实例化，将处理后的特征向量应用到算法模型中，解得：</p><p>图7. K均值聚类两个类别的聚类情况</p><p>从图7来看，容易发现第21回到第80回分自然的分在了一个类别，而前20回却和后40回分在了一起，这说明：前20回合后40回有更好的相似性。这不符合预计结果，猜想可能原因是前80回内部存在相似性存在一定的差异。</p><p>为进一步分析上述结论的原因，现将特征向量应用到新的算法模型中，该算法模型训练3个簇，即3个类别。实验结果如下图8所示：</p><p>图8. K均值聚类三个类别的聚类情况</p><p>从图9的实验结果来看，我们很容易发现从第21回到80回内部存在一定的差异性，被分成了两个类别；而前20回和后40回仍被分在了一个类别。该实验结果只说明了：第21回到第80回内部存在差异性。</p><p>再次训练新的算法模型，该算法模型训练4个类别，实验结果如图9。</p><p>图9. K均值聚类四个类别的聚类情况</p><p>这个实验结果很明显看出，前80回合后40回内容存在差异，不是同一个人所著。但同时，前80回同样存在差异，因此我们可以以这个结果进一步进行猜想，《红楼梦》不仅有两个作者，可能存在两个以上的编撰者。</p><p>凝聚聚类算法的处理方式与K均值聚类的方式相似，将图6的特征向量应用到凝聚聚类算法模型中。分别试验聚成两个类、三个类、四个类的算法模型，实验结果如图10。</p><p>图10. 凝聚聚类分别聚成2，3，4个类别的聚类情况</p><p>从图10很容易发现：在采用凝聚聚类聚成3个类别的时候，能够很显然的体现出前80回和后40回作者不一，而在前80回中，前20回和其他60回作者存在差异。</p></sec></sec><sec id="s6"><title>4. 总结与展望</title><p>综合上述模型求解结果，等价性检验模型虽然作为数理统计中优秀的模型，但依旧有着不小的局限性，在处理多个样本的情况下，K均值聚类和凝聚聚类反而得到了优秀的结果。从最终的实验结果可以观察出，根据分析《红楼梦》前80回和后40回的部分词量和词频，可以表明《红楼梦》前80回和后40回并不是同一作者所著。除此之外，我们还发现，在前80回内的文章也存在着不小的差异。因此可以一定程度上表明，《红楼梦》不止一个作者所著。</p></sec><sec id="s7"><title>基金项目</title><p>闽江学院校长基金(103952018230)。</p></sec><sec id="s8"><title>文章引用</title><p>程东波,柯小玲,林施鑫. 基于等价性检验和特征聚类的《红楼梦》作者分析An Analysis of the Authors of A Dream of Red Mansions Based on Equivalence Checking and Feature Clustering[J]. 理论数学, 2020, 10(05): 549-555. https://doi.org/10.12677/PM.2020.105067</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.35791-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">胡适.《红楼梦考证》(改定稿) [M]. 北京: 北京出版社, 2015.</mixed-citation></ref><ref id="hanspub.35791-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Karlgren, B. (1952) New Excursions in Chinese Grammar. The Bulletin of the Museum of Far Eastern Antiquities, 24, 79.</mixed-citation></ref><ref id="hanspub.35791-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Koppel, M., Schler, J. and Argamon, S. (2009) Computational Methods in Authorship Attribution. Journal of the American Society for Information Science and Technology, 60, 9-26. &lt;br&gt;https://doi.org/10.1002/asi.20961</mixed-citation></ref><ref id="hanspub.35791-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">李国强, 李瑞芳. 基于计算机的词频统计研究——考证《红楼梦》作者是否唯一[J]. 沈阳化工学院学报, 2006, 20(4): 305-307.</mixed-citation></ref><ref id="hanspub.35791-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">施建军. 基于支持向量机技术的《红楼梦》作者研究[J]. 红楼梦学刊, 2011(5): 35-52.</mixed-citation></ref><ref id="hanspub.35791-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">施建军. 关于以《红楼梦》120回为样本进行其作者聚类分析的可信度问题研究[J]. 红楼梦学刊, 2010(5): 318-335.</mixed-citation></ref><ref id="hanspub.35791-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">叶雷. 基于计量文体特征聚类的《红楼梦》作者分析[J]. 红楼梦学刊, 2016(5): 312-324.</mixed-citation></ref></ref-list></back></article>