<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2020.910207</article-id><article-id pub-id-type="publisher-id">AAM-38288</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20201000000_61771736.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于多维放缩和长短期记忆网络的期货价格预测
  Futures Price Prediction Based on Multidimensional Scaling and Long Short-Term Memory Network
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>扈</surname><given-names>文</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>孙</surname><given-names>德山</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>辽宁师范大学数学学院，辽宁 大连</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>13</day><month>10</month><year>2020</year></pub-date><volume>09</volume><issue>10</issue><fpage>1798</fpage><lpage>1804</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    结合多维放缩方法构建长短期记忆网络(MDS-LSTM)模型，对黄金主连期货未来10日的收盘价格进行预测。首先选取黄金主连的12个指标，利用多维放缩对12个指标进行降维，然后建立MDS-LSTM、MDS-BP和LSTM神经网络模型对收盘价格进行预测，将三个模型的预测结果进行比较，结果表明MDS-LSTM模型的预测精度较高，能更好的预测期货的走势。
    Combined with the multidimensional scaling method, the long short-term memory network (MDS-LSTM) model is constructed to predict the closing price of gold main link futures in the next 10 days. First, 12 indexes of the gold main link are selected and dimension-reduction of the 12 indexes is carried out. Then, MDS-LSTM, MDS-BP and LSTM neural network models are established to predict the closing price. The comparison of the prediction results of the three models shows that the MDS-LSTM model has a higher prediction accuracy and can better predict the futures trend. 
  
 
</p></abstract><kwd-group><kwd>多维放缩，长短期记忆网络，BP神经网络, Multidimensional Scaling</kwd><kwd> Long Short-Term Memory Network</kwd><kwd> BP Neural Network</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>结合多维放缩方法构建长短期记忆网络(MDS-LSTM)模型，对黄金主连期货未来10日的收盘价格进行预测。首先选取黄金主连的12个指标，利用多维放缩对12个指标进行降维，然后建立MDS-LSTM、MDS-BP和LSTM神经网络模型对收盘价格进行预测，将三个模型的预测结果进行比较，结果表明MDS-LSTM模型的预测精度较高，能更好的预测期货的走势。</p></sec><sec id="s2"><title>关键词</title><p>多维放缩，长短期记忆网络，BP神经网络</p></sec><sec id="s3"><title>Futures Price Prediction Based on Multidimensional Scaling and Long Short-Term Memory Network<sup> </sup></title><p>Wen Hu, Deshan Sun</p><p>School of Mathematics, Liaoning Normal University, Dalian Liaoning</p><p><img src="//html.hanspub.org/file/15-2621354x4_hanspub.png" /></p><p>Received: Oct. 7<sup>th</sup>, 2020; accepted: Oct. 20<sup>th</sup>, 2020; published: Oct. 27<sup>th</sup>, 2020</p><p><img src="//html.hanspub.org/file/15-2621354x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>Combined with the multidimensional scaling method, the long short-term memory network (MDS-LSTM) model is constructed to predict the closing price of gold main link futures in the next 10 days. First, 12 indexes of the gold main link are selected and dimension-reduction of the 12 indexes is carried out. Then, MDS-LSTM, MDS-BP and LSTM neural network models are established to predict the closing price. The comparison of the prediction results of the three models shows that the MDS-LSTM model has a higher prediction accuracy and can better predict the futures trend.</p><p>Keywords:Multidimensional Scaling, Long Short-Term Memory Network, BP Neural Network</p><disp-formula id="hanspub.38288-formula28"><graphic xlink:href="//html.hanspub.org/file/15-2621354x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/15-2621354x7_hanspub.png" /> <img src="//html.hanspub.org/file/15-2621354x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>随着期货市场和期货行业改革的深入推进，期货行业将进入历史上最好的发展机遇期，期货行业将持续发展。人们也越来越关注期货的未来走势，希望可以提高收益，降低风险。近来，有许多文章都对期货价格的变化进行了研究。随着神经网络的发展，许多学者开始尝试使用神经网络模型对期货价格进行预测。</p><p>文宝石等 [<xref ref-type="bibr" rid="hanspub.38288-ref1">1</xref>] 对股票数据进行滤波、差分及积分处理后结合LSTM模型进行预测，并与原始的LSTM模型和ARIMA模型对比发现，对数据进行多维处理后的LSTM模型有更好的性能和预测精度。马元昊 [<xref ref-type="bibr" rid="hanspub.38288-ref2">2</xref>] 采用了多层LSTM模型对上证指数的后一日收盘价格进行预测，结果表明LSTM对股票的预测有强大的作用。肖争艳等 [<xref ref-type="bibr" rid="hanspub.38288-ref3">3</xref>] 纳入反应中国国情的扩展指标，应用贝叶斯向量自回归模型与LSTM模型，对GDP进行动态滚动预测和固定窗口预测，结果表明LSTM模型有更好的泛化能力。李洁等 [<xref ref-type="bibr" rid="hanspub.38288-ref4">4</xref>] 建立了基于后向传播的多时间尺度RNN模型，并对民航日客流量进行预测，并与其他几种方法对比发现该模型的预测精度更高。张可等 [<xref ref-type="bibr" rid="hanspub.38288-ref5">5</xref>] 利用主成分分析法提取特征，建立LSTM模型对动作识别领域的7个数据集进行分析与预测，并与KNN模型和SVM模型对比，结果表明LSTM模型降低了预测难度，提高了精度。戴邵武等 [<xref ref-type="bibr" rid="hanspub.38288-ref6">6</xref>] 引入经验模态分解法将数据分解成IMF分量和趋势项，构建LSTM模型对北京市PM2.5的浓度进行预测，与SVR模型相比较精度明显提高。</p></sec><sec id="s6"><title>2. 多维放缩和长短期记忆网络</title><sec id="s6_1"><title>2.1. 多维放缩</title><p>多维放缩(Multidimensional Scaling)是一种经典的降维方法，它可以使原始空间中样本的距离在低维空间中得到保持，因此它主要关注与高维数据内部的特征，致力于保留高维空间中的“相似度”信息。</p><p>假设m个样本在原始空间的距离矩阵为 D ∈ R m &#215; m ，其元素 d i j 表示样本 x i 和 x j 之间的距离，原始空间的维数为d。目标是获得样本在 d ′ 维空间的表示 Z ∈ R d ′ &#215; m , d ′ ≤ d ，且任意两个样本在 d ′ 维空间中的欧式距离等于原始空间中的距离，即 ‖ z i − z j ‖ = d i j 。</p><p>令 B = Z T Z ∈ R m &#215; m ，其中B为降维后样本的内积矩阵， b i j = z i T z j ，有</p><p>d i j 2 = ‖ z i ‖ 2 + ‖ z j ‖ 2 − 2 z i T z j = b i i + b j j − 2 b i j (1)</p><p>为了便于讨论，令降维后的样本Z被中心化，即 ∑ i m z i = 0 。显然矩阵B的行与列之和均为零，即 ∑ i = 1 m b i j = ∑ j = 1 m b i j = 0 ，则</p><p>∑ i = 1 m d i j 2 = ∑ i = 1 m b i i + m b j j − 2 ∑ i = 1 m b i j = t r ( B ) + m b j j (2)</p><p>∑ j = 1 m d i j 2 = ∑ j = 1 m b j j + m b i i − 2 ∑ j = 1 m b i j = t r ( B ) + m b i i (3)</p><p>∑ i = 1 m ∑ j = 1 m d i j 2 = ∑ i = 1 m ( t r ( B ) + m b i i ) = 2 m t r ( B ) (4)</p><p>其中， t r ( B ) = ∑ i m ‖ z i ‖ 2 。令</p><p>d i ⋅ 2 = 1 m ∑ j = 1 m d i j 2 (5)</p><p>d ⋅ j 2 = 1 m ∑ i = 1 m d i j 2 (6)</p><p>d ⋅ ⋅ 2 = 1 m 2 ∑ i = 1 m ∑ j = 1 m d i j 2 = 1 m 2 ( 2 m t r ( B ) ) = 2 m t r ( B ) (7)</p><p>于是由(1)~(7)可得</p><p>d i j = − 1 2 ( d i i 2 + d i ⋅ 2 − d ⋅ j 2 + d ⋅ ⋅ 2 ) (8)</p><p>由此即可通过原始空间的距离矩阵D求取内积矩阵B。</p><p>对矩阵B做特征分解， B = V Λ V T ，其中 Λ = d i a g ( λ 1 , λ 2 , ⋯ , λ d ) 为特征值构成的对角矩阵， λ 1 ≥ λ 2 ≥ ⋯ ≥ λ d ，V为特征向量矩阵。假定其中有d个非零特征值，它们构成对角矩阵 Λ * = d i a g ( λ 1 , λ 2 , ⋯ , λ d * ) ，令 V * 表示相应的特征向量矩阵，则Z可表示为 Z = Λ * 1 2 V * T ∈ R d * &#215; m 。</p><p>在现实应用中为了使降维的效果更好，仅需要降维后的距离与原始空间中的距离尽可能接近，不需要完全相等，则可取 d ′ ≤ d 个最大特征值构成的对角矩阵来表示Z。</p></sec><sec id="s6_2"><title>2.2. 长短期记忆网络</title><p>长短期记忆网络(Long Short-Term Memory)是特殊的递归神经网络，由于常规的递归神经网络不能有效的解决长时间的信息依赖问题，所以Hochreiter和Schmidhuber提出了能够解决长期依赖的长短期记忆网络。LSTM的主要结构如下：</p><p>图1. LSTM结构</p><p>LSTM最重要的结构是单元状态，如图1中横向穿过的一条直线。LSTM有特殊的门限结构，它可以有选择的让信息通过，LSTM有忘记门，输入门和输出门三种门限控制单元状态，分别对应图1中 f t ， i t 和 O t 。</p><p>忘记门 f t 根据上一时刻的输出 h t − 1 和当前时刻的输入 x t 判断哪些信息需要从单元状态中抛弃，它由sigmiod层决定，如图1中 σ 层，sigmoid层输出的数字为[0, 1]，1表示完全保留，0表示完全抛弃。 C t − 1 是上一时刻的状态值，它会随着时间的变化不断更新。</p><p>输入门 i t 决定单元状态哪些信息需要储存，它分为两步，首先输入sigmoid层决定哪些值需要更新，接下来在tanh层输入新的候选值，如图1中tanh层。下面通过忘记门和输入门选择的信息进行信息更新，变成下一时刻的新信息。</p><p>输出门 O t 首先经过sigmoid层决定单元状态哪些信息可以输出，接下来将单元状态中的信息输入到tanh函数中与sigmoid的门限值相乘，最终得到输出的信息。</p></sec></sec><sec id="s7"><title>3. 实证分析</title><sec id="s7_1"><title>3.1. 数据选取</title><p>选取黄金主连(au0001) 2009年4月14日至2020年9月25日共2785个交易日的数据。分别用开盘价、收盘价、最高价、最低价、成交量、MA.MA1、KDJ.K、KDJ.D、KDJ.J、MACD.DIFF、MACD.DEA、MACD.MACD等12个指标预测未来10日期货收盘价。在图2中可以看到黄金主连的收盘价格变化幅度较大，没有明显的规律。</p><p>图2. 黄金主连收盘价曲线</p></sec><sec id="s7_2"><title>3.2. MDS-LSTM模型</title><p>本文使用的软件为MATLAB。首先将数据进行标准化处理，消除量纲的影响，本文采用“最大最小</p><p>值”标准化方法，即 x ′ = x − x max x max − x min ，x为原始数据， x ′ 为标准化的数据， x max 为原始数据的最大值， x min</p><p>为原始数据的最小值。</p><p>将标准化后的数据进行MDS降维，首先用euclidean法计算距离矩阵，然后将数据进行降维处理，结果显示MDS方法将数据降到10维。将降维后的数据输入到LSTM神经网络中进行训练，选取前2775个数据作为训练样本，后10个数据作为测试样本，将收盘价作为输出，用前一日的特征指标预测后一日的期货收盘价格。由于Adam优化器非常适用于大规模数据，并且计算高效，所以MDS-LSTM模型选择Adam作为优化器，初始学习率为0.005，迭代次数为200次，结果如图3。</p><p>图3. MDS-LSTM预测结果</p></sec><sec id="s7_3"><title>3.3. 模型对比</title><p>为了验证MDS-LSTM模型的效果，选取了MDS-BP模型与LSTM模型进行预测并与MDS-LSTM模型对比。MDS-BP模型选用newff法建立网络，用tansig训练隐藏层，purelin训练输出层，预测结果如图4。LSTM模型仍然选用Adam作为优化器，初始学习率为0.005，迭代次数为200次，预测结果如图5。</p><p>图4. MDS-BP预测结果</p><p>图5. LSTM预测结果</p><p>将MDS-BP模型和LSTM模型与MDS-LSTM模型进行对比，结果如图6。未来10日具体预测见表1，可以发现MDS-LSTM模型的预测效果更好，而且在期货价格波动较大时仍然有很好的拟合能力。</p><p>图6. 预测结果对比</p><table-wrap-group id="1"><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Comparison of prediction results over the next 10 day</title></caption><table-wrap id="1_1"><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >日期</th><th align="center" valign="middle" >真实值</th><th align="center" valign="middle" >MDS-LSTM</th><th align="center" valign="middle" >MDS-BP</th><th align="center" valign="middle" >LSTM</th></tr></thead><tr><td align="center" valign="middle"  rowspan="4"  >收 盘 价</td><td align="center" valign="middle" >2020.09.14</td><td align="center" valign="middle" >418.4400024</td><td align="center" valign="middle" >416.6134940</td><td align="center" valign="middle" >410.7366933</td><td align="center" valign="middle" >418.2308894</td></tr><tr><td align="center" valign="middle" >2020.09.15</td><td align="center" valign="middle" >419.7999878</td><td align="center" valign="middle" >416.5873396</td><td align="center" valign="middle" >410.6892847</td><td align="center" valign="middle" >418.3314404</td></tr><tr><td align="center" valign="middle" >2020.09.16</td><td align="center" valign="middle" >418.6400146</td><td align="center" valign="middle" >418.4739030</td><td align="center" valign="middle" >411.5838850</td><td align="center" valign="middle" >420.2919537</td></tr><tr><td align="center" valign="middle" >2020.09.17</td><td align="center" valign="middle" >415.6199951</td><td align="center" valign="middle" >417.0158520</td><td align="center" valign="middle" >410.9820331</td><td align="center" valign="middle" >420.6829135</td></tr></tbody></table></table-wrap><table-wrap id="1_2"><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="6"  >收 盘 价</th><th align="center" valign="middle" >2020.09.18</th><th align="center" valign="middle" >416.9200134</th><th align="center" valign="middle" >413.5560229</th><th align="center" valign="middle" >409.1707151</th><th align="center" valign="middle" >418.9971440</th></tr></thead><tr><td align="center" valign="middle" >2020.09.21</td><td align="center" valign="middle" >417.0100085</td><td align="center" valign="middle" >413.9966112</td><td align="center" valign="middle" >410.1771442</td><td align="center" valign="middle" >417.9316855</td></tr><tr><td align="center" valign="middle" >2020.09.22</td><td align="center" valign="middle" >407.5799866</td><td align="center" valign="middle" >414.7578599</td><td align="center" valign="middle" >409.9432455</td><td align="center" valign="middle" >418.0118737</td></tr><tr><td align="center" valign="middle" >2020.09.23</td><td align="center" valign="middle" >400.8999939</td><td align="center" valign="middle" >405.1827805</td><td align="center" valign="middle" >405.1655769</td><td align="center" valign="middle" >414.1995000</td></tr><tr><td align="center" valign="middle" >2020.09.24</td><td align="center" valign="middle" >396.5799866</td><td align="center" valign="middle" >400.1990371</td><td align="center" valign="middle" >399.7520063</td><td align="center" valign="middle" >410.0311776</td></tr><tr><td align="center" valign="middle" >2020.09.25</td><td align="center" valign="middle" >398.8800049</td><td align="center" valign="middle" >396.1674320</td><td align="center" valign="middle" >396.8202813</td><td align="center" valign="middle" >404.9963423</td></tr><tr><td align="center" valign="middle" >RMSE</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >0.0138</td><td align="center" valign="middle" >0.0232</td><td align="center" valign="middle" >0.0284</td></tr></tbody></table></table-wrap></table-wrap-group><p>表1. 未来10日的预测结果对比</p></sec></sec><sec id="s8"><title>4. 总结</title><p>建立了MDS-LSTM、MDS-BP和LSTM神经网络模型，充分利用LSTM神经网络的长时间记忆性对期货价格进行预测。在对比试验中发现MDS-LSTM模型对于期货收盘价预测精度更高，LSTM模型预测精度相对较低。相比较于MDS-BP模型，MDS-LSTM模型在期货价格波动较大时有很好的拟合能力，可以更准确地预测期货的收盘价格，所以该方法有可行性。对于波动较大的收盘价格MDS-LSTM模型基本可以预测趋势，但精度有待提高，需要不断探索得到更高的准确率。</p></sec><sec id="s9"><title>基金项目</title><p>辽宁省自然科学基金指导计划项目(编号：2019-ZD-0471)。</p></sec><sec id="s10"><title>文章引用</title><p>扈 文,孙德山. 基于多维放缩和长短期记忆网络的期货价格预测Futures Price Prediction Based on Multidimensional Scaling and Long Short-Term Memory Network[J]. 应用数学进展, 2020, 09(10): 1798-1804. https://doi.org/10.12677/AAM.2020.910207</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.38288-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">文宝石, 颜七笙. 数据多维处理LSTM股票价格预测模型[J]. 江西科学, 2020, 38(4): 443-449+472.</mixed-citation></ref><ref id="hanspub.38288-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">马元昊. 基于LSTM神经网络的股票大盘短期趋势预测[J]. 电脑知识与技术, 2020, 16(5): 205-206.</mixed-citation></ref><ref id="hanspub.38288-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">肖争艳, 刘玲君, 赵廷蓉, 陈彦斌. 深度学习神经网络能改进GDP的预测能力吗? [J]. 经济与管理研究, 2020, 41(7): 3-17.</mixed-citation></ref><ref id="hanspub.38288-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">李洁, 林永峰. 基于多时间尺度RNN的时序数据预测[J]. 计算机应用与软件, 2018, 35(7): 33-37+62.</mixed-citation></ref><ref id="hanspub.38288-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">张可, 崔乐. 基于PCA-LSTM模型的多元时间序列分类算法研究[J]. 统计与决策, 2020, 36(15): 44-49.</mixed-citation></ref><ref id="hanspub.38288-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">戴邵武, 陈强强, 刘志豪, 戴洪德. 基于EMD-LSTM的时间序列预测方法[J]. 深圳大学学报(理工版), 2020, 37(3): 265-270.</mixed-citation></ref></ref-list></back></article>