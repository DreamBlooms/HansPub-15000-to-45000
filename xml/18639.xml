<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">IaE</journal-id><journal-title-group><journal-title>Instrumentation and Equipments</journal-title></journal-title-group><issn pub-type="epub">2332-6980</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/IaE.2016.43010</article-id><article-id pub-id-type="publisher-id">IaE-18639</article-id><article-categories><subj-group subj-group-type="heading"><subject>IaE20160300000_89212896.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于GPRS的车辆实时监控管理系统设计
  The Design of Real-Time Monitoring and Management System for Vehicle Based on GPRS
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>浩</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>詹</surname><given-names>杰</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>孙</surname><given-names>琪皓</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>湖南科技大学物理与电子科学学院，湖南 湘潭</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>qhld52zh@163.com(张浩)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>09</day><month>09</month><year>2016</year></pub-date><volume>04</volume><issue>03</issue><fpage>69</fpage><lpage>77</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  运载工具、大型机械设备的增多对企业的管理提出了挑战，需加强对生产过程中车辆实时监控管理。设计了一种针对大型运输车辆的实时监控系统，并根据系统需要设计了高精度电容式油位传感器，解决车辆熄火状态下的防盗油问题，系统采用STM32作为主控芯片，集信号采集、数据分析、信号处理、GPRS网络通讯一体，具有车辆状态实时监测、无线通信、智能调度等功能。
   The increase of vehicles and large-scale mechanical equipments poses a challenge to the enterprise management, which needs to strengthen the real-time monitoring and management of vehicles in the production process. We have thus designed a real-time monitoring system for large transport vehicles, and projected a high-precision capacitive oil level sensor according to this system, so that the problem of oil theft for vehicle under flameout state could be solved. Adopting STM32 as the main control chip, the system is a combination of signal acquisition, data analysis, signal processing and GPRS network communication with the function of real-time monitoring of vehicles, wireless communication and intelligent scheduling.
 
</p></abstract><kwd-group><kwd>电容式油位传感器，STM32，GPRS，实时监控系统, Fuel Level Sensor of Capacitive</kwd><kwd> STM32</kwd><kwd> GPRS</kwd><kwd> Real-Time Monitoring System</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于GPRS的车辆实时监控管理系统设计<sup> </sup></title><p>张浩，詹杰，孙琪皓</p><p>湖南科技大学物理与电子科学学院，湖南 湘潭</p><disp-formula id="hanspub.18639-formula367"><graphic xlink:href="http://html.hanspub.org/file/7-2990097x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年9月5日；录用日期：2016年9月26日；发布日期：2016年9月29日</p><disp-formula id="hanspub.18639-formula368"><graphic xlink:href="http://html.hanspub.org/file/7-2990097x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>运载工具、大型机械设备的增多对企业的管理提出了挑战，需加强对生产过程中车辆实时监控管理。设计了一种针对大型运输车辆的实时监控系统，并根据系统需要设计了高精度电容式油位传感器，解决车辆熄火状态下的防盗油问题，系统采用STM32作为主控芯片，集信号采集、数据分析、信号处理、GPRS网络通讯一体，具有车辆状态实时监测、无线通信、智能调度等功能。</p><p>关键词 :电容式油位传感器，STM32，GPRS，实时监控系统</p><disp-formula id="hanspub.18639-formula369"><graphic xlink:href="http://html.hanspub.org/file/7-2990097x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>随着现代物流、矿山等行业的发展迅速，各种运载工具、大型机械设备越来越多，经常发生不按规定变更路线、超速、盗油等现象，严重威胁了企业的经济利益 [<xref ref-type="bibr" rid="hanspub.18639-ref1">1</xref>] 。但这些车辆一般处于移动状态或偏远矿区，特别是车辆熄火后现有监控设备都将失去作用，目前市场上尚未存在有效防范方法。本论文设计一套带有燃油实时检测、GPS定位和GPRS无线传输功能的车载监控系统，能够实时掌握车辆位置、是否存在异常状况，从而提高运输效益。</p></sec><sec id="s4"><title>2. 系统结构</title><p>系统由车载终端设备、GPRS网络以及控制中心组成，整体框图如图1所示。车载终端采集监测数据，将数据打包通过GPRS以TCP/IP协议发送到服务器 [<xref ref-type="bibr" rid="hanspub.18639-ref2">2</xref>] 。服务器是一台具有公网固定IP地址的计算机，可将车载终端发来的数据包进行解析与储存。客户端是因特网上的一个数据终端，通过网络访问服务器获取数据，采用C/S结构，支持多台终端同时查看监控信息 [<xref ref-type="bibr" rid="hanspub.18639-ref3">3</xref>] 。监控终端集各功能模块一体，系统实现油耗管理、GPS定位管理、驾驶员操作监控，满足现代企业的管理需求。</p><p>系统的工作原理为：油位传感器将采集的油位数据转换成电压信号，在监控终端经AD转换后实时采样，并对数据进行滤波、分析和处理，判断油箱内燃油状态(正常消耗、加油或盗油)。同时，采集GPS位置信息，最后通过GPRS无线通信网络将相关数据发送至服务器，存入数据库。</p></sec><sec id="s5"><title>3. 电容式油位传感器设计</title><p>汽柴油是易燃易爆物体，需要无接触采样。电容式传感器可将非电量的变化转换为电容量变化。将传感部分设计为同轴的圆柱，燃油的高度变化将引起传感器壳体和感应电极之间电容量的变化 [<xref ref-type="bibr" rid="hanspub.18639-ref4">4</xref>] 。设计的电容传感器采用差动脉冲宽度调制法测量电容，图2为电路原理图，图中C<sub>1</sub>为被测电容传感器，C<sub>2</sub>可调参考电容。A<sub>1</sub>、A<sub>2</sub>是两个比较器，Ur为参考电压 [<xref ref-type="bibr" rid="hanspub.18639-ref5">5</xref>] 。</p><p>图中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x9_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x10_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x11_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x12_hanspub.png" xlink:type="simple"/></inline-formula>组成两个震荡电路，所产的频率分别为：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x13_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x14_hanspub.png" xlink:type="simple"/></inline-formula>。将这两列信号。将<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x15_hanspub.png" xlink:type="simple"/></inline-formula>经过低通滤波后，就得到直流电压<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x16_hanspub.png" xlink:type="simple"/></inline-formula>为：</p><disp-formula id="hanspub.18639-formula370"><graphic xlink:href="http://html.hanspub.org/file/7-2990097x17_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x18_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x19_hanspub.png" xlink:type="simple"/></inline-formula>为A和B两点的直流分量；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x20_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x21_hanspub.png" xlink:type="simple"/></inline-formula>为电容<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x22_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x23_hanspub.png" xlink:type="simple"/></inline-formula>的充电时间，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x24_hanspub.png" xlink:type="simple"/></inline-formula>、</p><p>图1. 系统整体框图</p><p>图2. 差动脉冲宽度调制电路原理图</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x27_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x28_hanspub.png" xlink:type="simple"/></inline-formula>为触发器的输出的高电位，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x29_hanspub.png" xlink:type="simple"/></inline-formula>为触发器的参考电压 [<xref ref-type="bibr" rid="hanspub.18639-ref6">6</xref>] 。令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x30_hanspub.png" xlink:type="simple"/></inline-formula>，可得<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/7-2990097x31_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>即当被测电容发生改变时，其充电时间将发生弯化，使双稳态触发器产生不同的电压输出，从而得到燃油的容量。电路如图3所示，其中a为震荡信号产生部分，b为信号处理部分。</p></sec><sec id="s6"><title>4. 监控终端硬件设计</title><p>控制终端由电源模块、单片机控制单元、燃油传感器信号处理电路、GPS定位单元、GPRS无线通信单元以及扩展OBD接口等组成。电源模块将车载电瓶和备用电源电压12V转换为3.3 V和5 V供控制电路使用 [<xref ref-type="bibr" rid="hanspub.18639-ref7">7</xref>] 。正常情况下，车载电瓶为系统供电，并给备用充电电池充电，当车载电瓶出现故障或未接入系统时，则由备用电源供电。车载终端硬件结构如图4所示。</p><p>GPS模块主要是采集车辆的经纬度，OBD接口读取车辆速度以及方向等数据，将采集的数据传送至STM32芯片进行处理，本系统采用U-blox的NEO-6M模块 [<xref ref-type="bibr" rid="hanspub.18639-ref8">8</xref>] 。GPRS模块主要完成油量信息和GPS定位数据等信息的无线传输，同时还可远程下载服务器及控制中心的命令和信息。</p>断路检测电路设计<p>由于货运车辆的油箱外露，加装监测设备难免会有线路暴露在外，当线路因自然或人为破坏时，传感器将失去作用。断路报警检测电路，可检测电路是否正常，当出现断路情况时，及时报警 [<xref ref-type="bibr" rid="hanspub.18639-ref9">9</xref>] ，电路图如图5所示。</p><p>图3. 电容测量电路</p><p>图4. 车载终端硬件结构图</p><p>图5中，U1为NE555芯片，其内部有两个比较器。将油量检测线路中的两个导线接到A、B两点作为检测探头。当电路为通路时即A、B两点闭合，3引脚输出高电平，继电器断开，报警器关闭；当出现断路时即A、B两点断开，3引脚输出低电平，继电器闭合，报警器工作。</p></sec><sec id="s7"><title>5. 系统软件设计</title><sec id="s7_1"><title>5.1. 车载监控终端软件设计</title><p>监控终端的主要工作流程包括以下几个部分：</p><p>1) 各功能模块的系统初始化配置，其中包括串口、系统时钟、ADC、IO口、定时器、看门狗、中断等初始化程序。</p><p>2) 各功能模块初始化正常后采集所需信号、标准协议以及数据传输发送等系统程序。</p><p>3) 主控芯片将所接收的数据经过处理后由GPRS发送至监控中心。</p><p>软件流程图如图6所示。</p><p>图5. 断路检测电路</p><p>图6. 车载终端软件流程图</p></sec><sec id="s7_2"><title>5.2. 中转服务端软件设计</title><p>中转服务器设置在一台公网内有固定IP的计算机，它主要作用是接收、解析、储存来自车载终端通过GPRS发送来的数据包，并实时转发这些数据包至客户端。本系统数据量小，只需要一台普通电脑接入因特网，申请一个公网IP地址就可以改造成服务器 [<xref ref-type="bibr" rid="hanspub.18639-ref10">10</xref>] 。基于VC编写的服务端工作软件界面设计如图7所示，主要由主菜单、连接信息列表栏、GPRS设备连接信息显示栏、以太网连接信息显示栏四部分组成。菜单“控制参数”栏设置自动回复心跳包时延，回复确认信息。连接信息列表栏的功能是显示所有上线的GPRS终端设备和所有登陆的上位机客户端，显示内容。</p></sec><sec id="s7_3"><title>5.3. 客户端软件设计</title><p>客户端是因特网上的一个数据终端，主要用于监测、显示、记录运输车辆的状态信息，总体设计结构如图8所示。</p><p>软件采用C/S结构，可以从服务器获取车辆的实时数据，实现车辆远程监测。该上位机客户端软件采用VC编写，支持多台终端同时查看监测信息。该软件的主要功能：</p><p>1) 用户登录管理。</p><p>2) 运输车辆数据获取。</p><p>3) 运输车辆数据文本、地图模式显示功能。</p><p>4) 运输车辆信息管理功能。</p><p>5) 报警设置及提示功能。</p><p>6) 系统参数修改。</p><p>图7. 中转服务端软件界面</p></sec></sec><sec id="s8"><title>6. 系统测试</title><sec id="s8_1"><title>6.1. 电容式油位传感器测试</title><p>在实验室模拟加油、正常行驶油耗、盗油三种状态，曲线如图9所示。在一段时间内，输出电压不断增大过程为加油状态，在加油结束后曲线有一段波动，这是由于加油结束后，液面稳定需要一定的时间 [<xref ref-type="bibr" rid="hanspub.18639-ref11">11</xref>] ；燃油液位呈光滑曲线下降趋势为正常油耗过程；在盗油过程中，输出电压不断减小，当停止盗油后，电压渐渐恢复稳定。</p><p>由于燃油消耗是一个动态过程，精确太多没较大意义。本文所设计的电容式油位传感器在实验中运行良好，能够准确测量出汽车在燃油消耗、加油和盗油三种不同状态的电压变化情况，从而反映到客户端供用户分析。</p><p>图8. 客户端软件总体结构图</p><p>图9. 加油和盗油曲线图</p><p>图10. 客户端软件界面</p></sec><sec id="s8_2"><title>6.2. 系统客户端软件测试</title><p>打开客户端软件通过身份验证后，即可进入系统主界面。当服务器开启GPRS数据转发功能后，监控界面获取的车辆数据如图10所示。</p><p>图中车辆管理显示的是车辆ID，点击不同车辆，便出现相应车辆监控数据。显示模式可切换文本模式和地图模式，当选择地图模式时，将切换为Google地图显示车辆位置。当油量情况出现异常时，界面会闪动，并出现报警声音。</p></sec></sec><sec id="s9"><title>7. 结语</title><p>系统不仅可解决车辆在正常行驶状态时的监控，还解决了当车辆熄火时状态监控的难题，在紧急情况如车辆遭遇盗油、异常故障、遇劫、求助等情况发生时，可向管理中心发送报警信息，理论上满足了企业远程监控管理运输车辆，提高了企业的管理效率，有较高应用价值。目前本系统还在试验阶段，尚且存在能耗过高、GPS信号不稳定，数据收发滞后等不稳定情况需改善。今后还需针对系统增加车辆检测、维护、监督等功能，真正实现车辆监控与管理。</p></sec><sec id="s10"><title>基金项目</title><p>国家自然科学基金(No. 61540012)；湖南科技大学重点实验室开放基金(E21609)；湖南科技大学研究生创新基金项目创新项目(No. S140037)。</p></sec><sec id="s11"><title>文章引用</title><p>张浩,詹杰,孙琪皓. 基于GPRS的车辆实时监控管理系统设计The Design of Real-Time Monitoring and Management System for Vehicle Based on GPRS[J]. 仪器与设备, 2016, 04(03): 69-77. http://dx.doi.org/10.12677/IaE.2016.43010</p></sec><sec id="s12"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.18639-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">池云. 基于3G无线网络的车载监控系统设计与实现[J]. 物流技术, 2015, 34(2): 215-217.</mixed-citation></ref><ref id="hanspub.18639-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">何亚清, 张东方, 梁灵芝. 三道庄露天矿数字矿山建设实践[C]. 第三届全国数字矿山高新技术成果交流会论文集, 2014.</mixed-citation></ref><ref id="hanspub.18639-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">刘新玉. 基于C/S架构的电池监控系统设计[D]: [硕士学位论文]. 杭州: 杭州电子科技大学, 2013.</mixed-citation></ref><ref id="hanspub.18639-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">陈梅. 基于差动式电容传感器的车辆载荷检测系统[J]. 现代电子技术, 2011, 34(9): 190-192, 196.</mixed-citation></ref><ref id="hanspub.18639-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">卢翠珍. 差动脉宽调制电路的研究[J]. 中国科技信息, 2010(4): 120-121.</mixed-citation></ref><ref id="hanspub.18639-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">冯斌. 一种与介质无关的电容式液位测量方法研究[D]: [硕士学位论文]. 重庆: 重庆大学, 2009.</mixed-citation></ref><ref id="hanspub.18639-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">朱岩. 基于STM32的车辆综合无线监控系统设计[D]: [硕士学位论文]. 太原: 太原理工大学, 2012.</mixed-citation></ref><ref id="hanspub.18639-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">王正军. 基于GPS/GIS/GPRS的车辆监控系统的研究与开发[D]: [硕士学位论文]. 广州: 华南理工大学, 2014.</mixed-citation></ref><ref id="hanspub.18639-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">廖鹏. 输电线路防盗监测系统的设计与实现[D]: [硕士学位论文]. 成都: 电子科技大学, 2014.</mixed-citation></ref><ref id="hanspub.18639-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">孟磊. 基于OBD-Ⅱ的车载远程故障诊断系统设计[D]: [硕士学位论文]. 武汉: 武汉理工大学, 2012.</mixed-citation></ref><ref id="hanspub.18639-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">任德志, 李阳. 基于GPRS挖掘机燃油监控系统的设计[J]. 矿山机械, 2014(6): 29-33.</mixed-citation></ref></ref-list></back></article>