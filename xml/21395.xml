<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2017.64059</article-id><article-id pub-id-type="publisher-id">AAM-21395</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20170400000_15805834.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  直线与三维固定网格的交线长度与索引公式计算
  Formulas of the Length and Index for the Intersection of a Line and a Fixed Grid in Three-Dimensional Space
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>晓媛</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>彩芳</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>殷</surname><given-names>绪导</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>徐</surname><given-names>兆亮</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>上海海事大学文理学院，上海</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>21</day><month>06</month><year>2017</year></pub-date><volume>06</volume><issue>04</issue><fpage>496</fpage><lpage>503</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  本文首先介绍了数字图像重建中最典型的计算机断层成像技术(X-ray Computerized Tomography)的成像原理，并考虑将重建问题转化成线性方程组Ax = b的求解，重点讨论了系数矩阵A的生成。以三维实际重建问题为例，本文给出了计算直线与三维固定网格的交线长度与索引公式。最后利用MATLAB实现这一计算过程，并分析算法运行的效率。
   In this paper, we introduce the principle of imaging for X-ray CT and try to convert the reconstruction problem to a linear system Ax=b. We emphasize on the construction of A. Using a reconstruction example, we provide formulas of length and index of the intersection of a line and a fixed grid in three-dimensional space. Finally, we try to verify the formulas with MATLAB programming. 
 
</p></abstract><kwd-group><kwd>数字图像重建，X-Ray CT，三维固定网格，索引, Digital Image Reconstruction</kwd><kwd> X-Ray CT</kwd><kwd> Grid in 3D</kwd><kwd> Index</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>直线与三维固定网格的交线长度与 索引公式计算<sup> </sup></title><p>张晓媛，王彩芳，殷绪导，徐兆亮</p><p>上海海事大学文理学院，上海</p><p>收稿日期：2017年6月23日；录用日期：2017年7月15日；发布日期：2017年7月18日</p><disp-formula id="hanspub.21395-formula12"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文首先介绍了数字图像重建中最典型的计算机断层成像技术(X-ray Computerized Tomography)的成像原理，并考虑将重建问题转化成线性方程组Ax = b的求解，重点讨论了系数矩阵A的生成。以三维实际重建问题为例，本文给出了计算直线与三维固定网格的交线长度与索引公式。最后利用MATLAB实现这一计算过程，并分析算法运行的效率。</p><p>关键词 :数字图像重建，X-Ray CT，三维固定网格，索引</p><disp-formula id="hanspub.21395-formula13"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>数字图像重建是指根据物体边界测量数据，获取物体内部结构的一种方法 [<xref ref-type="bibr" rid="hanspub.21395-ref1">1</xref>] 。常见的成像技术有全息成像，电子显微，数码相机，核磁共振，超声波，计算机断层层析成像技术等等。图像重建最典型的应用是医学上的计算机断层层析成像技术 [<xref ref-type="bibr" rid="hanspub.21395-ref2">2</xref>] ，这是一种电子计算机技术与X射线检查技术相结合的产物，因其扫描时间快，图像清晰等特点，在成像领域有着非常重要的作用。</p><p>X射线在物体内部沿直线<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x9_hanspub.png" xlink:type="simple"/></inline-formula>传播，衰减满足Beer定理 [<xref ref-type="bibr" rid="hanspub.21395-ref3">3</xref>]</p><disp-formula id="hanspub.21395-formula14"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x11_hanspub.png" xlink:type="simple"/></inline-formula>为物体对X射线的衰减系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x12_hanspub.png" xlink:type="simple"/></inline-formula>为入射光强度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x13_hanspub.png" xlink:type="simple"/></inline-formula>为出射光强度。X-Ray CT利用这一原理，获取多组入射光强<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x14_hanspub.png" xlink:type="simple"/></inline-formula>和出射光强度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x15_hanspub.png" xlink:type="simple"/></inline-formula>，得到一系列的投影数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x16_hanspub.png" xlink:type="simple"/></inline-formula>，并根据投影数据值重建物体内部的吸收系数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x17_hanspub.png" xlink:type="simple"/></inline-formula>.</p><p>常见的X-Ray CT重建算法有迭代算法 [<xref ref-type="bibr" rid="hanspub.21395-ref4">4</xref>] ，分析算法(滤波反投影 [<xref ref-type="bibr" rid="hanspub.21395-ref5">5</xref>] ，反投影滤波 [<xref ref-type="bibr" rid="hanspub.21395-ref6">6</xref>] )等。随着计算机技术的高速发展，迭代重建算法因其利用计算机运算速度快，适合做重复性操作的特点被人们更广泛地应用在图像重建中。迭代算法首先涉及到问题的离散化，以三维图像为例，当待测物体所在的区域被离散成三维固定网格后(共<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x18_hanspub.png" xlink:type="simple"/></inline-formula>个像素)，如图1所示，假设物体在离散后每个格点上的吸收系数是一个常数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x19_hanspub.png" xlink:type="simple"/></inline-formula>，沿着第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x20_hanspub.png" xlink:type="simple"/></inline-formula>条射线上的投影值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x21_hanspub.png" xlink:type="simple"/></inline-formula>，可表示成<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x22_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x23_hanspub.png" xlink:type="simple"/></inline-formula>为第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x24_hanspub.png" xlink:type="simple"/></inline-formula>条射线与第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x25_hanspub.png" xlink:type="simple"/></inline-formula>个像素的交线长度，这样就将重建问题转化成<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x26_hanspub.png" xlink:type="simple"/></inline-formula>的求解 [<xref ref-type="bibr" rid="hanspub.21395-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.21395-ref8">8</xref>] 。我们的任务是确定矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x27_hanspub.png" xlink:type="simple"/></inline-formula>的第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x28_hanspub.png" xlink:type="simple"/></inline-formula>个行向量中的非零元以及非零元所在列的索引。</p><p>作者吴大瑞，何钦铭在 [<xref ref-type="bibr" rid="hanspub.21395-ref9">9</xref>] 中给出了计算直线与二维固定网格交线长度的算法，我们将这一算法进行推广，给出了计算直线与三维固定网格的交线长度的算法。此外，我们也给出了直线与三维固定网格的交线索引的公式。最后我们通过MATLAB实现这一算法 [<xref ref-type="bibr" rid="hanspub.21395-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.21395-ref11">11</xref>] ，并用两组数值实验分别验证了算法的正确性和有效性。</p></sec><sec id="s4"><title>2. 计算直线与网格的交线长度及索引位置</title><sec id="s4_1"><title>2.1. 空间坐标系的建立及图像的离散化</title><p>为后续描述方便，我们首先定义物体的参数(见表1)。</p><p>1) 假设待测物体处于一个长、宽、高分别为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x29_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x30_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x31_hanspub.png" xlink:type="simple"/></inline-formula>的矩形区域内。以矩形的中心为原点建立空间直角坐标系，对矩形区域进行离散化后得每个格点的长、宽、高分别为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x32_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x33_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x34_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>图1. 待测物体离散化</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Parameters of the object to be image</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >变量</th><th align="center" valign="middle" >意义</th></tr></thead><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x36_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >待测物体的长</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x37_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >待测物体的宽</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x38_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >待测物体的高</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x39_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >待测物体<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x40_hanspub.png" xlink:type="simple"/></inline-formula>方向上的分辨率，文中为偶数</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x41_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >待测物体<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x42_hanspub.png" xlink:type="simple"/></inline-formula>方向上的分辨率，文中为偶数</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x43_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >待测物体<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x44_hanspub.png" xlink:type="simple"/></inline-formula>方向上的分辨率，文中为偶数</td></tr></tbody></table></table-wrap><p>表1. 待测物体参数</p><p>2) 我们将网格中格点依<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x45_hanspub.png" xlink:type="simple"/></inline-formula>轴依次从下往上逐层标号，以最底层格点为例对网格进行标号，从数字1开始，按图2的方法，直到标完对应的格点数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x46_hanspub.png" xlink:type="simple"/></inline-formula>; 按同样的方法在矩形区域内向上一层对格点进行标号，依次向上标，直到标完对应的格点数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x47_hanspub.png" xlink:type="simple"/></inline-formula>，以此完成对矩形区域的离散化。</p></sec><sec id="s4_2"><title>2.2. 第i根射线所在位置描述</title><p>假设第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x48_hanspub.png" xlink:type="simple"/></inline-formula>根射线是由第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x49_hanspub.png" xlink:type="simple"/></inline-formula>个光源<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x50_hanspub.png" xlink:type="simple"/></inline-formula>及探测器<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x51_hanspub.png" xlink:type="simple"/></inline-formula>所确定，则该直线所在的空间直线参数方程可表示为(<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x52_hanspub.png" xlink:type="simple"/></inline-formula>为参数)</p><disp-formula id="hanspub.21395-formula15"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x53_hanspub.png"  xlink:type="simple"/></disp-formula><p>图2. xoy平面网格标号</p><p>其中(<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x55_hanspub.png" xlink:type="simple"/></inline-formula>)为直线的方向向量，可以根据确定的光源和探测器位置的坐标确定<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x56_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x57_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x58_hanspub.png" xlink:type="simple"/></inline-formula>。为后续描述方便，需保证<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x59_hanspub.png" xlink:type="simple"/></inline-formula>按序大于0，若出现以下情况之一：(1)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x60_hanspub.png" xlink:type="simple"/></inline-formula>，(2)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x61_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x62_hanspub.png" xlink:type="simple"/></inline-formula>，(3)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x63_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x64_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x65_hanspub.png" xlink:type="simple"/></inline-formula>，则令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x66_hanspub.png" xlink:type="simple"/></inline-formula>即可。</p></sec><sec id="s4_3"><title>2.3. 直线与网格交线的长度与索引公式</title><p>1) 为确定直线与网格的交线长度，我们首先给出直线与网格的交点。设光源探测器直线与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x67_hanspub.png" xlink:type="simple"/></inline-formula>平面的交点分别为 <inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x68_hanspub.png" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x69_hanspub.png" xlink:type="simple"/></inline-formula>)。根据条件</p><disp-formula id="hanspub.21395-formula16"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x70_hanspub.png"  xlink:type="simple"/></disp-formula><p>删除越界的点，得到直线与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x71_hanspub.png" xlink:type="simple"/></inline-formula>轴网格线相交<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x72_hanspub.png" xlink:type="simple"/></inline-formula>组的坐标，仍然记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x73_hanspub.png" xlink:type="simple"/></inline-formula>。同理，可获得直线与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x74_hanspub.png" xlink:type="simple"/></inline-formula>轴网格线相交的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x75_hanspub.png" xlink:type="simple"/></inline-formula>组有效坐标值，为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x76_hanspub.png" xlink:type="simple"/></inline-formula>，与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x77_hanspub.png" xlink:type="simple"/></inline-formula>轴网格线相交的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x78_hanspub.png" xlink:type="simple"/></inline-formula>组有效坐标值，为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x79_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>将三组数据按照<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x80_hanspub.png" xlink:type="simple"/></inline-formula>坐标从小到大进行重排，若<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x81_hanspub.png" xlink:type="simple"/></inline-formula>，则按<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x82_hanspub.png" xlink:type="simple"/></inline-formula>从小到大重排，若<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x83_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x84_hanspub.png" xlink:type="simple"/></inline-formula>，则按<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x85_hanspub.png" xlink:type="simple"/></inline-formula>从小到大重排。得到一系列不重复交点，记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x86_hanspub.png" xlink:type="simple"/></inline-formula>。则该直线与网格的交线长度可表示为</p><disp-formula id="hanspub.21395-formula17"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-2620435x87_hanspub.png"  xlink:type="simple"/></disp-formula><p>2) 为计算直线与网格交线的索引，可以根据交线起点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x88_hanspub.png" xlink:type="simple"/></inline-formula>找到该格点中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x89_hanspub.png" xlink:type="simple"/></inline-formula>坐标最小的顶点，并由此顶点推断索引值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x90_hanspub.png" xlink:type="simple"/></inline-formula>。具体的实现中，首先令</p><disp-formula id="hanspub.21395-formula18"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x91_hanspub.png"  xlink:type="simple"/></disp-formula><p>&#183; 若<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x92_hanspub.png" xlink:type="simple"/></inline-formula>，且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x93_hanspub.png" xlink:type="simple"/></inline-formula>，则修正<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x94_hanspub.png" xlink:type="simple"/></inline-formula>;</p><p>&#183; 若<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x95_hanspub.png" xlink:type="simple"/></inline-formula>，且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x96_hanspub.png" xlink:type="simple"/></inline-formula>，则修正<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x97_hanspub.png" xlink:type="simple"/></inline-formula>.</p><p>图3为几种特殊的相交情况，以此说明上述修正。</p><p>最后令</p><p>图3. 几种特殊的直线与网格相交情况。实心圆：起点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x115_hanspub.png" xlink:type="simple"/></inline-formula>；菱形：终点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x116_hanspub.png" xlink:type="simple"/></inline-formula>；空心圆：修正前的点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x117_hanspub.png" xlink:type="simple"/></inline-formula>；星形：修正后的点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x118_hanspub.png" xlink:type="simple"/></inline-formula>。(a)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x119_hanspub.png" xlink:type="simple"/></inline-formula>；(b)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x120_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x121_hanspub.png" xlink:type="simple"/></inline-formula>；(c)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x122_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x123_hanspub.png" xlink:type="simple"/></inline-formula>；(d)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x124_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x125_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x126_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x127_hanspub.png" xlink:type="simple"/></inline-formula></p><disp-formula id="hanspub.21395-formula19"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x128_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据修正后的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x129_hanspub.png" xlink:type="simple"/></inline-formula>，可得交线所在格点的索引公式为</p><disp-formula id="hanspub.21395-formula20"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-2620435x130_hanspub.png"  xlink:type="simple"/></disp-formula></sec></sec><sec id="s5"><title>3. 数值实验</title><p>为验证算法的有效性和正确性，我们进行如下两组数值实验。算法在一台Dell电脑上完成，操作系统为Windows 7旗舰版(64位)，处理器：Intel(R) Core(TM) i7-4790，CPU@3.60 GHz，RAM:8 GB。采用Matlab R_2013a版本。</p><sec id="s5_1"><title>3.1. 算法正确性验证</title><p>设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x131_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x132_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x133_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x134_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x135_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x136_hanspub.png" xlink:type="simple"/></inline-formula>。分别取如下4组光源和探测器。经程序计算得到结果如表2所示。此外，我们对不同光源和探测器情况作了手动计算，经过比较，我们确定两者一致，算法的正确性得到验证。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Correctness verification for the numerical metho</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >编号</th><th align="center" valign="middle" >光源与探测器</th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x137_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x138_hanspub.png" xlink:type="simple"/></inline-formula></th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >(1)</td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x139_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x140_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x141_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x142_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle"  rowspan="2"  >(2)</td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x143_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x144_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x145_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x146_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle"  rowspan="2"  >(3)</td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x147_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x148_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x149_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x150_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle"  rowspan="2"  >(4)</td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x151_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x152_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x153_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x154_hanspub.png" xlink:type="simple"/></inline-formula></td></tr></tbody></table></table-wrap><p>表2. 程序正确性检测结果</p></sec><sec id="s5_2"><title>3.2. 算法运行效率</title><p>我们模拟现实的光源和探测器分布情况，假设待测物体参数设置为</p><disp-formula id="hanspub.21395-formula21"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x155_hanspub.png"  xlink:type="simple"/></disp-formula><p>光源和探测平面同时绕待测物体螺旋上升。具体参数见表3。</p><p>初始状态下光源位置设为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x156_hanspub.png" xlink:type="simple"/></inline-formula>。与之对应的探测器平面如图4所示。</p><p>光源和探测器平面同时绕<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x157_hanspub.png" xlink:type="simple"/></inline-formula>轴旋转，第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x158_hanspub.png" xlink:type="simple"/></inline-formula>个光源转过角度为</p><disp-formula id="hanspub.21395-formula22"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x159_hanspub.png"  xlink:type="simple"/></disp-formula><p>光源位置为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x160_hanspub.png" xlink:type="simple"/></inline-formula></p><disp-formula id="hanspub.21395-formula23"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x161_hanspub.png"  xlink:type="simple"/></disp-formula><p>与之相对应的探测器上各点坐标为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x162_hanspub.png" xlink:type="simple"/></inline-formula></p><disp-formula id="hanspub.21395-formula24"><graphic xlink:href="http://html.hanspub.org/file/11-2620435x163_hanspub.png"  xlink:type="simple"/></disp-formula><p>由于系数矩阵是一个大型稀疏矩阵，在实际的迭代过程中，如果将<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x164_hanspub.png" xlink:type="simple"/></inline-formula>存入内存，是一个耗空间的做法；如果每次迭代都从外设读取数据，也是一个耗时的做法。因此我们考虑在每步迭代中，都计算一次系数矩阵。模拟实际情况，我们假设共采集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x165_hanspub.png" xlink:type="simple"/></inline-formula>次数据，形成<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x166_hanspub.png" xlink:type="simple"/></inline-formula>组交线长度和索引标号。</p><p>图4. 平面探测器编号</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Parameters for sources and detector</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >变量</th><th align="center" valign="middle" >意义</th><th align="center" valign="middle" >数据</th></tr></thead><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x168_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >光源到待测物体中心轴的距离</td><td align="center" valign="middle" >60 cm</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x169_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >探测平面中心到待测物体中心轴的距离</td><td align="center" valign="middle" >40 cm</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x170_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >平板探测器长度</td><td align="center" valign="middle" >40 cm</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x171_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >平板探测器高度</td><td align="center" valign="middle" >40 cm</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x172_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >平板探测器水平方向分辨率(偶数)</td><td align="center" valign="middle" >50</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x173_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >平板探测器竖直方向分辨率(偶数)</td><td align="center" valign="middle" >50</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x174_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >采集数据的旋转角(弧度)</td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x175_hanspub.png" xlink:type="simple"/></inline-formula></td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-2620435x176_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >螺距</td><td align="center" valign="middle" >10 cm</td></tr></tbody></table></table-wrap><p>表3. 光源、探测器参数</p><p>采用上述程序，在MATLAB下运行，实际代码执行的时间为597.7133秒。由此，我们也可以大体估计每次迭代所用时间。根据数值实验的结果，我们发现运行效率可以接受。</p></sec></sec><sec id="s6"><title>4. 总结</title><p>本文以X-ray CT为例，研究重建问题中系数矩阵的生成方式，将系数矩阵元素和直线与三维固定网格相交联系起来，研究了直线与三维固定网格的交线长度与索引。最后用MATLAB程序语言实现了这一算法，并将算法应用到三维重建的系数矩阵生成上，完成一次矩阵的计算时间在10分钟以内。运算效率是可行的。</p></sec><sec id="s7"><title>基金项目</title><p>国家自然科学基金青年基金项目(11401372)。</p></sec><sec id="s8"><title>文章引用</title><p>张晓媛,王彩芳,殷绪导,徐兆亮. 直线与三维固定网格的交线长度与索引公式计算 Formulas of the Length and Index for the Intersection of a Line and a Fixed Grid in Three-Dimensional Space[J]. 应用数学进展, 2017, 06(04): 496-503. http://dx.doi.org/10.12677/AAM.2017.64059</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.21395-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">冈萨雷斯. 数字图像处理[M]. 北京: 北京电子工业出版社, 2009.</mixed-citation></ref><ref id="hanspub.21395-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">曾晖, 孙腊珍, 汪晓莲. CT计算机断层扫描成像实验[J]. 物理实验, 2008, 28(12): 9-12.</mixed-citation></ref><ref id="hanspub.21395-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">庄天戈. CT原理与算法[M]. 上海: 上海交通大学出版社, 1992.</mixed-citation></ref><ref id="hanspub.21395-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">潘晋孝. X射线CT迭代算法研究[M]. 北京: 北京大学数学科学学院, 2006.</mixed-citation></ref><ref id="hanspub.21395-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">张顺利, 李卫斌, 唐高峰. 滤波反投影图像重建算法研究[J]. 咸阳师范学院学报, 2008, 23(4): 47-49.</mixed-citation></ref><ref id="hanspub.21395-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">洪贤勇, 乔志伟. 用反投影滤波算法实现CT图像的ROI重建[J]. 电视技术, 2014, 38(7): 29-32.</mixed-citation></ref><ref id="hanspub.21395-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">陈洪磊, 贺建峰, 刘俊卿, 马磊. 迭代图像重建中系统矩阵与重建图像质量关系研究[J]. 计算机应用, 2013, 33(1): 53-56, 68.</mixed-citation></ref><ref id="hanspub.21395-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">王亮, 寿永熙, 秦俊平. 图像重建迭代算法的研究[J]. 黑龙江科技信息, 2007(21): 72-72.</mixed-citation></ref><ref id="hanspub.21395-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">吴大瑞, 何钦铭. 一种简单的基于固定网格的空间直线索引算法[J]. 江南大学学报(自然科学版), 2005, 4(4): 394-396.</mixed-citation></ref><ref id="hanspub.21395-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">张振东, 哈力旦·A. 基于MATLAB 的CT的图像三维重建的研究与实现[J]. 电子世界, 2013(3): 87-88.</mixed-citation></ref><ref id="hanspub.21395-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">曾筝, 董芳华, 陈晓, 周宏, 周建中. 利用MATLAB实现CT断层图像的三维重建[J]. CT理论与应用研究, 2004, 13(2): 24-29.</mixed-citation></ref></ref-list></back></article>