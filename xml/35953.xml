<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JSTA</journal-id><journal-title-group><journal-title>Journal of Sensor Technology and Application</journal-title></journal-title-group><issn pub-type="epub">2331-0235</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JSTA.2020.83008</article-id><article-id pub-id-type="publisher-id">JSTA-35953</article-id><article-categories><subj-group subj-group-type="heading"><subject>JSTA20200300000_99950397.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  荧光寿命测温多指数数据处理方法
  Multi-Exponential Data Processing Method in Fluorescence Lifetime Temperature Measurement
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>贾</surname><given-names>丹平</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>博强</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>婉莹</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>立民</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>沈阳工业大学信息科学与工程学院，辽宁 沈阳</addr-line></aff><pub-date pub-type="epub"><day>04</day><month>06</month><year>2020</year></pub-date><volume>08</volume><issue>03</issue><fpage>71</fpage><lpage>79</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  基于荧光寿命的光纤测温技术关键点在于将荧光信号中的直流分量与噪声信号等背景干扰去除，尽可能准确地求得荧光寿命
  τ，但在高精度测量时，运用传统的单指数模型算法，如最小二乘拟合、积分面积比、FFT拟合等方法处理多指数的荧光信号时，求取荧光寿命 会带来很大误差。将LM算法和Prony算法引入荧光测温中，通过仿真分析可知，二者在处理多指数的荧光信号时较传统方法有明显优势，LM算法在低噪条件下，处理双指数模型的最大误差在&#177;10
  <sup>−4</sup> ms之间，响应速度3 &#215; 10
  <sup></sup>
  <sup>−1</sup>
   s，适合用于高精度测量之中；Prony算法受噪声影响较为明显，在低噪环境下的最大误差为&#177;10
  <sup></sup>
  <sup>−3</sup>
   ms，响应速度可以达到2 &#215; 10
  <sup></sup>
  <sup>−3</sup>
   s，适合应用在快速响应条件下。
   The key point of optical fiber temperature measurement technology based on fluorescence lifetime is to remove the background interference such as the dc component and the noise signal in the fluorescence signal so as to obtain the fluorescence life 
  τ as accurately as possible. However, in the case of high-precision measurement, when the traditional single exponential model algorithms, such as the least squares fitting, the integral area ratio, the FFT fitting and other methods are used to process the multi-exponential fluorescence signal, the fluorescence life error obtained will be large. LM algorithm and Prony algorithm are introduced into fluorescence temperature measurement. Through simulation analysis, it can be seen that the two algorithms have obvious advantages over the traditional methods in processing multi-exponential fluorescence signals. Under low noise condition, the maximum error of LM algorithm is between &#177;10
  <sup></sup>
  <sup>−4</sup>
   ms, and the re-sponse speed is 3 &#215; 10
  <sup></sup>
  <sup>−1</sup>
   s. It is very suitable for high-precision measurement. Prony algorithm is significantly affected by noise. The maximum error is &#177;10
  <sup></sup>
  <sup>−3</sup>
   ms in the low noise environment, and the response speed can reach 2 &#215; 10
  <sup></sup>
  <sup>−3</sup>
   s. It is suitable for application in the case of fast response.
 
</p></abstract><kwd-group><kwd>荧光寿命，测温，数据处理，高精度测量，LM算法，Prony算法, Fluorescence Lifetime</kwd><kwd> Temperature Measure</kwd><kwd> Date Processing</kwd><kwd> High Precision Measurement</kwd><kwd> LM Algorithm</kwd><kwd> Prony Algorithm</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>荧光寿命测温多指数数据处理方法<sup> </sup></title><p>贾丹平，王博强，刘婉莹，赵立民</p><p>沈阳工业大学信息科学与工程学院，辽宁 沈阳</p><disp-formula id="hanspub.35953-formula8"><graphic xlink:href="//html.hanspub.org/file/1-2960138x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2020年5月13日；录用日期：2020年5月28日；发布日期：2020年6月4日</p><disp-formula id="hanspub.35953-formula9"><graphic xlink:href="//html.hanspub.org/file/1-2960138x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>基于荧光寿命的光纤测温技术关键点在于将荧光信号中的直流分量与噪声信号等背景干扰去除，尽可能准确地求得荧光寿命 τ ，但在高精度测量时，运用传统的单指数模型算法，如最小二乘拟合、积分面积比、FFT拟合等方法处理多指数的荧光信号时，求取荧光寿命 τ 会带来很大误差。将LM算法和Prony算法引入荧光测温中，通过仿真分析可知，二者在处理多指数的荧光信号时较传统方法有明显优势，LM算法在低噪条件下，处理双指数模型的最大误差在&#177;10<sup>−4</sup> ms之间，响应速度3 &#215; 10<sup>−1</sup> s，适合用于高精度测量之中；Prony算法受噪声影响较为明显，在低噪环境下的最大误差为&#177;10<sup>−3</sup> ms，响应速度可以达到2 &#215; 10<sup>−3</sup> s，适合应用在快速响应条件下。</p><p>关键词 :荧光寿命，测温，数据处理，高精度测量，LM算法，Prony算法</p><disp-formula id="hanspub.35953-formula10"><graphic xlink:href="//html.hanspub.org/file/1-2960138x9_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/1-2960138x10_hanspub.png" /> <img src="//html.hanspub.org/file/1-2960138x11_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>荧光测温是一种可以应用在工业、农业、医疗等行业的温度测量技术，因其抗电磁干扰的特点 [<xref ref-type="bibr" rid="hanspub.35953-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.35953-ref2">2</xref>]，较传统热电偶测温有更大优势。同时基于荧光寿命的光纤测温系统有着不受激励光强干扰的特点，具有很好的发展前景 [<xref ref-type="bibr" rid="hanspub.35953-ref3">3</xref>]。</p><p>实际应用时荧光寿命的理论衰减形式为：</p><p>I ( t ) = I 0 exp ( − t / τ ) + I d + I n (1)</p><p>其中，I<sub>d</sub>为直流分量，I<sub> n</sub>为噪声信号，二者均属于背景干扰 [<xref ref-type="bibr" rid="hanspub.35953-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.35953-ref5">5</xref>]。 τ 为荧光寿命，是温度的单值函数，求取 τ 值即可得到被测温度值 [<xref ref-type="bibr" rid="hanspub.35953-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.35953-ref7">7</xref>]。为保证求 τ 的准确性，需要对接收的荧光信号进行去直流，消除背景噪声等预处理，通常采用最小二乘拟合、积分面积比、FFT拟合等方法 [<xref ref-type="bibr" rid="hanspub.35953-ref8">8</xref>]。<sup> </sup></p><p>但在高精度测量时发现，荧光信号为多指数形式，即：</p><p>I ( t ) = I 0 exp ( − t / τ 1 ) + I 1 exp ( − t / τ 2 ) + ⋯ + I N exp ( − t / τ J ) + I d + I n (2)</p><p>此时传统针对单指数的各算法存在弊端，需寻找更准确的算法来进行提高测量的精度。</p><p>LM算法和Prony算法是针对多指数模型的数据处理方法 [<xref ref-type="bibr" rid="hanspub.35953-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.35953-ref10">10</xref>]。本文通过仿真分析，研究将LM算法和Prony算法引入荧光测温的可行性和测量精度的问题。</p></sec><sec id="s4"><title>2. L-M算法</title><sec id="s4_1"><title>2.1. L-M算法在测温系统中的实现</title><p>定义待测荧光信号的模型为：</p><p>I ( t ) = ∑ i = 1 k A i exp ( − t / τ i ) (3)</p><p>在这里，构造一个代价函数来估计衰减残差的平方和：</p><p>S ( β ; t ) = 1 2 ∑ j = 1 n [ I j ( β ; t ) − y j ] 2 = 1 2 ∑ j = 1 n f j ( x ) 2 ≡ 1 2 F ( x ) T F ( x ) (4)</p><p>式(4)中的 F ( x ) 是由 f ( x ) 组成的向量值函数， β 是由A<sub>i</sub>和 τ 组成的参数。这样一来，求取荧光寿命 τ 就变成了求取参数 β 来使得S最小化的问题。考虑到S不是呈线性关系，需要更加精确、快速的收敛方法，因此提出了使用LM算法来进行拟合。</p><p>LM算法的迭代格式为：</p><p>x k + 1 = x k + d k (5)</p><p>其中d<sub>k</sub>为搜索方向，在高斯牛顿法的迭代条件基础上，Levenberg和Marquardt提出了通过对角截断来对J<sup>T</sup>J矩阵进行衰减，即引进一个阻尼因子 λ ，使其能够在较大的初始范围内进行收敛：</p><p>x k + 1 = x k − ( J T J + λ diag ( J T J ) ) − 1 J F ( x ) (6)</p><p>式中：J为I对 β 的梯度；J<sup>T</sup>J为Hessian矩阵；用Hessian的对角矩阵来代替单位矩阵，可以减小计算机字长短带来的累积舍入误差的影响，提高计算结果的精度。</p><p>阻尼因子 λ 在每次迭代过程中会进行自我调整，当S减小时， λ 相应减小，当 λ → 0 时，上式近似为高斯牛顿法；当S增大时， λ 相应增大，当 λ → ∞ 时，上式近似于最速下降法。当目标函数的精度达到预设值时，迭代结束。因此只要选择合适的迭代初值，就可以兼顾高斯牛顿法和最速下降法的优点，使得迭代收敛速度快，全局稳定性高。</p><p>在仿真过程中，使用LM算法分别对单指数模型和双指数模型进行了分析。</p></sec><sec id="s4_2"><title>2.2. L-M算法单指数仿真分析</title><p>针对单指数模型，此时荧光信号为：</p><p>I ( t ) = A 1 exp ( − t / τ ) + I d + I n</p><p>利用MATLAB做一条单指数函数曲线，设其模型为：</p><p>y = A exp ( − i Δ t / τ ) + I d + I n</p><p>采样时间间隔 Δ t = 0.01   ms 。假设荧光寿命 τ = 0. 5   ms ，通过仿真反求 τ 值偏离0.5 ms的大小来分析LM算法对直流分量和噪声分量的敏感程度及算法处理速度。</p><sec id="s4_2_1"><title>2.2.1. 直流分量的影响</title><p>令 A = 1 ，噪声信号 I n = 0 ，改变直流分量I<sub>d</sub>的幅度与荧光信号强度的比，结果如表1所示。可以看出，利用LM算法求取荧光寿命 τ 时，会受到直流分量的影响，随着直流分量的增大，荧光寿命 τ 也逐渐偏离理论值。因此若想应用此法得到较高的测量精度需要想办法去掉直流分量，这是此法的一个弊端。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The τ value table of the DC component is 0.5% - 2.5% of the fluorescence intensit</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >采样点</th><th align="center" valign="middle"  colspan="5"  >直流幅度与荧光强度比</th></tr></thead><tr><td align="center" valign="middle" >0.5%</td><td align="center" valign="middle" >1.0%</td><td align="center" valign="middle" >1.5%</td><td align="center" valign="middle" >2.0%</td><td align="center" valign="middle" >2.5%</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >0.500135</td><td align="center" valign="middle" >0.500341</td><td align="center" valign="middle" >0.500573</td><td align="center" valign="middle" >0.500680</td><td align="center" valign="middle" >0.500833</td></tr><tr><td align="center" valign="middle" >60</td><td align="center" valign="middle" >0.500179</td><td align="center" valign="middle" >0.500436</td><td align="center" valign="middle" >0.500663</td><td align="center" valign="middle" >0.500744</td><td align="center" valign="middle" >0.500927</td></tr><tr><td align="center" valign="middle" >90</td><td align="center" valign="middle" >0.500170</td><td align="center" valign="middle" >0.500396</td><td align="center" valign="middle" >0.500697</td><td align="center" valign="middle" >0.500817</td><td align="center" valign="middle" >0.501005</td></tr><tr><td align="center" valign="middle" >120</td><td align="center" valign="middle" >0.500075</td><td align="center" valign="middle" >0.500402</td><td align="center" valign="middle" >0.500649</td><td align="center" valign="middle" >0.500855</td><td align="center" valign="middle" >0.501017</td></tr><tr><td align="center" valign="middle" >150</td><td align="center" valign="middle" >0.500190</td><td align="center" valign="middle" >0.500489</td><td align="center" valign="middle" >0.500754</td><td align="center" valign="middle" >0.500962</td><td align="center" valign="middle" >0.501293</td></tr></tbody></table></table-wrap><p>表1. 直流分量为荧光强度的0.5%~2.5%时的 τ 值表</p></sec><sec id="s4_2_2"><title>2.2.2. 噪声信号的影响</title><p>令直流分量 I d = 0 ，改变噪声信号I<sub>n</sub>的幅度与荧光信号强度的比，结果如表2所示。可以看出，LM算法对噪声不敏感，是一种精度较高的算法。采样点的选取不仅决定了数据处理速度，还与噪声有关，采样长度并不是越大越好，例如在0.5%的幅度比情况下，采样长度120的仿真结果最接近理论值，因此要根据实际情况确定采样长度。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> The τ value table of the noise amplitude is 0.5% - 2.5% of the fluorescence intensit</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >采样点</th><th align="center" valign="middle"  colspan="5"  >噪声幅度与荧光强度比</th></tr></thead><tr><td align="center" valign="middle" >0.5%</td><td align="center" valign="middle" >1.0%</td><td align="center" valign="middle" >1.5%</td><td align="center" valign="middle" >2.0%</td><td align="center" valign="middle" >2.5%</td></tr><tr><td align="center" valign="middle" >30</td><td align="center" valign="middle" >0.499912</td><td align="center" valign="middle" >0.499937</td><td align="center" valign="middle" >0.499267</td><td align="center" valign="middle" >0.500507</td><td align="center" valign="middle" >0.499987</td></tr><tr><td align="center" valign="middle" >60</td><td align="center" valign="middle" >0.500063</td><td align="center" valign="middle" >0.500128</td><td align="center" valign="middle" >0.500101</td><td align="center" valign="middle" >0.500141</td><td align="center" valign="middle" >0.500616</td></tr><tr><td align="center" valign="middle" >90</td><td align="center" valign="middle" >0.500017</td><td align="center" valign="middle" >0.499746</td><td align="center" valign="middle" >0.500116</td><td align="center" valign="middle" >0.499800</td><td align="center" valign="middle" >0.499363</td></tr><tr><td align="center" valign="middle" >120</td><td align="center" valign="middle" >0.500014</td><td align="center" valign="middle" >0.500126</td><td align="center" valign="middle" >0.499800</td><td align="center" valign="middle" >0.500157</td><td align="center" valign="middle" >0.499010</td></tr><tr><td align="center" valign="middle" >150</td><td align="center" valign="middle" >0.500037</td><td align="center" valign="middle" >0.500310</td><td align="center" valign="middle" >0.499695</td><td align="center" valign="middle" >0.500272</td><td align="center" valign="middle" >0.500713</td></tr></tbody></table></table-wrap><p>表2. 噪声幅度为荧光强度的0.5%~2.5%时的 τ 值表</p></sec></sec><sec id="s4_3"><title>2.3. LM算法双指数仿真分析</title><p>用MATLAB做一条双指数曲线，设其模型为：</p><p>y = A 1 exp ( − i Δ t / τ 1 ) + A 2 exp ( − i Δ t / τ 2 ) + I d + I n</p><p>假设荧光寿命 τ 1 = 0. 5   ms ， τ 2 = 0. 3   ms ，通过仿真反求两个 τ 值偏离程度来进行对比分析。</p>噪声信号的影响<p>通过单指数模型仿真分析可知，算法受直流分量的影响，因此此处讨论无直流情况下对噪声的敏感程度。选择采样长度为120，改变噪声幅度与荧光强度的比例，得到表3所示的结果。</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> The τ value table of the fitting length of l-m algorithm is 120 point</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >采样点120</th><th align="center" valign="middle"  colspan="5"  >噪声幅度与荧光强度比</th></tr></thead><tr><td align="center" valign="middle" >0.5%</td><td align="center" valign="middle" >1.0%</td><td align="center" valign="middle" >1.5%</td><td align="center" valign="middle" >2.0%</td><td align="center" valign="middle" >2.5%</td></tr><tr><td align="center" valign="middle" >τ 1</td><td align="center" valign="middle" >0.500014</td><td align="center" valign="middle" >0.499933</td><td align="center" valign="middle" >0.499865</td><td align="center" valign="middle" >0.500428</td><td align="center" valign="middle" >0.503992</td></tr><tr><td align="center" valign="middle" >τ 2</td><td align="center" valign="middle" >0.300196</td><td align="center" valign="middle" >0.300387</td><td align="center" valign="middle" >0.300392</td><td align="center" valign="middle" >0.300601</td><td align="center" valign="middle" >0.298640</td></tr><tr><td align="center" valign="middle" >仿真时长(s)</td><td align="center" valign="middle" >0.352149</td><td align="center" valign="middle" >0.355530</td><td align="center" valign="middle" >0.352190</td><td align="center" valign="middle" >0.349143</td><td align="center" valign="middle" >0.350027</td></tr></tbody></table></table-wrap><p>表3. L-M算法拟合长度为120点时的 τ 值表</p><p>这里对比传统的最小二乘拟合法和FFT拟合法，分别在采样长度相同的情况下求取荧光寿命 τ 1 进行对比，结果如表4所示。</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> The τ value table of the fitting length of traditional algorithm is 120 point</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >采样点120</th><th align="center" valign="middle"  colspan="5"  >噪声幅度与荧光强度比</th></tr></thead><tr><td align="center" valign="middle" >0.5%</td><td align="center" valign="middle" >1.0%</td><td align="center" valign="middle" >1.5%</td><td align="center" valign="middle" >2.0%</td><td align="center" valign="middle" >2.5%</td></tr><tr><td align="center" valign="middle" >最小二乘拟合 τ 1</td><td align="center" valign="middle" >0.380714</td><td align="center" valign="middle" >0.380733</td><td align="center" valign="middle" >0.380928</td><td align="center" valign="middle" >0.380765</td><td align="center" valign="middle" >0.380725</td></tr><tr><td align="center" valign="middle" >仿真时长(s)</td><td align="center" valign="middle" >0.001171</td><td align="center" valign="middle" >0.001132</td><td align="center" valign="middle" >0.001150</td><td align="center" valign="middle" >0.001185</td><td align="center" valign="middle" >0.001149</td></tr><tr><td align="center" valign="middle" >FFT拟合法 τ 1</td><td align="center" valign="middle" >0.412866</td><td align="center" valign="middle" >0.412858</td><td align="center" valign="middle" >0.412946</td><td align="center" valign="middle" >0.413007</td><td align="center" valign="middle" >0.412547</td></tr><tr><td align="center" valign="middle" >仿真时长(s)</td><td align="center" valign="middle" >0.001103</td><td align="center" valign="middle" >0.001055</td><td align="center" valign="middle" >0.001058</td><td align="center" valign="middle" >0.001072</td><td align="center" valign="middle" >0.001091</td></tr></tbody></table></table-wrap><p>表4. 传统算法拟合长度为120点时的 τ 值表</p><p>对比以上两表数据可知，传统最小二乘法和FFT拟合法等算法在针对双指数模型时 τ 值计算效果较差，精度很低，误差最小在0.12 ms，受噪声影响明显，并不适合处理多指数荧光信号；而LM算法的误差维持在 0<sup>−4</sup> ms到10<sup>−3</sup> ms，测量精度较高，但由于算法需要使用到大量的迭代技术，对初值的猜测也有一定的要求，导致运行时间较长。针对这种情况，提出另一种扩充Prony算法进行改进。</p></sec></sec><sec id="s5"><title>3. Prony算法</title><sec id="s5_1"><title>3.1. Prony算法在测温系统中的实现</title><p>Prony算法是使用多指数函数的一种线性组合来描述等间距采样数据的数学模型，可以根据采样值直接估算出信号频率、衰减、幅值和初相位的分析方法。</p><p>该算法针对等间距采样点，在荧光测温中，实际光谱的荧光寿命曲线可看做纯指数或一系列指数函数的叠加，形式为：</p><p>I ( t ) = I 1 exp ( − t / τ 1 ) + I 2 exp ( − t / τ 2 ) + ⋯ + I n exp ( − t / τ n ) = ∑ j = 1 n I 0 j exp ( − t / τ j ) (7)</p><p>这样，当把采样值带入上式时，即可得到联立方程组：</p><p>{ I 0 = I 01 + I 02 + ⋯ + I 0 n I 1 = I 01 exp ( − Δ t / τ 1 ) + I 02 exp ( − Δ t / τ 2 ) + ⋯ + I 0 n exp ( − Δ t / τ n ) I 2 = I 01 exp ( − 2 Δ t / τ 1 ) + I 02 exp ( − 2 Δ t / τ 2 ) + ⋯ + I 0 n exp ( − 2 Δ t / τ n )                                                                                             ⋮ I 2 n − 1 = I 01 exp ( − ( 2 n − 1 ) Δ t / τ 1 ) + I 02 exp ( − ( 2 n − 1 ) Δ t / τ 2 ) + ⋯ + I 0 n exp ( − ( 2 n − 1 ) Δ t / τ n ) (8)</p><p>即：</p><p>I i = I ( i Δ t ) = ∑ j = 1 n I 0 j exp ( − i Δ t / τ j ) (9)</p><p>其中，I<sub>i</sub>为采样值，Δt为采样间隔，求解该非线性联立方程组，即可求得荧光寿命 τ 和幅值I<sub>0j</sub>，求解该方程组非常复杂，因此引入Prony算法，</p><p>设测量数据的估计模型为：</p><p>I ^ n = ∑ i = 1 p b i z i n       ( n = 0 , 1 , ⋯ , N − 1 ) (10)</p><p>其中更一般的表示模型有：</p><p>b m = A m (11)</p><p>z m = exp ( a m Δ t ) ,       a = − 1 / τ (12)</p><p>这里，A<sub>m</sub>为振幅，a<sub>m</sub>为衰减因子，Δt为采样间隔，prony算法采用平方误差最小原则来使模拟信号向真实信号进行逼近，即：</p><p>min ( ε = ∑ n = 0 N − 1 | I ( n ) − I ^ ( n ) | 2 ) (13)</p><p>同时考虑到估计模型函数是一个常系数线性差分方程的齐次解，因此定义了多项式：</p><p>φ ( z ) = ∏ t = 0 p ( z − z k ) = ∑ i = 0 p a i z p − 1 (14)</p><p>改造式(13)有：</p><p>I ^ ( n − m ) = ∑ i = 1 p b i z n − m       ( 0 ≤ n − m ≤ N − 1 ) (15)</p><p>将该式乘a<sub>m</sub>并对p + 1个乘积求和：</p><p>∑ m = 0 p a m I ^ ( n − m ) = ∑ l = 1 p b l ∑ m = 0 p a m z l n − m ,     p ≤ n ≤ N − 1 (16)</p><p>代入 z l n − m = z l n − p z l p − m ，有：</p><p>∑ m = 0 p a m I ^ ( n − m ) = ∑ l = 1 p b l z l n − p ∑ m = 0 p a m z l p − m = 0 (17)</p><p>该式等于零正是因为第二项求和恰好是 φ ( z ) = ∏ t = 0 p ( z − z k ) = ∑ i = 0 p a i z p − 1 位于根z<sub>i</sub>处的多项式 ϕ ( z i ) ，而</p><p>ϕ ( z i ) = 0 。因此可知 I ^ ( n ) 满足递推的差分方程：</p><p>I ^ ( n ) = − ∑ m = 1 p I ^ ( n − m )       ( p ≤ n ≤ N − 1 ) (18)</p><p>假设测量值 I ⌢ ( n ) 与真实值I(n)之间关系为： I ( n ) = I ⌢ ( n ) + e ( n ) ，其中为e(n)一个加性高斯白噪声，这样就有了：</p><p>I ( n ) = − ∑ m = 1 p a m I ^ ( n − m ) + e ( n ) = ∑ m = 1 p a m I ( n − m ) + ∑ m = 0 p a m e ( n − m )       ( p ≤ n ≤ N − 1 ) (19)</p><p>其中 a 0 = 1 ，上式表明白噪声中的指数过程是一个ARMA(p,p)模型，它具有相同的AR和MA参数，且激</p><p>励噪声为原加性白噪声e(n)。参数的最小二乘估计使 ∑ n = p N − 1 | e ( n ) | 2 最小，这又将得到一组困难的非线性方程。</p><p>估计AR参数的线性方法定义：</p><p>ε ( n ) = ∑ m = 0 p a m e ( n − m )       ( n = p , ⋯ , N − 1 ) (20)</p><p>这样式(19)变为：</p><p>I ( n ) = − ∑ m = 1 p a m I ( n − m ) + ε ( n ) (21)</p><p>所以求使 ∑ n = p N − 1 | e ( n ) | 2 最小就转换成了求使 ∑ n = p N − 1 | ε ( n ) | 2 最小，这就是扩充的Prony算法，即扩充的Prony算法</p><p>就是求解下列矩阵方程：</p><p>[ x ( p ) I ( p − 1 ) ⋯ I ( 0 ) x ( p + 1 ) I ( p ) ⋯ I ( 1 ) ⋮ ⋮ ⋱ ⋮ x ( p ) I ( p ) ⋯ I ( p ) ] [ 1 a 1 ⋮ a p ] = [ ε ( 0 ) ε ( 1 ) ⋮ ε ( N − 1 ) ]</p><p>或</p><p>I a = ε (22)</p><p>为使 ε p = ∑ n = p N − 1 | ε ( n ) | 2 = ∑ n = p N − 1 | ∑ m = 0 p a m I ( n − m ) | 2 最小，求 ∂ ε p / ∂ a m 令其等于零，有</p><p>∑ m = 0 p a m [ ∑ n = p N − 1 I ( n − m ) I ∗ ( n − i ) ] = 0 (23)</p><p>对应的最小误差能量：</p><p>ε p = ∑ m = 0 p a m [ ∑ n = p N − 1 I ( n − m ) I ∗ ( n ) ] (24)</p><p>在这里定义：</p><p>r ( i , j ) = ∑ n = p N − 1 I ( n − j ) I ∗ ( n − i ) (25)</p><p>则上述偏导式可写为</p><p>[ r ( 0 , 0 ) r ( 0 , 1 ) ⋯ r ( 0 , p ) r ( 1 , 0 ) r ( 1 , 1 ) ⋯ r ( 1 , p ) ⋮ ⋮ ⋱ ⋮ r ( p , 0 ) r ( p , 1 ) ⋯ r ( p , p ) ] [ 1 a 1 ⋮ a p ] = [ ε p 0 ⋮ 0 ] (26)</p><p>求解这一方程即可得到AR参数 a 1 , ⋯ , a p 和最小误差能量 ε p 的估计值。进一步可以求解如下特征方程的根Z：</p><p>1 + a 1 z − 1 + ⋯ + a p z − p = 0 (27)</p><p>这样，上述联立方程组模型就可以简化为：</p><p>[ 1 1 ⋯ 1 z 1 z 2 ⋯ z p ⋮ ⋮ ⋱ ⋮ z 1 N − 1 z 2 N − 2 ⋯ z p N − 1 ] [ b 1 b 2 ⋮ b p ] = [ x ^ ( 1 ) x ^ ( 2 ) ⋮ x ^ ( p ) ] (28)</p><p>其中，幅值A<sub>i</sub>为和衰减因子a<sub>i</sub> (即荧光寿命 τ )可表示为：</p><p>{ A i = | b i | a i = ln ( z i ) / Δ t (29)</p><p>由上推导，实现了Prony算法在荧光测温中的实现，现使用MATLAB软件分别对单指数模型和双指数模型进行分析。</p></sec><sec id="s5_2"><title>3.2. Prony算法的单指数仿真</title><p>用MATLAB软件做一条单指数荧光曲线，设其模型为：</p><p>y = A exp ( − i Δ t / τ ) + I d + I n ，</p><p>采样时间间隔 Δ t = 0.0 1   ms 。假设荧光寿命 τ = 0. 5   ms ，通过仿真反求 τ 值偏离 .5 ms的大小进行分析。</p><p>针对单指数模型，令 A = 1 ，噪声信号 I n = 0 ，采样长度选择120，改变直流分量I<sub>d</sub>的幅度与荧光信号强度，结果如表5所示。可以看出，Prony算法同样会受到直流分量的背景干扰，在直流分量较小时，仿真结果较好。</p><table-wrap id="table5" ><label><xref ref-type="table" rid="table5">Table 5</xref></label><caption><title> The τ value table of the DC component is 0.5% - 2.5% of the fluorescence intensity (sampling point 120</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >采样点120</th><th align="center" valign="middle"  colspan="5"  >直流幅度与荧光强度比</th></tr></thead><tr><td align="center" valign="middle" >0.5%</td><td align="center" valign="middle" >1.0%</td><td align="center" valign="middle" >1.5%</td><td align="center" valign="middle" >2.0%</td><td align="center" valign="middle" >2.5%</td></tr><tr><td align="center" valign="middle" >五次 τ 平均值</td><td align="center" valign="middle" >0.503418</td><td align="center" valign="middle" >0.499589</td><td align="center" valign="middle" >0.510936</td><td align="center" valign="middle" >0.518576</td><td align="center" valign="middle" >0.526724</td></tr></tbody></table></table-wrap><p>表5. 直流分量为荧光强度的0.5%~2.5%时的 τ 值表(采样点120)</p><p>再令直流分量 I d = 0 ，采样长度选择120，改变噪声信号幅度与荧光信号幅度的比，结果如表6所示。可以看出，Prony算法对噪声很敏感，随着噪声的增加，仿真结果也越来越偏离理论值，在低噪环境下精度较好。</p><table-wrap id="table6" ><label><xref ref-type="table" rid="table6">Table 6</xref></label><caption><title> The τ value table of the noise amplitude is 0.5% - 2.5% of the fluorescence intensity (sampling point 120</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >采样点120</th><th align="center" valign="middle"  colspan="5"  >噪声幅度与荧光强度比</th></tr></thead><tr><td align="center" valign="middle" >0.5%</td><td align="center" valign="middle" >1.0%</td><td align="center" valign="middle" >1.5%</td><td align="center" valign="middle" >2.0%</td><td align="center" valign="middle" >2.5%</td></tr><tr><td align="center" valign="middle" >五次 τ 平均值</td><td align="center" valign="middle" >0.500701</td><td align="center" valign="middle" >0.502971</td><td align="center" valign="middle" >0.515143</td><td align="center" valign="middle" >0.528520</td><td align="center" valign="middle" >0.550484</td></tr></tbody></table></table-wrap><p>表6. 噪声幅度为荧光强度的0.5%~2.5%时的 τ 值表(采样点120)</p></sec><sec id="s5_3"><title>3.3. Prony算法的双指数仿真</title><p>用MATLAB做一条双指数荧光曲线，设其模型：</p><p>y = A   exp ( − i Δ t / τ 1 ) + A 2 exp ( − i Δ t / τ 2 ) + I d + I n</p><p>假设荧光寿命 τ 1 = 0. 5   ms ， τ 2 = 0. 3   ms ，探究噪声对其的干扰。设拟合数据120点，改变噪声幅度与荧光强度的比例，结果如表7所示。由此可知在低噪环境下，Prony算法表现较好，仿真时长在10<sup>−3</sup> s数量级，比起LM算法更适合于快速响应环境下；同时其受噪声干扰较大，当噪声干扰较大时，精度不如LM算法。</p><table-wrap id="table7" ><label><xref ref-type="table" rid="table7">Table 7</xref></label><caption><title> The τ value table of the noise amplitude is 0.5% - 2.5% of the fluorescence intensity (sampling point 120</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >采样点120</th><th align="center" valign="middle"  colspan="5"  >噪声幅度与荧光强度比</th></tr></thead><tr><td align="center" valign="middle" >0.5%</td><td align="center" valign="middle" >1.0%</td><td align="center" valign="middle" >1.5%</td><td align="center" valign="middle" >2.0%</td><td align="center" valign="middle" >2.5%</td></tr><tr><td align="center" valign="middle" >τ 1</td><td align="center" valign="middle" >0.501421</td><td align="center" valign="middle" >0.492034</td><td align="center" valign="middle" >0.471874</td><td align="center" valign="middle" >0.435542</td><td align="center" valign="middle" >0.395383</td></tr><tr><td align="center" valign="middle" >τ 2</td><td align="center" valign="middle" >0.300739</td><td align="center" valign="middle" >0.295392</td><td align="center" valign="middle" >0.283338</td><td align="center" valign="middle" >0.170857</td><td align="center" valign="middle" >0.127272</td></tr><tr><td align="center" valign="middle" >仿真时长(s)</td><td align="center" valign="middle" >0.002446</td><td align="center" valign="middle" >0.009617</td><td align="center" valign="middle" >0.009727</td><td align="center" valign="middle" >0.010992</td><td align="center" valign="middle" >0.018512</td></tr></tbody></table></table-wrap><p>表7. 噪声幅度为荧光强度的0.5%~2.5%时的 τ 值表(采样点120)</p></sec></sec><sec id="s6"><title>4. 结论</title><p>论证了LM算法与Prony算法可以运用在荧光测温系统中，比起传统数据处理方法，在处理多指数函数模型时有着明显优势。LM算法在低噪条件下，处理双指数模型的最大误差在&#177;10<sup>−4</sup> ms之间，响应速度3 &#215; 10<sup>−1</sup> s，非常适合用于高精度测量之中；Prony算法受噪声影响较为明显，在低噪环境下的最大误差为&#177;10<sup>−3</sup> ms，相应速度可以达到2 &#215; 10<sup>−3</sup> s，适合应用在快速响应条件下。两种算法各有优势所在，具有较好发展前景。</p></sec><sec id="s7"><title>文章引用</title><p>贾丹平,王博强,刘婉莹,赵立民. 荧光寿命测温多指数数据处理方法Multi-Exponential Data Processing Method in Fluorescence Lifetime Temperature Measurement[J]. 传感器技术与应用, 2020, 08(03): 71-79. https://doi.org/10.12677/JSTA.2020.83008</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.35953-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">崔凤英, 李莉. 微波场的温度测量[J]. 计量技术, 2003(3): 18-19.</mixed-citation></ref><ref id="hanspub.35953-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">赵舫, 唐忠, 崔昊杨. 基于荧光光纤测温的电气设备在线监测系统[J]. 电测与仪表, 2015, 52(4): 85-89.</mixed-citation></ref><ref id="hanspub.35953-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">张月芳, 叶林华, 裘燕青. 掺杂型荧光光纤温度传感技术[J]. 海南大学学报(自然科学版), 2004, 22(3): 226-230.</mixed-citation></ref><ref id="hanspub.35953-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Jia, D., Zhao, L., Cui, S., et al. (2002) Optical Fiber Fluores-cent Thermometry for Electromagnetically Induced Heating in Medicine Treatment. 4916, 95-97. &lt;br&gt;https://doi.org/10.1117/12.482936</mixed-citation></ref><ref id="hanspub.35953-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">伞宏力. 微波消解的温度在线检测系统研究[D]: [硕士学位论文]. 沈阳: 沈阳工业大学, 2005.</mixed-citation></ref><ref id="hanspub.35953-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">贾丹平, 高浠萌, 王大力. 基于薄膜电阻的新型光纤电流传感器的研究[J]. 仪表技术与传感器, 2016(6): 8-10.</mixed-citation></ref><ref id="hanspub.35953-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">伞宏力, 贾丹平, 潘晓苏, 等. 用于微波消解仪的荧光光纤测温系统的研制[J]. 沈阳工业大学学报, 2006, 28(6): 639-642.</mixed-citation></ref><ref id="hanspub.35953-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">贾丹平, 王岩. 基于荧光寿命的微波场中温度测量技术[J]. 仪表技术与传感器, 2018(4): 90-94+97.</mixed-citation></ref><ref id="hanspub.35953-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">贾丹平. 荧光光纤温度测量技术及应用[M]. 北京: 科学出版社, 2015.</mixed-citation></ref><ref id="hanspub.35953-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">刘洋, 周燕, 刘育梁. 一种基于列文伯格-马克夸特的高精度荧光寿命计算成像方法[J]. 激光与光电子学进展, 2015, 52(10): 158-162.</mixed-citation></ref></ref-list></back></article>