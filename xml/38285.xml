<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2020.910205</article-id><article-id pub-id-type="publisher-id">AAM-38285</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20201000000_86739341.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于ARIMA和BP神经网络组合模型对股票价格的预测
  Prediction of Stock Price Based on ARIMA and BP Neural Network Combined Model
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>肖</surname><given-names>琳</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>金</surname><given-names>良琼</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>韦</surname><given-names>学永</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>贵州民族大学数据科学与信息工程学院，贵州 贵阳</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>13</day><month>10</month><year>2020</year></pub-date><volume>09</volume><issue>10</issue><fpage>1776</fpage><lpage>1786</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    本文选取了沪深300指数和百度股票的收盘价，利用ARIMA模型和BP神经网络两种单一模型以及两种模型的组合对股票价格进行预测，其中组合模型采取了等权重组合和方差倒数法两种定权的方法来确定权数。结果表明，通过等权重组合方式的模型ARIMA-BP的预测精度最高，预测的效果最好，BP神经网络模型效果其次，效果较差的为ARIMA模型。
    This article selects the CSI 300 Index and the closing price of Baidu stocks, and uses two single models of ARIMA model and BP neural network and a combination of the two models to predict stock prices. The combination model adopts two weighting methods: equal weight combination and reciprocal variance method to determine the weight. The results show that the ARIMA-BP model with equal weight combination has the highest prediction accuracy and the best prediction effect, followed by the BP neural network model, and the ARIMA model with the poorer effect. 
  
 
</p></abstract><kwd-group><kwd>ARIMA模型，BP神经网络，组合模型，股价预测, ARIMA Model</kwd><kwd> BP Neural Network</kwd><kwd> Combined Model</kwd><kwd> Stock Price Prediction</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>本文选取了沪深300指数和百度股票的收盘价，利用ARIMA模型和BP神经网络两种单一模型以及两种模型的组合对股票价格进行预测，其中组合模型采取了等权重组合和方差倒数法两种定权的方法来确定权数。结果表明，通过等权重组合方式的模型ARIMA-BP的预测精度最高，预测的效果最好，BP神经网络模型效果其次，效果较差的为ARIMA模型。</p></sec><sec id="s2"><title>关键词</title><p>ARIMA模型，BP神经网络，组合模型，股价预测</p></sec><sec id="s3"><title>Prediction of Stock Price Based on ARIMA and BP Neural Network Combined Model<sup> </sup></title><p>Lin Xiao, Liangqiong Jin, Xueyong Wei</p><p>School of Data Science and Information Engineering, Guizhou University for Nationalities, Guiyang Guizhou</p><p><img src="//html.hanspub.org/file/13-2621347x4_hanspub.png" /></p><p>Received: Oct. 7<sup>th</sup>, 2020; accepted: Oct. 20<sup>th</sup>, 2020; published: Oct. 27<sup>th</sup>, 2020</p><p><img src="//html.hanspub.org/file/13-2621347x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>This article selects the CSI 300 Index and the closing price of Baidu stocks, and uses two single models of ARIMA model and BP neural network and a combination of the two models to predict stock prices. The combination model adopts two weighting methods: equal weight combination and reciprocal variance method to determine the weight. The results show that the ARIMA-BP model with equal weight combination has the highest prediction accuracy and the best prediction effect, followed by the BP neural network model, and the ARIMA model with the poorer effect.</p><p>Keywords:ARIMA Model, BP Neural Network, Combined Model, Stock Price Prediction</p><disp-formula id="hanspub.38285-formula24"><graphic xlink:href="//html.hanspub.org/file/13-2621347x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/13-2621347x7_hanspub.png" /> <img src="//html.hanspub.org/file/13-2621347x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>从目前我国的经济发展来看，无论哪个方面的经济发展都在不断与国际接轨，股票市场作为社会主义市场经济发展的产物，也在慢慢走向国际化，人们对股票市场的关注度也越来越高，很多投资者也都纷纷加入到股票投资市场，期望给自己带来更多的收益，所以对于股票投资者来说，预测股价走势是很有必要的，这样才能够帮助投资者选择最佳投资时机，获取最高的利益，对于机构而言也是如此，从更高层面来看，也促进了我国市场经济的发展。</p><p>精准的预测股票的价格是较为困难的，是预测研究中的一大难题，相关学者经过不断的研究与创新，提出并建立了较为精确的预测股票价格模型如：吴玉霞，温欣 [<xref ref-type="bibr" rid="hanspub.38285-ref1">1</xref>] 通过利用时间序列中的ARIMA模型，将“华泰证券”250期的股票收盘价作为实证数据来进行建模，由结论可知ARIMA模型在短期预测中，无论是动态预测还是静态预测效果都较好；贺本岚 [<xref ref-type="bibr" rid="hanspub.38285-ref2">2</xref>] 利用时间序列常用的两种短期预测模型ARIMA和ARCH模型，并用这两种模型来预测上证指数的收盘价，对预测结果进行对比得出预测效果较好的是ARCH模型；陈小玲 [<xref ref-type="bibr" rid="hanspub.38285-ref3">3</xref>] 分别利用ARIMA和BP神经网络对股价进行预测研究，将百度和阿里巴巴这两支股票的收盘价作为实证分析数据，结论表明两种模型在股价短期预测中是可行的。</p><p>单一预测模型在某些情况会存在一定的局限性，预测结果的精度和准确性较差，因此在1969年Bates和Granger [<xref ref-type="bibr" rid="hanspub.38285-ref4">4</xref>]，首次提出了用组合的方式将单一模型结合起来，也即是提出组合模型这一概念，该理论自提出以来，一直持续引起国内外学者的广泛讨论和关注，由于通过组合的方式能够大幅度地提高模型的准确性和预测精度，所以很多学者都对此进行了相关理论研究和实例验证。翟静，曹俊 [<xref ref-type="bibr" rid="hanspub.38285-ref5">5</xref>] 在组合模型预测的大环境之下，通过方差倒数法将ARIMA模型和BP神经网络算法结合在一起对我国的粮食产量进行预测研究，得出组合模型的预测准确度比只用时间序列ARIMA或BP神经网络进行建模的模型预测结果准确度高。</p><p>基于此，本文选取沪深300指数和百度的收盘价为研究对象，利用线性模型ARIMA和非线性模型BP神经网络的单一模型和组合模型来预测股票价格，在模型组合时，利用了等权重法和方差倒数法。最后将单个模型和组合模型得到的预测值进行对比。</p></sec><sec id="s6"><title>2. 研究方法与模型建立</title><sec id="s6_1"><title>2.1. 时间序列的ARIMA模型</title><p>在时间序列模型中，我们会经常运用到ARIMA模型，ARIMA模型能够很好的研究和分析时间序列数据，而且预测的精度对于短期的数据还是较高的。</p><p>在上世纪70年代，Box和Jenkins提出了时间序列模型，这种模型有三种基本类型：自回归模型、滑动平均模型和自回归滑动平均模型。设 { y t } 是一个均值为零，且是平稳的时间序列，ARMA(p,q)模型也即是p阶自回归，q阶滑动平均的公式表达为：</p><p>Y t − ϕ 1 Y t − 1 − ⋯ − ϕ p Y t − p = ε t − θ 1 ε t − 1 − ⋯ − θ q ε t − q</p><p>可简写为 ϕ ( B ) Y t = θ ( B ) ε t 。ARIMA(p,d,q)模型中d的含义是差分阶数，在金融市场中，股票价格的时间序列数据通常是非平稳的，因为只有平稳序列才能建立ARMA模型，所以要对其进行平稳化处理，一般来说差分是进行平稳化最常用的方法，差分后的ARIMA与ARMA相同。</p><p>以下考虑ARIMA(p, 1, q)过程，也即是经过一阶差分的ARMA(p, q)模型， W t = Y t − Y t − 1 ，有：</p><p>W t = ϕ 1 W t − 1 + ϕ 2 W t − 2 + ⋯ + ϕ p W t − p + ε t − θ 1 ε t − 1 − θ 2 ε t − 2 − ⋯ − θ q ε t − q</p><p>将 W t = Y t − Y t − 1 代入得：</p><p>Y t − Y t − 1 = ϕ 1 ( Y t − 1 − Y t − 2 ) + ϕ 2 ( Y t − 2 − Y t − 3 ) + ⋯ + ϕ p ( Y t − p − Y t − p − 1 ) + ε t − θ 1 ε t − 1 − θ 2 ε t − 2 − ⋯ − θ q ε t − q</p><p>将上式改写为：</p><p>Y t = ( 1 + ϕ 1 ) Y t − 1 + ( ϕ 2 − ϕ 1 ) Y t − 2 + ⋯ + ( ϕ p − ϕ p − 1 ) Y t − p − ϕ p Y t − p − 1 + ε t − θ 1 ε t − 1 − ⋯ − θ q ε t − q (1)</p></sec><sec id="s6_2"><title>2.2. ARIMA模型的建模步骤(图1)</title><p>图1. ARIMA模型建模步骤图</p><p>拟合模型的初步识别准则 [<xref ref-type="bibr" rid="hanspub.38285-ref6">6</xref>] 如下表1所示：</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Preliminary identification criteria for the ARMA mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >模型(序列)</th><th align="center" valign="middle" >AR(p)</th><th align="center" valign="middle" >MA(q)</th><th align="center" valign="middle" >ARMA(p, q)</th></tr></thead><tr><td align="center" valign="middle" >自相关系数(ACF)</td><td align="center" valign="middle" >拖尾</td><td align="center" valign="middle" >q阶截尾</td><td align="center" valign="middle" >拖尾</td></tr><tr><td align="center" valign="middle" >偏自相关系数(PACF)</td><td align="center" valign="middle" >p阶截尾</td><td align="center" valign="middle" >拖尾</td><td align="center" valign="middle" >拖尾</td></tr></tbody></table></table-wrap><p>表1. ARMA模型初步识别准则</p><p>最后利用上文得到的已经通过检验的模型，对所研究的问题进行分析、建模、预测。</p></sec><sec id="s6_3"><title>2.3. BP神经网络算法</title><p>BP神经网络 [<xref ref-type="bibr" rid="hanspub.38285-ref7">7</xref>] 是目前应用范围很广的神经模型，是使用误差逆向传播算法来进行训练的一种多层前馈神经网络，对训练集数据进行反复不断的训练来调整权值和阈值，得到神经网络预测输出值与我们所期望得到的输出值无限接近，BP神经网络的学习能力极强，能很好的学习数据间的函数映射关系，从而来对数据进行分类、聚类、拟合、预测等等。</p><p>图2. BP神经网络拓扑结构</p><p>由图2可知，BP神经网络从结构上看有三层，从左往右依次为输入层、隐含层、输出层。其中，相邻的层之间是完全连接的，而在同一层内的神经单元之间是无连接的。 X 1 , X 2 , ⋯ , X n 为BP神经网络的输入值； W 1 , W 2 , ⋯ , W p 为BP神经网络的隐含层节点， Y 1 , Y 2 , ⋯ , Y m 为BP神经网络的输出值； W i j 和 W j k 表示BP神经网络权值。</p><p>在使用BP神经网络模型预测之前，需对模型进行训练，若不对网络进行训练的话，网络就不会具备联想记忆和预测能力，就不能进行预测研究。通常情况，在神经元个数较少的情况下，网络对样本的识别能力会降低，这样网络的训练量达不到，得到的训练结果少了，网络就不能对样本进行完全的识别，给网络的训练带来困难，反之，若神经元的个数很多的情况下，网络训练的时间就会增加，网络的就会出现过度训练的情况，严重可能导致训练效果及预测效果都很差。一般情况下，对我们来说隐含层神经元个数的确定是极其困难的，到目前为止还没有一个明确可行的理论方法支撑，我们就只能通过以下经验公式，并结合多次的试验反复对比来确定。</p><p>l = m + n + a</p><p>经验公式中：l表示隐含层神经元个数；n表示输入层节点数；m表示输出层节点数；a表示一个0~10任意整数。</p></sec><sec id="s6_4"><title>2.4. 模型组合方式</title><p>1) 等权重组合：顾名思义，给予两个模型同等的数值的权数；</p><p>2) 方差倒数法 [<xref ref-type="bibr" rid="hanspub.38285-ref4">4</xref>]：</p><p>主要思想：从预测误差入手，根据预测误差来进行赋值，也就是给误差平方和大的模型赋予小的权重，相反给误差平方和小的赋予较大的权重，这样一来，经过这种赋权的方式组合的模型，其预测的误差平方和就会最大程度的最小。</p><p>具体步骤：第一步计算每个单一模型预测的误差平方和；第二步用第一步得到的结果(也即是每一个模型的误差平方和)求倒数；第三步把第二步计算得到的值全部加起来所有；最后用第二步得到的各倒数除以第三步求得的倒数和，从而就可以得到各个模型的权数。</p></sec></sec><sec id="s7"><title>3. 实证研究分析</title><sec id="s7_1"><title>3.1. 数据来源</title><p>本文选取沪深300指数2017年6月1日至2019年12月17日(除节假日外)共624天的收盘价作为实验数据，来预测2019年12月18日至2019年12月31日的收盘价，并以同样的时间节点选取百度股票的收盘价来进行实证分析。所有历史数据均来自英为财情(https://cn.investing.com/)财经网站。</p></sec><sec id="s7_2"><title>3.2. ARIMA模型建立</title><sec id="s7_2_1"><title>3.2.1. 平稳性检验</title><p>根据沪深300指数收盘价的原始数据画时序图以及做单位根(ADF)检验，时序图如图3所示，ADF检验如下表2所示：</p><p>图3. 沪深300指数收盘价原始数据时序图</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> ADF test of the original data of the CSI 300 Inde</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Augmented Dickey-Fuller Test</th><th align="center" valign="middle" ></th><th align="center" valign="middle" ></th></tr></thead><tr><td align="center" valign="middle" >Data: x</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >Dickey-Fuller = −1.4894</td><td align="center" valign="middle" >Lag order = 8</td><td align="center" valign="middle" >p-value = 0.7944</td></tr><tr><td align="center" valign="middle" >alternative hypothesis: stationary</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表2. 沪深300指数原始数据的ADF检验</p><p>由时序图可知序列不平稳，ADF检验的 P-Value = 0 .7944 &gt; 0 .05 ，认为沪深300指数原始序列数据是非平稳的序列。需要做平稳化处理，对原始数据进行一阶差分，得到序列xdiff，并检验xdiff的平稳性，xdiff的时序图以及ADF检验的结果如下图4和表3所示：</p><p>图4. 沪深300指数平稳化处理后的时序图</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> ADF test after the first difference of the CSI 300 Inde</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Augmented Dickey-Fuller Test</th><th align="center" valign="middle" ></th><th align="center" valign="middle" ></th></tr></thead><tr><td align="center" valign="middle" >Data: xdiff</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >Dickey-Fuller = −7.8235</td><td align="center" valign="middle" >Lag order = 8</td><td align="center" valign="middle" >p-value = 0.01</td></tr><tr><td align="center" valign="middle" >alternative hypothesis: stationary</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表3. 沪深300指数一阶差分后的ADF检验</p><p>由图4时序图可知序列平稳，进一步通过ADF检验得到的 P-Value = 0 .01 &lt; 0 .05 可知，差分后的序列xdiff已经平稳，故取d = 1。</p></sec><sec id="s7_2_2"><title>3.2.2. 模型定阶</title><p>对差分后的序列xdiff，做其自相关图(ACF)及偏自相关图(PACF)如下：</p><p>图5. 一阶差分序列的自相关图</p><p>图6. 一阶差分序列的偏自相关图</p><p>由图5和图6可以看出p和q可能的取值分别为p = 3, 4, 7, q = 2, 3, 6, 8，从而我们考虑建立的模型如下表4所示，再通过AIC最小准则进行比较确定阶数p和q。</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> ARIMA AIC comparison of different order</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >模型</th><th align="center" valign="middle" >AIC</th><th align="center" valign="middle" >Log likelihood</th><th align="center" valign="middle" >模型</th><th align="center" valign="middle" >AIC</th><th align="center" valign="middle" >Log likelihood</th></tr></thead><tr><td align="center" valign="middle" >ARIMA(3, 1, 2)</td><td align="center" valign="middle" >6466.43</td><td align="center" valign="middle" >−3227.21</td><td align="center" valign="middle" >ARIMA(4, 1, 3)</td><td align="center" valign="middle" >6463.93</td><td align="center" valign="middle" >−3223.97</td></tr><tr><td align="center" valign="middle" >ARIMA(3, 1, 3)</td><td align="center" valign="middle" >6464.34</td><td align="center" valign="middle" >−3225.17</td><td align="center" valign="middle" >ARIMA(4, 1, 8)</td><td align="center" valign="middle" >6462.07</td><td align="center" valign="middle" >−3218.04</td></tr><tr><td align="center" valign="middle" >ARIMA(3, 1, 6)</td><td align="center" valign="middle" >6466.05</td><td align="center" valign="middle" >−3223.25</td><td align="center" valign="middle" >ARIMA(7, 1, 2)</td><td align="center" valign="middle" >6465.93</td><td align="center" valign="middle" >−3222.97</td></tr><tr><td align="center" valign="middle" >ARIMA(3, 1, 8)</td><td align="center" valign="middle" >6462.88</td><td align="center" valign="middle" >−3219.44</td><td align="center" valign="middle" >ARIMA(7, 1, 3)</td><td align="center" valign="middle" >6467.52</td><td align="center" valign="middle" >−3222.76</td></tr><tr><td align="center" valign="middle" >ARIMA(4, 1, 2)</td><td align="center" valign="middle" >6468.23</td><td align="center" valign="middle" >−3227.12</td><td align="center" valign="middle" >ARIMA(7, 1, 6)</td><td align="center" valign="middle" >6464.09</td><td align="center" valign="middle" >−3218.05</td></tr></tbody></table></table-wrap><p>表4. ARIMA不同阶数AIC比较</p><p>从表4可以看出，在所有选择的模型中，当p取4，q取8时，AIC值为6462.07，AIC值是最小的，因此确定模型为ARIMA(4, 1, 8)，代入公式(1)，模型ARIMA(4, 1, 8)的表达式为：</p><p>Y t = ( 1 + ϕ 1 ) Y t − 1 + ( ϕ 2 − ϕ 1 ) Y t − 2 + ( ϕ 3 − ϕ 2 ) Y t − 3 + ( ϕ 4 − ϕ 3 ) Y t − 4 − ϕ 4 Y t − 5 + ε t     − θ 1 ε t − 1 − θ 2 ε t − 2 − θ 3 ε t − 3 − θ 4 ε t − 4 − θ 5 ε t − 5 − θ 6 ε t − 6 − θ 7 ε t − 7 − θ 8 ε t − 8</p><p>对ARIMA(4, 1, 8)进行参数估计，估计值如表5所示：</p><table-wrap id="table5" ><label><xref ref-type="table" rid="table5">Table 5</xref></label><caption><title> ARIMA(4, 1, 8) model parameter value</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Variable</th><th align="center" valign="middle" >Coefficient</th><th align="center" valign="middle" >Variable</th><th align="center" valign="middle" >Coefficient</th></tr></thead><tr><td align="center" valign="middle" >AR(1)</td><td align="center" valign="middle" >0.2542</td><td align="center" valign="middle" >MA(3)</td><td align="center" valign="middle" >−0.1111</td></tr><tr><td align="center" valign="middle" >AR(2)</td><td align="center" valign="middle" >0.4055</td><td align="center" valign="middle" >MA(4)</td><td align="center" valign="middle" >0.6840</td></tr><tr><td align="center" valign="middle" >AR(3)</td><td align="center" valign="middle" >0.2268</td><td align="center" valign="middle" >MA(5)</td><td align="center" valign="middle" >−0.0410</td></tr><tr><td align="center" valign="middle" >AR(4)</td><td align="center" valign="middle" >−0.7928</td><td align="center" valign="middle" >MA(6)</td><td align="center" valign="middle" >−0.0604</td></tr><tr><td align="center" valign="middle" >MA(1)</td><td align="center" valign="middle" >−0.2235</td><td align="center" valign="middle" >MA(7)</td><td align="center" valign="middle" >0.2323</td></tr><tr><td align="center" valign="middle" >MA(2)</td><td align="center" valign="middle" >−0.4505</td><td align="center" valign="middle" >MA(8)</td><td align="center" valign="middle" >−0.1036</td></tr></tbody></table></table-wrap><p>表5. ARIMA(4, 1, 8)模型各参数值</p><p>将估计的参数代入到模型表达式中得到：</p><p>Y t = 1 .2542 Y t − 1 + 0.1513 Y t − 2 − 0.1787 Y t − 3 − 1.0196 Y t − 4 − 0.7928 Y t − 5 + ε t             + 0.2235 ε t − 1 + 0.4505 ε t − 2 + 0.1111 ε t − 3 − 0.6840 ε t − 4 + 0.0410 ε t − 5             + 0.0604 ε t − 6 − 0.2323 ε t − 7 + 0.1036 ε t − 8</p></sec><sec id="s7_2_3"><title>3.2.3. 模型的诊断检验</title><p>上文中，我们已经建立了ARIMA(4, 1, 8)模型，还需对模型的残差进行白噪声和正态性检验，只有检验通过，才能利用该模型进行预测。</p><p>画出残差的时序图和自相关图，如图7所示，从图可以看出，残差序列是平稳，且是相互独立的，并做Ljung-Box检验，从结果得知，Ljung-Box检验的 P-Value = 1 &gt; 0.05 ，这说明了残差序列是白噪声的，通过图8残差的Q-Q图可知，残差是满足正态性。</p><p>图7. 残差序列图及自相关图</p><p>图8. 残差正态检验Q-Q图</p><p>综上所述，建立的ARIMA(4, 1, 8)模型是可行的，可以用于预测沪深300指数的收盘价。采用同样的建模过程对百度股票进行时间序列建模，得到ARIMA(2, 1, 2)模型为最优模型，且该模型各种检验均通过。</p></sec></sec><sec id="s7_3"><title>3.3. BP神经网络模型</title><p>在BP神经网络模型预测中，不考虑其他的影响因子，仅以本文选取的两组实验数据作为单一预测因子。为了避免过拟合，对数据进行划分，把收集的实验数据中的时间序列划分为训练集、测试集和验证集，并且根据时间顺序分别按比例70%、15%和15%来进行划分。通过检验得到当隐含层为4时，以沪深300指数收盘价为原始数据的神经网络的均方误差最小，当隐含层为3时，以百度收盘价为原始数据的神经网络的均方误差最小，在使用MATLAB R2014a进行神经网络建模时，分别设计一个隐含层神经元数目为4、3的3层网络结构，并利用设计好的神经网络模型，对本文选取的两组数据沪深300指数和百度的收盘价进行预测。</p></sec></sec><sec id="s8"><title>4. 模型预测结果比较</title><p>利用单一模型ARIMA(4, 1, 8)模型和BP神经网络模型对沪深300指数收盘价的预测值，两种组合法得到的模型的预测值以及各模型所对应的相对误差如表6，表7所示，用ARIMA(2, 1, 2)模型和BP神经网络模型，以及采用不同方式组合的模型，对百度收盘价的预测值及各模型预测的相对误差如表8，表9所示。</p><table-wrap id="table6" ><label><xref ref-type="table" rid="table6">Table 6</xref></label><caption><title> Predicted values of CSI 300 Index by different model</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >日期</th><th align="center" valign="middle"  rowspan="2"  >实际收盘价</th><th align="center" valign="middle"  colspan="3"  >不同模型的预测值</th><th align="center" valign="middle" ></th></tr></thead><tr><td align="center" valign="middle" >ARIMA(4, 1, 8)</td><td align="center" valign="middle" >BP</td><td align="center" valign="middle" >等权重组合</td><td align="center" valign="middle" >方差倒数法组合</td></tr><tr><td align="center" valign="middle" >2019/12/18</td><td align="center" valign="middle" >4032.78</td><td align="center" valign="middle" >4053.58</td><td align="center" valign="middle" >4035.54</td><td align="center" valign="middle" >4044.56</td><td align="center" valign="middle" >4043.85</td></tr><tr><td align="center" valign="middle" >2019/12/19</td><td align="center" valign="middle" >4027.15</td><td align="center" valign="middle" >4053.34</td><td align="center" valign="middle" >4029.58</td><td align="center" valign="middle" >4041.46</td><td align="center" valign="middle" >4040.53</td></tr><tr><td align="center" valign="middle" >2019/12/20</td><td align="center" valign="middle" >4017.25</td><td align="center" valign="middle" >4052.9</td><td align="center" valign="middle" >4023.90</td><td align="center" valign="middle" >4038.40</td><td align="center" valign="middle" >4037.26</td></tr><tr><td align="center" valign="middle" >2019/12/23</td><td align="center" valign="middle" >3967.1</td><td align="center" valign="middle" >4043.9</td><td align="center" valign="middle" >4018.48</td><td align="center" valign="middle" >4031.19</td><td align="center" valign="middle" >4030.19</td></tr><tr><td align="center" valign="middle" >2019/12/24</td><td align="center" valign="middle" >3992.96</td><td align="center" valign="middle" >4048.78</td><td align="center" valign="middle" >4013.29</td><td align="center" valign="middle" >4031.03</td><td align="center" valign="middle" >4029.65</td></tr><tr><td align="center" valign="middle" >2019/12/25</td><td align="center" valign="middle" >3990.87</td><td align="center" valign="middle" >4037.16</td><td align="center" valign="middle" >4008.32</td><td align="center" valign="middle" >4022.74</td><td align="center" valign="middle" >4021.61</td></tr><tr><td align="center" valign="middle" >2019/12/26</td><td align="center" valign="middle" >4025.99</td><td align="center" valign="middle" >4046.6</td><td align="center" valign="middle" >4003.55</td><td align="center" valign="middle" >4025.08</td><td align="center" valign="middle" >4023.39</td></tr><tr><td align="center" valign="middle" >2019/12/27</td><td align="center" valign="middle" >4022.03</td><td align="center" valign="middle" >4046.62</td><td align="center" valign="middle" >3998.96</td><td align="center" valign="middle" >4022.79</td><td align="center" valign="middle" >4020.93</td></tr><tr><td align="center" valign="middle" >2019/12/30</td><td align="center" valign="middle" >4081.63</td><td align="center" valign="middle" >4043.95</td><td align="center" valign="middle" >3994.54</td><td align="center" valign="middle" >4019.25</td><td align="center" valign="middle" >4017.31</td></tr><tr><td align="center" valign="middle" >2019/12/31</td><td align="center" valign="middle" >4096.58</td><td align="center" valign="middle" >4054.64</td><td align="center" valign="middle" >3990.28</td><td align="center" valign="middle" >4022.46</td><td align="center" valign="middle" >4019.94</td></tr></tbody></table></table-wrap><p>表6. 不同模型对沪深300指数的预测值</p><table-wrap id="table7" ><label><xref ref-type="table" rid="table7">Table 7</xref></label><caption><title> Relative error of different models on the CSI 300 Inde</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >日期</th><th align="center" valign="middle"  colspan="3"  >不同模型的预测值</th><th align="center" valign="middle" ></th></tr></thead><tr><td align="center" valign="middle" >ARIMA(4, 1, 8)</td><td align="center" valign="middle" >BP</td><td align="center" valign="middle" >等权重组合</td><td align="center" valign="middle" >方差倒数法组合</td></tr><tr><td align="center" valign="middle" >2019/12/18</td><td align="center" valign="middle" >0.52%</td><td align="center" valign="middle" >0.07%</td><td align="center" valign="middle" >0.29%</td><td align="center" valign="middle" >0.27%</td></tr><tr><td align="center" valign="middle" >2019/12/19</td><td align="center" valign="middle" >0.65%</td><td align="center" valign="middle" >0.06%</td><td align="center" valign="middle" >0.36%</td><td align="center" valign="middle" >0.33%</td></tr><tr><td align="center" valign="middle" >2019/12/20</td><td align="center" valign="middle" >0.89%</td><td align="center" valign="middle" >0.17%</td><td align="center" valign="middle" >0.53%</td><td align="center" valign="middle" >0.50%</td></tr><tr><td align="center" valign="middle" >2019/12/23</td><td align="center" valign="middle" >1.94%</td><td align="center" valign="middle" >1.30%</td><td align="center" valign="middle" >1.62%</td><td align="center" valign="middle" >1.59%</td></tr><tr><td align="center" valign="middle" >2019/12/24</td><td align="center" valign="middle" >1.40%</td><td align="center" valign="middle" >0.51%</td><td align="center" valign="middle" >0.95%</td><td align="center" valign="middle" >0.92%</td></tr><tr><td align="center" valign="middle" >2019/12/25</td><td align="center" valign="middle" >1.16%</td><td align="center" valign="middle" >0.44%</td><td align="center" valign="middle" >0.80%</td><td align="center" valign="middle" >0.77%</td></tr><tr><td align="center" valign="middle" >2019/12/26</td><td align="center" valign="middle" >0.51%</td><td align="center" valign="middle" >0.56%</td><td align="center" valign="middle" >0.02%</td><td align="center" valign="middle" >0.06%</td></tr><tr><td align="center" valign="middle" >2019/12/27</td><td align="center" valign="middle" >0.61%</td><td align="center" valign="middle" >0.57%</td><td align="center" valign="middle" >0.02%</td><td align="center" valign="middle" >0.03%</td></tr><tr><td align="center" valign="middle" >2019/12/30</td><td align="center" valign="middle" >0.92%</td><td align="center" valign="middle" >2.13%</td><td align="center" valign="middle" >1.53%</td><td align="center" valign="middle" >1.58%</td></tr><tr><td align="center" valign="middle" >2019/12/31</td><td align="center" valign="middle" >1.02%</td><td align="center" valign="middle" >2.59%</td><td align="center" valign="middle" >1.81%</td><td align="center" valign="middle" >1.87%</td></tr></tbody></table></table-wrap><p>表7. 不同模型对沪深300指数的相对误差</p><table-wrap id="table8" ><label><xref ref-type="table" rid="table8">Table 8</xref></label><caption><title> Different models predict Baidu’s stock pric</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >日期</th><th align="center" valign="middle"  rowspan="2"  >实际收盘价</th><th align="center" valign="middle"  colspan="4"  >不同模型的预测值</th></tr></thead><tr><td align="center" valign="middle" >ARIMA(2,1,2)</td><td align="center" valign="middle" >BP神经网络</td><td align="center" valign="middle" >等权重组合</td><td align="center" valign="middle" >方差倒数法组合</td></tr><tr><td align="center" valign="middle" >2019/12/18</td><td align="center" valign="middle" >126.69</td><td align="center" valign="middle" >123.59</td><td align="center" valign="middle" >124.53</td><td align="center" valign="middle" >124.06</td><td align="center" valign="middle" >124.07</td></tr><tr><td align="center" valign="middle" >2019/12/19</td><td align="center" valign="middle" >128.07</td><td align="center" valign="middle" >123.17</td><td align="center" valign="middle" >125.32</td><td align="center" valign="middle" >124.25</td><td align="center" valign="middle" >124.28</td></tr><tr><td align="center" valign="middle" >2019/12/20</td><td align="center" valign="middle" >127.49</td><td align="center" valign="middle" >123.68</td><td align="center" valign="middle" >126.22</td><td align="center" valign="middle" >124.95</td><td align="center" valign="middle" >124.99</td></tr><tr><td align="center" valign="middle" >2019/12/23</td><td align="center" valign="middle" >128.83</td><td align="center" valign="middle" >123.56</td><td align="center" valign="middle" >127.24</td><td align="center" valign="middle" >125.40</td><td align="center" valign="middle" >125.47</td></tr><tr><td align="center" valign="middle" >2019/12/24</td><td align="center" valign="middle" >128.49</td><td align="center" valign="middle" >123.31</td><td align="center" valign="middle" >128.38</td><td align="center" valign="middle" >125.84</td><td align="center" valign="middle" >125.93</td></tr><tr><td align="center" valign="middle" >2019/12/26</td><td align="center" valign="middle" >127.58</td><td align="center" valign="middle" >123.59</td><td align="center" valign="middle" >129.64</td><td align="center" valign="middle" >126.61</td><td align="center" valign="middle" >126.72</td></tr><tr><td align="center" valign="middle" >2019/12/27</td><td align="center" valign="middle" >126.45</td><td align="center" valign="middle" >123.54</td><td align="center" valign="middle" >130.98</td><td align="center" valign="middle" >127.26</td><td align="center" valign="middle" >127.39</td></tr><tr><td align="center" valign="middle" >2019/12/30</td><td align="center" valign="middle" >126.29</td><td align="center" valign="middle" >123.38</td><td align="center" valign="middle" >132.40</td><td align="center" valign="middle" >127.89</td><td align="center" valign="middle" >128.05</td></tr><tr><td align="center" valign="middle" >2019/12/31</td><td align="center" valign="middle" >126.4</td><td align="center" valign="middle" >123.54</td><td align="center" valign="middle" >133.87</td><td align="center" valign="middle" >128.70</td><td align="center" valign="middle" >128.88</td></tr></tbody></table></table-wrap><p>表8. 不同模型对百度股价的预测值</p><table-wrap id="table9" ><label><xref ref-type="table" rid="table9">Table 9</xref></label><caption><title> Relative error of Baidu’s stock price forecast by different model</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >日期</th><th align="center" valign="middle"  colspan="4"  >不同模型预测的相对误差</th></tr></thead><tr><td align="center" valign="middle" >ARIMA(2,1,2)</td><td align="center" valign="middle" >BP神经网络</td><td align="center" valign="middle" >等权重组合</td><td align="center" valign="middle" >方差倒数法组合</td></tr><tr><td align="center" valign="middle" >2019/12/18</td><td align="center" valign="middle" >2.45%</td><td align="center" valign="middle" >1.71%</td><td align="center" valign="middle" >2.08%</td><td align="center" valign="middle" >2.06%</td></tr><tr><td align="center" valign="middle" >2019/12/19</td><td align="center" valign="middle" >3.82%</td><td align="center" valign="middle" >2.15%</td><td align="center" valign="middle" >2.99%</td><td align="center" valign="middle" >2.96%</td></tr><tr><td align="center" valign="middle" >2019/12/20</td><td align="center" valign="middle" >2.99%</td><td align="center" valign="middle" >0.99%</td><td align="center" valign="middle" >1.99%</td><td align="center" valign="middle" >1.96%</td></tr><tr><td align="center" valign="middle" >2019/12/23</td><td align="center" valign="middle" >4.09%</td><td align="center" valign="middle" >1.23%</td><td align="center" valign="middle" >2.66%</td><td align="center" valign="middle" >2.61%</td></tr><tr><td align="center" valign="middle" >2019/12/24</td><td align="center" valign="middle" >4.03%</td><td align="center" valign="middle" >0.08%</td><td align="center" valign="middle" >2.06%</td><td align="center" valign="middle" >1.99%</td></tr><tr><td align="center" valign="middle" >2019/12/26</td><td align="center" valign="middle" >3.13%</td><td align="center" valign="middle" >1.61%</td><td align="center" valign="middle" >0.76%</td><td align="center" valign="middle" >0.68%</td></tr><tr><td align="center" valign="middle" >2019/12/27</td><td align="center" valign="middle" >2.30%</td><td align="center" valign="middle" >3.59%</td><td align="center" valign="middle" >0.64%</td><td align="center" valign="middle" >0.74%</td></tr><tr><td align="center" valign="middle" >2019/12/30</td><td align="center" valign="middle" >2.30%</td><td align="center" valign="middle" >4.84%</td><td align="center" valign="middle" >1.27%</td><td align="center" valign="middle" >1.39%</td></tr><tr><td align="center" valign="middle" >2019/12/31</td><td align="center" valign="middle" >2.26%</td><td align="center" valign="middle" >5.91%</td><td align="center" valign="middle" >1.82%</td><td align="center" valign="middle" >1.96%</td></tr></tbody></table></table-wrap><p>表9. 不同模型对百度股价预测的相对误差</p><p>上文中相对误差计算公式为：</p><p>相 对 误 差 = | 预 测 收 盘 价 − 实 际 收 盘 价 | 实 际 收 盘 价 &#215; 100 %</p><p>从预测的相对误差表7和表9我们可以看出，通过方差倒数法组合的预测效果在前期较好，在后期来看，等权重组合法的预测效果较好。</p><p>从模型整体预测效果来看，本文选择平均绝对百分比误差(MAPE)来评估模型的预测精度，计算公式如下：</p><p>MAPE = 100 N ∑ i = 1 N | y t − y ^ t y t | ， y t 为实际值， y ^ t 为预测值。</p><p>利用MAPE公式分别计算不同模型对沪深300指数和百度股票收盘价预测的平均相对误差，得到的结果如下表10所示：</p><table-wrap id="table10" ><label><xref ref-type="table" rid="table1">Table 1</xref>0</label><caption><title> MAPE for different prediction model</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="4"  >沪深300指数</th><th align="center" valign="middle"  rowspan="4"  >模型</th><th align="center" valign="middle" >ARIMA(4, 1, 8)</th><th align="center" valign="middle" >0.96%</th></tr></thead><tr><td align="center" valign="middle" >BP神经网络</td><td align="center" valign="middle" >0.84%</td></tr><tr><td align="center" valign="middle" >等权重组合</td><td align="center" valign="middle" >0.79%</td></tr><tr><td align="center" valign="middle" >方差倒数组合</td><td align="center" valign="middle" >0.79%</td></tr><tr><td align="center" valign="middle"  rowspan="4"  >百度</td><td align="center" valign="middle"  rowspan="4"  >模型</td><td align="center" valign="middle" >ARIMA(2, 1, 2)</td><td align="center" valign="middle" >3.04%</td></tr><tr><td align="center" valign="middle" >BP神经网络</td><td align="center" valign="middle" >2.46%</td></tr><tr><td align="center" valign="middle" >等权重组合</td><td align="center" valign="middle" >1.81%</td></tr><tr><td align="center" valign="middle" >方差倒数组合</td><td align="center" valign="middle" >1.82%</td></tr></tbody></table></table-wrap><p>表10. 不同预测模型的MAPE</p><p>由上表10可知，在对沪深300指数的预测模型中，等权重组合和方差倒数组合的ARIMA-BP的MAPE都为0.79%，是四个模型中最小的，说明组合后的模型预测效果最好，在对百度股价的预测模型中，等权重组合的模型的MAPE为1.81%，也是四个模型中最小的，说明预测效果最好。</p></sec><sec id="s9"><title>5. 结论</title><p>本文利用时间序列模型和BP神经网络模型，对沪深300指数和百度股票的收盘价进行分析，分别建立了ARIMA(4, 1, 8)和ARIMA(2, 1, 2)模型和BP神经网络两种单一模型，以及通过方差倒数法和等权重法来组合两种模型，得到等权重组合ARIMA-BP模型和方差倒数组合模型，并利用四种模型对收盘价进行预测。结果表明，组合模型的预测效果优于单一模型。在组合模型中，等权重组合ARIMA-BP模型的预测效果比方差倒数组合模型好；在单个模型中，BP神经网络的预测效果优于ARIMA模型。这一结论充分说明了结合金融数据的线性和非线性的特征来进行预测是可行的，能较高地提升我们的预测精度。</p></sec><sec id="s10"><title>文章引用</title><p>肖 琳,金良琼,韦学永. 基于ARIMA和BP神经网络组合模型对股票价格的预测Prediction of Stock Price Based on ARIMA and BP Neural Network Combined Model[J]. 应用数学进展, 2020, 09(10): 1776-1786. https://doi.org/10.12677/AAM.2020.910205</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.38285-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">吴玉霞, 温欣. 基于ARIMA模型的短期股票价格预测[J]. 统计与决策, 2016(23): 83-86.</mixed-citation></ref><ref id="hanspub.38285-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">贺本岚. 股票价格预测的最优选择模型[J]. 统计与决策, 2008(6): 135-137.</mixed-citation></ref><ref id="hanspub.38285-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">陈小玲. 基于ARIMA模型与神经网络模型的股价预测[J]. 经济数学, 2017, 34(4): 30-34.</mixed-citation></ref><ref id="hanspub.38285-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Bates, J.M. and Granger, C.W.J. (1969) Combination of Forecasts. Operational Research Quarterly, 20, 451-468.</mixed-citation></ref><ref id="hanspub.38285-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">翟静, 曹俊. 基于时间序列ARIMA与BP神经网络的组合预测模型[J]. 统计与决策, 2016(4): 29-32.</mixed-citation></ref><ref id="hanspub.38285-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">王黎明, 王连, 杨楠, 编著. 应用时间序列分析[M]. 上海: 复旦大学出版社, 2009.</mixed-citation></ref><ref id="hanspub.38285-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">任青山, 方逵, 朱幸辉. 基于多元回归的BP神经网络生猪价格预测模型[J]. 江苏农业科学, 2019, 47(14): 277-281.</mixed-citation></ref></ref-list></back></article>