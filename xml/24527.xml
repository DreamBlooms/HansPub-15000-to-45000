<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2018.84053</article-id><article-id pub-id-type="publisher-id">CSA-24527</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20180400000_91493596.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于图像插值误差扩展的可逆医学图像水印
  Reversible Medical Image Watermarking Based on Image Interpolation Error Expansion
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>苌</surname><given-names>悦</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>晅</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>陕西师范大学，陕西 西安</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>08</day><month>04</month><year>2018</year></pub-date><volume>08</volume><issue>04</issue><fpage>480</fpage><lpage>486</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   将水印信息嵌入到音频，图像或视频等数字信号中可以保护产品的版权信息。在提取水印信息后，可逆水印图像可以在没有任何失真的情况下恢复原始图像。在本文中，我们利用加法插值误差扩展技术水印数据嵌入到图像的平滑区域中。与以前的水印方法不同，加法插值误差扩展通过对插值误差相加扩展或保持不变来嵌入比特“1”或“0”。由于只对平滑区域的像素进行了轻微的修改，因此保留了图像的高质量。实验结果还表明，与其他最先进的方案相比，所提出的方案可以提供更大的有效载荷容量和更高的图像保真度。 Embedding watermark information into audio, image or video digital signals can protect the copy-right information of products. After the watermark information is extracted, the original image can be restored without any distortion in the reversible watermark image. In this paper, we use the additive interpolation error extension method to embed watermark data into the smooth region of the image. Unlike previous watermarking methods, the additive interpolation error expansion embeds bits “1” or “0” by adding or expanding the interpolation error additively. Since only slight modifications have been made to the pixels of the smooth area, the high quality of the image is preserved. The experiment results show that the proposed scheme can provide greater payload capacity and higher image fidelity, compared with other most advanced schemes.
    
  
 
</p></abstract><kwd-group><kwd>医学图像，插值图像，加法插值误差扩展，可逆水印, Medical Image</kwd><kwd> Interpolation Image</kwd><kwd> Additive Interpolation Error Expansion</kwd><kwd> Reversible Water-mark</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于图像插值误差扩展的可逆医学图像水印<sup> </sup></title><p>苌悦，王晅</p><p>陕西师范大学，陕西 西安</p><p><img src="//html.hanspub.org/file/8-1540969x1_hanspub.png" /></p><p>收稿日期：2018年4月3日；录用日期：2018年4月19日；发布日期：2018年4月26日</p><disp-formula id="hanspub.24527-formula88"><graphic xlink:href="//html.hanspub.org/file/8-1540969x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>将水印信息嵌入到音频，图像或视频等数字信号中可以保护产品的版权信息。在提取水印信息后，可逆水印图像可以在没有任何失真的情况下恢复原始图像。在本文中，我们利用加法插值误差扩展技术水印数据嵌入到图像的平滑区域中。与以前的水印方法不同，加法插值误差扩展通过对插值误差相加扩展或保持不变来嵌入比特“1”或“0”。由于只对平滑区域的像素进行了轻微的修改，因此保留了图像的高质量。实验结果还表明，与其他最先进的方案相比，所提出的方案可以提供更大的有效载荷容量和更高的图像保真度。</p><p>关键词 :医学图像，插值图像，加法插值误差扩展，可逆水印</p><disp-formula id="hanspub.24527-formula89"><graphic xlink:href="//html.hanspub.org/file/8-1540969x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/8-1540969x7_hanspub.png" /> <img src="//html.hanspub.org/file/8-1540969x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着区域医疗和远程诊断技术的飞速发展，越来越多的医学图像开始在公网上进行传输。由于公网固有的安全隐患，医学图像数据的安全性受到巨大挑战 [<xref ref-type="bibr" rid="hanspub.24527-ref1">1</xref>] 。数字水印技术很好地解决了这一问题，它通过将一段具有特定含义的标识信息嵌入在载体医学图像中，能实现医学图像的真实性和完整性认证、电子病历EPR (Electronic Patient Record)的隐藏和版权保护 [<xref ref-type="bibr" rid="hanspub.24527-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.24527-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.24527-ref4">4</xref>] 。然而，通常的有损数字水印算法并不能满足医学对象的应用需求，因为作为诊断依据的医学图像对完整性有着严格的限制，要求含水印的医学图像在水印提取出来后，必须能恢复到原始的状态，即无损数字水印技术。目前，无损数字水印技术已经广泛应用在对完整性敏感的工程图设计、医学信息和法律证据等领域。</p><p>图像数据隐藏共分为两类，分别为可逆和不可逆的，而且无论是哪一类，水印嵌入都会改变载体，而且水印信息嵌入的越多，就会导致失真性越大，也就意味着数据隐藏性越差．所以，越来越多的专家和学者开始研究如何在确保低失真的基础上，把尽可能大的容量嵌入进去．可逆水印的特点是在提取水印信息后可以完全无损地恢复原始图像，主要应用于对图像质量要求极高的领域，如医学影像，遥感地图和法律证据图像等。医学图像具有与自然图像不同的特点，主要表现在图像精度要求高，相对平滑以及有大量空白区域(无信息的黑色区域)。MB Andra等在混合预测的基础上通过扩展预测误差来提高可逆水印算法的容量 [<xref ref-type="bibr" rid="hanspub.24527-ref5">5</xref>] ；MP Turuk等基于小波变换的方法利用量化函数来嵌入多个水印 [<xref ref-type="bibr" rid="hanspub.24527-ref6">6</xref>] ；陈亮等利用图像小波变换后的高频子带系数进行水印嵌入，改进传统的直方图平移方法，设计了嵌入参数选择算法 [<xref ref-type="bibr" rid="hanspub.24527-ref7">7</xref>] 。本文基于图像插值设计研究了可逆水印算法，介绍了可逆信息隐藏技术的研究现状、特性、评价标准以及研究前景，讨论了常见的插值算法，提出了本文所用的插值算法；在研究插值图像可逆原理的基础上，探讨了水印的嵌入、提取以及载体还原技术。</p></sec><sec id="s4"><title>2. 加法插值误差扩展</title><p>首先通过公式(1)获得插值误差</p><p>e = X − X ′ (1)</p><p>其中 X ′ 是像素值为X的插值。LM和RM表示插值误差直方图中的两个最高点，假设 L M &lt; R M ，我们可以把插值误差分为两部分：</p><p>左侧插值误差(LM)：插值误差e满足 e &lt; L M</p><p>右侧插值误差(RM)：插值误差e满足 e &lt; R M</p><p>加法插值误差扩展的公式为：</p><p>e ′ = { e + s i g n ( e ) &#215; b , e = L M / R M e + s i g n ( e ) &#215; 1 , e ∈ ( L N , L M ) ∪ ( R M , R N ) e , otherwise (2)</p><p>其中 e ′ 是扩展后的插值误差，b是嵌入的水印位，其中sign(.)函数定义为</p><p>s i g n ( e ) = { 1 , e ∈ L E − 1 , e ∈ R E (3)</p><p>其中参数LN与RN定义为</p><p>{ L N = arg min e ∈ L E h i s t ( e ) R N = arg min e ∈ R E h i s t ( e ) (4)</p><p>扩展之后得到水印像素 X ″</p><p>X ″ = X ′ + e ′ (5)</p><p>在提取过程中，使用相同的插值算法，我们可以获得相同的插值 X ′ ，并得到相应的插值误差</p><p>e ′ = X ″ − X ′ (6)</p><p>在已知LM，LN，RM，RN的情况下，即可提取嵌入的水印位</p><p>b = { 0 , e ′ = L M / R M 1 , e ′ = L M − 1 / R M + 1 (7)</p><p>然后应用加法插值误差扩展的逆函数来恢复原始插值误差</p><p>e = { e ′ − s i g n ( e ′ ) &#215; b e ′ ∈ [ L M − 1 , L M ] ∪ [ R M , R M + 1 ] e ′ − s i g n ( e ′ ) &#215; 1 e ′ ∈ [ L N , L N − 1 ] ∪ [ R M + 1 , R N ] e ' otherwise (8)</p><p>最终我们可以恢复原始像素</p><p>X = X ′ + e (9)</p></sec><sec id="s5"><title>3. 插值算法</title><p>在现有的研究中，使用的放大图像的方法均为不可逆的，就算把同一幅图像放大之后再按同样的比例缩小，在图像处理过程中也会有损失产生 [<xref ref-type="bibr" rid="hanspub.24527-ref8">8</xref>] 。假设低分辨率图像 X l 是由高分辨率图像 X h 通过 X l ( i , j ) = X ( 2 i − 1 , 2 j − 1 ) 直接下采样得到的。如图1所示，黑点代表下采样像素x<sub>l</sub>，白点表示遗失的像素。用所选插值方法放大的图像，由大小为m &#180; n的图像得到2m &#180; 2n的图像。</p><p>插值的关键问题是如何推断和利用缺失像素与相邻像素之间的相关性。首先，那些遗失的像素</p><p>X h ( 2 i , 2 j ) 在由四个低分辨率像素围绕的中心位置处被内插。其次，其他缺失的像素 X h ( 2 i − 1 , 2 j ) 和 X h ( 2 i , 2 j − 1 ) 在已经恢复的像素的帮助下进行插值预测。如图1(b)所示，我们可以沿着45&#176;和135&#176;两个方向对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/8-1540969x31_hanspub.png" xlink:type="simple"/></inline-formula>进行插值预测。预测过程如下：</p><p>计算 X ′ 45 ( 2 i , 2 j ) 和 X ′ 135 ( 2 i , 2 j ) 两个方向插值结果</p><p>{ X ′ 45 = ( X l ( i , j + 1 ) + X l ( i + 1 , j ) ) / 2 X ′ 135 = ( X l ( i , j ) + X l ( i + 1 , j + 1 ) ) / 2 (10)</p><p>图1. (a) 从高分辨率图像形成低分辨率图像；(b)，(c) 高分辨率插值图像的剩余样本；(d) 原始像素的插值</p><p>计算两个方向的插值误差 e 45 和 e 135 <sub> </sub></p><p>{ e 45 ( 2 i , 2 j ) = X ′ 45 ( 2 i , 2 j ) − X h ( 2 i , 2 j ) e 135 ( 2 i , 2 j ) = X ′ 135 ( 2 i , 2 j ) − X h ( 2 i , 2 j ) (11)</p><p>选择一个最佳的权重对来使 X ′ h 成为X的一个很好的估计， X ′ 需满足如下要求</p><p>{ X ′ h = w 45 &#215; X ′ 45 + w 135 &#215; X ′ 135 w 45 + w 135 = 1 (12)</p><p>确定权重w<sub>45</sub>和w<sub>135</sub>以最小化 X h 的均方误差</p><p>w 45 = σ ( e 135 ) σ ( e 45 ) + σ ( e 135 ) ,       w 135 = 1 − w 45 (13)</p><p>其中 σ ( e 45 ) 和 σ ( e 135 ) 分别是 e 45 和 e 135 的方差。</p><p>为了平衡计算的复杂性和像素的一致性，计算u</p><p>u = X l ( i , j + 1 ) + X l ( i + 1 , j ) 4 + X l ( i , j ) + X l ( i + 1 , j + 1 ) 4 (14)</p><p>5) 计算 σ ( e 45 ) 和 σ ( e 135 )</p><p>{ σ ( e 45 ) = 1 3 ∑ k = 1 3 ( S 45 ( k ) − u ) 2 σ ( e 135 ) = 1 3 ∑ k = 1 3 ( S 135 ( k ) − u ) 2 (15)</p><p>其中 { S 45 = { X l ( i , j + 1 ) , X ′ 45 , X l ( i + 1 , j ) } S 135 = { X l ( i , j ) , X ′ 135 , X l ( i + 1 , j + 1 ) }</p><p>由式(10)~(15)即可得到 X h ( 2 i , 2 j ) 。</p><p>在估计缺失的高分辨率像素 X h ( 2 i , 2 j ) 之后，可以类似地估计剩余像素 X h ( 2 i − 1 , 2 j ) 和 X h ( 2 i , 2 j − 1 ) 。参照图1(c)，黑点表示低分辨率像素，灰点表示第一步中的估计像素，白点表示要内插的像素。如图2(c)中，除了将两个方向修改为0˚和90˚之外，其余部分的计算方法与第一步中描述的类似。最后，通过上述过程重建整个高分辨率图。</p></sec><sec id="s6"><title>4. 水印的嵌入与提取</title><p>医学图像与一般的图像有一定的区别，不仅仅是图像精度要求高，而且还有相对平滑以及有大量空白区域(无信息的黑色区域)，我们选择在图像的平滑区域嵌入水印，保留图像变化较大的区域，可以在保证图像嵌入率的前提下不影响图像质量。</p><p>嵌入流程：</p><p>设原图像为I，待嵌入的水印为</p><p>Step1：对图像进行边缘提取，得到二值图像，将图像分为16 &#215; 16大小的块，计算二值图像每块的和sum，设立阈值T = 20，对sum &lt; T的图像标记为block并进行嵌入，其余块保持不变。建立二值图像，并对将要进行嵌入的块map的位置标记为1；</p><p>Step2：利用式(10)~(15)对块block进行上述的插值图像预测，并求出每个像素的插值误差e；</p><p>Step3：对插值误差e利用公式进行扩展，并嵌入水印，得到扩展后的误差 e ′ ；</p><p>Step4：利用式(1)~(5)嵌入水印后的像素，即完成了水印的嵌入；</p><p>Step5：对于嵌入水印后像素发生溢出的位置，建立位置图，发生溢出的位置直接跳过并且在位置图中标记为1，不发生溢出的位置标记为0。</p><p>用流程图可表示为图2所示。</p><p>水印的提取过程与嵌入流程相反，过程如下：</p><p>Step1：将图像分为16 &#215; 16大小的块，获取嵌入时用到的每个块的LM，LN，RM，RN；</p><p>Step2：对标记为map = 1的块利用式(6)~(8)进行提取，对位置图标记为1的位置跳过，即可得到误差e和嵌入的水印位b；</p><p>Step3：利用式(9)恢复图像的原始像素X。</p></sec><sec id="s7"><title>5. 实验结果</title><p>本次实验的原始图像采用512 &#215; 512大小的医学图像，如图3所示的三张图像，嵌入的水印为随机二进制位。为了对实验结果进行分析比对，采用峰值信噪比(PSNR)和嵌入容量(嵌入到载体图像的比特位的个数，用bits表示)作为算法的性能评估标准。</p><p>为了分析比较，将本方案和文献 [<xref ref-type="bibr" rid="hanspub.24527-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.24527-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.24527-ref7">7</xref>] 进行比对，结果如表1所示。从表1可以看出，相较于其他3种方法，本文方法不管在嵌入容量还是峰值信噪比(PSNR)上都有明显的提高。</p><p>图4给出了不同的载体图像在不同的嵌入容量下的 PSNＲ值测试结果。</p></sec><sec id="s8"><title>6. 结论</title><p>本文提出了一种新的可逆水印方案。与使用预测或小波技术的最新方案不同，所提出的方案使用插值技术来产生误差，相邻像素之间具有更大的去相关能力。通过对这些插值误差应用加法扩展，我们实</p><p>图2. 嵌入流程图</p><p>图3. 原始图像 (a) CT图像；(b) MRI图像；(c) 超声图像</p><p>图4. 不同载体图像在不同的嵌入容量下的PSNR测试结果</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Comparison in three images of capacity and PSN</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  ></th><th align="center" valign="middle"  colspan="2"  >CT图像</th><th align="center" valign="middle"  colspan="2"  >MRI图像</th><th align="center" valign="middle"  colspan="2"  >超声图像</th></tr></thead><tr><td align="center" valign="middle" >容量</td><td align="center" valign="middle" >PSNR</td><td align="center" valign="middle" >容量</td><td align="center" valign="middle" >PSNR</td><td align="center" valign="middle" >容量</td><td align="center" valign="middle" >PSNR</td></tr><tr><td align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.24527-ref5">5</xref>]</td><td align="center" valign="middle" >14689</td><td align="center" valign="middle" >47.65</td><td align="center" valign="middle" >14563</td><td align="center" valign="middle" >47.39</td><td align="center" valign="middle" >14258</td><td align="center" valign="middle" >49.26</td></tr><tr><td align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.24527-ref6">6</xref>]</td><td align="center" valign="middle" >15326</td><td align="center" valign="middle" >47.79</td><td align="center" valign="middle" >15482</td><td align="center" valign="middle" >47.66</td><td align="center" valign="middle" >15987</td><td align="center" valign="middle" >47.65</td></tr><tr><td align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.24527-ref7">7</xref>]</td><td align="center" valign="middle" >13589</td><td align="center" valign="middle" >46.35</td><td align="center" valign="middle" >13103</td><td align="center" valign="middle" >47.52</td><td align="center" valign="middle" >12568</td><td align="center" valign="middle" >47.24</td></tr><tr><td align="center" valign="middle" >本文方法</td><td align="center" valign="middle" >16598</td><td align="center" valign="middle" >49.28</td><td align="center" valign="middle" >17927</td><td align="center" valign="middle" >48.36</td><td align="center" valign="middle" >16927</td><td align="center" valign="middle" >49.72</td></tr></tbody></table></table-wrap><p>表1. 三种图像容量和PSNR的对比</p><p>现了高效的可逆水印方案，该方案在不牺牲嵌入容量的情况下保证了高质量的图像质量。根据实验结果，所提出的可逆方案提供了更高的容量并且为水印图像实现了更好的图像质量。另外，所提出的方案的计算成本很小。</p></sec><sec id="s9"><title>文章引用</title><p>苌 悦,王 晅. 基于图像插值误差扩展的可逆医学图像水印 Reversible Medical Image Watermarking Based on Image Interpolation Error Expansion[J]. 计算机科学与应用, 2018, 08(04): 480-486. https://doi.org/10.12677/CSA.2018.84053</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.24527-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Hu, J.K., Chen, H.H. and Hou, T.W. (2010) A Hybrid Public Key Infrastructure Solution (HPKI) for HIPAA Privacy/Security Regula-tions. Computer Standards &amp; Interfaces, 32, 274-280. &lt;br&gt;https://doi.org/10.1016/j.csi.2009.04.005</mixed-citation></ref><ref id="hanspub.24527-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Tan, C.K., Ng, J.C., Xu, X.T., et al. (2011) Security Protection of DICOM Medical Images Using Dual-Layer Reversible Watermarking with Tamper Detection Capability. Journal of Digital Imaging, 24, 528-540. 
&lt;br&gt;https://doi.org/10.1007/s10278-010-9295-4</mixed-citation></ref><ref id="hanspub.24527-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Deng, X.H., Chen, Z.G., Deng, X.H., et al. (2011) A Novel Dual-Layer Re-versible Watermarking for Medical Image Authentication and EPR Hiding. Advanced Science Letters, 4, 3678-3684. &lt;br&gt;https://doi.org/10.1166/asl.2011.1886</mixed-citation></ref><ref id="hanspub.24527-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Nayak, J., Bhat, P.S., Acharya, U.R., et al. (2009) Efficient Storage and Transmission of Digital Fundus Images with Patient Information Using Reversible Watermarking Technique and Error Control Codes. Journal of Medical Systems, 33, 163-171. &lt;br&gt;https://doi.org/10.1007/s10916-008-9176-2</mixed-citation></ref><ref id="hanspub.24527-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Vinoth, K.C. and Natarajan, V. (2016) Hybrid Local Prediction Error-Based Difference Expansion Reversible Watermarking for Medical Images. Computers &amp; Electrical Engineering, 53, 333-345.  
&lt;br&gt;https://doi.org/10.1016/j.compeleceng.2015.11.033</mixed-citation></ref><ref id="hanspub.24527-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Turuk, M.P. and Dhande, A.P. (2016) A Novel Reversible Multiple Medical Image Watermarking for Health Information System. Plenum Press, New York, NY.</mixed-citation></ref><ref id="hanspub.24527-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">陈亮, 刘惠文, 邓小鸿. 基于整数小波变换的数字图像可逆水印算法[J]. 计算机应用与软件, 2016, 33(4): 286-291.</mixed-citation></ref><ref id="hanspub.24527-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Luo, L., Chen, Z., Chen, M., et al. (2010) Reversible Image Watermarking Using Interpolation Technique. IEEE Transactions on Information Forensics &amp; Security, 5, 187-193. &lt;br&gt;https://doi.org/10.1109/TIFS.2009.2035975</mixed-citation></ref></ref-list></back></article>