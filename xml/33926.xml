<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">OE</journal-id><journal-title-group><journal-title>Optoelectronics</journal-title></journal-title-group><issn pub-type="epub">2164-5450</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/OE.2020.101001</article-id><article-id pub-id-type="publisher-id">OE-33926</article-id><article-categories><subj-group subj-group-type="heading"><subject>OE20200100000_71399671.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  自动匹配技术在大气能见度观测中的应用
  Application of Automatic Matching Technology in Atmospheric Visibility Observation
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>雷</surname><given-names>鸣</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>旭林</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>聂</surname><given-names>凯</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>琪</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>凯华</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>北京市气象探测中心，北京</addr-line></aff><aff id="aff1"><addr-line>天津市气象信息中心，天津</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>13</day><month>01</month><year>2020</year></pub-date><volume>10</volume><issue>01</issue><fpage>1</fpage><lpage>7</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文提出了一种多分辨率边缘增强快速归一化积相关匹配算法。针对图像匹配实时性问题，设计了先粗后精的匹配控制策略，实现了归一化积相关图像匹配算法的有效加速。通过在大气能见度观测中的应用试验，验证了所给算法的有效性，能够自动实时定位目标，取得了较好的观测效果。 In this paper, a fast normalized product correlation matching algorithm for multi-resolution edge enhancement is proposed. Aiming at the real-time problem of image matching, the matching control strategy of coarse first and fine second is designed, and the effective acceleration of normalized product correlation image matching algorithm is realized. Through the application test in the atmospheric visibility observation, the effectiveness of the algorithm is verified, and the target can be automatically located in real time, and the observation effect is good.
    
  
 
</p></abstract><kwd-group><kwd>图像匹配，归一化积相关，边缘增强，金字塔分解, Image Matching</kwd><kwd> Normalized Product Correlation</kwd><kwd> Edge Enhancement</kwd><kwd> Pyramid Decomposing</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>自动匹配技术在大气能见度观测中的应用<sup> </sup></title><p>雷鸣<sup>1*</sup>，刘旭林<sup>2*</sup>，聂凯<sup>2</sup>，王琪<sup>1</sup>，陈凯华<sup>1</sup></p><p><sup>1</sup>天津市气象信息中心，天津</p><p><sup>2</sup>北京市气象探测中心，北京</p><disp-formula id="hanspub.33926-formula1"><graphic xlink:href="//html.hanspub.org/file/1-2140214x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2019年12月23日；录用日期：2020年1月6日；发布日期：2020年1月13日</p><disp-formula id="hanspub.33926-formula2"><graphic xlink:href="//html.hanspub.org/file/1-2140214x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文提出了一种多分辨率边缘增强快速归一化积相关匹配算法。针对图像匹配实时性问题，设计了先粗后精的匹配控制策略，实现了归一化积相关图像匹配算法的有效加速。通过在大气能见度观测中的应用试验，验证了所给算法的有效性，能够自动实时定位目标，取得了较好的观测效果。</p><p>关键词 :图像匹配，归一化积相关，边缘增强，金字塔分解</p><disp-formula id="hanspub.33926-formula3"><graphic xlink:href="//html.hanspub.org/file/1-2140214x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/1-2140214x8_hanspub.png" /> <img src="//html.hanspub.org/file/1-2140214x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>图像匹配技术在卫星遥感、自然资源分析、天气预报、指纹识别、变迁检测、空间飞行器的自动导航、机器人视觉、气象云图分析及医学X射线图片处理等许多领域有重要的应用价值。</p><p>在这些领域中，传统的图像匹配算法有序贯相似性检测算法(SSDA)、平均绝对差算法(MAD)和hadamard变换算法(SATD)等。SSDA算法其实是利用子图与模板图各自去掉其均值后，对应位置之差的绝对值进行计算；MAD算法是计算子图与模板图对应位置上，灰度值之差的绝对值总和，再求平均，其实质是计算子图与模板图距离的平均值，优点是简单易实现，但运算量大，对噪声敏感；SATD算法是将模板与子图做差后得到的矩阵Q，再对矩阵Q求其hadamard变换，对变换所得矩阵求其元素的绝对值之和即SATD值，作为相似度的判别依据。</p><p>以上算法本质上都属于模板算法，而图像相关匹配是一种在图像中寻找有无所关心目标物的最常用的处理方法 [<xref ref-type="bibr" rid="hanspub.33926-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.33926-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.33926-ref3">3</xref>]，也同样属于模板算法。这类传统的相关性匹配算法，其特点是运算简单，匹配精度高，易于实现，但运算量大。</p><p>针对上述问题，本文提出了一种以互相关算法为基础，利用边缘增强技术来增加匹配概率，并采用分层搜索的方法来加速图像匹配的速度。最终，将该技术首次应用到了大气能见度观测当中。经过实验检验，表明该算法具有较好的定位精度和观测效果，能够有效的自动定位观测目标物，实现准确观测。</p></sec><sec id="s4"><title>2. 灰度互相关算法原理</title><p>去均值归一化灰度互相关算法的准则定义如下：设参考图为 G r ，其大小为 M r &#215; N r ，实时图为 G s ，其大小为 M s &#215; N s ，且 M s &lt; M r ， N s &lt; N r 。则参考图中以 ( u , v ) 为左上角、大小为 M s &#215; N s 的子图 G r ( u , v ) 与实时图 G s 间的去均值归一化互相关度量 ρ ( u , v ) 为 [<xref ref-type="bibr" rid="hanspub.33926-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.33926-ref5">5</xref>] ：</p><disp-formula id="hanspub.33926-formula4"><label>(1)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/1-2140214x21_hanspub.png"  xlink:type="simple"/></disp-formula><p>这里 G r ( u , v ) &#175; 与 G s &#175; 分别为 G r ( u , v ) 与 G s 的灰度均值。 ρ ( u , v ) 的取值范围是 [ − 1 , 1 ] 。计算归一化互相关矩阵并显示其表面图，互相关矩阵峰值发生的地方就是与模板最相关的地方。两幅图像之间的总偏移和平移取决于互相关峰值所处的位置、模板的大小和位置。</p></sec><sec id="s5"><title>3. 多分辨率边缘增强的快速归一化积相关匹配算法</title><p>基于前面给出的归一化积相关度量方法，为了增加匹配概率，利用sobel算子对图像进行了边缘增强处理，为了进一步减少匹配算法匹配时间，提高匹配效率，且同时保证一定的匹配精度与匹配概率，设计了先粗后精的分层匹配控制策略。</p><sec id="s5_1"><title>3.1. 先粗后精的分层匹配控制策略</title><p>在图1给出了金字塔分层匹配策略框图。该匹配过程第一步先进行初始粗匹配，确定需要定位的匹配候选点的大概位置，后续在此基础上再进行精匹配，精准定位最终的匹配位置或者最佳位置。由于第二阶段的精匹配是基于粗匹配的预选子图完成的。所以，这极大降低了其搜索范围，匹配速度大大提高。</p><p>在本文当中，整体的匹配控制策略流程如下所示：</p><p>1) 粗匹配阶段：该匹配阶段必须包含正确的匹配点，否则将会使后续工作毫无意义。但是如果保留过多匹配候选点，则势必会增加计算量，影响匹配速度。这里的解决方法是在第一阶段粗匹配时，设定阈值，保留一定数量的匹配候选点，而阈值的大小则靠大量实验获取。</p><p>图1. 金字塔分层匹配策略框图</p><p>本文直接选取粗匹配阶段的匹配候选点为3~5个，大量实验表明，通常选择5个候选点，足以保证正确的匹配点包含在其中。另外，对于图像匹配系统，在制备阶段，研究人员就透过某些特定图像特征的参数对基准图匹配概率进行预测，并且评估其可匹配性，从而确定当前的图像能否作为基准图进行使用 [<xref ref-type="bibr" rid="hanspub.33926-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.33926-ref7">7</xref>]。而实际上，常用基准图选定准则 [<xref ref-type="bibr" rid="hanspub.33926-ref7">7</xref>] 在一定程度上即可有效保证在基准图中的相似块数不会超过3个。</p><p>2) 图像的预处理是指对匹配图像的灰度数据进行一定的去噪、平滑、图像校正及特征提取等。</p></sec><sec id="s5_2"><title>3.2. 匹配算法设计</title><p>结合归一化度量方法及3.1节所示的先粗后精的分层匹配控制方案，设计了基于边缘增强的快速归一化积相关图像匹配算法。</p><p>具体算法如下：</p><p>1) 利用金字塔分解将基准图和实时图进行二层分解。由于图像相邻元素之间具有很强的相关性，因此低分辨率子图像仍能保持高分辨率图像的大部分特征。因而本文将基准图和实时图分解为各自原始图像大小的1/2 (或者1/4，1/8等，甚至是多层分解，方法类似，本文采用两层分解)。</p><p>2) 对实时图和基准图进行边缘增强。因为图像边缘信息抗畸变能力强，稳定性高，所以利用sobel算子对分解后的图像进行边缘增强(需对图像做归一化处理)，以突出图像的边缘特征，增加匹配概率。</p><p>3) 粗匹配阶段</p><p>匹配准则如下：</p><p>① 从基准图左上角开始扫描获取各个基准子图，并在实时图及所选的基准子图中取其灰度值，组成用于相关匹配的灰度矢量(基于图像相邻元素之间具有很强的相关性，可以考虑隔点抽取的方法加快匹配速度)。</p><p>② 利用公式(1)，进行实时图和基准子图互相关度量的计算。</p><p>③ 利用递归比较获得3~5个最佳匹配候选点。</p><p>4) 精匹配阶段</p><p>根据所得到的匹配候选点，在其周围适当扩展进行搜索匹配(本文基于实际需要，拓展5个像素)。</p><p>① 定一个门限值Q，利用归一化积相关度量方法逐一取候选子图，进行灰度匹配。当 ρ ( u , v ) &gt; Q 时，停止搜索，输出此匹配位置为最终的匹配结果，不再选取其他候选子图进行匹配。</p><p>② 在全部计算所得的互相关度量值中， ρ ( u , v ) 值最大时的匹配位置即为所求的最佳匹配结果。</p></sec></sec><sec id="s6"><title>4. 算法在能见度观测中的应用</title><p>在大气能见度观测中，对目标物，如光源和黑体的定位是否准确，直接决定了观测效果的好坏 [<xref ref-type="bibr" rid="hanspub.33926-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.33926-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.33926-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.33926-ref11">11</xref>]。</p><p>为了检验本文算法，将其内置于大气能见度观测系统中，以实时观测曲线与大气透射仪和散射仪的对比观测结果进行评估。</p><p>图2. 大气能见度观测系统的视频窗口(未定标)</p><p>图2~5中，DPVS_77是能见度观测系统的结果，PWD22为进口前向散射仪观测的观测结果，DNQ2-1是国产(无锡)前向散射仪观测的数据结果，而LT31则是透射仪观测的观测结果。</p><p>以LT31观测数据为基准进行误差分析。考虑到篇幅，仅随机选取连续7天的数据进行对比，误差情况如表1所示。</p><p>图3. 大气能见度观测系统的视频窗口(已定标，蓝色框为天空定位)</p><p>图4. 大气能见度观测系统实时观测曲线(去除本文算法)</p><p>图5. 大气能见度观测系统实时观测曲线(使用本文算法)</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Error comparison of observation dat</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >天数</th><th align="center" valign="middle" >原始(%)</th><th align="center" valign="middle" >本文算法(%)</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >90.2</td><td align="center" valign="middle" >4.2</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >120.1</td><td align="center" valign="middle" >7.4</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >78.4</td><td align="center" valign="middle" >−6.7</td></tr><tr><td align="center" valign="middle" >4</td><td align="center" valign="middle" >141.3</td><td align="center" valign="middle" >9.1</td></tr><tr><td align="center" valign="middle" >5</td><td align="center" valign="middle" >98.9</td><td align="center" valign="middle" >5.8</td></tr><tr><td align="center" valign="middle" >6</td><td align="center" valign="middle" >110.6</td><td align="center" valign="middle" >7.2</td></tr><tr><td align="center" valign="middle" >7</td><td align="center" valign="middle" >−68.2</td><td align="center" valign="middle" >2.8</td></tr></tbody></table></table-wrap><p>表1. 观测数据误差对比</p></sec><sec id="s7"><title>5. 结论</title><p>本文提出了一种基于最佳匹配尺度的多分辨率边缘增强匹配算法。透过在大气能见度观测中的应用试验结果表明，这是一种有效的图像匹配方法，能够保证目标物的准确自动定位，大大减少观测误差，提高观测准确率。当没有使用本文算法进行定位的时候，由于目标物定位错误所引发的误差平均为：81.6%，而使用本文算法进行定位后，观测误差提升至4.3%，观测效果得到极大提升。而从上面的观测曲线图也可以看出，使用本文算法后的数据曲线几乎与LT31观测到的数据曲线完全重合。实验充分验证了本文算法的有效性。</p></sec><sec id="s8"><title>基金项目</title><p>国家自然科学基金项目(41575156)。</p></sec><sec id="s9"><title>文章引用</title><p>雷 鸣,刘旭林,聂 凯,王 琪,陈凯华. 自动匹配技术在大气能见度观测中的应用Application of Automatic Matching Technology in Atmospheric Visibility Observation[J]. 光电子, 2020, 10(01): 1-7. https://doi.org/10.12677/OE.2020.101001</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.33926-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">曾峦, 翟优, 谭久彬. 基于SIFT的自动匹配策略[J]. 光电工程, 2011, 38(2): 65-66.</mixed-citation></ref><ref id="hanspub.33926-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">戴涛, 朱长仁, 胡树平. 图像匹配技术综述[J]. 数字技术与应用, 2012(3): 174-175.</mixed-citation></ref><ref id="hanspub.33926-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Cahnvon Seelen, U.M. and Bajcsy, R. (1996) Adaptive Correlation Tracking of Targets with Changing Scale. GRA SP Laboratory Technical Report.</mixed-citation></ref><ref id="hanspub.33926-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">荆仁杰. 计算机图像处理[M]. 杭州: 浙江大学出版社, 1990.</mixed-citation></ref><ref id="hanspub.33926-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Giachetti, A. (2000) Matching Techniques to Compute Image Motion. Image and Vision Computing, 18, 247-260.  
&lt;br&gt;https://doi.org/10.1016/S0262-8856(99)00018-9</mixed-citation></ref><ref id="hanspub.33926-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">陈朝阳, 张桂林, 郑云慧. 景象匹配算法的性能评估方法研究[J]. 红外与激光工程, 1998, 27(3): 38-41.</mixed-citation></ref><ref id="hanspub.33926-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">刘扬, 赵峰伟, 金善良. 景象匹配区选择方法研究[J]. 红外与激光工程, 2001, 30(3): 168-170.</mixed-citation></ref><ref id="hanspub.33926-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Lu, W.T. and Tao, S.C. (2001) An Approach to the Optical Characteristics Calibration of the CCD Camera System. Optical Technology, 27, 109-113. (In Chinese with English Abstract)</mixed-citation></ref><ref id="hanspub.33926-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Lu, W.T., Tao, S.C., Tan, Y.B. and Liu, Y.F. (2003) Application of Practical Blackbody Technique to Digital Photography Visiometer System. Quarterly Journal of Applied Meteorology, 14, 691-698. (In Chinese with English Abstract)</mixed-citation></ref><ref id="hanspub.33926-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Lu, W.T., Tao, S.H., Liu, Y.F., Tan, Y.B. and Wang, B.G. (2004) Measuring Meteorological Visibility Based on Digital Photography-Dual Differential Luminance Method and Experimental Study. Chinese Journal of Atmospheric Sciences, 28, 559-570. (In Chinese with English Abstract)</mixed-citation></ref><ref id="hanspub.33926-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">姜江, 张国平, 高金兵. 北京大气能见度的主要影响因子[J]. 应用气象学报, 2018, 29(2): 188-199.</mixed-citation></ref></ref-list></back></article>