<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SEA</journal-id><journal-title-group><journal-title>Software Engineering and Applications</journal-title></journal-title-group><issn pub-type="epub">2325-2286</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SEA.2015.46019</article-id><article-id pub-id-type="publisher-id">SEA-16643</article-id><article-categories><subj-group subj-group-type="heading"><subject>SEA20150600000_20674537.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  面向网络互联安全控制系统的安全认证协议研究
  Research on Security Authentication Protocol for Network Connection Control System
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>力嘉</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>钟</surname><given-names>求喜</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>燕</surname><given-names>翔宇</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>国防科学技术大学计算机学院，湖南 长沙</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>124589553@qq.com(杨力)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>15</day><month>12</month><year>2015</year></pub-date><volume>04</volume><issue>06</issue><fpage>148</fpage><lpage>153</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   在分析网络安全传输技术基础上，针对网络互联安全控制系统应用场景设计了一个网络安全传输系统框架，提出了一套相应的安全认证协议，并对安全认证协议进行了网络攻击的安全性分析。 Based on the analysis of network security transmission technology, this paper designed a network security transmission system framework which was used in application circumstance, and proposed a set of corresponding security authentication protocol, then analyzed the security of the authentication protocol which might be attacked in the net.
    
  
 
</p></abstract><kwd-group><kwd>网络安全，认证，网络互联安全控制系统, Network Security</kwd><kwd> Authentication</kwd><kwd> Network Connection Control System</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>面向网络互联安全控制系统的安全认证 协议研究<sup> </sup></title><p>杨力嘉，钟求喜，燕翔宇</p><p>国防科学技术大学计算机学院，湖南 长沙</p><disp-formula id="hanspub.16643-formula7"><graphic xlink:href="http://html.hanspub.org/file/5-2690177x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2015年12月9日；录用日期：2015年12月23日；发布日期：2015年12月29日</p><disp-formula id="hanspub.16643-formula8"><graphic xlink:href="http://html.hanspub.org/file/5-2690177x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>在分析网络安全传输技术基础上，针对网络互联安全控制系统应用场景设计了一个网络安全传输系统框架，提出了一套相应的安全认证协议，并对安全认证协议进行了网络攻击的安全性分析。</p><p>关键词 :网络安全，认证，网络互联安全控制系统</p><disp-formula id="hanspub.16643-formula9"><graphic xlink:href="http://html.hanspub.org/file/5-2690177x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>随着互联网技术的迅猛发展，网络规模的不断扩大，网络给人们带来不少便利，网络信息安全问题也日益突显。如何抵御来自网络的各种攻击，让信息在互联网中安全传输成为网络应用的关注点，网络信息安全技术也一直成为研究热点。自2013年美国“棱镜”计划曝光以来，网络安全问题更上升到国家战略安全层面。</p><p>目前各大企业部门为保证网络信息安全，大多采用防火墙隔离方法。通过这种方法，虽然可以建立一个较为安全的内部局域子网络，网内信息交互安全也可以得到较好的保证，但是对于跨越子网络的信息传输安全此方法则显得无能为力。信息安全传输技术就是为解决这类问题而出现的网络安全技术，其主要负责保护信息在网络传输过程中的安全，防止信息被非法用户获取或窜改。利用该技术所实现的信息安全传输系统(以下简称安全传输系统)目前已被广泛应用到各个领域。</p><p>网络互联安全控制系统(以下简称安全控制系统)作为安全传输系统的核心硬件设备，是一台处于外网与子网(安全网络)之间，起着网关兼防火墙作用的安全控制设备。它依据逻辑隔离条件下的数据共享传输需求，面向局域网络的受控接入和互联控制，监控进出子网的报文并进行报文进出控制，达到信息安全控制与传输安全的目的。</p><p>安全传输系统为保证信息的安全传输，在进行报文传输之前，必须对整个系统的硬件设备进行安全认证，以确保信息发送者和接收者的身份真实性。安全认证的核心为安全认证协议，安全认证协议以密码学为支撑，是一套在特定的网络拓扑结构下，依赖相关的网络安全设备，检验网络设备之间的身份真实性的网络协议规范。它的最终目标是保证设备之间交换信息的真实性和不可否认性。为了达到以上目标，安全认证协议会涉及到设备之间的信息交换，可信第三方或者会话服务器的参与，根据认证的流程和方式不同，安全认证协议可分为具有可信第三方的对称密钥协议、无可信第三方的对称密钥协议、具有第三方的公开密钥协议、无可信第三方的公开密钥协议、应用密码校验函数的认证协议和对称密钥重复认证协议六类。目前比较主流的认证协议有RADIUS、TACACS、Kerberos等认证协议。</p><p>本文以跨网络信息安全传输为应用背景，设计一套信息安全传输系统，提出一套安全认证协议并进行协议的安全评估，以保障信息安全传输。</p></sec><sec id="s4"><title>2. 基于网络互联安全控制系统的信息安全传输系统框架设计</title><p>信息安全传输系统是为解决网络信息传输安全问题而设计的一套完整的安全系统，其结构如图1所示。</p><p>硬件层为整个系统提供硬件支撑，主要包括网络架构和硬件设备两部分。网络架构即整个系统的网络拓扑结构，是由实际应用需求所决定；硬件设备主要由信息终端、路由设备和网络互联安全控制系统组成，其中网络互联安全控制系统为硬件层的核心部件。</p><p>图1. 安全传输系统体系结构</p><p>软件层负责整个系统的运行与管理，并为用户提供友好的交互界面。其内部又可分为系统软件、管理控制软件和安全协议，系统软件直接与硬件交互，为管理控制软件提供运行平台；管理控制软件负责与用户进行交互，并根据用户的指令对整个系统进行管理和控制；安全协议为系统各个设备之间信息交互提供通信规范，它的最终目的是实现网络信息传输的保密性、完整性和真实性，安全协议由安全认证协议和安全通信协议组成，安全认证协议负责验证信息交互的设备真实性并完成对通信密钥的交换，安全通信协议负责信息传输过程中的安全性。</p><p>本文针对跨网络信息传输的实际安全需求，基于网络互联安全控制系统为核心，结合互联网相关技术，设计一个安全传输系统框架，其总体结构如图2所示。</p><p>安全控制系统B安装在内部安全网1与外部网络之间，负责内部网1的边界安全；安全控制系统C安装在内部安全网2与外部网络之间，负责内部网2的边界安全。如果终端A与终端D需要通信，由于两个终端不在一个内部网络中，所以必须通过外部网络传输实现，A首先与安全控制系统B建立会话并将信息发送至B，然后B与C利用安全隧道技术<sup>②</sup>建立安全会话通道，通过安全会话通道将信息发送至C，最后信息通过C发送至目标终端D，整个传输流程完成。B与C通信期间虽然跨越了外部网络，但是由于使用了安全会话通道，因此传输信息的安全性得到保证，通过整个传输过程，信息可以安全的在A与D之间交互，就好像两个终端处于同个安全子网中传输一样。</p><p>安全传输系统在正常运行前，必须对系统中所有设备的身份真实性进行认证。对通过身份认证的设备，系统对其提供正常服务，如果发现身份无法通过的设备，该系统会拒绝该设备接入，并发出报警，因此安全认证对安全传输系统至关重要。</p></sec><sec id="s5"><title>3. 安全认证协议设计与安全性分析</title><p>针对安全传输系统框架的应用需求，本文设计一套安全认证协议，用以检测系统设备身份的真实性。认证协议利用高效率传输的UDP协议进行通信，并采用签名应答机制防止报文错误和丢包现象出现，如果认证过程中的任何流程环节出现报文错误或丢包现象，认证设备之间将会重启一个新的认证流程并对失败认证进行计数，失败次数超出阈值即判定认证失败。因为内部网络和外部网络安全风险及应用需求的不同，两种网络分别采用两种认证方式：内部网络中，终端和安全控制系统之间的认证采用以用户为认证主体的基于用户口令的双向认证方式；外部网络中，安全控制系统与安全控制系统之间采用以设备为认证主体的基于数字证书的双向认证方式。</p><sec id="s5_1"><title>3.1. 基于用户口令的双向认证协议</title><p>基于用户口令的双向认证，采用无可信第三方的对称密钥认证方法。协议要求参与主体双方都事先共享只有他们两人知道的秘密信息，并且知道秘密信息与协议主体的对应关系。</p><p>图2. 网络互联安全传输系统框架结构</p><sec id="s5_1_1"><title>3.1.1. 协议流程</title><p>(1) ClientHelloA→B: A, B, (N<sub>A</sub>♁K<sub>AB</sub>), H(A, N<sub>A</sub>, K<sub>AB</sub>)</p><p>(2) ServerHelloB→A: B, A, (N<sub>B</sub>♁K<sub>AB</sub>), H(B, N<sub>B</sub>, K<sub>AB</sub>, N<sub>A</sub>)</p><p>(3) ClientFinishA→B: A, B, H(N<sub>A</sub>, N<sub>B</sub>, K<sub>AB</sub>)</p></sec><sec id="s5_1_2"><title>3.1.2. 符号说明</title><p>A, B: 协议主体ID，代表认证双方的身份标识。</p><p>N<sub>A</sub>, N<sub>B</sub>: A, B产生的随机数。</p><p>H(…): 基于密钥的哈希函数，对括号内的数据求哈希值。</p><p>K<sub>AB</sub>: A、B预先共享的秘密信息，为用户A的口令哈希值，即K<sub>AB</sub> = H(A_password)。</p><p>(a♁b): 操作数a和操作数b的异或值，所得结果与操作数a字节位数相同。</p></sec><sec id="s5_1_3"><title>3.1.3. 协议分析</title><p>(1) 通过ClientHello，B可利用共享的K<sub>AB</sub>获得N<sub>A</sub>，计算H(A, N<sub>A</sub>, K<sub>AB</sub>)，并与其收到的哈希值比较，如果匹配，那么B确信NA是有效的。</p><p>(2) 通过ServerHello，A可利用共享的K<sub>AB</sub>获得N<sub>B</sub>，计算H(B, N<sub>B</sub>, K<sub>AB</sub>, N<sub>A</sub>)，并与其收到的哈希值比较，如果匹配，那么A确信B生成和发送了这个包含可信任信息新鲜标识符N<sub>A</sub>的哈希值，因为只有B和A拥有共享秘密K<sub>AB</sub>。因此B的主体活现性得到了认证，消息的新鲜性得到了保证。</p><p>(3) 通过ClientFinish，B确认了A的主体活现性，消息的新鲜性得到了保证。</p><p>综上所述，协议运行结束后，确认了A, B主体活现性、消息的新鲜性，达到了双向认证的安全目标。</p></sec></sec><sec id="s5_2"><title>3.2. 基于数字证书的双向认证协议</title><sec id="s5_2_1"><title>3.2.1. 协议流程</title><p>(1) ClientHello A→B: Cert<sub>A</sub>, A, N<sub>A</sub>, [A, N<sub>A</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x11_hanspub.png" xlink:type="simple"/></inline-formula></p><p>(2) ServerHello B→A: Cert<sub>B</sub>, {B, N<sub>B</sub>, N<sub>A</sub>, [B, N<sub>B</sub>, N<sub>A</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x12_hanspub.png" xlink:type="simple"/></inline-formula> }K<sub>A</sub></p><p>(3) ClientFinish A→B: {A, N<sub>A1</sub>, N<sub>B</sub>, [A, N<sub>A1</sub>, N<sub>B</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x13_hanspub.png" xlink:type="simple"/></inline-formula> }K<sub>B</sub></p><p>(4) ServerFinish B→A: {N<sub>A1</sub>, [N<sub>A1</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x14_hanspub.png" xlink:type="simple"/></inline-formula> }K<sub>A</sub></p></sec><sec id="s5_2_2"><title>3.2.2. 符号说明(未提及符号参照基于口令的认证协议)</title><p>Cert<sub>A</sub>, Cert<sub>B</sub>: A，B的数字证书。</p><p>K<sub>A</sub>,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x15_hanspub.png" xlink:type="simple"/></inline-formula>: A的公钥和私钥。</p><p>K<sub>B</sub>,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x16_hanspub.png" xlink:type="simple"/></inline-formula>: B的公钥和私钥。</p><p>N<sub>A1</sub>: A产生的不同于N<sub>A</sub>的随机数。</p><p>{…}K: 使用密钥K对{}中的消息进行加密。</p><p>[…]K: 使用密钥K对[<xref ref-type="bibr" rid="hanspub.16643-ref"></xref>]中的消息进行签名。</p></sec><sec id="s5_2_3"><title>3.2.3. 协议分析</title><p>(1) 通过ClientHello，B只能确定消息是用证书Cert<sub>A</sub>的私钥签名的，但不能进一步确定其他信息。</p><p>(2) 通过ServerHello，A确信收到的消息是新鲜的，确认了B的活现性，B的身份验证通过。</p><p>(3) 通过ClientFinish，B确认收到的消息是新鲜的，确认是与真实的A进行通信，保障了A的活现性。</p><p>(4) 通过ServerFinish，A再次确认收到的消息是新鲜的，是与真实的B进行通信，B是活现的。</p><p>综上所述，在协议双方确认A的证书为Cert<sub>A</sub>，B的证书为Cert<sub>B</sub>的前提下，协议运行结束后，确认了A、B主体活现性、消息的新鲜性，同时协议生成的N<sub>A1</sub>，N<sub>B</sub>具有保密性、新鲜性<sup>③</sup>、主体关联性，具有双向认证安全、双向密钥协商安全、双向密钥传输安全。另外，通过共享的N<sub>A1</sub>，N<sub>B</sub>作为密码材料，可生成用于安全控制设备之间建立安全通道的密钥，用于保护安全通道的参数协商。</p></sec></sec><sec id="s5_3"><title>3.3. 协议安全性分析</title><p>当今互联网络环境变幻莫测，网络攻击处处存在，安全认证协议设计的最终目的也是为了应对来自网络的各种威胁，目前针对认证协议的攻击主要有重放攻击和中间人攻击两种。</p><sec id="s5_3_1"><title>3.3.1. 重放攻击</title><p>重放攻击[<xref ref-type="bibr" rid="hanspub.16643-ref1">1</xref>] 又称重播攻击、回访攻击或新鲜性攻击，是指攻击者发送一个目标主机已接收过的数据报文，来达到欺骗系统的目的。攻击者还可利用重放方式大规模地发送数据报文，侵占目标主机的正常带宽和系统资源，导致正常的服务响应延迟或者中断，最终达到拒绝服务的目的。</p><p>针对重放攻击行为，本文中的两种认证协议均采用随机数验证的方式进行防御，即两种协议中的N<sub>A</sub>, N<sub>B</sub>, N<sub>A1</sub>三个随机数既有作为密码材料的功能，又起着抵御重放攻击的作用。目标主机可以针对收到的随机数建立一个随机数缓存表，在一定时间内，收到相同随机数的同类报文，目标主机可直接予以丢弃，不予理睬，已达到防御重放攻击的目的。</p></sec><sec id="s5_3_2"><title>3.3.2. 中间人攻击</title><p>中间人攻击[<xref ref-type="bibr" rid="hanspub.16643-ref2">2</xref>] 是一种“间接”的入侵攻击，这种攻击模型是通过各种技术手段将攻击计算机虚拟地放置在两台通信计算机之间，通过伪造数据报文的方式与两台通信计算机通信，使得两台通信计算机误认为通信正常，而攻击者从中获取有用信息。</p><p>抵御中间人攻击的最有效方式是让攻击者无法伪造通信双方的数据报文，在基于口令的认证协议中，由于中间人不知道用户口令，即无法获取K<sub>AB</sub>值，因此，(N<sub>A</sub>♁K<sub>AB</sub>)，H(A, N<sub>A</sub>, K<sub>AB</sub>), (N<sub>B</sub>♁K<sub>AB</sub>), H(B, N<sub>B</sub>, K<sub>AB</sub>, N<sub>A</sub>), H(N<sub>A</sub>, N<sub>B</sub>, K<sub>AB</sub>)字段也无法伪造，从而达到防御的目的；在基于数字证书的认证协议中，由于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x17_hanspub.png" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x18_hanspub.png" xlink:type="simple"/></inline-formula>只有A和B两个设备知道，那么攻击者也无法伪造[A, N<sub>A</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x19_hanspub.png" xlink:type="simple"/></inline-formula>, [B, N<sub>B</sub>, N<sub>A</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x20_hanspub.png" xlink:type="simple"/></inline-formula>, [A, N<sub>A1</sub>, N<sub>B</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x21_hanspub.png" xlink:type="simple"/></inline-formula>，[N<sub>A1</sub>]<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2690177x22_hanspub.png" xlink:type="simple"/></inline-formula>字段，至使中间人攻击失败，最终保证信息的真实性。</p></sec></sec></sec><sec id="s6"><title>4. 结语</title><p>近些年互联网的高速发展，网民人数越来越多，特别是移动终端的普及，对网络的安全性提出了更高更特殊的要求，在这种背景下，改进和设计新的认证协议以适应新的网络环境成为网络技术中研究的重要问题，目前许多安全认证协议都具有各自的特点，能够在特殊的环境中起着良好的保护效果，但是一些比较通用的认证协议在某些特殊领域安全防护性相对较差。由此可见，未来安全认证协议的发展必然会根据不同领域的实际需求量身定做，设计出适用于该领域的真正有效的安全认证协议。</p></sec><sec id="s7"><title>基金项目</title><p>国家自然科学基金(编号：61202482)。</p></sec><sec id="s8"><title>文章引用</title><p>杨力嘉,钟求喜,燕翔宇. 面向网络互联安全控制系统的安全认证协议研究 Research on Security Authentication Protocol for Network Connection Control System[J]. 软件工程与应用, 2015, 04(06): 148-153. http://dx.doi.org/10.12677/SEA.2015.46019</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16643-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">陈建熊, 孙乐昌. 认证测试对分析重放攻击的缺陷[J]. 计算机应用研究, 2009, 26(2): 739-741.</mixed-citation></ref><ref id="hanspub.16643-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">唐祚波, 缪祥华. 一种三方认证密钥协商协议的分析与改进[J]. 计算机工程, 2013, 39(1): 140-143.</mixed-citation></ref></ref-list></back></article>