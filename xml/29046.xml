<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JWRR</journal-id><journal-title-group><journal-title>Journal of Water Resources Research</journal-title></journal-title-group><issn pub-type="epub">2166-6024</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JWRR.2019.81003</article-id><article-id pub-id-type="publisher-id">JWRR-29046</article-id><article-categories><subj-group subj-group-type="heading"><subject>JWRR20190100000_90229105.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject><subject> 合作期刊</subject></subj-group></article-categories><title-group><article-title>
 
 
  长短期记忆模型在小流域洪水预报上的应用研究
  Application of the Long Short-Term Memory Networks for Flood Forecast
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>炅</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>艳军</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>俊勃</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>袁</surname><given-names>正颖</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>金津</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>董</surname><given-names>文逊</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>素描</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>长江水利委员会水文局，湖北 武汉</addr-line></aff><aff id="aff1"><addr-line>武汉大学水资源与水电工程科学国家重点实验室，湖北 武汉</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>02</day><month>02</month><year>2019</year></pub-date><volume>08</volume><issue>01</issue><fpage>24</fpage><lpage>32</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   在山区小流域，降水资料稀缺，且难以反应其降水的空间异质性，使得仅依靠降水资料进行洪水预报十分困难。为了提高山区小流域洪水预报精度，本文以官山河流域为例，选择可同时输入降水和径流资料进行水文模拟和预报的长短期记忆模型(LSTM)，对洪水过程进行模拟。同时构建了新安江模型模拟，进行对比研究。研究结果表明，若使用1975~1987年逐日数据对模型进行率定和检验，传统水文模型检验期的纳什效率系数为0.55，而对应的LSTM检验期的纳什效率系数为0.73，长短期记忆模型(LSTM)能够较大地提高降水资料缺少地区的水文模拟和预报效果。 Flood forecasting is difficult in mountain watershed because precipitation data is scarce and hard to reflect spatial heterogeneity. To improve the accuracy of flood forecasting in mountain watershed, long short-term memory model (LSTM) and Xin’anjiang model are used to simulate flood in Guanshan river watershed. The results show that the Nash efficiency coefficient of verification period in the tra-ditional hydrological model is 0.55, while that in the LSTM is 0.7 with daily data from 1975 to 1987. LSTM can greatly improve the hydrological simulation and forecast effect in the areas lacking precipi-tation data. 
  
 
</p></abstract><kwd-group><kwd>长短期记忆，洪水预报, Long Short-Term Memory (LSTM)</kwd><kwd> Flood Forecast</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>长短期记忆模型在小流域洪水预报上的应用研究<sup> </sup></title><p>郭炅<sup>1</sup>，张艳军<sup>1*</sup>，王俊勃<sup>1</sup>，袁正颖<sup>2</sup>，吴金津<sup>1</sup>，董文逊<sup>1</sup>，王素描<sup>1</sup></p><p><sup>1</sup>武汉大学水资源与水电工程科学国家重点实验室，湖北 武汉</p><p><sup>2</sup>长江水利委员会水文局，湖北 武汉</p><disp-formula id="hanspub.29046-formula60"><graphic xlink:href="//html.hanspub.org/file/3-2410724x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2019年2月2日；录用日期：2019年2月17日；发布日期：2019年2月25日</p><disp-formula id="hanspub.29046-formula61"><graphic xlink:href="//html.hanspub.org/file/3-2410724x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>在山区小流域，降水资料稀缺，且难以反应其降水的空间异质性，使得仅依靠降水资料进行洪水预报十分困难。为了提高山区小流域洪水预报精度，本文以官山河流域为例，选择可同时输入降水和径流资料进行水文模拟和预报的长短期记忆模型(LSTM)，对洪水过程进行模拟。同时构建了新安江模型模拟，进行对比研究。研究结果表明，若使用1975~1987年逐日数据对模型进行率定和检验，传统水文模型检验期的纳什效率系数为0.55，而对应的LSTM检验期的纳什效率系数为0.73，长短期记忆模型(LSTM)能够较大地提高降水资料缺少地区的水文模拟和预报效果。</p><p>关键词 :长短期记忆，洪水预报</p><disp-formula id="hanspub.29046-formula62"><graphic xlink:href="//html.hanspub.org/file/3-2410724x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by authors and Wuhan University.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/3-2410724x8_hanspub.png" /> <img src="//html.hanspub.org/file/3-2410724x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>山洪是最常见的自然灾害之一，具有短历时，高强度的特点，威胁着社会与国民经济的发展 [<xref ref-type="bibr" rid="hanspub.29046-ref1">1</xref>] 。洪水预报是为了预先获得洪水发生发展过程，根据洪水形成机理与运动规律，利用气象、水文等信息，预报预测洪水发生与变化过程的技术方法，并作为一项重要的防洪非工程措施，是减少洪水损失的最重要手段和方法之一。因此，建立有效的洪水预报模型，具有强烈的紧迫性和必要性。目前洪水预报方法可分为三类：经验预报、概念模型和系统或黑箱模型 [<xref ref-type="bibr" rid="hanspub.29046-ref2">2</xref>] 。但是，对于我国广大山区，由于水文资料缺失，且降雨的空间异质性强，传统的概念模型在山洪模拟上精度较差 [<xref ref-type="bibr" rid="hanspub.29046-ref3">3</xref>] 。近年来，人工神经网络等黑箱被广泛应用于水文预报的相关研究，并取得一定成果 [<xref ref-type="bibr" rid="hanspub.29046-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.29046-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.29046-ref6">6</xref>] 。然而，传统的人工神经网络对样本的噪声、网络模式等因素比较敏感，而且存在过拟合以及结点记忆快速衰弱现象，其应用也是受到很大限制 [<xref ref-type="bibr" rid="hanspub.29046-ref7">7</xref>] 。长短期记忆网络是一种改进的神经网络模型 [<xref ref-type="bibr" rid="hanspub.29046-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.29046-ref9">9</xref>] ，它通过修改神经网络结构中的隐藏层神经元，解决了上述问题。本文提出了一种基于长短期记忆网络的洪水预报模型，同时使用官山河流域的降水、径流资料，对其流域进行洪水预报，提高洪水预报精度。</p></sec><sec id="s4"><title>2. 模型介绍</title><sec id="s4_1"><title>2.1. LSTM模型</title><p>神经网络是一种由处理单元相互关联，有自适应能力的，非线性系统。它可以通过神经元的有向连接，建立输入参数到输出参数的映射，这种学习能力可以省略系统建模的步骤，特别适用于规律未知的情况。而比较传统的BP神经网络也已经广泛应用于水文预报，但是容易出现梯度消失，结点记忆快速衰弱的缺点，而LSTM长短期记忆网络模型可以改善这种情况。</p><p>长短期记忆(long-short term memory, LSTM)神经网络是一种改进的时间递归神经网络 [<xref ref-type="bibr" rid="hanspub.29046-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.29046-ref11">11</xref>] 。LSTM网络模型引入了多个自相关的核心信元cell和3个新增单元 [<xref ref-type="bibr" rid="hanspub.29046-ref12">12</xref>] ，分别是：输入门(inputgate)、输出门(output gate)和遗忘门(forget gate)。核心信元即细胞状态，3个门结构则控制信息在细胞状态上的更新。这样便实现了信息在网络上的更新。LSTM神经元结构如图1所示。</p><p>由结构图可知，为了与时间建立联系，LSTM在递归循环过程中增加了一个记忆单元——细胞状态，然后通过输入门i<sub>t</sub>、输出门o<sub>t</sub>和遗忘门f<sub>t</sub>这三个结构来进行数据写入、读取和过去状态的重置工作。Sigmoid激活函数使遗忘门的输出值为[0, 1]，当输出为0时，表示上一状态的信息全部被遗忘门舍弃；当输出为1时，表示上一状态的信息全部被保留。该结构的前向计算过程如下：</p><p>图1. LSTM结构示意图</p><p>i t = σ ( W i ⋅ [ h t − 1 , x t ] + b i ) (1)</p><p>o t = σ ( W o ⋅ [ h t − 1 , x t ] + b o ) (2)</p><p>f t = σ ( W f ⋅ [ h t − 1 , x t ] + b f ) (3)</p><p>C ˜ t = tanh ( W C h t − 1 + W C x t + b C ) (4)</p><p>C t = f t C t − 1 + i t C t (5)</p><p>h t = o t tanh ( C t ) (6)</p><p>式中： σ 为Sigmoid激活函数， W f 、 W i 、 W C 、 分别为对应的权重系数矩阵， h t − 1 、 h t 为上一时刻和这一时刻的隐藏层输出量， C t − 1 、 C t 、 C ˜ t 分别为上一时刻和当前时刻细胞状态以及输入的候选状态， x t 为当前层输出， b f 、 b i 、 b C 、 b o 分别为对应的偏置项。首先，利用上一时刻的隐藏层输出和当前层输出，通过(1)、(2)、(3)式计算输入门、输出门、遗忘门的系数。然后，通过(4)式得到当前神经元的候选状态 C ˜ t 。再通过遗忘门和输入门确定 C ˜ t 和 C t − 1 在当前细胞状态中的比例关系，使用(5)式对其进行更新。最后，使用(6)式计算当前时刻的隐藏层输出量。</p><p>在本文的LSTM网络训练中，采用时间反向传播算法，反向计算各神经元的输出值与真实值的误差，根据误差结果计算各权重。</p><p>同时，在LSTM模型的输入层中，输入层变量包括三个特征值：时间、降水量、径流量。输出层变量只有一个特征值：径流量。这样，模型的预报结果不仅与降雨有关，也与前期的径流量有关。</p></sec><sec id="s4_2"><title>2.2. 对比模型介绍</title><p>在本文中，选取水文上广泛应用的三水源新安江模型，使用该模型的洪水模拟结果与LSTM模型的模拟结果进行对比分析。</p><p>新安江是一种适用于我国湿润半湿润地区的概念性流域水文模型 [<xref ref-type="bibr" rid="hanspub.29046-ref13">13</xref>] [<xref ref-type="bibr" rid="hanspub.29046-ref14">14</xref>] 。三水源新安江模型蒸散发采用三层模型计算；产流计算选择蓄满产流模型；总径流采用自由水库结构被划分为地表径流、壤中流和地下径流；汇流计算采用线性水库；河道汇流采用马斯京根演算。</p><p>模型参数主要包括以下4类：1) 蒸散发计算参数；2) 产流模型计算参数；3) 水源划分参数；4) 汇流模型计算参数。</p><p>对于新安江模型而言，其模型的输入变量包括降水，蒸发。</p><p>从两个模型的输入变量来看，LSTM模型可以同时输入降水和径流资料，而新安江模型只是降水资料。文献 [<xref ref-type="bibr" rid="hanspub.29046-ref15">15</xref>] 表明，水文序列具有较强的自相关性，同时长记忆性分解结果表明，随着时间的延长，序列的长记忆性逐渐减弱。由此分析，当流域的降水资料与实际降水偏差较大时，同时使用降水、径流作为输入变量的LSTM的效果会更好。</p></sec></sec><sec id="s5"><title>3. 实例分析</title><sec id="s5_1"><title>3.1. 研究区概况</title><p>官山河位于汉江中上游，湖北省丹江口市西南部，丹江南岸 [<xref ref-type="bibr" rid="hanspub.29046-ref16">16</xref>] 。其经纬度范围东经110˚48'00''~111˚34'59''，北纬32˚13'16''~32˚58'20''。该流域面积465 km<sup>2</sup>，河长66.5千米，孤山水文站以上流域面积300多km<sup>2</sup> (孤山站集水面积322 km<sup>2</sup>)。流域平均高程690米，河道平均坡降5.7‰，多年平均流量7.78 m<sup>3</sup>/s。官山河流域地形以山地和丘陵为主，地形起伏变化较大，海拔范围240到1606 m。该流域属于局地性暴雨和连阴雨高发区，年降水量高达1100 mm。官山河流域内有水文站1个(孤山站)，自动雨量站4个，分布在吕家河村、官亭村、田贩村、铁炉村。</p></sec><sec id="s5_2"><title>3.2. 数据处理及模型参数分析</title><p>本文构建的LSTM洪水预报模型中，作为预报因子的输入层变量有两个，分别是径流量和降雨量。</p><p>对于官山河流域洪水模拟，径流量数据由孤山站直接测得，采用泰森多边形法对4个自动雨量站数据进行插值得到降水数据。本文选取该流域1975到1987年的相关数据资料。其中，共计9场洪水，预见期为24 h来对模型进行训练和验证。其中，前7场为训练集，后2场为检验集。</p><p>对于模型本身参数的设定，通过试错法，确定LSTM网络的中间层数为3层，优化方法采用RMSProp (root mean square prop)算法，节点数为30个，最大训练次数为1500次。</p><sec id="s5_2_1"><title>3.2.1. 数据归一化处理</title><p>由于输入的数据之间数量级有时候差别较大，使用LSTM网络预测结果会存很大的误差。数据的归一化处理会有效的减少这个误差，归一化数据的取值范围为[0,1]。本文中归一化采用的是离差标准化方法(Min-Max Normalization)，转换式为：</p><p>X * = X − X min X max − X min (7)</p><p>式中： X max 为数据序列的最大值， X min 为数据序列的最小值，X为原始的实测数据， X * 为归一化数据。经过这种归一化方法处理的数据，不但会消除因数据之间数量级差异造成的影响，而且会保留原始数据中存在的关系，使得之后的模型运算结果符合实际的范围和意义。</p></sec><sec id="s5_2_2"><title>3.2.2. 模型的参数设定</title><p>LSTM模型的主要参数包括：输入层step步数的选择以及LSTM层记忆神经元的个数。</p><p>对于LSTM网络模型，输入层加入了时序step的概念，这样处理单元便从常规的向量变成了张量，不同的步数选择对模型的精度有着不同的影响。在训练中，LSTM层记忆神经元的个数也会影响模型的精度。若节点个数设置较少，模型拟合效果会很差，同时会存在学习回归问题，最终模型结果精度较差。若节点个数设置过多，会增加训练过程的训练时间，还会带来过拟合问题，从而影响到模型性能。至于隐藏层节点个数的设置，本文采用经验公式确定，将此作为初值。最后，通过试错法确定隐藏层节点个数。根据前人的结果，隐藏层节点数N的经验公式为：</p><p>N = ( n + m ) + a (8)</p><p>式中：m和n为输入层和输出层的节点数，a为常数，取值范围[0,10]。</p><p>最终，通过试错法，确定LSTM网络的中间层数为3层，输入层步数为，优化方法采用RMSProp (root mean square prop)算法，误差控制率为0.001，节点数为30个，最大训练次数为1500次。</p><p>图2. 研究区域</p></sec><sec id="s5_2_3"><title>3.2.3. 模型的评价指标</title><p>基于水文预报的规范以及从官山河的实际情况出发(见图2)，本文洪峰流量相对误差和洪量相对误差对两个模型进行对比，同时采用纳什模型效率系数评价LSTM模型的精度：</p><p>1) 洪峰流量相对误差</p><p>Q e = Q p , s i m − Q p , o b s Q p , o b s &#215; 100 % (9)</p><p>式中：Q<sub>sim</sub>、Q<sub>obs</sub>分别为场次洪峰流量的模拟值与实测值，m<sup>3</sup>/s；Q<sub>e</sub>为场次洪峰流量相对误差，%，所有场次取其平均值即为流域洪峰流量平均相对误差。</p><p>2) 洪量相对误差</p><p>V e = V s i m − V o b s V o b s &#215; 100 % (10)</p><p>式中：V<sub>sim</sub>、V<sub>obs</sub>分别为场次洪水流量的模拟值与实测值，m<sup>3</sup>/s；V<sub>e</sub>为场次洪水流量相对误差，%，所有场次取其平均值即为流域洪水流量平均相对误差。</p><p>3) 纳什效率系数</p><p>N S = 1 − ∑ t = 1 n ( Q o t − Q p t ) 2 ∑ t = 1 n ( Q o t − Q o &#175; ) 2 (11)</p><p>式中：n是径流序列的长度，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/3-2410724x44_hanspub.png" xlink:type="simple"/></inline-formula>和 Q o t 分别表示t时刻径流的预报值和实测值，m<sup>3</sup>/s； Q o &#175; 是实测径流均值，m<sup>3</sup>/s。改系数越接近1，表示模型效果越好。</p></sec></sec><sec id="s5_3"><title>3.3. 结果与讨论</title><p>利用流域1975~1987年逐日水文资料对两个个模型参数进行率定，资料来源于《长江流域水文资料》。并选取场次洪水用已优选参数进行模拟，模拟结果以及部分场次洪水模拟结果见图3。</p><p>图3. 洪水模拟结果</p><p>由图3可得，就洪峰流量看，两个模型模拟的结果均小于实测流量，但是LSTM网络模型的模拟结果更接近实际值；就峰现时间看，新安江模型模拟的洪水过程，峰现时间比实际情况晚，甚至会出现实际上不存在的洪水过程，而LSTM模型模拟的洪水峰现时间基本与实际洪水过程吻合，模拟精度较高。总体来看，LSTM网络模型的模拟效果比新安江模型的模拟效果好。</p><p>由部分场次洪水过程图来看，LSTM网络模型的洪水过程与实际洪水过程相似，而新安江模型模拟结果与实际情况有较大偏差，尤其是峰现时间。仔细分析可以发现，该流域的洪水过程与降水过程并不对应，就19760601次洪水数据来看，当降水事件发生时，并没有观测到洪水发生，而是在之后一天才观测到洪水。</p><p>本文作者认为，之所以会发生这样的事情，很重要的原因在于该流域的降雨具有极强的空间变异性，监测到的降水过程与流域整体的降水过程偏差较大。另外，官山河流域植被覆盖度高，下垫面情况复杂。综合以上原因，传统的有很强物理机制的水文模型在该流域并不适用。</p><p>而就LSTM模型而言，同时输入降水和径流资料，这样便可以解决降雨与径流过程不对应的情况。同时，LSTM模型并不具备较强的物理机制，是单纯从降雨、径流资料的统计学关系出发。这样，其模拟的洪水过程的效果反而较好，模拟的精度较高，见图4。</p><p>深入分析模型模拟结果，结果见表1。从模拟结果来看，对于洪峰误差，LSTM模型的模拟结果误差在40%左右，而新安江模型的模拟结果误差在50%左右；对于洪量误差，LSTM模型的模拟结果误差在35%左右，而</p><p>图4. 场次洪水模拟结果</p><p>新安江模型的模拟结果误差仍在50%左右。无论是洪峰还是洪量，LSTM模型模拟结果均优于新安江模型。最后，分别计算率定期和检验期模型结果的纳什效率系数，结果分别为0.75和0.73，模拟结果精度较高。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The results of error analysi</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >序号</th><th align="center" valign="middle"  rowspan="2"  >洪号</th><th align="center" valign="middle"  colspan="2"  >洪峰误差(%)</th><th align="center" valign="middle"  colspan="2"  >洪量误差(%)</th></tr></thead><tr><td align="center" valign="middle" >LSTM模型</td><td align="center" valign="middle" >新安江模型</td><td align="center" valign="middle" >LSTM模型</td><td align="center" valign="middle" >新安江模型</td></tr><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >19760601</td><td align="center" valign="middle" >36.08</td><td align="center" valign="middle" >12.12</td><td align="center" valign="middle" >0.44</td><td align="center" valign="middle" >10.13</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >19770718</td><td align="center" valign="middle" >40.39</td><td align="center" valign="middle" >27.45</td><td align="center" valign="middle" >9.59</td><td align="center" valign="middle" >91.36</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >19790913</td><td align="center" valign="middle" >36.86</td><td align="center" valign="middle" >5.17</td><td align="center" valign="middle" >28.66</td><td align="center" valign="middle" >14.68</td></tr><tr><td align="center" valign="middle" >4</td><td align="center" valign="middle" >19800624</td><td align="center" valign="middle" >45.47</td><td align="center" valign="middle" >59.37</td><td align="center" valign="middle" >32.99</td><td align="center" valign="middle" >15.97</td></tr><tr><td align="center" valign="middle" >5</td><td align="center" valign="middle" >19811006</td><td align="center" valign="middle" >40.37</td><td align="center" valign="middle" >13.19</td><td align="center" valign="middle" >36.45</td><td align="center" valign="middle" >69.74</td></tr><tr><td align="center" valign="middle" >6</td><td align="center" valign="middle" >19820824</td><td align="center" valign="middle" >46.67</td><td align="center" valign="middle" >42.86</td><td align="center" valign="middle" >39.18</td><td align="center" valign="middle" >22.76</td></tr><tr><td align="center" valign="middle" >7</td><td align="center" valign="middle" >19831005</td><td align="center" valign="middle" >45.35</td><td align="center" valign="middle" >81.6</td><td align="center" valign="middle" >36.63</td><td align="center" valign="middle" >65.19</td></tr><tr><td align="center" valign="middle" >8</td><td align="center" valign="middle" >19850621</td><td align="center" valign="middle" >44.71</td><td align="center" valign="middle" >79.47</td><td align="center" valign="middle" >65.29</td><td align="center" valign="middle" >79.8</td></tr><tr><td align="center" valign="middle" >9</td><td align="center" valign="middle" >19860616</td><td align="center" valign="middle" >49.98</td><td align="center" valign="middle" >49.42</td><td align="center" valign="middle" >81.02</td><td align="center" valign="middle" >3.08</td></tr><tr><td align="center" valign="middle"  colspan="2"  >平均误差</td><td align="center" valign="middle" >42.58</td><td align="center" valign="middle" >50.22</td><td align="center" valign="middle" >36.1</td><td align="center" valign="middle" >50.55</td></tr></tbody></table></table-wrap><p>表1. 各模型模拟误差结果</p></sec></sec><sec id="s6"><title>4. 结论</title><p>本文以官山河流域1975到1986年的降水量、径流量资料为依据，采用归一化法对数据进行预处理，选用LSTM网络模型以及水文上广泛应用的三水源新安江模型作为预测模型，对该流域进行洪水模拟及预测。经过两者结果的对比分析，可以得到以下几条结论：</p><p>1) LSTM模型进行洪水预报时，同时使用降雨与径流数据，可以一定程度上提高洪水预报精度。</p><p>2) LSTM模型更适用于降雨资料缺少或者降雨的监测资料误差较大的山区小流域的洪水预报。在这些缺资料或无资料地区，传统的水文模型难以应用或应用结果较差，LSTM模型具有很强的参考价值。</p><p>3) 由于LSTM模型基于神经网络系统改进得来，在实际的洪水预报过程中有时会存在一定的过拟合现象，因此对于模拟结果应该辩证看待。</p></sec><sec id="s7"><title>基金项目</title><p>本文由国家重点研发计划(No. 2017YFC1502503)和国家自然科学基金重大项目(No. 41790431)资助。</p></sec><sec id="s8"><title>文章引用</title><p>郭 炅,张艳军,王俊勃,袁正颖,吴金津,董文逊,王素描. 长短期记忆模型在小流域洪水预报上的应用研究Application of the Long Short-Term Memory Networks for Flood Forecast[J]. 水资源研究, 2019, 08(01): 24-32. https://doi.org/10.12677/JWRR.2019.81003</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.29046-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">包红军, 王莉莉, 沈学顺, 等. 气象水文耦合的洪水预报研究进展[J]. 气象, 2016, 42(9): 1045-1057. 
BAO Hongjun, WANG Lili, SHEN Xueshun, et al. Advances of flood forecasting of hydro-meteorological forecast technology. Meteorological Monthly, 2016, 42(9): 1045-1057. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">吴超羽, 张文. 水文预报的人工神经网络方法[J]. 中山大学学报(自然科学版), 1994(1): 79-90. 
WU Chaoyu, ZHANG Wen. Application of artificial neural net: A new approach for hydrological forecasting. Acta Scientiarum Naturalium Universitatis Sunyatseni, 1994(1): 79-90. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">包红军, 赵琳娜. 基于集合预报的淮河流域洪水预报研究[J]. 水利学报, 2012, 43(2): 216-224. 
BAO Hongjun, ZHAO Linna. Flood forecast of Huaihe River based on TIGGE ensemble predictions. Journal of Hydraulic Engineering, 2012, 43(2): 216-224. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">俞亭超, 张土乔, 毛根海, 等. 预测城市用水量的人工神经网络模型研究[J]. 浙江大学学报(工学版), 2004, 38(9): 1156-1161. 
YU Tingchao, ZHANG Tuqiao, MAO Genhai, et al. Study of artificial neural network model for forecasting urban water demand. Journal of Zhejiang University (Engineering Science), 2004, 38(9): 1156-1161. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">CHIANG, Y. M., CHANG, L. C. and CHANG, F. Comparison of static-feed forward and dynamic-feedback neural networks for rainfall-runoff modeling. Journal of Hydrology, 2004, 290(3-4): 297-311. &lt;br&gt;https://doi.org/10.1016/j.jhydrol.2003.12.033</mixed-citation></ref><ref id="hanspub.29046-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">TAKUMI, A., SATOSHI, Y. and KOHEI, S. Distributed CFG-based symbolic execution for assembly programs: Consumer electronics. IEEE Consumer Electronics, Osaka, 2015: 76-80.</mixed-citation></ref><ref id="hanspub.29046-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">江衍铭, 张建全, 明焱. 集合神经网络的洪水预报[J]. 浙江大学学报(工学版), 2016, 50(8): 1471-1478. 
CHIANG Yenming, ZHANG Jianquan and MING Yan. Flood forecasting by ensemble neural networks. Journal of Zhejiang University (Engineering Science), 2016, 50(8): 1471-1478. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">于家斌, 尚方方, 王小艺, 等. 基于遗传算法改进的一阶滞后滤波和长短期记忆网络的蓝藻水华预测方法[J]. 计算机应用, 2018, 38(7): 2119-2123, 2135. 
YU Jiabin, SHANG Fangfang, WANG Xiaoyi, et al. Cyanobacterial bloom forecast method based on genetic algorithm-first order lag filter and long short-term memory network. Journal of Computer Applications, 2018, 38(7): 2119-2123, 2135. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">冯钧, 潘飞. 一种LSTM-BP多模型组合水文预报方法[J]. 计算机与现代化, 2018, 275(7): 82-85. 
FENG Jun, PAN Fei. A hydrologic forecast method based on LSTM-BP. Computer and Modernization, 2018, 275(7): 82-85. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">王旭东, 严珂, 陆慧娟, 等. LSTM的单变量短期家庭电力需求预测[J]. 中国计量大学学报, 2018, 29(2): 142-148. 
WANG Xudong, YAN Ke, LU Huijuan, et al. Short-term household electricity demand forecast based on LSTM single variable. Journal of China University of Metrology, 2018, 29(2): 142-148. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">JAVIER, O. F., DANIEL, R. Deep convolutional and LSTM recurrent neural networks for multimodal wearable activity recognition. Sensors, 2016, 16(1): 115. &lt;br&gt;https://doi.org/10.3390/s16010115</mixed-citation></ref><ref id="hanspub.29046-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">权波, 杨博辰, 胡可奇, 等. 基于LSTM的船舶航迹预测模型[J]. 计算机科学, 2018, 45(S2): 126-131. 
QUAN Bo, YANG Bochen, HU Keqi, et al. Prediction model of ship trajectory based on LSTM. Computer Science, 2018, 45(S2): 126-131. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">杨凯, 阮晓波, 游圆. 新安江模型在马尪溪流域径流模拟的应用[J]. 浙江水利水电学院学报, 2017, 29(5): 10-13. 
YANG Kai, RUAN Xiaobo and YOU Yuan. Application of Xin’anjiang model in Mawang River Basin runoff simulation. Journal of Zhejiang University of Water Resources and Electric Power, 2017, 29(5): 10-13. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">刘佩瑶, 郝振纯, 王国庆, 等. 新安江模型和改进BP神经网络模型在闽江水文预报中的应用[J]. 水资源与水工程学报, 2017, 28(1): 40-44. 
LIU Peiyao, HAO Zhenchun, WANG Guoqing, et al. Application of Xin’anjiang model and the improved BP neural network model in hydrological forecasting of the Min River. Journal of Water Resources and Water Engineering, 2017, 28(1): 40-44. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">劳应文, 吴志斌. U形板桩在官山河道治理中的应用[J]. 价值工程, 2015, 34(16): 139-140. 
LAO Yingwen, WU Zhibin. Application of U-shaped plate piles in Guanshan River regulation. Value Engineering, 2015, 34(16): 139-140. (in Chinese)</mixed-citation></ref><ref id="hanspub.29046-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">谢俊. 径流时间序列的长记忆特性分析[D]. 武汉: 华中科技大学, 2012. 
XIE Jun. Research on long memory characteristic of runoff time series. Wuhan: Huazhong University of Science and Technology, 2012. (in Chinese)</mixed-citation></ref></ref-list></back></article>