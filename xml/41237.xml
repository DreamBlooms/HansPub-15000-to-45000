<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">PM</journal-id><journal-title-group><journal-title>Pure  Mathematics</journal-title></journal-title-group><issn pub-type="epub">2160-7583</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/PM.2021.113046</article-id><article-id pub-id-type="publisher-id">PM-41237</article-id><article-categories><subj-group subj-group-type="heading"><subject>PM20210300000_12881517.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  线性延时系统的参数辨识及其在电路模型中的应用
  Parameter Identification of Linear Delay System and Its Application in Circuit Model
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>蘧</surname><given-names>静雪</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>岩斌</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>徐</surname><given-names>文瀚</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>上海大学数学系，上海</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><aff id="aff3"><addr-line>哈尔滨师范大学数学科学学院，黑龙江 哈尔滨；东北师范大学数学与统计学院，吉林 长春</addr-line></aff><pub-date pub-type="epub"><day>18</day><month>03</month><year>2021</year></pub-date><volume>11</volume><issue>03</issue><fpage>346</fpage><lpage>356</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    本文研究一类具有未知延时的线性系统的参数辨识问题。辨识问题包括延时估计和系统参数估计。首先，把延时和参数估计问题转化为具有遗忘因子的关于延时的非线性优化问题，借助Gauss-Newton法得到延时的估计，进而基于最小二乘方法得到系统参数估计。该辨识问题以实际电路系统为研究对象，充分考虑了延时和实际噪声的影响。最后，通过搭建实际电路系统，并以其输入和状态值作为实际测量数据，用本文所提辨识方法进行延时和系统参数辨识。验证结果表明了带有延时的线性微分方程模型的科学性和辨识方法的有效性。
    In this paper, the problem of parameter identification for a class of linear systems with unknown delay is studied. The identification problem includes the estimation of delay and system parame-ters. Firstly, the estimation of delay and parameters is transformed into a nonlinear optimization problem with forgetting factor, and the estimation of delay is obtained by Gauss-Newton method, then the parameters of the system are estimated based on the least square method. The problem of parameter identification takes the real circuit system as the research object and considers the effect of delay and real noise sufficiently. Finally, by building an actual circuit system and taking its input and state values as actual measurement data, the identification algorithm proposed in this paper is used to identify the delay and system parameters. The results show that the linear differential equation model with time delay is scientific and the method of identification is effective. 
  
 
</p></abstract><kwd-group><kwd>线性延时系统，参数辨识，最小二乘方法，Gauss-Newton法，电路模型, Linear Delay System</kwd><kwd> Parameter Identification</kwd><kwd> Least Square Method</kwd><kwd> Gauss-Newton Method</kwd><kwd>Circuit Model</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>本文研究一类具有未知延时的线性系统的参数辨识问题。辨识问题包括延时估计和系统参数估计。首先，把延时和参数估计问题转化为具有遗忘因子的关于延时的非线性优化问题，借助Gauss-Newton法得到延时的估计，进而基于最小二乘方法得到系统参数估计。该辨识问题以实际电路系统为研究对象，充分考虑了延时和实际噪声的影响。最后，通过搭建实际电路系统，并以其输入和状态值作为实际测量数据，用本文所提辨识方法进行延时和系统参数辨识。验证结果表明了带有延时的线性微分方程模型的科学性和辨识方法的有效性。</p></sec><sec id="s2"><title>关键词</title><p>线性延时系统，参数辨识，最小二乘方法，Gauss-Newton法，电路模型</p></sec><sec id="s3"><title>Parameter Identification of Linear Delay System and Its Application in Circuit Model<sup> </sup></title><p>Jingxue Qu<sup>1</sup>, Yanbin Zhao<sup>2,3</sup>, Wenhan Xu<sup>1</sup></p><p><sup>1</sup>Department of Mathematics, Shanghai University, Shanghai</p><p><sup>2</sup>School of Mathematical Sciences, Harbin Normal University, Harbin Heilongjiang</p><p><sup>3</sup>School of Mathematics and Statistics, Northeast Normal University, Changchun Jilin</p><p><img src="//html.hanspub.org/file/6-1251217x4_hanspub.png" /></p><p>Received: Feb. 17<sup>th</sup>, 2021; accepted: Mar. 18<sup>th</sup>, 2021; published: Mar. 26<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/6-1251217x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>In this paper, the problem of parameter identification for a class of linear systems with unknown delay is studied. The identification problem includes the estimation of delay and system parameters. Firstly, the estimation of delay and parameters is transformed into a nonlinear optimization problem with forgetting factor, and the estimation of delay is obtained by Gauss-Newton method, then the parameters of the system are estimated based on the least square method. The problem of parameter identification takes the real circuit system as the research object and considers the effect of delay and real noise sufficiently. Finally, by building an actual circuit system and taking its input and state values as actual measurement data, the identification algorithm proposed in this paper is used to identify the delay and system parameters. The results show that the linear differential equation model with time delay is scientific and the method of identification is effective.</p><p>Keywords:Linear Delay System, Parameter Identification, Least Square Method, Gauss-Newton Method, Circuit Model</p><disp-formula id="hanspub.41237-formula24"><graphic xlink:href="//html.hanspub.org/file/6-1251217x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/6-1251217x7_hanspub.png" /> <img src="//html.hanspub.org/file/6-1251217x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>在自然科学和社会科学的许多领域中，人们越来越重视对系统进行定量的分析、仿真、控制和预测，而将研究对象模型化，是开展这些工作的前提和基础。通过对未知系统的实验或运行数据进行分析，建立一个与所测系统等价的数学模型属于系统辨识问题。系统辨识作为现代工业控制中的重要分支，在控制系统的设计与分析、监控过程参数、故障诊断、图像识别和信号处理等领域有着广泛的应用 [<xref ref-type="bibr" rid="hanspub.41237-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.41237-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.41237-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.41237-ref4">4</xref>]。系统辨识包含两个部分，即模型结构辨识和参数辨识。在实际应用中，有些系统的模型可以用理论分析的方法借助于已知的定律、定理和原理推导出来，如力学原理、能量守恒定理和化学动力学原理等。在系统模型已知的条件下，确定模型中的一些未知参数属于参数辨识问题。近年来，针对不同模型的参数辨识的研究已经取得了一系列成果 [<xref ref-type="bibr" rid="hanspub.41237-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.41237-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.41237-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.41237-ref8">8</xref>]。文献 [<xref ref-type="bibr" rid="hanspub.41237-ref5">5</xref>] 研究了二阶RC等效电路模型的参数辨识问题，通过使用Levenberg-Marquard算法计算电路模型中的RC值。文献 [<xref ref-type="bibr" rid="hanspub.41237-ref6">6</xref>] 充分考虑了摩擦系数的影响，提出带有遗忘因子的递推最小二乘辨识算法。文献 [<xref ref-type="bibr" rid="hanspub.41237-ref7">7</xref>] 借助改进的人工鱼群算法对光伏组件的数学模型进行参数辨识。文献 [<xref ref-type="bibr" rid="hanspub.41237-ref8">8</xref>] 将蚁群算法用于参数辨识。</p><p>许多动力系统可以用微分方程来描述其状态变化规律。然而，随着工业的发展，利用常微分方程来描述一些复杂动力系统变得越来越困难。因为许多动力系统的演化不仅依赖于系统当前的状态，还取决于系统过去某一时刻或若干时刻的状态，这类动力系统被称为延时动力系统，需要建立延时微分方程模型。延时系统广泛存在于实际应用中，例如电子电力系统、神经网络、过程控制、生物环境与医学、建筑工程等领域 [<xref ref-type="bibr" rid="hanspub.41237-ref9">9</xref>] - [<xref ref-type="bibr" rid="hanspub.41237-ref14">14</xref>]。在延时微分方程模型中，延迟项与其他模型参数之间存在非线性关系，这导致辨识难度增加，控制效果下降，特别是在存在测量噪声的情况下，辨识延时微分方程模型的系统参数具有很大挑战。因此，对延时系统参数辨识方法的研究具有重要的理论意义和应用价值。</p><p>关于延时线性系统的参数辨识的研究已取得一些进展 [<xref ref-type="bibr" rid="hanspub.41237-ref15">15</xref>] - [<xref ref-type="bibr" rid="hanspub.41237-ref20">20</xref>]。Gawthrop [<xref ref-type="bibr" rid="hanspub.41237-ref15">15</xref>] 等提出一种用有理传递函数逼近延时的方法，但这种方法使得模型阶数增加，因此需要辨识更多参数，而且当系统延时较大时，可能会出现不可接受的近似误差。文献 [<xref ref-type="bibr" rid="hanspub.41237-ref16">16</xref>] 使用时频方法对带有延时的线性动力系统进行参数辨识，同时解决了系统参数估计和初始条件估计问题。Sung [<xref ref-type="bibr" rid="hanspub.41237-ref17">17</xref>] 等利用Levenberg-Marquardt方法最优化包含延时的目标函数，使预测误差达到最小，提出一种连续时间预测误差辨识方法。Orlov [<xref ref-type="bibr" rid="hanspub.41237-ref18">18</xref>] 等针对状态向量和控制中具有有限多个延时的线性动态系统，提出一种自适应参数辨识器，可实现未知延时和系统参数的在线辨识。Ren [<xref ref-type="bibr" rid="hanspub.41237-ref19">19</xref>] 等针对单输入单输出的连续时间延时系统，构造由参数估计误差驱动的自适应律，并引入滑模变换技术以确保参数估计的收敛性。</p><p>延时系统的参数辨识的研究大都使用仿真算例进行验证，目前很少有基于实际系统的研究结果。本文将以实际电路系统为研究对象，通过搭建实际电路系统，利用示波器采集系统的输入和状态数据来实现延时估计和参数辨识。实际数据与仿真数据不同，可能存在系统噪音和示波器的测量噪音等不能用具体模型精确描述的噪音，面向实际系统的系统辨识能够进一步检验模型结构的有效性和参数辨识方法的稳健性。本文结构如下：第2节介绍模型和本文将要用到的基本知识；第3节介绍辨识方法；第4节将所提参数辨识方法应用于实际电路系统中，以验证辨识方法的有效性。</p></sec><sec id="s6"><title>2. 准备工作</title><sec id="s6_1"><title>2.1. 问题陈述</title><p>考虑如下连续时间线性延时系统：</p><p>( x ˙ ( t ) = A 0 x ( t ) + A 1 x ( t − τ ) + B u ( t ) , u ( t ) = u &#175; ( t ) + ξ ( t ) , (2.1)</p><p>其中 u &#175; ( t ) ∈ ℝ r 是系统真实的输入变量， ξ ( t ) ∈ ℝ r 是系统中混杂的噪声， u ( t ) ∈ ℝ r ， x ( t ) ∈ ℝ n 是观测到的输入和状态变量， τ ∈ ℝ + 是系统的状态延时项， A 0 ∈ ℝ n &#215; n ， A 1 ∈ ℝ n &#215; n ， B ∈ ℝ n &#215; r 是系统的参数矩阵，设参数矩阵 θ T = [ A 0 , A 1 , B ] 。</p><p>本文研究的问题是：利用观测到的输入变量 u ( t ) 和状态变量 x ( t ) ，构造一种参数估计算法估计系统(2.1)的延时项 τ 以及参数矩阵 θ 。</p></sec><sec id="s6_2"><title>2.2. 系统的离散化</title><p>在 [ 0, T ] 时间内，取等间隔时间点 t k = k h ，离散步长 h = T N ， k = 1 , ⋯ , N 。假定输入 u ( t ) 在 [ t k , t k + 1 ] 区</p><p>间内恒定为 u ( t k ) ，采用欧拉法对系统(2.1)离散化，可得</p><p>x ( t k + 1 ) − x ( t k ) = h A 0 x ( t k ) + h A 1 x ( t k − d ) + h B u ( t k ) , (2.2)</p><p>其中 u ( t k ) 和 x ( t k ) 分别表示系统(2.1)在 t k 时刻测得的输入和状态值，d表示系统(2.1)离散化以后的时滞量，并且</p><p>d = τ h = d _ + l h ,</p><p>其中 0 ≤ l &lt; h ， d _ 是非负整数。当延时 τ 不是离散步长h的整数倍时， l ≠ 0 ， x ( k − d ) 可由 x ( k − d _ ) 与 x ( k − d _ − 1 ) 线性插值得到。若记 u ( t k ) = u k ， x ( t k ) = x k ， x ( t k + 1 ) − x ( t k ) = x k + 1 − x k = y k ，则待辨识的系统可以转化为</p><p>y k = h A 0 x k + h A 1 x k − d + h B u k = θ T φ ( k , d ) , (2.3)</p><p>其中 y k ∈ ℝ n , θ T ∈ ℝ n &#215; ( 2 n + r ) , φ ( k , d ) = [ h x k T , h x k − d T , h u k T ] T ∈ ℝ 2 n + r .</p><p>因此，本文研究的问题转化为：构造一种参数辨识算法，首先利用观测数据 { u k , x k } , ( k = 1 , 2 , ⋯ , N ) ，估计系统(2.3)的延时d和参数矩阵 θ ，再根据倍数关系计算系统(2.1)中的延时项 τ 。</p></sec></sec><sec id="s7"><title>3. 参数辨识算法</title><p>本节基于最小二乘算法和Gauss-Newton优化算法，提出一种线性延时系统的延时项估计和参数辨识算法，该算法可以利用观测数据 { u k , x k } , ( k = 1 , 2 , ⋯ , N ) 辨识系统延时项d和系统参数 θ 。</p><sec id="s7_1"><title>3.1. 算法的推导</title><p>离线的辨识算法要求如下二次准则函数达到最小：</p><p>J k ( θ , d ) = 1 2 ∑ i = 0 m − 1     e k − i T e k − i ,</p><p>其中m是使用的数据长度且满足 k − m ≥ d 。 e k 是节点k处的估计误差，即</p><p>e k = y k − θ ^ k T φ ^ ( k , d ^ ) .</p><p>θ ^ k 是利用节点k之前m组数据计算到的 θ 的估计值， d ^ k 是延时项d的估计值。</p><p>参数 θ ，d在节点k处的估计值 θ ^ k 和 d ^ k 可由下式得到：</p><p>[ θ ^ k T , d ^ k ] = arg min θ , d J k ( θ , d ) ,</p><p>当非线性时间延迟项d的估计 d ^ 已知时，线性参数 θ ^ k 可由线性最小二乘方法估计：</p><p>θ ^ k ( d ^ ) = R ^ − 1 ( k , d ^ ) F ^ ( k , d ^ ) ,</p><p>R ^ ( k , d ^ ) = ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) ,</p><p>F ^ ( k , d ^ ) = ϕ ^ ( k , d ^ ) Y T ( k ) , (3.1)</p><p>其中 ϕ ^ ( k , d ^ ) = [ φ ^ ( k , d ^ ) , φ ^ ( k − 1, d ^ ) , ⋯ , φ ^ ( k − m + 1, d ^ ) ] ， Y ( k ) = [ y k , y k − 1 , ⋯ , y k − m + 1 ] 。因此准则函数 J k ( θ , d ) 可转化为如下形式：</p><p>J ⌣ k ( d ) = 1 2 ∑ i = 0 m − 1     e ⌣ k − i T e ⌣ k − i , (3.2)</p><p>其中 e ⌣ k = y k − θ ^ k T ( d ^ ) φ ^ ( k , d ^ ) = y k − F ^ T ( k , d ^ ) [ R ^ − 1 ( k , d ^ ) ] T φ ^ ( k , d ^ ) 。</p><p>时间延迟d在节点k处的估计值 d ^ k 可由下式得到：</p><p>d ^ k = arg min d J ⌣ k ( d ) .</p><p>可以看出准则函数(3.2)中对节点k之前m组数值的权重是一致的, 为了削弱旧数据对参数估计结果的影响，加强新数据提供的信息量，本文引入遗忘因子 λ ,将(3.2)式转化为具有遗忘因子的准则函数：</p><p>J ⌣ k λ ( d ) = 1 2 ∑ i = 0 p − 1     λ i e ⌣ k − i T e ⌣ k − i = 1 2 E T ( k , d ) Λ E ( k , d ) , (3.3)</p><p>其中 λ 是遗忘因子， 0 &lt; λ ≤ 1 ，p是准则函数 J ⌣ k λ ( d ) 使用的数据量， p &lt; m 。</p><p>Λ = d i a g ( λ 0 I n , λ 1 I n , ⋯ , λ p − 1 I n ) , (3.4)</p><p>E T ( k , d ) = [ e ⌣ k T , e ⌣ k − 1 T , ⋯ , e ⌣ k − p + 1 T ] . (3.5)</p><p>由Gauss-Newton算法知延时项d可由如下算法迭代：</p><p>d k + 1 = d k + μ k ,</p><p>μ k = − ( ϒ T ( k , d ) ϒ ( k , d ) ) − 1 ϒ T ( k , d ) Λ E ( k , d ) ,</p><p>ϒ T ( k , d ) = ∂ E T ( k , d ) ∂ d ^ = [ ∂ e ⌣ k T ∂ d ^ , ∂ e ⌣ k − 1 T ∂ d ^ , ⋯ , ∂ e ⌣ k − p + 1 T ∂ d ^ ] . (3.6)</p><p>首先计算 e ⌣ k 关于 d ^ 的导数，并记为 Ψ ( k , d ) ，则：</p><p>Ψ ( k , d ) = ∂ e ⌣ k ∂ d ^ = − ∂ F ^ T ( k , d ^ ) [ R ^ − 1 ( k , d ^ ) ] T φ ^ ( k , d ^ ) ∂ d ^ = − ∂ F ^ ( k , d ) ∂ d ^ [ R ^ T ( k , d ^ ) ] − 1 φ ^ ( k , d ^ )   − F ^ T ( k , d ^ ) ∂ [ R T ( k , d ^ ) ] − 1 ∂ d ^ φ ^ ( k , d ^ )   − F ^ T ( k , d ^ ) [ R ^ T ( k , d ^ ) ] − 1 ∂ φ ^ ( k , d ^ ) ∂ d ^ , (3.7)</p><p>其中</p><p>∂ F ^ ( k , d ) ∂ d ^ = [ ∂ φ ^ ( k , d ^ ) ∂ d ^ , ∂ φ ^ ( k − 1, d ^ ) ∂ d ^ , ⋯ , ∂ φ ^ ( k − m + 1, d ^ ) ∂ d ^ ] Y T ( k ) , (3.8)</p><p>∂ [ R T ( k , d ^ ) ] − 1 ∂ d ^ = ∂ [ ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) ] − 1 ∂ d ^ = − [ ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) ] − 1 [ ∂ ϕ ^ ( k , d ^ ) ∂ d ^ ϕ ^ T + ϕ ^ ∂ ϕ ^ T ( k , d ^ ) ∂ d ^ ] [ ϕ ^ ( k , d ^ ) ϕ ^ T ( k , d ^ ) ] − 1 . (3.9)</p><p>对于 ∂ ϕ ^ ( k , d ^ ) ∂ d ^ ，先计算 ∂ ( h x k − d ^ ) ∂ d ^ ，</p><p>∂ ( h x k − d ^ ) ∂ d ^ = h ∂ x ( k − d ^ ) ∂ d ^ = h ∂ x ( k − d ^ ) ∂ ( k − d ^ ) ∂ ( k − d ^ ) ∂ d ^ = − h ∂ x ( k − d ^ ) ∂ ( k − d ^ ) = − h l i m γ → 0 x ( k − d ^ ) − x ( k − d ^ − γ ) ( k − d ^ ) − ( k − d ^ − γ ) .</p><p>根据Nyquist-Shannon采样定理 [<xref ref-type="bibr" rid="hanspub.41237-ref20">20</xref>]，当采样周期足够小时，采样系统的 γ = 1 ，由此可得：</p><p>∂ φ ^ ( k , d ^ ) ∂ d ^ = [ 0 − h Δ x k − d ^ 0 ] , (3.10)</p><p>Δ 是差分算子， Δ x k = x k − x k − 1 。</p></sec><sec id="s7_2"><title>3.2. 算法总结</title><p>算法3.1 系统(2.1)中延时项 τ 和参数 θ 的辨识算法：</p><p>第1步：令 k = 1 ，设 k = 1 时对应的观测数据为 { u k ˜ , x k ˜ } ；给定使用的数据量m和p；设置初始值 τ 0 、遗忘因子 λ 和辨识精度 ε ；</p><p>第2步：用观测数据 { u k , x k } , ( k = 1 , 2 , ⋯ , N ) 建立信息矩阵： y k ， φ ( k , d ^ k ) ， Y ( k ) ， ϕ ( k , d ^ k ) ；</p><p>第3步：进行如下迭代过程：</p><p>μ k = − ( ϒ T ( k , d ^ k ) ϒ ( k , d ^ k ) ) − 1 ϒ T ( k , d ^ k ) Λ E ( k , d ^ k ) ,</p><p>d ^ k + 1 = d ^ k + μ k ,</p><p>τ ^ k + 1 = h d ^ k + 1 .</p><p>其中 ϒ T ( k , d ^ k ) ， Λ 和 E ( k , d ^ k ) 由(3.4)~(3.10)式给出；</p><p>第4步：当 ‖ τ ^ k + 1 − τ ^ k ‖ &lt; ε 或 k = N 时，第3步的迭代终止，用(3.1)式估计系统(2.1)中的参数 θ ，则有</p><p>θ ^ ( d ^ N ) = R ^ − 1 ( N , d ^ N ) F ^ ( N , d ^ N ) .</p><p>否则，令 k : = k + 1 ，返回第2步。</p><p>注3.1 第3步中的 d ^ k 不一定是整数，因此在算法3.1的迭代步骤中 x k − d ^ k 由 x k − d ^ _ k 和 x k − d ^ _ k − 1 线性插值得到，其中 d ^ _ k 是 d ^ k 的向下取整。</p><p>注3.2 在算法3.1的计算过程中，迭代的每一步均使用到k节点之前的m组数据，因此 k = 1 时对应的观测数据 { u k ˜ , x k ˜ } 应该满足 k ˜ &gt; m 。</p></sec></sec><sec id="s8"><title>4. 电路模型的参数辨识</title><p>在实际电路系统中，通常需要知道电子元件的参数值，进而对电路系统进行参数性故障判断。然而，但由于硬件条件的限制，电子元件参数值往往难以测量或测量成本较高，因此本节将上节所提参数辨识算法3.1应用到电路模型中，辨识电路模型中的电压延迟以及电容电阻值，为实际电路系统的参数性故障诊断创造条件。</p><p>本文通过运算放大器和STM32芯片搭建延时电路模型，如图1所示。其中，实验所用的信号源是电压源，通过电压–电流转换器得到电流信号，即系统的输入 i ( t ) 。电阻R<sub>1</sub>、R<sub>2</sub>两端的电压 u 1 ( t ) 、 u 2 ( t ) 是系统的状态，延时电压 u 1 ( t − τ ) 和 u 2 ( t − τ ) 通过减法器和STM32芯片的存储功能实现，实现过程如图2所示。本文的实验平台如图3所示。</p><p>针对图1中的节点1和节点2写出如下基尔霍夫电流方程：</p><p>( i ( t ) − u 1 ( t − τ ) R d 1 − u 1 ( t ) R 1 − C 1 d u 1 d t = 0, u 1 ( t ) R 1 + C 1 d u 1 d t − u 2 ( t ) R 2 − C 2 d u 2 d t − u 2 ( t − τ ) R d 2 = 0. (4.1)</p><p>图1. 延时电路模型</p><p>图2. 延时电压的实现过程</p><p>图3. 实验平台</p><p>将上述方程转化为状态空间模型：</p><p>[ u ˙ 1 ( t ) u ˙ 2 ( t ) ] = [ − 1 C 1 R 1 0 0 − 1 C 2 R 2 ] [ u 1 ( t ) u 2 ( t ) ] + [ − 1 C 1 R d 1 0 − 1 C 2 R d 2 − 1 C 2 R d 2 ] [ u 1 ( t − τ ) u 2 ( t − τ ) ] + [ 1 C 1 1 C 2 ] i ( t ) ,</p><p>其中 C 1 ， C 2 ， R 1 ， R 2 ， R d 1 ， R d 2 和 τ 是待辨识的参数。</p><p>记 x ( t ) = [ u 1 ( t ) u 2 ( t ) ] ， U ( t ) = i ( t ) ， A 0 = [ − 1 C 1 R 1 0 0 − 1 C 2 R 2 ] ， A 1 = [ − 1 C 1 R d 1 0 − 1 C 2 R d 2 − 1 C 2 R d 2 ] , B = [ 1 C 1 1 C 2 ] ，则有</p><p>x ˙ ( t ) = A 0 x ( t ) + A 1 x ( t − τ ) + B U ( t ) , x ( t ) ∈ ℝ 2 , U ( t ) ∈ ℝ . (4.2)</p><p>利用算法3.1辨识系统(4.1)中的电压延迟 τ 以及电阻电容值，只需先辨识系统(4.2)中的参数矩阵 A 0 、 A 1 和B，再根据其与 C 1 、 C 2 、 R 1 、 R 2 、 R d 1 和 R d 2 之间的数量关系计算出电路系统的电阻和电容值即可。</p><p>本节用8位数字示波器在64 s内均匀采集2000组数据，即 T = 64 ， N = 2000 ，采样间隔或离散步长 h = 0.032 。在相同的实验条件下分别测量10次输入和状态值，其中一组输入和状态值 { U k , x k } , ( k = 1 , 2 , ⋯ , N ) 的测量结果如图4所示，测得的前500个状态值如图5所示，可以观察到示波器测得的原始数据噪声较大，因此本节先对原始的观测数据 { u k , x k } 进行Savitzky-Golay数据滤波，再用算法3.1进行参数辨识。</p><p>图4. 一组观测到的输入和状态值</p><p>设延时量初值为： τ 0 = 0.23 ，取 m = 900 ， p = 100 ， n = 150 ， λ = 0.95 ，利用测得的系统输入和状态值进行10次参数辨识。延时项 τ 的辨识过程如图6所示。参数和延时辨识结果与实际值的对比如表1所示。</p><p>图5. 系统(4.2)的前500个状态观测值</p><p>图6. 第1~10次实验中延时项 τ 的辨识过程</p><table-wrap-group id="1"><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Identification results and experimental errors of delay term and electronic component parameter values in circuit model (4.1</title></caption><table-wrap id="1_1"><table><tbody><thead><tr><th align="center" valign="middle" >实验结果</th><th align="center" valign="middle" >τ / s</th><th align="center" valign="middle" >C 1 / μ F</th><th align="center" valign="middle" >C 2 / μ F</th><th align="center" valign="middle" >R 1 / Ω</th><th align="center" valign="middle" >R 2 / Ω</th><th align="center" valign="middle" >R d 1 / Ω</th><th align="center" valign="middle" >R d 2 / Ω</th></tr></thead><tr><td align="center" valign="middle" >第1次</td><td align="center" valign="middle" >0.4498</td><td align="center" valign="middle" >740.1794</td><td align="center" valign="middle" >683.8233</td><td align="center" valign="middle" >410.7704</td><td align="center" valign="middle" >966.3211</td><td align="center" valign="middle" >523.3962</td><td align="center" valign="middle" >506.7010</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >1.36</td><td align="center" valign="middle" >5.74</td><td align="center" valign="middle" >2.31</td><td align="center" valign="middle" >2.69</td><td align="center" valign="middle" >3.37</td><td align="center" valign="middle" >2.63</td><td align="center" valign="middle" >0.65</td></tr><tr><td align="center" valign="middle" >第2次</td><td align="center" valign="middle" >0.4495</td><td align="center" valign="middle" >747.3570</td><td align="center" valign="middle" >689.6497</td><td align="center" valign="middle" >417.0305</td><td align="center" valign="middle" >964.6346</td><td align="center" valign="middle" >519.4436</td><td align="center" valign="middle" >516.5465</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >1.42</td><td align="center" valign="middle" >6.77</td><td align="center" valign="middle" >1.48</td><td align="center" valign="middle" >4.26</td><td align="center" valign="middle" >3.54</td><td align="center" valign="middle" >1.85</td><td align="center" valign="middle" >1.28</td></tr><tr><td align="center" valign="middle" >第3次</td><td align="center" valign="middle" >0.4467</td><td align="center" valign="middle" >749.8180</td><td align="center" valign="middle" >667.0266</td><td align="center" valign="middle" >415.2545</td><td align="center" valign="middle" >958.3749</td><td align="center" valign="middle" >516.2745</td><td align="center" valign="middle" >517.7267</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >2.04</td><td align="center" valign="middle" >7.12</td><td align="center" valign="middle" >4.71</td><td align="center" valign="middle" >3.81</td><td align="center" valign="middle" >4.16</td><td align="center" valign="middle" >1.23</td><td align="center" valign="middle" >1.52</td></tr><tr><td align="center" valign="middle" >第4次</td><td align="center" valign="middle" >0.4603</td><td align="center" valign="middle" >749.3177</td><td align="center" valign="middle" >666.6400</td><td align="center" valign="middle" >424.2695</td><td align="center" valign="middle" >961.4248</td><td align="center" valign="middle" >524.0130</td><td align="center" valign="middle" >520.6892</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >0.94</td><td align="center" valign="middle" >7.05</td><td align="center" valign="middle" >4.77</td><td align="center" valign="middle" >6.07</td><td align="center" valign="middle" >3.86</td><td align="center" valign="middle" >2.75</td><td align="center" valign="middle" >2.10</td></tr><tr><td align="center" valign="middle" >第5次</td><td align="center" valign="middle" >0.4503</td><td align="center" valign="middle" >747.1706</td><td align="center" valign="middle" >688.7300</td><td align="center" valign="middle" >400.1934</td><td align="center" valign="middle" >967.0184</td><td align="center" valign="middle" >509.8189</td><td align="center" valign="middle" >521.2468</td></tr></tbody></table></table-wrap><table-wrap id="1_2"><table><tbody><thead><tr><th align="center" valign="middle" >误差(%)</th><th align="center" valign="middle" >1.25</th><th align="center" valign="middle" >6.74</th><th align="center" valign="middle" >1.61</th><th align="center" valign="middle" >0.05</th><th align="center" valign="middle" >3.30</th><th align="center" valign="middle" >0.04</th><th align="center" valign="middle" >2.21</th></tr></thead><tr><td align="center" valign="middle" >第6次</td><td align="center" valign="middle" >0.4699</td><td align="center" valign="middle" >738.9344</td><td align="center" valign="middle" >683.6488</td><td align="center" valign="middle" >431.2437</td><td align="center" valign="middle" >964.6696</td><td align="center" valign="middle" >537.8621</td><td align="center" valign="middle" >506.8381</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >3.05</td><td align="center" valign="middle" >5.56</td><td align="center" valign="middle" >2.34</td><td align="center" valign="middle" >7.81</td><td align="center" valign="middle" >3.53</td><td align="center" valign="middle" >5.46</td><td align="center" valign="middle" >0.62</td></tr><tr><td align="center" valign="middle" >第7次</td><td align="center" valign="middle" >0.4835</td><td align="center" valign="middle" >748.1611</td><td align="center" valign="middle" >666.3721</td><td align="center" valign="middle" >420.9335</td><td align="center" valign="middle" >960.1822</td><td align="center" valign="middle" >534.6097</td><td align="center" valign="middle" >529.4820</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >6.03</td><td align="center" valign="middle" >6.88</td><td align="center" valign="middle" >4.80</td><td align="center" valign="middle" >5.23</td><td align="center" valign="middle" >3.98</td><td align="center" valign="middle" >4.83</td><td align="center" valign="middle" >3.82</td></tr><tr><td align="center" valign="middle" >第8次</td><td align="center" valign="middle" >0.4488</td><td align="center" valign="middle" >736.2329</td><td align="center" valign="middle" >679.7386</td><td align="center" valign="middle" >408.2738</td><td align="center" valign="middle" >975.4522</td><td align="center" valign="middle" >528.9898</td><td align="center" valign="middle" >515.4247</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >1.58</td><td align="center" valign="middle" >5.18</td><td align="center" valign="middle" >2.89</td><td align="center" valign="middle" >2.07</td><td align="center" valign="middle" >2.45</td><td align="center" valign="middle" >3.72</td><td align="center" valign="middle" >1.06</td></tr><tr><td align="center" valign="middle" >第9次</td><td align="center" valign="middle" >0.4445</td><td align="center" valign="middle" >747.9704</td><td align="center" valign="middle" >686.8672</td><td align="center" valign="middle" >398.2981</td><td align="center" valign="middle" >973.8660</td><td align="center" valign="middle" >521.5092</td><td align="center" valign="middle" >500.6972</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >2.52</td><td align="center" valign="middle" >6.85</td><td align="center" valign="middle" >1.88</td><td align="center" valign="middle" >0.43</td><td align="center" valign="middle" >2.61</td><td align="center" valign="middle" >2.26</td><td align="center" valign="middle" >1.82</td></tr><tr><td align="center" valign="middle" >第10次</td><td align="center" valign="middle" >0.4547</td><td align="center" valign="middle" >756.1448</td><td align="center" valign="middle" >683.2641</td><td align="center" valign="middle" >423.6429</td><td align="center" valign="middle" >988.2481</td><td align="center" valign="middle" >505.2398</td><td align="center" valign="middle" >525.8043</td></tr><tr><td align="center" valign="middle" >误差(%)</td><td align="center" valign="middle" >0.29</td><td align="center" valign="middle" >8.02</td><td align="center" valign="middle" >2.39</td><td align="center" valign="middle" >5.91</td><td align="center" valign="middle" >1.18</td><td align="center" valign="middle" >0.93</td><td align="center" valign="middle" >2.94</td></tr><tr><td align="center" valign="middle" >标准差</td><td align="center" valign="middle" >0.0123</td><td align="center" valign="middle" >5.9563</td><td align="center" valign="middle" >9.3444</td><td align="center" valign="middle" >10.4088</td><td align="center" valign="middle" >8.9636</td><td align="center" valign="middle" >9.7923</td><td align="center" valign="middle" >9.0216</td></tr><tr><td align="center" valign="middle" >真实值</td><td align="center" valign="middle" >0.456</td><td align="center" valign="middle" >700</td><td align="center" valign="middle" >700</td><td align="center" valign="middle" >400</td><td align="center" valign="middle" >1000</td><td align="center" valign="middle" >510</td><td align="center" valign="middle" >510</td></tr></tbody></table></table-wrap></table-wrap-group><p>表1. 电路模型(4.1)中延时项和电子元件参数值的辨识结果及实验误差</p><p>图6表明，算法3.1估计出的电压延迟 τ ^ 可以快速收敛到真实的电压延迟 τ ；表1中的结果表明，算法3.1可以在含有观测噪声的情况下准确辨识出电路模型(4.1)中的电压延迟以及电容、电阻值。</p></sec><sec id="s9"><title>5. 结论</title><p>本文研究一类线性延时系统的延时项估计及参数辨识问题，并将所提方法应用到电路模型中。首先用欧拉法对连续系统进行离散，得到离散模型；然后利用最小二乘方法将延时项的估计问题转化为非线性最小二乘优化问题，且在目标函数中引入遗忘因子；进而用Gauss-Newton法估计系统的延时量，并利用延时量得到系统参数的最小二乘估计值；最后，将所提参数辨识方法应用到电路模型中。计算结果表明，该方法可以在含有噪声的情况下估计出电路模型中的电压延时和电子元件参数值，满足实际应用的需求。</p></sec><sec id="s10"><title>基金项目</title><p>国家自然科学基金(11971303，11871330)。</p></sec><sec id="s11"><title>文章引用</title><p>蘧静雪,赵岩斌,徐文瀚. 线性延时系统的参数辨识及其在电路模型中的应用Parameter Identification of Linear Delay System and Its Application in Circuit Model[J]. 理论数学, 2021, 11(03): 346-356. https://doi.org/10.12677/PM.2021.113046</p></sec><sec id="s12"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.41237-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Ljung, L. (2002) System Identification: Theory for the User. Tsinghua University Press, Beijing.</mixed-citation></ref><ref id="hanspub.41237-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">马皓, 毛兴云, 徐德鸿. 基于混杂系统模型的DC/DC电力电子电路参数辨识[J]. 中国电机工程学报, 2005, 25(10): 50-54.</mixed-citation></ref><ref id="hanspub.41237-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Astrom, K.J. and Eykhoff, P. (1971) System Identification—A Survey. Automatica, 7, 123-162.  
&lt;br&gt;https://doi.org/10.1016/0005-1098(71)90059-8</mixed-citation></ref><ref id="hanspub.41237-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">方崇智, 萧德云. 过程辨识[M]. 北京: 清华大学出版社, 1988.</mixed-citation></ref><ref id="hanspub.41237-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">吴小慧, 张兴敢. 锂电池二阶RC等效电路模型参数辨识[J]. 南京大学学报(自然科学), 2020, 56(5): 754-761.</mixed-citation></ref><ref id="hanspub.41237-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">荀倩, 王培良, 李祖欣, 蔡志端, 秦海鸿. 基于递推最小二乘法的永磁伺服系统参数辨识[J]. 电工技术学报, 2016, 31(17): 161-169.</mixed-citation></ref><ref id="hanspub.41237-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">韩伟, 王宏华, 王成亮, 陈凌, 张经炜, 孙蓉. 基于参数辨识的光伏组件故障诊断模型[J]. 电网技术, 2015, 39(5): 1198-1204.</mixed-citation></ref><ref id="hanspub.41237-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">张旭辉, 林海军, 刘明珠, 高豹江. 基于蚁群粒子群优化的卡尔曼滤波算法模型参数辨识[J]. 电力系统自动化, 2014, 38(4): 44-50.</mixed-citation></ref><ref id="hanspub.41237-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">胡海岩, 王在华. 非线性时滞动力系统的研究进展[J]. 力学进展, 1999, 29(4): 501-501.</mixed-citation></ref><ref id="hanspub.41237-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">赵宁, 孟新柱. 一类具有时滞的随机SIS传染病模型[J]. 应用数学, 2018, 128(1): 220-224.</mixed-citation></ref><ref id="hanspub.41237-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Yue, D. and Han, Q.L. (2004) A Delay-Dependent Stability Criterion of Neutral Systems and Its Application to a Partial Element Equivalent Circuit Model. IEEE Transactions on Circuits and Systems II: Express Briefs, 51, 685-689.  
&lt;br&gt;https://doi.org/10.1109/TCSII.2004.837286</mixed-citation></ref><ref id="hanspub.41237-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Han, W. and Liu, M. (2011) Stability and Bifurcation Analysis for a Discrete-Time Model of Lotka-Volterra Type with Delay. Applied Mathematics and Computation, 217, 5449-5457. &lt;br&gt;https://doi.org/10.1016/j.amc.2010.12.014</mixed-citation></ref><ref id="hanspub.41237-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Bélair, J., Campbell, S.A. and van den Driessche, P. (1996) Frustration, Stability, and Delay-Induced Oscillations in a Neural Network Model. SIAM Journal on Applied Mathematics, 56, 245-255.  
&lt;br&gt;https://doi.org/10.1137/S0036139994274526</mixed-citation></ref><ref id="hanspub.41237-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Zhou, B., Li, Z.Y., Zheng, W.X. and Duan, G.R. (2012) Stabi-lization of Some Linear Systems with Both State and Input Delays. Systems &amp; Control Letters, 61, 989-998. &lt;br&gt;https://doi.org/10.1016/j.sysconle.2012.07.006</mixed-citation></ref><ref id="hanspub.41237-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Gawthrop, P.J. and Nihtil, M.T. (1985) Identification of Time Delays Using a Polynomial Identification Method. Systems &amp; Control Letters, 5, 267-271. &lt;br&gt;https://doi.org/10.1016/0167-6911(85)90020-9</mixed-citation></ref><ref id="hanspub.41237-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Danilevich, E.V., Evstratov, A.R., Kukharenko, N.I., Ovcharenko, V.N. and Poplavskii, B.K. (2018) Identification of Constant Parameters of Dynamic Systems by a Time-Frequency Method. Journal of Computer and Systems Sciences International, 57, 495-504. &lt;br&gt;https://doi.org/10.1134/S1064230718040068</mixed-citation></ref><ref id="hanspub.41237-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Sung, S.W. and Lee, I.B. (2013) Prediction Error Identification Method for Continuous-Time Processes with Time Delay. Industrial &amp; Engineering Chemistry Research, 40, 5743-5751. &lt;br&gt;https://doi.org/10.1021/ie0100636</mixed-citation></ref><ref id="hanspub.41237-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Orlov, Y., Belkoura, L., Richard, J.P. and Dambrine, M. (2003) Adaptive Identification of Linear Time-Delay Systems. International Journal of Robust and Nonlinear Control, 13, 857-872. &lt;br&gt;https://doi.org/10.1002/rnc.850</mixed-citation></ref><ref id="hanspub.41237-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Ren, X., Rad, A., Chan, P. and Lo, W.L. (2005) Online Identification of Continuous-Time Systems with Unknown Time Delay. IEEE Transactions on Automatic Control, 50, 1418-1422. &lt;br&gt;https://doi.org/10.1109/TAC.2005.854640</mixed-citation></ref><ref id="hanspub.41237-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Dong, S., Liu, T. and Chen, F. (2015) Iterative Identification of Output Error Model with Time Delay. IFAC-PapersOnLine, 48, 888-893. &lt;br&gt;https://doi.org/10.1016/j.ifacol.2015.09.082</mixed-citation></ref></ref-list></back></article>