<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2019.96119</article-id><article-id pub-id-type="publisher-id">CSA-30811</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20190600000_46990344.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于卷积神经网络的宠物识别
  Pet Recognition Based on Convolutional Neural Network
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>伟</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>于</surname><given-names>显驰</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>徐</surname><given-names>泽堃</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>华</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>覃</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>东北林业大学，黑龙江 哈尔滨</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>18</day><month>06</month><year>2019</year></pub-date><volume>09</volume><issue>06</issue><fpage>1055</fpage><lpage>1060</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   宠物在人们的生活当中，已经变成了人们日常生活不可分割的一部分，越来越多的人会去饲养宠物，伴随着人们智能化的不断提升，智能家居的全面发展，也对于宠物的管理提出了更高的要求，所以对于宠物识别技术的研究也有着很高的实际意义。该文提出一种基于神经网络的实时宠物识别，技术路线，使用Opencv，Pycharm，Python，采用神经网络的宠物面部监测和分类功能。对实时采集到的宠物图片进行处理，与训练好的模型进行比对，克服了以前宠物识别效率低下，成功率低等问题。 Pets have become an integral part of people’s daily life. More and more people will raise pets. With the continuous improvement of people’s intelligence and the comprehensive development of smart home, pet management also puts forward higher requirements, so the research of pet recognition technology has high practical significance. This paper presents a real-time pet recognition technology based on neural network, which uses Opencv, Pycharm, Python and neural network to monitor and classify pet faces. The PET images collected in real time are processed and compared with the trained models, which overcomes the problems of low efficiency and low success rate of pet recognition in the past. 
  
 
</p></abstract><kwd-group><kwd>宠物识别，神经网络，智能家, Pet Identification</kwd><kwd> Neural Network</kwd><kwd> Smart Home</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于卷积神经网络的宠物识别<sup> </sup></title><p>赵伟，于显驰，徐泽堃，郭华，李覃</p><p>东北林业大学，黑龙江 哈尔滨</p><p><img src="//html.hanspub.org/file/3-1541430x1_hanspub.png" /></p><p>收稿日期：2019年5月31日；录用日期：2019年6月11日；发布日期：2019年6月18日</p><disp-formula id="hanspub.30811-formula34"><graphic xlink:href="//html.hanspub.org/file/3-1541430x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>宠物在人们的生活当中，已经变成了人们日常生活不可分割的一部分，越来越多的人会去饲养宠物，伴随着人们智能化的不断提升，智能家居的全面发展，也对于宠物的管理提出了更高的要求，所以对于宠物识别技术的研究也有着很高的实际意义。该文提出一种基于神经网络的实时宠物识别，技术路线，使用Opencv，Pycharm，Python，采用神经网络的宠物面部监测和分类功能。对实时采集到的宠物图片进行处理，与训练好的模型进行比对，克服了以前宠物识别效率低下，成功率低等问题。</p><p>关键词 :宠物识别，神经网络，智能家</p><disp-formula id="hanspub.30811-formula35"><graphic xlink:href="//html.hanspub.org/file/3-1541430x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/3-1541430x7_hanspub.png" /> <img src="//html.hanspub.org/file/3-1541430x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>智能门禁系统已经被证明是智慧城市建设不可或缺的一部分，对于物体的识别技术在门禁系统中又扮演着极其重要的角色，例如：智能停车场系统中的车牌识别技术应用，火车站出入口人脸识别检测技术，并且已经在社区管理、学校考勤、科技园区等领域得到广泛的应用 [<xref ref-type="bibr" rid="hanspub.30811-ref1">1</xref>] 。我们将其应用在对于宠物的智能管理上，提高对于宠物的管理效能。我们通过使用Opencv软件，对视频流进行截取，对截取图片当中的宠物，使用MobileNet-SSD神经网络进行对于宠物的识别，训练集采用Kaggle开源的猫狗数据集，大大提高了识别的准确率。</p></sec><sec id="s4"><title>2. 宠物识别过程</title><sec id="s4_1"><title>2.1. 视频流截取宠物图片</title><p>对于动态视频流数据处理可以转化为静态图像帧的处理，这样就可以在不改变图像模型的情况下实现对视频流的处理工作 [<xref ref-type="bibr" rid="hanspub.30811-ref2">2</xref>] 。这里我们用到opencv，使用Python语言开发具有高效性，</p><p>得益于其丰富的第三方库，Python能够将其他语言制作的模块快速轻松地连接在一起。本文所使用的OpenCV就是可以通过Python语言进行调用的一个第三方视觉库。Open CV于1999年由Intel创立至今经过多年的发展已经成为当今计算机视觉领域一款功能强大且通用的图像视觉处理库。使用opencv自带的videocapture()函数定义摄像头对象，本实验调用的是笔记本的内置摄像头，在while循环中，利用摄像头对象read()函数读取视频的每一帧。截取图像过程如图1所示：</p><p>图1. 截取图像过程</p><p>截取图片结果如图2所示。</p></sec><sec id="s4_2"><title>2.2. MobileNet-SSD神经网络</title><p>Mobilenet主要是为了适用于移动端而提出的一种轻量级深度网络模型 [<xref ref-type="bibr" rid="hanspub.30811-ref3">3</xref>] 。主要使用了深度可分离卷积将表捉卷积核进行分解计算，引入了两个超参数去减少计算量，这两个超参数是宽度乘数和分辨率乘数。</p><p>深度可分离卷积是将一个标准的卷积核分成深度卷积核和1*1的点卷积核，假设输入为M个通道的featuremap，卷积核大小为D<sup>k</sup>*D<sup>k</sup>，输出通道为N，那么标准卷积核即为M*D<sup>K</sup>*D<sup>K</sup>*N。例如，输入feature map为m*n*16，想输出32通道，那么卷积核应为16*3*3*32，则可以分解为深度卷积：16*3*3得到的</p><p>图2. 截取图片结果</p><p>是16通道的特征图谱。点卷积为16*1*1*32，如果用标准卷积，则计算量为：m*n*16*3*3*32 = m*n*4608。用深度可分解卷积之后的计算量为m*n*16*3*3 + m*n*16*1*1*32 = m*n*656，一共有28层(深度卷积和点卷积单独算一层)，每层后面都跟有batchnorm层和relu层。深度可分解卷积操作示意图如下图3所示。</p><p>图3. 深度可分解卷积操作示意图</p></sec><sec id="s4_3"><title>2.3. 宠物特征提取</title><p>神经网络每一层生成的新的神经节点作为新的特征输入下一层，从而能够处理较复杂的任务，但是处理图像分类的任务时，一副图像的每一个像素点都是输入层的一个特征，都需要一个独立的权重，如果使用多层的神经网络，由于权重过多，不仅训练花费时间极高，而且对内存一会产生加大的消耗 [<xref ref-type="bibr" rid="hanspub.30811-ref4">4</xref>] 。</p><p>生物学家通过对动物大脑的研究发现动物识别物体时会从简单的线条开始逐步抽象出更高层次的物体，受此启发，计算机科学家发明了一种卷积神经网络的算法，对图像从最简单的线条开始识别，逐步识别出更复杂的目标物体 [<xref ref-type="bibr" rid="hanspub.30811-ref5">5</xref>] 。例如要识别下图中的金毛，在眼睛鼻子首位先提取出一些曲线最为第一层的输出，第二层组合这些曲线继续提取特征，根据一条曲线和两个鼻孔提取出鼻子的特征输出到下一层，继续组合和提取特征，在最后一层组合眼睛，鼻子等特征识别出金毛。特征提取如图4所示。</p><p>卷积将相邻的像素当作一个集合进行处理，这就是卷积和非卷积神经网络的区别，卷积神经网络使用滤波器提取图像的局部特征，这更复合人们的认知，因为一副图像的局部像素的相关性更加紧密，例如上图提取鼻子的特征时，只需要整幅图像的中间的一部分像素，而其他像素都为干扰项，非卷积网络的每一层特征都会影响下一层特征的提取，于是增加了很多干扰项，降低了特征提取的准确度。</p><p>图4. 特征提取图</p></sec><sec id="s4_4"><title>2.4. 训练数据集</title><p>MobileNet-SSD训练时候导入的图片大小是300 &#215; 300 &#215; 3，前面两个数据分别是图片呢的宽和高，第三个数据是图片的通道数，RGB，是三个维度。经过第一个卷积层得到的是150 &#215; 150 &#215; 32，也就是将原来的三个维度扩大成了32个维度，或者简单来说，将原来3个高扩大成了32个高 [<xref ref-type="bibr" rid="hanspub.30811-ref6">6</xref>] 。具体看一下实现的过程。MobileNet-SSD网络结构图如图5所示：</p><p>图5. MobileNet-SSD网络结构图</p><p>这是第一个卷积层里面的参数，看主要的数据kernel size = 3，也就是使用了3 &#215; 3的filter (滤波器) stride = 2每一个filter移动的步长是2，向右移动的时候一次移动两个像素，举例来说，filter的左上角的位置原来在从左向右数的第一个位置，移动之后，就变成了第三个位置，同理向下移动的时候也是这样的 [<xref ref-type="bibr" rid="hanspub.30811-ref7">7</xref>] 。卷积层参数图如下图6所示：</p><p>图6. 卷积层参数图</p><p>下图7就是移动以后得到的stride = 2时候的图像，经过卷积之后再经过一个激活函数relu，经过这样一次的对图像的滤波，最后可以得到想要的高维度的数据，但这个神经网络和其他的有些不一样，这个detections得到6个高维度数据，不仅仅是对最后的高维度的数据处理，这样的好处是，使得整个网络更加准确，而且速度较快。和yolo进行比较，这个的准确度可能达不到yolo的探测水平，我在做实时行人检测的时候，yolo的识别效果会更好，但是yolo的缺点就是速度太慢，根据你项目的需要，如果是实时检测猫狗的话，必然要选择MobileNet-SSD，这个网路根据名称可以看出，是由MobileNet进化而来的。</p><p>图7. Stride = 2时候的图像</p></sec></sec><sec id="s5"><title>3. 实验结果及分析</title><p>根据现在中国的宠物饲养现状，大部分人饲养的都是猫狗类的宠物，所以训练集采用的是2013年kaggle公开的猫狗大战训练集，其中有猫类图片12,500张，有狗类图片12,500张大大满足了我们对于训练集的要求。为了防止过拟合现象的发生，我们采用了验证集的方法提高识别的准确率。验证集主要是测试当前网络采用的一些超参数是否合理，利用validation-based early stopping (提前停止训练)机制来防止过拟合。不要认为模型中有了验证集，它自己就会提早停止。测试集是在全部模型训练好之后拿来测试的，在模型的构建中不能用测试集的任何信息。而为了防止过拟合，我们需要选取一些数据验证下模型的泛化能力，因此验证集不能与训练集有重合。宠物识别结果如下图8所示：</p><p>图8. 宠物识别结果图</p></sec><sec id="s6"><title>4. 结论与展望</title><p>本文介绍了一种基于卷积神经网络的宠物识别方法，通过对网络的训练来调整参数，实验验证了本文算法具有较高的识别率，为相关需求领域提供了一种简单易行的小成本宠物识别解决方案。由于实验设备与时间的限制，本文所提出的方法考虑到算法的实时性，利用MobileNet神经网络架构大大减少了识别的时间，尽管如此，识别所需的时间仍然无法与实时的要求相适应。在识别宠物的广度上也略有不足。希望在日后的学习中能够让这些问题得到解决。</p></sec><sec id="s7"><title>文章引用</title><p>赵 伟,于显驰,徐泽堃,郭 华,李 覃. 基于卷积神经网络的宠物识别Pet Recognition Based on Convolutional Neural Network[J]. 计算机科学与应用, 2019, 09(06): 1055-1060. https://doi.org/10.12677/CSA.2019.96119</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.30811-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">徐亚伟, 杨会成. 基于多层特征深度融合的卷积神经网络人脸识别方法[J]. 平顶山学院学报, 2019, 34(2): 53-58.</mixed-citation></ref><ref id="hanspub.30811-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">薛艳杰, 邓燕妮. 基于改进卷积神经网络的人脸识别研究[J]. 科技风, 2019(11): 106+131.  
竺可桢. 物理学[M]. 北京: 科学出版社, 1973: 1-3.</mixed-citation></ref><ref id="hanspub.30811-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">张翠芳, 金天恺, 苏博艺, 龙芳, 呼亚楠, 谢兰欣. 基于残差神经网络的人脸识别及仿真平台[J]. 徐州工程学院学报(自然科学版), 2019, 34(1): 33-37.</mixed-citation></ref><ref id="hanspub.30811-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">秦维, 张轩雄. 基于ARM与图像识别的宠物疾病预测系统研究与设计[J]. 电子测量技术, 2018, 41(7): 95-98.</mixed-citation></ref><ref id="hanspub.30811-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">范安宇, 包乾辉, 郑一超, 杨毅刚, 余亦锴. 基于卷积神经网络的人脸识别系统[J]. 电脑编程技巧与维护, 2019(1): 110-112.</mixed-citation></ref><ref id="hanspub.30811-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">刘子山. 人脸信息识别技术研究及在虚拟宠物上的应用[D]: [硕士学位论文]. 南京: 南京邮电大学, 2013.</mixed-citation></ref><ref id="hanspub.30811-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">王慧, 介龙梅. 基于多传感器/目标识别的电子宠物视觉系统[J]. 计算机工程, 2009, 35(11): 178-180.</mixed-citation></ref></ref-list></back></article>