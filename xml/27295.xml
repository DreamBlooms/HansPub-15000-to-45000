<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">DSC</journal-id><journal-title-group><journal-title>Dynamical Systems and Control</journal-title></journal-title-group><issn pub-type="epub">2325-677X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/DSC.2018.74035</article-id><article-id pub-id-type="publisher-id">DSC-27295</article-id><article-categories><subj-group subj-group-type="heading"><subject>DSC20180400000_11967699.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于PLC的非线性水箱的预测控制研究
  Research on Predictive Control of Nonlinear Water Tank Based on PLC
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>刚</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>宝林</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>华</surname><given-names>山</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>马</surname><given-names>平</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>马</surname><given-names>青鹏</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>冠甫</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>国电科学技术研究院有限公司，江苏 南京</addr-line></aff><aff id="aff5"><addr-line>华北电力大学(保定)，河北 保定 </addr-line></aff><aff id="aff2"><addr-line>国电科学技术研究院有限公司，江苏 南京 </addr-line></aff><aff id="aff4"><addr-line>华北电力大学(保定)，河北 保定</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>06</day><month>09</month><year>2018</year></pub-date><volume>07</volume><issue>04</issue><fpage>310</fpage><lpage>317</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    工业生产过程往往是一个大惯性、大迟延、非线性的控制对象，常规的PID控制很难达到良好的控制效果；预测控制的提出，可以有效地解决非线性、大迟延、大惯性的问题。本文选取典型的工业过程对象即非线性水箱进行预测控制的研究。在进行水箱试验前，需要在MATLAB上进行对象模型的辨识，以及必要参数的预整定。经实验结果表明，有约束预测控制算法在控制品质和调节时间上是优于传统的PID控制的，且该算法的鲁棒性能良好。
    The industrial production process is often a large inertia, large delay, and nonlinear control object. It is difficult to achieve good control effect by conventional PID control. The prediction control can effectively solve the problems of nonlinearity, large delay and large inertia. This paper selects the typical industrial process object, namely the nonlinear water tank for predictive control research. Before the tank test, it is necessary to identify the object model and pre-define the necessary pa-rameters on MATLAB. The experimental results show that the constrained predictive control al-gorithm is superior to the traditional PID control in terms of control quality and adjustment time, and the robust performance of the algorithm is good. 
  
 
</p></abstract><kwd-group><kwd>预测控制，DMC，有约束预测控制，非线性水箱，PLC, Predictive Control</kwd><kwd> DMC</kwd><kwd> Constrained Predictive Control</kwd><kwd> Nonlinear Water Tank</kwd><kwd> PLC</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于PLC的非线性水箱的预测控制研究<sup> </sup></title><p>陈刚<sup>1</sup>，陈宝林<sup>1</sup>，华山<sup>1</sup>，马平<sup>2</sup>，马青鹏<sup>2</sup>，刘冠甫<sup>2</sup></p><p><sup>1</sup>国电科学技术研究院有限公司，江苏 南京</p><p><sup>2</sup>华北电力大学(保定)，河北 保定</p><p><img src="//html.hanspub.org/file/8-2740189x1_hanspub.png" /></p><p>收稿日期：2018年10月3日；录用日期：2018年10月19日；发布日期：2018年10月26日</p><disp-formula id="hanspub.27295-formula55"><graphic xlink:href="//html.hanspub.org/file/8-2740189x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>工业生产过程往往是一个大惯性、大迟延、非线性的控制对象，常规的PID控制很难达到良好的控制效果；预测控制的提出，可以有效地解决非线性、大迟延、大惯性的问题。本文选取典型的工业过程对象即非线性水箱进行预测控制的研究。在进行水箱试验前，需要在MATLAB上进行对象模型的辨识，以及必要参数的预整定。经实验结果表明，有约束预测控制算法在控制品质和调节时间上是优于传统的PID控制的，且该算法的鲁棒性能良好。</p><p>关键词 :预测控制，DMC，有约束预测控制，非线性水箱，PLC</p><disp-formula id="hanspub.27295-formula56"><graphic xlink:href="//html.hanspub.org/file/8-2740189x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/8-2740189x7_hanspub.png" /> <img src="//html.hanspub.org/file/8-2740189x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着人们对工业生产过程的控制要求越来越高，工程师们除了在系统辨识、鲁棒控制、自适应控制、模型简化等方面寻求突破外，还开始尝试寻找一些新的控制思路。因此，预测控制并不是从某种理论衍生推导出的产物，而是直接来源于工业生产实践 [<xref ref-type="bibr" rid="hanspub.27295-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.27295-ref2">2</xref>] 。</p><p>本文首先对物理实验平台的非线性水箱进行了分析和实验，获得了流量——水位的飞升曲线，并在MATLAB上进行了辨识，获取了不同水位工作点下对象模型参数；考虑PLC控制器存储空间有限等问题对预测控制算法编程进行了优化，A3030型艾默生的非线性水箱这种典型的工业过程模型作为控制对象。设计了PLC实现非线性水箱水位预测控制系统；通过预测控制与PID的对比试验研究，从调节时间快慢，超调量，鲁棒性等方面验证了预测控制对非线性水箱控制的可实现性和优越性。</p></sec><sec id="s4"><title>2. 动态矩阵控制(DMC)</title><sec id="s4_1"><title>2.1. 基本原理介绍</title><p>动态矩阵控制(DMC)是一种基于阶跃响应的，并采用控制增量的算法。DMC的优越之处在于控制中加有积分环节，可以有效地消除系统的静态误差 [<xref ref-type="bibr" rid="hanspub.27295-ref3">3</xref>] 。</p><p>DMC算法包含三个部分：预测模型、滚动优化、反馈校正 [<xref ref-type="bibr" rid="hanspub.27295-ref4">4</xref>] 。其算法流程图如图1所示。</p></sec><sec id="s4_2"><title>2.2. 基于黄金分割法的有约束预测控制器设计</title><p>在实际的工业控制过程中，执行器的输出都是带有约束的，即输出范围只能在0%~100%之间，因此，在工业环境下设计控制器时，考虑输出约束后，动态矩阵控制简化算法的控制增量就会发生变化。本文采用黄金分割法设计有约束的预测控制器， Δ u ( k ) 的最优值计算将在有约束的条件下进行。</p><sec id="s4_2_1"><title>2.2.1. 黄金分割算法介绍</title><p>黄金分割算法是一种非常适合求解一维函数在 [ a , b ] 区间内的极值问题的经典算法。其主要的求解思想是沿着某一个已知的方向，通过“优胜劣汰”的原则逐步地缩小搜索区间，然后逐步逼近优化问题的最优值 [<xref ref-type="bibr" rid="hanspub.27295-ref5">5</xref>] 。</p><p>黄金分割法具体的计算步骤为：</p><p>(1) 确定收敛精度 ε ；</p><p>(2) 从 [ a , b ] 区间内选择 r 1 , r 2 ( r 1 &lt; r 2 ) 两点，然后将 [ a , b ] 分成三段；</p><p>图1. 无约束动态矩阵控制算法流程图</p><p>(3) 判断 f ( r 1 ) 和 f ( r 2 ) 的大小，若 f ( r 1 ) &gt; f ( r 2 ) ，则收敛区间则需要更新：</p><p>a = r 1</p><p>r 1 = r 2</p><p>r 2 = a + 0.618 &#215; ( b − a )</p><p>若 f ( r 1 ) &gt; f ( r 2 ) ，则收敛区间的更新公式为：</p><p>b = r 2</p><p>r 2 = r 1</p><p>r 1 = a + 0.382 &#215; ( b − a )</p><p>(4) 若 b − a a &lt; ε 则停止迭代，极值点为 a + b 2 ，函数的极值为 f ( a + b 2 ) ；否则，返回步骤(3)继续迭代。</p></sec><sec id="s4_2_2"><title>2.2.2. 基于黄金分割法的有约束预测控制器设计</title><p>设计有约束的控制器时，选取约束目标函数为 [<xref ref-type="bibr" rid="hanspub.27295-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.27295-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.27295-ref8">8</xref>] ：</p><p>min J ( k ) = ‖ w p ( k ) − y ˜ p 0 ( k ) − A 2 Δ u ( k ) ‖ Q 2 + H T R H Δ u 2 ( k )</p><p>在线求解 Δ u ( k ) 最优值的问题定义式为：</p><p>Δ u ( k ) = arg min J ( Δ u ( k ) ) s . t . Δ u ( k + i ) ∈ [ Δ u min , Δ u max ] , Δ u min &lt; 0 , Δ u max &gt; 0 u ( k + i ) ∈ [ u min , u max ] , u min ≥ 0 , Δ u max &gt; 0 Δ u ( k + i ) = γ i Δ u ( k ) , 1 ≤ i ≤ M − 1</p><p>由上述公式作简单的推导可以得到如下的关系：</p><p>u ( k ) = Δ u ( k ) + u ( k − 1 ) u ( k + 1 ) = γ Δ u ( k ) + Δ u ( k ) + u ( k − 1 ) u ( k + M − 1 ) = R i Δ u ( k ) + u ( k − 1 )</p><p>其中， R i = ∑ γ i</p><p>结合上述 Δ u ( k ) 的两个约束条件，通过推导，可以得到最终的约束范围是：</p><p>Δ u ( k ) ∈ { [ max ( Δ u min , u min − u ( k − 1 ) R M − 1 ) , min x ( Δ u max , u max − u ( k − 1 ) R M − 1 ) ] , γ &lt; 1 [ max ( Δ u min γ M − 1 , u min − u ( k − 1 ) R M − 1 ) , min x ( Δ u max γ M − 1 , u max − u ( k − 1 ) R M − 1 ) ] , γ ≥ 1 }</p><p>根据上述得到的 Δ u ( k ) 的约束范围，即可在设定的 [ a 1 ( t ) , b 1 ( t ) ] 区间内进行最优值搜索求解。则基于黄金分割法和集结优化的有约束预测控制算法流程图如图2所示。</p></sec></sec></sec><sec id="s5"><title>3. MATLAB仿真实例</title><sec id="s5_1"><title>3.1. 控制对象的辨识及参数的获取</title><p>以实验室的A3030型艾默生的非线性水箱为控制对象，通过调节控制阀，观察水位的变化情况，当水位趋于稳定不在发生变化时，此时可以通过系统自带的数据采集工具，截取实时趋势曲线中，变化较</p><p>图2. 基于黄金分割法的有约束预测控制算法流程图</p><p>为明显的一段。图3为水箱在阀门扰动下得到的飞升曲线，图3中，经过去坏点、初始值归零化等处理后，通过热工遗传算法辨识可以得到该水箱的传递函数为：</p><p>G ( s ) = 3.7766 ( 52.676 s + 1 ) 2</p></sec><sec id="s5_2"><title>3.2. DMC算法和PID算法的比较</title><p>在MATLAB平台上对已知的被控对象进行常规的PID优化和DMC优化。</p><p>运用DMC算法对该模型进行优化，选取参数如下：</p><p>模型时域： N = 200</p><p>预测时域： P = 200</p><p>控制时域：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/8-2740189x42_hanspub.png" xlink:type="simple"/></inline-formula></p><p>选取： γ = 0.5</p><p>设定区间 u ∈ [ − 6 , 6 ] ; Δ u ∈ [ − 16 , 16 ]</p><p>由图4可知，① 号曲线为DMC算法优化后的曲线；② 号曲线为PID算法整定后的曲线。通过曲线的对比，可以得到DMC算法对被控对象的调节效果和品质远高于常规的PID控制，集中体现在DMC算法无超调，且调节时间远快于PID算法，所以，可以得出，DMC算法在控制策略和控制品质上是优于PID控制的。</p><p>图3. 阀门扰动下非线性水箱的飞升曲线</p><p>图4. 仿真结果</p></sec></sec><sec id="s6"><title>4. 基于PLC的水箱控制试验</title><sec id="s6_1"><title>4.1. 实验设备介绍</title><p>A3030型艾默生过程自动化实训系统通过实际流体(自来水)的流量控制和液位控制来模拟对实际对象的控制和设备管理，它充分展示了DCS分散控制功能，体现了控制系统和现场仪表间的协同运作能力以及在PID回路之外建立设备管理平台为用户带来预诊断功能的先进理念，由于上水箱是一个圆筒状模型，一个具有典型非线性特征的对象，可以模拟很多实际工业过程被控对象。</p><p>现场设备包括：压力变送器、温度变送器、流量变送器、分析仪表，无线振动变送器，阀门、阀门定位器等。实验室项目融合了当前先进的各类通讯模式：HART、FF (基金会现场总线)以及Wireless Hart 智能无线通讯协议。被控对象的实物图如图5。</p></sec><sec id="s6_2"><title>4.2. 实验流程及实例</title><p>OVATION是美国开发的新型分散控制系统，它既包含过程控制技术，又吸收了企业管理信息技术，系统在硬件上采用了速度快、容量大的设备，保证系统的高性能运行；通讯网络使用标准的以太网，可靠性高、速度快、开放性高，提升其多任务、多数据的工作能力。</p><p>本次实验以单容水箱为被控对象。通过第二章的黄金分割算法的计算，可以得到的所需的模型参数 a [ i ] ( i = 1 ⋯ N ) 和控制器增量系数 d t 。将PLC中的程序初始化后赋值。然后将PLC与DCS立柜进行通讯连接，在Ovation系统上进行必要的通信点的配置和逻辑图的搭建。水箱水位的控制趋势图可以通过自带软件获取。本次实验总体流程如图6。</p><p>图7中A曲线为水位变化趋势，B曲线为控制器变化趋势。实验截取了其中10分钟的水位趋势变化图，可以看出①时刻水位能够在极短的时间内稳定下来；在稳定后的5分钟也就是②时刻通过改变出水口的插槽，从而改变对象的模型，来观察该算法的鲁棒性。通过实验可以看出，DMC算法确实能够提高系统的控制品质，集中体现在调节时间加快，超调量低，还可以看出该算法的鲁棒性良好。</p><p>无论是从第二节的仿真研究还是第三节的实验来看，通过对比可以看出：针对大迟延、大惯性、非线性的对象，从控制的品质来讲，都是DMC算法优于PID控制策略，集中体现在系统的调节时间加快、超调量降低、鲁棒性增强。</p><p>图5. A3030工艺流程系统物理实验平台</p><p>图6. 实验流程图</p><p>图7. 水箱水位控制趋势图</p></sec></sec><sec id="s7"><title>5. 结论</title><p>本文首先系统分析了预测控制中DMC算法的主要过程，并提出了一种基于黄金分割算法的有约束的预测控制器设计；其次对A3030工艺流程设备进行了简要的介绍。主要完成了在MATLAB平台上对DMC算法和PID算法进行调试，通过对被控对象的调节，可以看出，所选的DMC算法在控制品质上是优于传统的PID算法。为了进一步实现DMC算法，我们将利用PLC和A3030的非线性水箱上模拟控制大迟延系统的物理实验。通过试验可以验证出DMC算法确实可以提高系统的控制品质，且该算法的鲁棒性也较好。有比较深远的意义和推广价值，未来应更进一步革新和改善DMC算法，以达到更优的品质。</p></sec><sec id="s8"><title>文章引用</title><p>陈 刚,陈宝林,华 山,马 平,马青鹏,刘冠甫. 基于PLC的非线性水箱的预测控制研究Research on Predictive Control of Nonlinear Water Tank Based on PLC[J]. 动力系统与控制, 2018, 07(04): 310-317. https://doi.org/10.12677/DSC.2018.74035</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.27295-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">石宇静. 复杂工业过程模型预测控制的研究[D]. 沈阳: 东北大学, 2009.</mixed-citation></ref><ref id="hanspub.27295-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">徐祖华. 模型预测控制理论及应用研究[D]. 杭州: 浙江大学, 2004.</mixed-citation></ref><ref id="hanspub.27295-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">席裕庚. 预测控制[M]. 第二版. 国防工业出版社, 2013: 2-3.</mixed-citation></ref><ref id="hanspub.27295-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">席裕庚, 李德伟, 林姝. 模型预测控制——现状与挑战[J]. 自动化学报, 2013(3): 222-236.</mixed-citation></ref><ref id="hanspub.27295-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">鲍荣, 何德峰, 郑凯华. 基于黄金分割法的阶梯式约束预测控制[J]. 上海交通大学学报, 2012, 46(12): 1940-1944.</mixed-citation></ref><ref id="hanspub.27295-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">陈薇, 吴刚, 阎镜予, 凌青, 郑涛. 阶梯式有约束非线性预测控制及其应用[J]. 系统仿真学报, 2007(18): 4226-4228+4234.</mixed-citation></ref><ref id="hanspub.27295-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">朱娜娜. 模型预测控制简化算法的研究[D]. 杭州: 浙江大学, 2011.</mixed-citation></ref><ref id="hanspub.27295-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">刘有飞, 吴刚, 魏衡华, 孙德敏. 阶梯式动态矩阵控制及在温度控制系统中的应用[J]. 中国科学技术大学学报, 2002(3): 92-97.</mixed-citation></ref></ref-list></back></article>