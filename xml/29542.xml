<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">GST</journal-id><journal-title-group><journal-title>Geomatics Science and Technology</journal-title></journal-title-group><issn pub-type="epub">2329-549X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/GST.2019.72011</article-id><article-id pub-id-type="publisher-id">GST-29542</article-id><article-categories><subj-group subj-group-type="heading"><subject>GST20190200000_17701639.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  不同质量图在卡尔曼滤波相位解缠中应用探讨
  The Study on Application of Different Quality Maps in Kalman Filter Phase Unwrapping
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>闫</surname><given-names>满</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>春华</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>潍坊学院传媒学院，山东 潍坊</addr-line></aff><pub-date pub-type="epub"><day>18</day><month>03</month><year>2019</year></pub-date><volume>07</volume><issue>02</issue><fpage>65</fpage><lpage>73</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  卡尔曼滤波将相位解缠转化为状态估计问题，实现相位解缠与噪声消除的一并处理。通过建立相位的动态方程和观测方程来求解真实相位，在常规方法中观测方程的噪声方差由相干图的值来确定。本文采用三种不同质量图的值来确定噪声方差，实施扩展卡尔曼滤波相位解缠算法。分别在地形平坦和陡峭两种条件下对InSAR数据进行实验，通过对解缠结果进行对比分析，表明对于地形陡峭数据应用相位导数方差图得到的结果较可靠，而地形平坦数据应用伪相干图能够得到较为精确的解缠结果。
   The Kalman Filter transforms the phase unwrapping problem into state estimate issue to deal with phase unwrapping and noise eliminating at the same time. The true phase is obtained through establishment of the dynamic equation and observation equation, noise variance of observation equation is determined by the value of coherence image in the original method. In this paper, noise variance is determined by three kinds of different quality maps, then the Extended Kalman Filter phase unwrapping is implemented, using InSAR data to do the experiment in the steep and flat terrain. Through comparing and analyzing the phase unwrapping results, it is verified that the result using phase derivative variance map is more reliable in the steep terrain, but in the flat terrain, the result using pseudo-coherence map is more precise.
 
</p></abstract><kwd-group><kwd>相位解缠，质量图，卡尔曼滤波，合成孔径雷达干涉测量, Phase Unwrapping</kwd><kwd> Quality Map</kwd><kwd> Kalman Filter</kwd><kwd> InSAR</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>不同质量图在卡尔曼滤波相位解缠中应用探讨<sup> </sup></title><p>闫 满，郭春华</p><p>潍坊学院传媒学院，山东 潍坊</p><p><img src="//html.hanspub.org/file/4-2840232x1_hanspub.png" /></p><p>收稿日期：2019年3月10日；录用日期：2019年3月25日；发布日期：2019年4月1日</p><disp-formula id="hanspub.29542-formula27"><graphic xlink:href="//html.hanspub.org/file/4-2840232x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>卡尔曼滤波将相位解缠转化为状态估计问题，实现相位解缠与噪声消除的一并处理。通过建立相位的动态方程和观测方程来求解真实相位，在常规方法中观测方程的噪声方差由相干图的值来确定。本文采用三种不同质量图的值来确定噪声方差，实施扩展卡尔曼滤波相位解缠算法。分别在地形平坦和陡峭两种条件下对InSAR数据进行实验，通过对解缠结果进行对比分析，表明对于地形陡峭数据应用相位导数方差图得到的结果较可靠，而地形平坦数据应用伪相干图能够得到较为精确的解缠结果。</p><p>关键词 :相位解缠，质量图，卡尔曼滤波，合成孔径雷达干涉测量</p><disp-formula id="hanspub.29542-formula28"><graphic xlink:href="//html.hanspub.org/file/4-2840232x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/4-2840232x7_hanspub.png" /> <img src="//html.hanspub.org/file/4-2840232x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>相位解缠是合成孔径雷达干涉测量数据处理的重要步骤之一。自Goldsterin等人在1988年提出所谓的枝切法以来，各种基于InSAR数据的相位解缠算法不断涌现，这些方法大致可以分为两大类。一类是路径跟踪算法 [<xref ref-type="bibr" rid="hanspub.29542-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref3">3</xref>] ，如Goldstein枝切法等。另一类是非路径跟踪算法 [<xref ref-type="bibr" rid="hanspub.29542-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref6">6</xref>] ，如最小LP范数法等。前者是一种局部算法，其优点是可以隔绝相位不连续点，阻止局部相位误差在整个积分区域的传播，计算速度较快，在相干性较好的区域可以获得精确的解缠相位，但是在强噪声条件下，很难获得最佳积分路径，容易造成误差传递或无法解缠的孤立区域。后者则是一种全局算法，其优点是运算稳定性好，不需要识别残差点。除了上述两大类算法外，利用最优估计算法如网络流模型 [<xref ref-type="bibr" rid="hanspub.29542-ref7">7</xref>] 、卡尔曼滤波模型 [<xref ref-type="bibr" rid="hanspub.29542-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref10">10</xref>] 等进行相位解缠也受到越来越多的关注。文献 [<xref ref-type="bibr" rid="hanspub.29542-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.29542-ref10">10</xref>] 采用卡尔曼滤波模型，将相位解缠转化为状态估计问题，通过建立相位的动态方程和观测方程求解真实相位，实现相位解缠与噪声消除的一并处理。</p><p>常规卡尔曼滤波相位解缠算法中观测方程的噪声方差由相干图的值确定，本文分别应用伪相干图、相位导数方差图和最大相位梯度图的值来确定噪声方差，采用扩展卡尔曼滤波进行相位解缠。在地形平坦和陡峭两种条件下对真实InSAR数据进行实验，通过对解缠结果进行对比分析，表明对于地形陡峭数据应用相位导数方差图得到的结果较可靠，而地形平坦数据应用伪相干图能够得到较为精确的解缠结果。</p></sec><sec id="s4"><title>2. 三种质量图</title><sec id="s4_1"><title>2.1. 伪相干图</title><p>当幅度值为单位值1时，伪相干图的值定义为：</p><p>| z m , n | = ( ∑ cos ψ i , j ) 2 + ( ∑ sin ψ i , j ) 2 k 2 (1)</p><p>式中k为视数， ψ i , j 是由干涉数据提取的干涉相位值。</p></sec><sec id="s4_2"><title>2.2. 相位导数方差图</title><p>相位导数方差图是描述相位梯度变化的图像，其值定义如下：</p><p>| r m , n | = ∑ ( Δ i , j x − Δ &#175; m , n x ) 2 + ∑ ( Δ i , j y − Δ &#175; m , n y ) 2 k 2 (2)</p><p>这里，点 ( i , j ) 在以点 ( m , n ) 为中心 k &#215; k 窗口内的取值， Δ i , j x 和 Δ i , j y 是相位偏导数， Δ &#175; m , n x 和 Δ &#175; m , n y 是相位偏导数在 k &#215; k 窗口内的均值。</p></sec><sec id="s4_3"><title>2.3. 最大相位梯度图</title><p>最大相位梯度图中值的定义为两个相位梯度值中的较大值：</p><p>| q m , n | = max { max { | Δ i , j x | } , max { | Δ i , j y | } } (3)</p><p>这里， Δ i , j x 和 Δ i , j y 是相位偏导数。</p></sec></sec><sec id="s5"><title>3. 卡尔曼滤波相位解缠基本原理</title><p>卡尔曼滤波的观测方程为：</p><p>y ( k ) = [ Re { z ( k ) a ( k ) } Im { z ( k ) a ( k ) } ] ≜ [ cos ( φ ( k ) ) sin ( φ ( k ) ) ] + [ v 1 ( k ) v 2 ( k ) ] = h ( φ ( k ) ) + v ( k ) (4)</p><p>式中， z ( k ) 表示复干涉， a ( k ) 表示观测干涉振幅， φ ( k ) 为真实相位， h ( ⋅ ) 为 y ( k ) 和 φ ( k ) 间的非线性映射。 v 1 ( k ) , v 2 ( k ) 为零均值高斯白噪声，其方差已知，应用质量图的值<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/4-2840232x31_hanspub.png" xlink:type="simple"/></inline-formula>来确定，即：</p><p>E { v ( k ) } = 0 ; E { v ( k ) v ( j ) T } = d i a g i = 1 , 2 [ 1 2 | γ | 2 − 1 2 ] δ ( k , j ) (5)</p><p>这里， δ ( k , j ) 为Kronecker函数。</p><p>卡尔曼滤波的状态空间模型为：</p><p>{ x ( k + 1 ) = A x ( k ) + u ( k ) u ( k ) = u ^ ( k ) + w ( k ) (6)</p><p>这里，A为给定状态空间模型的系统矩阵， u ( k ) ， u ^ ( k ) 分别表示真实相位梯度及相位梯度估计， 为估计误差。</p><p>卡尔曼滤波相位解缠的递推方程为：</p><p>{ x ^ k + 1 , k = A x ^ k , k + u ^ k , k P k + 1 , k = A P k , k A T + Q k , k x ^ k + 1 , k + 1 = x ^ k + 1 , k + J k + 1 r k + 1 , k + 1 P k + 1 , k + 1 = ( I − J k + 1 C k + 1 , k ) P k + 1 , k J k + 1 = P k + 1 , k C k + 1 , k T ( C k + 1 , k P k + 1 , k C k + 1 , k T + R k + 1 , k + 1 ) − 1 r k + 1 , k + 1 = y k + 1 , k + 1 − C k + 1 , k x ^ k + 1 , k C k + 1 , k = [ − sin ( x ^ k + 1 , k ) , cos ( x ^ k + 1 , k ) ] T (7)</p><p>式中， x ^ k + 1 , k 和 P k + 1 , k 分别表示预测值及其对应的方差阵， u ^ k , k 为相位梯度估计， Q k , k 为状态噪声方差阵， x ^ k + 1 , k + 1 和 P k + 1 , k + 1 分别表示状态估计及其对应的方差阵， J k + 1 是滤波增益矩阵， r k + 1 , k + 1 是残差， C k + 1 , k 表示线性化的观测矩阵。</p></sec><sec id="s6"><title>4. 实验结果与分析</title><sec id="s6_1"><title>4.1. 地形陡峭条件下的实验结果与分析</title><p>采用ENVISAT卫星分别在2003年12月3日和2004年 1 月 7 日 获取的2景伊朗Bam地区图像作为实验的主副图像，通过干涉、配准、去平地效应等处理后，从中选取地形起伏较大的部分干涉图(100像素 &#215; 100像素)如图1所示。图2~4分别为应用相位导数方差图、伪相干图和最大相位梯度图进行卡尔曼滤波相位解缠得到的结果。从解缠结果上看，伪相干图的解缠结果较差，最大相位梯度图和相位导数方差图均能得到较高精度的解缠相位。这是因为在地形比较陡峭的区域，伪相干图对梯度变化较为敏感，将坡度变化大的区域作为噪声区域处理，不能准确地进行相位解缠。图5为对应的三种质量图。</p><p>图1. 干涉图</p><p>图2. 相位导数方差解缠图</p><p>图3. 伪相干系数解缠图</p><p>图4. 最大相位梯度解缠图</p><p>图5. (a) 相位导数方差图；(b) 伪相干图；(c) 最大相位梯度图</p><p>由三种质量图解缠结果得到的不连续点图如图6所示。从图6可以看出，应用伪相干图的解缠结果在低质量相位区域出现了较多的不连续点，相位导数方法图和最大相位梯度图的不连续点分布大致相同，较好地消除了噪声。</p><p>图6. (a) 相位导数方差不连续点图；(b) 伪相干系数不连续点图；(c) 最大相位梯度不连续点图</p><p>下面从不连续点数目和ε值这两个方面对解缠的结果进行定量分析。ε值越小，解缠质量越高；不连续点数目越少，抗相位畸变的性能越好。从表1可以看出，在地形陡峭条件下，相位导数方差图解缠结果的不连续点数目明显少于其他两种方法，滤波效果优于最大相位梯度图和伪相干图，抗相位畸变性能较强。ε表达式 [<xref ref-type="bibr" rid="hanspub.29542-ref11">11</xref>] 为：</p><p>ε = 1 M N ∑ i = 0 M − 2 ∑ j = 0 N − 1 ω i , j x | ϕ i + 1 , j − ϕ i , j − Δ i , j x | p + 1 M N ∑ i = 0 M − 1 ∑ j = 0 N − 2 ω i , j y | ϕ i , j + 1 − ϕ i , j − Δ i , j x | p (8)</p><p>其中，M和N分别为列数和行数。 ϕ i , j 是点 ( i , j ) 处的解缠相位。 ω i , j x 和 ω i , j y 是与缠绕相位梯度 Δ i , j x 和 Δ i , j y 相对应的权重，而此权重一般由相位质量图给出，其值一般在0到1之间。p的取值通常有0，1，2。这里，p取1。从ε值来看，相位导数方差图解缠结果的解缠质量略高于最大相位梯度图和伪相干图，解缠结果较可靠。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Three quality maps phase unwrapping results’ number of discontinuous points and ε valu</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >质量图</th><th align="center" valign="middle" >不连续点数目</th><th align="center" valign="middle" >ε值</th></tr></thead><tr><td align="center" valign="middle" >相位导数方差图</td><td align="center" valign="middle" >73</td><td align="center" valign="middle" >1.35465</td></tr><tr><td align="center" valign="middle" >最大相位梯度图</td><td align="center" valign="middle" >90</td><td align="center" valign="middle" >1.35779</td></tr><tr><td align="center" valign="middle" >伪相干系数图</td><td align="center" valign="middle" >199</td><td align="center" valign="middle" >1.46335</td></tr></tbody></table></table-wrap><p>表1. 三种质量图相位解缠的不连续点数目和ε值表</p></sec><sec id="s6_2"><title>4.2. 地形平坦条件下的实验结果与分析</title><p>采用ENVISAT卫星分别在2005年1月30日和2005年3月6日获取的2景山东济宁地区图像作为实验的主副图像，经过干涉处理后取其地形较为平坦的干涉图(100像素 &#215; 100像素)如图7所示。</p><p>图7. 干涉图</p><p>三种质量图的解缠结果如图8~10所示。从解缠结果可以看出应用伪相干图进行卡尔曼滤波相位解缠可以得到比较精确的结果，最大相位梯度图和相位导数方差图得到的解缠结果较差，这是因为后两种质量图在进行相位解缠时将地形平坦数据表征为低质量区域，故得到可靠性较差的解缠结果。图11为与干涉图对应的三种质量图。</p><p>图8. 相位导数方差图解缠结果</p><p>图9. 伪相干图解缠结果</p><p>图10. 最大相位梯度图解缠结果</p><p>图11. (a) 相位导数方差图；(b) 伪相干系数图；(c) 最大相位梯度图</p><p>根据解缠结果得到的不连续点图如图12所示，从不连续点图可以看出在高质量区域三种解缠结果的不连续点分布大致相同；在低质量区域，伪相干图的不连续点分布略好于最大相位梯度图和相位导数方差图，说明伪相干图的滤波效果较好。</p><p>图12. (a) 相位导数方差不连续点图；(b) 伪相干系数不连续点图；(c) 最大相位梯度不连续点图</p><p>从表2可以看出，伪相干图解缠结果的不连续点数目明显少于最大相位梯度图和相位导数方差图，表明伪相干图消除噪声的能力较强；而ε值略低于相位导数方差图和最大相位梯度图，说明伪相干图解缠的精度较高。综合不连续点数目和ε值来看，对于地形较为平坦的数据，在没有相干图的情况下，首先应该选择伪相干图作为质量图。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Three quality maps phase unwrapping results’ number of discontinuous points and ε valu</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >质量图</th><th align="center" valign="middle" >不连续点数目</th><th align="center" valign="middle" >ε值</th></tr></thead><tr><td align="center" valign="middle" >最大相位梯度图</td><td align="center" valign="middle" >310</td><td align="center" valign="middle" >2.85625</td></tr><tr><td align="center" valign="middle" >伪相干系数图</td><td align="center" valign="middle" >260</td><td align="center" valign="middle" >2.80187</td></tr><tr><td align="center" valign="middle" >相位导数方差图</td><td align="center" valign="middle" >284</td><td align="center" valign="middle" >2.80483</td></tr></tbody></table></table-wrap><p>表2. 三种质量图相位解缠的不连续点数目和ε值表</p></sec></sec><sec id="s7"><title>5. 结论</title><p>应用三种质量图分别确定卡尔曼滤波相位解缠算法中的观测噪声方差，对地形陡峭和平坦两种条件下的InSAR实际数据进行相位解缠。解缠结果表明，不同的地形条件下选取的质量图也应不同。地形陡峭数据选取相位导数方差图作为质量图能够得到可靠的解缠结果，而地形平坦数据应用伪相干图得到的解缠结果较为精确。</p></sec><sec id="s8"><title>文章引用</title><p>闫满,郭春华. 不同质量图在卡尔曼滤波相位解缠中应用探讨 The Study on Application of Different Quality Maps in Kalman Filter Phase Unwrapping[J]. 测绘科学技术, 2019, 07(02): 65-73. https://doi.org/10.12677/GST.2019.72011</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.29542-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Xu, W. and Cumming, I. (1999) A Region-Growing Algorithm for InSAR Phase Unwrapping. IEEE Transactions on Geoscience and Remote Sensing, 37, 124-133. https://doi.org/10.1109/36.739143</mixed-citation></ref><ref id="hanspub.29542-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Flynn, T.J. (1997) Two Dimensional Phase Unwrapping with Minimum Weighted Discontinuity. Journal of the Optical Society of America, 14, 2692-2701. https://doi.org/10.1364/JOSAA.14.002692</mixed-citation></ref><ref id="hanspub.29542-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Goldstein, R.M., Zerber, H.A. and Werner, C.L. (1988) Satellite Radar Interferometry: Two-Dimensional Phase Unwrapping. Radio Science, 23, 713-720. https://doi.org/10.1029/RS023i004p00713</mixed-citation></ref><ref id="hanspub.29542-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Pritt, M.D. and Shipman, L.S. (1994) Least-Squares Two-Dimensional Phase Unwrapping Using FFTs. IEEE Transactions on Geoscience and Remote Sensing, 32, 706-708. https://doi.org/10.1109/36.297989</mixed-citation></ref><ref id="hanspub.29542-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Pritt, M.D. (1996) Phase Unwrapping by Means of Multigrid Techniques for Interferometric SAR. IEEE Transactions on Geoscience and Remote Sensing, 34, 728-738. https://doi.org/10.1109/36.499752</mixed-citation></ref><ref id="hanspub.29542-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">CHEN, C.W. (2001) Statistical-Cost Network-Flow Approaches to Two-Dimensional Phase Unwrapping for Radar Interferometry. Stanford University, Stanford.</mixed-citation></ref><ref id="hanspub.29542-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Chen, C.W. (2001) Statistical-Cost Network-Flow Ap-proaches to Two-Dimensional Phase Unwrapping for Radar Interferometry. Stanford University, Stanford, California, USA.</mixed-citation></ref><ref id="hanspub.29542-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Loffeld, O. and Krämer, R. (1999) Phase Unwrapping for SAR Interferometry—A Data Fusion Approach by Kalman Filtering. IEEE 1999 International Geoscience and Remote Sensing Symposium (IGARSS’99), Hamburg, 28 June-2 July 1999, 1715-1717. https://doi.org/10.1109/IGARSS.1999.772071</mixed-citation></ref><ref id="hanspub.29542-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Krämer, R. and Loffeld, O. (1996) Phase Unwrapping for SAR In-terferometry with Kalman Filters. EUSAR’96, Königswinter, Germany, 26-28 March 1996, 199-202.</mixed-citation></ref><ref id="hanspub.29542-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Krämer, R. and Loffeld, O. (1997) Presentation of an Improved Phase Unwrapping Algorithm Based on Kalman Filters Combined with Local Slope Estimation. Fringe 96, Zurich, Suisse, 253-260.</mixed-citation></ref><ref id="hanspub.29542-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Ghiglia, D.C. and Pritt, M.D. (1998) Two-Dimensional Phase Unwrapping: Theory, Algo-rithms and Software. John Wiley &amp; Sons, Hoboken.</mixed-citation></ref></ref-list></back></article>