<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">PM</journal-id><journal-title-group><journal-title>Pure  Mathematics</journal-title></journal-title-group><issn pub-type="epub">2160-7583</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/PM.2018.83029</article-id><article-id pub-id-type="publisher-id">PM-25040</article-id><article-categories><subj-group subj-group-type="heading"><subject>PM20180300000_90156809.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  最小二乘法及其相关方法的数学原理与类比分析
  Mathematical Theory and Analogy Analysis of Least Square Method and Its Related Methods
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>幸</surname><given-names>冬梅</given-names></name><xref ref-type="aff" rid="aff1"><sub>1</sub></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>南昌大学数学系，江西 南昌</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>2404061160@qq.com</email></corresp></author-notes><pub-date pub-type="epub"><day>10</day><month>05</month><year>2018</year></pub-date><volume>08</volume><issue>03</issue><fpage>230</fpage><lpage>238</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   在对各种问题的统计分析和建模处理时，经常用到最小二乘法或其相关的方法进行误差分析处理。本文详细叙述了最小二乘法、偏最小二乘法与主成分分析法的数学原理，简述了这些方法的应用场合，对于它们不适用的情况作了说明。描述了它们之间的关联性，概述了它们的相异性。最后，简单说明了回归方程中的参数检验。 In the case of statistical analysis and modeling of various problems, the error analysis is often used by least square method or its related methods. In this paper, these mathematical theories are described in detail on least squares, partial least squares and principal component analysis. We sketch the applications of these methods. In the meantime, the case for which they are not appli-cable is explained. We outline the correlation among them and their different phases. At last, the parameter test in the regression equations is simply explained.
    
  
 
</p></abstract><kwd-group><kwd>最小二乘法，偏最小二乘法，主成分，回归, Least Squares Method</kwd><kwd> Partial Least Squares Method</kwd><kwd> The Principal Components</kwd><kwd> Regression</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>最小二乘法及其相关方法的 数学原理与类比分析<sup> </sup></title><p>幸冬梅</p><p>南昌大学数学系，江西 南昌</p><p><img src="//html.hanspub.org/file/6-1250627x1_hanspub.png" /></p><p>收稿日期：2018年4月28日；录用日期：2018年5月4日；发布日期：2018年5月24日</p><disp-formula id="hanspub.25040-formula53"><graphic xlink:href="//html.hanspub.org/file/6-1250627x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>在对各种问题的统计分析和建模处理时，经常用到最小二乘法或其相关的方法进行误差分析处理。本文详细叙述了最小二乘法、偏最小二乘法与主成分分析法的数学原理，简述了这些方法的应用场合，对于它们不适用的情况作了说明。描述了它们之间的关联性，概述了它们的相异性。最后，简单说明了回归方程中的参数检验。</p><p>关键词 :最小二乘法，偏最小二乘法，主成分，回归</p><disp-formula id="hanspub.25040-formula54"><graphic xlink:href="//html.hanspub.org/file/6-1250627x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by author and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/6-1250627x7_hanspub.png" /> <img src="//html.hanspub.org/file/6-1250627x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>在对计量化学、生物信息学、食品研究、医学、药理学等方面的研究时，经常需要从海量的数据中寻找出内在的联系性。这些海量的数据或通过实验得到、或在实践中得到，然而从这些数据的表面上并不能得到很多的信息，必需对这些数据进行进一步的处理。数据通常可以分成两组向量：因变量的向量、自变量的向量，讨论它们之间的内在联系。最简单的情况是：每组向量中均只有一个元素。因变量的向量与自变量的向量可能存在一定的回归关系。这些回归关系一般是非线性的关系，如果不会引起很大的失真性，可以用线性回归的方式近似。最小二乘(Least Square (LS))回归是这些回归模型中常用的处理误差的方法。为了合理、快捷地搜寻数据中存在的内在关系，研究者对最小二乘回归进行了各种改进，较典型的方法有：主成分分析(Principal Component Analysis (PCA))法、核主成分分析(Kernel Principal Component Analysis (KPCA))法与偏最小二乘(Partial Least Squares (PLS))法。核主成分分析法是主成分分析法的变种；偏最小二乘方法是主成分分析法与最小二乘回归相结合得到的一种方法，常称为PLS方法。现有的文献比较多侧重于这些方法的使用，但分析它们的数学原理、类比这些方法的异同处，并通过事例进行讨论的不多见。下面介绍最小二乘法、主成分分析法和偏最小二乘方法的数学工作原理，讨论它们的联系性。</p></sec><sec id="s4"><title>2. 最小二乘法、主成分分析法与偏最小二乘方法的数学原理</title><sec id="s4_1"><title>2.1. 最小二乘方法</title><p>最小二乘方法 [<xref ref-type="bibr" rid="hanspub.25040-ref1">1</xref>] 能够对实际问题有比较好的解释，该方法的核心是所有估计值与被估计值之差的平方和达到最小。因变量向量用y表示，自变量向量为x。若只有一个因变量，则此时的最小二乘方法即为最简单形式的最小二乘的曲线拟合，给定m个合适的函数 r 1 ( x ) , ⋯ , r m ( x ) 及n组数据 { y ( i ) , x ( i ) } i = 1 n ，其中 { y ( i ) , x ( i ) } 表示因变量、自变量组 ( y , x ) 的第i组值。为了方便，记 y ( i ) 为 y i 。选定适当的参数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/6-1250627x15_hanspub.png" xlink:type="simple"/></inline-formula>，得到曲线</p><p>y = β &#175; 0 + β &#175; 1 r 1 ( x ) + β &#175; 2 r 2 ( x ) + ⋯ + β &#175; n r m ( x ) ，s.t.</p><p>L ( β &#175; 0 , β &#175; 1 , ⋯ , β &#175; m ) ≜ min β i , 0 ≤ i ≤ m ∑ j ( y ( j ) − ( β 0 + β 1 r 1 ( x ( j ) ) + β 2 r 2 ( x ( j ) ) + ⋯ + β m r m ( x ( j ) ) ) ) 2 .</p><p>在没有其他限制条件下， L ( β 0 , β 1 , ⋯ , β m ) 关于 β i ( i = 1 , 2 , ⋯ , m ) 的一阶偏导为0是得到 L ( β 0 , β 1 , ⋯ , β m ) 的极小值的必要条件。选取参数 β i = β &#175; i ( i = 0 , 1 , ⋯ , m ) 的数学工作原理如下：</p><p>令 Y = [ y 1 , y 2 , ⋯ , y n ] T ， L ( β 0 , ⋯ , β m ) = ∑ j ( y j − ( β 0 + β 1 r 1 ( x j ) + β 2 r 2 ( x j ) + ⋯ + β m r m ( x j ) ) ) 2 ，分别求L关于 β i ( i = 0 , ⋯ , m ) 的偏导数，并令其为0，即</p><p>∂ L ∂ β 0 = − 2 ∑ j ( y j − ( β 0 + β 1 r 1 ( x ( j ) ) + ⋯ + β i r i ( x ( j ) ) + ⋯ + β m r m ( x ( j ) ) ) ) = 0 ∂ L ∂ β i = − 2 ∑ j r i ( x ( j ) ) ( y j − ( β 0 + β 1 r 1 ( x ( j ) ) + ⋯ + β i r i ( x ( j ) ) + ⋯ + β m r m ( x ( j ) ) ) ) = 0   ( i = 1 , 2 , ⋯ , m )</p><p>计算可得</p><p>β = ( β &#175; 0 , β &#175; 1 , ⋯ , β &#175; m ) = ( X T X ) − 1 ⋅ X T Y (1)</p><p>其中， X = [ 1 r 1 ( x ) ⋯ r m ( x ) ] = [ 1 r 1 ( x ( 1 ) ) ⋯ r m ( x ( 1 ) ) 1 r 1 ( x ( 2 ) ) ⋯ r m ( x ( 2 ) ) ⋮ ⋮ ⋱ ⋮ 1 r 1 ( x ( n ) ) ⋯ r m ( x ( n ) ) ] 。</p><p>选择合适的函数 r i ( x ) ( i = 1 , 2 , ⋯ , m ) 并不容易，常简化曲线拟合为线性拟合或多项式拟合，最简单的模型为线性回归模型，即因变量y是自变量 x = ( x 1 , x 2 , ⋯ , x n ) T 1的线性组合：</p><p>m = n ,   y = β 0 + β 1 x 1 + β 2 x 2 + ⋯ + β n x n = β T ⋅ ( 1 , x T ) , 其中 β = ( β 0 , β 1 , ⋯ , β n ) T .</p><p>给定n组数据 { y i , x ( i ) T } i = 1 n ,   x ( i ) T = ( x i 1 , ⋯ , x i n ) ，待定的系数 β i ( i = 0 , 1 , ⋯ , n ) 使得误差平方的叠加和最小，易得出</p><p>当 β = ( X T X ) − 1 ⋅ X T Y ≜ β &#175; 时， ∑ j ( y j − ( β 0 + β 1 x j 1 + β 2 x j 2 + ⋯ + β n x j n ) ) 2 其达到最小值，此时</p><p>y = β &#175; 0 + β &#175; 1 x 1 + β &#175; 2 x 2 + ⋯ + β &#175; n x n ,</p><p>其中 X = [ 1 x 1 ⋯ x n ] = [ 1 x 11 ⋯ x 1 n 1 x 21 ⋯ x 2 n ⋮ ⋮ ⋱ ⋮ 1 x n 1 ⋯ x n n ] ， 。</p><p>线性回归模型 y = β 0 + β 1 x 1 + β 2 x 2 + ⋯ + β n x n 是最简单的数据处理模型，不一定能够真正反映实际数据的内存规律；最小二乘方法涉及所有的变量，不同自变量数据之间可能存在全部或部分线性相关性关系，这时数据的有效信息可能不能直接体现出来。减少线性回归模型的变量的个数，但又不要丢弃太多的信息，主成分分析方法 [<xref ref-type="bibr" rid="hanspub.25040-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref3">3</xref>] 是可选方法之一。</p></sec><sec id="s4_2"><title>2.2. 主成分分析法</title><p>针对不同自变量数据之间存在全部或部相关性关系，导致(1)式中 X T X 成为病态矩阵，不再适合用最小二乘方法，W.F. Massy [<xref ref-type="bibr" rid="hanspub.25040-ref3">3</xref>] 提出了主成分回归(Principal Component Regression，简称PCR)方法。主成分分析的核心在于降维，将原有的多个性能指标(即多个自变量)减少为只含有少数几个综合性能指标。这些综合性能指标是原来的性能指标的线性组合，它们相互独立且集中反映出原始变量的较多信息，在选择综合性能指标时，一般通过信息量与原有信息量的百分比(如95%或更多、更少的百分比)来衡量。</p><p>设x是有n个随机变量组成的列向量2，研究它们所体现的信息，通常得计算出这n个随机变量的方差、协方差，找出这n个随机变量间有意义的相关性结构。然而若n较大，计算向量x的方差、协方差要花费比较多时间，除非n很小或者变量之间的相关性结构很简单，否则发现随机变量间的相关性结构比较困难。研究随机变量隐含的信息时，考虑研究一些维数远远低于n的派生变量，这些派生变量是原来变量的线性组合，它们保留了原来变量绝大部分信息，这样的派生变量称之为主成分。</p><p>主成分分析法中，寻找主成分的步骤如下3：</p><p>第一步：寻找第一个主成分，即找出x的一个线性组合 β 1 ，记为 β 1 ≜ α 1 T x ，其中 α 1 是一个n维列向量， α 1 = ( α 11 , α 12 , ⋯ , α 1 n ) T ， x = ( x 1 , x 2 , ⋯ , x n ) T ， var ( β 1 ) 为 β 1 的方差。</p><p>β 1 ≜ α 1 T x = α 11 x 1 + α 12 x 2 + ⋯ + α 1 n x n ,</p><p>s.t. var ( β 1 ) 最大，且 α 1 T ⋅ α 1 = 1 。</p><p>第二步：寻找第二个主成分，也即寻找x的第二个线性组合 β 2 ，记为 β 2 ≜ α 2 T x ，其中 α 2 是一个n维列向量， α 2 = ( α 21 , α 22 , ⋯ , α 2 n ) T ， ，</p><p>β 2 ≜ α 2 T x = α 21 x 1 + α 22 x 2 + ⋯ + α 2 n x n ,</p><p>s.t. var ( β 2 ) 最大，且 α 2 T ⋅ α 2 = 1 ， β 1 与 β 1 线性无关。</p><p>以此类推，直至找到线性关系 β k ，使其与 β 1 , β 2 , ⋯ , β k − 1 线性无关且具有最大方差。至此，k个主成分找到了。</p><p>第三步：建立因变量与主成分的回归方程，其中最简单的是线性回归方程。可依据最小二乘回归得到数学模型。</p><p>获得主成分的数学推导过程描述如下。</p><p>两个随机变量具有线性无关性，是指两个随机变量之间的协方差为0。在寻找主成分前，先对随机变量的数值进行规范化处理，使得随机变量的均值为0，方差为1。设随机变量的向量x的协方差矩阵为 ∑ 。</p><p>对于第一主成分 β 1 ：利用Lagrange乘子法，构造Lagrange函数</p><p>L ( α 1 ) ≜ var ( β 1 ) − λ ( α 1 T α 1 − 1 ) = α 1 T ⋅ ∑ ⋅   α 1 − λ ( α 1 T α 1 − 1 ) ,</p><p>其中λ是Lagrange乘子，依据极值原理， ∂ L ( α 1 ) ∂ α 1 = 0 是在条件 α 1 T ⋅ α 1 = 1 时 var ( β 1 ) 的取得最大值的充要条件。上式两边对 α 1 求导，令其为0，即</p><p>1 2 ⋅ ∂ L ( α 1 ) ∂ α 1 = ∑ ⋅   α 1 − λ α 1 = ( ∑ −   λ ⋅ I n ) ⋅ α 1 = 0 ⇒ ∑ ⋅   α 1 = λ α 1</p><p>其中 I n 是n阶单位矩阵。显然λ是 ∑ 特征值， α 1 是相应的特征向量。由于 var ( β 1 ) = α 1 T ⋅ ∑ ⋅   α 1 = λ α 1 T α 1 = λ ，所以 max var ( β 1 ) = ( max λ ) α 1 T α 1 = ( max λ ) ≜ λ 1 。因此，第一主成分中出现的系数为协方差矩阵 ∑ 的最大特征值 λ 1 的特征向量 α 1 。</p><p>对于第二主成分 β 2 ：由于 β 1 , β 2 线性无关，故 cov ( β 1 , β 2 ) = α 1 T ⋅ ∑ ⋅   α 2 = 0 ，而 α 1 T ⋅ ∑ ⋅   α 2 = α 2 T ⋅ ∑ ⋅   α 1 = α 2 T ⋅ λ 1 α 1 = λ 1 α 2 T ⋅ α 1 = λ 1 α 1 T ⋅ α 2 = 0 ，从而有</p><p>α 1 T ⋅ ∑ ⋅   α 2 = α 2 T ⋅ ∑ ⋅   α 1 = 0 = α 2 T ⋅ α 1 = α 1 T ⋅ α 2</p><p>利用Lagrange乘子法，构造Lagrange函数</p><p>L ( α 2 ) ≜ var ( β 2 ) − λ ( α 2 T α 2 − 1 ) − γ ( α 2 T α 1 − 0 ) = α 2 T ⋅ ∑ ⋅   α 2 − λ ( α 2 T α 2 − 1 ) − γ ( α 2 T α 1 − 0 )</p><p>上式两边对 α 2 求导，令其为0，即</p><p>1 2 ⋅ ∂ L ( α 2 ) ∂ α 2 = ∑ ⋅   α 2 − λ α 2 − γ α 1 = 0 (2)</p><p>两边左乘 α 1 T ，得</p><p>α 1 T ⋅ ∑ ⋅   α 2 − λ α 1 T ⋅ α 2 − γ α 1 T ⋅ α 1 = 0 ⇒ γ α 1 T ⋅ α 1 = 0 ⇒ γ = 0</p><p>代入(2)，得 ∑ ⋅   α 2 − λ α 2 = 0 ⇒ ∑ ⋅   α 2 = λ α 2 ，显然λ是 ∑ 的特征值， α 2 是相应的特征向量。由于</p><p>var ( β 2 ) = α 2 T ⋅ ∑ ⋅   α 2 = λ α 2 T α 2 = λ ，所以 max var ( β 2 ) = ( max λ ) α 2 T α 2 = ( max λ ) ≜ λ 2 。假设 ∑ 没有重根，则 λ 1 &gt; λ 2 ， λ 2 是 ∑ 的第二大特征根，相应的特征向量 α 2 是第二主成分中出现的系数4。</p><p>类似地，可以依次从大到小求出 ∑ 的其它特征根及特征向量，找出相应的主成分，通常依据 ∑ i = 1 s | λ i | ∑ i = 1 t | λ i | ≥ 95 % or 90 % 确定从 ∑ 所有t个特征值 λ i ( i = 1 , ⋯ , t ) 中选取s个特征值 λ i ( i = 1 , ⋯ , s ) 。</p></sec><sec id="s4_3"><title>2.3. 偏最小二乘法</title><p>偏最小二乘方法 [<xref ref-type="bibr" rid="hanspub.25040-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref8">8</xref>] 是20世纪80年代从应用中总结出来的一种降维技术。偏最小二乘回归方法的一大优点是：考虑样本总体对预测值的影响程度时，也充分考虑了单个因素间的综合作用对预测的影响。在回归速率上，偏最小二乘方法比一般的多元回归方法更快一些，对样本的要求更加宽松。偏最小二乘回归方法可以看成是最小二乘回归、主成分方法及典型相关分析方法的综合体。</p><p>偏最小二乘方法的原理如下：</p><p>设X5是含有n个随机变量 x 1 , x 2 , ⋯ , x n 组成的自变量的列向量，Y是含有一个或多个随机变量 y 1 , y 2 , ⋯ , y q ( q ≥ 1 ) 的因变量的列向量。找出X的k个线性组合 β i ( i = 1 , 2 , ⋯ , k ) ，这些线性组合满足主成分分析的要求；在Y中找出r个线性组合 τ i ( i = 1 , 2 , ⋯ , r ) ，它们也满足主成分分析的要求。建立 β i 与 τ i 的回归关系，使它们之间的相关程度达到最大；并构造 β i 与 X , Y 的回归关系，建立Y与X的回归关系。</p><p>偏最小二乘回归分析的步骤：</p><p>第一步：分别找出X与Y的第一主成分 β 1 , τ 1 ，并且使 β 1 , τ 1 的协方差 cov ( β 1 , τ 1 ) 达到最大。</p><p>β 1 ≜ X T α 1 = α 11 x 1 + α 12 x 2 + ⋯ + α 1 n x n ,</p><p>s.t. max var ( β 1 ) , 且 α 1 T ⋅ α 1 = 1 .</p><p>τ 1 ≜ Y T μ 1 = μ 11 y 1 + μ 12 y 2 + ⋯ + μ 1 q y q ,</p><p>s.t. max var ( τ 1 ) , 且 μ 1 T ⋅ μ 1 = 1 ;</p><p>max cov ( β 1 , τ 1 ) .</p><p>上述的方法在推导过程中，作了如下假定：1) 各变量的特征维数不大；2) 过程不存在序列相关性；3) 过程是线性的。以上方法中要求X及Y均已经作了预处理，使X及Y中心化、均值化。</p><p>第二步：先建立 β 1 与 τ 1 的回归关系： τ 1 = β 1 W T ，其中W为相应的权值；由 β 1 与X的线性回归方程及τ与Y的线性回归方程，得到 β 1 与Y的线性回归方程。</p><p>X = β 1 P T + E 1 , Y = τ 1 Q T + F 1 ( 0 ) , Y = β 1 R 1 T + F 1</p><p>当 E 1 , F 1 ( 0 ) , F 1 均为0时，显然有 P = X T ⋅ β 1 β 1 T ⋅ β 1 = X T ⋅ β 1 ‖ β 1 ‖ 2 ， Q = Y T ⋅ τ 1 τ 1 T ⋅ τ 1 = X T ⋅ τ 1 ‖ τ 1 ‖ 2 ， R 1 = Y T ⋅ β 1 β 1 T ⋅ β 1 = Y T ⋅ β 1 ‖ β 1 ‖ 2 ；一般地， E 1 , F 1 ( 0 ) , F 1 分别是这些回归方程的残差矩阵。</p><p>第三步：分别用 E 1 , F 1 替换 X , Y ，重复第一步~第二步，依次寻找X的第二主成分 β 2 。类似地，依次得到第三主成分 β 3 ，…，第d个主成分 β d 。</p><p>由第二步得到Y与X的主成分β的回归关系式： Y = β 1 R 1 T + β 2 R 2 T + β 3 R 3 T + ⋯ + β d R d T + F d ，利用第一步中的结果，容易得到Y与X的回归关系。</p><p>下面对第一步作详细分析，利用Lagrange乘子法求解 β 1 , τ 1 。</p><p>令 ，</p><p>由于 cov ( β 1 , τ 1 ) = α 1 T cov ( X , Y ) μ 1 = α 1 T ( X T ⋅ Y ) μ 1 ，</p><p>所以<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/6-1250627x147_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>依据极值原理， L ( α , μ ) 关于 α , μ 在边界上取得极大值的充要条件为相应的偏导数为0。下面分别对 α , μ 求偏导，得</p><p>∂ L ∂ α 1 = X T Y μ 1 − 2 λ 1 α 1 = 0 ⇒ X T Y μ 1 = 2 λ 1 α 1 , (i)</p><p>∂ L ∂ μ 1 = Y T X α 1 − 2 λ 2 μ 1 = 0 ⇒ Y T X α 1 = 2 λ 2 μ 1 , (ii)</p><p>所以由(i)，(ii)可得</p><p>( X T Y ) ( Y T X ) α 1 = ( X T Y ) ⋅ ( 2 λ 2 μ 1 ) = 2 λ 2 ( X T Y ) ⋅ μ 1 = 2 λ 2 ( 2 λ 1 α 1 ) = 2 λ 2 ⋅ 2 λ 1 α 1</p><p>( Y T X ) ( X T Y ) μ 1 = ( Y T X ) ⋅ ( 2 λ 1 α 1 ) = 2 λ 1 ( Y T X ) ⋅ α 1 = 2 λ 1 ( 2 λ 2 μ 1 ) = 2 λ 2 ⋅ 2 λ 1 μ 1</p><p>μ 1 T ⋅ ( Y T X ) α 1 = α 1 T ⋅ ( 2 λ 1 α 1 ) = 2 λ 1 ( α 1 T ⋅ α 1 ) = 2 λ 1 ⋅ ( Y T X ) α 1 = μ 1 T ⋅ ( 2 λ 2 μ 1 ) = 2 λ 2 μ 1 T ⋅ μ 1 = 2 λ 2</p><p>α 1 T ⋅ ( X T Y ) μ 1 = α 1 T ⋅ ( 2 λ 1 α 1 ) = 2 λ 1 ( α 1 T ⋅ α 1 ) = 2 λ 1</p><p>注意到 μ 1 T ⋅ ( Y T X ) α 1 = ( α 1 T ⋅ ( X T Y ) μ 1 ) T ⇒ 2 λ 2 = ( 2 λ 1 ) T = 2 λ 1 。</p><p>由此可得出， α 1 是矩阵 ( X T Y ) ( Y T X ) 的最大特征值所对应的特征向量，也是X的第一主成分 β 1 的系数部分； μ 1 是矩阵 ( Y T X ) ( X T Y ) 的最大的特征值所对应的特征向量，也是Y的第一主成分 τ 1 的系数。</p><p>采用PLS进行计算机处理数据时，常常通过迭代方式进行。在n维空间中任意选取一个非零列向量u (与列向量Y有相同的维数的向量)，PLS回归迭代过程包括6个步骤 [<xref ref-type="bibr" rid="hanspub.25040-ref3">3</xref>] ：</p><p>1 )   w = X T u / ( u T u ) 4 )   c = Y T t / ( t T t ) 2 )   ‖ w ‖ → 1 ( w = w / ‖ w ‖ ) 5 )   ‖ c ‖ → 1 ( c = c / ‖ c ‖ ) 3 )   t = X w 6 )   u = Y c</p><p>如果Y是一维向量，我们用y表示Y，此时有 u = y ；当满足精确度要求时，迭代步骤停止。可以证明w是 α 1 的近似值，c为 μ 1 的近似值，说明如下：</p><p>设最初选取的非零向量为 u ( 0 ) ，第一次利用PLS的6个步骤的1) 3) 4) 6)得到的为 w ( 1 ) , t ( 1 ) , c ( 1 ) , u ( 1 ) ；由 u ( k ) 利用PLS的6个步骤的1) 3) 4) 6)得到的为 w ( k + 1 ) , t ( k + 1 ) , c ( k + 1 ) , u ( k + 1 )</p><p>w ( k + 1 ) = X T u ( k ) / ( u ( k ) T u ( k ) ) = X T Y c ( k ) / ( ( u ( k ) T u ( k ) ) ⋅ ‖ c ( k ) ‖ ) = X T Y Y T t ( k ) / ( ( u ( k ) T u ( k ) ) ⋅ ‖ c ( k ) ‖ ⋅ ( t ( k ) T t ( k ) ) ) = X T Y Y T X w ( k ) / ( ( u ( k ) T u ( k ) ) ⋅ ‖ c ( k ) ‖ ⋅ ( t ( k ) T t ( k ) ) ⋅ ‖ w ( k ) ‖ )</p><p>所以</p><p>w ( k + 1 ) = X T Y Y T X ⋅ w ( k ) / ( ( u ( k ) T u ( k ) ) ⋅ ‖ c ( k ) ‖ ⋅ ( t ( k ) T t ( k ) ) ⋅ ‖ w ( k ) ‖ )</p><p>( X T Y Y T X ) ⋅ w ( k ) = ( ( u ( k ) T u ( k ) ) ⋅ ‖ c ( k ) ‖ ⋅ ( t ( k ) T t ( k ) ) ⋅ ‖ w ( k ) ‖ ) ⋅ w ( k + 1 )</p><p>类似地，有以下式子成立</p><p>c ( k + 1 ) = Y T X X T Y c ( k ) / ( ( t ( k + 1 ) T t ( k + 1 ) ) ⋅ ‖ w ( k + 1 ) ‖ ⋅ ( u ( k + 1 ) T u ( k + 1 ) ) ⋅ ‖ c ( k ) ‖ ) ∴ c ( k + 1 ) = Y T X X T Y c ( k ) / ( ( t ( k + 1 ) T t ( k + 1 ) ) ⋅ ‖ w ( k + 1 ) ‖ ⋅ ( u ( k ) T u ( k ) ) ⋅ ‖ c ( k ) ‖ ) ( Y T X ⋅ X T Y ) c ( k ) = ( ( t ( k + 1 ) T t ( k + 1 ) ) ⋅ ‖ w ( k + 1 ) ‖ ⋅ ( u ( k ) T u ( k ) ) ⋅ ‖ c ( k ) ‖ ) ⋅ c ( k + 1 )</p></sec></sec><sec id="s5"><title>3. 比较最小二乘方法、主成分分析法及偏最小二乘法</title><p>最小二乘方法、主成分分析法与偏最小二乘方法，均是从误差最小化方面去寻找合适的参数。这些方法在处理误差时，都默认了误差分布是理想的 [<xref ref-type="bibr" rid="hanspub.25040-ref1">1</xref>] ，即模型误差是独立同分布的且服从其均值为0、方差为 σ 2 的正太分布。下面以最小二乘方法进行说明。</p><p>给定需要拟合的数据 { ( x i 1 , x i 2 , ⋅ ⋅ ⋅ , x i k , y i ) , i = 1 , 2 , ⋅ ⋅ ⋅ , n , n &gt; k } ，利用下面的多元回归模型(即因变量关于自变量的数学期望)进行数据拟合： μ y | x 1 , x 2 , ⋅ ⋅ ⋅ , x k = β 0 + β 1 r 1 ( x ) + β 2 r 2 ( x ) + ⋅ ⋅ ⋅ + β k r k ( x k ) ，利用最小二乘估计得到参数 β 0 , β 1 , β 2 , ⋅ ⋅ ⋅ , β k ，每组拟合数据 ( x i 1 , x i 2 , ⋅ ⋅ ⋅ , x i k , y i ) 均满足方程</p><p>y i = β 0 + β 1 r 1 ( x i 1 ) + β 2 r 2 ( x i 2 ) + ⋅ ⋅ ⋅ + β k r k ( x i k ) + ε i</p><p>其中 ε i 是模型的随机误差，它独立同分布，服从均值为0，方差为 σ 2 的正太分布。</p><p>这里考虑因变量是自变量的多元线性回归模型，且只有一个因变量。从上述描写可知，在利用最小二乘法时，要求 X T X 可逆。如果X的列之间存在多重共线，纵然 X T X 可逆，由(1)计算得 β = ( β 0 , β 1 , ⋯ , β i , ⋯ , β m ) T 建立的数学模型，很可能不具有通用性。</p><p>X的列之间存在多重共线时，利用主成分分析法可消除这种共线性的不良影响。主成分分析法从原有的自变量向量中寻找它们的某些线性组合(即综合的指标或称之为综合自变量)，在信息损失最小的原则下，得到少数几个综合自变量。主成分分析法可以在一定程度上消除了原自变量之间的多重共线性，而且降低了待处理数据的维数。处理有周期性变化规律的数据时，如经济运行中的得到的各类经济数据，主成分分析法与谱分析方法相结合 [<xref ref-type="bibr" rid="hanspub.25040-ref9">9</xref>] ，分析数据的变化趋势与规律。</p><p>主成分分析法对X进行主成分分析，没有考虑因变量Y，也没有考虑X对Y的解释作用。PLS方法解决了这种缺憾。PLS回归(Partial Least-Square Regression，简称PLSR)方法充分利用了PCR方法对信息(自变量数据)提取的思想。</p><p>PLSR方法是S. Wold和C. Albano [<xref ref-type="bibr" rid="hanspub.25040-ref4">4</xref>] 在1983年提出的。许多研究工作者 [<xref ref-type="bibr" rid="hanspub.25040-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.25040-ref8">8</xref>] 对PLSR进行了研究，他们还研究了利用迭代的方式计算主成分(参考上文中“PLS回归迭代过程”关内容)。PLSR是主成分分析法与最小二乘法的综合体，它对自变量和因变量均提取主成分，同时还考虑了因变量的作用以及自变量X对因变量的解释作用，一定程度上消除了基于主成分的回归模型的不可靠性。</p><p>如果响应变量类似于二值情况，回归模型的随机误差 ε i 明显不是理想状态，即 ε i 不服从均值为0、方差为 σ 2 的正太分布。此时均值与方差均可能是随着自变量而发生改变，不可以利用多元回归方法中的最小二乘法来解决问题 [<xref ref-type="bibr" rid="hanspub.25040-ref1">1</xref>] 。例如，Logistic回归模型是一种比较理想的对二值响应的拟合，可以利用梯度下降法得到Logistic回归函数中的待估参数。</p></sec><sec id="s6"><title>4. 拟合回归模型优良性检验说明</title><p>对于已经给的数据分析研究得到相应的回归模型时，通常只需要作参数检验 [<xref ref-type="bibr" rid="hanspub.25040-ref1">1</xref>] ，检查 R 2 或 R a d j 2 <sup>6</sup>。如果得到的多个自变量数据与正交性差距太大，即它们明显不具有正交性，那么得到的模型可能过度拟合，此时需要进行交互验证 [<xref ref-type="bibr" rid="hanspub.25040-ref1">1</xref>] 。我们下一步要做的工作是针对具体问题，利用前述方法建立模型并进行参数检验与参数在实际情况的意义的解释。</p></sec><sec id="s7"><title>文章引用</title><p>幸冬梅. 最小二乘法及其相关方法的数学原理与类比分析 Mathematical Theory and Analogy Analysis of Least Square Method and Its Related Methods[J]. 理论数学, 2018, 08(03): 230-238. https://doi.org/10.12677/PM.2018.83029</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.25040-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Walpole, R.E., Myers, R.H., Myers, S.L. and Ye, K.Y. 理工科概率统计[M]. 周勇, 马昀蓓, 谢尚宇, 王晓婧, 译.北京: 机械工业出版社, 2010.</mixed-citation></ref><ref id="hanspub.25040-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Hotelling, H. (1933) Analysis of a Complex of Statistical Variables into Principal Components. Education Psychology, 24, 417-444. &lt;br&gt;https://doi.org/10.1037/h0071325</mixed-citation></ref><ref id="hanspub.25040-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Massy, W.F. (1965) Principal Components Regression in Exploratory Statistical Research. Journal of the American Statistical Association, 60, 234-256. &lt;br&gt;https://doi.org/10.1080/01621459.1965.10480787</mixed-citation></ref><ref id="hanspub.25040-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Wold, S., Albano, C. and Dun, M. (1983) Pattern Regression Finding and Using Regularities in Multivariate Data. Analysis Applied Science Publication, London.</mixed-citation></ref><ref id="hanspub.25040-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Rosipal, R. and Krämer, N. (2006) Overview and Recent Advances in Partial Least Squares. Subspace, Latent Structure and Feature Selection, Bohinj, Slovenia, 23-25 February 2005, 34-51. &lt;br&gt;https://doi.org/10.1007/11752790_2</mixed-citation></ref><ref id="hanspub.25040-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Wold, H. (1982) Soft Modeling: The Basic Design and Some Extensions. In: Jöreskog, J.-K. and Wold, H., Eds., Systems under Indirect Observation, Volume 2, North Holland, Amsterdam, 1-53.</mixed-citation></ref><ref id="hanspub.25040-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Wold, H. (1985) Partial Least Squares. In: Kotz, S. and Johnson, N.L., Eds., Encyclopedia of the Statistical Sciences, Vol. 6, John Wiley, New York, 581-591.</mixed-citation></ref><ref id="hanspub.25040-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Wold, S., Ruhe, H., Wold, H. and Dunn III, W.J. (1984) The Collinearity Problem in Linear Regression. The Partial Least Squares (PLS) Approach to Generalized Inverse. SIAM Journal of Scientific and Statistical Computations, 5, 735-743. &lt;br&gt;https://doi.org/10.1137/0905052</mixed-citation></ref><ref id="hanspub.25040-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">张红, 谢娜. 基于主成分分析与谱分析的房地产市场周期研究[J]. 清华大学学报(自然科学版), 2008, 48(9): 24-27.</mixed-citation></ref></ref-list></back></article>