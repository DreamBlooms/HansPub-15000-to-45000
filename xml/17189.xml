<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">MET</journal-id><journal-title-group><journal-title>Mechanical Engineering and Technology</journal-title></journal-title-group><issn pub-type="epub">2167-6631</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/MET.2016.51003</article-id><article-id pub-id-type="publisher-id">MET-17189</article-id><article-categories><subj-group subj-group-type="heading"><subject>MET20160100000_74404609.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于STC89C52单片机的数字气量表的设计
  Design of Digital Gas Meter Based on Processor STC89C52
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>方</surname><given-names>永锋</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>方</surname><given-names>煜斌</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>贵州工程应用技术学院机械工程学院，贵州 毕节</addr-line></aff><aff id="aff3"><addr-line>兰州交通大学机电工程学院，甘肃 兰州</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>fangyf_9707@126.com(方永)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>02</day><month>03</month><year>2016</year></pub-date><volume>05</volume><issue>01</issue><fpage>17</fpage><lpage>21</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文设计了一种新型数字气量表，该装置基于单片机和涡轮流量传感器对气罐剩余气量的间接测量，实现了CNG气罐剩余气量的实时显示。为驾驶员实时掌握气耗提供了准确数据依据。 A new type of digital gas meter is designed, by which the magnitude of the remaining gas in gas tank can be indirectly tested using the MCU and the turbine flow transducer, and the remaining gas volume in the CNG gas tank can be shown in real time. The designed digital gas meter provides the accurate data basis for the driver to master the gas consumption in real time.
    
  
 
</p></abstract><kwd-group><kwd>单片机，涡轮流量传感器，液晶显示, MCU</kwd><kwd> Turbine Flow Transducer</kwd><kwd> Liquid Crystal Display</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于STC89C52单片机的数字气量表的设计<sup> </sup></title><p>方永锋<sup>1</sup>，方煜斌<sup>2</sup></p><p><sup>1</sup>贵州工程应用技术学院机械工程学院，贵州 毕节</p><p><sup>2</sup>兰州交通大学机电工程学院，甘肃 兰州</p><disp-formula id="hanspub.17189-formula139"><graphic xlink:href="http://html.hanspub.org/file/3-2340265x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年3月2日；录用日期：2016年3月15日；发布日期：2016年3月24日</p><disp-formula id="hanspub.17189-formula140"><graphic xlink:href="http://html.hanspub.org/file/3-2340265x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文设计了一种新型数字气量表，该装置基于单片机和涡轮流量传感器对气罐剩余气量的间接测量，实现了CNG气罐剩余气量的实时显示。为驾驶员实时掌握气耗提供了准确数据依据。</p><p>关键词 :单片机，涡轮流量传感器，液晶显示</p><disp-formula id="hanspub.17189-formula141"><graphic xlink:href="http://html.hanspub.org/file/3-2340265x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>随着国家对清洁燃料的大力推广，CNG加气站等基础设施的广泛铺设，越来越多的CNG燃料汽车出现在人们的视野中。汽车燃气计量也引起了相关部门的重视和驾驶者的关注，但是由于没有可以精确显示燃气量的计量装置而无法落实管理。尤其在出租车行业，由于没有可以精确显示CNG气罐剩余气量的仪表，昼夜交班前都是以满罐为基准，导致加气站在固定时间加气车辆猛增，排队时间较长，给司机和乘客都造成不便。因此，本文设计了一种数字气量表，采用了涡轮传感器对CNG气罐进出流量进行计量作差，实现了对汽车剩余气量的实时监测，便于考核汽车的经济指标，而且给出租车行业昼夜交班带来极大便利，一定程度上能够解决出租车行业聚集加气的情况。</p></sec><sec id="s4"><title>2. 数字气量表的研究设计</title><sec id="s4_1"><title>2.1. 系统组成</title><p>硬件系统包括2个传感器信号输入模块、单片机控制模块、数据储存模块、液晶显示模块、面板按键模块和汽车电源供电模块 [<xref ref-type="bibr" rid="hanspub.17189-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.17189-ref2">2</xref>] 。系统框架图如图1所示。</p><p>系统软件包括信号测量模块、单片机和液晶显示的初始化设置模块、液晶的写数据/命令模块、流量计算模块、数据储存和数据显示模块，还有定时器的中断模块 [<xref ref-type="bibr" rid="hanspub.17189-ref3">3</xref>] - [<xref ref-type="bibr" rid="hanspub.17189-ref5">5</xref>] 。</p></sec><sec id="s4_2"><title>2.2. 系统工作原理</title><p>系统能够实现实时显示CNG气罐剩余气量的功能。单片机通过对分别安装在进气管道和出气管道上的涡轮传感器上的脉冲个数进行采集，然后通过计算，得出进气量和出气量，再进行作差处理，便得到了气罐中的剩余气量，所得的数据采用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2340265x9_hanspub.png" xlink:type="simple"/></inline-formula>总线，通过<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2340265x10_hanspub.png" xlink:type="simple"/></inline-formula>来储存，并通过液晶显示模块实时显示出来。设计中面板上有一个清零/复位按键，短按为复位键，长按5 s为清零。信号经采集后须通过整形放大处理，再传送给单片机进行计算。</p><p>图1. 硬件系统结构图</p></sec></sec><sec id="s5"><title>3. 系统硬件设计</title><p>结合软件方案设计硬件系统，尽可能的简化硬件结构，减小硬件系统的复杂性。</p><sec id="s5_1"><title>3.1. 涡轮传感器工作原理</title><p>流体流经传感器壳体，由于叶轮的叶片与流向有一定的角度，流体的冲力使叶片具有转动力矩，克服摩擦力矩和流体阻力之后叶片旋转，在力矩平衡后转速稳定，在一定的条件下，转速与流速成正比，由于叶片有导磁性，它处于信号检测器(由永久磁钢和线圈组成)的磁场中，旋转的叶片切割磁力线，周期性的改变着线圈的磁通量，从而使线圈两端感应出电脉冲信号，此信号经过放大器的放大整形，形成有一定幅度的连续的矩形脉冲波，可远传至显示仪表，显示出流体的瞬时流量和累计量 [<xref ref-type="bibr" rid="hanspub.17189-ref6">6</xref>] 。</p><p>在一定的流量范围内，脉冲频率f与流经传感器的流体的瞬时流量Q成正比，流量方程为：</p><disp-formula id="hanspub.17189-formula142"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2340265x12_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：</p><p>f——脉冲频率[Hz]；</p><p>k——传感器的仪表系数[<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2340265x13_hanspub.png" xlink:type="simple"/></inline-formula>]；</p><p>Q——流体的瞬时流量(工作状态下) [<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2340265x14_hanspub.png" xlink:type="simple"/></inline-formula>]；</p><p>每台传感器的仪表系数由制造厂填写在检定证书中，k值设入配套的设备中，便可计算出瞬时流量和累积总量。</p></sec><sec id="s5_2"><title>3.2. 单片机的选择</title><p>本系统选用STC89C52作为处理芯片。AT89C2051是美国ATMEL公司生产的低电压，高性能CMOS 8位单片机。具有8 k字节Flash，512字节RAM，32位I/O口线，看门狗定时器，内置4 KB EEPROM，MAX810复位电路，三个16位定时器/计数器，一个6向量2级中断结构和全双工串行口。本系统中主要用到了芯片的2个定时器和它的P1，P2端口。</p></sec><sec id="s5_3"><title>3.3. 数据存储电路</title><p>数据存储选用了<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2340265x15_hanspub.png" xlink:type="simple"/></inline-formula>总线的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2340265x16_hanspub.png" xlink:type="simple"/></inline-formula>存储器AT24C02。AT24C02是低工作电压的2 K位串行电可擦除只读存储器，内部组织为256个字节，每个字节8位。在其SCL输入时钟信号的上升沿将数据送入<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2340265x17_hanspub.png" xlink:type="simple"/></inline-formula>器件，并在时钟的下降沿将数据读出。SDA引脚可实现双向串行数据传输，该引脚为开漏输出，需要连接上拉电阻。将剩余气量数据保存在AT24C02中，可保证断电不丢失。数据储存模块和单片机的接口电路如图2所示。</p></sec><sec id="s5_4"><title>3.4. 液晶显示电路</title><p>显示部分选用了一块1602液晶，满足需求，简单方便。所用1602液晶为5 V电压驱动，带背光，可显示两行，每行16个字符，内置含128个字符的ASCII字符集字库，使用并行接口。该部分和单片机的接口电路如图2所示。</p><p>需要说明的是，真正投入使用的显示模块需要根据车辆生产厂家对仪表界面的要求去液晶厂家定制。</p></sec></sec><sec id="s6"><title>4. 系统软件设计</title><p>系统软件设计应遵循自顶向下逐步细化的设计方法，各个模块尽量保持独立，便于调试和修改。主程序流程图如图3所示。</p><p>图2. 单片机与液晶显示模块接口电路</p><p>图3. 主程序流程图</p></sec><sec id="s7"><title>5. 结束语</title><p>介绍了一种基于单片机STC89C52的数字式气量表的设计方法。设计中采用了涡轮流量传感器，其具有测量精度高、重复性小、体积小、质量轻、输出数字脉冲且维修方便等优点。作者设计的数字式气量表能够满足各方面的显示要求，能够实时显示CNG气罐剩余气量，为驾驶员实时掌握气耗和出租行业昼夜交班管理提供了准确可靠的数据依据。</p></sec><sec id="s8"><title>基金项目</title><p>贵州工程应用技术学院高层次人才项目(院科合字G2013007号)贵州省自然科学基金(黔科合J字[<xref ref-type="bibr" rid="hanspub.17189-ref2014">2014</xref>]2001)资助，贵州省省级实验示范教学中心项目资助，贵州省高等学校新能源汽车产学研基地(黔教科KY[<xref ref-type="bibr" rid="hanspub.17189-ref2014">2014</xref>]238)项目资助。</p></sec><sec id="s9"><title>文章引用</title><p>方永锋,方煜斌. 基于STC89C52单片机的数字气量表的设计Design of Digital Gas Meter Based on Processor STC89C52[J]. 机械工程与技术, 2016, 05(01): 17-21. http://dx.doi.org/10.12677/MET.2016.51003</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.17189-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">谢川, 张纯伟, 刘志峰. AT89C2051 单片机的智能涡轮流量计的设计[J]. 仪表技术与传感器, 2007, 43(10): 7-9.</mixed-citation></ref><ref id="hanspub.17189-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">张涛. 燃气体积修正仪校准方法研究[J]. 计量学报, 2015, 36(6): 15-19.</mixed-citation></ref><ref id="hanspub.17189-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">De Oliveira, E.C. and Campos Lourenço, T. (2013) Comparison of Different Approaches to Calculate a Final Meter Factor for Rotary-Type Natural Gas Displacement Meters. Flow Measurement and Instrumentation, 30, 160-165. 
&lt;br&gt;http://dx.doi.org/10.1016/j.flowmeasinst.2013.02.005</mixed-citation></ref><ref id="hanspub.17189-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">郭天祥. 新概念51单片机C语言教程[M]. 北京: 电子工业出版社, 2009.</mixed-citation></ref><ref id="hanspub.17189-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">李群芳, 张士军, 黄建. 单片微型计算机[M]. 北京: 电子工业出版社, 2008.</mixed-citation></ref><ref id="hanspub.17189-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">陆丽丽. 基于单片机的智能涡轮流量计显示仪的设计[J]. 机床与液压, 2011, 39(12): 51-53.</mixed-citation></ref></ref-list></back></article>