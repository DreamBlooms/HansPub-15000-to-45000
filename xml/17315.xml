<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JISP</journal-id><journal-title-group><journal-title>Journal of Image and Signal Processing</journal-title></journal-title-group><issn pub-type="epub">2325-6753</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JISP.2016.52008</article-id><article-id pub-id-type="publisher-id">JISP-17315</article-id><article-categories><subj-group subj-group-type="heading"><subject>JISP20160200000_98045008.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于岩屑图像的火山岩岩性识别
  Lithologic Identification of Volcanic Based on Cutting Figures
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>罗</surname><given-names>韬</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>余</surname><given-names>艳梅</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>滕</surname><given-names>奇志</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>四川大学电子信息学院图像信息研究所，四川 成都</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1037594232@qq.com(罗韬)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>05</day><month>04</month><year>2016</year></pub-date><volume>05</volume><issue>02</issue><fpage>58</fpage><lpage>65</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文提出了一种基于岩屑图像的火山岩岩性识别方法，首先通过实验分析并确定了对火山岩岩屑识别率较高的颜色与纹理特征；其次通过对这些特征的组合研究，提出了基于线性加权的特征融合法；最后采用极限学习机作为分类器，对特征融合后的火山岩岩屑进行测试。最终实验表明，融合特征对于火山岩岩屑能达到92.05%的识别率，为火山岩的岩性识别提供了一种可靠的参考依据。 In this paper, a new method based on features fusion for volcanic rocks lithology recognition is proposed. First, the color and texture with higher recognition rate are analyzed and determined through experiments. Secondly, a method based on feature fusion is proposed by combining the features into a new integration feature. And finally the extreme learning machine is used as the classifier. Experiments show that the recognition accuracy of integration features is up to 92.05%. This method provides a reliable reference for lithology identification of volcanic.
    
  
 
</p></abstract><kwd-group><kwd>岩屑图像，特征融合，极限学习机，火山岩识别, Cutting Figures</kwd><kwd> Feature Fusion</kwd><kwd> Extreme Learning Machine</kwd><kwd> Volcanic Recognition</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于岩屑图像的火山岩岩性识别<sup> </sup></title><p>罗韬，余艳梅<sup>*</sup>，滕奇志</p><p>四川大学电子信息学院图像信息研究所，四川 成都</p><disp-formula id="hanspub.17315-formula68"><graphic xlink:href="http://html.hanspub.org/file/2-2670072x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年3月20日；录用日期：2016年4月3日；发布日期：2016年4月8日</p><disp-formula id="hanspub.17315-formula69"><graphic xlink:href="http://html.hanspub.org/file/2-2670072x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文提出了一种基于岩屑图像的火山岩岩性识别方法，首先通过实验分析并确定了对火山岩岩屑识别率较高的颜色与纹理特征；其次通过对这些特征的组合研究，提出了基于线性加权的特征融合法；最后采用极限学习机作为分类器，对特征融合后的火山岩岩屑进行测试。最终实验表明，融合特征对于火山岩岩屑能达到92.05%的识别率，为火山岩的岩性识别提供了一种可靠的参考依据。</p><p>关键词 :岩屑图像，特征融合，极限学习机，火山岩识别</p><disp-formula id="hanspub.17315-formula70"><graphic xlink:href="http://html.hanspub.org/file/2-2670072x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>岩屑录井是石油地质勘探的一个重要环节，而岩性的判断是岩屑录井技术的关键部分。针对岩性的判定，目前主流的方法是测井资料法 [<xref ref-type="bibr" rid="hanspub.17315-ref1">1</xref>] 。此类方法是根据事先测定的测井资料来判定，利用不同的测井曲线作为特征输入，再使用不同的分类器来判别；或者直接利用测井曲线的形状来判别。这类方法对于测井曲线的依赖性很大，使用也有其局限性。鉴于此，近几年许多学者将数字成像技术与模式识别结合起来并成功的应用于岩屑识别 [<xref ref-type="bibr" rid="hanspub.17315-ref2">2</xref>] 。例如张国英等 [<xref ref-type="bibr" rid="hanspub.17315-ref3">3</xref>] 利用主成份分析作为特征，杨晓明 [<xref ref-type="bibr" rid="hanspub.17315-ref4">4</xref>] 等利用和差直方图作为特征，王冬强 [<xref ref-type="bibr" rid="hanspub.17315-ref5">5</xref>] 等利用纹理作为特征分别来识别岩屑。这些方法在岩屑的岩性识别方面有较好的效果，但大多针对的是沉积岩岩屑，对火山岩的岩屑识别较少提及。因此如何快速而准确的对火山岩岩屑进行分类识别，也是需要讨论的有意义的话题。</p></sec><sec id="s4"><title>2. 火山岩特征选取</title><p>火山岩是因为地球内部地壳剧烈运动，岩浆沿着缝隙上升，从火山通道喷出地表形成的。高温岩浆的液态冷却会结晶形成多种矿物，矿物再紧密结合成多种火山岩。因此火山岩的成份比较复杂，表现形式也更为多种多样。为了寻找比较好的火山岩特征，我们首先通过实物来观察其主要特征，再通过实验对其进行验证。</p><p>本文选择了火山岩岩屑中比较常见的凝灰岩与玄武岩作为样本，如图1所示。从实物上来看，无论是凝灰岩还是玄武岩二者的颜色特征都很明显，区分度比较大，可以作为主要特征。另外二者表面大多有火山喷发时留下的微小气孔或者岩浆冷却结晶形成的微小颗粒，因此纹理特征也具有一定的区分度，可以作为次要特征。</p><p>为了验证观察结果，本文作者提取了岩屑识别 [<xref ref-type="bibr" rid="hanspub.17315-ref6">6</xref>] 中常用的颜色，纹理以及边缘特征，并使用BP神经网络作为分类器。用到的颜色特征包括：颜色直方图，主色调直方图，颜色矩；纹理特征包括：灰度共生矩阵(GLCM)，局部二进制式(LBP)，和差直方图；边缘特征则是边缘方向直方图(EOH)。训练样本包括灰色凝灰岩29个，紫色玄武岩43个。测试样本为42个灰色凝灰岩，44个紫色玄武岩，识别率为正确识别的岩屑样本数与岩屑样本总数的比值，具体结果可以见表1。</p><p>表1的数据显示颜色矩的识别效果最好，可以达到88.75%。从总体上看，颜色特征对于火山岩的区分度是最大的，其次是纹理特征，至于边缘特征基本上没有区分度，这也与上面的观察结果相吻合。而且同样是颜色特征，颜色矩与颜色直方图的效果也是存在一定的差距；纹理特征中，灰度共生矩阵与局部二进制式则相差更大。由此可见，特征的选择对于识别效果的影响比较大。上面只选择了两类样本进</p><p>行比较，为了验证这三种特征对其他类别也有效，本文作者以灰色凝灰岩、灰黑色凝灰岩、深灰色凝灰岩、杂色凝灰岩、紫色玄武岩为样本对颜色特征再次进行测试，实验结果见表2。</p><p>由表2来看，对于颜色比较相近的几类岩屑来说，颜色矩的识别率仍然在80%以上，可见颜色特征是火山岩比较重要的特征。</p></sec><sec id="s5"><title>3. 特征融合</title><p>单个的特征往往无法完全反映样本的真实特征，因此在特征选择领域中，研究者常常将不同的特征组合成新的特征 [<xref ref-type="bibr" rid="hanspub.17315-ref7">7</xref>] 。由于主色调直方图、颜色矩和灰度共生矩阵这三种特征对于火山岩的识别比较有效，可以考虑将这三种特征组合起来，组合方式采用特征维数扩展，即将不同维数的特征以维数相加的方式进行拓展。为了更好的与前面的实验数据做对比，本文采用维数拓展后的特征对相同的岩屑样本进行测试，具体情况见表3。</p><p>图1. 火山岩岩屑样本。(a) 紫色玄武岩图；(b) 灰色凝灰岩</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Volcanic identification of common feature</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >特征</th><th align="center" valign="middle" >颜色直方图</th><th align="center" valign="middle" >主色调直方图</th><th align="center" valign="middle" >颜色矩</th><th align="center" valign="middle" >灰度共生矩阵</th><th align="center" valign="middle" >局部二进制式</th><th align="center" valign="middle" >和差直方图</th><th align="center" valign="middle" >边缘方向直方图</th></tr></thead><tr><td align="center" valign="middle" >识别率</td><td align="center" valign="middle" >70.85%</td><td align="center" valign="middle" >84.60%</td><td align="center" valign="middle" >88.75%</td><td align="center" valign="middle" >81.36%</td><td align="center" valign="middle" >58.29%</td><td align="center" valign="middle" >70.38%</td><td align="center" valign="middle" >59.24%</td></tr></tbody></table></table-wrap><p>表1. 常用特征的火山岩识别</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Volcanic identification of colour feature</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >特征类别 岩屑类别</th><th align="center" valign="middle" >灰色凝灰岩</th><th align="center" valign="middle" >灰黑色凝灰岩</th><th align="center" valign="middle" >深灰色凝灰岩</th><th align="center" valign="middle" >杂色凝灰岩</th><th align="center" valign="middle" >紫色玄武岩</th></tr></thead><tr><td align="center" valign="middle" >颜色直方图</td><td align="center" valign="middle" >68.95%</td><td align="center" valign="middle" >71.31%</td><td align="center" valign="middle" >72.63%</td><td align="center" valign="middle" >73.24%</td><td align="center" valign="middle" >75.89%</td></tr><tr><td align="center" valign="middle" >主色调直方图</td><td align="center" valign="middle" >73.71%</td><td align="center" valign="middle" >75.66%</td><td align="center" valign="middle" >83.28%</td><td align="center" valign="middle" >77.49%</td><td align="center" valign="middle" >80.05%</td></tr><tr><td align="center" valign="middle" >颜色矩</td><td align="center" valign="middle" >80.15%</td><td align="center" valign="middle" >81.88%</td><td align="center" valign="middle" >82.46%</td><td align="center" valign="middle" >82.51%</td><td align="center" valign="middle" >83.43%</td></tr></tbody></table></table-wrap><p>表2. 颜色特征的火山岩识别</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Volcanic identification of extend dimension feature</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >特征组合</th><th align="center" valign="middle" >主色调直方图</th><th align="center" valign="middle" >颜色矩</th><th align="center" valign="middle" >灰度共生矩阵</th><th align="center" valign="middle" >主色调直方图 +灰度共生矩阵</th><th align="center" valign="middle" >颜色矩 + 灰度共生矩阵</th><th align="center" valign="middle" >主色调直方图 + 颜色矩</th><th align="center" valign="middle" >主色调直方图 + 灰度共生矩阵 + 颜色矩</th></tr></thead><tr><td align="center" valign="middle" >特征维数</td><td align="center" valign="middle" >6维</td><td align="center" valign="middle" >9维</td><td align="center" valign="middle" >6维</td><td align="center" valign="middle" >12维</td><td align="center" valign="middle" >15维</td><td align="center" valign="middle" >15维</td><td align="center" valign="middle" >21维</td></tr><tr><td align="center" valign="middle" >识别率</td><td align="center" valign="middle" >84.60%</td><td align="center" valign="middle" >88.75%</td><td align="center" valign="middle" >81.36%</td><td align="center" valign="middle" >82.14%</td><td align="center" valign="middle" >87.29%</td><td align="center" valign="middle" >88.38%</td><td align="center" valign="middle" >77.24%</td></tr></tbody></table></table-wrap><p>表3. 特征维数拓展的火山岩识别</p><p>从表3可以看出对于特征的直接组合并不能提升火山岩的识别率，甚至还有可能出现大幅度下滑，究其原因在于简单的特征维数的增加，并不一定能真实的反映各个特征在样本中的比重，反而有可能造成特征的相互干扰，从而导致识别率的降低。</p><p>基于此本文提出了基于线性加权的特征融合。即在保持原有特征类别不变的情况下，将原来单纯的特征叠加方式改为依据各类别特征所占比重，将特征进行线性加权融合成新的特征。本文设定了一个加权比重值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x12_hanspub.png" xlink:type="simple"/></inline-formula>，并将主色调直方图(MCH)，与颜色矩(CM)以及灰度共生矩阵(GLCM)作为输入，组合方式如式(1)所示：</p><disp-formula id="hanspub.17315-formula71"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x14_hanspub.png" xlink:type="simple"/></inline-formula>用来调节特征<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x15_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x16_hanspub.png" xlink:type="simple"/></inline-formula>的权值比重，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x17_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x18_hanspub.png" xlink:type="simple"/></inline-formula>分别表示两种不同的特征，C表示融合后的新特征。</p><p>为了验证融合后特征的识别效果，本文采用相同的岩屑样本进行测试，具体情况见表4。</p><p>从表4可以看出当颜色矩特征的加权值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x19_hanspub.png" xlink:type="simple"/></inline-formula>取0.8，灰度共生矩阵特征的加权值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x20_hanspub.png" xlink:type="simple"/></inline-formula>取0.2时，识别率最高可达91.29%。可见在以颜色为主特征的情况下适当加权纹理特征能够更好的表示火山岩的特征。新的融合特征能够在不增加特征维数的情况下提升火山岩的识别率。</p></sec><sec id="s6"><title>4. 分类器的选择</title><p>从数学角度来说，利用融合特征来判定岩屑的类别是一种非线性问题，前面采用的BP神经网络能够很好地拟合实验数据。但是BP神经网络需要人为设置大量的参数，训练时间过长，且容易陷入局部最优解。因此，BP神经网络并不是最合适的分类器选择。极限学习机(extreme learning machine) ELM是一种简单易用、有效的单隐层前馈神经网络(SLFNs)学习算法，2004年由南洋理工大学黄广斌副教授提出 [<xref ref-type="bibr" rid="hanspub.17315-ref8">8</xref>] 。它只需要设置网络的隐层节点个数，在算法执行过程中不需要调整网络的输入权值以及隐元的偏置，并且产生唯一的最优解，具有学习速度快且泛化性能好的优点 [<xref ref-type="bibr" rid="hanspub.17315-ref9">9</xref>] 。因此，本文将其引入火山岩的岩屑识别过程。</p><p>给定一个N-L-T结构且激励函数为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x21_hanspub.png" xlink:type="simple"/></inline-formula>的单隐层前馈神经网络，N表示输入层的样本个数，L为隐含层的节点个数，对于N个训练样本集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x22_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x23_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x24_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x25_hanspub.png" xlink:type="simple"/></inline-formula>表示输入的第i个样本，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x26_hanspub.png" xlink:type="simple"/></inline-formula>表示相应的标签值，则有下式：</p><disp-formula id="hanspub.17315-formula72"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x27_hanspub.png"  xlink:type="simple"/></disp-formula><p>以矩阵形式表示公式(2)：</p><disp-formula id="hanspub.17315-formula73"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x28_hanspub.png"  xlink:type="simple"/></disp-formula><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> Volcanic identification of fusion feature</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >融合 特征C</th><th align="center" valign="middle" >主色调 直方图</th><th align="center" valign="middle" >颜色矩</th><th align="center" valign="middle" >灰度共 生矩阵</th><th align="center" valign="middle" >主色调直方图 + 灰度共生矩阵</th><th align="center" valign="middle" >颜色矩 + 灰度共生矩阵</th><th align="center" valign="middle" >主色调直方图 + 颜色矩</th></tr></thead><tr><td align="center" valign="middle" >特征维数</td><td align="center" valign="middle" >6维</td><td align="center" valign="middle" >9维</td><td align="center" valign="middle" >6维</td><td align="center" valign="middle" >6维</td><td align="center" valign="middle" >9维</td><td align="center" valign="middle" >9维</td></tr><tr><td align="center" valign="middle" >ω取值</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0.7</td><td align="center" valign="middle" >0.8</td><td align="center" valign="middle" >0.4</td></tr><tr><td align="center" valign="middle" >识别率</td><td align="center" valign="middle" >84.60%</td><td align="center" valign="middle" >88.75%</td><td align="center" valign="middle" >81.36%</td><td align="center" valign="middle" >88.67%</td><td align="center" valign="middle" >91.29%</td><td align="center" valign="middle" >89.16%</td></tr></tbody></table></table-wrap><p>表4. 融合特征的火山岩识别</p><disp-formula id="hanspub.17315-formula74"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x30_hanspub.png" xlink:type="simple"/></inline-formula>为第j个隐层节点与输出节点之间的权值；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x31_hanspub.png" xlink:type="simple"/></inline-formula>为输入节点与第j个隐层节点之间的输入权值；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x32_hanspub.png" xlink:type="simple"/></inline-formula>为第j个节点的偏置值；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x33_hanspub.png" xlink:type="simple"/></inline-formula>为第i个输入样本的输出值。</p><p>传统的单隐层前馈神经网络一般采用误差反向传播算法(BP) [<xref ref-type="bibr" rid="hanspub.17315-ref10">10</xref>] 来确定<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x34_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x35_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x36_hanspub.png" xlink:type="simple"/></inline-formula>这些参数值，BP算法每次迭代都需要更新这些参数值，但是在输入大量样本的情况下，迭代花费的时间过长，BP算法很难满足及时性需求。</p><p>ELM则不需要再对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x37_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x38_hanspub.png" xlink:type="simple"/></inline-formula>进行任何调整，只需要求出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x39_hanspub.png" xlink:type="simple"/></inline-formula>即可，省去了最耗时间的迭代求参这一步骤。而对于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x40_hanspub.png" xlink:type="simple"/></inline-formula>的求解，有两种情况：</p><p>1) 当隐含层节点数等于输入样本数，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x41_hanspub.png" xlink:type="simple"/></inline-formula>时，ELM输出可以以0误差逼近于训练样本的标准输出，即</p><disp-formula id="hanspub.17315-formula75"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x42_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17315-formula76"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x43_hanspub.png"  xlink:type="simple"/></disp-formula><p>以矩阵形式表示公式(5)</p><disp-formula id="hanspub.17315-formula77"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x44_hanspub.png"  xlink:type="simple"/></disp-formula><p>隐含层输出矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x45_hanspub.png" xlink:type="simple"/></inline-formula>可逆，则：</p><disp-formula id="hanspub.17315-formula78"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x46_hanspub.png"  xlink:type="simple"/></disp-formula><p>这样公式(7)求出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x47_hanspub.png" xlink:type="simple"/></inline-formula>快速而精准，但实际应用中，样本数往往远远大于隐含层节点数，此时需要用另一种方法求解。</p><p>2) 当样本数大于隐含层节点数，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x48_hanspub.png" xlink:type="simple"/></inline-formula>时，此时<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x49_hanspub.png" xlink:type="simple"/></inline-formula>不可逆。ELM输出可以以 误差逼近于训练样本的标准输出，即</p><disp-formula id="hanspub.17315-formula79"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x50_hanspub.png"  xlink:type="simple"/></disp-formula><p>即：</p><disp-formula id="hanspub.17315-formula80"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x51_hanspub.png"  xlink:type="simple"/></disp-formula><p>由极小范数求解准则可以求出最小二乘解：</p><disp-formula id="hanspub.17315-formula81"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670072x52_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x53_hanspub.png" xlink:type="simple"/></inline-formula>为隐含层输出矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x54_hanspub.png" xlink:type="simple"/></inline-formula>的广义逆，可以通过正交法求出。</p><p>ELM算法流程如下：</p><p>1) 训练过程：</p><p>输入：训练样本集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x55_hanspub.png" xlink:type="simple"/></inline-formula>，隐含层的节点个数L，激励函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x56_hanspub.png" xlink:type="simple"/></inline-formula></p><p>输出：输出权重<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x57_hanspub.png" xlink:type="simple"/></inline-formula></p><p>i. 随机生成<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x58_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x59_hanspub.png" xlink:type="simple"/></inline-formula>值；</p><p>ii. 由输入值以及随机生成的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x60_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x61_hanspub.png" xlink:type="simple"/></inline-formula>值确定隐含层输出矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x62_hanspub.png" xlink:type="simple"/></inline-formula>；</p><p>iii. 由公式(11)求出输出权值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x63_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>2) 测试过程:</p><p>输入：测试样本集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x64_hanspub.png" xlink:type="simple"/></inline-formula>，隐含层节点数L，激励函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x65_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x66_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x67_hanspub.png" xlink:type="simple"/></inline-formula>以及<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x68_hanspub.png" xlink:type="simple"/></inline-formula></p><p>输出：测试样本标签值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x69_hanspub.png" xlink:type="simple"/></inline-formula></p><p>i. 由输入值确定隐含层输出矩阵<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x70_hanspub.png" xlink:type="simple"/></inline-formula>；</p><p>ii. 由公式(3)求出标签值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2670072x71_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec><sec id="s7"><title>5. 实验与分析</title><p>本次实验中训练样本共有340个，其中凝灰岩153个，分为灰色凝灰岩、灰黑色凝灰岩、深灰色凝灰岩、杂色凝灰岩、紫色凝灰岩这5小类；另外还有玄武岩187个，包括灰黑色玄武岩、深灰色玄武岩、杂色玄武岩、紫色玄武岩这4小类。测试样本共有422个，其中凝灰岩218个，玄武岩204个，小类划分情况与训练样本相同。本次实验采用的是融合特征，并且对BP神经网络与ELM做了对比测试，由于ELM输入权值与偏置值都是随机选择的，导致每次识别结果都有所不同，因此其识别率为多次测量取平均值，具体测试情况可以见表5。</p><p>从表5可以看出，ELM在识别率上相比于BP神经网络有一定的提升，说明ELM在火山岩的岩性识别上还是具有一定的泛化优势，能够有效识别火山岩。在时间上更是缩短为原来的1/4左右，这在工程应用上也是一个很大的提升。</p><p>为了显示工程上的实际效果，本文测试了油田部门现场采集的火山岩岩屑。如图2所示，现场图片中含有深灰色凝灰岩与杂色凝灰岩两种岩屑。</p><p>效果图中蓝色代表杂色凝灰岩，灰色代表深灰色凝灰岩，黑色空白处代表背景。图3为专家判别的真实效果图，图4与图5分别为BP神经网络与本文改进后的实际效果图。从二者的效果图来看，两种方法都能将岩屑大致识别出来，为了进一步比较二者的差异，本文计算了3、4、5效果图中各类颜色岩屑的面积以及与总岩屑面积的百分比，通过数值分析可以判别各类算法的识别效果，具体情况见表6。</p><table-wrap id="table5" ><label><xref ref-type="table" rid="table5">Table 5</xref></label><caption><title> Volcanic identification of multi-clas</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  ></th><th align="center" valign="middle"  rowspan="2"  >岩屑类别</th><th align="center" valign="middle"  rowspan="2"  >训练样本数</th><th align="center" valign="middle"  rowspan="2"  >测试样本数</th><th align="center" valign="middle"  colspan="4"  >分类器</th></tr></thead><tr><td align="center" valign="middle"  colspan="4"  >BP神经网络 极限学习机</td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >识别情况</td><td align="center" valign="middle" >训练时间(s)</td><td align="center" valign="middle" >识别情况</td><td align="center" valign="middle" >训练时间(s)</td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >灰色凝灰岩</td><td align="center" valign="middle" >29</td><td align="center" valign="middle" >42</td><td align="center" valign="middle" >33/42</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >36/42</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >灰黑色凝灰岩</td><td align="center" valign="middle" >30</td><td align="center" valign="middle" >24</td><td align="center" valign="middle" >19/24</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >20/24</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >深灰色凝灰岩</td><td align="center" valign="middle" >28</td><td align="center" valign="middle" >47</td><td align="center" valign="middle" >42/47</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >43/47</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >杂色凝灰岩</td><td align="center" valign="middle" >33</td><td align="center" valign="middle" >44</td><td align="center" valign="middle" >39/44</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >40/44</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >紫色凝灰岩</td><td align="center" valign="middle" >33</td><td align="center" valign="middle" >61</td><td align="center" valign="middle" >55/61</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >59/61</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >灰黑色玄武岩</td><td align="center" valign="middle" >53</td><td align="center" valign="middle" >54</td><td align="center" valign="middle" >49/54</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >50/54</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >深灰色玄武岩</td><td align="center" valign="middle" >43</td><td align="center" valign="middle" >71</td><td align="center" valign="middle" >63/71</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >66/71</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >杂色玄武岩</td><td align="center" valign="middle" >48</td><td align="center" valign="middle" >35</td><td align="center" valign="middle" >30/35</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >32/35</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" >紫色玄武岩</td><td align="center" valign="middle" >43</td><td align="center" valign="middle" >44</td><td align="center" valign="middle" >40/44</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >42/44</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >总计</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >340</td><td align="center" valign="middle" >422</td><td align="center" valign="middle" >87.7%</td><td align="center" valign="middle" >12.4</td><td align="center" valign="middle" >92.05%</td><td align="center" valign="middle" >3.7</td></tr></tbody></table></table-wrap><p>表5. 多分类火山岩识别</p><p>图2. 现场岩屑图</p><p>图3. 专家识别效果图</p><p>图4. BP神经网络识别效果图</p><p>图5. 本文改进算法识别效果图</p><table-wrap id="table6" ><label><xref ref-type="table" rid="table6">Table 6</xref></label><caption><title> The table of cutting content</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >岩屑组分</th><th align="center" valign="middle"  colspan="2"  >面积(mm<sup>2</sup>)</th><th align="center" valign="middle" >含量(%)</th></tr></thead><tr><td align="center" valign="middle"  rowspan="3"  >杂色凝灰岩</td><td align="center" valign="middle" >实际含量</td><td align="center" valign="middle" >72.300</td><td align="center" valign="middle" >59.1</td></tr><tr><td align="center" valign="middle" >本文改进算法</td><td align="center" valign="middle" >66.585</td><td align="center" valign="middle" >54.4</td></tr><tr><td align="center" valign="middle" >BP神经网络算法</td><td align="center" valign="middle" >62.764</td><td align="center" valign="middle" >51.3</td></tr><tr><td align="center" valign="middle"  rowspan="3"  >深灰色凝灰岩</td><td align="center" valign="middle" >实际含量</td><td align="center" valign="middle" >50.202</td><td align="center" valign="middle" >40.9</td></tr><tr><td align="center" valign="middle" >本文改进算法</td><td align="center" valign="middle" >55.917</td><td align="center" valign="middle" >45.6</td></tr><tr><td align="center" valign="middle" >BP神经网络算法</td><td align="center" valign="middle" >59.739</td><td align="center" valign="middle" >48.7</td></tr></tbody></table></table-wrap><p>表6. 岩屑成份含量表</p><p>从表6可以看出，杂色凝灰岩的真实含量占整个岩屑比例为59.1%，本文改进后的算法判别中杂色凝灰岩所占比例为54.4%，而BP神经网络算法判别中杂色凝灰岩所占比例为51.3%，相比较而言本文改进后的算法判别更贴近真实效果。</p></sec><sec id="s8"><title>6. 总结</title><p>本文探索了基于岩屑图像的火山岩岩性识别法，通过观察并实验验证了以颜色，纹理，边缘为特征的火山岩岩性的识别，在此基础上提出了基于线性加权的特征融合，并将ELM分类器引入火山岩的岩屑识别过程。实验证明，改进后的方法不但可以提升火山岩的识别率，并且能够大幅度降低训练时间，在实际工程中，能够有效提高工作效率。</p></sec><sec id="s9"><title>文章引用</title><p>罗 韬,余艳梅,滕奇志. 基于岩屑图像的火山岩岩性识别 Lithologic Identification of Volcanic Based on Cutting Figures[J]. 图像与信号处理, 2016, 05(02): 58-65. http://dx.doi.org/10.12677/JISP.2016.52008</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.17315-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">赵辉, 司马立强, 戴思华. 火成岩岩性测井识别的思路和方法[J]. 大庆石油地质与开发, 2012, 31(4): 159-162.</mixed-citation></ref><ref id="hanspub.17315-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">杨晓敏, 冉飞, 吴炜, 等. 一种基于支持向量机与纹理的岩屑识别算法[J]. 石油化工高等学校学报, 2009, 22(2): 88-92.</mixed-citation></ref><ref id="hanspub.17315-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">张国英, 王娜娜, 张润生, 等. 基于主成分分析的BP神经网络在岩性识别中的应用[J]. 北京石油化工学院学报, 2008, 16(3): 43-46.</mixed-citation></ref><ref id="hanspub.17315-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">杨晓明, 李文东, 慈兴华, 等. 基于和差直方图的岩屑纹理分析与分类识别[J]. 中国海洋大学学报, 2011, 41(3): 99-104.</mixed-citation></ref><ref id="hanspub.17315-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">王东强, 李文东, 刘宗林, 等. 基于傅立叶变换的岩屑纹理特征提取及岩性识别方法研究[J]. 石油实验地质, 2008, 30(4): 420-423.</mixed-citation></ref><ref id="hanspub.17315-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">姚金铸. 岩屑图像识别系统的研究与应用[D]: [硕士学位论文]. 成都: 四川大学, 2014.</mixed-citation></ref><ref id="hanspub.17315-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Du, X. and Zhang, R.Q. (2014) Fusing Color and Texture Features for Blurred Face Recognition. Infrared and Laser Engineering, 43, 4192-4197.</mixed-citation></ref><ref id="hanspub.17315-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Huang, G.B., Zhu, Q.Y. and Siew, C.-K. (2004) Extreme Learning Machine: A New Learning Scheme of Feed forward Neural Networks. Proceedings of International Joint Conference on Neural Networks (IJCNN2004), Budapest, 25-29 July 2004, 985-990.</mixed-citation></ref><ref id="hanspub.17315-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Bulasundaram, S., Gupta, D. and Kapil (2014) 1-Norm Extreme Learning Machine for Regression and Multiclass Classification Using Newton Method. Neurocomputing, 128, 4-14. http://dx.doi.org/10.1016/j.neucom.2013.03.051</mixed-citation></ref><ref id="hanspub.17315-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">樊振宇. BP神经网络模型与学习算法[J]. 软件导刊, 2011, 10(7): 66-68.</mixed-citation></ref></ref-list></back></article>