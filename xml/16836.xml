<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">APP</journal-id><journal-title-group><journal-title>Applied  Physics</journal-title></journal-title-group><issn pub-type="epub">2160-7567</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/APP.2016.61001</article-id><article-id pub-id-type="publisher-id">APP-16836</article-id><article-categories><subj-group subj-group-type="heading"><subject>APP20160100000_88159419.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  傅里叶变换轮廓术的MATLAB GUI设计与仿真
  The Design and Simulation of MATLAB GUI Based on Fourier Transform Profilometry
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>孙</surname><given-names>漫凝</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>丽娟</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>束</surname><given-names>益梅</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>程</surname><given-names>菊</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>边</surname><given-names>心田</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>淮阴师范学院，江苏省现代检测技术与智能系统重点建设实验室，江苏 淮安</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>smncissy@163.com(孙漫)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>28</day><month>01</month><year>2016</year></pub-date><volume>06</volume><issue>01</issue><fpage>1</fpage><lpage>6</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   在傅里叶变换轮廓术的基础上，利用MATLAB的用户界面设计了基于傅里叶变换轮廓术的仿真交互界面，给出了三维面形测量的仿真结果。该平台具有人机界面友好、操作方便、速度快等优点，将三维面形测量和实验很好的结合起来。利用理论分析和计算机模拟，为三维测量的教学和研究工作开辟了新的途径。 On the basis of Fourier transform profilometry, we design interactive simulation interface of Fourier transform profilometry (FTP) with MATLAB GUI, then we can get the simulation results of three-dimensional shape measurement. The platform has the advantages of friendly man-machine interface, convenient operation, fast speed and so on; at the same time it can combine the three- dimensional shape measurement with experiment. By using theoretical analysis and computer simulation, a new approach has been opened up for the teaching and research of three-dimen- sional measurement.
    
  
 
</p></abstract><kwd-group><kwd>三维测量，GUI界面，傅里叶变换轮廓术, Three-Dimensional Measurement</kwd><kwd> GUI Interface</kwd><kwd> Fourier Transform Profilometry</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>傅里叶变换轮廓术的MATLAB GUI设计与仿真<sup> </sup></title><p>孙漫凝<sup>*</sup>，杨丽娟，束益梅，程菊，边心田</p><p>淮阴师范学院，江苏省现代检测技术与智能系统重点建设实验室，江苏 淮安</p><disp-formula id="hanspub.16836-formula21"><graphic xlink:href="http://html.hanspub.org/file/1-1270218x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年1月5日；录用日期：2016年1月22日；发布日期：2016年1月28日</p><disp-formula id="hanspub.16836-formula22"><graphic xlink:href="http://html.hanspub.org/file/1-1270218x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>在傅里叶变换轮廓术的基础上，利用MATLAB的用户界面设计了基于傅里叶变换轮廓术的仿真交互界面，给出了三维面形测量的仿真结果。该平台具有人机界面友好、操作方便、速度快等优点，将三维面形测量和实验很好的结合起来。利用理论分析和计算机模拟，为三维测量的教学和研究工作开辟了新的途径。</p><p>关键词 :三维测量，GUI界面，傅里叶变换轮廓术</p><disp-formula id="hanspub.16836-formula23"><graphic xlink:href="http://html.hanspub.org/file/1-1270218x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>光学三维传感具有非接触性、测量精度高等优点，在逆向工程、工业检测、机器视觉、文物保护、生物医学等领域具有广泛的应用[<xref ref-type="bibr" rid="hanspub.16836-ref1">1</xref>] -[<xref ref-type="bibr" rid="hanspub.16836-ref5">5</xref>] 。其中，基于条纹投影的傅里叶变换轮廓术 [<xref ref-type="bibr" rid="hanspub.16836-ref6">6</xref>] (FTP)具有单帧获取、高分辨率、实时性好等优点，自1983年FTP提出 [<xref ref-type="bibr" rid="hanspub.16836-ref7">7</xref>] 以来，受到人们广泛的关注。</p><p>MATLAB因其强大的数值计算、数据分析和可视化仿真能力，在高校和科研机构得到广泛的应用。MATLAB为用户提供了功能强大的可视化图形界面开发环境(GUI)，通过GUI，用户可以快捷方便地创建GUI应用程序，可以根据用户设计的GUI布局，自动生成M文件的框架，用户使用这一框架编写自己的应用程序。GUI用户界面友好、使用简单，运用广泛，能够快速、方便地进行某种技术或方法的演示，将GUI运用到三维测量中也为实验演示与教学提供了新的途径 [<xref ref-type="bibr" rid="hanspub.16836-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.16836-ref8">8</xref>] 。</p></sec><sec id="s4"><title>2. 基本原理</title><sec id="s4_1"><title>2.1. 光栅模型</title><p>我们所使用的傅里叶变换方式的测量系统的光路图如下图1所示，A为投影仪的出射光瞳，摄像系统光轴C0垂直于参考面并且与投影系统光轴AO相交于O点，投影光栅的栅线垂直于AOC的平面，不失一般性，设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x10_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x11_hanspub.png" xlink:type="simple"/></inline-formula>，AO与其参考面上发现的夹角为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x12_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>图1. FTP测量系统光路图</p><p>不失一般性，我们可以设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x14_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x15_hanspub.png" xlink:type="simple"/></inline-formula>，由几何知识知 [<xref ref-type="bibr" rid="hanspub.16836-ref9">9</xref>] ：</p><disp-formula id="hanspub.16836-formula24"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-1270218x16_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x17_hanspub.png" xlink:type="simple"/></inline-formula>为投影仪的焦距。</p><p>投影到参考面上的条纹是等周期分布的，使其周期为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x18_hanspub.png" xlink:type="simple"/></inline-formula>，其参考面上的相位分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x19_hanspub.png" xlink:type="simple"/></inline-formula>是坐标<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x20_hanspub.png" xlink:type="simple"/></inline-formula>的线性函数，投影仪上E'点与参考面上的F点的相位相对应，因此由(1)式可得，投影光栅的相位分布函数 [<xref ref-type="bibr" rid="hanspub.16836-ref9">9</xref>] 为：</p><disp-formula id="hanspub.16836-formula25"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-1270218x21_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s4_2"><title>2.2. 测量原理</title><p>测量系统的光路 [<xref ref-type="bibr" rid="hanspub.16836-ref5">5</xref>] 如图1所示，AO是投影光轴，CO是摄像系统的光轴，且CO垂直于参考平面并与投影光轴AO相交于O点，OF所在的平面为参考平面。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x22_hanspub.png" xlink:type="simple"/></inline-formula>是C点到参考平面的距离，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x23_hanspub.png" xlink:type="simple"/></inline-formula>是A点与C点之间的距离。D点和F点是参考平面上的两点，G点是物体上的一点。</p><p>我们采用正弦光栅投影到物体的表面上，经过物体表面的漫反射，CCD接收到参考光栅像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x24_hanspub.png" xlink:type="simple"/></inline-formula>和变形光栅像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x25_hanspub.png" xlink:type="simple"/></inline-formula>，然后对采集到的图像进行傅里叶变换、滤波、傅里叶逆变换等操作最终恢复出参考光栅<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x26_hanspub.png" xlink:type="simple"/></inline-formula>和变形光栅<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x27_hanspub.png" xlink:type="simple"/></inline-formula>的光场分布分布。被测物体的相位分布可表示 [<xref ref-type="bibr" rid="hanspub.16836-ref6">6</xref>] 为：</p><disp-formula id="hanspub.16836-formula26"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-1270218x28_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x29_hanspub.png" xlink:type="simple"/></inline-formula>表示取其复数的虚部，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x30_hanspub.png" xlink:type="simple"/></inline-formula>表示共轭运算。</p><p>从图1中，我们可以将三维表面上被测量的点G的高度记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x31_hanspub.png" xlink:type="simple"/></inline-formula>，由相似三角形<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x32_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x33_hanspub.png" xlink:type="simple"/></inline-formula>可以计算出物体表面的高度分布 [<xref ref-type="bibr" rid="hanspub.16836-ref5">5</xref>] 为：</p><disp-formula id="hanspub.16836-formula27"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-1270218x34_hanspub.png"  xlink:type="simple"/></disp-formula><p>由此我们可以得到物体的三维图像的恢复，同时，我们也可以从上式当中看出，物体恢复重建的精度取决于相位<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x35_hanspub.png" xlink:type="simple"/></inline-formula>的测量精度、光栅像的基频<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x36_hanspub.png" xlink:type="simple"/></inline-formula>以及投影系统光轴与摄影系统光轴的距离<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x37_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec></sec><sec id="s5"><title>3. FTP的GUI设计与仿真</title><sec id="s5_1"><title>3.1. 框架设计</title><p>打开MATLAB找到GUI设计的界面，然后在布局编辑器中设置以下控件：建立4个坐标轴对象用来显示所要投影条纹的图像、变形之后投影条纹的图像、恢复物体的三维图像以及误差分析的图像；建立4个静态文本标签，标注相应的控件提示；建立4个可编辑文本框，分别显示频率、系统参数d和L、以及噪声；建立4个滑动条用以控制频率、系统参数d和L、以及噪声；建立6个按钮，分别绘制所需的所有图像，以及整个操作过程的开始与结束。设置以上所有控件的String和Tag属性，便于程序的编辑，如图2所示。</p><p>在MATLAB里对于每一幅所要展示的图相对应的程序代码进行编写，定义相应的函数形式也可直接调用MATLAB里自身的函数设置。</p><p>1) 在初始程序中，我们可以设置条纹频率f的值为0.08，系统参数成像系统到参考面的距离L为1800 cm，系统参数投影系统与成像系统之间的距离d为900 cm，在条纹图强度上加入随机噪声为0.01。</p><p>图2. 仿真界面</p><p>相应的程序如下：</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x39_hanspub.png" xlink:type="simple"/></inline-formula>%设置条纹频率的大小</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x40_hanspub.png" xlink:type="simple"/></inline-formula>%设置系统参数L的大小</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x41_hanspub.png" xlink:type="simple"/></inline-formula>%设置系统参数d的大小</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x42_hanspub.png" xlink:type="simple"/></inline-formula>%设置噪声的大小</p><p>2) 就这4个滑动条而言，我们首先需要设置的就是滑动条的最大值和最小值，其次，我们要将滑动条显示的数据体现在动态文本框中。</p><p>相应的程序如下：</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x43_hanspub.png" xlink:type="simple"/></inline-formula>%获得条纹频率的滑动条数值</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-1270218x44_hanspub.png" xlink:type="simple"/></inline-formula>%将滑动条的数值显示在动态文本框</p><p>3) 调用pushbutton1_Callback函数，根据设置的具体参数绘制相应的初始条纹图、变形条纹图、恢复物体图以及误差分析图。程序调试完成后运行的界面如图3所示。</p></sec><sec id="s5_2"><title>3.2. 仿真平台的使用</title><p>在程序编写完成以后，我们首先根据经验将初始值先设定好，如图4中所示，条纹频率f设置为0.05，系统参数成像系统到参考面的距离L为1800 cm，系统参数投影系统与成像系统之间的距离d为900 cm，在条纹图强度上加入随机噪声为0.03，分别点击事先设定好的相应按钮，便会出现如下图所示的情况。我们能够清楚的看到，在将初始的条纹图进行一定程度上的变形后，可以明显的看到条纹的变形处有一个类似圆形的形状，而将其恢复时(见下图中的恢复物体图)，与原图相比较而言出现了一定的差距，通过变化，将其与原图像的差距进行弥补，而就是由于其与原图有一定的差距，从而使我们能够得到第四幅图——误差分析。</p><p>图3. 程序调试展示图</p><p>图4. 仿真运行界面图</p><p>模拟运行的过程当中，我们通过滑动条来不断的改变条纹频率f、系统参数L和d、以及噪声这4个参数，与此同时条纹图和恢复物体的图像都会随之发生相应的变化，从而由此产生不同的误差分析的结果 [<xref ref-type="bibr" rid="hanspub.16836-ref9">9</xref>] 。</p><p>与之相比，增大噪声的时候，恢复物体图的形状以及条纹图的形状也都有了一定的变化。</p><p>将条纹频率f、系统参数L和噪声固定不变，同时只变化系统参数d的示数，我们可以发现当d变大的时候，投影的条纹图和变形的条纹图的条纹间的宽度相应的有变宽。</p><p>如果保持条纹频率f、系统参数d和噪声不变，只变化系统参数L的时候，我们可以发现，当L变小的时候，投影的条纹图和变形的条纹图的条纹间的宽度相应的有变宽，同时误差分析的精度有下降。</p><p>而如果使得系统参数d、L和噪声不变，只变化条纹的频率f的时候，通过GUI设计模拟仿真我们可以看出，当L变小的时候，投影的条纹图和变形的条纹图条纹清晰宽度变宽，但是通过物体的变形条纹图就不那么明显了，同时恢复物体的形状也不是很好。</p></sec></sec><sec id="s6"><title>4. 结论</title><p>利用MATLAB GUI对傅里叶变换轮廓术进行仿真，编制了交互式界面，在界面中改变相关参数，可以仿真出不同参数条件下仿真测量的现象和结果，加深了学生对傅里叶变换轮廓术的理解，同时避免了学生在实验过程中由于仪器调节而产生的测量误差过大的问题，达到了理论与实验的结合。通过动态演示，整个测量过程形象直观，图像细致逼真，对于培养学生光学测量方面的兴趣具有积极的意义。</p></sec><sec id="s7"><title>基金项目</title><p>江苏省高等学校大学生实践创新训练计划项目，淮安市科技支撑计划(NO. HAG2014019)资助，淮阴师范学院青年优秀人才支撑计划(NO. 13HSQNZ03)。</p></sec><sec id="s8"><title>文章引用</title><p>孙漫凝,杨丽娟,束益梅,程 菊,边心田. 傅里叶变换轮廓术的MATLAB GUI设计与仿真 The Design and Simulation of MATLAB GUI Based on Fourier Transform Profilometry[J]. 应用物理, 2016, 06(01): 1-6. http://dx.doi.org/10.12677/APP.2016.61001</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16836-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">陈文静, 陈锋, 苏显渝, 等. CCD抽样过程对傅里叶变换轮廓术测量的影响[J]. 光电子•激光. 2005, 16(9): 1075-1076.</mixed-citation></ref><ref id="hanspub.16836-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">吴双卿, 张引, 张三元, 等. 傅里叶变换轮廓术物体三维形貌测量的系统分析及其坐标校准方法. 光学学报[J]. 2009, 29(10): 2781-2783.</mixed-citation></ref><ref id="hanspub.16836-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">朱江平, 苏显渝, 向立群. 红外人脸隐蔽性三维测量[J]. 激光杂志, 2010, 31(3): 14-16.</mixed-citation></ref><ref id="hanspub.16836-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Da, F.P. and Huang. H. (2012) A Novel Color Fringe Projection Based Fourier Transform 3D Shape Measurement Method. Optik, 123, 2233-2237. &lt;br&gt;http://dx.doi.org/10.1016/j.ijleo.2011.11.014</mixed-citation></ref><ref id="hanspub.16836-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">毛先富, 陈文静, 苏显渝. 傅里叶变换轮廓术新理论研究[J]. 中国激光, 2007, 34(1): 99-104.</mixed-citation></ref><ref id="hanspub.16836-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">苏显渝. 信息光学[M]. 北京: 科学出版社, 2011.</mixed-citation></ref><ref id="hanspub.16836-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Takeda, M. and Mutoh, K. (1983) Fourier Transform Profilometry for the Automatic Measurement of 3-D Object Shapes. Applied Optics, 22, 3977-3982. &lt;br&gt;http://dx.doi.org/10.1364/AO.22.003977</mixed-citation></ref><ref id="hanspub.16836-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">高峰, 赵文丽, 曹学成. 基于MATLAB GUI 的夫琅禾费单缝衍射仿真[J]. 山东农业大学学报(自然科学版), 2012, 43(3): 475-479.</mixed-citation></ref><ref id="hanspub.16836-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">马云秀, 边心田. 相位测量轮廓术中投影条纹畸变的研究[J]. 光电技术应用, 2013, 28(4): 83-85.</mixed-citation></ref></ref-list></back></article>