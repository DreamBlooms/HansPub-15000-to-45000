<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JOGT</journal-id><journal-title-group><journal-title>Journal of Oil and Gas Technology</journal-title></journal-title-group><issn pub-type="epub">2471-7185</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JOGT.2019.414049</article-id><article-id pub-id-type="publisher-id">JOGT-32035</article-id><article-categories><subj-group subj-group-type="heading"><subject>JOGT20190400000_96329352.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject><subject> 工程技术</subject><subject> 合作期刊</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于形态学的滤波消除泥浆脉冲信号基线漂移
  Removing Baseline Drifting in Mud Pulse Signals Based on Morphological Filtering
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>徐</surname><given-names>朝阳</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>任</surname><given-names>祥辉</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>穴</surname><given-names>强</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>曹</surname><given-names>乾洪</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>中国石油集团渤海钻探工程有限公司定向井技术服务分公司，天津 </addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>05</day><month>09</month><year>2019</year></pub-date><volume>41</volume><issue>04</issue><fpage>7</fpage><lpage>12</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   建立了用于消除泥浆脉冲信号基线漂移的形态学滤波器。采用最小二乘多项式拟合法、中值滤波法和形态学滤波法等3种方法处理泥浆脉冲PPM编码信号的基线漂移，并利用信噪比、均方根误差、归一化相关系数定量分析计算结果。对比结果表明，形态学滤波法消除泥浆脉冲信号基线漂移效果最佳。 A morphological filter for removing mud pulse baseline drifting was established. The baseline drifting of simulated PPM encoding signal of mud pulse was processed by least-square polynomial fitting, median filtering and morphological filtering methods, respectively. The results were quantitatively analyzed by using signal to noise ratio (S<sub>NR</sub>), root mean square error (E<sub>rms</sub>) and normalized correlation coefficient (C<sub>ncc</sub>). The analysis result shows that the morphological filtering method proposed is the best for removing the baseline drift of mud pulse signal. 
  
 
</p></abstract><kwd-group><kwd>随钻测量，泥浆脉冲信号，基线漂移，形态学滤波, MWD</kwd><kwd> Mud Pulse Signal</kwd><kwd> Baseline Drift</kwd><kwd> Morphological Filtering</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于形态学的滤波消除泥浆脉冲信号 基线漂移<sup> </sup></title><p>徐朝阳，任祥辉，穴强，曹乾洪</p><p>中国石油集团渤海钻探工程有限公司定向井技术服务分公司，天津</p><p>作者简介：徐朝阳(1985-)，男，博士，工程师，主要从事定向井仪器研发方面的工作。</p><p><img src="//html.hanspub.org/file/32035x1_hanspub.png" /></p><p>收稿日期：2019年3月20日；录用日期：2019年4月18日；发布日期：2019年8月15日</p><disp-formula id="hanspub.32035-formula17"><graphic xlink:href="//html.hanspub.org/file/32035x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>建立了用于消除泥浆脉冲信号基线漂移的形态学滤波器。采用最小二乘多项式拟合法、中值滤波法和形态学滤波法等3种方法处理泥浆脉冲PPM编码信号的基线漂移，并利用信噪比、均方根误差、归一化相关系数定量分析计算结果。对比结果表明，形态学滤波法消除泥浆脉冲信号基线漂移效果最佳。</p><p>关键词 :随钻测量，泥浆脉冲信号，基线漂移，形态学滤波</p><disp-formula id="hanspub.32035-formula18"><graphic xlink:href="//html.hanspub.org/file/32035x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by authors, Yangtze University and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p></sec><sec id="s3"><title>1. 引言</title><p>目前，无线随钻测量数据传输时，地面接收的泥浆脉冲信号常常存在基线漂移现象。随钻泥浆脉冲信号解码中，消除信号的基线漂移是重要的预处理工作，直接关系到后期解码的正确率，是泥浆脉冲信号解码技术的关键环节 [<xref ref-type="bibr" rid="hanspub.32035-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.32035-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.32035-ref3">3</xref>] 。形态学滤波消除信号基线漂移的研究多见于医学中的心电信号去噪，其效果好、适应性强、计算量较小 [<xref ref-type="bibr" rid="hanspub.32035-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.32035-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.32035-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.32035-ref7">7</xref>] 。医学心电信号和脉搏信号均具有规律性强的特征。但泥浆脉冲信号PPM编码信号占空比变化较大，同时还需考虑泥浆脉冲信号噪声干扰的随机性以及信号处理的实时性要求。因此，针对泥浆脉冲信号PPM编码信号的这一特征还需要进一步研究以消除其基线漂移。</p></sec><sec id="s4"><title>2. 泥浆脉冲信号噪声干扰</title><p>泥浆脉冲信号以泥浆压力波的形式通过钻柱内从井底传输至地面，能量耗散不可避免，且压力波与其反射波叠加，会产生波形畸变。另外，由于钻头的活动、钻柱的自转公转、钻柱与井壁的撞击、井下工具和泥浆泵的泵冲等干扰因素，接收信号会混叠很强的噪声，为后续信号处理带来困难。图1为现场采集的压力脉冲信号局部特征，采样频率为200 Hz。分析信号的频域特征(图1(b))，噪声分布频域较广，幅度无明显规律，高强度噪声主要集中在0~20 Hz之内，低频噪声中的泵噪信号基值频率接近于0。</p><p>图1. 现场采集泥浆压力脉冲信号及脉冲信号频域分析</p></sec><sec id="s5"><title>3. 形态学滤波</title><sec id="s5_1"><title>3.1. 形态学运算</title><p>地面接收泥浆脉冲信号是一维离散信号，信号序列f(n)定义为 F = { 0 , 1 , ⋯ , N } ，一维结构元素g(m)定义为 G = { 0 , 1 , ⋯ , M } ，且M &lt; N。形态学基本运算包括腐蚀和膨胀。</p><p>f(n)关于g(m)腐蚀的关系式如下：</p><p>( f Θ g ) ( n ) = min { f ( n + m ) − g ( m ) } ， n = 0 , 1 , ⋯ , N − M (1)</p><p>f(n)关于g(m)膨胀的关系式如下：</p><p>( f ⊕ g ) ( n ) = max { f ( n − m ) + g ( m ) } ， n = 0 , 1 , ⋯ , N + M − 2 (2)</p><p>将腐蚀和膨胀进行级联可以组成开运算和闭运算。开运算是指信号先被结构元素腐蚀再膨胀，记为“ ∘ ”，其关系式为：</p><p>( f ∘ g ) ( n ) = ( f Θ g ⊕ g ) ( n ) (3)</p><p>闭运算是指信号先被结构元素膨胀再腐蚀，记为“ • ”，其关系式为：</p><p>( f • g ) ( n ) = ( f ⊕ g Θ g ) ( n ) (4)</p><p>形态学开运算可以抑制信号正脉冲，闭运算可以抑制信号负脉冲，是基本的形态滤波器。</p></sec><sec id="s5_2"><title>3.2. 形态学滤波器设计</title><p>笔者采用2级滤波消除泥浆脉冲信号的基线漂移。第1级形态学滤波器直接处理原始泥浆脉冲信号f<sub>0</sub>，分别进行先“开”再“闭”运算和先“闭”再“开”运算，并取二者的算术平均，获得信号f<sub>1</sub>。第1级运算消除高频噪声，保留脉冲信号，选择的结构元素应与脉冲信号特征近似，且结构元素宽度小于脉冲信号宽度。其运算关系式如下：</p><p>f 1 = 1 2 ( f 0 ∘ g 1 • g 1 + f 0 • g 1 ∘ g 1 ) (5)</p><p>第2级形态学滤波器处理第1级运算获得的信号f<sub>1</sub>，分别进行先“开”再“闭”运算和先“闭”再“开”运算，并取二者的算术平均，获得基线漂移相关分量信号f<sub>2</sub>。第2级运算需要消除脉冲信号，且保留基线的特征，结构元素宽度应大于脉冲信号的宽度。其运算关系式如下：</p><p>f 2 = 1 2 ( f 1 ∘ g 2 • g 2 + f 1 • g 2 ∘ g 2 ) (5)</p><p>最后，将原始泥浆脉冲信号f<sub>0</sub>减去基线漂移相关分量信号f<sub>2</sub>，即可消除原始泥浆脉冲信号的基线漂移。</p><p>f 3 = f 0 − f 2 (6)</p></sec></sec><sec id="s6"><title>4. 试验分析</title><p>试验研究采用含强非线性基线漂移的模拟泥浆脉冲信号作为样本，分别采用最小二乘多项式拟合法、中值滤波法和形态学滤波法消除该信号的基线漂移，并对计算结果进行定量分析。</p><sec id="s6_1"><title>4.1. 试验样本</title><p>将基线信号从噪声信号中排除，并单独考虑，作为重要分析对象。图2为理想泥浆脉冲信号和各信号分量。</p><p>图2. 试验样本信号</p></sec><sec id="s6_2"><title>4.2. 结果分析</title><sec id="s6_2_1"><title>4.2.1. 定性分析</title><p>采用最小二乘多项式拟合法、中值滤波法和形态学滤波法，分别处理图2中的模拟信号e和f (结果如图3、图4所示)。图3(a)中左端仍可见比较明显的基线波动，图3(b)中左端的基线波动轻微，图3(c)中左端基线波动极小。图4(a)中右端仍存明显的基线波动，图4(b)和图4(c)右端基线波动轻微。因此，可以初步判断形态学滤波消除基线漂移的效果最佳，中值滤波法的效果次之，最小二乘多项式拟合法的效果最差。</p><p>图3. 模拟信号高占空比处存在强非线性基线漂移的修正结果</p><p>图4. 模拟信号低占空比处存在强非线性基线漂移的修正结果</p></sec><sec id="s6_2_2"><title>4.2.2. 定量分析</title><p>选取信噪比(R<sub>SN</sub>)、均方根误差(E<sub>rms</sub>)、归一化相关系数(C<sub>ncc</sub>) 3个指标进行定量分析。R<sub>SN</sub>越大、E<sub>rms</sub>越小、C<sub>ncc</sub>越接近1，则表示信号消除基线漂移的效果越好。计算R<sub>SN</sub>、E<sub>rms</sub>、C<sub>ncc</sub>所需的对比样本为图2(c)为例，结果见表1、表2，可以看出，在PPM编码信号占空比高、低两种情况下，形态学滤波结果的R<sub>SN</sub>最大、E<sub>rms</sub>最小、C<sub>ncc</sub>最接近1，所以形态学滤波的效果最好。3种方法对比，中值滤波的效果次之，最小二乘多项式拟合最差。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The comparison of modified results of strong nonlinear baseline drift at high duty cycle of analog signal</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >方法</th><th align="center" valign="middle" >R<sub>SN</sub></th><th align="center" valign="middle" >E<sub>rms</sub></th><th align="center" valign="middle" >C<sub>ncc</sub></th></tr></thead><tr><td align="center" valign="middle" >最小二乘多项式拟合法</td><td align="center" valign="middle" >3.0366</td><td align="center" valign="middle" >13.8243</td><td align="center" valign="middle" >0.8066</td></tr><tr><td align="center" valign="middle" >中值滤波法</td><td align="center" valign="middle" >6.6990</td><td align="center" valign="middle" >16.5151</td><td align="center" valign="middle" >0.9002</td></tr><tr><td align="center" valign="middle" >形态学滤波法</td><td align="center" valign="middle" >9.8388</td><td align="center" valign="middle" >10.3444</td><td align="center" valign="middle" >0.9513</td></tr></tbody></table></table-wrap><p>表1. 模拟信号高占空比处存在强非线性基线漂移的修正结果对比</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> The evaluation of modified results of strong nonlinear baseline drift at low duty cycle of analog signal</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >方法</th><th align="center" valign="middle" >R<sub>SN</sub></th><th align="center" valign="middle" >E<sub>rms</sub></th><th align="center" valign="middle" >C<sub>ncc</sub></th></tr></thead><tr><td align="center" valign="middle" >最小二乘多项式拟合法</td><td align="center" valign="middle" >2.5687</td><td align="center" valign="middle" >13.8171</td><td align="center" valign="middle" >0.7835</td></tr><tr><td align="center" valign="middle" >中值滤波法</td><td align="center" valign="middle" >5.9797</td><td align="center" valign="middle" >14.8940</td><td align="center" valign="middle" >0.8853</td></tr><tr><td align="center" valign="middle" >形态学滤波法</td><td align="center" valign="middle" >7.3071</td><td align="center" valign="middle" >10.7396</td><td align="center" valign="middle" >0.9102</td></tr></tbody></table></table-wrap><p>表2. 模拟信号低占空比处存在强非线性基线漂移的修正结果评价</p></sec></sec></sec><sec id="s7"><title>5. 结论</title><p>采用2级滤波消除泥浆脉冲信号的基线漂移，分别采用最小二乘多项式拟合、中值滤波和形态学滤波处理含强非线性基线漂移的模拟泥浆脉冲信号。对比结果显示，在PPM编码信号占空比高、低两种情况下，形态学滤波的R<sub>SN</sub>最大、E<sub>rms</sub>最小、C<sub>ncc</sub>最接近1，说明形态学滤波可以有效地消除泥浆脉冲信号的基线漂移，效果最佳。</p></sec><sec id="s8"><title>参考文献</title><p>[<xref ref-type="bibr" rid="hanspub.32035-ref1">1</xref>] 梁耀. 随钻泥浆脉冲信号的处理[D]: [硕士学位论文]. 西安: 西安石油大学, 2013: 21-37.</p><p>[<xref ref-type="bibr" rid="hanspub.32035-ref2">2</xref>] 邱彬, 周静, 高建邦, 等. 随钻测量信号中泵冲噪声对消[J]. 石油机械, 2014, 42(12): 22-27.</p><p>[<xref ref-type="bibr" rid="hanspub.32035-ref3">3</xref>] 陈伟, 李晓林, 江佩佩. 基于2D-DCT变换的MWD遥传信号泵冲干扰消除方法[J]. 测控技术, 2016, 35(10): 19-22.</p><p>[<xref ref-type="bibr" rid="hanspub.32035-ref4">4</xref>] 廖琪梅, 李安宗, 屈景辉, 等. 随钻测井钻井液脉冲信号基线漂移的矫正[J]. 石油钻采工艺, 2008, 30(4): 41-43.</p><p>[<xref ref-type="bibr" rid="hanspub.32035-ref5">5</xref>] 郭晓鑫, 刘立, 冯志鹏. 数学形态学在信号处理中的应用综述[J]. 仪器仪表学报, 2009, 30(10): 187-191.</p><p>[<xref ref-type="bibr" rid="hanspub.32035-ref6">6</xref>] 刘艳丽, 赵为松, 李海坤, 等. 基于形态滤波的脉搏波信号基线漂移消除方法研究[J]. 合肥工业大学学报(自然科学版), 2011, 34(4): 525-528.</p><p>[<xref ref-type="bibr" rid="hanspub.32035-ref7">7</xref>] 庞宇, 邓璐, 林金朝, 等. 基于形态滤波的心电信号去除基线漂移方法[J]. 物理学报, 2014, 63(9): 1-5.</p><p>[编辑] 帅群</p></sec></body><back><ref-list><title>References</title><ref id="hanspub.32035-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">梁耀. 随钻泥浆脉冲信号的处理[D]: [硕士学位论文]. 西安: 西安石油大学, 2013: 21-37.</mixed-citation></ref><ref id="hanspub.32035-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">邱彬, 周静, 高建邦, 等. 随钻测量信号中泵冲噪声对消[J]. 石油机械, 2014, 42(12): 22-27.</mixed-citation></ref><ref id="hanspub.32035-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">陈伟, 李晓林, 江佩佩. 基于2D-DCT变换的MWD遥传信号泵冲干扰消除方法[J]. 测控技术, 2016, 35(10): 19-22.</mixed-citation></ref><ref id="hanspub.32035-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">廖琪梅, 李安宗, 屈景辉, 等. 随钻测井钻井液脉冲信号基线漂移的矫正[J]. 石油钻采工艺, 2008, 30(4): 41-43.</mixed-citation></ref><ref id="hanspub.32035-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">郭晓鑫, 刘立, 冯志鹏. 数学形态学在信号处理中的应用综述[J]. 仪器仪表学报, 2009, 30(10): 187-191.</mixed-citation></ref><ref id="hanspub.32035-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">刘艳丽, 赵为松, 李海坤, 等. 基于形态滤波的脉搏波信号基线漂移消除方法研究[J]. 合肥工业大学学报(自然科学版), 2011, 34(4): 525-528.</mixed-citation></ref><ref id="hanspub.32035-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">庞宇, 邓璐, 林金朝, 等. 基于形态滤波的心电信号去除基线漂移方法[J]. 物理学报, 2014, 63(9): 1-5.</mixed-citation></ref></ref-list></back></article>