<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2017.72016</article-id><article-id pub-id-type="publisher-id">CSA-19838</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20170200000_71177122.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  机器人小车系统C++程序设计
  C++ Programming Design of Robot Car System
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>伯玮</given-names></name><xref ref-type="aff" rid="aff1"><sub>1</sub></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>沈阳市第四中学，辽宁 沈阳</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>syacbw@163.com</email></corresp></author-notes><pub-date pub-type="epub"><day>16</day><month>02</month><year>2017</year></pub-date><volume>07</volume><issue>02</issue><fpage>129</fpage><lpage>133</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文介绍了机器人小车控制系统的硬件构成、软件设计方法。在机器人小车应用中，采用C++进行程序设计，包括程序设计思想和实现过程，并在实际中验证了有效性。 This paper introduces the hardware structure and software design method of the robot car con-trol system. In the application of the robot car, the C++ is used to program, including the design idea and the realization process. The effectiveness is verified in practice.
    
  
 
</p></abstract><kwd-group><kwd>机器人小车，运动控制，程序设计, Robot Car</kwd><kwd> Motion Control</kwd><kwd> Program Design</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>机器人小车系统C++程序设计<sup> </sup></title><p>陈伯玮</p><p>沈阳市第四中学，辽宁 沈阳</p><p>收稿日期：2017年2月5日；录用日期：2017年2月25日；发布日期：2017年2月28日</p><disp-formula id="hanspub.19838-formula76"><graphic xlink:href="http://html.hanspub.org/file/4-1540713x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文介绍了机器人小车控制系统的硬件构成、软件设计方法。在机器人小车应用中，采用C++进行程序设计，包括程序设计思想和实现过程，并在实际中验证了有效性。</p><p>关键词 :机器人小车，运动控制，程序设计</p><disp-formula id="hanspub.19838-formula77"><graphic xlink:href="http://html.hanspub.org/file/4-1540713x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by author and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>机器人是指在计算机程序控制下能够自动完成人类部分工作的机器。集中了机械工程、电子学、控制理论、计算机、系统工程、仿生学等多个学科 [<xref ref-type="bibr" rid="hanspub.19838-ref1">1</xref>] - [<xref ref-type="bibr" rid="hanspub.19838-ref8">8</xref>] 知识，目前是人工智能研究中比较活跃的研究领域，很多青少年希望能亲手设计制作机器人。机器人可以采用单片机控制，通过视觉传感器获取环境的信息，然后由存放在单片机中事先编写好的程序，智能地对这些信息进行分析、处理、控制机器人的动作，能够随着环境参数的变化而改变机器人的行为。机器人小车是一个人工智能的典型问题。本文工作是制作机器人小车，使其在计算机程序 [<xref ref-type="bibr" rid="hanspub.19838-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.19838-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.19838-ref11">11</xref>] 控制下能够自动完成行走和图像采集的任务。</p></sec><sec id="s4"><title>2. 机器人小车图像采集系统硬件设计</title><p>本文的机器人小车单片机主控芯片采用意法半导体公司基于Cortex-M3内核的微控制芯片，最高工作频率为72 MHz，内置高速存储器(高达128 K字节的闪存和20 K字节的SRAM)，增强I/O端口和联结到两条APB，总线的外设；驱动器采用L298H桥控制电机旋转，四路TIM口控制电机正反转；因为机器人小车是运动的，根据实际采集需要，在本系统中选用变焦摄像头相机；图像的采集是由摄像头和图像采集卡合作完成，采集卡采用外置USB采集卡，可采集1路标清彩色视频信号；通信模块一路USART串口使用Simple WiFi模块与电脑通信，通信使用TTL电平；输入端接光电距离传感器，该光电传感器测量范围为5~100 cm，用来检测云台小车前后有无障碍物，防止机器人小车受到损坏；单片机供电使用AMS1117系列芯片，它的输出电压为3.267-3.333V；机器人小车还预留了两路高性能I/O口，为小车的后续开发和完善提供接口。</p></sec><sec id="s5"><title>3. 机器人小车图像采集系统软件设计</title><sec id="s5_1"><title>3.1. 机器人小车图像采集软件流程</title><p>根据功能设计的需要，在硬件基础上设计软件，软件分为二部分，图像采集和机器人小车的运动控制。图像采集流程图设计如图1所示。程序具体步骤如下：</p><p>1) 网络连接程序：连接到指定ip地址的主机，与主机连接成功，与主机的连接已断开；</p><p>2) 走行控制程序：右转按钮，后退按钮，左转按钮，舵机前转按钮，舵机后转按钮，前进按钮；</p><p>3) 采集卡初始化部分程序；打开视频设备文件，设置视频设备的数据通道、视频数据传输的模式和要捕捉的图片大小。</p><p>4) 视频控制程序：开始录制视频，停止录制视频，截图。</p></sec><sec id="s5_2"><title>3.2. 机器人小车运动程序</title><p>机器人小车的运动控制程序设计将系统在逻辑上划分为客户端与上位机两个部分，系统功能框架如图2所示。</p></sec><sec id="s5_3"><title>3.3. 系统功能界面</title><p>PC客户端软件设计，是为了和上位机进行通讯。基于采集卡的官方SDK和Socket通信协议编写，实现通过无线网络控制小车并接收小车传回图像的功能。图3是设计的PC客户端控制界面，可以在PC</p><p>图1. 机器人小车图像采集流程图</p><p>图2. 机器人小车运动流程图</p><p>图3. 客户端界面</p><p>上实现机器人小车的方向控制、舵机控制和图像采集。</p></sec><sec id="s5_4"><title>3.4. 部分设计代码</title><sec id="s5_4_1"><title>3.4.1. 图像采集代码(节选)</title><p>private void btnStartRecord_Click(object sender, EventArgs e) {</p><p>//m_hCapDev = m_pMainForm.m_hCapDev;</p><p>btnStartRecord.Enabled = false;</p><p>btnStopRecord.Enabled = true;</p><p>//m_bSupportGPU1 = m_checkGPU1.Checked;</p><p>= picDestination.Text + \\0 +DateTime.Now.Minute.ToString()+0+ DateTime.Now.Second.ToString() + .BMP</p><p>EXPORTS.QCAP_SNAPSHOT_BMP(m_hCapDev, ref strBmpName);</p><p>}</p><p>}</p></sec><sec id="s5_4_2"><title>3.4.2. 机器人小车运控制代码(节选)如下</title><p>private void button7_Click(object sender, EventArgs e) {</p><p>try</p><p>{</p><p>string msg = q</p><p>Byte[<xref ref-type="bibr" rid="hanspub.19838-ref"></xref>] bya = System.Text.Encoding.Default.GetBytes(msg.ToCharArray());</p><p>sock.Send(bya, bya.Length, SocketFlags.None);</p><p>}</p><p>catch</p><p>{</p><p>MessageBox.Show(连接尚未建立，无法发送);</p><p>}</p><p>}</p><p>通过以上设计，实现了机器人小车的遥控运动，当机器人小车运行到指定位置时，通过无线传输将遥控摄像头旋转的信号传输到机器人小车上，舵盘与机器人固定，舵机体旋转，带动摄像头旋转，进行图像拍摄。在实际应用中经过试验，达到了预期要求，实时采集和传输了图像到笔记本电脑，今后可以在此基础上进行分析处理。</p></sec></sec></sec><sec id="s6"><title>4. 结语</title><p>利用机器人小车硬件设计基础，借助C++编程，实现了对机器人小车的运动控制和图像采集，实现了机器人小车的相应功能，完成了机器人小车的控制任务，为青少年、教师运用机器人小车系统进行科技创新提供了有益的尝试。</p></sec><sec id="s7"><title>文章引用</title><p>陈伯玮. 机器人小车系统C++程序设计C++ Programming Design of Robot Car System[J]. 计算机科学与应用, 2017, 07(02): 129-133. http://dx.doi.org/10.12677/CSA.2017.72016</p></sec><sec id="s8"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.19838-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">张润梅, 龚剑. 基于机器人足球的大学生创新素质培养的探索与实践[J]. 计算机教育, 2009(2): 22-23, 29.</mixed-citation></ref><ref id="hanspub.19838-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">杨子夫, 米良川, 李德升. 舞蹈机器人步进电机驱动电路和程序设计[J]. 电子工程师, 2002, 28(9): 1-5.</mixed-citation></ref><ref id="hanspub.19838-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">杜佩君, 张瑞锋. 基于增广ESN的机器人轨迹跟踪控制[J]. 信息与控制, 2013, 42(4): 443-448.</mixed-citation></ref><ref id="hanspub.19838-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">崔茂源, 董再励, 田彦涛, 朱枫, 周船. 面向任务的虚拟环境和人机交互方法研究[J]. 信息与控制, 2002, 31(2): 153-158.</mixed-citation></ref><ref id="hanspub.19838-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">李航, 宋春华, 罗胜彬, 韦兴平, 刘小利. 机器人的研究现状及其发展趋势[J]. 微特电机, 2013, 41(4): 49-51.</mixed-citation></ref><ref id="hanspub.19838-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">张德龙, 李威凌, 吴怀宇, 陈洋. 基于学习机制的移动机器人动态场景自适应导航方法[J]. 信息与控制, 2016, 45(5): 521-529.</mixed-citation></ref><ref id="hanspub.19838-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">涂俊. 电脑智能机器人活动—培养学生综合素质的新载体[J]. 大众科技, 2011, 143(7): 130-131.</mixed-citation></ref><ref id="hanspub.19838-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">李卫红. 基于B/S的乐高NXT中文固件系统的研究及实现[J]. 价值工程, 2011(4): 146-147.</mixed-citation></ref><ref id="hanspub.19838-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">程来法. 基于C语言的电脑机器人足球进攻程序设计[J]. 电脑编程技巧与维护, 2012(5): 28-32.</mixed-citation></ref><ref id="hanspub.19838-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">谭浩强. C++程序设计[M]. 北京: 清华大学出版社, 2004.</mixed-citation></ref><ref id="hanspub.19838-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">许春山, 王建平, 曹广益, 赵锡芳. 基于Visual C++6.0的机器人控制系统软件实现[J]. 计算机应用与软件, 2003(10): 12-14.</mixed-citation></ref></ref-list></back></article>