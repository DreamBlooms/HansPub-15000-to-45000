<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">HJDM</journal-id><journal-title-group><journal-title>Hans Journal of Data Mining</journal-title></journal-title-group><issn pub-type="epub">2163-145X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/HJDM.2019.94019</article-id><article-id pub-id-type="publisher-id">HJDM-32658</article-id><article-categories><subj-group subj-group-type="heading"><subject>HJDM20190400000_11672308.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于改进回声状态网络的盖亚大数据短时交通状态预测研究
  A Short-Term Traffic Forecasting Research Based on Didi Chuxing GAIA Open Dataset Using Echo State Network Optimized by PSO Algorithm
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>家顺</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>河北工业大学，交通运输系，天津</addr-line></aff><pub-date pub-type="epub"><day>21</day><month>10</month><year>2019</year></pub-date><volume>09</volume><issue>04</issue><fpage>153</fpage><lpage>158</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    短期交通预测是现代智能交通系统重要的组成部分，本文设计了改进的回声状态网络基于盖亚开放数据来对短时交通状态进行预测。对于数据集中的无效数据，采用随机森林算法进行数据预处理，剔除其中的无效数据。由于盖亚数据集中的实时交通数据量巨大，采用粒子群算法对回声状态网络参数进行优化。最后采用2016年10月~11月成都市二环局部区域轨迹数据作为样本集对所设计的方法进行了验证，结果表明了该方法可以有效的对短时交通状态进行预测。
    Short-term traffic forecasting is an important part of contemporary intelligent transportation systems. In this paper, based on echo state network, a procedure is proposed to provide a forecast of traffic state. For the invalid data in the Didi Chuxing GAIA Open Dataset, the random forest algo-rithm is used to preprocess the data and eliminate the invalid data. Because of the huge amount of real-time traffic data in GAIA data set, particle swarm optimization algorithm is employed to op-timize the parameters of echo state network. Finally, the method is validated by using the local area trajectory data of the second ring road in Chengdu from October to November 2016 as the sample set. The result illustrates the effectiveness of this method. 
   
   
    
  
 
</p></abstract><kwd-group><kwd>回声状态网络，交通预测，粒子群算法, Echo State Network</kwd><kwd> Traffic Forecasting</kwd><kwd> PSO Algorithm</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于改进回声状态网络的盖亚大数据短时交通状态预测研究<sup> </sup></title><p>张家顺</p><p>河北工业大学，交通运输系，天津</p><p><img src="//html.hanspub.org/file/5-1760184x1_hanspub.png" /></p><p>收稿日期：2019年10月8日；录用日期：2019年10月18日；发布日期：2019年10月25日</p><disp-formula id="hanspub.32658-formula47"><graphic xlink:href="//html.hanspub.org/file/5-1760184x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>短期交通预测是现代智能交通系统重要的组成部分，本文设计了改进的回声状态网络基于盖亚开放数据来对短时交通状态进行预测。对于数据集中的无效数据，采用随机森林算法进行数据预处理，剔除其中的无效数据。由于盖亚数据集中的实时交通数据量巨大，采用粒子群算法对回声状态网络参数进行优化。最后采用2016年10月~11月成都市二环局部区域轨迹数据作为样本集对所设计的方法进行了验证，结果表明了该方法可以有效的对短时交通状态进行预测。</p><p>关键词 :回声状态网络，交通预测，粒子群算法</p><disp-formula id="hanspub.32658-formula48"><graphic xlink:href="//html.hanspub.org/file/5-1760184x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/5-1760184x7_hanspub.png" /> <img src="//html.hanspub.org/file/5-1760184x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>近年来，随着城市化进程的加快，城市道路的拥堵问题日益突出。由于大量扩建道路会受到资金和城市空间的限制，所以发展智能交通，提高道路通行效率就成了解决城市道路交通问题的重要手段，而短时交通状态预测是实现智能交通系统的基础和前提。蒲斌等 [<xref ref-type="bibr" rid="hanspub.32658-ref1">1</xref>] 提出了基于神经网络推论模型为主体的交通流量预测系统，通过实验验证了ARIMA乘积季节模型、BP神经网络和RBF神经网络的多种训练函数的预测精度及适应性。张海鹏等 [<xref ref-type="bibr" rid="hanspub.32658-ref2">2</xref>] 研究了基于公交车GPS数据的短时交通流预测问题。晏臻 [<xref ref-type="bibr" rid="hanspub.32658-ref3">3</xref>] 等针对传统的预测方法只考虑到了交通流量的时序特征，忽略了其空间特征这一问题，提出卷积神经网络(CNN)和长短期记忆网络(LSTM)相结合的短时交通流量预测模型。李志帅等 [<xref ref-type="bibr" rid="hanspub.32658-ref4">4</xref>] 提出一种基于图卷积神经网络和注意力机制的短时交通流量预测模型，该模型利用图卷积网络捕获路网流量空间特征，利用自注意力机制调整网络输出，提高最终预测结果的精确度。闫杨等 [<xref ref-type="bibr" rid="hanspub.32658-ref5">5</xref>] 提出了一种基于时空相关性的短时交通流量预测方法，利用卷积–循环门控单元提取交通流量的时空特征，双向门控循环单元提取交通流量的周期特征，将提取的特征进行融合，得到交通流量的预测值。Lin [<xref ref-type="bibr" rid="hanspub.32658-ref6">6</xref>] 提出了一种基于深度学习的空中交通流量预测模型，对空中交通流量预测进行了研究。Azadeh Emami [<xref ref-type="bibr" rid="hanspub.32658-ref7">7</xref>] 使用卡尔曼滤波算法对连通车辆环境下的短时交通流预测做了研究，可以对连通车辆环境下的短时交通流提供实时预测。</p><p>回声状态网络是由Jaeger [<xref ref-type="bibr" rid="hanspub.32658-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.32658-ref9">9</xref>] 在2001年提出并最初用于对无线通信系统的预测。由于该方法能有效的对混沌系统进行预测，采用回声状态网络进行交通预测成为了重要的研究热点。Zhang [<xref ref-type="bibr" rid="hanspub.32658-ref10">10</xref>] 基于改进的果蝇优化算法(ESN-IFOA)对回波状态网络进行优化，提出了一种5分钟交通量预测模型。王小洁 [<xref ref-type="bibr" rid="hanspub.32658-ref11">11</xref>] 针对船舶交通事故的预测误差大，建模过程耗费时间长等难题，设计基于回声状态网络的船舶交通事故预测模型。李丁园 [<xref ref-type="bibr" rid="hanspub.32658-ref12">12</xref>] 和张晋雁等 [<xref ref-type="bibr" rid="hanspub.32658-ref13">13</xref>] ，对于采用回声状态网络进行预测的网络结构和参数优化做了大量的研究。Thiede [<xref ref-type="bibr" rid="hanspub.32658-ref14">14</xref>] 提出了一种基于梯度的优化算法，用于对回声状态网络的超参数进行调整。</p><p>本文基于回声状态神经网络，设计了一个基于滴滴出行盖亚大数据中车辆GPS轨迹数据进行短时交通状态预测的方法。本文的结构如下，第2节介绍了基于改进回声状态网络的预测方法。第3节以2016年10月~11月成都市二环局部区域轨迹数据作为样本集验证了该方法的有效性。第4节对研究的结果做了总结。</p></sec><sec id="s4"><title>2. 基于改进回声状态网络的预测方法</title><p>在基于改进的回声状态网络对短时交通状态进行预测的问题中，主要包括提取特征集、数据预处理、学习训练、预测验证等步骤。其流程如图1所示。</p><p>图1. 基于改进回声状态网络短时交通状态预测流程</p><sec id="s4_1"><title>2.1. 数据预处理</title><p>盖亚数据集中提供的车辆轨迹信息数据包括车辆的GPS信息和订单信息，其数据格式如下面两个表格(表1~2)所示。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The fields of GPS trajectory data of Didi Chuxing GAIA Open Datase</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >字段</th><th align="center" valign="middle" >类型</th><th align="center" valign="middle" >示例</th><th align="center" valign="middle" >备注</th></tr></thead><tr><td align="center" valign="middle" >司机ID</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >glox.jrrlltBMvCh8nxqktdr2dtopmlH</td><td align="center" valign="middle" >已经脱敏处理</td></tr><tr><td align="center" valign="middle" >订单ID</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >jkkt8kxniovIFuns9qrrlvst@iqnpkwz</td><td align="center" valign="middle" >已经脱敏处理</td></tr><tr><td align="center" valign="middle" >时间戳</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >1501584540</td><td align="center" valign="middle" >unix时间戳，单位为秒</td></tr><tr><td align="center" valign="middle" >经度</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >104.04392</td><td align="center" valign="middle" >GCJ-02坐标系</td></tr><tr><td align="center" valign="middle" >纬度</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >104.04392</td><td align="center" valign="middle" >GCJ-02坐标系</td></tr></tbody></table></table-wrap><p>表1. 盖亚数据集车辆轨迹信息数据数据格式</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> The fields of order data of Didi Chuxing GAIA Open Datase</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >字段</th><th align="center" valign="middle" >类型</th><th align="center" valign="middle" >示例</th><th align="center" valign="middle" >备注</th></tr></thead><tr><td align="center" valign="middle" >订单ID</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >mjiwdgkqmonDFvCk3ntBpron5mwfrqvI</td><td align="center" valign="middle" >已经脱敏处理</td></tr><tr><td align="center" valign="middle" >开始计费时间</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >1501581031</td><td align="center" valign="middle" >unix时间戳，单位为秒</td></tr><tr><td align="center" valign="middle" >结束计费时间</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >1501582195</td><td align="center" valign="middle" >unix时间戳，单位为秒</td></tr><tr><td align="center" valign="middle" >上车位置经度</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >104.11225</td><td align="center" valign="middle" >GCJ-02坐标系</td></tr><tr><td align="center" valign="middle" >上车位置纬度</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >30.66703</td><td align="center" valign="middle" >GCJ-02坐标系</td></tr><tr><td align="center" valign="middle" >下车位置经度</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >104.07403</td><td align="center" valign="middle" >GCJ-02坐标系</td></tr><tr><td align="center" valign="middle" >下车位置维度</td><td align="center" valign="middle" >String</td><td align="center" valign="middle" >30.6863</td><td align="center" valign="middle" >GCJ-02坐标系</td></tr></tbody></table></table-wrap><p>表2. 盖亚数据集车辆订单信息数据数据格式</p><p>由于GPS数据采集受设备和环境的影响需要对数据中存在的无效数据进行剔除处理。由于实时采集的GPS轨迹数据量巨大，所以需要自动的对采集到的数据进行清理。对于盖亚开放数据集可以通过随机森林算法对车辆轨迹数据进行有效的清洗 [<xref ref-type="bibr" rid="hanspub.32658-ref15">15</xref>] 。</p></sec><sec id="s4_2"><title>2.2. 回声状态网络</title><p>回声状态网络是具有大量随机连接神经元的递归神经网络，该网络采用“储备池”代替传统神经网络中的隐层。储备池由大量稀疏连接的神经元组成，并将输入信号从低维空间映射到高维空间，唯一需要训练的参数即为输出权值矩阵。这些特点大大简化了回声状态网络的训练算法和求解过程。其基本结构可以采用下图(图2)来描述。</p><p>图2. 回声状态网络拓扑结构</p><p>其中，回声状态网络的基本方程为：</p><p>x ( n + 1 ) = f ( W in u ( n + 1 ) + W x ( n ) + W back y ( n ) ) (1)</p><p>y ( n + 1 ) = f out ( W out ( u ( n + 1 ) , x ( n + 1 ) , y ( n ) ) ) (2)</p><p>其中， u ( n ) = ( u 1 ( n ) , u 2 ( n ) , ⋯ , u K ( n ) ) T 和 y ( n ) = ( y 1 ( n ) , y 2 ( n ) , ⋯ , u L ( n ) ) T 分别表示K个输入单元和L个输出单元， x ( n ) = ( x 1 ( n ) , x 2 ( n ) , ⋯ , x N ( n ) ) T 表示储备池N个内部神经元的状态， W in 为输入单元与储备池的内部连接权值矩阵， W out 为储备池与输出单元连接权值矩阵， W back 为输出单元与储备池的连接权重矩阵， f 和 f out 分别为储备池单元和输出单元的激活函数。其中，需要训练的就是输出连接权值矩阵 W out 。</p></sec><sec id="s4_3"><title>2.3. 改进的回声状态网络</title><p>与其它大多数机器学习算法一样，回声状态网络的几个超参数，例如输入单元尺度、储备池谱半径、储备池稀疏程度和储备池规模等，必须仔细调整才能获得最佳性能。通常，在对回声状态网络训练时，首先将样本输入和样本输出一次注入到回声状态网络的输入和输出单元，通过公式(1)迭代更新网络内部状态，直到系统输出尽可能逼近期望输出。由于盖亚开放数据集中样本量巨大，同时短时交通状态预测对于算法的实时性要求较高，需要更有效的对于回声状态网络参数的优化算法。</p><p>对于网络参数的优化，等价于下面的最小化问题：</p><p>min ( d ( n ) − ∑ i = 1 L W out x i ( n ) ) (3)</p><p>于是，该参数问题转化为最优化问题。</p><p>粒子群优化算法是一种进化计算算法，每个粒子在搜索空间中单独的搜寻最优解，并将其记为当前个体极值，并将个体极值与整个粒子群里的其他粒子共享，找到最优的那个个体极值作为整个粒子群的当前全局最优解，粒子群中的所有粒子根据自己找到的当前个体极值和整个粒子群共享的当前全局最优解来调整自己的速度和位置。在粒子群算法中，粒子的速度和下一个位置可以用如下的公式来获得：</p><p>v ′ i d = ω ∗ v i d ⊕ α ( p i d − x i d ) ⊕ β ( p g d − x i d ) (4)</p><p>x ′ i d = x i d + v ′ i d (5)</p><p>这里α和β是0到1之间的随机数， p i d 是已知粒子最佳位置， p g d 是已知全局最佳位置， x i d 是粒子的当前位置， x ′ i d 是粒子的下一个位置，ω是权重参数。</p></sec></sec><sec id="s5"><title>3. 仿真和分析</title><p>这里选取了盖亚开放数据集中2016年10月~11月成都市二环局部区域轨迹数据作为样本集(数据来源：https://gaia.didichuxing.com)，该样本集包括约180GB数据，大约1,993,642,054条记录。其中10月的数据作为训练集，11月的数据作为测试集。首先，对训练集和测试集中的数据进行数据清洗。随机森林算法进行数据清洗的关键在于特征集的提取和特征子集的维度的确定。对于数据集中的任意一点i，选择该点和前面8个相邻点之间的速度、加速度共16个维度作为其特征子集。然后，输入训练数据采用粒子群算法对网络参数进行优化。最后，用所得到的回声状态网络对测试集数据进行预测，所得到预测数据与实际数据的比较如图3所示，其中折线为真实数据，黑点为预测数据。从图中可以看出预测数据与实际数据的整体趋势基本吻合，在车辆速度较高的区间误差相对较大，在车辆速度较低的区间预测值与实际值基本接近。对预测的结果计算其平均绝对误差和平均绝对百分比误差分别为1.973%和7.132%。结果表明，基于所设计的粒子群算法优化的改进回声状态网络，可以有效的对短时交通状态进行预测。</p><p>图3. 预测数据与实际数据比较</p></sec><sec id="s6"><title>4. 结论</title><p>本文利用滴滴出行盖亚开放数据中的GPS轨迹数据对短时交通流状态预测算法进行研究。由于滴滴出行的GPS轨迹实时数据量巨大，首先采用随机森林算法对数据自动预处理，然后采用粒子群算法对回声状态网络参数进行快速优化。最后采用2016年10月~11月成都市二环局部区域轨迹数据作为样本集对所设计的方法进行了验证。结果表明，该基于粒子群算法改进的回声状态网络可以有效的对短时交通状态进行预测。</p></sec><sec id="s7"><title>致谢</title><p>数据来自滴滴出行，数据出处：https://gaia.didichuxing.com。</p></sec><sec id="s8"><title>基金项目</title><p>河北省科技计划项目No.15456135。</p></sec><sec id="s9"><title>文章引用</title><p>张家顺. 基于改进回声状态网络的盖亚大数据短时交通状态预测研究A Short-Term Traffic Forecasting Research Based on Didi Chuxing GAIA Open Dataset Using Echo State Network Optimized by PSO Algorithm[J]. 数据挖掘, 2019, 09(04): 153-158. https://doi.org/10.12677/HJDM.2019.94019</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.32658-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">蒲斌, 李浩, 卢晨阳, 王治辉, 刘华. 基于神经网络的海量GPS数据交通流量预测[J]. 云南大学学报(自然科学版), 2019, 41(1): 53-60.</mixed-citation></ref><ref id="hanspub.32658-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">张海鹏, 杨宏业, 邬鑫珏, 王葆元. 基于公交车GPS数据的短时交通流预测研究[J]. 内蒙古工业大学学报(自然科学版), 2018, 37(1): 75-80.</mixed-citation></ref><ref id="hanspub.32658-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">晏臻, 于重重, 韩璐, 苏维均, 刘平. 基于CNN+LSTM的短时交通流量预测方法[J]. 计算机工程与设计, 2019(9): 2620-2624+2659.</mixed-citation></ref><ref id="hanspub.32658-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">李志帅, 吕宜生, 熊刚. 基于图卷积神经网络和注意力机制的短时交通流量预测[J]. 交通工程, 2019, 19(4): 15-19+28.</mixed-citation></ref><ref id="hanspub.32658-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">闫杨, 孙丽珺, 朱兰婷. 一种基于时空相关性的短时交通流量预测方法[J/OL]. 计算机工程, 1-8.</mixed-citation></ref><ref id="hanspub.32658-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Lin, Y., Zhang, J.-W. and Liu, H. (2019) Deep Learning Based Short-Term Air Traffic Flow Prediction Considering Temporal—Spatial Correlation. Aerospace Science and Technology, 93, Article ID: 105113.</mixed-citation></ref><ref id="hanspub.32658-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Emami, A., Sarvi, M. and Bagloee, S.A. (2019) Using Kalman Filter Algorithm for Short-Term Traffic Flow Prediction in a Connected Vehicle Environment. Journal of Modern Transportation, 27, 222-232.  
https://doi.org/10.1007/s40534-019-0193-2</mixed-citation></ref><ref id="hanspub.32658-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Jaeger, H. (2010) The “Echo State” Approach to Analysing and Training Recurrent Neural Networks—With an Erratum Note. German National Research Center for Information Technology GMD Technical Report Vol. 148, Bonn, 13.</mixed-citation></ref><ref id="hanspub.32658-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Jaeger, H. and Haas, H. (2004) Harnessing Nonlinearity: Predicting Chaotic Systems and Saving Energy in Wireless Telecommunication. Science, 304, 78-80. https://doi.org/10.1126/science.1091277</mixed-citation></ref><ref id="hanspub.32658-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Zhang, Q.Y., Qian, H., Chen, Y.P. and Lei, D.M. (2019) A Short-Term Traffic Forecasting Model Based on Echo State Network Optimized by Improved Fruit Fly Optimization Algorithm. Neurocomputing.  
https://doi.org/10.1016/j.neucom.2019.02.062</mixed-citation></ref><ref id="hanspub.32658-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">王小洁. 基于回声状态网络的船舶交通事故预测[J]. 舰船科学技术, 2019, 41(16): 16-18.</mixed-citation></ref><ref id="hanspub.32658-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">李丁园. 回声状态网络结构设计及应用研究[D]: [博士学位论文]. 长春: 吉林大学, 2019.</mixed-citation></ref><ref id="hanspub.32658-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">张晋雁, 陶宏才. 回声状态网络研究[J]. 成都信息工程学院学报, 2015, 30(6): 546-550.</mixed-citation></ref><ref id="hanspub.32658-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Thiede, L.A. and Parlitz, U. (2019) Gradient Based Hyperparameter Optimization in Echo State Net-works. Neural Networks, 115, 23-29.</mixed-citation></ref><ref id="hanspub.32658-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">张家顺. 基于随机森林算法的盖亚大数据清洗的研究[J]. 计算机科学与应用, 2019, 9(9): 1747-1752.</mixed-citation></ref></ref-list></back></article>