<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">IJM</journal-id><journal-title-group><journal-title>International Journal of Mechanics Research</journal-title></journal-title-group><issn pub-type="epub">2325-498X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/IJM.2015.42006</article-id><article-id pub-id-type="publisher-id">IJM-15499</article-id><article-categories><subj-group subj-group-type="heading"><subject>IJM20150200000_48268457.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  光弹实验视频采集系统的研发
  Development of the Photoelastic Experiment’s Video Acquisition System
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>婷</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>邓</surname><given-names>宗白</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>南京航空航天大学航空宇航学院，江苏 南京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>25</day><month>06</month><year>2015</year></pub-date><volume>04</volume><issue>02</issue><fpage>44</fpage><lpage>50</lpage><history><date date-type="received"><day>Aug.</day>	<month>12th,</month>	<year>2014</year></date><date date-type="rev-recd"><day>Sep.</day>	<month>14th,</month>	<year>2014</year>	</date><date date-type="accepted"><day>Sep.</day>	<month>22nd,</month>	<year>2014</year></date></history><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   为了解决本科实验教学中光弹演示实验存在的现状,一套基于USB工业摄像机和三可变镜头的视频采集教学软件被开发了。该视频采集系统硬件安装简单，只需要将工业相机的USB接口与计算机USB连接，然后将解码器串口与计算机串口连接就可使用，人机交互界面的设计操作简单，界面友好。该系统采用VB6.0开发完成界面设计以及视频图像的获取与处理，采用VB串口通讯技术完成对三可变镜头的焦距、聚焦和光圈的控制。这套采集系统已经在教学中使用，成功解决了光弹演示实验学生观察难，实验效果不好，演示性实验教学困难等难题。&lt;br/&gt;In order to solve the problems existing in the photoelastic experiment of undergraduate experimental teaching, a video acquisition teaching software is developed based on USB industrial camera and three variable lens. The hardware installation of the video acquisition system is simple, just needs to connect industrial camera’s USB interface to the computer’s USB , then make the serial port of decoder connect to the serial port of computer, then the system can be used. The design of interactive interface is simple and friendly. The design of the interface and video image’s acquisition and processing are developed by VB6.0. By using VB serial communication technology, the control of three variable lens’ focal length, focus and aperture is completed. The acquisition system has been used in the experimental teaching, it successfully solves the problems that students are difficult to observe images and teachers are difficult to explain in the photoelastic demonstration experiments.
    
  
 
</p></abstract><kwd-group><kwd>视频采集，串口通讯，VB6.0，实验教学改革, Video Collection</kwd><kwd> Serial Port Communication</kwd><kwd> VB6.0</kwd><kwd> Reform of Experimental Teaching</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>光弹实验视频采集系统的研发<sup> </sup></title><p>杨 婷，邓宗白</p><p>南京航空航天大学航空宇航学院，江苏 南京</p><p>Email: yangting@nuaa.edu.cn</p><p>收稿日期：2015年6月5日；录用日期：2015年6月19日；发布日期：2015年6月25日</p><disp-formula id="hanspub.15499-formula3981"><graphic xlink:href="http://html.hanspub.org/file/4-2650029x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为了解决本科实验教学中光弹演示实验存在的现状,一套基于USB工业摄像机和三可变镜头的视频采集教学软件被开发了。该视频采集系统硬件安装简单，只需要将工业相机的USB接口与计算机USB连接，然后将解码器串口与计算机串口连接就可使用，人机交互界面的设计操作简单，界面友好。该系统采用VB6.0开发完成界面设计以及视频图像的获取与处理，采用VB串口通讯技术完成对三可变镜头的焦距、聚焦和光圈的控制。这套采集系统已经在教学中使用，成功解决了光弹演示实验学生观察难，实验效果不好，演示性实验教学困难等难题。</p><p>关键词 :视频采集，串口通讯，VB6.0，实验教学改革</p><disp-formula id="hanspub.15499-formula3982"><graphic xlink:href="http://html.hanspub.org/file/4-2650029x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>光弹演示性实验是本科生《工程力学实验》课程中的一个基础演示性实验。它是一种应用光学原理的应力测试实验，在实验中要求学生观察几种典型的模型在平面或偏振光场中受力后的等差线和等倾线条纹，掌握光弹性测试的基础知识。但是，在实验教学过程中却发现只有靠近光弹实验装置附近的学生才能透过检偏镜(一般直径为150 mm左右)观察放置在其后面模型上的干涉条纹，尤其是在改变载荷大小或者偏振轴方向需要同学们同步观察此刻干涉条纹的实时变化时，很难保证每个学生都看到。这样就出现了老师费力讲解而学生却不知所云的现象，严重影响实验教学效果。如果能把模型上的干涉条纹在电脑上显示或者通过投影仪放大到显示屏上使得所有学生都能很清晰地观测到条纹变化将会显著提高实验教学效果，所以，将普通光弹仪改造成数字光弹仪迫在眉睫。但购买市面上售卖的一套光弹性软件价格非常昂贵，售价在三万左右，而软件中很多功能对于本科生演示性实验教学又使用不到，这样就造成了极大的浪费。基于这种现状，我们开发了这套针对光弹演示实验教学使用的光弹图像采集系统。</p></sec><sec id="s4"><title>2. 采集系统总体设计[<xref ref-type="bibr" rid="hanspub.15499-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.15499-ref2">2</xref>]</title><p>光弹图像采集系统的总体设计思路经过了几种方案的比较。</p><p>首先，传统的视频采集系统大多采用模拟摄像机和手动调焦镜头，普通模拟摄像机像素一般在七万以下，像素低，图像不清晰，图像放大后会出现马赛克现象，并且摄像机要多次经过AD/DA转换才输出视频信号，在转换的时候抽出的离散信号造成图像失真。同时，这种方案还需要在电脑中安装图像采集卡，安装是否到位将影响图像的采集，试验中发现有时会搜索不到图像采集卡以至于图像采集失败的情况。</p><p>介于上述方案的不理想，后将模拟摄像机改换为工业数字相机和手动调焦镜头，摄像机选择了分辨率为1280 &#215; 960，CCD成像尺寸为1/3”，通过USB2.0接口，不需要额外的采集设备，即插即用，满足了视频图像清晰，采集方便的要求。但是，在实验中需要手动调节支架位置以及镜头焦距来达到改变图像大小和清晰度，操作麻烦，影响实验效果，故手动调焦镜头在后来的实验中改换成三可变镜头(焦距、聚焦和光圈可变)。这套采集系统总体框架如图1。</p><p>在功能实现上通过解码器控制电动三可变镜头，这个也是这套系统的重点解决的难题之一。在操作时只需要根据需要操作客户端界面按钮就可实现镜头的变焦、聚焦和光圈的调整，可实现实时图像的保存、浏览以及实验全过程的录像等等。这种方案的优点是安装方便，操作简单。</p><p>图1. 视频采集系统总体架构</p></sec><sec id="s5"><title>3. 串口通讯技术[<xref ref-type="bibr" rid="hanspub.15499-ref3">3</xref>] -[<xref ref-type="bibr" rid="hanspub.15499-ref7">7</xref>]</title><sec id="s5_1"><title>3.1. 计算机与解码器串口通讯接口</title><p>解码器上的通讯端口是RS485，而电脑串口通讯端口是RS232，这就需要将计算机上的RS232转换成RS485。本系统直接采用RS232转RS485串口转换接口，如图2所示。</p><p>将转换器通讯端口的D+(DATA+)、D-(DATA-)、G(GND)分别与解码器DATA+、DATA-、GND端子对应连接，如图3所示。</p></sec><sec id="s5_2"><title>3.2. 计算机与解码器的通讯设置</title><p>解码器是与摄像机和电动变焦镜头设备配套使用的一种前段控制设备。在这套视频采集系统中，需要计算机通过解码器来控制三可变镜头的焦距、聚焦和光圈。首先需要选择一个通讯协议，所谓通信协议是指通信双方的一种约定。约定包括对数据格式、同步方式、传送速度、传送步骤、检纠错方式以及控制字符定义等问题做出统一规定，通信双方必须共同遵守。</p><p>本系统采用CCR-20G通讯协议，数据格式：1位起始位，8位数据位，1位停止位 (1-8-N-1)，波特率为4800 bps。然后需要设置解码器上FUNCT中1-4端子来选择不同的通讯协议，将FUNCT设置为0110，对应的通讯协议即为CCR-20G。</p><p>波特率是为了使解码器与控制设备(摄像机镜头)之间有相同的数据传输速度。本系统选用的摄像机镜头为波特率4800 bps，改变解码器上ID中7、8号端子设置解码器的波特率值。</p><p>解码器在系统中必须有一个唯一的地址号码才能供系统识别，通过改变解码器上ID中的1~6号端子来设置地址号码，该解码器地址号码为100000，如图4所示。</p></sec><sec id="s5_3"><title>3.3. 计算机通过解码器控制三可变镜头原理</title><p>该采集系统的难点之一是完成对三可变镜头焦距、聚焦和光圈的控制，开发原理就是使用VB串口通讯技术向计算机串口发出相应的控制指令，通过电平将控制信号送到解码器的串口，解码器将数字信号转变为模拟信号，做出相应的反应，驱动三可变镜头里面的电动机马达，使摄像头按照控制命令调整焦距、聚焦或者光圈，从而改变采集图像的大小和清晰度。解码器与工业镜头接线图，如图5所示。</p></sec><sec id="s5_4"><title>3.4. 采集系统硬件组成</title><p>摄像机选择USB接口的彩色工业CCD，做到即插即用，使用时只需要将USB接口摄像机连接到计算机上的USB接口上，RS485-232接口连接到计算机的串行口上就可以进行视频采集了，硬件连接简单，操作方便，这套视频采集系统所有的硬件包括RS232转RS485接口、解码器、工业摄像机和镜头，硬件连接如图6所示。</p><p>视频采集现场如图7所示。</p><p>图2. RS232转RS485接口装置</p><p>图3. Pc机与解码器的串口转换接口</p><p>图4. 解码器通讯设置</p></sec></sec><sec id="s6"><title>4. 采集系统软件设计[<xref ref-type="bibr" rid="hanspub.15499-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.15499-ref9">9</xref>]</title><p>通过VB6.0编程完成人机交互界面以及视频的获取与处理。软件主要功能包括：视频图像的采集、录制、图像抓拍、浏览保存的图像、控制摄像头光圈和焦距；录像回放等，还扩充了云台功能，可改变球形摄像头的方向，可上下左右转动等[<xref ref-type="bibr" rid="hanspub.15499-ref1">1</xref>] 。界面设计如图8所示。</p><p>抓拍的实时图像保存到计算机，界面如图9所示。</p><p>浏览存储在计算机中抓拍的图像，界面设计如图10所示。</p></sec><sec id="s7"><title>5. 采用VB编写的部分程序代码</title><p>控制摄像机镜头光圈的程序：</p><p>图5. 解码器与工业镜头接线</p><p>图6. 采集系统硬件连接</p><p>图7. 视频采集现场</p><p>Private Sub ApBig_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)</p><p>sbStatusBar.Panels(1).Text = 摄像机镜头控制----光圈大</p><p>MSComm1.Output = Chr(&amp;H40) &amp; Chr(&amp;H43) &amp; Chr(&amp;H1) &amp; Chr(&amp;H80) &amp; Chr(&amp;H484)</p><p>End Sub</p><p>图8. 视频采集软件界面设计</p><p>图9. 实时图像抓拍保存到计算机</p><p>图10. 浏览存储在计算机中的视频图像</p></sec><sec id="s8"><title>6. 结语</title><p>该系统采用VB6.0开发完成界面设计以及视频图像的获取与处理，采用VB串口通讯技术完成对三可变镜头的焦距、聚焦和光圈的控制。系统采集光弹图像，记录整个实验过程，并经计算机显示器或投影仪放大显示，让所有学生都能观看到实验过程。自使用以来，学生对实验现象观察清晰明了，实验原理理解更加透彻了，参加的实验人数也由原来的只能10人左右扩大到一个班级30人左右了，从而告别了原来的闹哄哄挤作一团，老师费力讲解但学生仍然不知所云的现象，提高了授课效率和实验教学质量。实际上，在本科其它科目的演示性实验过程中都或多或少的存在实验观察难的现象，这套视频实时采集系统可以普及到其它科目的演示性实验当中，让演示性实验也可以使学生看得清晰，学得透彻。</p></sec><sec id="s9"><title>基金项目</title><p>南京航空航天大学“实验技术研究与开发”项目。</p></sec><sec id="s10"><title>文章引用</title><p>杨 婷,邓宗白, (2015) 光弹实验视频采集系统的研发 Development of the Photoelastic Experiment’s Video Acquisition System. 力学研究,02,44-50. doi: 10.12677/IJM.2015.42006</p></sec><sec id="s11"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.15499-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">邓宗白, 刘正华 (2003) 动态应变数据采集与处理系统的开发及改进. 计算机应用与软件, 11, 88-90.</mixed-citation></ref><ref id="hanspub.15499-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">李巍 (2007) 基于USB总线的视频采集系统设计. 中国科学院研究生院(西安光学精密机械研究所), 西安.</mixed-citation></ref><ref id="hanspub.15499-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">李长林 (2006) Visual Basic串口通信技术与典型实例. 清华大学出版社有限公司, 北京.</mixed-citation></ref><ref id="hanspub.15499-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">立元, 逸之, 锦棋 (2008) Visual Basic 2005与自动化系统监控: RS-232串行通信. 清华大学出版社, 北京.</mixed-citation></ref><ref id="hanspub.15499-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">李锋, 曾德良 (2002) 基于VB6.0的串口通讯程序设计. 现代电子技术, 10, 54-57.</mixed-citation></ref><ref id="hanspub.15499-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">车飞 (2009) 用VB通信控件实现串口通信. 电脑编程技巧与维护, 16, 80-80.</mixed-citation></ref><ref id="hanspub.15499-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">徐永洪, 符影杰, 江峰, 等 (2004) 基于VB6.0的串口通信实现. 仪器仪表用户, 1, 67-68.</mixed-citation></ref><ref id="hanspub.15499-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">杨克玉 (2005) VB6.0程序设计实训教程. 机械工业出版社, 北京.</mixed-citation></ref><ref id="hanspub.15499-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">王兴晶, 等 (2004) Visual Basic 6.0应用编程150例. 电子工业出版社, 北京.</mixed-citation></ref></ref-list></back></article>