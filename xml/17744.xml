<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JWRR</journal-id><journal-title-group><journal-title>Journal of Water Resources Research</journal-title></journal-title-group><issn pub-type="epub">2166-6024</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JWRR.2016.53026</article-id><article-id pub-id-type="publisher-id">JWRR-17744</article-id><article-categories><subj-group subj-group-type="heading"><subject>JWRR20160300000_12430987.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject></subj-group></article-categories><title-group><article-title>
 
 
  耦合电网约束的水电系统短期发电调度研究
  Study on Short-Term Scheduling of Hydropower System Coupling Grid Constraint
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>跃驰</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>程</surname><given-names>春田</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>康</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>孚</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>本希</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>大连理工大学水电与水信息研究所，辽宁 大连</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><aff id="aff3"><addr-line>长江勘测规划设计研究院，湖北 武汉</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>zhangyuechi@foxmail.com(张跃)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>31</day><month>05</month><year>2016</year></pub-date><volume>05</volume><issue>03</issue><fpage>200</fpage><lpage>210</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   电网是水电站电力送出的必经途径，但在输送过程中不可避免地产生一定程度的电力损耗。以往研究大多集中在发电侧的水电站(群)发电量或发电效益最大，未能给予电力损耗充分的重视。因此，本文构建了考虑电网损耗的水电系统发电调度模型，以期实现水电最大化的消纳。同时，针对传统方法的早熟收敛缺陷，提出了耦合遗传算法和离散微分动态规划的离散微分遗传算法(DDGA)，并采用Fork/Join多核框架实现DDGA的并行求解，以求提高算法的搜索性能与求解效率。澜沧江流域梯级应用实例表明：所提模型与DDGA方法能够快速获得计及电网损耗的优化调度结果，有效提高电网水电消纳能力，具有较强的可行性及实用性。 The power grid is the only way of transmitting hydropower generation, and it will inevitably produce a certain degree of power loss in the transport process. Most previous studies focused on the generation side of maximum power out or generation benefits, without giving adequate attention to the power loss. In this paper, a short-term generation scheduling model coupling with power grid constraints is established, with the objective of maximizing the generation at the receiving end. A DDGA algorithm is proposed to solve the model, which combines the advantages of DDDP and GA. Moreover, based on the multi- core computer platform and Fork/Join parallel framework, a parallel processing method is used to improve the efficiency of solving the method. A case study of Lancang River cascade hydropower system proves that the model and DDGA method can quickly obtain optimal scheduling results, and it can improve the absorptive capacity of hydropower grid effectively. The proposed method is reasonability and practicability. 
  
 
</p></abstract><kwd-group><kwd>电网损耗，短期调度，水电系统，并行, Grid Loss</kwd><kwd> Short-Term Scheduling</kwd><kwd> Hydropower System</kwd><kwd> Parallel</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>耦合电网约束的水电系统短期发电调度研究<sup> </sup></title><p>张跃驰<sup>1</sup>，程春田<sup>1</sup>，刘康<sup>2</sup>，陈孚<sup>1</sup>，刘本希<sup>1</sup></p><p><sup>1</sup>大连理工大学水电与水信息研究所，辽宁 大连</p><p><sup>2</sup>长江勘测规划设计研究院，湖北 武汉</p><disp-formula id="hanspub.17744-formula123"><graphic xlink:href="http://html.hanspub.org/file/2-2410385x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年5月10日；录用日期：2016年5月31日；发布日期：2016年6月3日</p><disp-formula id="hanspub.17744-formula124"><graphic xlink:href="http://html.hanspub.org/file/2-2410385x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>电网是水电站电力送出的必经途径，但在输送过程中不可避免地产生一定程度的电力损耗。以往研究大多集中在发电侧的水电站(群)发电量或发电效益最大，未能给予电力损耗充分的重视。因此，本文构建了考虑电网损耗的水电系统发电调度模型，以期实现水电最大化的消纳。同时，针对传统方法的早熟收敛缺陷，提出了耦合遗传算法和离散微分动态规划的离散微分遗传算法(DDGA)，并采用Fork/Join多核框架实现DDGA的并行求解，以求提高算法的搜索性能与求解效率。澜沧江流域梯级应用实例表明：所提模型与DDGA方法能够快速获得计及电网损耗的优化调度结果，有效提高电网水电消纳能力，具有较强的可行性及实用性。</p><p>关键词 :电网损耗，短期调度，水电系统，并行</p><disp-formula id="hanspub.17744-formula125"><graphic xlink:href="http://html.hanspub.org/file/2-2410385x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>水电系统作为我国大电力系统的重要组成部分，在其优化调度时必须考虑电网安全运行约束。然而，一方面，现有研究大多集中在水电站本身的相关约束 [<xref ref-type="bibr" rid="hanspub.17744-ref1">1</xref>] - [<xref ref-type="bibr" rid="hanspub.17744-ref4">4</xref>] ，而对电网运行方面的限制约束关注度不够，至多仅考虑了线路功率约束 [<xref ref-type="bibr" rid="hanspub.17744-ref5">5</xref>] ，鲜有文献将电网损耗纳入模型中，这就导致水电调度计划很有可能无法满足电网潮流限制条件，既影响了电网的安全稳定运行，又无法充分有效消纳水电，造成大量的无益发电或弃水。因此，如何建立考虑电网损耗等相关约束的优化调度模型成为水库发电调度的研究重点之一。另一方面，由于水电站之间存在着复杂的水力、电力联系，水电系统需要处理复杂多变的约束条件，属于典型的离散、非凸和非线性优化问题，虽然模型求解方面已取得了较为丰硕的成果 [<xref ref-type="bibr" rid="hanspub.17744-ref6">6</xref>] - [<xref ref-type="bibr" rid="hanspub.17744-ref9">9</xref>] ，大致形成了数学规划方法和模拟仿真算法 [<xref ref-type="bibr" rid="hanspub.17744-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.17744-ref11">11</xref>] 两类，但目前仍无统一标准的求解方法，通常需要根据具体问题探讨分析方法的适用性。因此，如何利用现有算法并充分利用现有的电脑软硬件资源，以提高水电系统短期调度模型的求解效率和结果准确性，就成为水利工作者一直以来关注的重点。</p><p>基于上述分析，本文首先以受电侧受电量最大为目标，利用均方根电流法计算网损，建立了考虑电网运行约束的水电系统短期优化调度模型；然后通过整合遗传算法与离散微分动态规划的优势，同时结合近年来蓬勃发展的多核并行计算技术，提出了并行离散微分遗传算法(Discrete Differential Genetic Algorithm, DDGA)对模型进行求解。澜沧江流域梯级水电站实际应用结果验证了所提模型与方法的合理性与可行性。</p></sec><sec id="s4"><title>2. 耦合电网约束的水电系统调度模型</title><sec id="s4_1"><title>2.1. 目标函数</title><p>水电是廉价的清洁可再生能源，电网从整个社会效益的角度出发，增大水电出力可以降低发电成本并减小污染物排放量。由于没有考虑电网运行状态，传统的水电系统优化调度多以发电量最大为目标，致使发电计划无法满足电网实际运行约束。本文在考虑传统的水力电力约束的基础上，以受电侧受电量最大为目标，建立了耦合电网运行约束的水电系统短期优化调度模型，最终形成24点日调度曲线。目标函数如下所示：</p><disp-formula id="hanspub.17744-formula126"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x11_hanspub.png" xlink:type="simple"/></inline-formula> (MWh)为所有电站在受电侧的受电量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x12_hanspub.png" xlink:type="simple"/></inline-formula> (MW)为电站m在时段t的下网功率。</p></sec><sec id="s4_2"><title>2.2. 约束条件</title><p>约束条件包括电站约束和电网约束两部分。</p><p>1) 电站约束。主要分为两个方面，一方面是水力约束，主要包括水量平衡约束、始末水位约束、发电流量约束、水位约束和出库流量约束等。</p><disp-formula id="hanspub.17744-formula127"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x13_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula128"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x14_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula129"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x15_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula130"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x16_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula131"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x17_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x18_hanspub.png" xlink:type="simple"/></inline-formula> (m<sup>3</sup>)、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x19_hanspub.png" xlink:type="simple"/></inline-formula> (m<sup>3</sup>)表示水库m在第t时段的初末库容，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x20_hanspub.png" xlink:type="simple"/></inline-formula> (m<sup>3</sup>/s)表示水库m在第t时段各类流量之和，入库为正，出库为负，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x21_hanspub.png" xlink:type="simple"/></inline-formula> (m<sup>3</sup>/s)、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x22_hanspub.png" xlink:type="simple"/></inline-formula> (m)、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x23_hanspub.png" xlink:type="simple"/></inline-formula> (m<sup>3</sup>/s)分别表示水库m在第t时段的发电流量、初水位及出库流量。</p><p>另一方面是电力约束，主要包括电站出力约束、出力爬坡约束、机组振动区约束、出力保持时间约束等</p><disp-formula id="hanspub.17744-formula132"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x24_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula133"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x25_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula134"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x26_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula135"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x27_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x28_hanspub.png" xlink:type="simple"/></inline-formula> (MW)为电站m在t时段的出力，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x29_hanspub.png" xlink:type="simple"/></inline-formula>为电站m单时段最大爬坡速率，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x30_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x31_hanspub.png" xlink:type="simple"/></inline-formula>分别为电站m第k个振动区的上限和下限，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x32_hanspub.png" xlink:type="simple"/></inline-formula>为电站m出力变化最小间隔是段数，即电站出力上升或下降后出力保持稳定的最小保持时段数。</p><p>2) 电网约束。主要包括线路损耗约束、线路容量约束、网络损耗约束等。</p><disp-formula id="hanspub.17744-formula136"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x33_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula137"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x34_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula138"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x35_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x36_hanspub.png" xlink:type="simple"/></inline-formula>为电站m在t时段时，在电网输电侧输入功率，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x37_hanspub.png" xlink:type="simple"/></inline-formula>为并网效率，一般小于1%。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x38_hanspub.png" xlink:type="simple"/></inline-formula> (MWh)为电站m在t时段的输电损耗，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x39_hanspub.png" xlink:type="simple"/></inline-formula> (m)、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x40_hanspub.png" xlink:type="simple"/></inline-formula> (kV)为电站m电能输送距离及输送线路电压。</p></sec><sec id="s4_3"><title>2.3. 网络损耗处理方法</title><p>精确的电网损耗需要通过潮流计算获得，计算规模较大，而短期调度涉及时段较多，对计算速度要求较高，如果耦合潮流计算会极大地加大计算规模，降低计算效率。因此需要对电网损耗进行简化计算以提高计算速度。本文中采用均方根电流法计算网络损耗 [<xref ref-type="bibr" rid="hanspub.17744-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.17744-ref13">13</xref>] ，计算方法如下：</p><disp-formula id="hanspub.17744-formula139"><label>(14)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x41_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula140"><label>(15)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x42_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17744-formula141"><label>(16)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x43_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x44_hanspub.png" xlink:type="simple"/></inline-formula> (kA)、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x45_hanspub.png" xlink:type="simple"/></inline-formula> (Ω)、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x46_hanspub.png" xlink:type="simple"/></inline-formula> (MWh)分别为电站m在计算时段的均方根电流、单相等效阻抗、电能损耗，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x47_hanspub.png" xlink:type="simple"/></inline-formula> (A)为电站m在时段t的单相负荷电流，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x48_hanspub.png" xlink:type="simple"/></inline-formula> (MVar)为线路无功量，由于线路功率因数接近于1，处理时可以忽略无功功率对电流的影响。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x49_hanspub.png" xlink:type="simple"/></inline-formula>可根据电站上网功率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x50_hanspub.png" xlink:type="simple"/></inline-formula>和电站出口节点电压<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x51_hanspub.png" xlink:type="simple"/></inline-formula>算出，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x52_hanspub.png" xlink:type="simple"/></inline-formula>为受线路输送功率及温度等影响，但变化程度不大，可认为是定值，根据典型时刻潮流计算结果容易求出，为了简化计算，本文认为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x53_hanspub.png" xlink:type="simple"/></inline-formula>为给定常量。</p><p>由于：</p><disp-formula id="hanspub.17744-formula142"><label>(17)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x54_hanspub.png"  xlink:type="simple"/></disp-formula><p>所以受电侧吸纳电站m的电能<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x55_hanspub.png" xlink:type="simple"/></inline-formula>为：</p><disp-formula id="hanspub.17744-formula143"><label>(18)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x56_hanspub.png"  xlink:type="simple"/></disp-formula><p>就单个时段而言，在时段t受电侧吸纳电站m的电能<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x57_hanspub.png" xlink:type="simple"/></inline-formula>为：</p><disp-formula id="hanspub.17744-formula144"><label>(19)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x58_hanspub.png"  xlink:type="simple"/></disp-formula><p>基于上述假设，单时段可表示为：</p><disp-formula id="hanspub.17744-formula145"><label>(20)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x59_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x60_hanspub.png" xlink:type="simple"/></inline-formula>均为常数：</p><disp-formula id="hanspub.17744-formula146"><label>(21)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x61_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据公式(20)，可以得到以下关系曲线(图1)。</p><p>通过图1可以看出，随着电站出力的增加，电能损耗呈指数形式增加，而受端电量呈二次函数形式增加，增速逐渐变慢，甚至会出现受电量减小的情况。因此，合理的安排电站出力对增加受电侧受电量以及降低电网损耗具有重要的实际意义。</p></sec></sec><sec id="s5"><title>3. 基于并行DDGA的模型求解方法</title><p>遗传算法通过选择、交叉、变异循环计算实现寻优过程，以适应度函数值作为可行解的评价依据。经典遗传算法计算效率较低，主要有两方面原因：一方面种群规模较大，导致计算机计算能力不足；另一方面是计算后期种群个体差异变小，导致寻优速度减慢。针对上述问题，本文采用最优个体保留策略，结合DDDP算法的廊道思想，建立了基于多核并行的离散微分遗传算法对经典遗传算法进行改进，以提高结果准确性和计算效率。</p><sec id="s5_1"><title>3.1. 寻优速度改进</title><p>DDDP是动态规划的衍生算法，也是一种迭代优化方法，它由基本可行解开始，在基本可行解附近将状态离散化形成“廊道”，在“廊道”内利用动态规划求解，再以新的较优解代替基本可行解进行迭代计算，直到找到最优解为止。DDDP具有减少贮存量和计算时间的优点，为求解高维的水电系统优化调度问题提供了方便。</p><p>经典遗传算法后期寻优速度降低是个体差异变小和无效变异增多导致的。个体差异变小时，种群在一定程</p><p>图1. 电站出力与其相关电量关系曲线</p><p>度上已经接近最优解，若仍然在全部状态空间内产生变异，容易产生不满足约束的不可行解，从而降低后期收敛速度。DDDP的“廊道”思想能有效的应对上述问题，通过逐步缩减状态空间的方法使种群在“廊道”内进化，在保证种群多样性，避免出现种群早熟的基础上，提高种群进化的优秀个体的数量，保证遗传算法后期的稳定收敛速度。此外，为了有效保持种群多样性，在缩减状态空间的同时，根据进化代数和收敛程度，增加变异概率，进而提高遗传算法后期收敛速度。上述方法用公式表示如下：</p><disp-formula id="hanspub.17744-formula147"><label>(22)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2410385x63_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x64_hanspub.png" xlink:type="simple"/></inline-formula>为第k代个体第m个电站在t时段的下泄流量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x65_hanspub.png" xlink:type="simple"/></inline-formula>第k代种群的收敛程度，可用之前若干代的最优个体适应度之差表示，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x66_hanspub.png" xlink:type="simple"/></inline-formula>为0~1之间的随机浮点数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x67_hanspub.png" xlink:type="simple"/></inline-formula>为种群变异步长，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x68_hanspub.png" xlink:type="simple"/></inline-formula>为第k代个体的变异概率。</p></sec><sec id="s5_2"><title>3.2. 初始解生成策略</title><p>遗传算法允许在状态空间内随机生成初始种群，但种群中可行解的多少和种群多样程度会影响整体收敛速度，本文提出一种初始种群生成策略，在保证种群多样性的基础上自动满足流量约束和水位约束，从而提高种群中可行解的数量，以提高整体收敛速度。流程如下：</p><p>1) 根据各电站的日初、日末水位及来水量确定全天可用水量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x69_hanspub.png" xlink:type="simple"/></inline-formula>；</p><p>2) 以水位为状态变量、流量为决策变量，每个时段在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x70_hanspub.png" xlink:type="simple"/></inline-formula>之间随机生成流量，那么总流量的期望就是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x71_hanspub.png" xlink:type="simple"/></inline-formula>，实际为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x72_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>3) 计算<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x73_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x74_hanspub.png" xlink:type="simple"/></inline-formula>的差值，均匀分摊给电站的各个时段，使初始解的下泄流量等于可用流量，自动满足流量约束和末水位约束，从而提高初始解的可行性。</p><p>在迭代过程中容易产生末水位约束不满足的解，仍可以用流量差值分摊的方法对流量进行分摊，由于流量分摊量较小，基本不会对其他约束产生较大影响。</p></sec><sec id="s5_3"><title>3.3. 最优个体保留策略</title><p>研究表明，经典的遗传算法无法收敛到全局最优解，但是，若保留每一代最优个体，遗传算法能够收敛到全局最优解 [<xref ref-type="bibr" rid="hanspub.17744-ref14">14</xref>] ，因此，本文在计算时，采用最优解保留策略，将父代的最优解替换子代中的一个个体，从而保证算法的全局收敛性。</p></sec><sec id="s5_4"><title>3.4. 多核并行计算</title><p>并行计算能够充分发挥计算机的多核优势，将一个大规模的复杂问题分解为多个子问题，提高计算效率。并行计算要求子问题之间相互独立，尤其适合遗传算法这类智能搜索算法。目前，多核并行技术已经在多个领域得到应用，有多个基本框架可供选择，本文采用Lea提出的Fork/Join框架 [<xref ref-type="bibr" rid="hanspub.17744-ref15">15</xref>] ，该框架将总任务分解成若干个子任务，通过汇总每个子任务计算结果得到总任务的结果，并利用“工作窃取”的方法提高并行任务执行效率。Fork/Join框架已经被集成在Java开发环境中，操作较为简单，只需进行简单的任务划分便能发挥多核平台优势，取得良好的效果，达到提高计算效率的目的。有关Fork/Join框架的具体内容，文献 [<xref ref-type="bibr" rid="hanspub.17744-ref15">15</xref>] 已经做了详细说明，本文中不再赘述。</p></sec><sec id="s5_5"><title>3.5. 并行DDGA求解流程</title><p>DDGA迭代过程中，选择、交叉、变异及适应度函数计算过程都是针对一个或多个个体，且均能分解成并列的多个子任务，符合并行计算的条件。因此，本文对上述四个步骤进行改进，大幅提高了算法求解效率，求解步骤如下：</p><p>步骤1：参数初始化。设置种群规模n、交叉概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x75_hanspub.png" xlink:type="simple"/></inline-formula>、初始变异概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x76_hanspub.png" xlink:type="simple"/></inline-formula>以及初始变异范围<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x77_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>步骤2：种群初始化。根据上文所述的初始解生成方法生成规模为n的初代种群<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x78_hanspub.png" xlink:type="simple"/></inline-formula>，设置进化代数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x79_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>步骤3：计算适应度。利用Fork/Join并行框架，以公式(1)作为适应度函数，并行计算第k代个体的适应度，并记录最优个体<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x80_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>步骤4：选择运算。采用联赛法，并行筛选出与种群规模相同个数的个体。</p><p>步骤5：交叉运算。在步骤4的基础上，利用算术交叉方法。并行进行交叉运算。</p><p>步骤6：变异计算。在步骤5的基础上，根据变异概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x81_hanspub.png" xlink:type="simple"/></inline-formula>以及变异范围<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x82_hanspub.png" xlink:type="simple"/></inline-formula>，并行进行变异计算。</p><p>步骤7：插入上代最优个体。在步骤6的基础上，随机选择一个个体，用步骤3记录的最优个体<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x83_hanspub.png" xlink:type="simple"/></inline-formula>替代该个体。</p><p>步骤8：进化代数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x84_hanspub.png" xlink:type="simple"/></inline-formula>，根据进化代数逐步增加变异概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x85_hanspub.png" xlink:type="simple"/></inline-formula>并减小变异范围<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2410385x86_hanspub.png" xlink:type="simple"/></inline-formula>，形成新一代种群和基本参数。判断是否满足迭代终止条件，若不满足，则返回步骤3继续进行迭代计算，若满足，则结束计算并输出最优解。</p></sec></sec><sec id="s6"><title>4. 应用实例</title><sec id="s6_1"><title>4.1. 基本资料</title><p>本文选取小湾–漫湾–大朝山梯级水电站消落期某日为计算对象，各电站计算参数如表1。通过对比有无电网约束的优化调度结果，分析上述模型与算法的有效性与合理性。</p></sec><sec id="s6_2"><title>4.2. 考虑电网约束的水电系统调度结果</title><p>考虑电网约束前后的调度曲线及损耗曲线如图2所示。图2(a)为仅考虑传统约束的梯级电站优化调度曲线，图2(b)为与其对应的损耗曲线；图2(c)为考虑电网运行约束的梯级电站优化调度曲线，图2(d)为与其对应的损耗曲线。容易看出，考虑电网约束后，调度曲线和损耗曲线趋于平缓，出力峰值小幅下降就能使损耗峰值大幅降低，主要是损耗与出力平方的负相关关系所致。</p><p>通过对比图2可知，小湾电站出力的峰值由2800 MW降至2200 MW时，能使损耗峰值从128 MW降至79 MW，</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Calculation parameters for each hydropower plan</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >电站名</th><th align="center" valign="middle" >调节能力</th><th align="center" valign="middle" >装机/MW</th><th align="center" valign="middle" >正常高水位/m</th><th align="center" valign="middle" >死水位/m</th><th align="center" valign="middle" >始水位/m</th><th align="center" valign="middle" >末水位/m</th><th align="center" valign="middle" >调度日平均区间流量m<sup>3</sup>/s</th></tr></thead><tr><td align="center" valign="middle" >小湾</td><td align="center" valign="middle" >多年</td><td align="center" valign="middle" >4200.00</td><td align="center" valign="middle" >1240.00</td><td align="center" valign="middle" >1166.00</td><td align="center" valign="middle" >1219.00</td><td align="center" valign="middle" >1219.00</td><td align="center" valign="middle" >664.34</td></tr><tr><td align="center" valign="middle" >漫湾</td><td align="center" valign="middle" >季</td><td align="center" valign="middle" >1670.00</td><td align="center" valign="middle" >994.00</td><td align="center" valign="middle" >988.00</td><td align="center" valign="middle" >992.00</td><td align="center" valign="middle" >992.00</td><td align="center" valign="middle" >110.91</td></tr><tr><td align="center" valign="middle" >大朝山</td><td align="center" valign="middle" >季</td><td align="center" valign="middle" >1350.00</td><td align="center" valign="middle" >899.00</td><td align="center" valign="middle" >882.00</td><td align="center" valign="middle" >898.50</td><td align="center" valign="middle" >898.50</td><td align="center" valign="middle" >224.82</td></tr></tbody></table></table-wrap><p>表1. 各电站计算参数表</p><p>图2. 考虑电网约束前后调度曲线及损耗比较</p><p>即出力峰值的小幅降低(21.4%)能使电网损耗大幅降低(38.3%)，由于电网损耗是影响送电效率和电网安全稳定运行的重要因素，本文所提能有效降低电网损耗，提高电力消纳效率和电网稳定性。</p><p>表2为耦合电网约束前后梯级水电站出力及输电损耗结果，由结果对比可知，在不考虑电网约束时，梯级总发电量为51,107.5 MWh，损耗为1397.52 MWh，受电侧受电量为49,709.98 MWh；在考虑电网约束后，梯级</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Result of output power and transmission losses of stations before and after coupling grid constraint</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >时段/总计</th><th align="center" valign="middle"  colspan="3"  >考虑电网约束前出力</th><th align="center" valign="middle"  colspan="3"  >考虑电网约束后出力</th><th align="center" valign="middle"  colspan="3"  >考虑电网约束前损耗</th><th align="center" valign="middle"  colspan="3"  >考虑电网约束后损耗</th></tr></thead><tr><td align="center" valign="middle" >小湾</td><td align="center" valign="middle" >漫湾</td><td align="center" valign="middle" >大朝山</td><td align="center" valign="middle" >小湾</td><td align="center" valign="middle" >漫湾</td><td align="center" valign="middle" >大朝山</td><td align="center" valign="middle" >小湾</td><td align="center" valign="middle" >漫湾</td><td align="center" valign="middle" >大朝山</td><td align="center" valign="middle" >小湾</td><td align="center" valign="middle" >漫湾</td><td align="center" valign="middle" >大朝山</td></tr><tr><td align="center" valign="middle" >00:00~01:00</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >01:00~02:00</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >02:00~03:00</td><td align="center" valign="middle" >700.0</td><td align="center" valign="middle" >300.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >700.0</td><td align="center" valign="middle" >300.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >8.00</td><td align="center" valign="middle" >3.43</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >8.00</td><td align="center" valign="middle" >3.43</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >03:00~04:00</td><td align="center" valign="middle" >700.0</td><td align="center" valign="middle" >500.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >700.0</td><td align="center" valign="middle" >550.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >8.00</td><td align="center" valign="middle" >9.52</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >8.00</td><td align="center" valign="middle" >11.52</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >04:00~05:00</td><td align="center" valign="middle" >700.0</td><td align="center" valign="middle" >500.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >780.0</td><td align="center" valign="middle" >550.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >8.00</td><td align="center" valign="middle" >9.52</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >9.93</td><td align="center" valign="middle" >11.52</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >05:00~06:00</td><td align="center" valign="middle" >700.0</td><td align="center" valign="middle" >500.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >780.0</td><td align="center" valign="middle" >550.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >8.00</td><td align="center" valign="middle" >9.52</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >9.93</td><td align="center" valign="middle" >11.52</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >06:00~07:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >500.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >1600.0</td><td align="center" valign="middle" >550.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >9.52</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >41.80</td><td align="center" valign="middle" >11.52</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >07:00~08:00</td><td align="center" valign="middle" >2100.0</td><td align="center" valign="middle" >620.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >1900.0</td><td align="center" valign="middle" >600.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >72.00</td><td align="center" valign="middle" >14.64</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >58.94</td><td align="center" valign="middle" >13.71</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >08:00~09:00</td><td align="center" valign="middle" >2800.0</td><td align="center" valign="middle" >620.0</td><td align="center" valign="middle" >880.0</td><td align="center" valign="middle" >2200.0</td><td align="center" valign="middle" >600.0</td><td align="center" valign="middle" >800.0</td><td align="center" valign="middle" >128.00</td><td align="center" valign="middle" >14.64</td><td align="center" valign="middle" >29.50</td><td align="center" valign="middle" >79.02</td><td align="center" valign="middle" >13.71</td><td align="center" valign="middle" >24.38</td></tr><tr><td align="center" valign="middle" >09:00~10:00</td><td align="center" valign="middle" >2800.0</td><td align="center" valign="middle" >620.0</td><td align="center" valign="middle" >880.0</td><td align="center" valign="middle" >2200.0</td><td align="center" valign="middle" >600.0</td><td align="center" valign="middle" >800.0</td><td align="center" valign="middle" >128.00</td><td align="center" valign="middle" >14.64</td><td align="center" valign="middle" >29.50</td><td align="center" valign="middle" >79.02</td><td align="center" valign="middle" >13.71</td><td align="center" valign="middle" >24.38</td></tr><tr><td align="center" valign="middle" >10:00~11:00</td><td align="center" valign="middle" >2800.0</td><td align="center" valign="middle" >620.0</td><td align="center" valign="middle" >880.0</td><td align="center" valign="middle" >2200.0</td><td align="center" valign="middle" >600.0</td><td align="center" valign="middle" >800.0</td><td align="center" valign="middle" >128.00</td><td align="center" valign="middle" >14.64</td><td align="center" valign="middle" >29.50</td><td align="center" valign="middle" >79.02</td><td align="center" valign="middle" >13.71</td><td align="center" valign="middle" >24.38</td></tr><tr><td align="center" valign="middle" >11:00~12:00</td><td align="center" valign="middle" >2100.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >160.0</td><td align="center" valign="middle" >1900.0</td><td align="center" valign="middle" >650.0</td><td align="center" valign="middle" >190.0</td><td align="center" valign="middle" >72.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >58.94</td><td align="center" valign="middle" >16.10</td><td align="center" valign="middle" >1.38</td></tr><tr><td align="center" valign="middle" >12:00~13:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >160.0</td><td align="center" valign="middle" >1600.0</td><td align="center" valign="middle" >650.0</td><td align="center" valign="middle" >190.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >41.80</td><td align="center" valign="middle" >16.10</td><td align="center" valign="middle" >1.38</td></tr><tr><td align="center" valign="middle" >13:00~14:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >160.0</td><td align="center" valign="middle" >1600.0</td><td align="center" valign="middle" >650.0</td><td align="center" valign="middle" >190.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >41.80</td><td align="center" valign="middle" >16.10</td><td align="center" valign="middle" >1.38</td></tr><tr><td align="center" valign="middle" >14:00~15:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >160.0</td><td align="center" valign="middle" >1600.0</td><td align="center" valign="middle" >650.0</td><td align="center" valign="middle" >190.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >41.80</td><td align="center" valign="middle" >16.10</td><td align="center" valign="middle" >1.38</td></tr><tr><td align="center" valign="middle" >15:00~16:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >160.0</td><td align="center" valign="middle" >1600.0</td><td align="center" valign="middle" >650.0</td><td align="center" valign="middle" >200.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >41.80</td><td align="center" valign="middle" >16.10</td><td align="center" valign="middle" >1.52</td></tr><tr><td align="center" valign="middle" >16:00~17:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >160.0</td><td align="center" valign="middle" >1600.0</td><td align="center" valign="middle" >650.0</td><td align="center" valign="middle" >200.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >41.80</td><td align="center" valign="middle" >16.10</td><td align="center" valign="middle" >1.52</td></tr><tr><td align="center" valign="middle" >17:00~18:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >160.0</td><td align="center" valign="middle" >1600.0</td><td align="center" valign="middle" >660.0</td><td align="center" valign="middle" >200.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.98</td><td align="center" valign="middle" >41.80</td><td align="center" valign="middle" >16.59</td><td align="center" valign="middle" >1.52</td></tr><tr><td align="center" valign="middle" >18:00~19:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >220.0</td><td align="center" valign="middle" >1500.0</td><td align="center" valign="middle" >660.0</td><td align="center" valign="middle" >210.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >1.84</td><td align="center" valign="middle" >36.73</td><td align="center" valign="middle" >16.59</td><td align="center" valign="middle" >1.68</td></tr><tr><td align="center" valign="middle" >19:00~20:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >1500.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >36.73</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >20:00~21:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >1500.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >36.73</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >21:00~22:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >1500.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >36.73</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >22:00~23:00</td><td align="center" valign="middle" >1400.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >1500.0</td><td align="center" valign="middle" >670.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >32.00</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >36.73</td><td align="center" valign="middle" >17.10</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle" >23:00~24:00</td><td align="center" valign="middle" >1403.3</td><td align="center" valign="middle" >704.2</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >1500.0</td><td align="center" valign="middle" >700.0</td><td align="center" valign="middle" >0.0</td><td align="center" valign="middle" >32.15</td><td align="center" valign="middle" >18.89</td><td align="center" valign="middle" >0.00</td><td align="center" valign="middle" >36.73</td><td align="center" valign="middle" >18.67</td><td align="center" valign="middle" >0.00</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >总计</td><td align="center" valign="middle" >33603.3</td><td align="center" valign="middle" >13524.2</td><td align="center" valign="middle" >3980</td><td align="center" valign="middle" >33560</td><td align="center" valign="middle" >13500</td><td align="center" valign="middle" >3970</td><td align="center" valign="middle" >976.151</td><td align="center" valign="middle" >324.20</td><td align="center" valign="middle" >97.17</td><td align="center" valign="middle" >903.78</td><td align="center" valign="middle" >321.21</td><td align="center" valign="middle" >84.90</td></tr><tr><td align="center" valign="middle"  colspan="3"  >51107.5</td><td align="center" valign="middle"  colspan="3"  >51030.0</td><td align="center" valign="middle"  colspan="3"  >1397.52</td><td align="center" valign="middle"  colspan="3"  >1309.89</td></tr></tbody></table></table-wrap><p>表2. 耦合电网约束前后梯级水电站出力及输电损耗</p><p>总发电量为51,030 MWh，损耗为1309.89 MWh，受电侧受电量为49,720.11 MWh，较于前者，虽然发电侧电量降低了22.5 MWh，但由于网损降低了6.3%，受电侧受电量反而增加了10.13 MWh，梯级受电侧电量提高了0.20‰，在大幅降低网损的同时提高了梯级受电侧的受电量，效果显著。</p></sec><sec id="s6_3"><title>4.3. 并行DDGA对传统遗传算法收敛性的提高</title><p>采用DDGA对上述模型进行计算，利用3.2节所述的方法生成初始解，梯级总发电量为适应度函数，将动态变异区域与固定变异区域进行比较计算，得到图3所示的收敛速度曲线。</p><p>从图3可以看出，在固定廊道大小的情况下，窄廊道搜索在前期收敛速度较慢，但在后期会有较快的收敛</p><p>图3. 三种变异方式收敛性比较</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Multi-core parallel computing spee</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >核心数</th><th align="center" valign="middle" >单核</th><th align="center" valign="middle" >2核</th><th align="center" valign="middle" >4核</th></tr></thead><tr><td align="center" valign="middle" >计算时间/s</td><td align="center" valign="middle" >30.8</td><td align="center" valign="middle" >16.7</td><td align="center" valign="middle" >9.6</td></tr><tr><td align="center" valign="middle" >加速比</td><td align="center" valign="middle" >1.00</td><td align="center" valign="middle" >1.84</td><td align="center" valign="middle" >3.31</td></tr><tr><td align="center" valign="middle" >效率/%</td><td align="center" valign="middle" >100.0</td><td align="center" valign="middle" >92.2</td><td align="center" valign="middle" >82.8</td></tr></tbody></table></table-wrap><p>表3. 多核并行计算速度对比</p><p>速度；宽廊道搜索在前期收敛速度较快，但在后期收敛速度较慢；本文提出的变廊道方法能在前期和后期都保持较快的收敛速度，较于前两者能更快的收敛到最优解。</p><p>采用Inter(R)Xeon(R)CPU E3-1230V5@3.4GHz四核八线程处理器平台，通过对含有100个个体的种群进行优化计算来验证并行计算的有效性。计算结果见表3。</p><p>从表3中可以看出，并行计算较串行计算(单核)速度提高显著，且核心数越多，计算耗时越短，计算速度与核心数近似成正比例关系。但是，多核并行计算较于单核串行并不是成倍的提升速度，主要有两方面原因，一方面是任务划分耗时；另一方面是算法不是每个步骤都能实现并行，有必要的串行环节。</p></sec></sec><sec id="s7"><title>5. 结论</title><p>本文主要在以下两方面实现了创新成果：1) 针对现有研究鲜有考虑电网损耗的弊端，建立了耦合电网损耗约束的水电站系统短期优化调度模型，在降低网络损耗的同时提高水电消纳电量；2) 结合近年来高性能计算研究成果，以离散微分动态规划与遗传算法为基础，提出了基于Fork/Join框架的多核并行DDGA方法，提高了算法的搜索性能与收敛速度。所提模型和方法的有效性和可行性通过了澜沧江梯级水电站群模拟结果的检验，可为水电系统短期优化调度问题提供有益参考。</p></sec><sec id="s8"><title>基金项目</title><p>中央高校基本科研业务费(DUT15RC(3)077)。</p></sec><sec id="s9"><title>文章引用</title><p>张跃驰,程春田,刘 康,陈 孚,刘本希. 耦合电网约束的水电系统短期发电调度研究 Study on Short-Term Scheduling of Hydropower System Coupling Grid Constraint[J]. 水资源研究, 2016, 05(03): 200-210. http://dx.doi.org/10.12677/JWRR.2016.53026</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.17744-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">纪昌明, 李继伟, 张新明, 等. 梯级水电站短期发电优化调度的免疫蛙跳算法应用研究[J]. 水力发电学报, 2015, 34(1): 29-36. 
JI Changming, LI Jiwei, ZHANG Xinming, et al. Application of immune-shuffled frog-leaping algorithm to optimized operation of cascade hydropower stations for short-term power generation. Journal of Hydroelectric Engineering, 2015, 34(1): 29-36. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">申建建, 程春田, 李卫东, 等. 复杂时段耦合型约束水电站群短期变尺度优化调度方法[J]. 中国电机工程学报, 2014, 34(1): 87-95. 
SHEN Jianjian, CHENG Chuntian, LI Weidong, et al. A mutative-scale optimization method for short-term operation of hy-dropower plants with complex temporal coupling constraints. Proceedings of the CSEE, 2014, 34(1): 87-95. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">贾江涛, 管晓宏, 翟桥柱. 考虑水头影响的梯级水电站群短期优化调度[J]. 电力系统自动化, 2009, 33(13): 13-16. 
JIA Jiangtao, GUAN Xiaohong and ZHAI Qiaozhu. Short-term optimal scheduling of head-dependent cascaded hydropower stations. Automation of Electric Power Systems, 2009, 33(13): 13-16.</mixed-citation></ref><ref id="hanspub.17744-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">马超. 耦合航运要求的三峡–葛洲坝梯级水电站短期调度快速优化决策[J]. 系统工程理论与实践, 2013, 33(5): 1345- 1350. 
MA Chao. Fast optimal decision of short-term dispatch of three gorges and Gezhouba cascade hydropower stations with navi-gation demand considered. Systems Engineering Theory &amp; Practice, 2013, 33(5): 1345-1350. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">胡国强. 梯级水电站优化调度模型与算法研究[D]: [博士学位论文]. 北京: 华北电力大学(北京), 2007. 
HU Guoqiang. Study on optimal scheduling model and algorithm of cascaded hydroelectric power plants. Beijing: North China Electric Power University (Beijing), 2007. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">邹进, 张勇传. 三峡梯级电站短期优化调度的模糊多目标动态规划[J]. 水利学报, 2005, 36(8): 925-931. 
ZOU Jin, ZHANG Yongchuan. Short-term optimal scheduling of cascade hydropower stations using fuzzy multi-objective dy-namic programming. Journal of Hydraulic Engineering, 2005, 36(8): 925-931. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">申建建, 武新宇, 程春田, 等. 大规模水电站群短期优化调度方法Ⅱ: 高水头多振动区问题[J]. 水利学报, 2011, 42(10): 1168-1176. 
SHEN Jianjian, WU Xinyu, CHEN Chuntian, et al. Comprehensive approach for classification of river systems and identification of ecological characteristics II. Applications. Journal of Hydraulic Engineering, 2011, 42(10): 1168-1176. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">武新宇, 程春田, 李刚, 等. 水电站群长期典型日调峰电量最大模型研究[J]. 水利学报, 2012, 43(3): 363-371. 
WU Xinyu, CHENG Chuntian, LI Gang, et al. Research on long term typical day peak load regulation energy maximization model for hydropower systems. Journal of Hydraulic Engineering, 2012, 43(3): 363-371. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">张忠波, 吴学春, 张双虎, 等. 并行动态规划和改进遗传算法在水库调度中的应用[J]. 水力发电学报, 2014, 33(4): 21-27. 
ZHANG Zhongbo, WU Xuechun, ZHANG Shuanghu, et al. Parallel dynamic programming and improved genetic algorithm and their application to reservoir operation. Journal of Hydroelectric Engineering, 2014, 33(4): 21-27. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">马宁. 水电站短期发电调度实用化模型及应用研究[D]: [硕士学位论文]. 大连: 大连理工大学, 2011. 
MA Ning. Hydro power station short-term scheduling practical modal and application research. Dalian: Dalian University of Technology, 2011. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">王金文, 刘双全. 短期水电系统发电调度的优化方法综述[J]. 水电能源科学, 2008, 26(6): 137-143. 
WANG Jinwen, LIU Shuangquan. Optimization techniques in short-term hydropower scheduling: A state-of-art review. Water Resources and Power, 2008, 26(6): 137-143. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">邵军. 一种理论线损计算的电量潮流法[D]: [硕士学位论文]. 大连: 大连理工大学, 2004. 
SHAO Jun. A power flow method for theoretical calculation of line loss. Dalian: Dalian University of Technology, 2011. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">申学滨. 电力线路损耗分析与计算方法比较[J]. 中国电力教育, 2014(3): 248-249. 
SHEN Xuebin. Comparison of power line loss analysis and calculation methods. China Electric Power Education, 2014(3): 248-249. (in Chinese)</mixed-citation></ref><ref id="hanspub.17744-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">RUDOLPH, G. Convergence analysis of canonical genetic algorithms. IEEE Transactions on Neural Networks, 1994, 5(1): 96- 101. &lt;br&gt;http://dx.doi.org/10.1109/72.265964</mixed-citation></ref><ref id="hanspub.17744-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">LEA, D. A Java fork/join framework. Proceedings of the ACM 2000 Conference on Java Grande, 2000, 36-43.  
&lt;br&gt;http://dx.doi.org/10.1145/337449.337465</mixed-citation></ref></ref-list></back></article>