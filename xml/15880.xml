<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2015.57032</article-id><article-id pub-id-type="publisher-id">CSA-15880</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20150700000_80829264.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于ADS1294的表面肌电信号检测系统设计
  Design of Surface Electromyography Measurement System Based on ADS1294
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>徐</surname><given-names>羽晨</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>史</surname><given-names>井雄</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>中国地质大学(武汉)机械与电子信息学院，湖北 武汉</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>348963055@qq.com(徐羽)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>17</day><month>08</month><year>2015</year></pub-date><volume>05</volume><issue>07</issue><fpage>247</fpage><lpage>254</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  针对表面肌电信号微弱、易受干扰的特点，设计了一种基于ADS1294的表面肌电信号检测系统。系统采用了模拟前端ADS1294电路对表面肌电信号进行滤波、调理和采集，设计了MSP430F169主控制器电路将采集的肌电信号数据传输给上位机，并在LabVIEW环境下，开发了肌电信号检测系统上位机应用程序。该应用程序功能包括信号显示、数字滤波、波形记录及存储回放。实验结果表明，此系统能有效采集及显示表面肌电信号。
   According to the weakness and vulnerable of the surface electromyography, a surface electro-myography measurement system based on ADS1294 is designed in this paper. The system uses the ADS1294 circuit to condition and measure the surface electromyography. And a MSP430F169 control circuit is adapted to transfer the measured signal to the upper computer. In the LabVIEW environment, a surface electromyography detection application is designed and developed. The application functions include surface electromyography waveform display, digital filtering, wave-form recording and playback. The validity has been verified by lots of experiment.
 
</p></abstract><kwd-group><kwd>表面肌电信号，ADS1294，LabVIEW, Surface Electromyography</kwd><kwd> ADS1294</kwd><kwd> LabVIEW</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于ADS1294的表面肌电信号检测系统设计<sup> </sup></title><p>徐羽晨，史井雄</p><p>中国地质大学(武汉)机械与电子信息学院，湖北 武汉</p><p>Email: 348963055@qq.com</p><p>收稿日期：2015年7月25日；录用日期：2015年8月11日；发布日期：2015年8月17日</p><disp-formula id="hanspub.15880-formula53"><graphic xlink:href="http://html.hanspub.org/file/1-1540487x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对表面肌电信号微弱、易受干扰的特点，设计了一种基于ADS1294的表面肌电信号检测系统。系统采用了模拟前端ADS1294电路对表面肌电信号进行滤波、调理和采集，设计了MSP 430F 169主控制器电路将采集的肌电信号数据传输给上位机，并在LabVIEW环境下，开发了肌电信号检测系统上位机应用程序。该应用程序功能包括信号显示、数字滤波、波形记录及存储回放。实验结果表明，此系统能有效采集及显示表面肌电信号。</p><p>关键词 :表面肌电信号，ADS1294，LabVIEW</p><disp-formula id="hanspub.15880-formula54"><graphic xlink:href="http://html.hanspub.org/file/1-1540487x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>肌电信号是人体肌肉活动时运动单位动作电位在肌肉、皮下组织和皮肤等相互作用的电位叠加，包含着神经、肌肉的多种功能信息。通过对肌电信号的检测以及信息提取，可以广泛应用在临床医学、生物仿生和机器人控制等方面[<xref ref-type="bibr" rid="hanspub.15880-ref1">1</xref>] -[<xref ref-type="bibr" rid="hanspub.15880-ref3">3</xref>] 。然而表面肌电信号幅值微弱，一般在10~5000 μV，频率范围20~500 Hz，在背景噪声较大情况下使得有用信号的获取更为困难。</p><p>目前针对肌电信号采集处理系统的研究主要体现在三个方面：在成本控制前提下如何更加有效获取有用信号 [<xref ref-type="bibr" rid="hanspub.15880-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.15880-ref5">5</xref>] ，背景噪声的去噪处理方法 [<xref ref-type="bibr" rid="hanspub.15880-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.15880-ref7">7</xref>] ，肌电信号的特征提取及模式识别 [<xref ref-type="bibr" rid="hanspub.15880-ref8">8</xref>] 。有效信号的检测方法分为两种方式来实现，一种是采用分立器件设计信号调理和转换电路，另一种是采用专用集成测量模拟前端电路设计 [<xref ref-type="bibr" rid="hanspub.15880-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.15880-ref10">10</xref>] 。前者成本低，设计灵活，但是易于引入较大噪声，模拟前端电路将肌电信号的采集、前置放大、模数转换等功能全部集成在一个芯片内，对肌电信号进行滤波、陷波简单预处理，就能获取有用信号，具有抗噪声能力强，检测精度高，设计简单等特点，但是成本较高。</p><p>通过对比两种测量方式，本系统采用模拟前端ADS1294电路对表面肌电信号进行滤波、调理和采集，设计了MSP 430F 169主控制器电路将采集的肌电信号数据传输给上位机，在LabVIEW环境下，开发了肌电信号检测系统上位机应用程序。该应用程序实现了对硬件电路采集的信号进行数据转换、波形显示和存储回放，以及一些简单的滤波处理。</p></sec><sec id="s4"><title>2. 系统总体设计</title><p>整个系统由基于ADS1294的表面肌电信号采集模块、主控制器MSP 430F 169模块和上位机LabVIEW模块组成，系统结构图如图1所示。基于ADS1294的表面肌电信号采集模块负责采集表面肌电信号。主控制器MSP 430F 169模块功能是将采集的数据通过SPI接口传输给上位机。上位机LabVIEW模块对接收的肌电信号波形显示、数字滤波、波形记录及存储回放。</p></sec><sec id="s5"><title>3. 硬件电路设计</title><sec id="s5_1"><title>3.1. 基于ADS1294的信号采集电路设计</title><p>肌电信号采集模块，先对电极拾取的肌电信号进行滤波和放大预处理，再由模拟前端ADS1294进行内部增益放大和AD转换。</p><p>ADS1294是TI公司专用于生物电测量的全面集成型模拟前端芯片，它集成了高转换精度的模数转换</p><p>图1. 系统结构图</p><p>模块、程控差分输入放大器、右腿驱动和Wilson电阻网络等[<xref ref-type="bibr" rid="hanspub.15880-ref9">9</xref>] 。而且ADS1294包含了所有医疗心电图(ECG)和脑电图(EEG)应用所通常要求的所有特征。借助于其高水平的集成和出色的性能，模拟前端ADS1294可大大减小医疗仪器的尺寸、功率和总体成本。</p><p>由于ADS1294模拟前端高度集成，外围电路只需要一些去耦及增强器件稳定性的电容。主控制器MSP 430F 169通过SPI接口对ADS1294模拟前端进行寄存器配置、数据读写和运行控制操作。为了增强SPI接口的驱动能力，避免数据传输时受到干扰而出现数据传输出错，在设计时将SPI接口的时钟SPI_SCLK、数据输入SPI_DIN和数据输出SPI_DOUT三根信号线进行上拉。模拟前端ADS1294核心电路如图2所示。</p></sec><sec id="s5_2"><title>3.2. 主控制器MSP 430F 169电路设计</title><p>MSP 430F 169微控制器是TI公司基于RISC的16位混合信号处理器，专为满足超低功耗需求而精心设计。其内部集成了同步通信(USART)/异步通信(SPI)接口和48个IO口。MSP 430F 169内部具有60 kB + 256 B的Flash，其工作最高频率可达8 MHz。</p><p>基于MSP 430F 169微控制器低功耗、设计简单、性能好的特点，本设计采用MSP 430F 169作为主控制器。主控制器MSP 430F 169模块在系统中的主要功能有以下几点：1) 利用SPI接口对ADS1294内部寄存器进行配置；2) 通过I/O口控制ADS1294采集肌电信号；3) 信号采集完后的中断识别、数据读取及Flash存储；4) 利用异步通信UASRT将存储在Flash中的肌电信号上传给上位机。其控制电路如图3所示。</p></sec></sec><sec id="s6"><title>4. 软件设计</title><sec id="s6_1"><title>4.1. 主控制器MSP 430F 169软件设计</title><p>主控制器MSP 430F 169软件设计的整体程序流程图如图4所示。系统上电后，先初始化配置ADS1294寄存器，然后开始采集，当数据准备完成产生中断，MSP 430F 169识别中断后读取ADS1294转换的数据并存储在flash中。当flash存满时，将所有采集的数据上传给上位机。</p></sec><sec id="s6_2"><title>4.2. 上位机LabVIEW软件设计</title><p>本设计以虚拟仪器LabVIEW作为上位机，对MSP 430F 169传输上来的数据进行波形显示、数字滤</p><p>图2. 模拟前端ADS1294电路图</p><p>波及存储回放等操作。在程序设计时，采用事件结构对不同的事件进行压栈和判断。当具体事件来临，将进入具体事件结构中进行循环执行，直到其他的指令发出。上位机程序流程图如图5所示。</p><p>上位机LabVIEW程序的设计首先是建立数据存储文件。为了文件的读取方便，在建立文件时，给每通道的数据进行命名，同时将每一组数据进行编号，这样也便于数据的查错。其次是数据通过串口读取后的数据处理。在程序中，每个通道的数据都需处理，因此在设计时采用子程序打包调用的方法，使程序简洁、可读性强。最后，将处理后的数据进行保存、显示及数字滤波等。</p></sec></sec><sec id="s7"><title>5. 实验及结果分析</title><p>为测试系统的有效性，首先对系统进行了内部短路噪声测试、电极自然电位测试以及交直流静态测试。测试条件采用9 V干电池供电，采用6位半福禄克数字万用表进行标定，分别对三个通道接地，测试得到三通道的内部噪声最大波动值分别为：1.08 &#181;V, 1.25 &#181;V, 1.5 &#181;V。在此基础上，对人体手臂表面肌电信号进行采集。配置ADS1294的1~3通道的差分输入为正常输入，内部程控增益为12。人体手臂做伸缩运动时，主要依靠手臂的肱二头肌、肱三头肌和三角肌的肌肉组织。测试时ADS1294的三个通道的差分电极分别贴在手臂的肱二头肌、肱三头肌和三角肌，手臂做来回的伸缩动作。测得的原始波形及经过截止频率为500 Hz低通数字滤波后的波形分别如图6、图7所示。由图可知，未滤波的肌电信号最大为几十毫伏，滤波后的肌电信号为几百&#181;V~几毫伏，同时肱二头肌、肱三头肌和三角肌的肌电信号有差</p><p>图3. MSP 430F 169控制电路图</p><p>图4. MSP 430F 169程序流程图</p><p>图5. 上位机LabVIEW流程图</p><p>图6. 肌电信号原始波形</p><p>图7. 滤波后肌电信号波形</p><p>异，不动作时波形和文献[<xref ref-type="bibr" rid="hanspub.15880-ref5">5</xref>] 波形相似，幅值基本没有变化。动作引起的电位信号差异如何区分需要对测量数据进行特征量提取，模式识别，在线或离线辨识，然后再执行相应的动作[<xref ref-type="bibr" rid="hanspub.15880-ref8">8</xref>] 。</p></sec><sec id="s8"><title>6. 结论</title><p>肌电信号测量及处理系统在生物医疗、仿生智能机器、生物康复等方面具有广阔的应用前景。肌电信号的检测是该系统设计中的一个难点，获取实时、信噪比高的肌电信号，将大幅降低信号处理的难度，同时提高识别的有效性和准确性。论文设计的基于ADS1294的肌电信号采集系统，可以完成对手臂表面肌电信号的有效采集。整个系统以MSP430为主控制器控制各个模块的工作和数据传输，并利用虚拟仪器LabVIEW设计了上位机系统，可以实现对数据的有效处理、波形显示和存储回放。该系统为分析手臂运动信号与检测肌电信号相关性提供了良好的平台，在此基础上将进一步研究肌电信号的特征提取，在线或离线模式识别。</p></sec><sec id="s9"><title>文章引用</title><p>徐羽晨,史井雄. 基于ADS1294的表面肌电信号检测系统设计Design of Surface Electromyography Measurement System Based on ADS1294[J]. 计算机科学与应用, 2015, 05(07): 247-254. http://dx.doi.org/10.12677/CSA.2015.57032</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.15880-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">高韧杰 (2013) 智能仿生手臂的表面肌电信号采集与动作仿真系统设计. 吉林大学, 吉林.</mixed-citation></ref><ref id="hanspub.15880-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">朱仕勇 (2013) 手持式肌电信号采集系统设计与应用研究. 武汉理工大学, 武汉.</mixed-citation></ref><ref id="hanspub.15880-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">赖玥, 肖纯贤, 马超, 等 (2013) 基于S3C2440和ADS1294的心电信号采集和处理系统. 南开大学学报(自然科学版), 46, 93-96.</mixed-citation></ref><ref id="hanspub.15880-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">吴晓维, 田联房, 莫鸿强, 等 (2013) 表面膈肌肌电的测量系统的设计与实现. 计算机测量与控制, 21, 82-84.</mixed-citation></ref><ref id="hanspub.15880-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">滕燕, 王士允, 尹振全, 李小宁 (2013) 表面肌电信号采集与处理系统研究. 机床与液压, 41, 4-7.</mixed-citation></ref><ref id="hanspub.15880-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">席旭刚, 左静, 张启忠, 罗志增 (2014) 多通道表面肌电信号降噪与去混迭研究. 传感技术学报, 27, 293-298.</mixed-citation></ref><ref id="hanspub.15880-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">娄智, 邓浩, 陈香, 等 (2014) 基于自适应阈值处理的表面肌电信号小波去噪研究. 生物医学工程学杂志, 31, 723-728.</mixed-citation></ref><ref id="hanspub.15880-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">卜峰, 李传江, 陈佳佳, 等 (2014) 基于ARM的肌电假肢控制器. 上海大学学报(自然科学版), 20, 442-449.</mixed-citation></ref><ref id="hanspub.15880-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">路敦强, 王为, 陈永鹏 (2015) 基于ADS1298的表面肌电采集系统设计. 天津师范大学学报(自然科学版), 35, 34-37.</mixed-citation></ref><ref id="hanspub.15880-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">http://www.ti.com/product/ADS1294</mixed-citation></ref></ref-list></back></article>