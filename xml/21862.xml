<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">HJWC</journal-id><journal-title-group><journal-title>Hans Journal of Wireless Communications</journal-title></journal-title-group><issn pub-type="epub">2163-3983</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/HJWC.2017.74018</article-id><article-id pub-id-type="publisher-id">HJWC-21862</article-id><article-categories><subj-group subj-group-type="heading"><subject>HJWC20170400000_98696035.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于GPRS的温室大棚信息采集及控制
  Greenhouses Information Collection and Control Based on GPRS
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陆</surname><given-names>招兰</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>谢</surname><given-names>怀文</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>太平人寿保险有限公司福建分公司，福建 福州</addr-line></aff><aff id="aff1"><addr-line>三明学院现代教育技术中心，福建 三明</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>csc5711@163.com(陆招)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>08</day><month>08</month><year>2017</year></pub-date><volume>07</volume><issue>04</issue><fpage>144</fpage><lpage>154</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   由STC89C52单片机采集信息和智能控制，利用GPRS无线传输模块定时把温室大棚采集到的温度、湿度、光照强度以及CO2浓度等数据传输给上位机(PC机)，实时观察，同时又通过PC机对下位机(单片机)采集的信息进行分析，并发出相应指令给下位机作出相应的控制，如通风设备、喷淋装置、遮阳网等装置。 Greenhouses state parameters (such as temperature, humidity, light intensity and CO2 concentra-tion) which are collected and intelligently controlled by MCU (STC89C52) are transmitted to the host computer (PC) for real-time observation. By analyzing information provided by lower computer (MCU), PC orders STC89C52 to send control commands to ventilation equipment, spray device and Shade net. 
  
 
</p></abstract><kwd-group><kwd>温室大棚，远程监控，GPRS，STC89C52, Greenhouse</kwd><kwd> Remote Monitoring</kwd><kwd> GPRS</kwd><kwd> STC89C52</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于GPRS的温室大棚信息采集及控制<sup> </sup></title><p>陆招兰<sup>1</sup>，谢怀文<sup>2</sup></p><p><sup>1</sup>三明学院现代教育技术中心，福建 三明</p><p><sup>2</sup>太平人寿保险有限公司福建分公司，福建 福州</p><p>收稿日期：2017年8月12日；录用日期：2017年8月23日；发布日期：2017年8月30日</p><disp-formula id="hanspub.21862-formula30"><graphic xlink:href="http://html.hanspub.org/file/3-1730253x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>由STC 89C 52单片机采集信息和智能控制，利用GPRS无线传输模块定时把温室大棚采集到的温度、湿度、光照强度以及CO<sub>2</sub>浓度等数据传输给上位机(PC机)，实时观察，同时又通过PC机对下位机(单片机)采集的信息进行分析，并发出相应指令给下位机作出相应的控制，如通风设备、喷淋装置、遮阳网等装置。</p><p>关键词 :温室大棚，远程监控，GPRS，STC 89C 52</p><disp-formula id="hanspub.21862-formula31"><graphic xlink:href="http://html.hanspub.org/file/3-1730253x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>我国温室大棚的应用越来越广，根据农业生产的实际需要，研究设计温室大棚信息采集系统，对于温室大棚信息采集的智能化和实时监测自动化，实现土壤诊断、合理施肥灌溉、调温以及遮阳补光等具有重要的意义 [<xref ref-type="bibr" rid="hanspub.21862-ref1">1</xref>] 。</p><p>基于GPRS的温室大棚信息采集及控制系统的设计，通过温度传感器、湿度传感器、CO<sub>2</sub>传感器和光敏传感器采集大棚内温度、湿度、CO<sub>2</sub>浓度和光照强度等信息，由STC 89C 52单片机(下位机)分时循环收集各传感器信息并实时由GPRS模块发送到管理员室的PC机(上位机) [<xref ref-type="bibr" rid="hanspub.21862-ref2">2</xref>] ，管理员可以通过PC机实时查询大棚的相关信息。</p><p>PC机可以对采集的信息自动数据处理，做出相应的控制，如通风设备、喷淋装置、遮阳网等装置的打开或关闭；可以定时对多个大棚数据采集和保存，保存的数据有时间记录，这便于对各批次作物成长的分析。管理员可以通过pc机对大棚环境参数值适时调整设置，实现闭环控制，对不同季节、不同农作物进行环境参数的调整，实现对大棚的高效管理 [<xref ref-type="bibr" rid="hanspub.21862-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.21862-ref4">4</xref>] 。</p><p>本设计大棚内单片机系统(下位机)采用模块化的设计思路。使用STC 89C 52作为控制核心、无线传输模块使用GTM900C GPRS模块，液晶显示使用LCD12864等元器件，设计出的硬件系统使用简单，功耗低，性价比高 [<xref ref-type="bibr" rid="hanspub.21862-ref5">5</xref>] 。</p></sec><sec id="s4"><title>2. 系统硬件设计</title><sec id="s4_1"><title>2.1. 系统结构</title><p>系统结构主要由传感器、单片机及GPRS模块(下位机)和数据中心PC机(上位机)四部分组成如图1所示。通过各传感器把采集到的信息传送至单片机，单片机把接受到的信息通过GPRS模块传输到PC机上，然后再由PC机对这些信息进行分析处理 [<xref ref-type="bibr" rid="hanspub.21862-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.21862-ref7">7</xref>] 。其中一台PC机可以访问多个GPRS模块，从而实现多个温室大棚的分时控制，形成一对多的温室大棚测控系统。</p></sec><sec id="s4_2"><title>2.2. 硬件结构原理</title><p>硬件电路主要由信息采集、数据收发控制、信息显示、系统控制四部分组成。其中信息采集主要由温湿度传感器、光照强度以及CO<sub>2</sub>浓度传感器组成；数据收发控制主要由GPRS模块和PC机组成；信息显示由LCD12864组成；系统控制主要由单片机和PC机构成；其系统结构框图如图2所示。通过温度传感器、湿度传感器、光敏传感器以及CO<sub>2</sub>浓度传感器把采集到的信息传送至MCU和GPRS模块单元，单片机把处理好的数据在通过串口发送至GPRS模块，由LCD12864显示采集的信息，在由GPRS模块与PC机进行联通，并由GPRS模块发送至Internet网络，PC机通过访问Internet得到数据。对这些采集到的信息，PC机可以进行分析，并做出相应的控制，如打开或关闭通风设备、喷淋装置、化学反应</p><p>图1. 整机系统框图</p><p>图2. 单片机系统结构框图</p><p>装置和遮阳网等。</p><p>其中温湿度传感器是利用到了单片机的P3.7引脚进行单总线数据信息的采集和传输，光照强度传感器是利用了单片机的P3.6和P3.5两个引脚通过I <sup>2</sup>C 总线进行数据的采集和传输，GPRS模块利用单片机的P3.0和P3.1两个引脚进行串口通信。</p><p>温湿度传感器选用DHT11，具有响应速度快、抗干扰能力强、性价比高等优点；</p><p>光照强度传感器选用BH1750FVI，是一种数字型光强度传感器集成电路，它支持I <sup>2</sup>C 总线接口，具有高分辨率，抗干扰能力强；</p><p>CO<sub>2</sub>传感器选用VC1008T，其精度高、性能稳定；</p><p>GPRS模块选用华为GTM 900C 双频900/1800 MHZ，其内嵌TCP/IP协议模块，使用简单，设计成本低。GTM 900C 模块的工作原理图如图3所示。</p></sec></sec><sec id="s5"><title>3. 软件设计</title><p>程序编写主要包括信息采集和显示，单片机和GPRS的串口通信，以及控制GPRS实现联网和发送数据的功能 [<xref ref-type="bibr" rid="hanspub.21862-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.21862-ref9">9</xref>] 。</p><sec id="s5_1"><title>3.1. 系统程序流程图</title><p>系统主程序流程图如图4所示。</p><p>图3. GTM 900C 工作原理图</p><p>图4. 主程序流程图</p></sec><sec id="s5_2"><title>3.2. 单片机部分程序</title><p>LCD12864显示流程图、向BH1750发送单个字节流程图和连续读取数据及储存流程图如图5所示。</p></sec><sec id="s5_3"><title>3.3. 单片机通过串口向GPRS发送AT指令到网络</title><p>通过单片机和GPRS进行串口通信，把单片机采集的信息发送到上位机，其程序流程图如图6所示。</p><p>图5. 部分程序流程图</p><p>图6. GPRS联网流程图</p></sec><sec id="s5_4"><title>3.4. PC接收数据程序</title><p>接收数据程序流程图如图7所示。</p><p>编译程序生成应用软件后，服务器接收界面如图8所示。</p><p>图7. 上位机(PC)流程图</p><p>图8. 上位机(PC)界面图</p></sec></sec><sec id="s6"><title>4. 整机调试</title><sec id="s6_1"><title>4.1. GPRS串口联网的测试</title><p>依次在GSM串口调试助手程序界面输入以下AT指令，若板子正常且连网成功，且能够在TCP/UDP Socket调试工具中显示发送的数据(http)，显示如图9和图10所示，说明板子正常，能够正常连网和发送数据。</p><p>AT + CGDCONT = 1, IP, CMNET</p><p>AT%ETCPIP</p><p>AT%IOMODE = 0, 2, 0</p><p>AT%IPOPENX = 1, TCP, 111.164.240.229, 1001</p><p>AT%TPS = 1, 1, 3000, 1024</p><p>http</p><p>本系统通过温湿度传感器、光照强度传感器以及CO<sub>2</sub>浓度传感器采集信息并传送至单片机，由单片机屏显采集的信息，经GPRS模块串口通信，把采集的信息发送至上位机，上位机对接收到的信息进行相应的信息处理及管理。</p><p>图9. GPRS联网测试串口调试助手图</p><p>图10. GPRS联网测试上位机接收图</p></sec><sec id="s6_2"><title>4.2. GTM 900C 模块连接Internet网络的测试</title><p>第一步：连接电源线；将串口线的端口一端与板子的端口相连，另一端与电脑的串口端口相连。如图11所示。</p><p>第二步：插入SIM卡，如图12所示。</p><p>第三步：打开电路板电源，红灯亮，黄灯闪。</p><p>第四步：打开电脑中的GSM串口调试助手程序。</p><p>第五步：在GSM串口调试助手程序界面打开串口，依次点选GSM调试专用栏的几个按钮，若板子正常，则显示如图13所示。</p></sec><sec id="s6_3"><title>4.3. 单片机控制显示数据测试</title><p>将温湿度传感器、光敏传感器和LCD12864插入所设计的板中，将调试好的程序烧写入单片机，打开电源开关，液晶会显示如图14所示的值，说明硬件和软件都测试成功了。</p></sec><sec id="s6_4"><title>4.4. GPRS传送数据测试</title><p>将GPRS模块与单片机通过串口连接好后，打开上位机，设置好端口和IP，将调试好的程序烧写到单片机。打开GPRS模块和开发板电源，查看上位机是否与下位机联上网。如果联上网了，上位机将接</p><p>图11. GTM 900C 模块</p><p>图12. 插入SIM卡模块图</p><p>图13. GSM串口调试助手程序界面</p><p>图14. 单片机控制显示数据测试图</p><p>图15. GPRS 传送数据测试</p><p>收到下位机发送的数据，同时会将接收到的数据在相应的窗口显示，在对接收到的数据进行分析处理后将对下位机进行相应的控制。测试成功，上位机屏显如图15所示。</p></sec></sec><sec id="s7"><title>5. 结语</title><p>通过硬件系统、软件系统、GPRS模块的设计，实现了温室大棚环境参数的采集、显示、传输、接收和控制。取得的主要结果如下：</p><p>1) 对GPRS模块提出的组网方案，能够符合设计要求，很好的实现了各项功能。</p><p>2) 大棚内单片机系统设计采用模块化的思路。使用STC 89C 52作为控制核心、无线传输模块使用GTM900C GPRS模块，液晶显示使用LCD12864等元器件，设计出的硬件系统使用简单，功耗低，性价比高。</p><p>3) 用C语言编写的程序简单方便。程序主要包括信息的采集和显示、单片机和GPRS模块的串口通信以及GPRS联网和数据传输的程序，以及用VB语言编写的PC机程序。</p><p>4) 经测试，上位机(pc机)定时对多个大棚数据采集和保存，保存的数据有时间记录，这便于对各批次作物成长的分析。自动定时采集数据，每30分钟对各大棚循环采集存贮一次，这样设计使数据存贮量不会太大又达到监控的效果。</p><p>5) 本设计同时可以随时通过pc机键盘手动采集数据和操作大棚的控制系统。</p></sec><sec id="s8"><title>文章引用</title><p>陆招兰,谢怀文. 基于GPRS的温室大棚信息采集及控制Greenhouses Information Collection and Control Based on GPRS[J]. 无线通信, 2017, 07(04): 144-154. http://dx.doi.org/10.12677/HJWC.2017.74018</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.21862-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">董文国. 蔬菜温室大棚智能控制系统的设计[D]: [硕士学位论文]. 曲阜: 曲阜师范大学, 2012.</mixed-citation></ref><ref id="hanspub.21862-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">孙小春. 基于GPRS技术的土壤信息采集关键技术研究[D]: [硕士学位论文]. 咸阳: 西北农林科技大学, 2010.</mixed-citation></ref><ref id="hanspub.21862-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">张新. 无线传感网技术在现代设施农业中的应用开发[J]. 安徽农业科学, 2016(7): 296-299.</mixed-citation></ref><ref id="hanspub.21862-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">邢坤等. 基于GPRS的杏鲍菇温室环境远程监控系统设计[J]. 中国农机化学报, 2014, 35(2): 266-270.</mixed-citation></ref><ref id="hanspub.21862-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">辛艳辉, 袁合才. 基于单片机和TC35i的温室大棚智能监测系统设计[J]. 安徽农业科学, 2011, 39(13): 8093-8094.</mixed-citation></ref><ref id="hanspub.21862-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">芦燕. 温室实时监控系统上位机软件设计与实现[D]: [硕士学位论文]. 银川: 宁夏大学, 2014.</mixed-citation></ref><ref id="hanspub.21862-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">康鸿雁. 基于GSM短消息的农业大棚信息采集系统设计[J]. 安徽农业科学, 2012, 40(4): 2526-2528.</mixed-citation></ref><ref id="hanspub.21862-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">李军科, 等. 基于USB存储与GPRS传输的温室大棚参数监测设计[J]. 中国农机化学报, 2015, 36(5): 82-86.</mixed-citation></ref><ref id="hanspub.21862-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">韩岳. 温室大棚物联网智能测控系统研究[D]: [硕士学位论文]. 泰安: 山东农业大学, 2016.</mixed-citation></ref></ref-list></back></article>