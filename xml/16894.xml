<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2016.61006</article-id><article-id pub-id-type="publisher-id">CSA-16894</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20160100000_85176704.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  办公自动化系统基于表单的工作流设计与实现
  Design and Implementation of Workflow Based on Form for Office Automation System
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>梦苏</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>广州市广百股份有限公司，广东 广州</addr-line></aff><author-notes><corresp id="cor1">* E-mail:</corresp></author-notes><pub-date pub-type="epub"><day>18</day><month>01</month><year>2016</year></pub-date><volume>06</volume><issue>01</issue><fpage>50</fpage><lpage>57</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  本文以某企业电器分公司批发零售供应商审批事务为基础，实现电子化、规范化内部业务数据的审批流程，基于现有OA系统的工作流模块，应用HTML技术电子化流程表单，应用SQL Server及Oracle数据库技术进行二次开发，将部分数据从OA系统同步到相关业务系统，实现跨系统、跨数据库的交互，充分高效地利用了企业的人员、办公时间、空间、信息等资源，通过工作流优化设计，提高了企业工作效率。
   Based on approval affairs of an appliances company’s wholesale and retail supplier, this paper electronically achieves standardization and approval process for internal business data. The workflow module is based on existing OA system and uses HTML technology electronic flow form. The secondary development uses SQL Server, Oracle database technology and synchronization part of the data from the OA system to the relevant business system. This work fully and efficiently uses resources of the enterprise personnel, time, space and information. Through the work flow opti-mization design, the working efficiency of enterprises is improved.
 
</p></abstract><kwd-group><kwd>办公自动化，表单，工作流，存储过程, Office Automation</kwd><kwd> Form</kwd><kwd> Workflow</kwd><kwd> Stored Procedure</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>办公自动化系统基于表单的工作流设计与实现<sup> </sup></title><p>刘梦苏</p><p>广州市广百股份有限公司，广东 广州</p><disp-formula id="hanspub.16894-formula521"><graphic xlink:href="http://html.hanspub.org/file/6-1540546x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年1月7日；录用日期：2016年1月23日；发布日期：2016年1月30日</p><disp-formula id="hanspub.16894-formula522"><graphic xlink:href="http://html.hanspub.org/file/6-1540546x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文以某企业电器分公司批发零售供应商审批事务为基础，实现电子化、规范化内部业务数据的审批流程，基于现有OA系统的工作流模块，应用HTML技术电子化流程表单，应用SQL Server及Oracle数据库技术进行二次开发，将部分数据从OA系统同步到相关业务系统，实现跨系统、跨数据库的交互，充分高效地利用了企业的人员、办公时间、空间、信息等资源，通过工作流优化设计，提高了企业工作效率。</p><p>关键词 :办公自动化，表单，工作流，存储过程</p><disp-formula id="hanspub.16894-formula523"><graphic xlink:href="http://html.hanspub.org/file/6-1540546x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><sec id="s3_1"><title>1.1. 国内外发展现状</title><p>计算机技术及其应用的迅速发展对我们的工作和生活产生了深远影响，其中之一便是由于爆炸式增长的信息量，企业工作节奏骤然加快，旧有办公模式逐渐力不从心，信息化、系统化、自动化的新型办公模式越来越受到各行各业的重视，办公自动化(Office Automation，简称OA)系统，以其能充分高效地利用的人员、时间、信息等资源，取代纸质化、办公不受时空限制的优势，正在成为企业发展的重要辅助，以工作流为核心的OA系统开发，也逐渐受到用户和开发商的专注，并成为当下主流[<xref ref-type="bibr" rid="hanspub.16894-ref1">1</xref>] 。</p><p>在全球经济一体化的趋势下，各种实用性需求也会客观加速OA产品的前进步伐，向数据更集中、业务更全面、操作更简便的方向快速发展。一个完善优化的OA系统是抽取办公共性、融合知识管理、协同各方业务的综合信息管理系统，可以规范组织管理制度，提高员工素质和组织影响力；可以加快信息流转速度，提高员工效率和组织协调力；可以扩大知识共享范围，提高员工技能和组织竞争力；可以推动组织文化建设，提高员工激情和组织凝聚力，提升企业的综合竞争能力[<xref ref-type="bibr" rid="hanspub.16894-ref2">2</xref>] 。</p></sec><sec id="s3_2"><title>1.2. 本文主要工作</title><p>本文以某企业OA系统与供应链系统的对接项目为背景，实现其中电器分公司批发零售业务供应商进场<sup>1</sup>/退场<sup>2</sup>事务流程为基础，实现电子化、规范化内部业务数据的审批和更新，并将部分数据从OA系统同步到相关业务系统，设计与开发的主要工作包括以下几个方面：</p><p>1) 需求调研和分析</p><p>通过和企业内相关部门——电器分公司市场信息部、营运部，以及供应链系统开发公司的技术部门沟通了解需求信息。</p><p>2) 流程实现的技术选择</p><p>基于现有OA系统的工作流应用，应用HTML技术电子化流程表单，通过SQL Server技术进行二次开发，配合Oracle数据库技术进行数据交互，实现数据存储和同步。</p><p>3) 流程设计和数据库开发</p><p>由于需求部门对电子化流程的经验欠缺且需求清晰度不够，故采用瀑布模型进行开发，在实现过程中不断细化需求分析，以迭代的过程开发实现、测试修改，最终验收完成。</p></sec></sec><sec id="s4"><title>2. OA系统的关键技术</title><sec id="s4_1"><title>2.1. OA系统特点</title><p>通过OA平台来综合管理业务的功能，在企业信息化的建设发展中越来越受到重视，企业内部具有业务要求的功能需求，在OA系统设计选型中也被越来越多的提及。故而对原有OA产品的二次开发是办公自动化发展的必然趋势，其中的复杂程度决定着满足功能要求所花费的开发量[<xref ref-type="bibr" rid="hanspub.16894-ref3">3</xref>] 。</p><p>本论文中流程实例的设计开发基础是企业现行的OA系统(基于微软.net技术研发的信息管理平台)，该系统采用灵活的B/S架构，设计思想较为先进，具有开放性架构，提供二次开发的接口及文档，自由构建新的功能模块，或者集成如企业资源规划(ERP)、客户关系管理(CRM)等多种业务信息管理系统。系统模块构成功能应用架构见图1。</p></sec><sec id="s4_2"><title>2.2. 工作流技术</title><p>工作流的概念是根据工作中具有固定流程的事务或业务而提出的，通过将工作事务逐步分解，清晰地按发生顺序定义为电子化的过程、角色和规则，在应用过程中可以对不同实例进行执行和监控。工作流的应用提高了企事业单位办事效率、规范了工作流程，实现了企业内部的科学管理。</p><p>1993年，国际工作流管理联盟(Workflow Management Coalition，简称WfMC)成立，工作流技术进入快速发展阶段。WfMC在工作流管理系统的体系结构、应用接口及相关术语等方面制定了一系列标准，以实现跨工作流产品操作的无障碍交互，并且对工作流作出如下定义：工作流是指整个或部分经营过程在计算机支持下的全自动或半自动化，在实际情况中可以更广泛地把凡是由计算机软件系统(工作流管理系统)控制其执行的过程都称为工作流[<xref ref-type="bibr" rid="hanspub.16894-ref4">4</xref>] 。也就是把工作流程中的各环节根据特定的规则和逻辑组织起来，通过计算机模型进行表示与计算。工作流技术就是将实际工作或业务流程中的各个时点环节根据其实际</p><p>图1. 某企业OA系统功能结构图</p><p>的规则组织起来，转化为可以进行表示与计算的逻辑模型，使事务过程的部分或整体在计算机应用环境下电子化，从而提高工作效率[<xref ref-type="bibr" rid="hanspub.16894-ref5">5</xref>] 。一个工作流包括一组事件及相互间的顺序关系即每个活动的时点定义，及步骤或事件的流转判断条件。</p></sec><sec id="s4_3"><title>2.3. 存储过程</title><p>存储过程是由流控制和SQL语言编写的一组为了完成特定功能的批处理语句集，作为一种数据库对象，存储过程把需要执行的SQL语句存储在数据库服务器中，上层通过调用过程的名称即可实现数据库相应操作[<xref ref-type="bibr" rid="hanspub.16894-ref6">6</xref>] 。</p><p>本设计的存储过程在数据库中执行，相应减少了大型应用程序与数据库之间的网络通信量。存储过程通过识别数据库，利用SQL Server优化器在运行过程中能获取最佳性能，充分利用了数据库管理系统的逻辑和运算能力。</p></sec></sec><sec id="s5"><title>3. 整体设计</title><sec id="s5_1"><title>3.1. 项目需求概述</title><p>依照上述模型，本项目首先进行需求的分析调研，实例是企业OA系统与供应链系统对接项目中，电器分公司的业务流程电子化并实现数据推送的实现过程。</p><p>电器公司为了完善对供应商进场、退场的业务管理，使供应商的进退场情况能够得到及时的处理，避免拿着审批表到市内外几家门店做审批的传统方式，实现业务人员只需要通过OA系统进行审批，供应商通过供应链系统即可以进行自助查询，使相关信息和结果能及时、便捷地通知到位，节省大量人力物力，进行信息化的流程控制。</p><p>而电器公司这项业务原本只依靠人工填写的审批表，没有相关的规章制度或业务说明，日常的审批工作虽然涉及到多个部门、分公司，但也只靠员工的经验和记忆进行操作，既不科学也不严谨。供应商厂家相关人员需要到各个销售其商品的门店卖场依次签字确认，如果是比较畅销的品牌，可能需要到市内外十几家门店依次进行确认，非常费时费力。各家门店填写完后，厂家人员还需要把审批表拿回电器分公司市场信息部审批，之后再送去总公司财务部结算，最后送回电器公司由总经理审批之后，才算审批完成，商家可以退场。可以说，整个流程虽然不算繁琐，但跨地域的操作十分奔波，效率也不高。在电子流程审批之后，可以通过OA系统更方便高效地通知财务部门及相关门店，及时准备相关资料和先期工作。通过与电器公司营运部、市场信息部、以及供应链系统相关技术人员的多次详细沟通，汇总需求要点如下：</p><p>1) 精简供应商进场信息方面内容，细化供应商进场类型，增加营运部、电器公司领导、市场信息部的审核或审批意见栏，审批结果通过OA系统知会财务部门及相关门店负责人。</p><p>2) 供应商退场信息在保留原业务表格主要内容的基础上，适当加以优化，增加退场类型、门店等内容。通过OA系统审批流转到相关人员处，不再需要供应商亲自到每个部门、门店确认退场账务情况，实现高效便捷的业务流程。</p><p>3) 对上述两张流程表单的重复内容，如门店和所属机构的重复填写问题，需要借助流程化的电子表格通过数据浏览按钮，在相关页面选取数据，确定后系统自动将则选定结果会带入表单中填充重复表控件，这一过程需要新建数据维护表，并建立数据映射。另外，电子表单也容易解决诸如手填表格中预留的空百不可控等问题。</p></sec><sec id="s5_2"><title>3.2. E-R关系模型</title><p>根据需求分析，实现OA系统与供应链系统的对接以及实例化电器公司供应商进场、退场流程，首</p><p>先需要清晰主要实体之间的关系以及各个实体的基本属性，如图2所示。</p><p>其中OA系统数据库中，供应商进场/退场表与对应门店记录表通过表单ID关联，记录每一张进场/退场表单的录入及审批信息；对应门店表在流程申请时通过门店维护表这一数据源选取相应信息，并通过表单ID记录为进场/退场供应商的对应信息；供应商信息表为方便业务员操作而设计，通过供应商进场表推送数据，存储并可以由供应商退场表提取使用；门店维护表单独记录所有门店信息，当信息修改时可以统一维护。供应链系统数据库中，供应商进场表和供应商退场表通过符合条件的推送插入或更新数据，完成系统对接的供应商信息传递。</p></sec><sec id="s5_3"><title>3.3. 流程设计</title><p>电器供应商进场、退场流程的目的主要是电子化供应商进场、退场的内部审批，从营运部、市场信息部、财务部、门店到审核完成的过程。流程经过多执行人处理，按照设定的部门、机构、领导顺序逐一流转，完成最终的整体审批。所以流程的设计非常重要，决定着整条审批业务链的准确性和高效性。本文仅以供应商进场流程为例进行分析，其流程图如图3所示。</p><p>流程在流转审批中，如果遇到错误的处理、业务中断或临时原因需要终止的情况，可由申请人随时进行撤销操作，或由OA系统管理员进行步骤跳转或强制结束操作，以达到停止流程或流程重置的效果。在流程表单页面，有流程信息控件详细显示流程经过的步骤、执行人、处理时间、批复内容等等，对流程的流转经过及现行步骤都一目了然，清晰掌握。</p><p>图2. 项目简要E-R关系模型图</p><p>图3. 供应商进场审批流程图</p></sec></sec><sec id="s6"><title>4. 功能实现</title><sec id="s6_1"><title>4.1. 表单实现</title><p>电子化表单需要使用OA系统的自定义表单设计器，表单实现程序采用HTML语言编写。表单实现首先需要定义表单模板，模板对应流程或维护表，每个模板可以包含一个或多个重复表。</p><p>首先绘制表格框架，通过源代码模式修改HTML语句，设置需要的样式，如：</p><p>id=e52e 0f 70-2646-4e12-888e-e670de1ce 3f 3 border=1</p><p>cellSpacing=0 borderColor=#79cd89 cellPadding=0</p><p>height=971 align=center width=714&gt;……</p><p>表单HTML源代码设计要考虑的问题：1) 方便流程申请人填写表单且减少出错率；2) 表单中的控件就要与数据库字段的绑定；3) 流程中不可见的字段的属性处理。</p></sec><sec id="s6_2"><title>4.2. 数据库实现</title><p>1) 数据库链接</p><p>不同服务器间数据库的链接，首先需要配置本机的Oracle客户端安装目录下的tnsnames.ora文件，该文件提供tnsname到主机或ip的对应。在文件中添加相关的链接字符串如下：</p><p>SPPS =</p><p>(DESCRIPTION =</p><p>(ADDRESS_LIST =</p><p>(ADDRESS = (PROTOCOL = TCP)(HOST = 192.9.9.25)(PORT = 1521)))</p><p>(CONNECT_DATA =(SERVICE_NAME = ora92))</p><p>)</p><p>保存后，OA服务器便可以链接到供应链所需数据库。然后在SQL Server数据库的服务器对象设置中新增链接服务器GYLTOOA，设置服务器类型、数据源、登录名和密码等属性。设置好服务器链接之后，在指定的链接服务器上执行指定的传递查询，可以在存储过程中直接访问Oracle数据库相应资源。</p><p>2) SQL Server存储过程</p><p>OA系统的SQL Server数据库存储过程修改已存入数据表的推送标志IsExec，可回写状态改为待回写，然后将待回写状态的数据通过数据库链接GYLTOOA推送至相对应的Oracle数据表。而推送标志IsExec的可回写状态，由流程步骤中的执行动作控制。在供应商进场存储过程中，供应商信息同步过程只涉及OA系统内的数据传递，供应商进场审批信息是跨数据库跨系统的数据传递，需要在审批通过后更新一次业务数据；而供应商退场表的审批信息需要在流程开始时、审批结束时，两次更新业务数据。</p><p>下面以供应商进场进场存储过程GYS_OA_to_JXH_JC为例做简单说明：</p><p>首先，筛选状态IsExec=1的可回写数据置为待回写IsExec=2，防止在回写过程中有新数据插入进来，然后将待回写的数据写入OA系统供应商信息表：</p><p>INSERT INTO udf_DQ_GYSXXB(XGYS, GYSBM, JYLB, JYPP, XLR, XLDH, CZHM)</p><p>SELECT a.XGYS, a.GYSBM, a.JYLB, a.JYPP, a.XLR, a.XLDH, a.CZHM</p><p>FROM udf_DQ_GYSJC a</p><p>WHERE a.IsExec=2</p><p>并将待回写的数据写入供应链系统：</p><p>INSERT INTO OpenQuery(GYLTOOA,'select DocID, XGYS, GYSBM, JYLB, JYPP, XLR, XLDH, CZHM, PHSX, JCLX, GH_YGYSMC, GH_YGYSBM, GM_YGYSMC, GM_YGYSBM, JCSJ, BDSXSJ from scm.GYSJCSQ where 1=0')</p><p>SELECT b.Docid, a.XGYS, a.GYSBM, a.JYLB, a.JYPP, a.XLR, a.XLDH, a.CZHM, a.PHSX, a.JCLX, a.GH_YGYSMC, a.GH_YGYSBM, a.GM_YGYSMC, a.GM_YGYSBM, a.JCSJ, a.BDSXSJ</p><p>FROM udf_DQ_GYSJC a, udfRelation_FlowDocToForm b</p><p>WHERE a.IsExec=2 and a.formid=b.formid</p><p>最后，将源表数据置为已回写状态IsExec=3。</p><p>3) SQL Server定时作业</p><p>上述存储过程由SQL Server代理中的作业功能触发，自动执行定义好的周期性的任务，主要配置“常规”、“步骤”、“计划”三项内容。作业名称为“电器进退场”，作业步骤主要为“进退场数据回写供应链”，该作业主要执行GYS_OA_to_JXH_JC (供应商进场)和GYS_OA_to_JXH_TC (供应商退场)两项存储过程，每天全天重复执行，执行间隔10分钟。</p></sec><sec id="s6_3"><title>4.3. 流程实施</title><p>在OA系统中，提供了“审批、通知执行、通知申请人或执行动作(无执行人)、存档、条件判断、分发、多选择审批”等内置基本动作类型。这些动作类型可以直接使用，也可以在其基础上添加SQL语句进行扩展编辑。根据各流程模板的需要，在流程动作定义(以admin身份登录后，在控制面板-基本设置-流程管理中选取流程动作定义)中定义相关的动作或定义要运行的SQL语句，然后在具体流程实现时设置使用。</p><p>供应商进场流程除开始和结束步骤外，其余每一个步骤都可以自定义相关属性，包括流程动作、执行人、视图、上一步骤和下一步骤等。通过这些属性定义每个步骤的实现效果，每个步骤前后相连构成一项完整的流程。其中每个步骤选用的流程动作是其最为核心的功能。</p><p>流程步骤设置完成之后，将流程使用权限分配给相关人员，如使用权限、监控权限，最后进行流程发布，即可测试使用。整个流程的主要实现过程如上述论文内容，其他测试或修改环节不做赘述。</p></sec></sec><sec id="s7"><title>5. 结束语</title><p>随着办公自动化平台和相关技术的不断更新，办公自动化的范围已经从普适化的办公蔓延到移动OA端，公司员工的工作日趋向流动性办公、跨地域性办公等方向发展，随时随地办公的需求越发凸显，过于固定化的自动化办公方式成为公司发展的瓶颈。移动办公平台提供了一种新型的办公模式，将办公的范围无限扩大，会成为日后办公自动化发展的一大前进方向。本文充分利用了网络资源共享与协同工作技术，针对公司信息量大、涉及岗位多、人员多，处理流程烦琐、不规范的办公模式，利用OA办公系统，开发了供应商进场/退场流程，明显提高了公司办事效率、加快了本单位的企业信息化进程。</p></sec><sec id="s8"><title>文章引用</title><p>刘梦苏. 办公自动化系统基于表单的工作流设计与实现Design and Implementation of Workflow Based on Form for Office Automation System[J]. 计算机科学与应用, 2016, 06(01): 50-57. http://dx.doi.org/10.12677/CSA.2016.61006</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16894-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">李圆园. 办公自动化的技术发展过程及未来趋势[J]. 湖北电力, 2010, 34(2): 72-74.</mixed-citation></ref><ref id="hanspub.16894-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">王振. 办公自动化研究综述[J]. 办公自动化杂志, 2010, 193(11): 4-7.</mixed-citation></ref><ref id="hanspub.16894-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">范玉顺, 吴澄. 工作流管理技术研究与产品现状及发展趋势[J]. 计算机集成制造系统-CIMS, 2000, 6(1): 1-8.</mixed-citation></ref><ref id="hanspub.16894-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">丁昭阳. 基于工作流技术的协同办公自动化系统的应用研究[D]: [硕士学位论文]. 阜新: 辽宁工程技术大学.</mixed-citation></ref><ref id="hanspub.16894-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">李东宁. 高校办公自动化系统中工作流技术的应用[J]. 吉林广播电视大学学报, 2014(11): 20-21.</mixed-citation></ref><ref id="hanspub.16894-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">王朋. 教师信息管理系统中的存储过程的设计与实现[D]: [硕士学位论文]. 南京: 南京邮电大学, 2015.</mixed-citation></ref></ref-list></back></article>