<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">IJE</journal-id><journal-title-group><journal-title>International Journal of Ecology</journal-title></journal-title-group><issn pub-type="epub">2324-7967</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/IJE.2018.72008</article-id><article-id pub-id-type="publisher-id">IJE-24336</article-id><article-categories><subj-group subj-group-type="heading"><subject>IJE20180200000_52031603.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>生命科学</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于主成分分析的BP神经网络在水华预测中的应用
  Application of BP Neural Network Based on Principal Component Analysis in Algal Bloom Prediction
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>夏</surname><given-names>杰</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>文青</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>许</surname><given-names>海洋</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>西南科技大学理学院，四川 绵阳</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>swust20171001@163.com(夏杰)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>04</day><month>04</month><year>2018</year></pub-date><volume>07</volume><issue>02</issue><fpage>53</fpage><lpage>60</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   随着淡水生态系统水体污染和富营养化进程的加剧，诱发了大面积水华，其不仅破坏生态系统，而且造成巨大的经济损失。因此，根据水体各个理化因子对水华的发生进行预测就显得尤为重要。首先根据池塘1~15周的数据，利用主成分分析法对影响浮游生物总量的13个理化因子进行主要影响因子分析，得到池塘水华发生的主要影响因子为：总氮、透明度、溶解氧、铵态氮、盐度、总磷，溶氧。其次，根据确定的7个主要理化因子作为BP神经网络的输入层，浮游生物量作为输出层来对水华发生进行预测。结果表明基于主成分分析的BP神经网络模型的预测结果与真实值的拟合系数高达0.9912。为此，本文的研究方法可有效地预测水华的发生。 With the intensification of water pollution and eutrophication of freshwater ecosystems, large areas of algal bloom have been included, which not only destroy the ecosystems, but also cause huge economic losses. Therefore, it is very important to predict the occurrence of algal bloom according to the physical and chemical factors of water body. Firstly, according to the data of the pond for 1~15 weeks, the main influencing factors of 13 physical and chemical factors affecting the total plankton were analyzed based on principal component analysis (PCA). The main influencing factors of algal blooms were total nitrogen, transparency, dissolved oxygen, ammonium nitrogen, salinity, total phosphorus and dissolved oxygen. Secondly, according to the main seven physical and chemical factors identified as the input layer of BP neural network, the plankton biomass was used as the output layer to predict the occurrence of algal bloom. The results show that the fitting coefficient between the predicted result and the true value of the BP neural network model based on principal component analysis is as high as 0.9912. Therefore, the research method in this paper can effectively predict the occurrence of algal bloom.
    
  
 
</p></abstract><kwd-group><kwd>水华预测，理化因子，主成分分析，BP神经网络, Algal Bloom Prediction</kwd><kwd> Physical and Chemical Factors</kwd><kwd> Principal Component Analysis</kwd><kwd> BP Neural Network</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于主成分分析的BP神经网络在水华预测中的应用<sup> </sup></title><p>夏杰，吴文青，许海洋</p><p>西南科技大学理学院，四川 绵阳</p><p><img src="//html.hanspub.org/file/2-2640134x1_hanspub.png" /></p><p>收稿日期：2018年3月18日；录用日期：2018年4月2日；发布日期：2018年4月9日</p><disp-formula id="hanspub.24336-formula16"><graphic xlink:href="//html.hanspub.org/file/2-2640134x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>随着淡水生态系统水体污染和富营养化进程的加剧，诱发了大面积水华，其不仅破坏生态系统，而且造成巨大的经济损失。因此，根据水体各个理化因子对水华的发生进行预测就显得尤为重要。首先根据池塘1~15周的数据，利用主成分分析法对影响浮游生物总量的13个理化因子进行主要影响因子分析，得到池塘水华发生的主要影响因子为：总氮、透明度、溶解氧、铵态氮、盐度、总磷，溶氧。其次，根据确定的7个主要理化因子作为BP神经网络的输入层，浮游生物量作为输出层来对水华发生进行预测。结果表明基于主成分分析的BP神经网络模型的预测结果与真实值的拟合系数高达0.9912。为此，本文的研究方法可有效地预测水华的发生。</p><p>关键词 :水华预测，理化因子，主成分分析，BP神经网络</p><disp-formula id="hanspub.24336-formula17"><graphic xlink:href="//html.hanspub.org/file/2-2640134x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-2640134x7_hanspub.png" /> <img src="//html.hanspub.org/file/2-2640134x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>在我国水产养殖中，池塘养殖产量约占淡水养殖的70%。随着淡水生态系统水体污染和富营养化进程的加剧，有害蓝藻、轮虫等浮游生物高密度发生，很容易诱发大面积的水华 [<xref ref-type="bibr" rid="hanspub.24336-ref1">1</xref>] 。水华造成严重的环境污染和水体污染，同时区域用水安全也受到威胁，对水体养殖业造成严重的打击 [<xref ref-type="bibr" rid="hanspub.24336-ref2">2</xref>] 。水华的发生是水生态系统中各种理化因子作用的结果，受到总氮、总磷、磷酸盐磷、叶绿素、溶氧、水温等因素的影响。虽然针对不同情况下水生态系统各因子对水华发生已有不少研究成果 [<xref ref-type="bibr" rid="hanspub.24336-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.24336-ref4">4</xref>] ，但是准确的预测仍然是当前的首要任务。本文利用各个理化因子与水华之间的关系，结合主成分分析和神经网络来判断淡水养殖中水华是否发生，进一步为水华和水体富营养化治理提供理论依据。</p><p>预测模型是近几年国内外水华风险研究的重要工具 [<xref ref-type="bibr" rid="hanspub.24336-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.24336-ref6">6</xref>] ，如回归分析模型、人工神经网络、指数法预测、灰色预测模型。人工神经网络由于具有较强的非线性映射能力，受到广大研究者的青睐。文献 [<xref ref-type="bibr" rid="hanspub.24336-ref7">7</xref>] 利用RBF神经网络对叶绿素a的浓度做出预测，文献 [<xref ref-type="bibr" rid="hanspub.24336-ref8">8</xref>] 基于深度学习对湖库藻类水华进行预测，文献 [<xref ref-type="bibr" rid="hanspub.24336-ref9">9</xref>] 提出一种过程神经网络的预测模型。文献 [<xref ref-type="bibr" rid="hanspub.24336-ref10">10</xref>] 基于主成分分析的RBF神经网络对需水量做出预测。然而，在水华预测中，需要对理化因子进行筛选，选择恰当的因子，以简化神经网络的复杂度，提高预测结果的准确度。</p><p>本文通过研究淡水养殖池塘相关主要理化因子，利用主成分分析法确定影响水华发生的主要理化因子。进一步，建立BP神经网络模型以理化因子作为输入样本，对浮游生物做出预测，从而更好地控制并预测水华的发生，提高养殖产量，减小环境污染。</p></sec><sec id="s4"><title>2. 研究方法</title><sec id="s4_1"><title>2.1. 主成分分析法</title><p>主成分分析法 [<xref ref-type="bibr" rid="hanspub.24336-ref11">11</xref>] 也称为主分量分析(PCA)，主要为了用较少的变量来解释原始数据的大部分变异，将彼此相关性很高的变量转化为彼此独立或不相关的变量，是一种将原有的多个变量划分为少数几个综合评价的统计的方法。</p><p>1) 基本思想</p><p>设有m个样本，每个样本共有n个变量，若X表示指标的总和， x i j 表示第i个理化因子对应的第j个属性值，则构成的数据矩阵如下：</p><p>X = ( x i , j ) i = 1 , 2 , ⋯ , m ,   j = 1 , 2 , ⋯ , m . (1)</p><p>设原来的变量指标为 X 1 , X 2 , X 3 , ⋯ , X n ，它们的综合指标为新的变量指标为 Z 1 , Z 2 , Z 3 , ⋯ , Z m ， c m p 为相应的系数，则</p><p>Z k = c k 1 X 1 + c k 2 X 2 + ⋯ + c k p X p ,   k = 1 , 2 , ⋯ , m . (2)</p><p>主成分决定的新变量指标 Z 1 , Z 2 , Z 3 , ⋯ , Z m 分别为原变量 X 1 , X 2 , X 3 , ⋯ , X n 的第一，第二，…，第m个主成分。其中 Z 1 在变量中所占的贡献率最大， Z 1 , Z 2 , Z 3 , ⋯ , Z m 对评价系统的贡献率逐渐下降，挑选贡献率较大的作为主成分。</p><p>2) 分析过程</p><p>① 计算相关系数矩阵 R = ( r i j ) p &#215; p ，其中</p><p>r i j = ∑ k = 1 n ( x k i − x &#175; i ) ( x k j − x &#175; j ) ∑ k = 1 n ( x k i − x &#175; i ) 2 ( x k j − x &#175; j ) 2 . (3)</p><p>② 计算特征值与特征向量</p><p>用雅可比行列式对 | λ I − R | = 0 进行求解，求出特征值 ，并按照 λ 1 ≥ λ 2 ≥ ⋯ ≥ λ p ≥ 0 排列，然后分别求出对应于特征值 λ i 的特征向量 e i ( i = 1 , 2 , ⋯ , p ) 。</p><p>③ 计算主成份贡献率 z i 及累计贡献率 Z i 。</p><p>主成份 z i 的贡献率为：</p><p>z i = λ i / ∑ k = 1 p λ k ,   i = 1 , 2 , ⋯ , p . (4)</p><p>累计贡献率 Z i ：</p><p>Z i = ∑ k = 1 p ( λ k / ∑ k = 1 p λ k ) ,   i = 1 , 2 , ⋯ , p . (5)</p><p>④ 计算主成份载荷 l i j ：</p><p>l i j = p ( z i , x j ) = λ j − e i j ,     i , j = 1 , 2 , ⋯ , p . (6)</p></sec><sec id="s4_2"><title>2.2. BP神经网络模型</title><p>在神经网络中，应用最广泛的是美国加州大学的鲁梅尔哈特和麦克莱兰等人于1985年提出BP神经网络 [<xref ref-type="bibr" rid="hanspub.24336-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.24336-ref13">13</xref>] 。该模型是典型的多层网络，具有输入层节点、输出层节点，而且具有一层或多层隐含节点。其核心是通过一边向后传递误差，一边修正误差的方法来不断调节网络参数(权值和阈值)，以实现或逼近所希望的输出、输入映射关系。一个三层的BP网络结构如图1所示。</p><p>BP算法具有梯度性，也称为快速下降法，其迭代基本思想是：从一个初始点 w 0 出发，计算在点 w 0 的</p><p>图1. BP神经网络拓扑结构图</p><p>负梯度方向 − ∇ E ( w 0 ) ，并沿该方向移动一定距离到达新的点 w 1 = w 0 − η ∇ E ( w 0 ) ，只要参数h足够小，就能保证 E ( w 1 ) &lt; E ( w 0 ) 。不断重复这一过程，一定能找到 E ( w ) 的一个极值。</p><p>BP神经网络具体算法如下：</p><p>1) 初始化网络及学习参数。为加快网络学习将隐含层和输出层各节点的连接权值、神经元阈值规范化处理，其表达式如下：</p><p>{ x k n e w = 0.002 + 0.996 ( x k o l d − min x k o l d ) max x k o l d − min x k o l d y k n e w = 0.002 + 0.996 ( y k o l d − min y k o l d ) max y k o l d − min y k o l d , (7)</p><p>其中式(7)中， x k o l d ， y k o l d ， x k n e w ， y k n e w 分别为处理前后的网络输入与输出。通过数据规范化处理，将输入、输出数据变成 [ − 1 , 1 ] 中的数。</p><p>2) 利用数据对网络进行训练，计算网络的输入、输出值。</p><p>隐含层各节点的输入、输出值分别为：</p><p>s j k = ∑ i = 1 n a i k w i j − θ j ,       a j k = 1 1 + e − s j k ,     j = 1 , 2 , ⋯ , p . (8)</p><p>输出层各节点的输入、输出值分别为：</p><p>l t k = ∑ i = 1 p b t k v t ,     b t k = 1 1 + e − l t k ,     t = 1 , 2 , ⋯ , q . (9)</p><p>3) 误差逆传播，利用梯度下降法对各层连接层及阈值进行调整。</p><p>设网络的计算输出为 c t k ，网络期望输出与计算输出的偏差均方值 E k 为</p><p>E k = ∑ t = 1 q ( y k k − c t k ) 2 2 , (10)</p><p>输出层各节点的误差 d t k = ( y t k − c t k ) c t k ( 1 − c t k ) ，隐含层各节点的误差 h t k = ( ∑ t = 1 q d t k v j t ) b j k ( 1 − b j k ) 。</p><p>4) 修正权值与阈值。</p><p>5) 若网络的全局误差小于指定的值，则算法转入第6步，否则转入第2步。</p><p>6) 计算输出层。</p><p>7) 计算网络训练误差。</p><p>BP神经网络仿真测试结束后，通过计算真实值与输出值的偏差情况，对网络训练的泛化能力进行评价，选取决定系数R<sup>2</sup>评价模型的性能，其中</p><p>R 2 = ( l ∑ i = 0 l y ^ i y i − ∑ i = 0 l y ^ i ∑ i = 0 l y i ) 2 ( l ∑ i = 0 l y ^ i 2 − ( ∑ i = 0 l y ^ i 2 ) 2 ) ( l ∑ i = 0 l y i 2 − ( ∑ i = 0 l y i 2 ) 2 ) , (11)</p><p>式(11)中， y ^ i 为预测值， y i 为真实值。决定系数在 [ 0 , 1 ] 内，系数越接近于1，表明训练效果越接近真实值，反之，系数越接近于0，表明训练效果越差。</p></sec></sec><sec id="s5"><title>3. 实例分析</title><sec id="s5_1"><title>3.1. 池塘水华主要理化因子</title><p>为了利用神经网络预测出水华发生，需要收集大量的淡水养殖池塘的历史数据。本文收集2016年MathCup大学生数学建模竞赛A题的数据，以1号池为例，对1号池2个观测点的数据进行平均，最终得到池塘1到15周各个理化因子与浮游生物量的数据。将浮游生物总量作为主成分分析的因变量，自变量包括总磷、磷酸盐磷、总氮、硝态氮、亚硝态氮、铵态氮、溶解氧、COD、水温、PH、盐度、透明度、总碱度。</p><p>根据主成分分析法的具体步骤，利用MATLAB对理化因子进行求解。首先对原始观测数据进行标准化处理，其次计算相关系数矩阵，接着计算特征值和特征向量，最后计算各个指标的贡献率。根据各个指标贡献率的大小关系，确定影响水华发生的指标。其中各个理化因子的特征根和贡献率及评价值见表1，从表1可看出，总氮的贡献率为31.9345%，透明度贡献率为23.6956%，溶解氧贡献率为12.5598%，铵态氮贡献率为10.1669%，盐度贡献率为8.2344，总磷贡献率为6.2346，COD贡献率为3.6718%，因此贡献率排名前七的累积贡献率高达96.5177%。为此选取13个理化因子中贡献率排名前七的因子代替原变量。</p><p>根据主成分分析进行指标筛选，最终筛选出评价值排名前7的作为引起水华发生的理化因子，即总氮、透明度、溶解氧(COD)、铵态氮、盐度、总磷，溶氧作为池塘水华的主要因子，并作为BP神经网络输入样本。最后，可得到引起水华的7个主要指标和浮游生物量数据如表2。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Principal component solution data shee</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >理化因子</th><th align="center" valign="middle" >总磷</th><th align="center" valign="middle" >磷酸盐磷</th><th align="center" valign="middle" >总氮</th><th align="center" valign="middle" >硝态氮</th><th align="center" valign="middle" >亚硝态氮</th><th align="center" valign="middle" >铵态氮</th><th align="center" valign="middle" >溶解氧</th></tr></thead><tr><td align="center" valign="middle" >特征根</td><td align="center" valign="middle" >0.9392</td><td align="center" valign="middle" >0.1251</td><td align="center" valign="middle" >4.7902</td><td align="center" valign="middle" >0.0186</td><td align="center" valign="middle" >0.3140</td><td align="center" valign="middle" >1.5250</td><td align="center" valign="middle" >1.8840</td></tr><tr><td align="center" valign="middle" >贡献率</td><td align="center" valign="middle" >6.2546</td><td align="center" valign="middle" >0.8342</td><td align="center" valign="middle" >31.9345</td><td align="center" valign="middle" >0.1237</td><td align="center" valign="middle" >0.1251</td><td align="center" valign="middle" >10.1669</td><td align="center" valign="middle" >12.5598</td></tr><tr><td align="center" valign="middle" >评价值</td><td align="center" valign="middle" >0.0112</td><td align="center" valign="middle" >−0.2643</td><td align="center" valign="middle" >0.5756</td><td align="center" valign="middle" >−0.5047</td><td align="center" valign="middle" >−0.2229</td><td align="center" valign="middle" >0.3419</td><td align="center" valign="middle" >0.4812</td></tr><tr><td align="center" valign="middle" >排名</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >9</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >11</td><td align="center" valign="middle" >8</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >3</td></tr><tr><td align="center" valign="middle" >理化因子</td><td align="center" valign="middle" >COD</td><td align="center" valign="middle" >水温</td><td align="center" valign="middle" >PH</td><td align="center" valign="middle" >盐度</td><td align="center" valign="middle" >透明度</td><td align="center" valign="middle" >总碱度</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >特征根</td><td align="center" valign="middle" >0.5508</td><td align="center" valign="middle" >0.0027</td><td align="center" valign="middle" >0.0064</td><td align="center" valign="middle" >1.2352</td><td align="center" valign="middle" >3.5543</td><td align="center" valign="middle" >0.0582</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >贡献率</td><td align="center" valign="middle" >3.6718</td><td align="center" valign="middle" >0.0428</td><td align="center" valign="middle" >0.0429</td><td align="center" valign="middle" >8.2344</td><td align="center" valign="middle" >23.6956</td><td align="center" valign="middle" >0.3880</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >评价值</td><td align="center" valign="middle" >−0.0168</td><td align="center" valign="middle" >−0.8339</td><td align="center" valign="middle" >−0.5208</td><td align="center" valign="middle" >0.2568</td><td align="center" valign="middle" >0.5641</td><td align="center" valign="middle" >−0.4591</td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >排名</td><td align="center" valign="middle" >7</td><td align="center" valign="middle" >13</td><td align="center" valign="middle" >12</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表1. 主成分求解数据表</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> The main physical and chemical factors of water bloom and biological data shee</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >周数</th><th align="center" valign="middle" >总磷</th><th align="center" valign="middle" >总氮</th><th align="center" valign="middle" >铵态氮</th><th align="center" valign="middle" >溶氧</th><th align="center" valign="middle" >COD</th><th align="center" valign="middle" >盐度</th><th align="center" valign="middle" >透明度</th><th align="center" valign="middle" >生物总量</th></tr></thead><tr><td align="center" valign="middle" >mg∙kg<sup>−1</sup></td><td align="center" valign="middle" >mg∙kg<sup>−1</sup></td><td align="center" valign="middle" >mg∙kg<sup>−1</sup></td><td align="center" valign="middle" >mg/L</td><td align="center" valign="middle" >mg/L</td><td align="center" valign="middle" >mg/L</td><td align="center" valign="middle" >cm</td><td align="center" valign="middle" >10^6个/L</td></tr><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >10.1891</td><td align="center" valign="middle" >8.8743</td><td align="center" valign="middle" >18.7008</td><td align="center" valign="middle" >5.12</td><td align="center" valign="middle" >21.90</td><td align="center" valign="middle" >1.80</td><td align="center" valign="middle" >28.00</td><td align="center" valign="middle" >52.73</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >8.3721</td><td align="center" valign="middle" >8.3905</td><td align="center" valign="middle" >20.0819</td><td align="center" valign="middle" >4.16</td><td align="center" valign="middle" >20.95</td><td align="center" valign="middle" >2.05</td><td align="center" valign="middle" >26.00</td><td align="center" valign="middle" >296.12</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >8.7440</td><td align="center" valign="middle" >7.8190</td><td align="center" valign="middle" >23.6535</td><td align="center" valign="middle" >3.20</td><td align="center" valign="middle" >20.00</td><td align="center" valign="middle" >2.30</td><td align="center" valign="middle" >24.00</td><td align="center" valign="middle" >274.41</td></tr><tr><td align="center" valign="middle" >4</td><td align="center" valign="middle" >9.3626</td><td align="center" valign="middle" >8.3797</td><td align="center" valign="middle" >25.2355</td><td align="center" valign="middle" >4.96</td><td align="center" valign="middle" >23.40</td><td align="center" valign="middle" >2.10</td><td align="center" valign="middle" >25.00</td><td align="center" valign="middle" >95.94</td></tr><tr><td align="center" valign="middle" >5</td><td align="center" valign="middle" >8.4130</td><td align="center" valign="middle" >8.0672</td><td align="center" valign="middle" >22.2213</td><td align="center" valign="middle" >6.72</td><td align="center" valign="middle" >26.80</td><td align="center" valign="middle" >1.90</td><td align="center" valign="middle" >26.00</td><td align="center" valign="middle" >231.88</td></tr><tr><td align="center" valign="middle" >6</td><td align="center" valign="middle" >9.9054</td><td align="center" valign="middle" >6.4773</td><td align="center" valign="middle" >30.3525</td><td align="center" valign="middle" >5.04</td><td align="center" valign="middle" >27.27</td><td align="center" valign="middle" >2.00</td><td align="center" valign="middle" >24.00</td><td align="center" valign="middle" >172.29</td></tr><tr><td align="center" valign="middle" >7</td><td align="center" valign="middle" >5.5932</td><td align="center" valign="middle" >2.7576</td><td align="center" valign="middle" >11.2677</td><td align="center" valign="middle" >3.36</td><td align="center" valign="middle" >27.73</td><td align="center" valign="middle" >2.10</td><td align="center" valign="middle" >22.00</td><td align="center" valign="middle" >505.65</td></tr><tr><td align="center" valign="middle" >8</td><td align="center" valign="middle" >6.9944</td><td align="center" valign="middle" >4.1013</td><td align="center" valign="middle" >16.2684</td><td align="center" valign="middle" >2.88</td><td align="center" valign="middle" >25.57</td><td align="center" valign="middle" >2.10</td><td align="center" valign="middle" >22.00</td><td align="center" valign="middle" >185.53</td></tr><tr><td align="center" valign="middle" >9</td><td align="center" valign="middle" >9.9059</td><td align="center" valign="middle" >4.8385</td><td align="center" valign="middle" >21.6749</td><td align="center" valign="middle" >2.40</td><td align="center" valign="middle" >23.40</td><td align="center" valign="middle" >2.10</td><td align="center" valign="middle" >22.00</td><td align="center" valign="middle" >36.24</td></tr><tr><td align="center" valign="middle" >10</td><td align="center" valign="middle" >10.8805</td><td align="center" valign="middle" >6.7343</td><td align="center" valign="middle" >17.6684</td><td align="center" valign="middle" >3.27</td><td align="center" valign="middle" >23.08</td><td align="center" valign="middle" >1.60</td><td align="center" valign="middle" >21.00</td><td align="center" valign="middle" >262.41</td></tr><tr><td align="center" valign="middle" >11</td><td align="center" valign="middle" >11.8625</td><td align="center" valign="middle" >8.2514</td><td align="center" valign="middle" >27.0140</td><td align="center" valign="middle" >4.14</td><td align="center" valign="middle" >22.75</td><td align="center" valign="middle" >1.10</td><td align="center" valign="middle" >20.00</td><td align="center" valign="middle" >466.12</td></tr><tr><td align="center" valign="middle" >12</td><td align="center" valign="middle" >8.7985</td><td align="center" valign="middle" >8.1177</td><td align="center" valign="middle" >12.0263</td><td align="center" valign="middle" >5.29</td><td align="center" valign="middle" >24.06</td><td align="center" valign="middle" >1.30</td><td align="center" valign="middle" >19.50</td><td align="center" valign="middle" >290.00</td></tr><tr><td align="center" valign="middle" >13</td><td align="center" valign="middle" >12.5384</td><td align="center" valign="middle" >9.5958</td><td align="center" valign="middle" >26.7652</td><td align="center" valign="middle" >6.43</td><td align="center" valign="middle" >25.36</td><td align="center" valign="middle" >1.50</td><td align="center" valign="middle" >19.00</td><td align="center" valign="middle" >554.71</td></tr><tr><td align="center" valign="middle" >14</td><td align="center" valign="middle" >13.6464</td><td align="center" valign="middle" >8.3491</td><td align="center" valign="middle" >24.0939</td><td align="center" valign="middle" >5.56</td><td align="center" valign="middle" >25.70</td><td align="center" valign="middle" >1.50</td><td align="center" valign="middle" >21.00</td><td align="center" valign="middle" >1064.82</td></tr><tr><td align="center" valign="middle" >15</td><td align="center" valign="middle" >14.2669</td><td align="center" valign="middle" >7.3688</td><td align="center" valign="middle" >19.7633</td><td align="center" valign="middle" >4.60</td><td align="center" valign="middle" >26.03</td><td align="center" valign="middle" >1.50</td><td align="center" valign="middle" >23.00</td><td align="center" valign="middle" >954.71</td></tr></tbody></table></table-wrap><p>表2. 水华主要理化因子及生物总量数据表</p></sec><sec id="s5_2"><title>3.2. 结果与分析</title><p>1) 模型的输入、输出参数的选择</p><p>本文用MTALAB 2015a进行神经网络训练，其中模型的输入层为各个主要理化因子，输出层为浮游生物总量，具体设计如下：</p><p>输入层：总氮、透明度、溶解氧、铵态氮、盐度、总磷，溶氧共7个单元作为输入层。</p><p>输出层：浮游生物总量共一个输出层。</p><p>2) 模型的结构设计</p><p>本文神经网络模型采用三层网络模型，输入参数为池塘1到15周的7个理化因子。对于隐含层节点的选取，通过构造不同隐节点数的网络进行训练，根据各层网络的误差对权值和阈值进行修正，并通过评价系数来判断拟合的效果。经过多次训练后发现，60个隐含节点的网络结构拟合效果最佳，因此网络拓扑结构为 7 &#215; 60 &#215; 1 。在训练过程中，选取logsig函数为输出层的激活函数，选取trainlm为训练函数。</p><p>3) 模型网络参数的选取及参数设定</p><p>参数设置为：net.trainparam.epochs = 10000为网络训练的最大次数，net.trainparam.lr=0.2;为学习效率，net.trainparam.show=200为每200轮显示一次。</p><p>4) 模型检验与仿真分析</p><p>对收集的数据分别对池塘浮游生物总量进行仿真分析，其结果如图2。通过观察浮游生物的预测曲线和实际数据预测曲线，可明显看出两者吻合度较高。此外，通过看评价系数 R = 0.9912 可得，评价系数接近于1，表明拟合效果较好，对浮游生物的预测具有一定的使用价值如图3所示。</p><p>图2. 浮游生物预测值与真实值对比图</p><p>图3. 神经网络拟合系数图</p></sec></sec><sec id="s6"><title>4. 结论</title><p>本文通过构建影响水华发生的理化因子，并利用主成分分析法筛选出池塘水华主要因子。其次构建水华神经网络预测模型，得出以下结论。</p><p>1) 通过主成分分析可得影响水华发生的主要理化因子，包括总氮、透明度、溶解氧(COD)、铵态氮、盐度、总磷。这7个理化因子的累积贡献率为96.5177%。</p><p>2) 所构建的神经网络模型，由于神经网络模型具有较强的非线性映射能力，经过训练后的预测值与真实值吻合度较高。</p><p>3) 基于主成分分析的BP神经网络降低了网络输入的层数，提高了程序运行效率，从而提高了神经网络的性能，对水华预测有较好的效果。</p></sec><sec id="s7"><title>基金项目</title><p>西南科技大学理学院创新基金项目“量化投资平台下的交易策略研究”(项目编号：LXCX-05)，主持人：夏杰。</p></sec><sec id="s8"><title>文章引用</title><p>夏 杰,吴文青,许海洋. 基于主成分分析的BP神经网络在水华预测中的应用 Application of BP Neural Network Based on Principal Component Analysis in Algal Bloom Prediction[J]. 世界生态学, 2018, 07(02): 53-60. https://doi.org/10.12677/IJE.2018.72008</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.24336-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">窦明, 谢平, 夏军, 沈晓鲤, 方芳. 汉江水华问题研究[J]. 水科学进展, 2002, 13(5): 557-561</mixed-citation></ref><ref id="hanspub.24336-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">陈云峰, 殷福才, 陆根法. 水华爆发的突变模型——以巢湖为例[J]. 生态学报, 2006, 26(3): 878-883.</mixed-citation></ref><ref id="hanspub.24336-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">杜桂森, 王建厅, 张为华, 冯伶亲, 刘静. 官厅水库水体营养状况分析[J]. 湖泊科学, 2004, 16(3): 277-281.</mixed-citation></ref><ref id="hanspub.24336-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">全为民, 严力蛟, 虞左明, 焦荔. 湖泊富营养化模型研究进展[J]. 生物多样性, 2001, 9(2): 168-175.</mixed-citation></ref><ref id="hanspub.24336-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">郝启文, 王小艺, 许继平, 刘载文, 盛璐, 何多多. 湖库水质监测与水华预警信息系统[J]. 计算机工程, 2013, 39(1): 287-289+293.</mixed-citation></ref><ref id="hanspub.24336-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">孔繁翔, 马荣华, 高俊峰, 吴晓东. 太湖蓝藻水华的预防、预测和预警的理论与实践[J]. 湖泊科学, 2009, 21(3): 314-328.</mixed-citation></ref><ref id="hanspub.24336-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">仝玉华, 周洪亮, 黄浙丰, 张宏建. 一种自优化RBF神经网络的叶绿素a浓度时序预测模型[J]. 生态学报, 2011, 31(22): 6788-6795.</mixed-citation></ref><ref id="hanspub.24336-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">姚俊杨, 许继平, 王小艺, 黄振芳. 基于深度学习的湖库藻类水华预测研究[J]. 计算机与应用学, 2015, 32(10): 1265-1268.</mixed-citation></ref><ref id="hanspub.24336-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">李大刚, 王小艺, 刘载文, 许继平, 赵星, 戴军. 过程神经网络水华预测方法研究[J]. 计算机与应用化学, 2011, 28(2): 173-176.</mixed-citation></ref><ref id="hanspub.24336-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">桑慧茹, 王丽学, 陈韶明, 孙娟, 李司瑾. 基于主成分分析的RBF神经网络在需水预测中的应用[J]. 水电能源科学, 2017, 35(7): 58-61.</mixed-citation></ref><ref id="hanspub.24336-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">苏键, 陈军, 何洁. 主成分分析法及其应用[J]. 轻工科技, 2012, 28(9): 12-13+16.</mixed-citation></ref><ref id="hanspub.24336-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">万金保, 曾海燕, 朱邦辉. 主成分分析法在乐安河水质评价中的应用[J]. 中国给水排水, 2009, 25(16): 104-108.</mixed-citation></ref><ref id="hanspub.24336-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">任黎, 董增川, 李少华. 人工神经网络模型在太湖富营养化评价中的应用[J]. 河海大学学报(自然科学版), 2004, 32(2): 147-150.</mixed-citation></ref></ref-list></back></article>