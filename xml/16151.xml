<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JISP</journal-id><journal-title-group><journal-title>Journal of Image and Signal Processing</journal-title></journal-title-group><issn pub-type="epub">2325-6753</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JISP.2015.44010</article-id><article-id pub-id-type="publisher-id">JISP-16151</article-id><article-categories><subj-group subj-group-type="heading"><subject>JISP20150400000_97517999.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  散焦图像的维纳滤波复原及振铃抑制
  Defocused Image Restoration with Wiener Filter and Ringing Suppression
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>唐</surname><given-names>满芳</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>胡</surname><given-names>宗福</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>同济大学电子与信息工程学院，上海</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>ffyouxiang@163.com(唐满)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>08</day><month>10</month><year>2015</year></pub-date><volume>04</volume><issue>04</issue><fpage>87</fpage><lpage>93</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   图像复原是数字图像处理的重要研究内容。基于频域的维纳滤波实现图像复原，并针对复原过程中伴随的振铃效应，采用扩展边缘的方法做了消除振铃预处理。然后进一步分析点扩散函数半径、图像梯度对振铃样式的影响，并由此建立边界振铃样式数据库R。并结合轮廓提取以及边缘膨胀法，得到振铃影响域内某点到轮廓的距离，从而调用对应库里的振铃样式做振铃修正。最后基于Matlab用简单轮廓图形验证该振铃抵消方法的有效性，从而将振铃幅度控制在&#177;2之内，极大程度的恢复了原始高清图像。 Image restoration is a key research point of digital image processing. Wiener filter is used for basic image restoration, and boundary extension is a good method of ringing suppression preprocessing. Further analysis is made to find the relation between ringing pattern and precondition, including PSF radius and the gradient of outline. According to the relation, we build a 2D database matrix R to store the outline ringing pattern information. Combined with edge detection and image dilation, we can invoke the pattern database to suppress the ringing in a certain pre-condition and distance. Finally we verify the effectiveness of method with a simple outline example in Matlab, thus controlling the amplitude of ringing within &#177;2, and then the image information is restored as much as impossible.
    
  
 
</p></abstract><kwd-group><kwd>图像复原，维纳滤波，点扩散函数，振铃，边缘提取, Image Restoration</kwd><kwd> Wiener Filter</kwd><kwd> PSF</kwd><kwd> Ringing</kwd><kwd> Edge Detection</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>散焦图像的维纳滤波复原及振铃抑制<sup> </sup></title><p>唐满芳，胡宗福</p><p>同济大学电子与信息工程学院，上海</p><p>Email: ffyouxiang@163.com</p><p>收稿日期：2015年9月27日；录用日期：2015年10月10日；发布日期：2015年10月14日</p><disp-formula id="hanspub.16151-formula256"><graphic xlink:href="http://html.hanspub.org/file/2-2670060x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>图像复原是数字图像处理的重要研究内容。基于频域的维纳滤波实现图像复原，并针对复原过程中伴随的振铃效应，采用扩展边缘的方法做了消除振铃预处理。然后进一步分析点扩散函数半径、图像梯度对振铃样式的影响，并由此建立边界振铃样式数据库R。并结合轮廓提取以及边缘膨胀法，得到振铃影响域内某点到轮廓的距离，从而调用对应库里的振铃样式做振铃修正。最后基于Matlab用简单轮廓图形验证该振铃抵消方法的有效性，从而将振铃幅度控制在&#177;2之内，极大程度的恢复了原始高清图像。</p><p>关键词 :图像复原，维纳滤波，点扩散函数，振铃，边缘提取</p><disp-formula id="hanspub.16151-formula257"><graphic xlink:href="http://html.hanspub.org/file/2-2670060x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>随着科技和多媒体的迅猛发展，图像已经成为人类获取信息的重要途径。图像复原的目的是尽可能恢复原始高清图像。该技术已应用于众多科学工程领域，如天文图像复原、医学影像、军事侦察等[<xref ref-type="bibr" rid="hanspub.16151-ref1">1</xref>] 。</p><p>散焦图像给人的直观感觉是图像变模糊。图像退化的原因：光学系统的不理想、图像传输和采集过程中引入的噪声、图像运动、传感器噪声、摄像机聚焦不佳、物体与摄像机之间的相对移动等 [<xref ref-type="bibr" rid="hanspub.16151-ref2">2</xref>] 。</p><p>散焦图像复原试图利用退化图像的某种先验知识来重建或复原被退化的图像，因此图像复原可以看成图像退化的逆过程 [<xref ref-type="bibr" rid="hanspub.16151-ref3">3</xref>] 。由于图像复原是一个病态 [<xref ref-type="bibr" rid="hanspub.16151-ref4">4</xref>] 的问题，在复原过程中，会伴随着振铃产生。目前的图像复原及抑制振铃方法有：基于边缘分离的去振铃复原，图像去模糊正则化恢复算法，频域循环边界算法，反卷积边界效应的快速抑制算法等 [<xref ref-type="bibr" rid="hanspub.16151-ref5">5</xref>] - [<xref ref-type="bibr" rid="hanspub.16151-ref8">8</xref>] 。本文提出一种通过分析影响振铃样式的影响因子，并建立振铃样式库，来抑制振铃效应的方法。</p></sec><sec id="s4"><title>2. 图像退化建模及维纳滤波</title><p>散焦图像的退化模型 [<xref ref-type="bibr" rid="hanspub.16151-ref9">9</xref>] 如图1，用公式表示如公式(1)：</p><disp-formula id="hanspub.16151-formula258"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670060x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>用f表示原始的清晰图像，h表示引起图像模糊的退化函数，实质上是圆盘点扩散函数，n表示加性的高斯白噪声，g表示观察到的模糊降质图像。退化过程时域表达式如图1，其中*为卷积。</p><p>离焦模糊图像的退化模型为点扩散函数PSF，可用均匀分布的圆盘函数 [<xref ref-type="bibr" rid="hanspub.16151-ref10">10</xref>] 表示，如下面的分段函数表达式(2)，其对应的圆盘半径是模糊半径。</p><p>图1. 离焦图像的频域复原模型</p><disp-formula id="hanspub.16151-formula259"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670060x9_hanspub.png"  xlink:type="simple"/></disp-formula><p>图像复原的方法有直接逆滤波、伪逆滤波、维纳滤波、最小二乘滤波等 [<xref ref-type="bibr" rid="hanspub.16151-ref11">11</xref>] 。对比模糊半径为30时的维纳滤波和最小二乘滤波，如图2，维纳滤波能更好的恢复图像高频细节，决定采用维纳滤波。维纳滤波的过程表示为公式(3)：</p><disp-formula id="hanspub.16151-formula260"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670060x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中NCORR为噪声功率谱，ICORR为信号功率谱，他们的比值为噪信比NSR。</p></sec><sec id="s5"><title>3. 振铃简介</title><p>图像复原过程中会伴随振铃效应，表现为周期性强度急剧变化的周期性重复(如图3)。</p><sec id="s5_1"><title>3.1. 振铃分类</title><p>根据振铃在复原图像中出现的位置，还可将振铃分为边界振铃和轮廓振铃。</p><p>边界振铃是在复原图像边界附近出现的一种寄生波纹。</p><p>轮廓振铃是在边缘尤其是强边缘附近出现的平坦区域出现的若干条纹，它与轮廓平行，条纹的强度与边缘的梯度幅值成正比，且沿垂直边缘的方向减弱。它的存在会混淆图像的高频特征 [<xref ref-type="bibr" rid="hanspub.16151-ref12">12</xref>] ，从而降低复原图像的质量，对图像的目标识别和信息提取造成干扰，使得复原图像后续处理的难度增加。</p></sec><sec id="s5_2"><title>3.2. 振铃起因</title><p>引起振铃的主要因素 [<xref ref-type="bibr" rid="hanspub.16151-ref13">13</xref>] [<xref ref-type="bibr" rid="hanspub.16151-ref14">14</xref>] 有En、Ed、Eb：</p><p>1) 滤波器噪声振铃En：观测像素中存在不可避免的测量和量化误差。</p><p>2) 滤波器偏差振铃Ed：点扩散函数PSF频域响应有零点，正则化过程把一个不适定的问题转换成适定的，导致复原滤波器与原来的PSF的逆卷积的偏差。</p><p>3) 边界截断振铃Eb：图像在边界处梯度剧变，对图像做傅里叶变换时，周期延拓导致边界处梯度剧变，引起振铃。</p></sec></sec><sec id="s6"><title>4. 振铃抑制</title><sec id="s6_1"><title>4.1. 振铃样式的影响因素</title><p>用扩展边界预处理方法可以很好地消除边界振铃。对于比较顽固的轮廓振铃，可以通过观察不同模糊半径、轮廓处梯度对振铃样式的影响，建立振铃样式库。图像大小和轮廓曲率对振铃样式基本不影响。</p><p>通过大量实验，我们得到轮廓振铃的影响范围约在100像素以内，由此可以确定振铃影响域。以观察中间第300行、301~400列像素的振铃变化规律为例。图4(a)调整模糊半径为5，8，10，可以看出振铃周期，随PSF模糊半径变大而周期也变大，且呈现振铃周期 ≈ 模糊半径 &#215; 2的关系。图4(b)调整图像的轮廓处梯度为50，80，110，可以看出振铃幅度与轮廓处梯度的关系，梯度越大振铃幅度越剧烈。</p></sec><sec id="s6_2"><title>4.2. 建立振铃样式库R</title><p>由此根据梯度和模糊半径对振铃样式的影响程度，建立振铃样式库R，R为大小500 &#215; 100的矩阵。</p><p>图2. 维纳滤波与最小二乘滤波复原方法对比</p><p>图3. 模糊半径为10的带振铃复原图像</p><p>图4. 振铃样式随轮廓梯度和PSF半径变化归路图</p><p>100是振铃影响范围，即在振铃影响域内的某一点，到轮廓的距离d。我们取模糊半径1~20，梯度1~255每隔10取一个代表点，共有25个量化梯度。</p><p>例如，对于复原图像轮廓上的某一点W(i, j)，我们将调用R库里第h行第d列的振铃值R(h, d)做修正。D为振铃点到轮廓的距离为d, t为轮廓处的梯度，r为模糊半径，则h如公式(4)：</p><disp-formula id="hanspub.16151-formula261"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2670060x19_hanspub.png"  xlink:type="simple"/></disp-formula><p>假设梯度t = 183，模糊半径r = 8，振铃距离为d = 30的点，应调用h = 25 &#215; (8 − 1) + 183/10 = 193行，即R(193, 30)的值，去修正W(i, j)，如果该点在距离轮廓的正梯度方向，则减去振铃修正值；如果在梯度负方向，则加上振铃修正值。</p></sec><sec id="s6_3"><title>4.3. 振铃距离d</title><p>在实际应用中，我们很容易求得轮廓某点的梯度值t。但对于距离d，由于运算量较大，需要一些高效快捷的方法把振铃影响域内的点，到轮廓的距离d标记在矩阵D中。方法有：</p><p>1) 边缘膨胀方法。边缘提取得到主轮廓B0。对轮廓做半径为1的圆盘结构元素膨胀操作，膨胀第i + 1次的结果B2，与第i次的结果B1做异或运算，得到的平行曲线轮廓就是所有距离d = i + 1的振铃点，循环100次，得到完整的距离矩阵D。</p><p>2) 点扩散方法。边缘提取得到主轮廓B0。对于振铃影响域内的每一点，做半径从1循环到100的圆扩散，当圆与轮廓相遇时，此时的半径即为距离d，相遇点即轮廓源点。</p><p>3) 点斜式方法。边缘提取得到主轮廓B0。对于轮廓上的每一点，都可以由斜率求得其法线，在法线方向上，标记各点到轮廓源点的距离，得到矩阵D。</p></sec><sec id="s6_4"><title>4.4. 振铃修正</title><p>最后用Matlab具有简单轮廓的图验证该方法。如图5(a)和图5(c)所示，图像大小600 &#215; 600，模糊半径为10。在验证过曲率对振铃样式不影响的基础上，可以直接调用直线的振铃样式库R。</p><p>图5. 调用振铃库做修正前后对比图</p><p>先求得振铃影响域内每一点到轮廓的距离，存在矩阵D中，针对每点调用振铃库R(h, d)来振铃修正后，肉眼看，图5(b)圆内和圆外的部分都几乎看不出振铃；数值上，振铃幅度由原来的&#177;10，修正后控制在&#177;2以内，效果非常好。图5(d)由于轮廓较复杂，在尖锐的轮廓处会有残余振铃，而且轮廓相隔较近处会有干扰，但整体上已消除大部分振铃。</p><p>该方法优点是：对简单轮廓、简单背景、梯度统一的图像，复原过程和振铃抑制都非常有效，几乎消除了振铃。该方法缺点是：运算量较大。对于复杂轮廓、复杂背景的图像，需要分别算出轮廓上每点的梯度，再单独标记所有由该轮廓点辐射出来的振铃，并调用振铃库R中同样的h不同的d。</p><p>由于振铃因素的多样性，比如振铃遇到边界再反射回来进一步影响振铃样式分布，当轮廓距离较近会有振铃叠加，在轮廓交点处会有环形振铃等。此类情况，需要特别考虑及修正，有待进一步研究。</p></sec></sec><sec id="s7"><title>5. 结语</title><p>首先通过对比选定了频域维纳滤波图像复原方法，并分析了图像离焦和产生振铃的原因。然后根据模糊半径和轮廓梯度对振铃样式的影响，提出建立振铃样式库R的方法。进一步介绍如何求得振铃点到轮廓的距离，最后对于振铃影响域内的每一点，调用R(h, d)做振铃修正。该方法很好的提升了退化图像的品质，改善视觉效果。</p></sec><sec id="s8"><title>致谢</title><p>感谢导师胡宗福教授的悉心指导，严谨治学和精益求精的科研精神让我受益匪浅。同时感谢实验室的学长学姐学弟学妹的关照，以及和搭档龚梦欢同学的学术探讨。</p></sec><sec id="s9"><title>文章引用</title><p>唐满芳,胡宗福. 散焦图像的维纳滤波复原及振铃抑制Defocused Image Restoration with Wiener Filter and Ringing Suppression[J]. 图像与信号处理, 2015, 04(04): 87-93. http://dx.doi.org/10.12677/JISP.2015.44010</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16151-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">王永攀, 冯华君, 徐之海, 等 (2009) 模糊核估计不准确下的振铃效应修正. 光电工程, 8, 105-111.</mixed-citation></ref><ref id="hanspub.16151-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">左博新, 明德烈, 田金文 (2010) 盲复原图像振铃效应评价. 中国图象图形学报, 8, 1244-1253.</mixed-citation></ref><ref id="hanspub.16151-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">李金宗, 黄建明, 陈凤, 等 (2008) 超分辨率处理中振铃现象的分析与抑制. 系统工程与电子技术, 6, 664-668.</mixed-citation></ref><ref id="hanspub.16151-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">马子扬, 刘学慧, 吴恩华 (2014) 图像反卷积边界效应的快速抑制算法. 计算机辅助设计与图形学学报, 7, 1051- 1059.</mixed-citation></ref><ref id="hanspub.16151-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">赵剡, 李东兴, 许东 (2006) 抑制复原图像振铃波纹的频域循环边界算法. 北京航空航天大学学报, 11, 1290- 1294.</mixed-citation></ref><ref id="hanspub.16151-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">李俊山, 张士杰, 杨亚威, 等 (2014) 基于边缘分离的去振铃复原. 光学精密工程, 3, 797-805.</mixed-citation></ref><ref id="hanspub.16151-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">吴玲达, 郝红星 (2012) 一种图像去模糊正则化恢复算法参数确定方法. 国防科技大学学报, 4, 79-84.</mixed-citation></ref><ref id="hanspub.16151-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">唐述 (2013) 基于正则化的图像去模糊方法研究. 博士论文, 重庆大学, 重庆.</mixed-citation></ref><ref id="hanspub.16151-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">张益昕, 王顺, 张旭苹 (2011) 大尺度三维视觉测量中的离焦模糊图像恢复. 仪器仪表学报, 12, 2748-2753.</mixed-citation></ref><ref id="hanspub.16151-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">徐宗琦, 高璐 (2007) 一种盲复原图像振铃效应的后处理与质量评价方法. 计算机应用, 4, 986-988.</mixed-citation></ref><ref id="hanspub.16151-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Shen, C.T., Hwang, W.L. and Pei, S.C. (2012) Spatially-varying out-of-focus image deblurring with L1-2 optimization and a guided blur map. 2012 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), Kyoto, 25-30 March 2012, 1069-1072. &lt;br&gt;http://dx.doi.org  /10.1109/ICASSP.2012.6288071</mixed-citation></ref><ref id="hanspub.16151-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Aghdasi, F. and Ward, R.K. (1996) Reduction of boundary artifacts in image restoration. IEEE Transactions on Image Processing A Publication of the IEEE Signal Processing Society, 5, 611-618. &lt;br&gt;http://dx.doi.org  /10.1109/83.491337</mixed-citation></ref><ref id="hanspub.16151-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Lagendijk, R.L., Biemond, J. and Boekee, D.E. (1988) Regularized iterative image restoration with ringing reduction. IEEE Transactions on Acoustics Speech &amp; Signal Processing, 36, 1874-1888. &lt;br&gt;http://dx.doi.org  /10.1109/29.9032</mixed-citation></ref><ref id="hanspub.16151-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Tekalp, A.M. and Sezan, M.I. (1990) Quantitative analysis of artifacts in linear space-invariant image restoration. Multidimensional Systems &amp; Signal Processing, 1, 143-177. &lt;br&gt;http://dx.doi.org  /10.1007/BF01816547</mixed-citation></ref></ref-list></back></article>