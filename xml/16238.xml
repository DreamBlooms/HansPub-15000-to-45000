<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2015.59041</article-id><article-id pub-id-type="publisher-id">CSA-16238</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20150900000_91237447.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于Labview的声卡数据采集与处理系统设计与实现
  The Design and Implementation of Data Acquisition and Processing System Based on Labview
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>秦</surname><given-names>志一</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吕</surname><given-names>丹桔</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>月月</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>园园</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>黄飞</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>云鹏</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>雁</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>西南林业大学，云南 昆明</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1297215564@qq.com(吕丹)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>21</day><month>10</month><year>2015</year></pub-date><volume>05</volume><issue>09</issue><fpage>331</fpage><lpage>335</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  随着现代计算机科学技术的不断发展，labview图形编程开发技术已经被广泛应用。针对数据采集卡采集语音信号数据成本过高和计算机声卡性价比高等优点设计了基于labview的声卡数据采集处理系统。该系统可以根据用户需要设置合适的采样参数对采集到的语音信号进行时域和频域上的分析。该系统具有界面设计简单，扩展性好，功能多样化和数据处理能力强等优点。
   With the development of modern computer science and technology, Labview graphical program-ming technology has been widely used nowadays. Considering the cost of the data acquisition card is high and the computer sound card is cost-effective, data acquisition card can be replaced by computer sound card. According to this we designed a sound card based on Labview data acquisi-tion processing system. This system can meet users’ different demands. We can do research on speech signal in time domain and frequency domain by setting appropriate sampling parameters. This system’s interface is simple and it has good expansibility, functional diversity and strong data processing capability.
 
</p></abstract><kwd-group><kwd>声卡，LabVIEW，数据采集，信号处理, Sound Card</kwd><kwd> Labview</kwd><kwd> Data Acquisition</kwd><kwd> Signal Processing</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于Labview的声卡数据采集与处理系统设计与实现<sup> </sup></title><p>秦志一，吕丹桔<sup>*</sup>, 赵月月，王园园，刘黄飞，吴云鹏，张雁</p><p>西南林业大学，云南 昆明</p><p>Email: <sup>*</sup>1297215564@qq.com</p><p>收稿日期：2015年10月5日；录用日期：2015年10月23日；发布日期：2015年10月28日</p><disp-formula id="hanspub.16238-formula336"><graphic xlink:href="http://html.hanspub.org/file/3-1540500x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>随着现代计算机科学技术的不断发展，labview图形编程开发技术已经被广泛应用。针对数据采集卡采集语音信号数据成本过高和计算机声卡性价比高等优点设计了基于labview的声卡数据采集处理系统。该系统可以根据用户需要设置合适的采样参数对采集到的语音信号进行时域和频域上的分析。该系统具有界面设计简单，扩展性好，功能多样化和数据处理能力强等优点。</p><p>关键词 :声卡，LabVIEW，数据采集，信号处理</p><disp-formula id="hanspub.16238-formula337"><graphic xlink:href="http://html.hanspub.org/file/3-1540500x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>在计算机信息飞速发展的信息时代，可靠的数据采集系统是对信号在时域和频域上进行分析的重要保障。在数据采集系统中最重要的模块是数据采集模块，现在市面上出售的数据采集卡能够实现示波器、波形发生器、频率响应分析仪等多种采样功能。它们有着很强的扩展性和精确性[<xref ref-type="bibr" rid="hanspub.16238-ref1">1</xref>] ，像12位采样精度200 M的实时采样频率双通道的数字采样和USB供电模式的便利基本上能满足工程师与广大工科院校师生的使用要求。考虑到使用商业数据采集卡成本过高和对信号的处理还是得依托计算机这个平台来进行[<xref ref-type="bibr" rid="hanspub.16238-ref2">2</xref>] 。本文在以计算机为平台设计了基于Labview的声卡数据采集与处理系统。实验结果表明该系统具有设计简便、采样精度高，扩展性能好等优点[<xref ref-type="bibr" rid="hanspub.16238-ref3">3</xref>] 。利用Labview软件搭载的数据采集系统在降低成本的同时还能便于使用者携带，给用户带来了极大的便利。</p></sec><sec id="s4"><title>2. 声卡系统结构</title><p>集成在计算机上的声卡系统利用数字信号处理器(DSP)芯片来采集语音信号。DSP芯片中自带的RAM，可以用来暂存数据信息，并对数据进行处理，将声音信号编码和解码，并借助自带的模数和数模转换器，实现声音信号的模拟化和数字化之间的高速便捷转换。</p><p>声卡的数字化声音接口有直接传送方式和DMA传送方式两种[<xref ref-type="bibr" rid="hanspub.16238-ref4">4</xref>] 。直接传送方式是由应用程序直接通过数字信号处理器将声音数据进行输入输出，进行输入输出的数据是8位或16位脉冲编码调制PCM数据；DMA传送方式是将声音信号在数字信号处理器中采用DMA方式进行输入或输出。</p></sec><sec id="s5"><title>3. 基于计算机声卡的数据采集系统设计</title><p>基于声卡的数据采集系统主要由计算机内置的声卡以及Labview软件组成。该数据采集系统设计主要由声传感器、采集电路、计算机声卡、Labview程序、对语音信号的存储和显示这几个模块组成数据采集系统原理框图，如图1所示。</p><p>该数据采集模块首先在前面板设置好采样率、通道数、采样比特数等相关采集参数来采集声音数据。配置好声音输入VI后先通过启动声音输入VI来采集语音信号数据，再通过停止声音输入采集VI和写入声音文件VI将采集到的数据输送到移位寄存器。移位寄存器将上一次循环采集到的数值传递到下一次循环中去作为下一次循环的初始值输入，移位寄存器用于存储循环结束时采集到的语音信号数据。采集数据完毕后从目标文件下打开已经采集好的语音数据去并且确认采集来的数据是否正确。确认完毕后通过if条件结构选择存储路径和存储格式并对该数据进行存储，数据采集程序框图(如图2所示)。</p><p>数据采集模块利用计算机自带的声卡，由用户自主设置声音格式、采样参数来获取声音数据[<xref ref-type="bibr" rid="hanspub.16238-ref5">5</xref>] 。采样频率可由用户自主设置，根据声音的采样特性，此处可以自主选择输入多种采样频率，而在本次试验中根据人说话发出的声音频率在65 hz~1100 hz和听到的声音频率在20 hz~20 khz的基础上将采样频率定为44,100 Hz；通道数可以选择；每采样比特数数可以输入8位或16位[<xref ref-type="bibr" rid="hanspub.16238-ref6">6</xref>] 。采集声音数据的同时将原始音频信号以波形图的方式呈现于用户面前。在设计中使用的是存储格式是wav语音文件格式[<xref ref-type="bibr" rid="hanspub.16238-ref7">7</xref>] 。</p></sec><sec id="s6"><title>4. 基于计算机声卡的数据处理系统设计</title><p>数据处理模块(如图3所示)能根据用户需要对计算机声卡采集到的语音信号做简单的处理分析。</p><p>根据声音的采样特性，为了尽可能无失真的还原语音信号，本次设计采样率设定为44,100 Hz；根据用户的需求通道数可以选择单通道和双通道，本次设计采用的是单通道；采样比特数设为16位。在进行语音信号进行分析处理时，有矩形窗、hanning窗、hamming窗多种窗函数供用户选择对信号的幅频特性、相频特性、功率谱特性来进行分析[<xref ref-type="bibr" rid="hanspub.16238-ref8">8</xref>] 。对原始信号通过窗函数进行简单的信号处理，降低噪声的干扰，尽量做到信号的无失真获取。</p><p>图1. 系统框图</p><p>图2. 数据采集部分程序框图</p><p>图3. 数据处理框图</p><p>图4所示为Labview数据处理的程序框图，用户在对语音信号处理的结果就是通过窗函数来进行处理的。在程序的前面板用了一个下拉框来选择窗函数。不同的窗函数具有不同的处理功能，用户可根据自己的要求进行选择[<xref ref-type="bibr" rid="hanspub.16238-ref8">8</xref>] 。该部分是整个Labview程序框图的关键部分。在条件结构中输入用户已经存入的wav格式的语音文件的路径在通过字符串转函数的VI转换下转换成声音文件信息能识别的VI路径，从而打开声音文件。VI能够对已经存好的语音数据进行读取并且输出该语音信号的波形[<xref ref-type="bibr" rid="hanspub.16238-ref9">9</xref>] 。右边的条件结构和对子VI分析信号的声音格式的调用是用来确定刚采集的语音信号的声音格式是不是在开始选择的wav的格式，如果不是条件结构会弹出请重新采集语音信号的提示框。根据用户需要分析语音信号数据的起止时间和终止时间用户可以自行设置，该部分程序框图是由数学逻辑流程图和一个条件结构来实现的，通过条件结构来判断输入的时间是否合法。最后通过获取波形成分VI将波形成分分别输入到FFT功率谱VI和FFT频率谱，使VI实现对采集到的语音信号的幅度谱、功率谱和相位谱的输出。</p></sec><sec id="s7"><title>5. 实验结果</title><p>本设计主要实现了对采集到的声音信号进行时域分析和频域分析，实现分析声音信号的幅度谱、相位谱和功率谱等功能，实验结果如图5所示。时域分析是一种直接在时间域中对波形信号进行分析处理的方法，直观、准确，可以对数据采集系统时间响应的全部信息进行处理。频域分析是通过傅里叶变换将时域信号变换到频域，主要用来分析信号的频谱成分，用来了解信号的幅度变化和功率变化。</p><p>本系统以Labview软件为开发平台，利用了计算机声卡A/D转换功能强的特点，完成了对语音信号数据的实时采集和和分析并且能做出一些简单的信号处理。由于该系统性价比高，界面设计简单，扩展</p><p>图4. 数据处理程序框图</p><p>图5. 虚拟频谱分析界面</p><p>性能好，随着计算机的普及，虚拟仪器技术的成熟，该系统可被广泛用在信号分析和信号处理领域。</p></sec><sec id="s8"><title>文章引用</title><p>秦志一,吕丹桔,赵月月,王园园,刘黄飞,吴云鹏,张雁. 基于Labview的声卡数据采集与处理系统设计与实现The Design and Implementation of Data Acquisition and Processing System Based on Labview[J]. 计算机科学与应用, 2015, 05(09): 331-335. http://dx.doi.org/10.12677/CSA.2015.59041</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16238-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">杜鹏, 陶洪铸, 高保成, 张勇, 郭凌旭, 晏亮 (2015) 面向多应用的通用数据采集技术方案. 电力系统自动化, 1, 26-30.</mixed-citation></ref><ref id="hanspub.16238-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">陆建荣, 单梁, 汪静, 李军, 孙翌晨 (2015) 基于ARM的分布式多通道数据采集仪. 计算机工程与科学, 5, 1031- 1036.</mixed-citation></ref><ref id="hanspub.16238-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">车子萍 (2010) 基于LabVIEW和声卡的数据采集及频谱分析仪设计. 仪器仪表用户, 4, 14-15.</mixed-citation></ref><ref id="hanspub.16238-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">武晨, 符为榕 (2014) 基于Labview的声卡数据采集与分析系统设计. 机械工程与自动化, 4, 57-59.</mixed-citation></ref><ref id="hanspub.16238-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">刘妍 (2006) 基于声卡的数据采集系统设计. 伺服控制, 7, 87-89.</mixed-citation></ref><ref id="hanspub.16238-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">徐岩, 张晓明, 王瑜, 孙庆彬, 王之猛 (2011) 基于离散傅里叶变换的频谱分析新方法. 电力系统保护与控制, 11, 38-43.</mixed-citation></ref><ref id="hanspub.16238-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">种兰祥, 阎丽, 张首军 (2002) 基于计算机声卡的多通道数据采集系统. 西北大学学报(自然科学版), 6, 629-632.</mixed-citation></ref><ref id="hanspub.16238-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">陈林, 马天阳, 林凯, 钱世龙 (2011) 基于LabVIEW和声卡采集的温度控制系统设计. 科技信息, 26, 219.</mixed-citation></ref><ref id="hanspub.16238-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">李明, 杨其锋 (2013) 一种基于声卡的虚拟示波器的设计. 科技通报, 4, 155-157.</mixed-citation></ref></ref-list></back></article>