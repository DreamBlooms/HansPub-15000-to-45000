<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JEE</journal-id><journal-title-group><journal-title>Journal of Electrical Engineering</journal-title></journal-title-group><issn pub-type="epub">2333-5394</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JEE.2016.41005</article-id><article-id pub-id-type="publisher-id">JEE-17084</article-id><article-categories><subj-group subj-group-type="heading"><subject>JEE20160100000_62736296.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  变压器保护硬件在环实时仿真研究
  Study on the Real-Time Simulation of Transformer Protection with the Hardware in the Loop
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>钱</surname><given-names>俊杰</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>孙</surname><given-names>琳</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>薛</surname><given-names>海芹</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>建飞</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>华仁</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>南京师范大学电气与自动化工程学院，江苏 南京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1158453989@qq.com (钱俊)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>01</day><month>03</month><year>2016</year></pub-date><volume>04</volume><issue>01</issue><fpage>31</fpage><lpage>37</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   为了满足变压器保护可靠性、速动性和灵敏性的要求，以TI公司的DSPF28335为控制核心，编写算法设计变压器的保护装置。以二次谐波制动的方法躲过变压器合闸时的励磁涌流，利用纵联差动保护作为变压器主保护，利用过电流保护作为后备保护。利用MATLAB/Simulink搭建110 kV/11 kV等级的变压器模型，设置相应的故障，在半实物仿真平台RT-LAB上验证保护装置的性能。 With a TI Corporation DSPF28335 as the core of control, a transformer protection was designed that meets the needs of selectivity, speed, reliability and sensitivity, clears internal faults by lon-gitudinal differential protection, and uses over-current protection as backup protection. A 110/11 kV transformer model was designed in MATLAB/Simulink. Then, corresponding faults were set to obtain simulation waves and to activate RT-LAB, a real-time simulation platform. With a DSP, hardware for the real-time simulation loop was achieved, and corresponding figures and performance tests of the protection were obtained.
    
  
 
</p></abstract><kwd-group><kwd>变压器，微机保护，DSP，RT-LAB, Transformer</kwd><kwd> Microcomputer Protection</kwd><kwd> DSP</kwd><kwd> RT-LAB</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>变压器保护硬件在环实时仿真研究<sup> </sup></title><p>钱俊杰，孙琳，薛海芹，杨建飞，吴华仁</p><p>南京师范大学电气与自动化工程学院，江苏 南京</p><disp-formula id="hanspub.17084-formula278"><graphic xlink:href="http://html.hanspub.org/file/5-1010097x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年2月16日；录用日期：2016年3月1日；发布日期：2016年3月8日</p><disp-formula id="hanspub.17084-formula279"><graphic xlink:href="http://html.hanspub.org/file/5-1010097x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为了满足变压器保护可靠性、速动性和灵敏性的要求，以TI公司的DSPF28335为控制核心，编写算法设计变压器的保护装置。以二次谐波制动的方法躲过变压器合闸时的励磁涌流，利用纵联差动保护作为变压器主保护，利用过电流保护作为后备保护。利用MATLAB/Simulink搭建110 kV/11 kV等级的变压器模型，设置相应的故障，在半实物仿真平台RT-LAB上验证保护装置的性能。</p><p>关键词 :变压器，微机保护，DSP，RT-LAB</p><disp-formula id="hanspub.17084-formula280"><graphic xlink:href="http://html.hanspub.org/file/5-1010097x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>在电力系统中广泛地用变压器来升高或降低电压。变压器是电力系统不可缺少的重要电气设备。它的故障将对供电可靠性和系统安全性带来严重影响，同时大容量的电力变压器本身也是很贵重的装置。因此需要根据变压器容量等级和重要程度安装性能良好、动作可靠的继电保护装置[<xref ref-type="bibr" rid="hanspub.17084-ref1">1</xref>] 。</p><p>本文将设计以DSPF28335为控制核心的变压器保护装置，保护装置的主要功能为区分变压器区内和区外故障，断开故障电路，保护能够躲过励磁涌流。在MATLAB/Simulink中搭建变压器的数学模型，进行变压器区内短路、区外短路的仿真[<xref ref-type="bibr" rid="hanspub.17084-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.17084-ref3">3</xref>] 。编写相应的算法程序，纵联差动保护差动电流和过电流保护的电流有效值采用傅里叶变换计算有效值的方法，躲过励磁涌流采用二次谐波制动，也是利用傅里叶变换计算基波和二次谐波的有效值。</p><p>TMSF28335 DSP是TI公司新推出的一款浮点型数字信号处理器。这款DSP既保持了原有DSP芯片的优点，又能够执行复杂的浮点运算，频率可达到150 MHZ，具有精度高、成本低、功耗小、外设集成度高、数据及程序存储量大和AD转换更加精确等优点[<xref ref-type="bibr" rid="hanspub.17084-ref4">4</xref>] 。</p><p>最后，在半物理仿真平台RT-LAB上验证保护装置的性能，RT-LAB实时仿真系统是加拿大Opal-RT公司开发的一套基于模型的设计和测试应用平台，广泛应用于科研和工程设计。它将Simulink、SystemBuild等建模工具所搭建的数学模型，通过上位机和多台目标机的模式，将仿真模型放置在实时仿真平台上运行，从而方便地实现对大型复杂的硬件在环和快速控制原型的实时仿真进行分布式并行计算[<xref ref-type="bibr" rid="hanspub.17084-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.17084-ref6">6</xref>] 。本文的设计利用RT-LAB将短路电流输出给DSP采样，DSP输出跳闸信号给RT-LAB。</p></sec><sec id="s4"><title>2. 硬件设计</title><p>本设计的核心控制板中，使用DSP28335为核心处理器。变压器保护的硬件电路框图如图1所示，包括数据采集模块、CPU模块、电源电路模块、开关量输入输出模块、复位电路及JATG下载口电路模块等[<xref ref-type="bibr" rid="hanspub.17084-ref7">7</xref>] 。</p><p>以系统硬件框图为基础为本变压器保护装置设计了基于DSPF28335的核心板，以便于程序的开发和升级。</p></sec><sec id="s5"><title>3. 软件设计</title><p>根据变压器保护的需要，设计了基于DSPF28335的采样程序、差动保护的程序、过电流保护的程序。使用的开发环境是TI公司提供的CCS (Code Composer Studio)软件，本设计使用的是CCS3.3的版本。</p><p>图1. 系统硬件框图</p><sec id="s5_1"><title>3.1. 采样程序设计</title><p>TMS320F28335内部的A/D转换模块是一个12位具有带流水线的模数转换器。该模块包含了前端模拟多路复用开关(MUX)、采样/保持(S/H)电路等。该模块还具有16个通道，可以配置为两个独立的8通道模块，分别为ADCINA0至ADCINA7、ADCINB0至ADCINB7 [<xref ref-type="bibr" rid="hanspub.17084-ref8">8</xref>] 。</p><p>本装置的采样程序设计为6路通道的顺序采样，使用的通道为ADCINA0~ADCINA5，设定的采样频率为2400 HZ，即一个周波(0.02 s)采样48个点，使用EPWM为采样的触发信号。采样值与转换的数字值之间的关系为：</p><disp-formula id="hanspub.17084-formula281"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中N为转换的数字值，V为采样的模拟值，在使用时将ADCLO端接地，因此数字值和模拟值是一个线性对应的关系。</p></sec><sec id="s5_2"><title>3.2. 傅里叶级数算法设计</title><p>电流的有效值是采用傅里叶变换来计算，需要计算基波的有效值，差动电流基波的有效值。</p><p>傅里叶级数算法的基本思路来自傅里叶级数，算法本身具有滤波作用。它假定被采样的模拟信号是一个周期性时间函数，除基波外还含有不衰减的直流分量和各次谐波[<xref ref-type="bibr" rid="hanspub.17084-ref9">9</xref>] ，可表示为：</p><disp-formula id="hanspub.17084-formula282"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x11_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17084-formula283"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x12_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17084-formula284"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：a<sub>n</sub>、b<sub>n</sub>分别为直流、基波和各次谐波的正选项和余弦项的振幅。</p><p>因为DSP处理的是离散信号，所以需要将连续的信号离散化，用梯形法则可以求得：</p><disp-formula id="hanspub.17084-formula285"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x14_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17084-formula286"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x15_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：N为基波信号的一周期采样点数；</p><p>x<sub>k</sub>为第次采样值；</p><p>x<sub>0</sub>、x<sub>N</sub>分别为k = 0和k = N时的采样值。</p><p>因此，可以根据，求出有效值和相角如式(7)和(8)所示：</p><disp-formula id="hanspub.17084-formula287"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x16_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17084-formula288"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x17_hanspub.png"  xlink:type="simple"/></disp-formula></sec></sec><sec id="s6"><title>4. 硬件在环实时仿真</title><p>RT-LAB半实物仿真系统结构如图2所示。半实物仿真系统由上位机、目标机以及硬件实物组成。RT-LAB实时仿真系统包括上位机和目标机。上位机装有MATLAB/Simulink等图形化建模工具和RT-LAB软件包，可以完成系统建模、在线参数调节和信号监测等工作。目标机是Opal-RT公司专为半实物仿真应用而设计的基于PC的实时仿真器，内部配置有多核处理器，装有QNX或者Redhat实时操作系统，可以完成复杂系统模型的分布式实时计算。</p><p>Simulink仿真模型在RT-LAB中的模型如图3所示，需要将6路模拟信号配置给板卡输出，将跳闸信号配置给板卡输入。将变压器的MATLAB/Simulink仿真模型放在RT-LAB中运行，将变压器高压侧和低压侧的电流以模拟信号的形式送出给保护装置采样，并设置区内和区外故障 [<xref ref-type="bibr" rid="hanspub.17084-ref10">10</xref>] ，检验保护装置的性能。具体的保护装置和RT-LAB实验系统如图4所示。</p></sec><sec id="s7"><title>5. 实验结果</title><p>图5(a)显示了差动保护的实验波形，图5(b)显示了过电流保护的实验波形。</p><p>图2. RT-LAB半实物仿真系统结构图</p><p>图3. RT-LAB半实物仿真系统结构图</p><p>图4. RT-LAB实验验证系统图</p><p>图5. 差动保护和过电流保护实验波形</p><p>在Simulink中将变压器的区内故障设定为仿真开始后5.2 s发生，故障为三相短路，图5(a)三个波形从上到下依次为变压器高压侧的电流、变压器低压侧的电流、保护装置的跳闸信号，DSP的GPIO52口在系统正常运行时输出高电平，在检测到差动电流时输出低电平，从第三个波形看出从短路发生到DSP发出跳闸信号大概经过25 ms，能够快速切除故障。</p><p>在Simulink中将变压器的区外故障设定为仿真开始后7.2 s发生，故障为三相接地短路，由于过电流保护是后备保护，延时1 s动作，图5(b)三个波形从上到下依次为变压器高压侧的电流、变压器低压侧的电流、保护装置的跳闸信号，DSP的GPIO52口在系统正常运行时输出高电平，在检测到差动电流时输出低电平，从第三个波形看出从短路发生到DSP发出跳闸信号大概经过1.026 s，能够起到保护作用，切</p><p>图6. 差动保护和过电流保护在示波器中的波形</p><p>除变压器低压母线故障。</p><p>将高压侧的a相的电流和DSP的跳闸信号输入到示波器中，利用示波器的捕捉功能将跳闸瞬间的波形捕捉，波形如图6所示图6(a)为差动保护在示波器中的波形，图6(b)为过电流保护在示波器中的波形。由于DSP只能采样0~3 V的信号，而变压器两侧的电流是正弦信号，根据变压器高压侧和低压侧正常运行和短路时电流的大小，将原边和副边的信号分别进行式(9)、(10)的变换</p><disp-formula id="hanspub.17084-formula289"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x25_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17084-formula290"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-1010097x26_hanspub.png"  xlink:type="simple"/></disp-formula><p>从示波器的波形图6(a)中可以看出短路故障在35 ms发生，在60 ms时DSP发出跳闸信号，切除故障的时间约为25 ms。</p></sec><sec id="s8"><title>6. 结论</title><p>本文结合电力行业变压器保护标准规范的要求，设计了一种基于DSP的变压器保护装置，进行了硬件、软件等的设计。通过半实物仿真平台RT-LAB的实验验证，本文设计的变压器保护装置能够满足变压器保护的可靠性、速动性、选择性的要求，能够区分变压器区内和区外故障，并且准确切除短路故障。</p></sec><sec id="s9"><title>文章引用</title><p>钱俊杰,孙 琳,薛海芹,杨建飞,吴华仁. 变压器保护硬件在环实时仿真研究Study on the Real-Time Simulation of Transformer Protection with the Hardware in the Loop[J]. 电气工程, 2016, 04(01): 31-37. http://dx.doi.org/10.12677/JEE.2016.41005</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.17084-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">张保会, 尹项根. 电力系统继电保护[M]. 第二版. 北京: 中国电力出版社, 2009: 166-174.</mixed-citation></ref><ref id="hanspub.17084-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">王忠礼, 段慧达. MATLAB应用技术[M]. 北京: 清华大学出版社, 2007: 164-167.</mixed-citation></ref><ref id="hanspub.17084-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">于群, 曹娜. MATLAB/Simulink电力系统建模与仿真[M]. 北京: 机械工业出版社, 2011: 95-100.</mixed-citation></ref><ref id="hanspub.17084-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">刘陵顺, 高艳丽. TMS320F28335DSP原理及开发编程[M]. 北京: 北京航空航天大学出版社, 2011: 269-274.</mixed-citation></ref><ref id="hanspub.17084-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">陈元斌. 基于RT-LAB的热连轧主传动系统建模与仿真[D]: [硕士学位论文]. 杭州: 浙江大学, 2004.</mixed-citation></ref><ref id="hanspub.17084-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">郑鹤玲, 葛宝明. 基于RT-LAB的光伏发电系统实时仿真[J]. 电工电能新技, 2010, 29(4): 62-66.</mixed-citation></ref><ref id="hanspub.17084-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">刘宇. 基于TMS320F28335信号处理板的设计与实现[J]. 电子科技, 2011, 24(5): 44-47.</mixed-citation></ref><ref id="hanspub.17084-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">谭浩强. C程序设计[M]. 第三版. 北京: 清华大学出版社, 2005: 115-120.</mixed-citation></ref><ref id="hanspub.17084-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">杨奇逊, 黄少锋. 微机继电保护基础[M]. 第四版. 北京: 中国电力出版社, 2013: 89-94.</mixed-citation></ref><ref id="hanspub.17084-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Yabe, K. (1997) Power Differential Method for Discrimination between Fault and Magnetizing Inrush Current in Transformers. IEEE Transactions on Power Delivery, 12, 1109-1118. &lt;br&gt;http://dx.doi.org/10.1109/61.636909</mixed-citation></ref></ref-list></back></article>