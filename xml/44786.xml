<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2021.108298</article-id><article-id pub-id-type="publisher-id">AAM-44786</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20210800000_25208861.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于随机森林模型的重庆市二手房价格预测研究
  Research on Price Prediction of Second-Hand Housing in Chongqing Based on Random Forest Model
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>康</surname><given-names>嘉玲</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>成都信息工程大学应用数学学院，四川 成都</addr-line></aff><pub-date pub-type="epub"><day>03</day><month>08</month><year>2021</year></pub-date><volume>10</volume><issue>08</issue><fpage>2862</fpage><lpage>2867</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  二手房价格的精准预测对购房者和政府对房地产政策的调控具有重要意义，本文以重庆市九大主城区2015~2020成交的二手房价格为依据，将影响房价的微观因素与宏观因素有机结合，运用Python使用随机森林算法对二手房数据集进行训练建模，最后结合岭回归、Lasso回归对训练结果进行比较，实验结果显示随机森林模型的误差最小，应用效果比较好，值得推广和应用到房地产价格评估中。
   The accurate prediction of the second-hand house price is of great significance to the buyers and the government’s regulation of the real estate policy. This paper takes the prices of second-hand houses that were traded between 2015 and 2020 in the nine major urban areas of Chongqing as reference, organically combines the micro and macro factors that affect the housing prices, and uses Python and random forest algorithm to conduct training modeling on the second-hand house data set. Finally, ridge regression and Lasso regression are combined to compare the training results. The experimental results show that the error of random forest model is the smallest, the application effect is better, and it is worth popularizing and applying to the real estate price evaluation.
 
</p></abstract><kwd-group><kwd>随机森林，岭回归，Lasso回归，二手房, Random Forests</kwd><kwd> Ridge Regression</kwd><kwd> Lasso Regression</kwd><kwd> Second-Hand Houses</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>二手房价格的精准预测对购房者和政府对房地产政策的调控具有重要意义，本文以重庆市九大主城区2015~2020成交的二手房价格为依据，将影响房价的微观因素与宏观因素有机结合，运用Python使用随机森林算法对二手房数据集进行训练建模，最后结合岭回归、Lasso回归对训练结果进行比较，实验结果显示随机森林模型的误差最小，应用效果比较好，值得推广和应用到房地产价格评估中。</p></sec><sec id="s2"><title>关键词</title><p>随机森林，岭回归，Lasso回归，二手房</p></sec><sec id="s3"><title>Research on Price Prediction of Second-Hand Housing in Chongqing Based on Random Forest Model<sup> </sup></title><p>Jialing Kang</p><p>Department of Applied Mathematics, Chengdu University of Information Technology, Chengdu Sichuan</p><p><img src="//html.hanspub.org/file/26-2621773x4_hanspub.png?20210827085153101" /></p><p>Received: Jul. 23<sup>rd</sup>, 2021; accepted: Aug. 15<sup>th</sup>, 2021; published: Aug. 26<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/26-2621773x5_hanspub.png?20210827085153101" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>The accurate prediction of the second-hand house price is of great significance to the buyers and the government’s regulation of the real estate policy. This paper takes the prices of second-hand houses that were traded between 2015 and 2020 in the nine major urban areas of Chongqing as reference, organically combines the micro and macro factors that affect the housing prices, and uses Python and random forest algorithm to conduct training modeling on the second-hand house data set. Finally, ridge regression and Lasso regression are combined to compare the training results. The experimental results show that the error of random forest model is the smallest, the application effect is better, and it is worth popularizing and applying to the real estate price evaluation.</p><p>Keywords:Random Forests, Ridge Regression, Lasso Regression, Second-Hand Houses</p><disp-formula id="hanspub.44786-formula16"><graphic xlink:href="//html.hanspub.org/file/26-2621773x6_hanspub.png?20210827085153101"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/26-2621773x7_hanspub.png?20210827085153101" /> <img src="//html.hanspub.org/file/26-2621773x8_hanspub.png?20210827085153101" /></p></sec><sec id="s5"><title>1. 引言</title><p>住房不管在任何时期都是人们最基本的生活需求，与人民的生活品质密切相关，然而近几年我国各地房价持续上涨成为了社会的热点关注话题。与此同时，由于城市内可以用来建筑新房的土地越来越少，二手房交易市场越来越活跃，逐步取代新房在房地产行业占据主导地位。因此对二手房价格进行精准的预测，不仅可以为老百姓买卖房屋提供指导意见，并且对政府合理调控房地产交易市场具有重要意义。</p><p>近年来，随着互联网、大数据等技术的发展，有学者开始尝试使用数据挖掘、机器学习的新技术去预测房价，与其他方法相比，机器学习在非线性和多元统计上表现出了良好的应用前景 [<xref ref-type="bibr" rid="hanspub.44786-ref1">1</xref>]。本文使用随机森林算法 [<xref ref-type="bibr" rid="hanspub.44786-ref2">2</xref>] 对重庆市二手房价格进行预测，并结合岭回归、Lasso回归和回归决策树模型对训练结果进行比较，使用RMSE和R<sup>2</sup>对模型进行评估，最后结果显示随机森林模型的均方根误差RMSE最小和拟合优度R<sup>2</sup>最大，对二手房价格的预测误差最小。</p></sec><sec id="s6"><title>2. 数据分析及预处理</title><sec id="s6_1"><title>2.1. 数据集分析</title><p>由于考虑到城乡地区二手房价格有一定的差距，因此本文仅对重庆市九大主城区的二手房价格进行分析及预测。本文的数据集有96,346条样本，每个样本包含了20个特征，其中14个为数值型特征，6个为类别型特征。被解释变量为单位面积房屋价格(元/平方米)，解释变量分为宏观因素与微观因素，宏观变量包括经济因素和人口因素相关的7个特征，如地区生产总值，全体居民人均可支配收入、年末常住人口等，微观因素包括13个房屋基本信息相关的特征，如成交年月、房屋面积、所属区域、房屋户型等。其中宏观变量来自于重庆市统计年鉴，微观变量是使用网络爬虫技术于重庆市链家网站上获取，之所以选择链家网站进行数据获取是因为链家是以二手房交易起步的房屋交易平台，其房源信息的真实性、完整性和丰富性要高于其他平台。</p></sec><sec id="s6_2"><title>2.2. 数据预处理</title><sec id="s6_2_1"><title>2.2.1. 数据清洗</title><p>在对数据进行分析处理之前，首先要对数据进行清洗工作，主要包括处理重复值、缺失值和异常值，避免这些脏数据影响最终的预测结果。使用Python的工具包检查到本数据集不存在重复值与缺失值，然后使用箱线图分析法检测到三个异常点，对异常点进行删除，最终有效样本为96,343条。</p></sec><sec id="s6_2_2"><title>2.2.2. 离散变量重编码</title><p>离散型变量是不能直接用于建模，需要对这些数据进行重编码，将字符型变量转化为数值型变量，比如本数据集中需要处理的字符型变量有户型、建筑结构、装修状况、所属区域、商圈等信息。</p></sec><sec id="s6_2_3"><title>2.2.3. 特征归一化</title><p>对离散型变量进行数值化后，由于各个特征取值的大小不同，会造成特征空间中样本点的距离被个别特征值所主导，归一化 [<xref ref-type="bibr" rid="hanspub.44786-ref3">3</xref>] 是为了将数据映射到0~1之间，去掉量纲的过程，使计算更加的合理，让不同维度之间的特征在数值上有一定的可比性，提高预测的准确性。公式如下：</p><p>x n e w = x − x min x max − x min</p></sec><sec id="s6_2_4"><title>2.2.4. 对非正态数据进行正态化</title><p>由于大多数机器学习不能很好的处理非正态数据，需要将偏态数据进行正态化，本文选择使用Box-Cox变换 [<xref ref-type="bibr" rid="hanspub.44786-ref4">4</xref>]，其一般变化形式为：</p><p>y ( λ ) = { ln y , λ = 0 y λ − 1 λ , λ ≠ 0</p><p>其中 y ( λ ) 表示变换后得到的新变量，y表示原始连续变量， λ 表示变换参数，Box-Cox变换要求原始变量y取值为正。经检查存在3个倾斜的数值型变量，使用Box-Cox变换将其进行转化，如图1为房屋面积转化前分布图和P-P图，图2为房屋面积转化后分布图和P-P图。</p><p>图1. 原始数据分布</p><p>图2. 转换后数据分布</p></sec></sec></sec><sec id="s7"><title>3. 随机森林模型</title><p>随机森林是一种集成算法，既可以应用于分类问题也可以应用于回归问题，对于分类问题就是以少数服从多数的原则，将多颗决策树结果作为最终判断样本的类别；对于回归问题，样本最后的预测结果为多颗树的结果求平均值 [<xref ref-type="bibr" rid="hanspub.44786-ref5">5</xref>]。由于被解释变量单位面积房屋价格为连续型的数值，因此本文选择建立随机森林回归模型。由于计算量巨大，本文使用Python中的软件包RandomForestRegressor实现基于随机森林回归模型的二手房样本训练。</p><sec id="s7_1"><title>3.1. 相关参数的设置</title><p>使用python拟合随机森林回归模型时，主要调整的参数有随机森林所包含的决策树的个数(n_estimators)、决策树的最大深度(max_depth)、决策树根节点或中间节点能够继续分割的最小样本量(min_samples_split)、决策树叶节点的最小样本量(min_samples_leaf)。通过10重交叉验证的网格搜索，得到单棵回归决策树的最佳参数组合为max_depth = 19，min_samples_leaf = 2，min_samples_split = 2，最后通过手动调参确定随机森林是决策树个数n_estimators = 500，在测试集上得到的RMSE为129.528，结果较为理想。</p></sec><sec id="s7_2"><title>3.2. 模型评估</title><p>对模型的评估选择均方根误差RMSE和拟合优度R<sup>2</sup>两种指标，均方根误差RMSE对模型的预测效果做定量的统计值，有关计算公式如下：</p><p>RMSE = MSE = ∑ i = 1 n ( y i − y ⌢ i ) 2 n</p><p>其中n表示预测的样本量， y i 表示被解释变量的真实值， y ⌢ i 表示被解释变量的预测值。MSE或RMSE越小，说明模型对数据的拟合效果越好。拟合优度R<sup>2</sup>是指对观测值的拟合程度，计算公式如下：</p><p>R 2 = 1 − ∑ i ( y ⌢ i − y i ) 2 ∑ i ( y ⌢ i − y i 2 ) = 1 − ∑ i ( y ⌢ i − y i ) 2 / n ∑ i ( y ⌢ i − y i 2 ) / n = 1 − MSE ( y ⌢ , y ) var ( y ) ,</p><p>R<sup>2</sup>最大值为1，R<sup>2</sup>值越接近1，说明对数据的拟合效果越好。</p><p>将数据集按照8:2的比例划分训练集与测试集，经过调整参数之后在训练集上对模型进行训练，再将划分出来的19,269条测试集上的样本对二手房价格进行预测，预测结果如表1所示，模型在训练集和测试集上的评分如表2所示，由于测试集上的样本量非常多，因此表1仅选择20条进行展示，其中</p><p>匹 配 度 = y ⌢ i y i</p><p>反映了预测值( y ⌢ i )与真实值( y i )之间的匹配情况。</p><p>绝 对 误 差 = | y i − y ⌢ i |</p><p>反映了预测值( y ⌢ i )与真实值之间的实际误差。从表1可以看到匹配度的取值在0.9~1.01之间，预测的效果较好。表2是分别在训练集与测试集上的均方根误差与拟合优度，从表2中可以看到测试集上的拟合优度为0.99867，非常接近1，说明建立的随机森林回归模型能较好挖掘训练集上各特征与被解释变量之间的关系并将其很好的拓展到了测试集样本上。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Prediction results of random forest for test set</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >序号</th><th align="center" valign="middle" >实际成交价格(元/平方米)</th><th align="center" valign="middle" >预测价格(元/平方米)</th><th align="center" valign="middle" >匹配度</th><th align="center" valign="middle" >绝对误差</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >13,691.778276</td><td align="center" valign="middle" >13,693.030860</td><td align="center" valign="middle" >0.999909</td><td align="center" valign="middle" >1.252584</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >11,602.208059</td><td align="center" valign="middle" >11,584.158416</td><td align="center" valign="middle" >1.001558</td><td align="center" valign="middle" >18.049643</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >16,346.193633</td><td align="center" valign="middle" >16,390.281527</td><td align="center" valign="middle" >0.997310</td><td align="center" valign="middle" >44.087894</td></tr><tr><td align="center" valign="middle" >4</td><td align="center" valign="middle" >18,376.614015</td><td align="center" valign="middle" >18,348.623853</td><td align="center" valign="middle" >1.001525</td><td align="center" valign="middle" >27.990162</td></tr><tr><td align="center" valign="middle" >5</td><td align="center" valign="middle" >10,127.140774</td><td align="center" valign="middle" >10,135.135135</td><td align="center" valign="middle" >0.999211</td><td align="center" valign="middle" >7.994361</td></tr><tr><td align="center" valign="middle" >6</td><td align="center" valign="middle" >8589.388164</td><td align="center" valign="middle" >8603.104213</td><td align="center" valign="middle" >0.998406</td><td align="center" valign="middle" >13.716048</td></tr><tr><td align="center" valign="middle" >7</td><td align="center" valign="middle" >12,306.071281</td><td align="center" valign="middle" >12,291.666667</td><td align="center" valign="middle" >1.001172</td><td align="center" valign="middle" >14.404615</td></tr><tr><td align="center" valign="middle" >8</td><td align="center" valign="middle" >11,376.689881</td><td align="center" valign="middle" >11,372.549020</td><td align="center" valign="middle" >1.000364</td><td align="center" valign="middle" >4.140862</td></tr><tr><td align="center" valign="middle" >9</td><td align="center" valign="middle" >8008.016621</td><td align="center" valign="middle" >7936.507937</td><td align="center" valign="middle" >1.009010</td><td align="center" valign="middle" >71.508684</td></tr><tr><td align="center" valign="middle" >10</td><td align="center" valign="middle" >9774.693376</td><td align="center" valign="middle" >9805.903761</td><td align="center" valign="middle" >0.996817</td><td align="center" valign="middle" >31.210385</td></tr><tr><td align="center" valign="middle" >11</td><td align="center" valign="middle" >10,208.107475</td><td align="center" valign="middle" >10,203.090079</td><td align="center" valign="middle" >1.000492</td><td align="center" valign="middle" >5.017397</td></tr><tr><td align="center" valign="middle" >12</td><td align="center" valign="middle" >5132.411203</td><td align="center" valign="middle" >5173.865961</td><td align="center" valign="middle" >0.991988</td><td align="center" valign="middle" >41.454758</td></tr><tr><td align="center" valign="middle" >13</td><td align="center" valign="middle" >18,377.892153</td><td align="center" valign="middle" >18,419.556566</td><td align="center" valign="middle" >0.997738</td><td align="center" valign="middle" >41.664414</td></tr><tr><td align="center" valign="middle" >14</td><td align="center" valign="middle" >16,432.492217</td><td align="center" valign="middle" >16,437.355412</td><td align="center" valign="middle" >0.999704</td><td align="center" valign="middle" >4.863195</td></tr><tr><td align="center" valign="middle" >15</td><td align="center" valign="middle" >12,817.450620</td><td align="center" valign="middle" >12,813.852814</td><td align="center" valign="middle" >1.000281</td><td align="center" valign="middle" >3.597806</td></tr><tr><td align="center" valign="middle" >17</td><td align="center" valign="middle" >14,924.811060</td><td align="center" valign="middle" >14,917.127072</td><td align="center" valign="middle" >1.000515</td><td align="center" valign="middle" >7.683988</td></tr><tr><td align="center" valign="middle" >18</td><td align="center" valign="middle" >13,545.043557</td><td align="center" valign="middle" >13,542.688911</td><td align="center" valign="middle" >1.000174</td><td align="center" valign="middle" >2.354647</td></tr><tr><td align="center" valign="middle" >19</td><td align="center" valign="middle" >18,054.235728</td><td align="center" valign="middle" >18,040.435459</td><td align="center" valign="middle" >1.000765</td><td align="center" valign="middle" >13.800269</td></tr><tr><td align="center" valign="middle" >20</td><td align="center" valign="middle" >13,586.196783</td><td align="center" valign="middle" >13,584.905660</td><td align="center" valign="middle" >1.000095</td><td align="center" valign="middle" >1.291123</td></tr></tbody></table></table-wrap><p>表1. 随机森林对测试集的预测结果</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Test set and training set score compariso</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >RMSE</th><th align="center" valign="middle" >R<sup>2</sup></th></tr></thead><tr><td align="center" valign="middle" >训练集</td><td align="center" valign="middle" >57.91881</td><td align="center" valign="middle" >0.99973</td></tr><tr><td align="center" valign="middle" >测试集</td><td align="center" valign="middle" >129.52823</td><td align="center" valign="middle" >0.99869</td></tr></tbody></table></table-wrap><p>表2. 训练集与测试集评分对比</p></sec></sec><sec id="s8"><title>4. 不同算法实例比较</title><p>对重庆市九大主城区二手房数据集同时使用岭回归模型、Lasso回归模型 [<xref ref-type="bibr" rid="hanspub.44786-ref6">6</xref>] 以及单个回归决策树模型，并与随机森林回归模型进行对比。各个模型在测试集上的表现如表3所示，从表3可以看到，在对测试集上的样本进行预测时，岭回归和Lasso回归RMSE略大于随机森林，回归决策树相对较好，但都不如随机森林算法。</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> RMSE and R2 of each model on the test se</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >模型</th><th align="center" valign="middle" >RMSE</th><th align="center" valign="middle" >R<sup>2</sup></th></tr></thead><tr><td align="center" valign="middle" >岭回归</td><td align="center" valign="middle" >655.54513</td><td align="center" valign="middle" >0.966597</td></tr><tr><td align="center" valign="middle" >Lasso</td><td align="center" valign="middle" >658.21433</td><td align="center" valign="middle" >0.966325</td></tr><tr><td align="center" valign="middle" >回归决策树</td><td align="center" valign="middle" >251.25072</td><td align="center" valign="middle" >0.995093</td></tr><tr><td align="center" valign="middle" >随机森林</td><td align="center" valign="middle" >129.52823</td><td align="center" valign="middle" >0.998696</td></tr></tbody></table></table-wrap><p>表3. 各模型在测试集上的RMSE和R<sup>2</sup></p></sec><sec id="s9"><title>5. 结束语</title><p>本文以重庆市九大主城区二手房价格预测为基础，使用岭回归、Lasso回归、回归决策树和随机森林，经实验证明，随机森林回归算法在测试集上取得的RMSE最小，R<sup>2</sup>最大，说明集成算法相较于传统的回归模型具有一定的优越性，基于二手房价格建立的随机森林回归模型可以推广应用到其他住宅价格预测中去，得到的房价预测具有一定的指导意义。</p></sec><sec id="s10"><title>文章引用</title><p>康嘉玲. 基于随机森林模型的重庆市二手房价格预测研究Research on Price Prediction of Second-Hand Housing in Chongqing Based on Random Forest Model[J]. 应用数学进展, 2021, 10(08): 2862-2867. https://doi.org/10.12677/AAM.2021.108298</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.44786-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">曾婷婷. 基于机器学习的房价预测模型研究[D]: [硕士学位论文]. 绵阳: 西南科技大学, 2020.</mixed-citation></ref><ref id="hanspub.44786-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">李宇琪. 基于随机森林的房价预测模型[J]. 通讯世界, 2018(9): 306-308.</mixed-citation></ref><ref id="hanspub.44786-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">陈奕佳. 基于随机森林理论的北京市二手房估价模型研究[D]: [硕士学位论文]. 北京: 北京交通大学, 2015.</mixed-citation></ref><ref id="hanspub.44786-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">张家棋, 杜金. 基于XGBoost与多种机器学习方法的房价预测模型[J]. 现代信息科技, 2020, 4(10): 15-18.</mixed-citation></ref><ref id="hanspub.44786-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">张倩. 基于随机森林回归模型的住房租金预测模型的研究[D]: [硕士学位论文]. 长春: 东北师范大学, 2019.</mixed-citation></ref><ref id="hanspub.44786-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">时文静. 基于Lasso与数据挖掘方法的影响北京二手房价格的因素分析[D]: [硕士学位论文]. 北京: 北京工业大学, 2017.</mixed-citation></ref></ref-list></back></article>