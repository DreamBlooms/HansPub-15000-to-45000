<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2017.76073</article-id><article-id pub-id-type="publisher-id">CSA-21177</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20170600000_87236198.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于Retinex理论的草地图像增强算法研究
  Research on Grassland Image Enhancement Algorithm Based on Retinex Theory
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>卫光</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>洋</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>中原工学院，计算机学院，河南 郑州</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>14</day><month>06</month><year>2017</year></pub-date><volume>07</volume><issue>06</issue><fpage>632</fpage><lpage>637</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   为了解决室外环境中由于光照不均或者大雾天气下，草地图像模糊不清，不能有效的识别和提取草地图像重要信息的问题，本文提出一种专门针对草地图像的图像增强算法。本文基于传统的Retinex理论，用小波变换的方法拆分图像的高频分量和低频分量分别进行处理，之后再将处理结果融合重构。实验结果表明，相比传统的MSRCR算法和直方图均衡化方法，本文的算法提高了图像清晰度并且有效的抑制了图像处理时产生的噪声。 The article proposes a kind of image enhancement algorithm for lawn image, in order to solve the problem that lawn image is so blurred due to uneven illumination or heavy fog weather that it can’t identify and extract the important information effectively in outdoor environments. This paper uses wavelet transform method based on the traditional Retinex theory. It split the high frequency component and low frequency component then deal with them separately. Finally, the results are fused and reconstructed. Experimental results show that the algorithm of this paper provides the image’s definition and controls noise in image processing when it compared with traditional MSRCR algorithm and histogram equalization algorithm.
    
  
 
</p></abstract><kwd-group><kwd>图像增强，Retinex理论，MSRCR算法, Image Enhancement</kwd><kwd> Retinex Theory</kwd><kwd> MSRCR Algorithm</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于Retinex理论的草地图像增强算法研究<sup> </sup></title><p>刘卫光，李洋</p><p>中原工学院，计算机学院，河南 郑州</p><p>收稿日期：2017年6月7日；录用日期：2017年6月25日；发布日期：2017年6月28日</p><disp-formula id="hanspub.21177-formula81"><graphic xlink:href="http://html.hanspub.org/file/14-1540789x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为了解决室外环境中由于光照不均或者大雾天气下，草地图像模糊不清，不能有效的识别和提取草地图像重要信息的问题，本文提出一种专门针对草地图像的图像增强算法。本文基于传统的Retinex理论，用小波变换的方法拆分图像的高频分量和低频分量分别进行处理，之后再将处理结果融合重构。实验结果表明，相比传统的MSRCR算法和直方图均衡化方法，本文的算法提高了图像清晰度并且有效的抑制了图像处理时产生的噪声。</p><p>关键词 :图像增强，Retinex理论，MSRCR算法</p><disp-formula id="hanspub.21177-formula82"><graphic xlink:href="http://html.hanspub.org/file/14-1540789x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>图像是客观对象的一种相似性描述，但是在拍摄过程中，由于光照、气候等因素影响，往往造成图像的失真或者产生噪声。图像增强能在保留图像自身信息的同时突出某些特征信息，从而满足应用需求 [<xref ref-type="bibr" rid="hanspub.21177-ref1">1</xref>] 。本文所设计的算法策略主要应用于智能割草机器人关于采集的草地图像预处理，由于割草机器人的工作环境所致，拍摄的图片会经常受到光照不均和大雾天气的影响。针对光照和大雾的影响，常见的图像增强算法主要有直方图均衡化方法，Retinex算法，梯度域增强算法等 [<xref ref-type="bibr" rid="hanspub.21177-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.21177-ref3">3</xref>] 。</p><p>传统的图像增强算法，如直方图均衡化主要是通过对图像的非线性拉伸，使图像动态范围增大，对比度也增大，但是这些传统的方法多应用于灰度图像 [<xref ref-type="bibr" rid="hanspub.21177-ref4">4</xref>] 。随着人们视觉感知模型的发展，Retinex理论也随之建立，经过40多年的发展，从最开始的单尺度Retinex算法(SSR算法)发展到多尺度加权平均Retinex算法(MSR算法)再到彩色恢复Retinex算法(MSRCR算法)。</p><p>MSRCR算法虽然能突出图像的细节部分，但也存在着缺陷，比如如果输入图像质量不高，噪声也会随着细节的突出而放大；处理完的图像会整体偏暗变灰等等 [<xref ref-type="bibr" rid="hanspub.21177-ref5">5</xref>] 。为了解决这些问题，本文提出一种分别对高频分量和低频分量处理的办法，既能抑制高频的噪声放大，同时又增加低频分量的对比度，使图像清晰度增强。</p></sec><sec id="s4"><title>2. 理论背景</title><sec id="s4_1"><title>2.1. 小波变换</title><p>小波变换是一种新的变换方法，它继承和发展了短时傅里叶变换的局部化思想，又克服了窗口大小不能随频率变换的缺点 [<xref ref-type="bibr" rid="hanspub.21177-ref6">6</xref>] 。设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x9_hanspub.png" xlink:type="simple"/></inline-formula>为基本小波，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x10_hanspub.png" xlink:type="simple"/></inline-formula>为连续小波，对于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x11_hanspub.png" xlink:type="simple"/></inline-formula>，其连续小波变换为：</p><disp-formula id="hanspub.21177-formula83"><label>(2.1.1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/14-1540789x12_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，a不为0，b, t均为连续变量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x13_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x14_hanspub.png" xlink:type="simple"/></inline-formula>的复共轭。其逆变换为：</p><disp-formula id="hanspub.21177-formula84"><label>(2.1.2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/14-1540789x15_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s4_2"><title>2.2. MSRCR算法</title><p>Retinex理论认为物体的颜色不是由反射光的强度而是由不同频率的光的反射能力所决定的，所以光照不均会影响物体颜色的一致性 [<xref ref-type="bibr" rid="hanspub.21177-ref7">7</xref>] 。所以，基于Retinex理论的算法其本质就是通过估计并去除图像照度分量来获取反应图像本质信息的反射分量，来还原物体本来的面貌 [<xref ref-type="bibr" rid="hanspub.21177-ref8">8</xref>] 。Retinex理论认为，图像模型应该是：</p><disp-formula id="hanspub.21177-formula85"><label>(2.2.1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/14-1540789x16_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x17_hanspub.png" xlink:type="simple"/></inline-formula>是原始图像，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x18_hanspub.png" xlink:type="simple"/></inline-formula>是反射分量，反射主要包含物体轮廓，纹理等高频信息，大多数的去噪算法都是针对这个反射分量进行处理。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x19_hanspub.png" xlink:type="simple"/></inline-formula>是光照分量，主要包含环境光照强度等低频信息，大多数的去雾算法都是针对这个分量展开，目的是使得低频信息对比度增强，使图像更加清晰。</p><p>为了便于计算，通常对上面的公式进行取对数运算，变为：</p><disp-formula id="hanspub.21177-formula86"><label>(2.2.2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/14-1540789x20_hanspub.png"  xlink:type="simple"/></disp-formula><p>随着Retinex理论的发展，为了解决对某些图片处理完色彩失真的问题，研究者们提出了彩色恢复Retinex算法(Multi Scale Retinex with Color Restoration, MSRCR)，其表达式如下：</p><disp-formula id="hanspub.21177-formula87"><label>(2.2.3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/14-1540789x21_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x22_hanspub.png" xlink:type="simple"/></inline-formula>用来调节三个颜色通道颜色比例的色彩恢复函数，默认每个颜色所占比重都是1/3。其具体实现MATLAB代码部分如下(以R通道为例)：</p><p>Img = double(f);</p><p>[m, n] = size(f);</p><p>aa = 125;</p><p>for i = 1:m</p><p>for j = 1:n</p><p>C(i, j) = log(1 + aa * (Img(i, j)/I(i, j)));</p><p>end</p><p>end</p><p>K = imfilter(Img, b);</p><p>KK = imfilter(Img, bb);</p><p>KKK = imfilter(Img, bbb);</p><p>for i = 1:m</p><p>for j = 1:n</p><p>G(i, j) = 1/3 * (log(Img(i, j) + 1) − log(K(i, j) + 1));</p><p>G(i, j) = 1/3 * (log(Img(i, j) + 1) − log(KK(i, j) + 1)) + G(i, j);</p><p>G(i, j) = C(i, j) * (1/3 * (log(Img(i, j) + 1) − log(KKK(i, j) + 1)) + G(i, j));</p><p>end</p><p>end</p></sec><sec id="s4_3"><title>2.3. 均值滤波</title><p>均值滤波也称为线性滤波，采用的主要方法是邻域平均法，即用均值代替原图像的各个像素值。这种滤波方法非常简单易实现，但是会损失较多细节，不过基于草坪图像没有那么复杂的信息，所以对图像的高频分量用均值滤波的办法处理 [<xref ref-type="bibr" rid="hanspub.21177-ref9">9</xref>] 。在坐标点(x, y)大小为m * n的矩形窗口<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x23_hanspub.png" xlink:type="simple"/></inline-formula>，算术平均值是窗口<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/14-1540789x24_hanspub.png" xlink:type="simple"/></inline-formula>中被干扰图像g(x, y)的平均值，数学表达式如下：</p><disp-formula id="hanspub.21177-formula88"><label>(2.3.1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/14-1540789x25_hanspub.png"  xlink:type="simple"/></disp-formula><p>逆谐波均值滤波器表达式如下：</p><disp-formula id="hanspub.21177-formula89"><label>(2.3.2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/14-1540789x26_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，Q为滤波器的介绍，当Q为正数时，可以消除椒噪声；当Q为负数时，可以消除盐噪声。</p></sec></sec><sec id="s5"><title>3. 本文算法设计</title><p>本文针对草地图像的增强算法整体设计流程如图1所示。</p><p>因为草坪环境是室外环境，所以容易受到光照，天气等因素的影响，为了后续方便对草地图像进行分割、提取等操作，有必要对草地图像进行预处理。本文基于此需求，设计了这样一套预处理算法策略：先对拍摄的原始图像进行小波变换分解，抓取到图像中的高频分量和低频分量。针对高频分量，采取均值滤波的办法去除噪声；对于低频分量部分，采用MSRCR算法增强图像信息对比度，突出主要信息。在实际做实验的过程中，发现处理的效果不错，但是本文算法也有明显的不足，即MSRCR是对每个颜色通道分别处理再叠加，因此时间复杂度也相应的提高了。</p><p>基于时间复杂度的考虑并且针对算法目的，我们可以只对G通道进行卷积运算，R通道和B通道取得反射信息后直接输出即可。这样输出的图像虽然突兀，但是也能有效的去除草地上的雾气等，能为后续草坪边缘的识别提供保障。</p><p>图1. 本文算法整体流程图</p></sec><sec id="s6"><title>4. 实验与分析</title><p>本文所做的实验都是在win7 64位操作系统下，在MATLAB环境里进行测试，对比直方图均衡化方法和传统的自适应图像增强算法，对比结果如下图所示。</p><p>图2是带雾的而且光照条件也不相同的2幅草坪图像；图3是用直方图均衡化的方法进行处理后的结果；图4是用自适应增强算法处理后的结果；图5是本文的算法处理后的结果。通过观察可以发现，直方图均衡化算法处理后的图失真比较严重。图4是自适应增强算法，可以看到处理效果相对比较好，但是时间花费较长，每次运行时间大约是43 ms。图5是本文算法，处理近景的效果比较理想，但是远景对比度还是不太好，每次运行时间大约为27 ms。峰值信噪比(PSNR)和均方误差(MSE)是评价图像质量的两个客观标准 [<xref ref-type="bibr" rid="hanspub.21177-ref10">10</xref>] ，PSNR表示信号最大可能功率和影响它的表示精度的破坏性噪声功率之间的比值，单位是dB，它的比值越大代表失真越少，而MSE越小，则代表预测模型有更好的精确度。选取第一幅图像作为参照，四种算法对比如表1所示。</p><p>图2. 原始图像</p><p>图3. 直方图均衡化</p><p>图4. 自适应增强算法</p><p>图5. 本文算法</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> PSNR values and MSE values for various enhancement algorithm</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >原始图像</th><th align="center" valign="middle" >直方图均衡化</th><th align="center" valign="middle" >自适应增强算法</th><th align="center" valign="middle" >本文算法</th></tr></thead><tr><td align="center" valign="middle" >PSNR/dB</td><td align="center" valign="middle" >25.4</td><td align="center" valign="middle" >27.1</td><td align="center" valign="middle" >26.9</td></tr><tr><td align="center" valign="middle" >MSE</td><td align="center" valign="middle" >107.6</td><td align="center" valign="middle" >97.2</td><td align="center" valign="middle" >81.4</td></tr></tbody></table></table-wrap><p>表1. 各种增强算法的PSNR和MSE</p></sec><sec id="s7"><title>5. 结束语</title><p>Retinex是一种建立在科学实验基础上的理论，本文为了能保证突出草地图像在各种天气和时间段内的重要图像信息，采用了以Retinex理论为基础的算法设计。通过实验发现，在大多数情况下，都可以对草地图像的重要信息进行强化。相比于其他方法，本文算法对草地图像的处理结果更好。但是本文在某些方面的问题还没有得到解决：远景雾气不能完全消除；处理后的图像整体发灰。</p></sec><sec id="s8"><title>基金项目</title><p>本文得到国家自然科学基金项目支持，No.U1404606，基于概率图模型的图像分割方法研究；本文得到河南省科技攻关项目支持No.152102210360，深度学习在视觉目标检测中的关键技术研究；No.172102210070，基于机器视觉和无线定位技术的割草机器人模型研究。</p></sec><sec id="s9"><title>文章引用</title><p>刘卫光,李 洋. 基于Retinex理论的草地图像增强算法研究Research on Grassland Image Enhancement Algorithm Based on Retinex Theory[J]. 计算机科学与应用, 2017, 07(06): 632-637. http://dx.doi.org/10.12677/CSA.2017.76073</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.21177-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Kim, S., Kang, W., Lee, E., et al. (2010) Wavelet-Domain Color Image Enhancement Using Filtered Directional Bases and Fre-quency-Adaptive Shrinkage. IEEE Transactions on Consumer Electronics, 56, 1063-1070.</mixed-citation></ref><ref id="hanspub.21177-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">梁琳, 何卫平, 雷蕾, 等. 光照不均图像增强方法综述[J]. 计算机应用研究, 2010, 27(5): 1625-1628.</mixed-citation></ref><ref id="hanspub.21177-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">李菊霞, 余雪丽. 雾天条件下的多尺度Retinex图像增强算法[J]. 计算机科学, 2013, 40(3): 299-301.</mixed-citation></ref><ref id="hanspub.21177-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">周海珍, 熊登峰. 关于直方图均衡化算法在图像灰度处理中的应用研究[J]. 科技创新与应用, 2015(32): 51-52.</mixed-citation></ref><ref id="hanspub.21177-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">常戬, 白佳弘. 基于回转对称双边滤波的Retinex图像增强算法[J]. 计算机工程, 2016, 42(6): 265-273.</mixed-citation></ref><ref id="hanspub.21177-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">刘涛. 小波变换技术概述[J]. 中国新技术新产品, 2010(22): 33-33.</mixed-citation></ref><ref id="hanspub.21177-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">李垚峰, 何小海, 吴小强. 改进的带色彩恢复的多尺度Retinex雾天图像增强算法[J]. 计算机应用, 2014, 34(10): 2996-2999.</mixed-citation></ref><ref id="hanspub.21177-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Nicholls, S.J., Sipahi, I., Schoenhagen, P., et al. (2006) Application of Intravascular Ultrasound in Anti-Atherosclerotic Drug Development. Nature Reviews Drug Discovery, 5, 485.</mixed-citation></ref><ref id="hanspub.21177-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">舒志龙, 阮秋琦. 一种二维均值滤波快速算法及其应用[J]. 北京交通大学学报, 2001, 25(2): 22-24.</mixed-citation></ref><ref id="hanspub.21177-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">朱亚辉, 彭国华. 基于多尺度PSNR的图像融合评价算法[J]. 计算机应用研究, 2012, 29(7): 2784-2786.</mixed-citation></ref></ref-list></back></article>