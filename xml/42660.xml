<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2021.115152</article-id><article-id pub-id-type="publisher-id">CSA-42660</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20210500000_67532752.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  改进的成对预测误差扩展可逆数据隐藏算法
  Improved Reversible Data Hiding Algorithm for Pairwise Prediction Error Expansion
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>思雨</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杜</surname><given-names>玲</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>天津工业大学计算机科学与技术学院，天津</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>08</day><month>05</month><year>2021</year></pub-date><volume>11</volume><issue>05</issue><fpage>1484</fpage><lpage>1495</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   基于成对预测误差扩展是目前一种大容量低失真的可逆数据隐藏技术。误差扩展算法通过生成二维预测误差直方图确定最优扩展路径以完成自适应地修改。中值边缘检测器和菱形预测的方法只考虑了部分被测像素周围的相邻像素，本文考虑了被测像素周围的八个像素值，更好地利用了图像像素之间的相关性，并在此基础上，更精确地区分像素局部区域纹理度的高低，来实现选择像素值的精确度。所提方法在嵌入相同容量的秘密信息时，图像的失真度都优于现有算法，具有更好的视觉质量。 Expansion based on pairwise prediction errors is currently a reversible data hiding technology with large capacity and low distortion. The error expansion algorithm determines the optimal expansion path by generating a two-dimensional prediction error histogram to complete the adaptive modifi-cation. The median edge detector and diamond prediction method only considers the neighboring pixels around part of the measured pixel. This article considers the eight pixel values around the measured pixel, which makes better use of the correlation between image pixels, and on this basis, the level of texture in the local area of the pixel is more accurately distinguished to achieve the accuracy of the pixel value selection. When the proposed method embeds the same capacity of secret information, the distortion of the image is better than that of the existing algorithm, and it has better visual quality. 
  
 
</p></abstract><kwd-group><kwd>成对预测误差扩展，可逆数据隐藏，二维预测误差直方图, Pairwise Prediction Error Expansion</kwd><kwd> Reversible Data Hiding</kwd><kwd> Two-Dimensional Prediction Error Histogram</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>基于成对预测误差扩展是目前一种大容量低失真的可逆数据隐藏技术。误差扩展算法通过生成二维预测误差直方图确定最优扩展路径以完成自适应地修改。中值边缘检测器和菱形预测的方法只考虑了部分被测像素周围的相邻像素，本文考虑了被测像素周围的八个像素值，更好地利用了图像像素之间的相关性，并在此基础上，更精确地区分像素局部区域纹理度的高低，来实现选择像素值的精确度。所提方法在嵌入相同容量的秘密信息时，图像的失真度都优于现有算法，具有更好的视觉质量。</p></sec><sec id="s2"><title>关键词</title><p>成对预测误差扩展，可逆数据隐藏，二维预测误差直方图</p></sec><sec id="s3"><title>Improved Reversible Data Hiding Algorithm for Pairwise Prediction Error Expansion</title><p>Siyu Li, Ling Du</p><p>School of Computer Science and Technology, Tiangong University, Tianjin</p><p><img src="//html.hanspub.org/file/29-1542188x4_hanspub.png" /></p><p>Received: Apr. 25<sup>th</sup>, 2021; accepted: May 20<sup>th</sup>, 2021; published: May 27<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/29-1542188x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>Expansion based on pairwise prediction errors is currently a reversible data hiding technology with large capacity and low distortion. The error expansion algorithm determines the optimal expansion path by generating a two-dimensional prediction error histogram to complete the adaptive modification. The median edge detector and diamond prediction method only considers the neighboring pixels around part of the measured pixel. This article considers the eight pixel values around the measured pixel, which makes better use of the correlation between image pixels, and on this basis, the level of texture in the local area of the pixel is more accurately distinguished to achieve the accuracy of the pixel value selection. When the proposed method embeds the same capacity of secret information, the distortion of the image is better than that of the existing algorithm, and it has better visual quality.</p><p>Keywords:Pairwise Prediction Error Expansion, Reversible Data Hiding, Two-Dimensional Prediction Error Histogram</p><disp-formula id="hanspub.42660-formula59"><graphic xlink:href="//html.hanspub.org/file/29-1542188x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/29-1542188x7_hanspub.png" /> <img src="//html.hanspub.org/file/29-1542188x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>传统的信息隐藏方法 [<xref ref-type="bibr" rid="hanspub.42660-ref1">1</xref>] 在使用过程中会出现载体信息丢失的情况，攻击者 [<xref ref-type="bibr" rid="hanspub.42660-ref2">2</xref>] 对秘密信息的盗取和恶意篡改等行为也会使得秘密信息被泄露。因此可逆信息隐藏 [<xref ref-type="bibr" rid="hanspub.42660-ref3">3</xref>] 成为了近年来研究的热点。可逆数据隐藏技术将隐藏数据以某种算法嵌入到公开的载体图像中进行秘密地传输。接收方可以根据嵌入算法的逆过程来获得之前隐藏的数据，并且无失真地恢复原来的载体图像 [<xref ref-type="bibr" rid="hanspub.42660-ref4">4</xref>]。由于可逆数据隐藏技术具有可逆性 [<xref ref-type="bibr" rid="hanspub.42660-ref5">5</xref>] 和保密性 [<xref ref-type="bibr" rid="hanspub.42660-ref6">6</xref>]，被广泛地应用在医疗和军事等领域。在实际应用中需要大容量 [<xref ref-type="bibr" rid="hanspub.42660-ref7">7</xref>] 地嵌入秘密信息，而大容量地嵌入秘密信息往往会造成图像失真度低。因此，目前研究的关键问题在于如何尽可能地平衡好嵌入秘密信息的大小和图像失真度 [<xref ref-type="bibr" rid="hanspub.42660-ref8">8</xref>] 两者之间的关系。</p><p>目前的文献中提出了很多可逆的数据隐藏技术。2003年，Tian等人 [<xref ref-type="bibr" rid="hanspub.42660-ref9">9</xref>] 提出了一种基于差值扩展的可逆数据隐藏方法。该算法将秘密信息嵌入到相邻像素对的差值中，但嵌入容量不足以满足需要。随后，为了增大嵌入容量，Celik [<xref ref-type="bibr" rid="hanspub.42660-ref10">10</xref>] 等人提出了最低有效位压缩方法，通过压缩辅助信息来提高嵌入秘密信息的容量。然而，由于其采用无损压缩的方法，当嵌入容量过大时会造成图像的峰值信噪比(PSNR)急剧下降。后来，Ni等人 [<xref ref-type="bibr" rid="hanspub.42660-ref11">11</xref>] 最先提出了基于直方图修改的可逆数据隐藏的方法。该方法提高了图像的失真度，但由于采用基于图像像素生成直方图的峰值进行数据嵌入，从而使其嵌入容量有限。Lee [<xref ref-type="bibr" rid="hanspub.42660-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.42660-ref13">13</xref>] 等人提出了基于差分直方图平移的方法，由于在直方图中差值的峰值最高，以此获得更大的冗余空间。Xuan等人提出用四个阈值来辅助秘密信息进行双层嵌入，增加了嵌入容量。Ou等人提出了成对预测误差扩展的方法，通过在固定的像素值上嵌入秘密信息，提升了图像的质量。Xiao等人提出了动态规划算法，缩短了算法运行时间。</p><p>本文对Xiao等人的方法进行了改进，提出了一种更多考虑到图像内容和像素之间相关性的方法，主要贡献如下：</p><p>1) 提出了一种全新的全封闭预测方法。结合了先前工作中的MED (中值边缘检测器预测器)和菱形预测方法的优点，充分利用了被测像素值周围的相邻像素，得出更为精确的预测值，为嵌入秘密信息时选择嵌入像素值的位置提高了准确率，更进一步提高了嵌入后图像的视觉质量。</p><p>2) 提出了一种基于全封闭预测方法的计算像素局部区域纹理度高低的方法，3 &#215; 3的像素可以被分成上下两部分，每部分分别计算相邻像素和被测像素差的绝对值之和，再将这两部分计算的值相加，在计算的过程中，充分考虑了像素内容，更为精确地区分像素局部区域的纹理度高低，进一步提高了选择嵌入像素的精度，从而改善可逆信息隐藏的失真度。</p><p>3) 实验结果表明，所提方法在嵌入大量的秘密信息时，图像具有较高的峰值信噪比，更好地平衡了嵌入容量和图像质量之间的矛盾。</p></sec><sec id="s6"><title>2. 相关工作</title><sec id="s6_1"><title>2.1. 传统的预测误差扩展(C-PEE)</title><p>Wang等人的工作提出了传统预测误差扩展的可逆数据隐藏方案。通过修改预测误差，来进行秘密数据的嵌入，该方法可以将有效载荷嵌入到具有高标记图像质量的图像中，但是嵌入容量较少，图像的失真度也很高。现在我们将简要介绍这种方法。为了清晰地表示，只给出了基于直方图平移的嵌入阶段。首先，生成预测误差直方图。对于原图像I，将像素按照特定的顺序扫描(从左上角以光栅扫描方式扫描原图像I，不包括最右列和最后一行)得到的像素序列可以表示为 ( x 1 , ⋯ , x n ) ，其中，x<sub>1</sub>是被扫描的第一个像素值，N是所有被扫描图像的总数。中值边缘检测器预测方法 [<xref ref-type="bibr" rid="hanspub.42660-ref14">14</xref>] 来预测每一个像素值，像素预测值为 x ^ i ，用原来的像素值减去像素的预测值，就是预测误差，公式如下：</p><p>e i = x i − x ^ i</p><p>MED预测方法依赖于被测像素值的右边、下边和斜对角的像素值如图1所示。</p><p>图1. 被测像素的上下文</p><p>MED预测方法需要用特定的顺序将原始图像进行扫描，利用被测像素值的右边、下边和斜对角的像素值进行预测，像素预测值被表示如下：</p><p>x ^ i = { min ( u , v ) , if   w ≥ max ( u , v ) max ( u , v ) , if   w ≤ min ( u , v ) u + v − w , otherwise</p><p>其中， min ( u , v ) 和 max ( u , v ) 分别表示计算u和v时的较大和较小的函数。被测像素值x的预测结果为 x ^ i ，用被测像素的像值减去预测值，就可以得到预测误差，从而获得预测误差序列 ( e 1 , ⋯ , e n ) ，将预测误差进行统计生成预测误差直方图 [<xref ref-type="bibr" rid="hanspub.42660-ref15">15</xref>]。</p><p>对预测误差直方图进行修改，传统的预测误差扩展修改包括以下几个步骤：</p><p>e ˜ i = { e i + m , if   e i = 0 e i − m , if   e i = − 1 e i + 1 , if   e i &gt; 0 e i − 1 , if   e i &lt; 0</p><p>其中，m表示要嵌入的秘密信息位， m ∈ ( 0 , 1 ) 。当预测误差为0或−1时，修改预测误差直方图，在预测误差为0或者−1时嵌入秘密信息；预测误差大于0或者小于−1时，将预测误差直方图向前或者向后移动一个扩展箱的位置，以便腾出更多的空间保证数据嵌入的可逆性。原图像素在嵌入秘密信息后像素值就表示为 x ˜ i = x ^ i + e ˜ i ，也就是像素预测值与嵌入秘密信息之后的预测误差之和。</p><p>在图2中表示出了用于传统预测误差扩展的图示。图2中表示出了传统预测误差扩展的扩展箱的位置变化过程 [<xref ref-type="bibr" rid="hanspub.42660-ref16">16</xref>]，其中红色扩展项(预测误差为−1和0)被嵌入数据而绿色扩展箱(预测误差大于0或者小于−1)进行了移动。</p><p>图2. 关于传统预测误差扩展的方法</p><p>传统预测误差扩展的提取过程是嵌入秘密信息的逆过程，提取和图像恢复过程总结如下。首先，得到嵌入秘密信息之后的预测误差，然后，原始图像的像素预测误差表示为</p><p>e i = { e ˜ i , if   e ˜ i ∈ { − 1 , 0 } e ˜ i − 1 , if   e ˜ i &gt; 0 e ˜ i + 1 , if   e ˜ i &lt; 0</p><p>最后，图像像素恢复为 x i = x ^ i + e i 。</p></sec><sec id="s6_2"><title>2.2. 自适应嵌入和最佳预测误差选择相结合的预测误差扩展</title><p>针对传统预测误差进行改进，其中有自适应嵌入的预测误差扩展方法 [<xref ref-type="bibr" rid="hanspub.42660-ref17">17</xref>] 和最佳预测误差选择的预测误差扩展方法，将这两种方法结合起来就是这部分要进行描述得方法(AO-PEE)。</p><p>首先是自适应嵌入策略，为了更好地利用图像的冗余，提出了复杂度度量n<sub>i</sub>，并且，只有当n<sub>i</sub> &lt; T时嵌入的那一部分可以用来嵌入秘密信息，T是预先选择的阈值且T &gt; 0。这相当于，对于每个像素(n<sub>i</sub> &lt; T)时，将根据传统预测误差扩展方法的嵌入程序进行处理。否则，也就是n<sub>i</sub> ≥ T，像素会被忽略，值保持不变。在这种方法中，是影响嵌入性能的重要因素。为了更好地利用平滑像素，T被当作最小的正整数，这样有效载荷就可以被成功嵌入。将有效载荷嵌入后，阈值的选取从0开始，每次值增加1，直到找到最优的图像质量，那么相对应的T便是要确定的阈值。</p><p>复杂度测量是计算每个像素差异的平均值，即</p><p>n i = | u − v | + | v − w | + | w − u | 3</p><p>其次，最佳预测误差的选择需要考虑满足以下要求的特定的预测误差直方图，假定嵌入容量为。在这种情况下，将嵌入失真的期望值范数可以表示为</p><p>E ( ‖ I ˜ − I ‖ 2 2 ) = ∑ i = 1 N E ( ( x ˜ i − x i ) 2 ) = 1 2 ( h ( − 1 ) + h ( 0 ) ) + ∑ e ∉ { − 1 , 0 } h ( e ) = N − H</p><p>其中，I和 I ˜ 分别用来表示原图像和嵌入秘密信息之后的图像，由于被嵌入像素不一定要在预测误差为−1和0的像素上，对于这种特定的预测误差直方图，可以选择预测误差 [<xref ref-type="bibr" rid="hanspub.42660-ref18">18</xref>] 为−1和1的像素上嵌入秘密信息，预测误差为0的像素保持不变。那么嵌入失真的期望值发生了变化从N − H和N − 2H。如图3所示：</p><p>图3. 关于自适应预测误差扩展的方法</p><p>这一发现表明可以通过改变预测误差的选择来增加秘密信息的嵌入容量。基于此，发现对于给定的嵌入容量，可以选择两个预测误差满足a，a和b的具体数值可以通过重复嵌入来决定最佳的预测误差。由于a和b的变动，嵌入秘密信息像素的预测误差变为</p><p>e ˜ i = { e i , if   a &lt; e i &lt; b e i + m , if   e i = b e i − m , if   e i = a e i + 1 , if   e i &lt; b e i − 1 , if   e i &lt; a</p><p>将这两个改进结合起来就是这部分要描述的AO-PEE，AO-PEE需要确定三个参数：复杂度阈值T，扩展箱(a, b)。T是最小的正整数，对于给定的(a, b)，重复嵌入秘密信息的步骤来收集(a, b)，当嵌入失真最小时，相对应的参数便是要找的最佳参数。通过这两方面的改进，AO-PEE的性能得到了提高。</p></sec></sec><sec id="s7"><title>3. 本文方法</title><sec id="s7_1"><title>3.1. 全封闭的预测方法</title><p>本文采用了全封闭的预测方法，和目前常用的MED预测方法和菱形预测方法相比有些许不同，目前工作中的MED预测方法和菱形预测方法的优点，充分利用了被测像素值周围的相邻像素，得出更为精确的预测值，为嵌入秘密信息时选择嵌入像素值的位置提高了准确率，更进一步提高了嵌入后图像的视觉质量。根据整体的算法来选取合适的预测方法，合适的预测方法可以去掉原始图像像素间大部分相关的信息，从而使得预测误差分布集中在0附近，由预测误差生成的直方图从最中间向两侧递减，这样尖锐的直方图可以提高算法的性能。本文采用了一种基于全封闭预测方法的计算像素局部区域纹理度高低的方法，3 &#215; 3的像素可以被分成上下两部分，每部分分别计算相邻像素和被测像素差的绝对值之和，再将这两部分计算的值相加，在计算的过程中，充分考虑了像素内容，更为精确地区分像素局部区域的纹理度高低，进一步提高了选择嵌入像素的精度，从而改善可逆信息隐藏的失真度。图4表示各像素之间的位置关系。</p><p>自然图像中，像素值间存在着很强的相似性，相邻像素的相似度随着像素距离的增加而逐渐减小，邻近像素在统计意义上应有最强的相关性，当前像素通过其邻近像素来预测的准确度也应最高。相比之前的MED方法考虑了被测像素相邻的三个像素，如图1所示。菱形预测方法考虑了被测像素周围相邻的四个像素值。本文所提出的全封闭的预测方法考虑到了被测像素周围所有相邻的像素值，更好地利用了像素之间的相关性，为选择被嵌像素提高了准确性。像素值x是要进行预测的像素，将周围相邻的像素分别用八个像素来进行表示 { x 1 , x 2 , x 3 , x 4 , x 5 , x 6 , x 7 , x 8 } ，这八个像素值的平均值就是像素x的预测值，如图4所示：</p><p>图4. 全封闭预测方法</p><p>基于成对预测误差扩展嵌入数据的可逆数据隐藏方法，将要移动的像素分为可嵌入像素和不可嵌入像素两大类。可嵌入像素通过修改预测误差值来嵌入秘密信息；但是，不可嵌入像素不仅没有携带秘密信息，而且还需要进行移位。为了提高算法的嵌入容量，通常希望最大化可嵌入像素的数量，同时最小化那些不可嵌入的像素。那么，进行判断的前提首先要有一个精确的像素预测值，因为无论是后续的计算误差能量估计的方法需要用到像素预测值，而且误差能量估计方法的计算直接影响到了我们对目前像素值它是否可以进行嵌入像素的判断，减少不可嵌入像素的数量。</p></sec><sec id="s7_2"><title>3.2. 误差能量估计</title><p>对于大多数自然图像，预测误差在当前处理像素周围的区域具有很强的相关性。现有的方法未能全面的依赖图像内容，可以进一步利用这种相关性和尽可能多的依赖于图像的内容来消除可能不可以嵌入的预测误差 [<xref ref-type="bibr" rid="hanspub.42660-ref19">19</xref>]。误差能量估计计算如下：</p><p>Δ = d h + d v</p><p>d h = | x 2 − x | + | x 4 − x | + | x 7 − x | + | x 5 − x |</p><p>d v = | x 1 − x | + | x 3 − x | + | x 6 − x | + | x 8 − x |</p><p>这里需要注意x的下标表示的是当前处理像素的上下文位置如图3所示。</p><p>一旦得到误差能量Δ的估计值，可以基于Δ将预测误差分类为可嵌入和不可嵌入的误差。Δ的值较大表明相应的预测误差也较大，很可能是不能嵌入的预测误差。因此，在可以嵌入所有秘密信息的前提下，需要尽可能地选择较小的误差能量，来获得最好的图像质量。也就是说，要尽可能地选择在相对平滑的区域里嵌入秘密信息 [<xref ref-type="bibr" rid="hanspub.42660-ref20">20</xref>]，相对粗糙的区域保持不变。</p></sec><sec id="s7_3"><title>3.3. 嵌入过程</title><p>在这一节中，将详细描述秘密信息嵌入的过程，图像恢复和提取 [<xref ref-type="bibr" rid="hanspub.42660-ref21">21</xref>] 的过程是嵌入的逆过程，就不详细描述了。</p><p>因为二维预测误差直方图比一维预测误差直方图可以更好地反映图像数据中的复杂依赖性，因此利用二维预测误差直方图是有价值的。在这项工作中，基于二维预测误差直方图的修改策略称为双向预测误差扩展，其中通过扩展和转移直方图的预测误差来实现数据嵌入。成对PEE比传统的PEE在高维空间中可以更自然延伸。事实上，合理的直方图修改策略有助于提高可逆数据隐藏的性能。</p><p>基于成对预测误差的算法第一步需要先将预测误差进行成对匹配，然后再根据嵌入策略嵌入秘密信息。首先，按照特定的序列扫描图像(第一行像素除外)，将扫描像素收集成一维序列，按照3.1的方法计算像素的预测误差，将预测误差采用全封闭的预测方法，得到像素预测值，根据公式计算预测误差，生成预测误差系列 ( e 1 , ⋯ e n ) ，将它转化成新的序列 ( e 1 , ⋯ e n / 2 ) ，选取的成对预测误差就是其中的 e i = ( e 2 i − 1 , e 2 i ) 。接下来对于像素选择策略而言。只有误差能量小于预设的阈值T的预测误差选择生成二维预测误差直方图，其次，构造溢出位置图数据嵌入后像素的灰度值可能超出范围。为了防止这种情况，对图像进行预处理，将这些像素值调整到一个可靠的范围。由于方法中对每个像素值的修改最多为1，所以只需要按以下方式调整边缘值像素。像素值是255的话，将修改为254；如果是0，就修改为1。并且，每个修改后的像素在位置图中标记为1，而其他像素标记为0。然后对位置图进行无损压缩 [<xref ref-type="bibr" rid="hanspub.42660-ref22">22</xref>]，进一步减小其大小。</p><p>二维预测误差直方图的划分是根据成对的预测误差生成二维预测误差直方图，以第一象限为例。首先，直方图可以分成三个部分，如图5所示，以对角线的坐标点为分界线，对角线的坐标点为一部分，还有对角线上下两部分一共三部分。通过2D-PEH划分，坐标变换三角形区域转换为矩形。在图7的左图中显示了第一象限中的2D-PEH划分，并且对于右下三角形区域(绿点)，该区域中的每个 ( x , y ) 都被转换为 ( x ′ , y ′ ) 为将对角线上下两部分进行变换公式如下：</p><p>{ x ′ = x − y − 1 y ′ = y − b</p><p>图5. 区域划分</p><p>在成对预测误差扩展生成的坐标系中，找到一条最佳的路径来进行数据的嵌入。给定(n, m)，通过公式来确定最佳扩展路径。其中，P (n, m)表示在(0, 0)开始和在(n, m)结束的路径，q是给定的容量， b ∈ { 0 , 1 , 2 , 3 } ，n = 7， 0 ≤ m ≤ 7。</p><p>需要根据在划分的直方图中确定的最佳路径，可以将坐标系的象限分成两部分，最佳路径上边部分的预测误差进行嵌入而且只进行向上嵌入秘密信息，最佳路径下边部分的预测误差只向右嵌入秘密信息，最佳路径以外的不做任何变化。嵌入的时候采用双层嵌入，将图像分为阴影和空白两部分，如图6所示，这里详细描述空白部分的嵌入过程，空白部分嵌入完成后，再进行阴影部分的嵌入，直到所有的秘密信息都嵌入。</p><p>图6. 阴影和空白部分</p><p>为了更好地提取和恢复图像，辅助信息和压缩溢出位置图也需要进行嵌入，辅助信息包括：</p><p>1) 参数b (2位)、T (2位)、m (2位)</p><p>2) 最优扩展路径P (7, m) (m + 7位)</p><p>3) 压缩溢出位置图的长度(18位)</p><p>4) 压缩溢出位置图</p><p>5) 最后修改像素对的嵌入位置(16位)</p><p>在方法中，将这辅助信息依次嵌入到原图像素第一行的最低有效位中，在数据提取时首先提取。第一行像素被替换的LSB [<xref ref-type="bibr" rid="hanspub.42660-ref23">23</xref>] 和利用霍夫曼编码压缩的位置图将作为有效载荷的一部分嵌入到原图图像中。也就是说，嵌入的有效负载包括三个部分：替换的LSB、压缩的位置图和秘密消息。</p></sec></sec><sec id="s8"><title>4. 实验结果</title><p>在这一节中，通过与传统的预测误差扩展、Sachnev等人 [<xref ref-type="bibr" rid="hanspub.42660-ref24">24</xref>] 的方法、Ou等人的方法 [<xref ref-type="bibr" rid="hanspub.42660-ref25">25</xref>] 和Xiao [<xref ref-type="bibr" rid="hanspub.42660-ref26">26</xref>] 等人最近提出的成对预测误差扩展方案进行比较，来评估方法的嵌入性能。使用标准格式为JEPG的大小的灰度图像进行比较，包括Lena、Baboon、Barbara、Airplane、Elaine、Lake、Boat、和Peppers八张图片，从USC-SIPI图像数据库中下载得到的。根据一些实验数据，可以看出，在各种容量下，所提出的方法优于三种比较方法。更具体地说，表1和表2给出了用于这四种方法的嵌入容量为10,000位和20,000位的峰值信噪比。</p><p>从表1中可以看出所提出的方法，除了较为平滑的图像Airplane和目前的方法相比峰值信噪比几乎相似外，其他的图像峰值信噪比有了显著提高，平均增加了0.82 db。表2显示出当嵌入秘密信息的大小为20,000位时，峰值信噪比平均增加了1.25 db。从表2中发现，本文所提出的方法对图像较为粗糙和嵌入容量较大时，图像嵌入之后的视觉质量更好。图像较为平滑的，性能提高不是很明显。图7和图8是嵌入20,000位时，选取了Pepper、Baboon、Lena、Lake原图和嵌入之后的图像对比。可以看出嵌入之后的图像和原图像几乎无差别。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> When embedding 10,000 bits, the proposed method compares the peak signal-to-noise ratio with the method of Ou et al</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Image</th><th align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.42660-ref24">24</xref>]</th><th align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.42660-ref25">25</xref>]</th><th align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.42660-ref26">26</xref>]</th><th align="center" valign="middle" >proposed</th></tr></thead><tr><td align="center" valign="middle" >Lena</td><td align="center" valign="middle" >58.22</td><td align="center" valign="middle" >59.75</td><td align="center" valign="middle" >60.91</td><td align="center" valign="middle" >61.04</td></tr><tr><td align="center" valign="middle" >Baboon</td><td align="center" valign="middle" >54.14</td><td align="center" valign="middle" >55.22</td><td align="center" valign="middle" >56.23</td><td align="center" valign="middle" >56.30</td></tr><tr><td align="center" valign="middle" >Barbara</td><td align="center" valign="middle" >58.14</td><td align="center" valign="middle" >59.44</td><td align="center" valign="middle" >61.37</td><td align="center" valign="middle" >62.17</td></tr><tr><td align="center" valign="middle" >Airplane</td><td align="center" valign="middle" >60.48</td><td align="center" valign="middle" >63.76</td><td align="center" valign="middle" >64.08</td><td align="center" valign="middle" >64.12</td></tr><tr><td align="center" valign="middle" >Elaine</td><td align="center" valign="middle" >56.15</td><td align="center" valign="middle" >58.06</td><td align="center" valign="middle" >58.88</td><td align="center" valign="middle" >60.29</td></tr><tr><td align="center" valign="middle" >Lake</td><td align="center" valign="middle" >56.67</td><td align="center" valign="middle" >58.72</td><td align="center" valign="middle" >59.87</td><td align="center" valign="middle" >61.33</td></tr><tr><td align="center" valign="middle" >Boat</td><td align="center" valign="middle" >56.14</td><td align="center" valign="middle" >57.55</td><td align="center" valign="middle" >58.31</td><td align="center" valign="middle" >58.71</td></tr><tr><td align="center" valign="middle" >Peppers</td><td align="center" valign="middle" >55.57</td><td align="center" valign="middle" >56.21</td><td align="center" valign="middle" >58.73</td><td align="center" valign="middle" >61.00</td></tr><tr><td align="center" valign="middle" >Average</td><td align="center" valign="middle" >56.94</td><td align="center" valign="middle" >58.59</td><td align="center" valign="middle" >59.80</td><td align="center" valign="middle" >60.62</td></tr></tbody></table></table-wrap><p>表1. 嵌入10,000位时，所提出的方法与Ou等人的方法比较峰值信噪比</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> When embedding 20,000 bits, the proposed method compares the peak signal-to-noise ratio with the method of Ou et al</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Image</th><th align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.42660-ref24">24</xref>]</th><th align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.42660-ref25">25</xref>]</th><th align="center" valign="middle" >[<xref ref-type="bibr" rid="hanspub.42660-ref26">26</xref>]</th><th align="center" valign="middle" >proposed</th></tr></thead><tr><td align="center" valign="middle" >Lena</td><td align="center" valign="middle" >55.04</td><td align="center" valign="middle" >56.29</td><td align="center" valign="middle" >57.32</td><td align="center" valign="middle" >58.47</td></tr><tr><td align="center" valign="middle" >Baboon</td><td align="center" valign="middle" >49.38</td><td align="center" valign="middle" >50.11</td><td align="center" valign="middle" >50.45</td><td align="center" valign="middle" >50.52</td></tr><tr><td align="center" valign="middle" >Barbara</td><td align="center" valign="middle" >55.05</td><td align="center" valign="middle" >56.25</td><td align="center" valign="middle" >57.72</td><td align="center" valign="middle" >58.83</td></tr><tr><td align="center" valign="middle" >Airplane</td><td align="center" valign="middle" >57.33</td><td align="center" valign="middle" >60.21</td><td align="center" valign="middle" >60.47</td><td align="center" valign="middle" >61.04</td></tr><tr><td align="center" valign="middle" >Elaine</td><td align="center" valign="middle" >52.00</td><td align="center" valign="middle" >52.91</td><td align="center" valign="middle" >53.68</td><td align="center" valign="middle" >55.11</td></tr><tr><td align="center" valign="middle" >Lake</td><td align="center" valign="middle" >52.72</td><td align="center" valign="middle" >53.79</td><td align="center" valign="middle" >54.57</td><td align="center" valign="middle" >56.98</td></tr><tr><td align="center" valign="middle" >Boat</td><td align="center" valign="middle" >52.64</td><td align="center" valign="middle" >53.32</td><td align="center" valign="middle" >54.11</td><td align="center" valign="middle" >55.31</td></tr><tr><td align="center" valign="middle" >Peppers</td><td align="center" valign="middle" >52.31</td><td align="center" valign="middle" >52.83</td><td align="center" valign="middle" >54.99</td><td align="center" valign="middle" >57.03</td></tr><tr><td align="center" valign="middle" >Average</td><td align="center" valign="middle" >53.31</td><td align="center" valign="middle" >54.46</td><td align="center" valign="middle" >55.41</td><td align="center" valign="middle" >56.66</td></tr></tbody></table></table-wrap><p>表2. 嵌入20,000位时，所提出的方法与Ou等人的方法比较峰值信噪比</p><p>图7. Baboon、Peppers、Lena、Lake的原图</p><p>图8. 嵌入20,000位之后的Baboon、Peppers、Lena、Lake的图片</p><p>图9. Hu的方法、Xiao的方法、本文提出的方法分别在不同的图片上作性能比较</p><p>对于Xiao等人基于成对预测扩展的方法，我们的算法是对他们工作的直接改进。在图9中可以观察到，除了粗糙的图像Baboon之外，可以为每个图像提供一个更大的PSNR，无论EC是什么。Sachnev等人的方法是基于PEE结合嵌入位置选择策略。对于该方法，使用四个相邻像素的整数平均值来预测像素值。此外，使用排序技术基于局部方差的大小记录预测误差，一个像素如果其局部有较小的方差，则应预先嵌入该方法性能良好，优于一些典型的RDH方案。经过实验证明，在大多数情况下，的方法比这种性能良好的方法要好。然而，对于一些图像，当EC接近其最大值时(例如，当EC大于10,000位时，对于图像Baboon，当EC大于47,000位时，对于Airplane)，Sachnev等人的方法可以实现更大的PSNR。原因是，在这种情况下，由于EC是高的，不能很好地利用像素相关性的优势。此外，在这种情况下，光滑的图像是不够的，必须使用粗糙的图像来嵌入数据。这也不利于嵌入性能。但是，对于中等程度的EC，我们的方法更好。参考表1，我们的方法将Sachnev等人的EC提高了3.68 dB。</p></sec><sec id="s9"><title>5. 实验结果</title><p>本文提出了一种改进的基于2D-PEH成对嵌入的预测误差扩展的可逆数据隐藏方案，作为成对预测误差扩展方法(Xiao)的改进。通过紧密联系被测像素之间的相关性，考虑了一种全新的全封闭式的预测方法，提高了选择嵌入像素的准确性。此外，本文更多地依赖于图像的内容，提出了误差能量估计算法，可以避免可能不可以进行嵌入的预测误差。并且给出了实验结果，证明了该方案在容量失真性能方面的优越性。该方法的主要优点是在粗糙图像上和嵌入大容量时有显著提高。然而，对于较为平滑的图像提高不是很明显，因为在较为平滑的图像上先前的算法对像素选择上和所提出的算法基本相同。而粗糙的图像比先前的算法在像素选择上提高了准确率。最后，在未来工作的一个可能方向是提高平滑图像上的图像质量。</p></sec><sec id="s10"><title>文章引用</title><p>李思雨,杜 玲. 改进的成对预测误差扩展可逆数据隐藏算法Improved Reversible Data Hiding Algorithm for Pairwise Prediction Error Expansion[J]. 计算机科学与应用, 2021, 11(05): 1484-1495. https://doi.org/10.12677/CSA.2021.115152</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.42660-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Zhou, X. and Chen, J.-G. (2006) Information Hiding Based on Double-Random Phase Encoding Technology. Journal of Modern Optics, 53, 1777-1783. &lt;br&gt;https://doi.org/10.1080/09500340600624189</mixed-citation></ref><ref id="hanspub.42660-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Luo, S., Liu, J., Xu, W., Lu, W., Fang, Y., Zeng, J. and Shi, S. (2021) Upscaling Factor Estimation on Pre-JPEG Compressed Images Based on Differ-ence Histogram of Spectral Peaks. Signal Processing: Image Communication, 94, 116223. &lt;br&gt;https://doi.org/10.1016/j.image.2021.116223</mixed-citation></ref><ref id="hanspub.42660-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Sahu, A.K. and Swain, G. (2020) Reversible Image Steganogra-phy Using Dual-Layer LSB Matching. Sensing and Imaging, 21, Article No. 1. &lt;br&gt;https://doi.org/10.1007/s11220-019-0262-y</mixed-citation></ref><ref id="hanspub.42660-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Shi, Y., Li, X., Zhang, X., Wu, H. and Ma, B. (2016) Reversible Data Hiding: Advances in the Past Two Decades. IEEE Access, 4, 3210-3237. &lt;br&gt;https://doi.org/10.1109/ACCESS.2016.2573308</mixed-citation></ref><ref id="hanspub.42660-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Regeena Jeppiaar, M. (2015) A Prediction Based Reversible Image Steganographic Algorithm for JPEG Images. Journal of Applied Security Research, 10, 362-374. &lt;br&gt;https://doi.org/10.1080/19361610.2015.1038766</mixed-citation></ref><ref id="hanspub.42660-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Shiu, H., Lin, B.-S., Huang, C.-H., Chiang, P.-Y. and Lei, C.-L. (2017) Preserving Privacy of Online Digital Physiological Signals Using Blind and Reversible Steganography. Computer Methods and Programs in Biomedicine, 151, 159-170. &lt;br&gt;https://doi.org/10.1016/j.cmpb.2017.08.015</mixed-citation></ref><ref id="hanspub.42660-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Liu, H.-H. and Lee, C.-M. (2019) High-Capacity Reversible Im-age Steganography Based on Pixel Value Ordering. EURASIP Journal on Image and Video Processing, 2019, Article No. 54. &lt;br&gt;https://doi.org/10.1186/s13640-019-0458-z</mixed-citation></ref><ref id="hanspub.42660-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Kamal, A.H.M. and Islam, M.M. (2018) An Image Distor-tion-Based Enhanced Embedding Scheme. Iran Journal of Computer Science, 1, 175-186. &lt;br&gt;https://doi.org/10.1007/s42044-018-0016-3</mixed-citation></ref><ref id="hanspub.42660-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Tian, J. (2003) Reversible Data Embedding Using a Difference Expansion. IEEE Transactions on Circuits &amp; Systems for Video Technology, 13, 890-896. &lt;br&gt;https://doi.org/10.1109/TCSVT.2003.815962</mixed-citation></ref><ref id="hanspub.42660-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Celik, M.U., Sharma, G., Tekalp, A.M. and Saber, E. (2005) Lossless Generalized-LSB Data Embedding. IEEE Transactions on Image Processing, 12, 253-266. &lt;br&gt;https://doi.org/10.1109/TIP.2004.840686</mixed-citation></ref><ref id="hanspub.42660-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Ni, Z., Shi, Y.Q., Ansari, N. and Su, W. (2006) Reversible Data Hiding. IEEE Transactions on Circuits &amp; Systems for Video Technology, 16, 354-362. &lt;br&gt;https://doi.org/10.1109/TCSVT.2006.869964</mixed-citation></ref><ref id="hanspub.42660-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Lee, C.-F., Wang, K.-H., Chang, C.-C. and Huang, Y.-L. (2009) A Reversible Data Hiding Scheme Based on Dual Steganographic Images. Proceedings of the 3rd International Confer-ence on Ubiquitous Information Management and Communication, February 2009, 228-237. &lt;br&gt;https://doi.org/10.1145/1516241.1516281</mixed-citation></ref><ref id="hanspub.42660-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Lee, C.-F., Chang, C.-C., Pai, P.-Y. and Liu, C.-M.. (2015) An Adjustable and Reversible Data Hiding Method Based on Multiple-Base Notational System without Location Map. Journal of Information Hiding and Multimedia Signal Processing, 6, 1-28.</mixed-citation></ref><ref id="hanspub.42660-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">He, W., Xiong, G., Weng, S., Cai, Z. and Wang, Y. (2018) Reversible Data Hiding Using Multi-Pass Pixel-Value-Ordering and Pairwise Prediction-Error Expansion. Information Sciences, 467, 784-799.  
&lt;br&gt;https://doi.org/10.1016/j.ins.2018.04.088</mixed-citation></ref><ref id="hanspub.42660-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Kukreja, S., Kasana, G. and Kasana, S.S. (2019) Adaptive Reversi-ble Data Hiding Scheme for Digital Images Based on Histogram Shifting. Computing and Informatics, 38, 321-342. &lt;br&gt;https://doi.org/10.31577/cai_2019_2_321</mixed-citation></ref><ref id="hanspub.42660-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Wang, W., Ye, J., Wang, T. and Wang, W. (2018) A High Capacity Reversible Data Hiding Scheme Based on Right-Left Shift. Signal Processing, 150, 102-115. &lt;br&gt;https://doi.org/10.1016/j.sigpro.2018.04.008</mixed-citation></ref><ref id="hanspub.42660-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Kukreja, S., Kasana, G. and Kasana, S.S. (2019) Adaptive Re-versible Data Hiding Scheme for Digital Images Based on Histogram Shifting. Computing and Informatics, 38, 321-342. &lt;br&gt;https://doi.org/10.31577/cai_2019_2_321</mixed-citation></ref><ref id="hanspub.42660-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Caciula, I., Coanda, H.G. and Coltuc, D. (2018) Multiple Moduli Prediction Error Expansion Reversible Data Hiding. Signal Processing: Image Communication, 71, 120-127. &lt;br&gt;https://doi.org/10.1016/j.image.2018.11.005</mixed-citation></ref><ref id="hanspub.42660-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Vo, P.-H., Nguyen, T.-S., Huynh, V.-T. and Do, T.-N. (2018) A Novel Reversible Data Hiding Scheme with Two-Dimensional Histogram Shifting Mechanism. Multimedia Tools and Applications, 77, 28777-28797.  
&lt;br&gt;https://doi.org/10.1007/s11042-018-5991-8</mixed-citation></ref><ref id="hanspub.42660-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Di, F., Zhang, M., Zhang, Y. and Liu, J. (2018) Reversible Data Hiding for Encrypted Image Based on Interpolation Error Expansion. International Journal of Mobile Computing and Multimedia Communications (IJMCMC), 9, Article 5.  
&lt;br&gt;https://doi.org/10.4018/IJMCMC.2018100105</mixed-citation></ref><ref id="hanspub.42660-ref21"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Chang, K.-C. (2018) Efficient Lossless Watermarking Algo-rithm Using Gradient Sorting and Selective Embedding. Multimedia Tools and Applications, 77, 23579-23606. &lt;br&gt;https://doi.org/10.1007/s11042-017-5547-3</mixed-citation></ref><ref id="hanspub.42660-ref22"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">Abbasi, R., Xu, L., Amin, F. and Luo, B. (2019) Efficient Loss-less Compression Based Reversible Data Hiding Using Multilayered n-Bit Localization. Security and Communication Networks, 2019, Article ID: 8981240.  
&lt;br&gt;https://doi.org/10.1155/2019/8981240</mixed-citation></ref><ref id="hanspub.42660-ref23"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Chen, K. and Chang, C.-C. (2019) Real-Time Error-Free Reversible Data Hiding in Encrypted Images Using (7, 4) Hamming Code and Most Significant Bit Prediction. Symmetry, 11, 51. &lt;br&gt;https://doi.org/10.3390/sym11010051</mixed-citation></ref><ref id="hanspub.42660-ref24"><label>24</label><mixed-citation publication-type="other" xlink:type="simple">Sachnev, V., Kim, H.J., Nam, J., et al. (2009) Reversible Watermarking Algorithm Using Sorting and Prediction. IEEE Transactions on Circuits and Systems for Video Technology, 19, 989-999.  
&lt;br&gt;https://doi.org/10.1109/TCSVT.2009.2020257</mixed-citation></ref><ref id="hanspub.42660-ref25"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Ou, B., Li, X., Zhao, Y., Ni, R. and Shi, Y. (2013) Pairwise Prediction-Error Expansion for Efficient Reversible Data Hiding. IEEE Transactions on Image Processing, 22, 5010-5021. &lt;br&gt;https://doi.org/10.1109/TIP.2013.2281422</mixed-citation></ref><ref id="hanspub.42660-ref26"><label>26</label><mixed-citation publication-type="other" xlink:type="simple">Xiao, M., Li, X., Wang, Y., et al. (2019) Reversible Data Hiding Based on Pairwise Embedding and Optimal Expansion path. Signal Processing, 158, 210-218. &lt;br&gt;https://doi.org/10.1016/j.sigpro.2019.01.008</mixed-citation></ref></ref-list></back></article>