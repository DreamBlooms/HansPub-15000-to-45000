<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2017.66093</article-id><article-id pub-id-type="publisher-id">AAM-22152</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20170600000_88863621.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于HMM-GARCH模型的VaR方法及其在农业股市的应用
  VaR Method Based on HMM-GARCH Model and Its Application in Agricultural Stock Market
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>容</surname><given-names>兰兰</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>爽</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>冯</surname><given-names>茹</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>河北工业大学理学院，天津</addr-line></aff><aff id="aff3"><addr-line>北京石油化工学院数理系，北京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>953537932@qq.com(容兰)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>19</day><month>09</month><year>2017</year></pub-date><volume>06</volume><issue>06</issue><fpage>768</fpage><lpage>780</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  文章利用隐马尔科夫模型在状态划分上的优势，将隐马尔科夫模型(HMM)与GARCH模型结合建立HMM-GARCH模型来度量金融资产风险价值(VaR)｡首先对收益率序列建立隐马尔科夫模型，将股票市场分为正常状态与异常状态，用Baum-Welch算法估算模型的参数，再采用Viterbi算法估算收益率序列所对应的隐状态序列，根据隐状态序列将收益率序列分为两类，分别建立HMM-GARCH模型估算VaR｡最后利用GARCH模型､MRS-GARCH模型､HMM-GARCH模型对北大荒股票(600598)数据进行了实证分析，采用Kupiec-失败频率检验法对估计的VaR值进行检验｡实证结果表明，基于HMM-GARCH模型的VaR方法能更好的描绘和预测该股票的风险｡
   In this paper, the HMM and GARCH models are used to establish the HMM-GARCH model to measure the financial asset risk value (VaR) by using the advantage of the hidden Markov model in state division. First, the hidden Markov model of the financial asset return sequence is set up. The Baum-Welch algorithm is used to estimate the parameters of the model. Then, the Viterbi algorithm is used to estimate the corresponding hidden state sequence of the return sequence. According to the hidden state sequence, the return sequence is classified in two categories. And the HMM-GARCH model is established to estimate VaR for each state sequence respectively. Finally, the Beidahuang stock (600598) data are analyzed by using the GARCH model, MRS-GARCH model and HMM-GARCH model respectively. The accuracy of the VaR is tested by Kupiec failure frequency method. The results show that the HMM-GARCH model can better describe and predict the risk of the stock.
 
</p></abstract><kwd-group><kwd>HMM-GARCH模型，MRS-GARCH模型，VaR方法，Kupiec-失败频率检验法, HMM-GARCH Model</kwd><kwd> MRS-GARCH Model</kwd><kwd> VaR Method</kwd><kwd> Kupiec Failure Frequency Test</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于HMM-GARCH模型的VaR方法 及其在农业股市的应用<sup> </sup></title><p>容兰兰<sup>1</sup>，陈爽<sup>2</sup>，冯茹<sup>1</sup></p><p><sup>1</sup>河北工业大学理学院，天津</p><p><sup>2</sup>北京石油化工学院数理系，北京</p><p>收稿日期：2017年9月5日；录用日期：2017年9月20日；发布日期：2017年9月26日</p><disp-formula id="hanspub.22152-formula29"><graphic xlink:href="//html.hanspub.org/file/7-2620474x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>文章利用隐马尔科夫模型在状态划分上的优势，将隐马尔科夫模型(HMM)与GARCH模型结合建立HMM-GARCH模型来度量金融资产风险价值(VaR)｡首先对收益率序列建立隐马尔科夫模型，将股票市场分为正常状态与异常状态，用Baum-Welch算法估算模型的参数，再采用Viterbi算法估算收益率序列所对应的隐状态序列，根据隐状态序列将收益率序列分为两类，分别建立HMM-GARCH模型估算VaR｡最后利用GARCH模型､MRS-GARCH模型､HMM-GARCH模型对北大荒股票(600598)数据进行了实证分析，采用Kupiec-失败频率检验法对估计的VaR值进行检验｡实证结果表明，基于HMM-GARCH模型的VaR方法能更好的描绘和预测该股票的风险｡</p><p>关键词 :HMM-GARCH模型，MRS-GARCH模型，VaR方法，Kupiec-失败频率检验法</p><disp-formula id="hanspub.22152-formula30"><graphic xlink:href="//html.hanspub.org/file/7-2620474x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>自从2008年金融危机爆发以来，广大投资者和研究者都希望金融市场能具有提醒投资者和管理者抵抗非预期风险的能力。随着我国资本市场的进一步开放，我国的金融机构面临的风险将更加复杂，金融市场管理、金融监管原则和技术都要和国际接轨 [<xref ref-type="bibr" rid="hanspub.22152-ref1">1</xref>] 。VaR方法作为国际上衡量金融风险的领先技术，必将给我国的风险管理工作带来一定的借鉴，在风险管理的实践中产生很大的现实意义。</p><p>1994年JP Morgan公布了Riskmetrics体系，对VaR模型的原理和计算方法进行了系统的总结，由于VaR计算简单，易于理解及其合理性，很快受到推崇和研究。Riskmetrics在第一版技术文件中对VaR的原理做了详细的阐述，包括历史模拟法、参数法、蒙特卡罗模拟法等具体模型原理的说明 [<xref ref-type="bibr" rid="hanspub.22152-ref2">2</xref>] ；在第二版技术文件中，对非线性期权头寸的风险计量方法与如何处理实际分布的非正态性进行了补充 [<xref ref-type="bibr" rid="hanspub.22152-ref3">3</xref>] ；后又分别对理论界与实务界提出的问题与建议进行了研究和改进工作 [<xref ref-type="bibr" rid="hanspub.22152-ref4">4</xref>] 。2001年，巴塞罗那委员会正式指定VaR方法作为银行风险度量的标准。新Basle协议依据VaR方法对跨国银行的市场风险提出了具体的监管措施，使VaR方法成为金融风险管理的国际标准和理论基础。Zhang等在研究投资组合风险时，引入连接函数(Copula)方法，并与历史模拟法、均值-方差法、DCC-GARCH方法进行了比较 [<xref ref-type="bibr" rid="hanspub.22152-ref5">5</xref>] 。Foroni在混合频率VaR中引入状态转换方法和马尔科夫模型，提出了MSMF-VaR，通过实证表明在国民生产总值和经济预测方面效果较好 [<xref ref-type="bibr" rid="hanspub.22152-ref6">6</xref>] 。Marcucci通过比较不同的GARCH模型在持有期为一天到一个月内对股市波动率的预测能力，发现在短于一星期的持有期内，具有马尔科夫结构转换的GARCH模型(MRS-GARCH模型)比单一结构的GARCH模型对股市的VaR的估计效果更准确 [<xref ref-type="bibr" rid="hanspub.22152-ref7">7</xref>] 。</p><p>国内对VaR方法的研究起步较晚，最早研究是郑文通的《金融风险管理的VaR方法及其应用》。我国许多学者主要应用波动模型来描述金融市场的波动性，估计VaR值，对我国的金融市场风险进行深入分析。主要采用的波动模型包括GARCH模型、EGARCH模型、MRS-GARCH模型等 [<xref ref-type="bibr" rid="hanspub.22152-ref8">8</xref>] 。范英通过对VaR方法的深入研究，并对股票市场在不同置信水平下的风险值得实例计算，表明将VaR方法用于我国股票市场的投资风险分析是可行的 [<xref ref-type="bibr" rid="hanspub.22152-ref9">9</xref>] 。魏捷等以我国上证指数为例探讨了用GARCH模型计算VaR的新方法 [<xref ref-type="bibr" rid="hanspub.22152-ref10">10</xref>] 。郭名媛和张世英提出了基于MRS-GARCH模型的VaR方法，并对上海股票市场的风险进行了实证分析，结论证明MRS-GARCH模型计算VaR值更加有效 [<xref ref-type="bibr" rid="hanspub.22152-ref11">11</xref>] 。罗健英等针对中国钢铁期货市场波动率具有的结构突变特征，使用MRS-GARCH模型对其波动率建模，实证结果表明基于MRS-GARCH模型下的VaR方法能够有效地测度出钢铁期货市场的风险变化 [<xref ref-type="bibr" rid="hanspub.22152-ref12">12</xref>] 。</p><p>这些模型大都没有考虑波动结构变化，MRS-GARCH模型考虑了结构波动变化，在一定程度上可以对波动率结构发生突变前后的不同状态进行建模，从而得到不同状态下的定量模型，但是MRS-GARCH模型在进行参数估计时需要先用GARCH模型对时间序列的数据进行模拟估计波动率，再根据波动率大致的范围主观确定一个基准对波动率状态进行划分，最后用MRS-GARCH模型对样本数据再进行一次模拟。此种划分方法难免存在主观性差异，影响模型对样本数据模拟的精确度。</p><p>因此本文采用隐马尔科夫结构转换GARCH模型，即HMM-GARCH模型(Hidden Markov regime switching GARCH model)来度量我国金融市场的波动，并估计VaR值，希望为相关领域的研究提供一个参考方案。</p></sec><sec id="s4"><title>2. 波动率模型及其估计方法</title><sec id="s4_1"><title>2.1. GARCH模型</title><p>GARCH模型是由Bollerslev [<xref ref-type="bibr" rid="hanspub.22152-ref13">13</xref>] 基于ARCH模型提出的一个推广形式，广义ARCH模型。由于GARCH模型能够捕捉金融时间序列中一些重要的特征，例如，随时间变化的异方差性和波动率聚集性，使其成为波动率研究中一个标准方法。</p><p>一般的GARCH模型：</p><p>r t = ϕ 0 + ∑ i = 1 p 1 ϕ i r t − i + a t − ∑ j = 1 q 1 φ j a t − j a t = σ t ε t σ t 2 = ω + ∑ i = 1 p 2 α i a t − i 2 + ∑ j = 1 q 2 β j σ t − j 2 (1)</p><p>其中 r t 表示金融时间序列， { ε t } 是均值为0、方差为1的独立同分布随机变量序列， σ t 2 是条件方差，即条件波动率。 ω &gt; 0 , α i ≥ 0 , β j ≥ 0 ， ∑ i = 1 max ( p , q ) ( α i + β i ) &lt; 1 (这里对 i &gt; p , α i = 0 ，对 j &gt; q , β j = 0 )。对 α i + β i 的限制条件是保证 a t 的无条件方差是有限的，同时条件方差 σ t 2 是随时间变化的。通常假定 ε t 服从标准正态分布或标准化的学生-t分布或广义误差分布(GED)。</p></sec><sec id="s4_2"><title>2.2. MRS-GARCH模型</title><p>由于GARCH模型在对波动率进行预测时，假设条件波动率在整个时期只有一个机制，没有考虑到突发事件和预期的改变等冲击可能会使影响金融资产价格的结构发生显著变化，前后往往表现出不同的特征，为了反映这种结构性变化，将马尔科夫状态转换方法引入波动率模型中，刻画了金融资产在不同状态下的特征及其转换行为。MRS-GARCH模型的形式为：</p><p>r t = ϕ 0 + ∑ i = 1 p 1 ϕ i r t − i + a t − ∑ j = 1 q 1 φ j a t − j a t = ε t σ t 2 σ t 2 = ω s t + ∑ i = 1 p 2 α s t , i a t − i 2 + ∑ j = 1 q 2 β s t , j σ t − j 2 (2)</p><p>s t 表示 r t 在 t 时刻的状态， ω s t , α s t , i , β s t , j 都是依赖于 t 时刻状态为 s t 的参数。</p><p>状态之间的转移服从一阶马尔科夫过程：</p><p>p m n = P ( s t + 1 = n | s t = m , s t − 1 = k , ⋯ , r t , r t − 1 , ⋯ ) = P ( s t + 1 = n | s t = m ) (3)</p><p>p m n 表示状态 m 到状态 n 的一步转移概率。 k 表示状态的个数。本文只考虑两个状态。则转移概率矩阵为：</p><p>P = ( p 11 p 21 p 12 p 22 )</p><p>且有 ∑ n = 1 2 p m n = 1 ,   0 ≤ p m n ≤ 1 ,   ( m = 1 , 2 ) 。</p><p>对于MRS-GARCH模型的估计一般使用极大似然估计，待估参数为 θ = ( μ , ω 1 , ω 2 , α 1 , α 2 , β 1 , β 2 , p 11 , p 22 ) 。为得到样本的对数似然函数，需要进行滤波过程。对数似然函数为 L ( θ | a ) = ∑ t = 2 T ln f ( a t | θ , Ω t − 1 ) ，其中 a = ( a 1 , a 2 , ⋯ , a T ) ′ ， Ω t − 1 = ( a t − 1 , a t − 2 , ⋯ , a 1 ) 表示 t − 1 时刻的信息集。通过计算可以得到极大似然估计 θ ^ 。</p></sec><sec id="s4_3"><title>2.3. HMM-GARCH模型</title><sec id="s4_3_1"><title>2.3.1. 隐马尔科夫模型的理论知识</title><p>隐马尔科夫模型是由两个随机过程组成的一个双随机过程，用来描述一个含有未知参数的马尔科夫过程。主要从可观察到的变量中确定该过程的隐含参数，然后再用这些参数进行下一步分析。</p><p>隐马尔科夫模型可以由一个五元组 λ = ( M , N , A , B , Π ) 表示，其中：</p><p>N 表示隐含状态数量。隐含状态之间满足马尔科夫性质，是马尔科夫模型中实际隐含的状态。</p><p>M 表示可观察状态数目。可观察状态在模型中与隐含状态相关联，可通过直接观察得到，可观察状态数目 M 不一定要和隐含状态数目 N 一致。</p><p>A 表示隐含状态转移概率矩阵。可以表示为 a i j ∈ A ， a i j 表示在 t 时刻从状态 i 转移到 j 的概率，其中 1 ≤ i , j ≤ N 。</p><p>B 表示观察状态概率矩阵。 b j ( k ) ∈ B ， b j ( k ) 表示在 t 时刻从状态 j 中选择观察特征为 x k 的概率，其中， 1 ≤ j ≤ N ; 1 ≤ k ≤ M 。</p><p>Π ：表示初始状态的概率分布， Π = { π 1 , π 2 , ⋯ } ， π i = P { s t = i } ， π i 表示在 t 时刻选择状态 i 的概率，其中， s t 表示 t 时刻的状态， 1 ≤ i ≤ N 。</p></sec><sec id="s4_3_2"><title>2.3.2. HMM-GARCH模型</title><p>由于HMM-GARCH模型与MRS-GARCH模型都是基于GARCH模型对市场结构突变发生前后不同状态的波动率进行估计，只是两者对状态的分类方法不同。因此两者的波动率模型相同，具有相同的表达式：</p><p>r t = ϕ 0 + ∑ i = 1 p 1 ϕ i r t − i + a t − ∑ j = 1 q 1 φ j a t − j a t = ε t σ t 2 σ t 2 = ω s t + ∑ i = 1 p 2 α s t , i a t − i 2 + ∑ j = 1 q 2 β s t , j σ t − j 2 (4)</p><p>s t 表示 r t 在 t 时刻的状态， ω s t , α s t , i , β s t , j 都是依赖于 t 时刻状态为 s t 的参数。并且状态之间的转移服从马尔科夫状态转移概率矩阵 P 。</p></sec><sec id="s4_3_3"><title>2.3.3. HMM-GARCH模型</title><p>HMM模型的参数估计通常使用Baum-Welch算法。具体思想是：首先给定一个观察序列，调整模型参数 λ ，使其产生观察序列的概率 P ( O | λ ) 最大，再利用迭代过程确定模型的参数。实际中，在给定的观察序列有限时，不存在一个最佳的方法来估计 λ ，只可能找到某些方法，让参数 λ 在特定的几个性能上有较强的优势。在这种情况下，Baum-Welch算法利用递推的思想，使得条件概率局部最大，最后得到模型参数的最终估计值。具体步骤如下：</p><p>首先在给出模型参数和观察序列的前提下，定义 ξ t ( i , j ) 表示t时刻的状态为 s i ， t + 1 时刻的状态为 s j 的概率， q t 表示t时刻的状态值，即</p><p>ξ t ( i , j ) = P ( q t = s i , q t + 1 = s j | O , λ ) (5)</p><p>根据向前和向后变量的定义，可以将 ξ t ( i , j ) 写成下面的形式：</p><p>ξ t ( i , j ) = P ( q t = s i , q t + 1 = s j , O | λ ) P ( O | λ ) = α t ( i ) a i j b j ( o t + 1 ) β t + 1 ( j ) ∑ i = 1 N ∑ j = 1 N α t ( i ) a i j b j ( o t + 1 ) β t + 1 ( j ) (6)</p><p>其中，分子为 P ( q t = s i , q t + 1 = s j , O | λ ) 。定义 γ t ( i ) 为t时刻状态为 s i 的概率，则</p><p>γ t ( i ) = ∑ j = 1 N ξ t ( i , j ) (7)</p><p>将 γ t ( i ) 关于t求和，得到 ∑ t = 1 T − 1 γ t ( i ) ，为从状态 s i 转移出去的期望次数，将 ξ t ( i , j ) 关于t求和，得到 ∑ t = 1 T − 1 ξ t ( i , j ) ，为从 s i 转移到 s j 的期望次数。</p><p>模型的参数 Π , A , B 也可表示为：</p><p>π ˜ i = γ 1 ( i ) ,   a ˜ i j = ∑ t = 1 T − 1 ξ t ( i , j ) ∑ t = 1 T − 1 γ t ( i ) ,   b ˜ j ( k ) = ∑ t = 1 o t = v k T − 1 γ t ( j ) ∑ t = 1 T − 1 γ t ( j ) (8)</p><p>其中， π ˜ i 表示 t = 1 时刻状态 s i 出现的概率。即把原来的参数 λ = ( A , B , Π ) 更新为 λ ˜ = ( A ˜ , B ˜ , Π ˜ ) ，Baum [<xref ref-type="bibr" rid="hanspub.22152-ref14">14</xref>] 证明了一般情况下 P ( O | λ ˜ ) &gt; P ( O | λ ) ，即 λ ˜ 更接近于优化目标，因此经反复迭代就可以得到 λ 的极大似然值，而且满足 ∑ i = 1 N π ˜ i = 1 ,   ∑ j = 1 N a ˜ i j = 1 ,   ∑ k = 1 N b ˜ j ( k ) = 1 。</p><p>在实际应用中，常常假设观察序列服从连续分布，建立连续HMM模型，参数 B 为观测概率密度函数，可近似的表示为多个混合正态分布的组合。连续概率密度函数为：</p><p>b j ( O t ) = ∑ k = 1 M w j k b j k ( O t ) , j = 1 , ⋯ , N (9)</p><p>M 是混合分布的个数， w j k 是在隐状态 j 时第 k 个混合分布的权重，且 ∑ k = 1 M w j k = 1 , j = 1 , ⋯ , N , k = 1 , ⋯ , M 。</p><p>其中使用最多的是高斯分布，且均值是 μ j k ，协方差是 Σ j k ，那么 b j k ( O t ) = N ( O t , μ j k , Σ j k ) 。</p><p>当隐状态为 j 时，第 k 个正态分布产生的显状态的均值和协方差为</p><p>μ j k = E [ O ( t ) | Q ( t ) = j , M ( t ) = k ] Σ j k = cov [ O ( t ) | Q ( t ) = j , M ( t ) = k ] (10)</p><p>多个混合正态分布的函数可表示为</p><p>b j k ( O t ) = N ( O t , μ j k , Σ j k ) = 1 ( 2 π ) U / 2 | Σ j k | 1 / 2 exp { − 1 2 ( O t − μ j k ) T Σ j k − 1 ( O t − μ j k ) }</p><p>k = 1 时，</p><p>b j k ( O t ) = N ( O t , μ j k , Σ j k ) = 1 2 π σ exp { − ( x − μ ) 2 2 σ 2 } (11)</p><p>首先随机产生几组数值，包括初始状态的概率分布 Π 、状态转移矩阵 A 、可近似表示为混合正态分布的观测概率密度函数 B ，运用Baum-Welch算法对数据集进行训练，经过多次迭代后，当达到设定的阈值时，停止计算，参数逐渐趋于最优值。</p><p>通过这些计算可以得到波动率状态的划分结果，为建立结构突变前后不同状态的波动率模型提供基础。</p></sec></sec></sec><sec id="s5"><title>3. VaR方法及其检验</title><sec id="s5_1"><title>3.1. VaR方法</title><p>VaR表示处于风险中的价值，是指在市场正常波动下，某一金融资产或证券组合面临的最大可能损失。根据Jorion [<xref ref-type="bibr" rid="hanspub.22152-ref15">15</xref>] 定义，VaR是在一定置信水平下，某一金融资产或证券组合在未来特定的一段时间内的最大预期损失，可用公式表示为：</p><p>P ( Δ P ≤ VaR ) = α (12)</p><p>上式表示资产价值损失小于等于可能损失上限的概率，其中， Δ P 表示某一金融资产在一定持有期 Δ t 的价值损失额， 1 − α 为置信水平。</p><p>根据VaR的定义，首先假设金融资产的初始价值为 K 0 ，收益率 r t 服从正态分布 N ( μ , σ 2 ) ， z α 为正态分布下置信水平为 1 − α 的标准正态分布的分位数，则在 1 − α 概率水平下，有</p><p>VaR = K 0 [ μ − ( μ − z α σ t ) ] = K 0 z α σ t (13)</p><p>若持有期为 T ，可得均值和标准差为 μ T 和 σ T ，公式可以写为 VaR = K 0 z α σ t T 。因此在假设下，只要估计出金融资产的波动率 σ t ，则可求出其VaR值，在本文的VaR估计中，波动率 σ t 将通过GARCH模型、MRS-GARCH模型和HMM-GARCH模型估计，在实证中假设只考虑1天的持有期，令 K 0 = 1 。</p><p>同理可知道 [<xref ref-type="bibr" rid="hanspub.22152-ref16">16</xref>] ，当金融资产收益率服从学生t分布或GED分布时，可得到VaR的计算公式：</p><p>学生t分布：</p><p>VaR t = K t − 1 t α , v σ t (14)</p><p>t α , v 表示自由度为 v 的学生t分布的 α 分位数， K t − 1 表示滞后一期的股票收盘价格。</p><p>GED分布：</p><p>VaR g e d = K t − 1 g α σ t (15)</p><p>K t − 1 表示滞后一期的股票收盘价格， g α 表示在置信水平 α 下的分位数。</p></sec><sec id="s5_2"><title>3.2. VaR检验</title><p>本文采用Kupiec提出的失败频率检验法对VaR的估计结果进行检验，即是考察实际损失超过VaR的概率。实际损失计算公式为 W t = r t &#215; P t ，即当期收益率与当期价格乘积 [<xref ref-type="bibr" rid="hanspub.22152-ref17">17</xref>] 。</p><p>用 T 表示样本总数， F 表示样本中实际损失大于VaR值的个数，即失败的次数，且有 F ~ B ( T , α ) ，则 F / T 表示失败率。Kupiec提出的似然比检验的原假设是基于样本期计算得到的失败率与估计的VaR的左尾概率无显著性差异，原假设 H 0 : F T = α 。检验统计量为：</p><p>LR = 2 ln ( ( 1 − F T ) T − F ( F T ) F ) − 2 ln ( ( 1 − α ) T − F ( α ) F ) (16)</p><p>在原假设成立的情况下，统计量LR服从自由度为1的 分布，其非拒绝域为：</p><p>χ ( 1 − α / 2 ) 2 ( 1 ) &lt; L R &lt; χ ( 1 − α ) 2 ( 1 ) (17)</p></sec></sec><sec id="s6"><title>4. 实证研究</title><p>农业属于第一产业，在我国的经济建设中具有战略性的地位，农业的健康发展是推动工业文明不断前进和建设社会主义和谐社会的重要基础和物质保障，其发展状况直接关系到我国改革开放和现代化建设全局。随着农业产业化经营的发展以及中国股票的建立，农业上市公司开始顺应农业现代化的要求而不断出现；2004年至2014年连续11年中央“一号文件”中农业新政策的提出，为农业经济发展在宏观方面创造了条件，对于农业上市公司来说也提供了新的发展机遇。因此本文基于农业上市公司的股票，建立基于状态转换的GARCH类模型来度量我国金融市场的波动，并估计VaR值，希望为农业方面的研究与发展提供一个参考方案。</p><sec id="s6_1"><title>4.1. 样本选取与数据预处理</title><p>为了研究农业上市公司股票价格的波动特征，本文数据选择北大荒股票(600598)每日的收盘价为研究对象，考虑到中共中央在2004年1月至2014年月连续11年发布农业、农村和农民为主题的中央一号文件，同时考虑到我国从2001年开始实施股票交易制度的新规则，方便以后研究国家农业经济政策对农业上市公司股票价格波动的影响，选取时间范围是从2005年1月4日至2017年4月11日，样本数量为2881，数据来源于同花顺股票软件。本文将数据分为样本内和样本外两部分，其中样本内数据：2005年1月4日到2016年11月11日共2781个，用于模型的建模；样本外数据：2016年11月12日到2017年4月11日共100个数据，用于检验模型的预测效果。选取的这段时间是全球受金融危机影响，在这段时间我国股市也受其影响，波动现象严重，因此适合于考察中国股票市场收益率的波动特征。本文的数据处理均采用R3.3.2软件进行处理。</p><p>为了研究北大荒股票的股票价格波动和风险价值，先对其数据的基本统计特征进行分析。通过统计分析，我们可以了解北大荒公司的收益率是否具有“尖峰后尾”分布特征，观察收益率序列是否服从正态分布的假设，是否可以利用GARCH模型对股票数据价格波动进行估计。</p><p>在对日收益率的处理上采用对数收益率 R t = ln ( P t / P t − 1 ) ，其中， P t 表示 t 时刻北大荒的日收盘价，通过计算可以得到2780个收益率。</p></sec><sec id="s6_2"><title>4.2. ARCH效应检验</title><sec id="s6_2_1"><title>4.2.1. 农业上市公司股票价格波动的统计特征分析</title><p>图1是北大荒股票2780个收益率的时序图。从图1可知，收益率在0处上下波动，而且较大的波动</p><p>后面会跟着一个较大的波动，同时较小的波动后面会跟着一个较小的波动，这说明北大荒日收益率具有集群性特征。这也验证了收益率的方差与时间有关，具有异方差性，即过去的收益率波动会影响未来的收益率波动。</p><p>图2给出了收益率序列的直方图。由计算结果可知，北大荒对数收益率序列均值为0.000224，表明整体收益是大于0的；标准差为0.032538，偏度为−0.452，小于0，说明序列分布有较长的左拖尾。峰度</p><p>图1. 日对数收益率序列</p><p>图2. 收益率序列直方图</p><p>图3. 正态分布Q-Q图</p><p>为3.197，高于正态分布的峰度值3，说明收益率序列具有“尖峰后尾”的特征。Jarque-Bera统计量为1281.1599，远大于在5%的显著性水平下的临界值5.99，P值为0.000000，拒绝该对数收益率序列服从正态分布的假设。从其正态Q-Q图也可进一步得出收益率序列的非正态性，图3中可以看出收益率序列在正态直线外散布有大量的点，数据点组成的线呈曲线状，左右尾均有明显的摆动，说明实际分布两侧具有后尾现象。所以，可以判断该收益率不服从正态分布。</p></sec><sec id="s6_2_2"><title>4.2.2. ARCH效应检验</title><p>(1) 对收益率 r t 序列进行平稳性检验</p><p>通过计算可得，ADF统计量为−37.7574，均显著小于1%、5%和10%下的临界值，因此，北大荒收益率序列是平稳的，可用于建模。</p><p>(2) 对样本收益率的自回归进行检验</p><p>为了确定其均值方程，对收益率序列采用最小二乘估计，得到最优模型是ARMA(1,1)，具体均值方程表达式为： r t = ϕ 0 + ϕ 1 r t − 1 + a t + θ 1 a t − 1 。</p><p>经检验ARMA模型中估计参数所对应的P值显示均显著，表明该模型是可靠的。并且上述模型的每个统计检验结果都通过检验。对模型的残差以及残差的平方的自相关系数进行分析，经检验得出残差序列不存在序列相关性。</p><p>(3) ARCH效应检验</p><p>对上述均值方程的残差序列进行ARCH-LM检验，验证结果如图4。</p><p>由图4可以看出在高阶时P值仍为0，说明该序列具有高阶的ARCH效应，因此可以考虑建立GARCH(p,q)模型。</p></sec></sec><sec id="s6_3"><title>4.3. GARCH类模型的建立</title><p>由于对数收益率序列拒绝了正态分布的假设，本文则建立了基于广义误差分布(GED)下的GARCH</p><p>图4. ARCH效应检验结果</p><p>模型，暂不考虑学生t分布。</p><sec id="s6_3_1"><title>4.3.1. GARCH模型</title><p>对收益率序列建立ARMA-GARCH，使用R软件进行参数估计，可得出ARMA-GARCH模型的均值方程和方差方程表达式：</p><p>r t = 0.000622 − 0.528 r t − 1 + a t − 0.55 a t − 1 σ t 2 = 0.0000137 + 0.075 a t − 1 2 + 0.913 σ t − 1 2</p><p>GED的自由度为1.242，小于2，说明GED分布相对于标准正态分布有厚尾。</p></sec><sec id="s6_3_2"><title>4.3.2. MRS-GARCH模型</title><p>通过对北大荒的股票收益率建模，得到的MRS-GARCH模型可表示为：</p><p>当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/7-2620474x176_hanspub.png" xlink:type="simple"/></inline-formula>时，即正常波动状态下模型为：</p><p>r t = 1.50186 + a t σ t 2 = 0.00031 + 0.08012 a t − 1 2 + 0.91978 σ t − 1 2</p><p>当 s t = 2 时，即异常波动状态下建立的模型为：</p><p>r t = 1.10136 + a t σ t 2 = 0.01634 + 0.00181 a t − 1 2 + 0.99745 σ t − 1 2</p><p>得到状态的一步转移概率矩阵为</p><p>P = ( 0.949 0.308 0.051 0.692 )</p><p>p 11 &gt; p 22 表明正常状态的稳定性高于异常状态，这一点与实际相符。基于马尔科夫的GARCH模型， α 1 1 + β 1 1 = 0.9999 ， α 1 2 + β 1 2 = 0.9996 均小于1，说明基于马尔科夫建立条件异方差模型有助于降低波动的持续性，提高模型的可预测性。</p></sec><sec id="s6_3_3"><title>4.3.3. HMM-GARCH模型</title><p>首先对时间序列建立隐马尔科夫模型，将股票市场分为正常状态与异常状态。假设初始时刻为正常状态的概率为1，异常状态为2。运用R3.3.2软件，用Baum-Welch算法估算模型的参数，再采用Viterbi算法给出隐状态序列的最佳估计。大幅度的波动存在重要的信息，在处理时我们选择保留。小幅度的波动看作噪声，具有干扰的作用，不具有分析和预测价值，因此，在处理时只选择将小幅波动的噪声去除，保留有用信息，防止信号过度失真。</p><p>通过分析正常状态与异常状态下的数据，分别建立GARCH模型。</p><p>当 s t = 1 时，即正常波动状态下的模型为：</p><p>r t = 0.000492 + a t σ t 2 = 0.00000321 + 0.0085 a t − 1 2 + 0.983 σ t − 1 2</p><p>当 s t = 2 时，即异常波动状态下的模型为：</p><p>r t = 0.000315 − 0.188 r t − 1 − 0.928 r t − 2 + a t + 0.259 a t − 1 + 0.943 a t − 2 + 0.082 a t − 3 σ t 2 = 0.000536 + 0.125 a t − 1 2 + 0.646 σ t − 1 2</p><p>得到一步状态转移概率矩阵为：</p><p>P = ( 0.974 0.026 0.054 0.946 )</p><p>p 11 &gt; p 22 表明正常状态的稳定性高于异常状态，与实际相符。在基于隐马尔可夫模型的GARCH模型中， α 1 1 + β 1 1 = 0.9915 ， α 1 2 + β 1 2 = 0.9 ，均小于1，说明基于隐马尔科夫模型建立条件异方差模型有助于降低波动的持续性，提高模型的可预测性。</p></sec></sec><sec id="s6_4"><title>4.4. VaR的计算与检验</title><p>根据建模得到波动率方程，可以计算出波动率 σ t 的估计值，从而利用VaR的计算公式可以算出北大荒股票收盘价的日VaR值，由于经检验北大荒股票数据拒绝了正态分布，本文研究的是基于GED分布下的情况，因此VaR的计算公式为 VaR g e d = K t − 1 g α σ t 。</p><p>本文采用估计的GARCH-GED模型、MRS-GARCH-GED模型、HMM-GARCH-GED模型对北大荒股票的日VaR值进行了计算，分别计算了左尾概率为1%和左尾概率为5%时的VaR值。其失败频率检验结果见表1。</p><p>根据表1的检验结果，可以得到以下结论：</p><p>1) 对于不同的波动率模型计算VaR值，基于GARCH模型与MRS-GARCH模型估计的VaR值全部通过了检验，而HMM-GARCH模型估计的VaR值在置信水平为95%时未通过检验，说明对于北大荒股票数据，基于GARCH模型与MRS-GARCH模型的VaR估计方法优于HMM-GARCH模型的VaR估计方法。</p><p>2) 在95%和99%的置信水平下，HMM-GARCH模型的失败率均小于GARCH模型与MRS-GARCH模型的失败率，并且在99%的置信水平下，HMM-GARCH模型的失败率为0，估计VaR值比另外两个模型估计的VaR值更接近实际损失，其估计最理想。因此，基于HMM-GARCH模型的VaR方法优于GARCH模型与MRS-GARCH模型的VaR方法。</p><p>3) 置信水平越高，各种方法计算的VaR值越大，并且失败率越小。</p><p>总结以上结论，对于北大荒股票数据，虽然HMM-GARCH-VaR方法在置信水平为95%时未通过检验，但是其失败天数明显少于其他两个模型，并且在99%的置信水平下，失败率为0，估计效果很好，</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The statistical results of VaR failure frequency tes</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >波动模型</th><th align="center" valign="middle" >置信水平</th><th align="center" valign="middle" >VaR的均值</th><th align="center" valign="middle" >VaR的方差</th><th align="center" valign="middle" >失败次数</th><th align="center" valign="middle" >失败频率/%</th><th align="center" valign="middle" >LR统计量</th><th align="center" valign="middle" >是否通过检验</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >GARCH</td><td align="center" valign="middle" >99%</td><td align="center" valign="middle" >0.84</td><td align="center" valign="middle" >0.01092</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >−1.78E−15</td><td align="center" valign="middle" >是</td></tr><tr><td align="center" valign="middle" >95%</td><td align="center" valign="middle" >0.528</td><td align="center" valign="middle" >0.00432</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >0.977</td><td align="center" valign="middle" >是</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >MRS-GARCH</td><td align="center" valign="middle" >99%</td><td align="center" valign="middle" >0.464</td><td align="center" valign="middle" >0.00262</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >2.632</td><td align="center" valign="middle" >是</td></tr><tr><td align="center" valign="middle" >95%</td><td align="center" valign="middle" >0.298</td><td align="center" valign="middle" >0.00023</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >0.198</td><td align="center" valign="middle" >是</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >HMM-GARCH</td><td align="center" valign="middle" >99%</td><td align="center" valign="middle" >0.617</td><td align="center" valign="middle" >0.02382</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >1.97</td><td align="center" valign="middle" >是</td></tr><tr><td align="center" valign="middle" >95%</td><td align="center" valign="middle" >0.388</td><td align="center" valign="middle" >0.00942</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >1.02</td><td align="center" valign="middle" >4.783</td><td align="center" valign="middle" >否</td></tr></tbody></table></table-wrap><p>表1. VaR失败频率检验统计结果</p><p>则说明基于HMM-GARCH模型的VaR方法比基于GARCH模型与MRS-GARCH模型的VaR方法能更好的描绘和预测该股票的风险。</p></sec></sec><sec id="s7"><title>5. 结论</title><p>本文主要研究了基于状态转换GARCH模型的VaR实证分析。首先简单介绍了状态转换GARCH模型和其参数估计方法。再利用R3.3.2软件对北大荒股票数据进行基本统计分析，包括正态性检验、平稳性检验、异方差检验，选取拟合较好的GARCH模型，分别在95%、99%置信水平下计算VaR值，利用Kupiec提出的失败频率检验法检验模型的准确性和精度。</p><p>经过对北大荒的股票收盘价统计分析，其收益率序列具有尖峰后尾性，因此拒绝正态分布的假设，则本文研究了基于广义误差分布(GED)下的波动率模型，分别建立了ARMA(1,1)-GARCH(1,1)，MRS-GARCH(1,1)，正常状态下的HMM-GARCH(1,1)，异常状态下的HMM-ARMA(2,3)-GARCH(1,1)。结果表明基于隐马尔科夫模型的条件异方差模型可以有效降低GARCH模型高估波动持续性的问题，较好的刻画了波动的集聚性、时变性和波动的结构性转变等特点。然后利用估计的波动率模型分别计算了置信水平为95%和99%的VaR值，用Kupiec-失败频率检验法对估计的VaR值进行检验。实验结果表明对于本文所选的股票，基于HMM-GARCH模型的VaR方法比基于GARCH模型与MRS-GARCH模型的VaR方法能更好的描绘和预测该股票的风险。</p></sec><sec id="s8"><title>致谢</title><p>本工作受到国家自然科学基金和北京市教委面上项目资助。同时，罗路和常欣欣同学在Baum-Welch算法推导过程中给予了宝贵的指导，卢静会、王晓繁同学等在软件编程方面提供了协助，在此一并致谢！</p></sec><sec id="s9"><title>基金项目</title><p>国家自然科学基金资助项目(71401124)；北京市教委面上项目资助(KM201510017002)｡</p></sec><sec id="s10"><title>文章引用</title><p>容兰兰,陈爽,冯茹. 基于HMM-GARCH模型的VaR方法及其在农业股市的应用VaR Method Based on HMM-GARCH Model and Its Application in Agricultural Stock Market[J]. 应用数学进展, 2017, 06(06): 768-780. http://dx.doi.org/10.12677/AAM.2017.66093</p></sec><sec id="s11"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.22152-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">袁梁, 霍学喜, 吴后宽. VaR模型在商业银行风险管理中的应用[J]. 西北农林科技大学学报(社会科学版), 2005, 5(2): 56-60.</mixed-citation></ref><ref id="hanspub.22152-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Morgan Guaranty Trust Company (1995) RiskMetrics-Technical Document.</mixed-citation></ref><ref id="hanspub.22152-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Morgan Guaranty Trust Company, Reuters Ltd. (1996) Risk Metrics-Technical Document. 2nd Edition.</mixed-citation></ref><ref id="hanspub.22152-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Riskmetrics Group (2011) Return to Risk Metrics: The Evolution of a Standard.</mixed-citation></ref><ref id="hanspub.22152-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Zhang, B., Wei, Y., Yu, J., et al. (2014) Forecasting VaR and ES of Stock Index Portfolio: A Vine Copula Method. Physica A: Statistical Mechanics and Its Applications, 112-124. &lt;br&gt;https://doi.org/10.1016/j.physa.2014.08.043</mixed-citation></ref><ref id="hanspub.22152-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Foroni, C., Guẻrin, P. and Marcellino, M. (2014) Markov-Switching Mixed-Frequency VaR Models. International Journal of Forecasting.</mixed-citation></ref><ref id="hanspub.22152-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Marcucci, J. (2005) Forecasting Stock Market Volatility with Regime-Switching Models. Studies in Nonlinear Dynamics &amp; Econometrics, 9, Article 6. &lt;br&gt;https://doi.org/10.2202/1558-3708.1145</mixed-citation></ref><ref id="hanspub.22152-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">陈守东, 俞世典. 基于GARCH模型的VaR方法对中国股市的分析[J]. 吉林大学社会科学学报, 2002(4): 11-17.</mixed-citation></ref><ref id="hanspub.22152-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">范英. VaR方法及其在股市风险分析中的应用初探[J]. 中国管理科学, 2000, 8(3): 26-32.</mixed-citation></ref><ref id="hanspub.22152-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">魏捷, 王冬梅, 李威. 基于GARCH模型的上证综合指数VaR计算[J]. 统计与决策, 2010(23): 135-137.</mixed-citation></ref><ref id="hanspub.22152-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">郭名媛, 张世英. 基于MRS-GARCH模型的VaR方法及其在上海股市的应用[J]. 西北农林科技大学学报(社会科学版), 6(2): 52-55.</mixed-citation></ref><ref id="hanspub.22152-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">罗健英, 陈宴祥, 陈粘. 基于MRS-GARCH的钢铁期货市场VaR风险测度[J]. 管理现代化, 2014, 4: 92-94.</mixed-citation></ref><ref id="hanspub.22152-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Bollerslev, T. (1986) Generalized Autoregressive Conditional Heteroskedasticity. Journal of Econometrics, 31, 307-327.</mixed-citation></ref><ref id="hanspub.22152-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Baum, L.E. and Sell, G.R. (1986) Growth Functions for Transformations on Manifolds. Pacific Journal of Mathematics, 27, 211-227.</mixed-citation></ref><ref id="hanspub.22152-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Jorion, P. (1997) Value-at-Risk: The New Benchmark for Controlling Market Risk. The McGraw-Hill Com-panies.</mixed-citation></ref><ref id="hanspub.22152-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">张竞文. 基于GARCH-VaR模型的沪､深指数风险度量分析[D]: [硕士学位论文]. 大庆: 东北石油大学, 2016.</mixed-citation></ref><ref id="hanspub.22152-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">徐伟浩. 沪深300股指期货VaR-GARCH模型风险管理研究——基于恒指期货的比较视角[J]. 证券与保险, 2011, 10: 31-35.</mixed-citation></ref></ref-list></back></article>