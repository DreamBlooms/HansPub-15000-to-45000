<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JSTA</journal-id><journal-title-group><journal-title>Journal of Sensor Technology and Application</journal-title></journal-title-group><issn pub-type="epub">2331-0235</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JSTA.2019.74017</article-id><article-id pub-id-type="publisher-id">JSTA-32428</article-id><article-categories><subj-group subj-group-type="heading"><subject>JSTA20190400000_90959499.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于51单片机与4G模块的人员在位系统设计
  Design of Personnel-in-Place System Based on 51 Single Chip Microcomputer and 4G Module
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>惠蓉</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>孙</surname><given-names>同金</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>蒋</surname><given-names>杏国</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>左</surname><given-names>浩</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>盐城工学院电气工程学院，江苏 盐城</addr-line></aff><aff id="aff2"><addr-line>盐城市产品质量监督检验所，江苏 盐城</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>19</day><month>09</month><year>2019</year></pub-date><volume>07</volume><issue>04</issue><fpage>142</fpage><lpage>149</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文研究并设计了一种基于51单片机和4G模块的办公人员在位系统，本系统主要分为两个部分：下位机和上位机。下位机由单片机、按键、LED显示屏、压力传感器、串口转换器以及4G模块组成；上位机由云服务器、数据库、以及公众号组成。在下位机上，本系统通过设定好按键数据并经单片机处理后同时送给LED显示屏和串口转换器，LED屏显示按键状态，串口转换器将TTL数据转换成RS485数据传输给4G模块，4G模块通过HTTP协议将16进制消息传送到上位机。在上位机上，云服务器读取数据并编码存储入数据库。当用户在指定微信公众号发送工号数据时，云服务器端会返回相应人员在位状态。该在位系统具有成本低，适用性强和实用性好的特点，具有较大研究与应用价值。 In this paper, an office staff in place system based on 51 single chip microcomputer and 4G module is studied and designed. The system is mainly divided into two parts: the lower computer and the upper computer. The lower computer is composed of single chip microcomputer, keystroke, LED display screen, pressure sensor, serial port converter and 4G module. The upper computer is composed of cloud server, database and public number. On the lower computer, the system sets the key data and sends it to the LED display and serial converter through the MCU. The LED screen displays the button status. The serial converter converts the TTL data into RS485 data and trans-mits it to the 4G module. 4G module transmits the hex message to the host computer via the HTTP protocol. On the host computer, the cloud server reads the data and encodes it into the database. When the user sends the job number data to the WeChat public account, the cloud server will re-turn the corresponding personnel in the in-position state. Due to its low cost, good applicability and practicability, the system has certain research value and application value.
    
    
   
  
 
</p></abstract><kwd-group><kwd>办公自动化，微信服务端，单片机，在线监控, Office Automation</kwd><kwd> WeChat Server</kwd><kwd> Single Chip Microcomputer</kwd><kwd> Online Monitoring</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于51单片机与4G模块的人员在位系统设计<sup> </sup></title><p>李惠蓉<sup>1</sup>，孙同金<sup>1</sup>，蒋杏国<sup>1</sup>，左浩<sup>2</sup></p><p><sup>1</sup>盐城市产品质量监督检验所，江苏 盐城</p><p><sup>2</sup>盐城工学院电气工程学院，江苏 盐城</p><p><img src="//html.hanspub.org/file/4-2960122x1_hanspub.png" /></p><p>收稿日期：2019年9月6日；录用日期：2019年10月1日；发布日期：2019年10月8日</p><disp-formula id="hanspub.32428-formula37"><graphic xlink:href="//html.hanspub.org/file/4-2960122x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文研究并设计了一种基于51单片机和4G模块的办公人员在位系统，本系统主要分为两个部分：下位机和上位机。下位机由单片机、按键、LED显示屏、压力传感器、串口转换器以及4G模块组成；上位机由云服务器、数据库、以及公众号组成。在下位机上，本系统通过设定好按键数据并经单片机处理后同时送给LED显示屏和串口转换器，LED屏显示按键状态，串口转换器将TTL数据转换成RS485数据传输给4G模块，4G模块通过HTTP协议将16进制消息传送到上位机。在上位机上，云服务器读取数据并编码存储入数据库。当用户在指定微信公众号发送工号数据时，云服务器端会返回相应人员在位状态。该在位系统具有成本低，适用性强和实用性好的特点，具有较大研究与应用价值。</p><p>关键词 :办公自动化，微信服务端，单片机，在线监控</p><disp-formula id="hanspub.32428-formula38"><graphic xlink:href="//html.hanspub.org/file/4-2960122x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/4-2960122x7_hanspub.png" /> <img src="//html.hanspub.org/file/4-2960122x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>智能办公系统是综合运用了网络技术和先进设备的办公系统，其意义在于很大程度上提升了办事效率，减轻了工作强度，并实现了科学化的管理和决策 [<xref ref-type="bibr" rid="hanspub.32428-ref1">1</xref>] 。现阶段的智能办公系统，已经在互联网网络技术的运用、应用内容的广度与深度等方面都有了崭新的变化和发展，并已经成为企业不可缺少的核心管理系统。办公自动化实现的是一种无纸化、智能化、高效化 [<xref ref-type="bibr" rid="hanspub.32428-ref2">2</xref>] 的办公模式。随着智能办公系统的发展，如何实现企业员工在位状态信息的及时共享，对于提升企业员工协调工作效率，促进企业的发展具有重要的意义 [<xref ref-type="bibr" rid="hanspub.32428-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.32428-ref4">4</xref>] 。</p><p>基于上述目的，本文研究并设计了一种基于51单片机和4G模块的办公人员在位系统。此系统主要是通过软件编程实现单片机设备、4G模块与在线服务器之间的通信，并通过微信公众号的转发，实现无论在何地都能实时了解办公人员的动向，提升日常工作的实施效率，大大缩短工作流程所需的时间，提升企业员工协作效率，促进企业快速发展，具有重要意义。</p></sec><sec id="s4"><title>2. 总体方案设计</title><p>本在位系统的总体方案设计包括硬件设计和软件设计两部分。硬件部分由控制器模块、4G模块、显示模块、电源模块和按键模块组成；软件部分由云服务器、数据库与微信公众号组成。总体方案设计图如图1所示 [<xref ref-type="bibr" rid="hanspub.32428-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.32428-ref6">6</xref>] 。</p></sec><sec id="s5"><title>3. 系统硬件设计与实现</title><p>在位系统的硬件设计可以分为六个模块：控制器模块、显示模块、电源模块、串口转换模块、按键模块、压力感应模块以及4G传输模块。</p><sec id="s5_1"><title>3.1. 控制器模块</title><p>由于本系统对控制器的实时性能要求不高，故选用51单片机 [<xref ref-type="bibr" rid="hanspub.32428-ref7">7</xref>] 中使用较为广泛的STC89C52RC单片机作为控制器模块，其引脚图如图2所示。</p><p>图1. 总体方案设计图</p><p>图2. 单片机引脚图</p></sec><sec id="s5_2"><title>3.2. 显示模块</title><p>显示模块只需用来显示当前单片机的状态，选用LCD1602液晶显示屏，其实物图如图3所示。</p></sec><sec id="s5_3"><title>3.3. 电源模块</title><p>本系统将控制模块与4G模块供电分开。位系统控制模块需要5 V供电，而4G传输模块 [<xref ref-type="bibr" rid="hanspub.32428-ref8">8</xref>] 则需要降压模块将220 V电压转为12 V电压进行供电。</p><p>图3. LCD1602液晶实物图</p></sec><sec id="s5_4"><title>3.4. 串口转换模块</title><p>串口转换模块主要是用于数据的转换，考虑到其既要与计算机传输通信，又要与4G模块传输通信。本设计选用多功能合一的串口模块，芯片构成为CP2102 [<xref ref-type="bibr" rid="hanspub.32428-ref9">9</xref>] ，其原理如图4所示。</p><p>图4. 转换模块使用原理图</p></sec><sec id="s5_5"><title>3.5. 按键模块</title><p>为了实现员工在位不同状态的切换，本设计设置了4个独立按键来实现“Online”、“Waiting 30min”、“Meeting”、“Outing”四种状态的切换，并选用单片机的P3.3、P3.4、P3.5、P3.6输出控制信号。按键电路原理图如图5所示。</p></sec><sec id="s5_6"><title>3.6. 压力感应模块</title><p>压力感应模块实现了压力检测门锁状态的功能，其由FSR薄膜压力传感器和薄膜压力传感器信号转换模块构成 [<xref ref-type="bibr" rid="hanspub.32428-ref10">10</xref>] 。压力传感器的原理是将施加在FSR传感器薄膜区的压力转换成电阻值的变化，从而获得压力信息；薄膜压力传感器信号转换模块则将传感器的电阻信号转换成模拟电压信号或者高低电平信号。</p></sec><sec id="s5_7"><title>3.7. 4G传输模块</title><p>4G传输模块选用众山物联公司的4G DUT模块。通过其将接收到的TTL数据通过HTTP协议传送到私人搭建的服务器上，其实物图如图6所示。</p><p>图5. 按键模块电路图</p><p>图6. 4G模块实物图</p></sec></sec><sec id="s6"><title>4. 系统软件设计</title><p>系统软件的总体设计是采用总分模块化的方式进行设计，如图7所示。下位机的软件设计先是设计出每一个子模块并进行子模块的程序编写，最后在主程序中直接调用子函数；上位机的程序设计是先设计出数据接收处理和存储的接口，再设计出与微信公众号的通信接口；最后设计出数据在数据库读取的接口，将上位机和下位机合并从而完成系统的软件设计。</p><sec id="s6_1"><title>4.1. 下位机程序设计</title><p>a) 按键程序设计。按键程序设计的要求是要根据不同按键显示不同状态。</p><p>b) 显示程序设计。显示程序的逻辑是逐个读取内存中的字符，并将其拼接起来，当读取到最后一个字符后，结束程序。</p><p>c) 压力传感程序设计。压力传感程序要求不断扫描压力传感器状态，当检测到门锁压力变化时，会刷新当前内存中的数据。</p></sec><sec id="s6_2"><title>4.2. 上位机程序设计</title><p>上位机程序选用了腾讯云服务器搭建环境，后台应用选择EXPRESS框架，数据库选用了MYSQL数据库，公众号选择创建个人公众号并开启开发者模式。</p><p>图7. 软件设计流程图</p><p>a) 数据接收存储程序设计。数据接收存储程序用于将接收到的正确消息处理编码并存储于数据库中。</p><p>b) 交互程序设计。交互程序要求只有在用户输入正确工号的情况下，才会返回对应数据。</p></sec></sec><sec id="s7"><title>5. 系统测试</title><p>系统测试中，其实物如图8所示，办公人员通过操作按键模块和压力检测模块，首先在LCD液晶显示屏上显示按键和压力感应的消息，然后会把预先设定的按键消息转化成二进制，通过TTL转RS485转换器将信息传送到4G模块，4G模块将接收到的信息通过HTTP传输到设定好的服务器上，服务器将消息转换编码，并将其存储至数据库。按下按键的显示屏显示画面如下(以按下“Wait 30 min”按键为例)。</p><p>在服务器上，同时存在着一个接口服务用于接收和发送微信公众号信息。当用户在微信公众号界面输入需要查询的办公人员工号时，服务器会比对工号的正确性；如果用户输入的消息不符合要求，服务器将不会返回任何有效信息，这样能有效的保护了办公人员的隐私。企业员工按下不同按键后，在位系统返回查询结果如图9所示。可以看出，办公人员按下不同按键后，通过微信公众号查询服务器可实时返回办公人员在位信息的数据。</p><p>图8. 系统测试图</p><p>图9. 系统测试结果图</p></sec><sec id="s8"><title>6. 结束语</title><p>实现企业员工在位状态信息的及时共享，本文研究并设计了一种基于51单片机和4G模块的办公人员在位系统。系统主要分为下位机和上位机两个部分，其中下位机由单片机、按键、LED显示屏、压力传感器、串口转换器以及4G模块组成；上位机由云服务器、数据库、以及公众号组成。通过系统测试数据显示，办公人员按下不同按键后，本在位系统通过微信公众号查询服务器可实时反应办公人员在位信息的数据，且具备通过办公人员工号查询实现保障员工隐私的功能。因此，本文所提在位系统不仅可以实现企业员工在位信息实时查询的功能，且其成本低，适用性强和实用性好，具有较大研究及应用价值。</p></sec><sec id="s9"><title>文章引用</title><p>李惠蓉,孙同金,蒋杏国,左 浩. 基于51单片机与4G模块的人员在位系统设计Design of Personnel-in-Place System Based on 51 Single Chip Microcomputer and 4G Module[J]. 传感器技术与应用, 2019, 07(04): 142-149. https://doi.org/10.12677/JSTA.2019.74017</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.32428-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">王煜. 中小企业办公自动化系统的设计与实现[D]: [硕士学位论文]. 大连: 大连海事大学, 2018.</mixed-citation></ref><ref id="hanspub.32428-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">郭健. 基于NB-IoT的现代农业物联网监测节点的研究与应用[D]: [硕士学位论文]. 扬州: 扬州大学, 2019.</mixed-citation></ref><ref id="hanspub.32428-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">陆玉梅, 高鹏, 刘素霞. 企业风险规避下的员工激励模型与协调机制[J]. 统计与决策, 2015(23): 177-180.</mixed-citation></ref><ref id="hanspub.32428-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">朱耀楚, 范玉刚. 基于Internet的轴承运行状态远程监测系统设计[J]. 电子科技, 2018, 31(5): 19-22+32.</mixed-citation></ref><ref id="hanspub.32428-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">沈牡丹, 范智新. 人工智能时代档案工作如何寻求新发展[J]. 兰台世界, 2018(5): 77-79.</mixed-citation></ref><ref id="hanspub.32428-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">赵巍. 基于SOA架构的综合行政管理系统开发技术研究[J]. 价值工程, 2015, 34(2): 185-186.</mixed-citation></ref><ref id="hanspub.32428-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">孙万麟. 基于AT89C51单片机的电子琴设计[J]. 电脑知识与技术, 2010, 6(20): 5626-5627.</mixed-citation></ref><ref id="hanspub.32428-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">常勇. 基于4G网络的果园环境监测系统研究与开发[D]: [硕士学位论文]. 西安: 西安理工大学, 2018.</mixed-citation></ref><ref id="hanspub.32428-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">叶亮. 基于CP2102的USB转换接口设计的应用[J]. 中国新通信, 2018, 20(6): 99.</mixed-citation></ref><ref id="hanspub.32428-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">冯新颖, 赵世红. 基于薄膜压力传感器的多路选通信号调理电路设计[J]. 机电工程技术, 2019, 48(1): 126-128.</mixed-citation></ref></ref-list></back></article>