<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">DSC</journal-id><journal-title-group><journal-title>Dynamical Systems and Control</journal-title></journal-title-group><issn pub-type="epub">2325-677X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/DSC.2018.74029</article-id><article-id pub-id-type="publisher-id">DSC-26772</article-id><article-categories><subj-group subj-group-type="heading"><subject>DSC20180400000_29526968.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于运动控制器通用3D打印代码转换组件开发
  The Development of the Universal Code Conversion Component for Motion Controller
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>文磊</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>泽良</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>文海</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>潘</surname><given-names>盛湖</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>西南石油大学机电工程学院，四川 成都</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>06</day><month>09</month><year>2018</year></pub-date><volume>07</volume><issue>04</issue><fpage>262</fpage><lpage>266</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    针对3D打印机无法识别加工G代码程序，种类繁多、底层相对封闭，在进行3D打印系统设计时不得不针对不同运动控制器设计不同加工代码转换程序，通用性差且设计难度大等缺陷。本文介绍了面向运动控制器通用代码转换组件的实现过程，着重从系统组成与软件设计方面给出软件的实现方法。
    In accordance with common practice, 3D printers cannot recognize the processing multifarious G code program and has poor versatility. Furthermore, bottom layers are relatively closed. When de-signing 3D printing system. We have to design different conversion programs of processing code for different motion controllers. It has great difficulties in system design. This article focuses on providing the method of software implementation from system composition and software design, facing the implementation process of the universal code conversion component for motion con-troller. 
  
 
</p></abstract><kwd-group><kwd>运动控制器，代码转换，组件, Motion Controller</kwd><kwd> Code Conversion</kwd><kwd> Component</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于运动控制器通用3D打印代码转换组件开发<sup> </sup></title><p>赵文磊，李泽良，李文海，潘盛湖</p><p>西南石油大学机电工程学院，四川 成都</p><p><img src="//html.hanspub.org/file/2-2740182x1_hanspub.png" /></p><p>收稿日期：2018年8月17日；录用日期：2018年9月4日；发布日期：2018年9月11日</p><disp-formula id="hanspub.26772-formula24"><graphic xlink:href="//html.hanspub.org/file/2-2740182x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对3D打印机无法识别加工G代码程序，种类繁多、底层相对封闭，在进行3D打印系统设计时不得不针对不同运动控制器设计不同加工代码转换程序，通用性差且设计难度大等缺陷。本文介绍了面向运动控制器通用代码转换组件的实现过程，着重从系统组成与软件设计方面给出软件的实现方法。</p><p>关键词 :运动控制器，代码转换，组件</p><disp-formula id="hanspub.26772-formula25"><graphic xlink:href="//html.hanspub.org/file/2-2740182x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-2740182x7_hanspub.png" /> <img src="//html.hanspub.org/file/2-2740182x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>运动控制器是开放式3D打印系统的核心部件，其多样化直接影响着开放式3D打印系统的设计难度。因此，现代3D打印系统的模块化和通用化发展对运动控制器控制程序的设计质量、成本和效率提出了越来越高的要求 [<xref ref-type="bibr" rid="hanspub.26772-ref1">1</xref>] 。</p><p>本3D打印系统采用国际上较先进的开放式结构，以PMAC运动控制器为核心，通过设计用户控制程序实现对机床控制功能。结合以前其它类型运动控制器控制程序设计过程分析后发现：运动控制器无法识别G代码加工程序，需要设计人员设计专门转换程序；种类繁多且各个类型之间底层代码不具有通用性，即所设计的转换程序无法在不同运动控制器平台间移植；国内在运动控制器G代码转换程序方面研究有一定经验，但没有考虑不同运动控制器之间通用性，也未考虑不同编程平台之间可移植性 [<xref ref-type="bibr" rid="hanspub.26772-ref2">2</xref>] 。因此，开发一套具有较高通用性的代码转换组件，可以提高开放式3D打印系统的开发效率与运行稳定性。</p></sec><sec id="s4"><title>2. 组件体系及流程</title><sec id="s4_1"><title>2.1. 组件系统构成</title><p>本组件设计目的在于提高开放式3D打印系统的开发效率与运行稳定性。根据模块化设计思想及现代软件设计方法理论，结合运动控制器代码转换的特殊要求，将软件各个子功能按模块划分，即G代码输入接口、加工图形输入接口、G代码转换、底层词法数据库、G代码检错、仿真加工、应用参数设置、底层代码输出等几个主要模块，并由主程序进行统一管理和调度，如图1所示。</p><p>G代码输入与图形输入主要完成G代码文件或CAD图形文件读入、文件内容预处理；G代码转换将对正确的G代码文件或CAD图形文件按照转换规则转换成运动控制器底层加工程序；底层词法数据</p><p>图1. 系统硬件结构图</p><p>库建立G代码与运动控制器底层加工程序转换规则，不同运动控制器类型建立不同的转换单元，集成与同一数据库，以满足转换要求，转换单元可以增加、修改、删除；G代码检错用于对G代码词法、语法等正确性进行检查，可以知道G代码是否正确、是否需要进行修改等；仿真加工用于对加工程序模拟加工，可以知道加工过程是否正确、是否需要进行修改等；应用参数设置用于设置当前控制器类型，可以保证所调用的转换规则与控制器相对应等；底层代码输出完成转换后数控加工文件按照控制器要求的文件格式与语法生成并输出。</p></sec><sec id="s4_2"><title>2.2. 组件工作流程</title><p>由于组件功能复杂，其其转换过程必须考虑在不同类型运动控制器兼容性 [<xref ref-type="bibr" rid="hanspub.26772-ref2">2</xref>] ，这就决定了其数据处理过程的特殊性。结合基于开放式3D打印系统设计需要，对本组件进行了工作过程设计，如图2所示。</p></sec></sec><sec id="s5"><title>3. 组件软件实现</title><p>本组件的设计重点在与开放式3D打印系统设计思想保持高度一致，结合运动控制器特点设计加工文件格式，并能够输出正确的底层加工程序。因此该组件必须能够嵌入用不同编程语言设计3D打印系统中，作为一重要子模块。因此，本组件结构采用国际较为流行Microsoft COM组件模式，COM组件生成后可以在不同编程语言平台之间进行移植。图3所示为该组件嵌入3D打印3D打印系统实现G代码到PMAC运动控制器底层加工程序转换。</p><p>友好的用户界面能够提高系统的使用效率，方便操作，便于数控产品的推广。在Visual C++6.0的Microsoft Developer Studio环境中，使用应用程序向导(App Wizard)生成Windows GUI应用程序基本框架。</p><p>图2. 组件工作流程图</p><p>在资源编辑器中编辑对话框和控件，生成了一个非常友好的Windows风格的用户界面，利用VC 6.0中动态链接库技术完成各个子模块的设计 [<xref ref-type="bibr" rid="hanspub.26772-ref3">3</xref>] 。最后，将该应用程序发布成Microsoft COM组件，以在不同编程语言平台之间进行移植，无需任何修改。限于篇幅，本文仅对组件中G代码转换和仿真加工两个模块进行简单介绍。</p><sec id="s5_1"><title>3.1. G代码转换</title><p>本模块集中基本参数配置、G代码显示、转换后底层程序显示、G代码修改与优化等功能于一体。基本参数设置正确后，当需要修改G代码时，根据组件G代码分析结果提示信息，对其中部分代码进行适当调整，并在显示中实时刷新显示，有利与提高代码修改、转换的效率。</p></sec><sec id="s5_2"><title>3.2. 仿真加工</title><p>本模块是一个集NC数据处理和NC图形仿真于一体的图形仿真校验系统，由数控数据输入、数控程序数据处理、仿真计算和仿真显示等模块组成。</p><p>模块设计利用OpenGL技术和计算机动画技术，实现了数控加工过程的二维模拟仿真，可以观察零件加工过程，同时把一些重要的加工信息自动生成报表，其磨削仿真的用户界面，如图4所示。</p><p>图3. 组件显示界面</p><p>图4. 模拟仿真界面</p></sec></sec><sec id="s6"><title>4. 总结</title><p>着重论述了面向运动控制器通用代码转换组件的设计方法和设计过程，给出在模型建立和软件设计上的设计模型。经过实际应用调试，该组件达到了设计目的，符合市场的要求。在运动控制技术迅速发展的今天，运动控制器的发展日新月异，因此，在以后的设计应用中，可以考虑用更先进的控制器底层兼容的办法以求得更高性能通用性。</p></sec><sec id="s7"><title>基金项目</title><p>西南石油大学校重点开放项目支持。</p></sec><sec id="s8"><title>文章引用</title><p>赵文磊,李泽良,李文海,潘盛湖. 基于运动控制器通用3D打印代码转换组件开发 The Development of the Universal Code Conversion Component for Motion Controller[J]. 动力系统与控制, 2018, 07(04): 262-266. https://doi.org/10.12677/DSC.2018.74029</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.26772-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">卓闻涛. 基于FDM的3D打印切片引擎的研究及优化[D]: [硕士毕业论文]. 南京: 东南大学, 2015.</mixed-citation></ref><ref id="hanspub.26772-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">陈乐尧, 黄国立. 数控加工过程仿真中NC程序的检错与翻译技术[J]. 机床与液压, 2006(11): 227-230.</mixed-citation></ref><ref id="hanspub.26772-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">邱蕾, 屈国普. Visual C++中基于ADO的数据库访问的程序设计[J]. 信息与电脑, 2010(5): 150-151.</mixed-citation></ref></ref-list></back></article>