<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">GST</journal-id><journal-title-group><journal-title>Geomatics Science and Technology</journal-title></journal-title-group><issn pub-type="epub">2329-549X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/GST.2018.64033</article-id><article-id pub-id-type="publisher-id">GST-27177</article-id><article-categories><subj-group subj-group-type="heading"><subject>GST20180400000_16709337.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于相位一致性原理的像控点精确标定算法研究
  Research on Precise Calibration Algorithm of Image Control Point Based on Phase Consistency Principle
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>罗</surname><given-names>思</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>安</surname><given-names>冠星</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>万</surname><given-names>超刚</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>湖南省第一测绘院，湖南 衡阳</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>17</day><month>10</month><year>2018</year></pub-date><volume>06</volume><issue>04</issue><fpage>281</fpage><lpage>287</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  像控点是航空像片进行几何纠正及地理定位时重要的基准数据源，为了实现航空摄影中像控点的快速定位，本文通过研究基于相位一致性原理的异源影像匹配，将像控点标定在目标航空影像上，并以湖南省某区域不动产成果数据为例对本文的算法进行对比实验论证算法的有效性。
   Image control point is an important datum source for geometric correction and geolocation of aerial photos. In order to achieve the rapid location of image control points in aerial photography, this paper studies the heterogenous image matching based on the principle of phase consistency, calibrateing the image control point on the target aerial image, and taking the real estate data in a certain area of Hunan Province as an example to compare the effectiveness of the algorithm in this paper.
 
</p></abstract><kwd-group><kwd>相位一致性，像控点，异源影像，标定, Phase Consistency</kwd><kwd> Control Point</kwd><kwd> Heterologous Images</kwd><kwd> Calibration</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于相位一致性原理的像控点 精确标定算法研究<sup> </sup></title><p>罗思，安冠星，万超刚</p><p>湖南省第一测绘院，湖南 衡阳</p><p><img src="//html.hanspub.org/file/7-2840201x1_hanspub.png" /></p><p>收稿日期：2018年9月28日；录用日期：2018年10月12日；发布日期：2018年10月19日</p><disp-formula id="hanspub.27177-formula34"><graphic xlink:href="//html.hanspub.org/file/7-2840201x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>像控点是航空像片进行几何纠正及地理定位时重要的基准数据源，为了实现航空摄影中像控点的快速定位，本文通过研究基于相位一致性原理的异源影像匹配，将像控点标定在目标航空影像上，并以湖南省某区域不动产成果数据为例对本文的算法进行对比实验论证算法的有效性。</p><p>关键词 :相位一致性，像控点，异源影像，标定</p><disp-formula id="hanspub.27177-formula35"><graphic xlink:href="//html.hanspub.org/file/7-2840201x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/7-2840201x7_hanspub.png" /> <img src="//html.hanspub.org/file/7-2840201x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>近年来，随着摄影测量技术在生产生活中的不断应用，大量像控点信息被采集整理用于影像纠正及定位，并将其纳入数据库系统进行管理 [<xref ref-type="bibr" rid="hanspub.27177-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.27177-ref2">2</xref>] ，大大方便了航空摄影测量作业。然而，像控成果的应用却仍以目视判别为主，在目标航空影像中人工判别像控点所在地面位置，耗时耗力、作业量大且判别效率与精度较低 [<xref ref-type="bibr" rid="hanspub.27177-ref3">3</xref>] ，成为制约摄影测量生产效率的重要因素之一。计算机视觉技术的不断深入研究与应用使影像的精确识别正逐步成为可能。诸多学者对影像的机器识别技术进行了深入研究，基于特征的多源影像特征关系匹配技术实现多源遥感影像的匹配 [<xref ref-type="bibr" rid="hanspub.27177-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.27177-ref5">5</xref>] 。对多源影像进行基于灰度的多级概率松弛整体匹配，实现了SPOT全色和TM多波段影像的配准 [<xref ref-type="bibr" rid="hanspub.27177-ref6">6</xref>] 。计算机视觉技术的研究为目标定位提供了坚实的技术支撑 [<xref ref-type="bibr" rid="hanspub.27177-ref7">7</xref>] ，但基于计算机视觉技术的点目标精确定位方法却鲜有研究，并未形成有效的技术方案体系。</p><p>针对上述问题，本文以快速定位像控点为研究目标，通过对像控点影像与目标航空影像匹配及像控点在目标航空影像上的精确标定方案进行深入研究，提出一种基于相位一致性原理的像控点精确标定算法，有效实现像控点在目标航空影像中的精确定位，通过实验对本文研究的算法进行分析以确定该算法的可靠性、稳定性与准确性。</p></sec><sec id="s4"><title>2. 算法原理</title><p>利用目标航空影像的POS数据及像控点坐标在目标航空影像中对像控点进行初步定位并建立目标航空影像的匹配窗口，将像控点影像与该窗口影像进行匹配后在目标航空影像中标定像控点。算法实施主要包括四个步骤：建立匹配窗口、特征点检测、特征点匹配及像控点标定。</p><sec id="s4_1"><title>2.1. 建立匹配窗口</title><p>为加速算法运行速度，保证匹配结果精度，在进行影像匹配前需要建立目标航空影像的影像匹配窗口。匹配窗口建立步骤为：</p><p>1) 定位像控点：利用共线方程结合POS数据将像控点地理坐标换算以像主点为原点的像平面坐标，再将其换算为影像像素行列号，由于目标航空影像在成像时与像空间辅助坐标系存在相对旋转，因此首先将像平面坐标进行旋转变换，变换公式为：</p><p>{ x = x cos ( k ) − y sin ( k ) y = x sin ( k ) − y cos ( k ) (式1)</p><p>式中k 表示外方位元素中的Z轴旋转角， 表示旋转后像平面坐标，得到像平面坐标后再将其换算为影像行列号，换算公式为：</p><p>{ H = x + i m a g e l / 2 L = y + i m a g e c / 2 (式2)</p><p>式中 ( H , L ) 表示像控点所在行列号， ( x , y ) 表示像控点的像平面坐标， ( i m a g e l , i m a g e c ) 分别表示影像的长度与宽度。</p><p>2) 裁剪匹配窗口：以第1)步计算行列号对应像素为中心，裁剪800*800像素大小的影像作为匹配窗口，参与下一步影像匹配。</p></sec><sec id="s4_2"><title>2.2. 特征点检测</title><p>由于像控点影像数据来源与目标航空影像不同，其亮度、对比度及纹理等信息具有明显差异，针对异源影像的匹配采用相位一致性特征点检测算法 [<xref ref-type="bibr" rid="hanspub.27177-ref8">8</xref>] ，该方法选取6个方向和4个度的Log-Gabor小波变换，计算相位一致性测度 P C ( θ ) ，得到最大矩M，计算公式为：</p><p>M = 1 2 ( c + a − b 2 − ( a − c ) 2 )</p><p>a = ∑ ​ ( P C ( θ ) cos ( θ ) ) 2 (式3)</p><p>b = 2 ∑ ​ ( P C ( θ ) cos ( θ ) ) ∗ ( P C ( θ ) sin (θ))</p><p>c = ∑ ​ ( P C ( θ ) sin ( θ ) ) 2</p><p>其中，对于影像上的任意点 ( x , y ) ，若该点最大矩 M &gt; T 1 ，则该位置为边缘点。其中，T1为边缘点检测阈值。对最大矩M后进行归一化处理，将归一化处理结果乘以灰度最大值255从而生成基于相位信息的边缘影像，突出影像边缘信息，再结合FAST角点提取算法对该影像进行角点提取即可得到影像特征点。</p></sec><sec id="s4_3"><title>2.3. 特征点匹配</title><p>对2.2中提取出的特征点建立特征描述符：采集特征点统计梯度方向直方图生成近似的特征描述符，具体步骤为：</p><p>1) 以特征点为中心选择100*100的图像区域作为特征区域；</p><p>2) 对特征区域进行划分，使其成为25*25的16个子区域；</p><p>3) 每个子区域统计4个方向的梯度方向直方图，16个子区域共得到64维的特征向量作为特征描述符。</p><p>对异源影像匹配采用归一化相关函数作为匹配测度进行匹配，归一化相关函数公式为：</p><p>dis ( k i , k j ) = 〈 k i , k j 〉 | k i | ∗ | k j | (式4)</p><p>其中， k i , k j 分别表示影像的两个特征描述符。</p><p>由于异源影像差异往往较大，匹配测度的单一极值点不一定是正确的匹配点，造成一定量的误匹配点存在，因此，需要在已匹配的点对的基础上利用随机抽样一致性算法(RANSAC)对匹配点进行剔除提纯，剔除误匹配点，得到正确匹配的特征点对。</p></sec><sec id="s4_4"><title>2.4. 像控点标定</title><p>利用正确匹配的特征点对结合最小二乘原理可求得仿射变换模型的六个参数，建立像控点影像块中像控点行列号与目标航空影像中像控点行列号的映射关系。最后根据仿射变换公式将像控点影像块中的像控点位置换算至目标航空影像，完成像控点在目标航空影像上的标定。仿射变换公式为：</p><p>{ X = a 1 x + a 2 y + a 3 Y = b 1 x + b 2 y + b 3 (式5)</p><p>其中， ( x , y ) 为像控点在像控点影像块上的坐标， ( X , Y ) 表示像控点在目标航空影像上的坐标， a 1 , a 2 , a 3 , b 1 , b 2 , b 3 是目标航空影像与像控点影像之间的仿射变换参数。</p><p>由像控点的在像控点影像上的行列号坐标，并将此坐标代入式5中即可计算出像控点在目标航空影像上的行列号坐标，完成像控点在目标航空影像上的标定。</p></sec></sec><sec id="s5"><title>3. 实验分析</title><sec id="s5_1"><title>3.1. 实验数据</title><p>实验以湖南省某区域不动产成果数据作为测试数据，实验数据包括航空影像及相应POS数据、原始航空影像的相机参数及区域内像控成果资料。原始影像航空大小为11,704*7920像素大小，图1为航空影像。</p></sec><sec id="s5_2"><title>3.2. 实验分析</title><p>1) 建立影像匹配窗口</p><p>实验首先建立影像匹配窗口，在目标航空影像上裁剪出500*500像素大小的影像作为影像匹配窗口，图2、图3中图3(a)为目标航空影像裁剪之后的影像匹配窗口，图3(b)为与目标航空影像对应的像控点影像，从图上可以看出目标影像匹配窗口与像控点影像成像差异较大，纹理不一致，为异源影像。</p><p>图1. 原始影像</p><p>图2. 实验数据1</p><p>2) 特征提取与特征匹配</p><p>使用本文的算法对实验数据进行特征提取与特征匹配，结果图如图4、图5所示，从图中可以看出本文的特征提取与特征匹配算法匹配结果较为正确，对于角点及拐点的检测较为准确，经过随机抽样一致性算法对匹配点对进行剔除提纯得到的匹配点对少而精确，为了为确定本文研究算法优劣，使用sift特征匹配算法与本文研究的算法进行对比，图6、图7为sift特征匹配算法的匹配结果图，图6匹配结果大致正确，但存在少量的误匹配点，且得到的匹配点对数较多，图7匹配的点对较少，且出现匹配错误，实验可以看出本文的算法对异源影像匹配具有较好的稳定性。</p><p>3) 像控点标定</p><p>利用正确匹配的特征点对计算影像匹配窗口与像控点影像的仿射变换参数，由仿射变换参数及像控点坐标计算出像控点在影像匹配窗口的位置，本文的算法标定结果如图8所示，由图8可以看出本文算</p><p>图3. 实验数据2</p><p>图4. 匹配结果1</p><p>图5. 匹配结果2</p><p>图6. Sift特征算法匹配结果</p><p>图7. Sift特征算法匹配结果2</p><p>图8. 实验数据2</p><p>图9. Sift特征算法标定结果</p><p>法能够精确地将像控点标定在目标航空影像上，sift算法标定结果如图9所示，像控点P00201在影像匹配窗口上的标定存在误差，像控点P00200由于影像匹配失败，导致像控点P00200在影像匹配窗口没有标定结果。从标定结果可以看出，本文的特征提取与特征匹配算法计算出的影像匹配窗口与像控点影像的仿射变换参数正确，因此标定结果精确。</p></sec></sec><sec id="s6"><title>4. 结论</title><p>像控点目标精确标定是实现像控点重复利用、提高航空摄影测量作业效率的技术基础，对于提高摄影测量技术的高效性与实时性具有重要意义。本文采用相位一致性原理有效实现像控点影像与目标航空影像两种异源影像精确匹配，并将匹配结果应用于目标航空影像的像控点精确标定，使用湖南省某区域不动产成果资料进行实验分析，实验结果表明基于相位一致性原理的像控点精确标定算法能够准确快速地完成目标航空影像的像控点精确标定工作，减少航空影像处理中像控刺点的工作量，提高作业效率。</p></sec><sec id="s7"><title>文章引用</title><p>罗思,安冠星,万超刚. 基于相位一致性原理的像控点精确标定算法研究Research on Precise Calibration Algorithm of Image Control Point Based on Phase Consistency Principle[J]. 测绘科学技术, 2018, 06(04): 281-287. https://doi.org/10.12677/GST.2018.64033</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.27177-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">张继贤, 马瑞金. 图形图像控制点库及应用[J]. 测绘通报, 2000(1): 15-17.</mixed-citation></ref><ref id="hanspub.27177-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">潘振祥. 高分辨率影像数据处理及数据建库技术方法研究[J]. 测绘通报, 2008(10): 23-25.</mixed-citation></ref><ref id="hanspub.27177-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">卢刚, 赖震刚. 控制点影像库的设计与实现[C]//江苏省测绘学会2011年学术年会. 江苏省测绘学会2011年学术年会论文集. 南京: 江苏省测绘学会, 2011: 154-157.</mixed-citation></ref><ref id="hanspub.27177-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">张宇坤. 多源控制点影像匹配策略及控制点影像库设计研究[D]: [硕士学位论文]. 西安: 西北大学, 2008: 46-49.</mixed-citation></ref><ref id="hanspub.27177-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">刘晓龙, 李英成. 基于多源遥感影像融合的影像匹配技术[J]. 测绘科学, 2007(3): 59-61.</mixed-citation></ref><ref id="hanspub.27177-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">张祖勋, 张剑清. 数字摄影测量学[M]. 武汉: 武汉测绘科技大学出版社, 1996.</mixed-citation></ref><ref id="hanspub.27177-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">杨晓峰. 基于仿射变换模型的图像目标定位跟踪方法[D]: [硕士学位论文]. 武汉: 华中科技大学, 2005.</mixed-citation></ref><ref id="hanspub.27177-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">王怀所, 黄华. 基于相位一致性原理的特征点检测[J]. 计算机工程与设计, 2014(7): 2428-2430.</mixed-citation></ref></ref-list></back></article>