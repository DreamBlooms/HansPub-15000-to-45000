<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JSTA</journal-id><journal-title-group><journal-title>Journal of Sensor Technology and Application</journal-title></journal-title-group><issn pub-type="epub">2331-0235</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JSTA.2019.74014</article-id><article-id pub-id-type="publisher-id">JSTA-32228</article-id><article-categories><subj-group subj-group-type="heading"><subject>JSTA20190400000_32383483.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于单片机及鱼塘模型的智慧养鱼控制系统设计
  Design of Intelligent Fish Culture Control System Based on MCU and Fish Pond Model
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吉</surname><given-names>春雷</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>谈</surname><given-names>格</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>许</surname><given-names>杰</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>奚</surname><given-names>诗秋</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>盐城工学院，电气工程学院，江苏 盐城</addr-line></aff><aff id="aff2"><addr-line>盐城市计量测试所，江苏 盐城</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>19</day><month>09</month><year>2019</year></pub-date><volume>07</volume><issue>04</issue><fpage>121</fpage><lpage>128</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文研究并设计了基于单片机及鱼塘模型的智慧养鱼控制系统，由自动投喂模块、温度检测模块、光照强度检测模块、LCD显示模块、加热模块等模块构成。系统通过以单片机为控制核心，应用温度、光照传感器实现温度、光照强度信息的自动采集，并通过控制继电器实现温度光照的调节，利用鼓风机实现自动投喂的功能。 In this paper, one intelligent fish culture control system based on single chip microcomputer and fish pond model is studied and designed, which is composed of automatic feeding module, tem-perature detection module, light intensity detection module, LCD display module, heating module and so on. Based on single chip microcomputer, the intelligent fish culture control system can col-lect the temperature and light intensity information by temperature and light sensor and then adjust the temperature and light by the control of relay, and can achieve automatic feeding by using blower.
    
    
   
  
 
</p></abstract><kwd-group><kwd>单片机，自动投喂，传感器检测，继电器调节, Single Chip Microcomputer</kwd><kwd> Automatic Feeding</kwd><kwd> Sensor Detection</kwd><kwd> Relay Adjustment</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于单片机及鱼塘模型的智慧养鱼控制系统 设计<sup> </sup></title><p>吉春雷<sup>1</sup>，谈格<sup>1</sup>，许杰<sup>1</sup>，奚诗秋<sup>2</sup></p><p><sup>1</sup>盐城市计量测试所，江苏 盐城</p><p><sup>2</sup>盐城工学院，电气工程学院，江苏 盐城</p><p><img src="//html.hanspub.org/file/1-2960123x1_hanspub.png" /></p><p>收稿日期：2019年8月28日；录用日期：2019年9月12日；发布日期：2019年9月19日</p><disp-formula id="hanspub.32228-formula3"><graphic xlink:href="//html.hanspub.org/file/1-2960123x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文研究并设计了基于单片机及鱼塘模型的智慧养鱼控制系统，由自动投喂模块、温度检测模块、光照强度检测模块、LCD显示模块、加热模块等模块构成。系统通过以单片机为控制核心，应用温度、光照传感器实现温度、光照强度信息的自动采集，并通过控制继电器实现温度光照的调节，利用鼓风机实现自动投喂的功能。</p><p>关键词 :单片机，自动投喂，传感器检测，继电器调节</p><disp-formula id="hanspub.32228-formula4"><graphic xlink:href="//html.hanspub.org/file/1-2960123x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/1-2960123x7_hanspub.png" /> <img src="//html.hanspub.org/file/1-2960123x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着当代科学和技术的进步，我国渔业的发展已经进入了一个新的拐点。大力发展鱼塘智慧养鱼，是我国农业发展的战略目标和重要组成部分 [<xref ref-type="bibr" rid="hanspub.32228-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.32228-ref2">2</xref>] 。但是目前，我国的智慧养鱼技术与西方发达国家还存在着一些差距。我国的池塘养殖配套装备和新型养殖模式有研发方面的滞后，与此同时，在大型、影响深远的水产养殖平台的研发方面也处于落后。此外，中国的水产养殖是分散的，农民的整体教育水平和专业素质较低。传统水产养殖观念根深蒂固，大多数养殖户对新设备和新技术的接受程度较低 [<xref ref-type="bibr" rid="hanspub.32228-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.32228-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.32228-ref5">5</xref>] 。因此，构建基于单片机及鱼塘模型的智慧养鱼控制系统，养殖户可以看到鱼在每个养殖场和每个池塘的生长情况，不仅可促进我国智慧养殖的发展，也能使养殖户直观地认识智慧养殖，促进智慧养殖的推广发展。</p><p>本设计的核心单元是51单片机，根据功能是把设计分为以下几个模块：自动投喂模块，温度检测模块、光照强度检测模块、LCD显示模块、加热模块等并且结合软件设计温度检测模块程序、LCD显示程序、光照强度检测程序、继电器加热模块程序等。功能上利用鼓风机实现自动投喂；用温度、光照传感器实现温度、光照强度的检测，利用单片机和继电器实现自动控制。</p></sec><sec id="s4"><title>2. 总体方案设计</title><p>本文采用分模块的方式对主要模块进行设计。系统的主要模块有主控单元时钟模块、温度检测模块、LCD显示模块和自动定时投喂模块等。系统的核心单元是51单片机，各个模块环境参数值的采集使用传感器实现。整个系统运行的原理是由单片机接收并且处理数据，接着向各个模块传送信号并且执行相应的功能，从而实现了自动投喂和对鱼缸内温度、光照等环境因素的自动控制，系统的总体设计框图如图1所示。</p><p>图1. 总体设计框图</p></sec><sec id="s5"><title>3. 系统硬件设计与实现</title><p>控制系统的硬件设计主要分为七个模块：主控制单元时钟模块、光照强度检测模块、加热模块、温度检测模块、自动投喂模块、LCD键盘显示模块、电源模块。</p><sec id="s5_1"><title>3.1. 主控制单元时钟模块</title><p>主控制单元时钟模块主要由单片机部分和时钟模块组成，其硬件电路的原理图如图2所示 [<xref ref-type="bibr" rid="hanspub.32228-ref6">6</xref>] 。</p><p>图2. 主控制时钟模块硬件电路原理图</p><p>时钟模块控制电路主要完成时间的计算，体现计时功能。采用DS1302模块，它的VCC端口接5 V电压，GND接地，CLK端口和弹片的P04口相连，DAT和单片机的P03端口相连，RST和单片机的P02端口相连，从而与单片机进行数据转换，实现计时功能。</p></sec><sec id="s5_2"><title>3.2. 光照强度检测模块</title><p>光照强度检测模块主要是由GY-30光照传感器 [<xref ref-type="bibr" rid="hanspub.32228-ref7">7</xref>] 实现。通过VCC端口接5 V电源，SCL端口和单片机的P1.7端口相接，SDA和单片机的P1.6端口相接，实现对周围光照的检测，从而达到自动补光的效果，其硬件电路的原理图如图3所示。</p></sec><sec id="s5_3"><title>3.3. 加热模块</title><p>加热模块使用加热棒和继电器实现，通过继电器控制加热棒，实现水的加热。加热棒和继电器的NC端相连，继电器的COM端口接12 V电源实现加热功能，其硬件电路的原理图如图4所示。</p><p>图3. 光照强度检测模块硬件电路原理图</p><p>图4. 加热模块硬件电路原理图</p></sec><sec id="s5_4"><title>3.4. 温度检测模块</title><p>温度检测模块使用传感器为DS18B20 [<xref ref-type="bibr" rid="hanspub.32228-ref8">8</xref>] 。测温的主要原理是利用DS18B20内部的计数功能完成温度的测量，DS18B20的内部含有计数器1和计数器2，它的测温原理为低温系数震荡器产生的脉冲信号给计数器1，高温系数振荡器产生的脉冲信号作为减法给计数器2输入，通过DS18B20产生的时钟脉冲完成计数，从而完成温度的测量。</p><p>通过DS18B20的DQ端口和单片机的P3.7端口相接，在DQ和VDD间接一个4.7 K的电阻保护电路，完成温度检测功能，硬件电路的原理图如图5所示。</p><p>图5. 温度检测模块硬件电路原理图</p></sec><sec id="s5_5"><title>3.5. 自动投喂模块</title><p>自动投喂模块主要由继电器控制鼓风机实现。继电器由输入回路和输出回路组成，它在本质上是一种电子控制器。继电器的COM、NC端口和鼓风机相接，IN和单片机的P1.0端口相接，从而实现定时投喂的功能，其硬件电路的原理图如图6所示。</p></sec><sec id="s5_6"><title>3.6. LCD键盘显示模块</title><p>使用器件LCD1602液晶显示器 [<xref ref-type="bibr" rid="hanspub.32228-ref9">9</xref>] 实现LCD键盘显示模块功能。通过数字在液晶显示器上显示可以读出数值。LCD1602液晶显示器不仅可以显示数字，还可以显示字母和符号等，它是一种点阵型的液晶模块，功能十分强大。LCD1602液晶显示器显示的内容是两行，每行的长度为16个字符模块，通常表示为16X2。</p><p>图6. 自动投喂模块硬件电路原理图</p></sec><sec id="s5_7"><title>3.7. 电源模块</title><p>控制系统的电源模块采用5 V输电源供电，通过自锁开关控制开闭，用LED发光二极管串联一个电阻，闭合开关，LED灯亮，则表示电源正常通电，所有的电源从这里输出，其硬件电路的原理图如图7所示。</p><p>图7. 电源电路模块硬件电路原理图</p></sec></sec><sec id="s6"><title>4. 系统软件设计</title><p>控制系统软件设计采用模块化的设计，首先系统外设先初始化，设定初始值，到达一定的时间，继电器打开控制鼓风机进行自动投喂；当水温和周围光照强度低于设定值时，继电器打开控制加热棒的工作，单片机控制LED灯进行补光。软件设计流程图如图8所示。</p><p>软件设计的主要模块有LCD1602液晶显示模块、温度传感器检测模块、光照传感器检测模块、继电器加热模块。</p><sec id="s6_1"><title>4.1. LCD1602液晶显示模块</title><p>液晶显示模块程序所实现的主要功能是读取它的光标显示值，确定光标的位置。首先根据程序的输入确定第一个显示的字符，接着再根据程序按位显示所有的数据，直到全部显示。液晶显示程序流程图如图9所示。</p><p>图8. 系统程序流程图</p><p>图9. WIFI模块实物图</p><p>1602液晶显示函数的主要程序如下所示：</p><p>void Lcd1602WaitReady()</p><p>sta = LCD1602_DB;</p><p>void Lcd1602WriteCmd(unsigned char cmd)</p><p>VoidLcd1602SetCursor(unsigned char x, unsigned char y) Lcd1602SetCursor(x, y);</p><p>while (*str != '\0')</p><p>{</p><p>Lcd1602WriteDat(*str++);</p><p>}</p><p>LCD液晶显示模块函数先初始化，程序“sta = LCD1602_DB”表示读取状态字，接着向LCD1602液晶写入一字节的命令，显示设置RAM的起始地址，即光标的位置，上述程序中的“(x, y)”对应屏幕上的字符坐标，接着连续写入字符串数据，直到检测到结束符。</p></sec><sec id="s6_2"><title>4.2. 温度传感器检测模块</title><p>此段程序设计的目的主要为读取DB18B20的时序。首先需要进行的是初始化程序，建立DB18B20和单片机的联系。接着进行复位，然后获得测量的温度数据，接着读取转换结果，读取高低字节数据结果并且进行整合。</p></sec><sec id="s6_3"><title>4.3. 光照传感器检测模块</title><p>由于光照传感器检测模块选用的器件型号是GY-30，它的主芯片是BH1750 [<xref ref-type="bibr" rid="hanspub.32228-ref10">10</xref>] ，因此光照传感器检测模块的程序编写主要使用BH1750函数来实现。其功能实现流程图如图10所示。</p><p>图10. BH1750函数功能实现流程图</p></sec><sec id="s6_4"><title>4.4. 继电器加热模块</title><p>该模块的功能为显示器读取DS18B20温度，若是低于设定值，则单片机输出低电平，继电器常开触电吸合，开始工作，控制加热棒的加热。</p></sec></sec><sec id="s7"><title>5. 系统测试</title><p>控制系统的预期效果：当温度传感器检测到水温值，将其传送给单片机，由单片机进行处理和判断并且控制继电器是否工作。当水温低于设定值时，继电器打开，控制加热棒的加热，使水温上升，水温加热到之前设置的温度。鼓风机模拟自动定时投食模块，设置时间一分钟以后投食，鼓风机转动十秒钟，十秒钟以后鼓风机自动关闭。光照传感器感知周围的温度变化，并且传送给单片机，如果周围温度低于设定值，灯光自动打开，高于设定值，则自动关闭。</p><p>系统实际测试效果：将主控制板和鱼缸模型进行连接，打开电源开关，用按键设置自动补光的强度为100 Lux，当周围光照强度低于100 Lux时，LED发光二极管自动打开，进行补光；周围光照强度高于100 Lux时，LED发光二极管自动关闭。效果图如图11所示。</p><p>图11. 系统测试图</p></sec><sec id="s8"><title>6. 结束语</title><p>本文研究并设计了基于单片机及鱼塘模型的智慧养鱼控制系统，模拟实现了养鱼的智能化。系统硬件部分主要分为主控制单元时钟模块、光照强度检测模块、加热模块、温度检测模块、自动投喂模块、LCD键盘显示模块、电源模块；软件设计分为LCD1602液晶显示模块、温度传感器检测模块、光照传感器检测模块、继电器加热模块。系统测试结果显示：通过继电器模块﹑传感器模块以及单片机控制模块，系统可实现温度和光照的自动调节以及定时投喂等操作。通过上述分析可得：该控制系统可稳定运行，成本低廉，操作简单，不仅仅可促进渔业的智能化发展，而且通过其展示作用可使得养殖户更易接受智慧养殖，促进其进一步推广。</p></sec><sec id="s9"><title>文章引用</title><p>吉春雷,谈格,许杰,奚诗秋. 基于单片机及鱼塘模型的智慧养鱼控制系统设计Design of Intelligent Fish Culture Control System Based on MCU and Fish Pond Model[J]. 传感器技术与应用, 2019, 07(04): 121-128. https://doi.org/10.12677/JSTA.2019.74014</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.32228-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">刘伟, 林开司, 刘安勇. 基于物联网的鱼缸智能控制系统设计与实现[J]. 淮海工学院学报(自然科学版), 2016, 25(4): 1-4.</mixed-citation></ref><ref id="hanspub.32228-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">茆毓琦. 基于大数据技术的智慧水产养殖系统研究[D]: [硕士学位论文]. 青岛: 青岛科技大学, 2018.</mixed-citation></ref><ref id="hanspub.32228-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">廖静. 水产进入智慧养殖时代[J]. 农家之友, 2018(1): 30.</mixed-citation></ref><ref id="hanspub.32228-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">施紫楠. “渔夫博士”的智慧养鱼梦[J]. 农家之友, 2019(4): 39-40.</mixed-citation></ref><ref id="hanspub.32228-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">江钊鹏. 基于AVR单片机的智能养鱼控制系统设计与开发[J]. 电子技术与软件工程, 2016(4): 255-256.</mixed-citation></ref><ref id="hanspub.32228-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">章程. 基于51单片机智能家居的设计[J]. 智库时代, 2019(7): 282-288.</mixed-citation></ref><ref id="hanspub.32228-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">王伟杰, 叶超, 卢克祥, 等. 基于GY-30的集鱼灯多点同步无线测光系统设计[J]. 渔业现代化, 2016, 43(5): 62-66.</mixed-citation></ref><ref id="hanspub.32228-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">郑三婷. 温度传感器DS18B20在温度计设计中的应用[J]. 电子制作, 2019(12): 92-93.</mixed-citation></ref><ref id="hanspub.32228-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">史静, 李煜. 一种基于单片机和LCD1602的多行文本显示方法[J]. 科技视界, 2017(20): 61-62.</mixed-citation></ref><ref id="hanspub.32228-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">杨世权, 张谦述, 周聪. 多路BH1750光强检测系统的设计[J]. 太原学院学报(自然科学版), 2018, 36(4): 64-68.</mixed-citation></ref></ref-list></back></article>