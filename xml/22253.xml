<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">HJBM</journal-id><journal-title-group><journal-title>Hans Journal of Biomedicine</journal-title></journal-title-group><issn pub-type="epub">2161-8976</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/HJBM.2017.74012</article-id><article-id pub-id-type="publisher-id">HJBM-22253</article-id><article-categories><subj-group subj-group-type="heading"><subject>HJBM20170400000_79184108.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>医药卫生</subject></subj-group></article-categories><title-group><article-title>
 
 
  液体T
  <sub>2</sub>弛豫时间测量CPMG磁共振脉冲序列实现与应用
  The Implementation and Application of CPMG NMR Pulse Sequence for Measuring T
  <sub>2</sub> Relaxation Time with Clinical MRI Scanner
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>子剑</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>进喜</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>聂</surname><given-names>斌</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>单</surname><given-names>常征</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>潘</surname><given-names>洋</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>锦</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>泰山医学院医学信息工程学院，山东 泰安</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><aff id="aff1"><addr-line>泰山医学院放射学院，山东 泰安</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>zjzh@tsmc.edu.cn(赵子)</email>;<email>wjx941@163.com(王进)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>09</day><month>10</month><year>2017</year></pub-date><volume>07</volume><issue>04</issue><fpage>73</fpage><lpage>78</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   目的：探讨在i_Open 0.36T医用磁共振成像(MRI)系统上开发测试液体T<sub>2</sub>横向弛豫时间Carr-Purcell-Meiboom-Gill (CPMG)序列的可行性与实现方法。方法：pascal语言编辑源程序，可调参数控制激发脉冲波形，相位，幅度，持续时间等属性，回波间隔，数据采集次数，采样点数，采样时间等，编排数据记录方式，满足反演求T<sub>2</sub>的需要。编译源程序，上机调试实验，测试样品T<sub>2</sub>，与标准值比较。结果：完成了CPMG序列源代码，编译的可行性文件能够在商业磁共振成像仪上运行，测得的CuSO<sub>4</sub>溶液样品的T<sub>2</sub>值为197.479 ms。结论：利用该方法实现的CPMG序列所测样品T<sub>2</sub>值与标称值一致，满足实际应用需要，利用该方法实现CPMG序列是可行的。 Objective: To implement Carr-Purcell-Meiboom-Gill pulse sequence for T<sub>2</sub> relaxation measuring in i_Open 0.36T clinical MRI scanner. Methods: Pascal language is engaged to edit source code. Waveform, phase, amplitude and maintaining time of the excited RF pulse, spacing time of echoes, number of times of data sampling, sampling points, sampling time, and so on are all controlled by sequence parameters. Data logging form was arranged to meet the need of T<sub>2</sub> inversion. Source code of sequence was compiled to executable file and is loaded to RINMR software. Comparison was taken between measuring time of sample of CuSO<sub>4</sub> solution with our pulse sequence and the given standard value. Results: Source code of CPMG sequence was done as well as the exe file can run with commercial MRI instrumentation. The measuring T<sub>2</sub> relaxation time of sample was 197.479 ms. Conclusion: The T<sub>2</sub> value computed with our data acquired by our CPMG sequence is consistent with the given nominal value. The CPMG sequence adequately satisfies the practical application and the method can be used to implement the pulse sequence.
    
  
 
</p></abstract><kwd-group><kwd>核磁共振，脉冲序列，CPMG，实现应用, Nuclear Magnetic Resonance</kwd><kwd> Pulse Sequence</kwd><kwd> CPMG</kwd><kwd> Implementation and Application</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>液体T<sub>2</sub>弛豫时间测量CPMG磁共振脉冲 序列实现与应用<sup> </sup></title><p>赵子剑<sup>1</sup>，王进喜<sup>1*</sup>，聂斌<sup>2</sup>，单常征<sup>1</sup>，潘洋<sup>1</sup>，刘锦<sup>1</sup></p><p><sup>1</sup>泰山医学院放射学院，山东 泰安</p><p><sup>2</sup>泰山医学院医学信息工程学院，山东 泰安</p><disp-formula id="hanspub.22253-formula1"><graphic xlink:href="//html.hanspub.org/file/1-1530091x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2017年9月18日；录用日期：2017年10月2日；发布日期：2017年10月9日</p><disp-formula id="hanspub.22253-formula2"><graphic xlink:href="//html.hanspub.org/file/1-1530091x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>目的：探讨在i_Open 0.36T医用磁共振成像(MRI)系统上开发测试液体T<sub>2</sub>横向弛豫时间Carr-Purcell-Meiboom-Gill (CPMG)序列的可行性与实现方法。方法：pascal语言编辑源程序，可调参数控制激发脉冲波形，相位，幅度，持续时间等属性，回波间隔，数据采集次数，采样点数，采样时间等，编排数据记录方式，满足反演求T<sub>2</sub>的需要。编译源程序，上机调试实验，测试样品T<sub>2</sub>，与标准值比较。结果：完成了CPMG序列源代码，编译的可行性文件能够在商业磁共振成像仪上运行，测得的CuSO<sub>4</sub>溶液样品的T<sub>2</sub>值为197.479 ms。结论：利用该方法实现的CPMG序列所测样品T<sub>2</sub>值与标称值一致，满足实际应用需要，利用该方法实现CPMG序列是可行的。</p><p>关键词 :核磁共振，脉冲序列，CPMG，实现应用</p><disp-formula id="hanspub.22253-formula3"><graphic xlink:href="//html.hanspub.org/file/1-1530091x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>核磁共振(nuclear magnetic resonance, NMR)现象自被发现以来，应用领域不断扩大，应用层次不断深化，已发展成为许多领域举足轻重的技术 [<xref ref-type="bibr" rid="hanspub.22253-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref3">3</xref>] 。物质的弛豫时间是与NMR技术应用相关的两个重要属性，CPMG序列是测量样品本征横向弛豫时间的主要方式。NMR技术的核心是脉冲序列 [<xref ref-type="bibr" rid="hanspub.22253-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref5">5</xref>] ，近十几年来，我国科研工作者开始关注序列开发实现技术 [<xref ref-type="bibr" rid="hanspub.22253-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref8">8</xref>] ，但技术核心仍然掌握在发达国家手中。出于利益考虑，各大厂商的脉冲序列实现方法一直是商业机密。因此，研究脉冲序列的实现方法对于磁共振商业机器软硬件核心的国产化具有很重要的商业价值和实际意义。本文探讨基于RI谱仪的CPMG (Carr-Purcel1-Meiboom-Gill, CPMG)脉冲序列实现方法，并给出对样品的测试结果。</p></sec><sec id="s4"><title>2. 方法</title><sec id="s4_1"><title>2.1. 序列时序</title><p>CPMG脉冲序列的时序示意图如图1所示。X方向90˚射频脉冲后间隔TE/2时间施加Y方向180˚翻转脉冲，适时开启采样命令，对信号进行采样，TE时刻出现回波峰值，−Y方向施加180˚脉冲，采集回波，&#177;Y方向依次连续施加多个180˚脉冲，在相应时间窗口依次对相应回波采样，每隔TR时间重复上述过程，循环NS次(NS为叠加次数，即单一的序列执行次数)，原始数据(RAW data)依次存入序列预先开辟的内存空间(k空间)，完成回波数据的采集。数据可以用命令行方式以约定格式存储到硬盘，方便后续的调用和处理 [<xref ref-type="bibr" rid="hanspub.22253-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref10">10</xref>] 。</p><p>图1. CPMG序列时序示意图</p></sec><sec id="s4_2"><title>2.2. 编码实现</title><p>我们所用设备为万东医疗公司生产的i_Open 0.36T永磁磁共振，谱仪组件来自于英国的RI公司，支持pascal语言编码脉冲序列，pascal语言虽然不够直观，但是能够控制序列中的几乎所有元素，可以实现复杂精微的功能。利用RI提供的底层接口协议层，编程语言用pascal，按照编程规范 [<xref ref-type="bibr" rid="hanspub.22253-ref9">9</xref>] 实现各事件元素。序列首先开辟大小为SI &#215; C25 (SI为每个回波的采样点数，C25为序列运行一次的回波数)个32字节(每个数据点是一个复数，实部虚部都是占16个字节的实数)的内存空间用于存放采集到的原始数据。如果采集次数NS大于1，则第二次以后采集的数据与原有数据进行累加，由于噪声的随机性，可使信号的SNR提高到NS<sup>1/2</sup>倍。序列中的各变量因素，主要包括90˚激发脉冲持续时间、幅度、相位；180˚激发脉冲持续时间、幅度、相位；90˚和180˚脉冲时间间隔；主频率控制；偏移量控制，采样间隔，采样点数等均能通过可调参数实时修改得到反馈结果。</p></sec><sec id="s4_3"><title>2.3. 序列编译与测试</title><p>将序列源代码与RI提供的库文件一同编译连接，得到可执行文件，加载到磁共振调试软件，通过互动界面调试，通过后再测试样品T<sub>2</sub>。根据实际需要初步确定实验参数，然后根据实验信号调整各个参数，T<sub>2</sub>反演是用我们开发的软件实现，对于测试用的某浓度CuSO<sub>4</sub>水溶液样品(标称值T<sub>2</sub> = 200 ms)最后确定一组比较理想的参数如下：激发脉冲为的高斯脉冲,脉冲宽度3 ms，TR = 3000 ms，TE = 32 ms，DW = 28 μs，SI = 512，NS = 2，C25 = 16。利用反演软件对采集数据根据反演算法求样品T<sub>2</sub>，与标准值对照验证。</p></sec></sec><sec id="s5"><title>3. 结果</title><sec id="s5_1"><title>3.1. 序列源文件</title><p>序列源文件是本系统最重要的部分，也是系统最重要的体现，在该模块中，使用者可以进行底层控制和参数内容调整，同时也可以对一些问题进行逻辑分析。</p></sec><sec id="s5_2"><title>3.2. 可执行文件</title><p>设计的脉冲序列编译后，形成一个可执行文件，然后由谱仪软件RINMR调用，加载到系统，采用图形界面的命令行方式，实时向谱仪控制软件发送指令，改变脉冲序列的参数，实现激发和数据采集功能。</p></sec><sec id="s5_3"><title>3.3. 公式</title><p>利用选定参数的理论分析结果和实验采集的数据及其反演结果如图2~4所示。</p><p>图2中横坐标的数字1，2，3，……处为回波峰值的所在时间点。</p><p>图2. 理论结果：各回波峰值按T<sub>2</sub>参数成指数衰减的曲线</p><p>图3. 实验结果：各回波峰值按T<sub>2</sub>参数成指数衰减的曲线</p><p>图4. T<sub>2</sub>反演结果：197.479 ms</p></sec></sec><sec id="s6"><title>4. 讨论</title><p>尽管FID实验对于设定磁共振仪器的基本参数非常有用，但也有许多缺点。主要是通过FID获取的数据波形不仅受样品本身，还与样品范围内的磁场均匀度有关。样品的本征弛豫时间数据是区分不同组织，进行图像加权技术的基础，众多科研工作者需要研究样品本身属性对核磁共振信号的影响，因此去除磁场不均匀效应对信号衰减的贡献就非常有用了 [<xref ref-type="bibr" rid="hanspub.22253-ref11">11</xref>] ，而CPMG序列正可以实现这一目的。脉冲序列作为磁共振成像技术的核心，其各种序列参数(RF脉冲形状、幅度、相位循环；梯度形状、幅度；相位编码步；采样间隔；叠加次数；空扫次数；TR；TE；接收带宽)的设置，均可影响到信号。无论对技术人员还是诊断医生，深入理解序列参数与信号之间的关系，均具有重要的实际意义。各MRI设备生产厂家，出于技术保护等原因，生产的MRI商品只有少数参数能在极其有限的范围内改变，意义也在种种界面的包装下变得模糊不清。我们利用Tubro Pascal语言，通过变量控制的方式，设计实现各种参数可调的CPMG脉冲序列，以可执行文件形式由谱仪软件调用，加载到系统，采用图形界面的命令行方式，实时向谱仪控制软件发送指令，改变脉冲序列的参数，实现丰富而灵活的控制，对于理解NMR原理和技术实现提供了良好的桥梁。</p><p>序列中的激发脉冲形状可以在文本文件中定义，可以根据需要使用任意波形，幅度和相位分别由变量控制，可以在序列调试过程中根据反馈信号实时修改，完全由序列调试人员控制。</p><p>我国生产磁共振扫描机的企业大多采用组装的方式，核心部件谱仪大多依赖进口，序列开发的研究近年来进步较大，有系列研究发表 [<xref ref-type="bibr" rid="hanspub.22253-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.22253-ref8">8</xref>] ，但与国际先进水平尚有较大差距。</p><p>项目组的最终成果是能够应用于商业机器的脉冲序列，包括文本，源程序，编译的可执行文件，特色是丰富了原机器自带序列参数控制极其有限的弱点，大大增加了可实时调整的参数和因素。通过实施该项目，我们学到了很多课堂上无法学到的东西，增加了实践动手能力，培养了团结协作的团队精神，对软件产品开发的方方面面有了具体而深刻的体会，必将对将来的工作就业产生积极的影响。</p></sec><sec id="s7"><title>资助信息</title><p>国家级大学生创新创业训练计划项目(201510439162)。</p></sec><sec id="s8"><title>文章引用</title><p>赵子剑,王进喜,聂 斌,单常征,潘 洋,刘 锦. 液体T<sub>2</sub>弛豫时间测量CPMG磁共振脉冲序列实现与应用The Implementation and Application of CPMG NMR Pulse Sequence for Measuring T<sub>2</sub> Relaxation Time with Clinical MRI Scanner[J]. 生物医学, 2017, 07(04): 73-78. http://dx.doi.org/10.12677/HJBM.2017.74012</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.22253-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">谢狄霖, 陈忠. 脑活动功能磁共振成像研究进展[J]. 中国医学影像技术, 2004, 20(11): 1657-1662.</mixed-citation></ref><ref id="hanspub.22253-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Edelman, R.E., Siewert, B., Darby, D.G., et al. (1994) Qualitative Mapping of Cerebral Blood Flow and Functional Localization with Echo-Planar MR Imaging and Signal Targeting with Alternating Radio Frequency. Radiology, 192, 513-520. &lt;br&gt;https://doi.org/10.1148/radiology.192.2.8029425</mixed-citation></ref><ref id="hanspub.22253-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Simonetti, O.P., Kim, R.J., Fieno, D.S., et al. (2001) An Im-proved MR Imaging Technique for the Visualization of Myocardial Infarction. Radiology, 218, 215-223.  
&lt;br&gt;https://doi.org/10.1148/radiology.218.1.r01ja50215</mixed-citation></ref><ref id="hanspub.22253-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">韩鸿宾. 掌握磁共振成像序列设计, 合理科学运用MR技术解决临床与科研工作中的实际问题[J]. 中国医学影像技术, 2004, 20(7): 979-980.</mixed-citation></ref><ref id="hanspub.22253-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Haacke, E.M., Brown, R.W., Thompson, M.R., 等. 核磁共振成像物理原理和脉冲序列设计[M]. 曾晓庄, 包尚联, 译. 北京: 中国医药科技出版社, 2007.</mixed-citation></ref><ref id="hanspub.22253-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">韩鸿宾. 临床磁共振成像序列设计与应用[M]. 北京: 北京大学医学出版社, 2007.</mixed-citation></ref><ref id="hanspub.22253-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">黄敏, 林颖, 陈军波. 压缩感知磁共振成像脉冲序列的设计与实现[J]. 生物医学工程研究, 2015, 34(2): 67-73.</mixed-citation></ref><ref id="hanspub.22253-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">黄敏, 廖玚, 郭晶磊. 快速自旋回波脉冲序列的设计与实现[J]. 生物医学工程研究, 2012, 31(1): 11-14.</mixed-citation></ref><ref id="hanspub.22253-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Resonance Instruments Ltd. (2004) DRX Programming User Manual [EB]. Whitney Oxford Shire, United Kingdom, 7-38.</mixed-citation></ref><ref id="hanspub.22253-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">熊国欣, 李立本, 编. 核磁共振成像原理[M]. 北京: 科学出版社2007.</mixed-citation></ref><ref id="hanspub.22253-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Giri, S., Chung, Y., Merchant, A., et al. (2009) T2 Quantification for Improved Detection of Myocardial Edema. Journal of Cardiovascular Magnetic Resonance, 11, 56-56. &lt;br&gt;https://doi.org/10.1186/1532-429X-11-56</mixed-citation></ref></ref-list></back></article>