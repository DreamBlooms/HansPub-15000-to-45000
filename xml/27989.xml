<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SA</journal-id><journal-title-group><journal-title>Statistics and Application</journal-title></journal-title-group><issn pub-type="epub">2325-2251</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SA.2018.76071</article-id><article-id pub-id-type="publisher-id">SA-27989</article-id><article-categories><subj-group subj-group-type="heading"><subject>SA20180600000_32923069.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于空间克里金插值的黑河流域土壤水分研究
   Study on Soil Moisture of Heihe River Based on Spatial Kriging
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>晞曈</given-names></name><xref ref-type="aff" rid="aff1"><sub>1</sub></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>长安大学，陕西 西安</addr-line></aff><pub-date pub-type="epub"><day>29</day><month>11</month><year>2018</year></pub-date><volume>07</volume><issue>06</issue><fpage>622</fpage><lpage>629</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   空间克里金是地统计学中重要的一类插值方法，它通过对研究变量在研究区域内的空间自相关性进行建模，对待估计的点给出无偏最优估计。本文以黑河上游的典型灌溉农田土壤水分为研究对象，利用R
   软件中的相关扩展包，分析观测数据的空间变异性，构建研究区域内土壤水分含量的空间克里金插值模型，得到该区域内土壤水分含量的空间估计，为进一步研究该流域的生态水文过程提供了必要的指标。
    Spatial kriging is one of the most important interpolation methods in geostatistics, which models the spatial autocorrelation of the interested variable in the region and provides the unbiased optimized estimation. This article studies the soil moisture in the upstream of the Heihe River, and analyzes the spatial variability of the observations using the R software packages. The spatial kriging model was constructed to calculate the estimation of the soil moisture in the whole region and provide the necessary index for further study of hydrological process in the region. 
  
 
</p></abstract><kwd-group><kwd>地统计学，区域化变量，空间克里金，土壤水分,  Geostatistics</kwd><kwd> Regional Variable</kwd><kwd> Spatial Kriging</kwd><kwd> Soil Moisture</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于空间克里金插值的黑河流域土壤水分研究<sup> </sup></title><p>张晞曈</p><p>长安大学，陕西 西安</p><p><img src="//html.hanspub.org/file/6-2580423x1_hanspub.png" /></p><p>收稿日期：2018年11月20日；录用日期：2018年12月6日；发布日期：2018年12月13日</p><disp-formula id="hanspub.27989-formula49"><graphic xlink:href="//html.hanspub.org/file/6-2580423x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>空间克里金是地统计学中重要的一类插值方法，它通过对研究变量在研究区域内的空间自相关性进行建模，对待估计的点给出无偏最优估计。本文以黑河上游的典型灌溉农田土壤水分为研究对象，利用R软件中的相关扩展包，分析观测数据的空间变异性，构建研究区域内土壤水分含量的空间克里金插值模型，得到该区域内土壤水分含量的空间估计，为进一步研究该流域的生态水文过程提供了必要的指标。</p><p>关键词 :地统计学，区域化变量，空间克里金，土壤水分</p><disp-formula id="hanspub.27989-formula50"><graphic xlink:href="//html.hanspub.org/file/6-2580423x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by author and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/6-2580423x7_hanspub.png" /> <img src="//html.hanspub.org/file/6-2580423x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>地统计学(又称地质统计学)是在传统的统计学基础上，以区域化变量为基础，采用变异函数为主要工具，研究在空间分布上具有自相关性的自然现象的科学 [<xref ref-type="bibr" rid="hanspub.27989-ref1">1</xref>] 。克里金(Kriging)插值法，又称空间局部估计法，是地统计学的主要内容之一。它不同于传统基于距离的空间插值法，比如反距离加权法，只考虑了待测点周围的数据，直接通过插值公式得到结果 [<xref ref-type="bibr" rid="hanspub.27989-ref2">2</xref>] 。克里金法是从研究变量本身出发，根据已有样本点和待测点之间的空间位置关系来对自相关性进行建模，从而对待测点进行线性无偏的估计，同时还能给出估计的方差，比传统方法能更好地描述所研究的地理现象 [<xref ref-type="bibr" rid="hanspub.27989-ref3">3</xref>] 。</p><p>土壤是联系大气水、地表水、地下水和植物水并进行水分交换的核心地带，揭示土壤水文性质的空间分布特征是研究流域生态–水文过程的重要一环 [<xref ref-type="bibr" rid="hanspub.27989-ref4">4</xref>] ，土壤水分含量是水文过程分析中重要的一个指标。本文以流经青海省的黑河上游八宝河流域的土壤水分为研究对象，根据已有的无线传感器网络点收集的土壤水分数据，利用空间普通克里金法对研究区域内的土壤水分进行插值，得到整个地区土壤水分的分布估计，并给出估计方差，为进一步的水文环境分析提供了必要的指标。</p></sec><sec id="s4"><title>2. 空间克里金方法简介</title><sec id="s4_1"><title>2.1. 区域化变量</title><p>区域化变量是指能用空间分布来表征一个自然现象的变量，也就是将空间位置作为随机函数的自变量，它是地统计学中重要的基础理论 [<xref ref-type="bibr" rid="hanspub.27989-ref5">5</xref>] 。设研究区域的位置集合为D ( D ⊆ R 2 或者 D ⊆ R 3 )，空间位置表示为 x ∈ D ，所研究的变量在该处的属性值为 Z ( x ) 。也就是说，将所研究的地质现象看作研究区域D内以空间位置 为参数的随机函数 Z ( x ) 。</p><p>区域化变量在描述研究对象的空间结构性时，是从空间点对的角度出发的。设研究区域内任意两点为 x 1 ∈ D , x 2 ∈ D ，两点之间的距离向量为 h ∈ D ，则这两点之间属性的空间相关性通常用 Z ( x 1 ) , Z ( x 2 ) 之间的一阶矩和二阶矩来刻画。</p><p>区域化变量 Z ( x ) 的自协方差函数定义为空间两点x和 x + h 处的随机变量 Z ( x ) 和 Z ( x + h ) 的二阶混合中心矩，即</p><p>C ( x , h ) = Cov [ Z ( x ) , Z ( x + h ) ] = E [ Z ( x ) Z ( x + h ) ] − E [ Z ( x ) ] ⋅ E [ Z ( x + h ) ] (1)</p><p>通常出于研究需要，对于区域化变量的性质需要做出一些假设，最常见的就是如下的平稳假设 [<xref ref-type="bibr" rid="hanspub.27989-ref5">5</xref>] 。当区域化变量满足下列两个条件时，称该区域化变量满足二阶平稳假设：</p><p>1).在研究区域内，区域化变量 Z ( x ) 的数学期望存在且为常数：</p><p>E [ Z ( x ) ] = E [ Z ( x + h ) ] = m (2)</p><p>2). 在研究区域内，区域化变量 的协方差存在且只依赖于两点之间空间距离h：</p><p>Cov [ Z ( x ) , Z ( x + h ) ] = E [ Z ( x ) Z ( x + h ) ] − m 2 (3)</p><p>在二阶平稳假设下，协方差函数 C ( x , h ) 可以简记为 C ( h ) ，也就是只和点对之间的距离向量有关。</p></sec><sec id="s4_2"><title>2.2. 变异函数</title><p>变异函数是地统计学特有的工具，是许多地统计学计算的基础，它定义为区域化变量 Z ( x ) 在空间点x和 x + h 处属性值之差 Z ( x ) − Z ( x + h ) 的方差的一半，即</p><p>γ ( x , h ) = 1 2 V a r [ Z ( x ) − Z ( x + h ) ] = 1 2 E { [ Z ( x ) − Z ( x + h ) ] 2 } − 1 2 { E [ Z ( x ) ] − E [ Z ( x ) ] } 2 (4)</p><p>严格来说，变异函数应当叫做半变异函数，因为前面有系数，但是这只是为了公式推导方便，所以通常不做区分。</p><p>在二阶平稳的假设下，变异函数和协方差函数之间通常有如下关系 [<xref ref-type="bibr" rid="hanspub.27989-ref6">6</xref>] ：</p><p>γ ( x , h ) = γ ( h ) = C ( 0 ) − C ( h ) (5)</p><p>变异函数是地统计学研究的出发点，对于空间变量之间的自相关性的刻画都是从变异函数出发而不是从协方差函数出发。一般来说，两点之间距离越远，也就是h越大，变差函数的值越大，此时两点之间的相关性越小。</p><p>在二阶平稳假设下变异函数是关于距离h的函数，该函数有指数模型、球状模型和高斯模型等 [<xref ref-type="bibr" rid="hanspub.27989-ref3">3</xref>] 。实际应用中，变异函数的具体表达式需要通过拟合得到。首先根据已有样本点数据计算每两个样本点之间的距离h和相应的实验变异函数值 [ Z ( x ) − Z ( x + h ) ] 2 ，n个样本点两两之间总共可以得到 n ( n − 1 ) / 2 对值，以h为横坐标、 [ Z ( x ) − Z ( x + h ) ] 2 为纵坐标对这些值绘制散点图可以得到变异函数云图 [<xref ref-type="bibr" rid="hanspub.27989-ref7">7</xref>] ，变异函数云图通常用于分析原始数据之间是否存在自相关性。然后对上述 n ( n − 1 ) / 2 对值进行聚合，根据如下(6)式计算实验变异函数值 [<xref ref-type="bibr" rid="hanspub.27989-ref7">7</xref>] ，</p><p>γ * ( h ) = 1 2 N ( h ) ∑ i = 1 N ( h ) [ Z ( x i ) − Z ( x i + h ) ] 2 (6)</p><p>这里 N ( h ) 表示距离之差为 的点对数量。最后选定变异函数的模型，使用上述得到的实验变异函数值对其中的参数进行拟合得到理论变异函数的表达式 [<xref ref-type="bibr" rid="hanspub.27989-ref6">6</xref>] 。</p></sec><sec id="s4_3"><title>2.3. 空间克里金插值</title><p>不同的克里金插值法在估计的条件和细节上略有不同，本文以普通克里金(Ordinary Kriging)为例，阐述克里金插值法的基本原理 [<xref ref-type="bibr" rid="hanspub.27989-ref3">3</xref>] 。克里金插值的基本思想是利用空间上所有已知点的属性值，进行加权求和来估计未知点处的值，本质上也是一个线性估计量。设已知观测点集合为 { x i | i = 1 , 2 , ⋯ , n } ，空间点 x i 处的属性值为 Z ( x i ) ，简记为 Z i 。待估计的点为 x 0 ，待估计点的实际值为 Z ( x 0 ) ，简记为 Z 0 ，估计值为 Z ( x 0 ) * ，简记为 Z 0 * 。</p><p>待测点 x 0 的估计值 Z 0 * 由如下的线性估计式给出</p><p>Z 0 * = ∑ i = 1 n λ i Z i (7)</p><p>关键在于如何确定这些权重 λ i ( i = 1 , 2 , ⋯ , n ) 的值。</p><p>克里金方法是一种在满足无偏性的条件下寻求估计方差最小的权重系数，所以克里金插值问题可以写成一个有约束条件的优化问题 [<xref ref-type="bibr" rid="hanspub.27989-ref3">3</xref>] ：</p><p>{ min Var [ Z 0 * − Z 0 ] s .t E [ Z 0 * ] = Z 0 (8)</p><p>上述优化问题可以展开成如下的优化问题模型：</p><p>{ min C ( Z 0 , Z 0 ) + ∑ i = 1 n ∑ j = 1 n   λ i λ j C ( Z i , Z j ) − 2 ∑ i = 1 n   λ i C ( Z 0 , Z i ) s .t ∑ i = 1 n   λ i = 1 (9)</p><p>这里 C ( Z i , Z j ) 表示 C ( | x i − x j | ) ，也就是根据点对 x i 和 x j 之间的距离计算得到的协方差值，这个值通常是利用(5)式由已经拟合的理论变异函数计算得到。</p><p>(9)式的优化问题可以采用拉格朗日法转化为无约束优化问题求解出一系列的权重值，从而得到待估计点 x 0 的最小方差无偏估计。</p></sec></sec><sec id="s5"><title>3. 黑河土壤水分的空间克里金插值</title><p>本文采用R软件中的gstat包来对黑河流域的土壤水分含量进行空间克里金插值。空间克里金插值一般分为三个步骤：</p><p>1) 根据已有样本点数据绘制变异函数云图和实验变异函数图，进行初步分析；</p><p>2) 选择变异函数模型，拟合实验变异函数；</p><p>3) 对待估计点进行空间克里金插值，给出估计方差。</p><sec id="s5_1"><title>3.1. 数据来源</title><p>本文使用了来自于黑河数据管理计划寒区旱区科学数据中心(http://westdc.westgis.ac.cn/)的黑河生态水文遥感试验数据集 [<xref ref-type="bibr" rid="hanspub.27989-ref8">8</xref>] ，该数据集由黑河流域上游生态水文无线传感器网络WATERNET于2013年收集，这里使用了当年8月24号的观测数据。该数据集包括黑河上游八宝河流域内40个WATERNET节点的观测数据，这40个节点的数采仪编号为10~49，但是其中第46和48号数采仪在8月24号这天的数据由于外界因素有缺失，所以实际使用的是38个节点提供的观测数据，这些节点的分布如图1所示 [<xref ref-type="bibr" rid="hanspub.27989-ref8">8</xref>] 。</p><p>图1. 黑河上游区域WSN节点分布</p><p>每个节点都含有4 cm，10 cm，20 cm三个深度的土壤水分数据，这里以4 cm深度的土壤水分含量为对象。数采仪每5分钟采集一次数据，这样的观测频率过于密集，所以需要对原始数据进行聚合，这里以天为单位，每个节点取8月24号观测数据的平均值。处理后的各节点分布以及土壤水分含量分布见图2 (单位：cm<sup>3</sup>/cm<sup>3</sup>)。</p><p>图2. 土壤水分含量观测值分布(单位：cm<sup>3</sup>/cm<sup>3</sup>)</p></sec><sec id="s5_2"><title>3.2. 绘制变异函数云图和实验变异函数图</title><p>首先根据已有38个节点的土壤水分含量数据绘制变异函数云图和实验变异函数图。由于不同方向上土壤水分的变化趋势可能不相同，表现为各向异性 [<xref ref-type="bibr" rid="hanspub.27989-ref3">3</xref>] ，这里选择了正北(0˚)、东北(45˚)、正东(90˚)和东南(135˚)四个方向分别绘制图像，以判断变化趋势较为明显的方向。绘制的变异函数云图见图3，实验变异函数图见图4。</p><p>图3. 四个方向的变异函数云图</p><p>由变异函数云图和实验变异函数图可以看出，正北和东北两个方向的点对数量较少，变异函数云图上表现为图3中点的数量较少，不利于变异函数的计算，同时由图4中也可以看出，这两个方向上的实验变异函数散点图过于稀疏，无法反映自相关性。正东和东南两个方向的点对数量较多，但是在图4的实验变异函数图像中，正东方向的变化程度没有东南方向的显著，东南方向的实验变异函数散点图分布趋势较为陡峭，而正东方向的实验变异函数散点图分布较为平缓。所以最终选择东南方向的实验变异函数来进行拟合。</p><p>图4. 四个方向的实验变异函数图</p><p>同时，应当注意到，在滞后距离(lag distance)超过60 km的时候，图3中东南方向的变异函数云图中的点明显变少，这是导致图4中东南方向的实验变异函数图像忽然下降的原因，点的数目变少后，计算得到的方差也就降低了，也就是说，过少的点数计算得到的方差不具有代表性，所以这里只选择滞后距离在65 km以内的实验变异函数点进行拟合。</p></sec><sec id="s5_3"><title>3.3. 拟合变异函数模型</title><p>得到上述的实验变异函数图像后，需要选择变异函数模型来进行拟合。常用的变异函数模型有球状模型和指数模型 [<xref ref-type="bibr" rid="hanspub.27989-ref3">3</xref>] 。球状模型的表达式如(10)式所示：</p><p>γ ( h ) = { 0 ,     h = 0 C 0 + C ( 3 2 ⋅ h a − 1 2 ⋅ h 3 a 3 ) , 0 &lt; h ≤ a C 0 + C ,     h &gt; a (10)</p><p>指数模型的表达式如(11)式所示：</p><p>γ ( h ) = { 0 , h = 0 C 0 + C ( 1 − e − h a ) , h &gt; 0 (11)</p><p>上述两式中， C 0 为块金常数，C为偏基台值，a为变程。</p><p>拟合后得到的两个模型参数见表1：</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Fitted model parameter</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >参数</th><th align="center" valign="middle" >C<sub>0</sub></th><th align="center" valign="middle" >C</th><th align="center" valign="middle" >a</th><th align="center" valign="middle" >SSE</th></tr></thead><tr><td align="center" valign="middle" >球状模型</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0.01694676</td><td align="center" valign="middle" >31.22537</td><td align="center" valign="middle" >6.789126e-06</td></tr><tr><td align="center" valign="middle" >指数模型</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0.02330491</td><td align="center" valign="middle" >25.1821</td><td align="center" valign="middle" >5.870586e-06</td></tr></tbody></table></table-wrap><p>表1. 拟合的模型参数</p><p>拟合后两个模型的图形见图5：</p><p>图5. 变异函数拟合模型，左为指数模型，右为球状模型</p><p>由表1可知，指数模型的拟合误差SSE相比球状模型的较小，所以这里最终采用的是指数模型的变异函数。</p></sec><sec id="s5_4"><title>3.4. 空间克里金插值</title><p>得到了变异函数模型之后，选择需要插值的空间点，然后根据(9)式求解相应的优化问题，即可得到空间克里金插值。本文对于整个黑河上游八宝河区域都进行了插值，即先对八宝河流域网格化，然后在对每个网格中的点进行空间克里金插值，得到整个八宝河流域的土壤水分含量估计分布图，同时给出估计的方差。空间克里金插值的结果和方差分布如图6所示。</p><p>图6左边是空间克里金在整个区域的插值分布图，右侧是相应的方差分布图。左图可以看出八宝河流域土壤水分含量的大致分布，右图中标星号的点是已有的观测点，可以看出，在观测点附件的估计方差较小，远离观测点的地方估计方差较大，这与经验是相符合的。</p></sec></sec><sec id="s6"><title>4. 结论</title><p>本文利用地统计学中的空间克里金模型，根据已有观测点收集的数据，对黑河上游八宝河流域的土壤</p><p>图6. 空间克里金插值结果，左为插值图，右为方差图</p><p>水分进行了插值估计，并给出了估计方差，得到该流域土壤水分分布的一个估计，为进一步的水文环境分析提供了必要的指标。空间克里金模型相对于反距离加权法等传统的空间插值方法，不仅考虑了空间距离，还考虑了空间中点与点之间的相对位置以及自相关性，并且能给出估计精度，具有较高的实用性和可靠性。</p></sec><sec id="s7"><title>文章引用</title><p>张晞曈. 基于空间克里金插值的黑河流域土壤水分研究 Study on Soil Moisture of Heihe River Based on Spatial Kriging[J]. 统计学与应用, 2018, 07(06): 622-629. https://doi.org/10.12677/SA.2018.76071</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.27989-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">吕连宏, 张征, 迟志淼, 等. 地质统计学在环境科学领域的应用进展[J]. 地球科学与环境学报, 2006, 28(1): 105-109.</mixed-citation></ref><ref id="hanspub.27989-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">杨永川, 杨轲, 王志浩, 等. 空间插值法在热环境流动观测中的应用[J]. 中南大学学报(自然科学版), 2012, 43(9): 422-429.</mixed-citation></ref><ref id="hanspub.27989-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">刘爱利. 地统计学概论[M]. 北京: 科学出版社, 2012: 50-76.</mixed-citation></ref><ref id="hanspub.27989-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">晋锐, 李新, 阎保平, 罗万明, 李秀红, 郭建文, 马明国, 亢健, 张艳林. 黑河流域生态水文传感器网络设计[J].地球科学进展, 2012, 27(9): 993-1005.</mixed-citation></ref><ref id="hanspub.27989-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">李钟山. 地质统计学中的区域化变量理论[J]. 世界地质, 1997(2): 85-93.</mixed-citation></ref><ref id="hanspub.27989-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Oliver, M.A. and Webster, R. (2014) A Tutorial Guide to Geostatistics: Computing and Modelling Variograms and Kriging. Catena, 113, 56-69. &lt;br&gt;https://doi.org/10.1016/j.catena.2013.09.006</mixed-citation></ref><ref id="hanspub.27989-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Lichtenstern, A. (2013) Kriging Methods in Spatial Statistics.</mixed-citation></ref><ref id="hanspub.27989-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">亢健, 晋锐, 李新, 马明国. 黑河生态水文遥感试验: 黑河流域上游生态水文无线传感器网络WATERNET 2013年观测数据集[Z]. 黑河计划科学数据管理中心, 2014. &lt;br&gt;https://doi.org/10.3972/hiwater.219.2014.db</mixed-citation></ref></ref-list></back></article>