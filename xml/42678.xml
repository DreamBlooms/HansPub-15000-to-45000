<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2021.115159</article-id><article-id pub-id-type="publisher-id">CSA-42678</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20210500000_80300618.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  一种基于BEEPS滤波的红外图像细节增强算法
  An Infrared Image Detail Enhancement Algorithm Based on BEEPS Filtering
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>唐</surname><given-names>骏</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>高</surname><given-names>志强</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>顾</surname><given-names>鑫</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>朱</surname><given-names>家乙</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>沙</surname><given-names>怡中</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>耀芹</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>江苏北方湖光光电有限公司，江苏 无锡</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>08</day><month>05</month><year>2021</year></pub-date><volume>11</volume><issue>05</issue><fpage>1548</fpage><lpage>1554</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文改进了一种基于非线性双指数边缘滤波器(BEEPS)的红外细节增强算法，首先分离红外高低频信号，然后分别采用噪声可预见模型和自适应投影进行增强。仿真结果表明，改进算法的细节可视化增强效果明显。 In this paper, an improved infrared detail enhancement algorithm based on nonlinear double exponential edge filter (BEEPS) is presented. Firstly, the high and low frequency infrared signals are separated, and then the noise foreseeable model and adaptive projection are used to enhance the infrared detail. Simulation results show that the detail visualization enhancement effect of the improved algorithm is obvious. 
  
 
</p></abstract><kwd-group><kwd>BBEPS，细节增强，自适应投影，噪声可预见模型, BBEPS</kwd><kwd> Detail Enhancement</kwd><kwd> Adaptive Projection</kwd><kwd> Noise Predictable Model</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>本文改进了一种基于非线性双指数边缘滤波器(BEEPS)的红外细节增强算法，首先分离红外高低频信号，然后分别采用噪声可预见模型和自适应投影进行增强。仿真结果表明，改进算法的细节可视化增强效果明显。</p></sec><sec id="s2"><title>关键词</title><p>BBEPS，细节增强，自适应投影，噪声可预见模型</p></sec><sec id="s3"><title>An Infrared Image Detail Enhancement Algorithm Based on BEEPS Filtering</title><p>Jun Tang, Zhiqiang Gao, Xin Gu, Jiayi Zhu, Yizhong Sha, Yaoqin Zhang</p><p>Jiangsu North Huguang Photoelectric Co., Ltd., Wuxi Jiangsu</p><p><img src="//html.hanspub.org/file/36-1542170x4_hanspub.png" /></p><p>Received: Apr. 25<sup>th</sup>, 2021; accepted: May 20<sup>th</sup>, 2021; published: May 27<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/36-1542170x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>In this paper, an improved infrared detail enhancement algorithm based on nonlinear double exponential edge filter (BEEPS) is presented. Firstly, the high and low frequency infrared signals are separated, and then the noise foreseeable model and adaptive projection are used to enhance the infrared detail. Simulation results show that the detail visualization enhancement effect of the improved algorithm is obvious.</p><p>Keywords:BBEPS, Detail Enhancement, Adaptive Projection, Noise Predictable Model</p><disp-formula id="hanspub.42678-formula76"><graphic xlink:href="//html.hanspub.org/file/36-1542170x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/36-1542170x7_hanspub.png" /> <img src="//html.hanspub.org/file/36-1542170x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 概述</title><p>红外图像具有强大的穿透力、全天候作业能力和隐蔽被动探测能力，被广泛应用于工业资源勘探、民用昼夜监视和国防军事等领域。红外探测器输出的图像呈现出对比度低、细节少等缺陷，可通过图像增强算法进行改善。红外图像细节增强的算法经典算法是直方图均衡化 [<xref ref-type="bibr" rid="hanspub.42678-ref1">1</xref>]，基于深度学习的细节增强算法 [<xref ref-type="bibr" rid="hanspub.42678-ref2">2</xref>] 也是研究的热点。</p><p>目前，红外细节增强出现了一种基于将原始图像的高低频信号分离，然后分别进行增强的技术路线。该算法的核心是采用边缘保持和高频噪声抑制的非线性滤波器实现信号分层，比如双边滤波器 [<xref ref-type="bibr" rid="hanspub.42678-ref3">3</xref>] 和小波滤波器 [<xref ref-type="bibr" rid="hanspub.42678-ref4">4</xref>]。双边滤波器在空间方面的优化，拓展为带双指数的边缘滤波器(BEEPS, Bi-Exponential Edge-Preserving Smoother [<xref ref-type="bibr" rid="hanspub.42678-ref5">5</xref>] )。</p></sec><sec id="s6"><title>2. BEEPS滤波器</title><p>BEEPS滤波器与双边滤波器均由两个递归序列组成，其一的前向序列如式(1)所示，x表示原始红外图像，y表示滤波后的图像，r和λ分别代表滤波器的平滑系数：</p><p>y [ t ] = ( 1 − ρ [ t ] λ ) x [ t ] + ρ [ t ] λ y ( t − 1 ) (1)</p><p>ρ [ t ] = r ( x [ t ] , y [ t − 1 ] ) (2)</p><p>而另一个是后向递归序列，如下式(3)所示：</p><p>z [ t ] = ( 1 − ϱ [ t ] λ ) x [ t ] + ϱ [ t ] λ z [ t + 1 ] (3)</p><p>ϱ [ t ] = r ( x [ t ] , z [ t + 1 ] ) (4)</p><p>将上述合并，构成最终的输出序列：</p><p>m [ t ] = z [ k ] − ( 1 − λ ) x [ t ] + y [ t ] 1 + λ (5)</p><p>其中，r表示距离滤波器，采用高斯滤波函数，其中σ是控制滤波窗口大小的参数：</p><p>r ( u , v ) = e − ( u − v ) 2 2 σ 2 (6)</p><p>通常， ρ 和 ϱ 均为非线性参数，来源于高斯滤波函数。显然，BEEPS滤波器的计算只涉及到前后两个数据的递归运算，而双边滤波器要分析的是3 &#215; 3或者5 &#215; 5的邻近区域。为进一步提高运算效率，可按照图像的水平和垂直方向，分别同时并行计算，具体过程如下图1所示。</p><p>图1. 图像的BEEPS滤波并行处理策略</p><p>图2是红外图像和BEEPS滤波后第100列像素值的曲线图，其中红色曲线表示原始像素，蓝色曲线则表示滤波后的数据。BEEPS滤波器是一种低通滤波器，分析下图可知，在像素变化较为平坦的区域内，通过滤波处理可较为理想的保留原图像的边缘信息。BEEPS滤波可保证大量低频红外图像被保留下来，突变的边缘高频信息可通过与原始图像差分的方式提取出来。后续分别对高、低频分量采用不同的策略进行增强，基本流程如下图3所示。</p><p>图2. 原始图像的某列和其对应的BEEPS滤波后的曲线</p><p>图3. 细节增强的基本流程</p><p>滤波处理后的红外低频基层信号，具有较大的灰度动态分布区域。低频信号的增强可通过灰度拉伸、直方图投影，高频细节的增强常采用Gamma校正。</p></sec><sec id="s7"><title>3. 低频信号的自适应投影</title><p>红外低频图像通过直方图投影可拓展图像对比度，丰富图像细节。该算法首先计算图像的直方图信息Hn，根据设定的阈值T，进一步分析和标记该直方图。若该直方图的像素频数大于阈值，则标记为1，否则为0。然后，计算该直方图的累积分布函数DH，计算公式如下所示：</p><p>D H ( x ) = ∑ n = 0 x − 1 H n ( x ) (7)</p><p>该累积直方图的最值表征了有效统计灰度的个数，通过定义输出图像的灰度级范围(比如8比特图像数据的取值范围：0~255)，可实现该红外图像的直方图的投影。经典算法是采用固定频数阈值的直方图投影法，通过这样的阈值化操作，使得图像的灰度级总数变小，图像对比度得到显著提高。</p><p>BEEPS滤波后的低频基础层，以不同的阈值进行直方图投影，如图4所示。显然，场景1的最佳频数阈值为0.1%，场景2的最佳频数阈值为0.01%。</p><p>图4. 直方图投影效果图</p><p>根据上述分析，该算法过度依赖频数阈值，为在提升图像对比度的同时保留大量图像细节，提出如下改进计算公式：</p><p>T = ( H max − H min ) ∗ ( 1 − λ ) + H min (8)</p><p>H max 和 H min 分别表示图像有效灰度级的统计直方图中频数的最大和最小值。 λ 是是估算值，控制着输出图像中灰度级的跨度。如下图5所示， λ 为0.95的情况下，针对室内、室外两种典型场景的红外图像进行的仿真实验。实验结果表明：采用该算法可克服固定频数阈值的缺陷，具有一定的场景适应性。</p><p>图5. 自适应直方图投影效果图</p></sec><sec id="s8"><title>4. 高频细节的优化增强</title><p>高频细节增强算法，比如Gamma校正是一种全局化处理方案。由于人眼对噪声区域敏感性的差异，国外学者提出了噪声可见性原理，对应的数学模型如下式所示，式中y表示像素阈值，θ为可调参数，x表示噪声指示值，该值越大该像素点是噪声的可能性就越大。</p><p>y ( i , j ) = 1 x ( i , j ) ∗ θ + 1 (9)</p><p>考虑到BEEPS滤波器的非线性特性，可使用BEEPS滤波器的加权系数作为高频细节层自适应控制参数，为提高对背景噪声的抑制能力，采用以下的加权分析系数：</p><p>w ( i , j ) = 1 | φ | ∑ ( m , n ) ∈ φ i , j [ ( x ( i , j ) − μ m , n ) 2 σ m , n 2 + ε ] (10)</p><p>其中， μ m , n 和 σ m , n 表示像素的均值和方差，ε用于判定该像素归属特性，如果该区域的细节较为丰富，则 σ m , n 大于ε，w取值较大，归一化后接近于1，否则判定为噪声区域。</p><p>综上所述，高频细节层信号的增强处理模型如下式所示：</p><p>y d = y d ( i , j ) ∗ [ w ( i , j ) ∗ a + b ] (11)</p><p>其中，a和b为线性调节参数，用于将增益控制在合适的取值范围内。</p><p>如图6所示，在不同场景下的初始细节图、Gamma增强和优化增强后的效果图，显然改进算法在提升细节边缘相比Gamma增强具有较大的优势。与此同时，在克服高频噪声方面相比初始细节图也有不俗的表现。</p><p>图6. Gamma校正和改进算法比较</p></sec><sec id="s9"><title>5. 图像合并及图像细节增强效果评价</title><p>BEEPS滤波的基本层通过自适应直方图投影增强后，图像的对比度和亮度等得到较大的提升。通过差分得到的细节层保留了反映原始图像的微小边缘和噪声波动，结合噪声可预见性模型，实现带大量纹理信息的边缘的增强和高频噪声的抑制。将上述两者映射到合理的灰度动态范围(0~255)，并实现图像合并叠加，即可得到最终的红外细节增强的输出图像。</p><p>图像增强效果图如下图7所示，直观的看，最终细节增强后的图像不论对比度，还是细节纹理方面均有较大的提高。</p><p>为进一步分析改进算法和其他细节增强算法(DDE, Digital Detail Enhancement) (主要是基于双边滤波 [<xref ref-type="bibr" rid="hanspub.42678-ref6">6</xref>] DDE和引导滤波DDE [<xref ref-type="bibr" rid="hanspub.42678-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.42678-ref8">8</xref>]，使用这些算法滤波分层后的低频基层信号采用固定频数的直方图投影 [<xref ref-type="bibr" rid="hanspub.42678-ref9">9</xref>]，高频细节层信号采用Gamma增强 [<xref ref-type="bibr" rid="hanspub.42678-ref10">10</xref>]。)的差异，在多种场景的红外图像上，进行上述三种算法的图像细节增强效果的仿真比较。从主观分析图像质量的层面来看，改进的BEEPS细节增强算法在提升图像清晰度、对比度方面存在较大优势(比如场景1中的树叶纹理，远处房屋的轮廓、场景2中人物抬起的手臂细节等)。为客观量化考核图像质量，采用图像标准差、对比度、信息熵、平均梯度、边缘强度、图像清晰度和空间分辨率等进行分析比较，相关数据如下表1所示。对比各类量化客观考核指标，改进算法与其他算法相比均有优势。</p><p>图7. 红外细节增强效果对比图</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Quantitative evaluation list of image detail enhancemen</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >序号</th><th align="center" valign="middle"  colspan="2"  >算法/场景</th><th align="center" valign="middle" >信息熵</th><th align="center" valign="middle" >平均 梯度</th><th align="center" valign="middle" >边缘 强度</th><th align="center" valign="middle" >图像 清晰度</th><th align="center" valign="middle" >空间 分辨率</th><th align="center" valign="middle" >标准差</th><th align="center" valign="middle" >对比度</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >1</td><td align="center" valign="middle"  rowspan="2"  >引导 滤波</td><td align="center" valign="middle" >场景1</td><td align="center" valign="middle" >0.2</td><td align="center" valign="middle" >0.05</td><td align="center" valign="middle" >0.52</td><td align="center" valign="middle" >0.06</td><td align="center" valign="middle" >0.85</td><td align="center" valign="middle" >2.64</td><td align="center" valign="middle" >8.45</td></tr><tr><td align="center" valign="middle" >场景2</td><td align="center" valign="middle" >1.64</td><td align="center" valign="middle" >0.78</td><td align="center" valign="middle" >7.10</td><td align="center" valign="middle" >1.42</td><td align="center" valign="middle" >5.33</td><td align="center" valign="middle" >10.37</td><td align="center" valign="middle" >20.32</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >2</td><td align="center" valign="middle"  rowspan="2"  >双边 滤波</td><td align="center" valign="middle" >场景1</td><td align="center" valign="middle" >7.11</td><td align="center" valign="middle" >4.99</td><td align="center" valign="middle" >51.38</td><td align="center" valign="middle" >6.60</td><td align="center" valign="middle" >12.39</td><td align="center" valign="middle" >44.21</td><td align="center" valign="middle" >32.91</td></tr><tr><td align="center" valign="middle" >场景2</td><td align="center" valign="middle" >6.87</td><td align="center" valign="middle" >2.85</td><td align="center" valign="middle" >26.40</td><td align="center" valign="middle" >4.80</td><td align="center" valign="middle" >9.40</td><td align="center" valign="middle" >38.39</td><td align="center" valign="middle" >31.68</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >3</td><td align="center" valign="middle"  rowspan="2"  >改进的BEEPS</td><td align="center" valign="middle" >场景1</td><td align="center" valign="middle" >7.55</td><td align="center" valign="middle" >7.13</td><td align="center" valign="middle" >76.45</td><td align="center" valign="middle" >8.12</td><td align="center" valign="middle" >20.14</td><td align="center" valign="middle" >77.36</td><td align="center" valign="middle" >37.77</td></tr><tr><td align="center" valign="middle" >场景2</td><td align="center" valign="middle" >7.22</td><td align="center" valign="middle" >3.69</td><td align="center" valign="middle" >37.98</td><td align="center" valign="middle" >4.94</td><td align="center" valign="middle" >12.17</td><td align="center" valign="middle" >89.73</td><td align="center" valign="middle" >33.81</td></tr></tbody></table></table-wrap><p>表1. 图像细节增强量化评价列表</p></sec><sec id="s10"><title>6. 结论</title><p>本文主要研究了基于BEEPS滤波器的改进的红外图像细节增强算法，改进算法主要聚焦于高低频分层图像增强算法。多方面的数据表明：该算法在提升图像细节可视化质量方面具有一定的优势，该算法的并行机制在实际工程化方面也存在优势。</p></sec><sec id="s11"><title>文章引用</title><p>唐 骏,高志强,顾 鑫,朱家乙,沙怡中,张耀芹. 一种基于BEEPS滤波的红外图像细节增强算法An Infrared Image Detail Enhancement Algorithm Based on BEEPS Filtering[J]. 计算机科学与应用, 2021, 11(05): 1548-1554. https://doi.org/10.12677/CSA.2021.115159</p></sec><sec id="s12"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.42678-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Wang, B.J., Liu, S.Q., Li, Q. and Zhou, H.X. (2006) A Real Time Contrast Enhancement Algorithm for Infrared Images Based on Plateau Histogram. Infrared Physics and Technology, 48, 77-82.  
&lt;br&gt;https://doi.org/10.1016/j.infrared.2005.04.008</mixed-citation></ref><ref id="hanspub.42678-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Kuang, X., Sui, X., Chen, Q., et al. (2017) Single Infrared Im-age Stripe Noise Removal Using Deep Convolutional Networks. IEEE Photonics Journal, 9, 1-13. &lt;br&gt;https://doi.org/10.1109/JPHOT.2017.2717948</mixed-citation></ref><ref id="hanspub.42678-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">杨静, 李争. 一种基于双边滤波的红外图像细节增强方法[J]. 激光与红外, 2016, 46(4): 507-511.</mixed-citation></ref><ref id="hanspub.42678-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">吴强, 王新赛, 贺明, 王卫军, 李志军. 一种结合小波分析和直方图的红外增强方法[J]. 应用光学, 2011, 32(3): 464-467.</mixed-citation></ref><ref id="hanspub.42678-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Thevenaz, P., Sage, D. and Unser, M. (2012) Bi-Exponential Edge-Preserving Smoother. IEEE Transactions on Image Processing, 21, 3924-3936. &lt;br&gt;https://doi.org/10.1109/TIP.2012.2200903</mixed-citation></ref><ref id="hanspub.42678-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Chaudhury, K., Sage, D. and Unser, M. (2011) Fast O(1) Bilateral Filtering Using Trigonometric Range Kernels. IEEE Transactions on Image Processing, 20, 3376-3382. &lt;br&gt;https://doi.org/10.1109/TIP.2011.2159234</mixed-citation></ref><ref id="hanspub.42678-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">葛朋, 杨波, 韩庆林, 刘鹏, 陈树刚, 胡窦明, 张巧燕. 一种基于引导滤波图像分层的红外图像细节增强算法[J]. 红外技术, 2018, 40(12): 1161-1169.</mixed-citation></ref><ref id="hanspub.42678-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Bo, Z., Yin, L., Mei, Y., et al. (2018) An Improved Adaptive Detail Enhancement Algorithm for Infrared Images Based on Guided Image Fil-ter. Journal of Modern Optics, 66, 1-14. &lt;br&gt;https://doi.org/10.1080/09500340.2018.1511861</mixed-citation></ref><ref id="hanspub.42678-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Vickers, V.E. (1996) Plateau Equalization Algorithm for Real-Time Display of High Quality Infrared Imagery. Optical Engineering, 35, 1921. &lt;br&gt;https://doi.org/10.1117/1.601006</mixed-citation></ref><ref id="hanspub.42678-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Voloshynovskiy, S., Pereira, S., Iquise, V., et al. (2001) Attack Modeling: Towards a Second Generation Watermarking Benchmark. Signal Processing, 81, 1177-1214. &lt;br&gt;https://doi.org/10.1016/S0165-1684(01)00039-1</mixed-citation></ref></ref-list></back></article>