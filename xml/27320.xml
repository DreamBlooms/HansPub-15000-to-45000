<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">DSC</journal-id><journal-title-group><journal-title>Dynamical Systems and Control</journal-title></journal-title-group><issn pub-type="epub">2325-677X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/DSC.2018.74039</article-id><article-id pub-id-type="publisher-id">DSC-27320</article-id><article-categories><subj-group subj-group-type="heading"><subject>DSC20180400000_63038549.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  一种基于故障录像回放的数控机床故障诊断方法
  A Fault Diagnosis Method for CNC Machine Based on Fault Video Playback
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>乔</surname><given-names>利军</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>石</surname><given-names>江勇</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>琢</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>健</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>晏</surname><given-names>伟</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>武汉华中数控股份有限公司，湖北 武汉</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>06</day><month>09</month><year>2018</year></pub-date><volume>07</volume><issue>04</issue><fpage>348</fpage><lpage>355</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    数控机床在加工时，偶尔会发生一些不明原因的故障，导致机床无法正常加工。本文介绍了一种基于故障录像回放的数控机床故障诊断方法，该方法通过预先配置需要触发录像的报警，以及机床发生故障时需要录像的采样数据，从而在数控系统报警时记录下相应的数据。通过对录像数据的回放和分析，可以对机床的故障进行诊断。
    Some unexplained faults occasionally occur when NC machine tools are in processing, which will result in machine tools disable. This paper introduces a fault diagnosis method for CNC machine tools based on fault record playback. The method can record the corresponding data when the CNC system alarms. Before NC machine tools work, you should configure the alarm for triggering recording, and sampling data type for saving the system fault message when system alarm occur. Through the playback and analysis of record data, we can diagnose the faults of machine tools. 
  
 
</p></abstract><kwd-group><kwd>数控系统，故障录像，录像回放，报警类型，采样通道, CNC</kwd><kwd> Fault Record</kwd><kwd> Record Playback</kwd><kwd> Alarm Type</kwd><kwd> Sampling Channel</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>一种基于故障录像回放的数控机床故障诊断 方法<sup> </sup></title><p>乔利军，石江勇，黄琢，李健，晏伟</p><p>武汉华中数控股份有限公司，湖北 武汉</p><p><img src="//html.hanspub.org/file/12-2740199x1_hanspub.png" /></p><p>收稿日期：2018年10月5日；录用日期：2018年10月23日；发布日期：2018年10月30日</p><disp-formula id="hanspub.27320-formula38"><graphic xlink:href="//html.hanspub.org/file/12-2740199x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>数控机床在加工时，偶尔会发生一些不明原因的故障，导致机床无法正常加工。本文介绍了一种基于故障录像回放的数控机床故障诊断方法，该方法通过预先配置需要触发录像的报警，以及机床发生故障时需要录像的采样数据，从而在数控系统报警时记录下相应的数据。通过对录像数据的回放和分析，可以对机床的故障进行诊断。</p><p>关键词 :数控系统，故障录像，录像回放，报警类型，采样通道</p><disp-formula id="hanspub.27320-formula39"><graphic xlink:href="//html.hanspub.org/file/12-2740199x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/12-2740199x7_hanspub.png" /> <img src="//html.hanspub.org/file/12-2740199x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>数控机床在加工时，偶尔会发生一些故障，使数控系统产生报警，从而导致机床停止运行，影响工件的加工，严重时可能会损坏工件和刀具。因此，数控机床应具有自诊断能力，能采取良好的故障显示，检测方法，及时发现并能很快确定故障部位和原因，令操作人员或维修人员及时排除故障，尽快恢复工作 [<xref ref-type="bibr" rid="hanspub.27320-ref1">1</xref>] 。现有的机床故障诊断技术主要有：</p><p>1) 根据报警内容进行故障诊断</p><p>2) 根据控制系统LED灯或数码管的指示进行故障诊断 [<xref ref-type="bibr" rid="hanspub.27320-ref2">2</xref>]</p><p>3) 根据PC状态或梯形图进行故障诊断</p><p>4) 根据机床参数进行故障诊断</p><p>5) 用诊断程序进行故障诊断，包括启动诊断、在线诊断或称后台诊断和离线诊断 [<xref ref-type="bibr" rid="hanspub.27320-ref3">3</xref>]</p><p>数控机床发生故障的部件由机械和电气两大部分 [<xref ref-type="bibr" rid="hanspub.27320-ref4">4</xref>] ，发生故障的原因多种多样，按故障性质有如下两大类：</p><p>(1) 确定性故障，确定性故障是指控制系统主机中的硬件损坏或只要满足一定的条件，数控机床必然会发生的故障。</p><p>(2) 随机性故障，随机性故障是指数控机床在工作过程中偶然发生的故障，此类故障的发生原因较隐蔽，很难找出其规律性，故常称之为“软故障” [<xref ref-type="bibr" rid="hanspub.27320-ref5">5</xref>] 。</p><p>对于上述的偶尔才会发生一次的随机性故障，仅仅通过故障时报警信息的内容或者其他诊断方法有时很难找到故障原因。因此，如果能够在系统报警时，将系统内部的相关数据记录下来，然后通过对录像数据进行分析，就能够对问题分析起到很大作用。本文使用的诊断方法优势在于随机性的故障诊断提供了便利，为问题原因的查找提供了一种新的途径。</p><p>故障录像并非对界面显示或操作进行录像，而是对加工过程中数控系统内部的实时采样数据进行录像，因此需要预先对触发录像的系统报警和采样通道进行配置。</p><p>当数控系统监测到预先配置的报警时，就会将报警前最后10 s的实时采样数据进行记录，并保存在文件中。然后在示波器中查看录像数据，对导致故障的原因进行分析和诊断，从而帮助快速解决问题。</p></sec><sec id="s4"><title>2. 基于故障录像回放的故障诊断流程</title><p>使用本方法进行故障诊断的流程与其他的基于现象的诊断方法略有不同，需要在故障第一次发生时，根据报警内容配置录像数据，在该故障第二次发生时，回放录像文件，从而进行分析诊断。故障诊断流程如图1所示。</p><p>图1. 基于故障录像回放的故障诊断流程图</p><p>本方法主要应用于机床在加工过程中偶然发生的随机性故障，需要故障至少发生两次。故障初次发生时，由于缺少相关的数据，因此需要根据报警内容，加工所使用的机床部件，以及加工程序的内容对故障录像进行配置，以便录像可能与故障相关的数据。当故障再次发生时，便可根据录像的内容进行故障诊断和分析。若原因未能查明，则可重复2~4步骤，修改录像配置后重新加工，在故障再次发生时进行诊断。</p></sec><sec id="s5"><title>3. 故障录像回放功能的使用方法</title><sec id="s5_1"><title>3.1. 故障录像配置</title><p>机床发生故障时机床的报警种类繁多，另外，系统运行时产生内部数据的类型也非常多。因此，需要预先配置能够触发录像的系统报警，并配置该报警发生时需要录像的采样通道。由于系统资源的限制，最多能够配置16种报警类型，报警类型配置如图2所示，每种报警类型最多能够配置32个采样通道，采样通道配置如图3所示。不同报警类型配置的采样通道可以重复，所有采样通道的类型总数最多为32个，报警配置与采样通道配置关系如图4所示 [<xref ref-type="bibr" rid="hanspub.27320-ref6">6</xref>] 。</p><p>常用的机床故障诊断数据类型如下表1所示。</p></sec><sec id="s5_2"><title>3.2. 采样数据实时录像</title><p>为了能够记录系统报警前最后10 s的录像，数控系统需要在运行时实时对采样数据进行记录并保存在内存中，然后在需要录像的报警发生时将内存中的数据写入到文件中，录像处理过程如图5所示。系统运行时根据故障录像配置中的采样通道进行实时数据采样，重复配置的采样通道仅会采样一次。因系统资源限制，故障录像文件最多保存10个，如果超过10个文件，则会自动删除最旧的录像文件。故障录像文件以文本的方式存储，以便于数据分析和查看。</p></sec><sec id="s5_3"><title>3.3. 故障录像回放</title><p>通过示波器对录像文件进行回放，能够查看系统报警前最后10 s内部数据的变化情况，从历史记录文件列表中选择录像文件的界面如图6所示，所选录像文件的回放图形如图7所示。对录像数据进行分析和诊断，能够帮助确认问题的原因，对录像数据进行各种操作的功能如图8所示。</p><p>图2. 触发录像的报警类型配置图</p><p>图3. 报警发生时录像的采样通道配置图</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Commonly used machine tool fault diagnosis data type [7</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >类型名称</th><th align="center" valign="middle" >说明</th></tr></thead><tr><td align="center" valign="middle" >指令位置</td><td align="center" valign="middle" >数控系统要求轴移动到的位置</td></tr><tr><td align="center" valign="middle" >实际位置</td><td align="center" valign="middle" >轴实际移动到的位置</td></tr><tr><td align="center" valign="middle" >指令速度</td><td align="center" valign="middle" >数控系统要求轴移动的速度</td></tr><tr><td align="center" valign="middle" >实际速度</td><td align="center" valign="middle" >轴实际移动的速度</td></tr><tr><td align="center" valign="middle" >负载电流</td><td align="center" valign="middle" >伺服驱动器控制电机的力矩电流</td></tr><tr><td align="center" valign="middle" >跟踪误差</td><td align="center" valign="middle" >轴的指令位置和实际位置的差</td></tr></tbody></table></table-wrap><p>表1. 常用机床故障诊断数据类型 [<xref ref-type="bibr" rid="hanspub.27320-ref7">7</xref>] <sup> </sup></p><p>图4. 报警配置与采样通道配置关系图</p><p>图5. 采样数据实时录像说明图</p><p>图6. 选择要回放的故障录像文件</p><p>图7. 录像文件回放图</p><p>图8. 录像回放操作图</p></sec></sec><sec id="s6"><title>4. 应用例子</title><sec id="s6_1"><title>4.1. 刀库故障诊断</title><p>客户现场有一台使用机械手刀库的铣床，换刀时偶尔出现乱刀，导致换错刀，从而出现机床撞刀。为查明原因，在PLC中增加G3013.7刀位计时超时报警，并在故障录像中配置相关采样点位，如表2所示。</p><p>通过对换刀报警前的录像文件进行回放，发现原因是因为刀库正在预选刀过程中(刀库正转/反转过程中)，又接收到新的选刀指令，且导致选刀方向与之前刀库旋转方向相反时，会出现转错一个刀位现象(图9)。</p></sec><sec id="s6_2"><title>4.2. 进给轴异响故障诊断</title><p>客户现场有一台车床，在运行过程中发现X轴偶尔有异响。经分析认为需要先确定是指令异常，还是执行部件异常导致，在故障录像中配置相关采样点位，如表3所示。</p><p>通过对X轴异响前的指令加速度进行回放，发现指令X轴加速度达到12.88 m/s<sup>2</sup> (1.3 G加速度)，正常情况加工时加速度只有0.2 G左右，此处显示出现异常。然后将现场运行参数进行对比，发现因小线段参数设置错误导致异常(图10)。</p></sec><sec id="s6_3"><title>4.3. 电机故障诊断</title><p>如图11所示，系统运行时偶尔发生电机电流超过最大值报警。通过对负载电流数据进行录像，发现在加工时存在电流波动异常变大的情况，从而可以认为可能是电机故障(图11)。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> The sampling reg for tool magazine diagnosin</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >X0.5</th><th align="center" valign="middle" >刀库计数信号</th><th align="center" valign="middle" >R111</th><th align="center" valign="middle" >T指令刀号</th></tr></thead><tr><td align="center" valign="middle" >R110</td><td align="center" valign="middle" >选刀刀套号</td><td align="center" valign="middle" >B189</td><td align="center" valign="middle" >当前刀套号</td></tr><tr><td align="center" valign="middle" >Y1.6</td><td align="center" valign="middle" >刀库正转</td><td align="center" valign="middle" >Y1.7</td><td align="center" valign="middle" >刀库反转</td></tr><tr><td align="center" valign="middle" >Y2.1</td><td align="center" valign="middle" >刀臂正转</td><td align="center" valign="middle" >R104.2</td><td align="center" valign="middle" >选刀开始</td></tr></tbody></table></table-wrap><p>表2. 刀库诊断采样点位</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> The sampling reg for feed axis diagnosin</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >X轴实际位置</th><th align="center" valign="middle" >X轴指令位置</th></tr></thead><tr><td align="center" valign="middle" >X轴指令速度</td><td align="center" valign="middle" >X轴实际速度</td></tr><tr><td align="center" valign="middle" >X轴指令加速度</td><td align="center" valign="middle" >X轴实际加速度</td></tr></tbody></table></table-wrap><p>表3. 进给轴诊断采样点位</p><p>图9. 刀库故障诊断图</p><p>图10. X轴异响故障诊断图</p><p>图11. 电机过流报警诊断图</p></sec></sec><sec id="s7"><title>5. 结语</title><p>基于故障录像回放的数控机床故障诊断方法，为机床的故障诊断提供了一种新的思路。该方法简单实用，能够直接在数控系统上使用，无需借助外部设备或仪器。对于用户现场的故障调查有很大的帮助，能够快速对故障进行分析和诊断。另外，故障录像文件也可用客户端工具进行查看和分析，对于事后问题的查找和总结也很有帮助。</p></sec><sec id="s8"><title>基金项目</title><p>“高档数控机床与基础制造装备”科技重大专项(项目编号：2014ZX04015-061)。</p></sec><sec id="s9"><title>文章引用</title><p>乔利军,石江勇,黄 琢,李 健,晏 伟. 一种基于故障录像回放的数控机床故障诊断方法A Fault Diagnosis Method for CNC Machine Based on Fault Video Playback[J]. 动力系统与控制, 2018, 07(04): 348-355. https://doi.org/10.12677/DSC.2018.74039</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.27320-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">刘瑞已. 数控机床故障诊断与维护[M]. 北京: 化学工业出版社, 2013.</mixed-citation></ref><ref id="hanspub.27320-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">龚仲华. 数控机床故障诊断与维修500例[M]. 北京: 机械工业出版社, 2004.</mixed-citation></ref><ref id="hanspub.27320-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">沈军达. 数控机床故障诊断及维修[M]. 北京: 机械工业出版社, 2012.</mixed-citation></ref><ref id="hanspub.27320-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">孙汉卿. 数控机床装调与维修[M]. 北京: 机械工业出版社, 2004.</mixed-citation></ref><ref id="hanspub.27320-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">王锋. 数控机床故障诊断与维护[M]. 北京: 清华大学出版社, 2010.</mixed-citation></ref><ref id="hanspub.27320-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">产品部. HNC-V2.01.00-版本说明书[M]. 武汉: 武汉华中数控股份有限公司, 2018.</mixed-citation></ref><ref id="hanspub.27320-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">郑小年, 杨克冲. 数控机床故障诊断与维修[M]. 武汉: 华中科技大学出版社, 2005.</mixed-citation></ref></ref-list></back></article>