<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2021.108284</article-id><article-id pub-id-type="publisher-id">AAM-44448</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20210800000_73651054.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  从阿基米德分牛问题得出的Pell方程的最小正整数解
  The Smallest Positive Integer Solution of the Pell Equation Derived from Archimedes’s Cattle Problem
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>冯</surname><given-names>贝叶</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>中国科学院数学与系统科学研究院应用数学所，北京</addr-line></aff><pub-date pub-type="epub"><day>03</day><month>08</month><year>2021</year></pub-date><volume>10</volume><issue>08</issue><fpage>2733</fpage><lpage>2738</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  本文借助于数学软件Mathematica11.0用个人计算机求出了从阿基米德分牛问题得出的Pell方程的最小正整数解。
   In this paper, with the help of the mathematical software Mathematica11.0, a personal computer is used to obtain the smallest positive integer solution of the Pell equation from Archimedes’s cattle problem.
 
</p></abstract><kwd-group><kwd>阿基米德方程，Pell方程，最小正整数解，Mathematica11.0，个人计算机, Smallest Positive Integer Solution</kwd><kwd> Pell Equation</kwd><kwd> Mathematica11.0</kwd><kwd> Personal Computer</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>本文借助于数学软件Mathematica11.0用个人计算机求出了从阿基米德分牛问题得出的Pell方程的最小正整数解。</p></sec><sec id="s2"><title>关键词</title><p>阿基米德方程，Pell方程，最小正整数解，Mathematica11.0，个人计算机</p></sec><sec id="s3"><title>The Smallest Positive Integer Solution of the Pell Equation Derived from Archimedes’s Cattle Problem<sup> </sup></title><p>Beiye Feng</p><p>Institute of Applied Mathematics, Academy of Mathematics and Systems Science, Chinese Academy of Sciences, Beijing</p><p><img src="//html.hanspub.org/file/12-2621741x4_hanspub.png?20210809174807963" /></p><p>Received: Jul. 4<sup>th</sup>, 2021; accepted: Jul. 23<sup>rd</sup>, 2021; published: Aug. 9<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/12-2621741x5_hanspub.png?20210809174807963" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>In this paper, with the help of the mathematical software Mathematica11.0, a personal computer is used to obtain the smallest positive integer solution of the Pell equation from Archimedes’s cattle problem.</p><p>Keywords:Smallest Positive Integer Solution, Pell Equation, Mathematica11.0, Personal Computer</p><disp-formula id="hanspub.44448-formula32"><graphic xlink:href="//html.hanspub.org/file/12-2621741x6_hanspub.png?20210809174807963"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/12-2621741x7_hanspub.png?20210809174807963" /> <img src="//html.hanspub.org/file/12-2621741x8_hanspub.png?20210809174807963" /></p></sec><sec id="s5"><title>1. 引言</title><p>古希腊数学家Archimedes (阿基米德，公元前287~前212年)曾提出一个所谓的太阳神分牛问题，此问题最后可归结为求解一个二元二次的不定方程:</p><p>x 2 − 410286423278424 y 2 = 1 (1)</p><p>为节省篇幅，关于Archimedes分牛问题的原始形式，确切表述和如何将其化成上述方程的问题，请参见文献 [<xref ref-type="bibr" rid="hanspub.44448-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.44448-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.44448-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.44448-ref4">4</xref>]。方程(1)就是所谓的Pell方程。它的一般形式为 x 2 − D y 2 = 1 ，其中D是一个不是完全平方数的正整数。这一方程现在已有了相当完整的理论和解法，但对于具体的D，特别是较大的D，求出它的具体的最小正整数解仍需具体的计算。</p></sec><sec id="s6"><title>2. 用连分数解Pell方程的理论基础</title><p>在这一节中，我们首先简要回顾一下用连分数解Pell方程的主要结果。</p><p>定理1. 设D是一个不是完全平方数的正整数，则Pell方程</p><p>x 2 − D y 2 = 1 (2)</p><p>具有无穷多组整数解，其所有的正整数解可用以下公式表出</p><p>x n + y n D = ( x 0 + y 0 D ) n (3)</p><p>其中 ( x 0 , y 0 ) 表示方程(2)的最小的正整数解(必定存在，其具体求法可见下面的引理1，定理2)。</p><p>证明可见 [<xref ref-type="bibr" rid="hanspub.44448-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.44448-ref6">6</xref>]。</p><p>从公式(3)容易导出下面的递推公式和解得矩阵表达式</p><p>x n + 1 = x 0 x n + D y 0 y n , ( n ≥ 2 ) , x 1 = x 0 y n + 1 = y 0 x n + x 0 y n ,     ( n ≥ 2 ) , y 1 = y 0 (4)</p><p>( x n y n ) = ( x 0 D y 0 y 0 x 0 ) n ( 1 0 ) (5)</p><p>以上两式的优点是避免了使用根号，但递推公式(4)依赖了两个变量，从上面的公式我们易于导出下面的仅依赖于一个变量的二阶递推公式。</p><p>x n + 2 = 2 x 0 x n + 1 − x n ( n ≥ 3 ) , x 1 = x 0 , x 2 = x 0 2 + D y 0 2 y n + 2 = 2 x 0 y n + 1 − y n ( n ≥ 3 ) , y 1 = y 0 , y 2 = 2 x 0 y 0 (6)</p><p>引理1. 设D是一个不是完全平方数的正整数，则 D 一定可表示成如下形式的无限循环连分数</p><p>D = [ a 0 , { a 1 , a 2 , ⋯ , a n − 1 , 2 a 0 } ]</p><p>其中 a 0 = [ D ] ( [ D ] 表示 D 的整数部分)， { a 1 , a 2 , ⋯ , a n − 1 , 2 a 0 } 表示 D 的循环节。</p><p>证明可见 [<xref ref-type="bibr" rid="hanspub.44448-ref5">5</xref>] 第七章推论9。</p><p>定理2设D是一个不是完全平方的正整数， D = [ a 0 , { a 1 , a 2 , ⋯ , a n − 1 , 2 a 0 } ]</p><p>p q = [ a 0 , a 1 , a 2 , ⋯ , a n − 1 ]</p><p>则 p 2 − D q 2 必等于+1或−1。如果 p 2 − D q 2 = 1 ，则 x 0 = p ， y 0 = q 就是方程 x 2 − D y 2 = 1 的最小的正整数解，如果 p 2 − D q 2 = − 1 ，则 x 0 = 2 p 2 + 1 ， y 0 = 2 p q 就是方程 x 2 − D y 2 = 1 的最小的正整数解。证明可见 [<xref ref-type="bibr" rid="hanspub.44448-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.44448-ref6">6</xref>]。</p></sec><sec id="s7"><title>3. 阿基米德方程的最小解</title><p>对从Archimedes分牛问题得出的Pell方程(1)， [<xref ref-type="bibr" rid="hanspub.44448-ref7">7</xref>] 和 [<xref ref-type="bibr" rid="hanspub.44448-ref8">8</xref>] 曾用大型计算机算出了它的正整数解，后来 [<xref ref-type="bibr" rid="hanspub.44448-ref3">3</xref>] 又借助于数学软件Mathematica4.0予以解决，不过 [<xref ref-type="bibr" rid="hanspub.44448-ref3">3</xref>] 在其发表的论文中对利用Mathematica解决此问题中的一些相关问题表述不太清楚，也未指出一些应注意的细节，因此其计算过程经本文作者检验有些无法重复。本文详细给出了用Mathematica解决此问题的所有过程和有关细节，利用个人计算机中得出了本文的所有结果。所有过程读者均可自己重复。</p><p>Archimedes所提出的一些问题的解都是非常巨大的数，比如国际象棋问题的解答就是一个很大的数2<sup>64</sup> − 1。同样，本文所涉及的最后解答也是十万位级别的数，因此不可能在本文中完全写出，为了清楚地展示得出解答的过程，我们用两种方法求出解答。</p><p>方法1.</p><p>为了减少数据的大小，首先考虑410286423278424是否有平方因子，经过计算，发现</p><p>410286423278424 = 9314 2 &#215; 4729494</p><p>因此方程(1)可化为方程</p><p>x 2 − 4729494 z 2 = 1 (7)</p><p>其中</p><p>z = 9314 y (8)</p><p>现在，我们在Mathematica中键入命令</p><p>In[<xref ref-type="bibr" rid="hanspub.44448-ref1">1</xref>]:= ContinuedFraction[Sqrt[<xref ref-type="bibr" rid="hanspub.44448-ref4729494">4729494</xref>]]</p><p>然后得到答案</p><p>Out[<xref ref-type="bibr" rid="hanspub.44448-ref1">1</xref>]= {2174, {1, 2, 1, 5, 2, 25, 3, 1, 1, 1, 1, 1, 1, 15, 1, 2, 16, 1, 2, 1, 1, 8, 6, 1, 21, 1, 1, 3,</p><p>&gt; 1, 1, 1, 2, 2, 6, 1, 1, 5, 1, 17, 1, 1, 47, 3, 1, 1, 6, 1, 1, 3, 47, 1, 1, 17, 1, 5, 1, 1, 6, 2,</p><p>&gt; 2, 1, 1, 1, 3, 1, 1, 21, 1, 6, 8, 1, 1, 2, 1, 16, 2, 1, 15, 1, 1, 1, 1, 1, 1, 3, 25, 2, 5, 1, 2,</p><p>&gt; 1, 4348}}</p><p>根据定理2，我们应当把上述连分数修改成一个有限连分数如下</p><p>R = {2174,1, 2, 1, 5, 2, 25, 3, 1, 1, 1, 1, 1, 1, 15, 1, 2, 16, 1, 2, 1, 1, 8, 6, 1, 21, 1, 1, 3,</p><p>1, 1, 1, 2, 2, 6, 1, 1, 5, 1, 17, 1, 1, 47, 3, 1, 1, 6, 1, 1, 3, 47, 1, 1, 17, 1, 5, 1, 1, 6, 2,</p><p>2, 1, 1, 1, 3, 1, 1, 21, 1, 6, 8, 1, 1, 2, 1, 16, 2, 1, 15, 1, 1, 1, 1, 1, 1, 3, 25, 2, 5, 1, 2,</p><p>1}</p><p>现在将其输入到Mathematica中去，再输入命令</p><p>FromContinuedFraction[R]</p><p>即得到</p><p>109931986732829734979866232821433543901088049</p><p>Out[<xref ref-type="bibr" rid="hanspub.44448-ref3">3</xref>]= -----------------------------------------------------------------------</p><p>50549485234315033074477819735540408986340</p><p>令 u = 109931986732829734979866232821433543901088049 ,</p><p>v = 50549485234315033074477819735540408986340</p><p>由于 u 2 − 4729494 v 2 = 1</p><p>因此(u,v)就是方程(7)的最小解，而(7)的所有正整数解可以根据公式(6)算出</p><p>v n + 2 = 219863973465659469959732465642867087802176098 v n + 1 − v n (9)</p><p>v 1 = 50549485234315033074477819735540408986340</p><p>v 2 = 11114010680260185606329559328519372253719415502127416430951773446940215793566356501320</p><p>显然，方程(1)的最小解包含在这些解中，但是它必须符合条件(8)，因此方程(1)的最小解就是v中能被9314整除的最小的v。这样通过一个循环程序就可找到这个最小解(循环程序应在9314|v<sub>n</sub>时停止，而整除性可通过计算v<sub>n</sub>除以9314所得的余数是否为0来判定，这一余数可通过公式</p><p>r n = v n − IntegerPart [ v n / 9314 ] &#215; 9314</p><p>来计算。</p><p>最后结果是循环到 n = 2329 次即可得出答案 x 0 , y 0 。</p><p>方法2：直接对方程(1)进行计算，算法如下：</p><p>1. 计算 410286423278424 的连分数</p><p>在Mathematica中键入命令</p><p>ContinuedFraction[Sqrt[<xref ref-type="bibr" rid="hanspub.44448-ref410286423278424">410286423278424</xref>]]</p><p>回车后即可得出一个如下形式的无限连分数</p><p>{20255528, {4, 1, 1, 1, 4, 1, 2,……, 2, 1, 4, 1, 1, 1, 4, 40511056}}</p><p>(全部连分数可见 [<xref ref-type="bibr" rid="hanspub.44448-ref9">9</xref>] )。</p><p>2. 根据定理2，我们应当把上述连分数修改成一个有限连分数如下</p><p>R = {20255528,4, 1, 1, 1, 4, 1, 2,……, 2, 1, 4, 1, 1, 1, 4}</p><p>(全部连分数可见 [<xref ref-type="bibr" rid="hanspub.44448-ref10">10</xref>] )并在Mathematica中输入它，即键入</p><p>R = {20255528,4, 1, 1, 1, 4, 1, 2,……, 2, 1, 4, 1, 1, 1, 4}</p><p>后再回车。</p><p>3. 计算p，q</p><p>在Mathematica中再键入命令</p><p>FromContinuedFraction[R]</p><p>并回车就得到一个分数，其分子就是p，分母是q，这两个数都是非常大的数。其中p是一个103,273位的正整数，它的开头100位是</p><p>3765344502347205884018786193550576892856610111171560836237851390311234167566480643694312349186281391，</p><p>最后100位是</p><p>1040818520976114141057706314714705096647940993314916269513956239940831835922232584777023371728320049</p><p>(所有数字可见 [<xref ref-type="bibr" rid="hanspub.44448-ref11">11</xref>] )。q是一个103,266位的正整数，它的开头100位是</p><p>1858921901386913309458254208638757413523161201977027301065816550850027682269834724191861021631174425，</p><p>最后100位是</p><p>0600177126871130538492849382053917018667259351819528374696260428780278235279034092592107710208663490</p><p>(所有数字可见 [<xref ref-type="bibr" rid="hanspub.44448-ref12">12</xref>] )。根据定理2， p 2 − D q 2 必等于+1或−1，利用上面的p,q的末位数可知 p 2 − 410286423278424 q 2 的值只能是+1 (在Mathematica中也可直接验证这一结论)，这就说明方程(1)的最小解就是 x 0 = p , y 0 = q ，由方法1和方法2得出的答案是完全一致的。</p><p>注1：在向Mathematica中输入任何数据之前，必须把数字之间的换行符\。分行符&gt;和空白全部去掉，否则Mathematica会认为你输入的是多个数据，从而得不到正确的结果。比如当你输入In[<xref ref-type="bibr" rid="hanspub.44448-ref1">1</xref>]:= A=ContinuedFraction[Sqrt[<xref ref-type="bibr" rid="hanspub.44448-ref4102865">4102865</xref>]]并回车后，Mathematica会显示如下结果</p><p>Out[<xref ref-type="bibr" rid="hanspub.44448-ref1">1</xref>] = {2025, {1, 1, 4, 4, 1, 1, 1, 2, 3, 5, 1, 4, 7, 1, 2, 1, 1, 2, 2, 1, 2, 1, 115, 63, 3, 2, 4, 2,</p><p>&gt; 5, 2, 3, 10, 1, 4, 3, 1, 10, 82, 1, 1, 2, 1, 1, 10, 1, 1, 1, 3, 3, 2, 1, 15, 7, 1, 6, 2, 1, 3, 1,</p><p>&gt; 4, 2, 1, 1, 1, 2, 15, 3, 1, 5, 39, 1, 14, 1, 1, 1, 252, 1, 1, 6, 1, 2, 1, 2, 1, 21, 6, 18, 6, 21,</p><p>&gt; 1, 2, 1, 2, 1, 6, 1, 1, 252, 1, 1, 1, 14, 1, 39, 5, 1, 3, 15, 2, 1, 1, 1, 2, 4, 1, 3, 1, 2, 6, 1,</p><p>&gt; 7, 15, 1, 2, 3, 3, 1, 1, 1, 10, 1, 1, 2, 1, 1, 82, 10, 1, 3, 4, 1, 10, 3, 2, 5, 2, 4, 2, 3, 63,</p><p>&gt; 115, 1, 2, 1, 2, 2, 1, 1, 2, 1, 7, 4, 1, 5, 3, 2, 1, 1, 1, 4, 4, 1, 1, 4050}}</p><p>如果想把上述无限连分数修改成定理2所要求的有限连分数，并将其重新输入Mathematica中，则必须先把它写成下面的形式</p><p>R = {2174,1, 2, 1, 5, 2, 25, 3, 1, 1, 1, 1, 1, 1, 15, 1, 2, 16, 1, 2, 1, 1, 8, 6, 1, 21, 1, 1, 3,</p><p>1, 1, 1, 2, 2, 6, 1, 1, 5, 1, 17, 1, 1, 47, 3, 1, 1, 6, 1, 1, 3, 47, 1, 1, 17, 1, 5, 1, 1, 6, 2,</p><p>2, 1, 1, 1, 3, 1, 1, 21, 1, 6, 8, 1, 1, 2, 1, 16, 2, 1, 15, 1, 1, 1, 1, 1, 1, 3, 25, 2, 5, 1, 2,</p><p>1}</p><p>本文参考文献中的 [<xref ref-type="bibr" rid="hanspub.44448-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.44448-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.44448-ref11">11</xref>] 和 [<xref ref-type="bibr" rid="hanspub.44448-ref12">12</xref>] 在储存数据后都进行了上述处理，因此文件中的数据都是可以直接输入Mathematica的。</p><p>注2：在 Mathematica中，对比较小的分数，它以下面的用虚线当做分数线的分数形式显示，例如</p><p>109931986732829734979866232821433543901088049</p><p>Out[<xref ref-type="bibr" rid="hanspub.44448-ref3">3</xref>] = -----------------------------------------------------------------------</p><p>50549485234315033074477819735540408986340</p><p>但对比较大的分数，则用/号把分子和分母分开。请读者注意区分换行符\和前面的分数线符号。</p></sec><sec id="s8"><title>文章引用</title><p>冯贝叶. 从阿基米德分牛问题得出的Pell方程的最小正整数解The Smallest Positive Integer Solution of the Pell Equation Derived from Archimedes’s Cattle Problem[J]. 应用数学进展, 2021, 10(08): 2733-2738. https://doi.org/10.12677/AAM.2021.108284</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.44448-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Lenstra Jr., H.W. (2008) Solving the Pell Equation. Algorithmic Number Theory, 44, 1-24.</mixed-citation></ref><ref id="hanspub.44448-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Vardi, I. (1998) Archimedes’ Cattle Problem. The American Mathematical Monthly, 105, 305-319.  
&lt;br&gt;https://doi.org/10.1080/00029890.1998.12004887</mixed-citation></ref><ref id="hanspub.44448-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">赵东方. 运用Mathematica4软件包求解Pell方程的方法[J]. 华中师范大学学报(自然科学版), 2003, 37(3): 301-303.</mixed-citation></ref><ref id="hanspub.44448-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">王念良, 杨全, 王辉. 关于阿基米德牛群问题及与之有关的Pell方程[J]. 商洛学院学报, 2011, 25(4): 3-5.</mixed-citation></ref><ref id="hanspub.44448-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">潘承洞, 潘承彪. 初等数论[M]. 北京: 北京大学出版社, 1992.</mixed-citation></ref><ref id="hanspub.44448-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">冯贝叶. Gauss的遗产——从等式到同余式[M]. 哈尔滨: 哈尔滨工业大学出版社, 2018.</mixed-citation></ref><ref id="hanspub.44448-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Williams, H.C., German, R.A. and Zarnke, C.R. (1965) Solution of the Cattle Problem of Archimedes. Mathematics of Computation, 19, 671-674.</mixed-citation></ref><ref id="hanspub.44448-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Nelson, H.L. (1981) A Solution to Archimedes’ Cattle Problem. Journal of Recreational Mathematics, 13, 162-176.</mixed-citation></ref><ref id="hanspub.44448-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">冯贝叶. 根号410286423278424的连分数[Z].</mixed-citation></ref><ref id="hanspub.44448-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">冯贝叶. 有限部分连分数[Z].</mixed-citation></ref><ref id="hanspub.44448-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">冯贝叶. p, word文件[Z].</mixed-citation></ref><ref id="hanspub.44448-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">冯贝叶. q, word文件[Z].</mixed-citation></ref></ref-list></back></article>