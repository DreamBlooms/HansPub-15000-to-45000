<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">MOS</journal-id><journal-title-group><journal-title>Modeling and Simulation</journal-title></journal-title-group><issn pub-type="epub">2324-8696</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/MOS.2016.53011</article-id><article-id pub-id-type="publisher-id">MOS-18309</article-id><article-categories><subj-group subj-group-type="heading"><subject>MOS20160300000_82536451.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject><subject> 工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  改进的分裂Bregman方法荧光显微图像复原
  Improved Split Bregman Method for Fluorescence Microscopic Image Restoration
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>长春</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>瑜</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>肖</surname><given-names>洪兵</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>北京工商大学计算机与信息工程学院，北京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>wangyu@btbu.edu.cn(王瑜)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>08</day><month>08</month><year>2016</year></pub-date><volume>05</volume><issue>03</issue><fpage>81</fpage><lpage>88</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  荧光显微图像复原有着很多重要的应用，例如，天文成像，电子显微镜成像，单光子发射计算机断层成像术和正电子发射断层成像技术等等。传统基于全变差的分裂Bregman算法能够很好地保护图像边缘和纹理信息，但在图像的平滑区域会产生严重的阶梯效应，针对这一问题，本文提出了一种复原算法，主要考虑两点，一是采用全变差(Total Variation, TV)正则化模型，可以很好地复原模糊图像。二是引入权函数，对TV进行加权抑制阶梯效应，同时保护了图像的纹理信息。通过对参数的合理选择，获得最佳的复原效果，在模拟图像和真实荧光显微图像的实验结果验证了该算法的有效性和可行性。
   Fluorescence microscopic image restoration has many very important applications such as astro-nomical imaging, electronic microscopy, single particle emission computed tomography (SPECT) and positron emission tomography (PET). Traditional total variation imaging restoration based on split Bregman algorithm can preserve sharp edges and save the image texture. Serious staircase effect phenomena, however, is generally accompanied. Therefore an improved image restoration algorithm is proposed based on split Bregman in this paper, which is mainly considered two aspects. One is that the total variation regularization model is used, which is an effective tool to recover blurred images. The other is that the weight function of the total variation is involved, which can not only suppress the staircase effect, but also preserve the image texture information. By ap-propriately choosing the reasonable parameters, the better restoration results can be obtained. The experimental results on synthetic images and real fluorescence microscopic images show the effectiveness and feasibility of the proposed algorithm.
 
</p></abstract><kwd-group><kwd>分裂Bregman算法，加权，全变差正则化，图像复原, Split Bregman Algorithm</kwd><kwd> Weighted</kwd><kwd> Total Variation Regularization</kwd><kwd> Image Restoration</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>改进的分裂Bregman方法荧光显微图像复原<sup> </sup></title><p>张长春，王瑜<sup>*</sup>，肖洪兵</p><p>北京工商大学计算机与信息工程学院，北京</p><disp-formula id="hanspub.18309-formula232"><graphic xlink:href="http://html.hanspub.org/file/3-2570096x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年7月24日；录用日期：2016年8月14日；发布日期：2016年8月17日</p><disp-formula id="hanspub.18309-formula233"><graphic xlink:href="http://html.hanspub.org/file/3-2570096x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>荧光显微图像复原有着很多重要的应用，例如，天文成像，电子显微镜成像，单光子发射计算机断层成像术和正电子发射断层成像技术等等。传统基于全变差的分裂Bregman算法能够很好地保护图像边缘和纹理信息，但在图像的平滑区域会产生严重的阶梯效应，针对这一问题，本文提出了一种复原算法，主要考虑两点，一是采用全变差(Total Variation, TV)正则化模型，可以很好地复原模糊图像。二是引入权函数，对TV进行加权抑制阶梯效应，同时保护了图像的纹理信息。通过对参数的合理选择，获得最佳的复原效果，在模拟图像和真实荧光显微图像的实验结果验证了该算法的有效性和可行性。</p><p>关键词 :分裂Bregman算法，加权，全变差正则化，图像复原</p><disp-formula id="hanspub.18309-formula234"><graphic xlink:href="http://html.hanspub.org/file/3-2570096x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>荧光显微镜方法是一种新兴有效的显微镜成像技术，在生物医学研究中，它能够提供活体样本的三维图像 [<xref ref-type="bibr" rid="hanspub.18309-ref1">1</xref>] 。但是，由于成像系统衍射和噪声干扰等 [<xref ref-type="bibr" rid="hanspub.18309-ref2">2</xref>] 因素，荧光显微图像不可避免出现模糊和噪声等退化现象，荧光显微图像的质量通常受两个因素影响：一是由显微光学成像系统的物理限制而导致的模糊，用点扩散函数 [<xref ref-type="bibr" rid="hanspub.18309-ref3">3</xref>] (Point Spread Function PSF)来表征；二是测量工作大多在低光子流的情况下进行，因此会产生泊松噪声。面对这些固有的光学限制，以及对高质量图像的大量需求，用数字图像处理技术去除这些模糊和噪声是一项很有意义的工作。</p><p>目前，分裂Bregman算法 [<xref ref-type="bibr" rid="hanspub.18309-ref4">4</xref>] - [<xref ref-type="bibr" rid="hanspub.18309-ref7">7</xref>] 是求解范数最优化问题及其相关优化问题的最有效的方法之一，它是Rudin [<xref ref-type="bibr" rid="hanspub.18309-ref8">8</xref>] 等学者提出的一种基于Bregman距离的迭代正则化算法 [<xref ref-type="bibr" rid="hanspub.18309-ref9">9</xref>] - [<xref ref-type="bibr" rid="hanspub.18309-ref11">11</xref>] ，起初是用于图像去噪，后来Goldstein [<xref ref-type="bibr" rid="hanspub.18309-ref12">12</xref>] 在此基础上提出了分裂Bregman迭代图像复原模型。</p><p>Brette等人 [<xref ref-type="bibr" rid="hanspub.18309-ref13">13</xref>] 提出了基于各项同性扩散的目标边缘保护先验知识，即全变差正则化 [<xref ref-type="bibr" rid="hanspub.18309-ref11">11</xref>] 。全变差图像复原是基于变分的思想，把全变差图像复原模型转化为一个偏微分方程求解的过程。目前典型求解方法是根据Wang Yilun、Yang Junfeng等 [<xref ref-type="bibr" rid="hanspub.18309-ref14">14</xref>] 提出的基于变量分离和半二次惩罚函数法的快速全变差反卷积算法 [<xref ref-type="bibr" rid="hanspub.18309-ref15">15</xref>] (Fast Total Variation deconvolution, FTVd)，把图像复原模型看作是一个无约束问题优化求解，实验结果验证了FTVd的有效性和稳定性。Setzer等 [<xref ref-type="bibr" rid="hanspub.18309-ref16">16</xref>] 提出了分裂Bregman算法复原被泊松噪声污染的模糊图像，与其他的图像复原算法相比，它的优点在于不存在内部迭代及迭代过程中不产生负像素值。后来，王静等人 [<xref ref-type="bibr" rid="hanspub.18309-ref7">7</xref>] 提出了基于分裂Bregman方法的全变差图像去模糊算法，首先利用辅助变量及其二次惩罚泛函把全变差去模糊优化问题转化成一个等价的无约束优化问题，然后基于Bregman迭代将其分解为两个子优化问题采用交替最小化方法 [<xref ref-type="bibr" rid="hanspub.18309-ref15">15</xref>] 进行求解，接着根据子问题结构特点，采用离散傅里叶变换及收缩技术实现子优化问题的快速计算。</p><p>传统全变差分裂Bregman算法图像去模糊是假设图像在高斯噪声破坏情况下进行的，当图像实际被泊松噪声污染时，该算法虽然能在一定程度上抑制阶梯效应，但是复原效果并不理想，并且在噪声影响过大的情况下，去模糊效果会有所下降。针对图像被泊松噪声污染并且噪声影响过大去模糊效果不理想的情况，本文在传统基于分裂Bregman方法的全变差图像去模糊算法的基础上，引入TV约束模型和权函数，将加权TV约束模型与分裂Bregman方法有效地结合，既可以保留图像的边缘信息，又可以抑制平滑区域的阶梯效应，达到更好的去模糊效果。</p></sec><sec id="s4"><title>2. 相关工作</title><p>图像复原就是根据一定的先验知识(如：模糊核)，从已知的的模糊图像复原真实图像，其图像退化的模型如下：</p><disp-formula id="hanspub.18309-formula235"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，f、u分别是模糊图像和真实图像，K是模糊核矩阵，N是加入的噪声，“<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x11_hanspub.png" xlink:type="simple"/></inline-formula>”表示卷积运算。</p><sec id="s4_1"><title>2.1. 基本分裂Bregman算法</title><p>假设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x12_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x13_hanspub.png" xlink:type="simple"/></inline-formula>是关于变量u的凸能量泛函，则关于u的无约束化问题的形式是：</p><disp-formula id="hanspub.18309-formula236"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x14_hanspub.png"  xlink:type="simple"/></disp-formula><p>引入辅助变量d，则得到与公式(2)等价的约束优化问题的形式：</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x15_hanspub.png" xlink:type="simple"/></inline-formula>s.t.<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x16_hanspub.png" xlink:type="simple"/></inline-formula>(3)</p><p>根据变量分离理论，对式(3)加入Lagrange乘子 [<xref ref-type="bibr" rid="hanspub.18309-ref16">16</xref>] ，便可到关于u和d的无约束优化问题:</p><disp-formula id="hanspub.18309-formula237"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x17_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x18_hanspub.png" xlink:type="simple"/></inline-formula>是惩罚系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x19_hanspub.png" xlink:type="simple"/></inline-formula>。基于分裂Bregman理论 [<xref ref-type="bibr" rid="hanspub.18309-ref7">7</xref>] ，引入辅助变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x20_hanspub.png" xlink:type="simple"/></inline-formula>，则得到关于u和d及<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x21_hanspub.png" xlink:type="simple"/></inline-formula>的迭代更新公式：</p><disp-formula id="hanspub.18309-formula238"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x22_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18309-formula239"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x23_hanspub.png"  xlink:type="simple"/></disp-formula><p>利用交替极小化的方法 [<xref ref-type="bibr" rid="hanspub.18309-ref14">14</xref>] ，可分别得到变量u、d的更新公式：</p><disp-formula id="hanspub.18309-formula240"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x24_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18309-formula241"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x25_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s4_2"><title>2.2. 算法收敛性</title><p>参考文献 [<xref ref-type="bibr" rid="hanspub.18309-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.18309-ref9">9</xref>] 保证了算法的收敛性，其证明如下：</p><p>假设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x26_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x27_hanspub.png" xlink:type="simple"/></inline-formula>分别表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x28_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x29_hanspub.png" xlink:type="simple"/></inline-formula>的梯度函数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x30_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x31_hanspub.png" xlink:type="simple"/></inline-formula>，根据平均理论有：</p><disp-formula id="hanspub.18309-formula242"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x32_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，D表示Bregman距离，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x33_hanspub.png" xlink:type="simple"/></inline-formula>为对角矩阵，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x34_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x35_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x36_hanspub.png" xlink:type="simple"/></inline-formula>是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x37_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x38_hanspub.png" xlink:type="simple"/></inline-formula>之间的值，故我们可以得到如下的公式：</p><disp-formula id="hanspub.18309-formula243"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x39_hanspub.png"  xlink:type="simple"/></disp-formula><p>然后，对公式(10)两边同时乘以<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x40_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x41_hanspub.png" xlink:type="simple"/></inline-formula>，则公式(10)可以重新表示为：</p><disp-formula id="hanspub.18309-formula244"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x42_hanspub.png"  xlink:type="simple"/></disp-formula><p>最后，对公式(11)两边同时减去f，我们可以得到公式(12)：</p><disp-formula id="hanspub.18309-formula245"><graphic xlink:href="http://html.hanspub.org/file/3-2570096x43_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18309-formula246"><graphic xlink:href="http://html.hanspub.org/file/3-2570096x44_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18309-formula247"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x45_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据以上的讨论，我们可以得到分裂Bregman算法是收敛的。</p></sec></sec><sec id="s5"><title>3. 改进的图像复原算法</title><p>传统全变差分裂Bregman算法是假设图像在高斯噪声破坏的情况下进行的，当实际图像被泊松噪声破坏时，该算法虽能在一定程度上抑制阶梯效应，但当存在很大的泊松噪声时，复原效果并不理想，针对这种情况，本文提出一种新算法，即引入加权的全变差约束模型，来抑制阶梯效应，同时也保存了图像的纹理，得到了很好的复原效果。</p><sec id="s5_1"><title>3.1. 算法改进</title><p>在本文中，提出了引入加权全变差约束模型，根据变量分离理论和分裂Bregman算法，进行荧光显微图像复原。则公式(1)的目标函数如下：</p><disp-formula id="hanspub.18309-formula248"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x46_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x47_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x48_hanspub.png" xlink:type="simple"/></inline-formula>表示u在像素i水平方向和垂直方向的一阶有限差分，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x49_hanspub.png" xlink:type="simple"/></inline-formula>表示变量u在像素i处的变差数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x50_hanspub.png" xlink:type="simple"/></inline-formula>表示对所有的i<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x51_hanspub.png" xlink:type="simple"/></inline-formula>求和，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x52_hanspub.png" xlink:type="simple"/></inline-formula>设置为u，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x53_hanspub.png" xlink:type="simple"/></inline-formula>表示t–范数，第二项<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x54_hanspub.png" xlink:type="simple"/></inline-formula>是保真项，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x55_hanspub.png" xlink:type="simple"/></inline-formula>是正则化参数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x56_hanspub.png" xlink:type="simple"/></inline-formula>表示权函数，其表达式是公式(14)所示：</p><p><img src="http://html.hanspub.org/file/3-2570096x57_hanspub.png" />,<img src="http://html.hanspub.org/file/3-2570096x58_hanspub.png" /> (14)</p><p>全变差图像去模糊的问题可以看作是一个无约束问题优化问题。因此，引入辅助变量y，式(13)可以转化为关于u和y的无约束模型：</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x59_hanspub.png" xlink:type="simple"/></inline-formula>s.t.<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x60_hanspub.png" xlink:type="simple"/></inline-formula>(15)</p><p>添加变量u和y的二次惩罚项，转化为与式(15)等价的关于u和y的最优化问题的模型：</p><disp-formula id="hanspub.18309-formula249"><label>(16)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x61_hanspub.png"  xlink:type="simple"/></disp-formula><p>基于变量可分离理论和分裂Bregman迭代，可以转化为求关于u和y两个子优化问题，于是，得到关于变量u和y以及参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x62_hanspub.png" xlink:type="simple"/></inline-formula>的迭代更新迭代公式：</p><disp-formula id="hanspub.18309-formula250"><label>(17)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x63_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18309-formula251"><label>(18)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x64_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18309-formula252"><label>(19)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x65_hanspub.png"  xlink:type="simple"/></disp-formula><p>本文图像复原算法图像边界条件设为周期型边界，K和D均是块循环矩阵。在求解子问题<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x66_hanspub.png" xlink:type="simple"/></inline-formula>时，对式(17)中的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x67_hanspub.png" xlink:type="simple"/></inline-formula>求导并且令导数为零，可得到如下形式：</p><disp-formula id="hanspub.18309-formula253"><label>(20)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x68_hanspub.png"  xlink:type="simple"/></disp-formula><p>采用FFT及其反变换得到与(17)式等价形式的快速求解u的迭代公式：</p><disp-formula id="hanspub.18309-formula254"><label>(21)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x69_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中“*”表示复共轭，“<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x70_hanspub.png" xlink:type="simple"/></inline-formula>”表示分量分式乘积，F、F<sup>−1</sup>分别表示傅里叶变换及其逆变换。</p><p>求解子问题y，根据式(18)的结构特点，可利用shrink函数求解，其定义如下：</p><disp-formula id="hanspub.18309-formula255"><label>(22)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x71_hanspub.png"  xlink:type="simple"/></disp-formula><p>其解的形式为：</p><disp-formula id="hanspub.18309-formula256"><label>(23)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x72_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中规定<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x73_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>由式(22)和(23)，可得到子问题y的快速更新迭代公式为：</p><disp-formula id="hanspub.18309-formula257"><label>(24)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x74_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s5_2"><title>3.2. 算法流程</title><p>本文算法是假设PSF已知，故可以由快速迭代式(21)得到目标图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x75_hanspub.png" xlink:type="simple"/></inline-formula>，然后根据式(24)和(19)更新得到的数值带入到式(21)，最后得到更新后的图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x76_hanspub.png" xlink:type="simple"/></inline-formula>，收敛精度tol取经验值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x77_hanspub.png" xlink:type="simple"/></inline-formula>。表1给出了本文算法的具体流程。</p></sec></sec><sec id="s6"><title>4. 评价准则</title><p>图像复原的质量评价包括主观评价和客观评价，而主观评价包含了人的视觉特性和心理因素，其评价结果较符合实际观察到的图像质量，但有一定的随意波动性，在实际应用中因过程繁琐并且无法完全重复受到了严重的限制。本文中采用信噪比 [<xref ref-type="bibr" rid="hanspub.18309-ref14">14</xref>] (Signal to Noise Ratio, SNR)作为客观的图像复原质量的标准：</p><disp-formula id="hanspub.18309-formula258"><label>(25)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-2570096x78_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中M和N分别表示图像长度和宽度上的像素个数，g(i,j)和f(i,j)分别是原始图像和复原图像在点(i,j)处的灰度值，信噪比的数值越大，图像质量越好。</p></sec><sec id="s7"><title>5. 仿真结果与分析</title><p>为了验证本文算法的有效性，分别使用人工合成的模糊噪声图像和真实的荧光显微图像进行了验证，并且同FTVd-FM算法 [<xref ref-type="bibr" rid="hanspub.18309-ref15">15</xref>] ，传统分裂Bregman算法 [<xref ref-type="bibr" rid="hanspub.18309-ref7">7</xref>] 进行了比较，实验编译环境为Matlab，个人PC机：Inter Core双核，3.60 GHz，4 GB内存。使用SNR作为客观评价方法评价图像复原的质量。</p><sec id="s7_1"><title>5.1. 合成图像</title><p>在合成的模糊噪声图像上应用本文算法，图1(a)为合成图像(130 &#215; 130像素)，图1(b)是其对应的退化图像(泊松噪声和模糊)。在我们的实验中采用高斯PSF(大小5 &#215; 5，标准差为1.5)，复原结果如图2所示。</p><p>从图2可以看出，FTVd-FM算法存在明显的阶梯效应；传统分裂Bregman算法虽然一定程度上减轻了阶梯效应，但得到的图像边缘仍存在部分阶梯效应；本文算法得到的复原图像阶梯效应得到明显改善。</p></sec><sec id="s7_2"><title>5.2. 真实图像</title><p>为了验证算法的有效性和实用性，本文采用了真实的荧光显微图像进行了相关实验。图3(a)是真实观察到的荧光显微图像(512 &#215; 512像素)，由于并未知该图像的具体参数信息，因此，实验时仍然采用人工人工合成图像中的PSF值。</p><p>利用人工合成图像实验所得到的相关参数在真实荧光显微图像上进行实验。图3(b)是采用FTVd-FM算法得到的复原图像。从图中可以看出，复原的图像在明显的阶梯效应；图3(c)是使用传统分裂Bregman算法，从图中可以看出，阶梯效应得到了明显的抑制，但是仍然存在部分阶梯效应，影响复原图像的质量。图3(d)是利用本文算法得到的复原图像，从图中可以看出，使用本文算法既有效的抑制了阶梯效应，又保持了图像在平滑区域的光滑性和图像边缘区域的细节信息。</p><p>为了更加直观的观察复原结果的细节信息，我们对图3(a)中的黑色矩形框标记的区域进行了放大，图4(a)，图4(b)，图4(c)和图4(d)是分别对应图3(a)，图3(b)，图3(c)和图3(d)中相对应的区域。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The flow of the improved split Bregman image restoration metho</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >算法：改进的分裂Bregman图像复原算法</th></tr></thead><tr><td align="center" valign="middle" >1：输入：观测图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x79_hanspub.png" xlink:type="simple"/></inline-formula> 2：初始化参数：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x80_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x81_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x82_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x83_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x84_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x85_hanspub.png" xlink:type="simple"/></inline-formula> 3：while<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x86_hanspub.png" xlink:type="simple"/></inline-formula> do 4：根据第k次迭代得到的图像，由式(21)计算第k+1次迭代的图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x87_hanspub.png" xlink:type="simple"/></inline-formula>； 5：根据式(24)计算<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x88_hanspub.png" xlink:type="simple"/></inline-formula>； 6：将步骤1和2中计算得到的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x89_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x90_hanspub.png" xlink:type="simple"/></inline-formula>带入到式(19)计算的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x91_hanspub.png" xlink:type="simple"/></inline-formula>； 7：将步骤2和3中计算得到的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x92_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x93_hanspub.png" xlink:type="simple"/></inline-formula>带入到步骤1中，以此重复直到满足终止条件，计算得到复原结果<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x94_hanspub.png" xlink:type="simple"/></inline-formula>； 8：end while 9：输出：复原的图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-2570096x95_hanspub.png" xlink:type="simple"/></inline-formula>。</td></tr></tbody></table></table-wrap><p>表1. 改进的分裂Bregman图像复原算法流程</p><p>图1. 合成实验图像(a)原图，(b)退化图像</p><p>图2. 图像复原结果(a) FTVd-FM算法(SNR = 45.50 dB)，(b) 传统分裂Bregman算法(SNR = 45.50 dB)，(c) 本文算法(SNR = 49.68 dB)</p><p>图3. 真实荧光显微图像图像复原结果；(a) 退化图像，(b) FTVd-FM算法，(c) 传统分裂Bregman算法，(d) 本文算法</p><p>图4. (a)图3(a)的局部放大图，(b)图3(b)的局部放大图，(c)图3(c)的局部放大图，(d)图3(d)的局部放大图</p></sec></sec><sec id="s8"><title>6. 结束语</title><p>本文在分裂Bregman算法的基础上提出了一种新的图像复原算法，引入了权函数，通过对TV加权，抑制阶梯效应，提高图像复原效果，同时可以很好地保护图像的纹理信息。通过对参数的合理选择，获得了较好的复原效果。在合成图像和真实的荧光显微图像上的实验结果验证了算法的有效性和可行性，但是需要特别强调的是，在图像的模糊核过大的情况下，本文算法的图像复原效果会有所下降，这将是下一步研究工作中的主要任务。</p></sec><sec id="s9"><title>基金项目</title><p>北京市自然基金面上项目(No. 4162018)；北京市委组织部青年拔尖人才支持计划项目(No. 20140000 26833ZK14)；北京市属高等学校高层次人才引进与培养计划项目(No.CIT&amp;TCD201504010)。</p></sec><sec id="s10"><title>文章引用</title><p>张长春,王瑜,肖洪兵. 改进的分裂Bregman方法荧光显微图像复原 Improved Split Bregman Method for Fluorescence Microscopic Image Restoration[J]. 建模与仿真, 2016, 05(03): 81-88. http://dx.doi.org/10.12677/MOS.2016.53011</p></sec><sec id="s11"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.18309-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Lefkimmiatis, S., Bourquard, A. and Unser, M. (2012) Hessian-Based Regularization for 3D Microscopy Image Restoration. 9th IEEE International Symposium on Biomedical Imaging, Barcelona, 2-5 May 2012, 1731-1734.</mixed-citation></ref><ref id="hanspub.18309-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Chaux, C., Blanc-Féraud, L. and Zerubia, J. (2007) Wavelet-Based Restoration Methods: Application to 3D Confocal Microscopy. SPIE Proceedings, 6701, 78-89. &lt;br&gt;http://dx.doi.org/10.1117/12.731438</mixed-citation></ref><ref id="hanspub.18309-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Zhang, B., Fadili, J., Starck, J.-L. and Olivo-Marin, J.-C. (2007) Multiscale Va-riance-Stabilizing Transform for Mixed Poisson Gaussian Processes and Its Applications in Bio-Imaging. IEEE International Confe-rence on Image Processing, Vol. 6, San Antonio, 16 September-19 October 2007, 233-236.</mixed-citation></ref><ref id="hanspub.18309-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Getreuer, P. (2012) Total Variation Deconvolution Using Split Bregman. Image Processing on Line, 2, 158-174. 
&lt;br&gt;http://dx.doi.org/10.5201/ipol.2012.g-tvdc</mixed-citation></ref><ref id="hanspub.18309-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Goldstein, T. and Osher, S. (2009) The Split Bregman Algorithm for L1 Regu-larized Problems. SIAM Journal on Imaging Sciences, 2, 323-343. &lt;br&gt;http://dx.doi.org/10.1137/080725891</mixed-citation></ref><ref id="hanspub.18309-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Li, Y.F. and Feng, X.C. (2010) The Split Bregman Method for L1 Projection Problems. Acta Electronica Sinica, 38, 2471-2475.</mixed-citation></ref><ref id="hanspub.18309-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Wang, J., Lü, K., He, N. and Wang, Q. (2012) Total Variant Image Deblurring Based on Split Bregman Method. Acta Electronica Sinica, 40, 1503-1508.</mixed-citation></ref><ref id="hanspub.18309-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Rudin, L., Osher, S. and Fatemi, E. (1992) Nonliner Total Variation Based Noise Removal Algorithm. Physica D, 60, 259-268. &lt;br&gt;http://dx.doi.org/10.1016/0167-2789(92)90242-F</mixed-citation></ref><ref id="hanspub.18309-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Osher, S., Burger, M., Goldfarb, D., Xu, J.J. and Wotao, Y. (2005) An Iterative Regularization Method for Total Variation-Based Image Restoration. Multiscale Modeling and Simulation, 4, 460-489. &lt;br&gt;http://dx.doi.org/10.1137/040605412</mixed-citation></ref><ref id="hanspub.18309-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Tikhonov, A.N. and Arsenin, V.Y. (1997) Solutions of Ill-Posed Problems. V.H. Winston &amp; Sons, Washington DC.</mixed-citation></ref><ref id="hanspub.18309-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Babacan, S., Moluna, R. and Katsaggelos, A. (2008) Parameter Estimation in TV Image Restoration Using Variational Distribution Approximation. IEEE Transactions on Image Processing, 17, 326-339.  
&lt;br&gt;http://dx.doi.org/10.1109/TIP.2007.916051</mixed-citation></ref><ref id="hanspub.18309-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Goldstein, T. and Osher, S. (2009) The Split Bregman Algorithm for L1 Re-gularized Problems. SIAM Journal on Imaging Sciences, 2, 323-343. &lt;br&gt;http://dx.doi.org/10.1137/080725891</mixed-citation></ref><ref id="hanspub.18309-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Brette, S. and Dier, J. (2006) Optimized Single Site Update Algorithms for Image Deblurring. International Conference on Image Processing, Vol. 3, Lausanne, 16-19 September 1996, 65-68.  
&lt;br&gt;http://dx.doi.org/10.1109/ICIP.1996.560370</mixed-citation></ref><ref id="hanspub.18309-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Yin, W.T. and Yang, J.F. (2009) Alternating Direction Algorithms for Total Variation Deconvolution in Image Reconstruction. http://www.optimization-online.org/DB-HTML/2009/11/2463.html</mixed-citation></ref><ref id="hanspub.18309-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Yang, J.F., Yin, W.T., Zhang, Y. and Wang, Y.L. (2009) A Fast Algorithm for Edge-Preserving Variational Multichannel Image Restoration. SIAM Journal on Imaging Sciences, 2, 569-592. &lt;br&gt;http://dx.doi.org/10.1137/080730421</mixed-citation></ref><ref id="hanspub.18309-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Setzer, S., Steidl, G. and Teuber, T. (2010) Deblurring Poissonian Images by Split Bregman Techniques. Journal of Visual Communication and Image Representation, 21, 193-199. &lt;br&gt;http://dx.doi.org/10.1016/j.jvcir.2009.10.006</mixed-citation></ref></ref-list></back></article>