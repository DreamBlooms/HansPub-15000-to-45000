<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">GST</journal-id><journal-title-group><journal-title>Geomatics Science and Technology</journal-title></journal-title-group><issn pub-type="epub">2329-549X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/GST.2018.64029</article-id><article-id pub-id-type="publisher-id">GST-27145</article-id><article-categories><subj-group subj-group-type="heading"><subject>GST20180400000_48533905.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于最小二乘配置模型的高程异常拟合
  Height Anomaly Fitting Based on Least Squares Configuration Model
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>鸣鹤</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>晓倩</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>启斌</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>山东科技大学，测绘科学与工程学院，山东 青岛</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>17</day><month>10</month><year>2018</year></pub-date><volume>06</volume><issue>04</issue><fpage>254</fpage><lpage>259</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  如何由全球定位系统(GPS)测量的大地高得到常用的正常高一直是测绘工作者研究的热点。以某煤矿的高程数据为例，分别使用二次曲面拟合模型以及最小二乘配置模型对高程数据进行处理。对比两种模型结果，最小二乘配置模型拟合残差较小，内外符合精度较高，可以满足实际测量工作的需求。
   How to obtain the normal height from the geodetic height measured by GPS has always been a hot spot by surveying workers. This paper takes an example of a coalmine’s elevation data which is processed by the quadric surface fitting model and the least squares configuration model. Comparing the results of the two models, the residuals of the least-squares model have a smaller fitting error, and the internal precision and outer precision are high. The obtained results can meet the needs of actual measurement work.
 
</p></abstract><kwd-group><kwd>高程异常，曲面拟合，最小二乘配置法，外符合精度, Height Anomaly</kwd><kwd> Surface Fitting</kwd><kwd> Least Squares Collocation</kwd><kwd> Outer Precision</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于最小二乘配置模型的高程异常拟合<sup> </sup></title><p>王鸣鹤，吴晓倩，张启斌</p><p>山东科技大学，测绘科学与工程学院，山东 青岛</p><p><img src="//html.hanspub.org/file/3-2840196x1_hanspub.png" /></p><p>收稿日期：2018年9月20日；录用日期：2018年10月10日；发布日期：2018年10月17日</p><disp-formula id="hanspub.27145-formula12"><graphic xlink:href="//html.hanspub.org/file/3-2840196x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>如何由全球定位系统(GPS)测量的大地高得到常用的正常高一直是测绘工作者研究的热点。以某煤矿的高程数据为例，分别使用二次曲面拟合模型以及最小二乘配置模型对高程数据进行处理。对比两种模型结果，最小二乘配置模型拟合残差较小，内外符合精度较高，可以满足实际测量工作的需求。</p><p>关键词 :高程异常，曲面拟合，最小二乘配置法，外符合精度</p><disp-formula id="hanspub.27145-formula13"><graphic xlink:href="//html.hanspub.org/file/3-2840196x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/3-2840196x7_hanspub.png" /> <img src="//html.hanspub.org/file/3-2840196x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>GPS高程测量是高程测量中非常重要的一种方法，其测得的是大地高，需要由大地高向常用的正常高进行转换 [<xref ref-type="bibr" rid="hanspub.27145-ref1">1</xref>] - [<xref ref-type="bibr" rid="hanspub.27145-ref6">6</xref>] 。很多文献中多采用曲面拟合的方法，建立一个拟合面来代替拟合区域的似大地水准面 [<xref ref-type="bibr" rid="hanspub.27145-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.27145-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.27145-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.27145-ref10">10</xref>] 。这种方法可以获得一个比较接近的高程异常值，但二次曲面拟合的拟合面必然会遵循二次曲面的结构趋势，无法根据不同的拟合点以及拟合区域灵活地进行调整。为了对拟合点中存在的随机性残差进行改进，本文引入了最小二乘配置法模型。最小二乘配置法不仅能考虑高程异常的趋势性，还能根据区域内的个别变化考虑其随机性，在一些地形复杂、地表崎岖、区域面积较大、拟合跨度较长的区域内，能够得到很好的用于实际工作的拟合结果 [<xref ref-type="bibr" rid="hanspub.27145-ref11">11</xref>] [<xref ref-type="bibr" rid="hanspub.27145-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.27145-ref13">13</xref>] 。本文针对类似的复杂区域情况，在拟合模型改进、模型符合精度方面展开探讨。</p></sec><sec id="s4"><title>2. 高程异常拟合模型</title><sec id="s4_1"><title>2.1. 曲面拟合</title><p>多项式拟合即在拟合区域中根据已知水准点数据构造一个曲面来代表拟合区域的似大地水准面，函数模型为：</p><p>F ( x , y ) = f ( x , y ) + Δ (1)</p><p>式中： 为高程异常； Δ 为误差； f ( x , y ) 为拟合多项式，见式(2)：</p><disp-formula id="hanspub.27145-formula14"><label>(2)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/3-2840196x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中： a i 为未知系数；x、y为拟合点的经纬度；K为多余条件数。采用了六参数多项式，即二次曲面多项式，利用选取的拟合点求得待定系数。计算未知参数，建立超定方程组，使用最小二乘法求其最小二乘解，公式见式(3)：</p><p>B = ( X ⊺ X ) − 1 X ⊺ Y (3)</p><p>式中：X是六参数多项式的各项未知数；Y是高程异常值。将式(2)带入式(1)求得高程异常值，实现大地高向正常高的转换。</p></sec><sec id="s4_2"><title>2.2. 最小二乘配置法</title><p>最小二乘配置法的数学模型如下：</p><p>L = B X + C Z + Δ (4)</p><p>式中：L为已测点高程异常的观测值；B为已知系数矩阵，具体数值取决于选取的拟合函数类型，采用的最小二乘配置是基于二次曲面拟合的，此处为公式(3)中B；X为非随机变量；<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/3-2840196x17_hanspub.png" xlink:type="simple"/></inline-formula>，E为单位矩阵；S为高程异常与其趋势面的差值； 为观测信号； Δ 为观测信号的噪声。根据上式写出误差方程：</p><p>V = B X ^ + C Z ^ − L (5)</p><p>式中：V为改正数； X ^ 为X的估计值；<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/3-2840196x22_hanspub.png" xlink:type="simple"/></inline-formula>为Z的估计值。上式按照最小二乘准则化简后得<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/3-2840196x23_hanspub.png" xlink:type="simple"/></inline-formula>和 S ^ ′ 的计算式为：</p><p>X ^ = ( B ⊺ D L L − 1 B ) − 1 B ⊺ D L L − 1 L (6)</p><p>S ^ ′ = D S ′ S D L L − 1 ( L − B X ^ ) (7)</p><p>式中： D L L − 1 为L的自协方差阵； S ^ ′ 为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/3-2840196x29_hanspub.png" xlink:type="simple"/></inline-formula>的估计值； 为 S ′ 和S的协方差阵。</p><p>由此得待测点高程异常平均值为：</p><p>L ^ = B ′ X ^ + S ^ ′ (8)</p><p>式中： L ^ 为待测点高程异常的估计值。</p></sec></sec><sec id="s5"><title>3. 算例分析</title><p>选用数据为某煤矿的22个点的D级GPS控制点成果，所有测点均已联测四等水准。已知22点中选取18点作为拟合点建立函数模型，其余4点作为检核点用于检核模型误差。18个拟合点的大地高、正常高如图1所示。</p><p>GPS网点分布如图2所示，其中黑色方块点为检核点，已在图中标明检核点点号，其余点为拟合点。</p><p>两种模型的拟合结果如表1所示。</p><p>两种模型的残差对比如图3所示，两种模型的拟合残差如图4所示。</p><p>对上图表进行结果分析时，需要从内符合精度与外符合精度两方面进行分析：将已知的拟合点数据带入到已建立的模型中，得到的残差值即为内符合精度；将已知的检核点数据带入到已建立的模型中，得到的残差值即为外符合精度。两者区别在于，已建立的模型是建立在拟合点数据的基础上，而与检核点数据无关。</p><p>由上图表计算得曲面拟合模型内符合精度为0.024 m，最小二乘配置模型内符合精度为0.0038 m；曲面拟合模型外符合精度为0.036 m，最小二乘配置模型外符合精度为0.0028 m。结果表明，无论对于模型内的拟合点还是模型外的检核点，最小二乘配置模型的残差明显较低，残差值相对曲面拟合模型降低了一个数量级；其内外符合精度都有较大的提高；其模型的残差明显小于二次曲面拟合模型，且各点精度</p><p>图1. 已知点数据</p><p>图2. GPS网点分布图</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Fitting residua</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >点号</th><th align="center" valign="middle" >拟合值/m</th><th align="center" valign="middle" >高程异常/m</th><th align="center" valign="middle" >曲面拟合残差/m</th><th align="center" valign="middle" >最小二乘配置残差/m</th></tr></thead><tr><td align="center" valign="middle" >JQ28</td><td align="center" valign="middle" >8.731</td><td align="center" valign="middle" >8.714</td><td align="center" valign="middle" >−0.017</td><td align="center" valign="middle" >−0.001</td></tr><tr><td align="center" valign="middle" >JQ40</td><td align="center" valign="middle" >8.753</td><td align="center" valign="middle" >8.716</td><td align="center" valign="middle" >−0.037</td><td align="center" valign="middle" >−0.002</td></tr><tr><td align="center" valign="middle" >JQ41</td><td align="center" valign="middle" >7.487</td><td align="center" valign="middle" >7.507</td><td align="center" valign="middle" >0.020</td><td align="center" valign="middle" >−0.001</td></tr><tr><td align="center" valign="middle" >JQ29</td><td align="center" valign="middle" >8.350</td><td align="center" valign="middle" >8.378</td><td align="center" valign="middle" >0.028</td><td align="center" valign="middle" >0.006</td></tr><tr><td align="center" valign="middle" >D057</td><td align="center" valign="middle" >8.595</td><td align="center" valign="middle" >8.582</td><td align="center" valign="middle" >−0.013</td><td align="center" valign="middle" >−0.005</td></tr><tr><td align="center" valign="middle" >D059</td><td align="center" valign="middle" >8.409</td><td align="center" valign="middle" >8.408</td><td align="center" valign="middle" >−0.001</td><td align="center" valign="middle" >−0.0005</td></tr><tr><td align="center" valign="middle" >D091</td><td align="center" valign="middle" >7.920</td><td align="center" valign="middle" >7.876</td><td align="center" valign="middle" >−0.044</td><td align="center" valign="middle" >0.004</td></tr><tr><td align="center" valign="middle" >D090</td><td align="center" valign="middle" >8.368</td><td align="center" valign="middle" >8.346</td><td align="center" valign="middle" >−0.022</td><td align="center" valign="middle" >0.006</td></tr><tr><td align="center" valign="middle" >D102</td><td align="center" valign="middle" >8.590</td><td align="center" valign="middle" >8.571</td><td align="center" valign="middle" >−0.019</td><td align="center" valign="middle" >−0.001</td></tr><tr><td align="center" valign="middle" >D104</td><td align="center" valign="middle" >8.561</td><td align="center" valign="middle" >8.606</td><td align="center" valign="middle" >0.045</td><td align="center" valign="middle" >0.004</td></tr><tr><td align="center" valign="middle" >D105</td><td align="center" valign="middle" >8.117</td><td align="center" valign="middle" >8.133</td><td align="center" valign="middle" >0.016</td><td align="center" valign="middle" >−0.006</td></tr><tr><td align="center" valign="middle" >D106</td><td align="center" valign="middle" >7.746</td><td align="center" valign="middle" >7.744</td><td align="center" valign="middle" >−0.002</td><td align="center" valign="middle" >−0.0002</td></tr><tr><td align="center" valign="middle" >D107</td><td align="center" valign="middle" >7.873</td><td align="center" valign="middle" >7.866</td><td align="center" valign="middle" >−0.007</td><td align="center" valign="middle" >−0.0001</td></tr><tr><td align="center" valign="middle" >D125</td><td align="center" valign="middle" >8.596</td><td align="center" valign="middle" >8.604</td><td align="center" valign="middle" >0.008</td><td align="center" valign="middle" >0.0004</td></tr><tr><td align="center" valign="middle" >DZ01</td><td align="center" valign="middle" >8.033</td><td align="center" valign="middle" >8.038</td><td align="center" valign="middle" >0.005</td><td align="center" valign="middle" >0.0003</td></tr><tr><td align="center" valign="middle" >GT01</td><td align="center" valign="middle" >8.546</td><td align="center" valign="middle" >8.578</td><td align="center" valign="middle" >0.032</td><td align="center" valign="middle" >0.001</td></tr><tr><td align="center" valign="middle" >GT02</td><td align="center" valign="middle" >8.529</td><td align="center" valign="middle" >8.547</td><td align="center" valign="middle" >0.018</td><td align="center" valign="middle" >0.007</td></tr><tr><td align="center" valign="middle" >TK01</td><td align="center" valign="middle" >8.776</td><td align="center" valign="middle" >8.793</td><td align="center" valign="middle" >0.017</td><td align="center" valign="middle" >−0.005</td></tr><tr><td align="center" valign="middle" >XC01</td><td align="center" valign="middle" >7.687</td><td align="center" valign="middle" >7.698</td><td align="center" valign="middle" >0.011</td><td align="center" valign="middle" >−0.001</td></tr><tr><td align="center" valign="middle" >XC02</td><td align="center" valign="middle" >7.619</td><td align="center" valign="middle" >7.572</td><td align="center" valign="middle" >−0.047</td><td align="center" valign="middle" >−0.003</td></tr><tr><td align="center" valign="middle" >XH01</td><td align="center" valign="middle" >8.798</td><td align="center" valign="middle" >8.818</td><td align="center" valign="middle" >0.020</td><td align="center" valign="middle" >−0.002</td></tr><tr><td align="center" valign="middle" >XH02</td><td align="center" valign="middle" >8.816</td><td align="center" valign="middle" >8.782</td><td align="center" valign="middle" >−0.034</td><td align="center" valign="middle" >−0.003</td></tr></tbody></table></table-wrap><p>表1. 拟合残差</p><p>图3. 内符合的模型残差对比</p><p>图4. 外符合的拟合残差对比</p><p>分布较为平均，没有太大起伏。二次曲面模型残差较大，究其原因，主要有以下几点：</p><p>1) 二次曲面模型仅考虑拟合点数据的趋势性，未考虑个别区域的随机性；</p><p>2) 单纯地选取某个次数的曲面模型时，拟合面一定符合该次数曲面模型的结构特征，这会使得某些处于拟合点之间的拟合区域不能很好地符合拟合数据的特征；</p><p>3) 二次曲面模型未使用计算各点协方差，使得计算结果未能很好地考虑各点之间的关联性。</p></sec><sec id="s6"><title>4. 结论</title><p>本文给出了曲面拟合模型和最小二乘配置模型，利用某矿区的GPS数据与水准数据进行了相关的验证。结果表明，最小二乘配置模型拟合效果明显优于曲面拟合模型，残差值较低，内外符合精度均有数量级的提升，拟合结果可以用于相关实际工作。尽管模型达到一定拟合精度，但模型拟合到的水准面不一定是准确的，实际工作中需要同时综合内、外符合精度及残差分析拟合效果，才能更准确得出拟合能力。</p></sec><sec id="s7"><title>文章引用</title><p>王鸣鹤,吴晓倩,张启斌. 基于最小二乘配置模型的高程异常拟合Height Anomaly Fitting Based on Least Squares Configuration Model[J]. 测绘科学技术, 2018, 06(04): 254-259. https://doi.org/10.12677/GST.2018.64029</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.27145-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">倪屾. 基于多项式曲面拟合GPS高程模型[J]. 科技风, 2015, 31(12): 3.</mixed-citation></ref><ref id="hanspub.27145-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">沙月进. 最小二乘配置法在GPS高程拟合中的应用[J]. 测绘信息与工程, 2000, 43(3): 3-5.</mixed-citation></ref><ref id="hanspub.27145-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">沈雪峰, 高成发, 潘树国. 基于最小二乘配置法的BP神经网络GPS高程异常拟合方法研究[J]. 测绘工程, 2011, 20(4): 14-17 + 21.</mixed-citation></ref><ref id="hanspub.27145-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">张树基, 武文波. 最小二乘配置模型在GPS高程拟合中的应用[J]. 陕西煤炭, 2009, 28(2): 30-32.</mixed-citation></ref><ref id="hanspub.27145-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">孙正明, 高井祥, 王坚, 等. 最小二乘配置法在GPS高程异常推估中的应用[J]. 测绘科学, 2007, 43(6): 102-103 + 207.</mixed-citation></ref><ref id="hanspub.27145-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">李冲, 季灵运, 张冬菊. GPS高程拟合模型误差的最小二乘配置补偿[J]. 勘察科学技术, 2007, 22(1): 27-29.</mixed-citation></ref><ref id="hanspub.27145-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">杜红飞, 谢劭峰, 孙昌瑜. 最小二乘配置法在GPS高程异常值推估中的应用[J]. 河南科学, 2013, 31(2): 208-211.</mixed-citation></ref><ref id="hanspub.27145-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">郭春喜, 聂建亮, 王斌, 等. 利用自适应最小二乘配置的GPS水准与重力似大地水准面的拟合[J]. 武汉大学学报(信息科学版), 2013, 38(1): 44-47.</mixed-citation></ref><ref id="hanspub.27145-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">鲁纯. 基于最小二乘配置法的GPS高程转换[J]. 辽宁省交通高等专科学校学报, 2012, 14(6): 40-43.</mixed-citation></ref><ref id="hanspub.27145-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">左廷英, 丁俊豪, 宋迎春, 等. 带有部分不确定性的平差算法在GPS高程拟合中的应用[J]. 测绘工程, 2018, 27(6): 5-9.</mixed-citation></ref><ref id="hanspub.27145-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">陈水航. GPS高程拟合代替四等水准测量精度分析与探讨[J]. 经纬天地, 2018, 33(2): 51-54.</mixed-citation></ref><ref id="hanspub.27145-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">马华宇. 基于高程异常拟合模型的矿区测量数据处理[J]. 煤炭技术, 2018, 37(3): 110-112.</mixed-citation></ref><ref id="hanspub.27145-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">谢曦霖, 许才军, 温扬茂, 等. 一种基于多面函数的改进最小二乘配置方法[J]. 武汉大学学报(信息科学版), 2018, 43(4): 592-598.</mixed-citation></ref></ref-list></back></article>