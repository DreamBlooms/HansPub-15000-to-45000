<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2016.61003</article-id><article-id pub-id-type="publisher-id">CSA-16825</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20160100000_43855688.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  NURBS曲面片的混合与填充
  Blending and Filling of NURBS Patches
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>江</surname><given-names>南</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>唐</surname><given-names>月红</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>饶</surname><given-names>洁屏</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>南京航空航天大学理学院数学系，江苏 南京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>tangyuehong@nuaa.edu.cn(唐月)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>18</day><month>01</month><year>2016</year></pub-date><volume>06</volume><issue>01</issue><fpage>21</fpage><lpage>29</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  本文提出用轮廓删除法对NURBS曲面片进行细分的曲面混合及N边洞填充的方法。该方法先根据非均匀Catmull-Clark细分原理进行曲面混合，构造插值于角点的非均匀Catmull-Clark细分曲面法，再运用轮廓删除法在细分迭代的过程中去除控制网格边界轮廓，然后进行N边洞的填充以生成一张整体光滑的连续曲面。该方法在保证混合曲面与基曲面片在边界处C2连续时，能使N边洞填充曲面具有较好的光顺性。实例结果表明，该方法简化了具体的计算机实现过程，拓宽了细分曲面应用范围，解决了细分曲面与经典样条拼接的不相容问题，且使生成的曲面兼顾了二者的优点，具有较好的填充效果。
   This paper presents a method for subdividing the NURBS surface patches blending and N-sided hole filling by contour deletion method. First, surface blended according to the principle of non- uniform Catmull-Clark subdivision surface, and the non-uniform Catmull-Clark subdivision method which builds the surface interpolating corner vertices and boundary curves was constructed. Then the contour deletion method was used to remove the control mesh boundary contour in the process of segmentation iteration. Last, N-sided hole filling was used to generate an integral smooth continuous surface. The method not only can guarantee the blending surface and the base surface patches C2 continuity at the boundary, but also can make the N-sided hole filling surface have better smoothness. Results show that, this method simplifies the specific computer realization process, broads the scope of application of subdivision surfaces, and solves the problem of incompatibility between subdivision surface and classic spline splicing; the resulting surface has both advantages with better filling effect.
 
</p></abstract><kwd-group><kwd>NURBS，细分曲面，轮廓删除法，曲面混合，N边洞填充, NURBS</kwd><kwd> Subdivision Surface</kwd><kwd> Contour Deletion Method</kwd><kwd> Surface Blending</kwd><kwd> N-Sided Hole Filling</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>NURBS曲面片的混合与填充<sup> </sup></title><p>江南，唐月红<sup>*</sup>，饶洁屏</p><p>南京航空航天大学理学院数学系，江苏 南京</p><disp-formula id="hanspub.16825-formula251"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年1月7日；录用日期：2016年1月21日；发布日期：2016年1月27日</p><disp-formula id="hanspub.16825-formula252"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文提出用轮廓删除法对NURBS曲面片进行细分的曲面混合及N边洞填充的方法。该方法先根据非均匀Catmull-Clark细分原理进行曲面混合，构造插值于角点的非均匀Catmull-Clark细分曲面法，再运用轮廓删除法在细分迭代的过程中去除控制网格边界轮廓，然后进行N边洞的填充以生成一张整体光滑的连续曲面。该方法在保证混合曲面与基曲面片在边界处C<sup>2</sup>连续时，能使N边洞填充曲面具有较好的光顺性。实例结果表明，该方法简化了具体的计算机实现过程，拓宽了细分曲面应用范围，解决了细分曲面与经典样条拼接的不相容问题，且使生成的曲面兼顾了二者的优点，具有较好的填充效果。</p><p>关键词 :NURBS，细分曲面，轮廓删除法，曲面混合，N边洞填充</p><disp-formula id="hanspub.16825-formula253"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>在计算机辅助几何设计(Computer Aided Geometric Design CAGD)和数字几何设计领域中，细分曲面和非均匀有理B样条(简称NURBS)已成为曲面造型的主流。尽管非均匀有理B样条已经是一种工业标准并且很容易的应用到商业建模系统中，但是由于NURBS需要矩形网格的限制，仅仅使用它通常难以构造一些复杂的曲面，而细分曲面的出现有效的弥补了这些问题。</p><p>对于细分曲面，Prautzsch [<xref ref-type="bibr" rid="hanspub.16825-ref1">1</xref>] 在1998年提出了均匀节点区间的任意次数细分法，2001年Warren等一些学者[<xref ref-type="bibr" rid="hanspub.16825-ref2">2</xref>] -[<xref ref-type="bibr" rid="hanspub.16825-ref4">4</xref>] 推广了Prautzsch的结果，但是这些细分方法中没有一种是非均匀的细分方法[<xref ref-type="bibr" rid="hanspub.16825-ref5">5</xref>] ，因此，在几何建模的通用性和灵活性方面存在一定的局限性。2007年，Thomas等人[<xref ref-type="bibr" rid="hanspub.16825-ref6">6</xref>] 提出了基于Schaefer的节点插入[<xref ref-type="bibr" rid="hanspub.16825-ref7">7</xref>] 的非均匀细分算法，然而该算法在曲面包含奇异点时会带来困难。对于N边洞填充的问题，文献[<xref ref-type="bibr" rid="hanspub.16825-ref8">8</xref>] 用N张双7次NURBS曲面去构造几乎处处<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x10_hanspub.png" xlink:type="simple"/></inline-formula>连续的N边域曲面，这种方法通过两步计算实现，需要较高的计算耗费；文献[<xref ref-type="bibr" rid="hanspub.16825-ref9">9</xref>] 用流形的方法构造N边域曲面，虽然生成的曲面处处<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x11_hanspub.png" xlink:type="simple"/></inline-formula>连续，但这种方法构造出的曲面赋值比较繁琐；文献[<xref ref-type="bibr" rid="hanspub.16825-ref10">10</xref>] 的方法只适合于均匀三次B样条曲面的情况；在文献[<xref ref-type="bibr" rid="hanspub.16825-ref11">11</xref>] 中给出了非均匀Catmull-Clark细分模式产生N边域曲面的方法，但由于细分混合曲面必须与基曲面片共用三排控制顶点，因此对围成N边洞的曲面片要求较高，所以应用范围受到一定的限制，文献[<xref ref-type="bibr" rid="hanspub.16825-ref11">11</xref>] 也未涉及多边洞填充问题。针对以上情况，本文将细分曲面运用于对传统NURBS参数曲面进行拼接以及对N片NURBS参数曲面围成的N边洞进行连续填充，提出一类边界处理规则用以生成插值于角点的非均匀Catmull-Clark细分曲面，并利用插值于角点的非均匀Catmull-Clark细分曲面进行N边洞<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x12_hanspub.png" xlink:type="simple"/></inline-formula>连续填充。</p></sec><sec id="s4"><title>2. 非均匀Catmull-Clark细分模式与轮廓删除法</title><sec id="s4_1"><title>2.1. 非均匀Catmull-Clark细分模式[<xref ref-type="bibr" rid="hanspub.16825-ref11">11</xref>]</title><p>Catmull-Clark细分方法是三次B样条曲线细分向任意拓扑网格上曲面细分的推广，采用四边形1~4面分裂拓扑规则生成新网格的拓扑，包括几何规则和拓扑规则，在正规网格处产生双三次B样条曲面，该曲面除奇异顶点外处处<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x13_hanspub.png" xlink:type="simple"/></inline-formula>连续[<xref ref-type="bibr" rid="hanspub.16825-ref12">12</xref>] 。非均匀Catmull-Clark细分模式与Catmull-Clark细分模式的拓扑规则一样，但新点的计算公式如下：</p><p>新面点：</p><disp-formula id="hanspub.16825-formula254"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-1540526x14_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，</p><disp-formula id="hanspub.16825-formula255"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x15_hanspub.png"  xlink:type="simple"/></disp-formula><p>新边点：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x16_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>其中，</p><disp-formula id="hanspub.16825-formula256"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x17_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.16825-formula257"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-1540526x18_hanspub.png"  xlink:type="simple"/></disp-formula><p>新顶点：</p><disp-formula id="hanspub.16825-formula258"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/3-1540526x19_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x20_hanspub.png" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x21_hanspub.png" xlink:type="simple"/></inline-formula> ,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x22_hanspub.png" xlink:type="simple"/></inline-formula> ,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x23_hanspub.png" xlink:type="simple"/></inline-formula>的计算推导与(2)式中的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x24_hanspub.png" xlink:type="simple"/></inline-formula>相同，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x25_hanspub.png" xlink:type="simple"/></inline-formula>的计算推导与(1)式<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x26_hanspub.png" xlink:type="simple"/></inline-formula>相同。</p><p>在上面的公式中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x27_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x28_hanspub.png" xlink:type="simple"/></inline-formula>为参数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x29_hanspub.png" xlink:type="simple"/></inline-formula>与边<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x30_hanspub.png" xlink:type="simple"/></inline-formula>对应，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x31_hanspub.png" xlink:type="simple"/></inline-formula>表示该边绕<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x32_hanspub.png" xlink:type="simple"/></inline-formula>逆时针旋转遇到的第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x33_hanspub.png" xlink:type="simple"/></inline-formula>条边。新网格中各边参数赋予的规则表示如图1所示。</p></sec><sec id="s4_2"><title>2.2. 轮廓删除法</title><p>轮廓删除法(Skirt-removed approach)的思想就是每次细分时，边界边不产生新边点，边界点不产生新顶点点。它可以分两步进行：</p><p>1) 采用普通的Catmull-Clark细分模式生成过渡网格，计算出每个面对应的新面点，每条内部边对应的新边点，每个内部顶点对应的新顶点，再将所有新点按照细分拓扑规则连成一个新网格；</p><p>2) 把过渡网格上的轮廓即所有边界点、边界边、边界面及与边界点相连的内部边删除。</p><p>引入轮廓删除法是为了把Catmull-Clark细分模式应用于开网格(带有边界的二维流行[<xref ref-type="bibr" rid="hanspub.16825-ref11">11</xref>] )，开网格的轮廓是指网格上的所有边界面及其上的顶点、边所形成的子网格，对开网格删除轮廓是指在删除轮廓的同时，还要保留轮廓与内部面的公共边，这些被保留的公共边就是新网格的边界边。</p><p>为实现对NURBS曲面的混合和填充，关键是对开网格的边界做适当的处理，以使细分曲面插值于基曲面片的边界曲线，并满足一定的连续性要求。</p></sec></sec><sec id="s5"><title>3. NURBS曲面混合与N边洞填充</title><p>本节首先讨论NURBS曲面片的混合问题，然后构造插值于角点的非均匀Catmull-Clark细分曲面，再通过适当的处理，将得到的曲面统一到轮廓删除模式下的非均匀Catmull-Clark细分曲面，最后对非均匀Catmull-Clark细分曲面的N边洞进行G<sup>1</sup>填充。</p><sec id="s5_1"><title>3.1. 曲面混合</title><p>给定N片双三次非均匀B样条曲面为基曲面片，记第k片曲面P<sup>k</sup>的控制网格为：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x34_hanspub.png" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x35_hanspub.png" xlink:type="simple"/></inline-formula>；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x36_hanspub.png" xlink:type="simple"/></inline-formula>)，相应的单节点向量为：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x37_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x38_hanspub.png" xlink:type="simple"/></inline-formula>，要求构造出的细分曲面片与P<sup>k</sup>沿第一行(i = 1)控制顶点所确定的边界光滑拼接。假定每片都由<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x39_hanspub.png" xlink:type="simple"/></inline-formula>的控制网格确定，初始输入如图2 (黑点以外的部分)所示。</p><p>首先，为了使混合曲面与每片基曲面P<sup>k</sup>的拼接达到C<sup>2</sup>连续，初始控制网格应与P<sup>k</sup>的控制网格共用三行顶点：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x40_hanspub.png" xlink:type="simple"/></inline-formula>得到<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x41_hanspub.png" xlink:type="simple"/></inline-formula>个<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x42_hanspub.png" xlink:type="simple"/></inline-formula>网格片，增加一些新点把这些网格片连接成一个完整的控制网格，其增加点的规则如下：</p><p>图1. 新边参数赋予的规则</p><p>图2. 细分控制网格</p><disp-formula id="hanspub.16825-formula259"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x45_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.16825-formula260"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x46_hanspub.png"  xlink:type="simple"/></disp-formula><p>然后，对控制网格进行预处理，方法如下：</p><p>记细分混合曲面的控制网格为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x47_hanspub.png" xlink:type="simple"/></inline-formula>，取出其与P<sup>k</sup>公共的三排控制顶点，并加入相应的延伸边以及<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x48_hanspub.png" xlink:type="simple"/></inline-formula>中与P<sup>k</sup>相邻的边，记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x49_hanspub.png" xlink:type="simple"/></inline-formula>，设置<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x50_hanspub.png" xlink:type="simple"/></inline-formula>各边权值如下：</p><p>1) 同一列上的水平边所对应的权值为：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x51_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x52_hanspub.png" xlink:type="simple"/></inline-formula>；同时，延伸层中靠近第一列水平边(权值为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x53_hanspub.png" xlink:type="simple"/></inline-formula>)的边权值设为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x54_hanspub.png" xlink:type="simple"/></inline-formula>，延伸层中靠近最后一列水平边(权值为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x55_hanspub.png" xlink:type="simple"/></inline-formula>)的边权值设为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x56_hanspub.png" xlink:type="simple"/></inline-formula>.</p><p>2) 同一行上的竖直边所对应的权值为：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x57_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x58_hanspub.png" xlink:type="simple"/></inline-formula>；同时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x59_hanspub.png" xlink:type="simple"/></inline-formula>中与基曲面P<sup>k</sup>相邻的各边权值设为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x60_hanspub.png" xlink:type="simple"/></inline-formula>，延伸层中靠近最后一行竖直边(权值为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x61_hanspub.png" xlink:type="simple"/></inline-formula>)的边权值设为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x62_hanspub.png" xlink:type="simple"/></inline-formula>；经过预处理的控制网格仍记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x63_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>最后，进行迭代。先按照非均匀Catmull-Clark细分模式计算出控制网格<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x64_hanspub.png" xlink:type="simple"/></inline-formula>内部的新点，以任意方式计算出边界边对应的新边点和边界点对应的新顶点，并将所有新点连成新的拓扑网格，再删除最外一层控制网格。</p><p>图3是对三张<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x65_hanspub.png" xlink:type="simple"/></inline-formula>三次非均匀B样条开曲面进行拼接的结果，其中图3(a)为待拼接的非均匀三次B样条曲面片及其控制网格，图中红色的部分为非均匀Catmull-Clark曲面的初始控制网格。细分6次后，细分曲面对基曲面片的拼接效果如图3(b)和图3(c)所示。图4给出了5张基曲面混合的结果。</p><p>图3. (a) 基曲面片和细分控制网；(b) 基曲面片节点向量任意指定；(c) 节点距为控制顶点距的平均</p><p>图4. 五张基曲面片混合</p></sec><sec id="s5_2"><title>3.2. 插值于N边洞边界曲线的非均匀Catmull-Clark细分曲面</title><p>对于N片非均匀双三次B样条曲面片围成N边洞，本文采用插值于角点的非均匀B样条曲面，只需相邻曲面片有公共角点即可。将插值于角点的曲线细分公式统一成轮廓删除模式，根据非均匀Catmull-Clark细分模式的新点计算公式(1)，(2)，(3)，可以证明当最外两层控制网格正则，各行列首尾两条边的权值为零且所有的延伸边权值也为零时，非均匀Catmull-Clark细分模式产生的次外一层控制顶点即为新的控制顶点，且细分后的权值保持初始控制网格权值的特点. 对于N边洞问题本文给出以下算法。</p><p>算法1：(形成插值于角点的N边域曲面)。</p><p>Step 1：构造细分填充曲面的初始控制网格。保留边界曲线的控制顶点作为细分填充曲面的最外一层控制顶点。为了保证细分曲面的初始控制网格的最外两层顶点正则，当N边洞各边上的独立控制顶点数为奇数时，不再增加中心点，而是相对于各边的中心控制顶点各增加一个新点，再把新点与每个基曲面控制网的第1行中点相连，如图5所示。由于只需满足插值条件，中间的新控制顶点均可任意指定.</p><p>Step 2：将初始控制网格向外扩充一层，将所有的延伸边权值都赋为零，采用预处理方法对最外两层正则网格及其邻边边赋权值，延伸后的控制网格记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x70_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>Step 3：第k步迭代时，1) 按照非均匀Catmull-Clark细分模式对赋权的细分控制网格<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x71_hanspub.png" xlink:type="simple"/></inline-formula>进行细分，生成新的控制网格<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x72_hanspub.png" xlink:type="simple"/></inline-formula>；2) 删除最外一层控制顶点，与最外层控制顶点相连的边不进行删除，作为新控制网格的相应延伸边，将其权值作为延伸边的权值.生成的新的带延伸边的控制网格记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x73_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>图6和图7是对非均匀三次B样条曲线围成的三边洞和五边洞进行连续填充的效果图，红色和蓝色分别为构成N边洞的非均匀三次B样条曲线及其控制网格.通过移动新增加的控制顶点，图6(a)和图6(b)分别生成了凸起的和凹陷的两张曲面。</p><p>算法1将插值于角点的非均匀Catmull-Clark细分曲面统一成轮廓删除模式，跟文献[<xref ref-type="bibr" rid="hanspub.16825-ref11">11</xref>] 的插值于角点的N边域曲面比起来，对初始控制网格的要求更低，且避免了将初始控制网格分成两个单独的部分来处理，提高了可执行性。</p></sec><sec id="s5_3"><title>3.3. 基于非均匀Catmull-Clark细分模式的N边洞G<sup>1</sup>填充</title><p>由非均匀Catmull-Clark模式的局部B样条曲面性质，再根据插值于角点的B样条曲面的G<sup>1</sup>拼接条件，以<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x74_hanspub.png" xlink:type="simple"/></inline-formula>为例子给出基于非均匀Catmull-Clark细分模式的N边洞G<sup>1</sup>填充算法如下。</p><p>图5. 填充曲面初始控制网格</p><p>图6. (a) 凸起的填充曲面(三边洞)；(b) 凹陷的填充曲面(三边洞)</p><p>图7. 填充曲面(五边洞)</p><p>算法2：(G<sup>1</sup>填充算法)。</p><p>Step 1：构造细分填充曲面的初始控制网格，保留边界曲线的控制顶点作为细分填充曲面的最外一层控制顶点。相对于边界曲面的每一个交界点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x79_hanspub.png" xlink:type="simple"/></inline-formula>，对应一个新增控制顶点，记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x80_hanspub.png" xlink:type="simple"/></inline-formula>。相对于第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x81_hanspub.png" xlink:type="simple"/></inline-formula>个基曲面片的边界曲线<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x82_hanspub.png" xlink:type="simple"/></inline-formula>中间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x83_hanspub.png" xlink:type="simple"/></inline-formula>个控制顶点，各对应一个新控制顶点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x84_hanspub.png" xlink:type="simple"/></inline-formula>。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x85_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x86_hanspub.png" xlink:type="simple"/></inline-formula>组成了新增控制点的最外层，也就是细分填充曲面控制网格的次外层.再按照上述规则在内部插入控制顶点(如图8~图10所示)。</p><p>Step 2：确定<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x87_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x88_hanspub.png" xlink:type="simple"/></inline-formula>的位置。</p><p>1)<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x89_hanspub.png" xlink:type="simple"/></inline-formula>位于面<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x90_hanspub.png" xlink:type="simple"/></inline-formula>上，且根据下列相容性条件求出：</p><disp-formula id="hanspub.16825-formula261"><graphic xlink:href="http://html.hanspub.org/file/3-1540526x91_hanspub.png"  xlink:type="simple"/></disp-formula><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x92_hanspub.png" xlink:type="simple"/></inline-formula>五点共面保证了上面的相容性条件求解得到唯一的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x93_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>2) 同理，根据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x94_hanspub.png" xlink:type="simple"/></inline-formula>的相容性条件可求出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x95_hanspub.png" xlink:type="simple"/></inline-formula>，令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x96_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x97_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>3) 对已有的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x98_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x99_hanspub.png" xlink:type="simple"/></inline-formula>，根据相邻两B&#233;zier曲面片的G<sup>1</sup>拼接条件求出<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/3-1540526x100_hanspub.png" xlink:type="simple"/></inline-formula>的位置。</p><p>Step 3：对控制多边形的各边赋权值，再用非均匀Catmull-Clark细分方法的轮廓删除模式进行细分迭代。</p><p>图8. G<sup>1</sup>填充曲面的初始控制网格</p><p>图9. (a) 构成三边洞的基曲面片；(b) 三边洞G<sup>1</sup>连续填充</p><p>图10. 五边洞G<sup>1</sup>连续填充</p></sec></sec><sec id="s6"><title>4. 结论</title><p>本文研究了Catmull-Clark细分曲面与NURBS曲面的融合。在用非均匀Catmull-Clark细分方法的轮廓删除模式构造N边曲面片的基础上，为NURBS曲面的混合和N边洞填充给出了具体算法。同时，还提出了用非均匀Catmull-Clark细分模式构造N边曲面片的角点插值法，通过改变边界附近的边所对应的参数，把角点插值法归入了非均匀Catmull-Clark细分方法的轮廓删除模式，并由此给出了N边洞的一个填充算法，填充曲面和基曲面G<sup>1</sup>拼接。本文给出的算法都已在微机上实现。实验表明，本文的算法简单、有效。</p></sec><sec id="s7"><title>基金项目</title><p>中国国家自然科学基金(51175248/E050603)，南京航空航天大学基本科研业务费(NZ2013201)。</p></sec><sec id="s8"><title>文章引用</title><p>江南,唐月红,饶洁屏. NURBS曲面片的混合与填充 Blending and Filling of NURBS Patches[J]. 计算机科学与应用, 2016, 06(01): 21-29. http://dx.doi.org/10.12677/CSA.2016.61003</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.16825-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Prautzsch, H. (1998) Smoothness of Subdivision Surfaces at Extraordinary Points. Advances in Computer Mathematics, 9, 377-389. &lt;br&gt;http://dx.doi.org/10.1023/A:1018945708536</mixed-citation></ref><ref id="hanspub.16825-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Warren, J. and Weimer, H. (2001) Subdivision Methods for Geometric Design. Morgan Kaufmann Publisher, San Francisco.</mixed-citation></ref><ref id="hanspub.16825-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Zorin, D. and Schroder, P. (2001) Aunifield Framework for Primal/Dual Quadrilateral Subdivision Schemes. Computer Aided Geometric Design, 18, 429-454. &lt;br&gt;http://dx.doi.org/10.1016/S0167-8396(01)00040-1</mixed-citation></ref><ref id="hanspub.16825-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Stam, J. (2001) On Subdivision Schemes Gene-ralizing Uniform B-Spline Surfaces of Arbitrary Degree. Computer Aided Geometric Design, 18, 383-396. &lt;br&gt;http://dx.doi.org/10.1016/S0167-8396(01)00038-3</mixed-citation></ref><ref id="hanspub.16825-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">沈培强. 一种对称非均匀细分曲面算法[J]. 计算机光盘软件与应用, 2012(3): 148-150.</mixed-citation></ref><ref id="hanspub.16825-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Cashman, T.J., Dodgson, N.A. and Sabin, M.A. (2007) Non-Uniform B-Spline Subdivision Using Refine and Smooth. 12th IMA Conference on the Mathematics of Surfaces, Sheffield, 4-6 September 2007, 121-137. 
&lt;br&gt;http://dx.doi.org/10.1007/978-3-540-73843-5_8</mixed-citation></ref><ref id="hanspub.16825-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Schaefer, S. and Goidman, R. (2009) Non-Uniform Subdi-vision for B-Spline of Arbitrary Degree. Computer Aided Geometric Design, 26, 75-81. &lt;br&gt;http://dx.doi.org/10.1016/j.cagd.2007.12.005</mixed-citation></ref><ref id="hanspub.16825-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Wang, L.Z. and Zhu, X.X. (1995) Construction of N-Sided Patches. Computer Aided Drafting Design and Manufacturing, 5, 26-32.</mixed-citation></ref><ref id="hanspub.16825-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Cotrina, J., Pla, N. and Vigo, M. (2004) N-Sided Patches with B-Spline Boundaries. Computers &amp; Graphics, 30, 959- 970.</mixed-citation></ref><ref id="hanspub.16825-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">李桂清. 细分曲面造型及应用[D]: [博士学位论文]. 北京: 中国科学院计算技术研究所, 2001.</mixed-citation></ref><ref id="hanspub.16825-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">刘浩, 廖文和. 用非均匀细分模式构造N边域曲面[J]. 机械科学与技术, 2005, 24(11): 1323-1326.</mixed-citation></ref><ref id="hanspub.16825-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">李涛, 周来水. 细分曲面求交裁剪算法研究[J]. 计算机工程与应用, 2009, 45(30): 177-180.</mixed-citation></ref></ref-list></back></article>