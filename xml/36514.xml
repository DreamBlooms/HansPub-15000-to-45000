<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2019.107134</article-id><article-id pub-id-type="publisher-id">CSA-36514</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20190700000_75757492.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于差分进化算法与循环神经网络的MBR膜通量预测
  Prediction of MBR Membrane Flux Based on Differential Evolution Algorithm and Recurrent Neural Network
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>儒剑</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>春青</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>天津工业大学计算机科学与技术学院，天津</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>15</day><month>07</month><year>2020</year></pub-date><volume>10</volume><issue>07</issue><fpage>1299</fpage><lpage>1305</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   膜生物反应器(Membrane Bio-Reactor, MBR)处理污水是一个复杂的动态过程，难以用数学模型直接建模。针对该问题，本文利用差分进化算法(Differential Evolution Algorithm, DE)优化的循环神经网络(Recurrent Neural Network, RNN)对污水处理过程的膜通量进行预测。首先运用主成分分析法确定影响膜通量的相关过程变量；然后用DE算法优化RNN的初始权值和阈值；最后用训练好的DE-RNN模型进行预测并与样本数据对比。结果显示，该模型对膜通量地预测有着较高的准确率，具有很好的自适应性，达到了预期目标。 Wastewater treatment by membrane bio-reactor (MBR) is a complex dynamic process, which is difficult to be modeled directly by mathematical model. To solve this problem, this paper uses the recurrent neural network (RNN) based on differential evolution algorithm (DE) to predict membrane flux in wastewater treatment. First, authors used principal component analysis to determine the process variables affecting membrane fouling; and then used differential evolution algorithm to optimize initial value of RNN model; finally, the trained DE-RNN model was used to predict and compare with the sample data. The results show that the model has high accuracy, good adaptability and achieves the expected goal.  
  
 
</p></abstract><kwd-group><kwd>膜生物反应器，膜通量，差分进化算法，循环神经网络, Membrane Bio-Reactor (MBR)</kwd><kwd> Membrane Flux</kwd><kwd> Differential Evolution (DE) Algorithm</kwd><kwd> Recurrent Neural Network (RNN)</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于差分进化算法与循环神经网络的MBR膜通量预测<sup> </sup></title><p>黄儒剑，李春青</p><p>天津工业大学计算机科学与技术学院，天津</p><p>收稿日期：2020年6月22日；录用日期：2020年7月8日；发布日期：2020年7月15日</p><disp-formula id="hanspub.36514-formula1"><graphic xlink:href="//html.hanspub.org/file/1-1541820x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>膜生物反应器(Membrane Bio-Reactor, MBR)处理污水是一个复杂的动态过程，难以用数学模型直接建模。针对该问题，本文利用差分进化算法(Differential Evolution Algorithm, DE)优化的循环神经网络(Recurrent Neural Network, RNN)对污水处理过程的膜通量进行预测。首先运用主成分分析法确定影响膜通量的相关过程变量；然后用DE算法优化RNN的初始权值和阈值；最后用训练好的DE-RNN模型进行预测并与样本数据对比。结果显示，该模型对膜通量地预测有着较高的准确率，具有很好的自适应性，达到了预期目标。</p><p>关键词 :膜生物反应器，膜通量，差分进化算法，循环神经网络</p><disp-formula id="hanspub.36514-formula2"><graphic xlink:href="//html.hanspub.org/file/1-1541820x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/1-1541820x7_hanspub.png" /> <img src="//html.hanspub.org/file/1-1541820x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着我国工业的不断发展，水污染问题日益严重 [<xref ref-type="bibr" rid="hanspub.36514-ref1">1</xref>]。污水的处理与再利用，已成为“十三五”规划中，国家环境保护的重点工作之一 [<xref ref-type="bibr" rid="hanspub.36514-ref2">2</xref>]。膜生物反应器(MBR)是一种由膜分离单元与生物处理单元相结合的新型态、高效能污水处理系统 [<xref ref-type="bibr" rid="hanspub.36514-ref3">3</xref>]。膜生物反应器具有污水处理效率高、占地面积小、经济效益高等优点 [<xref ref-type="bibr" rid="hanspub.36514-ref4">4</xref>]，已广泛应用于城市污水处理、工业污水处理等领域。</p><p>在膜生物反应器的使用过程中，膜污染问题不可避免。膜污染会导致污水处理降低，工艺能耗增加，缩短中空纤维膜构件的使用寿命 [<xref ref-type="bibr" rid="hanspub.36514-ref5">5</xref>]。正确预测膜通量的大小，从而判断膜污染的程度，及时对膜构件进行清洗、替换，能够提高膜生物反应器的工作效率、能耗比与使用寿命，具有极大的实际意义与应用价值 [<xref ref-type="bibr" rid="hanspub.36514-ref6">6</xref>]。</p><p>在工业生产环境中，衡量膜污染程度的膜通量很难直接测量，需要根据膜生物反应器的其他运行参数进行预测。因为膜生物反应器处理污水是一个复杂的动态过程，各污染因子之间相互交叉相互影响，利用经典的数学模型难以直接建模并进行精确预测 [<xref ref-type="bibr" rid="hanspub.36514-ref7">7</xref>]。将人工神经网络用于MBR污水处理过程仿真，是近年来进行膜污染预测的新途径 [<xref ref-type="bibr" rid="hanspub.36514-ref8">8</xref>]。本文采用循环神经网络为算法主体，膜通量变化过程是一个随时间变化的连续过程，循环神经网络对时序变量的预测有着更好的适应性。同时利用差分进化算法对RNN的初始权值和阈值进行优化，可以提高模型的训练效率。研究发现，利用此模型可以准确地预测膜生物反应器的膜通量。</p></sec><sec id="s4"><title>2. RNN神经网络(Recurrent Neural Networks)</title><p>循环神经网络(Recurrent Neural Network, RNN)是一类以序列数据作为输入变量，在序列的演进方向进行递归运算且所有节点(循环单元)按链式连接的递归神经网络 [<xref ref-type="bibr" rid="hanspub.36514-ref9">9</xref>]。RNN在20世纪90年代提出，经过不断的发展与优化，在21世纪初成为深度学习的核心算法之一。</p><p>循环神经网络具有记忆性、参数共享性，因此在对序列的非线性特征进行学习时具有一定优势，其简单结构如图1所示。其中x是一个向量，它代表输入层的值；s是一个向量，它代表隐藏层的值；o是一个向量，它代表输出层的值；U是输入层到隐藏层的权重矩阵；V是隐藏层到输出层的权重矩阵；w是一个权重矩阵，将隐藏层上一次的值作为这一次的输入。RNN神经网络与全连接神经网络的区别在于，上一时刻隐藏层的输出，作为下一时刻隐藏层的输入变量之一参与运算。</p><p>图1. RNN结构示意图</p><p>其运算公式如下：</p><p>O t = g ( V ∗ S t ) (1)</p><p>S t = f ( U ∗ X t + W ∗ S t − 1 ) (2)</p><p>RNN网络在t时刻接收到 x t 之后，隐藏层 S t 的值取决于当前时刻输入的变量 x t 和上一时刻隐藏层的值 S t − 1 。</p></sec><sec id="s5"><title>3. 差分进化算法(Differential Evolution Algorithm)</title><p>差分进化算法(Differential Evolution Algorithm, DE)是一种采用浮点矢量编码进行随机搜索的高效的全局优化算法，对于具体问题条件限制的依赖性低。差分进化算法与遗传算法和粒子群算法相比，具有工作原理简单、控制参数少、容易实现等优点。</p><p>RNN神经网络的权重矩阵初始值的选择对于模型训练有着重要的意义。初始值选择不好，容易形成局部最优化，从而影响预测模型的精确度。用差分进化算法进行初始值的优化，有利于模型的训练。</p><p>DE算法采用实数编码，每一代的种群包含NP个维数为D的实数向量，其中个体表示为：</p><p>x i , G ( i = 1 , 2 , ⋯ , N P ) (3)</p><p>式中：NP表示种群规模；G表示当前进化代数；i表示个体在第G代种群中的位置标号。差分进化算法计算步骤如下：</p><p>1) 种群初始化</p><p>初始化种群，在边界约束条件下随机选择，采用下面表达式随机产生初始种群：</p><p>x = r a n d ( D , N P ) ∗ ( x U − x L ) + x L (4)</p><p>式中x表示存放初始种群的向量，D表示种群中个体的维数，NP表示种群规模， x U 表示种群中个体向量的上限， x L 表示种群中个体向量的下限， r a n d ( D , N P ) 表示分布在 ( 0 , 1 ) 区间内D行NP列的随机矩阵。</p><p>2) 变异操作</p><p>随机选取当代种群中两个不同向量生成变差向量，经变异算子F作用后与第三个向量结合生成变异向量，如公式(5)</p><p>v i , G + 1 = x r 1 , G + F ∗ ( x r 2 , G − x r 3 , G ) (5)</p><p>其中r<sub>1</sub>、r<sub>2</sub>、r<sub>3</sub>为随机选择的序号且互不相同，F为变异算子，变异算子F通常在0到2之间取值。</p><p>3) 交叉操作</p><p>通过将第G代种群中的目标向量个体 x i , G 与其变异向量个体 v i , G + 1 部分基因进行交叉操作产生试验向量 u i , G + 1 个体。</p><p>4) 选择操作</p><p>比较试验向量个体 u i , G + 1 和当前种群中的目标向量个体 x i , G ，分析不同向量个体的适应度，若 u i , G + 1 的适应度更高，则选其作为子代，否则选 x i , G 作为子代。</p></sec><sec id="s6"><title>4. 基于DE-RNN的膜通量预测模型</title><sec id="s6_1"><title>4.1. 采用PCA进行MBR系统参数选取</title><p>主成分分析法(Principal Component Analysis, PCA)是一种统计分析方法，用于掌握事物主要矛盾变量，它通过对原始数据集进行线性空间投影来分析矩阵特征值，从多维数据集中解析出主要影响因素，从而达到对数据集降维，简化复杂的问题的目的。</p><p>膜生物反应器的运行参数众多，如果将全部运行参数作为输入变量通过RNN运算，不仅计算量庞大，而且影响预测模型的准确率。通过PCA算法，减少RNN输入变量的个数，从而提升模型的性能。</p><p>主成分分析法步骤为：</p><p>Step1：把初选的影响因子组成矩阵X。</p><p>Step2：对矩阵X进行标准化处理，得到标准化矩阵A。</p><p>Step3：计算出协方差矩阵S。</p><p>Step4：计算协方差矩阵S的特征值λ与相应的特征向量u，然后由特征值降序排列得到特征值矩阵V和特征向量矩阵U。</p><p>Step5：由特征值矩阵V计算出贡献率，确定主成分。</p><p>初选MBR系统的六个参数作为膜污染影响因子，分别为总阻力、MLSS、COD、PH、温度、操作压力，并以此作为RNN输入层的六个神经元。膜通量为RNN输出层的唯一神经元。</p></sec><sec id="s6_2"><title>4.2. 建立基于DE-RNN的膜通量预测模型</title><p>循环神经网络RNN在应用时，网络权值和阈值的初始值选取不当，容易导致算法的局部最优化，从而影响网络识别的精度。本文采用差分进化算法对RNN的权值和阈值进行优化，以加快RNN的收敛速度和识别精度。</p><p>建立基于DE-RNN的预测模型。将RNN的参数作为种群的个体，RNN的计算结果作为判断标准，执行DE算法，得到满足精确度的种群个体，及经过优化的RNN权值和阈值的初始值。然后对经过优化的RNN进行训练，得到用于预测的DE-RNN模型。算法的程序流程图如图2所示。</p><p>图2. DE-RNN算法的程序流程图</p><p>具体实验步骤如下：</p><p>Step1：对RNN的参数编码，所有编码得到的基因位串称为一个个体。</p><p>Step2：初始种群随机产生，个体数量为20，构建初始的交配池。</p><p>Step3：执行RNN算法，将误差百分比作为衡量个体适应度的标准。个体间基因进行交叉和变异。</p><p>Step4：保留适应度高的个体，淘汰适应度低的个体。</p><p>Step5：回到(3)进行循环，直到得出最佳结果结束循环。</p><p>Step6：训练完毕，得到RNN权值和阈值的最优值，进行仿真实验。</p></sec></sec><sec id="s7"><title>5. 预测结果与实验结果对比分析</title><p>实验数据来自于石家庄市某污水处理厂，此污水处理厂采用MBR污水处理工艺，过滤膜为是孔径为0.2 μm的聚偏氟乙烯微滤膜。25组实验数据作为训练样本，5组实验数据作为校验用样本。</p><p>通过PCA算法选取的水质指标为6个：总阻力、MLSS、COD、PH、温度、操作压力，作为输入变量。本文使用的RNN的结构为的结构为6-10-1，使用快速梯度下降算法调整参数，输出单元为膜通量。进行实验，用RNN模型和DE-RNN模型分别预测膜通量并计算拟合度，DE-RNN模型预测数据和实际数据的对比结果如图3所示，RNN模型的预测拟合度如图4所示，DE-RNN模型的预测拟合度如图5所示。</p><p>对比实际数据和预测数据可知，预测数据的准确度在0.9以上，该模型具有较高的精确度，达到了准确预测膜通量的预期目标。对比RNN模型和DE-RNN模型的拟合度，RNN模型的拟合度最低为0.87，平均为0.94；DE-RNN模型的拟合度最低为0.91，平均为0.97。DE-RNN模型比RNN模型拟合度更高，误差更小。用DE算法优化RNN，对预测模型的准确度有着明显的提升。</p><p>图3. 膜通量的实际值与测试值关系图</p><p>图4. RNN拟合度测定实验图</p><p>图5. DE-RNN拟合度测定实验图</p></sec><sec id="s8"><title>6. 结论</title><p>MBR处理污水是一个复杂的动态过程，具有多流程、时变、不确定等特点，是一个运行非平稳的系统，用数学模型难以直接建模。本文在用主成分分析法简化MBR系统参数的基础上，用差分进化算法优化循环神经网络的初始权值和阈值，建立了DE-RNN仿真模型用以预测膜通量。实验结果表明，DE-RNN预测模型有着很高的精确度，该模型是有效的、可行的。DE-RNN模型与RNN模型相比拟合度更高，说明用DE算法优化RNN，对提高精确度，提高适应度有着积极的作用，对模型的优化是明显有效的。本文的研究有一定的理论价值和实践意义，对MBR膜通量预测可以起到积极的指导作用。</p></sec><sec id="s9"><title>基金项目</title><p>国家自然科学基金项目(51378350)；国家自然科学基金青年科学基金资助项目(50808130)；国家自然科学基金青年科学基金项目(21506159)。</p></sec><sec id="s10"><title>文章引用</title><p>黄儒剑,李春青. 基于差分进化算法与循环神经网络的MBR膜通量预测Prediction of MBR Membrane Flux Based on Differential Evolution Algorithm and Recurrent Neural Network[J]. 计算机科学与应用, 2020, 10(07): 1299-1305. https://doi.org/10.12677/CSA.2019.107134</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.36514-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">中华人民共和国环境保护部. 2018中国环境状况公报[Z], 2019-05-29.</mixed-citation></ref><ref id="hanspub.36514-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">中华人民共和国国务院. 国家环境保护”十三五”规划[Z]. 中华人民共和国国务院(国发[2016] 53号), 2016-03-20.</mixed-citation></ref><ref id="hanspub.36514-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Zhang, Y., Chen, Z.M., An, W., Xiao, S.M., Yuan, H.Y., Zhang, D.Q. and Yang, M. (2015) Risk Assessment of Giardia from a Full Scale MBR Sewage Treatment Plant Caused by Membrane Integrity Failure. Journal of Environmental Sciences, 30, 252-258. &lt;br&gt;https://doi.org/10.1016/j.jes.2014.09.033</mixed-citation></ref><ref id="hanspub.36514-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Meng, F., Chae, S.R., Drews, A., et al. (2009) Recent Advances in Membrane Bioreactors (MBRs): Membrane Fouling and Membrane Material. Water Research, 43, 1489-1512. &lt;br&gt;https://doi.org/10.1016/j.watres.2008.12.044</mixed-citation></ref><ref id="hanspub.36514-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Huang, L.Y. and Lee, D.-J. (2015) Membrane Bioreactor: A Mini Review on Recent R&amp;D Works. Bioresource Technology, 194, 383-388. &lt;br&gt;https://doi.org/10.1016/j.biortech.2015.07.013</mixed-citation></ref><ref id="hanspub.36514-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">韩永萍, 肖燕, 宋蕾, 王晓琳. MBR膜污染的形成及其影响因素研究进展[J]. 膜科学与技术, 2013, 33(1): 102-110.</mixed-citation></ref><ref id="hanspub.36514-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Zhang, M., Liao, B.Q., Zhou, X., et al. (2015) Effects of Hydrophilicity/Hydrophobicity of Membrane on Membrane Fouling in a Submerged Membrane Bioreactor. Bioresource Technology, 175, 59-67.  
&lt;br&gt;https://doi.org/10.1016/j.biortech.2014.10.058</mixed-citation></ref><ref id="hanspub.36514-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Kaneko, H. and Funatsu, K. (2013) Physical and Statistical Model for Predicting a Transmembrane Pressure Jump for a Membrane Bioreactor. Chemometrics &amp; Intelligent Labora-tory Systems, 121, 66-74.   
&lt;br&gt;https://doi.org/10.1016/j.chemolab.2012.11.013</mixed-citation></ref><ref id="hanspub.36514-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Goodfellow, I., Bengio, Y. and Courville, A. (2016) Deep Learning. The MIT Press, Cambridge, Massachusetts.</mixed-citation></ref></ref-list></back></article>