<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2021.118213</article-id><article-id pub-id-type="publisher-id">CSA-44478</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20210800000_66863970.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  有理数域上集合成员关系的保密判定协议
  Privacy Preserving Protocol of Rational Set Membership’s Judge
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>亚伟</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>长安大学理学院，陕西 西安</addr-line></aff><pub-date pub-type="epub"><day>02</day><month>08</month><year>2021</year></pub-date><volume>11</volume><issue>08</issue><fpage>2080</fpage><lpage>2087</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文通过将有理数按位编码为矩阵，并结合ElGamal同态加密算法，设计了有理数域上集合成员关系的保密判定协议，其中点集成员关系的保密判定协议可适用于 维有理点。其次，应用模拟范例的方法严格证明了协议的安全性，同时协议能够保护集合的势。最后，比较分析表明当参与者的有理数满足一定条件时，本文设计的协议是高效的。 By encoding the rational numbers into a matrix, combined with the ElGamal homomorphic encryption algorithm, this paper designs secure protocol for the rational set membership’s judge, in which the protocol for the point set membership can be applied to n(n≥2) dimensional rational points. Secondly, using the well accepted simulation paradigm proves that the proposed protocols are secure, and at the same time, the protocol can protect the number of elements in the partici2243pant set. Finally, the comparison and analysis show that the efficiency of the proposed protocol when the rational numbers meet certain conditions. 
  
 
</p></abstract><kwd-group><kwd>集合成员关系，安全多方计算，有理数，ElGamal同态加密算法, Set Membership</kwd><kwd> Secure Multi-Party Computation</kwd><kwd> Rational Number</kwd><kwd> ElGamal Homomorphic Encryption Algorithm</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>本文通过将有理数按位编码为矩阵，并结合ElGamal同态加密算法，设计了有理数域上集合成员关系的保密判定协议，其中点集成员关系的保密判定协议可适用于 n ( n ≥ 2 ) 维有理点。其次，应用模拟范例的方法严格证明了协议的安全性，同时协议能够保护集合的势。最后，比较分析表明当参与者的有理数满足一定条件时，本文设计的协议是高效的。</p></sec><sec id="s2"><title>关键词</title><p>集合成员关系，安全多方计算，有理数，ElGamal同态加密算法</p></sec><sec id="s3"><title>Privacy Preserving Protocol of Rational Set Membership’s Judge <sup> </sup></title><p>Yawei Li</p><p>School of Science, Chang’an University, Xi’an Shaanxi</p><p><img src="//html.hanspub.org/file/7-1542243x5_hanspub.png?20210811195816665" /></p><p>Received: Jul. 5<sup>th</sup>, 2021; accepted: Aug. 3<sup>rd</sup>, 2021; published: Aug. 11<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/7-1542243x6_hanspub.png?20210811195816665" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>By encoding the rational numbers into a matrix, combined with the ElGamal homomorphic encryption algorithm, this paper designs secure protocol for the rational set membership’s judge, in which the protocol for the point set membership can be applied to n ( n ≥ 2 ) dimensional rational points. Secondly, using the well accepted simulation paradigm proves that the proposed protocols are secure, and at the same time, the protocol can protect the number of elements in the participant set. Finally, the comparison and analysis show that the efficiency of the proposed protocol when the rational numbers meet certain conditions.</p><p>Keywords:Set Membership, Secure Multi-Party Computation, Rational Number, ElGamal Homomorphic Encryption Algorithm</p><disp-formula id="hanspub.44478-formula34"><graphic xlink:href="//html.hanspub.org/file/7-1542243x8_hanspub.png?20210811195816665"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/7-1542243x9_hanspub.png?20210811195816665" /> <img src="//html.hanspub.org/file/7-1542243x10_hanspub.png?20210811195816665" /></p></sec><sec id="s5"><title>1. 引言</title><p>隐私集合计算是安全多方计算 [<xref ref-type="bibr" rid="hanspub.44478-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref2">2</xref>] 领域中的一类重要问题，集合成员关系的保密判定问题是其中的一个基本问题，要求判定一个元素是否属于一个集合，而不泄露该元素和集合的具体信息。集合成员关系的保密判定问题在可搜索加密 [<xref ref-type="bibr" rid="hanspub.44478-ref3">3</xref>]、访问控制 [<xref ref-type="bibr" rid="hanspub.44478-ref4">4</xref>]、可撤销访问结构 [<xref ref-type="bibr" rid="hanspub.44478-ref5">5</xref>] 等问题中有重要的应用。</p><p>集合成员关系保密判定可通过数据相等比较 [<xref ref-type="bibr" rid="hanspub.44478-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref7">7</xref>]、两方集合交集或交集的势 [<xref ref-type="bibr" rid="hanspub.44478-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref11">11</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref12">12</xref>]、集合包含关系 [<xref ref-type="bibr" rid="hanspub.44478-ref13">13</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref14">14</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref15">15</xref>] [<xref ref-type="bibr" rid="hanspub.44478-ref16">16</xref>] 的保密计算协议间接地来实现。上述方法或者需要将元素与集合中元素进行一一比较、或者不需要协议的全部计算功能，会使协议的效率欠佳或导致参与方拥有的信息泄露。文献 [<xref ref-type="bibr" rid="hanspub.44478-ref17">17</xref>] 利用可交换加密方案提出了数集成员关系保密判定协议。文献 [<xref ref-type="bibr" rid="hanspub.44478-ref18">18</xref>] 利用全同态加密，结合范德蒙行列式的性质，设计了集合成员判定关系的相关协议。上述协议均仅适用于整数集上的集合成员关系判定。文献 [<xref ref-type="bibr" rid="hanspub.44478-ref19">19</xref>] 首次设计了有理数域上集合成员关系保密判定协议，并在数集成员关系保密判定协议的基础上，利用哥德尔编码将有理点编码为有理数，设计了点集成员关系的保密判定协议，但该协议只适用于2维有理点。</p><p>由于信息技术的快速发展，与坐标定位相关的应用软件得到了广泛应用，使用户的位置信息的私密性成为需要关注的问题。因此，设计有理点的相关保密计算协议有重要的实用价值。本文借助文献 [<xref ref-type="bibr" rid="hanspub.44478-ref20">20</xref>] 中提出的按位编码思想，结合ElGamal同态加密算法，针对有理数集合成员关系和有理点集成员关系的判定问题设计了保密计算协议。</p></sec><sec id="s6"><title>2. 预备知识</title><sec id="s6_1"><title>2.1. 安全多方计算模型</title><p>安全多方计算中通常使用半诚实模型和恶意模型。半诚实模型下的参与者会忠实地执行协议，但同时他们会保留执行协议中收到的中间信息，并试图推断其它参与者的输入。恶意模型下的参与者不按要求执行协议，可能有拒绝参加协议、提供错误的输入或者中间计算结果以及随时终止协议等行为。本文考虑半诚实模型下协议的安全性。</p></sec><sec id="s6_2"><title>2.2. 半诚实模型下的安全性定义</title><p>设 P i ( i = 1 , 2 ) 拥有私密信息 X i ，利用协议 π 合作计算函数 f ( X 1 , X 2 ) = ( f 1 ( X 1 , X 2 ) , f 2 ( X 1 , X 2 ) ) ，其中 f i ( X 1 , X 2 )   ( i = 1 , 2 ) 是 P i 收到的输出。将参与者 P i ( i = 1 , 2 ) 收到的信息序列记为 V I E W i π ( X 1 , X 2 ) = ( X i , r i , m 1 i , m 2 i , ⋯ , m l i , f i ( X ) ) ，其中 X i 是 P i 的输入， r i 是 P i 产生的随机数， m t i ( t = 1 , 2 , ⋯ , l ) 表示 P i 收到的第t个消息。</p><p>定义1 [<xref ref-type="bibr" rid="hanspub.44478-ref21">21</xref>] (半诚实模型下协议的安全性)对于 f ( X 1 , X 2 ) = ( f 1 ( X 1 , X 2 ) , f 2 ( X 1 , X 2 ) ) ，若存在概率多项式时间模拟器 S i ( i = 1 , 2 ) 满足下式：</p><p>{ S i ( X i , f ( X 1 , X 2 ) ) } X 1 , X 2 ≡ c   { V I E W i π ( X 1 , X 2 ) } X 1 , X 2 (1)</p><p>则称 π 保密地计算了 f ( X 1 , X 2 ) ，其中符号 ≡ c 表示计算上不可区分。</p><p>可通过构造满足式 的概率多项式时间模拟器 S i ( i = 1 , 2 ) 来证明协议的安全性，此方法称为模拟范例 [<xref ref-type="bibr" rid="hanspub.44478-ref21">21</xref>]。本文将用此方法证明协议的安全性。</p></sec><sec id="s6_3"><title>2.3. ElGamal同态加密算法</title><p>同态加密的概念最早由RIVEST [<xref ref-type="bibr" rid="hanspub.44478-ref22">22</xref>] 提出，可以通过对密文的操作实现对相应明文的计算。ElGamal加密算法 [<xref ref-type="bibr" rid="hanspub.44478-ref23">23</xref>] 是基于有限域上计算离散对数问题的困难性和Diffie-Hellman假设设计的，算法描述如下：</p><p>1) 密钥生成算法</p><p>对给定安全参数k，系统生成一个k比特的大素数p和循环群 Z p * 的一个生成元g。若选取随机数x作为私钥，对应公钥为 h = g x mod p 。</p><p>2) 加密算法E</p><p>对明文 M ( M ∈ Z p * ) ，选取的随机数r，加密得密文： E ( M ) = ( c 1 , c 2 ) = ( g r mod p , M h r mod p ) 。</p><p>3) 解密算法D</p><p>对于密文 E ( M ) ，其明文为： M = c 2 ⋅ c 1 − x mod p 。</p><p>ElGamal同态加密算法具有乘法同态性。对于明文消息 M 1 , M 2 ( M 1 + M 2 &lt; p ) ，其密文 E ( M 1 ) , E ( M 2 ) 满足 E ( M 1 ) &#215; E ( M 2 ) = E ( M 1 &#215; M 2 ) 。</p></sec></sec><sec id="s7"><title>3. 有理数域上集合成员关系保密判定</title><sec id="s7_1"><title>3.1. 编码方法</title><p>李顺东 [<xref ref-type="bibr" rid="hanspub.44478-ref20">20</xref>] 等人为了解决多个有理数相等保密判定问题，提出了按位编码的方法，将一个有理数编码为一个矩阵，具体过程如下：</p><p>首先，对于参与者 P i 持有的有理数 x i = a i / b i = a i 1 a i 2 ⋯ a i s i / b i 1 b i 2 ⋯ b i s i ，其中 gcd ( a i , b i ) = 1 ， a i k , b i l ∈ { 0 , 1 , ⋯ , 9 } , 1 ≤ k ≤ s i , 1 ≤ l ≤ q i ，统一其分子和分母位数分别为 s , q ，位数不够的情况按下式转换数据，</p><p>x i → 0 ⋯ 0 a i 1 a i 2 ⋯ a i s i 0 ⋯ 0 b i 1 b i 2 ⋯ b i q i → e i 1 ⋯ e i j ⋯ e i s + q (2)</p><p>即通过在分子分母之前补0将其拥有的有理数的分子分母位数统一，并将其分子分母连接起来，其中 1 ≤ j ≤ s + q 。其次，根据式(2)将有理数 x i 按位编码为矩阵：</p><p>U ( s + q ) &#215; 10 = [ u 1 1 u 2 1 ⋯ u 10 1 u 1 2 u 2 2 ⋯ u 10 2 ⋮ ⋮ ⋮ u 1 s + q u 2 s + q ⋯ u 10 s + q ] (3)</p><p>对于每一行 u j = [ u 1 j u 2 j ⋯ u 10 j ] ( 1 ≤ j ≤ s + q ) ，有：</p><p>u k j = { 0 ,             e i j = k − 1 r k j ,         e i j ≠ k − 1 (4)</p><p>其中 r k j ∈ Z p * 且是非零的随机数。现将上述编码方法中的式(4)改为：</p><p>u k j = { 1 ,           e i j = k − 1 r k j ,       e i j ≠ k − 1 (5)</p><p>其中 r k j ∈ Z p * 且是大于1的随机数。下文将利用改动后的方法设计有理数域上集合成员关系的保密判定协议。</p></sec><sec id="s7_2"><title>3.2. 有理数域上数集成员关系的保密判定</title><p>问题描述 Alice拥有有理数 v 0 ，Bob拥有有理数集合 V = { v 1 , v 2 , ⋯ , v m } 。双方希望在不泄露 v o ，V中元素及V的势的前提下合作计算函数 P ( v 0 , V ) ：若 v 0 ∈ V ， P ( v 0 , V ) = 1 ；否则， P ( v 0 , V ) = 0 。</p><p>计算原理 Alice和Bob依据式(2)将有理数 v i ( i = 0 , 1 , ⋯ , m ) 作如下转换：</p><p>v i → e i 1 ⋯ e i j ⋯ e i s + q (6)</p><p>其中 1 ≤ j ≤ s + q 。Alice依据式(5)将有理数 v 0 编码为矩阵U，并将U发送给Bob。Bob对于其拥有的有理数 v i ，依据式(6)中的 e i j ( 1 ≤ j ≤ s + q ) 从 u 1 至 u s + q 中依次取出对应位置编码 u e i 1 + 1 1 , u e i 2 + 1 2 , ⋯ , u e i s + q + 1 s + q ，计算 U i = u e i 1 + 1 1 u e i 2 + 1 2 ⋯ u e i s + q + 1 s + q ，容易得到以下命题是正确的。</p><p>命题1 P ( v 0 , V ) = 1 当且仅当对于每一个 i = 1 , 2 , ⋯ , m 存在 U i = 1 。</p><p>协议1有理数域上数集成员关系的保密判定协议</p><p>输入：Alice输入 v 0 ，Bob输入 V = { v 1 , v 2 , ⋯ , v m } 。</p><p>输出： P ( v 0 , V )</p><p>准备：Alice和Bob依据式(2)对有理数 v 0 , v i ( i = 1 , 2 , ⋯ , m ) 进行转换得到式(6)。</p><p>1. Alice执行以下操作：</p><p>1) 产生ElGamal同态算法的密钥对 ( s k , p k ) ；</p><p>2) 根据(5)式将 v 0 按位编码为矩阵U；</p><p>3) 利用公钥 p k 加密矩阵U中 u k j = 1 的分量，得加密矩阵：</p><p>E ( U ) = [ u 1 1 u 2 1 ⋯ u 10 1 u 1 2 u 2 2 ⋯ u 10 2 ⋮ ⋮ ⋮ u 1 s + q u 2 s + q ⋯ u 10 s + q ] = [ ( c 11 1 , c 12 1 ) ( c 21 1 , c 22 1 ) ⋯ ( c ( 10 ) 1 1 , c ( 10 ) 2 1 ) ( c 11 2 , c 12 2 ) ( c 21 2 , c 22 2 ) ⋯ ( c ( 10 ) 1 2 , c ( 10 ) 2 2 ) ⋮ ⋮ ⋮ ( c 11 s + q , c 12 s + q ) ( c 21 s + q , c 22 s + q ) ⋯ ( c ( 10 ) 1 s + q , c ( 10 ) 2 s + q ) ] (7)</p><p>其中 ( c ( e 0 j + 1 ) 1 j , c ( e 0 j + 1 ) 2 j ) = E ( 1 ) ， ( c ( ≠ e 0 j + 1 ) 1 j , c ( ≠ e 0 j + 1 ) 2 j ) ∈ Z p * &#215; Z p * 为随机数对。Alice将矩阵 E ( U ) 及公钥 p k 发送</p><p>给Bob。</p><p>2. 对于每个 i = 1 , 2 , ⋯ , m ，Bob执行以下操作：</p><p>1) 根据式 中的 e i j ( 1 ≤ j ≤ s + q ) 从 E ( U ) 中按位取出密文 E ( u e i 1 + 1 1 ) , E ( u e i 2 + 1 2 ) , ⋯ , E ( u e i s + q + 1 s + q ) ，并计算：</p><p>E ( U i ) = E ( u e i 1 + 1 1 ) E ( u e i 2 + 1 2 ) ⋯ E ( u e i s + q + 1 s + q ) (8)</p><p>2) 选取正整数l，满足 l &gt; m 。从 Z p * 中选取 l − m 个大于1的随机数 r 1 , r 2 , ⋯ , r l − m ，并计算其密文 E ( r 1 ) , E ( r 2 ) , ⋯ , E ( r l − m ) ；</p><p>3) 对密文 E ( U i ) , E ( r 1 ) , E ( r 2 ) , ⋯ , E ( r l − m ) ( i = 1 , 2 , ⋯ , m ) 的顺序进行随机置换，并按置换后的顺序发</p><p>送给Alice。</p><p>3. Alice解密收到的密文，记解密结果为 d k ( 1 ≤ k ≤ l ) 。若存在 d k = 1 ，Alice输出 P ( v 0 , V ) = 1 ；否则，输出 P ( v 0 , V ) = 0 。</p><p>正确性分析 命题1的正确性及本文采用的ElGamal加密算法的同态性保证了协议1的正确性。</p><p>安全性分析 Alice将加密矩阵 E ( U ) 发送给Bob，由于Bob没有私钥，因此无法获得有理数 v 0 的任何信息。Bob将随机置换后的l个密文 E ( U i ) , E ( r 1 ) , E ( r 2 ) , ⋯ , E ( r l − m ) ( i = 1 , 2 , ⋯ , m ) 发送给Alice，由于Alice不知道具体置换，因此无法推得集合V中任何元素的信息；同时，由于随机数 r 1 , r 2 , ⋯ , r l − m 均大于1，则发送密文 E ( r 1 ) , E ( r 2 ) , ⋯ , E ( r l − m ) 给Alice的操作不影响协议的正确性且隐藏了集合V的势。</p><p>定理1 协议1在半诚实模型下是安全的。</p><p>证明：利用模拟范例证明协议1的安全性。在协议1中， f 1 ( v 0 , V ) = f 2 ( v 0 , V ) = P ( v 0 , V ) 。首先构造模拟器 S 1 ， S 1 接受输入 ( v 0 , P ( v 0 , V ) ) ，按照如下方式运行：</p><p>1) 随机选取有理数集 V ′ = { v ′ 1 , v ′ 2 , ⋯ , v ′ m } 使得 P ( v 0 , V ) = P ( v 0 , V ′ ) ，将 v 0 , v ′ i ( i = 1 , 2 , ⋯ , m ) 进行转换：</p><p>v 0 → e 0 1 ⋯ e 0 j ⋯ e 0 s + q v ′ i → e i 1 ′ ⋯ e i j ′ ⋯ e i s + q ′ (9)</p><p>2) S 1 将 v 0 编码为矩阵U，并加密得矩阵 E ( U ) ，如式(7)所示。</p><p>3) 计算 E ( U ′ i ) = E ( u e i 1 ′ + 1 1 ) E ( u e i 2 ′ + 1 2 ) ⋯ E ( u e i s + q ′ + 1 s + q ) ， ( i = 1 , 2 , ⋯ , m ) ，生成 l − m 个大于1的随机数 r ′ 1 , r ′ 2 , ⋯ , r ′ l − m ，计算其密文 E ( r ′ 1 ) , E ( r ′ 2 ) , ⋯ , E ( r ′ l − m ) 。</p><p>4) 解密 E ( U ′ i ) , E ( r ′ 1 ) , E ( r ′ 2 ) , ⋯ , E ( r ′ l − m ) ( i = 1 , 2 , ⋯ , m ) ，记解密结果为 d ′ k ( 1 ≤ k ≤ l ) ，根据 d ′ k 可得 P ( v 0 , V ′ ) 。</p><p>令 S 1 ( v 0 , P ( v 0 , V ) ) = { v 0 , E ( U ′ i ) , r ′ u , E ( r ′ u ) , P ( v 0 , V ′ ) } ，其中 i = 1 , 2 , ⋯ , m ， u = 1 , 2 , ⋯ , l − m 。而协议执行中， V I E W 1 ( v 0 , V ) = { v 0 , E ( U i ) , r u , E ( r u ) , P ( v 0 , V ) } 。由于Bob没有私钥，根据ElGamal加密算法的语义安全性，对Bob来说， E ( U i )   ≡ c   E ( U ′ i ) 以及 E ( r u )   ≡ c   E ( r ′ u ) ，其中 i = 1 , 2 , ⋯ , m ， u = 1 , 2 , ⋯ , l − m 。由于随机数计算上不可区分，则 r u   ≡ c   r ′ u 。又因为 P ( v 0 , V ) = P ( v 0 , V ′ ) ，因此 { S 1 ( v 0 , P ( v 0 , V ) ) } = { V I E W 1 ( v 0 , V ) } 。</p><p>S 2 可用类似方法构造，此处省略。定理1得证。</p></sec><sec id="s7_3"><title>3.3. 有理数域上点集成员关系的保密判定</title><p>以n维有理点为例设计点集成员关系的保密判定协议。</p><p>问题描述 Alice拥有n维有理点 X = ( x 1 , x 2 , ⋯ , x n ) ，Bob拥有n维有理点集合 Y = { Y 1 , Y 2 , ⋯ , Y m } ，其中 Y t = ( y 1 t , y 2 t , ⋯ , y n t ) ( t = 1 , 2 , ⋯ , m ) 。双方希望在不泄露X、Y中元素及Y的势的前提下合作计算函数 P ( X , Y ) ：若 X ∈ Y ， P ( X , Y ) = 1 ；否则 P ( X , Y ) = 0 。</p><p>计算原理 Alice和Bob依据式(2)将有理点 X = ( x 1 , x 2 , ⋯ , x n ) , Y t = ( y 1 t , y 2 t , ⋯ , y n t )   ( t = 1 , 2 , ⋯ , m ) 的坐标</p><p>作如下转换：</p><p>x i → e i 1 ⋯ e i j ⋯ e i s + q y i t → e i t 1 ⋯ e i t j ⋯ e i t ( s + q ) (10)</p><p>其中 i = 1 , 2 , ⋯ , n ， 1 ≤ j ≤ s + q 。对于每一个 i = 1 , 2 , ⋯ , k ，Alice依据下式：</p><p>u ( i ) k j = { 1 ,             e i j = k − 1 r k j ,         e i j ≠ k − 1 (11)</p><p>将 x i 编码为矩阵 U ( i ) ，并发送给Bob。对于每一个有理点 Y t ( t = 1 , 2 , ⋯ , m ) 的坐标 y i t ( i = 1 , 2 , ⋯ , n ) ，Bob依据式(10)中的 e i t j ，从 u ( i ) 1 至 u ( i ) s + q 中依次取出对应位置编码 u ( i ) e i t 1 + 1 1 , u ( i ) e i t 2 + 1 2 , ⋯ , u ( i ) e i t ( s + q ) + 1 s + q ，并计算： U i t = u ( i ) e i t 1 + 1 1 ⋅ u ( i ) e i t 2 + 1 2 ⋅ ⋯ ⋅ u ( i ) e i t ( s + q ) + 1 s + q 。容易得到以下命题是正确的。</p><p>命题2 P ( X , Y ) = 1 当且仅当对于每个 t = 1 , 2 , ⋯ , m 存在 ∏ i = 1 n U i t = 1 。</p><p>协议2有理数域上点集成员关系保密判定协议</p><p>输入：Alice输入有理点 X = ( x 1 , x 2 , ⋯ , x n ) ，Bob输入有理数集合 Y = { Y 1 , Y 2 , ⋯ , Y m } ，其中 Y t = ( y 1 t , y 2 t , ⋯ , y n t ) ( t = 1 , 2 , ⋯ , m ) 。</p><p>输出： P ( X , Y ) 。</p><p>准备：Alice和Bob据式(2)对有理点 X = ( x 1 , x 2 , ⋯ , x n ) , Y t = ( y 1 t , y 2 t , ⋯ , y n t )   ( t = 1 , 2 , ⋯ , m ) 的坐标转换得到式(10)。</p><p>1. Alice执行以下操作：</p><p>1) 产生ElGamal加密算法的密钥对 ( s k , p k ) ；</p><p>2) 根据(11)式将 x i ( i = 1 , 2 , ⋯ , n ) 按位编码为矩阵 U ( i ) ；</p><p>3) 利用公钥 p k 加密矩阵 U ( i )   ( i = 1 , 2 , ⋯ , n ) 中 u ( i ) k j = 1 的分量，得加密矩阵：</p><p>E ( U ( i ) ) = [ E ( u ( i ) 1 1 ) E ( u ( i ) 1 1 ) ⋯ E ( u ( i ) 10 1 ) E ( u ( i ) 1 2 ) E ( u ( i ) 1 2 ) ⋯ E ( u ( i ) 10 2 ) ⋮ ⋮ ⋮ E ( u ( i ) 1 s + q ) E ( u ( i ) 1 s + q ) ⋯ E ( u ( i ) 10 s + q ) ] = [ ( c 11 1 , c 12 1 ) ( i ) ( c 21 1 , c 22 1 ) ( i ) ⋯ ( c ( 10 ) 1 1 , c ( 10 ) 2 1 ) ( i ) ( c 11 2 , c 12 2 ) ( i ) ( c 21 2 , c 22 2 ) ( i ) ⋯ ( c ( 10 ) 1 2 , c ( 10 ) 2 2 ) ( i ) ⋮ ⋮ ⋮ ( c 11 s + q , c 12 s + q ) ( i ) ( c 21 s + q , c 22 s + q ) ( i ) ⋯ ( c ( 10 ) 1 s + q , c ( 10 ) 2 s + q ) ( i ) ] (12)</p><p>其中 ( c ( e i j + 1 ) 1 j , c ( e i j + 1 ) 2 j ) ( i ) = E ( 1 ) ， ( c ( ≠ e i j + 1 ) 1 j , c ( ≠ e i j + 1 ) 2 j ) ( i ) ∈ Z p * &#215; Z p * 为随机数对。Alice将矩阵 E ( i ) ( U ) 及公钥 p k</p><p>发送给Bob。</p><p>2. 对于每一个 t = 1 , 2 , ⋯ , m 和 i = 1 , 2 , ⋯ , n ，Bob执行以下操作：</p><p>1) 根据 y i t 从 E ( U ) 中按位取出密文 E ( u ( i ) e i t 1 + 1 1 ) , E ( u ( i ) e i t 2 + 1 2 ) , ⋯ , E ( u ( i ) e i t ( s + q ) + 1 s + q ) ，计算：</p><p>U i t = E ( u ( i ) e i t 1 + 1 1 ) E ( u ( i ) e i t 2 + 1 2 ) ⋯ E ( u ( i ) e i t ( s + q ) + 1 s + q ) (13)</p><p>进一步计算 U t = ∏ i = 1 n U i t 。</p><p>2) 选取正整数l，满足 l &gt; m 。从 Z p * 中选取 l − m 个大于1的随机数 r 1 , r 2 , ⋯ , r l − m ，并计算其密文 E ( r 1 ) , E ( r 2 ) , ⋯ , E ( r l − m ) ；</p><p>3) 对密文 E ( U i ) , E ( r 1 ) , E ( r 2 ) , ⋯ , E ( r l − m )   ( i = 1 , 2 , ⋯ , m ) 的顺序进行随机置换，并按置换后的顺序发</p><p>送给Alice。</p><p>3. Alice解密收到的密文，记解密结果为 d k ( 1 ≤ k ≤ l ) 。若存在 d k = 1 ，Alice输出 P ( X , Y ) = 1 ；否则，输出 P ( X , Y ) = 0 。</p><p>正确性分析 命题2的正确性以及本文采用的ElGamal加密系统的同态性保证了协议2的正确性。</p><p>安全性分析 X、Y中元素及Y的势的隐私性可类似于协议1中 v o 、V中元素及V的势的隐私性进行分析。</p><p>定理2 协议2在半诚实模型下是安全的。</p><p>定理2的证明类似于定理1的证明，故省略。</p></sec></sec><sec id="s8"><title>4. 协议分析与比较</title><p>本文中设计的协议用到了ElGamal同态加密算法，计算复杂性分析只考虑费时的模指数运算。用通信次数衡量协议的通信复杂性，一方发送给另一方算一次。</p><p>计算复杂性分析 每进行一次ElGamal加密(解密)操作需要2次(1次)模指数运算。协议1中Alice需加密 s + q 次，解密l次；Bob需加密 l − m 次。因此，协议1共需 3 l + 2 ( s + q ) − 2 m 次模指数运算。类似地进行分析可知协议2共需 3 l + 2 n ( s + q ) − 2 m 次模指数运算。</p><p>通信复杂性分析 协议1和协议2的通信次数均为2次。</p><p>将本文设计的协议与文献 [<xref ref-type="bibr" rid="hanspub.44478-ref19">19</xref>] 中的协议进行比较，结果如表1所示。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The comparison of protocol</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >文献</th><th align="center" valign="middle" >计算功能</th><th align="center" valign="middle" >计算复杂性</th><th align="center" valign="middle" >通信复杂性</th><th align="center" valign="middle" >适用范围</th></tr></thead><tr><td align="center" valign="middle" >协议1 协议2</td><td align="center" valign="middle" >数集成员关系 点集成员关系</td><td align="center" valign="middle" >3 l + 2 ( s + q ) − 2 m 3 l + 2 n ( s + q ) − 2 m</td><td align="center" valign="middle" >2 2</td><td align="center" valign="middle" >有理数 n ( n ≥ 2 ) 维有理点</td></tr><tr><td align="center" valign="middle" >文献 [<xref ref-type="bibr" rid="hanspub.44478-ref19">19</xref>]</td><td align="center" valign="middle" >数集成员关系 点集成员关系</td><td align="center" valign="middle" >3 l + 8 3 l + 8</td><td align="center" valign="middle" >4 4</td><td align="center" valign="middle" >有理数 2维有理点</td></tr></tbody></table></table-wrap><p>表1. 协议的比较</p><p>注解：其中l均是参与方为隐藏集合的势选取的正整数。</p><p>相比文献 [<xref ref-type="bibr" rid="hanspub.44478-ref19">19</xref>]，当参与计算的有理数按(2)式统一转换后，当 s + q &lt; m 时，协议1计算复杂性低；当 n = 2 且 s + q &lt; m / 2 时，协议2计算复杂性低。本文协议的通信效率高于文献 [<xref ref-type="bibr" rid="hanspub.44478-ref19">19</xref>] 中的协议。此外，协议2可用于 n ( n ≥ 2 ) 维有理点。</p></sec><sec id="s9"><title>5. 结束语</title><p>针对有理数域上集合成员关系的保密判定问题，本文借助文献 [<xref ref-type="bibr" rid="hanspub.44478-ref20">20</xref>] 中按位编码的方法，提出了有理数集成员关系和有理点集成员关系的保密判定协议，且点集成员关系的保密判定协议适用于 n ( n ≥ 2 ) 维有理点。比较分析表明本文设计的协议通信效率高于相关协议，当参与计算的有理数满足一定条件时，本文协议的计算复杂度更低。因此，未来将进一步研究高效的集合成员关系的保密判定协议。</p></sec><sec id="s10"><title>文章引用</title><p>李亚伟. 有理数域上集合成员关系的保密判定协议Privacy Preserving Protocol of Rational Set Membership’s Judge[J]. 计算机科学与应用, 2021, 11(08): 2080-2087. https://doi.org/10.12677/CSA.2021.118213</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.44478-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Yao, A.C. (1982) Protocols for Secure Computations. The 23rd Annual IEEE Symposium on Foundations of Computer Science, Chicago, 3-5 November 1982, 160-164. &lt;br&gt;https://doi.org/10.1109/SFCS.1982.38</mixed-citation></ref><ref id="hanspub.44478-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Benor, M., Goldwasser, S., Widerson, A., et al. (1988) Completeness Theorems for Non-Crypto-Graphic Fault-Tolerant Distributed Computation. The Twentieth Annual ACM Symposium on Theory of Computing, Chicago, 2-4 May 1988, 1-10. &lt;br&gt;https://doi.org/10.1145/62212.62213</mixed-citation></ref><ref id="hanspub.44478-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Dan, B., Giovanni, D.C., Rafail, O., et al. (2004) Public Key Encryption with Keyword Search. International Conference on the Theory and Applications of Cryptographic Techniques, Interlaken, 2-6 May 2004, 506-522.</mixed-citation></ref><ref id="hanspub.44478-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Sandhu, R.S., Coyne, E.J., Feinstein, H.L., et al. (1996) Role-Based Access Control Models. Computer, 29, 38-47.  
&lt;br&gt;https://doi.org/10.1109/2.485845</mixed-citation></ref><ref id="hanspub.44478-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Ruj, S., Stojmenovic, M., Nayak, A. (2014) Decentralized Access Control with Anonymous Authentication of Data Stored in Clouds. IEEE Transactions on Parallel and Distributed Systems, 25, 384-394.  
&lt;br&gt;https://doi.org/10.1109/TPDS.2013.38</mixed-citation></ref><ref id="hanspub.44478-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">秦静, 张振峰, 冯登国, 李宝. 一个特殊的安全双方计算协议[J]. 通信学报, 2004(11): 35-42.</mixed-citation></ref><ref id="hanspub.44478-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">秦静, 张振峰, 冯登国, 李宝. 无信息泄漏的比较协议[J]. 软件学报, 2004(3): 421-427.</mixed-citation></ref><ref id="hanspub.44478-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Pinka, B., Schneider, T., Weinert, C. and Wieder, U. (2018) Efficient Circuit-Based PSI via Cuckoo Hashing. In: Nielsen, J.B. and Rijmen, V., Eds., Advances in Cryptology—EUROCRYPT 2018, LNCS, Vol. 10822, Springer, Berlin, 125-157. &lt;br&gt;https://doi.org/10.1007/978-3-319-78372-7_5</mixed-citation></ref><ref id="hanspub.44478-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">窦家维, 刘旭红, 周素芳, 等. 高效的集合安全多方计算协议及应用[J]. 计算机学报, 2018, 41(8): 1844-1860.</mixed-citation></ref><ref id="hanspub.44478-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">周素芳, 李顺东, 郭奕旻, 窦家维, 陈振华. 保密集合相交问题的高效计算[J]. 计算机学报, 2018, 41(2): 464-480.</mixed-citation></ref><ref id="hanspub.44478-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">陈振华, 李顺东, 黄琼, 丁勇, 刘娅茹. 非加密方法安全计算两种集合关系[J]. 软件学报, 2018, 29(2): 473-482.</mixed-citation></ref><ref id="hanspub.44478-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">唐春明, 林旭慧. 隐私保护集合交集计算协议[J]. 信息网络安全, 2020, 20(1): 9-15.</mixed-citation></ref><ref id="hanspub.44478-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">李荣花, 武传坤, 张玉清. 判断集合包含关系的安全计算协议[J]. 计算机学报, 2009, 32(7): 1337-1345.</mixed-citation></ref><ref id="hanspub.44478-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Dou, J.W., Gong, L.M., Li, S.D., et al. (2016) Ef-ficient Private Subset Computation. Security and Communication Networks, 9, 5965-5976. &lt;br&gt;https://doi.org/10.1002/sec.1749</mixed-citation></ref><ref id="hanspub.44478-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Zhou, S.F., Li, S.D., Dou, J.W., et al. (2017) Efficient Secure Multiparty Subset Computation. Security and Communication Networks, 2017, Article ID: 9717580. &lt;br&gt;https://doi.org/10.1155/2017/9717580</mixed-citation></ref><ref id="hanspub.44478-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">程楠, 赵运磊. 一种高效的关于两方集合并/交集基数的隐私计算方法[J]. 密码学报, 2021, 8(2): 352-364.</mixed-citation></ref><ref id="hanspub.44478-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Li, S.D., Wang, D.S. and Dai, Y.Q. (2009) Symmetric Cryptographic Protocols for Extended Millionaires’ Problem. Science China Information Sciences, 52, 974-982. &lt;br&gt;https://doi.org/10.1007/s11432-009-0109-6</mixed-citation></ref><ref id="hanspub.44478-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">张茜, 苏烨, 秦静. 集合成员关系判定的安全多方计算协议[J]. 山东大学学报(理学版), 2020, 55(4): 118-126.</mixed-citation></ref><ref id="hanspub.44478-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">窦家维, 刘旭红, 王文丽. 有理数域上两方集合的高效保密计算[J]. 计算机学报, 2020, 43(8): 1397-1413.</mixed-citation></ref><ref id="hanspub.44478-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">李顺东, 杜润萌, 杨颜璟, 魏琼. 有理数相等的保密判定[J]. 电子学报, 2020, 48(10): 1933-1937.</mixed-citation></ref><ref id="hanspub.44478-ref21"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Goldreich, O. (2004) Foundation of Cryptography: Volume 2, Basic Appli-cations. Cambridge University Press, London, 599-764. &lt;br&gt;https://doi.org/10.1017/CBO9780511721656</mixed-citation></ref><ref id="hanspub.44478-ref22"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">Rivest, R.L., Adleman, L.M. and Dertouzos, M.L. (1978) On Data Banks and Privacy Homeomorphisms. In: Foundations of Secure Computation, Academia Pres, Cambridge, 169-177.</mixed-citation></ref><ref id="hanspub.44478-ref23"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Gamal, T. (1984) A Public Key Cryptosystem and a Signature Scheme Based on Discrete Logarithms. IEEE Transactions on Information Theory, 31, 469-472. &lt;br&gt;https://doi.org/10.1109/TIT.1985.1057074</mixed-citation></ref></ref-list></back></article>