<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SEA</journal-id><journal-title-group><journal-title>Software Engineering and Applications</journal-title></journal-title-group><issn pub-type="epub">2325-2286</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SEA.2021.102022</article-id><article-id pub-id-type="publisher-id">SEA-42034</article-id><article-categories><subj-group subj-group-type="heading"><subject>SEA20210200000_88962886.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于RLWE认证密钥协商算法的设计
  Design of Authenticated Key Agreement Algorithm Based on RLWE
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>秀菊</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>子臣</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>北京印刷学院信息工程学院，北京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>07</day><month>04</month><year>2021</year></pub-date><volume>10</volume><issue>02</issue><fpage>185</fpage><lpage>194</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  密钥协商算法允许参与者在非安全信道中交换信息共同协商会话密钥用于保密通信，是密码学中最关键技术之一。本文基于RLWE困难问题，利用四舍五入密钥共识算法，Filtering引理及哈希函数，设计了一个新的基于RLWE困难问题的认证密钥协商算法。新的认证密钥协商算法具有高效与可证明安全的特点。
   Key agreement algorithm allows participants to exchange information in the open channel to gener-ate a secure temporary session key to ensure secret communication, which is one of the key tech-nologies in cryptography. In this paper, a novel authenticated key agreement algorithm based on RLWE difficulty problem is proposed using rounded key consensus algorithm, filtering lemma and hash function. The new authenticated key agreement algorithm is proved to be efficient and prova-bly secure.
 
</p></abstract><kwd-group><kwd>RLWE，数字签名，密钥协商, RLWE</kwd><kwd> Digital Signature</kwd><kwd> Key Agreement</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>密钥协商算法允许参与者在非安全信道中交换信息共同协商会话密钥用于保密通信，是密码学中最关键技术之一。本文基于RLWE困难问题，利用四舍五入密钥共识算法，Filtering引理及哈希函数，设计了一个新的基于RLWE困难问题的认证密钥协商算法。新的认证密钥协商算法具有高效与可证明安全的特点。</p></sec><sec id="s2"><title>关键词</title><p>RLWE，数字签名，密钥协商</p></sec><sec id="s3"><title>Design of Authenticated Key Agreement Algorithm Based on RLWE</title><p>Xiuju Huang, Zichen Li</p><p>School of Information Engineering, Beijing Institute of Graphic Communication, Beijing</p><p><img src="//html.hanspub.org/file/15-2690501x4_hanspub.png" /></p><p>Received: Feb. 18<sup>th</sup>, 2021; accepted: Apr. 22<sup>nd</sup>, 2021; published: Apr. 29<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/15-2690501x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>Key agreement algorithm allows participants to exchange information in the open channel to generate a secure temporary session key to ensure secret communication, which is one of the key technologies in cryptography. In this paper, a novel authenticated key agreement algorithm based on RLWE difficulty problem is proposed using rounded key consensus algorithm, filtering lemma and hash function. The new authenticated key agreement algorithm is proved to be efficient and provably secure.</p><p>Keywords:RLWE, Digital Signature, Key Agreement</p><disp-formula id="hanspub.42034-formula14"><graphic xlink:href="//html.hanspub.org/file/15-2690501x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/15-2690501x7_hanspub.png" /> <img src="//html.hanspub.org/file/15-2690501x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>格是一种建立在偏序集合上的代数结构，起源于1611年开普勒提出的关于容器内堆放等半径小球所达最大密度的猜想。后来格作为一种密码分析工具用于攻击破解密码体制 [<xref ref-type="bibr" rid="hanspub.42034-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.42034-ref2">2</xref>]。1996年，美国布朗大学的Jeffrey Hoffstein、Jill Pipher和Joseph H. Silverman三位数学教授发明了一种公钥密码体制NTRU [<xref ref-type="bibr" rid="hanspub.42034-ref3">3</xref>]。2009年，Gentry基于格密码构造了首个全同态密码方案 [<xref ref-type="bibr" rid="hanspub.42034-ref4">4</xref>]，格密码得到极大的发展。2015年美国国家标准研究和技术研究学院发布了“后量子密码报告” [<xref ref-type="bibr" rid="hanspub.42034-ref5">5</xref>]。报告表明，由于计算机运算速度的不断提高，现有的公钥密码在未来面临着极大的挑战。NIST在全球范围内征集后量子密码算法标准。具有抗量子计算的格密码公被认为最具竞争力的后量子算法。尤其近几年格密码得到快速发展，许多优秀的研究成果 [<xref ref-type="bibr" rid="hanspub.42034-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.42034-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.42034-ref8">8</xref>] 如雨后春笋一般出现。</p><p>近几年国内在后量子密码算法研究方面也取得了很大的进展。2018年6月，由国家密码管理局指导，中国密码学会同密码行业标准化技术委员会，商用密码检测中心共同组织实施，全国密码算法设计竞赛开始，历时一年半，于2019年12月分别遴选出公钥密码算法和分组密码算法一、二、三等奖 [<xref ref-type="bibr" rid="hanspub.42034-ref9">9</xref>]。</p><p>国内外格密码发展一片欣欣向荣，产生很多优秀的算法。 [<xref ref-type="bibr" rid="hanspub.42034-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.42034-ref11">11</xref>] 等论文直接使用格困难问题设计密钥封装方案，具有高效与可证明安全性的特点。J. W. Bos，L. Ducas，E. Kiltz，T. Lepoint等人提出了一种基于CCA安全加密的可认证密钥交换通用结构 [<xref ref-type="bibr" rid="hanspub.42034-ref12">12</xref>]，在此论文中提到了一种通用的数字签名方案，具有简单直接的特点，但签名过程较为繁琐效率低，且有私钥泄露的风险，不具备完全向前保密性。 [<xref ref-type="bibr" rid="hanspub.42034-ref13">13</xref>] [<xref ref-type="bibr" rid="hanspub.42034-ref14">14</xref>] 提出将密钥共识机制与RLWE困难问题相结合的方案，此类方案较为成熟，现在仍未发现有效的破解方案，丰富了密钥封装方案的思路。但是这些密钥协商方案没有认证的功能，也就是在密钥协商过程中没有对双方的身份和收到的消息进行认证。</p><p>本文基于RLWE困难问题，结合数字签名技术，设计了一种更加安全高效的具有认证功能的密钥协商算法。算法仅用一对密钥对进行加密处理，通过中止技术来解决私钥泄露问题。由于在签名方案中，不存在交互，因此签名者不需要将中止的签名包含到最终签名中。如果签名者需要中止，他只需重新运行协议，直到获得正确范围内的签名。这样可以提高签名效率，从而保证通信的安全性，高效性，真实性，不可抵赖性和完整性。</p></sec><sec id="s6"><title>2. 基础知识</title><sec id="s6_1"><title>2.1. 定义与符号</title><p>本文将用粗体小写字母表示矢量，大写字母表示矩阵。比如，a<sub>1</sub>，a<sub>2</sub>是Z<sup>n</sup>的两个元素， A = ( a 1 , a 2 ) 。默认情况下，所有向量都是列向量。对于一个向量a (或矩阵A)，我们用a<sup>T</sup> (或A<sup>T</sup>)表示它的转置。对于实数 x ∈ R ，我们使用 ⌊ x ⌋ 表示向下取整，即 ⌊ x ⌋ 表示不大于x的最大整数。定义x的四舍五入表示：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x13_hanspub.png" xlink:type="simple"/></inline-formula>，当x为向量、矩阵或者多项式运算时，上面所定义的四舍五入和向下取整均是对分量或系数进行的运算。</p><p>设 Z 是有理整数环，设 R = Z [ X ] / ( Φ m ( X ) ) 是第m个割圆数域的整数环， Φ m ∈ Z [ X ] 是m次割圆多项式。本文中采用 Φ m = x n + 1 ， n = 2 r ， r &gt; 0 ， m = 2 n 。本文规定q是素数且 q ≡ 1 ( mod 2 n ) ， R q = R / q R ≅ Z q [ X ] / ( X n + 1 ) ，其中 Z q = Z / q Z 。 y ← R q ，表示y的每个分量或系数均独立地服从分布 R q ，且y的系数属于集合 [ − ( q − 1 ) / 2 , ( q − 1 ) / 2 ] 。用符号 x ′ = x mod q ，q为正整数，表示 x ′ 的系数属于集合 [ 0 , q − 1 ] ， x ′ = x mod &#177; q ，q为正整数，表示 x ′ 的系数范围属于集合 [ − ⌊ ( q − 1 ) / 2 ⌋ , ⌊ ( q − 1 ) / 2 ⌋ ] 。a的无穷范数写做 ‖ a ‖ ∞ ，对于 A = ( a 1 , a 2 , ⋯ , a m ) , ‖ A ‖ ∞ = max i ‖ a ‖ ∞ 。最后本文采用与Kyber [<xref ref-type="bibr" rid="hanspub.42034-ref12">12</xref>] 原算法中同样的噪声分布B<sub>η</sub>，其定义如下：</p><p>( a 1 , ⋯ , a η , b 1 , ⋯ , b η ) ← ( 0 , 1 ) 2 η 输出 ∑ i = 1 η ( a i − b i ) (1)</p></sec><sec id="s6_2"><title>2.2. 格</title><p>定义：设 x 1 , x 2 , ⋯ , x m 是n维空间 R n 上线性无关的向量，m维格 L ( x 1 , x 2 , ⋯ , x m ) 是由向量 x 1 , x 2 , ⋯ , x m 生成的一个向量集，形式表示为</p><p>L ( x 1 , x 2 , ⋯ , x m ) = ∑ i = 1 m a i x i , a i ∈ Z (2)</p><p>其中， { x 1 , x 2 , ⋯ , x m } 是格L的一组基，记为 Dim ( L ) = m ，(m, n)分别为格L的维数和秩，当m = n时称为格L是满秩。同样的一个格可以采用不同的基底来表示，但是从m维格中选出m个线性无关的向量却不一定能成为这个格的一组基。一个格基通过左乘一个特定矩阵可以转化成另一个格基，这个特定的矩阵是由整数构成，且其行列式为&#177;1。因此格具有离散性和格基多样性。</p></sec><sec id="s6_3"><title>2.3. 基于格的困难性假设</title><p>2009年REGEV O首先提出了LWE (learning with errors)问题 [<xref ref-type="bibr" rid="hanspub.42034-ref15">15</xref>]，是对最坏情况格困难问题如GAPSVP和SIVP的一个简化，并证明LWE的安全性基于GAPSVP和SIVP最坏情况的困难问题，近年来它已经成为很多密码应用的基础。</p><p>LWE可看作随机线性码的译码问题，给出如下定义： x ∈ Z p n 是某个向量矩阵，存在矩阵 Q ∈ Z p m &#215; n ，使得 y = Q x + e ，e是一个服从 e ∈ Z p m 的干扰信号，LWE问题就是已知Q和y，求x。由于LWE在实际生产应用过程中效率较低，Lyubashevsky，C. Peikert和 O. Regev在LWE的基础上变形出了一种效率更高，安全性和复杂性规约为SVP问题的新问题R-LWE (Learning with Errors over Rings) 困难问题 [<xref ref-type="bibr" rid="hanspub.42034-ref16">16</xref>]。R-LWE问题和LWE问题的定义很相似，可以视为一个样本结构固定了的LWE问题。现R-LWE困难问题是基于格密码学一个活跃的研究领域，在这个困难问题上产生了很多优秀成果 [<xref ref-type="bibr" rid="hanspub.42034-ref17">17</xref>] [<xref ref-type="bibr" rid="hanspub.42034-ref18">18</xref>] [<xref ref-type="bibr" rid="hanspub.42034-ref19">19</xref>]。</p></sec><sec id="s6_4"><title>2.4. 基于格R-LWE的数字签名算法</title><p>数字签名是一种以电子形式给一个消息签名的过程，只有消息发送方可以对自己信息进行签名，任意知道公钥的验证者都可以对其进行验证。数字签名可以起到身份认证，保证信息完整性，不可否认性以及匿名性等作用，具有不可伪造性和不可抵赖性。</p><p>一个数字签名的形式化定义如下：</p><p>系统初始化过程：数字签名含有基本元素为(P, M, K, S, V)，其中P为消息集，M为签名集，K为密钥集合，S为签名算法集合，V为验证算法集合。</p><p>签名产生过程： k ∈ K 对于每一个消息 p ∈ P 和 m ∈ M ，存在 s i g k ∈ S ， s i g k : P → M 。将签名消息组(p, m)发送给消息验证者进行验证。</p><p>签名认证过程：对于每一个 k ∈ K 存在一个相应的验证算法 v e r k ∈ V ，对收到的签名消息组进行验证， v e r k : P &#215; M → { T , F } ，</p><p>v e r k ( p , m ) = { T , m = s i g k ( p ) F , m ≠ s i g k ( p ) (3)</p><p>若 v e r k ( p , m ) = T ，则签名验证通过，签名有效，否则签名无效。</p><p>本文要用的是基于格R-LWE的数字签名方案。构造格的数字签名算法大部分分为两种途经，一种是利用限门函数 [<xref ref-type="bibr" rid="hanspub.42034-ref20">20</xref>] 进行设计的，另一种是基于Fiat-Shamir方法进行转化，后者具有简单高效的特点，因此成为这个算法的首要选择方案。由于格的特殊代数结构，如果直接输出算法的签名，会泄露密钥，为解决这个问题VadimLyubashevsky提出“异常终止”的概念 [<xref ref-type="bibr" rid="hanspub.42034-ref21">21</xref>]。中止协议的目的是，验证方可以选择中止协议，以保护有关其密钥的一些信息。本文使用的是均匀分布拒绝抽样格签名，使用的技术为Filtering引理。</p><p>Filtering引理，即涉及均匀分布的拒绝抽样算法。只有签名者输出的签名当且仅当落在一个固定的区间之内，签名的输出分布就会服从该区间上的均匀分布，故不会泄露私钥的信息。</p><p>Filtering引理定义：设k是一个正整数， a ∈ { v ∈ Z k : ‖ v ‖ ∞ ≤ A } ，随机均匀地选取 b ← { v ∈ Z k : ‖ v ‖ ∞ ≤ B } ，其中B &gt; A。设随机变量c = a + b，那么c服从于集合 { v ∈ Z k : ‖ v ‖ ∞ ≤ B − A } 的均匀分布。</p><p>基于格R-LWE的数字签名算法的步骤如下：</p><p>签名者</p><p>密钥产生Gen:</p><p>( s , e ) ← S η L &#215; 1 &#215; S η L &#215; 1 ，且其系数服从某个窄的分布</p><p>a ← R q L &#215; L</p><p>t : = a s + e ∈ R q L &#215; 1</p><p>返回公钥 p k = ( a , t ) 和私钥 s k ( s , e ) 验证者</p><p>事实上，</p><p>a z 1 + z 2 − t c = a ( s c + y 1 ) + e c + y 2 − t c = a s c + a y 1 + e c + y 2 − t c = ( a s + e ) c + a y 1 + y 2 − t c = t c + a y 1 + y 2 − t c = a y 1 + y 2 = w</p><p>故， H ( w , μ ) = H ( a z 1 + z 2 − t c , μ )</p><p>本方案的安全性主要取决于它的可靠性和在哈希函数中发现冲突的难度，只要我们设置合适的参数，以目前的已知技术在哈希函数中寻找冲突是不可行的。</p></sec><sec id="s6_5"><title>2.5. 密钥协商机制</title><p>密钥协商机制是指两人或者多人，在不需要可信第三方的情况下，所有参与者在一个开放网络环境中，利用自己长期密钥对等信息，通过某种密钥协商协议，生成一个共享的临时会话密钥。密钥协商协议是一类极其重要的基础性安全协议。现存的比较高效成熟的密钥协商机制主要是利用 RSA公钥体制、传统椭圆曲线公钥体制ECC和Diffie-Hellman密钥协商体制来实现的。这些传统的算法大都基于大数分解问题，椭圆曲线等数学问题。随着量子的不断发展，计算速度的不断加快，这些算法抵制不了量子计算机时代的带来。基于后量子密码的密钥协商问题也成为热门话题。本文使用的是密钥共识与格困难问题相结合的方法，在这里我们先介绍一种带噪音的四舍五入密钥共识算法。</p><p>密钥共识算法KC如下定义：</p><p>KC = (parameters, com, che)，其中参数 parameters = ( q , r , b , e , a u p a ) ，q控制安全性和效率，r控制共识密钥的范围，b控制带宽，e控制错误率，aupa表示辅助参数，且满足 2 r e ≤ q ( 1 − 1 / b ) ， r ≥ 2 ， b ≤ q ， 0 ≤ e ≤ | q / 2 |</p><p>KC算法正确性证明：对于任意 σ 1 , σ 2 ∈ Z q ，且 | σ 1 − σ 2 | q ≤ e ，都有 k 1 = k 2 。</p><p>证明：假设 | σ 1 − σ 2 | q ≤ e ，存在 θ ∈ Z 并且 δ ∈ [ − e , e ] 使得 σ 2 = σ 1 + θ q + δ 。从算法KC的第5行到第7行可知，存在 θ ′ ∈ Z ，使得 α σ 1 + w + θ ′ q ′ = σ A = k 1 β + v ′ 。从α和β的定义中，我们有 α / β = r / q 。将这两个等式带入到Che (算法1的第15行)中k<sub>2</sub>的等式中可知</p><disp-formula id="hanspub.42034-formula15"><graphic xlink:href="//html.hanspub.org/file/15-2690501x116_hanspub.png"  xlink:type="simple"/></disp-formula><p>注意到 | v ′ / β − v ″ / b | = | v ′ b − β v ″ | / β b ≤ 1 / 2 b ，故</p><p>| ( v ′ / β − v ″ / b ) − w / β + α δ / β | ≤ 1 / ( 2 b ) + α / β ( e + 1 / 2 )</p><p>由假设的条件 2 r e ≤ q ( 1 − 1 / b ) ,我们可以得到右边的严格小于1/2，因此，在取整之后，有 k 1 = k 2 。<sub> </sub></p><p>KC算法安全性证明：当变量满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x121_hanspub.png" xlink:type="simple"/></inline-formula>，k<sub>1</sub>，v是相互独立且k<sub>1</sub>均匀分布，因此KC算法具有安全性。</p><p>证明：定义一个映射<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x122_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x123_hanspub.png" xlink:type="simple"/></inline-formula>显然f满足一一映射关系，有KC算法第7行可以知道<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x124_hanspub.png" xlink:type="simple"/></inline-formula>，因此<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x125_hanspub.png" xlink:type="simple"/></inline-formula>服从<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x126_hanspub.png" xlink:type="simple"/></inline-formula>中均匀分布。所以<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x127_hanspub.png" xlink:type="simple"/></inline-formula>服从<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x128_hanspub.png" xlink:type="simple"/></inline-formula>中均匀分布，且相互独立，而v只受<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x129_hanspub.png" xlink:type="simple"/></inline-formula>影响不受k<sub>1</sub>影响，可证明k<sub>1</sub>，v是相互独立且k<sub>1</sub>均匀分布。</p></sec></sec><sec id="s7"><title>3. 基于RLWE认证密钥协商算法</title><p>根据我们在预备知识中介绍的数字签名与密钥协商的知识，本文提出一个基于格的可认证密钥协商方案，方案介绍如下：</p><p>密钥生成：这里使用种子seed生成矩阵</p><p>(1) <inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x131_hanspub.png" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x130_hanspub.png" xlink:type="simple"/></inline-formula>R<sub>q</sub>的系数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x132_hanspub.png" xlink:type="simple"/></inline-formula></p><p>(2)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x133_hanspub.png" xlink:type="simple"/></inline-formula>随机生成私钥<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x134_hanspub.png" xlink:type="simple"/></inline-formula></p><p>(3)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x135_hanspub.png" xlink:type="simple"/></inline-formula>生成公钥<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x136_hanspub.png" xlink:type="simple"/></inline-formula></p><p>数字签名验证：</p><p>Initiator → Responder</p><p>(1)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x137_hanspub.png" xlink:type="simple"/></inline-formula>使用密钥对对Initiator公钥进行数字签名</p><p>(2)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x138_hanspub.png" xlink:type="simple"/></inline-formula>，对Y<sub>1</sub>进行验证</p><p>Responder → Initiator</p><p>(1)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x139_hanspub.png" xlink:type="simple"/></inline-formula>， 使用临时密钥对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x140_hanspub.png" xlink:type="simple"/></inline-formula>和V进行数字签名</p><disp-formula id="hanspub.42034-formula16"><label>(2)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2690501x141_hanspub.png"  xlink:type="simple"/></disp-formula><p>密钥协商：</p><p>(1)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x142_hanspub.png" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x143_hanspub.png" xlink:type="simple"/></inline-formula><sub> </sub></p><disp-formula id="hanspub.42034-formula17"><label>(2)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2690501x144_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.42034-formula18"><label>(3)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2690501x145_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.42034-formula19"><label>(4)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2690501x146_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.42034-formula20"><label>(5)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2690501x147_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.42034-formula21"><label>(6)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/15-2690501x148_hanspub.png"  xlink:type="simple"/></disp-formula><p>总流程图如下所示：</p><p>Initiator Responder</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x150_hanspub.png" xlink:type="simple"/></inline-formula>R<sub>q</sub>的系数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x151_hanspub.png" xlink:type="simple"/></inline-formula></p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x153_hanspub.png" xlink:type="simple"/></inline-formula>公钥<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x154_hanspub.png" xlink:type="simple"/></inline-formula>和私钥<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x155_hanspub.png" xlink:type="simple"/></inline-formula></p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x156_hanspub.png" xlink:type="simple"/></inline-formula>为对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x157_hanspub.png" xlink:type="simple"/></inline-formula>数字签名返回值</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x158_hanspub.png" xlink:type="simple"/></inline-formula>为返回的辅助验证信号，c为返回HASH值</p><p>通过验证算法继续，未通过算法中断，重新开始<sub> </sub></p></sec><sec id="s8"><title>4. 算法分析</title><sec id="s8_1"><title>4.1. 正确性分析</title><p>由第二章方案流程图可知：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x162_hanspub.png" xlink:type="simple"/></inline-formula><sub> </sub></p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x163_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>故<sub> </sub></p><p>因为我们<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x165_hanspub.png" xlink:type="simple"/></inline-formula>均随机取自均匀二项分布<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x166_hanspub.png" xlink:type="simple"/></inline-formula>，他们都是很小的取值，因此可以确定<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x167_hanspub.png" xlink:type="simple"/></inline-formula>，由1.5可知，当我们密钥共识的两个输入值距离<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x168_hanspub.png" xlink:type="simple"/></inline-formula>，时，就可以推出<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x169_hanspub.png" xlink:type="simple"/></inline-formula>。密钥共识算法的正确性与安全性已证，请看1.5。</p></sec><sec id="s8_2"><title>4.2. 安全性分析</title><p>1) CCA2可证明安全。我们在这里设计一个游戏G0</p><p>Game G0：</p><p>在此游戏中，任意一个敌手A都不能以绝对的优势可以分辩出<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x181_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x182_hanspub.png" xlink:type="simple"/></inline-formula>那个是算法产生的，那个是随机选取的，即绝对值<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/15-2690501x183_hanspub.png" xlink:type="simple"/></inline-formula>是可忽略的。</p><p>2) 已知密钥安全：对于参与多个协议的参与者，一次共享密钥的泄露不会影响其他共享密钥的安全进行，换句话说，攻击者A无法根据本次的共享密钥得出参与者的其他共享密钥，称为该方案满足已知密钥安全。</p><p>此方案共享密钥的生成不仅与参与者的公钥和私钥有关，且与含噪声的四舍五入KC协议有关，K<sub>1</sub>，K<sub>2</sub>是在一个范围内近似相同，所以攻击者即使知道共享密钥的值，也不能推测出关于密钥对的相关信息，即满足已知密钥安全。</p><p>3) 可抵抗中间人攻击：由于数字签名的存在，此算法可以抵抗中间人攻击。此数字签名具有安全性与不可复制性。有主动性敌手，在不知道私钥的情况下，没有办法攻击成功。由于数字签名特点，也使这个算法具有了密钥泄露伪装安全，即在一方长期泄露密钥的情况下，仍没有办法通过数字签名认证，从而实现共享密钥生成。</p><p>4) 密钥控制安全：由于本方案中密钥的建立是由所有参与者的密钥对信息共同参与生成，因此共享密钥的生成是具有随机性和不可预测性，任何一个参与者或者敌手都不能把共享密钥设定为某个确定的值，此方案符合密钥控制安全。</p></sec><sec id="s8_3"><title>4.3. 效率分析</title><p>本方案是在环格的基础上设计的一个带数字签名的密钥协商方案，相对于标准格，R-LWE相对于LWE 允许在相同通信量的情况下传输更大的消息。此方案中使用的基于RLWE的密钥协商协议与其他协议方案相比较，相应计算量和通信量明显减少，是一种简洁高效的后量子PAKE协议，这里 [<xref ref-type="bibr" rid="hanspub.42034-ref14">14</xref>] 对此密钥协商方案有详细效率分析。而我们在前面讲过，CCA 安全公钥加密的认证密钥交换通用构造在数字签名部分具有效率低的缺点，而我们改进使用基于R-LWE带异常终止的数字签名，相对于其他数字签名具有更好安全性与高效性。因此整个方案相对于使用CCA 安全公钥加密的认证密钥交换通用构造效率更高。</p></sec></sec><sec id="s9"><title>5. 总结</title><p>本文是在阅读大量相关文献后设计的一个在格R-LWE困难问题上可认证密钥协商方案。该方案使用了密钥协商与数字签名，具有安全性，高效性，真实性，不可抵赖性和完整性的特点，但仍存在着效率以及实用性的问题，下一步准备把这个方案与现实场景相结合，提高它的实际工作效率，实现这个方案的价值。</p></sec><sec id="s10"><title>基金项目</title><p>国家自然科学基金(61370188)；北京市教委科研计划一般项目(KM202010015009)；北京市教委科研计划资助(No. KM202110015004)；北京印刷学院博士启动金项目(27170120003/020)；BIGC Project (Ec202007)。</p></sec><sec id="s11"><title>文章引用</title><p>黄秀菊,李子臣. 基于RLWE认证密钥协商算法的设计 Design of Authenticated Key Agreement Algorithm Based on RLWE[J]. 软件工程与应用, 2021, 10(02): 185-194. https://doi.org/10.12677/SEA.2021.102022</p></sec><sec id="s12"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.42034-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Shamir, A. (1984) A Polynomial-Time Algorithm for Breaking the Basic Merkle-Hellman Cryptosystem. IEEE Transac-tions on Information Theory, 30, 699-704. &lt;br&gt;https://doi.org/10.1109/TIT.1984.1056964</mixed-citation></ref><ref id="hanspub.42034-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Coppersmith, D. (1996) Finding a Small Root of a Univariate Modular Equation. International Conference on the Theory and Applications of Cryptographic Techniques, Vol. 1070, 155-165. &lt;br&gt;https://doi.org/10.1007/3-540-68339-9_14</mixed-citation></ref><ref id="hanspub.42034-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Hoffstein, J., Pipher, J. and Silverman, J.H. (1998) NTRU: A Ring-Based Public Key Cryptosystem. International Algorithmic Number Theory Symposium, Vol. 1423, 267-288. &lt;br&gt;https://doi.org/10.1007/BFb0054868</mixed-citation></ref><ref id="hanspub.42034-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Gentry, C. (2009) Fully Homomorphic Encryption Using Ideal Lattices. Proceedings of the Forty-First Annual ACM Symposium on Theory of Computing, Bethesda, MD, May 2009, 169-178. &lt;br&gt;https://doi.org/10.1145/1536414.1536440</mixed-citation></ref><ref id="hanspub.42034-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Chen, L., Jordan, S., et al. (2016) Report on Post-Quantum Cryptography. US Department of Commerce, National Institute of Standards and Technology, Gaithersburg.</mixed-citation></ref><ref id="hanspub.42034-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Micciancio, D. and Regev, O. (2009) Lattice-Based Cryptography. In: Bernstein, D.J., Buchmann, J. and Dahmen, E., Eds., Post-Quantum Cryptography, Springer, Heidelberg, Berlin, New York, 147-191.  
&lt;br&gt;https://doi.org/10.1007/978-3-540-88702-7_5</mixed-citation></ref><ref id="hanspub.42034-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Wang, X.Y. and Liu, M.J. (2014) Survey of Lattice-Based Cryptography. Journal of Cryptologic Research, 1, 13-27.</mixed-citation></ref><ref id="hanspub.42034-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">李子臣, 谢婷, 张卷美, 等. 基于RLWE的后量子认证密钥交换协议[J]. 计算机研究与发展, 2019, 56(12): 2694-2701.</mixed-citation></ref><ref id="hanspub.42034-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">中国密码协会. 全国密码算法设计竞赛公钥参赛算法[EB/OL]. http://sfjs.cacrnet.org.cn/site/term/list_72_1.html</mixed-citation></ref><ref id="hanspub.42034-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">高昕炜. 基于RLWE的后量子密钥交换协议构造和应用[D]: [硕士/博士学位论文]. 北京: 北京交通大学, 2019.</mixed-citation></ref><ref id="hanspub.42034-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Zhang, J., Yu, Y., Fan, S., et al. (2020) Tweaking the Asymmetry of Asymmetric-Key Cryptography on Lattices: Kems and Signatures of Smaller Sizes. IACR International Conference on Public-Key Cryptography, Vol. 12111, 37-65.  
&lt;br&gt;https://doi.org/10.1007/978-3-030-45388-6_2</mixed-citation></ref><ref id="hanspub.42034-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Bos, J., Ducas, E., Kiltz, E., et al. (2018) CRYSTALS—Kyber: A CCA-Secure Module-Lattice-Based KEM. 2018 IEEE European Symposium on Security and Privacy (EuroS&amp;P), London, UK, 353-367.  
&lt;br&gt;https://doi.org/10.1109/EuroSP.2018.00032</mixed-citation></ref><ref id="hanspub.42034-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Ding, J., Gao, X., Takagi, T. and Wang, Y. (2019) One Sample Ring-LWE with Rounding and Its Application to Key Exchange. International Conference on Applied Cryptography and Network Security, Colombia, 5-7 June 2019, 323-343.  
&lt;br&gt;https://doi.org/10.1007/978-3-030-21568-2_16</mixed-citation></ref><ref id="hanspub.42034-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Jin, Z. and Zhao, Y. (2019) Generic and Practical Key Estab-lishment from Lattice. International Conference on Applied Cryptography and Network Security, Colombia, 5-7 June 2019, 302-322.  
&lt;br&gt;https://doi.org/10.1007/978-3-030-21568-2_15</mixed-citation></ref><ref id="hanspub.42034-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Regev, O. (2009) On Lattices, Learning with Errors, Random Linear Codes, and Cryptography. Journal of the ACM, 56, Article No. 34. &lt;br&gt;https://doi.org/10.1145/1568318.1568324</mixed-citation></ref><ref id="hanspub.42034-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Lyubashevsky, V., Peikert, C. and Regev, O. (2013) On Ideal Lat-tices and Learning with Errors over Rings. Journal of the ACM, 60, Article No. 43. &lt;br&gt;https://doi.org/10.1145/2535925</mixed-citation></ref><ref id="hanspub.42034-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Bos, J.W., Lauter, K., Loftus, J. and Naehrig, M. (2013) Improved Security for a Ring-Based Fully Homomorphic Encryption Scheme. IMA International Conference on Cryptography and Coding, Vol. 8308, 45-64.  
&lt;br&gt;https://doi.org/10.1007/978-3-642-45239-0_4</mixed-citation></ref><ref id="hanspub.42034-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Brakerski, Z., Gentry, C. and Vaikuntanathan, V. (2012) (Leveled) Fully Homomorphic Encryption without Bootstrapping. Proceedings of the 3rd Innovations in Theoretical Computer Science Conference, Cambridge, MA, January 2012, 309-325. &lt;br&gt;https://doi.org/10.1145/2090236.2090262</mixed-citation></ref><ref id="hanspub.42034-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Castryck, W., Iliashenko, I. and Vercauteren, F. (2016) On Error Distributions in Ring-Based LWE. LMS Journal of Computation and Mathematics, 19, 130-145. &lt;br&gt;https://doi.org/10.1112/S1461157016000280</mixed-citation></ref><ref id="hanspub.42034-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Feng, C. and Zhao, Y. (2017) Ideal Lattice Based Justifiable Secure Digital Signature Scheme. Computer Engineering, 43, 103-107.</mixed-citation></ref><ref id="hanspub.42034-ref21"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Lyubashevsky, V. (2009) Fiat-Shamir with Aborts: Applications to Lattice and Factoring-Based Signatures. International Conference on the Theory and Application of Cryptology and Information Security Springer, Vol. 5912, 598-616.  
&lt;br&gt;https://doi.org/10.1007/978-3-642-10366-7_35</mixed-citation></ref></ref-list></back></article>