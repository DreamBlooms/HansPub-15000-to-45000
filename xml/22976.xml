<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SEA</journal-id><journal-title-group><journal-title>Software Engineering and Applications</journal-title></journal-title-group><issn pub-type="epub">2325-2286</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SEA.2017.66022</article-id><article-id pub-id-type="publisher-id">SEA-22976</article-id><article-categories><subj-group subj-group-type="heading"><subject>SEA20170600000_35746685.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于物联网技术的室内空气控制系统设计
  Design of Indoor Air Control System Based on Internet of Things Technology
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>范</surname><given-names>丽亚</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>马</surname><given-names>介渊</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>联宁</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>许</surname><given-names>大玮</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>西安交通大学城市学院，陕西 西安</addr-line></aff><aff id="aff3"><addr-line>西安联创生物医药孵化器有限公司，陕西 西安</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>majieyuan@163.com(马介)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>05</day><month>12</month><year>2017</year></pub-date><volume>06</volume><issue>06</issue><fpage>193</fpage><lpage>198</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   针对空气污染现状和人们对健康室内环境的需求，研究并设计了一种基于物联网的室内空气控制系统。系统以STM32微控制器为硬件核心，采用多种传感器组成的传感器单元，对8种室内主要污染气体进行实时监测。通过移动终端发送控制指令从而控制空气净化器、空调和加湿器的工作状态。系统不仅可以远程监控空气质量，还可以远程控制和调节空气质量。 According to the air pollution status and people’s demand for healthy indoor environment, an indoor air control system based on Internet of Things is studied and designed. The system with STM32 microcontroller as the hardware core could monitor 8 main indoor pollution gases in real time by the sensor unit composed of a variety of sensors. And it could not only monitor air quality remotely, but also control and regulate air quality remotely, by the method of sending control commands through mobile terminals so as to control the air purifier, air conditioner and humidifier working state.
    
  
 
</p></abstract><kwd-group><kwd>物联网，室内空气，空气质量，远程控制, Internet of Things</kwd><kwd> Indoor Air</kwd><kwd> Air Quality</kwd><kwd> Remote Control</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于物联网技术的室内空气控制系统设计<sup> </sup></title><p>范丽亚<sup>1</sup>，马介渊<sup>2*</sup>，李联宁<sup>1</sup>，许大玮<sup>1</sup></p><p><sup>1</sup>西安交通大学城市学院，陕西 西安</p><p><sup>2</sup>西安联创生物医药孵化器有限公司，陕西 西安</p><disp-formula id="hanspub.22976-formula35"><graphic xlink:href="//html.hanspub.org/file/6-2690284x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2017年11月20日；录用日期：2017年12月4日；发布日期：2017年12月11日</p><disp-formula id="hanspub.22976-formula36"><graphic xlink:href="//html.hanspub.org/file/6-2690284x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对空气污染现状和人们对健康室内环境的需求，研究并设计了一种基于物联网的室内空气控制系统。系统以STM32微控制器为硬件核心，采用多种传感器组成的传感器单元，对8种室内主要污染气体进行实时监测。通过移动终端发送控制指令从而控制空气净化器、空调和加湿器的工作状态。系统不仅可以远程监控空气质量，还可以远程控制和调节空气质量。</p><p>关键词 :物联网，室内空气，空气质量，远程控制</p><disp-formula id="hanspub.22976-formula37"><graphic xlink:href="//html.hanspub.org/file/6-2690284x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/6-2690284x8_hanspub.png" /> <img src="//html.hanspub.org/file/6-2690284x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着环境污染问题日益严重，雾霾一词逐渐进入人们视野，空气污染问题越来越引起人们关注 [<xref ref-type="bibr" rid="hanspub.22976-ref1">1</xref>] 。通过室内空气净化器可以大大降低空气污染对人们的危害，因此空气净化器被越来越多人的接受，迅速成为一种新兴的家用电器 [<xref ref-type="bibr" rid="hanspub.22976-ref2">2</xref>] 。</p><p>随着物联网技术的兴起，仅通过空气净化器对室内空气质量做出评估已经无法满足人们的需求。人们不仅要求使用物联网技术可以对家用电器进行远程监测，随时随地掌握室内空气质量，还可以直接远程操纵空气净化器等家电的工作状态。</p><p>李伟等提出了一种基于物联网技术的室内环境智能控制系统，实现了对室内空气中湿度、甲醛、照度、一氧化碳数据进行采集与监测，从而调节家电工作状态的问题 [<xref ref-type="bibr" rid="hanspub.22976-ref2">2</xref>] 。但该设计需手工使用红外遥控器和基于Andriod系统的平板电脑两种末端控制装置，来分别控制不同家电的工作状态。</p><p>本文利用物联网技术对空气净化系统的功能进行了改进，用户不仅能使用移动终端远程监控空气质量，还可以通过移动终端发送控制指令，进而通过空气净化器、空调和加湿器调节空气质量，实现远程控制和调节空气质量。</p></sec><sec id="s4"><title>2. 系统结构设计</title><p>本文设计的基于物联网技术的空气质量控制系统主要由多个传感器单元、物联网网关、物联网服务器、移动终端四个部分组成。由多种传感器组成的传感器单元对室内空气质量进行数据实时采集；使用物联网网关连接传感器单元和物联网服务器；通过具有GPRS网络通信功能的手机移动终端来远程监测与控制空气净化器、空调、加湿器等家电的工作，实现室内空气的有效快速净化。各个部分之间的信息交互通过WiFi实现，系统结构框图如图1所示。</p><p>主要工作原理如下：</p><p>1) 传感器单元内的传感器本体将检测到的空气质量信息发送至微处理器，微处理器接收空气质量信息后，将空气质量信息进行处理，然后通过传感器单元内的第一WIFI模块无线发送至物联网网关。</p><p>2) 物联网网关通过内置的第二WIFI模块，将接收的空气质量信息发送到网络通信协议模块进行处理，处理后的空气质量信息发送至物联网服务器。</p><p>3) 物联网服务器内置的第三WIFI模块接收物联网网关发送的空气质量信息，对空气质量信息进行分析处理。分析处理后的结果一份通过以太网接口进行网络云端备份，一份通过GPRS模块发送至移动终端。</p><p>图1. 系统结构图</p><p>4) 移动终端接收到空气质量信息后，用户通过终端APP查看分析结果。通过输入相对应的操作和控制指令，通过GPRS模块和第三WIFI模块将指令发送给物联网网关。物联网网关将操作指令通过网络通信协议模块进行处理后，通过第二WIFI模块分别发送给相应的空气净化装置。空气净化器、空调和加湿器等空气净化装置都配备相应的WIFI模块，可以无线接受操作指令，并将空气净化器、空调和加湿器的工作状态数据发送给物联网网关。物联网网关和物联网服务器分别通过内置的WIFI模块，将空气质量信息发送给移动终端，从而达到远程监控和调节空气质量的目的。</p></sec><sec id="s5"><title>3. 系统功能设计</title><sec id="s5_1"><title>3.1. 数据采集功能</title><p>系统的数据采集功能由多个传感器单元来完成。传感器单元包括：传感器本体、微处理器和第一WiFi模块组成。传感器本体由设置在室内墙壁表面的传感器单元组成，可包括CO传感器、NH<sub>3</sub>传感器、CO<sub>2</sub>传感器、温度传感器和湿度传感器等。后期测试中，选择了12种常见的气体传感器，根据相应的技术参数，通过比较其优缺点，最终选择了如表1所示的8种传感器。包含8种传感器的传感器单元，能够从室内不同空间方位对8种室内主要污染气体进行实时监测，包括PM2.5、PM10、CO、CO<sub>2</sub>、HCHO、TVOC、NH<sub>3</sub>和O<sub>3</sub>。</p><p>传感器单元中的微处理器采用的STM32“增强型”系列的STM32F103R8T6型主流单片机，可采集模拟、PWM和串口数字3种信号，并能输出PWM脉宽调制信号。单片机采用ARM-Cortcx-M3内核微控制器，工作电压3.3 V，包含16个12 bit的A/D数据转换器用于采集模拟量；3个通用16位定时器和一个高级定时器用于捕获PWM输入信号和输出PWM脉宽调制信号；3个USART接口用于串口通信；51个通用I/O口，用于设置外部中断输入端口。</p><p>不同气敏元件的气体传感器接触污染的空气后产生相应不同的信号。数据采集处理时，单片机通过A/D数据转换器、定时器和串口模块将接收的模拟量和数字量转化为相应的电压值，根据传感器厂商提供的输出电压与气体浓度的对应关系解算出相应气体浓度值。然后依据空气质量综合指数法，计算出综合污染指数。从综合污染指数得出室内空气中污染物浓度超标倍数和主要的污染气体等。进而将室内空气质量按照综合污染指数范围划分为五个不同等级，如表2所示。空气污染指数划分为0~0.49、0.50~0.99、1.00~1.49、1.50~1.99和大于2.0五个等级，对应于空气质量的五个级别，指数越大，级别越高，说明污染越严重，对人体健康的影响也越明显。</p><p>目前，常用的室内空气质量评价方法有：灰色理论法、动态模式法、模糊数学法等。灰色理论法没有将人体对室内空气质量的主观感受相联系，不够全面。动态模式法只能用来确定单个污染物的质量浓度。模糊数学法需要建立各因素对每一级别的隶属函数，过程较繁，且运算过程由于强调权值的作用，而忽视了各种污染因子的综合效应 [<xref ref-type="bibr" rid="hanspub.22976-ref3">3</xref>] 。本文以综合指数评价法对室内空气污染的实例进行了分析，表明</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Sensor technical parameter</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >PM2.5</th><th align="center" valign="middle" >PM10</th><th align="center" valign="middle" >CO</th><th align="center" valign="middle" >CO<sub>2</sub></th><th align="center" valign="middle" >HCHO</th><th align="center" valign="middle" >TVOC</th><th align="center" valign="middle" >NH<sub>3</sub></th><th align="center" valign="middle" >O<sub>3</sub></th></tr></thead><tr><td align="center" valign="middle" >传感器型号</td><td align="center" valign="middle" >GP2Y1051AU0F</td><td align="center" valign="middle" >DSM501</td><td align="center" valign="middle" >MQ7</td><td align="center" valign="middle" >MH-Z19</td><td align="center" valign="middle" >DS-HCHO</td><td align="center" valign="middle" >MS1100</td><td align="center" valign="middle" >MQ135</td><td align="center" valign="middle" >MS2610</td></tr><tr><td align="center" valign="middle" >输出数据类型</td><td align="center" valign="middle" >串口数字</td><td align="center" valign="middle" >PWM</td><td align="center" valign="middle" >模拟量</td><td align="center" valign="middle" >PWM</td><td align="center" valign="middle" >串口数字</td><td align="center" valign="middle" >模拟量</td><td align="center" valign="middle" >模拟量</td><td align="center" valign="middle" >模拟量</td></tr><tr><td align="center" valign="middle" >监测能力</td><td align="center" valign="middle" >0.03</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >10~1000</td><td align="center" valign="middle" >0~5000</td><td align="center" valign="middle" >0~10</td><td align="center" valign="middle" >0~1000</td><td align="center" valign="middle" >10~1000</td><td align="center" valign="middle" >0.01~1</td></tr></tbody></table></table-wrap><p>表1. 传感器技术参数</p><p>注：检测能力一栏，除PM2.5和PM10气体传感器使用最小粒子检测直径单位：μm，其余传感器采用气体浓度检测范围单位：ppm。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Relation table of comprehensive pollution index and air quality grad</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >指数</th><th align="center" valign="middle" >等级</th><th align="center" valign="middle" >评价</th><th align="center" valign="middle" >对人体健康的影响</th></tr></thead><tr><td align="center" valign="middle" >0~0.49</td><td align="center" valign="middle" >I</td><td align="center" valign="middle" >优</td><td align="center" valign="middle" >适宜生活</td></tr><tr><td align="center" valign="middle" >0.50~0.99</td><td align="center" valign="middle" >II</td><td align="center" valign="middle" >良</td><td align="center" valign="middle" >污染物不超标，可正常生活</td></tr><tr><td align="center" valign="middle" >1.00~1.49</td><td align="center" valign="middle" >III</td><td align="center" valign="middle" >轻度污染</td><td align="center" valign="middle" >至少一个污染物超标，除敏感体质，一般不会慢性中毒</td></tr><tr><td align="center" valign="middle" >1.50~1.99</td><td align="center" valign="middle" >IV</td><td align="center" valign="middle" >中度污染</td><td align="center" valign="middle" >一般有2~3个污染物超标，人体健康明显受害，敏感者受害严重</td></tr><tr><td align="center" valign="middle" >2.0以上</td><td align="center" valign="middle" >V</td><td align="center" valign="middle" >重度污染</td><td align="center" valign="middle" >一般有3~4个污染物超标，人体健康受害严重，敏感者可能死亡</td></tr></tbody></table></table-wrap><p>表2. 综合污染指数与空气质量等级关系表</p><p>该方法是可行有效的，能全面综合反应室内空气质量的优劣和各种污染物在污染程度上的差异，还能确定室内空气中的主要污染物，是较为理想的评价法 [<xref ref-type="bibr" rid="hanspub.22976-ref4">4</xref>] 。</p></sec><sec id="s5_2"><title>3.2. 数据处理功能</title><p>传感器单元将检测到的空气质量信息发送至微处理器，微处理器接收空气质量信息后，对空气质量信息进行处理。处理后的空气质量信息通过传感器单元内的第一WiFi模块无线发送至物联网网关。</p><p>物联网网关设置有可无线接收空气质量信息WIFI模块。物联网网关接受到空气质量信息后，按照相对应的网络通信协议进行处理，并经处理后的信息发送至物联网服务器。</p><p>物联网服务器包括以太网接口和GPRS模块。物联网服务器接收并对空气质量信息，并对空气质量信息进行分析，得到空气质量等级值和主要污染气体信息的分析结果。物联网服务器可以将分析结果通过太网接口上传至网络云端进行备份，还可通过GPRS模块发送至移动终端，供用户查询。</p></sec><sec id="s5_3"><title>3.3. 人机交互功能</title><p>人机交互功能由具有GPRS网络通信功能的手机移动终端APP来完成的。移动终端接收并显示室内空气质量信息的分析结果，包括：空气污染指数、空气品质、温湿度、净化器等的工作模式、定时时间、风机转速、滤网寿命以及紫外灯和负氧离子发生器的工作状态等信息。用户可以通过APP发出操作和控制指令。物联网服务器通过WIFI无线网络通信模块连接的物联网网关将操作和控制指令发送给空气净化器、空调和加湿器。空气净化器、空调和加湿器均设置有用于接收控制信息的WIFI模块，接收到操作指令后调节工作状态，从而实现远程控制和调节空气质量的目的。</p></sec></sec><sec id="s6"><title>4. 软件设计</title><p>移动终端APP登录后首先进行初始化，即移动终端发出初始化信号，物联网服务器根据指令将存储在网络云端的室内空气质量数据通过WIFI模块和GPRS模块发送到手机端，从而在APP上显示室内空气质量状态。根据用户需要确定是否调节净化器、空调或加湿器。用户确认不需要调节净化器、空调或加湿器时，继续确认是否需要中断它们的运行；如果不要中断，则移动终端继续监控并显示室内空气质量状态；需要中断时，分别发送操控指令至净化器、空调或加湿器，并存储状态信息。用户需要调节净化器、空调或加湿器时，分别发送控制指令集到净化器、空调或加湿器；系统实时进行空气质量数据的采集和信息存储。主程序流程如图2所示。</p></sec><sec id="s7"><title>5. 实验测试</title><p>在室温16℃和湿度46%环境下，启动了系统。移动端显示当前空气综合污染指数为0.72，空气质量评价为良，电机转速较低，主要污染气体为CO<sub>2</sub>。为了检验系统的稳定性和效果，每隔30 s对室内综合污染指数值进行读取和记录，直到空气质量达到优且该值的波动达到平稳。在室内点燃两根香烟，制造了高浓度PM2.5、CO和CO<sub>2</sub>的环境。将香烟分别置于净化器进风口左右约20 cm处的地面上，1 min后将香烟迅速移出室外。为了直观展示室内综合污染指数值的变化，通过MATLAB软件对实验数据进行了处理。如图3所示，室内综合污染指数一开始在0.7左右，后迅速上升，然后迅速下降，之后虽有小</p><p>图2. 主程序流程图</p><p>图3. 综合污染指数变化图</p><p>范围的起伏，但整体指数呈现下降趋势，于22 min左右降到了1.0以下，47 min左右降到了0.5以下，之后稳定在0.5左右。可从移动端以看出，电机转率较快。分析曲线起伏原因：在香烟点燃的一分钟内，烟气浓度较高、污染严重且靠近净化器进风口，综合污染指数大幅上升。香烟被移出室外后，出现迅速下降和小范围波动现象，一方面是因为净化器的快速净化作用，另一方面是因为污染空气的扩散效应。47 min之后，综合污染指数值稳定在0.5附近，空气质量达到优，电机转速降至1级，净化速率减慢。</p></sec><sec id="s8"><title>6. 总结</title><p>本文设计了一种基于物联网技术的室内空气控制系统，介绍了系统的结构设计、主要功能模块的硬件选型和软件设计。该系统通过多个传感器单元直接通过WIFI模块与物联网网关无线通信连接，并且通过移动终端发送控制指令从而通过空气净化器、空调和加湿器调节空气质量。系统不仅可以远程监控空气质量，还可以远程控制和调节空气质量。</p></sec><sec id="s9"><title>文章引用</title><p>范丽亚,马介渊,李联宁,许大玮. 基于物联网技术的室内空气控制系统设计Design of Indoor Air Control System Based on Internet of Things Technology[J]. 软件工程与应用, 2017, 06(06): 193-198. http://dx.doi.org/10.12677/SEA.2017.66022</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.22976-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">蔡文郁, 徐建军, 王洪亮. 基于物联网的家居空气质量净化系统[J]. 杭州电子科技大学学报(自然科学版), 2016, 36(4): 5-9.</mixed-citation></ref><ref id="hanspub.22976-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">李伟, 杨伟进, 孙二杰, 石震. 基于物联网技术的室内环境智能控制系统设计[J]. 信息技术与信息化, 2015(2): 176-179.</mixed-citation></ref><ref id="hanspub.22976-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">舒爱霞, 李孜军, 邓艳星, 郭宁. 综合指数评价法在室内空气品质评价中的应用[J]. 化工装备技术, 2010(2): 60-62.</mixed-citation></ref><ref id="hanspub.22976-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">张鹏, 冯显英, 霍睿. 基于STM32的多功能空气净化器控制系统开发[J]. 电子技术应用, 2017, 43(3): 80-83.</mixed-citation></ref></ref-list></back></article>