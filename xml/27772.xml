<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SG</journal-id><journal-title-group><journal-title>Smart Grid</journal-title></journal-title-group><issn pub-type="epub">2161-8763</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SG.2018.86057</article-id><article-id pub-id-type="publisher-id">SG-27772</article-id><article-categories><subj-group subj-group-type="heading"><subject>SG20180600000_80520331.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  配电网通信协议智能测试技术研究
  Communication Protocol of Intelligent Test System in Distribution Network
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>小军</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>嘉健</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>庞</surname><given-names>嘉琦</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>灿军</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>广东电网有限责任公司电力科学研究院，广东 广州</addr-line></aff><aff id="aff3"><addr-line>中山供电局东区供电分局，广东 中山</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>30</day><month>10</month><year>2018</year></pub-date><volume>08</volume><issue>06</issue><fpage>525</fpage><lpage>531</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    文章分析了配网通信的特点，结合地区供电局的应用经验，研究了101、104协议应用于配网自动化时需要规范的内容。文章结合配网自动化通信检测需要，提出了101、104协议一致性测试的要求，同时分析了现有的通信协议测试系统的缺陷，并介绍了通信协议智能测试系统的开发要点。
    This paper analyzes the characteristics of distribution network communication and the application experience of regional power supply bureau. The contents of 101 and 104 protocols applied to distribution automation are studied. In this paper, the requirements of 101 and 104 protocol conformance testing are put forward according to the needs of distribution network automation communication testing. The defects of existing communication protocol testing system are analyzed, and the key points of developing communication protocol intelligent testing system are introduced. 
  
 
</p></abstract><kwd-group><kwd>配电网通信，通信协议，101规约，104规约，一致性测试，错误定位, Distribution Network Communication</kwd><kwd> Communication Protocol</kwd><kwd> 101 Statute</kwd><kwd> 104 Statute</kwd><kwd> 
Conformance Testing</kwd><kwd> Error Location</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>配电网通信协议智能测试技术研究<sup> </sup></title><p>陈小军<sup>1</sup>，黄嘉健<sup>1</sup>，庞嘉琦<sup>2</sup>，张灿军<sup>2</sup></p><p><sup>1</sup>广东电网有限责任公司电力科学研究院，广东 广州</p><p><sup>2</sup>中山供电局东区供电分局，广东 中山</p><p><img src="//html.hanspub.org/file/6-1580554x1_hanspub.png" /></p><p>收稿日期：2018年11月6日；录用日期：2018年11月21日；发布日期：2018年11月28日</p><disp-formula id="hanspub.27772-formula62"><graphic xlink:href="//html.hanspub.org/file/6-1580554x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>文章分析了配网通信的特点，结合地区供电局的应用经验，研究了101、104协议应用于配网自动化时需要规范的内容。文章结合配网自动化通信检测需要，提出了101、104协议一致性测试的要求，同时分析了现有的通信协议测试系统的缺陷，并介绍了通信协议智能测试系统的开发要点。</p><p>关键词 :配电网通信，通信协议，101规约，104规约，一致性测试，错误定位</p><disp-formula id="hanspub.27772-formula63"><graphic xlink:href="//html.hanspub.org/file/6-1580554x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/6-1580554x7_hanspub.png" /> <img src="//html.hanspub.org/file/6-1580554x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>配电网自动化系统是指利用计算机、通信、电力电子技术对配电网现场运行的设备进行远程监测和控制的自动化系统。配网自动化需对分布在配网线路各处的设备进行监控，被监控对象数量繁多，且地理位置分散、分布广泛，依赖于有效可靠的通信手段及协议。</p><p>目前国内城市建设配网自动化工程，使用的协议大多是IEC 60870-5-101和IEC 60870-5-104协议，其中载波通信采用101非平衡式协议，公网无线GPRS通信采用104和平衡式101协议。国内文献研究针对配电网的特点，详细研究了配网自动化通信单节点通信数据量低、通信通道数量相对较大等特点 [<xref ref-type="bibr" rid="hanspub.27772-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.27772-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.27772-ref3">3</xref>] 。但在实际配网应用中，由于101、104协议提供给用户的可选项较多，可配置的参数太多，对于电力系统应用人员来说，反而不易把握参数的选配以及应用功能的选择。同时也会导致不同的应用人员根据自己的理解选取其中的应用功能选项和参数，实际上造成了各个不同的调度中心就有不同版本的101/104协议，各自动化设备厂家需针对每个调度中心开发相应版本的101/104协议通信程序 [<xref ref-type="bibr" rid="hanspub.27772-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.27772-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.27772-ref6">6</xref>] 。因此，为解决规约一致性问题，需对规约的互操作性进行深入研究，开发出一套适用于配网通信协议的测试软件，对配网设备的通信协议程序进行一致性测试，有效支持配网自动化系统应用。</p></sec><sec id="s4"><title>2. 101、104通信协议架构</title><p>因104规约是101规约为基础的基于TCP/IP协议的网络通信规约，该规约作为采用标准传输协议子集的101规约的网络访问，其应用层ASDU与101规约基本一致 [<xref ref-type="bibr" rid="hanspub.27772-ref7">7</xref>] 。104协议架构是建立ISO-OSI开放式系统互联模型的基础上的，由图1中可知，104协议是101协议和TCP/IP的网络传输功能的集合，让IEC 60870-5-101可以在X.25、ATM、ISDN、帧中继等多种网络场景中应用。</p><p>图1. 101、104协议架构</p><p>101、104规约中除了对链路地址、公共地址、对象体地址、传送原因等字段长度进行了规定以外，考虑到配网无线通信是租赁模式，必须兼顾通信资费和通信效率的双重要求，均对无线通信中使用到的101平衡式协议内容进行了细化，主要针对可能造成无线传输流量增加的内容进一步规定。如组号分配问题，第1组~第8组为遥信；第9组~第12组为遥测。此外，还需要形成一套完整的通信策略，来规定通信双方由于链路问题的各种等待重发时间和重发次数。表1为广东电网公司推荐采用的重发参数配置，可保证厂站端的信息能被调度共享，减少维护工作量，提高工作效率，须将其进行扩展，以适应调度、运行维护的需要。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> 101 and 104 protocol retransmission parameter list of Guangdong power grid (unit: seconds</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >重发参数</th><th align="center" valign="middle" >预设值</th><th align="center" valign="middle" >推荐范围</th><th align="center" valign="middle" >重发参数</th><th align="center" valign="middle" >预设值</th><th align="center" valign="middle" >推荐范围</th></tr></thead><tr><td align="center" valign="middle" >X1</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" >5~255</td><td align="center" valign="middle" >X10</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" >5~255</td></tr><tr><td align="center" valign="middle" >X2</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >3~10</td><td align="center" valign="middle" >X11</td><td align="center" valign="middle" >11</td><td align="center" valign="middle" >3~10</td></tr><tr><td align="center" valign="middle" >X3</td><td align="center" valign="middle" >60</td><td align="center" valign="middle" >10~600</td><td align="center" valign="middle" >X12</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0~255</td></tr><tr><td align="center" valign="middle" >X4</td><td align="center" valign="middle" >60</td><td align="center" valign="middle" >10~600</td><td align="center" valign="middle" >X13</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >1~15</td></tr><tr><td align="center" valign="middle" >X5</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >3~10</td><td align="center" valign="middle" >X14</td><td align="center" valign="middle" >10%</td><td align="center" valign="middle" >1%~100%</td></tr><tr><td align="center" valign="middle" >X6</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" >5~255</td><td align="center" valign="middle" >X15</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" >5~255</td></tr><tr><td align="center" valign="middle" >X7</td><td align="center" valign="middle" >15</td><td align="center" valign="middle" >5~255</td><td align="center" valign="middle" >X16</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >3~15</td></tr><tr><td align="center" valign="middle" >X8</td><td align="center" valign="middle" >10</td><td align="center" valign="middle" >5~255</td><td align="center" valign="middle" >X17</td><td align="center" valign="middle" >60</td><td align="center" valign="middle" >10~255</td></tr><tr><td align="center" valign="middle" >X9</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >3~10</td><td align="center" valign="middle" >X18</td><td align="center" valign="middle" >65</td><td align="center" valign="middle" >10~255</td></tr></tbody></table></table-wrap><p>表1. 广东电网101、104规约通信策略重发参数表(单位：秒)</p><p>协议实施细则还应该规定针对无线通信终端的远程维护功能，以解决无线通信终端远程故障恢复和参数更改的问题。另外，由于终端厂家众多，也需要规定监控终端的简单的远程维护功能，使得终端可以脱离厂家的维护软件而进行参数维护功能。</p></sec><sec id="s5"><title>3. 101、104协议的一致性测试方法</title><p>目前行业内存在若干版本的101、104及其他通信规约的测试软件，在这些软件中，至少有两方面的不足 [<xref ref-type="bibr" rid="hanspub.27772-ref8">8</xref>] 。一是在测试功能上，现有的测试软件不能满足对测试参数的灵活修改，同时只能对正常的通信流程和应用服务数据单元结构进行解释和测试，缺乏对故障通信情况下规约的健康性测试。二是测试方式上，欠缺对错误报文的准确定位及错误原因分析。所以在实际的测试过程中，不能给测试人员提供辅助性的错误提示。</p><p>为了更好地协助测试人员进行通信协议一致性测试，测试系统需要具备以下特性：</p><p>1) 灵活的协议参数配置和测试项配置；</p><p>2) 错误报文跟踪分析；</p><p>3) 自动和手动相结合的测试分析手段。</p><p>本文通过在对广东电网设备入网检测中积累了丰富的测试经验，开发出一套针对配网101、104通信协议的测试系统，并在实际应用中进行了评估。</p><p>101、104协议的一致性测试是指借助通信协议测试系统，根据正式颁布的配网通信协议实施细则，对主站和终端之间的报文交互过程进行分析和判定，寻找出主站和终端使用的通信协议与协议实施细则不一致之处，并进行评分。对主站协议的测试，是通过模拟终端测试软件进行；对终端协议的测试，是通过模拟主站测试软件进行。测试过程一般分为两阶段，一是对正常通信过程的测试，二是对错误通信过程的测试。</p><p>正常通信过程的测试，主要是测试在正常通信过程下，链路建立过程、初始化过程、总召唤过程、三遥过程、对时过程等过程中的报文字段的正确性，是通信协议实施细则的基本要求；错误通信过程的测试，是通过测试系统模拟发出错误的报文，以测试主站或终端是否能够严格按实施细则的规定进行处理，这是通信协议实施细则的高级要求，但也是必不可少的部分。</p></sec><sec id="s6"><title>4. 通信协议测试系统的开发</title><p>配网自动化通信规约测试系统以面向对象为开发思想，采用模块化的结构设计，将功能分解为模块，模块功能的实现采用基于组件化的方式。可方便配置每种规约的协议参数，并很容易进行新规约的扩展。软件分解为主程序(exe)、规约模块(dll)、配置文件(xml)、测试结果文件四部分，每部分实现特定的功能，如图2所示。</p><p>图2. 软件结构图</p><p>主程序共有三种工作模式：自动测试、单步测试以及运行模式。</p><p>自动测试模式支持测试过程一键点击完成所选择的所有过程项及数据项的测试，一般作为整个测试过程的第一阶段，能够方便快速地对整个协议程序有一个全面的了解和评价，也作为单步测试阶段的基础。</p><p>单步测试模式支持分测试项逐个进行，由测试人员决定测试过程的启停。能够有针对性对某个报文交互过程进行详细地测试，分析其错误原因。</p><p>手动测试模式支持手动输入数据报文，并给测试人员提供发送数据帧模板。是对自动测试和单步测试模式的补充和扩展，由测试人员手动输入每个报文和被测试方进行交互，达到了灵活测试的目的。</p><p>三种测试模式工作流程如图3所示。</p><p>图3. 主控程序流程图</p><p>1) 首先进行模式选择，自动、单步(主站)以及运行态；如果已经处于某种模式下，提示用户将切换通道并初始化状态。</p><p>2) 判断通道是否已经运行，如果已经运行则先关闭通道；否则直接进入第4步。</p><p>3) 判断通道使能标志，如果初始化通道并使能；否则直接打开通道。</p><p>4) 判断通道标志，是否打开，如果未打开则打开通道。</p><p>5) 判断通道标志是否创建了协议组件，如果已创建，则初始化协议，否则首先创建组件，然后初始化协议。</p><p>6) 判断当前通道的协议组件对象是否已经初始化过，没有则初始化，有的话则启用组件。</p><p>7) 根据第一步中设置的模式，则通知协议对象进入到指定的模式状态下。</p><p>8) 如果进入自动测试模式，则组件会自动运行下去，不需要人工干预，这时候可以选择停止通道。当组件处理完毕或者认为处理完所有的测试项后，会向界面发送测试结束的通知，这时候界面会根据设置的标示信息，如果需要进入运行态，则自动转入运行态；如果需要弹出测试结果，则弹出测试结果信息。</p><p>9) 在模拟主站的时候，单步执行会一步一步的执行过程项；首先会执行第一个过程分项；当组件执行完后返回测试结束信息时，程序自动跳转到下一过程分项，等待用户再次点击按钮进行测试；当测试完成后；如上述第8所说的根据标示信息进行动作。</p><p>10) 如果进入运行模式，主站会保持链路，子站会及时回应主站的信息。</p><p>图4. 测试验证对比</p><p>通过现场测试验证，该测试系统可以提高测试效率和规约一致性，如图4所示，测试效率提高了50%，规约一致性提高至100%。</p></sec><sec id="s7"><title>5. 总结</title><p>通信的问题是多年来制约配网自动化发展的一个重要因素，IEC61850提供的通信模型是配电网通信发展的方向，能够建立统一、完善、详细的功能和数据模型，提高通信效率；同时101、104通信协议仍将长期地应用于配电网通信，本次开发的配电网自动化通信协议测试系统功能完善、稳定，提高了测试效率和规约一致性，在对入网设备的通信协议检测方面将发挥重要的作用。</p></sec><sec id="s8"><title>基金项目</title><p>中国南方电网有限责任公司科技项目(GDKJXM20172867)。</p></sec><sec id="s9"><title>文章引用</title><p>陈小军,黄嘉健,庞嘉琦,张灿军. 配电网通信协议智能测试技术研究Communication Protocol of Intelligent Test System in Distribution Network[J]. 智能电网, 2018, 08(06): 525-531. https://doi.org/10.12677/SG.2018.86057</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.27772-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">余南华, 陈云瑞. 通信技术[M]. 北京: 中国电力出版社, 2012.</mixed-citation></ref><ref id="hanspub.27772-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">钟清. 智能电网关键技术研究[M]. 北京: 中国电力出版社, 2011.</mixed-citation></ref><ref id="hanspub.27772-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">张晓平, 余南华. 智能配电网的通信系统建设与发展分析[J]. 广东电力, 2011, 24(11): 59-65.</mixed-citation></ref><ref id="hanspub.27772-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">张岚. 配电网自动化通信方式综述[J]. 电力系统通信, 2008, 12(4): 42-46.</mixed-citation></ref><ref id="hanspub.27772-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">戴新文. 配电网自动化中两种常用通信方式选型探讨[J]. 福建电力与电工, 2007(1): 36-38.</mixed-citation></ref><ref id="hanspub.27772-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">李克文, 高立克, 等. 配电网自动化通信规约测试系统开发与应用[J]. 广西电力, 2011, 34(1): 10-12.</mixed-citation></ref><ref id="hanspub.27772-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">沈鸿. 远动通信规约测试及分析系统[J]. 广东电力, 2005, 3(18): 55-57.</mixed-citation></ref><ref id="hanspub.27772-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">刘海龙, 娄英俊, 欧阳琪, 等. 101, 104规约在配电网历史数据传输中的应用[J]. 电气技术, 2011(3): 21-24.</mixed-citation></ref></ref-list></back></article>