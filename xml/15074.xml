<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JISP</journal-id><journal-title-group><journal-title>Journal of Image and Signal Processing</journal-title></journal-title-group><issn pub-type="epub">2325-6753</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JISP.2015.42002</article-id><article-id pub-id-type="publisher-id">JISP-15074</article-id><article-categories><subj-group subj-group-type="heading"><subject>JISP20150200000_39859127.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于提升小波变换的图像融合改进算法的研究
  Study on the Improvement of Image Fusion Algorithm Based on Lifting Wavelet Transform
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>江</surname><given-names>泽涛</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>阳</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>川</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>南昌航空大学信息工程学院，江西 南昌</addr-line></aff><aff id="aff2"><addr-line>桂林电子科技大学计算机科学与工程学院，广西 桂林</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>14</day><month>04</month><year>2015</year></pub-date><volume>04</volume><issue>02</issue><fpage>11</fpage><lpage>19</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   提出了一种基于提升小波变换的图像融合改进算法。针对提升小波分解后的低频和高频分量各自的特点，选用不同的规则进行融合，即低频系数采用选择法和加权平均相结合的策略，高频系数时，把小波系数的方差与绝对值综合起来考虑决定融合小波系数。实验结果表明，当采用平均梯度、信息熵、标准差、均方根误差和峰值信噪比作为客观评价准则，该算法的融合图像比拉普拉斯金字塔融合图像和传统的小波变换的融合图像具有更好的融合效果，较好地提高了图像融合精确度。&lt;br/&gt;An improved algorithm is Proposed for image fusion based on lifting wavelet transform in the paper. According to the characteristics of lifting wavelet decomposition of the low and high frequency components of the respective, different fusion rules are adopted, namely low frequency coefficient selection method and the weighted average method, choosing the high frequency coefficient, the variance of wavelet coefficients and the absolute value of the wavelet coefficients are considered synthetically decision fusion. The experimental results show that, when we take the average gradient, the information entropy, the standard deviation, root mean square error and peak signal to noise ratio as the objective evaluation criteria of image fusion, image fusion algorithm has better fusion effect than Laplasse Pyramid fusion image and the traditional wavelet transform; it improves the accuracy of image fusion effectly.
    
  
 
</p></abstract><kwd-group><kwd>图像融合，融合规则，小波变换，提升小波变换, Image Fusion</kwd><kwd> Fusion Rule</kwd><kwd> Wavelet Transform</kwd><kwd> Lifting Wavelet Transform</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于提升小波变换的图像融合改进算法的研究<sup> </sup></title><p>江泽涛<sup>1</sup>，杨阳<sup>2</sup>，郭川<sup>2</sup></p><p><sup>1</sup>桂林电子科技大学计算机科学与工程学院，广西 桂林</p><p><sup>2</sup>南昌航空大学信息工程学院，江西 南昌</p><p>Email: zetaojiang@126.com, 912335524@qq.com, 1002204643@qq.com</p><p>收稿日期：2015年3月26日；录用日期：2015年4月7日；发布日期：2015年4月14日</p><disp-formula id="scirp.15074-formula757"><graphic xlink:href="http://html.hanspub.org/file/1-2670043x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>提出了一种基于提升小波变换的图像融合改进算法。针对提升小波分解后的低频和高频分量各自的特点，选用不同的规则进行融合，即低频系数采用选择法和加权平均相结合的策略，高频系数时，把小波系数的方差与绝对值综合起来考虑决定融合小波系数。实验结果表明，当采用平均梯度、信息熵、标准差、均方根误差和峰值信噪比作为客观评价准则，该算法的融合图像比拉普拉斯金字塔融合图像和传统的小波变换的融合图像具有更好的融合效果，较好地提高了图像融合精确度。</p><p>关键词 :图像融合，融合规则，小波变换，提升小波变换</p><disp-formula id="scirp.15074-formula758"><graphic xlink:href="http://html.hanspub.org/file/1-2670043x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>图像融合是将两个或两个以上的传感器对某一场景获取多幅图像信息加以综合，从而获取单一传感器无法获取的信息。图像融合的目的是减少不确定性。</p><p>由于现有的基于小波变换的图像融合算法计算较复杂、速度较慢等缺点，本文提出了一种基于提升小波变换的图像融合改进算法。针对提升小波分解后的低频和高频分量各自的特点，选用不同的规则进行融合，该方法在保持原有的基于传统小波变换融合方法的融合性能的前提下，可以使融合处理的计算量大大减少，融合速度显著提高。</p></sec><sec id="s4"><title>2. 提升小波的分解与重构</title><p>Sweldens提出了用提升方法构造小波的新思路，并证明所有经典小波分析都可以找到相应等效的提升方法[<xref ref-type="bibr" rid="scirp.15074-ref1">1</xref>] 提升方案把第一代小波变换过程分为分裂、预测和更新(或修正)三个阶段[<xref ref-type="bibr" rid="scirp.15074-ref2">2</xref>] 。</p><p>1) 分裂：是将信号偶数和奇数样本分离，即</p><disp-formula id="scirp.15074-formula759"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x8_hanspub.png" xlink:type="simple"/></inline-formula>表示信号<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x9_hanspub.png" xlink:type="simple"/></inline-formula>的低频近似分量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x10_hanspub.png" xlink:type="simple"/></inline-formula>表示信号<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x11_hanspub.png" xlink:type="simple"/></inline-formula>的高频细节分量。</p><p>2) 预测：预测过程是一个对偶提升的过程，应保持偶样本不变，利用数据间的相关性，定义预测算子<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x12_hanspub.png" xlink:type="simple"/></inline-formula>，用相邻的偶数序列来预测奇数序列。预测误差为</p><disp-formula id="scirp.15074-formula760"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>3) 更新：经过以上两个步骤产生的系数子集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x14_hanspub.png" xlink:type="simple"/></inline-formula>的某些性质(如均值)并不和原始数据中的性质一致，因此需要构造一个更新算子<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x15_hanspub.png" xlink:type="simple"/></inline-formula>去更新<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x16_hanspub.png" xlink:type="simple"/></inline-formula>，使得修正后的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x17_hanspub.png" xlink:type="simple"/></inline-formula> (记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x18_hanspub.png" xlink:type="simple"/></inline-formula>)只包含信号的低频成分。即</p><disp-formula id="scirp.15074-formula761"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x19_hanspub.png"  xlink:type="simple"/></disp-formula><p>与经典小波分析方法相比，第二代小波构造方法的优越性体现在：a) 与经典的Mallat算法相比，其运算量减少一半，在对图像数据的进行处理时，可以减少约3/4的运算量[<xref ref-type="bibr" rid="scirp.15074-ref3">3</xref>] 。b) 易于构造非线性小波变换[<xref ref-type="bibr" rid="scirp.15074-ref4">4</xref>] 。</p><p>提升小波重构就是将分解的三个步骤倒过来：</p><p>1) 反修正<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x20_hanspub.png" xlink:type="simple"/></inline-formula> (4)</p><p>2) 反预测<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x21_hanspub.png" xlink:type="simple"/></inline-formula> (5)</p><p>3) 合并<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x22_hanspub.png" xlink:type="simple"/></inline-formula> (6)</p><p>式中的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x23_hanspub.png" xlink:type="simple"/></inline-formula>表示将<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x24_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x25_hanspub.png" xlink:type="simple"/></inline-formula>分别作为偶数序列和奇数序列拼接成原始信号。采用基于提升方案的小波变换对信号进行分解和重构的过程如图1所示。</p><p>信号进行传统小波变换是用滤波器对信号进行卷积滤波，由于时域卷积在频域变为乘积，所以传统小波变换往往依赖于傅立叶变换在频域中进行设计。从以上的分析可以看出：对信号进行提升小波变换用的是时域中的函数插值思想，即对信号进行预测来产生高频信号，然后再通过更新来获得低频信号，只需在时域中进行，大大节省了内存。Daubechies和Sweldens证明了[<xref ref-type="bibr" rid="scirp.15074-ref5">5</xref>] ；任意具有有限长滤波器的离散小波变换都可以通过对它的多相矩阵进行因式分解化为有限的提升步骤来解决，传统的小波变换转化为提升算法之后，运算速度大有提高。另外，提升小波变换可以实现整数小波变换，计算过程不产生任何浮点误差，具有精确的重构原始信号，以及对原始图像的尺寸没有严格的要求等优点。</p></sec><sec id="s5"><title>3. 算法的改进</title><p>相对于传统的小波变换，提升小波变换具有良好的、适合硬件实现的特点。提升算法不依赖于傅立叶变换，在空间域就能完成小波变换，实现对频率域信号的分析，因此不需要很强的傅立叶分析背景便可以理解小波的特性和小波变换。由于摒弃了传统的傅立叶变换，将高低通滤波器转化成一系列的预测和更新步骤，而预测和更新步骤的实现往往很简单，并且具有很大的重复性，从而简化了小波分解和重构的实现结构，降低了运算复杂度。提升算法可以进行同址运算，大大减少了程序所需要的存储开销。这些特点使得提升算法非常适合硬件实现，可以有效地提高硬件系统的性能，以及硬件资源的利用率，极大地改善了运行速度、占用少量内存空间。</p><p>基于提升小波变换的图像融合基本原理与基于传统小波变换的图像融合方法类似。首先采用提升方案对已配准的源图像先进行提升小波分解，然后对各分解层分别进行融合处理，各分解层上的不同频率分量可采用不同的融合算子进行融合处理，最后进行提升小波逆变换重构融合图像[<xref ref-type="bibr" rid="scirp.15074-ref6">6</xref>] [<xref ref-type="bibr" rid="scirp.15074-ref7">7</xref>] 。以两幅图像为例，融合原理如图2所示。</p><p>大部分基于小波变换的图像融合算法主要研究如何选择融合图像中的高频细节系数，而对低频近似系数直接采用“平均法”处理，这在一定程度上降低了图像的对比度。图像的低频成分包括了图像的主要能量，决定了图像的轮廓。因此，正确地选择低频系数能够很好地提高图像的视觉效果。综合考虑融合图像的质量和执行速度，本章提出了一种基于提升小波变换的图像融合改进算法，在以往的低频与高频融合规则上，均进行了改进，融合图像较好地保留了输入图像的细节和边缘，全局清晰，融合效果好。</p><sec id="s5_1"><title>3.1. 低频部分融合规则</title><p>图像经过提升小波变换[<xref ref-type="bibr" rid="scirp.15074-ref8">8</xref>] 后得到低频分量是对源图像的近似描述，包含了图像的轮廓和纹理信息，以及平均灰度，一般采用加权平均法来处理。但是由于聚焦的不同，图像差异较大，这样处理会弱化它们之间的差异，降低目标的可识别性。由于这个原因，本文采用以下方法来处理低频分量：</p><p>图1. 提升小波变换的分解和重构示意图</p><p>图2. 提升小波变换融合算法原理图</p><disp-formula id="scirp.15074-formula762"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x28_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x29_hanspub.png" xlink:type="simple"/></inline-formula>为融合后的低频分量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x30_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x31_hanspub.png" xlink:type="simple"/></inline-formula>分别为左聚焦和右聚焦图像的低频部分，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x32_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x33_hanspub.png" xlink:type="simple"/></inline-formula>分别为低频分量的均值。</p></sec><sec id="s5_2"><title>3.2. 高频部分融合规则</title><p>对于图像的高频成分，小波系数绝对值越大表示相应位置的灰度值变化也越大，同时还表示其包含着比较多的图像信息，这也说明其重要性程度也越大，它在一定程度上反映了源图像对融合图像的贡献程度的大小。方差的大小对应着数据组分布情况，方差值越大对应着数据组分布程度也越大。在图像数据中，图像数据的像素值变化越大，那么就表明方差也越大，比如含边缘的图像数据块对应的方差值相对来说比较大，清晰图像块的方差值要比不清晰图像块的方差值大。基于小波系数的上述性质，对于小波系数先后有人提出了基于小波系数绝对值取大的融合规则和基于小波系数窗口方差取大的融合规则，这两种方法的融合过程计算简单，而且融合效果都不错，但是这两种方法有可能引入噪声系数。针对此问题，本文提出了将小波系数绝对值大小和小波系数窗口方差大小结合起来考虑，融合规则如下：</p><p>1) 两幅图像A和B，如果图像A在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x34_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值比图像B在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x35_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值大，且图像A在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x36_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差比图像B在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x37_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差大，则取图像A在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x38_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数作为融合图像在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x39_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数。</p><p>2) 两幅图像A和B，如果图像A在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x40_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值比图像B在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x41_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值大，但图像A在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x42_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差比图像B在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x43_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差小，则取图像B在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x44_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口的各小波系数绝对值均值和作为融合图像在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x45_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数。</p><p>3) 两幅图像A和B，如果图像A在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x46_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值比图像B在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x47_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值小，且图像A在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x48_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差比图像B在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x49_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差小，则取图像B在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x50_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数作为融合图像在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x51_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数。</p><p>4) 两幅图像A和B，如果图像A在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x52_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值比图像B在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x53_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数绝对值小，且图像A在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x54_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差比图像B在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x55_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差大，则取图像A在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x56_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口的各小波系数绝对值均值和作为融合图像在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x57_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数。</p><p>5) 其他的情况就取两幅图像A和B在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x58_hanspub.png" xlink:type="simple"/></inline-formula>小波系数的平均值作为融合图像在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x59_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数。</p><p>上述思想用数学公式可表示为：</p><disp-formula id="scirp.15074-formula763"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x60_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x61_hanspub.png" xlink:type="simple"/></inline-formula>为融合图像在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x62_hanspub.png" xlink:type="simple"/></inline-formula>的融合系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x63_hanspub.png" xlink:type="simple"/></inline-formula>为图像A在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x64_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x65_hanspub.png" xlink:type="simple"/></inline-formula>为图像B在点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x66_hanspub.png" xlink:type="simple"/></inline-formula>的小波系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x67_hanspub.png" xlink:type="simple"/></inline-formula>为图像A在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x68_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口的各小波系数绝对值均值和，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x69_hanspub.png" xlink:type="simple"/></inline-formula>为图像B在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x70_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口的各小波系数绝对值均值和，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x71_hanspub.png" xlink:type="simple"/></inline-formula>为图像A在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x72_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x73_hanspub.png" xlink:type="simple"/></inline-formula>为图像B在以点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x74_hanspub.png" xlink:type="simple"/></inline-formula>为中心元素的窗口方差系数。</p><p>由于该融合规则把小波系数绝对值大小和小波系数窗口方差大小结合起来考虑，所以在一定程度上克服了融合两幅图像小波系数时有可能引入噪声系数的不足。</p></sec></sec><sec id="s6"><title>4. 实验结果及分析</title><p>通过实验我们将本章提出的算法与拉普拉斯金字塔、传统的小波变换以及低频近似系数直接采用“平均法”处理的融合算法相比较。图3中，(a)、(b)分别是两幅已经过配准的多聚焦图像[<xref ref-type="bibr" rid="scirp.15074-ref9">9</xref>] [<xref ref-type="bibr" rid="scirp.15074-ref10">10</xref>] ，其中图(a)为聚焦右边的钟表图像，图(b)为聚焦左边的钟表图像，大小都为256 &#215; 256。图(c)和图(d)为分别使用基于拉普拉斯金字塔和DBSS(2,2)小波变换[<xref ref-type="bibr" rid="scirp.15074-ref11">11</xref>] 的融合图像，这两种算法都采用本文提出的融合规则。图(e)为使用提升小波 + 均值规则的融合图像，即融合规则采用低频部分取平均，高频部分取系数绝对值最大的融合算法。图(f)为本章算法融合图像。实验中，拉普拉斯金字塔中的滤波器<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x75_hanspub.png" xlink:type="simple"/></inline-formula>= [1 4 6 4 1]/16，提升小波变换使用db4作为小波基，四种方法的分解层数均为2。从图3融合结果来看，四种算法融合后的图像都包含了源图像的有用信息，得到了左右聚焦都清晰的图像。相比较容易看出，提升小波 + 均值规则的融合图像效果最差，其他三种算法融合图像的细节和边缘较好，全局清晰，视觉效果差不多。</p><disp-formula id="scirp.15074-formula764"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x82_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x83_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x84_hanspub.png" xlink:type="simple"/></inline-formula>分别为图像的行数和列数；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x85_hanspub.png" xlink:type="simple"/></inline-formula>表示图像在像素点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x86_hanspub.png" xlink:type="simple"/></inline-formula>的灰度值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x87_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x88_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>2) 信息熵</p><p>对于灰度范围<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x89_hanspub.png" xlink:type="simple"/></inline-formula>的图像直方图，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x90_hanspub.png" xlink:type="simple"/></inline-formula>为灰度值等于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x91_hanspub.png" xlink:type="simple"/></inline-formula>的像素数与图像总像素数之比，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x92_hanspub.png" xlink:type="simple"/></inline-formula>为灰度级总数，其信息熵定义为</p><disp-formula id="scirp.15074-formula765"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x93_hanspub.png"  xlink:type="simple"/></disp-formula><p>图像信息熵反应了图像携带的信息量的多少。融合图像的熵值越大，说明携带了源图像越多的信息量，融合效果越好。</p><p>3) 标准差</p><p>标准差是一种表示分散程度的统计观念，它反映了图像灰度值的分布情况。标准差的大小与图像质量正相关。标准差越大，说明图像灰度级分布越分散，图像的有用信息就越多；标准差越小，图像灰度级分布集中，图像的对比度也减小，色调单一得不到太多有用的信息。标准差的计算公式为：</p><disp-formula id="scirp.15074-formula766"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x94_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x95_hanspub.png" xlink:type="simple"/></inline-formula>表示融合后图像的灰度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x96_hanspub.png" xlink:type="simple"/></inline-formula>表示融合图像灰度的均值。</p><p>4) 均方根误差</p><p>均方根误差表示融合图像与标准图像的偏离程度，均方根误差越小，说明融合效果越好。其计算公式为：</p><disp-formula id="scirp.15074-formula767"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x97_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x98_hanspub.png" xlink:type="simple"/></inline-formula>为融合图像，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x99_hanspub.png" xlink:type="simple"/></inline-formula>为标准图像。</p><p>5) 峰值信噪比</p><p>峰值信噪比越大，图像的视觉效果就越好。其计算公式为：</p><disp-formula id="scirp.15074-formula768"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2670043x100_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2670043x101_hanspub.png" xlink:type="simple"/></inline-formula></p><p>表1是对图3中融合图像的客观数据统计。本章算法的融合图像中的平均梯度、信息熵、标准差和峰值信噪比都比其他几种算法的高，并且均方根误差比其他几种算法的小，说明本章算法较好地提高了清晰度和提取更多源图像的信息，融合效果更好。所以，从主、客观分析来看，本章算法的融合效果在这几种方法中是最好的。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The average gradient, information entropy, standard deviation, root mean square error and peak signal to noise ratio of multifocus image fusion result</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >平均梯度</th><th align="center" valign="middle" >信息熵</th><th align="center" valign="middle" >标准差</th><th align="center" valign="middle" >均方根误差</th><th align="center" valign="middle" >峰值信噪比</th></tr></thead><tr><td align="center" valign="middle" >拉普拉斯金字塔融合</td><td align="center" valign="middle" >7.4913</td><td align="center" valign="middle" >7.7252</td><td align="center" valign="middle" >52.3190</td><td align="center" valign="middle" >7.4844</td><td align="center" valign="middle" >68.4616</td></tr><tr><td align="center" valign="middle" >DBSS(2,2)小波融合</td><td align="center" valign="middle" >7.6967</td><td align="center" valign="middle" >7.8983</td><td align="center" valign="middle" >52.3112</td><td align="center" valign="middle" >7.2883</td><td align="center" valign="middle" >69.3075</td></tr><tr><td align="center" valign="middle" >提升小波 + 均值融合</td><td align="center" valign="middle" >7.4877</td><td align="center" valign="middle" >7.7146</td><td align="center" valign="middle" >51.4169</td><td align="center" valign="middle" >7.4226</td><td align="center" valign="middle" >70.3351</td></tr><tr><td align="center" valign="middle" >本章算法融合</td><td align="center" valign="middle" >7.7723</td><td align="center" valign="middle" >7.9528</td><td align="center" valign="middle" >52.3593</td><td align="center" valign="middle" >7.0789</td><td align="center" valign="middle" >71.4028</td></tr></tbody></table></table-wrap><p>表1. 多聚焦图像融合结果的平均梯度、信息熵、标准差、均方根误差和峰值信噪比</p></sec><sec id="s7"><title>5. 小结</title><p>本文提出了一种基于提升小波变换[<xref ref-type="bibr" rid="scirp.15074-ref12">12</xref>] -[<xref ref-type="bibr" rid="scirp.15074-ref16">16</xref>] 的图像融合改进算法，该算法使用提升小波变换代替传统的小波变换或拉普拉斯金字塔，提出了采用不同的融合策略合并相应的低频系数和高频系数，本文通过仿真比较，性能明显优于拉普拉斯金字塔、传统的小波变换以及低频近似系数直接采用“平均法”处理的融合算法，本文算法简单、执行速度快、节省内存空间，融合图像能够较好地保留细节和边缘，同时保留了源图像的有用信息，全局清晰，融合效果良好，在自动目标识别与跟踪、遥感、医学图像处理、智能机器人等领域有着广阔的应用前景，特别适用于实时系统。</p></sec><sec id="s8"><title>科研情况</title><p>国家自然科学基金项目——由二维图像序列重建三维图像拼接与融合方法研究(编号：61272216)。</p></sec><sec id="s9"><title>基金项目</title><p>本文是由中国自然科学基金会(61272216)和中国航天创新基金会(CASC201102)资助。</p></sec><sec id="s10"><title>文章引用</title><p>江泽涛,杨 阳,郭 川, (2015) 基于提升小波变换的图像融合改进算法的研究Study on the Improvement of Image Fusion Algorithm Based on Lifting Wavelet Transform. 图像与信号处理,02,11-19. doi: 10.12677/JISP.2015.42002</p></sec><sec id="s11"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.15074-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Daubechies, I. and Sweldens, W. (1998) Factoring wavelet transforms into lifting steps. Journal of Fourier Analysis and Applications, 4, 245-267.</mixed-citation></ref><ref id="hanspub.15074-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Daubechies, I. and Sweldens, W. (1998) Factoring wavelet transforms into lifting steps. Journal of Fourier Analysis and Applications, 4, 305-327.</mixed-citation></ref><ref id="hanspub.15074-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Li, H.G., Wang, Q. and Wu, L.N. (2001) A novel design of lifting scheme from general wavelets. IEEE Transactions on Signal Processing, 49, 1714-1717.</mixed-citation></ref><ref id="hanspub.15074-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">孙延奎 (2005) 小波分析及其应用. 机械工业出版社, 北京.</mixed-citation></ref><ref id="hanspub.15074-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">王卫卫, 水鹏朗, 宋国乡 (2004) 小波域多聚集图像融合算法. 系统工程与电子技术, 5, 668-671.</mixed-citation></ref><ref id="hanspub.15074-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">李伟, 朱学峰 (2007) 基于第二代小波变换的图像融合方法及性能评价. 自动化学报, 8, 817-822.</mixed-citation></ref><ref id="hanspub.15074-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">杨静, 王岩飞, 刘波 (2004) 一种新的非抽取提升结构小波变换图像融合方法. 光子学报, 6, 728-731.</mixed-citation></ref><ref id="hanspub.15074-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">刘军伟, 饶妮妮 (2005) 提升小波变换的FPGA 设计与实现. 微计算机信息, 11Z, 132-134.</mixed-citation></ref><ref id="hanspub.15074-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Dong, H.X., Yi, Z.J. and Ye, X.B. (2012) Multifocus image fusion scheme based on features contrast of lifting stationary wavelet. Application Research of Computers, 2, 096.</mixed-citation></ref><ref id="hanspub.15074-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Liao, C.Z., Liu, Y.S. and Jiang, M.Y. (2013) Multifocus image fusion using Laplacian pyramid and Gabor filters. Applied Mechanics and Materials, 373, 530-535.</mixed-citation></ref><ref id="hanspub.15074-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">陈浩, 王延杰 (2014) 基于小波变换的图像融合技术研究. 微电子学与计算机, 5, 39-41.</mixed-citation></ref><ref id="hanspub.15074-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">邵国峰, 林锦顺, 张卫国 (2014) 一种基于提升小波的快速图像融合算法. 光电技术应用, 4, 39-44.</mixed-citation></ref><ref id="hanspub.15074-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">徐萌萌 (2014) 基于小波变换的图像融合算法研究. 哈尔滨理工大学, 哈尔滨.</mixed-citation></ref><ref id="hanspub.15074-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">余汪洋, 陈祥光, 董守龙, 吴磊 (2014) 基于小波变换的图像融合算法研究. 北京理工大学学报, 12, 1262-1266.</mixed-citation></ref><ref id="hanspub.15074-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">王娟 (2010) 基于第二代小波变换的图像融合算法研究. 西华大学, 成都.</mixed-citation></ref><ref id="hanspub.15074-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">李俊峰, 姜晓丽, 戴文战 (2014) 基于提升小波变换的医学图像融合. 中国图象图形学报, 11, 1639-1648.</mixed-citation></ref></ref-list></back></article>