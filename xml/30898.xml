<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2019.96126</article-id><article-id pub-id-type="publisher-id">CSA-30898</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20190600000_30813251.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  结合层次聚类的海洋内波SAR图像特征自动检测
  Automatic Feature Detection of Ocean Internal Wave SAR Image Based on Hierarchical Clustering
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>许</surname><given-names>素芹</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>捷</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>婷婷</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陶</surname><given-names>荣华</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>海军潜艇学院，山东 青岛</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>18</day><month>06</month><year>2019</year></pub-date><volume>09</volume><issue>06</issue><fpage>1118</fpage><lpage>1125</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   海洋内波是一种典型的海洋现象，其特征检测和参数反演研究对海洋生态系统、海洋渔业、海洋工程和军事等具有重要意义。海洋内波在合成孔径雷达(SAR)图像上的明暗条纹特征，使SAR图像成为检测海洋内波特征的重要数据源。针对复杂的多簇海洋内波SAR图像，本文首先利用高斯滤波、Canny算子对SAR图像中多簇海洋内波特征进行检测，通过非内波边缘剔除、特征曲线搜索，结合层次聚类分析，进行了海洋内波特征的自动提取和多个内波波包的识别与分离。基于计算机视觉库Opencv，利用RADARSAT卫星SAR图像进行了海洋内波特征检测，检测结果表明该方法有效解决了内波特征自动检测问题，为海量SAR图像海洋内波特征参数自动反演和星上快速处理奠定了基础。 Ocean internal wave is a typical ocean phenomenon, and its characteristic detection and parameter inversion are of great significance to marine ecosystem, marine fishery, marine engineering and military affairs. The characteristics of light and dark stripes of ocean internal waves on synthetic aperture radar (SAR) images make SAR images become an important data source for detecting ocean internal wave features. In this paper, for complex multi-cluster SAR images of ocean internal waves, Gauss filter and Canny operator are used for the feature detection of multi-cluster ocean internal wave in SAR image, and automatic extraction of ocean internal wave features and identification and separation of multiple internal wave packets are realized by eliminating the edge of non-internal wave, searching the feature curve and combing the method of hierarchical clustering analysis. Based on computer vision library Opencv, ocean internal wave feature detection is carried out based on the SAR image of RADARSAT. The detecting results show that this method can effectively solve the problem of internal wave feature automatic detection, which lays a foundation for automatic inversion of ocean internal wave feature parameters and onboard fast processing of massive SAR images. 
  
 
</p></abstract><kwd-group><kwd>SAR图像，海洋内波特征，Canny算子，层次聚类，自动检测, SAR Image</kwd><kwd> Ocean Internal Wave Characteristics</kwd><kwd> Canny Operator</kwd><kwd> Hierarchical Clustering</kwd><kwd> Auto-matic Withdrawal</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>结合层次聚类的海洋内波SAR图像特征 自动检测<sup> </sup></title><p>许素芹，陈捷，李婷婷，陶荣华</p><p>海军潜艇学院，山东 青岛</p><p><img src="//html.hanspub.org/file/10-1541418x1_hanspub.png" /></p><p>收稿日期：2019年6月4日；录用日期：2019年6月17日；发布日期：2019年6月24日</p><disp-formula id="hanspub.30898-formula3"><graphic xlink:href="//html.hanspub.org/file/10-1541418x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>海洋内波是一种典型的海洋现象，其特征检测和参数反演研究对海洋生态系统、海洋渔业、海洋工程和军事等具有重要意义。海洋内波在合成孔径雷达(SAR)图像上的明暗条纹特征，使SAR图像成为检测海洋内波特征的重要数据源。针对复杂的多簇海洋内波SAR图像，本文首先利用高斯滤波、Canny算子对SAR图像中多簇海洋内波特征进行检测，通过非内波边缘剔除、特征曲线搜索，结合层次聚类分析，进行了海洋内波特征的自动提取和多个内波波包的识别与分离。基于计算机视觉库Opencv，利用RADARSAT卫星SAR图像进行了海洋内波特征检测，检测结果表明该方法有效解决了内波特征自动检测问题，为海量SAR图像海洋内波特征参数自动反演和星上快速处理奠定了基础。</p><p>关键词 :SAR图像，海洋内波特征，Canny算子，层次聚类，自动检测</p><disp-formula id="hanspub.30898-formula4"><graphic xlink:href="//html.hanspub.org/file/10-1541418x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/10-1541418x7_hanspub.png" /> <img src="//html.hanspub.org/file/10-1541418x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>海洋内波是海水内部的波动之一，它与海洋表面的海浪运动有着非常不同的物理特征。海洋内波会引起海水温、盐、密度剖面发生剧烈的波动，这种波动具有很强的方向性和时变性，对水下声传播影响巨大，使声速的大小和方向均发生改变，给水下目标的声纳探测与定位以及水声通信等带来严重影响。对几何尺寸与内波波长相当的水下航行器的安全性和隐蔽性也影响严重，因此及时掌握海洋内波特征具有重要意义。</p><p>众所周知，应用SAR可以观测海洋内波，而且海洋内波在SAR图像上呈现明暗相间的条纹特征 [<xref ref-type="bibr" rid="hanspub.30898-ref1">1</xref>] ，为内波特征参数反演提供了丰富的资料源，相应算法研究也比较多，但大多算法依赖人工干预，检测精度受主观因素影响，检测效率较低。陈捷 [<xref ref-type="bibr" rid="hanspub.30898-ref2">2</xref>] 等基于滑动窗口研究了海洋内波SAR图像特征的自动检测算法，其中滑动窗口大小根据典型内波波长的1/2~1倍确定，用来处理海量大幅宽SAR图像效率不高，不适于处理包含多个内波波包的复杂SAR图像。本文应用跨平台计算机视觉库Opencv实现了海洋内波SAR图像特征自动检测，首先基于Canny算子检测海洋内波SAR图像特征边缘，通过曲线搜索将内波特征边缘从图像中分离出来，结合层次聚类方法完成多个内波波包的识别和标识，整个过程无需外界干预，为海量SAR图像数据快速处理和进一步自动反演内波波长、传播方向、波速、振幅等特征参数奠定了基础。</p></sec><sec id="s4"><title>2. 层次聚类算法</title><p>针对多簇内波的特征曲线的分离问题，本文在一般边缘特征提取的基础上结合层次聚类方法，有效实现了内波群的自动检测识别和分离。层次聚类是聚类算法的一种，通过计算样本数据点或簇间的相似度来创建一棵聚类树。在聚类树中，不同类别的原始数据点或簇是树的最低层，树的顶层是一个聚类的根节点。创建聚类树有自下而上合并和自上而下分裂两种方法，本文目的是寻找一个簇中的特征线上的点，因此采用合并方法。</p><p>聚类分析的输入用特征数据集合 ( X , d ) 表示，其中X表示一组样本，d表示样本间相似度的标准，聚类系统的输出是对数据的区分结果 [<xref ref-type="bibr" rid="hanspub.30898-ref3">3</xref>] ，即：</p><disp-formula id="hanspub.30898-formula5"><graphic xlink:href="//html.hanspub.org/file/10-1541418x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中 c i ( i = 1 , 2 , 3 , ⋯ , k ) 是X的子集，且满足如下条件：</p><p>1) c 1 ∪ c 2 ∪ c 3 ∪ ⋯ ∪ c k = x</p><p>2) c i ∩ c j = ϕ ， i ≠ j ，c中的 c 1 , c 2 , ⋯ , c k 称为类或簇。</p><p>层次聚类的合并算法通过计算两类数据点或簇间的相似性，即通过计算每一个类别的数据点或簇与所有数据点或簇之间的距离来确定它们之间的相似性，距离越小，相似度越高。并将距离最近的两个数据点或簇进行组合，生成聚类树。数据点或簇 i , j 之间的距离用欧式距离 [<xref ref-type="bibr" rid="hanspub.30898-ref4">4</xref>] 来计算：</p><p>d i j = ( x i − x j ) 2 + ( y i − y j ) 2</p><p>在层次聚类过程中，以单个数据对象为初始簇，以满足簇间最小距离阈值的簇相聚和的方法融合，直至遍历所有初始簇得到聚类为止。如果有N个对象被聚类，其距离矩阵大小为 N &#215; N ，基于距离阈值的聚类实现流程为：</p><p>1) 将X中的每一个数据 x i 作为一个聚类中心 c i = ( x i ) 形成X的一个聚类集合： c = ( c 1 , c 2 , ⋯ , c n ) ；</p><p>2) 计算c中的每个聚类对 ( c i , c j ) 之间的欧式距离 d i j ，得到初始化距离矩阵；</p><p>3) 将 d i j 满足阈值的两个子簇合并为一个新簇，并进行簇类标识；</p><p>4) 在未标识的簇中重复执行3)，直到所有的簇都被标识为止。</p></sec><sec id="s5"><title>3. 海洋内波SAR图像特征自动检测</title><p>基于Opencv编程 [<xref ref-type="bibr" rid="hanspub.30898-ref5">5</xref>] 实现了SAR图像海洋内波特征的自动检测，具体流程如图1所示。图2为2000年4月22日的 RADARSAT卫星SAR图像，图像大小为1058像素 &#215; 766像素，图像中明显存在海洋内波，且至少有三个内波波包 [<xref ref-type="bibr" rid="hanspub.30898-ref6">6</xref>] 。</p><p>图1. 海洋内波SAR图像特征检测流程图</p><p>图2. SAR图像</p><p>图3. 高斯滤波平滑图像</p><p>1) 高斯滤波</p><p>用高斯滤波器分别按照行和列对原始图像进行卷积运算，抑制图像噪声。噪声抑制程度取决于高斯函数的标准差 σ ，当 σ 较小时，卷积运算量小，定位精度高，信噪比低；当 σ 较大时情况刚好相反，通过试验高斯滤波器参数 σ = 3 ，较好的抑制了噪声，获得的平滑图像如图3所示，图像质量具有明显改善。</p><p>2) Canny内波边缘检测</p><p>Canny算子具有较好的抗噪性能和较高的边缘定位精度 [<xref ref-type="bibr" rid="hanspub.30898-ref7">7</xref>] ，它满足三个准则 [<xref ref-type="bibr" rid="hanspub.30898-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.30898-ref9">9</xref>] ：</p><p>1) 信噪比准则，信噪比越大，边缘检测效果越好，即非边缘点被误判为边缘点或者边缘点被误判为非边缘点的概率要低 [<xref ref-type="bibr" rid="hanspub.30898-ref10">10</xref>] 。</p><p>2) 定位精度准则，定位精度越高，即检测出的边缘点尽可能在实际边缘的中心。</p><p>3) 单边缘响应准则，保证单个边缘只有一个像素响应，虚假边缘响应得到最大抑制。即对真实的边缘点，检测算子所返回的也应当只有一个，最终提取的边缘应尽可能细 [<xref ref-type="bibr" rid="hanspub.30898-ref11">11</xref>] 。</p><p>对于滤波后的图像首先计算每个像素梯度大小 M ( m , n ) 和梯度方向 θ ( m , n ) ，为确定边缘，必须对图像阵列的梯度进行非极大值抑制，即通过抑制梯度方向上的非边缘点的梯度幅值，生成细化的边缘。梯度方向 θ ( m , n ) 一般取4个可能的角度0˚、45˚、90˚、135˚之一，然后利用 3 &#215; 3 模版作用于梯度阵列的所有点，在每个点上，邻域的中心像素与沿着梯度线的两个元素进行比较，如果邻域中心点处的幅值小于沿梯度线方向上的相邻点幅值，则 M ( m , n ) 幅值为0，否则该点为可能的边缘点，这样遍历图像梯度阵列后得到只有一个像素点宽的边缘阵列 M ( m , n ) 。为了避免非极大值抑制后的图像可能存在孤立点或假边缘的情况，Canny使用了滞后双阈值处理，即设定高、低两个阈值 τ 1 , τ 2 ，对于大于高阈值的像素就确定为边缘；小于低阈值的确定为非边缘：介于二者之间的像素结合邻接像素中是否有超过高阈值的边缘像素确定。</p><p>通过自适应选取算子大小和双阈值，当算子大小为3时输出黑白二值边缘图像，如图4所示，可见较好地识别出了三个主要内波波包，但同时也包含了一些非内波特征边缘。因此本文进一步采用八邻域边缘曲线搜索的方法 [<xref ref-type="bibr" rid="hanspub.30898-ref12">12</xref>] 将图像中的曲线分离出来，同时统计每条曲线上的点数，保留曲线点数占比前30%的曲线，其它予以剔除，处理结果如图5所示，显然干扰信息明显减少，但仍然含有一些非内波边缘信息，这将会在后面进一步剔除。</p><p>图4. Canny边缘检测结果</p><p>图5. 非边缘特征剔除结果</p><p>3) 层次聚类识别内波群</p><p>由图4、图5可见检测出的边缘为一幅二值黑白图像，为了反演各簇内波特征参数，利用层次聚类方法将内波簇群进行分离和标识。层次聚类结果由集群之间的最小欧式距离阈值决定，最优欧式距离阈值通过统计不同阈值确定的集群包含的点数多而且曲线数少的原则确定。通过试验分析，认为欧式距离阈值为30时内波簇群分离结果较理想，如图6所示，图中标识为集群质心位置编号。为了保留主要内波波包可进一步剔除集群内部点数较少的集群，结果如图7所示，与原始图像的叠加结果如图8所示，为了配合海水温盐密剖面数据反演内波特征参数，进一步将每个内波波包分离和标识，分离结果如图9、图10、图11所示。</p><p>图6. 层次聚类分析结果</p><p>图7. 三个主要内波波包</p><p>图8. 检测结果与原图像的叠加</p><p>图9. 第一个内波波包</p><p>图10. 第二个内波波包</p><p>图11. 第三个内波波包</p></sec><sec id="s6"><title>4. 结论</title><p>本文根据海洋内波SAR图像特点，基于Opencv利用Canny算子结合层次聚类实现了SAR图像多簇海洋内波特征自动检测和特征曲线的分离与识别，为进一步估算各内波波长、波向、波速和振幅等特征参数奠定了基础，克服了人工干预方法和基于滑动窗口自动检测方法的不足，为海量海洋SAR图像数据内波自动检测提供了有效方法，也为实现星上快速自动处理奠定了基础。</p></sec><sec id="s7"><title>文章引用</title><p>许素芹,陈 捷,李婷婷,陶荣华. 结合层次聚类的海洋内波SAR图像特征自动检测Automatic Feature Detection of Ocean Internal Wave SAR Image Based on Hierarchical Clustering[J]. 计算机科学与应用, 2019, 09(06): 1118-1125. https://doi.org/10.12677/CSA.2019.96126</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.30898-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">李海艳, 杜涛. 海洋内波SAR影像成像理论[J]. 海洋科学, 2005, 29(10): 86-89.</mixed-citation></ref><ref id="hanspub.30898-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">陈捷, 陈标, 许素芹. 一种新的SAR图像内波检测与参数估计方法[J]. 中国图象图形学报, 2018, 14(1): 40-44.</mixed-citation></ref><ref id="hanspub.30898-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">白勇峰. 一种新的层次聚类算法的研究及应用[D]: [硕士学位论文]. 兰州: 西北师范大学, 2011.</mixed-citation></ref><ref id="hanspub.30898-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">段明秀. 层次聚类算法的研究及应用[D]: [硕士学位论文]. 长沙: 中南大学, 2009.</mixed-citation></ref><ref id="hanspub.30898-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">毛星云, 冷雪飞, 等. OpenCV3编程入门[M]. 北京: 电子工业出版社, 2015.</mixed-citation></ref><ref id="hanspub.30898-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Liu, A.K. and Hsu, M.K. (2004) Internal Wave Study in the South China Sea Using Synthetic Aperture Radar (SAR). International Journal of Remote Sensing, 25, 1261-1264. &lt;br&gt;https://doi.org/10.1080/01431160310001592148</mixed-citation></ref><ref id="hanspub.30898-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Canny, J. (1986) A Computational Approach to Edge Detec-tion. IEEE Transactions on Pattern Analysis and Machine Intelligence, 8, 679-698. &lt;br&gt;https://doi.org/10.1109/TPAMI.1986.4767851</mixed-citation></ref><ref id="hanspub.30898-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">陈志强, 高磊, 吴黎慧, 等. 一种优化的Canny算子边缘检测法[J]. 电子测试, 2011(6): 43-46.</mixed-citation></ref><ref id="hanspub.30898-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">徐德明, 万长林. 可抗噪声的Canny改进边缘检测算法[J]. 计算机系统应用, 2017, 26(1): 201-205.</mixed-citation></ref><ref id="hanspub.30898-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">张桂梅, 孙晓旭, 陈彬彬, 等. 结合分数阶微分和Canny算子的边缘检测[J]. 中国图象图形学报, 2018, 21(8): 1028-1038.</mixed-citation></ref><ref id="hanspub.30898-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">曾接贤. 改进的Beamlet与Canny相结合提取复杂图像线特征[J]. 中国图象图形学报, 2012, 17(7): 775-782.</mixed-citation></ref><ref id="hanspub.30898-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">刘相滨, 向坚持, 阳波. 基于八邻域边界跟踪的标号算法[J]. 计算机工程与应用, 2001, 37(23): 125-126.</mixed-citation></ref></ref-list></back></article>