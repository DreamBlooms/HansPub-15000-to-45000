<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2019.911223</article-id><article-id pub-id-type="publisher-id">CSA-32849</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20191100000_29146390.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于概率分类模型的体数据分类可视化
  Volume Data Classification Visualization Based on Probabilistic Classification Model
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>俊达</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>汤</surname><given-names>晓安</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>国防科技大学，湖南 长沙</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>31</day><month>10</month><year>2019</year></pub-date><volume>09</volume><issue>11</issue><fpage>1986</fpage><lpage>1992</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   分类可视化能够直观表达体数据的结构特征，是研究体数据的重要方法。本文提出一种基于概率分类模型的体数据分类可视化方法。该方法首先建立体素的概率分类模型，利用灰度直方图中定义的传递函数实现体素的分类。然后将概率分类模型与核回归重构相结合，获得更加准确地重构结果，并构造重构点的重构有效性。最后结合重构有效性实现从灰度值到颜色、不透明度的可视化映射，得到最终的绘制结果。实验表明，本文方法能够有效区分体数据中的不同结构特征，形成同质连续、异质分离的绘制结果，实现较好的分类可视化效果。 Classification visualization is an important method for volume data study, which can intuitively reveal the structural characteristics. This paper proposes a classification visualization method based on probabilistic classification model. First, the voxel probabilistic classification model is established, which realizes the classification of voxel with the transfer function defined in gray histogram. Then voxel probabilistic classification model and kernel regression are combined to achieve more accurate reconstruction result, and the validity of reconstruction on reconstructed points is measured. Finally, from gray value to color and opacity, the visualization mapping based on reconstruction validity is implemented to obtain the final visualization result. The experiment shows that the proposed method can efficiently separate the feature structures of volume data and achieve a better classification visualization result of homogeneous continuity and heterogeneous separation. 
  
 
</p></abstract><kwd-group><kwd>体绘制，光线投射法，传递函数，分类可视化，核回归, Volume Rendering</kwd><kwd> Ray Casting</kwd><kwd> Transfer Function</kwd><kwd> Classification Visualization</kwd><kwd> Kernel Regression</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于概率分类模型的体数据分类可视化<sup> </sup></title><p>张俊达<sup>*</sup>，汤晓安</p><p>国防科技大学，湖南 长沙</p><disp-formula id="hanspub.32849-formula18"><graphic xlink:href="//html.hanspub.org/file/3-1541574x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2019年10月16日；录用日期：2019年10月31日；发布日期：2019年11月7日</p><disp-formula id="hanspub.32849-formula19"><graphic xlink:href="//html.hanspub.org/file/3-1541574x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>分类可视化能够直观表达体数据的结构特征，是研究体数据的重要方法。本文提出一种基于概率分类模型的体数据分类可视化方法。该方法首先建立体素的概率分类模型，利用灰度直方图中定义的传递函数实现体素的分类。然后将概率分类模型与核回归重构相结合，获得更加准确地重构结果，并构造重构点的重构有效性。最后结合重构有效性实现从灰度值到颜色、不透明度的可视化映射，得到最终的绘制结果。实验表明，本文方法能够有效区分体数据中的不同结构特征，形成同质连续、异质分离的绘制结果，实现较好的分类可视化效果。</p><p>关键词 :体绘制，光线投射法，传递函数，分类可视化，核回归</p><disp-formula id="hanspub.32849-formula20"><graphic xlink:href="//html.hanspub.org/file/3-1541574x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/3-1541574x8_hanspub.png" /> <img src="//html.hanspub.org/file/3-1541574x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>体数据主要由不同传感器在三维物理空间采样或科学计算等方式获取，因此在不同的应用领域，体数据可能表示为标量场，如温度、压强等，也可能表示为矢量场，如飓风数据、磁场数据等。对原始数据的直接研究缺乏直观性和启发性，而分类可视化通过对不同结构、特征的分类，能够更好地暴露体数据的分布规律，帮助研究者挖掘数据中蕴含的信息，增强可视化结果的表达能力，对体数据的研究具有重要意义。</p><p>分类可视化方法主要分为三类：基于传递函数的方法、基于统计的方法和基于标记的方法。在基于传递函数的方法中，Tian等利用交互的传递函数进行海洋涡流的可视化 [<xref ref-type="bibr" rid="hanspub.32849-ref1">1</xref>]，通过修改传递函数来提取二维、三维的涡流特征。Ma等提出了一种基于聚类和特征可见性度量的传递函数交互设计算法 [<xref ref-type="bibr" rid="hanspub.32849-ref2">2</xref>]。Lan等将空间连接计算整合进基于二维传递函数的体数据分类中 [<xref ref-type="bibr" rid="hanspub.32849-ref3">3</xref>]，获得了较好的结构分离效果。Kawamura等设计了一种面向多变量的多维传递函数生成方法 [<xref ref-type="bibr" rid="hanspub.32849-ref4">4</xref>]，该方法不但能够实现多变量的体数据可视化，还可以兼容面绘制等传统绘制技术。基于传递函数的体数据分类方法仅仅从可视化映射阶段实现了体数据的分类，对于结构化体数据，特别是均匀网格体数据能够得到良好的结果，但当面向空间分布不均匀的非结构化体数据时，会产生诸多绘制失真和错误，并且该类方法不能实现体素的分类。基于统计的体数据分类方法的理论基础为决策理论和概率模型，能够实现体素的分类，被大量应用于数据预分类和离线分类算法。McGivney等通过贝叶斯框架提出一种解决部分容积效应的方法，该方法通过采用迭代算法计算后验概率密度的最大后验估计，得到体素的主要成分，实现体素的分类 [<xref ref-type="bibr" rid="hanspub.32849-ref5">5</xref>]。Prilepov等利用体素的混合模型进行二元决策边界的提取，实现混合物质边界的重构和表示 [<xref ref-type="bibr" rid="hanspub.32849-ref6">6</xref>]。基于标记的体数据分类方法通过在空间上限制传递函数对体数据的作用，减小了传统方法容易引起的绘制结果失真，可以实现光滑、二元的边界决策。Liang等设计了一种基于标记的交互体绘制方法 [<xref ref-type="bibr" rid="hanspub.32849-ref7">7</xref>]，用户选择感兴趣的区域后，算法将重新调整传递函数并优化感兴趣区域的绘制质量。然而该类方法没有考虑到边界周围的信号退化问题，因此在面对含有大量不确定性的体数据时，基于标记的体数据分类方法反而会产生更多的失真和错误分类的情况。</p><p>本文提出一种基于概率分类模型的体数据分类可视化方法，通过核回归将体素概率分类模型引入体数据重构，然后基于构造的重构有效性，实现重构点的可视化映射，采用光线投射法获得体数据的分类可视化结果。</p></sec><sec id="s4"><title>2. 体素的概率分类模型</title><p>设体数据表示为 { ( x i , y i ) : i = 1 , 2 , ⋯ , N } ，其中 x i 为第i个数据点的空间坐标， y i 为对应的属性值。由于测量设备和测量环境的限制以及部分容积效应的影响，单一体素可能对应多种特征。为了描述这种情况，定义：</p><p>p ( f k | y ) ,   k = 1 , 2 , ⋯ , K (1)</p><p>表示灰度值为y的数据点属于特征类 f k 的概率为 p ( f k | y ) 。</p><p>灰度直方图能够描述体数据的灰度值分布规律，传递函数定义了从灰度值向颜色、不透明度的映射。本文使用bin宽度为1的灰度直方图结合传递函数的方法构建体素概率分类模型，如图1所示。</p><p>图1. 基于灰度直方图的体素概率分类</p><p>其中，红、蓝、绿色梯形为颜色映射，折线为不透明度映射 α 1 ( y ) , α 2 ( y ) ∈ [ 0 , 1 ] 。本文用不透明度映射定义体数据特征， α 1 ( y ) , α 2 ( y ) 分别表示两个特征类，不透明度值可以反映某一灰度值属于某一特征的条件概率，不透明度值大表示该灰度值属于某一特征的条件概率大。为了将条件概率从不透明度映射中分离，定义：</p><p>q ( f k | y ) = α k ( y i ) α k max ,     k = 1 , 2 , ⋯ , K (2)</p><p>其中， α k max 为对应第k个特征的最大不透明度。本文采用文献 [<xref ref-type="bibr" rid="hanspub.32849-ref8">8</xref>] 的方法，引入“空”特征类，将没有定义传递函数的部分都归入这个特征类里面，从而使概率模型完整。最终，体素的概率分类模型表示为：</p><p>p ( f k | y ) = q ( f k | y ) max ∑ k q ( f k | y ) p ( f 0 | y ) = 1 − ∑ k p ( f k | y ) (3)</p><p>其中， k = 1 , 2 , ⋯ , K ， p ( f 0 | y ) 即为上述的“空”特征类。</p><p>本文采用光线投射法实现体数据的分类可视化。该方法通过从视点向体数据引多条射线，射线在体数据内部进行重构采样，然后将采样值可视化映射为颜色和不透明度，最后将一条射线上的光学属性值进行叠加，形成这条射线最后表示的颜色和不透明度值。光线投射法不受体数据结构的限制，能够得到较好的绘制结果。</p></sec><sec id="s5"><title>3. 面向分类的核回归重构</title><p>核回归方法作为一种常用的非参数估计方法，能够很好地适应上述概率分类模型。对任意一点 x 处的重构可以表示为：</p><p>y ^ = ∑ y i ∈ Ω ω i y i (4)</p><p>其中， y ^ 为重构结果， ω i 为空间核函数， Ω 为重构的支撑域， y i 为支撑域内数据点的灰度值。式(4)表示任意一点的灰度值可以由支撑域内数据点灰度值的线性组合得到。定义空间核函数为：</p><p>ω i = 1 − Distance ( x , x i ) σ (5)</p><p>其中， Distance ( x , x i ) 表示重构点 x 与数据点 x i 的距离，一般取 Distance ( x , x i ) = ‖ x − x i ‖ 2 。</p><p>为了使核回归方法能够适应概率分类模型，本文定义特征核函数 ω f = p ( f | y i ) 。将两种核函数组合为最终的重构核，得到面向分类的核回归重构，体数据中任意一点对应特征 f 的重构灰度值为：</p><p>y ^ f = ∑ y i ∈ Ω ω i ω f y i ∑ y i ∈ Ω ω i ω f (6)</p><p>其中， ω i 体现数据点 x i 对重构点 x 的影响程度，距离重构点越近的数据点其对应的空间核函数越大，对重构的贡献越大。 ω f 体现概率分类模型对重构的影响，面向某一特征类 f ，如果数据点属于此类的条件概率越大，则该点对重构的贡献越大。</p></sec><sec id="s6"><title>4. 可视化映射</title><p>本文采用了固定支撑域的核回归重构方法，在数据密度不同的区域，重构的准确性是不同的。为了描述某一次重构的有效性，由式(6)中的两种重构核定义：</p><p>Φ ( x , f , Ω ) = ∑ y i ∈ Ω ω i ω f (7)</p><p>Φ ( x , f , Ω ) 可以描述为在特征 f 的前提下，支撑域 Ω 范围内，对位置 x 重构时的重构有效性。</p><p>为了对分类结果进行有效的可视化表达，需要将重构的属性值根据给定的传递函数映射为光学属性。对于任意的空间位置 x ，给定K个特征类，则需要对 x 进行K次重构，得到分别对应每个特征类的重构结果。本文沿用文献 [<xref ref-type="bibr" rid="hanspub.32849-ref9">9</xref>] 的方法，采用累加混合的方式得到重构点对应的光学属性值。某一条射线上的重构点，采用从后向前的合成方式：</p><p>C s = C s + ( 1 − α s ) C s r c α s = α s + ( 1 − α s ) α s r c Φ ( x , f , Ω ) (8)</p><p>其中， C s 和 α s 为累加的颜色和不透明度， C s r c 和 α s r c 为根据给定的传递函数得到的当前位置的颜色和不透明度。通过在不透明度累加中加入 Φ ( x , f , Ω ) 的权重，实现基于重构有效性的可视化映射。由于 Φ ( x , f , Ω ) 与特征相关，因此式 与重构一样也需要进行K次。</p></sec><sec id="s7"><title>5. 仿真结果及分析</title><p>为了验证本文算法的有效性，采用Tooth (数据来自GE Aircraft Engines，Evendale)和Engine (数据来自General Electric)两组数据，对比算法为基于传递函数的分类方法，均采用一维传递函数， σ = 10 。</p><p>图2. Engine数据的传递函数</p><p>Engine数据的传递函数如图2所示，基于传递函数的分类方法采用基本的最小二乘重构，传递函数对应的最大颜色值和不透明度都为1。为了对比在相同的颜色映射下的体数据分类结果，本文算法也采用图2所示的传递函数，其中不透明度映射同时定义了三个特征类。</p><p>图3. Engine数据分类可视化结果</p><p>Engine数据的可视化结果如图3所示。基于传递函数的分类可视化方法(左图)由于无法实现体素的分类，仅仅从可视化映射阶段对体数据定义的特征类进行颜色和不透明度的映射。在重构过程中产生的大量中间灰度值，使分类可视化产生类似平滑滤波的结果，不同特征之间的空间关系被模糊，特征类不能被清晰地可视化表达。本文算法(右图)由于引入了体素的概率分类模型，实现了同质区域内连续，不同物质间分离的重构结果。同时，考虑到体数据空间分布的不均匀性，构造了能够结合体素概率分类模型的重构有效性 Φ ( x , f , Ω ) 。在进行可视化映射时，结合重构有效性进行光学属性的叠加，使最终的可视化结果能够清晰地可视化表达不同特征类。</p><p>图4. Tooth数据的传递函数</p><p>对于Tooth数据，传递函数如图4所示，对应的三种特征类依次映射为红色、绿色和蓝色，相应的不透明度映射与颜色映射的对应位置相同，对于归一化后的颜色和不透明度表示，传递函数对应的最大颜色值和不透明度都为1。其中蓝色部分对应的体数据并不是有效的体数据，但为了验证算法的有效性，依然将其定义为一个特征类，但蓝色和其对应的不透明度的最大值减小为0.7。</p><p>图5. Tooth数据分类可视化结果</p><p>Tooth数据的可视化结果如图5所示。与Engine数据的可视化结果类似，基于传递函数的分类可视化结果(左图)出现了特征类结构不清晰的问题，并且可见在牙齿结构表面覆盖的一层蓝色非有效数据出现许多“毛刺”，这是由传统重构方法产生的中间灰度值进入了用户定义的传递函数范围而引起的。本文算法(右图)的绘制结果中，蓝色的物质均匀地覆盖在牙齿结构表面，并且牙齿内部不同的特征类也非常清晰地得以表达。</p></sec><sec id="s8"><title>6. 总结</title><p>本文提出了一种基于概率分类模型的体数据分类可视化方法。该方法首先利用灰度直方图中的传递函数定义了体素的概率分类模型。然后将概率分类模型引入到重构阶段中，基于核回归，实现了面向体数据分类的数据重构。最后，构造了重构有效性，并将其引入可视化映射阶段，最终得到了清晰、准确的体数据分类可视化结果。</p></sec><sec id="s9"><title>文章引用</title><p>张俊达,汤晓安. 基于概率分类模型的体数据分类可视化Volume Data Classification Visualization Based on Probabilistic Classification Model[J]. 计算机科学与应用, 2019, 09(11): 1986-1992. https://doi.org/10.12677/CSA.2019.911223</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.32849-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Tian, F., Cheng, L., and Chen, G. (2018) Transfer Function-Based 2d/3d Interactive Spatiotemporal Visualizations of Mesoscale Eddies. International Journal of Digital Earth, No. 11, 1-21. 
&lt;br&gt;https://doi.org/10.1080/17538947.2018.1543364</mixed-citation></ref><ref id="hanspub.32849-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Ma, B. and Entezari, A. (2017) Volumetric Feature-Based Classification and Visibility Analysis for Transfer Function Design. IEEE Transactions on Visualization and Computer Graphics, 24, 3253-3267.  
&lt;br&gt;https://doi.org/10.1109/TVCG.2017.2776935</mixed-citation></ref><ref id="hanspub.32849-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Lan, S.R., Wang, L.S., Song, Y.P., Wang, Y.-P., Yao, L.P., Sun, K., Xia, B. and Xu, Z. (2017) Improving Separability of Structures with Similar Attributes in 2d Transfer Function Design. IEEE Transactions on Visualization and Computer Graphics, 23, 1546-1560. &lt;br&gt;https://doi.org/10.1109/TVCG.2016.2537341</mixed-citation></ref><ref id="hanspub.32849-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Kawamura, T., Idomura, Y., Miyamura, H. and Takemiya, H. (2017) Algebraic Design of Multi-Dimensional Transfer Function Using Transfer Function Synthesizer. Journal of Visu-alization, 20, 151-162.  
&lt;br&gt;https://doi.org/10.1007/s12650-016-0387-1</mixed-citation></ref><ref id="hanspub.32849-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Mcgivney, D., Deshmane, A., Jiang, Y., Ma, D., Badve, C., Sloan, A., Gulani, V. and Griswold, M. (2018) Bayesian Estimation of Multicomponent Relaxation Parameters in Magnetic Resonance Fingerprinting. Magnetic Resonance in Medicine, 80, 159-170. &lt;br&gt;https://doi.org/10.1002/mrm.27017</mixed-citation></ref><ref id="hanspub.32849-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Iuri, P., Harald, O., Eduard, D., Christoph, G. and Joy, K. I. (2013) Cubic Gradient-Based Material Interfaces. IEEE Transactions on Visualization &amp; Computer Graphics, 19, 1687-1699. &lt;br&gt;https://doi.org/10.1109/TVCG.2013.16</mixed-citation></ref><ref id="hanspub.32849-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Liang, Z. and Hansen, C. (2013) Transfer Function Design Based on User Selected Samples for Intuitive Multivariate Volume Exploration. IEEE Pacific Visualization Symposium, 27 Feburary-1 March 2013, 73-80.</mixed-citation></ref><ref id="hanspub.32849-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Beaucoup, F. and Carraro, L. (2007) Uncertainty Visualization in Medical Volume Rendering Using Probabilistic Animation. IEEE Transactions on Visualization &amp; Computer Graphics, 13, 1648-1655.  
&lt;br&gt;https://doi.org/10.1109/TVCG.2007.70518</mixed-citation></ref><ref id="hanspub.32849-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Cai, W. and Sakas, G. (2010) Data Intermixing and Multi-Volume Rendering. Computer Graphics Forum, 18, 359-368.  
&lt;br&gt;https://doi.org/10.1111/1467-8659.00356</mixed-citation></ref></ref-list></back></article>