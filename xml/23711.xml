<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">OJCS</journal-id><journal-title-group><journal-title>Open Journal of Circuits and Systems</journal-title></journal-title-group><issn pub-type="epub">2327-0853</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/OJCS.2018.71001</article-id><article-id pub-id-type="publisher-id">OJCS-23711</article-id><article-categories><subj-group subj-group-type="heading"><subject>OJCS20180100000_57367654.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject><subject> 工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  一种移动电源的控制系统
  A Control System for Mobile Power
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>祝</surname><given-names>昌久</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>曹</surname><given-names>新亮</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>金斗</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>延安大学，物理与电子信息学院，陕西 延安</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1143854186@qq.com(祝昌)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>09</day><month>02</month><year>2018</year></pub-date><volume>07</volume><issue>01</issue><fpage>1</fpage><lpage>8</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   为了提高移动电源的实用性，使移动电源具有定时掉电和手动调压功能。阐述了STC89C52控制光耦开关定时通断的原理，讨论了升压芯片XL6009在功耗、稳压的方面的特点。采用STC89C52实现对移动电源的定时控制，通过芯片XL6009实现移动电源输出电压可调。本系统最终实现移动电源定时掉电和手动调压的功能。 In order to improve the practicability of mobile power supply that is the mobile power supply has the function of timing power drop and manual adjustment. This paper describes the principle of STC89C52 control of the time-lapse of the optical coupling switch, and discusses the characteristics of the lifting chip XL6009 in power consumption and stabilization. The STC89C52 is adopted to realize the timing control of the mobile power supply, and the output voltage of the mobile power supply can be adjusted by the chip XL6009. The system finally realizes the function of the mobile power to drop the power and manually adjust the voltage. 
  
 
</p></abstract><kwd-group><kwd>移动电源，定时开关，DC-DC，STC89C52，光电耦合, Mobile Power</kwd><kwd> Timing Switch</kwd><kwd> DC-DC</kwd><kwd> STC89C52</kwd><kwd> Optical Coupling</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>一种移动电源的控制系统<sup> </sup></title><p>祝昌久，曹新亮，李金斗</p><p>延安大学，物理与电子信息学院，陕西 延安</p><p><img src="//html.hanspub.org/file/1-2780109x1_hanspub.png" /></p><p>收稿日期：2018年1月16日；录用日期：2018年2月2日；发布日期：2018年2月9日</p><disp-formula id="hanspub.23711-formula1"><graphic xlink:href="//html.hanspub.org/file/1-2780109x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为了提高移动电源的实用性，使移动电源具有定时掉电和手动调压功能。阐述了STC89C52控制光耦开关定时通断的原理，讨论了升压芯片XL6009在功耗、稳压的方面的特点。采用STC89C52实现对移动电源的定时控制，通过芯片XL6009实现移动电源输出电压可调。本系统最终实现移动电源定时掉电和手动调压的功能。</p><p>关键词 :移动电源，定时开关，DC-DC，STC89C52，光电耦合</p><disp-formula id="hanspub.23711-formula2"><graphic xlink:href="//html.hanspub.org/file/1-2780109x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/1-2780109x7_hanspub.png" /> <img src="//html.hanspub.org/file/1-2780109x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>现如今各种小功率用电器层出不穷，其所需电压也不尽相同，运用普通移动电源为其供电时难以做到电压匹配。另外，此类用电器并不具备定时功能，所以在使用时不够人性化。如果在这些用电器上都增加一个定时开关又会大大增加制作成本 [<xref ref-type="bibr" rid="hanspub.23711-ref1">1</xref>] 。为了解决上述问题，本设计在移动电源上增加定时开关，这样在不增加这类用电器制作成本的情况下使其具有定时功能。此外，本系统在移动电源5 V、2 A的输出前端增加升压模块，使输出电压在5 V到12 V之间可调，这样就能使移动电源适用于不同电压需求的用电器 [<xref ref-type="bibr" rid="hanspub.23711-ref2">2</xref>] 。</p></sec><sec id="s4"><title>2. 系统总体设计方案</title><p>该系统以STC89C52单片机为核心处理器，通过独立按键设置定时时间并通过数码管实时显示。当到达预设时间时，单片机控制光电耦合开关断开，使得移动电源输出端停止供电 [<xref ref-type="bibr" rid="hanspub.23711-ref3">3</xref>] 。同时，在升压模块中通过调节可变电阻，使得输出电压可调。系统总体设计原理框图如图1所示。</p></sec><sec id="s5"><title>3. 系统硬件设计</title><sec id="s5_1"><title>3.1. STC89C52单片机</title><p>STC89C52是一种含8051内核，具抗干扰，高速，低功耗的增强型51单片机，指令代码完全兼容传统8051。其内部集成定时器，程序储存器，数据存储器等一系列硬件电路，可供本系统使用。以STC89C52作为中央处理器，其最小系统的外围电路简单，在使用较少元器件的情况下，能够很好的实现本系统的控制功能。为尽量减小体积，降低功耗，因此选择51系列中体积更小，功耗更低，质量更轻的LQFP-44小型封装单片机。其原理图如图2所示。</p><p>图1. 总体设计原理框图</p></sec><sec id="s5_2"><title>3.2. 定时模块电路</title><p>要实现定时功能除了需要用到单片机内部定时器外，同时，还需要外围电路支持 [<xref ref-type="bibr" rid="hanspub.23711-ref4">4</xref>] 。定时模块包括单片机最小系统电路，按键电路和显示电路，定时模块电路如图3所示。</p><p>单片机最小系统是以最少的器件构成能够让单片机工作的系统，其硬件电路包括复位电路和晶振电路等。51单片机中，时钟周期Ts = 1/Fosc，一个机器周期等于12倍的时钟周期。晶振选用12 MHZ，其</p><p>图2. STC89C52 (LQFP—44)单片机原理图</p><p>图3. 定时模块电路</p><p>时钟周期为1/12 us，机器周期为1 us，两个机器周期为2 us。因此，在复位电路中，RST引脚需连接2 us以上的高电平脉冲，才可产生复位动作。运用C1与R1组成振荡电路，产生此脉冲，其时间常数T = RC，C1选用10 uF电容，R1选用10 KΩ，时间常数为1 ms。这样，RST脚上的电压可保持2 us以上的高电平，满足系统复位。在设计中，为了方便复位操作，在电容C1上并联按键K4，实现按键手动复位操作。</p><p>定时时间的设定采用独立式按键来完成，通过单片机I/O口读取的不同电平来判断按键是否被按下。将按键的一端与单片机I/O口连接，另一端与地连接，当按键被按下时，此I/O口与地形成短路，随即该I/O口的电平被拉低。按键释放后，由于单片机内部存在上拉电阻所以I/O口仍保持在高电平状态，通过程序随时对I/O口的电平状态进行查寻从而判断按键是否按下。按键K1，K2，K3分别于P1.0，P1.1，P1.2口连接，通过独立按键实现时间自加一，从而调节倒计时时间。K1按下的时候分钟位加一，K2按下时候秒位加一，K3按下时完成时间设定，同时启动倒计时程序。</p><p>为尽量小本设计体积，降低功耗，采用四位一体共阴数码管作为动态显示，利用dp点将分钟位与秒钟位隔开。采用74HC245译码器作为数码管驱动电路，通过单片机P0口向74HC245译码器传输数据，经过译码器处理后在数码管上显示实时时间 [<xref ref-type="bibr" rid="hanspub.23711-ref5">5</xref>] 。</p></sec><sec id="s5_3"><title>3.3. 光藕开关电路</title><p>为控制移动电源输出端定时断电，本系统采用光电耦合器充当开关。光电耦合器是将发光元件和光敏元件封装同一硅片内，其中发光元件一般为发光二极管，光敏元件一般为光敏三极管。本设计将单片机RD端与光电耦合器输入端连接，RD端输出低电平时，光电耦合器输入端无电信号，发光二极管不发光，光敏三极管不导通；反之，RD端输出高电平时，发光二极管发光，光敏三极管导通。因此通过程序控制单片机RD端输出的高低电平，从而控制光电耦合器输出端是否导通进而达到定时断电的目的 [<xref ref-type="bibr" rid="hanspub.23711-ref6">6</xref>] 。如图4所示。</p><p>在本设计中运用光电耦合器控制移动电源输出端的通断，移动电源的输出最大电流为2.1 A，所以选用大电流光电耦合器AQY272，其连续负载电流为2 A，峰值负载电流为6 A，满足设计需求。因其负载峰值电流足够大，可直接将移动电源输出电压VCC直接与光电耦合器输出端相连，不需要增加额外开关器件(如继电器等)，大大简化了电路设计。</p></sec><sec id="s5_4"><title>3.4. 升压电路设计</title><p>XL6009是一款4 A开关电流的高性能(BOOST)芯片，芯片在3 V电压下即可启动，其理想输入电压</p><p>图4. 光电耦合器</p><p>在5 V至32 V，宽输出电压在5 V至35 V。内置4 A高效MOSFET管，其效率可达94%，高开关频率为40 KHZ，采用小电容即可达到很好的滤波效果。因其体积小，效率高，外围电简单，广泛用于低压升压电路中 [<xref ref-type="bibr" rid="hanspub.23711-ref7">7</xref>] 。内部结构图如图5所示，芯片引脚图如图6所示。</p><p>基于XL6009的开关型升压电路如图7所示。将移动电源的5 V输出电压经过光耦开关接到该芯片输入引脚4 (VIN)，同时，在该引脚和接地引脚1之间接入22 uF/35 V电容以消除噪声。在使能引脚2 (EN)接入5 V高电平或悬空(本设计采用悬空状态)，芯片正常工作，输出引脚3 (SW)产生输出电压。利用反馈引脚5 (FB)将输出电压设置为正电压，通过调节可变电阻R5的阻值改变反馈网络，实现输出电压在5 V到12 V之间可调。</p><p>输出电压为：</p><disp-formula id="hanspub.23711-formula3"><label>(1)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/1-2780109x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>图5. XL6009内部结构图</p><p>图6. XL6009引脚图</p><p>图7. 基于XL6009升压电路</p><p>为防止芯片被作为降压使用烧毁芯片，在R4前串联1 K电阻R3，根据输出电压公式可知理论输出电压最低为5.04 V，这样芯片就永远工作在升压电路状态。</p></sec></sec><sec id="s6"><title>4. 系统软件设计</title><p>本系统软件程序，在LIEL4环境中运用C语言代码进行编写和调试。倒计时程序，通过配置STC89C52单片机TMOD寄存器，运用定时器T0工作模式1构成定时器，同时通过六进制算法实现倒计时功能。显示程序，运用单片机并行串口在P1口进行数据发送，通过译码器驱动，实现在数码管上显示倒计时时间。按键程序运用延时函数实现按键消抖，使得按键更加准确。</p><p>默认情况下单片机RD端输出高电平，光电耦合器输出端处于导通状态，移动电源输出端可正常供电。当需要用到定时断电功能时，通过按键K1，K2调节倒计时时间，时间设定完成后，按下K3键进入倒计时程序。倒计时结束后，RD端输出低电平，光电耦合器不导通，移动电源输出端停止供电 [<xref ref-type="bibr" rid="hanspub.23711-ref8">8</xref>] 。总体程序流程图如图8所示。</p></sec><sec id="s7"><title>5. 测试结果</title><p>定时功能测试：设定10分钟自动掉电测试，连续10次按下按键K1，数码管分钟位显示10，最后按下K3键，开始倒计时，同时在数码管上实时显示剩余时间，经过十分钟移动电源切断输出。</p><p>根据公式(1)调节升压电路中可变电阻R4分别测量调压电路输入、输出端的电流与电压，测试数据如表1。</p><p>可见，调节可变电阻R4能够改变输出电压，输出电压在5 V到12 V之间可调。该升压电路转化效率在90%以上。</p></sec><sec id="s8"><title>6. 结论</title><p>本设计采用51单片机实现移动电源定时掉电控制，同时，运用升压电路实现移动电源输出电压可调。实验结果表明，定时掉电效果良好，升压电路转换效率较高。这一设计解决了移动电源在为小功率用电</p><p>图8. 系统程序流程图</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Test data table of voltage regulating circui</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >可调电阻R4 (KΩ)</th><th align="center" valign="middle" >输入电压(V)</th><th align="center" valign="middle" >输入电流(A)</th><th align="center" valign="middle" >输出电压(V)</th><th align="center" valign="middle" >输出电流(A)</th><th align="center" valign="middle" >效率(%)</th></tr></thead><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >5.04</td><td align="center" valign="middle" >1.96</td><td align="center" valign="middle" >8.62</td><td align="center" valign="middle" >1.04</td><td align="center" valign="middle" >90.6</td></tr><tr><td align="center" valign="middle" >1.5</td><td align="center" valign="middle" >4.98</td><td align="center" valign="middle" >1.94</td><td align="center" valign="middle" >10.32</td><td align="center" valign="middle" >0.87</td><td align="center" valign="middle" >91.8</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >5.01</td><td align="center" valign="middle" >1.97</td><td align="center" valign="middle" >11.64</td><td align="center" valign="middle" >0.78</td><td align="center" valign="middle" >91.2</td></tr><tr><td align="center" valign="middle" >2.5</td><td align="center" valign="middle" >4.96</td><td align="center" valign="middle" >2.03</td><td align="center" valign="middle" >13.65</td><td align="center" valign="middle" >0.67</td><td align="center" valign="middle" >90.8</td></tr></tbody></table></table-wrap><p>表1. 调压电路测试数据表</p><p>器供电时，电压不匹配和不能定时掉电的问题。系统总体设计简单，低成本，实用性强，适合移动电源的改装与生产，具有一定的运用前景。</p></sec><sec id="s9"><title>基金项目</title><p>大学生创新创业训练计划项目(编号：D2016111)。</p></sec><sec id="s10"><title>参考文献 (References)</title><p>[<xref ref-type="bibr" rid="hanspub.23711-ref1">1</xref>] 潘泽坤. 移动电源的行业现状与发展前景[J]. 广东科技, 2015, 24(6): 49-51.</p><p>[<xref ref-type="bibr" rid="hanspub.23711-ref2">2</xref>] 吴学军, 胡晗, 李文联. 一种基于低功耗单片机的移动电源设计[J]. 电源技术, 2014, 38(3): 495-497.</p><p>[<xref ref-type="bibr" rid="hanspub.23711-ref3">3</xref>] 陈中, 朱代忠. 基于STC89C52单片机的控制系统设计[M]. 北京: 清华大学出版社, 2015.</p><p>[<xref ref-type="bibr" rid="hanspub.23711-ref4">4</xref>] 何海滨. 用89C51单片机制作的简易定时器[J]. 电子制作, 2007(12): 66-67.</p><p>[<xref ref-type="bibr" rid="hanspub.23711-ref5">5</xref>] 吴振磊, 刘孝赵. 74HC595在单片机控制多位数码管中的应用[J]. 科技广场, 2013(5): 174-176.</p><p>[<xref ref-type="bibr" rid="hanspub.23711-ref6">6</xref>] 钟平, 严军保. 常用光电耦合器的功能及检测[J]. 家电检修技术, 2001(8): 39.</p><p>[<xref ref-type="bibr" rid="hanspub.23711-ref7">7</xref>] 吴兴洲, 周明珠, 李家旺. 基于XL6009开关升压稳压电源的设计[J]. 电子世界, 2014(5): 135.</p><p>[<xref ref-type="bibr" rid="hanspub.23711-ref8">8</xref>] 袁东, 朱新国. 基于51单片机典型应用30例[M]. 北京: 清华大学出版社, 2016.</p></sec></body><back><ref-list><title>References</title><ref id="hanspub.23711-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">潘泽坤. 移动电源的行业现状与发展前景[J]. 广东科技, 2015, 24(6): 49-51.</mixed-citation></ref><ref id="hanspub.23711-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">吴学军, 胡晗, 李文联. 一种基于低功耗单片机的移动电源设计[J]. 电源技术, 2014, 38(3): 495-497.</mixed-citation></ref><ref id="hanspub.23711-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">陈中, 朱代忠. 基于STC89C52单片机的控制系统设计[M]. 北京: 清华大学出版社, 2015.</mixed-citation></ref><ref id="hanspub.23711-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">何海滨. 用89C51单片机制作的简易定时器[J]. 电子制作, 2007(12): 66-67.</mixed-citation></ref><ref id="hanspub.23711-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">吴振磊, 刘孝赵. 74HC595在单片机控制多位数码管中的应用[J]. 科技广场, 2013(5): 174-176.</mixed-citation></ref><ref id="hanspub.23711-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">钟平, 严军保. 常用光电耦合器的功能及检测[J]. 家电检修技术, 2001(8): 39.</mixed-citation></ref><ref id="hanspub.23711-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">吴兴洲, 周明珠, 李家旺. 基于XL6009开关升压稳压电源的设计[J]. 电子世界, 2014(5): 135.</mixed-citation></ref><ref id="hanspub.23711-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">袁东, 朱新国. 基于51单片机典型应用30例[M]. 北京: 清华大学出版社, 2016.</mixed-citation></ref></ref-list></back></article>