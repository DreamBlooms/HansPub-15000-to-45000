<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">MOS</journal-id><journal-title-group><journal-title>Modeling and Simulation</journal-title></journal-title-group><issn pub-type="epub">2324-8696</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/MOS.2016.52007</article-id><article-id pub-id-type="publisher-id">MOS-17725</article-id><article-categories><subj-group subj-group-type="heading"><subject>MOS20160200000_69744297.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject><subject> 工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  太阳影子定位模型的研究及应用
  Research of Shadow Localization Model and Its Application
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>周</surname><given-names>倩</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>嘉瑞</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>蔡</surname><given-names>荣芳</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>丰</surname><given-names>全东</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff4"><addr-line>北京林业大学材料科学与技术学院，北京</addr-line></aff><aff id="aff3"><addr-line>北京林业大学信息学院，北京</addr-line></aff><aff id="aff2"><addr-line>北京林业大学经济管理学院，北京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><aff id="aff5"><addr-line>北京林业大学理学院，北京</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>fqd@lsec.cc.ac.cn(丰全)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>17</day><month>05</month><year>2016</year></pub-date><volume>05</volume><issue>02</issue><fpage>50</fpage><lpage>56</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  本文利用影子随着时间的变化，建立了太阳影子定位的模型。首先对视频中提取的图像进行裁剪、灰度化以及二值化的预处理，可以大大降低图像处理的计算量；其次利用透视变换，求出视频中实际的杆影长，对于受测量误差影响较大的异常数据，我们给予剔除；然后利用天文学中太阳运行轨迹相关理论，我们给出了太阳高度角，实际杆影长等的公式；最后，在已知杆长和未知杆长的情况下，把模型定位问题转化成求解经纬度和日期的非线性优化问题。通过比较，求解结果较好地吻合了实际的拍摄地点和日期。
   With the length variation of pole’s shadow, we construct a localization model. Firstly, in order to reduce the work of images processing, we preprocess the extracted images, including cutting, gray processing, binarization processing, etc. Secondly, applying perspective transform, we get the actual length of pole’s shadow in video. For some images, measurement error results in some abnormal data of pole’s length, consequently, we remove them. Thirdly, using solar paths’ related theory in astronomy, we obtain formulas of the solar elevation angle and the shadow’s length. Lastly, whether the real length of pole in video is known or not, we transform the localization model into solving the longitude, latitude, and date of the nonlinear optimization problem. By comparison, the results of the solution are in good agreement with the actual shooting location and date.
 
</p></abstract><kwd-group><kwd>影子定位，透视变换，太阳高度角，非线性优化, Shadow Localization</kwd><kwd> Perspective Transform</kwd><kwd> Solar Elevation Angle</kwd><kwd> Nonlinear Optimization</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>太阳影子定位模型的研究及应用<sup> </sup></title><p>周倩<sup>1</sup>，刘嘉瑞<sup>2</sup>，蔡荣芳<sup>3</sup>，丰全东<sup>4*</sup></p><p><sup>1</sup>北京林业大学经济管理学院，北京</p><p><sup>2</sup>北京林业大学信息学院，北京</p><p><sup>3</sup>北京林业大学材料科学与技术学院，北京</p><p><sup>4</sup>北京林业大学理学院，北京</p><disp-formula id="hanspub.17725-formula480"><graphic xlink:href="http://html.hanspub.org/file/6-2570093x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年5月4日；录用日期：2016年5月27日；发布日期：2016年5月30日</p><disp-formula id="hanspub.17725-formula481"><graphic xlink:href="http://html.hanspub.org/file/6-2570093x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文利用影子随着时间的变化，建立了太阳影子定位的模型。首先对视频中提取的图像进行裁剪、灰度化以及二值化的预处理，可以大大降低图像处理的计算量；其次利用透视变换，求出视频中实际的杆影长，对于受测量误差影响较大的异常数据，我们给予剔除；然后利用天文学中太阳运行轨迹相关理论，我们给出了太阳高度角，实际杆影长等的公式；最后，在已知杆长和未知杆长的情况下，把模型定位问题转化成求解经纬度和日期的非线性优化问题。通过比较，求解结果较好地吻合了实际的拍摄地点和日期。</p><p>关键词 :影子定位，透视变换，太阳高度角，非线性优化</p><disp-formula id="hanspub.17725-formula482"><graphic xlink:href="http://html.hanspub.org/file/6-2570093x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>随着数据业务和多媒体业务的扩展，人们对定位的需求日益增大，从最开始15世纪的路基无线电导航到现代的GPS定位、超声波定位和蓝牙定位等，定位技术获得了快速发展。为弥补传统定位技术在信号接收、网络环境和设备性能等方面的局限性 [<xref ref-type="bibr" rid="hanspub.17725-ref1">1</xref>] ，本文结合计算机视觉 [<xref ref-type="bibr" rid="hanspub.17725-ref2">2</xref>] 这一研究热点，建立了利用太阳影子变化的定位模型。通过任意一段太阳下拍摄的视频，太阳影子定位模型能利用影子的变化推算出视频拍摄地点与日期。目前国内对太阳影子定位技术的研究与记载甚少，2015年全国大学生建模竞赛A题涉及相关思路，但研究者的定位模型在图像识别和模型建立方面都存在不足，例如胡毅华 [<xref ref-type="bibr" rid="hanspub.17725-ref3">3</xref>] 、黄小卉 [<xref ref-type="bibr" rid="hanspub.17725-ref4">4</xref>] 等测量影长时未对视频图像做透视变换图像校正，朱海洋 [<xref ref-type="bibr" rid="hanspub.17725-ref5">5</xref>] 建立模型时忽略地球绕日的椭圆轨道影响，降低了模型精度。</p><p>本文首先利用Matlab软件提取视频中的图像，经过裁剪、灰度化以及二值化降低运算量后，利用透视变换校正图像，从而消除了照相机拍摄带来的视觉偏差，随后基于Hough变换的直线检测技术测算出视频中不同时刻下杆子的影长；然后利用影长与赤纬角、纬度和时角等参数的理化关系建立非线性优化模型的过程中，本文先从已知视频里杆长的情况出发，求解出视频拍摄的地点和日期，其次为提高模型的适用性，将原模型拓展到杆长未知的情况下，建立新的模型同样能求解出视频拍摄的地点与日期；最后讨论了拍摄地的大气折射率对结果的影响。</p></sec><sec id="s4"><title>2. 透视投影校正</title><sec id="s4_1"><title>2.1. 图像预处理</title><p>本文以2015年全国大学生建模竞赛A题提供视频为例 [<xref ref-type="bibr" rid="hanspub.17725-ref6">6</xref>] ，将时长为40分钟的视频导入Matlab软件，共61,022帧。若提取图像时间间隔过短时，提取的相邻图像中影子长度变化将不明显，同时计算复杂度变大，导致难以定位，而提取图像时间间隔过长时，样本数据变少，同样难以定位，因此提取图像时间间隔不宜过短或过长。本文每隔1525帧即1分钟提取视频图像，得到41张图像。由于提取的图像里面包含了大量的无效信息，我们首先对图像进行剪裁，只保留有效信息，见图1。</p><p>其次为了降低图像处理的计算量，我们对剪裁的图像先后进行灰度化和二值化处理。依据人眼对不同颜色的敏感度，将彩色图像的R、G、B三个颜色分量进行加权平均求和，可得到灰度化后的图像。本文采用Matlab中的rgb2函数进行图像灰度化 [<xref ref-type="bibr" rid="hanspub.17725-ref7">7</xref>] ，其默认的亮度方程为</p><disp-formula id="hanspub.17725-formula483"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x11_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x12_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x13_hanspub.png" xlink:type="simple"/></inline-formula>为图像各像素点的红、绿、蓝像素值。</p><p>然后对灰度化后的图像进行二值化处理，我们选择普遍采用的最大类间法 [<xref ref-type="bibr" rid="hanspub.17725-ref8">8</xref>] 。通过最大类间法，我们确定了一个二值化的阈值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x14_hanspub.png" xlink:type="simple"/></inline-formula>，当图像上的灰度值大于等于该阈值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x15_hanspub.png" xlink:type="simple"/></inline-formula>时，像素点灰度设置为255，否则为0。该方法能在不影响图像整体和局部分布的基础上呈现明显的黑白效果。最后利用形态学的开、闭操作剔除一些杂点和去除小面积形状，最终得到图2。</p></sec><sec id="s4_2"><title>2.2. 利用透视变换计算影长</title><p>以降噪后图像的左上角为坐标原点建立平面直角坐标系，利用Hough变换 [<xref ref-type="bibr" rid="hanspub.17725-ref9">9</xref>] ，检测出降噪图像中的杆影所在线段及端点坐标，由于照相机拍摄得到的物像存在视觉透视，因此不能直接根据降噪后的图像计算杆影长。降噪后的图像中，Matlab能识别出杆子底座的4个顶点及杆末端的坐标分别为A(14,137)，B(20,113)，C(123,113)，D(122,137)和E(70,125)，见图3。已知底座底面是正方形，AD平行于横坐标轴，</p><p>故在透视变化下，线段AD长度不变，从而得到A’(14,137)，B’(14,29)，C’(122,29)以及D’(122,137)。利用四对透视变换前后对坐标即可求得透视变换矩阵 [<xref ref-type="bibr" rid="hanspub.17725-ref10">10</xref>] ，本文直接调用Matlab的cp2tform函数 [<xref ref-type="bibr" rid="hanspub.17725-ref11">11</xref>] 计算出透视变换的转换矩阵Tform，进而求出不同时刻透视变换后的E'和F'的坐标，然后计算E’，F’的欧式距离便得到所需要的实际杆影长。</p></sec><sec id="s4_3"><title>2.3. 影长数据处理</title><p>经过透视变换后，我们可得到41张图片中的实际杆影长。在视频时间段内，杆影长是逐渐减少的，</p><p>图1. 图像裁剪效果</p><p>图2. 降噪后的图像</p><p>如图4所示。因为短期内影长变化微小扩大了误差的影响，导致图4中存在部分异常点，为了保证模型的可靠性，我们需要剔除这些异常点。最终保留41个影长中的前10个与后12个，共22个数据作为有效杆影长数据，用于后续的非线性优化求解。</p></sec></sec><sec id="s5"><title>3. 模型建立与求解</title><sec id="s5_1"><title>3.1. 杆长已知日期未知求解地点</title><p>在现实生活中要在视频拍摄地寻找一个已知高度的物体并非难事，并且通常能轻易获知当时日期，部分相机拍摄时也会在视频上体现拍摄日期，但是也会经常遇到搜集的视频没有拍摄时间记载的情况，因此建立一个杆长已知，拍摄日期未知，求解拍摄地经纬度的模型具有一定现实意义。本例视频中杆长为2米，拍摄日期为7月13日，我们在假设日期未知的情况下建立模型，模型的目标函数和约束条件需涉及太阳高度角、赤纬角、时角、时差、本地太阳时等相关天文物理参数。</p><p>首先给出太阳高度角的公式 [<xref ref-type="bibr" rid="hanspub.17725-ref12">12</xref>] ：</p><disp-formula id="hanspub.17725-formula484"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x18_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x19_hanspub.png" xlink:type="simple"/></inline-formula>为高度角，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x20_hanspub.png" xlink:type="simple"/></inline-formula>为赤纬角，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x21_hanspub.png" xlink:type="simple"/></inline-formula>为纬度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x22_hanspub.png" xlink:type="simple"/></inline-formula>为太阳时角，而赤纬角<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x23_hanspub.png" xlink:type="simple"/></inline-formula>近似公式 [<xref ref-type="bibr" rid="hanspub.17725-ref13">13</xref>] 为：</p><disp-formula id="hanspub.17725-formula485"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x24_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x25_hanspub.png" xlink:type="simple"/></inline-formula>为自1月1日算起的累计日。</p><p>时角<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x26_hanspub.png" xlink:type="simple"/></inline-formula>的计算公式 [<xref ref-type="bibr" rid="hanspub.17725-ref14">14</xref>] 为：</p><p>图3. 透视变换示意图</p><p>图4. 影长随时间的变化</p><disp-formula id="hanspub.17725-formula486"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x30_hanspub.png" xlink:type="simple"/></inline-formula>为本地太阳时，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x31_hanspub.png" xlink:type="simple"/></inline-formula>为正表示偏东，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x32_hanspub.png" xlink:type="simple"/></inline-formula>为负表示偏西。通常<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x33_hanspub.png" xlink:type="simple"/></inline-formula>可用本地时<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x34_hanspub.png" xlink:type="simple"/></inline-formula>代替，但本地时与本地太阳时因为地球自转和人为调整等因素存在差异，故本文利用调整公式计算精度更高的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x35_hanspub.png" xlink:type="simple"/></inline-formula>：</p><disp-formula id="hanspub.17725-formula487"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x36_hanspub.png"  xlink:type="simple"/></disp-formula><p>上式中本地时<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x37_hanspub.png" xlink:type="simple"/></inline-formula>可由视频中提供的拍摄时对应的北京时间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x38_hanspub.png" xlink:type="simple"/></inline-formula>和拍摄地经度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x39_hanspub.png" xlink:type="simple"/></inline-formula>转换得到</p><disp-formula id="hanspub.17725-formula488"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x40_hanspub.png"  xlink:type="simple"/></disp-formula><p>而时差<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x41_hanspub.png" xlink:type="simple"/></inline-formula>的近似公式 [<xref ref-type="bibr" rid="hanspub.17725-ref15">15</xref>] 为：</p><disp-formula id="hanspub.17725-formula489"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x42_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17725-formula490"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x43_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据太阳影长和折射后的太阳高度角的几何关系可以得到太阳影子的长度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x44_hanspub.png" xlink:type="simple"/></inline-formula>为</p><disp-formula id="hanspub.17725-formula491"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x45_hanspub.png"  xlink:type="simple"/></disp-formula><p>在已知杆长<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x46_hanspub.png" xlink:type="simple"/></inline-formula>为2米，得到实际的太阳影长<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x47_hanspub.png" xlink:type="simple"/></inline-formula>是关于本地时<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x48_hanspub.png" xlink:type="simple"/></inline-formula>，经度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x49_hanspub.png" xlink:type="simple"/></inline-formula>，纬度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x50_hanspub.png" xlink:type="simple"/></inline-formula>和累积日<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x51_hanspub.png" xlink:type="simple"/></inline-formula>的函数，即</p><disp-formula id="hanspub.17725-formula492"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x52_hanspub.png"  xlink:type="simple"/></disp-formula><p>因此模型定位问题可转化为求解非线性优化问题，其中目标函数为：</p><disp-formula id="hanspub.17725-formula493"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x53_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x54_hanspub.png" xlink:type="simple"/></inline-formula>为论文2.3部分得到的不同时刻<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x55_hanspub.png" xlink:type="simple"/></inline-formula>对应的实际杆影长，共22个数据，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x56_hanspub.png" xlink:type="simple"/></inline-formula>为由公式(10)得到的理论值，即：</p><disp-formula id="hanspub.17725-formula494"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x57_hanspub.png"  xlink:type="simple"/></disp-formula><p>而关于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x58_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x59_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x60_hanspub.png" xlink:type="simple"/></inline-formula>的约束条件为：</p><disp-formula id="hanspub.17725-formula495"><graphic xlink:href="http://html.hanspub.org/file/6-2570093x61_hanspub.png"  xlink:type="simple"/></disp-formula><p>使用变步长搜索法、拟牛顿法以及lingo软件都可以解出以上非线性优化问题，最终得最优解为：</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x62_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>即拍摄地点为内蒙古鄂尔多斯(E109.9727˚, N39.0051˚)，比较吻合实际拍摄地点，而对应日期为7月12日，与真正的日期相差一天，关于日期结果的相对误差为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x63_hanspub.png" xlink:type="simple"/></inline-formula>，也比较接近拍摄日期。结果的误差主要来自于剔除部分异常的杆影长数据，测量有一定的误差等，这些最终都对结果有稍微的影响。</p></sec><sec id="s5_2"><title>3.2. 杆长和日期未知求地点</title><p>当拍摄的视频没有杆长的信息，或者视频从他处获得，持有者对视频中对象了解较少时，需要重新建立模型。上述情况对应于杆长和时间信息未知，确定拍摄地点和时间的模型。</p><p>由太阳高度角公式(2)可计算出正切值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x64_hanspub.png" xlink:type="simple"/></inline-formula>，也是关于本地时<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x65_hanspub.png" xlink:type="simple"/></inline-formula>，经度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x66_hanspub.png" xlink:type="simple"/></inline-formula>，纬度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x67_hanspub.png" xlink:type="simple"/></inline-formula>和累积日<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x68_hanspub.png" xlink:type="simple"/></inline-formula>的函数，即：</p><disp-formula id="hanspub.17725-formula496"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x69_hanspub.png"  xlink:type="simple"/></disp-formula><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x70_hanspub.png" xlink:type="simple"/></inline-formula>函数实际上应该等于杆长与影长之比，由本文2部分，利用透视变换我们可以求得实际杆长，以及筛选得到的22个杆影长数据，于是便得到相应的22个的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x71_hanspub.png" xlink:type="simple"/></inline-formula>。由此杆长和日期未知的模型定位问题便转化为下列非线性优化模型，其中目标函数为：</p><disp-formula id="hanspub.17725-formula497"><label>(14)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x72_hanspub.png"  xlink:type="simple"/></disp-formula><p>约束条件为：</p><disp-formula id="hanspub.17725-formula498"><graphic xlink:href="http://html.hanspub.org/file/6-2570093x73_hanspub.png"  xlink:type="simple"/></disp-formula><p>求解得到：</p><disp-formula id="hanspub.17725-formula499"><graphic xlink:href="http://html.hanspub.org/file/6-2570093x74_hanspub.png"  xlink:type="simple"/></disp-formula><p>这与实际拍摄地点内蒙古自治区鄂尔多斯的经纬度非常吻合，而求解的对应日期仍然为7月12日，与实际的日期也比价接近。与3.1部分类似，剔除部分异常的杆影长数据，测量本身存在一定的误差等导致对结果有稍微的影响。</p></sec></sec><sec id="s6"><title>4. 模型的进一步讨论</title><p>为了进一步提高模型精度，考虑大气折射率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x75_hanspub.png" xlink:type="simple"/></inline-formula>对太阳高度角的影响，原太阳高度角为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x76_hanspub.png" xlink:type="simple"/></inline-formula>，经过折射后，太阳高度角为角<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x77_hanspub.png" xlink:type="simple"/></inline-formula>，如图5。</p><p>若设大气层的折射率为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x78_hanspub.png" xlink:type="simple"/></inline-formula>，则可得：</p><disp-formula id="hanspub.17725-formula500"><label>(15)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x79_hanspub.png"  xlink:type="simple"/></disp-formula><p>而大气层折射率近似的计算公式 [<xref ref-type="bibr" rid="hanspub.17725-ref16">16</xref>] 为：</p><disp-formula id="hanspub.17725-formula501"><label>(16)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2570093x80_hanspub.png"  xlink:type="simple"/></disp-formula><p>图5. 太阳折射角示意图</p><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x82_hanspub.png" xlink:type="simple"/></inline-formula>为该点的大气压，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x83_hanspub.png" xlink:type="simple"/></inline-formula>为温度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x84_hanspub.png" xlink:type="simple"/></inline-formula>为相对温度。根据中国天气网，鄂尔多斯在2015年7月13日气温为18℃~29℃，视频拍摄时为8点54分到9点34分，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x85_hanspub.png" xlink:type="simple"/></inline-formula>取20℃，气压为895.6 hpa，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x86_hanspub.png" xlink:type="simple"/></inline-formula>为37%，得<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2570093x87_hanspub.png" xlink:type="simple"/></inline-formula>，说明当天鄂尔多斯地区大气折射作用非常弱，可以忽略不计。</p><sec id="s6_1"><title>5. 结论和评价</title><p>本文利用影子随着时间的变化，建立了太阳影子定位的模型。在已知杆长和未知杆长的情况下，把模型定位问题转化成求解拍摄地点的经纬度和拍摄日期的非线性优化问题。通过比较，求解的结果较好地吻合了实际的拍摄地点和日期。</p><p>在模型中，视频图像是否经过透视校正，本地太阳时与时差的模拟计算公式选择以及是否考虑不同地区大气折射率的差异都将对模型结果的精确程度产生影响，本文综合考虑了上述影响因素，得到了较为理想的结果。另外测量误差，剔除异常数据，求解优化模型等环节也不可避免地会影响最终的结果。</p></sec></sec><sec id="s7"><title>基金项目</title><p>北京高等学校“青年英才计划”(YETP0769)，国家自然科学基金(61571002, 61370193)。</p></sec><sec id="s8"><title>文章引用</title><p>周倩,刘嘉瑞,蔡荣芳,丰全东. 太阳影子定位模型的研究及应用 Research of Shadow Localization Model and Its Application[J]. 建模与仿真, 2016, 05(02): 50-56. http://dx.doi.org/10.12677/MOS.2016.52007</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.17725-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">袁正午, 褚静静, 邓思兵, 黄冬黎, 叶玮. 移动终端定位技术发展现状与趋势[J]. 计算机应用研究, 2007, 24(11): 1-5, 14.</mixed-citation></ref><ref id="hanspub.17725-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Hanek, R. and Schmitt, T. (2000) Vision-Based Localization and Data Fusion in a System of Cooperating Mobile Robots. 2000 IEEE/RSJ International Conference on Intelligent Robots and Systems, 2, 1199-1204.</mixed-citation></ref><ref id="hanspub.17725-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">胡毅华, 杨旭龙, 刘媛萍. 太阳影子定位模型的构建[J]. 洛阳师范学院学报, 2015(11): 13-18..</mixed-citation></ref><ref id="hanspub.17725-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">黄小卉, 朱家明, 翁瑾, 方婷婷. 基于时空角度对太阳影子定位技术的研究[J]. 齐齐哈尔大学学报(自然科学版), 2016(1): 68-72..</mixed-citation></ref><ref id="hanspub.17725-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">朱海洋, 张梦祺. 太阳影子定位算法在视频数据分析中的应用[J]. 信息通信, 2015(12): 29-30.</mixed-citation></ref><ref id="hanspub.17725-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">全国大学生数学建模竞赛[EB/OL]. http://www.mcm.edu.cn, 2015-9-12.</mixed-citation></ref><ref id="hanspub.17725-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Lee, T.H., Kim, B.K. and Song, W.J. (2010) Converting Color Images to Grayscale Images by Reducing Dimensions.  Optical Engineering, 49, 057006-057006-7. &lt;br&gt;http://dx.doi.org/10.1117/1.3431688</mixed-citation></ref><ref id="hanspub.17725-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">吕行军, 韩宪忠, 王克俭, 等. 基于最大方差阈值法的火车票图像二值化处理[J]. 计算机应用与软件, 2012, 29(7): 249-253.</mixed-citation></ref><ref id="hanspub.17725-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">陈高华, 卓东风, 夏锡瑞. 基于Hough变换直线检测中的峰值提取[J]. 太原科技大学学报, 2006, 27(4): 256-258.</mixed-citation></ref><ref id="hanspub.17725-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">何援军. 透视和透视投影变换——论图形变换和投影的若干问题之三[J]. 计算机辅助设计与图形学学报, 2005, 17(4): 734-739.</mixed-citation></ref><ref id="hanspub.17725-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">罗倩倩. Matlab在数字图像处理中的应用[J]. 伺服控制, 2011, 3(5): 49-52.</mixed-citation></ref><ref id="hanspub.17725-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">PV Education (2013) The Sun’s Position. http://www.pveducation.org/pvcdrom/properties-of-sunlight/suns-position</mixed-citation></ref><ref id="hanspub.17725-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">PV Education (2013) Elevation Angle. http://www.pveducation.org/pvcdrom/properties-of-sunlight/elevation-angle</mixed-citation></ref><ref id="hanspub.17725-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Wikipedia (2013) Hour Angle. https://en.wikipedia.org/wiki/Hour_angle</mixed-citation></ref><ref id="hanspub.17725-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Wikipedia (2013) Equation of Time. https://en.wikipedia.org/w/index.php?title=Equation_of_time&amp;oldid=664315122</mixed-citation></ref><ref id="hanspub.17725-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">刘海宁, 李真, 张国雄. 以相对湿度为参量的大气折射率计算公式[J]. 应用激光, 2000, 20(1): 13-15.</mixed-citation></ref></ref-list></back></article>