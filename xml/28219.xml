<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2018.812207</article-id><article-id pub-id-type="publisher-id">CSA-28219</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20181200000_96606068.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于蓝牙的U盘智能控制系统设计与实现
  Design and Implementation of a New USB Control System Based on Bluetooth Wireless Communication
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>昊坤</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>null</addr-line></aff><aff id="aff2"><label>1</label><addr-line>招远市第一中学，山东 招远</addr-line></aff><pub-date pub-type="epub"><day>13</day><month>12</month><year>2018</year></pub-date><volume>08</volume><issue>12</issue><fpage>1862</fpage><lpage>1869</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   随着移动互联网数据时代的到来，信息和知识的快速传播和便携储存受到前所未有的挑战，对数据的处理需要更加智能。本文提出一种基于蓝牙的U盘控制系统，设计了基于蓝牙4.0协议的低功耗传输模块和电源管理模块，由USB控制模块作为主控，并通过扩展外围电路实现对U盘的控制和访问。本系统实现了智能手机与不带OTG接口的U盘可以通过蓝牙技术进行通信，方便人们浏览、拷贝粘贴U盘里的文件，大大提高工作效率。辅以多平台、多功能、自主研发的手机APP和微信小程序，具有广泛的发展及应用前景。 With the advent of the mobile Internet data era, the rapid dissemination of information and knowledge and the requirement of portable storage are facing unprecedented challenges, and the processing of data needs to be more intelligent. A new control system using Bluetooth wireless communication technology for viewing, copying, pasting files in USB storage devices through smart phones is proposed, which helps people work more efficiently and conveniently. The system consists of a low power Bluetooth module, an USB control module and a power management module, and it performs well on energy consumption and portable size. Custom APP and Wechat extension are also designed for this system. The system has high value and board application on research and industry levels. 
  
 
</p></abstract><kwd-group><kwd>蓝牙，U盘，无线传输，USB控制系统, Bluetooth</kwd><kwd> USB Storage Devices</kwd><kwd> Wireless Communication</kwd><kwd> USB Control System</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于蓝牙的U盘智能控制系统设计与实现<sup> </sup></title><p>李昊坤</p><p>招远市第一中学，山东 招远</p><p><img src="//html.hanspub.org/file/10-1541231x1_hanspub.png" /></p><p>收稿日期：2018年12月7日；录用日期：2018年12月20日；发布日期：2018年12月27日</p><disp-formula id="hanspub.28219-formula10"><graphic xlink:href="//html.hanspub.org/file/10-1541231x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>随着移动互联网数据时代的到来，信息和知识的快速传播和便携储存受到前所未有的挑战，对数据的处理需要更加智能。本文提出一种基于蓝牙的U盘控制系统，设计了基于蓝牙4.0协议的低功耗传输模块和电源管理模块，由USB控制模块作为主控，并通过扩展外围电路实现对U盘的控制和访问。本系统实现了智能手机与不带OTG接口的U盘可以通过蓝牙技术进行通信，方便人们浏览、拷贝粘贴U盘里的文件，大大提高工作效率。辅以多平台、多功能、自主研发的手机APP和微信小程序，具有广泛的发展及应用前景。</p><p>关键词 :蓝牙，U盘，无线传输，USB控制系统</p><disp-formula id="hanspub.28219-formula11"><graphic xlink:href="//html.hanspub.org/file/10-1541231x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by author and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/10-1541231x7_hanspub.png" /> <img src="//html.hanspub.org/file/10-1541231x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着数据时代的到来和人们生活、工作节奏的加快，智能手机成为连接人与人、人与知识、人与数据的重要工具。通过数据线用电脑读取USB存储设备中资料的这种传统方法存在几点不足，一是数据线收纳起来比较麻烦，二来线缆传输比较局限，对设备的接口也有要求 [<xref ref-type="bibr" rid="hanspub.28219-ref1">1</xref>] ，三是时刻随身携带电脑不太可行，不能满足人们随时查看资料的需要。</p><p>目前，基于蓝牙和USB OTG访问的大容量存储设备的研究相对比较独立，王振铎 [<xref ref-type="bibr" rid="hanspub.28219-ref2">2</xref>] 、幸联星 [<xref ref-type="bibr" rid="hanspub.28219-ref3">3</xref>] 等人设计实现了安全防护和智能控制等含有蓝牙模块的硬件、软件系统；王宽方 [<xref ref-type="bibr" rid="hanspub.28219-ref4">4</xref>] 研究了手持监测终端的USB OTG技术的应用。专利号为CN201320664049.8的中国专利首次公开了一种U盘和蓝牙的桥接器，它由MCU模块、蓝牙模块、开关控制模块、电压调节和充电管理模块、可充电纽扣电池、液晶显示模块、USB A型插头、USB A型插座等组成 [<xref ref-type="bibr" rid="hanspub.28219-ref5">5</xref>] 。可使U盘、U盾等USB设备通过蓝牙网络在手机等移动便携设备中使用。但由于有MCU和液晶显示模块的存在，该实用新型虽然可以访问的USB设备种类比较多，但功耗、体积和成本也会增大，不方便携带。很多情况下人们身边只有智能手机和不带OTG接口的普通U盘，想随时随地浏览和访问U盘内的文件比较麻烦，因此急需一种便携、低成本的基于蓝牙的U盘控制系统来解决这个问题。</p><p>本文提出的基于蓝牙的U盘控制系统可以使得智能手机与不带OTG接口的U盘可以通过蓝牙技术进行通信，方便人们浏览、拷贝粘贴U盘里的文件，大大提高工作效率。文中首先介绍了蓝牙技术和系统概述，然后阐述了系统各模块的设计，介绍了系统功能，最后介绍了系统的应用前景。</p></sec><sec id="s4"><title>2. 基于蓝牙技术的U盘控制系统</title><p>蓝牙技术是一种无线数据与语音通信的开放性全球规范，它以低成本的短距离无线通信为基础，为固定与移动设备的通信环境提供特别连接的通信技术。蓝牙采用分散式网络结构以及快跳频和短包技术，支持点对点及点对多点通信，工作在全球通用的2.4 GHz ISM频段，其数据速率为1 Mbps，采用时分双工传输方案实现全双工传输。作为一种短距离无线通信协议，蓝牙技术具有低成本、低功耗、高速率、方便灵活等特点，能在包括智能手机、无线耳机、笔记本电脑、相关外设等众多设备之间进行无线信息交换。利用蓝牙技术，能够有效地简化移动通信终端设备之间的通信，也能够成功地简化设备与因特网Internet之间的通信，从而数据传输变得更加迅速高效，为无线通信拓宽道路 [<xref ref-type="bibr" rid="hanspub.28219-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.28219-ref7">7</xref>] 。</p><p>为了实现智能手机通过蓝牙协议直接浏览和访问普通U盘内的文件，从而研制了包括低功耗蓝牙模块、USB控制模块和电源管理模块组成的便携式低成本蓝牙U盘控制系统。整个系统的示意图如图1所示，普通U盘插入本文设计的U盘控制器，通过蓝牙协议与智能手机无线连接；智能手机上的APP或者微信小程序可以直接浏览访问U盘里的数据文件。</p><p>图1. 基于蓝牙的U盘控制系统示意图</p></sec><sec id="s5"><title>3. 系统硬件设计与实现</title><p>基于蓝牙的U盘控制系统分为软硬件两大部分。软件包括手机APP程序或微信小程序；硬件主要是蓝牙U盘控制器。</p><p>蓝牙U盘控制器在设计上划分成三个功能模块，包括：低功耗蓝牙模块、USB控制模块和电源管理模块。蓝牙U盘控制系统要满足低功耗、低成本、便携的要求，因此在设计上针对上述要求进行了优化处理。蓝牙U盘控制器的功能框图如图2所示。</p><p>图2. 蓝牙U盘控制器功能框图</p><sec id="s5_1"><title>3.1. 低功耗蓝牙模块</title><p>在与智能手机进行无线通信的协议中，蓝牙协议属于低功耗的一种协议，而且目前基于蓝牙的设备比较成熟 [<xref ref-type="bibr" rid="hanspub.28219-ref8">8</xref>] 。因此，本文基于低功耗蓝牙模块JDY-10进行了设计实现。JDY-10透传模块是基于蓝牙4.0协议标准，工作频段为2.4 GHz范围，调制方式为GFSK，最大发射功率为8 dB，最大发射距离80米，具有功耗低、尺寸小、信号强、数据传输稳定等特性。JDY-10的实物图如图3所示。</p><p>图3. 蓝牙模块实物图</p><p>JDY-10模块使用起来比较简单，通过异步串口UART的TXD和RXD信号就可实现跟其他设备异步串口双向数据通信 [<xref ref-type="bibr" rid="hanspub.28219-ref9">9</xref>] 。该模块的原理图如图4所示。通过给该模块供3.3 V直流电源就可以工作，而且可以手动控制PWRC管脚打开或关闭本模块，以达到低功耗的要求。</p><p>图4. 蓝牙模块的原理图</p></sec><sec id="s5_2"><title>3.2. USB控制模块</title><p>USB控制模块在设计上选择了性价比高的CH376芯片作为主控芯片，通过扩展外围电路实现对U盘的控制和访问，其主要性能和特点如下：</p><p>1) CH376是文件管理控制芯片，用于单片机系统读写U盘或者SD卡中的文件。</p><p>2) 支持USB设备方式和USB主机方式，并且内置了USB通讯协议的基本固件，内置了处理Mass-Storage海量存储设备的专用通讯协议的固件 [<xref ref-type="bibr" rid="hanspub.28219-ref10">10</xref>] ，内置了SD卡的通讯接口固件，内置了FAT16和FAT32以及FAT12文件系统的管理固件，支持常用的USB存储设备(包括U盘/USB硬盘/USB闪存盘/USB读卡器)和SD卡(包括标准容量SD卡和高容量HC-SD卡以及协议兼容的MMC卡和TF卡)。</p><p>3) CH376支持三种通讯接口：8位并口、SPI接口或者异步串口，各种控制器可以通过上述任何一种通讯接口控制CH376芯片，存取U盘或者SD卡中的文件 [<xref ref-type="bibr" rid="hanspub.28219-ref11">11</xref>] 。</p><p>CH376的功能框图如图5所示。CH376芯片通过三种接口可以方便的让各种控制器访问USB设备或SD设备。本文设计当中只使用了其异步串口接口，通过蓝牙模块JDY-10的异步串口直接接到CH376上，将蓝牙模块设置为透传模式，这样手机APP可以直接访问U盘。实际的USB控制模块原理图如图6所示。</p><p>图5. USB控制模块功能框图</p><p>图6. USB控制模块原理图</p></sec><sec id="s5_3"><title>3.3. 电源管理模块</title><p>电源管理模块包括微型锂电池、电源开关、充电管理单元、电量指示灯和MicroUSB充电接口。其中锂电池充电管理单元选用了低功耗高集成度的LTC4001芯片，最大充电电流2A，具有电池短路检测、适宜温度充电判定和过压保护等功能，其电路设计如图7所示 [<xref ref-type="bibr" rid="hanspub.28219-ref12">12</xref>] 。</p><p>图7. 电源管理模块原理图</p></sec></sec><sec id="s6"><title>4. 系统软件设计及实验分析</title><p>系统软件包括手机端的APP应用程序或微信小程序。本文以APP应用程序为例来说明系统的软件。APP应用程序可以基于IOS也可以基于安卓，主要功能包含了底层驱动程序、用户接口API函数、顶层用户功能三层结构(图8)。</p><p>图8. 手机端软件功能层</p><p>目前通过在安卓智能手机上开发的APP程序可以浏览、访问普通U盘中的文件，同时具有蓝牙U盘控制器设备远离报警、电量监控等特殊功能，如图9所示。</p><p>经实验测试，通过蓝牙u盘访问文件时间如表1所示。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Access time test result</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >测试项目(KB)</th><th align="center" valign="middle" >访问时间(s)</th><th align="center" valign="middle" >测试项目(KB)</th><th align="center" valign="middle" >访问时间(s)</th></tr></thead><tr><td align="center" valign="middle" >图片98 KB</td><td align="center" valign="middle" >0.1 s</td><td align="center" valign="middle" >文档253 KB</td><td align="center" valign="middle" >0.2 s</td></tr><tr><td align="center" valign="middle" >图片98 KB</td><td align="center" valign="middle" >0.1 s</td><td align="center" valign="middle" >文档3 M</td><td align="center" valign="middle" >1.3 s</td></tr><tr><td align="center" valign="middle" >音频4.2 M</td><td align="center" valign="middle" >2.1 s</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >音频11.2 M</td><td align="center" valign="middle" >5.2 s</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表1. 软件测试结果——文件访问时间</p><p>实验所测传输时间略大于蓝牙4.0协议的3 M/s (对应24 mbps)的传输时间，原因是本方案采用了蓝牙轮训机制而非中断机制。</p><p>图9. 专用APP截图</p></sec><sec id="s7"><title>5. 应用前景与未来研究方向</title><p>本系统设计了由蓝牙传输模块、USB控制模块、电源管理模块的硬件系统，自主开发了APP软件程序，通过实验测试实现了对图片、文档、音频的便捷传输。基于蓝牙的U盘控制系统在研究和工业领域均有较大研究价值和应用前景。数据化、快速化是社会发展趋势，无线、便携、低功耗的基于蓝牙的U盘控制系统改变了传统数据读取方式，具有大批量生产、广泛运用的市场需求。此外，本系统可以通过APP和微信小程序进行更新扩展，可根据用户需要增加最时兴的功能，比如未来会增加文件标注，一键式邮件分享等功能。在蓝牙技术发展方面，以下几个方面还可进行深入研究：进一步提高数据传输的性能，降低传输的能耗，增强网络的可扩展性和降低蓝牙设备的连接时间。</p></sec><sec id="s8"><title>文章引用</title><p>李昊坤. 基于蓝牙的U盘智能控制系统设计与实现Design and Implementation of a New USB Control System Based on Bluetooth Wireless Communication[J]. 计算机科学与应用, 2018, 08(12): 1862-1869. https://doi.org/10.12677/CSA.2018.812207</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.28219-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">王义乔. 办公达人之无线传输的七种武器移动设备之间的无线传输应用[J]. 数码世界, 2013(4): 132-135.</mixed-citation></ref><ref id="hanspub.28219-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">王振铎, 王振辉, 边倩. 一种U盘安全防护系统[J]. 自动化技术与应用, 2018, 37(6): 31-35.</mixed-citation></ref><ref id="hanspub.28219-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">幸联星. 基于单片机无线控制智能台灯设计[J]. 电子制作, 2018(19): 28-31+99.</mixed-citation></ref><ref id="hanspub.28219-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">王宽方. USB OTG技术在手持式水质监测仪中的研究应用[D]: [硕士学位论文]. 郑州: 华北水利水电大学, 2016.</mixed-citation></ref><ref id="hanspub.28219-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">江艳玲. 一种USB和蓝牙设备桥接器[P]. 中国专利, CN 203574207 U, 2014.</mixed-citation></ref><ref id="hanspub.28219-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">徐金苟. 蓝牙4. 0底层核心技术协议研究与实现[D]: [硕士学位论文]. 上海: 上海交通大学, 2012.</mixed-citation></ref><ref id="hanspub.28219-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Conti, M. and Moretti, D. (2005) System Level Analysis of the Bluetooth Standard. Design, Automation and Test in Europe, Munich, 7-11 March 2005, 118-123. &lt;br&gt;https://doi.org/10.1109/DATE.2005.288</mixed-citation></ref><ref id="hanspub.28219-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Mal’Kov, P., Elyagin, S., Dement’ev, V., et al. (2015) The Using of Bluetooth 4.0 Technologies for Communication with Territorial-Distributed Devices. International Conference on Next Generation Wired/Wireless Networking, 518-528. &lt;br&gt;https://doi.org/10.1007/978-3-319-23126-6_45</mixed-citation></ref><ref id="hanspub.28219-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Yu, B., Xu, L. and Li, Y. (2012) Bluetooth Low En-ergy (BLE) Based Mobile Electrocardiogram Monitoring System. 2012 IEEE International Conference on Information and Automation, Shenyang, 6-8 June 2012, 763-767.  
&lt;br&gt;https://doi.org/10.1109/ICInfA.2012.6246921</mixed-citation></ref><ref id="hanspub.28219-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">朱晓宇. 嵌入式系统中USB海量存储设备的设计与实现[D]: [硕士学位论文]. 成都: 电子科技大学, 2009.</mixed-citation></ref><ref id="hanspub.28219-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">张亮, 李杰, 张天佑. USB接口芯片CH376在专用控制系统中的应用[J]. 兵工自动化, 2014(3): 51-53.</mixed-citation></ref><ref id="hanspub.28219-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">LTC4001-1-2A Synchronous Buck Li-Ion Charger. Analog Devices.  
&lt;br&gt;https://www.analog.com/media/en/technical-documentation/data-sheets/40011fa.pdf</mixed-citation></ref></ref-list></back></article>