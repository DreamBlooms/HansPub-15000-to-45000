<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">IaE</journal-id><journal-title-group><journal-title>Instrumentation and Equipments</journal-title></journal-title-group><issn pub-type="epub">2332-6980</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/IaE.2019.72012</article-id><article-id pub-id-type="publisher-id">IaE-30650</article-id><article-categories><subj-group subj-group-type="heading"><subject>IaE20190200000_95457563.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于心电脉搏的无创连续血压检测系统的设计
  Design of Noninvasive Continuous Blood Pressure Detection System Based on ECG and Pulse
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>唐</surname><given-names>陶波</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>施</surname><given-names>亦旸</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>邓</surname><given-names>艳军</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>晓红</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>经州</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>春伟</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff4"><addr-line>杭州电子科技大学浙江省杭电智慧城市研究中心，浙江 杭州</addr-line></aff><aff id="aff3"><addr-line>中国电信浙江省分公司，浙江 杭州</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><aff id="aff1"><addr-line>杭州电子科技大学电子信息学院，浙江 杭州</addr-line></aff><pub-date pub-type="epub"><day>03</day><month>06</month><year>2019</year></pub-date><volume>07</volume><issue>02</issue><fpage>79</fpage><lpage>85</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   本文根据血压连续监测需求，设计并实施了一套基于心电脉搏的无创连续血压检测系统。采用硬件终端 + 手机APP的监护模式，硬件终端实现心电与脉搏信号采集与处理；手机APP实现对心电、脉搏信号的特征点识别，建立血压测量模型，获取脉搏传导时间，计算得到血压值。本系统有效的实现无创连续血压测量，为高血压疾病的治疗与预防提供了一种有效的解决方案。 In this paper, based on the continuous monitoring of blood pressure, a set of non-invasive contin-uous blood pressure detection system based on ECG and pulse was designed and implemented. Adopting the monitoring mode of hardware terminal + mobile APP, hardware terminal realizes ECG and pulse signal acquisition and processing; mobile APP realizes the recognition of characteristic points of ECG and pulse signal, establishes blood pressure model, then calculates pulse transit time, and finally calculates blood pressure value. The system effectively achieves non-invasive continuous blood pressure measurement, and provides an effective solution for the treatment and prevention of hypertension diseases. 
 
</p></abstract><kwd-group><kwd>血压，脉搏波传导时间，心电，脉搏, Blood Pressure</kwd><kwd> Pulse Wave Transit Time</kwd><kwd> ECG</kwd><kwd> Pulse</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于心电脉搏的无创连续血压检测系统的设计<sup> </sup></title><p>唐陶波<sup>1</sup>，施亦旸<sup>2</sup>，邓艳军<sup>1</sup>，张晓红<sup>1</sup>，黄经州<sup>3</sup>，郭春伟<sup>3</sup></p><p><sup>1</sup>杭州电子科技大学电子信息学院，浙江 杭州</p><p><sup>2</sup>中国电信浙江省分公司，浙江 杭州</p><p><sup>3</sup>杭州电子科技大学浙江省杭电智慧城市研究中心，浙江 杭州</p><p><img src="//html.hanspub.org/file/2-2990236x1_hanspub.png" /></p><p>收稿日期：2019年5月10日；录用日期：2019年5月29日；发布日期：2019年6月5日</p><disp-formula id="hanspub.30650-formula8"><graphic xlink:href="//html.hanspub.org/file/2-2990236x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文根据血压连续监测需求，设计并实施了一套基于心电脉搏的无创连续血压检测系统。采用硬件终端 + 手机APP的监护模式，硬件终端实现心电与脉搏信号采集与处理；手机APP实现对心电、脉搏信号的特征点识别，建立血压测量模型，获取脉搏传导时间，计算得到血压值。本系统有效的实现无创连续血压测量，为高血压疾病的治疗与预防提供了一种有效的解决方案。</p><p>关键词 :血压，脉搏波传导时间，心电，脉搏</p><disp-formula id="hanspub.30650-formula9"><graphic xlink:href="//html.hanspub.org/file/2-2990236x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-2990236x7_hanspub.png" /> <img src="//html.hanspub.org/file/2-2990236x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>血压是血液对血管壁在单位面积上的侧压力，即压强，其测量单位常用mmHg来表示(1 mmHg = 0.133 KPa)。血压是反应人体心血管状况的重要生理参数，在医学上成为了疾病判断、观察治疗成果、预后判断的重要依据 [<xref ref-type="bibr" rid="hanspub.30650-ref1">1</xref>] 。根据统计表明，在国内每年有近300万心血管患者死亡，而这其中超过一半与高血压有关系 [<xref ref-type="bibr" rid="hanspub.30650-ref2">2</xref>] 。因此，保证血压测量的准确性与实时性，对于心血管疾病的治疗与预防具有至关重要的作用。</p><p>现有的人体连续血压测量方法可以分为有创测量法和无创测量法。有创连续血压监测一般通过动脉插管法测量，将连接压力传感器的导管插入大动脉或者心脏来监测血压信号，从而实现连续测量血压，但是这种方法局限性很大。无创连续测量方法包括示波测量法、动脉张力测量法、容积补偿测量法和脉搏波传导时间测量法 [<xref ref-type="bibr" rid="hanspub.30650-ref3">3</xref>] 。</p><p>相比较于其他的无创血压测量方式，基于心电(ECG, electrocardiograph)与光电容积脉搏波(PPG, Photoplethysmography)相结合测量脉搏波传导时间(PTT, pulse transit time)，在利用PTT与血压之间的关系来获取血压，该方法在设计上更加的简单易行。本文设计了一种连续血压测量系统，集心电检测、脉搏检测、信号处理、蓝牙传输于一体，以接触式传感器代替原有的充气式袖带，装备实用，操作简单。</p></sec><sec id="s4"><title>2. 系统测量原理</title><p>1878年，Moens与Korteweg经过实验提出了脉搏波速度(pulse wavevalociy, PWV) [<xref ref-type="bibr" rid="hanspub.30650-ref4">4</xref>] 的公式：</p><p>P W V = K E h ρ D (1)</p><p>式中h为血管壁厚度，D为血管平衡状态的内径，ρ为血液密度，E为血管的杨氏弹性模量，K为血管参数，主动脉的K值一般可取0.8。</p><p>根据Hughes等 [<xref ref-type="bibr" rid="hanspub.30650-ref5">5</xref>] 人提血管弹性模量E与血管跨壁压(血管内外压力差) p之间关系：</p><p>E = E 0 exp ( α p ) (2)</p><p>式中，α为表征血管特征参数，数值一般为0.016~0.018 H g − 1 ， E 0 是p为0时的血管弹性模量。</p><p>结合式(1)和式(2)可以得到：</p><p>P W V = K E 0 h ρ D exp ( α p ) (3)</p><p>假设脉搏波经过一个长度为L的血管，所用的传导时间PTT，传输速度为PWV，则有 [<xref ref-type="bibr" rid="hanspub.30650-ref6">6</xref>] ：</p><p>P W V = L P T T (4)</p><p>其中L表示动脉两个检测点之间的距离。将式(4)代入式(3)可以获得血压p：</p><p>p = 1 α ( ln L 2 ρ d h E 0 − 2 ln P P T ) (5)</p><p>若对式(5)中的PTT进行幂级数展开，则有：</p><p>ln P T T = ∑ n = 1 ∞ ( − 1 ) n − 1 &#215; ( P P T − 1 ) n n (6)</p><p>式(6)的一阶近似代入式(5)后，可得简化的血压与脉搏传导时间PTT与血压的线性模型：</p><p>P = a &#215; P W T T + b (7)</p><p>其中a，b为待定系数，可以通过大量的实验数据进行确定。</p></sec><sec id="s5"><title>3. 系统总体方案</title><p>系统主要有ECG信号采集电路、PPG信号采集电路、主控电路模块、蓝牙通信模块以及电源管理模块组成。其系统设计框图如图1所示。</p><p>图1. 系统结构框图</p><p>系统通过光电反射式脉搏传感器与金属干电极分别采集ECG信号与PPG信号，经过调理电路将预处理后的信号传到主控制器，主控制器再对心电、脉搏信号进行处理后利用蓝牙4.0技术发送至手机终端，在手机端实现脉搏、心电波形的显示以及血压计算。</p></sec><sec id="s6"><title>4. 系统硬件设计</title><sec id="s6_1"><title>4.1. 心电采集模块</title><p>系统通过金属干电极采集到ECG信号后，再通过BMD101心电处理芯片对心电心电信号进行处理。BMD101是生理信号检测和处理的片上设备，芯片内部主要包括低噪声放大与ADC模数转换器两个部分，具有极低的系统噪声与可控增益，因此可以有效的检测到生物信号，并使用16为高精度ADC模拟数字转换器将它们转化为数字信号，并通过串口实现数据的传输。其内部处理处理流程图如图2所示。</p><p>图2. BMD101内部处理流程图</p><p>其BMD101心电检测电路原理图如图3所示：</p><p>图3. BMD101心电检测电路原理图</p></sec><sec id="s6_2"><title>4.2. 脉搏采集模块</title><p>脉搏采集传感器采用的是光电反射式脉搏传感器PulseSensor，该传感器利用光电容积原理，通过对手指末端透光度的检测，间接检测出PPG信号。光电式脉搏传感器具有结构简单、无损耗、可重复性好等优点。同时，传感器内部集成了放大电路与噪声消除电路，接入3.3 V供电电压，输出引脚输出的是0 V~3.3 V之间的PPG信号波形，直接连接MCU的ADC口进行采集。</p>蓝牙传输电路<p>本系统选用MTSerialBle蓝牙4.0作为蓝牙模传输电路的核心芯片，MTSerialBle是馒头科技设计的一块低功耗蓝牙透传模块，模块支持主从一体，可以实现和Android进行完美的数据传输。系统采用MCU串口连接蓝牙，实现采集硬件终端与手机终端之间的数据传输。其电路原理图如图4所示：</p><p>图4. 蓝牙模块电路原理图</p></sec></sec><sec id="s7"><title>5. 系统软件设计</title><p>系统软件部分主要由终端软件设计、手机APP设计两个部分组成。其中终端软件设计实现控对ECG、PPG数据同步采集，并实现对ECG信号、PPG信号处理，最后通过控制蓝牙实现数据上传数据手机终端。手机APP设计主要实现从MCU模块接收生理数据，再对接收的数据进行进分析处理，完成血压测量。</p><sec id="s7_1"><title>5.1. 终端软件设计</title><p>系统终端软件通过单片机串口、定时器、A/D转换器等功能，实现对ECG与PPG信号的同步采集，再对ECG、PPG信号进行处理，最后通过蓝牙实现数据传输至手机终端。终端信号采集如图5所示。ECG信号通过串口从BMD101接收；PPG信号通过A/D转换器将模拟信号转为数字信号；通过为了后面PTT的获取，这里需要ECG与PPG信号采集同步，系统利用定时器设定为100 Hz采样频率实现同步采集。采集后的ECG与PPG信号经过一定的滤波处理后，最后通过蓝牙将数据发送至手机终端。</p><p>图5. 终端信号采集</p></sec><sec id="s7_2"><title>5.2. 手机APP设计</title><p>手机APP端设计是基于Android系统平台开发，通过Android平台实现对心电与脉搏信号处理实现脉搏传导时间的获取，最后建立血压模型完成血压测量。</p><p>从功能上来说，本系统的手机APP主要包括了数据接收、数据处理与计算、系统管理与显示三个功能模块。数据接收通过Android的蓝牙接口接收从硬件终端发送的心电与脉搏数据；系统管理与显示主要完成用户信息的注册、登录、注销，并对心电、脉搏波形以及测量的血压值进行显示。</p><p>数据处理与计算主要分为心电与脉搏信号的特征点获取、传导时间计算、血压计算三个部分。</p><p>ECG与PPG信号的特征点获取实现对ECG信号R波点与PPG信号主波点定位。其处理步骤如下：</p><p>1) 选定一段信号为数组φ(n)，φ(n)对相邻数据做差值，即进行一阶导得dx(n)：</p><p>d x ( n ) = φ ( n ) − φ ( n − 1 ) (8)</p><p>当dx(n)大于0时，记为1；当dx(n)小于等于0时，即为−1；</p><p>2) 根据 d x ( n ) ∗ d x ( n − 1 ) 的值来判断峰点与谷点，如果其值小于0，则记录该点；</p><p>3) 对所有的峰点与谷点进行识别，从峰点开始检测，如果第一个点是谷点，则跳过。寻找所有满足比左邻近最小谷点值(初始值为信号最小值，指从上次检测到的有效峰值点开始，到当前峰点之间的最小谷值点)、比右邻近谷点都高于一定阈值的有效峰点，并且在一个有效峰点检测过程中，检测到的峰点为两次有效检测所有可能的峰点中的最大值点。阈值一般取信号最大值与最小值之差的三分之一，可自适应调整；</p><p>4) 对检测到的有效峰点再次进行判断，判断两个有效峰值点之间的距离是否在一定的区间，若满足条件的的则即为目标峰值点，而不符合要求的情况下，舍去其中较小的那个有效峰值点。其中区间一般可选取采样频率的1/2到1倍之间，可自适应调整。</p><p>传导时间是以心电信号的R波点为起点，以脉搏信号的主波点为终点的时间间隔来获取，最后通过传导时间与血压之间的关系模型获取血压值。</p></sec></sec><sec id="s8"><title>6. 系统测试</title><p>为了验证血压测量方式的准确性，本文采取了10名身体健康志愿者的EGC与PPG信号进行连续测量血压实验，利用建立的模型分别计算获得收缩压与舒张压值，并与欧姆龙的袖带血压计进行比较。其测量结果统计如表1所示：</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> System measurement and cuff sphygmomanometer measurement results statistic</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >志愿者编号</th><th align="center" valign="middle"  rowspan="2"  >PTT/ms</th><th align="center" valign="middle"  colspan="2"  >收缩压/mmHg</th><th align="center" valign="middle"  colspan="2"  >舒张压/mmHg</th></tr></thead><tr><td align="center" valign="middle" >SBP<sub>C</sub></td><td align="center" valign="middle" >SBP<sub>S</sub></td><td align="center" valign="middle" >DBP<sub>C</sub></td><td align="center" valign="middle" >DBP<sub>S</sub></td></tr><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >184.3</td><td align="center" valign="middle" >116.6</td><td align="center" valign="middle" >114</td><td align="center" valign="middle" >77.9</td><td align="center" valign="middle" >74</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >223.2</td><td align="center" valign="middle" >94.7</td><td align="center" valign="middle" >98</td><td align="center" valign="middle" >75.9</td><td align="center" valign="middle" >66</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >192.2</td><td align="center" valign="middle" >112.2</td><td align="center" valign="middle" >118</td><td align="center" valign="middle" >77.3</td><td align="center" valign="middle" >73</td></tr><tr><td align="center" valign="middle" >4</td><td align="center" valign="middle" >200.1</td><td align="center" valign="middle" >107.6</td><td align="center" valign="middle" >108</td><td align="center" valign="middle" >77.9</td><td align="center" valign="middle" >79</td></tr><tr><td align="center" valign="middle" >5</td><td align="center" valign="middle" >225.5</td><td align="center" valign="middle" >90.4</td><td align="center" valign="middle" >91</td><td align="center" valign="middle" >75.8</td><td align="center" valign="middle" >67</td></tr><tr><td align="center" valign="middle" >6</td><td align="center" valign="middle" >195.5</td><td align="center" valign="middle" >110.3</td><td align="center" valign="middle" >110</td><td align="center" valign="middle" >77.1</td><td align="center" valign="middle" >70</td></tr><tr><td align="center" valign="middle" >7</td><td align="center" valign="middle" >188.2</td><td align="center" valign="middle" >114.5</td><td align="center" valign="middle" >118</td><td align="center" valign="middle" >77.5</td><td align="center" valign="middle" >71</td></tr><tr><td align="center" valign="middle" >8</td><td align="center" valign="middle" >174.5</td><td align="center" valign="middle" >122.8</td><td align="center" valign="middle" >124</td><td align="center" valign="middle" >78.1</td><td align="center" valign="middle" >72</td></tr><tr><td align="center" valign="middle" >9</td><td align="center" valign="middle" >196.4</td><td align="center" valign="middle" >109.8</td><td align="center" valign="middle" >111</td><td align="center" valign="middle" >77.1</td><td align="center" valign="middle" >74</td></tr><tr><td align="center" valign="middle" >10</td><td align="center" valign="middle" >216.4</td><td align="center" valign="middle" >98.5</td><td align="center" valign="middle" >101</td><td align="center" valign="middle" >76.2</td><td align="center" valign="middle" >69</td></tr></tbody></table></table-wrap><p>表1. 系统测量与袖带血压计测量结果统计</p><p>其中PWTT表示EGC信号R波点到PPG信号主波点的时间间隔，SBP<sub>C</sub>与DBP<sub>C</sub>为系统通过血压模型计算获得收缩压值与舒张压值，SBP<sub>S</sub>与DBP<sub>S</sub>为通过袖带血压计测量获得收缩压值与舒张压值。</p><p>通过表1统计的结果，可以看出在一定误差范围内，本系统的测量结果可以与袖带血压计测量结果具有一定的互换性。为了更好的验证其检测结果，这里同样采用了Bland-Altman差值法对SBP<sub>C</sub>与SBP<sub>S</sub>、DBP<sub>C</sub>与DBP<sub>S</sub>进行一致性检验，实验结果分别见图6所示。</p><p>图6. 系统血压与袖带血压的Bland-Altman分析</p><p>根据Bland-Altman分析可以看出测量的收缩压与舒张压在10个志愿者数据中，每种测量方法都只有一个点在95%一致检验之外，说明本系统的方法与袖带血压测量方法具有很好的一致性，在一定的范围内，本系统可以替代袖带血压计。</p></sec><sec id="s9"><title>7. 总结</title><p>本文设计并实现了基于心电脉搏的无创连续血压检测系统，兼容了心电、脉搏信号监测以及基于脉搏波传导时间的血压测量方式，采用硬件终端 + 手机APP的监护模式，为用户提供了一种科学有效、经济实在的健康监测方案。通过实验检测发现脉搏传导时间与血压之间存在很好的相关性，为脉搏波传导时间血压测量法的发展提供了参考，但是结果还是存在一定的误差，需要在后期的工作中进一步的探索与研究。</p></sec><sec id="s10"><title>基金项目</title><p>浙江省基础公益研究项目(LGG18F010012)，浙江省公益技术应用研究项目(计划编号：2017C31037)。</p></sec><sec id="s11"><title>文章引用</title><p>唐陶波,施亦旸,邓艳军,张晓红,黄经州,郭春伟. 基于心电脉搏的无创连续血压检测系统的设计Design of Noninvasive Continuous Blood Pressure Detection System Based on ECG and Pulse[J]. 仪器与设备, 2019, 07(02): 79-85. https://doi.org/10.12677/IaE.2019.72012</p></sec><sec id="s12"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.30650-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">[1]	杨秀环, 梁华杰, 梁秀生, 等. 连续无创血压监测技术的研究进展[J]. 现代诊断与治疗, 2016, 27(18): 3364-3366.</mixed-citation></ref><ref id="hanspub.30650-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">陈巨兰. 高血压病的临床研究与治疗进展[J]. 中国医学文摘(内科学), 2000(6): 753-755.</mixed-citation></ref><ref id="hanspub.30650-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">高伟. 基于脉搏波的连续血压监测仪器的设计[D]: [硕士学位论文]. 天津: 天津大学, 2016.</mixed-citation></ref><ref id="hanspub.30650-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">尹赛男. 基于脉搏波传导时间的无创连续血压测量研究[D]: [硕士学位论文]. 沈阳: 东北大学, 2012.</mixed-citation></ref><ref id="hanspub.30650-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Chen, W., Kobayashi, T., Ichikawa, S., et al. (2000) Continuous Estimation of Systolic Blood Pressure Using the Pulse Arrival Time and Inter-mittent Calibration. Medical &amp; Biological Engineering &amp; Computing, 38, 569-574. &lt;br&gt;https://doi.org/10.1007/BF02345755</mixed-citation></ref><ref id="hanspub.30650-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">李章俊. 基于光电容积脉搏波描记法的无创连续血压测量[J]. 中国生物医学工程学报, 2012, 31(4): 607-614.</mixed-citation></ref></ref-list></back></article>