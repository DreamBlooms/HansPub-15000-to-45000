<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">HJCB</journal-id><journal-title-group><journal-title>Hans Journal of Computational Biology</journal-title></journal-title-group><issn pub-type="epub">2164-5426</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/HJCB.2020.101002</article-id><article-id pub-id-type="publisher-id">HJCB-34488</article-id><article-categories><subj-group subj-group-type="heading"><subject>HJCB20200100000_57097772.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>生命科学</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于短时傅里叶变换的心音特征提取研究
  Research on Heart Sound Feature Extraction Based on Short-Time Fourier Transform
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>孙</surname><given-names>树平</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>楠</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>婷婷</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>弼强</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>庞</surname><given-names>宏祥</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>肖航</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>南阳理工学院，河南 南阳</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>06</day><month>02</month><year>2020</year></pub-date><volume>10</volume><issue>01</issue><fpage>15</fpage><lpage>20</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  针对正常与异常心音在时频域具有不同特征表现形式，本研究提出了一种基于短时傅里叶变换结合等高线轮廓的方法对心音信号进行时频域特征提取研究。首先，基于小波分解对心音信号进行预处理，保留21.5~689 Hz频段有效心音信号；其次，基于短时傅里叶变换对有效心音进行时频分析；最后，本研究分析了40位健康志愿者的1500秒正常心音信号并与典型异常心音信号进行比较，其结果表明：正常第一心音频带宽度为70.07 &#177; 12.62 Hz，持续时间为109.3 &#177; 26.2 ms。PS (肺动脉狭窄)病人第一心音频带宽度为168.80 &#177; 9.95 Hz，持续时间为23.7 &#177; 3.0 ms。
   Aimed at the different characteristics of normal and abnormal heart sounds in the time-frequency domain, this study proposes a short-time Fourier transform (STFT)-based method combined with manual selection method to extract the features of heart sounds in the time-frequency domain. Firstly, the heart sound signal is preprocessed via wavelet decomposition, and the effective frequency components (21.5 - 689 Hz) of heart sound are remained. Secondly, STFT-based heart sound features are defined and extracted to character heart sound. Finally, the 1500 seconds normal heart sounds signal from 40 healthy volunteers are analyzed to compare with several typical abnormal heart sounds. The comparative results show that the frequency width and time width of normal sounds are distributed in 70.07 &#177; 12.62 Hz and 109.3 &#177; 26.2 ms, respectively. However, the time and frequency widths distributed 168.80 &#177; 9.95 Hz and 23.7 &#177; 3.0 ms are corresponding to the sounds from patients with pulmonary stenosis.
 
</p></abstract><kwd-group><kwd>心音，短时傅里叶变换，小波变换，特征提取, Heart Sound</kwd><kwd> Short-Time Fourier Transform</kwd><kwd> Wavelet Transform</kwd><kwd> Feature Extraction</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于短时傅里叶变换的心音特征提取研究<sup> </sup></title><p>孙树平，王楠，黄婷婷，张弼强，庞宏祥，李肖航</p><p>南阳理工学院，河南 南阳</p><p>收稿日期：2020年2月24日；录用日期：2020年3月5日；发布日期：2020年3月12日</p><disp-formula id="hanspub.34488-formula23"><graphic xlink:href="//html.hanspub.org/file/2-1690088x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对正常与异常心音在时频域具有不同特征表现形式，本研究提出了一种基于短时傅里叶变换结合等高</p><p>线轮廓的方法对心音信号进行时频域特征提取研究。首先，基于小波分解对心音信号进行预处理，保留21.5~689 Hz频段有效心音信号；其次，基于短时傅里叶变换对有效心音进行时频分析；最后，本研究分析了40位健康志愿者的1500秒正常心音信号并与典型异常心音信号进行比较，其结果表明：正常第一心音频带宽度为70.07 &#177; 12.62 Hz，持续时间为109.3 &#177; 26.2 ms。PS (肺动脉狭窄)病人第一心音频带宽度为168.80 &#177; 9.95 Hz，持续时间为23.7 &#177; 3.0 ms。</p><p>关键词 :心音，短时傅里叶变换，小波变换，特征提取</p><disp-formula id="hanspub.34488-formula24"><graphic xlink:href="//html.hanspub.org/file/2-1690088x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-1690088x7_hanspub.png" /> <img src="//html.hanspub.org/file/2-1690088x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>近年来心血管疾病形势却变得愈发严峻，已经代替肿瘤成为城乡居民死亡的首要原因。《中国心血管报告2018》 [<xref ref-type="bibr" rid="hanspub.34488-ref1">1</xref>] 显示：2016年农村因心血管疾病死亡人数占全部因疾病死亡人数的45.50%，城市因心血管疾病死亡人数占全部死亡人数的43.16%，如图1所示。同时指出心血管疾病死亡人数还在迅速增加，因此做好心血管疾病的防治工作已经迫在眉睫。</p><p>图1. 2016年中国农村和城市居民主要疾病死因构成</p><p>心音是由心脏内血液流动经胸腔壁传达产生的一种振动声音，是心肌患性能状态的一种表征形式，其主要由两个成分(S1和S2)组成的近似于周期的非平稳信号。图2所示为典型主动脉瓣狭窄心音信号时域波形 [<xref ref-type="bibr" rid="hanspub.34488-ref2">2</xref>]。因此，S1和S2的有效特征作为评价心肌患和诊断心脏病的基础显得尤为重要，可为心肌患提供有价值的诊断信息。鉴于此，本文针对S1和S2进行特征提取研究。</p></sec><sec id="s4"><title>2. 方法</title><sec id="s4_1"><title>2.1. 基于小波变换的心音信号降噪过程</title><p>对心音进行采集的时候找不到绝对安静的环境，信号难免会带有一些噪声。这些能量很小的噪声听起来并不明显，但是在时频分析时会产生很大的影响，因此在时频分析之前，我们需要采取一定的措施来对信号进行降噪 [<xref ref-type="bibr" rid="hanspub.34488-ref3">3</xref>]。本研究中我们使用小波来对得到的心音信号进行降噪，消除大部分噪声，最后得到一段噪声较少的心音信号。将采集的心音信号输入到MATLAB中进行降噪。因为小波分析可以通过调整窗口在时域和频域对信号进行局部化分析，保存控制小波系数的信号，然后对有噪声控制的小波系数进行删除，根据该小波分析降噪的理论依据得出：经小波dB 10分解后，心音信号噪声的系数幅值低于小波系数幅度值 [<xref ref-type="bibr" rid="hanspub.34488-ref4">4</xref>]。</p><p>图2. 正常心音信号的时域表示</p><p>利用小波变换对心音信号降噪和图像降噪的原理主要都是阈值的选择，这就显得阈值的选择对于小波变换对信号降噪尤为重要。在设计阈值时根据噪声小波系数的特点，随着分解层数的改变而自适应的变化 [<xref ref-type="bibr" rid="hanspub.34488-ref5">5</xref>]。因此，本研究将采用小波系数 的母小波，采用本实验室编写的基于MATLAB的可执行文件(PSD-based Feature Extraction App)对心音进行五层的分解，图3是其小波的5层分解图，由St中0~2 kHz分解成g(t)中cD1-1~2 kHz和h(t)中cA1-0~0.5 kHz。选取第一段中的h(t)继续分析，分解成g(t)中cD2-0.5~1 kHz和h(t)中cA2-0~0.5 kHz。又继续选取第二段中h(t)继续进行分析，对h(t)分解成g(t)中cD6-62.5~125 Hz和h(t)中cA6-0~62.5 Hz。通过对小波降噪分解图的三部分分析比较，选取了最适合的降噪频率范围。我们通过观察降噪结果来选择效果最好的降噪频率，结果证明dB 10小波对心音的降噪效果最好。</p><p>图3. 小波分解图</p></sec><sec id="s4_2"><title>2.2. 基于短时傅里叶变换特征提取</title><sec id="s4_2_1"><title>2.2.1. 短时傅里叶变换原理</title><p>短时傅里叶变换的基本思想与积分的思想很相似，把一个非平稳信号看成是很多段平稳信号相接在一起而形成的，通过加窗的方式来保证其所分出来小段信号的短时性。由于限定了一个时间窗，当我们设置的时间窗足够短的时候，就可以认为该非平稳信号的某一个片段为平稳信号，然后对其使用傅里叶变换。同时对其他片段也使用傅里叶变换，最后，非平稳信号被分解成很多不同频率信号的叠加，相当于实现了对整个非平稳信号的傅里叶变换 [<xref ref-type="bibr" rid="hanspub.34488-ref6">6</xref>]。短时傅里叶变换(STFT)的公式(1)。</p><p>s t f t ( t , ω ) = ∫ − ∞ + ∞ x ( τ ) g ( τ − t ) e − j ω τ d τ 。 (1)</p><p>短时傅里叶变换具有一定的时间分辨率和频率分辨率，我们不可能得到无限小的时间和频率分辨率，由德国物理学家沃纳&#183;卡尔&#183;海森堡于1927年提出的测不准原理如公式(2) [<xref ref-type="bibr" rid="hanspub.34488-ref6">6</xref>] <sup> </sup></p><disp-formula id="hanspub.34488-formula25"><label>(2)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/2-1690088x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>可见短时傅里叶变换是不可能具有任意的时间分辨率和频率分辨率的，它们会随着其中一个的增大而减小。在短时傅里叶变换中，这是由所加的窗的长度来决定的。窗越长则时间分辨率越高，频率分辨率越低，窗越短则时间分辨率越低，频率分辨率就会越高，这就导致时间分辨率7和频率分辨率不可能无限大小。图4为典型信号 f ( x ) = cos ( 200 π t ) + cos ( 100 π t ) 在时频域表现形式，其横轴代表时间，纵轴表示频率，颜色的深浅度表示能量大小，因此，借助短时傅里叶变换可以将信号从时频两域对信号的能量分布进行描述，并且能够表示信号在时间域上所对应的成分。因此本文将采用短时傅里叶变换对S1和S2进行研究，提取有效特征，对典型心脏病的心音信号进行定性分析。</p><p>图4. 短时傅里叶变换时频图</p></sec><sec id="s4_2_2"><title>2.2.2. 特征提取</title><p>图5上图是正常人心音经过短时傅里叶变换得到的心音片段，每个心音周期都分为2部分，即第一心音S1和第二心音S2。由图可以看出心音中心部分颜色深，从中心到外围逐渐变浅，颜色深的部分代表该位置的能量高，颜色浅的部分代表能量低。首先，运用数学形态学的方法得到S1和S2的时频域形状，即图5中最外围等高线外接的红色矩形。然后计算矩形的长度和宽度就可以得到心音S1和S2的持续时间(Tw)和带宽(Fmin, Fw)，由此可以得到心音的三维特征向量[Tw, Fmin, Fw]。</p><p>图5. 正常心音信号</p></sec></sec></sec><sec id="s5"><title>3. 实验分析</title><p>本研究采用短时傅里叶变换来对多组信号进行处理，分析其时频特点，并提取特征值，将40组正常人心音数据和典型异常心音吸纳后进行对比分析，从而总结出正常心音时频特征。图6表示正常心音与PS (肺动脉狭窄)病人心音信号频率域(见图(6a))和时间域(见图(6b))的对比，由此可明显区分正常与异常心音。</p><p>图6. 正常心音与PS患者心音信号对比图</p></sec><sec id="s6"><title>4. 结论</title><p>本研究采用短时傅里叶变换对心音信号进行研究，基于信号时频分布定义信号特征，通过手动方式提取第一第二心音时频域特征，对正常及异常心音进行特征对比研究，其特征统计结果(均值&#177;样本方差)为：正常人S1的频带宽度为70.07 &#177; 12.62 Hz，持续时间109.3 &#177; 26.2 ms，S2频带宽度为66.02 &#177; 8.39 Hz，持续时间为92.5 &#177; 28.0 ms。PS (肺动脉狭窄)病人S1频带宽度为168.80 &#177; 9.95 Hz，持续时间为23.7 &#177; 3.0 ms，S2频带宽度为147.68 &#177; 16.80 Hz，持续时间为30.8 &#177; 5.7 ms。由于特征提取采用手动方式，为客观描述心音特征而避免人为主观能动性，本研究在如何实现自动选取特征需要有待于进一步的研究。</p></sec><sec id="s7"><title>文章引用</title><p>孙树平,王 楠,黄婷婷,张弼强,庞宏祥,李肖航. 基于短时傅里叶变换的心音特征提取研究Research on Heart Sound Feature Extraction Based on Short-Time Fourier Transform[J]. 计算生物学, 2020, 10(01): 15-20. https://doi.org/10.12677/HJCB.2020.101002</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.34488-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">胡盛寿, 高润霖, 等. 2018管疾病报告[J]. 中国循环杂志, 2019, 34(3): 1-2.</mixed-citation></ref><ref id="hanspub.34488-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">3M Database (2019) 50 Heart and Lung Sounds Library. 
&lt;br&gt;http://solutions.3m.com/wps/portal/3M/enEU/3M-Littmann-EMEA/stethoscope/littmann-learning-institute/heart-lung-sounds/heart-lung-sound-library/</mixed-citation></ref><ref id="hanspub.34488-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">韩立喜. 心音信号去噪及特征值提取的研究[D]: [硕士学位论文]. 长春: 长春理工大学, 2013.</mixed-citation></ref><ref id="hanspub.34488-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">朱先和, 杨世平. 基于小波变换对信号噪声的处理研究[J]. 电子科技, 2016, 29(6): 128-131.</mixed-citation></ref><ref id="hanspub.34488-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Ducas, R.A., Elliott, J.E., Melnyk, S.F., et al. (2014) Cardiovascular Magnetic Resonance in Pregnancy: Insights from the Cardiac Hemodynamic Imaging and Remodeling in Pregnancy (CHIRP) Study. Journal of Cardiovascular Magnetic Resonance, 16, 1-3. &lt;br&gt;https://doi.org/10.1186/1532-429X-16-1</mixed-citation></ref><ref id="hanspub.34488-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">张旭东, 陆明泉. 离散随机信号处理[M]. 北京: 清华大学出版社, 2005.</mixed-citation></ref></ref-list></back></article>