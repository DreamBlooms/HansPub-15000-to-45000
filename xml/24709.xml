<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2018.74054</article-id><article-id pub-id-type="publisher-id">AAM-24709</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20180400000_74933729.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  轻量级MDS矩阵的构造
  The Construction of Lightweight MDS Matrix
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>周</surname><given-names>敏</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>顾</surname><given-names>执</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>西华大学数学研究所，四川 成都</addr-line></aff><aff id="aff3"><addr-line>西南交通大学数学学院，四川 成都</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1027164433@qq.com(周敏)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>20</day><month>04</month><year>2018</year></pub-date><volume>07</volume><issue>04</issue><fpage>429</fpage><lpage>445</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   MDS矩阵在密码学中有重要的应用，可以用来构造分组密码。MDS矩阵的异或数是衡量密码算法的有效性的一个重要指标。本文研究MDS矩阵的性质，考虑循环、矩阵分块和迭代等思想，分别针对几类特殊性质的MDS矩阵构造，包括循环MDS矩阵、Hadar MDS矩阵和迭代MDS矩阵等。在m = 4, 8情况下，使用程序来搜索满足条件的MDS矩阵，给出了具有最小异或数的MDS矩阵的数目和例子，得到m = 4, 8情况下许多具有已知最小异或数的MDS矩阵，得到了m = 4时具有异或数12的循环MDS矩阵，也构造了m = 8时具有异或数10的最佳MDS矩阵。 MDS Matrix has important applications in cryptography and it can be used to construct block ciphers. The number of XOR of a MDS Matrix is an important index to measure the validity of cipher algorithm. In this paper, we study the properties of MDS matrix and consider the ideas of cycle, block matrix and so on. The MDS matrix is constructed for several special properties, including cyclic MDS matrix, Hadamard MDS matrix and iterative MDS matrix etc. When the number m = 4, 8, we use the program to search the MDS matrix that satisfies the condition. The number of MDS matrix with the minimum number of XOR and examples are given and we get many MDS matrices with the minimum number of XOR; when m = 4, we have given the circulating MDS Matrix with the number of XOR with 12, when m = 8 we have given the best MDS Matrix with the number of XOR with 10.
    
  
 
</p></abstract><kwd-group><kwd>MDS矩阵，线性扩散层，循环矩阵，Hadamard矩阵，异或数, MDS Matrix</kwd><kwd> Linear Diffusion Layer</kwd><kwd> Cyclic Matrix</kwd><kwd> Hadamard Matrix</kwd><kwd> Number of XOR</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>轻量级MDS矩阵的构造<sup> </sup></title><p>周敏<sup>1</sup>，顾执<sup>2</sup></p><p><sup>1</sup>西华大学数学研究所，四川 成都</p><p><sup>2</sup>西南交通大学数学学院，四川 成都</p><p><img src="//html.hanspub.org/file/19-2620613x1_hanspub.png" /></p><p>收稿日期：2018年4月11日；录用日期：2018年4月21日；发布日期：2018年4月28日</p><disp-formula id="hanspub.24709-formula204"><graphic xlink:href="//html.hanspub.org/file/19-2620613x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>MDS矩阵在密码学中有重要的应用，可以用来构造分组密码。MDS矩阵的异或数是衡量密码算法的有效性的一个重要指标。本文研究MDS矩阵的性质，考虑循环、矩阵分块和迭代等思想，分别针对几类特殊性质的MDS矩阵构造，包括循环MDS矩阵、Hadar MDS矩阵和迭代MDS矩阵等。在m = 4, 8情况下，使用程序来搜索满足条件的MDS矩阵，给出了具有最小异或数的MDS矩阵的数目和例子，得到m = 4, 8情况下许多具有已知最小异或数的MDS矩阵，得到了m = 4时具有异或数12的循环MDS矩阵，也构造了m = 8时具有异或数10的最佳MDS矩阵。</p><p>关键词 :MDS矩阵，线性扩散层，循环矩阵，Hadamard矩阵，异或数</p><disp-formula id="hanspub.24709-formula205"><graphic xlink:href="//html.hanspub.org/file/19-2620613x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/19-2620613x7_hanspub.png" /> <img src="//html.hanspub.org/file/19-2620613x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 绪论</title><sec id="s3_1"><title>1.1. 引言</title><p>混乱原则和扩散原则是保证分组密码安全性的重要原则，线性扩散层是分组对称密码算法的重要组成部分，其扩散特性是通过特定的内部结构来实现的。扩散结构的设计十分重要，直接关系到分组密码的安全性能和实现性能 [<xref ref-type="bibr" rid="hanspub.24709-ref1">1</xref>] 。在轻量级加密过程中，通过有限的资源环境保证信息安全，线性扩散层发挥着重要作用。</p><p>分支数是分组密码设计中的一个重要组成成分，可以根据分支数的大小从理论上给出差分和线性攻击的抵抗界限。线性扩散层是一个线性变换，可以通过一个n阶矩阵表示，若这个n阶矩阵的最大分支数是n + 1，则这个扩散层就称为完美扩散层。MDS矩阵的分支数达到最大，在分组密码的扩散结构中得到广泛应用，比如Advanced Encryption Standard (AES) [<xref ref-type="bibr" rid="hanspub.24709-ref2">2</xref>] 、Shark [<xref ref-type="bibr" rid="hanspub.24709-ref3">3</xref>] 以及Twofish [<xref ref-type="bibr" rid="hanspub.24709-ref4">4</xref>] 和Khazad [<xref ref-type="bibr" rid="hanspub.24709-ref5">5</xref>] 分组密码算法等。此外，为了保证解密结构和加密结构的一致性，通常采用对合MDS矩阵，因此，如何构造良好性质的对合MDS矩阵成为了研究的目标。</p><p>构造MDS矩阵的方法通常利用有限域及MDS码。为提高运算效率，通常考虑有限域上具有较少非零元素的矩阵。循环矩阵以及Hadamard矩阵是主要选取的对象，AES扩散层就是使用此类矩阵。为了适用于轻量密码算法，目前主要使用递归扩散层构造最优扩散层，具体是首先构造一个简单的矩阵，然后该矩阵复合若干次(通常大于等于矩阵的阶数)，得到MDS矩阵。在轻量级的Hash函数设计中，比如PHOTON，以及分组密码LED [<xref ref-type="bibr" rid="hanspub.24709-ref6">6</xref>] ，均是通过此类MDS矩阵构造。利用上述想法并用具有较少异或操作的线性变换替换有限域上的乘法，实现效率得以提高。如何构造轻量级MDS矩阵，既能减少矩阵乘法运算中出现的困难又能避免迭代构造出现的问题，是进一步需要研究的问题。</p><p>本文考虑m = 4, 8时具有小异或数的MDS矩阵，首先给出了MDS矩阵异或数的性质，然后使用直接搜索满足性质的特殊循环MDS矩阵，并分析MDS矩阵的异或数最小值和数目，为了改进MDS矩阵的构造方法和效率，使用循环、分块和迭代等思想，来考虑特殊MDS矩阵，并分析这些MDS矩阵的异或数最小值和数目。</p><p>本文的主要结构是：第二节给出了一些基本概念和MDS矩阵性质；第三节使用循环、分块和迭代等思想，给出几种特殊类型MDS矩阵的构造，并分析这些MDS矩阵的最小异或数和数目。</p></sec><sec id="s3_2"><title>1.2. 预备知识</title><p>记<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x9_hanspub.png" xlink:type="simple"/></inline-formula>为一个有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x10_hanspub.png" xlink:type="simple"/></inline-formula>个元素的有限域，当m = 1时，值为0或1，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x11_hanspub.png" xlink:type="simple"/></inline-formula>可以看成<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x12_hanspub.png" xlink:type="simple"/></inline-formula>上的m维线性空间，记<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x13_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x14_hanspub.png" xlink:type="simple"/></inline-formula>上的m维线性空间。一个矩阵成为二元矩阵，若矩阵的每个元素都在有限域<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x15_hanspub.png" xlink:type="simple"/></inline-formula>中，即每个元素都是0或1。</p><p>一个<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x16_hanspub.png" xlink:type="simple"/></inline-formula>映射L被称为是线性的，若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x17_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x18_hanspub.png" xlink:type="simple"/></inline-formula>。确定<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x19_hanspub.png" xlink:type="simple"/></inline-formula>上的一个基，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x20_hanspub.png" xlink:type="simple"/></inline-formula>上的线性映射可以用<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x21_hanspub.png" xlink:type="simple"/></inline-formula>的二元矩阵L表示，即<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x22_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x23_hanspub.png" xlink:type="simple"/></inline-formula>为一个列向量。</p><p>记<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x24_hanspub.png" xlink:type="simple"/></inline-formula>为所有的<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x25_hanspub.png" xlink:type="simple"/></inline-formula>的非奇异二元矩阵的集合，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x26_hanspub.png" xlink:type="simple"/></inline-formula>。取一个二元矩阵</p><disp-formula id="hanspub.24709-formula206"><graphic xlink:href="//html.hanspub.org/file/19-2620613x27_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x28_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x29_hanspub.png" xlink:type="simple"/></inline-formula>中一个二元矩阵。定义L的一个t阶子方阵为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x30_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x31_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x32_hanspub.png" xlink:type="simple"/></inline-formula>是两个长度为t的序列，并且<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x33_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x34_hanspub.png" xlink:type="simple"/></inline-formula>。二元矩阵L称为MDS矩阵，若L的任意阶数为t的子方阵都是满秩矩阵。</p><p>对任意的二元矩阵L，记L的异或数为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x35_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x36_hanspub.png" xlink:type="simple"/></inline-formula>，m为L的阶数，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x37_hanspub.png" xlink:type="simple"/></inline-formula>为L的第i行中1的个数。对任意的<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x38_hanspub.png" xlink:type="simple"/></inline-formula>，通过提取L中每一行不为零元素的位置而将L的简化形式给出，例如矩阵[[1,3], 2, 3, [1,4]]表示如下矩阵</p><disp-formula id="hanspub.24709-formula207"><graphic xlink:href="//html.hanspub.org/file/19-2620613x39_hanspub.png"  xlink:type="simple"/></disp-formula><p>线性扩散层是一个线性变换，每一个线性变换都可以用一个m阶矩阵表示。所以每一个线性扩散层都可以有一个m阶矩阵表示，众所周知，m阶矩阵的最大分支数是m + 1。具有最大分支数的线性扩散层是一个完美扩散层或者是一个MDS矩阵。</p><p>一个矩阵被称为循环矩阵，若这个矩阵每一行的最后一个分块被旋转到下一行的最左边。四阶循环矩阵如下</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x40_hanspub.png" xlink:type="simple"/></inline-formula>,</p><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x41_hanspub.png" xlink:type="simple"/></inline-formula></p><p>一个<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x42_hanspub.png" xlink:type="simple"/></inline-formula>的矩阵被称为Hadamard矩阵，若它具有如下形式</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x43_hanspub.png" xlink:type="simple"/></inline-formula>,</p><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x44_hanspub.png" xlink:type="simple"/></inline-formula>是两个<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x45_hanspub.png" xlink:type="simple"/></inline-formula>的Hadamard矩阵。四阶Hadamard矩阵如下</p><disp-formula id="hanspub.24709-formula208"><graphic xlink:href="//html.hanspub.org/file/19-2620613x46_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x47_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>文献 [<xref ref-type="bibr" rid="hanspub.24709-ref7">7</xref>] 给出了循环MDS矩阵和Hadamard MDS矩阵的一个下界，提出一种利用非对合矩阵，建构出异或数较小的MDS矩阵，主要的思想是对构造的非对合MDS矩阵，通过不同矩阵的性质的研究，借助搜索，得到最终异或数最小的MDS矩阵。</p></sec></sec><sec id="s4"><title>2. 构造轻量级MDS矩阵</title><p>本节主要使用循环、分块和迭代等思想，在m = 4, 8情况下，考虑特殊二元MDS矩阵的构造，分别考虑循环MDS矩阵、Hadmard MDS矩阵、最佳MDS矩阵和迭代MDS矩阵的构造，分析这些矩阵的性质，使用程序搜索具有最小异或数的MDS矩阵，并给出了矩阵对应的最小异或数以及这些矩阵的数目，得到了m = 4时具有异或数12的循环MDS矩阵(2.1节)，也构造了m = 8时具有异或数10的最佳MDS矩阵(2.4节)。</p><sec id="s4_1"><title>2.1. 轻量级循环MDS矩阵的构造</title><p>对于循环型矩阵</p><disp-formula id="hanspub.24709-formula209"><graphic xlink:href="//html.hanspub.org/file/19-2620613x48_hanspub.png"  xlink:type="simple"/></disp-formula><p>若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x49_hanspub.png" xlink:type="simple"/></inline-formula>是MDS矩阵，则<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x50_hanspub.png" xlink:type="simple"/></inline-formula>都必须是可逆矩阵。4阶可逆矩阵有20,160个，而8阶可逆矩阵超过了2<sup>62</sup>个。需要构造轻量级MDS矩阵，直观看应该包含异或数为0的矩阵(置换矩阵)，特别地，我们可将<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x51_hanspub.png" xlink:type="simple"/></inline-formula>中某些矩阵取为单位阵。因此，首先考虑如下矩阵：</p><disp-formula id="hanspub.24709-formula210"><graphic xlink:href="//html.hanspub.org/file/19-2620613x52_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中I为单位矩阵。首先给出如下基本引理(证明由高等代数基本知识可得证)。</p><p>引理1：假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x53_hanspub.png" xlink:type="simple"/></inline-formula>均是二元域上的m阶满秩矩阵，则有下述结论：</p><p>1)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x54_hanspub.png" xlink:type="simple"/></inline-formula>是满秩矩阵当且仅当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x55_hanspub.png" xlink:type="simple"/></inline-formula>为满秩矩阵。</p><p>2)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x56_hanspub.png" xlink:type="simple"/></inline-formula>是满秩矩阵当且仅当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x57_hanspub.png" xlink:type="simple"/></inline-formula>为满秩矩阵。</p><p>3)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x58_hanspub.png" xlink:type="simple"/></inline-formula>是满秩矩阵当且仅当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x59_hanspub.png" xlink:type="simple"/></inline-formula>为满秩矩阵。</p><p>4)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x60_hanspub.png" xlink:type="simple"/></inline-formula>是满秩矩阵当且仅当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x61_hanspub.png" xlink:type="simple"/></inline-formula>为满秩矩阵。</p><p>对于<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x62_hanspub.png" xlink:type="simple"/></inline-formula>型矩阵，若L为MDS矩阵，则必定有以下几个矩阵均为满秩矩阵：</p><disp-formula id="hanspub.24709-formula211"><graphic xlink:href="//html.hanspub.org/file/19-2620613x63_hanspub.png"  xlink:type="simple"/></disp-formula><p>下面针对m = 4和m = 8，分别讨论MDS矩阵。</p><sec id="s4_1_1"><title>2.1.1. 4阶矩阵环上的循环型MDS矩阵</title><p>考虑在<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x64_hanspub.png" xlink:type="simple"/></inline-formula>上的所有满秩矩阵，令集合</p><disp-formula id="hanspub.24709-formula212"><graphic xlink:href="//html.hanspub.org/file/19-2620613x65_hanspub.png"  xlink:type="simple"/></disp-formula><p>为了满足MDS矩阵的相关条件，记集合</p><disp-formula id="hanspub.24709-formula213"><graphic xlink:href="//html.hanspub.org/file/19-2620613x66_hanspub.png"  xlink:type="simple"/></disp-formula><p>记满足上述条件的有序矩阵对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x67_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x68_hanspub.png" xlink:type="simple"/></inline-formula></p><p>令<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x69_hanspub.png" xlink:type="simple"/></inline-formula></p><p>最后依照MDS矩阵的定义，依次验证<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x70_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x71_hanspub.png" xlink:type="simple"/></inline-formula></p><p>使用程序4总共搜索到156,387个这种形式的MDS矩阵，其中异或总数最低的MDS矩阵共有48个，其异或数为12。并且，经过验证，A、B满足关系：</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x72_hanspub.png" xlink:type="simple"/></inline-formula>或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x73_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>例1：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x74_hanspub.png" xlink:type="simple"/></inline-formula></p><p>例2：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x75_hanspub.png" xlink:type="simple"/></inline-formula></p></sec><sec id="s4_1_2"><title>2.1.2. 8阶矩阵环上的循环型MDS矩阵</title><p>当m = 8时，若依照m = 4的程序搜索方法，面临搜索数据量极大的问题。为缩小搜索范围，考虑特殊情形下的这类MDS矩阵，分别在两种具体情形下讨论。</p><p>1) 基于低异或数子类搜索：</p><p>利用分块构造矩阵的思想，具体考虑这样形式的集合：</p><disp-formula id="hanspub.24709-formula214"><graphic xlink:href="//html.hanspub.org/file/19-2620613x76_hanspub.png"  xlink:type="simple"/></disp-formula><p>考虑mzjz2中的矩阵A的限定条件：</p><p>a) 取<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x77_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>即<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x78_hanspub.png" xlink:type="simple"/></inline-formula></p><p>考虑所有此类有序矩阵对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x79_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x80_hanspub.png" xlink:type="simple"/></inline-formula>，再通过MDS矩阵的定义，使用程序5依次验证<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x81_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x82_hanspub.png" xlink:type="simple"/></inline-formula>，最终得到2690个这种形式的MDS矩阵，其中MDS阵的一行异或数最低为7，且能够取得17个这样的MDS矩阵。</p><p>例3：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x83_hanspub.png" xlink:type="simple"/></inline-formula></p><p>b) 取<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x84_hanspub.png" xlink:type="simple"/></inline-formula>，即<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x85_hanspub.png" xlink:type="simple"/></inline-formula></p><p>考虑所有此类有序矩阵对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x86_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x87_hanspub.png" xlink:type="simple"/></inline-formula>，再通过MDS矩阵的定义，使用类似程序5的程序依次验证：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x88_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x89_hanspub.png" xlink:type="simple"/></inline-formula>最终得到200,072个这种类型的MDS矩阵，其中异或总数最低的MDS矩阵共有12个，其中MDS阵的一行异或数最低为22。</p><p>例4：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x90_hanspub.png" xlink:type="simple"/></inline-formula></p><p>c) 矩阵A满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x91_hanspub.png" xlink:type="simple"/></inline-formula></p><p>即： <inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x92_hanspub.png" xlink:type="simple"/></inline-formula></p><p>考虑所有此类有序矩阵对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x93_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x94_hanspub.png" xlink:type="simple"/></inline-formula>，再通过MDS矩阵的定义，依次验证<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x95_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x96_hanspub.png" xlink:type="simple"/></inline-formula>，最终得到1444个这种形式的MDS矩阵，并且每一个MDS矩阵一行的异或数均为4。</p><p>例5：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x97_hanspub.png" xlink:type="simple"/></inline-formula></p><disp-formula id="hanspub.24709-formula215"><graphic xlink:href="//html.hanspub.org/file/19-2620613x98_hanspub.png"  xlink:type="simple"/></disp-formula><p>m = 8时，基于低异或数构造的循环MDS矩阵总结如表1。</p><p>2) 基于4阶情形的启发式搜索：</p><p>通过对4阶循环MDS矩阵的分析，我们知道形如<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x99_hanspub.png" xlink:type="simple"/></inline-formula>这样的异或数最低的MDS矩阵满足关系<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x100_hanspub.png" xlink:type="simple"/></inline-formula>或<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x101_hanspub.png" xlink:type="simple"/></inline-formula>。为此，考虑如下形式8阶矩阵环上的循环型MDS矩阵：</p><disp-formula id="hanspub.24709-formula216"><graphic xlink:href="//html.hanspub.org/file/19-2620613x102_hanspub.png"  xlink:type="simple"/></disp-formula><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Cyclic MDS matri</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >循环矩阵的第一行</th><th align="center" valign="middle" >生成元来源</th><th align="center" valign="middle" >特征元素结构</th><th align="center" valign="middle" >最小异或数</th></tr></thead><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x103_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x104_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x105_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >28</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x106_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x107_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x108_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >88</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x109_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x110_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x111_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >16</td></tr></tbody></table></table-wrap><p>表1. 循环MDS矩阵</p><p>为了得到低异或数的矩阵，我们只搜索了A是异或数等于1的满秩矩阵的情况：记所有八阶异或数为零的满秩矩阵集合为：</p><disp-formula id="hanspub.24709-formula217"><graphic xlink:href="//html.hanspub.org/file/19-2620613x112_hanspub.png"  xlink:type="simple"/></disp-formula><p>将矩阵<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x113_hanspub.png" xlink:type="simple"/></inline-formula>中的零元素依次用1进行替换，得到一个新矩阵，记此变换后的全体矩阵集合为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x114_hanspub.png" xlink:type="simple"/></inline-formula>，集合中所有矩阵的异或数均为1，即：</p><disp-formula id="hanspub.24709-formula218"><graphic xlink:href="//html.hanspub.org/file/19-2620613x115_hanspub.png"  xlink:type="simple"/></disp-formula><p>满足条件的矩阵可从<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x116_hanspub.png" xlink:type="simple"/></inline-formula>选取。现检验如下矩阵是否为MDS矩阵：</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x117_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x118_hanspub.png" xlink:type="simple"/></inline-formula></p><p>使用程序6检验，共96,093个MDS矩阵，其中矩阵异或总数最小为12，共80,640个矩阵满足异或数最小。</p><p>例6：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x119_hanspub.png" xlink:type="simple"/></inline-formula></p><p>下面给出一些二元矩阵的性质。</p><p>引理2 [<xref ref-type="bibr" rid="hanspub.24709-ref7">7</xref>] ：已知<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x120_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x121_hanspub.png" xlink:type="simple"/></inline-formula>，如果L的秩为2m，则<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x122_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>证明：假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x123_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x124_hanspub.png" xlink:type="simple"/></inline-formula>。则<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x125_hanspub.png" xlink:type="simple"/></inline-formula>的每一行每一列都有一个元素为1其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x126_hanspub.png" xlink:type="simple"/></inline-formula>。所以L是非奇异的，即<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x127_hanspub.png" xlink:type="simple"/></inline-formula>，矛盾。证毕。</p><p>定理1：1) 若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x128_hanspub.png" xlink:type="simple"/></inline-formula>是一个循环的MDS矩阵，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x129_hanspub.png" xlink:type="simple"/></inline-formula>，则<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x130_hanspub.png" xlink:type="simple"/></inline-formula>；2) 若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x131_hanspub.png" xlink:type="simple"/></inline-formula>是一个Hadamard MDS矩阵，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x132_hanspub.png" xlink:type="simple"/></inline-formula>，则<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x133_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>证明：1) 设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x134_hanspub.png" xlink:type="simple"/></inline-formula>是一个循环的MDS矩阵。</p><p>若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x135_hanspub.png" xlink:type="simple"/></inline-formula>，则在第一行中至少含有三个异或数为0，不妨假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x136_hanspub.png" xlink:type="simple"/></inline-formula>，有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x137_hanspub.png" xlink:type="simple"/></inline-formula>，因L是一个MDS矩阵，所以这与假设矛盾。其他情况同样可以被证明。</p><p>若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x138_hanspub.png" xlink:type="simple"/></inline-formula>，则对某一行至少有两个元素异或数为零，其余两个元素异或数之和为2。</p><p>当m = 4时：</p><p>a) 不妨设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x139_hanspub.png" xlink:type="simple"/></inline-formula>。采用如下搜索策略：当m = 4时，首先得到一个包含所有异或数为1的满秩矩阵的集合One以及包含所有异或数为0的满秩矩阵的集合<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x140_hanspub.png" xlink:type="simple"/></inline-formula>，然后对每一个数组<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x141_hanspub.png" xlink:type="simple"/></inline-formula>，带入检验<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x142_hanspub.png" xlink:type="simple"/></inline-formula>是否为MDS矩阵，通过运行程序1，并未检测到任何满足条件的矩阵；</p><p>b) 不妨设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x143_hanspub.png" xlink:type="simple"/></inline-formula>，记异或数为零的矩阵集合为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x144_hanspub.png" xlink:type="simple"/></inline-formula>，则</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x145_hanspub.png" xlink:type="simple"/></inline-formula>,</p><p>显见L存在一个子方阵<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x146_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x147_hanspub.png" xlink:type="simple"/></inline-formula>，此时的L一定不是MDS矩阵。</p><p>当m = 8时，同理可证，详见附件程序2。</p><p>由矩阵的初等行列变换知，交换上述A B C D的位置不会影响<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x148_hanspub.png" xlink:type="simple"/></inline-formula>的MDS性，故该证明具有一般性。</p><p>综上可得，满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x149_hanspub.png" xlink:type="simple"/></inline-formula></p><p>2)<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x150_hanspub.png" xlink:type="simple"/></inline-formula>是一个Hadamard MDS矩阵。</p><p>若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x151_hanspub.png" xlink:type="simple"/></inline-formula>，则在第一行中至少含有两个异或数为0，不失普遍性，这里假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x152_hanspub.png" xlink:type="simple"/></inline-formula>，据引理2，有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x153_hanspub.png" xlink:type="simple"/></inline-formula>，因L是一个MDS矩阵，所以这与假设矛盾。其他情况同样可以被证明。</p><p>若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x154_hanspub.png" xlink:type="simple"/></inline-formula>，则对某一行至少有一个元素异或数为零，其余三个元素异或数之和为3。</p><p>当m = 4时：</p><p>1) 不妨设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x155_hanspub.png" xlink:type="simple"/></inline-formula>，采用如下搜索策略：首先可记一个包含所有异或数为1的满秩矩阵的集合One和包含所有异或数为0的满秩矩阵<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x156_hanspub.png" xlink:type="simple"/></inline-formula>。然后对每一个数组<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x157_hanspub.png" xlink:type="simple"/></inline-formula>，带入程序3的findMDS1.m检验是否为MDS矩阵的程序中，通过运行程序，并未检测到任何满足条件的矩阵。</p><p>2) 不妨假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x158_hanspub.png" xlink:type="simple"/></inline-formula>，搜索策略如下：记一个包含所有异或数为1的矩阵的集合One，一个包含所有异或数为2的矩阵的集合Two。然后对每一个数组<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x159_hanspub.png" xlink:type="simple"/></inline-formula>，带入程序3中的findMDS2.m检验是否为MDS矩阵的程序中，通过运行程序，并未检测到任何满足条件的矩阵。</p><p>3) 假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x160_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x161_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x162_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>显见L存在一个子方阵<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x163_hanspub.png" xlink:type="simple"/></inline-formula>，显然<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x164_hanspub.png" xlink:type="simple"/></inline-formula>，所以此时的L一定不是MDS矩阵。</p><p>当m = 8时，同理可证。</p><p>由矩阵的初等行列变换知，交换上述A B C D的位置不会影响<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x165_hanspub.png" xlink:type="simple"/></inline-formula>的MDS性，故该证明具有一般性。</p><p>综上，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x166_hanspub.png" xlink:type="simple"/></inline-formula>是一个MDS矩阵，则<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x167_hanspub.png" xlink:type="simple"/></inline-formula>。证毕。</p><p>利用上述定理知4阶或8阶矩阵环上的循环型MDS矩阵异或数不小于12。前面构造说明异或数12是可以达到的，并已经取得。</p></sec></sec><sec id="s4_2"><title>2.2. 循环MDS矩阵的改进</title><p>此节继续考虑特殊分块矩阵，尝试构造类似循环矩阵的MDS矩阵，记循环矩阵为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x168_hanspub.png" xlink:type="simple"/></inline-formula>，考虑类似循环矩阵的矩阵：</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x169_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x170_hanspub.png" xlink:type="simple"/></inline-formula></p><p>对这类矩阵，期望得到异或数低于12的MDS矩阵。</p><p>对已知异或总数为12的循环MDS矩阵的分析，发现总是可以表示成<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x171_hanspub.png" xlink:type="simple"/></inline-formula>或者<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x172_hanspub.png" xlink:type="simple"/></inline-formula>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x173_hanspub.png" xlink:type="simple"/></inline-formula>的异或数为1，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x174_hanspub.png" xlink:type="simple"/></inline-formula>的异或数为2。现在对24对矩阵序对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x175_hanspub.png" xlink:type="simple"/></inline-formula>中异或数为2的矩阵进行替换，即将某一个<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x176_hanspub.png" xlink:type="simple"/></inline-formula>替换为集合One中的元素。其中：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x177_hanspub.png" xlink:type="simple"/></inline-formula></p><p>考虑<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x178_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>很遗憾，使用程序7搜索并没有异或数小的MDS矩阵的出现。</p></sec><sec id="s4_3"><title>2.3. 轻量级Hadamard型 MDS矩阵的构造</title><p>记<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x179_hanspub.png" xlink:type="simple"/></inline-formula>为Hadamard循环矩阵：</p><disp-formula id="hanspub.24709-formula219"><graphic xlink:href="//html.hanspub.org/file/19-2620613x180_hanspub.png"  xlink:type="simple"/></disp-formula><p>要想<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x181_hanspub.png" xlink:type="simple"/></inline-formula>为MDS矩阵，则至少要求下列矩阵是满秩矩阵：</p><disp-formula id="hanspub.24709-formula220"><graphic xlink:href="//html.hanspub.org/file/19-2620613x182_hanspub.png"  xlink:type="simple"/></disp-formula><p>通过分析，若是采用全局程序搜索，当m = 4和8时程序运算量太大，故不实际，由此需要对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x183_hanspub.png" xlink:type="simple"/></inline-formula>进行特殊处理。</p><p>当m = 4时考虑如下三种特殊Hadamad矩阵：</p><p>1) 令<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x184_hanspub.png" xlink:type="simple"/></inline-formula>。要使得<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x185_hanspub.png" xlink:type="simple"/></inline-formula>为MDS矩阵，则下列矩阵一定为满秩矩阵：</p><disp-formula id="hanspub.24709-formula221"><graphic xlink:href="//html.hanspub.org/file/19-2620613x186_hanspub.png"  xlink:type="simple"/></disp-formula><p>使用程序8来搜索满足条件的此类MDS矩阵，发现此类MDS矩阵不存在。</p><p>2) 令<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x187_hanspub.png" xlink:type="simple"/></inline-formula>，即<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x188_hanspub.png" xlink:type="simple"/></inline-formula>，其二阶子方阵中</p><p>存在<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x189_hanspub.png" xlink:type="simple"/></inline-formula>。程序发现不存在此类MDS矩阵。</p><p>3) 令<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x190_hanspub.png" xlink:type="simple"/></inline-formula>。若<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x191_hanspub.png" xlink:type="simple"/></inline-formula>为MDS矩阵，则要求下列矩阵一定为满秩矩阵：</p><disp-formula id="hanspub.24709-formula222"><graphic xlink:href="//html.hanspub.org/file/19-2620613x192_hanspub.png"  xlink:type="simple"/></disp-formula><p>使用程序得到<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x193_hanspub.png" xlink:type="simple"/></inline-formula>型的MDS矩阵共有7917个，其中矩阵一行的最低异或数为4，并且，给出了48组这样的矩阵对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x194_hanspub.png" xlink:type="simple"/></inline-formula>使得<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x195_hanspub.png" xlink:type="simple"/></inline-formula>为MDS矩阵，且满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x196_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>例7：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x197_hanspub.png" xlink:type="simple"/></inline-formula></p><p>将这几种情形Hadamard矩阵总结如表2。</p><p>显见，此时得到的MDS矩阵异或总数并不是所有矩阵中最小的，与目标还有一定的距离。为此，考虑如何改进我们的矩阵，从而得到更优结果，还有待进一步的研究。</p><p>当m = 8时，考虑满足如下条件的Hadamard矩阵：</p><p>将<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x198_hanspub.png" xlink:type="simple"/></inline-formula>中所有非单位元的元素均拆分为如下形式：</p><disp-formula id="hanspub.24709-formula223"><graphic xlink:href="//html.hanspub.org/file/19-2620613x199_hanspub.png"  xlink:type="simple"/></disp-formula><p>再次对矩阵A的异或数做限定，令集合</p><disp-formula id="hanspub.24709-formula224"><graphic xlink:href="//html.hanspub.org/file/19-2620613x200_hanspub.png"  xlink:type="simple"/></disp-formula><p>构造这样的<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x201_hanspub.png" xlink:type="simple"/></inline-formula>，满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x202_hanspub.png" xlink:type="simple"/></inline-formula>，使用类似程序搜索得到了形如<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x203_hanspub.png" xlink:type="simple"/></inline-formula>的MDS矩阵有6693个，且矩阵异或总数最小为32，共有48个矩阵能够取得最小异或总数。</p><p>例8：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x204_hanspub.png" xlink:type="simple"/></inline-formula></p><p>令集合<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x205_hanspub.png" xlink:type="simple"/></inline-formula>，先取定<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x206_hanspub.png" xlink:type="simple"/></inline-formula>。检验此时的<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x207_hanspub.png" xlink:type="simple"/></inline-formula>是否为MDS矩阵，没有任何结果返回。这说明当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x208_hanspub.png" xlink:type="simple"/></inline-formula>时，根本不存在<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x209_hanspub.png" xlink:type="simple"/></inline-formula>型MDS矩阵。由此有如下定理。</p><p>定理2：已知<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x210_hanspub.png" xlink:type="simple"/></inline-formula>，如果<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x211_hanspub.png" xlink:type="simple"/></inline-formula>矩阵是MDS矩阵，则一定有<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x212_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec><sec id="s4_4"><title>2.4. 最佳MDS矩阵的构造</title><p>文献 [<xref ref-type="bibr" rid="hanspub.24709-ref8">8</xref>] 构造了一类MDS矩阵：</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Hadamard MDS matri</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >矩阵类型</th><th align="center" valign="middle" >生成元来源</th><th align="center" valign="middle" >MDS矩阵个数</th><th align="center" valign="middle" >最小异或数</th></tr></thead><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x213_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x214_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >/</td><td align="center" valign="middle" >/</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x215_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x216_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >/</td><td align="center" valign="middle" >/</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x217_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x218_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >7917</td><td align="center" valign="middle" >16</td></tr></tbody></table></table-wrap><p>表2. Hadamard MDS矩阵</p><disp-formula id="hanspub.24709-formula225"><graphic xlink:href="//html.hanspub.org/file/19-2620613x219_hanspub.png"  xlink:type="simple"/></disp-formula><p>文献 [<xref ref-type="bibr" rid="hanspub.24709-ref8">8</xref>] 中被称为最佳矩阵。基于这个思想，本小节研究如下矩阵：</p><disp-formula id="hanspub.24709-formula226"><graphic xlink:href="//html.hanspub.org/file/19-2620613x220_hanspub.png"  xlink:type="simple"/></disp-formula><p>要求L为MDS矩阵，则必有以下矩阵是满秩矩阵：</p><disp-formula id="hanspub.24709-formula227"><graphic xlink:href="//html.hanspub.org/file/19-2620613x221_hanspub.png"  xlink:type="simple"/></disp-formula><p>当m = 4时，考虑满足条件的<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x222_hanspub.png" xlink:type="simple"/></inline-formula>，使用程序9得到共48878个最佳MDS矩阵，其中存在43组满足条件的矩阵对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x223_hanspub.png" xlink:type="simple"/></inline-formula>，使得最佳MDS矩阵的异或数达到最小为13，即<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x224_hanspub.png" xlink:type="simple"/></inline-formula>，经观察，这些矩阵中的矩阵对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x225_hanspub.png" xlink:type="simple"/></inline-formula>均满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x226_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x227_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>例9：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x228_hanspub.png" xlink:type="simple"/></inline-formula></p><p>当m = 8时，考虑<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x229_hanspub.png" xlink:type="simple"/></inline-formula>中满足条件的<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x230_hanspub.png" xlink:type="simple"/></inline-formula>，基于m = 4时得到的结论，为找到异或数较低的MDS矩阵，不妨尝试令<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x231_hanspub.png" xlink:type="simple"/></inline-formula>，考虑二元域上所有异或数等于1的满秩矩阵，使用程序10，检验得到61,528个MDS矩阵，其中40320个异或数为10的最佳MDS矩阵。</p><p>例10：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x232_hanspub.png" xlink:type="simple"/></inline-formula></p></sec><sec id="s4_5"><title>2.5. 利用迭代寻找轻量级MDS矩阵</title><p>构造MDS矩阵可以利用有限域以及MDS码，除此以外，最常用的方法还有迭代法。迭代法的主要思想是通过利用较小分支数的扩散层重复作用，最终得到具有最大分支数的扩散层。实施此方法的第一步并不是构造一个MDS矩阵，这种新的设计策略在轻量级的哈希函数中被提出 [<xref ref-type="bibr" rid="hanspub.24709-ref9">9</xref>] ，例如PHOTON算法，在LED轻量分组密码的设计中被大量应用 [<xref ref-type="bibr" rid="hanspub.24709-ref10">10</xref>] 。典型的代表是利用线性反馈移位寄存器的构造。使用此方法，本小节中构造一些具有低异或数的MDS矩阵。</p><p>记LFSR MDS矩阵L具有如下形式：</p><disp-formula id="hanspub.24709-formula228"><graphic xlink:href="//html.hanspub.org/file/19-2620613x233_hanspub.png"  xlink:type="simple"/></disp-formula><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Lightweight MDS Matri</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >形式</th><th align="center" valign="middle" >d的范围</th><th align="center" valign="middle" >最小异或总数</th><th align="center" valign="middle" >MDS矩阵总个数</th></tr></thead><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x234_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >4~100</td><td align="center" valign="middle" >51</td><td align="center" valign="middle" >14,853</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x235_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >4~100</td><td align="center" valign="middle" >35</td><td align="center" valign="middle" >22,951</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x236_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >4~100</td><td align="center" valign="middle" >35</td><td align="center" valign="middle" >2733</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x237_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >4~100</td><td align="center" valign="middle" >41</td><td align="center" valign="middle" >21,575</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x238_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >4~100</td><td align="center" valign="middle" >39</td><td align="center" valign="middle" >16,197</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x239_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >4~100</td><td align="center" valign="middle" >24</td><td align="center" valign="middle" >16,185</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x240_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >4~100</td><td align="center" valign="middle" >42</td><td align="center" valign="middle" >20,211</td></tr></tbody></table></table-wrap><p>表3. 轻量级MDS矩阵</p><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x241_hanspub.png" xlink:type="simple"/></inline-formula>。由矩阵L迭代生成MDS矩阵时，迭代次数不超过100次。为了减少程序搜索量，考虑矩阵<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x242_hanspub.png" xlink:type="simple"/></inline-formula>中每一行的元素至多有两个不相关的变量。文献 [<xref ref-type="bibr" rid="hanspub.24709-ref9">9</xref>] 考虑矩阵<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x243_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x244_hanspub.png" xlink:type="simple"/></inline-formula>，可通过合适的线性变换得到一个MDS矩阵。不妨就取定<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x245_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x246_hanspub.png" xlink:type="simple"/></inline-formula></p><p>当<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x247_hanspub.png" xlink:type="simple"/></inline-formula>时，考虑<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x248_hanspub.png" xlink:type="simple"/></inline-formula>上的所有二元矩阵，然后将矩阵L带入进行运算，得到所有的矩阵(注意：此处假设迭代100次)。利用MDS矩阵的定义，使用程序11找出迭代后的所有MDS矩阵，总共得到18,882个MDS矩阵，其中具有最小异或数的矩阵有24个，这些矩阵的异或总数为42。此时的迭代次数d可以取到82。</p><p>例11：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x249_hanspub.png" xlink:type="simple"/></inline-formula></p><p>此时通过该形式迭代得到的MDS矩阵异或数不是很理想。虽然在<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/19-2620613x250_hanspub.png" xlink:type="simple"/></inline-formula>中我们并没有找到轻量级的MDS矩阵，但是通过修改生成元及其形式，有望得到异或数较小的MDS矩阵。使用以上的搜索策略，尝试了多种形式，均有MDS矩阵的返回，现将结果列于表3。</p></sec></sec><sec id="s5"><title>3. 总结</title><p>本文考虑具有小的异或数MDS矩阵的构造，使用循环、分块和迭代等思想来考虑MDS矩阵，分析MDS矩阵的性质，考虑特殊情况下的矩阵，分别对几种情况的特殊矩阵，在m = 4和8下，使用程序搜索，得到这些MDS矩阵的异或数最小的情况，并计数和给出相关例子。如何构造最小的异或数的MDS矩阵是一个有趣和实际应用的问题，需要进一步研究。</p></sec><sec id="s6"><title>基金项目</title><p>本文得到四川省科技厅2015年第一批科技计划项目(基本科研-重点研发) (2015JY0245)、四川省教育厅自然科学重点项目(15ZA0135)，在此表示感谢！</p></sec><sec id="s7"><title>文章引用</title><p>周 敏,顾 执. 轻量级MDS矩阵的构造 The Construction of Lightweight MDS Matrix[J]. 应用数学进展, 2018, 07(04): 429-445. https://doi.org/10.12677/AAM.2018.74054</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.24709-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Daemen, J. and Rijmen, V. (2001) The Wide Trail Design Strategy. Proceedings of the 8th IAM international Conference, Springer-Verlag, Berlin, Volume 2260: 222-238.</mixed-citation></ref><ref id="hanspub.24709-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Daemen, J. and Rijmen, V. (2002) The Design of Rijndael: AES—The Advanced Encryption Standard. Springer Science &amp; Business Media. &lt;br&gt;https://doi.org/10.1007/978-3-662-04722-4</mixed-citation></ref><ref id="hanspub.24709-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Rijmen, V., Daemen, J., Preneel, B., Bosselaers, A. and De Win, E. (1996) The cIpher SHARK. In: Fast Software Encryption. Vol. 1039 of Lecture Notes in Computer Science. Springer Berlin Heidelberg, 99-111.  
&lt;br&gt;https://doi.org/10.1007/3-540-60865-6_47</mixed-citation></ref><ref id="hanspub.24709-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Schneier, B., Kelsey, J., Whiting, D., Wagner, D., Hall, C. and Ferguson, N. (1998) Twoﬁsh: A 128-Bitblock Cipher. NIST AES Proposal, 15. http://dblp.uni-trier.de/db/conf/rsfdgrc/index.html</mixed-citation></ref><ref id="hanspub.24709-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Barreto, P. and Rijmen, V. (2000) The Khazad Legacy-Level Block Cipher. Submission to the Nessie Project, 97.  
http://dblp.uni-trier.de/db/conf/rsfdgrc/index.html</mixed-citation></ref><ref id="hanspub.24709-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Guo, J., Peyarin, T. and Poschmann, A. (2011) The PHOTON Family of Lightweight Hash Function. CRYPTO’11, Springer-Verlag, Berlin, Volume 6841: 222-239.</mixed-citation></ref><ref id="hanspub.24709-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Li, Y. and Wang, M. (2016) On the Construction of Lightweight Circulant Involutory MDS Matrices. FSE 2016. IACR Cryptology ePrint Archive, 2016: 406. http://eprint.iacr.org/</mixed-citation></ref><ref id="hanspub.24709-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Junod, P. and Vaudenay, S. (2004) Perfect Diffusion Primitives for Block Ciphers Building Efficient MDS Matrices. In: Handschuh, H. and Hasan, M.A., Eds., SAC 2004. LNCS, Volume 3357, 84-99. Springer, Heidelberg.</mixed-citation></ref><ref id="hanspub.24709-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Wu, S., Wang, M. and Wu, W. (2012) Recursive Diffusion Layers for (Lightweight) Block Ciphers and Hash Functions. In: Knudsen, L.R. and Wu, H., Eds., SAC 2012: Selected Areas in Cryptography, LNCS, Volume 7707, 355-371.  
&lt;br&gt;https://doi.org/10.1007/978-3-642-35999-6_23</mixed-citation></ref><ref id="hanspub.24709-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Guo, J., Peyrin, T., Poschmann, A. and Robshaw, M. (2011) The LED Block Cipher. In: Preneel, B. and Takagi, T., Eds., CHES 2011: Cryptographic Hardware and Embedded Systems, LNCS, Volume 6917, 326-341. Springer, Heidelberg. &lt;br&gt;https://doi.org/10.1007/978-3-642-23951-9_22</mixed-citation></ref></ref-list></back></article>