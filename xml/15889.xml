<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">MOS</journal-id><journal-title-group><journal-title>Modeling and Simulation</journal-title></journal-title-group><issn pub-type="epub">2324-8696</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/MOS.2015.43009</article-id><article-id pub-id-type="publisher-id">MOS-15889</article-id><article-categories><subj-group subj-group-type="heading"><subject>MOS20150300000_18291295.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject><subject> 工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于OPNET的动态路由协议仿真研究
  Simulation Research of Dynamic Routing Protocol Based on OPNET
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>仝</surname><given-names>磊</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>磊</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>冰</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>孔</surname><given-names>德阳</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>北京航天飞行控制中心，北京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>tonglei83@163.com(仝磊)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>18</day><month>08</month><year>2015</year></pub-date><volume>04</volume><issue>03</issue><fpage>72</fpage><lpage>79</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  合适的路由选择和设计不仅可以优化网络效能，还可以在一定程度上提高网络的安全性和可靠性。本文依据实体网络拓扑，利用OPNET搭建仿真环境，对动态路由协议中的RIP、OSPF和EIGRP三种协议的性能进行仿真对比分析。仿真结果表明，EIGRP在路由收敛时间以及网络队列时延上均具有较大性能优势，但由于EIGRP为思科设备私有协议，使得该协议的进一步推广受到考验；RIP受其算法限制，比较适合小型网络；OSPF协议由于其对各类规模网络均有不错的支持，所以其应用范围最广。网络路由协议的选择和设计要根据网络的实际情况具体问题具体分析，而在实际大型的网络中，静态和动态路由协议通常会被同时采用，以确保网络综合效能的最大化。
   The appropriate route selection and design not only can optimize network performance, but also can improve the safety and reliability of the network to a certain extent. This paper, based on physical network topology, uses OPNET simulation environment to simulate and comparatively analyzes the performance of dynamic routing protocols RIP, OSPF and EIGRP. Simulation results show that, on the routing convergence time and network queue delay, EIGRP has bigger perfor-mance advantages, however, because EIGRP is Cisco’s proprietary protocol device, the further promotion of it is challenged; RIP algorithm, subject to restrictions, is more suitable for small networks; OSPF protocol has good support for networks of all sizes, and it has the most extensive range of applications. Selection and design of network routing protocol should be based on the actual situation, but in the actual large-scale networks, static and dynamic routing protocol will usually be adopted at the same time, to ensure the maximum effectiveness of the integrated net-work.
 
</p></abstract><kwd-group><kwd>动态路由协议，RIP，OSPF，EIGRP, Dynamic Routing Protocol</kwd><kwd> RIP</kwd><kwd> OSPF</kwd><kwd> EIGRP</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于OPNET的动态路由协议仿真研究<sup> </sup></title><p>仝磊<sup>*</sup>，陈磊，刘冰，孔德阳</p><p>北京航天飞行控制中心，北京</p><p>Email: <sup>*</sup>tonglei83@163.com</p><p>收稿日期：2015年7月24日；录用日期：2015年8月12日；发布日期：2015年8月18日</p><disp-formula id="hanspub.15889-formula415"><graphic xlink:href="http://html.hanspub.org/file/2-2570067x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>合适的路由选择和设计不仅可以优化网络效能，还可以在一定程度上提高网络的安全性和可靠性。本文依据实体网络拓扑，利用OPNET搭建仿真环境，对动态路由协议中的RIP、OSPF和EIGRP三种协议的性能进行仿真对比分析。仿真结果表明，EIGRP在路由收敛时间以及网络队列时延上均具有较大性能优势，但由于EIGRP为思科设备私有协议，使得该协议的进一步推广受到考验；RIP受其算法限制，比较适合小型网络；OSPF协议由于其对各类规模网络均有不错的支持，所以其应用范围最广。网络路由协议的选择和设计要根据网络的实际情况具体问题具体分析，而在实际大型的网络中，静态和动态路由协议通常会被同时采用，以确保网络综合效能的最大化。</p><p>关键词 :动态路由协议，RIP，OSPF，EIGRP</p><disp-formula id="hanspub.15889-formula416"><graphic xlink:href="http://html.hanspub.org/file/2-2570067x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>随着网络的快速发展和越来越广泛而多样化的应用，网络结构和规模越来越复杂化。而合适的路由选择和设计不仅可以优化网络效能，还可以在一定程度上提高网络的安全性和可靠性。一般来说，路由协议可分为静态路由协议和动态路由协议。静态路由必须由专人手工将所有的网络位置输入到路由器的路由选择表中，一旦网络连接发生变化，必须对其进行手动更改以更新路由选择表；而运行动态路由协议的路由器可以不断更新各自对所有网络的感知，并将相关的信息加入到路由选择表中，当网络连接发生变化时，动态路由协议将根据各自的算法将这个变化自动通告给所有的路由器，自动完成路由选择表的更新。</p><p>本文依据某部实体网络拓扑，利用OPNET [<xref ref-type="bibr" rid="hanspub.15889-ref1">1</xref>] 搭建仿真环境，对动态路由协议中的RIP [<xref ref-type="bibr" rid="hanspub.15889-ref2">2</xref>] 、OSPF [<xref ref-type="bibr" rid="hanspub.15889-ref3">3</xref>] 和EIGRP [<xref ref-type="bibr" rid="hanspub.15889-ref4">4</xref>] 三种协议的性能进行仿真对比分析。</p></sec><sec id="s4"><title>2. 动态路由协议</title><p>动态路由协议就是路由器根据协议查找网络并更新路由选择表。一般来说，使用动态路由要比使用静态或默认路由容易，但会占用更多的路由器CPU处理时间和网络带宽。常用的动态路由协议有路由信息协议(Routing Information Protocol, RIP)、开放最短路径优先(Open Shortest Path First, OSPF)和增强内部网关路由协议(Enhanced Interior Gateway Routing Protocol, EIGRP)。</p><sec id="s4_1"><title>2.1. RIP</title><p>RIP是内部网关协议IGP中最先得到广泛使用的协议[<xref ref-type="bibr" rid="hanspub.15889-ref1">1</xref>] 。RIP是一种分布式的基于距离向量的路由选择协议，它在传输层使用UDP：520端口更新路由信息，是因特网的标准协议。RIP最大的优点是实现简单，开销小，并且是唯一的所有路由设备都支持的动态路由选择协议[<xref ref-type="bibr" rid="hanspub.15889-ref2">2</xref>] 。</p><p>RIP是一种纯粹的距离矢量路由选择协议，采用Bellman-Ford算法，每隔30秒就将自己的路由选择表从所有激活的接口上送出。RIP只将跳计数作为判断到达远程网络最佳路径的依据，并且在默认情况下允许的最大跳计数为15，也就是说16跳被认为不可达。在小型网络应用中，RIP可以很好的运行，但对于配备有慢速WAN链接的大型网络或安装有大量路由器的网络，它的运行效率就很低了。</p><p>RIP目前已经发展至三个版本，分别是Version 1 (RIPv1)，Version 2 (RIPv2)和RIP next generation (RIPng)。</p><p>RIPv1采用广播的方式进行路由更新，且只使用有类的路由选择，即网络中的所有设备都必须使用相同的子网掩码，这是因为在其发送的更新数据中不携带子网掩码信息。RIPv2采用组播的方式进行路由更新(224.0.0.9)，相对于RIPv1采用的广播方式，组播方式进一步降低了网络开销。并且，RIPv2还提供了前缀路由选择信息，并可以在路由更新中传输子网掩码信息，这样就支持了无类的路由选择，其适用性相对RIPv1得到大大增强[<xref ref-type="bibr" rid="hanspub.15889-ref3">3</xref>] 。RIPng使用在IPv6的网络环境中，本文暂不作论述。</p><p>本文仿真中采用RIPv2。</p></sec><sec id="s4_2"><title>2.2. OSPF</title><p>OSPF由IETF在上世纪80年代末期开发，OSPF是SPF类路由协议中的开放式版本，所有最短路径树(SPF)路由协议都基于数学算法——Dijkstra算法。OSPF也是一个内部网关协议，是基于链路状态的路由协议，支持VLSM、支持快速收敛、协议本身占用的带宽小、使用组播地址(224.0.0.5和224.0.0.6)完成路由更新、用成本(Cost)作为度量值。</p><p>OSPF [<xref ref-type="bibr" rid="hanspub.15889-ref5">5</xref>] 就是典型的链路状态路由协议，OSPF通过相邻路由器接口的状态来建立一个链路状态数据库，然后对该数据库根据一种SPF的算法计算出最佳路径，最后将最佳路径放入到路由表中。这就是说，基于链路状态的路由协议，不是只公告自己的路由表，而是经历了一个复杂的演算过程后才得到的路由表。另外，链路状态路由协议在理论上是不受连接数目限制的，而且收敛速度很快。所以，OSPF协议非常适合用在一个较大的网络环境中。</p><p>相对于采用距离矢量算法的RIP协议，OSPF协议具有更多的优点。OSPF与RIP的特点比较如表1所示。</p></sec><sec id="s4_3"><title>2.3. EIGRP</title><p>EIGRP是IGRP (Interior Gateway Routing Protocol，内部网关路由协议)的高级版本，是思科公司的私有路由协议。协议中也使用了自治系统的概念来描述相邻路由器的集合，处于自治系统中的路由器使用相同的路由选择协议并共享相同的路由选择信息。EIGRP的路由更新中包含了子网掩码，在设计网络时可以使用VLSM及人工汇总。</p><p>EIGRP结合了链路状态和距离矢量两种协议的特性，因此也被称为混合型路由选择协议。EIGRP不会像OSPF那样发送链路状态数据包，相反，它所发送的是传统的距离矢量更新，在此更新中包含有网络信息以及从发出通告的路由器达到这些网络的开销。此外，EIGRP也拥有链路状态的特性，它会在启动时同步相邻路由器上的路由表，并在每拓扑结构发生改变时发送特定的更新数据。EIGRP默认跳计数为100，最大为255，但它不会像RIP那样使用跳计数作为度量。对EIGRP来说，跳计数只是用来限定EIGRP路由更新数据包在被抛弃之前可以经过的路由器个数。所以，EIGRP非常适用特大型网络的应用。</p><p>EIGRP拥有许多强大的功能，主要包括：</p><p>1) 通过协议相关模块支持IPv4和IPv6以及一些应用不太广泛的其他被路由协议；</p><p>2) 与RIPv2和OSPF一样是无类路由协议；</p><p>3) 支持VLSM/CIDR；</p><p>4) 支持汇总和不连续网络；</p><p>5) 高效的邻居发现；</p><p>6) 基于可靠传输协议(RTP)的通信；</p><p>7) 基于弥散更新算法(DUAL)的最佳路径选择，收敛速度更快。</p></sec></sec><sec id="s5"><title>3. 仿真与分析</title><sec id="s5_1"><title>3.1. 仿真环境的设计</title><p>本文采用OPNET设计搭建了包括四个子网的仿真环境，分别为A区、B区、C区和D区，各子网路由器通过OC1方式交叉互联，如图1所示。</p><p>A区子网为服务器以及网管局域网，路由器下接一台核心交换机，核心交换机下接各类型应用服务器(IP电话、FTP、Email以及HTTP)以及包括10台计算机用户终端的LAN A，如图2(a)所示；B区和C区均为小型局域网，各自路由器均下接4台接入交换机，各接入交换机下接10台计算机用户终端，分别如图2(b)、图2(c)所示；D区为中型局域网，路由器下接一台核心交换机，核心交换机下接8台接入交换机，各接入交换机下接20台计算机用户终端，如图2(d)所示；各区子网内部均为1000 Base-T方式连接。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Comparison between RIP and OSP</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >特性</th><th align="center" valign="middle" >OSPF</th><th align="center" valign="middle" >RIPv2</th><th align="center" valign="middle" >RIPv1</th></tr></thead><tr><td align="center" valign="middle" >协议特性</td><td align="center" valign="middle" >链路状态</td><td align="center" valign="middle" >距离矢量</td><td align="center" valign="middle" >距离矢量</td></tr><tr><td align="center" valign="middle" >无类支持</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >否</td></tr><tr><td align="center" valign="middle" >VLSM支持</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >否</td></tr><tr><td align="center" valign="middle" >自动汇总</td><td align="center" valign="middle" >否</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >是</td></tr><tr><td align="center" valign="middle" >手动汇总</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >否</td></tr><tr><td align="center" valign="middle" >不连续支持</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >否</td></tr><tr><td align="center" valign="middle" >路由传播</td><td align="center" valign="middle" >可变化的组播</td><td align="center" valign="middle" >周期性组播</td><td align="center" valign="middle" >周期性广播</td></tr><tr><td align="center" valign="middle" >路径度量</td><td align="center" valign="middle" >带宽</td><td align="center" valign="middle" >跳</td><td align="center" valign="middle" >跳</td></tr><tr><td align="center" valign="middle" >跳计数限制</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >15</td><td align="center" valign="middle" >15</td></tr><tr><td align="center" valign="middle" >汇聚</td><td align="center" valign="middle" >快</td><td align="center" valign="middle" >慢</td><td align="center" valign="middle" >慢</td></tr><tr><td align="center" valign="middle" >对等认证</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >是</td><td align="center" valign="middle" >否</td></tr><tr><td align="center" valign="middle" >分层网络需求</td><td align="center" valign="middle" >是(使用区域)</td><td align="center" valign="middle" >否(只是平面)</td><td align="center" valign="middle" >否(只是平面)</td></tr><tr><td align="center" valign="middle" >更新</td><td align="center" valign="middle" >事件触发</td><td align="center" valign="middle" >路由表更新</td><td align="center" valign="middle" >路由表更新</td></tr><tr><td align="center" valign="middle" >路由计算</td><td align="center" valign="middle" >Dijkstra</td><td align="center" valign="middle" >Bellman-Ford</td><td align="center" valign="middle" >Bellman-Ford</td></tr></tbody></table></table-wrap><p>表1. OSPF与RIP的比较</p><p>图1. 仿真拓扑</p></sec><sec id="s5_2"><title>3.2. 仿真场景设置</title><p>本文仿真中，各交换机均采用三层VLAN方式互联。在最初的仿真场景中设置启用RIP协议，并以此为基础，复制出两个场景，分别启用OSPF和EIGPR协议。设置运行路由协议后的网络如图3所示。仿真时间设置为10分钟。</p></sec><sec id="s5_3"><title>3.3. 仿真结果分析</title><p>为更为全面的对比三种动态路由协议的性能，本文选取路由收敛时间、A区核心交换机CPU利用率、网络队列时延以及协议发送流量四个参数进行统计对比分析。</p><p>1) 路由收敛时间</p><p>路由收敛时间直接反映协议性能。三种路由的收敛时间对比如图4所示：从图中可以看出，采用</p><p>图2. 各局域网拓扑：(a) 局域网A；(b) 局域网B；(c) 局域网C；(d) 局域网D</p><p>图3. 仿真路由设置</p><p>EIGRP的网络收敛时间在3.8 ms左右，RIP完成收敛小于8 s，而OSPF收敛最慢，用了近70 s才完成收敛。OSPF由于其初次收敛需要计算各路由器链接链路开销，所以其初次收敛速度较慢；但一旦完成首次收敛，各路由将经过路由器存储在本地的数据库中，当发生网络更新的时候将不需要被动的询问邻居路由器，所以OSPF在以后的收敛时间会大幅压缩。总的来说，EIGRP在收敛时间上拥有教大的优势。</p><p>2) A区核心交换机CPU利用率</p><p>A区核心交换机为全网服务器的数据提供交换服务，其CPU利用率也是反映路由性能的重要指标。各仿真场景中A区核心交换机CPU利用率对比如图5所示：从图中可以看到，采用RIP协议的网络中，核心交换机CPU利用率最大，而采用OSPF的网络中，核心交换机CPU利用率最小。这是由于OSPF用于发现和维护邻居关系的是定期发送的是不含路由信息的HELLO报文，非常短小，并且使用组播方式(而非广播)发送报文，大大降低了网络设备CPU的利用率。</p><p>3) 网络队列时延</p><p>从图6中可以看到，采用RIP协议的网络队列时延最大，而采用EIGRP的网络队列时延最小。可见，在队列时延上，EIGRP也存在较大的性能优势。这是由于OSPF和EIGRP均是链路状态协议，而RIP是距离矢量协议，而路由状态协议较之距离矢量协议在路由算法拥有较大优势，所以可以大幅降低网络队列时延。</p><p>图4. 收敛时间对比</p><p>图5. A区核心交换机CPU利用率</p><p>4) 协议发送流量</p><p>从协议发送流量对比上看，OSPF发送的流量最多，而RIP发送的流量最少，EIGRP除了仿真刚开始时会突发大量流量，随后即立即减少，如图7所示。这是由于OSPF和EIGRP作为链路状态协议，在网络收敛前要需要全网洪泛链路状态请求报文，所以在仿真初期会有大量的协议发送流量；当整个网络完成收敛后，发送流量将大大减少。</p></sec></sec><sec id="s6"><title>4. 结语</title><p>本文通过OPNET搭建仿真环境，对动态路由协议中最常用的RIP、OSPF和EIGRP进行了仿真，对其性能进行了对比分析。对比仿真结果可以看到，EIGRP在路由收敛时间已经网络队列时延上均具有较大性能优势，而且随着网络规模的增大以及复杂，其优势也会越来越明显。但由于EIGRP为思科设备私有协议，而随着“斯诺登”事件的影响，国内越来越多的用户开始采用华为、华三等厂商设备替代原思科设备，使得该协议的进一步推广受到考验。RIP受其算法限制，在一般大型网络中较少采用，但其配置简单，比较适合小型网络。OSPF协议由于其对各类规模网络均有不错的支持，且被几乎所有网络设备</p><p>图6. 网络队列时延</p><p>图7. 协议发送流量</p><p>提供商所采用，所以其应用范围最广。</p><p>总的来说，网络路由协议的选择和设计要根据网络的实际情况具体问题具体分析，而在实际大型的网络中，静态和动态路由协议通常会被同时采用，以确保网络综合效能的最大化。</p></sec><sec id="s7"><title>参考文献(References)</title><p>[<xref ref-type="bibr" rid="hanspub.15889-ref1">1</xref>] Sethi, A.S., et al., 著, 王玲芳, 母景琴, 等, 译 (2014) 计算机网络仿真OPNET实用指南. 机械工业出版社, 北京.</p><p>[<xref ref-type="bibr" rid="hanspub.15889-ref2">2</xref>] 李琨, 俞忠原, 薛小平 (2002) RIP协议分析与仿真研究. 计算机工程, 3, 85-86, 147.</p><p>[<xref ref-type="bibr" rid="hanspub.15889-ref3">3</xref>] 赵天福, 周丹平 (2008) 基于OSPF协议的网络拓扑发现技术的实现. 江南大学学报(自然科学版), 2, 151-156.</p><p>[<xref ref-type="bibr" rid="hanspub.15889-ref4">4</xref>] 格拉齐亚尼(Graziani, R.)著, 思科系统公司, 译 (2009) 思科网络技术学院教程CCNA Exploration: 路由协议和概念. 人民邮电出版社, 北京.</p><p>[<xref ref-type="bibr" rid="hanspub.15889-ref5">5</xref>] 倪勇, 史怀洲, 朱培栋 (2009) 基于OSPF链路状态数据库构建网络拓扑. 计算机技术与发展, 3, 1-4.</p></sec></body><back><ref-list><title>References</title><ref id="hanspub.15889-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Sethi, A.S., et al., 著, 王玲芳, 母景琴, 等, 译 (2014) 计算机网络仿真OPNET实用指南. 机械工业出版社, 北京.</mixed-citation></ref><ref id="hanspub.15889-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">李琨, 俞忠原, 薛小平 (2002) RIP协议分析与仿真研究. 计算机工程, 3, 85-86, 147.</mixed-citation></ref><ref id="hanspub.15889-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">赵天福, 周丹平 (2008) 基于OSPF协议的网络拓扑发现技术的实现. 江南大学学报(自然科学版), 2, 151-156.</mixed-citation></ref><ref id="hanspub.15889-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">格拉齐亚尼(Graziani, R.)著, 思科系统公司, 译 (2009) 思科网络技术学院教程CCNA Exploration: 路由协议和概念. 人民邮电出版社, 北京.</mixed-citation></ref><ref id="hanspub.15889-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">倪勇, 史怀洲, 朱培栋 (2009) 基于OSPF链路状态数据库构建网络拓扑. 计算机技术与发展, 3, 1-4.</mixed-citation></ref></ref-list></back></article>