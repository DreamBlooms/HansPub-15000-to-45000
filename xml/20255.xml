<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JISP</journal-id><journal-title-group><journal-title>Journal of Image and Signal Processing</journal-title></journal-title-group><issn pub-type="epub">2325-6753</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JISP.2017.62012</article-id><article-id pub-id-type="publisher-id">JISP-20255</article-id><article-categories><subj-group subj-group-type="heading"><subject>JISP20170200000_13585225.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于阈值标记的分水岭算法道路提取
  Road Extraction Based on Threshold Labeling Watershed Algorithm
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>登未</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>汪</surname><given-names>西原</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>胜男</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>宁夏大学物理与电子电气工程学院，宁夏 银川</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1967543173@qq.com(黄登)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>20</day><month>04</month><year>2017</year></pub-date><volume>06</volume><issue>02</issue><fpage>98</fpage><lpage>105</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   分水岭算法易产生过分割现象，本文提出一种基于阈值标记的分水岭分割方法，能更为精准提取遥感图像中的道路信息。该方法对遥感图像进行中值滤波及直方图均衡化预处理；经多尺度形态学梯度计算出最大梯度值、进行低通滤波，然后使用二维最大熵求阈值、完成扩展的极小值变换，通过这些标记对梯度幅度图像加以修正；最后实现标记梯度图像的分水岭变换，利用形状特征提取图像中的道路信息。本文使用MATLAB仿真软件对银川某地的遥感图像进行道路提取，实验结果表明：该算法可以提取出较为精确、清晰的道路信息。 Aiming at the phenomenon that the watershed algorithm is easy to produce over segmentation, a watershed segmentation method based on threshold marking is proposed to extract road information in remote sensing image. Firstly, the median filtering and histogram equalization of remote sensing images are pre-processed, and then the pre-processed image is processed to obtain the multi-scale morphological gradient, and the maximum morphological gradient is obtained by low pass filtering. Then threshold is calculated by the 2D maximum entropy, extending minima transform with the income threshold, using these markers to modifier gradient magnitude image; finally, the marked gradient image was carried out by watershed transform using shape feature to extract the road information in the image. MATLAB is used to extract the road from a remote sensing image of Yinchuan. The experimental results show that the algorithm can extract the road information in the image very well.
    
  
 
</p></abstract><kwd-group><kwd>遥感图像，分水岭算法，标记提取，道路提取, Remote Sensing Image</kwd><kwd> Watershed Algorithm</kwd><kwd> Mark Extraction</kwd><kwd> Morphological Road Extraction</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于阈值标记的分水岭算法道路提取<sup> </sup></title><p>黄登未<sup>*</sup>，汪西原<sup>#</sup>，王胜男</p><p>宁夏大学物理与电子电气工程学院，宁夏 银川</p><disp-formula id="hanspub.20255-formula12"><graphic xlink:href="http://html.hanspub.org/file/4-2670103x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2017年4月7日；录用日期：2017年4月23日；发布日期：2017年4月26日</p><disp-formula id="hanspub.20255-formula13"><graphic xlink:href="http://html.hanspub.org/file/4-2670103x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>分水岭算法易产生过分割现象，本文提出一种基于阈值标记的分水岭分割方法，能更为精准提取遥感图像中的道路信息。该方法对遥感图像进行中值滤波及直方图均衡化预处理；经多尺度形态学梯度计算出最大梯度值、进行低通滤波，然后使用二维最大熵求阈值、完成扩展的极小值变换，通过这些标记对梯度幅度图像加以修正；最后实现标记梯度图像的分水岭变换，利用形状特征提取图像中的道路信息。本文使用MATLAB仿真软件对银川某地的遥感图像进行道路提取，实验结果表明：该算法可以提取出较为精确、清晰的道路信息。</p><p>关键词 :遥感图像，分水岭算法，标记提取，道路提取</p><disp-formula id="hanspub.20255-formula14"><graphic xlink:href="http://html.hanspub.org/file/4-2670103x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>遥感技术的飞速发展使航天飞机和各种卫星系统可提供大量遥感影像，其分辨率也越来越高，为遥感影像的应用提供了便利条件；从高分辨率遥感影像中提取道路信息是目标检测与识别的研究热点，道路信息的提取方法研究基本上可以分为三类：基于边缘提取、基于区域分割提取和两者相结合。</p><p>Nevatia [<xref ref-type="bibr" rid="hanspub.20255-ref1">1</xref>] 等以提取梯度方向相对平行的边缘为基础，从边缘提取着手，再提取梯度幅度阈值并将近似方向的点连成线段，最后将之编成相对平行的线对，但它基于道路对比度不变的不完备假设，会产生很多问题。Zhu [<xref ref-type="bibr" rid="hanspub.20255-ref2">2</xref>] 等釆用相对平行的边缘来选择种子点，并根据边缘的强度与长度等的相似程度来连接，同时利用了机遇规则的系统；这种方法简单的假设图像没有噪声兵器道路与背景具有较高的对比度，使得其适应性不高。Fischle [<xref ref-type="bibr" rid="hanspub.20255-ref3">3</xref>] 等从较低分辨率的图像上根据像素灰度值和对比度来计算像素为道路点的得分，以便形成代价阵列，釆用最小代价路径的图搜索方法(例如动态规划)进行求解；它的缺点是代价函数很难确定，可能会造成错误。胡翔云 [<xref ref-type="bibr" rid="hanspub.20255-ref4">4</xref>] 研究的对象是小比例尺图像中非城市地区的道路网，重点研究了一种基于感知编组的自动形成道路网的方法，这种方法基于概率模型，同时有上下文信息作为支持；然后构建了一个实验系统及框架，这个框架的可行性较强，同时便于扩充。文贡坚 [<xref ref-type="bibr" rid="hanspub.20255-ref5">5</xref>] 等提出了提取比较直的主干道路网的方法，这种方法针对的图像是城市航空图像；首先整幅图像被分成若干块，然后在每一个子块中基于直线来提取检测道路段，较完整的道路网可以自动连接形成；其优势在于中层符号是使用直线的，而且直线提取算法比较稳健。</p><p>基于以上的道路提取方法及遥感图像的特点，本研究通过中值滤波及直方图增强，不仅能去除图像噪声，还能较好地保持目标的边缘轮廓信息，再用阈值标记来修改梯度图像，从而有效解决了分水岭算法产生的过分割问题，可以更精确地提取图像中的道路信息。</p></sec><sec id="s4"><title>2. 遥感图像的多尺度形态学梯度与最大熵阈值求取</title><p>待处理的原始图像整体偏暗，首先使用直方图均衡化来增强道路与周边环境的差异；再采用中值滤波处理，在保持图像边缘的同时有效去除椒盐噪声，可缓解分水岭过度分割。</p><sec id="s4_1"><title>2.1. 多尺度形态学梯度算法</title><p>分水岭算法处理的是梯度图像，本研究对象为彩色图像，因此我们先求每个通道的梯度，再取最大的梯度，来获得梯度图像。腐蚀和膨胀是形态学图像处理、获取梯度的两个最基本操作。腐蚀是在图像中“收缩”或“细化”的操作，结构元素<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x10_hanspub.png" xlink:type="simple"/></inline-formula>对一幅图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x11_hanspub.png" xlink:type="simple"/></inline-formula>在位置<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x12_hanspub.png" xlink:type="simple"/></inline-formula>的腐蚀定义为(1)式，腐蚀处理由包含在与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x13_hanspub.png" xlink:type="simple"/></inline-formula>重合区域中的所有值中选取的最小值决定；膨胀是在图像中“加长”或“变粗”的操作，结构元素<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x14_hanspub.png" xlink:type="simple"/></inline-formula>对一幅图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x15_hanspub.png" xlink:type="simple"/></inline-formula>在位置<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x16_hanspub.png" xlink:type="simple"/></inline-formula>的膨胀定义为(2)式，膨胀处理由包含在与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x17_hanspub.png" xlink:type="simple"/></inline-formula>重合区域中的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x18_hanspub.png" xlink:type="simple"/></inline-formula>的所有值中选取的最大值决定。对一幅待分割彩色输入图象<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x19_hanspub.png" xlink:type="simple"/></inline-formula>的单尺度形态学梯度可定义为(3)式，该式表明梯度图像计算结果主要取决于结构元素的尺寸和形状。</p><disp-formula id="hanspub.20255-formula15"><label>(1) (2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x20_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.20255-formula16"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x22_hanspub.png"  xlink:type="simple"/></disp-formula><p>由于圆盘状结构元素具有各向同性的性质，使得形态学梯度图像更少地依赖边缘的方向 [<xref ref-type="bibr" rid="hanspub.20255-ref6">6</xref>] ，本文选择具有各向同性的圆盘状“disk”作为结构元素，可以避免图像特征的畸变。如果结构元素尺寸过大会导致图像物体边缘受损，造成边缘与梯度值的不一致性；如果结构元素过小，会致使梯度算子对斜坡边缘产生小的输出，影响分割结果。所以，本文使用多尺度特性计算梯度。设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x23_hanspub.png" xlink:type="simple"/></inline-formula>为结构元素<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x24_hanspub.png" xlink:type="simple"/></inline-formula>的半径，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x25_hanspub.png" xlink:type="simple"/></inline-formula>为结构元素的最大半径，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x26_hanspub.png" xlink:type="simple"/></inline-formula>为结构元素的最小半径，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x27_hanspub.png" xlink:type="simple"/></inline-formula>表示权值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x28_hanspub.png" xlink:type="simple"/></inline-formula>分别代表彩色图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x29_hanspub.png" xlink:type="simple"/></inline-formula>的RGB三个彩色分量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x30_hanspub.png" xlink:type="simple"/></inline-formula>表示不同彩色分量、不同尺寸下的形态学梯度，则多尺度形态学梯度定义为(4)式。彩色图像转换为梯度图像可定义为(5)式，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x31_hanspub.png" xlink:type="simple"/></inline-formula>分别代表彩色图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x32_hanspub.png" xlink:type="simple"/></inline-formula>的R、G、B的三个彩色分量的形态学梯度。这样通过计算彩色图像梯度，可以将彩色图像转化为灰度图像。</p><disp-formula id="hanspub.20255-formula17"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x33_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.20255-formula18"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x34_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s4_2"><title>2.2. 低通滤波</title><p>分水岭算法产生的过分割主要是由于图像中的细节纹理和噪声产生的伪极小值造成的。基于标记约束的分水岭算法是从预先指定的种子点开始浸水，因此只要能够对物体进行准确的相关标记即可得到理想的实验目标，达到识别图像的目的。梯度幅度图像在沿对象的边缘处有较高的像素值，能够突显图像的噪声，与此同时还能减弱图像中较为平坦的区域，从而增强图像中的噪声与图像物体内容之间的差异，此时使用滤波器能够很容易将那些凸显出来的孤立噪声滤除掉。因此从梯度图像的低频成分中提取与物体相关的极小值能够得到比从原始图像的低频成分中更加准确的结果。本文算法对形态学梯度，使用巴特沃斯低通滤波滤波器来计算图像的低频成分 [<xref ref-type="bibr" rid="hanspub.20255-ref7">7</xref>] ，获得空间域的彩色图像梯度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x35_hanspub.png" xlink:type="simple"/></inline-formula>，有效地克服了先验知识对标记提取的困难。</p></sec><sec id="s4_3"><title>2.3. 最大熵求阈值</title><p>对梯度图像中的低频成分采用二维最大熵算法来自动获取阈值。最大熵阈值分割方法是利用直方图灰度统计信息来构造判别函数取极值的模式来获取最佳分割阈值。假设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x36_hanspub.png" xlink:type="simple"/></inline-formula>的灰度级为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x37_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x38_hanspub.png" xlink:type="simple"/></inline-formula>为图像各灰度级出现的频率，梯度图像邻域的平均灰度也有<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x39_hanspub.png" xlink:type="simple"/></inline-formula>级。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x40_hanspub.png" xlink:type="simple"/></inline-formula>为总像素，二维直方图为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x41_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x42_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x43_hanspub.png" xlink:type="simple"/></inline-formula>是像素灰度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x44_hanspub.png" xlink:type="simple"/></inline-formula>是邻域平均灰度。梯度图像中灰度i及其邻域灰度均值j的像素点数由<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x45_hanspub.png" xlink:type="simple"/></inline-formula>表示，那么<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x46_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x47_hanspub.png" xlink:type="simple"/></inline-formula>满足</p><disp-formula id="hanspub.20255-formula19"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x48_hanspub.png"  xlink:type="simple"/></disp-formula><p>目标和背景的概率累计分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x49_hanspub.png" xlink:type="simple"/></inline-formula>、<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x50_hanspub.png" xlink:type="simple"/></inline-formula>分别为</p><disp-formula id="hanspub.20255-formula20"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x51_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.20255-formula21"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x52_hanspub.png"  xlink:type="simple"/></disp-formula><p>定义其目标和背景的二维熵为</p><disp-formula id="hanspub.20255-formula22"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x53_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.20255-formula23"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x54_hanspub.png"  xlink:type="simple"/></disp-formula><p>此梯度图像总熵的判别函数通过变换定义为</p><disp-formula id="hanspub.20255-formula24"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x55_hanspub.png"  xlink:type="simple"/></disp-formula><p>公式中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x56_hanspub.png" xlink:type="simple"/></inline-formula>满足</p><disp-formula id="hanspub.20255-formula25"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x57_hanspub.png"  xlink:type="simple"/></disp-formula><p>最终选取的阈值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x58_hanspub.png" xlink:type="simple"/></inline-formula>满足</p><disp-formula id="hanspub.20255-formula26"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/4-2670103x59_hanspub.png"  xlink:type="simple"/></disp-formula><p>因此通过这种二维最大熵算法自动获取阈值对标记进行扩展地极小值变换，可以有效地屏蔽伪极小值对分割结果的影响，使局部极小值仅出现在标记的位置，有效地消除了人工标记的困难，具有较高的鲁棒性。</p></sec></sec><sec id="s5"><title>3. 基于标记的分水岭分割</title><sec id="s5_1"><title>3.1. 分水岭算法</title><p>1991年，Vincent和Soille将分水岭算法 [<xref ref-type="bibr" rid="hanspub.20255-ref8">8</xref>] 应用于图像处理，把一副原始图像想象成图1所示的一个地形表面，这个地形表面有一系列的山谷，每一个谷就代表着一个较小连通区域或较小值像素，设想所有的谷底被刺穿，谷底开始积水，水平面开始匀速上升，积水的面会漫过这个集水盆地，为了防止积水面漫过盆地，在盆地间筑坝，这些坝就形成了分水岭。分水岭分割就类似于这个漫水过程。</p><p>分水岭算法分为排序和淹没两个操作：</p><p>图1. 分水岭概念示意图</p><p>1) 排序：在积水过程中，按升序排列所有像素亮度值，相同亮度值的像素被存入同一列表，在淹没过程中便于一起访问相同亮度值的全部像素，提高了分割速度；</p><p>2) 淹没：当水从区域极小值处逐渐对图像拓扑表面进行淹没时，按照像素亮度值升序访问每一个像素点，从最小亮度值像素开始标记每一个集水盆地，在对相同亮度值的像素进行访问时，从与标记集水盆地相邻的像素开始，根据测地距离，确定像素被标记处理的顺序，按照先入先出的原则，实现对同一亮度级的像素进行淹没，确定这些像素的标号。</p></sec><sec id="s5_2"><title>3.2. 阈值标记的分水岭分割</title><p>通过采用梯度图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x61_hanspub.png" xlink:type="simple"/></inline-formula>作为分水岭的分割图像，用提取到的标记对原始梯度图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x62_hanspub.png" xlink:type="simple"/></inline-formula>进行修改，屏蔽掉原有图像中的所有局部极小值 [<xref ref-type="bibr" rid="hanspub.20255-ref9">9</xref>] ，修改后的梯度图像中，局部极小值只存在二值标记图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x63_hanspub.png" xlink:type="simple"/></inline-formula>中不为</p><p>零的地方。修改后的标记图像用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x64_hanspub.png" xlink:type="simple"/></inline-formula>表示，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x65_hanspub.png" xlink:type="simple"/></inline-formula>(式中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x66_hanspub.png" xlink:type="simple"/></inline-formula>表示形态学极小值标定技术的操作。然后在修改后的梯度图像<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x67_hanspub.png" xlink:type="simple"/></inline-formula>上应用分水岭分割，得到最终的理想分割结果，用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x68_hanspub.png" xlink:type="simple"/></inline-formula>表示，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x69_hanspub.png" xlink:type="simple"/></inline-formula>表示分水岭算法的分割操作算子，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/4-2670103x70_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec><sec id="s5_3"><title>3.3. 算法实现</title><p>1) 对图像进行直方图均衡化，中值滤波预处理。</p><p>2) 对预处理后的图像求RGB分量的多尺度形态学梯度，并求得最大的形态学梯度。</p><p>3) 对最大的形态学梯度进行提取原始图像内部标记，对原始图像进行巴特沃斯低通滤波。</p><p>4) 用二维最大熵求梯度图像的阈值 [<xref ref-type="bibr" rid="hanspub.20255-ref10">10</xref>] ，并用阈值对梯度图像进行扩展的极小值变换。</p><p>5) 修改梯度图像，用分水岭变换分割图像，提取里面的道路信息。</p></sec></sec><sec id="s6"><title>4. 实验结果与分析</title><p>实验数据选取资源三号国产卫星提供的样图中的一部分(图2)，图像分辨率为2.1米，尺寸为385 &#215; 354，测试在Matlab (R2010a)上运行。对原始图像进行预处理。从图3与图4，可以看出图像的对比度明显增强；图5为最大形态学梯度图像，选择的尺寸分别为1、2、3，图6为低通滤波后的图像，我们选择的截止频率为50 HZ；采用原始分水岭算法和改进的分水岭算法。图7与图8对比发现改进后的分水岭算法不仅能够将遥感图像的道路信息分割出来，还可以得到较为清晰的道路信息。</p><p>以上结果图像可以看出，道路区域的面积不会很小，这样就可以再次过滤掉分割后的小面积，从而</p><p>图2. 样图</p><p>图3. 样图一部分</p><p>图4. 预处理图像</p><p>图5. 最大形态学梯度</p><p>图6. 滤波图像</p><p>图7. 传统算法</p><p>图8. 改进的算法</p><p>图9. 道路信息</p><p>只留下提取的道路信息。道路本身具有一定的长度和宽度 [<xref ref-type="bibr" rid="hanspub.20255-ref11">11</xref>] ，目标长度越长，则为道路的可能性越大；目标宽度越宽，则为道路的可能性越小。分割后图像中的道路信息如图9所示，和原图对比后发现，道路信息不仅提取完成，而且提高道路信息的精准性。</p></sec><sec id="s7"><title>5. 结束语</title><p>本文计算梯度图像，使用中值滤波与直方图增强处理图像，较好地去除了噪声以及增强了图像的对比度，目标轮廓清晰，便于后续分水岭变换。提出了利用阈值标记的分水岭分割方法，并利用道路的形状特征提取道路，并在Matlab R2010a软件平台进行了仿真实验。实验结果表明，该方法可以很好地提取图像中的道路信息。</p></sec><sec id="s8"><title>基金项目</title><p>国家自然科学基金项目(41561087)：多源遥感影像的分层特征信息提取与宁夏生态环境地物目标分类识别。</p></sec><sec id="s9"><title>文章引用</title><p>黄登未,汪西原,王胜男. 基于阈值标记的分水岭算法道路提取Road Extraction Based on Threshold Labeling Watershed Algorithm[J]. 图像与信号处理, 2017, 06(02): 98-105. http://dx.doi.org/10.12677/JISP.2017.62012</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.20255-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Nevatia, R. and Babu, K. (1980) Liner Feature Extraction and Description. IEEE CGIP, 13, 257-269.</mixed-citation></ref><ref id="hanspub.20255-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Zhu, M. and Yeh, P. (1986) Automatic Road Network Extraction on Aerial Photographs. IEEE Computer Society Press, New York, 34-40.</mixed-citation></ref><ref id="hanspub.20255-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Fischlen, M., Tenenbaum, J. and Wolf, H. (1987) Detection of Roads and Linear Structures in Low-Resolution Aerial Imagery Using a Multisource Knowledge Integration Technique. Association for Computing Machine, 15, 741-752.</mixed-citation></ref><ref id="hanspub.20255-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">胡翔云. 航空遥感图像线状地物与房屋的半自动提取[D]. 武汉: 武汉大学, 2001.</mixed-citation></ref><ref id="hanspub.20255-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">文贡坚, 王润生. 从航空遥感图像中自动提取主要道路[J]. 软件学报, 2000, 11(7): 957-964.</mixed-citation></ref><ref id="hanspub.20255-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">李晓龙, 帅仁俊. 一种基于形态学的脑肿瘤分割[J]. 液晶与显示, 2015, 30(1): 157-162.</mixed-citation></ref><ref id="hanspub.20255-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">陈传峰, 朱长仁, 宋洪芹. 基于巴特沃斯低通滤波器的图像增强[D]. 长沙: 国防科技大学, 2012.</mixed-citation></ref><ref id="hanspub.20255-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">刁智华, 赵春江, 郭新宇, 陆声链, 王秀徽. 分水岭算法的改进方法研究[J]. 计算机工程, 2010, 36(17):1-6.</mixed-citation></ref><ref id="hanspub.20255-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">张海涛, 李雅男. 阈值标记的分水岭彩色图像分割[J]. 中国图像图形学报, 2015, 20(12): 1602-1611.</mixed-citation></ref><ref id="hanspub.20255-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">李孟歆, 贾燕雯, 姜佳楠. 基于灰度-梯度二维最大熵阈值法的赤足迹轮廓提取[J]. 电子技术与软件工程, 2016, 16(1): 97-98.</mixed-citation></ref><ref id="hanspub.20255-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">雷小奇, 王卫星, 赖均. 一种基于形状特征进行高分辨率遥感影像道路提取方法[J]. 测绘学报, 2009, 38(5): 458-464.</mixed-citation></ref></ref-list></back></article>