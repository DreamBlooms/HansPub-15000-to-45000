<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2020.101005</article-id><article-id pub-id-type="publisher-id">CSA-33887</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20200100000_94847262.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于STM32的空调服智能控制系统设计
  Design of Intelligent Control System for Air-Conditioning Clothing Based on STM32
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>勤陆</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>冉</surname><given-names>煦</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>红火</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>胡</surname><given-names>茜</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>召富</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>西华大学，四川 成都</addr-line></aff><aff id="aff2"><addr-line>成都纺织高等专科学校，四川 成都</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>31</day><month>12</month><year>2019</year></pub-date><volume>10</volume><issue>01</issue><fpage>35</fpage><lpage>43</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   空调服贴肤面料与人体皮肤之间存在微气候区，监控该区域温度便能控制人体体感温度。文章介绍了一种基于STM32系统的空调服的智能控制系统的控制思想和系统架构设计。该控制系统能够自动检测并调节空调服微气候区温度，通过传导、对流、辐射等多种热交换实现服装温度的自动控制和调节，从而使人体长时间保持舒适，为空调服智能控制系统设计提供了一种可靠的解决方案。经测试，系统性能稳定、监测全面、经济舒适、安全可靠、运行稳定，具有较大的市场前景。 There is a microclimate area between the fabric of air conditioning clothing and the skin of human body. The sendible temperature can be controlled by monitoring the temperature in this area. The paper introduces the control idea and system architecture design of an intelligent control system for air conditioning clothing based on STM32 system. The control system can automatically detect and adjust the temperature in the microclimate area of air conditioning clothing so that the human body can be comfortable for a long time. Through conduction, convection, radiation and other heat exchanges to realize automatic control and adjustment of clothing temperature, the system provides a reliable system solution for intelligent control system of air conditioning clothing. After testing, the system with stable performance, comprehensive monitoring and stable operation is economic and comfortable, safe and reliable, and has great market prospects. 
  
 
</p></abstract><kwd-group><kwd>智能控制，空调服，控制系统，STM32, Intelligent Control</kwd><kwd> Air-Conditioning Clothing</kwd><kwd> Control System</kwd><kwd> STM32</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于STM32的空调服智能控制系统设计<sup> </sup></title><p>黄勤陆<sup>1</sup>，冉煦<sup>1</sup>，李红火<sup>1</sup>，胡茜<sup>2</sup>，刘召富<sup>1</sup></p><p><sup>1</sup>成都纺织高等专科学校，四川 成都</p><p><sup>2</sup>西华大学，四川 成都</p><p>收稿日期：2019年12月17日；录用日期：2020年1月2日；发布日期：2020年1月9日</p><disp-formula id="hanspub.33887-formula44"><graphic xlink:href="//html.hanspub.org/file/5-1541630x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>空调服贴肤面料与人体皮肤之间存在微气候区，监控该区域温度便能控制人体体感温度。文章介绍了一种基于STM32系统的空调服的智能控制系统的控制思想和系统架构设计。该控制系统能够自动检测并调节空调服微气候区温度，通过传导、对流、辐射等多种热交换实现服装温度的自动控制和调节，从而使人体长时间保持舒适，为空调服智能控制系统设计提供了一种可靠的解决方案。经测试，系统性能稳定、监测全面、经济舒适、安全可靠、运行稳定，具有较大的市场前景。</p><p>关键词 :智能控制，空调服，控制系统，STM32</p><disp-formula id="hanspub.33887-formula45"><graphic xlink:href="//html.hanspub.org/file/5-1541630x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/5-1541630x7_hanspub.png" /> <img src="//html.hanspub.org/file/5-1541630x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>人体温度保持在一个稳定的温度范围，通过人体机体不断新陈代谢进行调节，随环境温度的变化小幅度变化，基本保持在37℃左右 [<xref ref-type="bibr" rid="hanspub.33887-ref1">1</xref>]。高温环境下，人的生理机能会出异常，如大量出汗会让心血管负担加重，降低工作效率，影响判断力、中暑、甚至猝死 [<xref ref-type="bibr" rid="hanspub.33887-ref2">2</xref>]。空调服作为一种具有温度调节功能的特殊服装，能在极端环境下保持人体体温 [<xref ref-type="bibr" rid="hanspub.33887-ref3">3</xref>] 稳定。它在人体皮肤与服装面料之间提供一个微气候区，通过改变其温度，使人体保持舒适状态。因此，如何监测与调节微气候区的温度是空调服核心。本文介绍了一种以STM32系统及半导体制冷器为核心的空调服智能控制系统，并详细介绍了其控制思想及系统架构设计。</p></sec><sec id="s4"><title>2. 空调服系统组成</title><p>空调服系统主要由制冷系统、制热系统、智能控制系统、服装和工艺系统四个系统构成。制冷系统由电子半导体制冷片、对流风扇以及冷却管道组成；二是制热系统；三是控制系统，主要包括温度采集模块、STM32系统模块、半导体制冷和水循环模块、太阳能锂电池组管理电路、按键模块以及显示模块等 [<xref ref-type="bibr" rid="hanspub.33887-ref4">4</xref>] ；四是服装及工艺系统，主要由空调服内层、中层(功能层)及外层面料构成。所用制冷制热系统器件微型化，质量控制在2.5 KG内，提高了衣服穿着的舒适性。空调服测试产品如下图1所示。</p><p>图1. 空调服测试产品</p></sec><sec id="s5"><title>3. 控制系统硬件设计</title><sec id="s5_1"><title>3.1. 控制系统概述</title><p>控制系统完成空调服的启停和运行状态管理。通过对半导体制冷系统、空气循环系统、液冷循环系统的控制达到调节温度的目的。同时该控制系统还能实时显示微气候区温度及设定温度，并控制太阳能电池组。控制系统框图如下图2所示，系统的控制流程图如下图3所示。</p><p>图2. 系统硬件框图</p><p>图3. 控制流程图</p><p>控制系统以ARM 32位Cortext M3内核的低功耗单片机为核心，采用STM32F103C8 T6作为主控芯片，该芯片具有优先级可编程的中断系统，具备单周期乘法指令和硬件除法指令；存储器有两类，64 KB的FLASH和20 KB的SRAM；工作频率可达72 MHz，宽电压供电范围为2.0~3.6 V；另外系统还集成了定时器、GPIO口、看门狗、UART、I2C和SPI接口等丰富的片内外资源，系统运行稳定，可扩展性强。内嵌以太网接口，能够方便地处理数字、模拟量参数，具有成本低、速度快、性价比高等优点。此外，控制电路输出通道可达6路，能够对半导体制冷系统、空气循环系统、水循环系统、温度采集模块、人机交互系统等几大部件进行控制，STM32控制器电路图如下图4所示，实物如下图5所示。</p><p>图4. STM32控制系统电路图</p><p>图5. STM32控制器系统实物图</p><p>空调服系统中除了体温探头，还可以配置NBP、SpO2、ECG传感器接头，进行血压、心电、血氧等人体生理参数采集和监控 [<xref ref-type="bibr" rid="hanspub.33887-ref5">5</xref>]。</p></sec><sec id="s5_2"><title>3.2. 温度监测模块</title><p>温度监测模块安装于空调服微气候区，用于实时监测该区域温度。温度传感器采用DS18B20数字温度传感器模块，该模块内部包含温度传感器、A/D转换器、信号处理器、存储器(或寄存器)和接口电路。能够采用数据线供电范围为3.0 V至5.5 V，温度可测量范围为−55℃至125℃，根据空调服实际需要，系统设计范围为−20℃至50℃。内部温度采集精度可以由用户自定义为9-Bits至12-Bits，测温分辨率可达 0.0625 ℃， 被测温度采用16位数字量方式串行输出；DS18B20内设64位序列号进行网络地址识别，多个DS18B20温度检测模块通过Wire总线构成分布式温度采集系统。DS18B20温控系统外部电路设计如下图6所示。</p><p>图6. 温度传感器接口电路</p><p>用户可在一定范围内设置微气候区温度，系统将对比所测温度与设置温度，并据此进行控制和显示，当测量温度小于设定温度时，制热系统启动；当测量温度大于等于设定温度时，制冷系统启动。</p></sec><sec id="s5_3"><title>3.3. 半导体制冷系统</title><p>半导体制冷组件是利用半导体热电效应原理制成的制冷器件，具有无需制冷剂、体积小、寿命长、可靠性高、制冷方便、制冷速度快特点，因改变电流方向就可以改变制冷、制热端等优点得到了广泛的应用。当直流电流由P型半导体流向N型半导体时，P-N结的交界面成为发热端；反之，当直流电流由N型半导体流向P型半导体时，P-N结交界面成为吸热端。该过程中发热及吸热量的大小，由串、并联热电偶的数量以及通过电流的大小决定，半导体制冷器的工作示意如下图7所示。</p><p>图7. 半导体制冷工作原理图</p><p>本系统采用的半导体制冷芯片TEC1-12706，该芯片外形尺寸40 &#215; 40 &#215; 3.75 mm，内阻2.1~2.4 Ω，额定工作电压12 V，工作电流4.5 A，工作温度范围−55℃至83℃。冷却液流经储液罐时，将被置于半导体制冷器冷端冷却，再次进入循环管道。半导体制冷器的热端通过散热风扇与外界环境连通。</p><p>本空调服实行液冷降温技术，液冷降温即通过冷却液与环境的热交换来改变环境温度的技术 [<xref ref-type="bibr" rid="hanspub.33887-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.33887-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.33887-ref7">7</xref>]。空调服夹层中铺满田型或蛇形管道，由锂电池驱动水泵，将储箱中的冷却液送入管道中，使冷却液在管内循环，最后流回储箱 [<xref ref-type="bibr" rid="hanspub.33887-ref6">6</xref>]。循环过程中，微气候区的温度得以降低。空调服装内层由良导热材料制成，可以使微气候区与冷却液之间更好地发生热交换 [<xref ref-type="bibr" rid="hanspub.33887-ref7">7</xref>]。</p><p>液冷循环系统大大减轻了空调服的臃肿感，可以实现和平常衣服的一样质感，并且该系统可拆卸，使得服装在日常使用中更易清洗、易携带。半导体制冷器的冷端通过空气过滤入口与外界连通。当空气循环系统启动时，外界空气经半导体制冷器冷端冷却后，由空气循环风扇送入空调服的微气候区，通过与人体皮肤的对流散热，达到降温的效果。</p></sec><sec id="s5_4"><title>3.4. 电源模块</title><p>该空调服前胸、后背等面积较大部位配置了太阳能光伏薄膜，通过光伏片将太阳能转化为电能，存储在锂电池中，供电给控制系统和循环装置。多个电子元器件嵌入在智能空调服装里面，耗电比较大，对电源模块和太阳能续航能力提出的更高要求，因此采用高光电转换率和重量较轻的直流12 V太阳能电池 [<xref ref-type="bibr" rid="hanspub.33887-ref8">8</xref>] 可提高系统持续工作时间，本空调服可正常运行2~3小时。</p><p>电源为整个系统提供能量，其驱动能力、电压、纹波、内阻、体积、功耗及成本等参数直接影响到系统工作的稳定性。系统采用电源芯片SPX1117M3，低压差工作电压3.3 V，输出电流最大为800 mA。系统的电源电路原理图如下图8所示。</p><p>图8. 系统的电源原理图</p></sec><sec id="s5_5"><title>3.5. 复位电路</title><p>本系统STM32的复位电路，复位电路如下图9所示。</p><p>图9. 复位电路原理图</p><p>如上图所示，复位电路采用集成芯片MAX706，使用看门狗型上电和人工混合复位方式。如果在1.6 s内看门狗输入端未被触发，看门狗输出将变为低电平；当电源故障报警等情况出现时，可使用低电平有效的人工复位，门限电压为1.25 V。</p></sec><sec id="s5_6"><title>3.6. 时钟电路</title><p>时钟电路为系统提供主时钟和实时时钟两类同步工作信号供各个模块使用。主时钟信号频率为8 MHz，频率较高；实时时钟频率有32.768 KHz，频率较低，实时时钟有PCLK、FCLK、UCLK和HCLK四组，由锁相环对主时钟进行倍频和同步处理得到。芯片内I2C、SPI、ADC、GPIO等外设模块访问APB总线时由PCLK时钟供给；Cortex-M3内核时钟参与FCLK信号；HCLK主要供给DMA、AHB、存储器、中断等模块 [<xref ref-type="bibr" rid="hanspub.33887-ref9">9</xref>]。STM32的时钟电路如下图10所示。</p><p>图10. 时钟电路原理图</p><p>时钟模块输出的设计频率和实际频率相差比较大情况下，在测试阶段可以采用基于二分法相对遍历法进行自动修调 [<xref ref-type="bibr" rid="hanspub.33887-ref10">10</xref>]。</p></sec></sec><sec id="s6"><title>4. 控制系统软件设计</title><sec id="s6_1"><title>4.1. 程序软件流程</title><p>为方便用户调节空调服温度，增强体验感，配置了移动智能终端和APP应用。可通过服装表面的显示屏或手机专用APP显示并设置温度 [<xref ref-type="bibr" rid="hanspub.33887-ref8">8</xref>] ；在云模式温湿度环境监测系统中，除单独监控各空调服运行状态外，还可以通过云平台将所有空调服站点数据上传至远云数据中心存储并供管理人员分析；另外还可根据需求加配心率传感器和运动量传感器等功能模块，通过手机APP进行人体心率和运动量监测。</p><p>智能空调服具有自动和手动模式。自动模式下实现智能控温，自动检测空调服内部微环境的温度，与设置的温度对比后自动开关服装内制冷、制热装置，调节服装内部微气候。</p><p>系统在启动后首先进行初始化，初始化过程包括对各传感器、数码管、按键等的输入或者输出端进行配置 [<xref ref-type="bibr" rid="hanspub.33887-ref11">11</xref>]。初始化后运行模式选择，有制冷/制热两种模式；穿戴人员通过控制面板设置运行模式并设置好适宜温度后，系统进入自动控温运行模式。运行模式分两个线程，线程一进执行液冷循环控制，线程二执行空气循环控制，两个线程相辅相成，共同达成控制目的。</p></sec><sec id="s6_2"><title>4.2. 温度显示模块设计</title><p>使用者通过按键自行设置微气候区温度，设置到个人最适宜的环境温度。空调服启动运行后，液晶显示屏适时地显示服装内温度，温度显示界面如下图11所示。</p><p>图11. 温度显示界面</p><p>显示模块部分代码如下：</p><disp-formula id="hanspub.33887-formula46"><graphic xlink:href="//html.hanspub.org/file/5-1541630x20_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s6_3"><title>4.3. 测试结果</title><p>通过对空调服测试产品进行制冷测试，得到了如下表1中的数据。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Microclimate area temperature test result</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >时间(min)</th><th align="center" valign="middle" >0</th><th align="center" valign="middle" >3</th><th align="center" valign="middle" >6</th><th align="center" valign="middle" >9</th><th align="center" valign="middle" >12</th><th align="center" valign="middle" >15</th><th align="center" valign="middle" >18</th><th align="center" valign="middle" >21</th><th align="center" valign="middle" >24</th><th align="center" valign="middle" >27</th><th align="center" valign="middle" >30</th></tr></thead><tr><td align="center" valign="middle" >微气候区温度(℃)</td><td align="center" valign="middle" >28</td><td align="center" valign="middle" >27.2</td><td align="center" valign="middle" >25.2</td><td align="center" valign="middle" >25.1</td><td align="center" valign="middle" >25</td><td align="center" valign="middle" >25.2</td><td align="center" valign="middle" >25.1</td><td align="center" valign="middle" >25.1</td><td align="center" valign="middle" >25.2</td><td align="center" valign="middle" >25</td><td align="center" valign="middle" >25.1</td></tr></tbody></table></table-wrap><p>表1. 微气候区温度测试结果</p><p>测试时空调服的微气候区初始温度为28℃，设定好温度后，控制系统启动，空调服开始制冷，6分钟后微气候区温度达到设定值，并且在之后的30分钟内保持稳定。控制系统能够较为稳定地将微气候区的温度控制在设定值。</p></sec></sec><sec id="s7"><title>5. 结束语</title><p>该空调服智能控制系统以STM32为核心，结合半导体制冷、相变冷却液、传导辐射对流等热交换技术，较好地实现了空调服微气候区温度的检测与控制。同时利用太阳能光伏转换技术，利用太阳能电池进行储能，降低了能源消耗，延长了空调服制持续工作时间。注重人性化设计，突出体现以人为本的理念，产品工程市场化后具有广泛的应用前景。</p></sec><sec id="s8"><title>基金项目</title><p>四川省科技计划重点研发项目(2019YFG0159)，成都纺织高等专科学校校级项目(CDFZTDLK201601)。</p></sec><sec id="s9"><title>文章引用</title><p>黄勤陆,冉 煦,李红火,胡 茜,刘召富. 基于STM32的空调服智能控制系统设计Design of Intelligent Control System for Air-Conditioning Clothing Based on STM32[J]. 计算机科学与应用, 2020, 10(01): 35-43. https://doi.org/10.12677/CSA.2020.101005</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.33887-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">黄凤英. 基于STM32F103C8T6单片机的多功能智能手表设计[J]. 物联网技术, 2019(3): 49-51.</mixed-citation></ref><ref id="hanspub.33887-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">冉煦, 黄勤陆, 袁方琳珂, 等. 基于半导体制冷器的智能空调服装研究[J]. 计算机科学与应用, 2019, 9(1): 70-77.</mixed-citation></ref><ref id="hanspub.33887-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">范一强, 贺建芸, 刘士成等. 制冷与制热空调服的研究进展[J]. 纺织学报, 2018, 39(7): 174-180.</mixed-citation></ref><ref id="hanspub.33887-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">王伟, 刘飞, 李成龙. 一种用于配电网带电作业的空调服装置[J]. 电子测量技术, 2017, 17(41): 32-36.</mixed-citation></ref><ref id="hanspub.33887-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">戴明, 王琪, 吴万庆, 等. 一种便携式多体征参数监护系统的设计及实现[J]. 电子技术应用，2015(2): 79-81.</mixed-citation></ref><ref id="hanspub.33887-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">孙晓阳. 一种新型高效环保空调服的提出[J]. 应用能源技术, 2015(4): 34-35.</mixed-citation></ref><ref id="hanspub.33887-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">黄勤陆, 喻兴隆. 一种基于ARM的纺织企业环境监测系统研究设计[J]. 成都纺织高等专科学校学报, 2017, 34(4): 152-155.</mixed-citation></ref><ref id="hanspub.33887-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">李帅兵, 徐欣, 邢书琳, 等. 智能终端控温空调服装的研发[J]. 山东纺织科技, 2018(3): 10-12.</mixed-citation></ref><ref id="hanspub.33887-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">吴海洋. 基于ARM的人体红外测温系统设计与研究[D]: [硕士学位论文]. 太原: 太原科技大学, 2011.</mixed-citation></ref><ref id="hanspub.33887-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">孟博，颜河，管金凤, 等. 时钟模块自动修调电路设计[J]. 电子技术应用, 2019(5): 14-16.</mixed-citation></ref><ref id="hanspub.33887-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">王标, 吴薇. 基于STM32的测温实验平台的设计[J]. 仪器仪表用户, 2019, 26(5): 11-14.</mixed-citation></ref></ref-list></back></article>