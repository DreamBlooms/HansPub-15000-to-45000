<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SA</journal-id><journal-title-group><journal-title>Statistics and Application</journal-title></journal-title-group><issn pub-type="epub">2325-2251</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SA.2016.54037</article-id><article-id pub-id-type="publisher-id">SA-19251</article-id><article-categories><subj-group subj-group-type="heading"><subject>SA20160400000_16224720.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于Gibbs抽样的集装箱吞吐量Bayes AR(p)分析
  Bayes AR(p) Analysis of Container Throughput Based on the Gibbs Sampling
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>朱</surname><given-names>善维</given-names></name><xref ref-type="aff" rid="aff1"><sub>1</sub></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>上海海事大学经济管理学院，上海</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1377490996@qq.com</email></corresp></author-notes><pub-date pub-type="epub"><day>12</day><month>12</month><year>2016</year></pub-date><volume>05</volume><issue>04</issue><fpage>350</fpage><lpage>358</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  AR(p)模型广泛应用于时序预测，然而传统静态模型难以处理突发事件以致模型估计偏差。鉴于突发事件对模型估计的影响，采用Gibbs抽样方法对模型进行Bayes分析，根据时序样本似然函数的统计结构构造出模型各参数的先验分布。在导出模型参数后验条件分布后给出具体抽样策略。在最小均方误差估计准则下对中小样本的模拟显示，参数估计值与真值接近。对上海港1982~2015年集装箱吞吐量数据的分析表明：借助Bayes分析，可以克服由于突发事件导致的模型估计偏差，使模型预测更加准确。
   AR(p) model is widely used for time series forecasts; however, it’s difficult for traditional static model to deal with emergencies, which lead to estimation bias. In view of the influences of emergencies for model estimation, we carry out Bayesian analysis of the model by aid of the Gibbs sampling. According to likelihood function’s statistical structure of the time series samples, the prior distribution is obtained. After getting the posterior empirical distribution of parameters, the specific sampling strategy is proposed. Under the minimum mean square error estimation criterion, the simulation experiments show that the estimates are close to the true value. The analysis for the data of Shanghai port’s container throughput from 1982 to 2015 indicates that by aid of the Bayesian analysis, the estimation bias from emergencies can be overcome so that the model prediction is more accurate.
 
</p></abstract><kwd-group><kwd>AR模型，Bayes分析，Gibbs抽样，吞吐量, AR(p) Model</kwd><kwd> Bayes Analysis</kwd><kwd> Gibbs Sampling</kwd><kwd> Throughout Capacity</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于Gibbs抽样的集装箱吞吐量 Bayes AR(p)分析<sup> </sup></title><p>朱善维</p><p>上海海事大学经济管理学院，上海</p><disp-formula id="hanspub.19251-formula203"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年11月26日；录用日期：2016年12月9日；发布日期：2016年12月15日</p><disp-formula id="hanspub.19251-formula204"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>AR(p)模型广泛应用于时序预测，然而传统静态模型难以处理突发事件以致模型估计偏差。鉴于突发事件对模型估计的影响，采用Gibbs抽样方法对模型进行Bayes分析，根据时序样本似然函数的统计结构构造出模型各参数的先验分布。在导出模型参数后验条件分布后给出具体抽样策略。在最小均方误差估计准则下对中小样本的模拟显示，参数估计值与真值接近。对上海港1982~2015年集装箱吞吐量数据的分析表明：借助Bayes分析，可以克服由于突发事件导致的模型估计偏差，使模型预测更加准确。</p><p>关键词 :AR模型，Bayes分析，Gibbs抽样，吞吐量</p><disp-formula id="hanspub.19251-formula205"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>世界经济的发展与港口业休戚相关，世界各主要港口间的竞争如今正逐步转向以集装箱吞吐量为核心的港口综合能力的竞争。可见，对港口集装箱吞吐量的预测不可或缺，其在制定港口发展方向，经营策略，投资规模，泊位选址上都发挥着重要作用。</p><p>对于集装箱吞吐量的预测，田歆等 [<xref ref-type="bibr" rid="hanspub.19251-ref1">1</xref>] 基于TEI@I方法，提出香港集装箱吞吐量预测研究框架，利用季节ARIMA及VAR等计量模型，不规则时间的量化方法以及径向基神经网络技术，建立了集装箱吞吐量的综合集成预测模型。杨金花等 [<xref ref-type="bibr" rid="hanspub.19251-ref2">2</xref>] 基于灰色预测模型GM(1,1)预测了上海港样本期外3年的集装箱吞吐量。余思勤等 [<xref ref-type="bibr" rid="hanspub.19251-ref3">3</xref>] 采用带外生变量的非线性自回归神经网络模型对上海港集装箱吞吐量进行预测，发现训练后的网络误差较小，预测效果较好。已有预测模型多是传统静态模型，面对诸如2009年美国金融危机，全球贸易不景气，港口集装箱吞吐量锐减之类的突发事件就会导致模型预测偏差。鉴于此，本文提出Bayes AR(p)模型，运用Bayes方法对时间序列进行预测分析，此不仅利用了模型信息和样本信息，也结合了模型中总体分布的未知参数信息。这样就能处理传统静态模型难以克服的缺陷，易于适应外部变化。</p><p>运用Bayes方法对时间序列模型进行分析时会遇到对高维概率分布积分的问题。Gibbs抽样是解决高维积分的迭代Monte Carlo方法，解决了复杂表达式难以高维积分的问题，应用十分广泛。本文利用Bayes方法对AR(p)模型进行分析，得到模型参数后验条件分布后，给出Gibbs抽样的具体策略。通过Gibbs抽样得到一系列模拟值构成Markov链，且链的平稳分布收敛于待估参数的后验条件分布，即可以将模拟值看作后验分布的独立样本对参数估计值进行推断。</p></sec><sec id="s4"><title>2. 模型建立</title><p>对于随机变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x9_hanspub.png" xlink:type="simple"/></inline-formula>，其满足的AR(p)模型为</p><disp-formula id="hanspub.19251-formula206"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-2580207x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，误差项<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x11_hanspub.png" xlink:type="simple"/></inline-formula>，且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x12_hanspub.png" xlink:type="simple"/></inline-formula>相互独立；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x13_hanspub.png" xlink:type="simple"/></inline-formula>为模型的自回归系数；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x14_hanspub.png" xlink:type="simple"/></inline-formula>为模型的阶数；记<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x15_hanspub.png" xlink:type="simple"/></inline-formula>，其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x16_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x17_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x18_hanspub.png" xlink:type="simple"/></inline-formula>为延迟算子。则(1)式可记为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x19_hanspub.png" xlink:type="simple"/></inline-formula>。若AR(p)模型是平稳的，则必多项式<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x20_hanspub.png" xlink:type="simple"/></inline-formula>的根在单位圆之内。本文假定所分析的AR(p)模型均是平稳过程。对于未处理的时间序列数据，通过单位根检验来判定是否平稳，对非平稳的时间序列可通过差分化为平稳时间序列。</p><p>若已知<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x21_hanspub.png" xlink:type="simple"/></inline-formula>对于给定时间序列<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x22_hanspub.png" xlink:type="simple"/></inline-formula>，则</p><disp-formula id="hanspub.19251-formula207"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x23_hanspub.png"  xlink:type="simple"/></disp-formula><p>记<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x24_hanspub.png" xlink:type="simple"/></inline-formula>的条件概率密度为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x25_hanspub.png" xlink:type="simple"/></inline-formula>。对初始值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x26_hanspub.png" xlink:type="simple"/></inline-formula>，样本<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x27_hanspub.png" xlink:type="simple"/></inline-formula>的条件似然函数为</p><disp-formula id="hanspub.19251-formula208"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-2580207x28_hanspub.png"  xlink:type="simple"/></disp-formula><p>其对数似然函数为</p><disp-formula id="hanspub.19251-formula209"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>在进行Bayes分析时，由于参数的先验信息比较难确定，而不当先验信息会对估计结果产生错误影响。根据似然函数(2)式的结构，自回归系数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x30_hanspub.png" xlink:type="simple"/></inline-formula>的先验分布选为无信息先验，记<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x31_hanspub.png" xlink:type="simple"/></inline-formula>，误差项<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x32_hanspub.png" xlink:type="simple"/></inline-formula>的方差<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x33_hanspub.png" xlink:type="simple"/></inline-formula>的先验分布选为倒Gamma分布(参见文 [<xref ref-type="bibr" rid="hanspub.19251-ref4">4</xref>] )。其为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x34_hanspub.png" xlink:type="simple"/></inline-formula>的共轭先验分布。记</p><disp-formula id="hanspub.19251-formula210"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x35_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x36_hanspub.png" xlink:type="simple"/></inline-formula>是先验分布参数。根据Bayes公式可知，参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x37_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x38_hanspub.png" xlink:type="simple"/></inline-formula>的后验条件分布为</p><disp-formula id="hanspub.19251-formula211"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/5-2580207x39_hanspub.png"  xlink:type="simple"/></disp-formula><p>为了避免对参数的高维概率密度函数作积分的复杂问题，我们利用马尔科夫链蒙特卡罗(Markov Chain Monte Carlo, MCMC)算法。</p><p>MCMC的基本思想是：对于给定样本集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x40_hanspub.png" xlink:type="simple"/></inline-formula>，为得到参数向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x41_hanspub.png" xlink:type="simple"/></inline-formula>的后验分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x42_hanspub.png" xlink:type="simple"/></inline-formula>的样本，建立一个平稳分布为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x43_hanspub.png" xlink:type="simple"/></inline-formula>的Markov链<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x44_hanspub.png" xlink:type="simple"/></inline-formula>，对于任意时刻<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x45_hanspub.png" xlink:type="simple"/></inline-formula>，下一状态<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x46_hanspub.png" xlink:type="simple"/></inline-formula>来自分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x47_hanspub.png" xlink:type="simple"/></inline-formula>的抽样，即其只和当前时刻<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x48_hanspub.png" xlink:type="simple"/></inline-formula>的状态有关，与历史状态<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x49_hanspub.png" xlink:type="simple"/></inline-formula>无关。在这些迭代样本的基础上就可以对参数做统计推断，如下式计算后验均值</p><disp-formula id="hanspub.19251-formula212"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x50_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x51_hanspub.png" xlink:type="simple"/></inline-formula>为链的迭代状态数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x52_hanspub.png" xlink:type="simple"/></inline-formula>为链的截断状态数。在MCMC算法中，为构造状态转移概率使已知后验分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x53_hanspub.png" xlink:type="simple"/></inline-formula>为平稳分布，常采用的构造方法有Gibbs抽样法，Metropolis-Hastings算法等。本文便是采用Gibbs抽样的MCMC算法。</p><p>考虑到联合后验分布(3)式的特点，如文 [<xref ref-type="bibr" rid="hanspub.19251-ref5">5</xref>] ，在给定<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x54_hanspub.png" xlink:type="simple"/></inline-formula>的条件下，可选取建议分布是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x55_hanspub.png" xlink:type="simple"/></inline-formula>元正态分布的Metropolis-Hastings算法对自回归系数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x56_hanspub.png" xlink:type="simple"/></inline-formula>进行后验抽样。为确定建议分布的参数，参考 [<xref ref-type="bibr" rid="hanspub.19251-ref6">6</xref>] 中定理给出如下引理。</p><p>引理：对于样本<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x57_hanspub.png" xlink:type="simple"/></inline-formula>，模型的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x58_hanspub.png" xlink:type="simple"/></inline-formula>维参数向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x59_hanspub.png" xlink:type="simple"/></inline-formula>的极大似然估计量为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x60_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x61_hanspub.png" xlink:type="simple"/></inline-formula>满足：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x62_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x63_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x64_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x65_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x66_hanspub.png" xlink:type="simple"/></inline-formula>阶Fisher信息阵，有</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x67_hanspub.png" xlink:type="simple"/></inline-formula>,</p><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x68_hanspub.png" xlink:type="simple"/></inline-formula>为样本<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x69_hanspub.png" xlink:type="simple"/></inline-formula>下<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x70_hanspub.png" xlink:type="simple"/></inline-formula>的似然函数。则根据引理，Metropolis-Hastings算法的建议分布的协差阵取为</p><disp-formula id="hanspub.19251-formula213"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x71_hanspub.png"  xlink:type="simple"/></disp-formula><p>于是，回归系数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x72_hanspub.png" xlink:type="simple"/></inline-formula>的抽样方法的具体步骤见算法1。</p><p>算法1：步1：抽取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x73_hanspub.png" xlink:type="simple"/></inline-formula>；</p><p>步2：抽取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x74_hanspub.png" xlink:type="simple"/></inline-formula>；</p><p>步3：若<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x75_hanspub.png" xlink:type="simple"/></inline-formula>，则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x76_hanspub.png" xlink:type="simple"/></inline-formula>，否则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x77_hanspub.png" xlink:type="simple"/></inline-formula>，其中</p><disp-formula id="hanspub.19251-formula214"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x78_hanspub.png"  xlink:type="simple"/></disp-formula><p>对在参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x79_hanspub.png" xlink:type="simple"/></inline-formula>给定下，参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x80_hanspub.png" xlink:type="simple"/></inline-formula>的后验分布核为</p><disp-formula id="hanspub.19251-formula215"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x81_hanspub.png"  xlink:type="simple"/></disp-formula><p>也就是</p><disp-formula id="hanspub.19251-formula216"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x82_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x83_hanspub.png" xlink:type="simple"/></inline-formula>表示自由度为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x84_hanspub.png" xlink:type="simple"/></inline-formula>的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x85_hanspub.png" xlink:type="simple"/></inline-formula>分布。则参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x86_hanspub.png" xlink:type="simple"/></inline-formula>的后验分布核是标准分布，可直接抽样。</p><p>于是Gibbs抽样方法的具体迭代步骤如下：给定迭代初始值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x87_hanspub.png" xlink:type="simple"/></inline-formula>，依次取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x88_hanspub.png" xlink:type="simple"/></inline-formula>，那么第j轮迭代的实现步骤如下：</p><p>步1：从分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x89_hanspub.png" xlink:type="simple"/></inline-formula>里产生<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x90_hanspub.png" xlink:type="simple"/></inline-formula>，</p><p>步2：从分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x91_hanspub.png" xlink:type="simple"/></inline-formula>里产生<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x92_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec><sec id="s5"><title>3. 模拟实验</title><p>为了考察Gibbs抽样方法的效果，本节进行模拟实验，为不失一般性，取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x93_hanspub.png" xlink:type="simple"/></inline-formula>，则模拟的AR(p)模型如下</p><disp-formula id="hanspub.19251-formula217"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x94_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x95_hanspub.png" xlink:type="simple"/></inline-formula>，记<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x96_hanspub.png" xlink:type="simple"/></inline-formula>。令参数的真值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x97_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x98_hanspub.png" xlink:type="simple"/></inline-formula>，超参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x99_hanspub.png" xlink:type="simple"/></inline-formula>，取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x100_hanspub.png" xlink:type="simple"/></inline-formula>的初始值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x101_hanspub.png" xlink:type="simple"/></inline-formula>。分别取时间跨度为50, 100, 200三种情况进行模拟比较，模拟迭代10,000次，并舍弃轨道的前5000次迭代，各参数的后验估计值和后验标准差如表1，其中括号内为后验标准差。</p><p>由表1可见，当样本量较小时就已经接近真实值，且随着样本时间跨度的增加，参数的估计标准差逐渐缩小。</p></sec><sec id="s6"><title>4. 实证分析</title><p>自2010年来，上海港集装箱吞吐量一直居世界第一，对其集装箱吞吐量的预测对我国经济的发展至关重要。本文选取1982~2015年的上海港集装箱吞吐量数据(如表2)，数据来源于上海市统计年鉴 [<xref ref-type="bibr" rid="hanspub.19251-ref7">7</xref>] 。</p><p>绘出历年吞吐量的散点图如图1。</p><p>由图可见，数据呈现指数上升的趋势，2009年由于世界金融危机上海港集装箱吞吐量锐减，可视为突发事件。因此可对数据做对数处理，处理结果如图2。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> The estimation of parameters posterior mea</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >N</th><th align="center" valign="middle" >真值</th><th align="center" valign="middle" >50</th><th align="center" valign="middle" >100</th><th align="center" valign="middle" >200</th></tr></thead><tr><td align="center" valign="middle" ><sub><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x102_hanspub.png" xlink:type="simple"/></inline-formula> </sub></td><td align="center" valign="middle" >0.7</td><td align="center" valign="middle" >0.6939(0.1719)</td><td align="center" valign="middle" >0.7011(0.1142)</td><td align="center" valign="middle" >0.7048(0.0923)</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x103_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >−0.1</td><td align="center" valign="middle" >−0.098(0.1556)</td><td align="center" valign="middle" >−0.1056(0.1191)</td><td align="center" valign="middle" >−0.1089(0.1085)</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x104_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >0.01</td><td align="center" valign="middle" >0.0160(0.0015)</td><td align="center" valign="middle" >0.010(0.0010)</td><td align="center" valign="middle" >0.0134(0.0011)</td></tr></tbody></table></table-wrap><p>表1. 参数后验均值估计结果</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Shanghai port’s container throughput from 1982 to 201</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >年份</th><th align="center" valign="middle" >吞吐量</th><th align="center" valign="middle"  rowspan="2"  >年份</th><th align="center" valign="middle" >吞吐量</th><th align="center" valign="middle"  rowspan="2"  >年份</th><th align="center" valign="middle" >吞吐量</th></tr></thead><tr><td align="center" valign="middle" >(万TEU)</td><td align="center" valign="middle" >(万TEU)</td><td align="center" valign="middle" >(万TEU)</td></tr><tr><td align="center" valign="middle" >1982</td><td align="center" valign="middle" >6.6</td><td align="center" valign="middle" >1994</td><td align="center" valign="middle" >119.9</td><td align="center" valign="middle" >2006</td><td align="center" valign="middle" >2171.9</td></tr><tr><td align="center" valign="middle" >1983</td><td align="center" valign="middle" >8.0</td><td align="center" valign="middle" >1995</td><td align="center" valign="middle" >152.6</td><td align="center" valign="middle" >2007</td><td align="center" valign="middle" >2615.2</td></tr><tr><td align="center" valign="middle" >1984</td><td align="center" valign="middle" >11.5</td><td align="center" valign="middle" >1996</td><td align="center" valign="middle" >197.1</td><td align="center" valign="middle" >2008</td><td align="center" valign="middle" >2800.6</td></tr><tr><td align="center" valign="middle" >1985</td><td align="center" valign="middle" >20.2</td><td align="center" valign="middle" >1997</td><td align="center" valign="middle" >93.5</td><td align="center" valign="middle" >2009</td><td align="center" valign="middle" >2500.2</td></tr><tr><td align="center" valign="middle" >1986</td><td align="center" valign="middle" >20.4</td><td align="center" valign="middle" >1997</td><td align="center" valign="middle" >119.9</td><td align="center" valign="middle" >2010</td><td align="center" valign="middle" >2906.9</td></tr><tr><td align="center" valign="middle" >1987</td><td align="center" valign="middle" >22.4</td><td align="center" valign="middle" >1998</td><td align="center" valign="middle" >152.6</td><td align="center" valign="middle" >2011</td><td align="center" valign="middle" >3173.9</td></tr><tr><td align="center" valign="middle" >1988</td><td align="center" valign="middle" >31.3</td><td align="center" valign="middle" >2000</td><td align="center" valign="middle" >197.1</td><td align="center" valign="middle" >2012</td><td align="center" valign="middle" >3252.9</td></tr><tr><td align="center" valign="middle" >1989</td><td align="center" valign="middle" >35.4</td><td align="center" valign="middle" >2001</td><td align="center" valign="middle" >252.8</td><td align="center" valign="middle" >2013</td><td align="center" valign="middle" >3361.7</td></tr><tr><td align="center" valign="middle" >1990</td><td align="center" valign="middle" >45.6</td><td align="center" valign="middle" >2002</td><td align="center" valign="middle" >306.6</td><td align="center" valign="middle" >2014</td><td align="center" valign="middle" >3528.5</td></tr><tr><td align="center" valign="middle" >1991</td><td align="center" valign="middle" >57.7</td><td align="center" valign="middle" >2003</td><td align="center" valign="middle" >421.6</td><td align="center" valign="middle" >2015</td><td align="center" valign="middle" >3653.7</td></tr><tr><td align="center" valign="middle" >1992</td><td align="center" valign="middle" >73.1</td><td align="center" valign="middle" >2004</td><td align="center" valign="middle" >1455.4</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >1993</td><td align="center" valign="middle" >93.5</td><td align="center" valign="middle" >2005</td><td align="center" valign="middle" >1808.4</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表2. 1982~2015年上海港集装箱吞吐量</p><p>经对数处理后，吞吐量随时间的变化有明显的线性趋势。所以对变换后的数据进行时间序列分析。</p><p>利用R软件tseries包中的adf.test()函数对变换后的吞吐量做单位根检验，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x105_hanspub.png" xlink:type="simple"/></inline-formula>，说明不能拒绝存在单位根的假设。对变换后的数据做两阶差分后对应的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x106_hanspub.png" xlink:type="simple"/></inline-formula>，说明差分后的序列平稳，</p><p>图1. 1982~2015年集装箱吞吐量</p><p>图2. 1982~2015 年集装箱对数吞吐量</p><p>且序列的ACF，PACF图如下。</p><p>由图3可知，ACF拖尾，PACF两步截尾。可以采用Bayes AR(2)模型<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x109_hanspub.png" xlink:type="simple"/></inline-formula></p><p>图3. 对数吞吐量二阶差分的ACF(上)、PACF(下)</p><p>对数据进行拟合，利用上文的Gibbs抽样方法对模型参数进行估计，且先验参数与模拟实验部分一致，Gibbs抽样模拟轨道长10,000，绘出参数的后2000次迭代过程(见图4)。</p><p>可见参数迭代平稳，并抛弃轨道的前5000个点，计算参数的后验均值与标准差见表3。其中括号内数字代表参数后验标准差。</p><p>则模型的估计结果为</p><disp-formula id="hanspub.19251-formula218"><graphic xlink:href="http://html.hanspub.org/file/5-2580207x112_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x113_hanspub.png" xlink:type="simple"/></inline-formula>，于是我们可得未来三年的集装箱吞吐量为3782.107TEU，</p><p>图4. 参数后2000次迭代过程</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> The estimation of parameters posterior mea</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x117_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x118_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/5-2580207x119_hanspub.png" xlink:type="simple"/></inline-formula></th></tr></thead><tr><td align="center" valign="middle" >−0.6532(0.166)</td><td align="center" valign="middle" >−0.5847(0.172)</td><td align="center" valign="middle" >0.0195(0.0053)</td></tr></tbody></table></table-wrap><p>表3. 参数后验均值结果</p><p>3947.072TEU，4098.362TEU。</p><p>由于贝叶斯参数估计方法充分利用了样本的信息和模型信息，估计方法更加灵活，对诸如金融危机之类的突发性事件有着较好的应变能力，也能克服传统估计方法中因为样本不足或者质量不佳导致结果误差较大的缺陷。用贝叶斯估计未知参数的方法得到的模型更适合预测，更能反映现实问题。</p></sec><sec id="s7"><title>文章引用</title><p>朱善维. 基于Gibbs抽样的集装箱吞吐量Bayes AR(p)分析 Bayes AR(p) Analysis of Container Throughput Based on the Gibbs Sampling[J]. 统计学与应用, 2016, 05(04): 350-358. http://dx.doi.org/10.12677/SA.2016.54037</p></sec><sec id="s8"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.19251-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">田歆, 曹志刚, 骆家伟, 等. 基于TEI@I方法论的香港集装箱吞吐量预测方法[J]. 运筹与管理, 2009, 18(4): 82- 89.</mixed-citation></ref><ref id="hanspub.19251-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">杨金花, 杨艺. 基于灰色模型的上海港集装箱吞吐量预测[J]. 上海海事大学学报, 2014, 35(2): 28-32.</mixed-citation></ref><ref id="hanspub.19251-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">余思勤, 范莹莹. 基于NARX神经网络的港口集装箱吞吐量预测[J]. 上海海事大学学报, 2015, 36(4): 1-5.</mixed-citation></ref><ref id="hanspub.19251-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Fernandez, C., Osiewalski, J. and Steel, M. (1997) On the Use of Panel Data in Stochastic Frontier Models with Improper Priors. Journal of Econometrics, 79, 169-193. &lt;br&gt;https://doi.org/10.1016/S0304-4076(97)88050-5</mixed-citation></ref><ref id="hanspub.19251-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Altaleb, A. and Chauveau, D. (2002) Bayesian Analysis of the Logit Model and Comparison of Two Metropolis- Hastings Strategies. Computational Statistics and Data Analysis, 39, 137-152.  
&lt;br&gt;https://doi.org/10.1016/S0167-9473(01)00055-X</mixed-citation></ref><ref id="hanspub.19251-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">茆诗松, 王静龙, 濮晓龙. 高等数理统计[M]. 第2版. 北京: 高等教育出版社, 2006: 120-121.</mixed-citation></ref><ref id="hanspub.19251-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">上海统计网[Z/OL]. http://www.stats-sh.gov.cn/</mixed-citation></ref></ref-list></back></article>