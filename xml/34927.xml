<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">DSC</journal-id><journal-title-group><journal-title>Dynamical Systems and Control</journal-title></journal-title-group><issn pub-type="epub">2325-677X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/DSC.2020.92011</article-id><article-id pub-id-type="publisher-id">DSC-34927</article-id><article-categories><subj-group subj-group-type="heading"><subject>DSC20200200000_96805171.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  准坐标形式的非完整刚体系统动力学方程及数值模拟
  Dynamic Equation and Numerical Simulation of Nonholonomic Multibody System in Quasi-Coordinate Form
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郝</surname><given-names>鑫</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>彦平</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>姚</surname><given-names>文莉</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>青岛理工大学理学院岩土力学与近海地下工程重点实验室，山东 青岛</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>31</day><month>03</month><year>2020</year></pub-date><volume>09</volume><issue>02</issue><fpage>121</fpage><lpage>128</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    本文的目标是研究针对非完整多体系统动力学与控制问题的更简单规范的动力学建模方法。采用欧拉–拉格朗日形式的高斯原理推导了适于非完整多体系统的准坐标形式的动力学运动微分方程。与目前常用的以动力学状态函数表达的针对非完整系统的动力学微分方程相比，文中的推导方法简单直接，得到的方程维数与自由度一致，且方程以准速度的显式矩阵表达，具有较强的通用性及规范性，适用于多体系统的程式化建模及计算的要求。针对例子中的典型非完整系统，建立了准速度表达的一阶运动微分方程并进行了数值模拟以及相应的动力学特性分析，与通常用于该类问题的带乘子的Routh方程相比，文中的方法在计算速度上占优，同时在不进行额外的违约修正的前提下，可较好地解决违约及位置奇异问题。
    The goal is to study a simpler and more canonical dynamic modeling method for nonholonomic multibody system dynamics and control problems. By using the Euler-Lagrangian form of Gauss principle, the differential equations of dynamic motion suitable for nonholonomic multibody sys-tems in quasi-velocity form are derived. Compared with the dynamic differential equations for nonholonomic systems, which are usually expressed in terms of energy functions and generalized coordinates, the method of derivation presented is simple and direct, and the obtained equations are expressed in explicit matrices of quasi-velocity consistent with the degrees of freedom. It has strong generality and standardization, and is suitable for programming modeling and calculation of multibody system requirements. For the example of nonholonomic system, the differential equa-tion of motion expressed by quasi-velocity is established, and the numerical simulation and the corresponding dynamic characteristics are carried out. Compared with the Routh equation with multipliers, the proposed method is superior in computational speed and can be used to solve the constrained default and location singular problems. 
  
 
</p></abstract><kwd-group><kwd>准速度，非完整系统，高斯原理，多体系统，准坐标, Quasi Velocity</kwd><kwd> Non-Holonomic System</kwd><kwd> Gauss Principle</kwd><kwd> Multi-Rigid Body System</kwd><kwd> Quasi-Coordinate</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>准坐标形式的非完整刚体系统动力学方程及数值模拟<sup> </sup></title><p>郝鑫，刘彦平，姚文莉<sup>*</sup></p><p>青岛理工大学理学院岩土力学与近海地下工程重点实验室，山东 青岛</p><disp-formula id="hanspub.34927-formula37"><graphic xlink:href="//html.hanspub.org/file/4-2740256x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2020年3月12日；录用日期：2020年3月31日；发布日期：2020年4月7日</p><disp-formula id="hanspub.34927-formula38"><graphic xlink:href="//html.hanspub.org/file/4-2740256x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文的目标是研究针对非完整多体系统动力学与控制问题的更简单规范的动力学建模方法。采用欧拉–拉格朗日形式的高斯原理推导了适于非完整多体系统的准坐标形式的动力学运动微分方程。与目前常用的以动力学状态函数表达的针对非完整系统的动力学微分方程相比，文中的推导方法简单直接，得到的方程维数与自由度一致，且方程以准速度的显式矩阵表达，具有较强的通用性及规范性，适用于多体系统的程式化建模及计算的要求。针对例子中的典型非完整系统，建立了准速度表达的一阶运动微分方程并进行了数值模拟以及相应的动力学特性分析，与通常用于该类问题的带乘子的Routh方程相比，文中的方法在计算速度上占优，同时在不进行额外的违约修正的前提下，可较好地解决违约及位置奇异问题。</p><p>关键词 :准速度，非完整系统，高斯原理，多体系统，准坐标</p><disp-formula id="hanspub.34927-formula39"><graphic xlink:href="//html.hanspub.org/file/4-2740256x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/4-2740256x8_hanspub.png" /> <img src="//html.hanspub.org/file/4-2740256x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>“完整”和“非完整”是力学上对约束和系统的分类概念。完整约束是对系统位形的限制，非完整约束是对系统运动的限制。自从Hertz于1894年首次提出非完整系统的一些重要概念以来，众多学者在非完整系统的基本原理、基本方程及在工程中的应用都取得了重要进展。</p><p>非完整系统动力学方程的建立主要依据如下力学原理：1) DLP原理(D’Almbert及Bernoulli原理)；2) Gauss原理和Jourdain原理；3) Hamilton原理。其中Gauss原理往往被认为是更具普适性的分析动力学的基本原理 [<xref ref-type="bibr" rid="hanspub.34927-ref1">1</xref>]。</p><p>在非完整系统动力学的发展过程中，基于上述原理建立起各种不同的动力学方程，这些方程形式各异，一般可以划分为两类：1) 基于乘子理论的动力学方程，如Routh方程 [<xref ref-type="bibr" rid="hanspub.34927-ref2">2</xref>] ；2) 约化的不带乘子的动力学方程，如Maggi方程、Appell方程等 [<xref ref-type="bibr" rid="hanspub.34927-ref3">3</xref>]。这些方程数学上等价，但数值求解中表现的特性并不相同 [<xref ref-type="bibr" rid="hanspub.34927-ref4">4</xref>]。</p><p>非完整多体系统的动力学建模主要基于上述几种典型的动力学方程, 上述方程的共同特点是：由表征系统运动状态的某函数(动能、Hamilton函数、加速度能等)及广义力按照规定的微分算子就能得到，思路清晰、表达简洁是其一大优点，但方程的不足之处在于建立了动力学基本函数后，还需经过微分算子的求导运算，对于比较复杂的系统，这种求导运算过程非常冗长。相比而言，Appell方程中的微分算子是最简单的，但建立复杂系统的Appell函数并非易事，Kane通过Jourdain原理，得到用准坐标表达的动力学微分方程，但在求偏速度、广义主动力及广义惯性力的过程涉及到矢量运算，符号复杂运算繁琐 [<xref ref-type="bibr" rid="hanspub.34927-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.34927-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.34927-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.34927-ref7">7</xref>]。Udwadia等从Gauss原理出发，得到U-K方程，可以处理一阶非完整系统，但该方程中涉及非常复杂的广义逆矩阵的计算问题 [<xref ref-type="bibr" rid="hanspub.34927-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.34927-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.34927-ref10">10</xref>]。</p><p>高斯原理往往被认为是更具普适性的分析力学的基本原理，可适用于完整、非完整约束系统；同时准坐标表达的方程具有很大的概括性(用广义坐标表达不过是它的特殊情形)，而且方程的结果往往很简洁，都是一阶方程。</p><p>因此，本文引进了由准坐标表达的坐标系统，采用高斯原理作为基本原理进行了动力学方程的推导。文中得到了以准速度的显式矩阵表达形式的非完整多体系统的动力学微分方程，并以此作为建模的基本方程，研究了非完整系统典型例子的动力学问题，与目前常用的Routh方程的方法进行对比分析，从而探索研究非完整系统动力学与控制问题的更简单规范的建模方法。</p></sec><sec id="s4"><title>2. 准速度、准加速度与广义坐标及广义加速度关系的矩阵表示</title><p>设系统由n个广义坐标描述，系统受到g个一阶非完整约束：</p><p>f k ( q j , q ˙ j , t ) = 0 ( j = 1 , ⋯ , n ; k = m + 1 , ⋯ , n ; m = n − g ) (1)</p><p>其中m为系统的自由度数，可取后面 n − m = g 个准速度为：</p><p>π ˙ k = ω k = f k ( q j , q ˙ j , t ) ≡ 0 ( j = 1 , ⋯ , n ; k = m + 1 , ⋯ , n ; m = n − g ) (2)</p><p>前面m个准速度可选为以 q j , q ˙ j , t 为变量的m个其它任意函数：</p><p>π ˙ k = ω k = f k ( q j , q ˙ j , t ) ( j = 1 , ⋯ , n ; k = 1 , ⋯ , m ; m = n − g ) (3)</p><p>选择准速度的条件为：(2)和(3)两个式子中所包含的n个函数的Jacobi矩阵 非奇异。</p><p>由方程(1) (2)得到广义速度的表达式并微分得到：</p><p>q &#168; j = ∑ s = 1 n ∂ q ˙ j ∂ q s q ˙ s + ∑ k = 1 m ∂ q ˙ j ω k ω ˙ k + ∂ q ˙ j ∂ t ( j , s = 1 , ⋯ , n ; k = 1 , ⋯ , m ) (4)</p><p>定义下列矩阵：</p><p>q = [ q 1 ⋯ q n ] T , q ˙ = [ q ˙ 1 ⋯ q ˙ n ] T , q &#168; = [ q &#168; 1 ⋯ q &#168; n ] T , π = [ π 1 ⋯ π m ] T ,</p><p>ω = [ ω 1 ⋯ ω m ] T , ω ˙ ′ = [ ω ˙ 1 ⋯ ω ˙ m ] T , D ω = [ ∂ q ˙ j ∂ ω k ] j = 1 , ⋯ , n k = 1 , ⋯ , m , w = [ ∑ s = 1 n ∂ q ˙ j ∂ q s q ˙ s + ∂ q ˙ j ∂ t ] n &#215; 1 .</p><p>则方程(4)可表达为矩阵形式：</p><p>q &#168; = D ω ω ˙ + w (5)</p><p>对(5)求变分，得到：</p><p>δ q &#168; = D ω δ ω ˙ (6)</p></sec><sec id="s5"><title>3. 以准坐标表示的动力学微分方程</title><p>Euler-Lagrange形式的Gauss原理为 [<xref ref-type="bibr" rid="hanspub.34927-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.34927-ref3">3</xref>] ：</p><p>∑ s = 1 n ( ∂ T ∂ q s − d d t ∂ T ∂ q ˙ s + Q s ) δ q &#168; s = 0 (7)</p><p>将系统动能表达为广义速度的显式：</p><p>T = T 2 + T 1 + T 0 = 1 2 ∑ s = 1 n ∑ k = 1 n A k s q ˙ s q ˙ k + ∑ s = 1 n B s q ˙ s + T 0</p><p>则(7)式可写为：</p><p>( A q &#168; + g − Q ) δ q &#168; = 0 (8)</p><p>其中 A = [ A k s ] n &#215; n 为正定且对称的矩阵， g ( q , q ˙ , t ) = [ g s ] s = 1 , ⋯ , n T ，其中 g s = ∑ k = 1 n ∑ m = 1 n [ k , m ; s ] q ˙ k q ˙ m − ∑ k = 1 n ( ∂ B k ∂ q s − ∂ B s ∂ q k ) q ˙ k + ∂ B s ∂ t − ∂ T 0 ∂ q s + ∑ k = 1 n ∂ A k ∂ t q ˙ k ; Q = [ Q s ] s = 1 , ⋯ , n T</p><p>Q s = ∑ i = 1 N F i ⋅ ∂ r i ∂ q s 为对应系统广义坐标的广义力；</p><p>[ k , m ; s ] = 1 2 ( ∂ A k s ∂ q m + ∂ A m s ∂ q k − ∂ A k m ∂ q s ) 为系数矩阵 A = [ A k s ] n &#215; n 的第一类Christoffel符号。</p><p>将(5)及(6)代入(8)式，得：</p><p>( A D ω ω ˙ + A w + g − Q ) T D ω δ ω ˙ = 0 (9)</p><p>则(9)式可化为：</p><p>( A ∗ ω ˙ + g ∗ − Q ∗ ) T δ ω ˙ = 0 (10)</p><p>其中：</p><p>g ∗ = D ω T ( A w + g ) , Q ∗ = D ω T Q , A ∗ = D ω T A D ω</p><p>由于 δ ω ˙ 中元素的独立性，故下式成立：</p><p>A ∗ ω ˙ + g ∗ − Q ∗ = 0 (11)</p><p>则根据准速度的选择方法，准加速度矢量 ω ˙ 是m维的，总是与系统的自由度数一致。</p></sec><sec id="s6"><title>4. 例子</title><p>如图1，一刚体作平面运动，在其重心C处引与刚体固结的坐标系Cξη约束条件为在任一时刻C点速度恒沿 Cξ 方向，设刚体的质量为M，对C点之惯性矩为I<sub>C</sub>，求刚体在任意外力作用下的运动 [<xref ref-type="bibr" rid="hanspub.34927-ref4">4</xref>]。</p><p>图1. 非完整系统的例子</p><p>作用在刚体上的外力可简化为主矢量F (设它与x轴间的夹角为 α )及对C点的主矩L<sub>C</sub>。</p><p>非完整约束条件为：</p><p>x ˙ C tan φ − y ˙ C = 0 (12)</p><p>其中x<sub>C</sub>，y<sub>C</sub>为C点在固定坐标系Oxy的坐标，φ角为Cξ 轴与x轴间的夹角。令 q = [ x ˙ c , φ , y ˙ c ] T 为广义坐标矢量， ω = [ ω 1 , ω 2 ] T 为准速度矢量。</p><sec id="s6_1"><title>4.1. 基于准速度的高斯最小拘束原理的求解</title><p>选择准速度如下：</p><p>ω 1 = x ˙ C cos φ + sin φ y ˙ C ω 2 = φ ˙ ω 3 = x ˙ C tan φ − y ˙ C (13)</p><p>则：</p><p>J = [ cos φ 0 sin φ 0 1 0 tan φ 0 − 1 ] ,     J &#175; = [ 0 ] n &#215; 1</p><p>因此可通过计算得到下列矩阵：</p><p>D = J − 1 = [ cos φ 0 sin φ cos φ 0 1 0 sin φ 0 − cos 2 φ ] ,     D ω = [ cos φ 0 0 1 sin φ 0 ]</p><p>w = D ˙ ω ′ = [ − sin φ φ ˙ ω 1 0 cos φ φ ˙ ω 1 ]</p><p>A * = D ω T A D ω = [ cos φ 0 0 1 sin φ 0 ] T [ M I C M ] [ cos φ 0 0 1 sin φ 0 ] = [ M I C ]</p><p>g * = D ω T ( A w + g ) = [ 0 0 ]</p><p>Q * = D ω T Q = [ cos φ 0 0 1 sin φ 0 ] T [ F cos α L C F sin α ] = [ F cos φ cos α + F sin φ sin α L C ]</p><p>将A<sup>*</sup>，g<sup>*</sup>，Q<sup>*</sup>代入矩阵方程(11)，即：</p><p>M ω ˙ 1 = F cos φ cos α + F sin φ sin α I c ω ˙ 2 = L c (14)</p><p>通过方程(14)计算得到 ω ˙ = [ ω ˙ 1 ω ˙ 2 ] T ，将其代入(13)，可得到广义速度，通过一次积分即可得到下一时</p><p>刻的广义坐标的值。</p><p>数值计算结果见图2，图3显示了针对约束方程(12)的违约关系图，因准坐标方法中速度约束的自动满足，使得数值结果对约束方程的误差几乎可以忽略。</p></sec><sec id="s6_2"><title>4.2. 基于Routh方程的求解方法</title><p>由非完整系统的Routh方程可以得到：</p><p>M x &#168; C = F cos α + λ tan φ M y ⃛ C = F sin α − λ I C ω ˙ 2 = L C (15)</p><p>方程组(15)连同约束方程(12)式，可以得到系统的动力学解，数值求解结果如图4及图5所示。</p></sec><sec id="s6_3"><title>4.3. 两种方法的对比分析</title><p>a. 基于方程的对比：</p><p>采用两种方法所得到的方程分别为(14)及(15)，通过消掉方程(15)中的 λ ，我们可以得出两种方法是数学上等价的；但方程(14)仅含有两个封闭的准加速度方程的微分方程组，而要采用方程(15)，需要联立约束方程(12)，需要求解包含四个方程的微分代数方程组，显然前者的求解难度要小得多；</p><p>由方程(15)的右边项可以看出：</p><p>当 φ = π 2 + k π 时， tan φ 没有意义，需要额外处理奇异问题，而方程(14)则避免了此问题。</p><p>b. 基于数值运算结果的对比：</p><p>图2及图4中，通过两种方法所计算的质心坐标在最初五个波峰前几乎是重合的，从数值层面证明了两种方法的数学等效性；</p><p>图3及图5显示了两种方法的速度违约情况，通过对比可知，Routh方法由于速度方程的违约，位移曲线随着仿真时间的增长，其违约程度越来越大。</p><p>综上所述，同传统的Routh方法相比，采用准坐标形式的动力学矩阵方程(11)来解决非完整系统的动力学问题，计算速度快，且在不需要额外修正的情况下，可有效地避免违约及位置奇异问题。</p></sec></sec><sec id="s7"><title>5. 结论</title><p>同目前常用的以动力学状态函数表达的针对非完整系统的动力学微分方程相比，本文采用高斯原理推导得到了以准坐标形式的动力学微分方程，它以准速度的显式矩阵形式表示，维数与自由度一致，具有较强的通用性及规范性，适用于多体系统的程式化建模及计算的要求。</p><p>图2. 质心坐标随时间变化关系图(准坐标法)</p><p>图3. 速度违约图(准坐标法)</p><p>图4. 质心坐标随时间变化关系图(Routh法)</p><p>图5. 未加修正的速度违约图(Routh法)</p><p>文中的准坐标动力学方程同现有的求解非完整约束系统的Routh方程数学上等价，但可不需要额外处理速度违约及位置奇异问题。</p><p>本文是对非完整系统动力学与控制问题的更简单规范的建模方法的探索。</p></sec><sec id="s8"><title>文章引用</title><p>郝 鑫,刘彦平,姚文莉. 准坐标形式的非完整刚体系统动力学方程及数值模拟 Dynamic Equation and Numerical Simulation of Nonholonomic Multibody System in Quasi-Coordinate Form[J]. 动力系统与控制, 2020, 09(02): 121-128. https://doi.org/10.12677/DSC.2020.92011</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.34927-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">刘才山. 分析动力学中的基本方程与非完整约束[J]. 北京大学学报(自然科学版), 2016, 52(4): 756-766.</mixed-citation></ref><ref id="hanspub.34927-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">梅凤翔. 非完整系统力学基础[M]. 北京: 北京工业学院出版社, 1985.</mixed-citation></ref><ref id="hanspub.34927-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">刘延柱. 高等动力学[M]. 北京: 高等教育出版社, 2000.</mixed-citation></ref><ref id="hanspub.34927-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">陈滨. 分析动力学(第2版) [M]. 北京: 北京大学出版社, 2012</mixed-citation></ref><ref id="hanspub.34927-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">黄昭度, 钟奉俄. 工程系统分析力学[M]. 北京: 高等教育出版社, 1992.</mixed-citation></ref><ref id="hanspub.34927-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">C.A.杰格日达, Щ.X.索尔塔哈诺夫, М.Л.尤士科夫. 非完整系统的运动方程和力学的变分原理[M]. 梅凤翔, 译. 北京: 北京理工大学出版社, 2007.</mixed-citation></ref><ref id="hanspub.34927-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">刘恩远. 变质最可控力学系统的Gauss原理和Appell方程[J]. 固体力学学报, 1986, 2.</mixed-citation></ref><ref id="hanspub.34927-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Kalaba, R.E. and Udwadia, F.E. (1993) Equations of Motion for Nonholonomic, Constrained Dynamical Systems via Gauss’s Principle. Journal of Applied Mechanic, 60, 662-668. https://doi.org/10.1115/1.2900855</mixed-citation></ref><ref id="hanspub.34927-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Udwadia, F.E. and Kalaba, R.E. (1992) A New Perspective on Constrained Motion. Proceedings of Royal Society A, 439, 407-410. https://doi.org/10.1098/rspa.1992.0158</mixed-citation></ref><ref id="hanspub.34927-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Kozlov, V.V. (2008) Gauss Principle and Realization of Con-straints. Regular and Chaotic Dynamics, 13, 431-434.  
https://doi.org/10.1134/S1560354708050055</mixed-citation></ref></ref-list></back></article>