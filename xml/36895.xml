<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2020.108149</article-id><article-id pub-id-type="publisher-id">CSA-36895</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20200800000_47906344.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于TOA算法的UWB的室内定位系统设计
  Design of UWB Positioning System Based on TOA Algorithm
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>继东</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>侯</surname><given-names>庆</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>贵州大学计算机科学与技术学院，贵州 贵阳</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>04</day><month>08</month><year>2020</year></pub-date><volume>10</volume><issue>08</issue><fpage>1437</fpage><lpage>1443</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文首先对目前的室内定位系统进行分析，总结目前的室内定位技术的特点，并对几种常用的算法(基于到达时间差，基于到达时间等)进行对比；然后，对基于到达时间算法的定位系统进行设计，实现该定位系统并进行测试定位效果。实验结果表明，本文实现的基于到达时间TOA算法的UWB定位系统具有较好的定位效果，能够满足生活中的一些室内定位场景的需求。 Firstly, this paper analyzes the current indoor positioning system, summarizes the characteristics of the current indoor positioning technology, and compares several commonly used algorithms (based on time difference of arrival, based on time of arrival, etc.). Then, the positioning system based on time of arrival is designed to realize the positioning system and test the positioning effect. Experimental results show that the UWB positioning system based on arrival time TOA algorithm implemented in this paper has better positioning effect and can meet the requirements of some indoor positioning scenes in daily life. 
  
 
</p></abstract><kwd-group><kwd>定位系统，超宽带，室内定位, Positioning System</kwd><kwd> UWB</kwd><kwd> Indoor Positioning</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于TOA算法的UWB的室内定位系统设计</title><p>赵继东，侯庆</p><p>贵州大学计算机科学与技术学院，贵州 贵阳</p><p>收稿日期：2020年7月14日；录用日期：2020年7月29日；发布日期：2020年8月5日</p><disp-formula id="hanspub.36895-formula21"><graphic xlink:href="//html.hanspub.org/file/2-1541836x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文首先对目前的室内定位系统进行分析，总结目前的室内定位技术的特点，并对几种常用的算法(基于到达时间差，基于到达时间等)进行对比；然后，对基于到达时间算法的定位系统进行设计，实现该定位系统并进行测试定位效果。实验结果表明，本文实现的基于到达时间TOA算法的UWB定位系统具有较好的定位效果，能够满足生活中的一些室内定位场景的需求。</p><p>关键词 :定位系统，超宽带，室内定位</p><disp-formula id="hanspub.36895-formula22"><graphic xlink:href="//html.hanspub.org/file/2-1541836x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-1541836x7_hanspub.png" /> <img src="//html.hanspub.org/file/2-1541836x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着定位技术的发展，人们对定位具体应用场景的需求也在不断扩大，逐渐从室外扩大到了室内，如：对人员进行室内看护、仓库货物的定位、服务机器人、大型商场等。常见的室内定位技术包括，基于WIFI的定位、蓝牙定位、RFID定位、UWB定位、红外线定位、ZigBee定位等，目前这些技术面临定位精度不高、建设成本高、功耗高、定位效果不稳定等难题，而超带宽UWB技术具有定位精度高、抗干扰能力强、分辨率高、功耗低等优点，对于室内定位的算法，主要有基于到达时间，基于到达时间差、基于到达角度、基于接收的信号强度等 [<xref ref-type="bibr" rid="hanspub.36895-ref1">1</xref>]，基于到达角度不仅需要测量距离还需特殊设备测量角度，对设备要求较高，较难实现；基于信号强度算法是根据信号衰减模型，其定位精度不高，本文技术选型为超宽带UWB技术，使用到达时间算法，能够解决上述室内定位的难题，具有较好的定位效果。</p></sec><sec id="s4"><title>2. 定位系统简介</title><sec id="s4_1"><title>2.1. 室内定位系统的特点</title><p>与室外定位不同，室内空间狭小、有限并且有墙壁遮挡，卫星信号会被墙壁遮挡，反射，定位精度会有非常大的误差，故不能使用卫星进行定位；室内定位的技术主要包括：无线通讯、基站定位、红外定位等方式，通过一些固定在室内的设备发送的信号和固定在被定位物体上的设备进行信号交互，测出距离或角度，利用信号衰减模型或数学方法计算出定位物体的坐标。</p></sec><sec id="s4_2"><title>2.2. 室内定位技术的分类</title><p>1) 基于超宽带UWB室内定位</p><p>超宽带UWB (Ultra Wideband)技术，UWB和传统的通信技术不同，它通过发送和接收具有纳秒或微秒级以下的极窄脉冲来实现无线传输的。由于脉冲时间宽度极短，因此可以实现频谱上的超宽带：使用的带宽在500 MHz以上，它具有高精度、强穿透能力、抗多径抗干扰能力强、功耗极低等特点 [<xref ref-type="bibr" rid="hanspub.36895-ref2">2</xref>]。通过基站和定位标签发送和接收信号来实现测距，然后通过一些定位算法计算得出定位坐标，其定位精度可达厘米级。</p><p>2) 基于红外线的室内定位</p><p>红外线室内定位的原理是在定位标签上安装红外射线发射装置，把光学传感器安装在要定位的室内区域，通过测量距离或角度来实现定位，但是红外线是光的一种，所以穿透性极差，如果传播过程中被物体遮挡，定位误差就比较大，只能通过增加红外线接收设备来提高定位精度，这样会提高成本。</p><p>3) 基于蓝牙技术的室内定位</p><p>蓝牙定位首先需要在定位区域内布设蓝牙设备，蓝牙标签设备进入定位区域后，不断向周围广播信号和数据包，测出蓝牙标签设备在不同基站下的信号强度 [<xref ref-type="bibr" rid="hanspub.36895-ref3">3</xref>]，然后通过信号传播模型匹配出标签设备和基站的距离，然后通过定位算法计算出定位坐标。</p><p>4) 基于RFID的定位技术</p><p>RFID是一种非接触式自动识别技术，它通过射频信号自动识别目标对象并获取相关数据 [<xref ref-type="bibr" rid="hanspub.36895-ref4">4</xref>]。RFID的原理是通过调节发射能量来调节读写距离的RFID读写器，这样如果RFID标签离读写器越远能量就越小，反之就越近，通过设置阈值、接收信号强度、相位等参数，利用定位算法完成距离和方位的计算。</p><p>5) 基于WIFI定位技术</p><p>WIFI定位技术的原理是通过在定位区域内放置若干个无线AP，并且每个无线AP都有唯一的MAC地址，当被定位设备开启WIFI情况下，就可以扫描周围的AP信号，将周围扫描到无线信号列表中 [<xref ref-type="bibr" rid="hanspub.36895-ref5">5</xref>]，就类似于手机扫描周围WIFI信号，距离不同的AP，接收到的信号强度也不同，建立信号强度与距离关系的模型，实现测距，进行定位。</p></sec><sec id="s4_3"><title>2.3. 定位算法的分类</title><p>1) 基于到达角度定位AOA (Angle of Arrival) [<xref ref-type="bibr" rid="hanspub.36895-ref6">6</xref>]</p><p>该定位算法是通过某些硬件设备测量出基站和标签之间的距离和角度，然后再利用三角函数之间的关系来计算出标签的位置，该方法对设备要求较高，原理如图1所示。</p><p>图1. 基于到达角度定位原理图</p><p>2) 基于接收的信号强度指示RSSI (Received Signal Strength Indication) [<xref ref-type="bibr" rid="hanspub.36895-ref7">7</xref>]</p><p>该定位方法是依据信号传播模型，信号会随着距离的增加而衰减，建立能量衰减和距离的模型，通过指纹匹配法来匹配基站和标签的距离，从而对目标进行定位。</p><p>3) 基于到达时间(TOA, Time of Arrival) [<xref ref-type="bibr" rid="hanspub.36895-ref8">8</xref>]</p><p>该方法是事先已知基站坐标，通过基站向标签发送信号，根据信号的传播时间来计算出距离，然后利用数学方法计算出标签位置，该方法至少需要三个定位基站，详见下节。</p><p>4) 基于到达时间差TDOA (Time Difference of Arrival) [<xref ref-type="bibr" rid="hanspub.36895-ref9">9</xref>]</p><p>基于到达时间差TDOA (Time Difference of Arrival)要求基站时间同步，在此前提下发送脉冲信号，标签通过各个基站发出的信号的到达时间差，该定位模型是两组双曲线，结合基站的位置坐标(x<sub>i</sub>, y<sub>i</sub>)，基站到标签的距离d<sub>i</sub>，对标签进行定位的方法 [<xref ref-type="bibr" rid="hanspub.36895-ref10">10</xref>]，原理如图2所示。</p></sec></sec><sec id="s5"><title>3. UWB室内定位系统设计</title><sec id="s5_1"><title>3.1. 定位系统总体架构</title><p>定位系统总体架构如图3所示，基站和标签主要由DWM1000模块和STM32组成，DWM1000模块是基于DW1000芯片设计的超宽带收发模组。该模块集成了天线及所有的射频电路、电源管理和时钟电路 [<xref ref-type="bibr" rid="hanspub.36895-ref11">11</xref>]，能够收发UWB信号，各基站与标签进行信号交互，STM32记录每次的传播时间，计算出对应基站和标签的距离，然后发送给基站A，由基站A将数据汇总通过串口发送给上位机，由上位机根据TOA定位算法求解定位坐标。</p><p>图2. 基于到达时间差定位原理图</p><p>图3. 定位系统架构图</p></sec><sec id="s5_2"><title>3.2. 双边双向测距模型</title><p>双边双向测距(Double-sided Two-way Ranging)算法是对单边双向测距的一种扩展，该算法记录了信号往返的两个时间戳，通过计算可以得到信号传播时间，记录两个往返时间虽然会增加系统的响应时间，但会提高测距的精度和稳定性。</p><p>在具体定位过程中，每个UWB定位基站给标签发送信号，发送时间记为T<sub>1</sub>，信号到达时间分别为T<sub>2</sub>，然后标签发送应答信号时间为T<sub>3</sub>，到达基站的时间为T<sub>4</sub>，基站发送一个终止帧时间为T<sub>5</sub>，标签收到终止帧时间为T<sub>6</sub>，计算飞行时间的公式如下，飞行时间乘以信号传播速率得出基站和标签的距离，此次测距过程完成，具体过程如图4所示。</p><p>图4. 双边双向测距模型图</p><p>计算UWB信号飞行时间的公式如下：</p><p>T t o f = ( T r o u n d A &#215; T r o u n d B − T r e p l y A &#215; T r e p l y B ) ( T r o u n d A + T r o u n d B + T r e p l y A + T r e p l y B )</p></sec><sec id="s5_3"><title>3.3. TOA定位算法模型</title><p>基于TOA (Time of Arrival)定位算法，在室内非视距NLOS情况下，可以把每个基站和标签发送的信号抽象成一个圆形，算法模型如图5所示，要想实现定位，至少需要三个基站，这三个基站和标签形成的圆会交于一点，该交点就是标签的位置。模型如图5所示，标签坐标为(x, y)，每个基站的坐标(x<sub>i</sub>, y<sub>i</sub>)，基站到标签的距离为d<sub>i</sub>，可以列出方程：</p><p>图5. 基于到达时间定位原理图</p><p>{ ( x − x 1 ) 2 + ( y − y 1 ) 2 = d 1 ( x − x 2 ) 2 + ( y − y 2 ) 2 = d 2 ( x − x 3 ) 2 + ( y − y 3 ) 2 = d 3</p><p>上面方程中，各基站的坐标(x<sub>i</sub>, y<sub>i</sub>)需要事先设置、测量，所以各基站坐标(x<sub>i</sub>, y<sub>i</sub>)已知，基站到标签的距离d<sub>i</sub>可以根据双边双向测距模型，测出每个基站到标签的飞行时间T<sub>tofi</sub>，UWB的传播速率为光速，将飞行时间乘以传播速率就可得到基站到标签的距离d<sub>i</sub>，于是，上面公式就只有(x, y)未知，通过求解上述方程，可以得到标签坐标(x, y)，完成定位。</p><p>按上述方法，每三个基站可组成一组定位基站，可以确定一个标签坐标，当基站个数为n时，会有 c n 3 种组合，当n个基站每次定位同一个标签时会得出 c n 3 个坐标，将得到的坐标进行平均，得出一个精度比较精准的最终质心坐标。</p></sec></sec><sec id="s6"><title>4. 实验与分析</title><p>实现上述算法和系统之后，需要测试该系统的定位效果，于是设计了如图6测试方案，在一个10 m &#215; 10 m的范围内进行测试，设备由三个基站、一个标签和一个装有上位机软件的电脑组成，三个基站坐标分别是：A基站(0, 0)，B基站(10, 0)，C基站(0, 10)，在测量过程中，上位机通过串口发送命令给基站A，基站A分别发送命令给B、C基站执行测距操作，基站A，B，C同时，不断地给标签发送测距信号，标签收到信号后进行测距计算，将数据发给基站A，A基站将数据通过串口传给上位机，上位机通过到达时间算法，计算出定位标签坐标。</p><p>图6. 定位实验图</p><p>按照上述实验方案对基于TOA算法的UWB定位系统进行了室内定位实验，实验结果如图7所示，平均定位精度能达到30 cm左右，相比其他室内定位技术的米级定位精度，该系统定位精度很高。</p><p>图7. 定位效果误差图</p></sec><sec id="s7"><title>5. 总结</title><p>本文在介绍各种室内定位技术和算法后，因UWB技术具有高精度、强穿透能力、抗多径抗干扰能力强、功耗极低等特点，选定了UWB定位技术，并且使用双边双向测距算法和到达时间TOA定位算法，然后设计该系统的架构，并且实现了该系统测试实际环境下的定位精度，实验表明，该系统具有较高的定位精度，能够满足特定场景下室内定位的需求。</p></sec><sec id="s8"><title>文章引用</title><p>赵继东,侯 庆. 基于TOA算法的UWB的室内定位系统设计Design of UWB Positioning System Based on TOA Algorithm[J]. 计算机科学与应用, 2020, 10(08): 1437-1443. https://doi.org/10.12677/CSA.2020.108149</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.36895-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">李德鹏. 基于RFID的景区讲解员动态调度技术研究[D]: [硕士学位论文]. 南京: 南京师范大学, 2013.</mixed-citation></ref><ref id="hanspub.36895-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">吕昕. 基于UWB的危化品仓储堆垛货物定位技术的研究[D]: [硕士学位论文]. 北京: 北京化工大学, 2015.</mixed-citation></ref><ref id="hanspub.36895-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">贾静静. 物联网定位技术超全解析!定位正在从室外走向室内[J]. 物联网技术, 2018, 8(3): 4-9.</mixed-citation></ref><ref id="hanspub.36895-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">张彬. 天津环球磁卡股份有限公司RFID产品研发战略管理[D]: [硕士学位论文]. 天津: 天津大学, 2009.</mixed-citation></ref><ref id="hanspub.36895-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">刘希骞. 基于Android手机定位系统的设计与实现[D]: [硕士学位论文]. 曲阜: 曲阜师范大学, 2016.</mixed-citation></ref><ref id="hanspub.36895-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">王锦涛, 皇甫一鸣, 李哲舟, 冯婧. 基于UWB测距技术的室内定位研究[J]. 通信电源技术, 2018, 35(5): 50-53+56.</mixed-citation></ref><ref id="hanspub.36895-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">杨超超, 陈建辉, 刘德亮, 郭希维, 方正. 基于到达时间和到达角度的室内联合定位算法[J]. 激光与光电子学进展, 2019, 56(22): 203-209.</mixed-citation></ref><ref id="hanspub.36895-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">高思远, 冯秀芳. 基于RSSI信号特征的室内分区指纹定位算法[J]. 计算机工程与设计, 2020, 41(4): 1093-1098.</mixed-citation></ref><ref id="hanspub.36895-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">(2020) Robotics; Researchers from Hongik University Report New Studies and Findings in the Area of Robotics (Non-Line-of-Sight Error Mitigating Algorithms for Transmitter Localization Based on Hybrid Toa/rssi Measurements). Journal of Robotics &amp; Machine Learning.</mixed-citation></ref><ref id="hanspub.36895-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">张俊鹏. 基于无线传感器网络的车位感知系统研究[D]: [硕士学位论文]. 北京: 北京邮电大学, 2017.</mixed-citation></ref><ref id="hanspub.36895-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Yang, B., Yang, Z.Y., Wang, D., et al. (2020) A La-grangian Multiplier Method for TDOA and FDOA Positioning of Multiple Disjoint Sources with Distance and Velocity Correlation Constraints. Mathematical Problems in Engineering, 2020, Article ID 1382321. &lt;br&gt;https://doi.org/10.1155/2020/1382321</mixed-citation></ref></ref-list></back></article>