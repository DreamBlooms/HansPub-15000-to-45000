<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2016.68061</article-id><article-id pub-id-type="publisher-id">CSA-18378</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20160800000_22491247.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于Unity3D的体感游戏设计与实现
  The Design and Implementation of Motion Sensing Game Based on Unity 3D
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>斯</surname><given-names>琴</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>侯</surname><given-names>建峰</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>北方工业大学计算机学院，北京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>houjianfeng@ncut.edu.cn(侯建)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>17</day><month>08</month><year>2016</year></pub-date><volume>06</volume><issue>08</issue><fpage>492</fpage><lpage>497</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  本文利用Unity这款跨平台的游戏开发引擎，结合Kinect可获取人体骨骼数据的设备，设计并实现了一款切水果体感游戏。在界面设计部分，借助Unity3D平台规划了游戏的主体框架，实现了游戏主要模块的功能。在体感技术方面，使用Kinect的摄像机获取现实场景作为游戏背景，使用Kinect获取玩家骨骼数据，通过程序对骨骼数据的分析，实现了人机交互所需的体感动作。
   In this thesis, we design and realize a fruit-cutting game about motion sensing with the help of the Unity, a cross-platform game development engine, and Kinect, an equipment which can access available human body skeleton data. In interface design part, with the aid of Unity3D platform, we plan the main framework of the game and realize the main module’s function. As for motion sensing technology, we use the camera of Kinect to obtain the real scene as a gaming background. We also use the Kinect device to obtain the player bone data. Through the program’s analysis of the bone data, we finally realize the human-computer interaction for motion sensing.
 
</p></abstract><kwd-group><kwd>人机交互，体感，游戏, Human-Computer Interaction</kwd><kwd> Motion Sensing Technology</kwd><kwd> Game</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于Unity3D的体感游戏设计与实现 <sup> </sup></title><p>斯琴，侯建峰</p><p>北方工业大学计算机学院，北京</p><disp-formula id="hanspub.18378-formula597"><graphic xlink:href="http://html.hanspub.org/file/6-1540613x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年7月30日；录用日期：2016年8月15日；发布日期：2016年8月23日</p><disp-formula id="hanspub.18378-formula598"><graphic xlink:href="http://html.hanspub.org/file/6-1540613x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文利用Unity这款跨平台的游戏开发引擎，结合Kinect可获取人体骨骼数据的设备，设计并实现了一款切水果体感游戏。在界面设计部分，借助Unity3D平台规划了游戏的主体框架，实现了游戏主要模块的功能。在体感技术方面，使用Kinect的摄像机获取现实场景作为游戏背景，使用Kinect获取玩家骨骼数据，通过程序对骨骼数据的分析，实现了人机交互所需的体感动作。</p><p>关键词 :人机交互，体感，游戏</p><disp-formula id="hanspub.18378-formula599"><graphic xlink:href="http://html.hanspub.org/file/6-1540613x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>现今社会，随着科技的高速发展，软件的更新换代，游戏的形式也渐渐发生改变。例如基于体感技术的人机互动游戏悄然萌芽，渗透到人们的生活中。</p><p>相比于传统游戏，体感游戏让用户以更为自然直接的肢体动作对机器发出指令，机器通过分析用户的动作，按照预先设定的模式，来作出相应反馈。这种游戏模式改变了玩家与游戏之间互动方式，通过丰富的肢体动作与游戏互动，甩掉鼠标和键盘，深受玩家青睐 [<xref ref-type="bibr" rid="hanspub.18378-ref1">1</xref>] 。</p><p>本文利用Unity3D游戏引擎和Kinect体感设备，设计并实现了一款体感类的切水果游戏。首先，在Unity3D环境中进行以c#语言为基础的脚本编写，创建游戏对象并设计整体游戏的得分逻辑关系与函数封装。其次，通过Kinect设备发射红外线，探测红外光反射，来获取的深度数据，由此提取人体体感数据，主要需要玩家双手骨骼点信息，并转化为坐标信息，完成人机交互。将获取到的信息传入脚本程序中，使各部分连为一体。玩家只需挥动双手，消除游戏界面中弹出的游戏对象即可得分，通过累加分数至一定值，达到过关晋级的游戏效果。</p></sec><sec id="s4"><title>2. Unity3D游戏引擎</title><p>Unity作为一款基于跨平台的游戏开发引擎，以其易操作，支持语言丰富，自动化程度高，兼容性强而著称，而且被广泛应用于互动系统的开发，比如建筑可视化、虚拟现实、三维视频游戏等。</p><p>由于其编程界面可视化，便于开发，脚本编辑高效，本款游戏选择直接在Unity5.0.1平台上，利用C#语言，完成了游戏模块划分及功能实现。而且，Unity支持3D模型，可直接导入骨骼和动画，并将贴图材质自动转换为U3D格式，这也极大地方便了Kinect获取的图像信息转化为游戏背景 [<xref ref-type="bibr" rid="hanspub.18378-ref2">2</xref>] 。</p><p>此外，在基本技术操作上，Unity3D平台的出众的开发效率和优越的性能、性价比也为本研究创造了便利的条件。</p></sec><sec id="s5"><title>3. 体感技术</title><p>随着科技的发展，人机交互模式已开始出现用自然、感官技术来替代电脑的键盘和鼠标等外设，体感技术应运而生 [<xref ref-type="bibr" rid="hanspub.18378-ref3">3</xref>] 。</p><p>体感技术，一种通过对动作进行感应达到控制显示的技术，即人们可以运用肢体动作或声音与计算机进行交互 [<xref ref-type="bibr" rid="hanspub.18378-ref4">4</xref>] 。其原理为设备采取人体骨骼及姿势数据，转化成数字信号传回电脑，实现人机交互 [<xref ref-type="bibr" rid="hanspub.18378-ref5">5</xref>] 。依照体感方式与原理的不同，目前主要有机械式、光学式、电磁式、惯性、声学等体感识别技术。利用体感技术实现人机交互，最大的优点在于它允许人们通过思维引导肢体运动，实现全身心投入。而且，体感游戏改变了玩家与游戏的互动方式，让用户甩掉鼠标和键盘玩游戏，通过语言、手势等动作操纵游戏画面中的人物，带入感强，拘束度小，备受广大玩家青睐。</p><p>2010年11月微软公司于推出了一款体感外设——KINECT [<xref ref-type="bibr" rid="hanspub.18378-ref6">6</xref>] 。实际上，KINECT是一种实时进行运动捕捉、麦克风输入等功能的3D 体感摄影机。其原理为通过红外感应，采集深度信息及人体关节点信息，来识别人体运动姿势及周围环境图像。通过Kinect，人们只需做简单的动作即可实现计算机的实时交互 [<xref ref-type="bibr" rid="hanspub.18378-ref7">7</xref>] 。当Kinect与体感技术相结合，即可实现玩家用身体操控的整个过程的游戏，方便简单，适合各个年龄段用户，发展前景良好。</p></sec><sec id="s6"><title>4. 应用案例与分析</title><p>针对传统游戏存在的界面保守，操作单调的问题，本研究为提高用户游戏愉悦感和舒适度，结合了Unity3D开发平台，及体感技术，开发设计了一款切水果体感游戏。</p><p>1. 游戏简介</p><p>本款基于Unity3D技术的体感切水果游戏，以Kinect获取到的当前所处环境作为背景图。初始分值为0，初始生命值为5。</p><p>玩家通过身体控制游戏中“刀刃”，“玩家”的图像来源于KINECT 识别到的骨架数据，刀刃绑定了骨架中HandLeft 和HandRight的坐标属性。</p><p>游戏过程中，不断有水果和小动物跳出，玩家需在水果消失前，切中跳出的水果，切中与否运用了射线碰撞检测技术，当代表刀刃HandLeft 和HandRight的坐标与水果的碰撞盒相碰，代表切中水果。切中水果得分，切中小动物扣分，未切中水果减命，当生命值清零，游戏结束。当分数达到300分，过关，进入下一关卡。</p><p>本游戏画风简约，操作简单，适合作为休闲娱乐使用。</p><p>2. 游戏实现逻辑过程</p><p>1) 获取游戏背景</p><p>Kinect通过相应的API可获取到彩色图像，将其转换为texture格式，设为游戏背景图。</p><p>2) 游戏元素的生成</p><p>首先建立游戏元素预制体，本游戏包含水果预制体和小动物预制体(其中水果为游戏的消除对象，切中后出发加分逻辑，小动物为保护对象，如果被误切中，则会触发减分逻辑)，为其添加物理属性，在rigid body属性中可为其添加重力属性(Use Gravity)，定义其初始坐标为负，再给定一个向上的初速度，使其从画面下方弹出，到达界面顶部后自由落体，以比较自然的方式出现在屏幕画面中(如图1)。</p><p>3) 切中水果逻辑</p><p>首先，利用Kinect设备获取玩家手腕处骨骼数据，采集玩家手势挥动情况，获取双手的位置数据。体感设备获取到的骨骼数据，以图像中心点为坐标(0, 0)，图像左下角坐标为(−1, −1)，右上角坐标为(1, 1)，获取到手部骨骼点的坐标是在图像的相对坐标位置，即它的横纵坐标都在(−1, 1)之间，假如体感设备获取到的左手骨骼点坐标为(x<sub>0</sub>, y<sub>0</sub>)，将其转化为屏幕坐标(x, y)的公式如公式一所示，其中Screen.width为屏幕的宽度，Screen.height为屏幕的高度。</p><disp-formula id="hanspub.18378-formula600"><graphic xlink:href="http://html.hanspub.org/file/6-1540613x9_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18378-formula601"><graphic xlink:href="http://html.hanspub.org/file/6-1540613x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>Formula 1. Coordinate Position Transformation</p><p>公式1. 坐标点转化公式</p><p>图1. 游戏元素生成界面</p><p>其次，本着两个不可穿透的实体不能共享一个空间区域的原理 [<xref ref-type="bibr" rid="hanspub.18378-ref8">8</xref>] ，我们在box collider属性中，为prefab添加碰撞盒，通过在相应位置发射射线，来检测两个物体之间是否发生了碰撞，如果检测到碰撞，则出发成功切到逻辑并触发碰撞后表现的特效，即物体在碰撞后能自然弹开，溅射果汁等效果。</p><p>通过射线碰撞检测技术，如图2 [<xref ref-type="bibr" rid="hanspub.18378-ref9">9</xref>] 在三维空间内，判断获取到的手部骨骼点坐标发出射线 [<xref ref-type="bibr" rid="hanspub.18378-ref10">10</xref>] ，在与水果碰撞盒之间的有限的距离内，若射线与碰撞盒发生碰撞，则认为二切中水果，并返回碰撞点即被切中水果的位置信息，利用该位置信息，做后续的逻辑处理。此时界面根据玩家动作产生相应弧度的刀刃，完成人机交互。</p><p>4) 得分逻辑</p><p>本游戏在Unity创建游戏对象时，已提前为每个游戏对象设置了tag标签并赋予其不同属性；在脚本编写过程中，将不同游戏对象的得分逻辑封装在不同函数中，最终只需通过所切中游戏对象的名字和标记即可判断切中的游戏对象类型及是否得分。体现在游戏界面中即为玩家可自由选择消除不同水果或小动物。</p><p>5) 玩法简介</p><p>本游戏为玩家累计一定分值，从而过关的益智类小游戏。游戏过程中，界面下方不断有水果和小动物跳出，玩家需避开小动物，切中水果。切中水果，加10分，未成功躲避而切中小动物，减50分；若遗漏水果，直至其消失于界面仍未切到，减命1条。初始分值为0，命为5；分数清空，游戏不结束；生命值清空，游戏结束；当分值达到300分，成功过关。不同关卡可调节水果弹出的速度与种类，画风简单轻松，适合各年龄人群(如图3)。</p><p>6) 实现效果</p><p>本文最终实现了一款可以支持多人同时参与的切水果体感游戏，游戏执行效果如图4所示，多人可以同时利用自己的双手切除画面中产生的水果,而且，随着双手的运动轨迹产生彩色拖尾效果。切中水果加分，切中小动物模型减分，分数显示在如图4左上角处，若直至水果调出界面仍未切中，命数减一，如图4中右上角所示。玩家可点击左下角处喇叭按钮选择游戏音效：外放或静音。</p><p>图2. 射线碰撞检测示意图</p><p>图3. 整体游戏流程图</p><p>图4. 游戏效果图</p></sec><sec id="s7"><title>5. 结束语</title><p>本款基于unity3D技术的切水果体感游戏，不需要昂贵复杂的设备支持，只需连接Kinect外设，即可让玩家自由用任意姿势切中水果。不同于传统游戏中键盘和鼠标的束缚及单一化交互模式，本体感游戏极大增强了玩家的角色带入感，既增强了玩游戏时的愉悦感，又使肌体得到锻炼。本着“运动与娱乐相结合”的理念，本研究极具发展前景。而且随着体感技术的日益成熟与完备，这种寓教于乐同时还能锻炼身体的大型体感游戏必将得到大规模的推广。如何实现多感官操作，并使大众广泛接受体感游戏将成为我们下一步研究目标。</p></sec><sec id="s8"><title>文章引用</title><p>斯琴,侯建峰. 基于Unity3D的体感游戏设计与实现 The Design and Implementation of Motion Sensing Game Based on Unity 3D[J]. 计算机科学与应用, 2016, 06(08): 492-497. http://dx.doi.org/10.12677/CSA.2016.68061</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.18378-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">刘晋钢, 刘卫斌, 刘晋霞. Kinect与Unity3D数据整合技术在体感游戏中的应用研究[J]. 电脑开发与应用, 2014, 27(11): 7-11.</mixed-citation></ref><ref id="hanspub.18378-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">360百科. Unity3D [DB/OL]. http://baike.so.com/doc/5376000-5612112.html</mixed-citation></ref><ref id="hanspub.18378-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">马建荣, 章苏静, 李凤. 基于体感技术的亲子互动游戏设计与实现[J]. 中国电化教育, 2012(9): 85-88.</mixed-citation></ref><ref id="hanspub.18378-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">车力军, 孙峰. 3G时代体感游戏的发展思考[J]. 电信技术, 2011(11): 55-58.</mixed-citation></ref><ref id="hanspub.18378-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">张浩鹏. Kinect: 人机交互新入口[J]. IT经理世界, 2012(19): 20-20.</mixed-citation></ref><ref id="hanspub.18378-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">中国百科网. 基于Kinect深度图像信息的手势跟踪与识别[J/OL].  
http://www.chinabaike.com/t/10472/2016/0201/4333071.html</mixed-citation></ref><ref id="hanspub.18378-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">马宁. 体感游戏简史[J]. 程序员, 2010(12).</mixed-citation></ref><ref id="hanspub.18378-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">张绍江. 基于Unity 虚拟校园漫游系统的设计与开发[J]. 天津中德职业技术学院学报, 2014(5): 65-67.</mixed-citation></ref><ref id="hanspub.18378-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">de Byl, P. (2014) Holistic Mobile Game Development with Unity. Focal Press, Waltham, Massachusetts.</mixed-citation></ref><ref id="hanspub.18378-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">乐小燕, 代俊雅, 郑海滨, 等. Kinect与Unity结合的人体骨骼控制方法[J]. 信息与电脑(理论版), 2013(7).</mixed-citation></ref></ref-list></back></article>