<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">FIN</journal-id><journal-title-group><journal-title>Finance</journal-title></journal-title-group><issn pub-type="epub">2161-0967</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/FIN.2021.114036</article-id><article-id pub-id-type="publisher-id">FIN-43969</article-id><article-categories><subj-group subj-group-type="heading"><subject>FIN20210400000_21389388.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>经济与管理</subject></subj-group></article-categories><title-group><article-title>
 
 
  沪深300股指期权定价实证研究——基于BS、CEV、Heston模型的对比分析
  An Empirical Study on the Pricing of CSI 300 Index Options—Based on BS, CEV, and Heston Models
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>翔</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>治</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>南开大学经济学院，天津</addr-line></aff><pub-date pub-type="epub"><day>18</day><month>06</month><year>2021</year></pub-date><volume>11</volume><issue>04</issue><fpage>319</fpage><lpage>332</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  为研究沪深300股指期权定价，本文在对BS、CEV、Heston模型进行了理论分析和欧式期权定价解析式推导后，针对不同模型使用了不同的方法进行参数估计并实现了模型定价。最后本文借由对称平均绝对百分比误差(sMAPE)作为误差衡量指标，得出了实证结论：1) 三个模型对期权的估值整体呈现高估的态势，整体拟合优度CEV模型 &gt; BS模型 &gt; Heston模型；2) 从虚实期权角度来看，三个模型均对实值期权拟合效果更好，对虚值期权而言CEV模型拟合效果最好，对实值期权而言Heston模型拟合效果最好；3) 进一步探究发现，BS模型和CEV对短到期期限、低价值的期权拟合效果相对较好，Heston模型对低执行价、短到期期限、低价值的期权拟合效果较好。
   In order to study the CSI 300 stock index option pricing, after theoretical analysis of the BS, CEV, and Heston models and analytical derivation of European option pricing, different methods are used for parameter estimation and model pricing for different models. Finally, this paper uses the sym-metric mean absolute percentage error (sMAPE) as the error measurement index to draw the em-pirical conclusions: 1) The valuation of options by the three models is generally overestimated, and the overall goodness of fit: CEV model &gt; BS model &gt; Heston model; 2) From the perspective of out- of-the-money/real options, the three models are better for real options; The CEV model has the best fitting effect for out-of-the-money options, and the Heston model has the best fitting effect for real- valued options; 3) Further exploration found that the BS model and CEV have a relatively better fit-ting effect on short-expiration and low-value options, and the Heston model has a relatively better fitting effect on low-strike, short-expiration, and low-value options.
 
</p></abstract><kwd-group><kwd>沪深300股指期权，波动率，BS模型，CEV模型，Heston模型, CSI 300 Stock Index Options</kwd><kwd> Volatility</kwd><kwd> BS Model</kwd><kwd> CEV Model</kwd><kwd> Heston Model</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>为研究沪深300股指期权定价，本文在对BS、CEV、Heston模型进行了理论分析和欧式期权定价解析式推导后，针对不同模型使用了不同的方法进行参数估计并实现了模型定价。最后本文借由对称平均绝对百分比误差(sMAPE)作为误差衡量指标，得出了实证结论：1) 三个模型对期权的估值整体呈现高估的态势，整体拟合优度CEV模型 &gt; BS模型 &gt; Heston模型；2) 从虚实期权角度来看，三个模型均对实值期权拟合效果更好，对虚值期权而言CEV模型拟合效果最好，对实值期权而言Heston模型拟合效果最好；3) 进一步探究发现，BS模型和CEV对短到期期限、低价值的期权拟合效果相对较好，Heston模型对低执行价、短到期期限、低价值的期权拟合效果较好。</p></sec><sec id="s2"><title>关键词</title><p>沪深300股指期权，波动率，BS模型，CEV模型，Heston模型</p></sec><sec id="s3"><title>An Empirical Study on the Pricing of CSI 300 Index Options—Based on BS, CEV, and Heston Models<sup> </sup></title><p>Xiang Zhang<sup>*</sup>, Zhi Li<sup>#</sup></p><p>School of Economics, Nankai University, Tianjin</p><p><img src="//html.hanspub.org/file/14-1140583x5_hanspub.png?20210721084525620" /></p><p>Received: Jun. 6<sup>th</sup>, 2021; accepted: Jun. 21<sup>st</sup>, 2021; published: Jul. 20<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/14-1140583x6_hanspub.png?20210721084525620" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>In order to study the CSI 300 stock index option pricing, after theoretical analysis of the BS, CEV, and Heston models and analytical derivation of European option pricing, different methods are used for parameter estimation and model pricing for different models. Finally, this paper uses the symmetric mean absolute percentage error (sMAPE) as the error measurement index to draw the empirical conclusions: 1) The valuation of options by the three models is generally overestimated, and the overall goodness of fit: CEV model &gt; BS model &gt; Heston model; 2) From the perspective of out-of-the-money/real options, the three models are better for real options; The CEV model has the best fitting effect for out-of-the-money options, and the Heston model has the best fitting effect for real-valued options; 3) Further exploration found that the BS model and CEV have a relatively better fitting effect on short-expiration and low-value options, and the Heston model has a relatively better fitting effect on low-strike, short-expiration, and low-value options.</p><p>Keywords:CSI 300 Stock Index Options, Volatility, BS Model, CEV Model, Heston Model</p><disp-formula id="hanspub.43969-formula6"><graphic xlink:href="//html.hanspub.org/file/14-1140583x7_hanspub.png?20210721084525620"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/14-1140583x8_hanspub.png?20210721084525620" /> <img src="//html.hanspub.org/file/14-1140583x9_hanspub.png?20210721084525620" /></p></sec><sec id="s5"><title>1. 引言</title><p>期权是金融衍生品市场的重要组成部分，其本质上是一种合约，赋予了持有人在未来以某一特定价格买入或卖出某一资产权利。期权本质上是依托于现货而存在的，对于期权而言最核心的内容就是定价。合理定价的期权能丰富金融市场，为投资者提供对冲、保值的手段；而若期权定价偏离了公允价值，则会诱发套利行为的发生，严重会波及现货市场，造成股市动荡。</p><p>2020年中我国A股市场整体在动荡中上行，而期权作为一种能提供风险对冲功能的衍生品，在2020年也备受青睐。于2019年12月23日推出的沪深300股指期权是我国第一只股指期权，其意义不言而喻。我国各大证券交易所多次要求各做市商做好期权的风险管理工作，主要参考指标是Delta、Vega、Gamma等希腊值。但是这些希腊值仅是期权定价模型的附属品，要想准确的计算出期权的市场价值，还是应当首先从定价模型入手。因此本文基于BS、CEV、Heston模型，对沪深300期权定价进行了实证研究。</p></sec><sec id="s6"><title>2. 文献综述</title><p>已有文献中一般预测金融资产波动率的模型有两类：历史波动率模型和内含波动率模型。历史波动率的代表模型就是条件异方差GARCH模型，是由T. Bollerslev [<xref ref-type="bibr" rid="hanspub.43969-ref1">1</xref>] 于1986年在Engel提出的ARCH模型(1982)的基础上拓展提出的，GARCH模型相比ARCH模型更能体现出金融资产的长期记忆性。在此之后越来越多的学者对GARCH模型进行了优化，如1991年Nelson [<xref ref-type="bibr" rid="hanspub.43969-ref2">2</xref>] 提出EGARCH模型和Glosten等 [<xref ref-type="bibr" rid="hanspub.43969-ref3">3</xref>] 于1993年提出的GJR-GARCH模型，能较好的解决股票波动率的“杠杆效应”问题”。在随机波动率模型的研究上，Heston [<xref ref-type="bibr" rid="hanspub.43969-ref4">4</xref>] 最早于1993年基于随机波动率给出了欧式期权的定价模型；而蒋祥林等 [<xref ref-type="bibr" rid="hanspub.43969-ref5">5</xref>] 于2005年基于Bayes原理对随机波动率SV-N和SV-T模型进行了研究，并通过实证发现随机波动率模型优于GARCH模型。在隐含波动率领域Henry A. Latan&#233;和Richard J. Rendleman Jr [<xref ref-type="bibr" rid="hanspub.43969-ref6">6</xref>] 于1976年最早通过实证研究了隐含波动率模型的拟合效果，并认为隐含波动率模型优于当时的历史波动率模型。郑振龙等 [<xref ref-type="bibr" rid="hanspub.43969-ref7">7</xref>] 于2010年通过对不同的模型的预测效果进行对比分析，得出内含波动率模型更适合预测长期波动率，而GARCH模型更适合预测短期波动率的结论。倪中新等 [<xref ref-type="bibr" rid="hanspub.43969-ref8">8</xref>] 于2020年对上证50 ETF进行实证，发现由BS公式推导出的内含波动率–执行价曲线对股票收益具有显著的预测能力。</p><p>目前期权定价模型主要可分为四类：BS模型、BS替代模型、随机波动率模型和IVF模型。BS模型是期权定价领域的基石，最早由Black等 [<xref ref-type="bibr" rid="hanspub.43969-ref9">9</xref>] 于1973年提出，该模型最基本的假设就是股票价格服从几何布朗运动。此模型的提出，极大地促进了金融衍生品的发展。BS替代模型用其他连续扩散过程代替几何布朗运动或者在连续的运动过程中附加跳跃性，这些过程统称为levy过程。其中，Cox John C和Ross Stephen A [<xref ref-type="bibr" rid="hanspub.43969-ref10">10</xref>] 在1976年提出了CEV(常方差弹性模型)模型，此模型在几何布朗运动基础上赋其予维纳过程项前的系数S一个β次方的权重，由此模拟资产价格概率分布左端肥尾( β &lt; 1 )或右端肥尾( β &gt; 1 )的情况。Merton Robert C [<xref ref-type="bibr" rid="hanspub.43969-ref11">11</xref>] 在1976年把跳跃过程加入到连续的运动过程中，即默顿跳跃–连续模型，该模型给出的分布左右端均肥大。第三类是随机波动率模型，即假设波动率是随时间变化的。Heston [<xref ref-type="bibr" rid="hanspub.43969-ref4">4</xref>] 于1993年提出随机波动率Heston模型，其假设 σ ( t ) = v ，而v服从一个CIR过程。P. Hagan等 [<xref ref-type="bibr" rid="hanspub.43969-ref12">12</xref>] 在2002年提出了SARS模型，这种模型最大的优点是可以很好地拟合波动率微笑。最后一类IVF(隐含波动率函数)模型，该模型能够做到使期权价格和市场价格完全匹配，由B. Dupire [<xref ref-type="bibr" rid="hanspub.43969-ref13">13</xref>]、E. Derman [<xref ref-type="bibr" rid="hanspub.43969-ref14">14</xref>] 和M. Rubinstein [<xref ref-type="bibr" rid="hanspub.43969-ref15">15</xref>] 于1994年提出，并给出了波动率函数 σ ( S , t ) 的解析式，在实际应用中IVF模型需每天利用期权数据对参数进行校正，也因此该模型对简单期权和部分奇异期权均有高精度的拟合效果，但不适合用于长期预测和实证研究。因此本文选取了前三类模型中的代表模型做实证对比研究。</p><p>沪深300股指期权推出时间较短，因此当前对于其定价实证领域研究的文章屈指可数，其中较有代表性的是张传涛 [<xref ref-type="bibr" rid="hanspub.43969-ref16">16</xref>] 于2020年引入SVI波动率模型对沪深300股指期权进行定价，其中利用Quasi-Explicit方法对SVI模型实现了参数估计，结果显示结合了SVI模型的二叉树模型的定价效果更加精确。</p><p>综合来看，本文的主要贡献和创新主要是：1、选用当前研究文献较少的我国第一只股指期权作为实证研究样本，是对我国股指期权定价领域研究空白的补充；2、选取了三类不同模型中的代表模型：经典的BS模型、BS替代模型中的典型模型CEV模型、随机波动率模型中的典型模型Heston模型，着眼于研究不同模型的差异，以及对于股指期权价值的不同拟合效果。3、三类模型均使用简洁且精确的解析式法实现定价，同时在解析式法参数估计上的一些难点和复杂过程利用Python编写代码实现，为国内期权市场定价提供参考。</p></sec><sec id="s7"><title>3. 模型构造与欧式期权定价解析式推导</title><sec id="s7_1"><title>3.1. BS模型</title><p>BS模型 [<xref ref-type="bibr" rid="hanspub.43969-ref9">9</xref>] 是最经典的期权定价模型，其在期权定价领域基石的地位毋庸置疑，尽管近年来一直因为其严格的适用假设一直被诟病，但在我国许多期权交易机构仍在使用BS模型对期权进行估值。</p><p>BS模型认为对于任一时刻的股价有：</p><p>Δ S S ~ N ( u Δ t , σ 2 Δ t ) (1)</p><p>将其代换为对数股价形式，可得到：</p><p>ln S t ~ N ( ln S 0 + ( u − σ 2 2 ) T , σ 2 T ) (2)</p><p>也可以将其写为一个几何布朗运动过程：</p><p>Δ S = u S Δ t + σ S Δ W (3)</p><p>其中u为期望收益率率、 σ 为波动率，W为维纳过程：</p><p>Δ W = ε Δ t (4)</p><p>其中 ε 为标准正态分布</p><p>由于欧式看跌期权可由看涨期权价值和看涨看跌平价公式得到，故在此及下文中仅研究看涨期权的解析式。那么由风险中性定价可得欧式看涨期权价格：</p><p>c = E [ max ( S T − K ) e − r T , 0 ] (5)</p><p>要求解 E [ max ( S T − K ) e − r T , 0 ] ，可以先求解 E [ max ( V − K , 0 ) ] 。假设 ln V 服从正态分布，标注差为w，均值为m，定义 Q = ln V − m w ，那么Q的密度函数 h ( Q ) = 1 2 π e − Q 2 2 ，那么</p><p>E [ max ( V − K , 0 ) ] = ∫ ln V − m w ∞ ( e Q w + m − K ) h ( Q ) d Q (6)</p><p>对 e Q w + m h ( Q ) 一项进行整理：</p><p>e Q w + m h ( Q ) = 1 2 π e − Q 2 2 + Q W + m = e m + w 2 2 h ( Q − w ) (7)</p><p>带入 E [ max ( V − K , 0 ) ] 可得：</p><p>E [ max ( V − K , 0 ) ] = e m + w 2 2 ∫ ln V − m w ∞ h ( Q − w ) d Q − K ∫ ln V − m w ∞ h ( Q ) d Q (8)</p><p>求出积分可得：</p><p>E [ max ( V − K , 0 ) ] = e m + w 2 2 N ( d 1 ) − K N ( d 2 )</p><p>d 1 = ln [ E ( V ) / K ] + w 2 / 2 w d 2 = ln [ E ( V ) / K ] − w 2 / 2 w (9)</p><p>在上式基础上令 V = S T ， w = σ T ，即可得到欧式看涨期权的定价公式：</p><p>c = E [ max ( S T − K ) e − r T , 0 ] = S 0 N ( d 1 ) − K e − r t N ( d 2 ) (10)</p><p>其中：</p><p>d 1 = ln ( S 0 / K ) + ( r + 1 2 σ 2 ) T σ T d 2 = ln ( S 0 / K ) + ( r − 1 2 σ 2 ) T σ T = d 1 − σ T (11)</p></sec><sec id="s7_2"><title>3.2. CEV模型</title><p>CEV模型 [<xref ref-type="bibr" rid="hanspub.43969-ref10">10</xref>] 是BS模型的替代模型，其用另一个levy过程替代了BS模型所假设的几何布朗运动过程。</p><p>根据上文中所讨论内容，在BS模型中：</p><p>Δ S = u S Δ t + σ S Δ W (12)</p><p>而在CEV模型中，引入了一个权重 β ，使得股票价格服从以下扩散过程：</p><p>Δ S = u S Δ t + σ S β Δ W (13)</p><p>Cox John C.和Ross Stephen A.在1976给出了 σ 的近似估计值为：</p><p>σ = σ B S F 0 1 − β (14)</p><p>σ B S 为BS模型中所使用的固定波动率，也即几何布朗运动下的波动率。</p><p>在CEV模型中，当 β = 1 时，股票价格服从几何布朗运动，此时即为BS模型。</p><p>当 β &lt; 1 时， σ 随股票价格下降而上升，此时对应的情况即为隐含波动率为执行价格K递减函数的波动率微笑。如下右图所示，虚线所代表与对数收益率具有相同均值和标准差的正态分布，而实线为左图所示递减隐含波动率下的对数收益率概率分布。可见此时对数收益率的分布具有明显尖顶、左肥尾、右瘦尾的特征，见图1。</p><p>图1. 递减型波动率微笑</p><p>β &gt; 1 时， σ 随股票价格上升而上升，此时对应的情况即为隐含波动率为执行价格K递增函数的波动率微笑。其图像正好与递减型波动率微笑相反，可见此时对数收益率的分布具有明显尖顶、右肥尾、左瘦尾的特征，见图2。</p><p>图2. 递增型波动率微笑</p><p>此时依然可以利用风险中性定价原理 c = E [ max ( S T − K ) e − r T , 0 ] 得出CEV模型对欧式看涨期权的定价解析式，但在实际处理上十分困难，在此借助另一种方法求解——无套利均衡定价：</p><p>首先先了解伊藤过程，形如：</p><p>Δ x = a ( x , t ) Δ t + b ( x , t ) Δ W (15)</p><p>其中a、b为变量x和时间t的函数，W为维纳过程，那么上述过程就被定义为伊藤过程，几何布朗运动过程就是一个伊藤过程。</p><p>数学家K. Ito [<xref ref-type="bibr" rid="hanspub.43969-ref17">17</xref>] 于1951年发现了有关该扩散过程的一个重要结论——伊藤引理。伊藤引理指出，对于一个漂移率为a，方差率为b<sup>2</sup>的伊藤过程，一个关于变量x和时间t的函数G服从以下过程：</p><p>Δ G = ( ∂ G ∂ x a + ∂ G ∂ t + 1 2 ∂ 2 G ∂ x 2 b 2 ) Δ t + ∂ G ∂ x b Δ W (16)</p><p>可见上述过程也是一个伊藤过程。</p><p>现在推导CEV模型欧式看涨期权的解析式，设一个欧式看涨期权的价值为f，其为现货价格S和时间t的函数，由于CEV模型所假设的 Δ S = u S Δ t + σ S β Δ W 过程为一个伊藤过程，由伊藤引理可得：</p><p>Δ f = ( ∂ f ∂ S u S + ∂ f ∂ t + 1 2 ∂ 2 f ∂ S 2 σ 2 S 2 β ) Δ t + ∂ f ∂ S σ S β Δ W (17)</p><p>为了进行无套利定价，可以构造一个组合消除风险，即消除维纳过程。考虑这样一个组合P，由一个看涨期权空头和 ∂ f ∂ S 数量的标的股票多头组成，那么P的价值为：</p><p>P = − f + ∂ f ∂ S S (18)</p><p>那么 Δ P 的扩散过程为：</p><p>Δ P = − Δ f + ∂ f ∂ S Δ S = ( − ∂ f ∂ t − 1 2 ∂ 2 f ∂ S 2 σ 2 S 2 β ) Δ t (19)</p><p>可见 Δ P 中无维纳过程，是一个无风险组合。定义无风险利率为 r f ，那么由无套利原理有：</p><p>Δ P = ( − ∂ f ∂ t − 1 2 ∂ 2 f ∂ S 2 σ 2 S 2 β ) Δ t = r f P Δ t = r f ( − f + ∂ f ∂ S S ) Δ t (20)</p><p>整理得：</p><p>∂ f ∂ t + 1 2 ∂ 2 f ∂ S 2 σ 2 S 2 β + ∂ f ∂ S r f S = r f f (21)</p><p>由此得到了求解CEV模型欧式期权定价解析式的微分方程，对于看涨期权，关键边界条件为：</p><p>t = T 时， f = max ( S − K , 0 ) (22)</p><p>带入微分方程可解得当 β &lt; 1 时：</p><p>c = S t e − q T ( 1 − Q ( x ; 2 + 1 1 − β , y ) ) − K e − r T Q ( y ; 1 1 − β , x ) (23)</p><p>β &gt; 1 时：</p><p>c = S t e − q T ( 1 − Q ( y ; 1 β − 1 , x ) ) − K e − r T ( 1 − Q ( x ; 2 + 1 β − 1 , y ) ) (24)</p><p>其中：</p><p>x = K 2 − 2 β e − ( r − q ) ( 2 − 2 β ) T m ( 1 − β ) 2</p><p>y = S 0 K 2 − 2 β m ( 1 − β ) 2</p><p>m = σ 2 ( 1 − β ) [ e ( r − q ) ( 2 − 2 β ) T − 1 ] 2 ( r − q ) ( β − 1 ) (25)</p><p>Q ( ∗ ) 为非中心 χ 2 分布(24)</p></sec><sec id="s7_3"><title>3.3. Heston模型</title><p>Heston模型是随机波动模型的代表模型之一，最早由Steven L. Heston [<xref ref-type="bibr" rid="hanspub.43969-ref4">4</xref>] 于1993年发表的论文中提出。</p><p>在随机波动模型中，波动率不是一个固定变量而是随时间变化的，可表示为：</p><p>Δ S = u S Δ t + σ ( t ) S Δ W 1 (26)</p><p>而在Heston模型中，令：</p><p>σ t = v (27)</p><p>同时令：</p><p>Δ v = κ ( θ − v ) Δ t + δ v Δ W 2</p><p>Δ W 1 Δ W 2 = ρ Δ t (28)</p><p>这是一个CIR过程， θ 指长期方差率，v表示资产方差率，在该模型中v以k的速度被拉向长期方差率 θ 当 趋于无限时， v ( t ) 期望值趋于 θ ；</p><p>而 Δ S = u S Δ t + v S Δ W 1 也是一个伊藤过程，类似于上文对CEV模型的处理方法，由伊藤引理和无套利原理可得：</p><p>1 2 v S 2 ∂ 2 f ∂ S 2 + ρ δ v S ∂ 2 f ∂ S ∂ V + 1 2 δ 2 v ∂ 2 f ∂ v 2 + r f S ∂ f ∂ S + [ κ ( θ − v ) − λ ( S , v , t ) ] ∂ f ∂ v + ∂ f ∂ t = r f f (29)</p><p>其中 λ ( S , v , t ) 为波动率风险的价格，为不可观测量，Heston定义其值为 λ v ，同时证明了等价鞅测度下将其放在风险中性世界中可得 λ = 0 ，得以消除此项。</p><p>直接解这个方程很困难，Heston猜测Heston模型的欧式看涨期权定价解析式具有和BS解析式相似的形式：</p><p>c ( S , v , t ) = S P 1 − K e − r t P 2 (30)</p><p>如果已知 P 1 、 P 2 特征函数，那么通过傅里叶逆变换可得：</p><p>P j = 1 2 + 1 π ∫ 0 + ∞ R e [ e − i ϕ ln K f j ( x , v , τ ; ϕ ) i ϕ ] d ϕ ,     j = 1 , 2 (31)</p><p>R e [ ∗ ] 代表被积函数实数部分， x = ln S ，i为虚数单位；Heston假定 P 1 、 P 2 的特征函数具有如下形式：</p><p>f j ( x , v , τ ; ϕ ) = e [ A ( τ ; ϕ ) + B ( τ ; ϕ ) v + i ϕ x ] (32)</p><p>由(29)、(31)、(32)可得常微分方程：</p><p>d A j ( τ ; ϕ ) d τ − κ θ B j ( τ ; ϕ ) − r ϕ i = 0</p><p>d B j ( τ ; ϕ ) d τ − δ 2 B j 2 ( τ ; ϕ ) 2 + ( b j − ρ δ ϕ i ) B j ( τ ; ϕ ) − u j ϕ i + ϕ 2 2 = 0 (33)</p><p>初始条件：</p><p>A j ( 0 ; ϕ ) = B j ( 0 ; ϕ ) = 0 (34)</p><p>可以解得：</p><p>A ( τ ; ϕ ) = i r ϕ τ + a δ 2 [ ( b j − ρ δ ϕ i + h j ) τ − 2 ln ( 1 − g j e h j τ 1 − g j ) ]</p><p>B ( τ ; ϕ ) = b j − ρ δ ϕ i + h j δ 2 ( 1 − e h j τ 1 − g j e h j τ )</p><p>g j = b j − ρ δ ϕ i + h j b j − ρ δ ϕ i − h j</p><p>h j = ( ρ δ ϕ i − b j ) 2 − δ 2 ( 2 u j ϕ i − ϕ 2 )</p><p>j = 1 , 2 ，且：</p><p>u 1 = 1 2 , u 2 = − 1 2 , a = κ θ , b 1 = κ − ρ δ , b 2 = κ (35)</p><p>其中 ρ 为两个维纳过程 W 1 、 W 2 的相关系数； κ 是 v ( t ) 回归至 θ 的速度； δ 是波动率的波动率，也就是 v ( t ) 的方差。如果上述参数满足 2 κ θ &gt; δ 2 ，那么过程 v ( t ) 会是严格的正数。</p><p>[ k , t , s 0 , r ]是给定的参数，而[ v 0 , κ , θ , δ , ρ ]是需要估计的参数。</p></sec><sec id="s7_4"><title>3.4. BS、CEV、Heston模型理论对比</title><p>首先三个模型最本质的区别就是对股价的变动使用了不同的扩散过程去拟合</p><p>在BS模型中假设股价服从几何布朗运动过程：</p><p>Δ S = u S Δ t + σ S Δ W (36)</p><p>而CEV模型在此基础上加了一个权重 β ，同时对波动率也在BS模型基础上进行了近似替代，因而能较好地拟合隐含波动率为执行价格K递增或递减函数的波动率微笑：</p><p>Δ S = u S Δ t + σ S β Δ W</p><p>σ = σ B S F 0 1 − β (37)</p><p>Heston模型不再假定波动率固定，而是认为其是随时间变动的一个变量，同时使用5个参数对波动率的变动情况进行模拟，因而能够较好的拟合大部分股票的时变波动率：</p><p>Δ S = u S Δ t + v S Δ W 1</p><p>Δ v = κ ( θ − v ) Δ t + δ v Δ W 2</p><p>Δ W 1 Δ W 2 = ρ Δ t (38)</p><p>此外无论是BS、CEV还是Heston模型，它们都能通过风险中性方法或无套利均衡原理得到对应的欧式期权定价解析式，但BS的定价解析式最为简洁，Heston模型最复杂。此外若要使用三个模型的欧式期权定价解析式进行定价，除可直接获得的四个参数[ k , t , s 0 , r ]外，BS模型还需估计波动率 σ ，CEV模型需估计 σ 和 β ，Heston模型需估计[ v 0 , κ , θ , δ , ρ ]五个参数，因而在具体的参数估计方法的选择上也有差异。</p></sec></sec><sec id="s8"><title>4. 参数估计</title><sec id="s8_1"><title>4.1. 数据选取</title><p>参数估计部分的数据选取自2019年12月23日~2020年3月19日81只沪深300股指期权数据及其对应现货数据收盘价数据，其范围涵盖了不同的执行价、上市日期和到期期限，具有较好的随机性，数据来源Wind数据库。而2020年3月20号至2021年3月20日的数据将用于后文的模型拟合优度检验，故在此部分不使用。</p></sec><sec id="s8_2"><title>4.2. BS模型参数估计——基于历史内含波动率</title><p>BS模型需要的参数包括[ k , t , s 0 , r , σ ]，其中[ k , t , s 0 , r ]是给定的，唯一需要估计的是一个固定年波动率 σ ，由于本文需要估计的是一个长期的波动率，综合考虑本文选取内含波动率模型进行估计。</p><p>在具体操作中，本文使用BS模型下的BS公式在给定真实市值、执行价、现货价、无风险利率、到期期限下，反推得到81只期权的内含波动率，求平均得到固定年波动率估计值 σ = 0.190998578 。</p></sec><sec id="s8_3"><title>4.3. CEV模型参数估计——基于迭代法</title><p>CEV模型所需的参数在BS模型的基础上还有一个权重 β 。本文利用2020年3月19日之前的81只期权数据，使用迭代法设置估计精度为0.01，不断迭代减小模型预测值与真实值的误差，得到 β 的估计值1.61，迭代过程见图3。</p><p>图3. 最优beta迭代过程曲线</p><p>进而可以得到 σ C E V 的估计值</p><p>σ C E V = σ B S F 0 1 − β = σ B S S 0 1 − β e r T ( 1 − β ) (39)</p></sec><sec id="s8_4"><title>4.4. Heston模型参数估计——基于模拟退火算法</title><p>Heston模型同样需要给定[ k , t , s 0 , r ]，而[ v 0 , κ , θ , δ , ρ ]是需要估计的参数，而由于同时需要估计五个参数，估计CEV模型 β 值的所用的迭代法不再适用，因此可借助Python进行模拟退火算法，这是一种在一个大空间内寻找最优解的一般方法。模拟所使用的历史期权数据来自2020年3月19日以前上市的81只期权，其中算法具体参数设置见表1。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Important parameter settings of simulated annealing algorith</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >参数值</th><th align="center" valign="middle" >功能</th></tr></thead><tr><td align="center" valign="middle" >T = 100</td><td align="center" valign="middle" >初始温度为100，温度越高接受新解概率越大</td></tr><tr><td align="center" valign="middle" >Speed = 0.7</td><td align="center" valign="middle" >退火速度为0.7，按此速度退火接受新解概率将越来越小</td></tr><tr><td align="center" valign="middle" >T-min = e^(-6)</td><td align="center" valign="middle" >最低温度为e^(−6)，低于此温度时终止循环</td></tr><tr><td align="center" valign="middle" >Delta = 0.7</td><td align="center" valign="middle" >最初若函数值变动为Delta，则认为函数值变动很大</td></tr><tr><td align="center" valign="middle" >P = 0.9</td><td align="center" valign="middle" >当认为函数值变动很大时将有0.9概率接受新解</td></tr><tr><td align="center" valign="middle" >Times-max = 500</td><td align="center" valign="middle" >每个温度下循环超过500终止循环</td></tr><tr><td align="center" valign="middle" >Delta-min = 0.001</td><td align="center" valign="middle" >当新旧解之差小于0.001计算次数</td></tr><tr><td align="center" valign="middle" >Delta-min-times = 100</td><td align="center" valign="middle" >当新旧解之差连续小于0.001次数达到100终止循环</td></tr><tr><td align="center" valign="middle" >Times-termination = 400</td><td align="center" valign="middle" >当连续未接受新解超过400次，终止循环</td></tr></tbody></table></table-wrap><p>表1. 模拟退火算法重要参数设置</p><p>在经过10,862轮模拟后，满足了终止条件接受新解后的函数值变化连续小于0.001达到次数101次，此时温度为0.035188，输出参数最优解，见表2。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Estimated values of parameters of the Heston mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >v0</th><th align="center" valign="middle" >κ</th><th align="center" valign="middle" >θ</th><th align="center" valign="middle" >δ</th><th align="center" valign="middle" >ρ</th><th align="center" valign="middle" >MAPE</th></tr></thead><tr><td align="center" valign="middle" >0.037755</td><td align="center" valign="middle" >0.995793</td><td align="center" valign="middle" >0.004193</td><td align="center" valign="middle" >0.025404</td><td align="center" valign="middle" >0.290059</td><td align="center" valign="middle" >0.146679</td></tr></tbody></table></table-wrap><p>表2. Heston模型各参数估计值</p></sec></sec><sec id="s9"><title>5. 误差分析</title><p>在估计了三个期权定价模型的参数后，即可利用本文理论基础部分列出的理论部分列出的对应的欧式看涨期权定价解析式进行定价。在该部分本文选用2020年3月20日~2021年3月20日的40只看涨期权数据，其范围涵盖了不同的执行价、上市日期和到期期限，具有较好的随机性。</p><p>由于不同期权价值相差较大，且同时存在正负误差，为了更科学的比较模型拟合优度，综合考虑本文选取对称平均绝对百分比误差(sMAPE)作为模型拟合效果的检验指标：</p><p>s M A P E = 1 n ∑ t = 1 n | F t − A t | F t + A t 2 (40)</p><p>对于单个期权计算时，采用对称绝对百分比误差(sAPE)：</p><p>s A P E = | F t − A t | ( F t + A t ) / 2 (41)</p><p>其中 F t 为模型的预测值， A t 为真值，基于此可以得出各模型拟合情况，见表3 (c为期权市场价值(单位：元)，F为模型预测价值，sAPE为模型预测误差)。</p><table-wrap-group id="3"><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> BS, CEV, Heston model prediction results and error</title></caption><table-wrap id="3_1"><table><tbody><thead><tr><th align="center" valign="middle" >c</th><th align="center" valign="middle" >F B S</th><th align="center" valign="middle" >s A P E B S</th><th align="center" valign="middle" >F C E V</th><th align="center" valign="middle" >s A P E C E V</th><th align="center" valign="middle" >F H e s t o n</th><th align="center" valign="middle" >s A P E H e s t o n</th></tr></thead><tr><td align="center" valign="middle" >476.4</td><td align="center" valign="middle" >580.1</td><td align="center" valign="middle" >0.1963</td><td align="center" valign="middle" >576.0</td><td align="center" valign="middle" >0.1893</td><td align="center" valign="middle" >573.4</td><td align="center" valign="middle" >0.1848</td></tr><tr><td align="center" valign="middle" >62.8</td><td align="center" valign="middle" >89.6</td><td align="center" valign="middle" >0.3512</td><td align="center" valign="middle" >90.9</td><td align="center" valign="middle" >0.3652</td><td align="center" valign="middle" >85.1</td><td align="center" valign="middle" >0.3017</td></tr><tr><td align="center" valign="middle" >346.4</td><td align="center" valign="middle" >455.5</td><td align="center" valign="middle" >0.2722</td><td align="center" valign="middle" >453.1</td><td align="center" valign="middle" >0.2669</td><td align="center" valign="middle" >452.6</td><td align="center" valign="middle" >0.2658</td></tr><tr><td align="center" valign="middle" >265.0</td><td align="center" valign="middle" >408.9</td><td align="center" valign="middle" >0.4270</td><td align="center" valign="middle" >402.8</td><td align="center" valign="middle" >0.4126</td><td align="center" valign="middle" >360.7</td><td align="center" valign="middle" >0.3060</td></tr><tr><td align="center" valign="middle" >223.8</td><td align="center" valign="middle" >285.7</td><td align="center" valign="middle" >0.2430</td><td align="center" valign="middle" >286.4</td><td align="center" valign="middle" >0.2453</td><td align="center" valign="middle" >228.7</td><td align="center" valign="middle" >0.0215</td></tr><tr><td align="center" valign="middle" >500.6</td><td align="center" valign="middle" >510.9</td><td align="center" valign="middle" >0.0204</td><td align="center" valign="middle" >508.0</td><td align="center" valign="middle" >0.0146</td><td align="center" valign="middle" >507.6</td><td align="center" valign="middle" >0.0138</td></tr><tr><td align="center" valign="middle" >289.2</td><td align="center" valign="middle" >350.4</td><td align="center" valign="middle" >0.1915</td><td align="center" valign="middle" >347.6</td><td align="center" valign="middle" >0.1835</td><td align="center" valign="middle" >345.3</td><td align="center" valign="middle" >0.1769</td></tr><tr><td align="center" valign="middle" >103.4</td><td align="center" valign="middle" >97.5</td><td align="center" valign="middle" >0.0592</td><td align="center" valign="middle" >102.9</td><td align="center" valign="middle" >0.0044</td><td align="center" valign="middle" >82.1</td><td align="center" valign="middle" >0.2298</td></tr><tr><td align="center" valign="middle" >165.4</td><td align="center" valign="middle" >164.0</td><td align="center" valign="middle" >0.0083</td><td align="center" valign="middle" >170.2</td><td align="center" valign="middle" >0.0288</td><td align="center" valign="middle" >129.7</td><td align="center" valign="middle" >0.2423</td></tr><tr><td align="center" valign="middle" >190.2</td><td align="center" valign="middle" >145.3</td><td align="center" valign="middle" >0.2680</td><td align="center" valign="middle" >152.9</td><td align="center" valign="middle" >0.2175</td><td align="center" valign="middle" >112.9</td><td align="center" valign="middle" >0.5100</td></tr><tr><td align="center" valign="middle" >512.8</td><td align="center" valign="middle" >663.1</td><td align="center" valign="middle" >0.2556</td><td align="center" valign="middle" >661.1</td><td align="center" valign="middle" >0.2527</td><td align="center" valign="middle" >661.3</td><td align="center" valign="middle" >0.2530</td></tr><tr><td align="center" valign="middle" >475.4</td><td align="center" valign="middle" >616.7</td><td align="center" valign="middle" >0.2588</td><td align="center" valign="middle" >614.5</td><td align="center" valign="middle" >0.2552</td><td align="center" valign="middle" >614.6</td><td align="center" valign="middle" >0.2554</td></tr><tr><td align="center" valign="middle" >439.6</td><td align="center" valign="middle" >571.3</td><td align="center" valign="middle" >0.2606</td><td align="center" valign="middle" >568.8</td><td align="center" valign="middle" >0.2563</td><td align="center" valign="middle" >568.8</td><td align="center" valign="middle" >0.2562</td></tr><tr><td align="center" valign="middle" >405.4</td><td align="center" valign="middle" >527.1</td><td align="center" valign="middle" >0.2609</td><td align="center" valign="middle" >524.3</td><td align="center" valign="middle" >0.2558</td><td align="center" valign="middle" >524.0</td><td align="center" valign="middle" >0.2553</td></tr><tr><td align="center" valign="middle" >372.6</td><td align="center" valign="middle" >484.0</td><td align="center" valign="middle" >0.2601</td><td align="center" valign="middle" >481.1</td><td align="center" valign="middle" >0.2542</td><td align="center" valign="middle" >480.5</td><td align="center" valign="middle" >0.2530</td></tr><tr><td align="center" valign="middle" >341.6</td><td align="center" valign="middle" >442.4</td><td align="center" valign="middle" >0.2572</td><td align="center" valign="middle" >439.4</td><td align="center" valign="middle" >0.2505</td><td align="center" valign="middle" >438.5</td><td align="center" valign="middle" >0.2484</td></tr><tr><td align="center" valign="middle" >312.4</td><td align="center" valign="middle" >402.5</td><td align="center" valign="middle" >0.2520</td><td align="center" valign="middle" >399.5</td><td align="center" valign="middle" >0.2447</td><td align="center" valign="middle" >398.1</td><td align="center" valign="middle" >0.2411</td></tr><tr><td align="center" valign="middle" >284.8</td><td align="center" valign="middle" >364.3</td><td align="center" valign="middle" >0.2449</td><td align="center" valign="middle" >361.4</td><td align="center" valign="middle" >0.2371</td><td align="center" valign="middle" >359.4</td><td align="center" valign="middle" >0.2317</td></tr><tr><td align="center" valign="middle" >258.8</td><td align="center" valign="middle" >328.0</td><td align="center" valign="middle" >0.2358</td><td align="center" valign="middle" >325.3</td><td align="center" valign="middle" >0.2278</td><td align="center" valign="middle" >322.8</td><td align="center" valign="middle" >0.2200</td></tr><tr><td align="center" valign="middle" >234.6</td><td align="center" valign="middle" >293.7</td><td align="center" valign="middle" >0.2238</td><td align="center" valign="middle" >291.4</td><td align="center" valign="middle" >0.2160</td><td align="center" valign="middle" >288.2</td><td align="center" valign="middle" >0.2051</td></tr><tr><td align="center" valign="middle" >212.0</td><td align="center" valign="middle" >261.6</td><td align="center" valign="middle" >0.2095</td><td align="center" valign="middle" >259.7</td><td align="center" valign="middle" >0.2022</td><td align="center" valign="middle" >255.9</td><td align="center" valign="middle" >0.1875</td></tr><tr><td align="center" valign="middle" >191.0</td><td align="center" valign="middle" >231.7</td><td align="center" valign="middle" >0.1926</td><td align="center" valign="middle" >230.3</td><td align="center" valign="middle" >0.1864</td><td align="center" valign="middle" >225.8</td><td align="center" valign="middle" >0.1670</td></tr><tr><td align="center" valign="middle" >171.6</td><td align="center" valign="middle" >204.1</td><td align="center" valign="middle" >0.1728</td><td align="center" valign="middle" >203.1</td><td align="center" valign="middle" >0.1683</td><td align="center" valign="middle" >198.1</td><td align="center" valign="middle" >0.1432</td></tr><tr><td align="center" valign="middle" >153.6</td><td align="center" valign="middle" >178.7</td><td align="center" valign="middle" >0.1509</td><td align="center" valign="middle" >178.3</td><td align="center" valign="middle" >0.1488</td><td align="center" valign="middle" >172.7</td><td align="center" valign="middle" >0.1170</td></tr><tr><td align="center" valign="middle" >137.2</td><td align="center" valign="middle" >155.5</td><td align="center" valign="middle" >0.1252</td><td align="center" valign="middle" >155.7</td><td align="center" valign="middle" >0.1264</td><td align="center" valign="middle" >149.6</td><td align="center" valign="middle" >0.0867</td></tr><tr><td align="center" valign="middle" >122.2</td><td align="center" valign="middle" >134.6</td><td align="center" valign="middle" >0.0964</td><td align="center" valign="middle" >135.3</td><td align="center" valign="middle" >0.1019</td><td align="center" valign="middle" >128.9</td><td align="center" valign="middle" >0.0530</td></tr><tr><td align="center" valign="middle" >108.6</td><td align="center" valign="middle" >115.8</td><td align="center" valign="middle" >0.0638</td><td align="center" valign="middle" >117.0</td><td align="center" valign="middle" >0.0747</td><td align="center" valign="middle" >110.3</td><td align="center" valign="middle" >0.0152</td></tr><tr><td align="center" valign="middle" >96.2</td><td align="center" valign="middle" >99.0</td><td align="center" valign="middle" >0.0285</td><td align="center" valign="middle" >100.7</td><td align="center" valign="middle" >0.0459</td><td align="center" valign="middle" >93.8</td><td align="center" valign="middle" >0.0255</td></tr><tr><td align="center" valign="middle" >85.0</td><td align="center" valign="middle" >84.1</td><td align="center" valign="middle" >0.0102</td><td align="center" valign="middle" >86.3</td><td align="center" valign="middle" >0.0149</td><td align="center" valign="middle" >79.3</td><td align="center" valign="middle" >0.0699</td></tr><tr><td align="center" valign="middle" >74.8</td><td align="center" valign="middle" >71.1</td><td align="center" valign="middle" >0.0508</td><td align="center" valign="middle" >73.6</td><td align="center" valign="middle" >0.0166</td><td align="center" valign="middle" >66.6</td><td align="center" valign="middle" >0.1164</td></tr><tr><td align="center" valign="middle" >275.0</td><td align="center" valign="middle" >140.1</td><td align="center" valign="middle" >0.6503</td><td align="center" valign="middle" >143.1</td><td align="center" valign="middle" >0.6311</td><td align="center" valign="middle" >124.0</td><td align="center" valign="middle" >0.7572</td></tr><tr><td align="center" valign="middle" >367.6</td><td align="center" valign="middle" >207.6</td><td align="center" valign="middle" >0.5565</td><td align="center" valign="middle" >210.4</td><td align="center" valign="middle" >0.5441</td><td align="center" valign="middle" >173.9</td><td align="center" valign="middle" >0.7155</td></tr><tr><td align="center" valign="middle" >471.8</td><td align="center" valign="middle" >267.9</td><td align="center" valign="middle" >0.5512</td><td align="center" valign="middle" >269.9</td><td align="center" valign="middle" >0.5443</td><td align="center" valign="middle" >214.5</td><td align="center" valign="middle" >0.7500</td></tr></tbody></table></table-wrap><table-wrap id="3_2"><table><tbody><thead><tr><th align="center" valign="middle" >233.8</th><th align="center" valign="middle" >87.4</th><th align="center" valign="middle" >0.9114</th><th align="center" valign="middle" >92.4</th><th align="center" valign="middle" >0.8671</th><th align="center" valign="middle" >74.2</th><th align="center" valign="middle" >1.0367</th></tr></thead><tr><td align="center" valign="middle" >337.0</td><td align="center" valign="middle" >146.3</td><td align="center" valign="middle" >0.7894</td><td align="center" valign="middle" >152.1</td><td align="center" valign="middle" >0.7559</td><td align="center" valign="middle" >116.2</td><td align="center" valign="middle" >0.9746</td></tr><tr><td align="center" valign="middle" >457.4</td><td align="center" valign="middle" >201.4</td><td align="center" valign="middle" >0.7771</td><td align="center" valign="middle" >207.3</td><td align="center" valign="middle" >0.7525</td><td align="center" valign="middle" >151.7</td><td align="center" valign="middle" >1.0038</td></tr><tr><td align="center" valign="middle" >493.0</td><td align="center" valign="middle" >557.0</td><td align="center" valign="middle" >0.1220</td><td align="center" valign="middle" >518.9</td><td align="center" valign="middle" >0.0513</td><td align="center" valign="middle" >519.5</td><td align="center" valign="middle" >0.0523</td></tr><tr><td align="center" valign="middle" >282.4</td><td align="center" valign="middle" >240.2</td><td align="center" valign="middle" >0.1617</td><td align="center" valign="middle" >260.3</td><td align="center" valign="middle" >0.0813</td><td align="center" valign="middle" >258.0</td><td align="center" valign="middle" >0.0905</td></tr><tr><td align="center" valign="middle" >244.2</td><td align="center" valign="middle" >228.5</td><td align="center" valign="middle" >0.0666</td><td align="center" valign="middle" >227.8</td><td align="center" valign="middle" >0.0694</td><td align="center" valign="middle" >224.8</td><td align="center" valign="middle" >0.0827</td></tr><tr><td align="center" valign="middle" >207.4</td><td align="center" valign="middle" >216.7</td><td align="center" valign="middle" >0.0441</td><td align="center" valign="middle" >198.0</td><td align="center" valign="middle" >0.0466</td><td align="center" valign="middle" >194.3</td><td align="center" valign="middle" >0.0652</td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >s M A P E B S</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >s M A P E C E V</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >s M A P E H e s t o n</td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >0.2570</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >0.2452</td><td align="center" valign="middle" ></td><td align="center" valign="middle" >0.2795</td></tr></tbody></table></table-wrap></table-wrap-group><p>表3. BS、CEV、Heston模型预测结果及误差</p><p>从上述实证结果来看，三个模型对期权的估值均呈现高估的态势，且BS模型和CEV模型单个期权估计结果很接近。此外综合来看，三个模型的sMAPE排序为： s M A P E C E V ( 0.2452 ) &lt; s M A P E B S ( 0.2570 ) &lt; s M A P E H e s t o n ( 0.2795 ) 。接下来探究模型对虚值期权和实值期权分别拟合效果，见表4。</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> The fitting effect of the model on out-of-the-money/real option</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >s M A P E B S</th><th align="center" valign="middle" >s M A P E C E V</th><th align="center" valign="middle" >s M A P E H e s t o n</th></tr></thead><tr><td align="center" valign="middle" >虚值期权</td><td align="center" valign="middle" >0.3162</td><td align="center" valign="middle" >0.3047</td><td align="center" valign="middle" >0.3904</td></tr><tr><td align="center" valign="middle" >实值期权</td><td align="center" valign="middle" >0.2085</td><td align="center" valign="middle" >0.1965</td><td align="center" valign="middle" >0.1889</td></tr></tbody></table></table-wrap><p>表4. 模型对虚值期权和实值期权拟合效果</p><p>结果显示三个模型均对实值期权拟合效果更好，其中CEV模型对虚值期权拟合效果最好，Heston模型对实值期权拟合效果最好。对于此外为了进一步研究各个模型拟合效果的规律性，分别用三个模型的误差对c(真实价值：百元)、K(执行价：千元)、T(到期时间：年)进行回归，得到表5所示结果。</p><table-wrap id="table5" ><label><xref ref-type="table" rid="table5">Table 5</xref></label><caption><title> Analysis of the influence of different factors on the goodness of model fi</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >BS模型</th><th align="center" valign="middle" >CEV模型</th><th align="center" valign="middle" >Heston模型</th></tr></thead><tr><td align="center" valign="middle" >c-P值</td><td align="center" valign="middle" >0.0343 (**)</td><td align="center" valign="middle" >0.0408 (**)</td><td align="center" valign="middle" >0.0715(*)</td></tr><tr><td align="center" valign="middle" >c-系数</td><td align="center" valign="middle" >0.000549</td><td align="center" valign="middle" >0.000520</td><td align="center" valign="middle" >0.000593</td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >K-P值</td><td align="center" valign="middle" >0.2814</td><td align="center" valign="middle" >0.3297</td><td align="center" valign="middle" >0.0204(**)</td></tr><tr><td align="center" valign="middle" >K-系数</td><td align="center" valign="middle" >0.0000621</td><td align="center" valign="middle" >0.0000551</td><td align="center" valign="middle" >0.000164</td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" >T-P值</td><td align="center" valign="middle" >0.0004(***)</td><td align="center" valign="middle" >0.0004(***)</td><td align="center" valign="middle" >0.0001(***)</td></tr><tr><td align="center" valign="middle" >T-系数</td><td align="center" valign="middle" >0.471141</td><td align="center" valign="middle" >0.463709</td><td align="center" valign="middle" >0.632153</td></tr></tbody></table></table-wrap><p>表5. 不同因素对模型拟合优度影响分析</p><p>其中***、**和*分别表示在1%、5%和10%的水平上显著。先看真实价值对三个模型估计结果的影响，在5%的显著性水平下BS模型和CEV模型的预测误差受期权真实市值影响显著，而Heston模型在10%的显著性水平上显著，且三者系数均为正值，说明三个模型均对于价值较小的期权预测精度更高。</p><p>而执行价K对Heston模型在5%的显著性水平上显著，系数为正，说明其对执行价较小的期权预测精度较高。</p><p>到期时间T对于三个模型影响均在1%的显著性水平上显著，且系数为正，说明三个模型均对到期期限低的期权价值预测效果更好。</p></sec><sec id="s10"><title>6. 结论</title><p>本文基于BS、CEV、Heston模型，使用解析式的方法，对沪深300股指期权进行了实证研究。通过以对称平均绝对百分比误差(sMAPE)作为误差指标的分析实证发现，三个模型对期权的估值均呈现高估的态势，且BS模型和CEV模型单个期权估计结果很接近，其中CEV模型拟合效果最好，其次为BS模型，Heston模型最差。从虚实期权角度来看，三个模型均对实值期权拟合效果更好，对虚值期权而言CEV模型拟合效果最好，对实值期权而言Heston模型拟合效果最好。进一步探究发现，BS模型和CEV对短到期期限、低价值的期权拟合效果相对较好，Heston模型对低执行价、短到期期限、低价值的期权拟合效果较好。</p><p>从实证结果可以发现， β 为1.61的CEV模型拟合效果最好，而时变波动率的Heston模型拟合效果最次，说明沪深300股指期权存在一定的递增型波动率微笑现象，而时变波动率的特征较弱。</p><p>同时不仅模型整体拟合优度存在差异，模型的拟合优度还会随期权的虚实值状态和到期期限等等因素变动。对于沪深300而言，CEV模型对其虚值期权拟合效果最好，而Heston模型对实值期权的拟合效果十分出色，这也提醒市场对于期权定价而言，选用模型时要考虑多方位因素。</p><p>总的来说，中国的期权市场还处于前期发展阶段，目前市场BS模型的应用仍是主流。但是市场瞬息万变，宏观政策、市场噪音，或是像疫情这类突发重大事件等等都有可能使得股价呈现出大幅偏离几何布朗运动假设，沪深300股指期权作为一只几乎与疫情同时诞生的期权更是如此。因此研究期权定价中其时变性、跳跃性等非正态特征尤为重要。本文仅以三类模型对沪深300股指期权定价进行实证对比研究，希望可对我国期权市场发展贡献绵薄之力。</p></sec><sec id="s11"><title>文章引用</title><p>张 翔,李 治. 沪深300股指期权定价实证研究——基于BS、CEV、Heston模型的对比分析An Empirical Study on the Pricing of CSI 300 Index Options—Based on BS, CEV, and Heston Models[J]. 金融, 2021, 11(04): 319-332. https://doi.org/10.12677/FIN.2021.114036</p></sec><sec id="s12"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.43969-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Bollerslev, T. (1986) Generalized Autoregressive Conditional Heteroscedasticity. Journal of Econometrics, 31, 307-327.  
&lt;br&gt;https://doi.org/10.1016/0304-4076(86)90063-1</mixed-citation></ref><ref id="hanspub.43969-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Nelson, D.B. (1991) Conditional Heteroskedasticity in Asset Returns: A New Approach. Econometrica, 59, 347-370.  
&lt;br&gt;https://doi.org/10.2307/2938260</mixed-citation></ref><ref id="hanspub.43969-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Glosten, L.R., Jagannathan, R. and Runkle, D.E. (1993) On the Relation be-tween the Expected Value and the Volatility of the Nominal Excess Return on Stocks. Journal of Finance, 48, 1779-1801.  
&lt;br&gt;https://doi.org/10.1111/j.1540-6261.1993.tb05128.x</mixed-citation></ref><ref id="hanspub.43969-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Heston, S.L.A. (1993) Closed-Form Solution for Options with Stochastic Volatility with Applications to Bond and Currency Options. Review of Financial Studies, 6, 327-343. &lt;br&gt;https://doi.org/10.1093/rfs/6.2.327</mixed-citation></ref><ref id="hanspub.43969-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">蒋祥林, 王春峰. 基于贝叶斯原理的随机波动率模型分析及其应用[J]. 系统工程, 2005, 23(10): 22-28.</mixed-citation></ref><ref id="hanspub.43969-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Latané, H. (1976) Standard Deviations of Stock Price Ratios Implied in Option Prices. The Journal of Finance, 31, 369- 381. &lt;br&gt;https://doi.org/10.1111/j.1540-6261.1976.tb01892.x</mixed-citation></ref><ref id="hanspub.43969-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">郑振龙, 黄薏舟. 波动率预测: GARCH模型与隐含波动率[J]. 数量经济技术经济研究, 2010, 27(1): 140-150.</mixed-citation></ref><ref id="hanspub.43969-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">倪中新, 郭婧, 王琳玉. 上证50ETF期权隐含波动率微笑形态的风险信息容量研究[J]. 财经研究, 2020, 46(4): 155-169.</mixed-citation></ref><ref id="hanspub.43969-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Black, F. and Scholes, M. (1973) The Pricing of Options and Corporate Liabilities. Journal of Political Economy, 81, 637-654. &lt;br&gt;https://doi.org/10.1086/260062</mixed-citation></ref><ref id="hanspub.43969-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Cox, J.C. and Ross, S.A. (1976) The Valuation of Options for Alternative Stochastic Processes. North-Holland, 3, 145- 166. &lt;br&gt;https://doi.org/10.1016/0304-405X(76)90023-4</mixed-citation></ref><ref id="hanspub.43969-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Merton, R.C. (1976) Option Pricing When Underlying Stock Returns Are Discontinuous. North-Holland, 3, 125-144.  
&lt;br&gt;https://doi.org/10.1016/0304-405X(76)90022-2</mixed-citation></ref><ref id="hanspub.43969-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Hagan, P., Kumar, D., Lesniewski, A. and Woodward, D. (2002) Managing Smile Risk. Wilmott, 9, 84-108.</mixed-citation></ref><ref id="hanspub.43969-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Dupire, B. (1994) Pricing with Smile. Risk, 2, 18-20.</mixed-citation></ref><ref id="hanspub.43969-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Derman, E. and Kani, I. (1994) Riding on a Smile. Risk, 2, 32-39.</mixed-citation></ref><ref id="hanspub.43969-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Rubinstein, M. (1994) Implied Bi-nomial Trees. Journal of Finance, 7, 771-818.  
&lt;br&gt;https://doi.org/10.1111/j.1540-6261.1994.tb00079.x</mixed-citation></ref><ref id="hanspub.43969-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">张传涛. 基于SVI模型的沪深300股指期权定价实证研究[D]: [硕士学位论文]. 青岛: 山东科技大学, 2020.</mixed-citation></ref><ref id="hanspub.43969-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Ito, K. (1951) On Stochastic Differential Equations. Memoirs of the American Mathematical Society, No. 4, 1-51.  
&lt;br&gt;https://doi.org/10.1090/memo/0004</mixed-citation></ref></ref-list></back></article>