<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">PM</journal-id><journal-title-group><journal-title>Pure  Mathematics</journal-title></journal-title-group><issn pub-type="epub">2160-7583</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/PM.2018.82018</article-id><article-id pub-id-type="publisher-id">PM-24034</article-id><article-categories><subj-group subj-group-type="heading"><subject>PM20180200000_96120061.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  分段平稳时间序列中的多变点检测
  Multiple Change-Points Detection of Piecewise Stationary Time Series
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>吴</surname><given-names>楠</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>胡</surname><given-names>尧</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>丹</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>贵州大学数学与统计学院，贵州 贵阳；贵州省公共大数据重点实验室，贵州 贵阳</addr-line></aff><aff id="aff1"><addr-line>贵州大学数学与统计学院，贵州 贵阳</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>331914178@qq.com(吴楠)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>12</day><month>03</month><year>2018</year></pub-date><volume>08</volume><issue>02</issue><fpage>136</fpage><lpage>148</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   变点问题在工业、金融、气象等领域有着广泛的应用。针对分段平稳时间序列的多变点检测，提出一种通过构建似然比扫描(LRS)统计量，结合最小描述长度(MDL)准则对变点数量、位置进行估计的方法，将计算上不可行的全局多变点估计问题通过有效分段降为各局部窗口中的多个单变点检测问题。同时对每个估计变点构建了置信区间，为描述变点提供更多信息。最后通过大量数值模拟和交通实例分析证明方法的有效性。 The change-point problem has a wide range of applications in the industrial, financial, meteorology and other fields. A method for estimating the numbers, locations of change-point by building the Likelihood ratio scan (LRS) statistics, combined with the Minimum description length (MDL) principle has been proposed. It reduces the computationally infeasible global mul-tiple-change-point estimation problem to a number of single-change-point detection problems in various local windows by effective segmentation. In order to provide more information for describing change points, we have constructed confidence intervals for each of the change points. Finally, extensive simulation studies and example analysis of traffic show the LRS usability practice.
    
  
 
</p></abstract><kwd-group><kwd>多变点，似然比，置信区间，最小描述长度准则, Multiple Change-Points</kwd><kwd> Likelihood Ratio</kwd><kwd> Confidence Intervals</kwd><kwd> Minimum Description Length 
Criterion</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>分段平稳时间序列中的多变点检测<sup> </sup></title><p>吴楠<sup>1</sup>，胡尧<sup>1,2*</sup>，王丹<sup>1</sup></p><p><sup>1</sup>贵州大学数学与统计学院，贵州 贵阳</p><p><sup>2</sup>贵州省公共大数据重点实验室，贵州 贵阳</p><disp-formula id="hanspub.24034-formula25"><graphic xlink:href="//html.hanspub.org/file/4-1250614x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2018年2月23日；录用日期：2018年3月9日；发布日期：2018年3月14日</p><disp-formula id="hanspub.24034-formula26"><graphic xlink:href="//html.hanspub.org/file/4-1250614x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>变点问题在工业、金融、气象等领域有着广泛的应用。针对分段平稳时间序列的多变点检测，提出一种通过构建似然比扫描(LRS)统计量，结合最小描述长度(MDL)准则对变点数量、位置进行估计的方法，将计算上不可行的全局多变点估计问题通过有效分段降为各局部窗口中的多个单变点检测问题。同时对每个估计变点构建了置信区间，为描述变点提供更多信息。最后通过大量数值模拟和交通实例分析证明方法的有效性。</p><p>关键词 :多变点，似然比，置信区间，最小描述长度准则</p><disp-formula id="hanspub.24034-formula27"><graphic xlink:href="//html.hanspub.org/file/4-1250614x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/4-1250614x8_hanspub.png" /> <img src="//html.hanspub.org/file/4-1250614x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>近年来，变点检测一直被认为是计量经济学，生物学和统计学的一个重要问题。大量文献探索了时间序列模型中变点的检测。变点估计的第一篇文章是由Hinkley (1970)提出的，他研究i.i.d随机变量序列中变点的极大似然估计，并证明了估计变点依分布收敛于双侧随机游走的最大值，在正态假设下，表明其极限分布可以通过数值方法获得 [<xref ref-type="bibr" rid="hanspub.24034-ref1">1</xref>] 。Hinkley (1970)使用类似的方法研究了服从二项分布的随机变量序列，并给出了极限分布的可计算形式 [<xref ref-type="bibr" rid="hanspub.24034-ref2">2</xref>] 。但是，对于非正态或非二项分布的情况，其结果不能作为变点的统计推断。直到Yao (1987)表明当参数变化幅度d很小时，Hinkley (1970)的极限分布可以作为变点估计分布的一个良好近似 [<xref ref-type="bibr" rid="hanspub.24034-ref3">3</xref>] 。在时间序列领域，Picard (1985)首先研究了自回归(AR)模型中变点的极大似然估计。她假设参数变化幅度是 d n ， d n 取决于样本量n，当 n → ∞ 时， d n → 0 ，结果得到与Yao (1987)相同的极限分布，这为本文后期对变点构建置信区间提供理论支持 [<xref ref-type="bibr" rid="hanspub.24034-ref4">4</xref>] 。Davis (2006)提出利用最小描述长度 (MDL: Minimum description length)准则来检测非线性时间序列中的多变点 [<xref ref-type="bibr" rid="hanspub.24034-ref5">5</xref>] 。Fryzlewicz (2014)提出wild二元分割(WBS: Wild Binary Segmentation)方法，省去复杂的优化过程，将非平稳时间序列随机分割为分段平稳序列，运用乘积性模型将时间序列自协方差结构中的变点检测问题转化为检测小波周期图中的变点问题 [<xref ref-type="bibr" rid="hanspub.24034-ref6">6</xref>] 。Yau (2016)研究了非平稳时间序列中的多变点问题，通过似然比扫描方法将原始序列分解为一段一段的自回归过程，分别对各段AR过程进行建模，AR模型参数发生改变的点即为变点。随着这些方法的产生，非平稳时间序列中的多变点研究问题得到了快速发展 [<xref ref-type="bibr" rid="hanspub.24034-ref7">7</xref>] 。</p><p>实际上，仅仅检测出变点位置并不能提供完整的信息，相比之下，置信区间可以提供更多信息来对变点进行描述。为了获得置信区间，则需要得到变点估计的渐近分布。Hinkley (1970)、Picard (1985)和Yao (1987)分别研究了估计变点的收敛情况及极限分布，指出变点估计依分布收敛于双侧随机游走的最大值，其极限分布参见Yao (1987)。</p><p>本文首先介绍了变点模型及其渐近理论。其次，结合似然比方法构造似然比扫描(LRS: Likelihood ratio scan)统计量进行变点检测，并给出相应的渐近性质及似然比扫描方法的详细执行步骤：1) 使用似然比扫描统计量获得初步变点估计(可能存在过估计问题，将一些不是异常点识别为变点)；2) 采用MDL准则进行模型选择过程，进而得到一组一致变点估计；3) 为每个估计的变化点构建置信区间。最后，利用大量数值模拟和交通实例验证LRS方法的有效性、优良性和实用性。</p></sec><sec id="s4"><title>2. 模型介绍</title><sec id="s4_1"><title>2.1. 基本假设</title><p>假设时间序列 { X t : t = 1 , 2 , ⋯ } 是 F t 可测的，并且严格平稳的，遍历的，可表示为</p><p>X t = g ( θ , X t , ϵ t ) (1)</p><p>其中 F t 是由 { ϵ t , ϵ t − 1 , ⋯ } 生成的 σ 域， X t = ( X t , X t − 1 , ⋯ ) ， θ 是 p &#215; 1 维的未知参数向量， { ϵ t } 是独立同分布的。序列 { X t } 的结构由可测量的函数g和参数 θ 刻画，假设参数空间 Θ 是 ℝ p 的有界紧集，且g是关于 θ 连续的。当真实参数 时，用 Μ ( θ 0 ) 表示模型(1)，同理 θ = θ 1 时，用 Μ ( θ 1 ) 表示模型(1)。</p><p>首先考虑分段平稳过程中的单变点问题。设 { X 1 , ⋯ , X n } 是由两个独立过程组成的随机样本，记 τ 1 0 ∈ { 1 , 2 , ⋯ , n − 1 } 为真实变点，满足 δ n &lt; τ 1 0 &lt; ( 1 − δ ) n ,   δ &gt; 0 ，则单变点问题模型为</p><p>{ X 1 , ⋯ , X τ 1 0 } ∈ Μ ( θ 1 0 ) , { X τ 1 0 + 1 , ⋯ , X n } ∈ Μ ( θ 2 0 ) (2)</p><p>其中 θ 1 0 , θ 2 0 ∈ Θ 是两段序列的未知参数，且 θ 1 0 ≠ θ 2 0 。</p><p>记条件似然函数 l t ( θ ) ≡ log f θ ( X t | X t − 1 ) ，其中 f θ 是 X t 给定过去观测值的条件密度函数。则单变点模型(2)的似然函数为</p><p>L n ( τ , θ 1 , θ 2 ) = L 1 n ( τ , θ 1 ) + L 2 n ( τ , θ 2 )</p><p>式中 L 1 n ( τ , θ 1 ) = ∑ t = 1 τ l t ( θ 1 ) ， L 2 n ( τ , θ 2 ) = ∑ t = τ + 1 n l t ( θ 2 ) 分别是两段序列的条件对数似然函数。对于给定的 τ ， θ ^ 1 n ( τ ) = a r g m a x θ 1 L 1 n ( τ , θ 1 ) ，同理 θ ^ 2 n ( τ ) = a r g m a x θ 2 L 2 n ( τ , θ 2 ) ，则变点 τ 可由(3)式进行估计</p><p>τ ^ = arg max 1 ≤ τ ≤ n L n [ τ , θ ^ 1 n ( τ ) , θ ^ 2 n ( τ ) ] (3)</p><p>变点前后两段的参数估计分别为 θ ^ 1 = θ ^ 1 n ( τ ) ， θ ^ 2 = θ ^ 2 n ( τ ) 。 τ ^ , θ ^ 1 , θ ^ 2 的一致性证明参见Ling (2016) [<xref ref-type="bibr" rid="hanspub.24034-ref8">8</xref>] 。</p></sec><sec id="s4_2"><title>2.2. 变点估计的渐近分布</title><p>对于单变点模型(2)，定义随机游走</p><p>W τ = { ∑ t = 1 τ ( l t ( θ 1 0 ) − l t ( θ 2 0 ) ) , τ &gt; 0, 0 , τ = 0, ∑ t = τ − 1 ( l t ( θ 2 0 ) − l t ( θ 1 0 ) ) ,     τ &lt; 0 . (4)</p><p>当 τ &gt; 0 时 X t ∈ M ( θ 2 0 ) ， τ &lt; 0 时 X t ∈ M ( θ 1 0 ) 。参照Ling (2016)的定理2.2(b)，对于固定的 θ 1 0 ， θ 2 0 有</p><p>τ ^ 1 − τ 1 0 → d arg max τ ∈ ℤ W τ (5)</p><p>注意到 W τ 的极限分布依赖于未知参数 θ 1 0 ， θ 2 0 ，并且不能得出分布函数的解析式，因此，实践中难以直接使用(5)构造置信区间。Ling (2016)定理3.1推导出了当参数变化很小时 W τ 的近似分布。具体而言，如果 θ 1 0 − θ 2 0 = O ( 1 / n ) ，那么对于任意给定的 M ( M &gt; 0 )</p><p>( d ′ ^ ∑ ^ d ′ ^ ) 2 ( d ′ ^ Ω ^ d ′ ^ ) − 1 ( arg max r ∈ [ − M , M ] W ⌊ m ^ r ⌋ ) → d arg max r ∈ [ − M , M ] { B ( r ) − 1 2 | r | } (6)</p><p>其中 d ^ = θ ^ 1 − θ ^ 2 ， ∑ ^ = 1 2 M ∑ t = − M M ∂ 2 l t ( θ ) ∂ θ ∂ θ ′ | θ ^ 2 ， Ω ^ = 1 2 M ∑ t = − M M ( D t ( θ ^ 2 ) − D &#175; ) ( D t ( θ ^ 2 ) − D &#175; ) ′ ， D t ( θ ) = ∂ l t ( θ ) ∂ θ ， D &#175; = ∑ − M M D t ( θ ^ 2 ) 2 M ， B ( r ) 是 ℝ 上的标准布朗运动， m ^ = ( d ′ ^ ∑ ^ d ′ ^ ) − 2 ( d ′ ^ Ω ^ d ′ ^ ) (变点数目)。</p><p>进一步，记 arg max τ W τ 的分布为 F d ( x ) ，则当 s &gt; M 时，有</p><p>| F d ( x ) − P ( arg max τ ∈ [ − s , s ] W ⌊ τ ⌋ ≤ x ) | ≤ ε</p><p>因此</p><p>| F d ( x ) − P ( m arg max r ∈ [ − M , M ] W ⌊ m ^ r ⌋ x ) | = | F d ( x ) − P ( arg max r ∈ [ − m M , m M ] W ⌊ r ⌋ ≤ x ) | ≤ ε</p><p>当M充分大时， r ∉ [ − M , M ] 的概率很小，所以当d较小时，</p><p>F d ( x ) ≈ P ( arg max r ∈ R [ B ( r ) − | r | / 2 ] ≤ x )</p><p>成立。Yao (1987)证明了 arg max r ∈ R [ B ( r ) − | r | / 2 ] 的分布 F ( x ) 具有密度函数：</p><p>f ( x ) = 3 2 e | x | Φ ( 3 2 | x | ) − 1 2 Φ ( | x | 2 ) (7)</p><p>其中 Φ ( x ) = ∫ x ∞ 1 2π exp ( − u 2 2 ) d u ， x ∈ R ≡ ( − ∞ , ∞ ) 。故当M充分大，d较小时，可以用 F ( x ) 来近似 ( d ′ ^ ∑ ^ d ′ ^ ) 2 ( d ′ ^ Ω ^ d ′ ^ ) − 1 ( τ ^ 1 − τ 1 0 ) 的分布。利用 F ( x ) 对变点估计进行置信区间构造，即 ( 1 − α ) % 置信度的置信区间为</p><p>C I = [ τ ^ 1 − [ Δ F α / 2 ] − 1 , τ ^ 1 + [ Δ F α / 2 ] + 1 ] (8)</p><p>其中 Δ = ( d ′ ^ Ω ^ d ′ ^ ) ( d ′ ^ ∑ ^ d ′ ^ ) − 2 ， F α / 2 ( x ) 是 arg max r ∈ ℝ [ B ( r ) − | r | / 2 ] 的 α 2 分位数。</p></sec></sec><sec id="s5"><title>3. 基于似然比扫描 (LRS)方法的多变点估计</title><p>结合AR过程的计算优势和强稳健性，考虑将原始序列通过合理分割变为分段平稳AR过程，即将原始序列的多变点估计变为局部单变点估计。</p><sec id="s5_1"><title>3.1. 基本假设</title><p>假设观测值 { X t } t = 1 , ⋯ , n 可以划分为 m + 1 个平稳过程。第j段序列观测值 X j = { X τ j − 1 + 1 , ⋯ , X τ j } ∈ M ( θ j ) ，其中 j = 1 , ⋯ , m ， τ j 是第j个变点，即在 τ j 处第j段AR过程 AR ( p j ) 发生突变，变为第 j + 1 段AR过程 AR ( p j + 1 ) 。令 τ 0 ≜ 0 ， τ m + 1 ≜ n 。记 J = ( τ 1 , ⋯ , τ m ) 为变点的集合。定义 λ j 为第j个变点的相对位置，使得 τ j = ⌊ λ j n ⌋ ， j = 0 , ⋯ , m + 1 ，且满足当 ϵ λ &gt; 0 时 min j = 0 , ⋯ , m ( λ j + 1 − λ j ) &gt; ϵ λ 。</p></sec><sec id="s5_2"><title>3.2. 基于似然比扫描统计量的多变点检测步骤</title><p>本节，主要介绍了LRS方法检测多变点的三个步骤，其变点估计及渐近性质将在下节讨论。</p><p>第一步：使用似然比扫描统计量获得所有变点集合</p><p>分别定义扫描窗口及其相应的观测值为</p><p>W t ( h ) = { t − h + 1 , ⋯ , t + h } ， X W t ( h ) = { X t − h + 1 , ⋯ , X t + h }</p><p>其中 t = h , ⋯ , n − h ，h称为窗口半径， h = h ( n ) 依赖于样本量n。定义扫描窗口 W t ( h ) 的似然比扫描统计量</p><p>S h ( t ) = 1 h L 1 h ( t , θ ^ 1 ) + 1 h L 2 h ( t , θ ^ 2 ) − 1 h L ⋅ h ( t , θ ^ )</p><p>L 1 h ( t , θ ^ 1 ) ， L 2 h ( t , θ ^ 2 ) ， L ⋅ h ( t , θ ^ ) 分别是相应观测序列 { X s } t − h + 1 , ⋯ , t ， { X s } t + 1 , ⋯ , t + h ， { X s } W t ( h ) 的条件似然函数。具体地说，样本 z = { z 1 , ⋯ , z n } 的条件似然函数为</p><p>L ( θ ) = ∑ t = 1 n l t ( θ ) ≡ ∑ t = 1 n log f θ ( z t | z t − 1 , z t − 2 , ⋯ )</p><p>其中 f θ ( z t | z t − 1 , z t − 2 , ⋯ ) 是给定过去观测值的条件密度函数，且当 s ≤ 0 时 z s = 0 。</p><p>接下来，使用扫描统计量 S h ( t ) 对序列进行扫描，从而获得一组似然比扫描统计量值的序列 ( S h ( h ) , S h ( h + 1 ) , ⋯ , S h ( n − h ) ) ，如果t是变点， S h ( t ) 往往会较大。若 2 h &lt; n ϵ λ ，则每个扫描窗口内至多存在一个变点。因此 S h ( ⋅ ) 的局部最大值构成一组变点估计，记局部变点估计如下</p><p>J ^ ( 1 ) = { m ∈ { h , h + 1 , ⋯ , n − h } : S h ( m ) = max t ∈ ( m − h , m + h ) S h ( t ) }</p><p>当 t ∉ [ h , ⋯ , ( n − h ) ] 时 S h ( t ) ≜ 0 。即如果 S h ( m ) 是扫描窗口 [ m − h + 1 , m + h ] 内的最大值，则m就是该扫描窗口的局部变点估计。记 m ^ 为估计变点的数目，表示 中的元素个数。</p><p>第二步：通过模型选择得到变点一致估计</p><p>寻找m， J 的最佳集合即为模型选择问题。从上一步获得的局部变点估计集合 J ^ ( 1 ) 通常会存在过估计问题，即将一些正常值也识别为变点，使得 J ^ ( 1 ) 内不仅包含所有真实变点集合，还包含一些非变点。为了更准确地检测到真实变点，进一步利用合适的信息准则从 J ^ ( 1 ) 中选取最佳的子集作为变点估计。最小描述长度(MDL)准则已经在很多实证研究中体现出显著的优势(如Davis et al. (2006, 2008))，本文选取MDL准则进行模型选择过程。给定一组变点估计 J = ( τ 1 , ⋯ , τ m ) ，MDL准则定义为</p><p></p><p>式中 L j ( θ ^ j ; X j ) 是第j段的似然函数， n 1 , ⋯ , n j 是每段分割的长度， d j 是 θ j 的维数， ζ j , 1 , ⋯ , ζ j , c j 是整数值参数，分别确定第j段分割的模型参数 [<xref ref-type="bibr" rid="hanspub.24034-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.24034-ref9">9</xref>] 。考虑本文将各段分为AR过程，整数值参数只有AR过程阶数 p j ；又 θ j = ( ϕ j , 0 , ϕ j , 1 , ⋯ , ϕ j , p , σ ϵ 2 ) ，故 d j = p j + 2 。所以针对AR过程，其MDL表达式为</p><p></p><p>给定局部变点估计 J ^ ( 1 ) ，可以通过下式精确估计变点</p><p>( m ^ ( 2 ) , J ^ ( 2 ) ) = a r g m i n m = | J | , J ⊆ J ^ ( 1 ) MDL ( m , J )</p><p>因为 J ^ ( 1 ) 所包含的因素已经远远少于样本容量，所以在 J ^ ( 1 ) 上优化MDL使计算的复杂度大大降低，提高计算效率。本文采用Yao (1984)和Jackson (2005)提到的最优分割(OP)算法对MDL进行优化 [<xref ref-type="bibr" rid="hanspub.24034-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.24034-ref11">11</xref>] 。</p><p>第三步：最终估计和置信区间构造</p><p>定义新扩展的局部窗口 E j ( h ) 和第j个变点估计 τ ^ j ( 2 ) ∈ J ^ ( 2 ) 的相应观测值 X E j (h)</p><p>E j ( h ) = { τ ^ j ( 2 ) − 2 h + 1 , ⋯ , τ ^ j ( 2 ) + 2 h } ， X E j ( h ) = { X τ ^ j ( 2 ) − 2 h + 1 , ⋯ , X τ ^ j ( 2 ) + 2 h }</p><p>这保证了每个真实变点在相应扩展局部窗口 E j ( h ) 的 ( 1 4 , 3 4 ) 内的概率接近于1。设 L j ( τ , θ 1 , θ 2 ) = ∑ t = τ ^ j ( 2 ) − 2 h + 1 τ l t ( θ 1 ) + ∑ t = τ + 1 τ ^ j ( 2 ) + 2 h l t ( θ 2 ) ，定义最终变点估计为</p><p>τ ^ j ( 3 ) = arg max τ ∈ ( τ ^ j ( 2 ) − h , τ ^ j ( 2 ) + h ] L j ( τ , θ ^ j , θ ^ j + 1 )</p><p>其中 θ ^ j = θ ^ j ( τ ) = a r g m a x θ 1 ∑ t = τ ^ j ( 2 ) − 2 h + 1 τ l t ( θ 1 ) ， θ ^ j + 1 类似定义。此时，可利用2.1中的结论来获得每个最终的变点估计 τ ^ j ( 3 ) 的置信区间。</p><p>在最初扫描步骤中， W j ( h ) 的大小为2h，对给定h，每个时刻t的 S h ( t ) 的计算复杂度为 O ( h ) 。在第二步中，使用Jackson (2005)最优分割算法优化MDL时，最小化MDL需要 O ( ( m ^ ( 1 ) ) 2 n ) 的计算复杂度。</p><p>在第三步中，由于计算被限制在扩展的局部窗口上，所以计算复杂度为 O ( m ^ ( 2 ) h 2 ) 。综上，由于 m ^ ( 1 ) 和 m ^ ( 2 ) 都是有限的，因此整个检测到最终变点估计过程的总计算复杂度为 O ( n h + h 2 ) 。当h较小时，例如 h = O { log ( n ) } ，则完整的三步LRS方法需要使用动态规划算法(最优分割算法)的计算复杂度为 O { n log ( n ) } ，明显低于 O { n 2 } 的数量级。如3.3节所示，窗口半径h作为调整参数，其值选取对定理3.1是至关重要的，其中d未知的。但如果h的阶数大于 O { log ( n ) } ，例如 h = O ( d 2 log ( n ) 2 ) ，那 d 2 的取值不会影响到LRS方法的一致性。因此，随着样本量的增加，这个h的选择在理论上是合理的。经过大量模拟及实证研究发现通常 d = 2 时，各种模型和样本有较好的结果，因此建议当 n &gt; 800 时使用 max { 50 , 2 log ( n ) 2 } ，当 n ≤ 800 时使用 max { 25 , 2 log ( n ) 2 } 作为h的经验选择。</p></sec><sec id="s5_3"><title>3.3. 渐近性质</title><p>本节主要讨论似然比扫描方法的渐近性质，给出相应定理以保证变点估计数目、位置、置信区间的一致性。</p><p>假设3.1. 对任意两个连续的分段 X j = { X τ j − 1 + 1 , ⋯ , X τ j } ， X j + 1 = { X τ j + 1 , ⋯ , X τ j + 1 } ，当 k ∈ { τ j − 1 + 1 , ⋯ , τ j } ，条件似然函数的期望 E [ l k ( θ ) ] 在 θ = θ j 0 处取得唯一的极大值，同理当 k ∈ { τ j + 1 , ⋯ , τ j + 1 } ， E [ l k ( θ ) ] 在 θ = θ j + 1 0 处取得唯一的极大值，且 θ j 0 ≠ θ j + 1 0 。此外有</p><p>{ E [ l k ( θ j + 1 0 ) ] &lt; E [ l k ( θ j 0 ) ] k ∈ { τ j − 1 + 1 , ⋯ , τ j } E [ l k ( θ j + 1 0 ) ] &gt; E [ l k ( θ j 0 ) ] k ∈ { τ j + 1 , ⋯ , τ j + 1 }</p><p>假设3.2. 在任意一个分段中， l k ( θ ) 是关于 { X t } 的连续可测函数，且关于 θ 几乎处处二阶可微。</p><p>假设3.3. 令 Y k ( θ ) = l k ( θ ) − E [ l k ( θ ) ] 。对任意 θ ∈ Θ ，存在 K &gt; 0 使得 Ε ( e | Y k ( θ ) | ) ≤ K ,   k ∈ ℕ 成立。</p><p>假设3.4. 对任意 θ j ∈ Θ j ，均存在可积函数 G ( X t ) ，使得 E ( G ( X t ) ) &lt; ∞ ， | l t ( θ j ) | ≤ G ( X t ) 。</p><p>下面定理3.1确保了所有变点都可以在 J ^ ( 1 ) 的h邻域中确定。</p><p>定理3.1. 记真实变点集合为 J 0 = ( τ 1 0 , ⋯ , τ m 0 0 ) ，通过第一步扫描统计量得到的局部变点集合为 J ^ ( 1 ) = ( τ ^ 1 ( 1 ) , ⋯ , τ ^ m ^ ( 1 ) ( 1 ) ) ，其中 m ^ ( 1 ) = | J ^ ( 1 ) | 。若假设3.1~3.4成立，且 2 h &lt; n ϵ λ ( ϵ λ &gt; 0 ) ，则存在 d &gt; 0 ，当 h ≥ d log ( n ) 时有</p><p>P ( m a x m i n τ ∈ J 0 , k = 1 , ⋯ , m ^ ( 1 ) | τ − τ ^ k ( 1 ) | &lt; h ) → 1</p><p>由于变点之间的最小距离为 n ϵ λ = O ( n ) ，所以真实变点数目 m 0 是有限的。但此时并不能保证 m ^ ( 1 ) 等于 m 0 。也就是说，变点的数量可能被高估，存在过估计问题。接下来定理3.2阐述了基于MDL准则模型选择方法产生的变点数量和位置的一致性。</p><p>定理3.2. 定理3.1成立条件下，当 ϵ λ &gt; 0 时，有 m ^ ( 2 ) → p m 0 。此外，若 m ^ ( 2 ) = m 0 ，则有</p><p>P ( m a x j = 1 , ⋯ , m 0 | τ ^ ( 2 ) − τ j 0 | &lt; h ) → 1</p><p>由于 h ≥ d log ( n ) ，定理3.2意味着 m a x j = 1 , ⋯ , m 0 | τ ^ j ( 2 ) − τ j 0 | = O p ( h ) ，与经典收敛速率 O p ( 1 ) 相比，显然是不理想的。不过尽管如此，区间 [ τ ^ j − h + 1 , τ ^ j + h ] 覆盖真实变点 τ j 0 的概率接近依然1，这使扩展的局部窗口产生变点一致最终估计和置信区间变得可行。</p><p>定理3.3. 定理3.2成立条件下，若 3 h &lt; n ϵ λ ，同时假设3.4成立，则有</p><p>τ ^ j ( 3 ) − τ j 0 → d arg max τ ∈ ℤ W j , τ</p><p>其中 W j , τ 是一个随机游走如下所示</p><p>W τ = { ∑ t = τ j 0 + 1 τ j 0 + τ ( l t ( θ j 0 ) − l t ( θ j + 1 0 ) ) ,       τ &gt; 0, 0 ,   τ = 0, ∑ t = τ j 0 + τ + 1 τ j 0 ( l t ( θ j + 1 0 ) − l t ( θ j 0 ) ) , τ &lt; 0 .</p><p>特别地，此时 τ ^ j ( 3 ) − τ j 0 = O p ( 1 ) 。</p><p>由于变点之间的最小距离远大于窗口半径h，即 n ϵ λ / h → ∞ ，扩展的局部窗口 E j ( h ) 之间的距离亦趋于无穷，所以在一些弱相依条件下，构造的CI是渐近独立的。此时可将2.2中获得单变点置信区间的方法直接应用至多变点模型(其实质也是局部单变点问题)。</p></sec></sec><sec id="s6"><title>4. 数值模拟</title><p>下面用数值模拟说明LRS方法的有效性。</p><sec id="s6_1"><title>4.1. 模型表达</title><p>模型A：没有变点的平稳AR(1)过程</p><p>模型A用来测试评估统计量在没有变点时的检测性能，即当序列无变点时，统计量是否能准确识别。AR(1)过程 X t = 0.4 X t − 1 + ε t ，设样本量 n = 1024 。</p><p>模型B：分段平稳AR(1)过程</p><p>X t = { 0.4 X t − 1 + ε t ,     1 ≤ t ≤ 400 − 0.6 X t − 1 + ε t ,   401 ≤ t ≤ 612 0.5 X t − 1 + ε t ,     613 ≤ t ≤ 1024</p><p>模型C：分段平稳AR(2)过程</p><p>X t = { 0.9 X t − 1 + ε t ,     1 ≤ t ≤ 512 1.69 X t − 1 − 0.81 X t − 2 + ε t , 512 ≤ t ≤ 768 1.32 X t − 1 − 0.81 X t − 2 + ε t , 769 ≤ t ≤ 1024</p><p>模型D：分段平稳分段平稳AR过程(3变点)</p><p>X t = { 1.399 X t − 1 − 0.4 X t − 2 + ε t ,   1 ≤ t ≤ 125 0.3 X t − 1 + 0.3 X t − 2 + ε t , 126 ≤ t ≤ 532 0.9 X t − 1 + ε t , 533 ≤ t ≤ 704 0.1 X t − 1 − 0.5 X t − 2 + ε t , 705 ≤ t ≤ 1024</p><p>模型E：分段平稳ARMA(1，1)过程(2变点)</p><p>X t = { − 0.9 X t − 1 + ε t + 0.7 ε t − 1 , 1 ≤ t ≤ 512 0.9 X t − 1 + ε t , 513 ≤ t ≤ 768 ε t − 0.7 ε t − 1 , 769 ≤ t ≤ 1024</p><p>在模型对比中加入ARMA过程，试图拓展统计量在ARMA过程中的变点识别应用问题。</p><p>上述各模型的变点检测模拟结果见表1、图1。</p><p>图1. 各模型真实变点与LRS方法估计变点位置</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Location of true change-point and LRS estimatio</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >模型</th><th align="center" valign="middle" >真实变点位置</th><th align="center" valign="middle" >估计变点位置</th><th align="center" valign="middle" >置信区间</th><th align="center" valign="middle" >模型</th><th align="center" valign="middle" >真实变点位置</th><th align="center" valign="middle" >估计变点位置</th><th align="center" valign="middle" >置信区间</th></tr></thead><tr><td align="center" valign="middle" >模型A</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >无</td><td align="center" valign="middle"  rowspan="3"  >模型D</td><td align="center" valign="middle" >125</td><td align="center" valign="middle" >125</td><td align="center" valign="middle" >[122, 128]</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >模型B</td><td align="center" valign="middle" >400</td><td align="center" valign="middle" >400</td><td align="center" valign="middle" >[392, 408]</td><td align="center" valign="middle" >532</td><td align="center" valign="middle" >549</td><td align="center" valign="middle" >[531, 567]</td></tr><tr><td align="center" valign="middle" >612</td><td align="center" valign="middle" >612</td><td align="center" valign="middle" >[607, 617]</td><td align="center" valign="middle" >704</td><td align="center" valign="middle" >703</td><td align="center" valign="middle" >[700, 706]</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >模型C</td><td align="center" valign="middle" >512</td><td align="center" valign="middle" >510</td><td align="center" valign="middle" >[499, 525]</td><td align="center" valign="middle"  rowspan="2"  >模型E</td><td align="center" valign="middle" >512</td><td align="center" valign="middle" >511</td><td align="center" valign="middle" >[506, 516]</td></tr><tr><td align="center" valign="middle" >768</td><td align="center" valign="middle" >768</td><td align="center" valign="middle" >[763, 773]</td><td align="center" valign="middle" >768</td><td align="center" valign="middle" >768</td><td align="center" valign="middle" >[766, 770]</td></tr></tbody></table></table-wrap><p>表1. 各模型真实变点与LRS方法估计变点位置</p><p>结合表1和图1可看出，LRS对于非平稳时间序列中的变点检测问题是有效的，不论是单变点、多变点还是没有变点的情形，均可以较准确的进行检测。在ARMA过程中的变点位置检测会出现偏移，但变点个数均正确，尽管准确率有所下降，不难看出检测到的变点仍在构造的置信区间内。</p></sec><sec id="s6_2"><title>4.2. 置信区间</title><p>本节主要检查变点置信区间的覆盖准确性。通过上述各个模型生成数据。应用LRS方法，在每个估计变点周围利用定理3.3和2.2节的结论构建90％置信区间。设置样本量 n = 1024 ，分别各进行100次模拟。结果如表2所示。</p><p>表2展示了具体结论，表明最终变点估计 τ ^ j ( 3 ) 对 τ 0 做出了较好的估计，且置信区间覆盖概率较高，效果良好。</p></sec><sec id="s6_3"><title>4.3. 模拟对比</title><p>定义利用渐近分布构造的置信区间覆盖率为CR</p><p>C R = # 置 信 区 间 覆 盖 真 实 变 点 模 拟 次 数</p><p>趋近于1，则认为估计效果比较好。</p><p>为对比检验LRS方法检测变点的准确率，依旧通过上述5个模型，同时利用LRS方法与经典WBS方法进行比较。各模型分别模拟100次，整理得到结果见表3。</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Confidence interval coverage of each mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >模型</th><th align="center" valign="middle" >真实变点位置</th><th align="center" valign="middle" >变点估计均值</th><th align="center" valign="middle" >90%估计变点范围</th><th align="center" valign="middle" >90%置信区间均值</th><th align="center" valign="middle" >覆盖率</th><th align="center" valign="middle" >计算时间(s)</th></tr></thead><tr><td align="center" valign="middle" >模型A</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >无</td><td align="center" valign="middle" >无</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >模型B</td><td align="center" valign="middle" >400</td><td align="center" valign="middle" >400.47</td><td align="center" valign="middle" >[387, 413]</td><td align="center" valign="middle" >[393.55, 407.39]</td><td align="center" valign="middle" >92%</td><td align="center" valign="middle"  rowspan="2"  >387.96</td></tr><tr><td align="center" valign="middle" >612</td><td align="center" valign="middle" >612.11</td><td align="center" valign="middle" >[599, 625]</td><td align="center" valign="middle" >[605.58, 618.64]</td><td align="center" valign="middle" >89%</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >模型C</td><td align="center" valign="middle" >512</td><td align="center" valign="middle" >512.26</td><td align="center" valign="middle" >[503, 520]</td><td align="center" valign="middle" >[501.11, 523.41]</td><td align="center" valign="middle" >92%</td><td align="center" valign="middle"  rowspan="2"  >467.63</td></tr><tr><td align="center" valign="middle" >768</td><td align="center" valign="middle" >768.61</td><td align="center" valign="middle" >[755, 782]</td><td align="center" valign="middle" >[760.92, 776.3]</td><td align="center" valign="middle" >93%</td></tr><tr><td align="center" valign="middle"  rowspan="3"  >模型D</td><td align="center" valign="middle" >125</td><td align="center" valign="middle" >124.87</td><td align="center" valign="middle" >[116, 134]</td><td align="center" valign="middle" >[120.15, 129.59]</td><td align="center" valign="middle" >95%</td><td align="center" valign="middle"  rowspan="3"  >563.92</td></tr><tr><td align="center" valign="middle" >532</td><td align="center" valign="middle" >530.4</td><td align="center" valign="middle" >[493, 557]</td><td align="center" valign="middle" >[512.22, 548.58]</td><td align="center" valign="middle" >74%</td></tr><tr><td align="center" valign="middle" >704</td><td align="center" valign="middle" >704.74</td><td align="center" valign="middle" >[695, 714]</td><td align="center" valign="middle" >[700.16, 708.12]</td><td align="center" valign="middle" >89%</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >模型E</td><td align="center" valign="middle" >512</td><td align="center" valign="middle" >511.73</td><td align="center" valign="middle" >[504, 519]</td><td align="center" valign="middle" >[507.35, 516.09]</td><td align="center" valign="middle" >91%</td><td align="center" valign="middle"  rowspan="2"  >491.58</td></tr><tr><td align="center" valign="middle" >768</td><td align="center" valign="middle" >767.74</td><td align="center" valign="middle" >[761, 774]</td><td align="center" valign="middle" >[764.84, 770.62]</td><td align="center" valign="middle" >84%</td></tr></tbody></table></table-wrap><p>表2. 各模型置信区间覆盖情况</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Simulation result of LRS and WB</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >变点个数</th><th align="center" valign="middle"  colspan="2"  >模型A 无变点</th><th align="center" valign="middle"  colspan="2"  >模型B 2变点</th><th align="center" valign="middle"  colspan="2"  >模型C 2变点</th><th align="center" valign="middle"  colspan="2"  >模型D 3变点</th><th align="center" valign="middle"  colspan="2"  >模型E 2变点</th></tr></thead><tr><td align="center" valign="middle" >LRS</td><td align="center" valign="middle" >WBS</td><td align="center" valign="middle" >LRS</td><td align="center" valign="middle" >WBS</td><td align="center" valign="middle" >LRS</td><td align="center" valign="middle" >WBS</td><td align="center" valign="middle" >LRS</td><td align="center" valign="middle" >WBS</td><td align="center" valign="middle" >LRS</td><td align="center" valign="middle" >WBS</td></tr><tr><td align="center" valign="middle" >0</td><td align="center" valign="middle" >100</td><td align="center" valign="middle" >55</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td></tr><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >12</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >14</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >13</td><td align="center" valign="middle" >100</td><td align="center" valign="middle" >56</td><td align="center" valign="middle" >100</td><td align="center" valign="middle" >86</td><td align="center" valign="middle" >12</td><td align="center" valign="middle" >17</td><td align="center" valign="middle" >100</td><td align="center" valign="middle" >53</td></tr><tr><td align="center" valign="middle" >3</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >9</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >28</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >13</td><td align="center" valign="middle" >88</td><td align="center" valign="middle" >67</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >26</td></tr><tr><td align="center" valign="middle" >≥4</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >11</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >16</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >16</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >7</td></tr><tr><td align="center" valign="middle" >CR</td><td align="center" valign="middle" >100%</td><td align="center" valign="middle" >51%</td><td align="center" valign="middle" >89%</td><td align="center" valign="middle" >50%</td><td align="center" valign="middle" >92%</td><td align="center" valign="middle" >72%</td><td align="center" valign="middle" >74%</td><td align="center" valign="middle" >60%</td><td align="center" valign="middle" >84%</td><td align="center" valign="middle" >41%</td></tr></tbody></table></table-wrap><p>表3. LRS、WBS模拟结果</p><p>结果显示，当非平稳序列为分段平稳AR过程时LRS方法和WBS方法均能较好的检测出变点且位置估计效果都比较好，从变点个数检测和位置估计的准确率上来说，LRS方法准确率明显高于WBS方法，WBS方法存在较严重的变点数目高估问题，将一些本不是变点的点作为变点。通过上述典型模型的变点检测情况，明确了LRS方法的优良性，对各模型均能灵敏的对变点数目进行检测，给出了良好的变点位置估计，同时构建的置信区间覆盖率也较高，证明了LRS方法的实用性。</p></sec></sec><sec id="s7"><title>5. 交通流数据应用实例</title><p>以贵阳市宝山北路与东新区路交叉口南北方向车流量数据为例。选取2016年4月4日至2016年4月10日一周(星期一至星期日)车流量数据进行变点检测，验证LRS方法的实用性。数据为每天00:00~23:55每两分钟(共720个)过车数量。宝山北路与东新区路交叉口南北方向一周车流量时序图如图2所示。</p><p>考虑工作日、休息日车流量分布情况，分别选取星期四、五、六作为代表，同时利用LRS方法和WBS方法对车流量数据进行变点检测，分别得到各天的变点估计情况如图3~5所示。</p><p>图2. 贵阳市宝山北路与东新区路交叉口南向北一周车流量时序图</p><p>图3. 宝山北路与东新区路交叉口2016年4月7日(星期四)车流量变点位置估计</p><p>图4. 宝山北路与东新区路交叉口2016年4月8日(星期五)车流量变点位置估计</p><p>图5. 宝山北路与东新区路交叉口2016年4月9日(星期六)车流量变点位置估计</p><p>通过图3~5可直观清晰的对比两种方法对变点位置的估计情况，WBS方法检测出的变点数目明显多于LRS方法，过估计问题依然普遍存在。从工作日(星期四星期五)的变点位置不难虽然WBS方法估计变点多于LRS方法，但是LRS方法检测出的变点附近WBS方法也识别到了变点的存在，即对于变点的存在性检测两种方法都是足够灵敏的。区别较大的是休息日(星期六)的变点位置估计，LRS方法和WBS 方法检测出的点分别对应时间01:24、07:04、13:02和03:50、06:34、08:54、13:02、21:08。但从实际出发，该交叉路口处于贵阳市中心，很多大型商圈围绕，当星期五结束工作，晚上人们会集中前往娱乐消遣，与朋友聚会等，所以在01:24左右前还属于人群活动时间，成为新的出行“高峰”，01:24左右后人们才陆续休息，此时车流极具下降造成分布改变；休息日不存在早晚高峰问题，但考虑早晨人们开始起床活动或出游等造成07:04左右时交通流分布发生改变，车流量开始增多；非工作日贵阳车辆不实行尾号限行，所以全天车流都较多，在13:02后该路口车流量趋于平稳，分布不在发生改变。</p><p>表4展示了LRS方法和WBS方法对2016年4月4日(星期一)至2016年4月10日(星期日)每天车流量的变点识别情况，具体见表4。</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> Contrast of change point of traffic flow data detection result</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >日期 方法</th><th align="center" valign="middle"  colspan="2"  >2016/4/4 (星期一)</th><th align="center" valign="middle"  colspan="2"  >2016/4/5 (星期二)</th><th align="center" valign="middle"  colspan="2"  >2016/4/6 (星期三)</th><th align="center" valign="middle"  colspan="2"  >2016/4/7 (星期四)</th><th align="center" valign="middle"  colspan="2"  >2016/4/8 (星期五)</th><th align="center" valign="middle"  colspan="2"  >2016/4/9 (星期六)</th><th align="center" valign="middle"  colspan="2"  >2016/4/10 (星期日)</th></tr></thead><tr><td align="center" valign="middle" >位置</td><td align="center" valign="middle" >时间</td><td align="center" valign="middle" >位置</td><td align="center" valign="middle" >时间</td><td align="center" valign="middle" >位置</td><td align="center" valign="middle" >时间</td><td align="center" valign="middle" >位置</td><td align="center" valign="middle" >时间</td><td align="center" valign="middle" >位置</td><td align="center" valign="middle" >时间</td><td align="center" valign="middle" >位置</td><td align="center" valign="middle" >时间</td><td align="center" valign="middle" >位置</td><td align="center" valign="middle" >时间</td></tr><tr><td align="center" valign="middle"  rowspan="3"  >LRS</td><td align="center" valign="middle" >226</td><td align="center" valign="middle" >07:30</td><td align="center" valign="middle" >201</td><td align="center" valign="middle" >06:40</td><td align="center" valign="middle" >220</td><td align="center" valign="middle" >07:18</td><td align="center" valign="middle" >202</td><td align="center" valign="middle" >06:42</td><td align="center" valign="middle" >202</td><td align="center" valign="middle" >06:42</td><td align="center" valign="middle" >43</td><td align="center" valign="middle" >01:24</td><td align="center" valign="middle"  colspan="2"   rowspan="3"  >无</td></tr><tr><td align="center" valign="middle" >345</td><td align="center" valign="middle" >11:28</td><td align="center" valign="middle" >328</td><td align="center" valign="middle" >10:54</td><td align="center" valign="middle" >339</td><td align="center" valign="middle" >11:16</td><td align="center" valign="middle" >364</td><td align="center" valign="middle" >12:06</td><td align="center" valign="middle" >328</td><td align="center" valign="middle" >10:54</td><td align="center" valign="middle" >213</td><td align="center" valign="middle" >07:04</td></tr><tr><td align="center" valign="middle" >568</td><td align="center" valign="middle" >18:54</td><td align="center" valign="middle" >537</td><td align="center" valign="middle" >17:52</td><td align="center" valign="middle" >534</td><td align="center" valign="middle" >17:46</td><td align="center" valign="middle" >528</td><td align="center" valign="middle" >17:34</td><td align="center" valign="middle" >522</td><td align="center" valign="middle" >17:22</td><td align="center" valign="middle" >392</td><td align="center" valign="middle" >13:02</td></tr><tr><td align="center" valign="middle"  rowspan="6"  >WBS</td><td align="center" valign="middle" >44</td><td align="center" valign="middle" >01:26</td><td align="center" valign="middle" >56</td><td align="center" valign="middle" >01:50</td><td align="center" valign="middle" >45</td><td align="center" valign="middle" >01:28</td><td align="center" valign="middle" >73</td><td align="center" valign="middle" >02:24</td><td align="center" valign="middle" >56</td><td align="center" valign="middle" >01:50</td><td align="center" valign="middle" >116</td><td align="center" valign="middle" >03:50</td><td align="center" valign="middle" >48</td><td align="center" valign="middle" >01:34</td></tr><tr><td align="center" valign="middle" >200</td><td align="center" valign="middle" >06:40</td><td align="center" valign="middle" >196</td><td align="center" valign="middle" >06:30</td><td align="center" valign="middle" >211</td><td align="center" valign="middle" >07:00</td><td align="center" valign="middle" >196</td><td align="center" valign="middle" >06:30</td><td align="center" valign="middle" >197</td><td align="center" valign="middle" >06:32</td><td align="center" valign="middle" >198</td><td align="center" valign="middle" >06:34</td><td align="center" valign="middle" >209</td><td align="center" valign="middle" >06:56</td></tr><tr><td align="center" valign="middle" >402</td><td align="center" valign="middle" >13:22</td><td align="center" valign="middle" >297</td><td align="center" valign="middle" >09:52</td><td align="center" valign="middle" >342</td><td align="center" valign="middle" >11:22</td><td align="center" valign="middle" >341</td><td align="center" valign="middle" >11:20</td><td align="center" valign="middle" >242</td><td align="center" valign="middle" >08:02</td><td align="center" valign="middle" >268</td><td align="center" valign="middle" >08:54</td><td align="center" valign="middle" >650</td><td align="center" valign="middle" >21:38</td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >328</td><td align="center" valign="middle" >10:54</td><td align="center" valign="middle" >432</td><td align="center" valign="middle" >14:22</td><td align="center" valign="middle" >368</td><td align="center" valign="middle" >12:14</td><td align="center" valign="middle" >318</td><td align="center" valign="middle" >10:34</td><td align="center" valign="middle" >392</td><td align="center" valign="middle" >13:02</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >532</td><td align="center" valign="middle" >17:42</td><td align="center" valign="middle" >527</td><td align="center" valign="middle" >17:32</td><td align="center" valign="middle" >487</td><td align="center" valign="middle" >16:12</td><td align="center" valign="middle" >357</td><td align="center" valign="middle" >11:52</td><td align="center" valign="middle" >635</td><td align="center" valign="middle" >21:08</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr><tr><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >566</td><td align="center" valign="middle" >18:50</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" >546</td><td align="center" valign="middle" >18:10</td><td align="center" valign="middle" >506</td><td align="center" valign="middle" >16:50</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表4. 交通流数据变点检测结果对比</p><p>结果显示工作日(星期一至星期日) LRS方法普遍识别出3个变点，这3个点将车流量数据分为4个子序列，变点位置及对应的时间也相对较为固定，集中在早、中、晚上下班高峰期，与实际也比较符合。针对星期日车流数据LRS方法未识别到，原因可能为：1) 当天数据比较特殊，2) 星期日贵阳城区不限号，当日在所有时间段内车流分布都基本保持不变，尽管从凌晨到上午7点这段时间过车量较少，但并未导致整个车流分布发生改变。其次，WBS方法对变点的识别也是灵敏的，但是过估计问题也十分严重，常将一些奇异点也当作变点处理。通过数值模拟和实证分析都表明相较于目前使用较多的WBS方法，LRS方法不仅能有效识别到变点，而且能够更为准确的对变点位置进行估计，说明LRS方法对变点研究是实践可用的。</p></sec><sec id="s8"><title>6. 结束语</title><p>文章考虑了分段平稳时间序列的变点检测问题，假设观测值服从参数不同的非线性时间序列模型(AR模型)，且变点数量及位置均未知，通过构建LRS统计量对序列进行检测，实现序列变点的初步识别，进一步结合MDL准则进行模型选择，估计变点的数量、位置，最后对每个估计变点分别构造置信区间。同时利用WBS算法对序列变点数目及位置进行估计，并对两种算法进行模拟比较。数值模拟结果显示，两种方法均对变点有良好的识别效果，但LRS方法明显优于WBS方法，LRS方法的模型选择过程能更有效的剔除异常值，使得变点估计更为准确。最后，结合贵阳市中心道路车流量数据实例分析，表明方法对于交通流突变分析效果较好。</p></sec><sec id="s9"><title>基金项目</title><p>贵州大学2017年研究生创新基金项目(研理工2017067)；国家自然科学基金项目(11661018，11361015)；全国统计科学研究项目(2014LZ46)；贵州省自然科学基金项目(黔科合J字[<xref ref-type="bibr" rid="hanspub.24034-ref2014">2014</xref>]2058号)。</p></sec><sec id="s10"><title>文章引用</title><p>吴 楠,胡 尧,王 丹. 分段平稳时间序列中的多变点检测 Multiple Change-Points Detection of Piecewise Stationary Time Series[J]. 理论数学, 2018, 08(02): 136-148. https://doi.org/10.12677/PM.2018.82018</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.24034-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Hinkley, D.V. (1970) Inference about the Change-Point in a Sequence of Random Variables. Biometrika, 57, 1-17.  
&lt;br&gt;https://doi.org/10.1093/biomet/57.1.1</mixed-citation></ref><ref id="hanspub.24034-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Hinkley, D.V. and Hinkley, E.A. (1970) Inference about the Change-Point in a Se-quence of Binomial Variables. Biometrika, 57, 477-488. &lt;br&gt;https://doi.org/10.1093/biomet/57.3.477</mixed-citation></ref><ref id="hanspub.24034-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Yao, Y.C. (1987) Ap-proximating the Distribution of the Maximum Likelihood Estimate of the Change-Point in a Sequence of Independent Random Va-riables. Annals of Statistics, 15, 1321-1328. &lt;br&gt;https://doi.org/10.1214/aos/1176350509</mixed-citation></ref><ref id="hanspub.24034-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Picard, D. (1985) Testing and Esti-mating Change-Points in Time Series. Advances in Applied Probability, 17, 841-867.  
&lt;br&gt;https://doi.org/10.2307/1427090</mixed-citation></ref><ref id="hanspub.24034-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Davis, R.A. and Rodriguez-Yam, G.A. (2006) Structural Break Estimation for Nonstatio-nary Time Series Models. Journal of the American Statistical Association, 101, 223-239. &lt;br&gt;https://doi.org/10.1198/016214505000000745</mixed-citation></ref><ref id="hanspub.24034-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Fryzlewicz, P. (2014) Wild Binary Segmentation for Multiple Change-Point Detection. The Annals of Statistics, 42, 2243-2281. &lt;br&gt;https://doi.org/10.1214/14-AOS1245</mixed-citation></ref><ref id="hanspub.24034-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Yau, C.Y. and Zhao, Z. (2015) Inference for Multiple Change Points in Time Series via Likelihood Ratio Scan Statistics. Journal of the Royal Statistical Society, 2015, 78. http://doi.org/10.1111/rssb.12139</mixed-citation></ref><ref id="hanspub.24034-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Ling, S. (2016) Estimation of Change-Points in Linear and Nonlinear Time Series Models. Econometric Theory, 32, 402-430. &lt;br&gt;https://doi.org/10.1017/S0266466614000863</mixed-citation></ref><ref id="hanspub.24034-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Davis, R.A., Lee, T.C.M. and Rodriguez-Yam, G.A. (2008) Break Detection for a Class of Nonlinear Time Series Models. Journal of Time Series Analysis, 29, 834-867. &lt;br&gt;https://doi.org/10.1111/j.1467-9892.2008.00585.x</mixed-citation></ref><ref id="hanspub.24034-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Yao, Y.C. (1984) Estimation of a Noisy Discrete-Time Step Function: Bayes and Empirical Bayes Approaches. Annals of Statistics, 12, 1434-1447. &lt;br&gt;https://doi.org/10.1214/aos/1176346802</mixed-citation></ref><ref id="hanspub.24034-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Jackson, B., Scargle, J.D., Barnes, D., et al. (2005) An Algorithm for Optimal Partitioning of Data on an Interval. IEEE Signal Processing Letters, 12, 105-108. &lt;br&gt;https://doi.org/10.1109/LSP.2001.838216</mixed-citation></ref></ref-list></back></article>