<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2021.107244</article-id><article-id pub-id-type="publisher-id">AAM-43820</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20210700000_48266072.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于马尔科夫随机场对二型糖尿病早期诊断
  A Markov Random Field-Based Approach for Early Diagnosis of Type 2 Diabetes
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>田</surname><given-names>雪寒</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>艺舒</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>北京科技大学，北京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><aff id="aff2"><addr-line>青岛大学，山东 青岛</addr-line></aff><pub-date pub-type="epub"><day>01</day><month>07</month><year>2021</year></pub-date><volume>10</volume><issue>07</issue><fpage>2339</fpage><lpage>2347</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  为了探究二型糖尿病早期动态变化，本文通过分析小鼠标本的组织特异性表达数据，获得相邻时间段之间的差异表达的证据，以表征基因差异表达的动态变化。该数据集中含有丰富的时空信息，但以往的研究中很难充分利用。我们通过在潜在状态上指定马尔可夫随机场(MRF)合并具有时空结构的复杂数据，用蒙特卡洛期望最大化(MCEM)算法计算模型参数，其关键特征是同时考虑基因表达水平的空间相似性和时间依赖性，仿真研究与实例分析结果都表明该方法具有更高的灵敏度，能识别更多的DE基因，能从数据中提取更多生物学上有意义的结果。
   In order to explore the early dynamic changes of type 2 diabetes mellitus, this paper analyzed the tissue-specific expression data of mouse specimens to obtain the evidence of differential expression between adjacent time periods, so as to characterize the dynamic changes of differential gene expression. This dataset contains abundant spatiotemporal information, but it is difficult to make full use of it in previous studies. We pass in the potential state specified on Markov random field (MRF) combined with space-time structure of complex data, using the Monte Carlo calculation model for the expectation maximization (MCEM) algorithm parameters, its key characteristic is also considering gene expression level of similarity space and time dependence, simulation research and the example analysis results show that this method has higher sensitivity. More DE genes can be identified and more biologically significant results can be extracted from the data.
 
</p></abstract><kwd-group><kwd>二型糖尿病早期，马尔可夫随机场，MCEM算法, Type 2 Diabetes</kwd><kwd> Markov Random Field</kwd><kwd> MCEM Algorithm</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>为了探究二型糖尿病早期动态变化，本文通过分析小鼠标本的组织特异性表达数据，获得相邻时间段之间的差异表达的证据，以表征基因差异表达的动态变化。该数据集中含有丰富的时空信息，但以往的研究中很难充分利用。我们通过在潜在状态上指定马尔可夫随机场(MRF)合并具有时空结构的复杂数据，用蒙特卡洛期望最大化(MCEM)算法计算模型参数，其关键特征是同时考虑基因表达水平的空间相似性和时间依赖性，仿真研究与实例分析结果都表明该方法具有更高的灵敏度，能识别更多的DE基因，能从数据中提取更多生物学上有意义的结果。</p></sec><sec id="s2"><title>关键词</title><p>二型糖尿病早期，马尔可夫随机场，MCEM算法</p></sec><sec id="s3"><title>A Markov Random Field-Based Approach for Early Diagnosis of Type 2 Diabetes<sup> </sup></title><p>Xuehan Tian<sup>1</sup>, Yishu Wang<sup>2*</sup></p><p><sup>1</sup>Qingdao University, Qingdao Shandong</p><p><sup>2</sup>University of Science &amp; Technology Beijing, Beijing</p><p><img src="//html.hanspub.org/file/10-2621714x5_hanspub.png" /></p><p>Received: Jun. 7<sup>th</sup>, 2021; accepted: Jun. 28<sup>th</sup>, 2021; published: Jul. 12<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/10-2621714x6_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>In order to explore the early dynamic changes of type 2 diabetes mellitus, this paper analyzed the tissue-specific expression data of mouse specimens to obtain the evidence of differential expression between adjacent time periods, so as to characterize the dynamic changes of differential gene expression. This dataset contains abundant spatiotemporal information, but it is difficult to make full use of it in previous studies. We pass in the potential state specified on Markov random field (MRF) combined with space-time structure of complex data, using the Monte Carlo calculation model for the expectation maximization (MCEM) algorithm parameters, its key characteristic is also considering gene expression level of similarity space and time dependence, simulation research and the example analysis results show that this method has higher sensitivity. More DE genes can be identified and more biologically significant results can be extracted from the data.</p><p>Keywords:Type 2 Diabetes, Markov Random Field, MCEM Algorithm</p><disp-formula id="hanspub.43820-formula2"><graphic xlink:href="//html.hanspub.org/file/10-2621714x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/10-2621714x8_hanspub.png" /> <img src="//html.hanspub.org/file/10-2621714x9_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>糖尿病是一种难以根治的慢性疾病，慢性并发症可遍及全身重要器官，急性并发症严重时可危及生命。其中二型糖尿病(T2D)占糖尿病患者总数的九成以上，糖尿病早期由于因胰岛β细胞的代偿机制代偿机制，血糖变化与正常人群差别较小，做专项检查成本高，容易造成医疗资源浪费。因此，诊断出“糖尿病早期”并积极采取干预治疗手段，将有利于推进治愈二型糖尿病这一难题。</p><p>自20世纪90年代中后期，基因微阵列技术问世以来便受到科学界的广泛关注，是基因组学中能有效地测量有机体的基因表达水平所使用最广泛的工具。揭示生物网络是系统生物学中的一个关键目标，现在我们能通过微阵列在各种条件下测量基因组水平的表达情况，这些数据可以从统计上推断基因调控网络。在生物学中，许多不同的生物过程都用图表示，比如：包括蛋白质–蛋白质相互作用网络(PPI)，转录调控网络和基因共表达网络，生物途径等。</p><p>我们用由节点 V = { 1 , ⋯ , p } ，边 E ⊂ V &#215; V 组成的图 G = ( V , E ) 表示生物网络。对于条件独立图，当且仅当节点i和节点j在给定所有其他节点都不条件独立的情况下， ( i , j ) ∈ E 。高斯图形模型(GGMs)则已经被证明是推断条件独立图的最佳方法之一。高斯图模型是一种概率图模型，GGMs起源于20世纪70年代早期，这一概念源于AP Dempster [<xref ref-type="bibr" rid="hanspub.43820-ref1">1</xref>] 的经典论文，是研究基因之间关联网络的工具。在GGM中，</p><p>假定p维随机变量 X = ( X 1 , ⋯ , X p ) 服从多元高斯分布 Ν ( μ , Σ ) ， Θ = Σ − 1 ，可以证明 X i 和 X j 的条件独立性等效于 Θ i j ≠ 0 : X i ⊥ X j | X V \ { i , j } ⇔ Θ i j = 0 。在GGM中，估计条件独立图等效于估计 Θ 中的非零条目。</p><p>为了估计GGM，Meinshausen &amp; Buhlmann [<xref ref-type="bibr" rid="hanspub.43820-ref2">2</xref>] 证明了使用套索的邻域选择是一个计算吸引力的标准协方差稀疏高维图选择模型。邻域选择分别估计了图中的每个节点的条件独立性限制，因此等价于高斯线性模型的变量选择。同时证明了稀疏的邻域选择方案对于高维图是一致，其一致性取决于惩罚参数的选择。Yuan &amp; Lin [<xref ref-type="bibr" rid="hanspub.43820-ref3">3</xref>] 提出了一种有效的算法来扩展Lasso方法的特征选择，并表明这些扩展具有优越的性能，在一定条件下，Lasso变量的选择具有一致性。Friedman et al. [<xref ref-type="bibr" rid="hanspub.43820-ref4">4</xref>] 考虑用逆协方差矩阵上的Lasso惩罚来估计稀疏图的问题.，利用Lasso的坐标下降过程，开发了一种简单的图形Lasso算法，命名为图形套索(glasso)。Cai et al. [<xref ref-type="bibr" rid="hanspub.43820-ref5">5</xref>]，Dobra et al. [<xref ref-type="bibr" rid="hanspub.43820-ref6">6</xref>]，Wang et al. [<xref ref-type="bibr" rid="hanspub.43820-ref7">7</xref>] 等三人同样对估计GGM做出了许多贡献。</p><p>本文提出的工作是基于对小鼠标本的组织特异性表达数据的分析所激发的，我们希望通过分析小鼠标本的组织特异性表达数据，在小鼠发育的不同时期，不同的器官组织基因表达动态发育过程不同，为了有效利用该数据集中丰富的时空信息，我们的方法基于马尔可夫随机场(MRF)模型识别相邻时间点的差异表达基因(DE)，用蒙特卡洛期望最大化(MCEM)算法计算模型参数，考虑不同时间不同器官组织的病理性变化。我们的方法的关键特征是同时考虑基因表达水平的空间相似性和时间依赖性，获得相邻时间段之间的差异表达的证据，以表征基因差异表达的动态变化，从而探究二型糖尿病早期动态变化。以更好地从数据中提取生物学上有意义的结果。</p></sec><sec id="s6"><title>2. 模型构建</title><sec id="s6_1"><title>2.1. 差异基因的潜状态模型</title><p>对于二型糖尿的早期患者，因胰岛β细胞的代偿机制，血糖波动于正常人群差异很小，通过现有检测方式诊断时患者已经不可能自愈。为了探究二型糖尿病早期动态变化，我们通过分析小鼠标本的组织特异性表达数据，获得相邻时间段之间的差异表达的证据，以表征基因差异表达的动态变化。</p><p>首先我们假设 B = 3 为脂肪，肝脏及胰腺这三处采样组织， T = 3 为小鼠发育的第1周、9周、18周三个年龄阶段， G = 45101 为基因数。令 n b t 表示在区域b处，年龄为t的小鼠的重复次数， N b = ( n b 1 , ⋯ , n b t , ⋯ , n b T ) ′ 为区域b中重复次数的列向量， N = ( N 1 , ⋯ , N b , ⋯ , N B ) 为重复次数</p><p>我们假设 y b g t k , k = 1 , ⋯ , n b t 服从均值为 μ b g t 和方差为 σ 0 2 的正态分布 y b g t k ~ Ν ( μ b g t , σ 0 2 ) 。 x b g t 为二进制潜状态，表示基因g是否在区域b时刻t中表达，以 x b g t 为条件，我们假设 μ b g t 遵循高斯分布：</p><p>μ b g t | x b g t = 0 ~ Ν ( μ 1 b , σ 1 b 2 ) μ b g t | x b g t = 1 ~ Ν ( μ 2 b , σ 2 b 2 )</p><p>我们假设在特定的区域，混合成分的均值和方差不同，用 μ 1 , μ 2 , σ 1 , σ 2 表示所有区域的参数向量。 y b g t k 在 x b g t 条件下的分布具有以下形式：</p><p>y b g t k | x b g t = 0 ~ N ( μ 1 b , σ 1 b 2 + σ 0 2 ) y b g t k | x b g t = 1 ~ N ( μ 2 b , σ 2 b 2 + σ 0 2 )</p><p>给定潜变量数组 X ，假定 f ( Y | X ) = ∏ b = 1 B ∏ g = 1 G ∏ t = 1 T f ( y b g t | x b g t ) 条件独立，则</p><p>f ( y b g t | x b g t ) = ∏ k = 1 n b t f ( y b g t | x b g t ) .</p><p>下面我们对于差异表达基因(DE)的分析，我们首先将观察到的数据转换为数组 B &#215; G &#215; ( T − 1 ) ，在相邻时段之间执行t检验并将t统计量转换为 z ~ scores 。设 y b g ( t − 1 ) 和 y b g t 分别为t-1与t时刻区域b中基因g的表达值的向量，双样本t统计量为：</p><p>t b g ( t − 1 ) = y &#175; b g t − y &#175; b g ( t − 1 ) s</p><p>其中s为 y &#175; b g t − y &#175; b g ( t − 1 ) 的标准误差的估计值。然后将检验统计量 t b g ( t − 1 ) 转换为 z ~ scores ：</p><p>z b g ( t − 1 ) = Φ − 1 ( F n b t + n b ( t − 1 ) − 2 ( t b g ( t − 1 ) ) ) .</p><p>其中 n b g ( t − 1 ) 和 n b g t 是 y b g ( t − 1 ) 和 y b g t 中重复的数目。</p><p>基因表达数据由 B &#215; G &#215; ( T − 1 ) 数组 Z 表示。 s b g t 表示表示基因g在区域b是否在时段t和t+1之间差异表达的二进制潜状态，这是我们推断的目的。设 S 为维数 B &#215; G &#215; ( T − 1 ) 的潜状态数组。在 s b g t 条件下，我们假设 z b g t 遵循混合分布：</p><p>f ( z b g t | s b g t ) = ( 1 − s b g t ) f 0 ( z b g t ) + s b g t f 1 ( z b g t ) .</p><p>其中 f 0 ( z ) 是零密度， f 1 ( z ) 是非零密度。我们假设零密度遵循标准的 N ( 0 , 1 ) 分布。我们采用非参数经验贝叶斯框架(Efron [<xref ref-type="bibr" rid="hanspub.43820-ref8">8</xref>] )，通过使用R包locfdr将非空密度与自然样条拟合。给定 S ，假定条件独立：</p><p>f ( Z | S ) = ∏ b = 1 B ∏ g = 1 G ∏ t = 1 T − 1 f ( z b g t | s b g t ) .</p></sec><sec id="s6_2"><title>2.2. MRF模型的先验概率</title><p>上述模型和推理目标中的一个关键组成部分是我们未知的潜在状态数组 X ,下面我们用MRF模型生成 X 的先验值 p ( X ) 。对于每个基因 g ，我们构建一个无向图 G g = ( V g , E g ) ，其中</p><p>V g = { x b g t : b = 1 , ⋯ , B , t = 1 , ⋯ , T } 是节点的集合， E g 是边的集合， E g 由 E g 1 与 E g 2 组成，</p><p>E g 1 = { ( x b g t , x b ′ g t ′ ) : b ≠ b ′ , t = t ′ } 为包含捕获的区域之间空间依赖性的边缘 E g 2 = { ( x b g t , x b ′ g t ′ ) : b = b ′ , | t − t ′ | = 1 }</p><p>为包含捕获的相邻周期之间时间依赖性的边缘。</p><p>对于 p ( X ) 的联合分布概率，我们建立下列成对交互的MRF模型(Besag [<xref ref-type="bibr" rid="hanspub.43820-ref9">9</xref>], Lin et al. [<xref ref-type="bibr" rid="hanspub.43820-ref10">10</xref>] )：</p><p>p ( X | Φ ) ∝ ∏ g = 1 G exp { γ 0 ∑ V g I 0 ( x b g t ) + γ 1 ∑ V g I 1 ( x b g t ) + β 1 ∑ E g 1 [ I 0 ( x b g t ) I 0 ( x b ′ g t ′ ) + I 1 ( x b g t ) I 1 ( x b ′ g t ′ ) ] + β 2 ∑ E g 2 [ I 0 ( x b g t ) I 0 ( x b ′ g t ′ ) + I 1 ( x b g t ) I 1 ( x b ′ g t ′ ) ] } 2-(1)</p><p>其中 I 0 ( ) 与 I 1 ( ) 为指标函数，令 γ = γ 1 − γ 0 ，可得条件概率：</p><p>p ( x b g t | X ; Φ ) = exp { x b g t F ( x b g t , Φ ) } 1 + exp { F ( x b g t , Φ ) } F ( x b g t , Φ ) = γ + β 1 ∑ b ′ ≠ b ( 2 x b ′ g t − 1 ) + β 2 { I t ≠ 1 [ 2 x b g ( t − 1 ) − 1 ] + I t ≠ T [ 2 x b g ( t + 1 ) − 1 ] } 2-(2)</p><p>其中 β 1 为捕获空间依赖性的参数， β 2 为捕获时间间依赖性的参数。</p><p>接下来，我们考虑先验分布 p ( S ) 的MRF模型，同时考虑了时间依赖性和空间相似性。我们将3个区域分成两组：用 B p 表示胰腺区域， B n 非胰腺区域。联合概率类似于2-(1)，可以计算条件概率并具有以下形式：</p><p>p ( s b g t | S / s b g t ; Φ D E ) = exp { s b g t F D E ( s b g t , Φ D E ) } 1 + exp { F D E ( s b g t , Φ D E ) } 2-(3)</p><p>如果 b ∈ B p ：</p><p>F D E ( s b g t , Φ D E ) = γ D E + β p p ∑ b ′ ∈ B n / b ( 2 s b ′ g t − 1 ) + β p n ∑ b ′ ∈ B n ( 2 s b ′ g t − 1 ) + β t { I t ≠ 1 [ 2 s b g ( t − 1 ) − 1 ] + I t ≠ T [ 2 s b g ( t + 1 ) − 1 ] }</p><p>如果 b ∈ B n ：</p><p>F D E ( s b g t , Φ D E ) = γ D E + β n n ∑ b ′ ∈ B n / b ( 2 s b ′ g t − 1 ) + β n p ∑ b ′ ∈ B p ( 2 s b ′ g t − 1 ) + β t { I t ≠ 1 [ 2 s b g ( t − 1 ) − 1 ] + I t ≠ T [ 2 s b g ( t + 1 ) − 1 ] } .</p><p>其中 Φ D E = ( β p p , β n n , β p n , β n p ) ， β p p 为胰腺区之间的空间系数， β n n 为非胰腺区之间的空间系数， β p n 为胰腺区到非胰腺区之间的空间系数， β n p 为非胰腺区到胰腺区之间的空间系数，由对称性可得， β p n = β n p 。</p></sec></sec><sec id="s7"><title>3. 参数估计与后验概率估计</title><sec id="s7_1"><title>3.1. 参数估计</title><sec id="s7_1_1"><title>3.1.1. p(X)的参数估计算法</title><p>估计MRF参数 Φ = ( γ 1 , β 1 , β 2 ) 和高斯混合模型参数 Θ = ( μ 1 , σ 1 ; μ 2 , σ 2 ) ：</p><p>如果给定数组X， Φ ， Θ ,可以通过最大似然估计(MLE)进行估计。但是，潜伏状态X是未观察到的，因此也需要进行估计。通常针对缺失数据估计实施期望最大化(EM)算法，但由于期望项难以控制，因此不适用于我们的模型。因此，我们提出以下MCEM算法 [<xref ref-type="bibr" rid="hanspub.43820-ref11">11</xref>] 来估计：</p><p>1) 通过无偏估计量估计 σ 0 ：</p><p>σ ^ 0 2 1 G &#215; ∑ b = 1 B ∑ t = 1 T ( n b t − 1 ) ∑ g = 1 G ∑ b = 1 B ∑ t = 1 T ∑ k = 1 n b t ( y b g t k − y &#175; b g t ) 2</p><p>2) 在不考虑空间和时间依赖性的情况下，通过简单的高斯混合模型获得初始估计值 X ^ 和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x109_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>3) 因为没有针对<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x110_hanspub.png" xlink:type="simple"/></inline-formula>的显式MLE，所以选择初始估计<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x111_hanspub.png" xlink:type="simple"/></inline-formula>，将该估计将最大化得到以下伪似然函数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x112_hanspub.png" xlink:type="simple"/></inline-formula>(Besag [<xref ref-type="bibr" rid="hanspub.43820-ref12">12</xref>] )：</p><disp-formula id="hanspub.43820-formula3"><graphic xlink:href="//html.hanspub.org/file/10-2621714x113_hanspub.png"  xlink:type="simple"/></disp-formula><p>4) 令<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x114_hanspub.png" xlink:type="simple"/></inline-formula>，EM算法中预期的完整数据对数似然可通过蒙特卡罗方法(Wei and Tanner [<xref ref-type="bibr" rid="hanspub.43820-ref11">11</xref>] )进行近似：</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x115_hanspub.png" xlink:type="simple"/></inline-formula>3-(1)</p><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x116_hanspub.png" xlink:type="simple"/></inline-formula>通过吉布斯采样获得。从<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x117_hanspub.png" xlink:type="simple"/></inline-formula>到，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x118_hanspub.png" xlink:type="simple"/></inline-formula>中的所有条目都被下列公式按顺序更新，</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x119_hanspub.png" xlink:type="simple"/></inline-formula> 3-(2)</p><p>5) 用<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x120_hanspub.png" xlink:type="simple"/></inline-formula>更新，使3-(1)最大化：</p><disp-formula id="hanspub.43820-formula4"><graphic xlink:href="//html.hanspub.org/file/10-2621714x121_hanspub.png"  xlink:type="simple"/></disp-formula><p>与步骤3相同，我们用<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x122_hanspub.png" xlink:type="simple"/></inline-formula>中的伪似然函数替换似然函数。包含<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x123_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x124_hanspub.png" xlink:type="simple"/></inline-formula>的项是可分离的，因此可以分别进行优化。</p><p>6) 重复步骤4，步骤5，直至收敛。</p></sec><sec id="s7_1_2"><title>3.1.2. p(S)的参数估计算法</title><p>为了随着时间的推移识别DE基因。在该模型中，只需要迭代地更新MRF先验中的参数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x125_hanspub.png" xlink:type="simple"/></inline-formula>。该算法与上面的算法有一些相似之处：</p><p>1) 汇总Z中的<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x126_hanspub.png" xlink:type="simple"/></inline-formula>并通过locfdr程序估算<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x127_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>2) 不考虑空间和时间依赖性的情况下，通过简单的混合模型获得初始估<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x128_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>3) 获得初始估计<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x129_hanspub.png" xlink:type="simple"/></inline-formula>，其最大化的伪似然函数：</p><disp-formula id="hanspub.43820-formula5"><graphic xlink:href="//html.hanspub.org/file/10-2621714x130_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x131_hanspub.png" xlink:type="simple"/></inline-formula>如2-(3)所定义。</p><p>4) 通过蒙特卡罗近似估计预期的完整数据对数似然：</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x132_hanspub.png" xlink:type="simple"/></inline-formula> 3-(3)</p><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x133_hanspub.png" xlink:type="simple"/></inline-formula>由Gibbs采样获得，从<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x134_hanspub.png" xlink:type="simple"/></inline-formula>到<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x135_hanspub.png" xlink:type="simple"/></inline-formula>中的所有条目都下列公式被按顺序更新。</p><p><inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x136_hanspub.png" xlink:type="simple"/></inline-formula>3-(4)</p><p>5) 通过<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x137_hanspub.png" xlink:type="simple"/></inline-formula>更新<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x138_hanspub.png" xlink:type="simple"/></inline-formula>，直至得到最大化3-(3)。</p><p>6) 重复步骤4，步骤5，直至收敛。</p></sec></sec><sec id="s7_2"><title>3.2. 后验概率估计</title><p>为了获得后验概率的估计，我们实现了一个单独的Gibbs采样，并通过MCEM算法估计模型参数。潜在状态根据3-(2)和3-(4)依次更新，关于对DE基因的推断，我们采用基于后验概率的FDR定义(Newton</p><p>et al. [<xref ref-type="bibr" rid="hanspub.43820-ref13">13</xref>]；Li，Wei and Maris [<xref ref-type="bibr" rid="hanspub.43820-ref14">14</xref>] )。局部后验f.d.r<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x139_hanspub.png" xlink:type="simple"/></inline-formula>由Gibbs采样估计得来。<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x140_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x141_hanspub.png" xlink:type="simple"/></inline-formula>的升序排序值。让<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x142_hanspub.png" xlink:type="simple"/></inline-formula>，然后我们拒绝所有零假设<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x143_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x144_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec></sec><sec id="s8"><title>4. 仿真模拟与实例分析</title><sec id="s8_1"><title>4.1. 仿真模拟</title><p>为了评估我们提出的MRF模型的性能本节进行了仿真模拟。在模拟中通过3轮重复次数生成了在3个区域，3个时间点的500个基因的数据。我们考虑了两种模拟设置模拟的：</p><p>模拟设置1：用Gibbs采样器模拟潜状态阵列。采样器从一个可能是EE或DE随机数组开始，在每一轮吉布斯抽样中，每个潜在状态都根据3-(7)顺序更新一次。我们进行了三轮吉布斯抽样，以获得潜在的状态数组S。参数为：<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x145_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x146_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x147_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x148_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x149_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>模拟设置2：在时间点1中，所有基因的死亡概率均为0.1。隐马尔可夫状态随时间模型改变：如果一个基因在t−1时刻为DE，t时刻变成EE概率为0.5；为了保持DE基因的数量不变，我们随机选择相同数量的EE基因在t时刻切换到DE。三层的潜在状态最初设置是相同的。然后随机选择DE状态的不同比例(0.1、0.2、0.5)切换为EE；相同数量的EE状态也切换为DE，以保持DE基因总数不变。</p><p>我们在敏感性、特异性和FDR这三个方面比较了这两个模型(见表1)。对于MRF和EB模型，我们选择了<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x150_hanspub.png" xlink:type="simple"/></inline-formula>，满足<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x151_hanspub.png" xlink:type="simple"/></inline-formula>，控制FDR小于0.05，与EB相比，我们的方法(MRF)了更高的灵敏度。而当相似度降低时，即，从HMM(0.1)到HMM(0.5)，FDR在我们的模型中略有增加，但在EB模型中并没有完全增加。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Comparison between MRF model and EB mode</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Simulation</th><th align="center" valign="middle" >Model</th><th align="center" valign="middle" >Sensitivity</th><th align="center" valign="middle" >Specificity</th><th align="center" valign="middle" >FDR</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >MRF</td><td align="center" valign="middle" >MRF</td><td align="center" valign="middle" >0.654(0.031)</td><td align="center" valign="middle" >0.997(0.001)</td><td align="center" valign="middle" >0.035(0.012)</td></tr><tr><td align="center" valign="middle" >EB</td><td align="center" valign="middle" >0.500(0.035)</td><td align="center" valign="middle" >0.998(0.001)</td><td align="center" valign="middle" >0.037(0.011)</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >HMM(0.1)</td><td align="center" valign="middle" >MRF</td><td align="center" valign="middle" >0.698(0.042)</td><td align="center" valign="middle" >0.998(0.001)</td><td align="center" valign="middle" >0.037(0.011)</td></tr><tr><td align="center" valign="middle" >EB</td><td align="center" valign="middle" >0.498(0.051)</td><td align="center" valign="middle" >0.998(0.001)</td><td align="center" valign="middle" >0.035(0.010)</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >HMM(0.2)</td><td align="center" valign="middle" >MRF</td><td align="center" valign="middle" >0.628(0.040)</td><td align="center" valign="middle" >0.997(0.001)</td><td align="center" valign="middle" >0.037(0.011)</td></tr><tr><td align="center" valign="middle" >EB</td><td align="center" valign="middle" >0.496(0.045)</td><td align="center" valign="middle" >0.998(0.001)</td><td align="center" valign="middle" >0.035(0.010)</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >HMM(0.5)</td><td align="center" valign="middle" >MRF</td><td align="center" valign="middle" >0.535(0.036)</td><td align="center" valign="middle" >0.997(0.001)</td><td align="center" valign="middle" >0.049(0.013)</td></tr><tr><td align="center" valign="middle" >EB</td><td align="center" valign="middle" >0.511(0.037)</td><td align="center" valign="middle" >0.998(0.001)</td><td align="center" valign="middle" >0.038(0.010)</td></tr></tbody></table></table-wrap><p>表1. MRF与EB的比较</p></sec><sec id="s8_2"><title>4.2. 实例分析</title><p>本文数据来自小鼠标本的组织特异性表达数据数据集，编号为GSE77943。</p><p>我们应用MRF模型来识别相邻时期之间的DE基因。运行20次MCEM算法的迭代，Gibbs采样器的设置为500/1500，估计的MRF参数为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x152_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x153_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x154_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x155_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x156_hanspub.png" xlink:type="simple"/></inline-formula>。胰腺与非胰腺区域系数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x157_hanspub.png" xlink:type="simple"/></inline-formula>远小于胰腺与胰腺<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x158_hanspub.png" xlink:type="simple"/></inline-formula>和非胰腺与非胰腺系数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2621714x159_hanspub.png" xlink:type="simple"/></inline-formula>，表明胰腺与非胰腺区域之间的组间差异。当假设没有空间和时间依赖性时，模型简化为简单的经验贝叶斯(EB)模型，基于局部FDR控制程序，MRF和EB模型中的阈值分别为0.46和0.32。在两个模型中被鉴定为DE的基因数量是30,605 (MRF)和13,273 (EB)，其中11,149 (84%)重叠。较高的阈值导致在MRF模型中识别为DE的更多基因。</p><p>后验概率对超参数的选择敏感，我们通过改变后局部FDR的阈值来计算灵敏度和特异性，我们将本文提出的MRF模型与EB模型进行了比较，该模型假设没有时间和空间依赖性。对于两组分别绘制ROC曲线如图1所示，与EB模型相比，MRF模型AUC面积更大，MRF模型的性能更好，MRF模型从空间相似性中获益更多。</p><p>图1. EB与MRF模型的ROC曲线</p></sec></sec><sec id="s9"><title>5. 结论</title><p>图形模型在基因表达数据的分析中应用广泛，基于基因表达数据的图形模型可以为可视化基因之间的关系和生成生物假设提供一个有用的工具，我们对图形模型之间的差异很感兴趣。在本文中，我们使用了一种贝叶斯邻域选择程序来估计高斯图形模型，结合了马尔可夫随机场来合并具有时空结构的数据。仿真研究和实例分析表明，将复杂的数据结构合并到联合建模框架中有助于估计，与常用的高斯混合模型相比，该模型具有灵敏度更高，能识别更多的DE基因。</p></sec><sec id="s10"><title>文章引用</title><p>田雪寒,王艺舒. 基于马尔科夫随机场对二型糖尿病早期诊断A Markov Random Field-Based Approach for Early Diagnosis of Type 2 Diabetes[J]. 应用数学进展, 2021, 10(07): 2339-2347. https://doi.org/10.12677/AAM.2021.107244</p></sec><sec id="s11"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.43820-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Dempster, A.P. (1972) Covariance Selection. Biometrics, 28, 157-175. &lt;br&gt;https://doi.org/10.2307/2528966</mixed-citation></ref><ref id="hanspub.43820-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Meinshausen, N. and Bühlmann, P. (2006) High-Dimensional Graphs and Variable Selection with the Lasso. Annals of Statistics, 34, 1436-1462. &lt;br&gt;https://doi.org/10.1214/009053606000000281</mixed-citation></ref><ref id="hanspub.43820-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Yuan, M. and Lin, Y. (2007) Model Selection and Estimation in the Gaussian Graphical Model. Biometrika, 94, 19-35.  
&lt;br&gt;https://doi.org/10.1093/biomet/asm018</mixed-citation></ref><ref id="hanspub.43820-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Friedman, J., Hastie, T. and Tibshirani, R. (2008) Sparse Inverse Covariance Estimation with the Graphical Lasso. Biostatistics, 9, 432-441. &lt;br&gt;https://doi.org/10.1093/biostatistics/kxm045</mixed-citation></ref><ref id="hanspub.43820-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Cai, T., Liu, W. and Luo, X. (2011) A Constrained ℓ1 Minimization Approach to Sparse Precision Matrix Estimation. Journal of the American Statistical Association, 106, 594-607. &lt;br&gt;https://doi.org/10.1198/jasa.2011.tm10155</mixed-citation></ref><ref id="hanspub.43820-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Dobra, A., Lenkoski, A. and Rodriguez, A. (2011) Bayesian Inference for General Gaussian Graphical Models with Application to Multivariate Lattice Data. Journal of the American Statistical Association, 106, 1418-1433.  
&lt;br&gt;https://doi.org/10.1198/jasa.2011.tm10465</mixed-citation></ref><ref id="hanspub.43820-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Wang, H. (2012) Bayesian Graphical Lasso Models and Efficient Posterior Computation. Bayesian Analysis, 7, 867-886.  
&lt;br&gt;https://doi.org/10.1214/12-BA729</mixed-citation></ref><ref id="hanspub.43820-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Efron, B. (2004) Large-Scale Simultaneous Hypothesis Testing: The Choice of a Null Hypothesis. Journal of the American Statistical Association, 99, 96-104. &lt;br&gt;https://doi.org/10.1198/016214504000000089</mixed-citation></ref><ref id="hanspub.43820-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Besag, J. (1986) On the Statistical Analysis of Dirty Pictures. Journal of the Royal Statistical Society: Series B (Methodological), 48, 259-279. &lt;br&gt;https://doi.org/10.1111/j.2517-6161.1986.tb01412.x</mixed-citation></ref><ref id="hanspub.43820-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Lin, Z., Sanders, S.J., Li, M., et al. (2015) A Markov Random Field-Based Approach to Characterizing Human Brain Development Using Spatial-Temporal Transcriptome Data. The Annals of Applied Statistics, 9, 429-451.  
&lt;br&gt;https://doi.org/10.1214/14-AOAS802</mixed-citation></ref><ref id="hanspub.43820-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Wei, G.C.G. and Tanner, M.A. (1990) A Monte Carlo Implementation of the EM Algorithm and the Poor Man’s Data Augmentation Algorithms. Journal of the American Statistical Association, 85, 699-704.  
&lt;br&gt;https://doi.org/10.1080/01621459.1990.10474930</mixed-citation></ref><ref id="hanspub.43820-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Besag, J. (1974) Spatial Interaction and the Statistical Analysis of Lattice Systems. Journal of the Royal Statistical Society: Series B (Methodological), 36, 192-225. &lt;br&gt;https://doi.org/10.1111/j.2517-6161.1974.tb00999.x</mixed-citation></ref><ref id="hanspub.43820-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Newton, M.A., Kendziorski, C.M., Richmond, C.S., et al. (2001) On Differential Variability of Expression Ratios: Improving Statistical Inference about Gene Expression Changes from Microarray Data. Journal of Computational Biology, 8, 37-52. &lt;br&gt;https://doi.org/10.1089/106652701300099074</mixed-citation></ref><ref id="hanspub.43820-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Li, H., Wei, Z. and Maris, J. (2010) A Hidden Markov Random Field Model for Genome-Wide Association Studies. Biostatistics, 11, 139-150. &lt;br&gt;https://doi.org/10.1093/biostatistics/kxp043</mixed-citation></ref></ref-list></back></article>