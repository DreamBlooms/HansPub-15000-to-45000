<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">GST</journal-id><journal-title-group><journal-title>Geomatics Science and Technology</journal-title></journal-title-group><issn pub-type="epub">2329-549X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/GST.2018.62015</article-id><article-id pub-id-type="publisher-id">GST-24702</article-id><article-categories><subj-group subj-group-type="heading"><subject>GST20180200000_44512911.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  OSM辅助的车载激光点云道路三维矢量边界提取
  OSM-Assisted Extraction of 3D Vector Boundary from Mobile Laser Scanning Point Cloud
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>韩</surname><given-names>婷</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>必胜</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>袁</surname><given-names>鹏飞</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>梁</surname><given-names>福逊</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>武汉大学测绘遥感信息工程国家重点实验室，湖北 武汉</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>hanting@whu.edu.cn(韩婷)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>08</day><month>02</month><year>2018</year></pub-date><volume>06</volume><issue>02</issue><fpage>128</fpage><lpage>140</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   高精度的三维道路信息在智能交通、城市规划与管理等领域具有重要的作用。车载激光点云数据包含了道路及其周围地物的三维信息，但存在数据量大、场景复杂和地物遮挡等问题，为道路边界信息的准确提取带来挑战。OpenStreetMap (OSM)作为一种众源数据，提供了基础道路信息。本文提出一种基于OSM数据辅助，从车载激光点云数据中提取道路三维边界的方法。首先分析车载点云的空间分布特征，构建车载点云特征图，然后以OSM数据作为初始位置，通过改进的活动轮廓模型算法进行道路边界提取，得到三维矢量道路边界。本文采用StreetMapper数据进行实验，结果表明，本文提出的算法能够修复点云缺损导致的边界信息缺失，准确且完整的提取道路三维边界信息，具有较强的稳健性和适用性。 High-precision 3D road information plays an important role in intelligent transportation, urban planning and management. The mobile laser scanning system can quickly obtain the 3D informa-tion of the street scene, but it is difficult to directly extract the complete and accurate road boun-dary from the original point cloud due to the large amount of data, occlusion and complicated urban street scenes. OpenStreetMap is a kind of crowd source geographic data. It can be used to assist road extraction of mobile laser point clouds. This paper proposes a road 3D boundary extraction algorithm that integrates two-dimensional vector data OpenStreetMap and vehicle-borne laser point cloud data. Firstly, the point cloud feature map is constructed by analyzing the spatial distribution characteristics of the Scanning points. The OSM provides the initial position, and then the road boundary extraction is performed on the feature map of the point cloud by the improved active contour model. We use StreetMapper data to carry out experiments. The results show that the proposed algorithm can repair the lack of boundary information caused by point cloud defects, and accurately and completely extract road three-dimensional boundary information, which proves strong robustness and applicability. 
  
 
</p></abstract><kwd-group><kwd>OpenStreetMap，车载激光点云，道路边界提取，点云特征图，活动轮廓模型, OpenStreetMap</kwd><kwd> Mobile Laser Scanning Point Clouds</kwd><kwd> Road Boundary Extraction</kwd><kwd> Feature Image</kwd><kwd> Active Contour Model</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>OSM辅助的车载激光点云道路三维矢量 边界提取<sup> </sup></title><p>韩婷，杨必胜，袁鹏飞，梁福逊</p><p>武汉大学测绘遥感信息工程国家重点实验室，湖北 武汉</p><p><img src="//html.hanspub.org/file/10-2840174x1_hanspub.png" /></p><p>收稿日期：2018年4月12日；录用日期：2018年4月21日；发布日期：2018年4月28日</p><disp-formula id="hanspub.24702-formula5"><graphic xlink:href="//html.hanspub.org/file/10-2840174x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>高精度的三维道路信息在智能交通、城市规划与管理等领域具有重要的作用。车载激光点云数据包含了道路及其周围地物的三维信息，但存在数据量大、场景复杂和地物遮挡等问题，为道路边界信息的准确提取带来挑战。OpenStreetMap (OSM)作为一种众源数据，提供了基础道路信息。本文提出一种基于OSM数据辅助，从车载激光点云数据中提取道路三维边界的方法。首先分析车载点云的空间分布特征，构建车载点云特征图，然后以OSM数据作为初始位置，通过改进的活动轮廓模型算法进行道路边界提取，得到三维矢量道路边界。本文采用StreetMapper数据进行实验，结果表明，本文提出的算法能够修复点云缺损导致的边界信息缺失，准确且完整的提取道路三维边界信息，具有较强的稳健性和适用性。</p><p>关键词 :OpenStreetMap，车载激光点云，道路边界提取，点云特征图，活动轮廓模型</p><disp-formula id="hanspub.24702-formula6"><graphic xlink:href="//html.hanspub.org/file/10-2840174x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/10-2840174x7_hanspub.png" /> <img src="//html.hanspub.org/file/10-2840174x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>空间信息技术正在向着三维化发展，激光雷达扫描系统能够快速准确的获取高精度的三维空间信息。从LiDAR点云中提取高精度的三维道路信息在城市规划、3D导航和智慧城市等领域具有重要作用。但是车载激光雷达点云具有密度分布不均匀，数据量大，数据不完整和场景复杂等缺陷，从而影响的道路提取的完整性和正确性。</p><p>目前存在的车载激光点云道路提取算法，可分为四大类。第一类是基于扫描线的道路信息提取 [<xref ref-type="bibr" rid="hanspub.24702-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref5">5</xref>] ，这类算法将每条扫描线近似看作道路的一个横截面，利用相邻扫描线的空间相似性进行提取。方莉娜 [<xref ref-type="bibr" rid="hanspub.24702-ref1">1</xref>] 基于移动窗口滤波法先提取地面点云，再根据扫描窗口内的高差、坡度、点密度的变化从地面点云中识别路坎点云，该方法依赖于大量经验阈值，且提取精度受到窗口大小影响。Guan [<xref ref-type="bibr" rid="hanspub.24702-ref2">2</xref>] 利用轨迹信息创建道路横截面点云段，从每段点云中提取主点形成一条伪扫描线，然后根据坡度，高差提取路坎点云，由于主点不能包含全部路坎点，此方法会造成路坎位置的偏差。Elberink [<xref ref-type="bibr" rid="hanspub.24702-ref3">3</xref>] 同样利用轨迹信息创建道路横截面数据，然后利用RANSAC算法检测路面两侧垂直面片最为路坎边界，此方法仅适用于垂直形态的路坎。这类基于扫描线的方法对于非线性的扫描仪，需要大量预处理来获取伪扫描线，降低了处理效率并且会造成精度损失。</p><p>第二类是基于聚类的道路信息提取 [<xref ref-type="bibr" rid="hanspub.24702-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref8">8</xref>] ，这类算法根据道路点具有相似的几何和强度特征，将具有相似特征的点通过聚类分析提取道路点。闫利 [<xref ref-type="bibr" rid="hanspub.24702-ref6">6</xref>] 提出一种基于法向量的模糊聚类方法进行道路提取。Ibrahim [<xref ref-type="bibr" rid="hanspub.24702-ref7">7</xref>] 先利用点密度阈值分割地面点，然后根据地面点的高程离散度、法向量、高程梯度等信息通过高斯滤波器提取道路边界。此方法需要大量人工经验阈值的选择。Zhou [<xref ref-type="bibr" rid="hanspub.24702-ref8">8</xref>] 通过检测高程差异进行路坎提取，然后利用KNN将路坎点聚类提取道路边界。此方法采用单一特征进行聚类分析的，导致后续需要进行大量优化工作。</p><p>第三类是基于机器学习的道路信息提取 [<xref ref-type="bibr" rid="hanspub.24702-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref10">10</xref>] ，这类算法利用机器学习算法通过人工选取一定的路坎与非路坎进行样本训练，实现路坎点云的提取。罗海峰 [<xref ref-type="bibr" rid="hanspub.24702-ref9">9</xref>] 先构建包含相对高程、法向量方向、多尺度高程差及多尺度高程方差的点云特征向量，然后采用SVM提取路坎点云，并对提取结果进行聚类去噪优化。杨必胜和刘缘 [<xref ref-type="bibr" rid="hanspub.24702-ref10">10</xref>] 提出BKD三维局部特征，该特征包含高斯核密度估计和二值化，然后利用随机森林分类器提取路坎和道路标线。这类方法需要进行大量样本训练，其通用性受到限制。</p><p>第四类是基于点云特征图像的道路信息提取 [<xref ref-type="bibr" rid="hanspub.24702-ref11">11</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref13">13</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref14">14</xref>] ，这类算法将点云数据投影到二维空间，将三维特征转化为二维平面特征，利用图像处理技术对道路进行识别提取。Jaakkolat [<xref ref-type="bibr" rid="hanspub.24702-ref11">11</xref>] 通过计算格网之间的点云高程差异生成高程梯度图，利用图像处理算子检测路坎位置。Boyko [<xref ref-type="bibr" rid="hanspub.24702-ref12">12</xref>] 提出了一种适用于大范围城市场景道路提取的方法，该方法利用点云高程特征和法向量特征形成特征图，然后利用活动轮廓模型算法检测出道路边缘位置，此方法仅适用于密度非常大的点云。此类方法的处理效率较高，因此本文采用此类方法，并在Boyko的方法上进行改进，提出一种效率更高且准确率更高的算法。</p><p>目前存在的算法，还存在以下问题，第一没能解决因遮挡、数据缺失、点密度分布差异等导致道路目标提取不完整或漏提取的问题，道路提取结果的正确度和完整度有待提高。其次目前方法多数集中在道路点云的分割，道路边界仍由无拓扑信息的点云构成，未能将这些点云转化成能够精确表达道路形状的三维矢量道路信息。最后还存在效率不高等问题。本文算法充分利用OSM的先验知识(位置、语义、拓扑等)，并改进活动轮廓模型算法，能够快速完整准确的提取出包括遮挡及数据缺失区域的道路边界，最终生成精确的具有语义和拓扑信息的三维矢量道路数据。</p></sec><sec id="s4"><title>2. 三维道路矢量边界提取方法</title><p>本文利用OSM辅助车载激光点云进行三维道路边界提取，首先利用OSM的连接关系对点云进行分段处理，对于每一段点云进行平面规则格网投影，通过分析格网内部点云的空间特征(高差、点云密度、到OSM距离)构建点云特征图像，然后利用改进的活动轮廓模型算法，改进的模型以梯度矢量流加上宽度约束作为外部能量，使其更加适用于道路提取，从而更加准确的提取道路边界。本文方法的具体流程如图1所示。</p><sec id="s4_1"><title>2.1. 数据预处理</title><sec id="s4_1_1"><title>2.1.1. 车载点云分段</title><p>车载激光扫描获取的点云的数据量大，需要分段处理。本文依据OSM的拓扑连接性对车载点云进行分段，即利用OSM的顶点及交叉点作为分割点。因为OSM的形状和道路形状近似，在道路形状较为复杂时需要分成多段简单的道路进行处理，OSM为了表示出道路的形状顶点随之增加，因此OSM的顶点是天然的分割点，并且提取完成之后再根据这些顶点进行拼接，有效的保证拓扑不变性。</p><p>首先把车载激光点云垂直投影到XOY平面，图2是投影后的点云与OSM的叠加显示图。对于由两个顶点构成的一段OSM，以之为对称中心线做Bounding box，考虑到OSM并不位于道路中心线，为了完整保留道路，所以矩形宽度值应设定为大于道路宽度，并且考虑到分段提取完成后重新连接需要保证段与段之间有一定的重合度，所以矩形的长度值应设定为大于OSM线段长度。根据OSM端点坐标可求得Bounding box四个顶点坐标，利用判断点是否在多边形内部算法PNPoly算法求出所有位于该Bounding box内部的点，即是对应于该段OSM的点云段。</p><p>图1. 道路点云提取流程</p><p>图2. 利用OSM连接关系对点云分段(蓝色折线是OSM，红色点是折线顶点，绿色矩形框是一段OSM对应的Bounding box)</p></sec><sec id="s4_1_2"><title>2.1.2. 建立局部坐标系与构建格网</title><p>对于每一段点云，以垂直于道路方向划分格网，此方式划分的格网的每一行可以看作道路横截面，这样就可以利用到道路横截面相邻格网关系这一特征。具体法是对于一段点云，对应的OSM的两个顶点分别为A和B，如图3，首先建立点云局部坐标系，以A为原点，以AB为y轴，垂直于AB方为x轴，根据已知的OSM顶点A和B的坐标求得该坐标系与原始坐标系XOY的旋转角度为θ，通过坐标转换公式(1)，将该段点云的所有点转换到新的局部坐标系xoy坐标系下。然后根据公式(2)进行格网划分，示意图如图4，x<sub>min</sub>, y<sub>min</sub>是该段点云在xoy坐标系下的最小值，GridSize表示格网分辨率的大小，可根据激光扫描仪的分辨率确定，i, j表示该LiDAR点(x, y)在格网中的行列号。</p><disp-formula id="hanspub.24702-formula7"><label>(1)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x11_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.24702-formula8"><label>(2)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x12_hanspub.png"  xlink:type="simple"/></disp-formula></sec></sec><sec id="s4_2"><title>2.2. 车载点云道路特征图构建</title><p>对于上述建立的格网，通过分析每个格网内部点云的空间特征以及相邻格网特征关系确定每个格网</p><p>图3. 建立局部坐标系</p><p>图4. 格网划分示意图</p><p>的属性，即确定特征图像每个像素灰度值 [<xref ref-type="bibr" rid="hanspub.24702-ref15">15</xref>] ，然后利用改进活动轮廓模型检测道路边缘。本文首先对点云进行格网滤波，然后利用点云高差特征和点云密度特征构建点云特征图。</p><p>为了去除路坎周围树木点云的影响，需要对车载激光点云进行高程滤波，去除非地面点。具体方法是首先分析单个格网，先认为每个格网中最低点为地面点，去除该格网内高程大于最低点一定阈值的非地面点，其次分析邻域格网，即判断该格网的最低点与邻域3 &#215; 3格网的最低点之高差，如果高差大于一定阈值或者邻域格网超过半数都为空格网，则判断该格网内所有点为非地面点。图5为了显示出整体滤波效果，将各段滤波结果合并显示，最终滤波结果如图5(c)。图5(b)的结果是没有经过OSM框选的全部点云数据的滤波结果，可以看到距离道路两边较远的范围仍有少量屋顶和树冠被错分为地面点(图中红色的点)，对于这种情况可以通过把所有点云拟合一个平面，根据点到平面的距离将这些噪声点去除。由于这些噪声都已经超出了OSM框选的最大范围之外，所以本文并无此类噪声点。</p><p>对于城市环境的道路，路坎是在道路边缘，垂直于路面且与路面有一定高程阶跃的一种结构 [<xref ref-type="bibr" rid="hanspub.24702-ref16">16</xref>] ，路坎的一侧是平坦的道路，另一侧是平坦的人行道。因此包含路坎点云的格网内点云高差应该在一定阈值范围之内，且大于左右两侧格网高差，用公式表达如下，</p><disp-formula id="hanspub.24702-formula9"><label>(3)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x15_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x16_hanspub.png" xlink:type="simple"/></inline-formula>表示第(i, j)个格网内的最高点与最低点的高程差值，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x17_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x18_hanspub.png" xlink:type="simple"/></inline-formula>表示路坎高度范围，具体范围可根据当地公路设计规范查询。</p><p>根据车载激光扫描仪的扫描原理和投影点密度理论 [<xref ref-type="bibr" rid="hanspub.24702-ref17">17</xref>] 可知，格网内点云密度DoPP (Density of Projecting Points)值与目标高度成正比，因此在路坎部分会出现局部点密集，即路坎所在格网的点密度应大于左右两侧格网的点密度。对于滤波后留下的围栏底部、建筑物底部以及车辆底部和路坎具有相似的高差特征且密度也大于左右格网，但建筑物和围栏以及车辆有一侧由于遮挡是几乎没有扫描点的，因此可以根据这特征设定一个格网最小点密度DoPP<sub>min</sub>来去除滤波后建筑物和围栏以及车辆，用公式表示如下，</p><p>图5. (a) 高程赋色的全部原始点云；(b) 各段点云格网滤波结果合并显示；(c) 各段OSM框选范围内的点云滤波结果合并显示</p><disp-formula id="hanspub.24702-formula10"><label>(4)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x22_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x23_hanspub.png" xlink:type="simple"/></inline-formula>表示第(i, j)个格网内扫描点个数，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x24_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x25_hanspub.png" xlink:type="simple"/></inline-formula>是格网(i, j)的左右格网内扫描点的个数，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x26_hanspub.png" xlink:type="simple"/></inline-formula>表示格网内点云密度最小值。</p><p>最后将满足高差和点云密度要求的格网灰度值设置为0，其余格网灰度值设置为255，得到的二值灰度特征图如图6所示，为了显示整体点云的特征图，将所有分段点云特征图拼接显示，注意实际操作中并不需要这样做。</p></sec><sec id="s4_3"><title>2.3. 改进活动轮廓模型进行车载点云特征图分割</title><p>活动轮廓(active contour model, snake)的概念最早由Kass提出 [<xref ref-type="bibr" rid="hanspub.24702-ref18">18</xref>] ，是指一个参数化表达的曲线在内外力的影响下演化到能量最小的对象边缘位置。若轮廓曲线snake的位置用参数表达为<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x27_hanspub.png" xlink:type="simple"/></inline-formula>, s表示归一化弧长，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x28_hanspub.png" xlink:type="simple"/></inline-formula>，则其能量函数表示成如下形式</p><disp-formula id="hanspub.24702-formula11"><label>(5)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>该能量函数由三个部分组成，第一部分E<sub>int</sub>表示内部能量，可写成如下形式</p><disp-formula id="hanspub.24702-formula12"><label>(6)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x30_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，α(s), β(s)是权重参数，第一项<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x31_hanspub.png" xlink:type="simple"/></inline-formula>是曲线的一阶导数，控制曲线的弹性，第二项<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x32_hanspub.png" xlink:type="simple"/></inline-formula>是曲线的二阶导数，控制曲线的刚性。第二部分E<sub>image</sub>表示图像力，能够把snake吸引到需要的特征区域，如需定位到图像中的边缘位置，则图像能量可写成如下形式</p><disp-formula id="hanspub.24702-formula13"><label>(7)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x33_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x34_hanspub.png" xlink:type="simple"/></inline-formula>表示图像梯度。第三部分E<sub>con</sub>表示用户自定义的一些限制力。E<sub>con</sub>和E<sub>image</sub>合称为外部能量E<sub>ext</sub>。snake在内部能量和外部能量的共同控制下，在能量函数(5)达到最小化时，snake收敛于目标边缘。</p><p>由kass提出的活动轮廓模型存在两个缺点，一是对初始位置敏感，需要依赖其他机制将Snake放置</p><p>图6. 各段点云特征图合并显示</p><p>在感兴趣的图像特征附近；二是由于Snake模型的非凸性，它有可能收敛到局部极值点，甚至发散。许多学者在此基础上改进传统的snake模型，Xu [<xref ref-type="bibr" rid="hanspub.24702-ref19">19</xref>] 提出的GVFsnake模型引入梯度矢量场<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x36_hanspub.png" xlink:type="simple"/></inline-formula>作为新的外力，通过最小化如下能量函数获取<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x37_hanspub.png" xlink:type="simple"/></inline-formula>，</p><disp-formula id="hanspub.24702-formula14"><label>(8)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x38_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中μ是权重系数，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x39_hanspub.png" xlink:type="simple"/></inline-formula>是从图像<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x40_hanspub.png" xlink:type="simple"/></inline-formula>中提取的边缘图像，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x41_hanspub.png" xlink:type="simple"/></inline-formula>表示边缘图像梯度，是指向目标边缘的梯度向量，在图像同特性区域<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x42_hanspub.png" xlink:type="simple"/></inline-formula>，因此仅使用<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x43_hanspub.png" xlink:type="simple"/></inline-formula>作为外力的传统snake模型导致仅在图像边缘区域具有捕获力。而通过最小化上式获取的梯度向量流<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x44_hanspub.png" xlink:type="simple"/></inline-formula>在图像同特性区域是缓慢变化的向量流，在图像边缘区域<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x45_hanspub.png" xlink:type="simple"/></inline-formula>，因此GVF snake扩大了传统snake的外力作用范围，加强了对目标凹轮廓边缘的吸引力，并且增加了初始snake曲线位置放置的灵活性。传统snake模型和GVF snake模型的内外力作用方式如图7和图8所示。</p><p>图7. 以图像梯度作为外力的snake模型</p><p>图8. 以GVF作为外力的snake模型</p><p>对于车载激光点云中的道路边界，在车辆遮挡区域和道路出入口无路坎特征，会造成的道路边界特征的缺失，导致道路边界提取不完整和不准确。如图7和图8中的道路右边界，在道路边界缺失的区域，由于缺乏外力的约束会导致snake在该部分的曲线提前结束收敛而造成道路边界提取的不准确。于是本文利用道路的宽度变化是非常缓慢的这特点对活动轮廓模型进行改进，在能量函数上加上宽度约束。文献 [<xref ref-type="bibr" rid="hanspub.24702-ref20">20</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref21">21</xref>] [<xref ref-type="bibr" rid="hanspub.24702-ref22">22</xref>] 的模型都加了宽度约束，但是这些模型必须具有准确的中心线位置作为初始snake，而本文中的OSM段并不是严格位于道路中心，因为OSM是车辆或行人的行驶轨迹，通常位于道路的靠左侧或者靠右侧。本文结合GVF作为外部能量，提出一种新模型，如图9所示，若用参数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x48_hanspub.png" xlink:type="simple"/></inline-formula>表示初始曲线V即OSM，<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x49_hanspub.png" xlink:type="simple"/></inline-formula>分别表示距离左右道路边界的距离，n(s)表示OSM的单位法向量,道路的左右边界线V<sub>L</sub>，V<sub>R</sub>可表示为</p><disp-formula id="hanspub.24702-formula15"><label>(10)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x50_hanspub.png"  xlink:type="simple"/></disp-formula><p>能量函数为</p><disp-formula id="hanspub.24702-formula16"><label>(11)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x51_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x52_hanspub.png" xlink:type="simple"/></inline-formula>表示三种能量的权重系数，其中<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x53_hanspub.png" xlink:type="simple"/></inline-formula>的定义和传统snake的定义相同。<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x54_hanspub.png" xlink:type="simple"/></inline-formula>的定义使用GVF snake中的梯度矢量流<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x55_hanspub.png" xlink:type="simple"/></inline-formula>作为左右边界的外力。为了更准确的效果，应将左右梯度向量投影到<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x56_hanspub.png" xlink:type="simple"/></inline-formula>方向</p><disp-formula id="hanspub.24702-formula17"><graphic xlink:href="//html.hanspub.org/file/10-2840174x57_hanspub.png"  xlink:type="simple"/></disp-formula><p>能量函数的最后一项是道路宽度约束，是<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x58_hanspub.png" xlink:type="simple"/></inline-formula>的一阶导数，所以最小化该项能保证道路宽度的平缓变化，防止snake在路坎缺失的区域提前结束收敛或者收敛于道路内外侧的噪声区域。</p><disp-formula id="hanspub.24702-formula18"><label>(12)</label><graphic position="anchor" xlink:href="//html.hanspub.org/file/10-2840174x59_hanspub.png"  xlink:type="simple"/></disp-formula><p>能量函数<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x60_hanspub.png" xlink:type="simple"/></inline-formula>的最小化是通过求解三个分别对应<inline-formula><inline-graphic xlink:href="//html.hanspub.org/file/10-2840174x61_hanspub.png" xlink:type="simple"/></inline-formula>的欧拉方程实现的，欧</p><p>图9. 模型的参数化表达。蓝色折线是OSM作为初始snake，红色点是折线顶点，V<sub>L</sub>和V<sub>R</sub>是道路左右边界</p><p>拉方程的求解和传统snake模型解法相似，需要引入一个步长参数γ和时间参数t进行差分迭代求解。算法步骤如下：</p><p>步骤1：用OSM初始化曲线V</p><p>步骤2：计算法向量n(s)</p><p>步骤3：根据宽度W<sub>L</sub>(s)，W<sub>R</sub>(s)和曲线法向量n(s)更新曲线V1和V2</p><p>步骤4：计算E<sub>int</sub>和E<sub>ext</sub>,更新V</p><p>步骤5：更新宽度W<sub>L</sub>(s)和W<sub>R</sub>(s)</p><p>步骤6：重复步骤2-5,直至满足迭代次数要求或达到精度要求。</p><p>图10是选取了一段具有代表性的道路进行分析说明，是一段点云完整的处理流程，10(a)一段原始的点云，可以看出该段点云路边停靠多辆车辆，并且有一个道路的出入口，这些地方的路坎特征被遮挡或者无路坎特征。图10(b)是该段点云格网滤波的结果。图10(c)是该段点云生成的特征图，图中的断裂区域对应于上述的车辆遮挡和出入口。图10(d)是用本文提出的改进活动轮廓模型算法提取的道路边缘，可以看出本文算法在无路坎特征区域依然能使曲线收敛于准确的道路边缘。</p></sec></sec><sec id="s5"><title>3. 结果与分析</title><sec id="s5_1"><title>3.1. 实验数据与参数</title><p>本实验采用Street Mapper 360 MLS系统采集的城市环境扫描数据，其扫描范围约118 m &#215; 110 m，扫描点的密度约为25~35 points/m，共7,116,542个数据点。数据中包含了大量的复杂城市地物，包括房屋，树木、草地、车辆以及电力线等，数据密度较大但有较多由于车辆造成的遮挡。</p><p>本文中使用的参数值列于表1中，其中能量函数所涉及的权重系数都使用常数。</p></sec><sec id="s5_2"><title>3.2. 实验结果</title><p>将分段提取得到的2D道路边界重新拼接形成完整的2D道路边界，如图11(a)中的蓝色边界，拼接时可以利用OSM的拓扑关系进行拓扑重构，如果两段OSM之间是邻接关系，则它们对应的左右边界也分别邻接，只需要找出对应的交点作为邻接点。由于在第一步分段的保证了段与段之间的重叠性，因此上段边界和下段边界之间有一定的重合性，则以他们的重合点作为公共交点进行连接，为了防止没有重叠点的情况，上段边界尾点和下段边界的首点之间距离小于一定阈值，则也进行连接。最后对2D的边界线矢量化并赋予高程值，将2D的边界线转化成3D的边界线，并将OSM的语义信息赋给该3D道路边界，</p><p>图10. (a) 含有车辆遮挡和道路出入口的点云段；(b) 滤波去除非地面点；(c) 对应点云特征图；(d) 边界提取结果，蓝色线是OSM，红色线是提取的边界</p><p>图11. (a) 二维道路边界转化成三维道路边界并将OSM的语义信息赋给三维道路边界，蓝色线表示二维道路边界，红色线表示三维道路边界；(b) 三维道路边界与点云叠加显示</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Summary of the parameters and their values used in our experiment</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >Parameter</th><th align="center" valign="middle" >Value</th><th align="center" valign="middle" >Parameter</th><th align="center" valign="middle" >Value</th><th align="center" valign="middle" >Parameter</th><th align="center" valign="middle" >Value</th></tr></thead><tr><td align="center" valign="middle" >Grid Size</td><td align="center" valign="middle" >0.1 m</td><td align="center" valign="middle" >Δh<sub>min</sub></td><td align="center" valign="middle" >0.1 m</td><td align="center" valign="middle" >Δh<sub>max</sub></td><td align="center" valign="middle" >0.2 m</td></tr><tr><td align="center" valign="middle" >Bounding Box Width</td><td align="center" valign="middle" >2 Road Width</td><td align="center" valign="middle" >DoPP<sub>min</sub></td><td align="center" valign="middle" >10 points/dm<sup>2</sup></td><td align="center" valign="middle" >α</td><td align="center" valign="middle" >0.01</td></tr><tr><td align="center" valign="middle" >β</td><td align="center" valign="middle" >100</td><td align="center" valign="middle" >κ</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >ω</td><td align="center" valign="middle" >10</td></tr><tr><td align="center" valign="middle" >ψ</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >γ</td><td align="center" valign="middle" >10 pixels</td><td align="center" valign="middle" ></td><td align="center" valign="middle" ></td></tr></tbody></table></table-wrap><p>表1. 本实验中所使用的参数值</p><p>得到的最终结果如图11，11(a)中蓝色线表示矢量化的2D边界，红色线是矢量化的3D边界，11(b)是3D矢量边界和点云的叠加显示效果。</p></sec><sec id="s5_3"><title>3.3. 对比与分析</title><p>本文软件开发环境是visual studio 2013，硬件开发环境是Intel Xeon E3处理器，3.0 GHz，16 G内存，四核cpu。在此软硬件开发环境下对上述数据进行实验最终耗时6 min，其中生成特征图耗时不到10 s，主要耗时在边缘提取部分，虽然改进活动轮廓模型耗时较长，但其提高了道路边缘提取的准确性，尤其在路坎被遮挡区域，如下图12是使用GVF模型和本文算法模型进行的对比实验，图(a)是使用GVF模型提取的边缘，可以看出在车辆遮挡的区域，特征图中此区域无边缘特征，因此缺乏外力约束，导致该部分曲线提前结束收敛造成边缘提取的不准确。而本文所提出的算法，在该区域由于宽度约束使其正确检测出道路边缘位置。</p></sec></sec><sec id="s6"><title>4. 结论与展望</title><p>本文提出了一种利用二维矢量数据OpenStreetMap辅助车载LiDAR点云进行道路三维边界提取的一种方法，本文算法解决了在路坎被车辆遮挡以及道路出入口的路坎缺失造成的道路边界不完整问题，提高了路坎提取的效率和准确率，并且把OSM数据丰富的语义信息、拓扑信息和LiDAR点云的高程信息相互融合，最终形成具有语义的准确的道路三维矢量边界信息，可直接用于基础地理信息数据的更新，也可应用于三维导航、智慧城市等。本文实验未涉及复杂道路的拓扑构建，但其处理方式和本文相同，</p><p>图12. (a) 用GVF模型提取的二维边界；(b) 对应三维道路边界与点云叠加显示；(c) 用本文提出算法提取的二维道路边界；(d) 对应三维道路边界与点云叠加显示</p><p>都是利用OSM的拓扑关系来判断其对应边界的拓扑关系。本文算法的精度部分依赖于OSM的精度，但是随着移动端GPS的发展，OSM的精度已经越来越高。</p><p>本文适用于提取复杂城市街道具有规则或不规则路坎形状的道路边缘，本文只用到了点云的高程信息，因此未来的一个工作方向可以利用点云的强度、颜色以及纹理信息，提高适用性，进行乡村环境无路坎特征的道路边缘提取。此外本文也可用于建筑物的提取，此时活动轮廓模型的约束力将不再是平行约束，而是适用于建筑物的约束条件。</p></sec><sec id="s7"><title>文章引用</title><p>韩 婷,杨必胜,袁鹏飞,梁福逊. OSM辅助的车载激光点云道路三维矢量边界提取 OSM-Assisted Extraction of 3D Vector Boundary from Mobile Laser Scanning Point Cloud[J]. 测绘科学技术, 2018, 06(02): 128-140. https://doi.org/10.12677/GST.2018.62015</p></sec><sec id="s8"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.24702-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Yang, B., Fang, L. and Li, J. (2013) Semi-Automated Extraction and Delineation of 3d Roads of Street Scene from Mobile Laser Scanning Point Clouds. ISPRS Journal of Photogrammetry &amp; Remote Sensing, 79, 80-93. 
https://doi.org/10.1016/j.isprsjprs.2013.01.016</mixed-citation></ref><ref id="hanspub.24702-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Guan, H., Li, J., Yu, Y., Wang, C., Chapman, M. and Yang, B. (2014) Using Mobile Laser Scanning Data for Automated Extraction of Road Markings. ISPRS Journal of Photogrammetry &amp; Remote Sensing, 87, 93-107. 
https://doi.org/10.1016/j.isprsjprs.2013.11.005</mixed-citation></ref><ref id="hanspub.24702-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Elhinney, C.M., Kumar, P., Cahalane, C. and McCarthy, T. (2010) Initial Results from European Road Safety Inspection (EURSI) Mobile Mapping Project. International Archives of Photogrammetry, Remote Sensing and Spatial Information Sciences, Vol. XXXVIII, Part 5: Commission V Symposium, Newcastle upon Tyne, UK, 440-445.</mixed-citation></ref><ref id="hanspub.24702-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Lin, Y. and Hyyppa, J. (2010) K-Segments-Based Geometric Modeling of VLS Scan Lines. IEEE Geoscience &amp; Re-mote Sensing Letters, 8, 93-97. https://doi.org/10.1109/LGRS.2010.2051940</mixed-citation></ref><ref id="hanspub.24702-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Wijesoma, W.S., Kodagoda, K.R.S. and Balasuriya, A.P. (2004) Road-Boundary Detection and Tracking Using Ladar Sensing. IEEE Transactions on Robotics &amp; Automation, 20, 456-464. https://doi.org/10.1109/TRA.2004.825269</mixed-citation></ref><ref id="hanspub.24702-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">闫利, 张毅. 基于法向量模糊聚类的道路面点云数据滤波[J]. 武汉大学学报(信息科学版), 2007, 32(12): 1119-1122.</mixed-citation></ref><ref id="hanspub.24702-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Ibrahim, S. and Lichti, D. (2012) Curb-Based Street Floor Extraction from Mobile Terrestrial Lidar Point Cloud. ISPRS, International Archives of the Photogrammetry, Remote Sensing and Spatial In-formation Sciences, XXXIX-B5, 193-198. https://doi.org/10.5194/isprsarchives-XXXIX-B5-193-2012</mixed-citation></ref><ref id="hanspub.24702-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Zhou, L. and Vosselman, G. (2012) Mapping Curbstones in Airborne and Mobile Laser Scanning Data. International Journal of Applied Earth Observations &amp; Geoinformation, 18, 293-304. https://doi.org/10.1016/j.jag.2012.01.024</mixed-citation></ref><ref id="hanspub.24702-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">罗海峰, 方莉娜, 陈崇成. 车载激光扫描数据路坎点云提取方法[J]. 地球信息科学学报, 2017, 19(7): 861-871.</mixed-citation></ref><ref id="hanspub.24702-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Yang, B., Liu, Y., Dong, Z., Liang, F., Li, B. and Peng, X. (2017) 3D Local Feature BKD to Extract Road Information from Mobile Laser Scanning Point Clouds. ISPRS Journal of Photogrammetry &amp; Remote Sensing, 130, 329-343. 
https://doi.org/10.1016/j.isprsjprs.2017.06.007</mixed-citation></ref><ref id="hanspub.24702-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Jaakkola, A., Hyyppä, J., Hyyppä, H. and Kukko, A. (2008) Retrieval Al-gorithms for Road Surface Modelling Using Laser-Based Mobile Mapping. Sensors, 8, 5238. https://doi.org/10.3390/s8095238</mixed-citation></ref><ref id="hanspub.24702-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Boyko, A. and Funkhouser, T. (2011) Extracting Roads from Dense Point Clouds in Large Scale Urban Environment. ISPRS Journal of Photogrammetry &amp; Remote Sensing, 66, S2-S12. https://doi.org/10.1016/j.isprsjprs.2011.09.009</mixed-citation></ref><ref id="hanspub.24702-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Kumar, P., Mcelhinney, C.P., Lewis, P. and Mccarthy, T. (2013) An Au-tomated Algorithm for Extracting Road Edges from Terrestrial Mobile Lidar Data. ISPRS Journal of Photogrammetry &amp; Remote Sensing, 85, 44-55.  
https://doi.org/10.1016/j.isprsjprs.2013.08.003</mixed-citation></ref><ref id="hanspub.24702-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Shi, W.Z. and Wu, F.F. (2008) Feature Extraction and Modeling of Urban Building from Vehicle-Borne Laser Scanning Data.</mixed-citation></ref><ref id="hanspub.24702-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">杨必胜, 魏征, 李清泉, 等. 面向车载激光扫描点云快速分类的点云特征图像生成方法[J]. 测绘学报, 2010, 39(5): 540-545.</mixed-citation></ref><ref id="hanspub.24702-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">方莉娜. 车载激光点云中道路环境几何特征识别[D]: [博士学位论文]. 武汉: 武汉大学, 2014.</mixed-citation></ref><ref id="hanspub.24702-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">史文中, 李必军, 李清泉. 基于投影点密度的车载激光扫描距离图像分割方法[J]. 测绘学报, 2005, 34(2): 95-100.</mixed-citation></ref><ref id="hanspub.24702-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Kass, M., Witkin, A. and Terzopoulos, D. (1988) Snakes: Active Contour Models. International Journal of Computer Vision, 1, 321-331. https://doi.org/10.1007/BF00133570</mixed-citation></ref><ref id="hanspub.24702-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Xu, C. and Prince, J.L. (1997) Gradient Vector Flow: A New External Force for Snakes. Conference on Computer Vision and Pattern Recognition, San Juan, 17-19 June 1997, 66.</mixed-citation></ref><ref id="hanspub.24702-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Rossant, F., Bloch, I., Ghorbel, I., et al. (2015) Parallel Double Snakes. Application to the Segmentation of Retinal Layers in 2D-OCT for Pathological Subjects. Pattern Recognition, 48, 3857-3870.  
https://doi.org/10.1016/j.patcog.2015.06.009</mixed-citation></ref><ref id="hanspub.24702-ref21"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Laptev, I., Mayer, H., Lindeberg, T., et al. (2000) Automatic Extraction of Roads from Aerial Images Based on Scale Space and Snakes. Machine Vision &amp; Applications, 12, 23-31. https://doi.org/10.1007/s001380050121</mixed-citation></ref><ref id="hanspub.24702-ref22"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">Fua, P. (1997) Model-Based Optimization: An Approach to Fast, Accurate, and Consistent Site Modeling from Imagery. In: Firschein, O. and Strat, T.M., Eds., RADIUS: Image Understanding for Intelligence Im-agery, Morgan Kaufmann, San Francisco, 903-908.</mixed-citation></ref></ref-list></back></article>