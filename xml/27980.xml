<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2018.712176</article-id><article-id pub-id-type="publisher-id">AAM-27980</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20181200000_15828297.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  分层MC在期权定价中的应用
  Application of Layered MC in Option Pricing
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>云烁</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>姜</surname><given-names>晴琼</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>贵州民族大学，数据科学与信息工程学院，贵州 贵阳</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>30</day><month>11</month><year>2018</year></pub-date><volume>07</volume><issue>12</issue><fpage>1511</fpage><lpage>1520</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    本文从理论上分析了利用分层MC抽样技术可以提高模拟的计算精度，以及推导了分层抽样方差缩减的效果(通过VRERS值或粗糙估计量方差的比较)，给出了分层MC模拟的具体算法；且根据推导发现分层概率加权方法、分层匹配样本方法与最优分层方法这三种方法中，最优分层方法方差缩减效果比分层匹配样本方法方差缩减效果好。并把所研究的成果应用于欧式看涨期权的定价之中，对于期权理论的研究和完善具有重要的基础作用。
    This paper enhances the calculation precision and operation efficiency of stratified sampling via analyzing stratified MC sample technique in theory, deduces the effect of stratified sampling in variance reduction techniques and provides idiographic arithmetic of stratified MC simulation. Finding in the three method of stratified probability weighted, stratified matched sampling and optimal stratified sampling after deducing, the optimal stratified sampling performs well in vari-ance reduction techniques. The results also are applied in the European call option. It plays to the basic key role to the theoretical researches and perfection of the option. 
  
 
</p></abstract><kwd-group><kwd>Monte-Carlo模拟，分层MC，方差缩减, Monte-Carlo Simulation</kwd><kwd> Hierarchical MC</kwd><kwd> Variance Reduction</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>分层MC在期权定价中的应用<sup> </sup></title><p>陈云烁，姜晴琼</p><p>贵州民族大学，数据科学与信息工程学院，贵州 贵阳</p><p><img src="//html.hanspub.org/file/6-2620788x1_hanspub.png" /></p><p>收稿日期：2018年11月16日；录用日期：2018年12月6日；发布日期：2018年12月13日</p><disp-formula id="hanspub.27980-formula51"><graphic xlink:href="//html.hanspub.org/file/6-2620788x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文从理论上分析了利用分层MC抽样技术可以提高模拟的计算精度，以及推导了分层抽样方差缩减的效果(通过VRER<sub>S</sub>值或粗糙估计量方差的比较)，给出了分层MC模拟的具体算法；且根据推导发现分层概率加权方法、分层匹配样本方法与最优分层方法这三种方法中，最优分层方法方差缩减效果比分层匹配样本方法方差缩减效果好。并把所研究的成果应用于欧式看涨期权的定价之中，对于期权理论的研究和完善具有重要的基础作用。</p><p>关键词 :Monte-Carlo模拟，分层MC，方差缩减</p><disp-formula id="hanspub.27980-formula52"><graphic xlink:href="//html.hanspub.org/file/6-2620788x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/6-2620788x7_hanspub.png" /> <img src="//html.hanspub.org/file/6-2620788x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>期权既是高效的风险对冲工具又是高效的投资工具，一直被投资者青睐。1973年著名学者Black与Scholes [<xref ref-type="bibr" rid="hanspub.27980-ref1">1</xref>] 基于一些假定的条件下开创性的推导出标准欧式期权定价的模型。国内外众多学者以及金融业界人士就期权定价问题开展了广泛的研究，但随着研究的深入人们发现只有在特定的条件下一些期权才具有解析解，期权都没有解析解或是解析解求解非常困难，如：美式期权、亚式期权等这类特殊的期权是没有解析解的。因此。在大多数的情形下，期权定价一般需要寻求数值解法；目前，期权定价的数值求解有：二叉树 [<xref ref-type="bibr" rid="hanspub.27980-ref2">2</xref>] 、二项式模型 [<xref ref-type="bibr" rid="hanspub.27980-ref3">3</xref>] 、有限差分法(隐式或显式)以及随机模拟 [<xref ref-type="bibr" rid="hanspub.27980-ref4">4</xref>] 等方法。尤其是其中的蒙特卡洛模拟法由于其具有良好的适用性引起人们特别的重视。尤其是在实际应用中，如多标的资产、复合基础资产、标的资产既带跳跃又有随机波动率的条件且期权模型又要考虑与标的资产路径相关 [<xref ref-type="bibr" rid="hanspub.27980-ref5">5</xref>] [<xref ref-type="bibr" rid="hanspub.27980-ref6">6</xref>] ，蒙特卡罗方法则可以大显身手。</p><p>但是蒙特卡罗模拟方法自身也有不足之处，就是模拟结果的精度、波动性等受到模拟的路径数量的重大影响 [<xref ref-type="bibr" rid="hanspub.27980-ref7">7</xref>] [<xref ref-type="bibr" rid="hanspub.27980-ref8">8</xref>] ，所以纵观蒙特卡罗模拟方法在金融衍生物定价的完善与发展主要体现在模拟估计误差减少技术与扩大其应用范围。模拟估计误差减少技术主要是针对模拟过程所产生的离散化误差与统计误差，离散化误差即由样本路径模拟过程所导致，而统计误差即由于有限样本及不同的抽样方法所引起的估计误差。其中，统计误差可以通过方差缩减技术来解决，离散化误差则通过采取有效的高阶收敛性的样本路径模拟的方式来逼近 [<xref ref-type="bibr" rid="hanspub.27980-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.27980-ref10">10</xref>] 。下文将重点介绍分层抽样法结合Monte-Carlo模拟，在提高模拟精度技术的数学原理基础上重点说明其在期权模拟定价上的使用，然后给出精确的模拟误差与精度值。</p></sec><sec id="s4"><title>2. 分层Monte-Carlo方法</title><sec id="s4_1"><title>2.1. 分层Monte-Carlo方法的产生</title><p>在我们以下的讨论模型中，均以欧式看涨期权</p><p>S ( T ) = S ( t ) exp { ( r − 1 2 σ 2 ) ( T − t ) + σ ( B ( T ) − B ( t ) ) }</p><p>为例，其中T风险价格到期日， S ( t ) 表示当前时刻风险资产价格， B ( T ) − B ( t ) ∼ N ( 0 , T − t ) ，r无风险利率， σ 为年波动率。对风险资产在T时刻的模拟常常借助下面的代码：</p><disp-formula id="hanspub.27980-formula53"><graphic xlink:href="//html.hanspub.org/file/6-2620788x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>该模拟显然是要借助正态随机数代码的，但是正态随机数的产生过程容易产生不均衡现象，也就是说：</p><disp-formula id="hanspub.27980-formula54"><graphic xlink:href="//html.hanspub.org/file/6-2620788x14_hanspub.png"  xlink:type="simple"/></disp-formula><p>通过上面的代码可以验证，在产生的10,000个标准正态随机数中，n1，n2的个数很难保证是1:1，有时差距还很大。</p><p>基于此，统计学家们构造出一种新的随机数产生方案，将密度函数分成有限个区间，然后在每个区间上按照各自的概率比重产生一定数量的随机数，最后用这些数进行Monte-Carlo模拟，该方法被称为分层Monte-Carlo方法(以下称为分层MC方法)，最终通过在每个小区间上的抽样来实现提高模拟精度这一目的。</p></sec><sec id="s4_2"><title>2.2. 分层抽样原理</title><p>分层抽样的原理是对所输入数据进行处理，使其更加规律，从而使经验概率与理论概率更加匹配(Glasserman和Gaussia [<xref ref-type="bibr" rid="hanspub.27980-ref11">11</xref>] )。下面通过一个简单的推导来说明分层抽样的性质。</p><p>假设拟估计：</p><p>Y = E [ f ( U ) ] = ∫ 0 1 f ( y ) d y = μ</p><p>其中 U ∼ U i n f [ 0 , 1 ] ，假设对样本分为两层，即：</p><p>Y S = 1 2 f ( V 1 ) + 1 2 f (V2)</p><p>其中</p><p>V 1 ∼ U n i f [ 0 , 1 2 ]                                                           V 2 ∼ U n i f [ 1 2 , 1 ]</p><p>现在比较变量Y的粗糙估计量 Y c r u d e 和分层抽样估计量 Y S 之间的关系：</p><p>Y ^ c r u d e = 1 n ∑ i = 1 n f ( μ i )                                                       Y ^ S = 1 n / 2 ∑ i = 1 n / 2 Y S i = 1 n [ ∑ i = 1 n / 2 ( f ( V 1 i ) + f ( V 2 i ) ) ] (1)</p><p>接下来(1)式期望和方差为：</p><p>E [ Y ^ S ] = 1 n [ ∑ i = 1 n / 2 f ( V 1 i ) + f ( V 2 i ) ] = ∫ 0 1 f ( y ) d y = μ (2)</p><p>V a r [ f ( V 1 i ) ] = ∫ 0 1 2 2 f 2 ( x ) d x − [ ∫ 0 1 2 2 f ( x ) d x ] 2 ≡ 2 ν 1 − 4 m 1 2 (3)</p><p>V a r [ f ( V 2 i ) ] = ∫ 1 2 1 2 f 2 ( x ) d x − [ ∫ 1 2 1 2 f ( x ) d x ] 2 ≡ 2 ν 2 − 4 m 2 2 (4)</p><p>其中</p><p>ν 1 = ∫ 0 1 2 f 2 ( x ) d x                                                                   m 1 = ∫ 0 1 2 f ( x ) d x ν 2 = ∫ 1 2 1 f 2 ( x ) d x                                                                     m 1 = ∫ 1 2 1 f ( x ) d x</p><p>根据公式(3)、(4)得：</p><p>V a r [ f ( V 1 i ) ] + V a r [ f ( V 2 i ) ] = 2 ( ν 1 + ν 2 ) − 4 ( m 1 2 + m 2 2 ) = 2 ( ν 1 + ν 2 ) − 2 ( m 1 + m 2 ) − 2 ( m 1 − m 2 ) 2 = 2 V a r ( f ) − 2 ( m 1 − m 2 ) 2 (5)</p><p>根据公式(1)、(5)，推导出公式(6)：</p><p>V a r [ Y ^ S ] = 1 n 2 [ ∑ i = 1 n / 2 V a r ( f ( V 1 i ) ) + V a r ( f ( V 2 i ) ) ] = 1 n [ V a r ( f ) − ( m 1 − m 2 ) 2 ] (6)</p><p>V a r [ Y ^ c r u d e ] = V a r ( f ) / n                                 V a r [ Y ^ c r u d e ] = V a r [ Y ^ S ] − ( m 1 + m 2 ) 2 / n (7)</p><p>整理公式(7)，得：</p><p>  V a r [ Y ^ S ] − V a r [ Y ^ c r u d e ] = ( m 1 + m 2 ) 2 / n (8)</p><p>假设</p><p>f ( U ) = e U                                                                                               n = 2 E [ f ( U ) ] = 1.718                                     V a r [ f ( U ) ] = 0.240</p><p>根据公式(6)、(7)计算，得：</p><p>Y ^ c r u d e = ( e u 1 + e u 2 ) / 2                                                             V a r [ Y c r u d e ] = 0.121 m 1 = 0.6487                                                                                                                             m 2 = 1.069 V a r [ Y ^ S ] = V a r [ Y ^ c r u d e ] − ( m 1 + m 2 ) 2 / n = 0.0375</p><p>则</p><p>V R E R S = 3.227</p><p>从方差缩减比率 V R E R S 的值可看出分层抽样方差缩减技术的效果比较明显。</p></sec></sec><sec id="s5"><title>3. 均匀分布与非均匀的分层</title><p>根据第1节我们了解当分层层数为 n = 2 的情形，方差缩减的大小为(8)式。接下来我们将研究当分层层数 n &gt; 2 的情形时均匀分布和非均匀分布分层抽样的估计量。方差缩减的大小在后面的章节给出证明。</p><sec id="s5_1"><title>3.1. 均匀分布的分层</title><p>假设把[0,1]分为n层，记第一层为 A 1 = [ 0 , 1 / n ) ，第二层为 A 2 = [ 1 / n , 2 / n ) ，依次类推， A n = [ ( n − 1 ) / n , 1 ) ，</p><p>在均匀分布的条件下，落在每一个小区间的概率为 1 n ，假设样本空间为n，定义如下：</p><p>V i = i − 1 + U i n ∼ U n i f [ i − 1 n , i n ]</p><p>其中 U i ∼ U n i f ( 0 , 1 ) , i = 1 , 2 , ⋯ , n 。因此 V i 为给定 U ∈ A i 时U的条件分布， V 1 , V 2 , ⋯ , V n 构成了(0,1)均匀分布的一个分层样本。如果 Y = f ( U ) ，则有 E [ f ( U ) ] 的分层抽样估计为：</p><p>Y S = 1 n ∑ i = 1 n f (Vi)</p></sec><sec id="s5_2"><title>3.2. 非均匀分布的分层</title><p>给定概率 p 1 , p 2 , ⋯ , p K ,       ∑ i = 1 K p i = 1 ，并定义K个分层分别为：</p><p>A 1 = ( a 0 , a 1 ) , A 2 = ( a 2 , a 3 ) , ⋯ , A K = ( a K − 1 , a K )</p><p>其中 a 0 = − ∞ , a 1 = F − 1 ( p 1 ) , a 2 = F − 1 ( p 1 + p 2 ) , ⋯ , a K = F − 1 ( p 1 + p 2 + ⋯ + p K ) ，F为概率分布函数。假设随机变量Y的概率分布函数为F，则有 P r ( Y ∈ A i ) = F ( a i ) − F ( a i − 1 ) = p i 。为了利用所产生的分层抽样 A 1 , A 2 , ⋯ , A K ，需要生成随机变量 Y | Y ∈ A i 的样本，利用逆变换方法可实现。假设 V = a i − 1 + U ( a i − a i − 1 ) ，则 F − 1 ( V ) 具有 Y | Y ∈ A i 分布。</p></sec></sec><sec id="s6"><title>4. 几种分层MC方法</title><sec id="s6_1"><title>4.1. 分层概率加权方法</title><p>考察欧式看涨期权定价问题。注意：</p><p>S ( T ) = S ( t ) exp { ( r − 1 2 σ 2 ) ( T − t ) + σ T − t ⋅ ε } (9)</p><p>其中 ε 服从标准正态分布，将随机变量 ε 的值域进行分层，划分为没有交集的K个区间 A 1 , A 2 , ⋯ , A K ，并用 p i 来表示标准正态随机变量落入每一个小区间 A i 的概率，即： P ( A i ) = p i , i = 1 , 2 , ⋯ , K 。</p><p>那么：</p><p>P r ( Y ∈ ∪ i = 1 K A i ) = 1 E [ Y ] = ∑ i = 1 K P r ( ε ∈ A i ) E [ Y | ε ∈ A i ] = ∑ i = 1 K P i E [ Y | ε ∈ A i ]</p><p>其中 Y = max { S ( T ) − K , 0 } ，最后生成 Y | ε ∈ A i 分布的样本。</p><p>在随机抽样时，产生的与 ε 同分布随机数落入区间 A i 的比例通常不等于 p i ，尽管产生的随机总数n增大时，它会趋于 p i 。在分层抽样中提前约定：从每层 A i 中提取一定数量的随机数，每个从 A i 提取的随机数，都被限制在条件 ε ∈ A i 的标准正态随机数。最后计算每一层上的条件期望，并把它们按照概率比重 p i 进行加权平均。按分层概率加权Monte-Carlo方法的计算步骤如下：</p><p>Step1：将随机数对应的总体X的值域进行K个区间划分 A 1 , A 2 , ⋯ , A K ，并计算落入每个区间的概率 p i ，即(直接对总体 max { S ( T ) − K , 0 } 分层即可)。</p><p>P ( A i ) = p i ,     i = 1 , 2 , ⋯ , K</p><p>Step2：给定第一层样本容量 n 1 (数量必须保证模拟精度)，产生的随机数 ε ，若 ε ∈ A i 则保留，否则重复产生随机数，直到达到容量 n 1 为止。这样我们就获取了第一层 A i 上的 n 1 个随机数。</p><p>ε 1 , 1 , ε 1 , 2 , ⋯ , ε 1 , n 1</p><p>Step3：利用第一层的 A i 上的 n 1 个随机数估计条件期望</p><p>E 1 = 1 n ∑ j = 1 n 1 Y 1 , j ,         j = 1 , 2 , ⋯ , n 1</p><p>其中 Y 1 , j = max { S 1 j − K , 0 } ， S 1 , j = S ( 0 ) exp { ( r − 1 2 σ 2 ) ( T − t ) + σ T − t ⋅ ε 1 , j }</p><p>Step4：重复步骤2和步骤3，估计其他分层的条件 E 2 , E 3 , ⋯ , E k ；</p><p>Step5：按照概率比重 p i 将 E i 加权平均，即可估计欧式看涨期权在t时刻的价格</p><p>c ^ = exp { − r ( T − t ) } ∑ i = 1 K p i n i ∑ j = 1 n 1 Y i , j (10)</p><p>为了节省计算机运行时间，同时兼顾精度的需求，通常按照概率比重设置分层的模拟次数，令</p><p>q i = n i / n ,     ∑ i = 1 K n i = n ,     i = 1 , 2 , ⋯ , K</p><p>由于 n i 必须取值非负整数，很难做到 q i 和 p i 完全一致，但当n足够大时， p i ≈ q i ，此时统计量可以改写为：</p><p>c ^ = exp { − r ( T − t ) } p i n q i ∑ i = 1 K ∑ j = 1 n 1 Y i , j (11)</p><p>则(11)式可改写成(12)式：</p><p>c ^ = exp { − r ( T − t ) } 1 n ∑ i = 1 K p i q i ∑ j = 1 n 1 Y i j (12)</p>分层概率加权的区间估计<p>现在我们讨论使用分层抽样对欧式看涨期权价格进行区间估计，假设样本数为n，分到每层的样本数为 n 1 , n 2 , ⋯ , n K ，且有 n 1 + n 2 + ⋯ + n K = n ， Y | ε ∈ A i 的样本值为 Y i , j , i = 1 , 2 , ⋯ , K ，有：</p><p>μ i = E [ Y i , j ] = E [ Y | ε ∈ A i ] σ i 2 = V a r [ Y i , j ] = V a r [ Y | ε ∈ A i ] μ = E [ Y ] = ∑ i = 1 K p i μ i</p><p>其中</p><p>Y i , j = max { S i , j − K , 0 }</p><p>无论是否按照比例设置分层样本容量，估计量 c ^ 是无偏，因为</p><p>E [ c ^ ] = exp { − r ( T − t ) } ∑ i = 1 K p i n i ∑ j = 1 n 1 μ i = exp { − r ( T − t ) } ∑ i = 1 K p i μ i = c</p><p>其中</p><p>c = exp { − r ( T − t ) } E [ max { S ( T ) − K , 0 } ]</p><p>E [ Y | ε ∈ A i ] 的无偏估计为：</p><p>Y i = ( ∑ j = 1 n i Y i , j ) / n i</p><p>则 E [ Y ] 的分层抽样估计为：</p><p>Y ^ S = ∑ i = 1 K p i Y i = ∑ i = 1 K p i 1 n i ∑ j = 1 n 1 Y i , j (13)</p><p>通过(13)可以计算出 E [ Y S ] = μ ，因此分层抽样估计 Y S 为 E [ Y ] 的无偏估计。分层抽样 Y S 的方差为：</p><p>V a r [ Y S ] = ∑ i = 1 K p i 2 V a r ( Y i ) = ∑ i = 1 K p i 2 V a r [ 1 n i ∑ j = 1 n i Y i , j ] = ∑ i = 1 K P i 2 σ i 2 n i (14)</p><p>对于每一层 A i ，样本 ε 1 , 1 , ε 1 , 2 , ⋯ , ε 1 , n 1 是独立同分布且均值为 μ i ，方差为 σ i 2 ，因此满足当 n → ∞ 时，</p><p>1 n q i ∑ j = 1 n q i ( Y i , j − μ i ) → d N ( 0 , σ i 2 ) (15)</p><p>其中 q 1 , q 2 , ⋯ , q K 固定，经中心化与规范化后的变量 n ( Y ^ − μ ) 可以写成</p><p>n ( c ^ − c ) = n exp { − r ( T − t ) } ∑ i = 1 K ( 1 n q i ∑ j = 1 n q i Y i , j − μ i ) (16)</p><p>整理之后我们有：</p><p>n ( c ^ − c ) = n exp { − r ( T − t ) } ∑ i = 1 K p i q i ( 1 n q i ∑ j = 1 n q i Y i j − μ i ) (17)</p><p>这表明 n ( c ^ − c ) 可渐进表示为独立同分布正态随机变量(均值为0，方差为 σ i 2 )的线性组合(系数为 exp { − r T } p i / q i )，因而当层级数量K固定、样本容量n足够大时</p><p>n ( c ^ − c ) ∼ N ( 0 , exp { − 2 r ( T − t ) } σ 2 ( q ) ) (18)</p><p>从而我们给出的显著水平 α 的置信区间</p><p>[ c ^ − z α / 2 exp { − 2 r ( T − t ) } σ ( q ) n , c ^ + z α / 2 exp { − 2 r ( T − t ) } σ ( q ) n ] (19)</p><p>在(18)与(19)实际应用中， σ 2 ( q ) 是未知的，但通常可以通过使用</p><p>s ( q ) = ∑ i = 1 K p i q i s i 2 (20)</p><p>通过(20)式来得到它的一致估计，其中 s i 2 为 max { S i , 1 − K , 0 } , ⋯ , max { S i , n 1 − K , 0 } 的修正样本标准差。</p><p>分层抽样的误差估计有两种方法：一种是直接方法，即利用 V a r [ Y S ] = ∑ i = 1 K p i 2 ( σ i 2 / n i ) 直接进行计算，其中 σ i 用其样本方差 s i 进行代替；另一种就是蒙特卡罗模拟方法，即直接模拟m个独立的分层抽样估计值，然后再计算这m个独立的分层估计值的标准差。</p></sec><sec id="s6_2"><title>4.2. 分层匹配样本方法</title><p>分层匹配样本方法也称为比例分层抽样法。分层概率加权Monte-Carlo方法需要在每一层上不停的产生足够数量的样本，虽然可以最大限度的提高模拟精度，但是在反复产生随机数的同时需要不停的舍去那些不符分层标准的随机数，这肯定延长计算机运行时间。</p><p>本节构造了另一种分层方案，注意区间 A 1 , A 2 , ⋯ , A k 是随机变量 ε 的值域的完整划分。这意味着对于总体 ε 的任何一个随机数 ε (仍用 ε 表示)，存在一个分层区间 A i ，使得：</p><p>ε ∈ A i , ε ∉ A j , i ≠ j , j = 1 , 2 , ⋯ , K</p><p>在比例分层抽样下， n i = n p i ，所以有：</p><p>Y ^ S = Y ^ S ∘ p r o p = ( ∑ i = 1 K ∑ j = 1 n i Y i j ) / n                                             V a r [ Y ^ S ∘ p r o p ] = ( ∑ i = 1 K p i σ i 2 ) / n (21)</p><p>另外 V a r ( Y ) 为：</p><p>V a r ( Y ) = E [ Y 2 ] − ( E [ Y ] ) 2 = ∑ i = 1 K p i E [ Y 2 | ε ∈ A i ] − μ 2 = ∑ i = 1 K p i ( σ i 2 + μ i 2 ) − μ 2 = ∑ i = 1 K p i σ i 2 − ∑ i = 1 K p i ( μ i − μ ) 2 / n (22)</p><p>则</p><p>V a r ( Y ^ c r u d e ) = V a r ( Y ) / n = V a r ( Y ^ S ∘ p r o p ) + ∑ i = 1 K p i ( μ i − μ ) 2 / n (23)</p><p>所以比例分层抽样的方差缩减效果为：</p><p>V a r ( Y ^ c r u d e ) − V a r ( Y ^ S ∘ p r o p ) = ∑ i = 1 K p i ( μ i − μ ) 2 / n (24)</p><p>分层匹配样本的Monte-Carlo方法步骤如下：</p><p>Step1：将随机数对应的总体X的值域进行K个区间划分 A 1 , A 2 , ⋯ , A K ，并计算落入每个区间的概率 p i ，即(直接对总体 max { S ( T ) − K , 0 } 分层即可)。</p><p>P ( A i ) = p i ,     i = 1 , 2 , ⋯ , K</p><p>Step2：产生一定量的样本(容量为n)，然后将他们匹配到分层 A 1 , A 2 , ⋯ , A K 去，假定第i个分层 A i 的样本为</p><p>ε i , 1 , ε i , 2 , ⋯ , ε i , n 1 , i = 1 , 2 , ⋯ , K</p><p>其中 n 1 + n 2 + ⋯ + n K = n</p><p>Step3：利用第i层的 A i 上的 n 1 个随机数估计条件期望</p><p>E i = 1 n i ∑ j = 1 n i Y i , j ,         j = 1 , 2 , ⋯ , n 1 , i = 1 , 2 , ⋯ , K</p><p>其中 Y i , j = max { S i , j − K , 0 } ， S i , j = S ( 0 ) exp { ( r − 1 2 σ 2 ) ( T − t ) + σ T − t ⋅ ε i , j }</p><p>Step4：按照概率比重 p i 将 E i 加权平均，即可估计欧式看涨期权在t时刻的价格</p><p>c = exp { − r ( T − t ) } ∑ i = 1 K p i μ i (25)</p></sec><sec id="s6_3"><title>4.3. 最优分层方法</title><p>在按比例匹配分层容量时，也就是在 n 1 + n 2 + ⋯ + n K = n 的条件下，求解 V a r [ Y S ] 的最小值， p i = q i 且方差参数 σ 2 ( q ) 化解为</p><p>∑ i = 1 K p i 2 q i σ i 2 = ∑ i = 1 K p i σ i 2 (26)</p><p>利用拉格朗日法求解(26)式最小值，假设：</p><p>L ( n 1 , n 2 , ⋯ , n K , λ ) = ∑ i = 1 K p i 2 σ i 2 n i + λ ( n 1 + n 2 + ⋯ + n K − n ) { ∂ L ∂ n i = − p i 2 σ i 2 n i 2 + λ = 0 ∂ L ∂ λ = n 1 + n 2 + ⋯ + n K − n = 0 ⇒ { n i = p i σ i λ n 1 + n 2 + ⋯ + n K = n ⇒ n i ∗ = n p i σ i ∑ i = 1 K p i σ i , i = 1 , 2 , ⋯ , K</p><p>换句话说，每个层级的最优分配与层标准差的乘积成正比，所以最优分层的方差为：</p><p>V a r ( Y ^ S ∘ o p t ) = ∑ i = 1 K p i n i * σ i 2 = σ &#175; 2 / n (27)</p><p>其中</p><p>σ &#175; = ∑ i = 1 K p i σ i</p><p>因为</p><p>∑ i = 1 K p i ( σ i − σ &#175; ) 2 = ∑ i = 1 K p i σ i 2 − σ &#175; 2</p><p>所以公式(26)可写成：</p><p>V a r ( Y ^ S ∘ o p t ) = [ ∑ i = 1 K p i σ i 2 − ∑ i = 1 K p i ( σ i − σ &#175; ) 2 ] / n (28)</p><p>则最优分层抽样的方差缩减效果为：</p><p>V a r ( Y ^ c r u d e ) − V a r ( Y ^ S ∘ o p t ) = ∑ i = 1 K p i ( μ i − μ ) 2 / n + ∑ i = 1 K p i ( σ i − σ &#175; ) 2 / n (29)</p><p>另外，最优分层抽样相对比例分层抽样的方差缩减效果为：</p><p>V a r ( Y ^ S ∘ p r o p ) − V a r ( Y ^ S ∘ o p t ) = ∑ i = 1 K p i ( σ i − σ &#175; ) 2 / n (30)</p>最优分层抽样方差的分解<p>假设用 Y | η 表示 Y | ε ∈ A i ，其中 i = 1 , 2 , ⋯ , K ，则有：</p><p>V a r ( Y ^ c r u d e ) = 1 n V a r [ E ( Y | η ) ] + 1 n E [ V a r ( Y | η ) ]</p><p>其中</p><p>V a r [ E ( Y | η ) ] = ∑ i = 1 K p i ( μ i − μ ) 2 E [ V a r ( Y | η ) ] = ∑ i = 1 K p i ( σ i − σ &#175; ) 2 + σ &#175; 2</p><p>所以为了降低 V a r ( Y ^ c r u d e ) 的值，在选择分层变量 ε 时，应该尽量保证 V a r [ E ( Y | η ) ] 取得最大值，或 E [ V a r ( Y | η ) ] 取得最小值。也就是说，在进行分层时应该尽量保证各层之间的波动性比较大，层内波动性较小。</p></sec></sec><sec id="s7"><title>5. 总结</title><p>本文详细地分析了利用分层MC抽样技术模拟提高其计算精度与运行效率，及推导了分层抽样方差缩减的效果(也就是方差缩减比率 V R E R S 的值)，而且我们根据推导发现分层概率加权方法、分层匹配样本方法与最优分层方法这三种方法中，而且我们从(30)式看出最优分层方法方差缩减效果比分层匹配样本方法的方差缩减效果好。并把所研究的成果应用于欧式看涨期权的定价之中，其对于期权理论的研究和完善具有重要的基础作用。作用分析各种理财产品现值，为投资者和相关人员机构提供一种较好的与预测工具和手段。</p></sec><sec id="s8"><title>基金项目</title><p>贵州民族大学科研基金资助项目(2017YB070)；贵州民族大学网络安全与大数据应用训练中心(20161113006)。</p></sec><sec id="s9"><title>文章引用</title><p>陈云烁,姜晴琼. 分层MC在期权定价中的应用Application of Layered MC in Option Pricing[J]. 应用数学进展, 2018, 07(12): 1511-1520. https://doi.org/10.12677/AAM.2018.712176</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.27980-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Black, F. and Scholes, M. (1973) The Pricing of Options and Corporate Liabilities. Journal of Political Economics, 81, 637-569.</mixed-citation></ref><ref id="hanspub.27980-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Garman, M.B. and Kohlhagen, S.W. (1983) Foreign Currency Option Values. Journal of International Money and Finance, 2, 231-237.</mixed-citation></ref><ref id="hanspub.27980-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Cox, J., Ross, S. and Rubinstein, M. (1979) Option Pricing: A Simplified Ap-proach. Journal of Financial Economics, 7, 229-264.</mixed-citation></ref><ref id="hanspub.27980-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Option, B.P. (1977) A Monte Carlo Approach. Journal of Financial Economic, 4, 323-338.</mixed-citation></ref><ref id="hanspub.27980-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Longstaff, F.A. and Schwartz, E.S. (2001) Valuing American Options by Sim-ulation: A Simple Least-Squares Approach. The Review of Financial Studies, 14, 229-264.</mixed-citation></ref><ref id="hanspub.27980-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">熊炳忠, 马柏林. 基于贝叶斯MCMC算法的美式期权定价[J]. 经济数学, 2013, 30(2): 55-62.</mixed-citation></ref><ref id="hanspub.27980-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Jaeckel, P. (2003) Monte Carlo Methods in Financial. Wiley, New York, 78-183.</mixed-citation></ref><ref id="hanspub.27980-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Glasserman, P. (2004) Monte Carlo Method in Financial Engi-neering. Springer, New York, 289-365.</mixed-citation></ref><ref id="hanspub.27980-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">陈辉. 期权定价的蒙特卡洛模拟方差缩减技术研究[J]. 统计与信息论坛, 2008, 23(7): 86-96.</mixed-citation></ref><ref id="hanspub.27980-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">姜礼尚. 期权定价的数学模型和方法[M]. 第2版. 北京: 高等教育出版社, 2007.</mixed-citation></ref><ref id="hanspub.27980-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Glasserman, P. and Gaussian, P. (1998) Importance Sampling and Stratification: Computationissuer. Pro-ceeding of the 1998 Winter Simulation Conference, IEEE Press, New York, 685-693.</mixed-citation></ref></ref-list></back></article>