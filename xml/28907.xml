<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2019.82031</article-id><article-id pub-id-type="publisher-id">AAM-28907</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20190200000_57445093.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  CT系统参数标定及成像研究
  Study on Parameters Calibration and Imaging of CT System
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>苏</surname><given-names>茜</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>应</surname><given-names>浩聪</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>余</surname><given-names>沁怡</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>美玲</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>亚群</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>蒋</surname><given-names>慕蓉</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>云南大学信息学院，云南 昆明</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>30</day><month>01</month><year>2019</year></pub-date><volume>08</volume><issue>02</issue><fpage>265</fpage><lpage>276</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    CT系统安装时存在的误差在一定程度上影响到样品的成像质量，本文提出了一种借助已知结构模板对CT系统进行参数标定后再对未知结构样品进行成像的方法。首先，借助已知结构的模板及其X射线接收信息，基于卷积逆投影图像重建方法讨论了一种已安装好的典型二维CT系统的主要参数标定；然后利用已获得的标定参数，建立基于图像灰度的吸收率计算模型，研究未知结构的样品成像问题；最后对影响标定精度和稳定性的误差因素进行分析，设计新模板以改进标定精度和稳定性。本文的研究对降低CT系统安装误差影响、提高样品成像质量具有一定意义。
    The errors arising during installation of CT system will affect the imaging quality of the samples to some extent. In this paper, a method is proposed to image the unknown structure samples by cali-brating the parameters of CT system with the known structure template. Firstly, based on convo-lution inverse projection method for image reconstruction, we discuss the main parameters cali-bration of a typical two-dimensional CT system with the help of the known structure template and its X-ray receiving information. Then, based on the obtained calibration parameters, a model for calculating the absorptivity based on image gray level is established to study the imaging problem of unknown structure samples. Finally, the error factors affecting accuracy and stability of the calibration are analyzed, and a new template is designed to improve accuracy and stability. The research in this paper has a certain significance to reduce the influence of CT system installation error and improve the imaging quality of the sample. 
  
 
</p></abstract><kwd-group><kwd>CT系统，参数标定，卷积法，图像灰度，图像重建, CT System</kwd><kwd> Parameters Calibration</kwd><kwd> Convolution Method</kwd><kwd> Image Grayscale</kwd><kwd> Image Reconstruction</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>CT系统参数标定及成像研究<sup> </sup></title><p>苏茜，应浩聪，余沁怡，陈美玲，黄亚群，蒋慕蓉</p><p>云南大学信息学院，云南 昆明</p><p><img src="//html.hanspub.org/file/13-2620856x1_hanspub.png" /></p><p>收稿日期：2019年1月27日；录用日期：2019年2月11日；发布日期：2019年2月19日</p><disp-formula id="hanspub.28907-formula19"><graphic xlink:href="//html.hanspub.org/file/13-2620856x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>CT系统安装时存在的误差在一定程度上影响到样品的成像质量，本文提出了一种借助已知结构模板对CT系统进行参数标定后再对未知结构样品进行成像的方法。首先，借助已知结构的模板及其X射线接收信息，基于卷积逆投影图像重建方法讨论了一种已安装好的典型二维CT系统的主要参数标定；然后利用已获得的标定参数，建立基于图像灰度的吸收率计算模型，研究未知结构的样品成像问题；最后对影响标定精度和稳定性的误差因素进行分析，设计新模板以改进标定精度和稳定性。本文的研究对降低CT系统安装误差影响、提高样品成像质量具有一定意义。</p><p>关键词 :CT系统，参数标定，卷积法，图像灰度，图像重建</p><disp-formula id="hanspub.28907-formula20"><graphic xlink:href="//html.hanspub.org/file/13-2620856x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/13-2620856x7_hanspub.png" /> <img src="//html.hanspub.org/file/13-2620856x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>计算断层摄影(Computed Tomography)，简称CT，是电子计算机和X线相结合，应用到医学领域的重大突破，它使传统的X线诊断技术进入了计算机处理和图像显示的新时代 [<xref ref-type="bibr" rid="hanspub.28907-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.28907-ref2">2</xref>] 。随着CT系统的应用日渐广泛，它可以在不破坏样品的情况下，利用样品对射线能量的吸收特性对生物组织和工程材料的样品进行断层成像，由此获取样品内部的结构信息。然而，CT系统在安装时往往存在误差，从而影响成像质量 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 。针对这一问题，本文首先基于一种典型的二维CT系统，借助已知结构的模板(即样品)及其X射线接收信息研究CT系统主要参数的标定，包括CT系统旋转中心在正方形托盘中的位置、探测器单元之间的距离以及该CT系统使用的X射线的180个方向；其次，基于已获得的标定参数，讨论未知结构的样品成像问题；最后，对影响标定精度和稳定性的因素进行分析，并设计新模板以改进标定精度和稳定性。</p></sec><sec id="s4"><title>2. CT系统主要参数标定</title><p>文中使用的二维CT系统如图1所示 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] ，平行入射的X射线垂直于探测器平面，每个探测器单元看成一个接收点，且等距排列。已知结构的模板几何信息如图2所示 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 。</p><p>图1. 二维CT系统示意图</p><p>图2. 已知结构模板的几何信息</p><sec id="s4_1"><title>2.1. 探测器单元间距的计算</title><p>对文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件2的模板接收信息，根据吸收率的强弱进行染色，得到512个探测单元旋转180个方向的接收结果，见图3。</p><p>图3. 吸收率色阶图</p><p>分析图3中吸收率可知，当系统旋转到A处时，X射线与圆、椭圆相切，并在下一次旋转时与二者相离；B处吸收率最强而范围最小，此时X射线应最接近平行于椭圆长轴；C处接收范围最大而强度除去中间深色圆形的叠加后是最弱的，此时X射线应最接近平行于椭圆短轴，三种情况如图4中所示。</p><p>探测器单元间距公式为： Δ d = l / n ，其中l为n个连续探测器的总间距。</p><p>按照图4的分析，对文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件2中的数据进行比对，得：</p><p>n A ≈ 29 ， l A = 8   mm</p><p>△ d A = 8 29   mm ≈ 0.2759   mm</p><p>图4. ABC三处射线扫描情况</p><p>考虑到旋转可能跳过平行于长轴或短轴的方向，对B、C附近几组数据进行比对发现，数据之间变化很小，可认为系统转到此两处时近似经过两轴，得：</p><p>n B ≈ 109 ， l B = 30   mm</p><p>△ d B = 30 109   mm ≈ 0.2752   mm</p><p>n C ≈ 289 ， l C = 80   mm</p><p>△ d C = 80 289   mm ≈ 0.2768   mm</p><p>由于C处采集的数据较多，认为该处数据能更合理的反映探测单元间的实际距离，因此得到最终结果为0.2768 mm。</p></sec><sec id="s4_2"><title>2.2. 卷积逆投影图像重建</title><p>逆投影是指各个方向的投影逆向返回到该方向的位置，如果对多个投影方向中的每个方向都进行这样的逆投影，就可以建立平面上的一个部分，典型的方法是卷积逆投影重建 [<xref ref-type="bibr" rid="hanspub.28907-ref4">4</xref>] 。</p><p>卷积可看成一种滤波手段 [<xref ref-type="bibr" rid="hanspub.28907-ref5">5</xref>] ，卷积逆投影相当于先对数据滤波再将结果逆投影回来，可以使模糊得到校正。而卷积重建法是一种变换重建法，可以根据傅里叶变换推出 [<xref ref-type="bibr" rid="hanspub.28907-ref6">6</xref>] 。</p><p>图像函数 f ( x , y ) 的二维傅里叶变换为：</p><p>F ( u , v ) = ∫ − ∞ ∞ ∫ − ∞ ∞ f ( x , y ) e − j 2 π ( u x + v y ) d x d y</p><p>逆变换公式为：</p><p>f ( x , y ) = ∫ − ∞ ∞ ∫ − ∞ ∞ F ( u , v ) e j 2 π ( u x + v y ) d u d y (1)</p><p>用 u = r cos θ , v = r sin θ 进行代换，得公式(1)的极坐标形式：</p><p>f ( x , y ) = ∫ 0 2π ∫ 0 ∞ F ( r , θ ) e j 2 π ( x cos θ + y sin θ ) r d r d θ</p><p>由傅里叶变换共轭对称性得：</p><p>f ( x , y ) = ∫ 0 2π ∫ 0 ∞ F ( r , θ ) e j 2 π ( x cos θ + y sin θ ) | r | d r d θ (2)</p><p>令 f ′ ( x , y , θ ) = ∫ − ∞ ∞ e j 2 π ( x cos θ + y sin θ ) F ( r , θ ) | r | d r ，公式(2)等价于：</p><p>f ( x , y ) = ∫ 0 π f ′ ( x , y , θ ) d θ (3)</p><p>当r取 ( − 1 / 2 d , 1 / 2 d ) 时，公式(2)近似为：</p><p>f ( x , y ) ≈ ∫ 0 π ∫ − 1 2 d 1 2 d F ( r , θ ) e j 2 π ( x cos θ + y sin θ ) | r | d r d θ</p><p>即：</p><p>h ( ρ ) = ∫ − 1 2 d 1 2 d | r | e j 2 π ρ d r (4)</p><p>联立公式，经化简得：</p><p>f ′ ( x , y , θ ) = ∫ − ∞ ∞ g ( ρ , θ ) h ( x cos θ + y sin θ − ρ ) d ρ (5)</p><p>由化简结果知，可以先将投影数据 g ( ρ , θ ) 和相应脉冲滤波器(公式(4))进行卷积，然后用公式(3)对不同旋转角θ求和，就能实现图像重建。</p><p>本文利用Matlab函数进行卷积重建，还原探测器视角的扫描图像，将图像二值化，编程算出图像的中心点、椭圆的中心并建立坐标系，如图5所示。</p><p>图5. 还原图像建立坐标系</p><p>图中G点为图像正中心，由旋转平移的性质知，原系统旋转中心坐标相当于G点在图5坐标系中的坐标。这里我们设图5的左下角顶点为坐标原点。</p><p>先将复原图比例调整为与文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件1中一致。</p><p>la是经过椭圆心、圆心的直线，lb为椭圆长轴。原图中，椭圆长短轴的交点、圆心的位置是已知的，计算两线的方程为：</p><p>la : y = − 0.5677 x + 258.0935</p><p>lb : y = 1.7613 x − 204.6182</p><p>联立解得旋转中心为(−9.0663, 6.3578)。</p></sec><sec id="s4_3"><title>2.3. 平面投影角度计算模型</title><p>求解CT系统X射线的180个方向，关键在于确定每个时刻X射线相对于椭圆心、圆心连线的夹角，为此，本节建立了基于平面几何投影的角度计算模型。</p><p>图6. 圆心距投影模型</p><p>在利用投影计算方向之前，文中选取了部分只穿过椭圆的X射线，对它们的接收强度与它们穿过椭圆的长度进行拟合，发现二者之间呈线性相关，关系式如下：I = 1.7722L。</p><p>在图6中，AB为某时刻探测器相对位置，A、B分别为椭圆心O<sub>1</sub>、圆心O<sub>2</sub>经X射线在探测器上的投影，可知：∆CAO<sub>1</sub>~∆CBO<sub>2</sub>，则有 | CA | | CO 1 | = | CA | + | AB | | CO 1 | + | O 1 O 2 | ，化简得： | CA | | CO 1 | = | AB | | O 1 O 2 | = cos α 。</p><p>|O<sub>1</sub>O<sub>2</sub>|已知，AO<sub>1</sub>、BO<sub>2</sub>分别经过椭圆心、圆心，由前述线性相关性，得出这两条X射线应是穿过椭圆和圆的射线中接收强度最大的两条，因此通过筛选出文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件2中每列经过椭圆的射线接收强度最大值和经过圆的射线接收强度最大值，就可找到每次旋转后的AO<sub>1</sub>和BO<sub>2</sub>，两线间距离为投影|AB|，从而可得 的值。</p><p>利用Matlab拟合出的余弦函数为： cos α = − 0.0093 + 0.9926 ∗ cos ( 0.0175 t + 0.4807 ) ，相关度信息为：R-SQUARE = 0.9995，RMSE = 0.0141，表明拟合效果较好。</p><p>求反函数拟合得到180次旋转的角度变换公式为： P = 1.0015 t + 28.1355 + 90 ，单位为度。</p><p>由上式可计算出X射线在以椭圆心为原点的坐标轴中的初始方向，见图7。</p><p>图7. X射线初始方向</p><p>因此，CT系统使用的X射线的180个方向如表1所示(单位为度)。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> 180 Directions of X-ra</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >次数</th><th align="center" valign="middle"  colspan="6"  >角度(˚)</th></tr></thead><tr><td align="center" valign="middle" >1~6</td><td align="center" valign="middle" >119.1370</td><td align="center" valign="middle" >120.1385</td><td align="center" valign="middle" >121.1400</td><td align="center" valign="middle" >122.1415</td><td align="center" valign="middle" >123.1430</td><td align="center" valign="middle" >124.1445</td></tr><tr><td align="center" valign="middle" >7~12</td><td align="center" valign="middle" >125.1460</td><td align="center" valign="middle" >126.1475</td><td align="center" valign="middle" >127.1490</td><td align="center" valign="middle" >128.1505</td><td align="center" valign="middle" >129.1520</td><td align="center" valign="middle" >130.1535</td></tr><tr><td align="center" valign="middle" >13~18</td><td align="center" valign="middle" >131.1550</td><td align="center" valign="middle" >132.1565</td><td align="center" valign="middle" >133.1580</td><td align="center" valign="middle" >134.1595</td><td align="center" valign="middle" >135.1610</td><td align="center" valign="middle" >136.1625</td></tr><tr><td align="center" valign="middle" >19~24</td><td align="center" valign="middle" >137.1640</td><td align="center" valign="middle" >138.1655</td><td align="center" valign="middle" >139.1670</td><td align="center" valign="middle" >140.1685</td><td align="center" valign="middle" >141.1700</td><td align="center" valign="middle" >142.1715</td></tr><tr><td align="center" valign="middle" >25~30</td><td align="center" valign="middle" >143.1730</td><td align="center" valign="middle" >144.1745</td><td align="center" valign="middle" >145.1760</td><td align="center" valign="middle" >146.1775</td><td align="center" valign="middle" >147.1790</td><td align="center" valign="middle" >148.1805</td></tr><tr><td align="center" valign="middle" >31~36</td><td align="center" valign="middle" >149.1820</td><td align="center" valign="middle" >150.1835</td><td align="center" valign="middle" >151.1850</td><td align="center" valign="middle" >152.1865</td><td align="center" valign="middle" >153.1880</td><td align="center" valign="middle" >154.1895</td></tr><tr><td align="center" valign="middle" >37~42</td><td align="center" valign="middle" >155.1910</td><td align="center" valign="middle" >156.1925</td><td align="center" valign="middle" >157.1940</td><td align="center" valign="middle" >158.1955</td><td align="center" valign="middle" >159.1970</td><td align="center" valign="middle" >160.1985</td></tr><tr><td align="center" valign="middle" >43~48</td><td align="center" valign="middle" >161.2000</td><td align="center" valign="middle" >162.2015</td><td align="center" valign="middle" >163.2030</td><td align="center" valign="middle" >164.2045</td><td align="center" valign="middle" >165.2060</td><td align="center" valign="middle" >166.2075</td></tr><tr><td align="center" valign="middle" >49~54</td><td align="center" valign="middle" >167.2090</td><td align="center" valign="middle" >168.2105</td><td align="center" valign="middle" >169.2120</td><td align="center" valign="middle" >170.2135</td><td align="center" valign="middle" >171.2150</td><td align="center" valign="middle" >172.2165</td></tr><tr><td align="center" valign="middle" >55~60</td><td align="center" valign="middle" >173.2180</td><td align="center" valign="middle" >174.2195</td><td align="center" valign="middle" >175.2210</td><td align="center" valign="middle" >176.2225</td><td align="center" valign="middle" >177.2240</td><td align="center" valign="middle" >178.2255</td></tr><tr><td align="center" valign="middle" >61~66</td><td align="center" valign="middle" >179.2270</td><td align="center" valign="middle" >180.2285</td><td align="center" valign="middle" >181.2300</td><td align="center" valign="middle" >182.2315</td><td align="center" valign="middle" >183.2330</td><td align="center" valign="middle" >184.2345</td></tr><tr><td align="center" valign="middle" >67~72</td><td align="center" valign="middle" >185.2360</td><td align="center" valign="middle" >186.2375</td><td align="center" valign="middle" >187.2390</td><td align="center" valign="middle" >188.2405</td><td align="center" valign="middle" >189.2420</td><td align="center" valign="middle" >190.2435</td></tr><tr><td align="center" valign="middle" >73~78</td><td align="center" valign="middle" >191.2450</td><td align="center" valign="middle" >192.2465</td><td align="center" valign="middle" >193.2480</td><td align="center" valign="middle" >194.2495</td><td align="center" valign="middle" >195.2510</td><td align="center" valign="middle" >196.2525</td></tr><tr><td align="center" valign="middle" >79~84</td><td align="center" valign="middle" >197.2540</td><td align="center" valign="middle" >198.2555</td><td align="center" valign="middle" >199.2570</td><td align="center" valign="middle" >200.2585</td><td align="center" valign="middle" >201.2600</td><td align="center" valign="middle" >202.2615</td></tr><tr><td align="center" valign="middle" >84~90</td><td align="center" valign="middle" >203.2630</td><td align="center" valign="middle" >204.2645</td><td align="center" valign="middle" >205.2660</td><td align="center" valign="middle" >206.2675</td><td align="center" valign="middle" >207.2690</td><td align="center" valign="middle" >208.2705</td></tr><tr><td align="center" valign="middle" >91~96</td><td align="center" valign="middle" >209.2720</td><td align="center" valign="middle" >210.2735</td><td align="center" valign="middle" >211.2750</td><td align="center" valign="middle" >212.2765</td><td align="center" valign="middle" >213.2780</td><td align="center" valign="middle" >214.2795</td></tr><tr><td align="center" valign="middle" >97~102</td><td align="center" valign="middle" >215.2810</td><td align="center" valign="middle" >216.2825</td><td align="center" valign="middle" >217.2840</td><td align="center" valign="middle" >218.2855</td><td align="center" valign="middle" >219.2870</td><td align="center" valign="middle" >220.2885</td></tr><tr><td align="center" valign="middle" >103~108</td><td align="center" valign="middle" >221.2900</td><td align="center" valign="middle" >222.2915</td><td align="center" valign="middle" >223.2930</td><td align="center" valign="middle" >224.2945</td><td align="center" valign="middle" >225.2960</td><td align="center" valign="middle" >226.2975</td></tr><tr><td align="center" valign="middle" >109~114</td><td align="center" valign="middle" >227.2990</td><td align="center" valign="middle" >228.3005</td><td align="center" valign="middle" >229.3020</td><td align="center" valign="middle" >230.3035</td><td align="center" valign="middle" >231.3050</td><td align="center" valign="middle" >232.3065</td></tr><tr><td align="center" valign="middle" >115~120</td><td align="center" valign="middle" >233.3080</td><td align="center" valign="middle" >234.3095</td><td align="center" valign="middle" >235.3110</td><td align="center" valign="middle" >236.3125</td><td align="center" valign="middle" >237.3140</td><td align="center" valign="middle" >238.3155</td></tr><tr><td align="center" valign="middle" >121~126</td><td align="center" valign="middle" >239.3170</td><td align="center" valign="middle" >240.3185</td><td align="center" valign="middle" >241.3200</td><td align="center" valign="middle" >242.3215</td><td align="center" valign="middle" >243.3230</td><td align="center" valign="middle" >244.3245</td></tr><tr><td align="center" valign="middle" >127~132</td><td align="center" valign="middle" >245.3260</td><td align="center" valign="middle" >246.3275</td><td align="center" valign="middle" >247.3290</td><td align="center" valign="middle" >248.3305</td><td align="center" valign="middle" >249.3320</td><td align="center" valign="middle" >250.3335</td></tr><tr><td align="center" valign="middle" >133~138</td><td align="center" valign="middle" >251.3350</td><td align="center" valign="middle" >252.3365</td><td align="center" valign="middle" >253.3380</td><td align="center" valign="middle" >254.3395</td><td align="center" valign="middle" >255.3410</td><td align="center" valign="middle" >256.3425</td></tr><tr><td align="center" valign="middle" >139~144</td><td align="center" valign="middle" >257.3440</td><td align="center" valign="middle" >258.3455</td><td align="center" valign="middle" >259.3470</td><td align="center" valign="middle" >260.3485</td><td align="center" valign="middle" >261.3500</td><td align="center" valign="middle" >262.3515</td></tr><tr><td align="center" valign="middle" >145~150</td><td align="center" valign="middle" >263.3530</td><td align="center" valign="middle" >264.3545</td><td align="center" valign="middle" >265.3560</td><td align="center" valign="middle" >266.3575</td><td align="center" valign="middle" >267.3590</td><td align="center" valign="middle" >268.3605</td></tr><tr><td align="center" valign="middle" >151~156</td><td align="center" valign="middle" >269.3620</td><td align="center" valign="middle" >270.3635</td><td align="center" valign="middle" >271.3650</td><td align="center" valign="middle" >272.3665</td><td align="center" valign="middle" >273.3680</td><td align="center" valign="middle" >274.3695</td></tr><tr><td align="center" valign="middle" >157~162</td><td align="center" valign="middle" >275.3710</td><td align="center" valign="middle" >276.3725</td><td align="center" valign="middle" >277.3740</td><td align="center" valign="middle" >278.3755</td><td align="center" valign="middle" >279.3770</td><td align="center" valign="middle" >280.3785</td></tr><tr><td align="center" valign="middle" >163~168</td><td align="center" valign="middle" >281.3800</td><td align="center" valign="middle" >282.3815</td><td align="center" valign="middle" >283.3830</td><td align="center" valign="middle" >284.3845</td><td align="center" valign="middle" >285.3860</td><td align="center" valign="middle" >286.3875</td></tr><tr><td align="center" valign="middle" >169~174</td><td align="center" valign="middle" >287.3890</td><td align="center" valign="middle" >288.3905</td><td align="center" valign="middle" >289.3920</td><td align="center" valign="middle" >290.3935</td><td align="center" valign="middle" >291.3950</td><td align="center" valign="middle" >292.3965</td></tr><tr><td align="center" valign="middle" >175~180</td><td align="center" valign="middle" >293.3980</td><td align="center" valign="middle" >294.3995</td><td align="center" valign="middle" >295.4010</td><td align="center" valign="middle" >296.4025</td><td align="center" valign="middle" >297.4040</td><td align="center" valign="middle" >298.4055</td></tr></tbody></table></table-wrap><p>表1. X射线的180个方向</p></sec></sec><sec id="s5"><title>3. 未知结构样品成像研究</title><sec id="s5_1"><title>3.1. 图像的重建和位置还原</title><p>文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件3是利用上述CT系统得到的某未知样品的接收信息，利用MATLAB函数卷积重建还原探测器视角的扫描图像，得到该未知样品的几何形状如图8所示。</p><p>图8. 样品形状重建</p><p>由于系统X射线初始角度为119.1370˚，为计算样品在托盘中的位置，文中用MATLAB函数将样品绕旋转中心逆时针旋转29.1370˚。</p><p>又因为旋转后得到的图形大小为362 * 362像素，而托盘图像大小为256 * 256像素，应进行裁剪，所以取以距原图像中心以左(9.0663/100) * 256像素、以上(6.3578/100) * 256像素为中心的256 * 256像素的空图像矩阵对原图进行裁剪，得到样品在托盘中的位置如图9所示。</p><p>图9. 裁剪旋转平移后样品在托盘上的位置</p></sec><sec id="s5_2"><title>3.2. 基于图像灰度的吸收率计算模型</title><p>图10为文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件1中样品吸收率的色阶图，由该图可知，托盘上放置样品的地方吸收率为1，其余地方吸收率为0。</p><p>图10. 附件1中吸收率色阶图</p><p>图11为文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件2中图像重建后的灰度矩阵图像：</p><p>图11. 附件2中图像重建后的灰度矩阵图</p><p>忽略为还原样品位置处理图像时产生的噪点，观察矩阵值发现该样品所在位置对应像素点的灰度值均相同，可得出以下结论：某一点的吸收率是关于该点像素灰度值的相对值，并将灰度值最大的像素点对应位置的吸收率设为1，其余像素位置吸收率均以该像素为基准进行等比例缩小，得到吸收率计算模型：</p><p>{ α ( i , j ) = δ ∗ g ( i , j ) δ = 1 / [ g ( i , j ) ] max</p><p>其中 为矩阵第i行第j列像素对应位置的吸收率，δ为将最大灰度值标准化为1的比例， g ( i , j ) 为矩阵第i行第j列像素的灰度值。</p><p>根据吸收率计算模型公式对文献 [<xref ref-type="bibr" rid="hanspub.28907-ref3">3</xref>] 附件3重建图像的灰度矩阵进行标准化运算，得到的新矩阵每个元素的值即为该点像素对应位置的吸收率，标准化之后的图像如图12所示，与图9相比灰度变化较明显。</p><p>图12. 标准化后的灰度图像</p></sec></sec><sec id="s6"><title>4. 标定精度及稳定性</title><sec id="s6_1"><title>4.1. 影响因素分析</title><p>影响标定精度和稳定性的因素主要包括以下三点：</p><p>1) 标定探测器相邻单元之间距离时的误差。</p><p>本文通过计算椭圆长轴长度与椭圆长轴所跨单元数量之间的比值来近似确定探测器相邻单元之间的距离。相比于采用圆的半径、椭圆短轴来计算的方法，该方法可获得更高的精度。但是，无论采用哪种方法，图形的边缘都不可能正好对准探测器单元，因此，在计算过程中将出现不可避免的误差。采用尽可能大的图形来做计算只能尽可能缩小这一偏差在最终结果中的比例，不能彻底消除误差。</p><p>2) 计算探测器各个时刻位置时的误差</p><p>文中利用椭圆心和圆心的距离及其在CT探测器上的投影距离的比值来获得探测器各个时刻相对于x轴的倾斜角。这一方法在椭圆和圆在探测器上的投影重叠时，将无法推导出探测器的精确方位，只能凭借函数的特征来拟合出探测器的当前位置。在高精度要求的场合，这将引起接下来旋转中心计算的偏差甚至重建图像的畸变。</p><p>3) 确定重建图像和原图之间关系时的误差</p><p>重建图像可以被大体视为原图经过旋转、平移和缩放后的结果，其中旋转和缩放都可能引起图像失真 [<xref ref-type="bibr" rid="hanspub.28907-ref7">7</xref>] 。文中采用双三次插值 [<xref ref-type="bibr" rid="hanspub.28907-ref8">8</xref>] 来尽可能保证图像画质不退化。但是由于图像是由矩阵来表示的，每一次处理过程中数据的舍入都会产生一定的误差，而总的误差会在这些误差的叠加当中被放大。其中y轴的位置并不能由数据直接得到，而需要通过旋转中心和x轴的位置来推导，这将导致2)中有关倾斜角和旋转中心的误差在后面的计算中被放大。</p></sec><sec id="s6_2"><title>4.2. 新模板设计</title><p>针对上述误差，为改进标定精度和稳定性重新设计模板如图13、图14所示：</p><p>图13. 第一次标定用的模板</p><p>将标定过程分为两个阶段。在第一阶段使用图13的模板，模板中有且仅有一个椭圆，避免了图形重合的现象，完整地获取180个射线方向(而不是通过函数模拟)，从而精确计算CT系统旋转中心和重建图像的倾斜角度。第二阶段使用图14的模板，该模板在原来椭圆的基础上，在x轴上和y轴上分别增加一个正圆。这样能精确确定x轴和y轴的位置，并能获得更为精确的重建图像和原介质的比例尺。但是，这种做法将造成额外的一次扫描，增大了标定过程的成本。</p><p>另外，由于更大的图形能够在一定程度上减小离散图形带来的误差，因此，本文决定采用比原来模板更大的图形来进行标定。但图形也不能无限放大，要保证托盘能够放置样品且样品能够被扫描到。</p></sec></sec><sec id="s7"><title>5. 结束语</title><p>本文在计算相邻探测器距离以及射线各个时刻方向的时候，将原问题抽象为几何模型，极大地降低</p><p>图14. 第二次标定用的模板</p><p>了解题难度和运算量。为了快速方便地重建投影图像并寻找CT系统旋转中心，文中采用了卷积法，使得重建后的图像具有较高的精确度和还原度。利用MATLAB命令对图像进行旋转、裁剪、平移等处理过程中双三次插值等方法的运用最大程度上避免了图像失真问题。通过对参数标定过程中的不精确和不稳定因素的分析，本文对症下药，设计了一种新的标定模板。对标定参数的精确性和稳定性的进一步探讨是今后研究的内容。</p></sec><sec id="s8"><title>基金项目</title><p>云南大学教育教学改革研究项目(2017Y13)。</p></sec><sec id="s9"><title>文章引用</title><p>苏 茜,应浩聪,余沁怡,陈美玲,黄亚群,蒋慕蓉. CT系统参数标定及成像研究Study on Parameters Calibration and Imaging of CT System[J]. 应用数学进展, 2019, 08(02): 265-276. https://doi.org/10.12677/AAM.2019.82031</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.28907-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">科普中国. CT (电子计算机断层扫描) [EB/OL]. https://baike.baidu.com/item/CT/122415?fr=aladdin, 2017-03-20.</mixed-citation></ref><ref id="hanspub.28907-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">余晓锷, 龚剑. CT原理与技术[M]. 北京: 科学出版社, 2014.</mixed-citation></ref><ref id="hanspub.28907-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">全国大学生数学建模竞赛组委会. 2017年高教社杯全国大学生数学建模竞赛赛题[EB/OL].  
http://www.mcm.edu.cn/html_cn/node/460baf68ab0ed0e1e557a0c79b1c4648.html, 2017-09-14.</mixed-citation></ref><ref id="hanspub.28907-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">闫镔, 李磊. CT图像重建算法[M]. 北京: 科学出版社, 2014.</mixed-citation></ref><ref id="hanspub.28907-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">伍伟文, 全超, 刘丰林. 相对平行直线扫描CT滤波反投影图像重建[J]. 光学学报, 2016, 36(9): 157-167.</mixed-citation></ref><ref id="hanspub.28907-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Jiang Hsieh. 计算机断层成像技术处理原理、设计、伪像和进展[M]. 北京: 科学出版社, 2006.</mixed-citation></ref><ref id="hanspub.28907-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">张顺利. ART算法几种重建模型的研究和比较[J]. 航空计算技术, 2005, 35(2): 39-41.</mixed-citation></ref><ref id="hanspub.28907-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">王会鹏, 周利莉, 张杰. 一种基于区域的双三次图像插值算法[J]. 计算机工程, 2010, 36(19): 216-218.</mixed-citation></ref></ref-list></back></article>