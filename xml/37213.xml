<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SEA</journal-id><journal-title-group><journal-title>Software Engineering and Applications</journal-title></journal-title-group><issn pub-type="epub">2325-2286</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SEA.2020.94034</article-id><article-id pub-id-type="publisher-id">SEA-37213</article-id><article-categories><subj-group subj-group-type="heading"><subject>SEA20200400000_64874230.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于深度学习的银行卡号识别研究
  Research on Identification of Bank Card Number Based on Deep Learning
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>月锟</given-names></name><xref ref-type="aff" rid="aff1"><sub>1</sub></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>青岛理工大学信息与控制工程学院，山东 青岛</addr-line></aff><pub-date pub-type="epub"><day>24</day><month>07</month><year>2020</year></pub-date><volume>09</volume><issue>04</issue><fpage>302</fpage><lpage>308</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  针对自然环境下银行卡卡号识别困难等问题，本文提出了一种基于深度学习的银行卡卡号识别方法。方法分为两步：银行卡卡号区域定位和定位后的卡号识别。卡号区域定位使用CTPN神经网络训练的数据模型，训练集数据采用ICDAR2015；对定位的银行卡号，使用CRNN神经网络训练数据模型，最后完成卡号数字识别。本方法采用端到端对银行卡卡号行定位、识别，能够自动适应图片的倾斜，对自然环境下银行卡卡号的识别具有很好的适应性。&lt;br/&gt;In view of the difficulty in the identification of bank card numbers in natural environment, this paper proposes a method for the identification of bank card Numbers based on deep learning. The method is divided into two steps: the location of the bank card number and the identification of the card number after location. The data model of CTPN neural network was used for the location of card number area, and ICDAR2015 was used for the data of training set. The CRNN neural network was used to train the data model to locate the bank card number, and finally the card number digital recognition was completed. This method adopts end-to-end positioning and recognition of the bank card number line, which can automatically adapt to the tilt of the picture, and has good adaptability to the identification of bank card number in natural environment.
 
</p></abstract><kwd-group><kwd>深度学习，CTPN，CRNN，端到端, Deep Learning</kwd><kwd> CTPN</kwd><kwd> CRNN</kwd><kwd> End-to-End</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于深度学习的银行卡号识别研究</title><p>刘月锟</p><p>青岛理工大学信息与控制工程学院，山东 青岛</p><p>收稿日期：2020年8月3日；录用日期：2020年8月17日；发布日期：2020年8月24日</p><disp-formula id="hanspub.37213-formula87"><graphic xlink:href="//html.hanspub.org/file/7-2690459x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>针对自然环境下银行卡卡号识别困难等问题，本文提出了一种基于深度学习的银行卡卡号识别方法。方法分为两步：银行卡卡号区域定位和定位后的卡号识别。卡号区域定位使用CTPN神经网络训练的数据模型，训练集数据采用ICDAR2015；对定位的银行卡号，使用CRNN神经网络训练数据模型，最后完成卡号数字识别。本方法采用端到端对银行卡卡号行定位、识别，能够自动适应图片的倾斜，对自然环境下银行卡卡号的识别具有很好的适应性。</p><p>关键词 :深度学习，CTPN，CRNN，端到端</p><disp-formula id="hanspub.37213-formula88"><graphic xlink:href="//html.hanspub.org/file/7-2690459x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2020 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/7-2690459x7_hanspub.png" /> <img src="//html.hanspub.org/file/7-2690459x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着网络技术的发展，经济社会的进步，带来了支付方式的各种变革，支付宝、微信需要绑定银行卡支付，银行转账需要输入银行卡号等等，在这些过程中对银行卡拍照，进而识别出银行卡卡号，将带来极大的方便。支付宝、微信、手机银行基本都带有拍照识别银行卡号的功能，但是存在着对识别环境、银行卡清晰度、图片角度等种种限制，越来越多的商家也在尝试开发应用此技术。</p><p>对于银行卡号的自动识别，人们进行了很多研究，现有卡号定位方法基本基于opencv的边缘检测算法，对银行卡图片进行灰度化、二值化、边缘检测、轮廓提取等操作 [<xref ref-type="bibr" rid="hanspub.37213-ref1">1</xref>] - [<xref ref-type="bibr" rid="hanspub.37213-ref6">6</xref>]，对定位后的卡号进行字符分割，再对切割后的字符进行识别；在字符识别上，有的采用深度学习的方法 [<xref ref-type="bibr" rid="hanspub.37213-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.37213-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.37213-ref6">6</xref>]，有的采用模板匹配的算法 [<xref ref-type="bibr" rid="hanspub.37213-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.37213-ref5">5</xref>]，有的采用改进的特征匹配算法 [<xref ref-type="bibr" rid="hanspub.37213-ref3">3</xref>]；但只是在字符切割后对单个字符进行识别，字符切割的准确率制约着最终识别的准确率，这些方法在自然场景下存在着卡号行定位难、复杂背景银行卡字符切割难、识别率低等问题。</p></sec><sec id="s4"><title>2. 概述</title><p>近几年深度学习在文字识别中的应用发展迅速，基于深度学习的端到端的文字识别，不需要显式加入文字切割这个环节，而是将文字识别转化为序列学习问题，就可以对整个文本图像进行识别，文字的切割也被融入到深度学习中去。</p><p>本文采用深度学习的方法训练数据模型，采用端到端对银行卡卡号行定位、银行卡号识别，不再对银行卡进行投影、字符切割处理，对卡号行定位、识别准确，适应复杂环境，为银行卡识别提供了新方法。</p></sec><sec id="s5"><title>3. 卡号行定位</title><p>文字识别分为两个具体步骤：文字的检测和文字的识别，两者缺一不可，对于银行卡号的识别也是如此，首先需要准确定位银行卡号，然后才能识别，如果定位不准确也就不能正确识别。</p><p>文本检测方法很多，影响较大的是文献 [<xref ref-type="bibr" rid="hanspub.37213-ref7">7</xref>]，基于这篇论文实现的深度神经网络简称为CTPN，直到现在这个网络框架一直是OCR系统中做文本检测的一个常用网络，极大地影响了文本检测算法的方向。文献 [<xref ref-type="bibr" rid="hanspub.37213-ref8">8</xref>] 提出了检测多方向文本和弯曲文本的方法，由于银行卡号的定位主要是横向文本，本文选用CTPN深度神经网络进行文本检测。</p><sec id="s5_1"><title>3.1. 网络结构</title><p>CTPN的基础网络使用了VGG16用于特征提取，在VGG的最后一个卷积层CONV5，CTPN用了3 &#215; 3的卷积核来对该feature map做卷积，这个CONV5特征图的尺寸由输入图像来决定，而卷积时的步长却限定为16，感受视野被固定为228个像素。卷积后的特征将送入BLSTM继续学习，最后接上一层全连接层FC，输出要预测的参数：2k个纵向坐标y，2k个分数，k个x的水平偏移量。</p><p>CTPN网络结构 [<xref ref-type="bibr" rid="hanspub.37213-ref7">7</xref>] 如图1：</p><p>图1. CTPN网络结构图</p><p>结构主要定义：</p><p>(1) self.cnn = nn.Sequential()</p><p>(2) self.cnn.add_module(‘VGG_16', VGG_16())</p><p>(3) self.rnn = nn.Sequential()</p><p>(4) self.rnn.add_module('im2col', img2col.Im2col((3, 3), (1, 1), (1, 1)))</p><p>(5) self.rnn.add_module('blstm', BLSTM(3 * 3 * 512, 128))</p><p>(6) self.FC = nn.Conv2d(256, 512, 1)</p><p>(7) self.vertical_coordinate = nn.Conv2d(512, 2 * 10, 1)</p><p>(8) self.score = nn.Conv2d(512, 2 * 10, 1)</p><p>(9) self.side_refinement = nn.Conv2d(512, 10, 1)</p></sec><sec id="s5_2"><title>3.2. 模型训练</title><p>训练数据选用ICDAR2015，每个文本框用4个坐标来表示，即左上、右上、右下、左下四个坐标，共八个值，记作[x1 y1 x2 y2 x3 y3 x4 y4]。</p><p>Loss函数的定义是三部分，类别判断(是不是text)，竖直方向坐标偏移量和边缘偏移量，类别判断为cls_loss，使用CrossEntropyLoss，竖直方向坐标偏移量和边缘偏移量分别为v_reg_loss和o_reg_loss，训练过程优化器选择SGD。</p><p>训练过程损失函数曲线如图2。</p><p>使用训练后的模型对银行卡图片中的文本进行识别，根据识别出的文本区域的坐标，计算文本区域宽、高，由宽高比和宽高绝对值，定位银行卡号位置。</p></sec></sec><sec id="s6"><title>4. 卡号识别</title><p>基于深度学习的端到端文本识别方法主要有CRNN OCR和attention OCR。两种方法在特征学习阶段都采用了CNN + RNN的网络结构，CRNN OCR在对齐时采取的方式是CTC算法，而attention OCR采取的方式则是attention机制。</p><p>本文卡号识别使用CRNN算法 [<xref ref-type="bibr" rid="hanspub.37213-ref9">9</xref>]，CRNN架构是CNN + RNN + CTC，CNN提取图像像素特征，RNN提取图像时序特征，而CTC归纳字符间的连接特性，从而实现不定长字符的识别。</p><p>图2. 训练过程损失函数变化图</p><sec id="s6_1"><title>4.1. 网络结构</title><p>网络结构分为三部分，依次为：</p><p>卷积层，使用CNN，作用是从输入图像中提取特征序列；</p><p>循环层，使用RNN，作用是预测从卷积层获取的特征序列的标签(真实值)分布；</p><p>转录层，使用CTC，作用是把从循环层获取的标签分布通过去重整合等操作转换成最终的识别结果。</p><p>网络结构 [<xref ref-type="bibr" rid="hanspub.37213-ref9">9</xref>] 如图3。</p><p>图3. CRNN网络结构图</p></sec><sec id="s6_2"><title>4.2. 模型训练</title><p>训练数据使用采集的银行卡数据，按照4位一组分割，并进行数据增强。空格用下划线“_”代替，训练过程优化器选择RMSprop。</p><p>针对实际中采集的银行卡数量不充足的问题，对切割后的银行卡号数据通过左右倾斜、模糊、平移等方法，对每张银行卡号数据进行数据增强，满足数据训练需要。</p><p>训练损失函数和验证正确率曲线如图4：</p><p>图4. 训练过程损失函数和验证正确率变化图</p></sec></sec><sec id="s7"><title>5. 系统测试</title><p>操作系统为win10，开发语言为python3.7，深度学习框架为pytorch1.0.1。开发环境安装后对数据模型进行训练，得到数据模型。</p><p>使用训练好的模型，对银行卡中的文本进行定位，根据银行卡卡号的特点，如：卡号一般位置、长度、高度等特点，将银行卡位置识别出来，定位效果如图5、图6。</p><p>图5. 印刷体银行卡卡号定位</p><p>图6. 凹凸体银行卡卡号定位</p><p>使用训练好的模型，对银行卡中定位的银行卡号进行识别，识别结果如图7、图8。</p><p>图7. 印刷体银行卡卡号识别</p><p>图8. 凹凸体银行卡卡号识别</p></sec><sec id="s8"><title>6. 结论</title><p>本研究提出了一种基于深度学习的银行卡卡号识别方法，本方法采用端到端的方法对银行卡号进行识别，不需要传统方法的字符分割、图片矫正等对图片的处理，实验表明，对黑体印刷及凹凸印刷两种类型银行卡都能很好的定位和识别，能够自动适应图片的倾斜，对自然环境下复杂背景的银行卡卡号的识别也具有很好的适应性。</p></sec><sec id="s9"><title>文章引用</title><p>刘月锟. 基于深度学习的银行卡号识别研究Research on Identification of Bank Card Number Based on Deep Learning[J]. 软件工程与应用, 2020, 09(04): 302-308. https://doi.org/10.12677/SEA.2020.94034</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.37213-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">涂亚飞. 银行卡号字符的分割与识别算法研究[D]: [硕士学位论文]. 北京: 北京交通大学, 2017.</mixed-citation></ref><ref id="hanspub.37213-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">李淑云. 银行卡卡号字符分割与识别方法研究[D]: [硕士学位论文]. 武汉: 华中科技大学, 2014.</mixed-citation></ref><ref id="hanspub.37213-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">董延华, 陈中华, 宋和烨, 黄雨. 改进特征匹配算法在银行卡号识别中的应用[J]. 吉林大学学报(理学版), 2018, 56(1): 126-129.</mixed-citation></ref><ref id="hanspub.37213-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">赵慧敏. 基于深度学习的银行卡识别系统设计开发[D]: [硕士学位论文]. 北京: 华北电力大学, 2019.</mixed-citation></ref><ref id="hanspub.37213-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">刘振飞. 基于OpenCV的银行卡号识别系统[J]. 电子技术与软件工程, 2019(11): 63-63.</mixed-citation></ref><ref id="hanspub.37213-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">蔡安平, 邱博宇, 谭小辉, 李尚林. 基于移动端的银行卡识别方法[J]. 计算机科学与应用, 2020, 10(4): 732-740.</mixed-citation></ref><ref id="hanspub.37213-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Tian, Z., Huang, W., He, T., et al. (2016) Detecting Text in Natural Image with Connectionist Text Proposal Network. ECCV 2016, 56-72. arXiv:1609.03605 [cs.CV] &lt;br&gt;https://doi.org/10.1007/978-3-319-46484-8_4</mixed-citation></ref><ref id="hanspub.37213-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Liao, M., Lyu, P., He, M., et al. (2019) Mask TextSpotter: An End-to-End Trainable Neural Network for Spotting Text with Arbitrary Shapes. IEEE Transactions on Pattern Analysis and Machine Intelligence, PP(99), 1-1.  
&lt;br&gt;https://doi.org/10.1109/TPAMI.2019.2937086</mixed-citation></ref><ref id="hanspub.37213-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Shi, B., Bai, X. and Yao, C. (2016) An End-to-End Trainable Neural Network for Image-Based Sequence Recognition and Its Application to Scene Text Recognition. IEEE Trans-actions on Pattern Analysis &amp; Machine Intelligence, 39, 2298-2304. &lt;br&gt;https://doi.org/10.1109/TPAMI.2016.2646371</mixed-citation></ref></ref-list></back></article>