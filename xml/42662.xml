<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2021.115153</article-id><article-id pub-id-type="publisher-id">CSA-42662</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20210500000_12128735.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  粒子群算法优化的神经网络对MBR过滤阻力的预测
  Neural Network Optimized by Particle Swarm Algorithm for Prediction of MBR Filtering Resistance
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>鼎</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>春青</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>天津工业大学计算机科学与技术学院，天津</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>08</day><month>05</month><year>2021</year></pub-date><volume>11</volume><issue>05</issue><fpage>1496</fpage><lpage>1502</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   在MBR系统中，人们通常用膜通量或过滤阻力与操作参数的函数关系表征一个膜污染模型，但是膜污染是一个复杂的动态过程，经典的数学模型难以精确模拟。针对此问题，在本文中使用过滤阻力表征膜污染，利用BP神经网络对MBR系统中的膜的过滤阻力进行预测。然后利用粒子群算法优化神经网络的初始权值与阈值，提高神经网络获得全局最优解的能力。最后，我们将程序预测结果与实际实验数据做对比，发现该模型准确率较高，达到了预期效果。 In the MBR system, people usually use the functional relationship between membrane flux or filtration resistance and operating parameters to characterize a membrane fouling model, but membrane fouling is a complex dynamic process, and classical mathematical models are difficult to accurately simulate. In response to this problem, the filtration resistance is used to characterize membrane fouling in this article, and the BP neural network is used to predict the filtration resistance of the membrane in the MBR system. Then the particle swarm algorithm is used to optimize the initial weights and thresholds of the neural network to improve the ability of the neural network to obtain the global optimal solution. Finally, we compare the program prediction results with the actual experimental data, and find that the model has a higher accuracy rate and achieves the expected effect. 
  
 
</p></abstract><kwd-group><kwd>膜生物反应器，膜过滤阻力，粒子群算法，BP神经网络, Membrane Bio-Reactor (MBR)</kwd><kwd> Membrane Filtering Resistance</kwd><kwd> Particle Swarm Optimization (PSO) Algorithm</kwd><kwd> Back Propagation Neural Network (BP)</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>摘要</title><p>在MBR系统中，人们通常用膜通量或过滤阻力与操作参数的函数关系表征一个膜污染模型，但是膜污染是一个复杂的动态过程，经典的数学模型难以精确模拟。针对此问题，在本文中使用过滤阻力表征膜污染，利用BP神经网络对MBR系统中的膜的过滤阻力进行预测。然后利用粒子群算法优化神经网络的初始权值与阈值，提高神经网络获得全局最优解的能力。最后，我们将程序预测结果与实际实验数据做对比，发现该模型准确率较高，达到了预期效果。</p></sec><sec id="s2"><title>关键词</title><p>膜生物反应器，膜过滤阻力，粒子群算法，BP神经网络</p></sec><sec id="s3"><title>Neural Network Optimized by Particle Swarm Algorithm for Prediction of MBR Filtering Resistance</title><p>Ding Wang, Chunqing Li</p><p>School of Computer Science and Technology, Tianjin Polytechnic University, Tianjin</p><p><img src="//html.hanspub.org/file/30-1542172x4_hanspub.png" /></p><p>Received: Apr. 25<sup>th</sup>, 2021; accepted: May 20<sup>th</sup>, 2021; published: May 27<sup>th</sup>, 2021</p><p><img src="//html.hanspub.org/file/30-1542172x5_hanspub.png" /></p></sec><sec id="s4"><title>ABSTRACT</title><p>In the MBR system, people usually use the functional relationship between membrane flux or filtration resistance and operating parameters to characterize a membrane fouling model, but membrane fouling is a complex dynamic process, and classical mathematical models are difficult to accurately simulate. In response to this problem, the filtration resistance is used to characterize membrane fouling in this article, and the BP neural network is used to predict the filtration resistance of the membrane in the MBR system. Then the particle swarm algorithm is used to optimize the initial weights and thresholds of the neural network to improve the ability of the neural network to obtain the global optimal solution. Finally, we compare the program prediction results with the actual experimental data, and find that the model has a higher accuracy rate and achieves the expected effect.</p><p>Keywords:Membrane Bio-Reactor (MBR), Membrane Filtering Resistance, Particle Swarm Optimization (PSO) Algorithm, Back Propagation Neural Network (BP)</p><disp-formula id="hanspub.42662-formula63"><graphic xlink:href="//html.hanspub.org/file/30-1542172x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2021 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY 4.0).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/30-1542172x7_hanspub.png" /> <img src="//html.hanspub.org/file/30-1542172x8_hanspub.png" /></p></sec><sec id="s5"><title>1. 引言</title><p>随着城镇化率逐步提高，人们用水需求不断增长，水体污染加剧，水资源短缺的问题愈发严重。膜生物反应器(MBR)是一种新型的污水处理技术，它将高效膜分离技术与活性污泥生物处理单元相结合，相比于传统的生物处理方式有着明显优势，例如出水水质更好，运行过程中更加灵活稳定，并且占地面积小，全程自动化节省人力等 [<xref ref-type="bibr" rid="hanspub.42662-ref1">1</xref>]。</p><p>MBR系统由生物反应器和膜组件组成，其中各个膜组件相互连接。在MBR系统运行时，污水会流过各个膜组件，通过膜组件过滤掉大分子颗粒以此可以达到过滤污水的目的 [<xref ref-type="bibr" rid="hanspub.42662-ref2">2</xref>]。但MBR系统在运行过程中，膜污染引起的膜过滤阻力不断增加，膜过滤通量严重衰减的问题，仍是影响该项技术推广应用的关键所在 [<xref ref-type="bibr" rid="hanspub.42662-ref3">3</xref>]。</p><p>深入研究膜过滤阻力机理及其通量变化规律，是目前该工艺需要解决的关键问题。许多研究者对膜过滤阻力模型进行了分析研究，但由于过滤过程影响因素的多样性和物料体系的复杂性，尚无普遍适用的模型可用来预测膜过滤阻力变化时通量的变化规律 [<xref ref-type="bibr" rid="hanspub.42662-ref4">4</xref>]。神经网络是一种黑箱模型，具有自映射能力，是用来解决线性及非线性多变量问题的优良工具，具有精确预测，易于操作等特点 [<xref ref-type="bibr" rid="hanspub.42662-ref5">5</xref>]。因此，本文采用BP神经网络为算法主体，同时利用粒子群对神经网络的初始权值和阈值进行优化，提高了模型的训练效率和准确率。研究发现，利用此模型可以准确地预测膜生物反应器在污水处理过程中的膜过滤阻力，便于操作人员了解膜过滤过程长期的运行性能。</p></sec><sec id="s6"><title>2. BP神经网络</title><p>BP神经网络(BPNN)是在1986年由David E. Rumelhart等学者提出的，是一类基于误差逆向传播(Back Propagation，简称BP)算法的多层前馈神经网络 [<xref ref-type="bibr" rid="hanspub.42662-ref6">6</xref>]，BPNN由输入层、隐含层、输出层组成，每一层之间各神经元相互独立不连接，而层与层之间的神经元相互连接。单隐藏层的神经网络结构如图1所示。</p><p>BP神经网络的学习过程由前向计算过程和误差反向传播过程组成。在前向计算过程中，输入量从输入层经隐藏层逐层计算，并传向输出层，每层神经元的状态只影响下一层神经元的状态。如输出层不能得到期望的输出，则转入误差反向传播过程，误差信号沿原来的连接通路返回，逐次调整网络各层的权值和阈值，直至到达输入层，再重复计算。这两个过程反复迭代，通过不断调整各层的权值和阈值，使得与期望输出的误差最小，学习过程结束。</p><p>图1. 神经网络结构</p></sec><sec id="s7"><title>3. 粒子群算法</title><p>粒子群优化算法最早由Kennedy和Eberhart在1995年提出的种群优化算法。该算法最初是受到飞鸟集群活动的规律性启发，进而利用群体智能建立的一个简化模型 [<xref ref-type="bibr" rid="hanspub.42662-ref7">7</xref>]。粒子群算法在对动物集群活动行为观察基础上，利用群体中的个体对信息的共享使整个群体的运动在问题求解空间中产生从无序到有序的演化过程，从而获得最优解 [<xref ref-type="bibr" rid="hanspub.42662-ref8">8</xref>]。在粒子群优化算法中，首先需要初始化一群随机粒子，然后迭代寻找最优解。每一次迭代，粒子通过两个极值来更新自己，第一个是粒子个体经历过的最好位置 p B e s t ，第二个是种群经历过的最好位置 g B e s t 。</p><p>假设在一个D维的目标搜索空间中，有K个粒子组成种群，将第i个粒子的位置表示为一个D维向量，即 X i = ( X i 1 , X i 2 , ⋯ , X i D ) , i = 1 , 2 , ⋯ , N ，第i个粒子速度为 V i = ( V i 1 , V i 2 , ⋯ , V i D ) , i = 1 , 2 , ⋯ , N ，速度更新方程如下所示。</p><p>V i = V i + C 1 ( p B e s t − X i ) &#215; r a n d 1 + C 2 ( g B e s t − X i ) &#215; r a n d 2</p><p>其中 V i 是粒子更新的速度， X i 是粒子的当前位置， C 1 和 C 2 学习因子，也称为加速常数，主要对粒子的收敛性产生影响，通常来说 C 1 = C 2 = 2 ， p B e s t 是粒子个体经历过的最好位置， g B e s t 是种群经历过的最好位置， r a n d 1 和 r a n d 2 是[0,1]之间的随机数，位置更新后的状态如下。</p><p>X i = X i + V i</p><p>我们通常使用惯性因子 ω 来优化速度更新方程，动态 ω 在PSO搜索过程中可以动态变化，惯性因子取得值较大，粒子探测到新位置的可能性增加，全局寻优能力较好，但是算法的收敛速度较慢，值较小局部寻优能力好。优化后的方程如下所示：</p><p>V i = ω V i + C 1 ( p B e s t − X i ) &#215; r a n d 1 + C 2 ( g B e s t − X i ) &#215; r a n d 2</p><p>其中</p><p>ω = ω i n − ω e n d max i t e r &#215; i t e r + ω e n d</p></sec><sec id="s8"><title>4. 基于PSO-BP的膜过滤阻力预测模型</title><sec id="s8_1"><title>4.1. 神经网络参数选取</title><p>在MBR运行过程中，造成膜污染的因素很多，我们将进水流量Qinf，水质pH，溶解性固体总量TDS，跨膜压差，进水温度，膜通量，操作压力，这7个变量用作神经网络的输入，我们使用膜的过滤总阻力Rt来量化膜污染的程度，作为神经网络的输出。</p></sec><sec id="s8_2"><title>4.2. 建立基于PSO-BP膜过滤阻力预测模型</title><p>BP神经网络使用梯度下降法来进行函数拟合，但是此方法的缺点就是容易陷入局部极值点，这是因为在神经网络学习过程中没有引入额外参数，如果我们仅仅根据样本对初始权值和阈值进行调整，那么算法的性能将直接取决于权值的好坏。我们可以使用PSO粒子群算法优化神经网络的权值。首先计算出BP神经网络中权值的数量，该数量记作粒子群算法个体向量的维数，在该条件下随机生成粒子，然后按照粒子群算法过程进行学习迭代；在具体的迭代过程中，我们将算法优化后的个体的向量再转化成BP神经网络中的各连接权值。算法的流程图如下图2所示：</p><p>图2. PSO-BP算法程序流程图</p><p>具体的实验步骤如下：</p><p>步骤1 我们将收集的膜生物反应器数据做归一化处理后分为样本数据35组，校验样本12组。</p><p>步骤2 初始化神经网络，确定神经网络的结构并且给各参数赋初值。</p><p>步骤3 初始化PSO算法。给粒子群的参数赋初值，确定种群的规模，初始化粒子的速度和位置。</p><p>步骤4 计算每个粒子的适应度值，然后将粒子的适应度值与全局最优适应度值进行比较，如果达到了设定值，输出粒子的最优位置，否则继续迭代，更新粒子的速度和位置，迭代次数加一，重新计算适应度值，如果超过迭代次数，输出最优位置。</p><p>步骤5 用PSO算法的优化后最好位置来作为神经网络的系统参数，以期望值与神经网络的输出值之间的平方作为误差函数，反向传播更新权值与阈值。</p></sec></sec><sec id="s9"><title>5. 预测结果与实验结果对比分析</title><p>实验使用来自某污水处理厂的一些实验数据，此污水处理厂采用MBR污水处理工艺，过滤膜为NTR7450纳滤膜，滤芯为5 μm，操作压力为3.72 bar，进水流量为272 ml/min。我们使用35组实验数据作为训练样本，12组实验数据作为校验样本。</p><p>我们选取以下指标为输入变量：进水流量Qinf、pH、溶解性固体总量TDS、跨膜压差、进水温度、膜通量、操作压力作为输入变量。输出单元为膜的过滤阻力。本实验使用梯度下降法调整神经网络的参</p><p>数，隐藏层的激活函数为非线性sigmoid函数 f ( x ) = 1 1 + e − x 。通过将输入和输出数据除以相应的观察到</p><p>的最大值，将输入和输出数据归一化为范围[0,1]，防止数值溢出。然后将输入模式对应的BPNN输出与目标值进行比较，并调整权重以减小误差平方和。</p><p>本次实验通过matlab编程，用BP模型和PSO-BP模型分别对膜的过滤阻力进行计算。模型预测值与真实数据的对比如图3所示，两种模型的预测误差如表1所示，可见BP模型误差较大，PSO-BP模型误差相比于BPNN模型均方误差下降了0.0462，平均绝对百分比误差下降了19.4726%。PSO算法优化模型适应度如图4所示，当粒子进化代数等于7时，适应度较高，此时适应度下的权值和阈值为最优阈值。同时，在本文中为了得到最优的预测结果，所以为隐层节点数先设置一个初始值，然后在这个值的基础上逐渐增加，比较每次网络的预测性能，选择性能最好的对应的节点数作为隐含层神经元节点数。根据图5可以发现当隐藏层节点数为14时，该网络的均方误差最小，为0.1104。改进后的模型预测精度明显优于改进前的网络模型，且拟合度更好，稳定性和泛化性均有较大提升。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> PSO optimization neural network fitness curve grap</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >BP模型</th><th align="center" valign="middle" >PSO-BP模型</th></tr></thead><tr><td align="center" valign="middle" >平均绝对误差mae</td><td align="center" valign="middle" >0.1986</td><td align="center" valign="middle" >0.0343</td></tr><tr><td align="center" valign="middle" >均方误差mse</td><td align="center" valign="middle" >0.0484</td><td align="center" valign="middle" >0.0022</td></tr><tr><td align="center" valign="middle" >均方误差根rmse</td><td align="center" valign="middle" >0.2201</td><td align="center" valign="middle" >0.0476</td></tr><tr><td align="center" valign="middle" >平均绝对百分比误差mape</td><td align="center" valign="middle" >23.3837%</td><td align="center" valign="middle" >3.9104%</td></tr></tbody></table></table-wrap><p>表1. PSO优化BP适应度曲线图</p><p>图3. 神经网络预测值与真实值对比图</p><p>图4. PSO优化BP适应度曲线图</p><p>图5. 不同隐藏层节点数下的均方误差</p></sec><sec id="s10"><title>6. 结论</title><p>MBR处理污水是一个复杂的动态过程，本文建立了BP神经网络仿真预测模型用以预测膜过滤阻力，并且使用了粒子群算法优化BP神经网络的初始权值和阈值。实验结果表明，PSO-BP预测模型有着很高的精确度，图3所示的分别为过滤阻力的实际值、BP神经网络得到的预测值以及粒子群算法优化后的神经网络得到的预测值。通过观察发现使用PSO算法后的神经网络算法预测的结果精度更高，误差更小。本文的研究有一定的理论价值和实践意义，对MBR领域的研究有一定参考价值。</p></sec><sec id="s11"><title>文章引用</title><p>王 鼎,李春青. 粒子群算法优化的神经网络对MBR过滤阻力的预测Neural Network Optimized by Particle Swarm Algorithm for Prediction of MBR Filtering Resistance[J]. 计算机科学与应用, 2021, 11(05): 1496-1502. https://doi.org/10.12677/CSA.2021.115153</p></sec><sec id="s12"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.42662-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">薛万泽. 膜生物反应器在废水处理中的应用[J]. 城市建设理论研究: 电子版, 2015, 5(34): 885-886.</mixed-citation></ref><ref id="hanspub.42662-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">唐朝春, 段先月, 叶鑫, 陈惠民, 吴庆庆. MBR膜污染的机理及其影响因素研究进展[J]. 工业水处理, 2017, 37(4): 18-21.</mixed-citation></ref><ref id="hanspub.42662-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">王亚娥, 欧阳铭, 朱联锡. 膜生物反应器中UF膜过滤阻力影响因素[J]. 中国给水排水, 2000, 16(2): 55-57.</mixed-citation></ref><ref id="hanspub.42662-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">曹占平, 张景丽, 张宏伟. 微滤膜过滤阻力机理及模型研究[J]. 膜科学与技术, 2010, 30(1): 18-23.</mixed-citation></ref><ref id="hanspub.42662-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">石宝强, 张捍民, 杨凤林, 等. 人工神经网络在膜生物反应器膜污染预测中的应用前景[J]. 工业水处理, 2006, 26(12): 14-17.</mixed-citation></ref><ref id="hanspub.42662-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">时维国, 雷何芬. 基于PSO-BP神经网络的网络时延预测算法[J]. 自动化与仪表, 2020, 35(7): 1-5.</mixed-citation></ref><ref id="hanspub.42662-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">高尚, 杨静宇. 群智能算法及其应用[M]. 北京: 中国水利水电出版社, 2006.</mixed-citation></ref><ref id="hanspub.42662-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Delgrange, N., Cabassud, C., Cabassud, M., et al. (1998) Neural Networks for Prediction of Ultrafiltration Transmembrane Pressure—Application to Drinking Water Production. Journal of Membrane Science, 150, 111-123.  
&lt;br&gt;https://doi.org/10.1016/S0376-7388(98)00217-8</mixed-citation></ref></ref-list></back></article>