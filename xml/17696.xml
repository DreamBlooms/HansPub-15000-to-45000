<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AAM</journal-id><journal-title-group><journal-title>Advances in Applied Mathematics</journal-title></journal-title-group><issn pub-type="epub">2324-7991</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AAM.2016.52037</article-id><article-id pub-id-type="publisher-id">AAM-17696</article-id><article-categories><subj-group subj-group-type="heading"><subject>AAM20160200000_30435930.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于函数型数据的上证指数预测
  Prediction for the Shanghai Stock Index Based on the Functional Data
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>程</surname><given-names>丽娟</given-names></name><xref ref-type="aff" rid="aff1"><sub>1</sub></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>岭南师范学院数学与计算科学学院，广东 湛江</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>cheng_lijuan@163.com</email></corresp></author-notes><pub-date pub-type="epub"><day>05</day><month>05</month><year>2016</year></pub-date><volume>05</volume><issue>02</issue><fpage>291</fpage><lpage>297</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  在金融数据的研究中，经常遇到函数型数据。主要建立函数型主成分分析的预测模型，分析函数型数据在上证指数预测中的应用，根据函数型数据分析的原理及其求解主成分分析的方法，使用Matlab对上证指数进行预测。
   In the research of financial data, the functional data are often encountered. In this paper, the pre-diction model of functional principal components analysis is established to forecast the Shanghai Stock Index. Based on the principal component analysis theory and calculation method, the Shanghai Composite Index is forecasted by Matlab.
 
</p></abstract><kwd-group><kwd>函数型数据，主成分分析，预测, Functional Data</kwd><kwd> Principal Component Analysis</kwd><kwd> Forecast</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于函数型数据的上证指数预测<sup> </sup></title><p>程丽娟</p><p>岭南师范学院数学与计算科学学院，广东 湛江</p><disp-formula id="hanspub.17696-formula128"><graphic xlink:href="http://html.hanspub.org/file/17-2620260x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年5月6日；录用日期：2016年5月27日；发布日期：2016年5月30日</p><disp-formula id="hanspub.17696-formula129"><graphic xlink:href="http://html.hanspub.org/file/17-2620260x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>在金融数据的研究中，经常遇到函数型数据。主要建立函数型主成分分析的预测模型，分析函数型数据在上证指数预测中的应用，根据函数型数据分析的原理及其求解主成分分析的方法，使用Matlab对上证指数进行预测。</p><p>关键词 :函数型数据，主成分分析，预测</p><disp-formula id="hanspub.17696-formula130"><graphic xlink:href="http://html.hanspub.org/file/17-2620260x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>传统的数据分析中，获得的数据包括截面数据、时间序列数据以及面板数据，但是对这三种数据分析时要依赖许多的假设条件，适用数据的类型具有一定的局限性，加拿大学者J.O. Ramsay在1982年首次给出将泛函分析、拓扑学和统计学相结合的设想，提出“函数型数据”的概念以及函数型数据的分析方法 [<xref ref-type="bibr" rid="hanspub.17696-ref1">1</xref>] 。近年来，函数型数据分析广泛应用在医学、气象学、生物学等领域。金融数据间隔较短，可以视为连续数据，即函数型数据，因而可以进行函数型数据分析 [<xref ref-type="bibr" rid="hanspub.17696-ref2">2</xref>] 。</p><p>本文主要建立函数型主成分分析的预测模型，分析函数型数据在上证指数预测中的应用，根据函数型数据分析的原理及其求解主成分分析的方法，使用Matlab软件对上证指数进行预测。</p></sec><sec id="s4"><title>2. 函数型数据分析</title><p>对于原始数据序列<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x9_hanspub.png" xlink:type="simple"/></inline-formula>，建立回归模型</p><disp-formula id="hanspub.17696-formula131"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x11_hanspub.png" xlink:type="simple"/></inline-formula>为原始数据序列的函数在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x12_hanspub.png" xlink:type="simple"/></inline-formula>时的取值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x13_hanspub.png" xlink:type="simple"/></inline-formula>为噪声，表示观测数据中的扰动因素、误差或其它外生因素 [<xref ref-type="bibr" rid="hanspub.17696-ref3">3</xref>] 。在标准的统计模型中，通常假定<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x14_hanspub.png" xlink:type="simple"/></inline-formula>服从零均值有限方差的独立分布，且通常假定方差相等。但在处理函数型数据时，可以放松这些假设条件，使模型更加符合现实中的问题。在函数型数据分析中，首先要考虑到原始数据的选取问题，而原始数据的选取要通过抽样率来进行。原始数据在时间轴上的曲率不同，通常曲率值大的地方，相应的数据分布比较密，因此在曲率大的地方应该选取较多的数据点，曲率可以用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x15_hanspub.png" xlink:type="simple"/></inline-formula>表示 [<xref ref-type="bibr" rid="hanspub.17696-ref4">4</xref>] 。</p><sec id="s4_1"><title>2.1. 数据平滑</title><p>最简单的平滑方法为线性平滑，线性平滑法是指用离散观测值的线性组合去估计函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x16_hanspub.png" xlink:type="simple"/></inline-formula>，线性平滑可以衍生出平滑算子的许多性质，并且其运算速度较快，但是有时非线性平滑方法在不同的数据和同一个数据的不同部分，结果会更优良，因而本文考虑基函数平滑法。基函数平滑法是将离散的观测数据转化为相应函数的平滑方法，基函数能够保留待估函数的性质。它是用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x17_hanspub.png" xlink:type="simple"/></inline-formula>个己知的基函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x18_hanspub.png" xlink:type="simple"/></inline-formula>的线性组合得到函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x19_hanspub.png" xlink:type="simple"/></inline-formula>的估计<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x20_hanspub.png" xlink:type="simple"/></inline-formula>，即</p><disp-formula id="hanspub.17696-formula132"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x21_hanspub.png"  xlink:type="simple"/></disp-formula><p>对函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x22_hanspub.png" xlink:type="simple"/></inline-formula>的估计包括两部分，第一步是选取用来拟合的基函数，第二步是估计每个基函数前面的系数。基函数的个数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x23_hanspub.png" xlink:type="simple"/></inline-formula>决定了观测数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x24_hanspub.png" xlink:type="simple"/></inline-formula>的平滑度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x25_hanspub.png" xlink:type="simple"/></inline-formula>越小，拟合的函数越平滑，但拟合程度就越差。</p><p>采用基函数平滑方法时，常选用的基函数包括傅立叶基，B-Spline基，多项式基，常数基等。对于周期性的数据常采用傅里叶基，对于非周期性的数据通常用B-Spline基进行拟合 [<xref ref-type="bibr" rid="hanspub.17696-ref5">5</xref>] 。在基函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x26_hanspub.png" xlink:type="simple"/></inline-formula>确定的情况下，系数向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x27_hanspub.png" xlink:type="simple"/></inline-formula>的一组取值唯一地确定一个函数。估计系数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x28_hanspub.png" xlink:type="simple"/></inline-formula>的最简单方法是最小二乘法，即最小化残差平方和：</p><disp-formula id="hanspub.17696-formula133"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>解得<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x30_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>从观测值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x31_hanspub.png" xlink:type="simple"/></inline-formula>来估计曲线<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x32_hanspub.png" xlink:type="simple"/></inline-formula>，则曲线估计的两个目标：一方面，估计的曲线和数据较好地拟合，即使残差平方和最小。另一方面，如果得到的曲线波动很大或局部变化过大的话不希望拟合的太好，即放弃一定程度的拟合度，达到较好的平滑度。因此，我们定义带惩罚的残差平方和为：</p><disp-formula id="hanspub.17696-formula134"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x33_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x34_hanspub.png" xlink:type="simple"/></inline-formula>，即为惩罚项，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x35_hanspub.png" xlink:type="simple"/></inline-formula>称为平滑参数。通过最小化<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x36_hanspub.png" xlink:type="simple"/></inline-formula>，以获得估计函数。</p><p>上式中的第一项度量了曲线的拟合效果，第二项度量了曲线的平滑度。正的常数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x37_hanspub.png" xlink:type="simple"/></inline-formula>决定了拟合度与平滑度之间的平衡，当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x38_hanspub.png" xlink:type="simple"/></inline-formula>较小时，惩罚项对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x39_hanspub.png" xlink:type="simple"/></inline-formula>影响较小；当<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x40_hanspub.png" xlink:type="simple"/></inline-formula>较大时，在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x41_hanspub.png" xlink:type="simple"/></inline-formula>上产生较大的粗糙惩罚。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x42_hanspub.png" xlink:type="simple"/></inline-formula>的值由广义交叉验证法确定。</p></sec><sec id="s4_2"><title>2.2. 函数型主成分分析</title><p>函数型数据主成分分析是将变量看作函数的形式，其样本的协方差矩阵也变为函数的形式，因此可以避免出现高维的协方差矩阵。在函数数据下，观测矩阵为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x43_hanspub.png" xlink:type="simple"/></inline-formula>，它表示对同一个变量进行了<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x44_hanspub.png" xlink:type="simple"/></inline-formula>次重复观测，每次所得到的观测数据构成一个函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x45_hanspub.png" xlink:type="simple"/></inline-formula>，此时，函数型数据的主成分的线性组合为：</p><disp-formula id="hanspub.17696-formula135"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x46_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中下标<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x47_hanspub.png" xlink:type="simple"/></inline-formula>表示第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x48_hanspub.png" xlink:type="simple"/></inline-formula>次重复观测，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x49_hanspub.png" xlink:type="simple"/></inline-formula>为权重函数，即函数型主成分的特征函数。</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x50_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x51_hanspub.png" xlink:type="simple"/></inline-formula>的协方差为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x52_hanspub.png" xlink:type="simple"/></inline-formula>，则有<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x53_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>函数型数据的第一主成分<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x54_hanspub.png" xlink:type="simple"/></inline-formula>的求解为求下面有约束条件的最大化问题：</p><disp-formula id="hanspub.17696-formula136"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x55_hanspub.png"  xlink:type="simple"/></disp-formula><p>同样的，第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x56_hanspub.png" xlink:type="simple"/></inline-formula>个主成分<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x57_hanspub.png" xlink:type="simple"/></inline-formula>的求解就是在上式的最大化问题中添加约束条件<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x58_hanspub.png" xlink:type="simple"/></inline-formula>求得 [<xref ref-type="bibr" rid="hanspub.17696-ref6">6</xref>] 。</p><p>函数型主成分的权重函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x59_hanspub.png" xlink:type="simple"/></inline-formula>满足特征方程<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x60_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x61_hanspub.png" xlink:type="simple"/></inline-formula>为特征值。</p><p>记<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x62_hanspub.png" xlink:type="simple"/></inline-formula>，则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x63_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>函数型主成分分析中数据<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x64_hanspub.png" xlink:type="simple"/></inline-formula>是函数的形式，样本的个数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x65_hanspub.png" xlink:type="simple"/></inline-formula>决定了其协方差算子<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x66_hanspub.png" xlink:type="simple"/></inline-formula>的秩为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x67_hanspub.png" xlink:type="simple"/></inline-formula>。因此其非零特征值的最大个数为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x68_hanspub.png" xlink:type="simple"/></inline-formula>，进而满足约束条件的主成分的最大个数为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x69_hanspub.png" xlink:type="simple"/></inline-formula>。在实际观测中，我们通常选取样本个数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x70_hanspub.png" xlink:type="simple"/></inline-formula>与观测点的个数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x71_hanspub.png" xlink:type="simple"/></inline-formula>，至少应该满足<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x72_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>函数型主成分的选取思想与多元主成分的选取相同，根据所研究问题的需要确定累积贡献率，选择合适的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x73_hanspub.png" xlink:type="simple"/></inline-formula>使得<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x74_hanspub.png" xlink:type="simple"/></inline-formula>达到所确定的累积贡献率，一般要求累积贡献率不小于85%。</p></sec><sec id="s4_3"><title>2.3. 函数型主成分预测模型</title><p>设随机过程<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x75_hanspub.png" xlink:type="simple"/></inline-formula>均方连续，且二次可积。设随机变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x76_hanspub.png" xlink:type="simple"/></inline-formula>是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x77_hanspub.png" xlink:type="simple"/></inline-formula>的线性均方估计，则有<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x78_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x79_hanspub.png" xlink:type="simple"/></inline-formula>是希尔伯特空间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x80_hanspub.png" xlink:type="simple"/></inline-formula>的一个希尔伯特子空间。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x81_hanspub.png" xlink:type="simple"/></inline-formula>是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x82_hanspub.png" xlink:type="simple"/></inline-formula>在子空间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x83_hanspub.png" xlink:type="simple"/></inline-formula>上的正交投影，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x84_hanspub.png" xlink:type="simple"/></inline-formula>，从而有</p><disp-formula id="hanspub.17696-formula137"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x85_hanspub.png"  xlink:type="simple"/></disp-formula><p>设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x86_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x87_hanspub.png" xlink:type="simple"/></inline-formula>在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x88_hanspub.png" xlink:type="simple"/></inline-formula>的线性预测的均方误差，表示为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x89_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>分别提取两个区间的主成分，随机过程<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x90_hanspub.png" xlink:type="simple"/></inline-formula>在<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x91_hanspub.png" xlink:type="simple"/></inline-formula>中第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x92_hanspub.png" xlink:type="simple"/></inline-formula>个主成分定义为：</p><disp-formula id="hanspub.17696-formula138"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x93_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x94_hanspub.png" xlink:type="simple"/></inline-formula>称为主因子，它是对应于协方差函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x95_hanspub.png" xlink:type="simple"/></inline-formula>的第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x96_hanspub.png" xlink:type="simple"/></inline-formula>大特征值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x97_hanspub.png" xlink:type="simple"/></inline-formula>的正则化的特征函数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x98_hanspub.png" xlink:type="simple"/></inline-formula>是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x99_hanspub.png" xlink:type="simple"/></inline-formula>的均值函数 [<xref ref-type="bibr" rid="hanspub.17696-ref7">7</xref>] 。</p><p>第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x100_hanspub.png" xlink:type="simple"/></inline-formula>个主成分解释的方差(即方差的累积贡献率)为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x101_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x102_hanspub.png" xlink:type="simple"/></inline-formula>是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x103_hanspub.png" xlink:type="simple"/></inline-formula>在区间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x104_hanspub.png" xlink:type="simple"/></inline-formula>中的总方差，表示的样本数据波动的程度，即<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x105_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>随机过程<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x106_hanspub.png" xlink:type="simple"/></inline-formula>可以Karhunen-Lo&#232;ve正交展开，则有<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x107_hanspub.png" xlink:type="simple"/></inline-formula>，同样，设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x108_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x109_hanspub.png" xlink:type="simple"/></inline-formula>分别表示在区间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x110_hanspub.png" xlink:type="simple"/></inline-formula>上的特征函数和主成分，则随机过程<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x111_hanspub.png" xlink:type="simple"/></inline-formula>用Karhunen-Lo&#232;ve正交展开表示为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x112_hanspub.png" xlink:type="simple"/></inline-formula>，若区间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x113_hanspub.png" xlink:type="simple"/></inline-formula>表示的是未来的一个时间区间，则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x114_hanspub.png" xlink:type="simple"/></inline-formula>的线性最小二乘估计<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x115_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x116_hanspub.png" xlink:type="simple"/></inline-formula> [<xref ref-type="bibr" rid="hanspub.17696-ref8">8</xref>] ，其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x117_hanspub.png" xlink:type="simple"/></inline-formula>为随机变量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x118_hanspub.png" xlink:type="simple"/></inline-formula>的主成分<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x119_hanspub.png" xlink:type="simple"/></inline-formula>的线性最小二乘估计，表示为</p><disp-formula id="hanspub.17696-formula139"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x120_hanspub.png"  xlink:type="simple"/></disp-formula><p>对上式中的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x121_hanspub.png" xlink:type="simple"/></inline-formula>序列，每个序列我们取前<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x122_hanspub.png" xlink:type="simple"/></inline-formula>个主成分拟合，得到最小二乘估计量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x123_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x124_hanspub.png" xlink:type="simple"/></inline-formula>，因此，主成分预测模型<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x125_hanspub.png" xlink:type="simple"/></inline-formula>为</p><disp-formula id="hanspub.17696-formula140"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/17-2620260x126_hanspub.png"  xlink:type="simple"/></disp-formula></sec></sec><sec id="s5"><title>3. 实证分析</title><p>本文选取我国上证指数作为研究对象，选取2015年4月7日至6月8日的5分钟收益率数据。为了避免“隔夜效应”的影响，在进行数据分析时，舍弃每天的第一个数据(即9:35时刻)，把每天的5分钟收益率数据视为其对应函数产生的一组样本观测值，使用B样条插值法对这些样本观测值进行拟合，并进行平滑处理，然后根据得到的光滑曲线求出其变化速度曲线，即一阶导数曲线，如下图所示。图1表示的是收益率曲线及其平滑曲线，其中绿线表示的原数据，蓝线表示的是B样条插值法得到的曲线，红线表示对B样条插值法得到的曲线平滑处理后得到的新曲线。图2表示的是B样条插值法得到曲线的一阶导数曲线。</p><p>图1. 收益率曲线及其平滑曲线</p><p>图2. 一阶导数曲线</p><p>得到平滑函数后，为分析收益率在时间上的差异，将收益率分为两个区间，其中前30天为第一区间，后14天为第二区间，分别对两个区间的收益率函数进行函数型主成分分析，如下图所示。图3表示第一区间的前两个主成分，其中PC1对应的方差贡献率是52.9%，PC2对应的方差贡献率是47.1%，图4表示第二区间的前两个主成分，其中PC1对应的方差贡献率是58.2%，PC2对应的方差贡献率是27.3%。</p><p>根据表1中的方差贡献率，在第一区间选取全部2个主成分。在第二个区间里，第一、二主成分的方差贡献率已经达到了85.5%，因此选取前两个主成分表示第二区间内收益率的变化特征。</p><p>观察表2中的相关系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x129_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x130_hanspub.png" xlink:type="simple"/></inline-formula>的相关系数为1.0000，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x131_hanspub.png" xlink:type="simple"/></inline-formula>与<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x132_hanspub.png" xlink:type="simple"/></inline-formula>的相关系数为1.0000，远远大于其它的相关，因此，选取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x133_hanspub.png" xlink:type="simple"/></inline-formula>对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x134_hanspub.png" xlink:type="simple"/></inline-formula>做最小二乘估计，选取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x135_hanspub.png" xlink:type="simple"/></inline-formula>对<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x136_hanspub.png" xlink:type="simple"/></inline-formula>做最小二乘估计，由此得到<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x137_hanspub.png" xlink:type="simple"/></inline-formula>模型为</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x138_hanspub.png" xlink:type="simple"/></inline-formula>：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x139_hanspub.png" xlink:type="simple"/></inline-formula></p><disp-formula id="hanspub.17696-formula141"><graphic xlink:href="http://html.hanspub.org/file/17-2620260x140_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.17696-formula142"><graphic xlink:href="http://html.hanspub.org/file/17-2620260x141_hanspub.png"  xlink:type="simple"/></disp-formula><p>将观测到的真实值、模型估计出的预测值及由两者得到的误差百分比如下表所示。</p><p>由表3可以看出，除6月12日误差百分比较大以外，绝大部分的误差百分比都较小。因此说明建立的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x142_hanspub.png" xlink:type="simple"/></inline-formula>模型具有很好的准确性。综上知，建立函数型主成分预测模型对我国上证指数收益率进行预测，预测的准确程度较高。</p><p>图3. 主成分权重函数(第一区间)</p><p>图4. 主成分权重函数(第二区间)</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Principal component characteristic value and contribution rat</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >主成分</th><th align="center" valign="middle"  colspan="3"  >前30天</th><th align="center" valign="middle"  colspan="3"  >后14天</th></tr></thead><tr><td align="center" valign="middle" >特征值</td><td align="center" valign="middle" >贡献率</td><td align="center" valign="middle" >累计贡献率</td><td align="center" valign="middle" >特征值</td><td align="center" valign="middle" >贡献率</td><td align="center" valign="middle" >累计贡献率</td></tr><tr><td align="center" valign="middle" >1</td><td align="center" valign="middle" >0.0099</td><td align="center" valign="middle" >52.9%</td><td align="center" valign="middle" >52.9%</td><td align="center" valign="middle" >0.0056</td><td align="center" valign="middle" >58.2%</td><td align="center" valign="middle" >58.2%</td></tr><tr><td align="center" valign="middle" >2</td><td align="center" valign="middle" >0.0088</td><td align="center" valign="middle" >47.1%</td><td align="center" valign="middle" >100%</td><td align="center" valign="middle" >0.0026</td><td align="center" valign="middle" >27.3%</td><td align="center" valign="middle" >85.5%</td></tr></tbody></table></table-wrap><p>表1. 主成分特征值与贡献率</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Correlation coefficien</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x145_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x146_hanspub.png" xlink:type="simple"/></inline-formula></th></tr></thead><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x147_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >1.0000</td><td align="center" valign="middle" >-0.0655</td></tr><tr><td align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/17-2620260x148_hanspub.png" xlink:type="simple"/></inline-formula></td><td align="center" valign="middle" >-0.0655</td><td align="center" valign="middle" >1.0000</td></tr></tbody></table></table-wrap><p>表2. 相关系数</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Real value and predictive valu</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >6月9日</th><th align="center" valign="middle" >6月10日</th><th align="center" valign="middle" >6月11日</th><th align="center" valign="middle" >6月12日</th></tr></thead><tr><td align="center" valign="middle" >真实值</td><td align="center" valign="middle" >−0.00357</td><td align="center" valign="middle" >−0.00146</td><td align="center" valign="middle" >0.00304</td><td align="center" valign="middle" >0.00874</td></tr><tr><td align="center" valign="middle" >预测值</td><td align="center" valign="middle" >−0.00338</td><td align="center" valign="middle" >−0.00139</td><td align="center" valign="middle" >0.00309</td><td align="center" valign="middle" >0.00793</td></tr><tr><td align="center" valign="middle" >误差百分比</td><td align="center" valign="middle" >5.32%</td><td align="center" valign="middle" >4.79%</td><td align="center" valign="middle" >−4.93%</td><td align="center" valign="middle" >9.27%</td></tr></tbody></table></table-wrap><p>表3. 真实值与预测值</p></sec><sec id="s6"><title>4. 结论</title><p>本文对函数型数据分析方法和函数型数据分析方法在上证指数中的应用进行了研究，介绍了函数型数据分析的研究意义，以及函数型数据的均值函数、方差函数、协方差函数、相关系数函数等描述统计量。研究了函数型数据的主成分分析方法以及如何建立函数型主成分预测模型。通过对上证指数收益率进行预测的实证分析，得到建立函数型主成分预测模型对我国上证指数收益率进行预测，预测的准确程度较高。</p></sec><sec id="s7"><title>基金项目</title><p>岭南师范学院自然科学青年项目《基于函数型数据的统计分析及应用》(QL1407)。</p></sec><sec id="s8"><title>文章引用</title><p>程丽娟. 基于函数型数据的上证指数预测Prediction for the Shanghai Stock Index Based on the Functional Data[J]. 应用数学进展, 2016, 05(02): 291-297. http://dx.doi.org/10.12677/AAM.2016.52037</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.17696-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Ramsay, J.O. (1982) When the Data Are Functions. Psychometrika, 47, 379-396.  
&lt;br&gt;http://dx.doi.org/10.1007/BF02293704</mixed-citation></ref><ref id="hanspub.17696-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Delicado, P. (2011) Dimensionality Reduction When Data Are Density Functions. Computational Statistics and Data Analysis, 55, 401-420. &lt;br&gt;http://dx.doi.org/10.1016/j.csda.2010.05.008</mixed-citation></ref><ref id="hanspub.17696-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">严明义. 季节数据分析: 一种基于数据的函数性视角的分析方法[J]. 当代经济科学, 2007(1): 108-113.</mixed-citation></ref><ref id="hanspub.17696-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">严明义, 等. 中国消费价格指数季节被动的函数性数据分析[J]. 统计与信息论坛, 2010(8): 100-106.</mixed-citation></ref><ref id="hanspub.17696-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Mallor, F., Leon, T. and Gaston, M. (2010) Changes in Power Curve Shapes as an Indicator of Fatigue during Dynamic Contractions. Journal of Biomechanics, 43, 1627-1631. &lt;br&gt;http://dx.doi.org/10.1016/j.jbiomech.2010.01.038</mixed-citation></ref><ref id="hanspub.17696-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Ramsay, J.O. and Hooker, G. (2009) Functional Data Analysis with R and MATLAB. Springer, New York. 
&lt;br&gt;http://dx.doi.org/10.1007/978-0-387-98185-7</mixed-citation></ref><ref id="hanspub.17696-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Shang, H.L. (2010) Nonparametric Modeling and Forecasting Electricity Demand: An Empirical Study. Working Paper.</mixed-citation></ref><ref id="hanspub.17696-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Berrendero, J.R. (2011) Principal Components for Multivariate Functional Data. Computational Statistics and Data Analysis, 55, 2619-2634. &lt;br&gt;http://dx.doi.org/10.1016/j.csda.2011.03.011</mixed-citation></ref></ref-list></back></article>