<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2017.74040</article-id><article-id pub-id-type="publisher-id">CSA-20253</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20170400000_20588412.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  物联网智能浇灌控制系统
  Intelligent Irrigation Control System Using Internet of Things
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>冯</surname><given-names>雨轩</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>圣玥</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>丹丹</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>仁春</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>赵</surname><given-names>立杰</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>邢</surname><given-names>杰</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>沈阳化工大学信息工程学院，辽宁 沈阳</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>zlj_lunlun@163.com(赵立)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>18</day><month>4</month><year>2017</year></pub-date><volume>07</volume><issue>04</issue><fpage>329</fpage><lpage>335</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   传统果园种植低效且工作繁重，物联网技术+传统果园种植的模式有利于提高果园管理效率。本文采用STM32系类单片机、2.4 G无线模块，结合Unity3D引擎移动开发平台，设计和开发了一种物联网+Unity3D可交互智能化虚拟现实果园种植远程监控控制系统。该系统由底层部分和顶层部分组成，底层部分设计使用土壤湿度传感器和空气温湿度传感器检测果园土壤温度和外部环境温度和湿度信息，控制器根据不同果树土壤湿度设定值，调节电磁阀，控制浇水量。顶层部分设计建立三维虚拟场景，实现场景漫游、实时监视、信息显示功能。底层部分与顶层部分建立协议，通过查询果树养殖专业信息设定智能浇灌，同时也建立远程手动控制浇灌，方便管理人员随时查看数据和远程控制浇灌，降低果园养护难度。 Traditional orchard cultivation is inefficient and heavy work, and the Internet of Things technol-ogy + traditional orchard cultivation mode is conducive to improving the efficiency of the orchard management. In this paper, with STM32 series of single-chip microcomputer, 2.4 G wireless module, and Unity3D engine mobile development platform, we design and develop an orchard planting remote monitoring and control system of Internet of Things + Unity3D interactive intelligent virtual reality. The system consists of the bottom part and the top part of the composition. The bottom part of the design uses soil moisture sensors and air temperature and humidity sensors to detect the soil temperature and outdoor environment temperature and humidity information. According to different fruit soil moisture settings, the controller adjusts the solenoid valve and controls the amount of irrigation. The top part of the design establishes three-dimensional virtual scene to achieve roaming, real-time monitoring, and information display. The bottom part establishes protocols with the top part, then we can investigate fruit tree farming professional information to set the intelligent watering, and establish remote manual control watering, which facilitate the management staff at any time to view the data and remotely control watering, thus reducing the difficulty of orchards maintenance.
    
  
 
</p></abstract><kwd-group><kwd>智慧果园，远程控制与监测，物联网，虚拟现实, Smart Orchards</kwd><kwd> Remote Control and Detection</kwd><kwd> Internet of Things</kwd><kwd> Virtual Reality</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>物联网智能浇灌控制系统<sup> </sup></title><p>冯雨轩，王圣玥，杨丹丹，郭仁春，赵立杰，邢杰</p><p>沈阳化工大学信息工程学院，辽宁 沈阳</p><disp-formula id="hanspub.20253-formula15"><graphic xlink:href="http://html.hanspub.org/file/6-1540760x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2017年4月4日；录用日期：2017年4月17日；发布日期：2017年4月27日</p><disp-formula id="hanspub.20253-formula16"><graphic xlink:href="http://html.hanspub.org/file/6-1540760x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>传统果园种植低效且工作繁重，物联网技术+传统果园种植的模式有利于提高果园管理效率。本文采用STM32系类单片机、2.4 G无线模块，结合Unity3D引擎移动开发平台，设计和开发了一种物联网+Unity3D可交互智能化虚拟现实果园种植远程监控控制系统。该系统由底层部分和顶层部分组成，底层部分设计使用土壤湿度传感器和空气温湿度传感器检测果园土壤温度和外部环境温度和湿度信息，控制器根据不同果树土壤湿度设定值，调节电磁阀，控制浇水量。顶层部分设计建立三维虚拟场景，实现场景漫游、实时监视、信息显示功能。底层部分与顶层部分建立协议，通过查询果树养殖专业信息设定智能浇灌，同时也建立远程手动控制浇灌，方便管理人员随时查看数据和远程控制浇灌，降低果园养护难度。</p><p>关键词 :智慧果园，远程控制与监测，物联网，虚拟现实</p><disp-formula id="hanspub.20253-formula17"><graphic xlink:href="http://html.hanspub.org/file/6-1540760x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>传统果园种植手工劳动方式造成果园养护效率低下，果农劳动强度大。由于专业养护人员的缺乏、果树养护不及时，常常导致果树营养不良甚至死亡，给果农造成极大的损失。随着信息时代的高速发展，传统产业迎来了物联网时代。如何让电脑客户端和手机APP应用程序自动检测控制果树的生长情况，在果树缺失水分时自动通知果农，并进行自动浇水。通过远程监控控制功能实现智能管理，越来越受到关注，因此迫切需要一种可交互智能化果园种植虚拟现实监控控制系统。</p><p>文 [<xref ref-type="bibr" rid="hanspub.20253-ref1">1</xref>] 设计的基于PC机和单片机智能灌溉系统无智能终端即智能手机APP操控，极大的限制了远程操作的距离。文 [<xref ref-type="bibr" rid="hanspub.20253-ref2">2</xref>] 设计开发了一种基于ZigBee技术实现农田节水灌溉、施肥以及信息采集与处理的系统数据只能通过路由器传输，限制了数据传输和控制的范围。文 [<xref ref-type="bibr" rid="hanspub.20253-ref3">3</xref>] 发明的基于无线传感器网络智能灌溉系统仅仅可通过无线网络对果园进行浇水控制，但无法检测到果树周围环境的具体信息，同时需要大量的接线不利于在果园安装和维护。虚拟现实作为一种高度逼真的交互式视景仿真技术，在军事、医学、设计和娱乐等领域得到广泛应用 [<xref ref-type="bibr" rid="hanspub.20253-ref4">4</xref>] 。但是，基于虚拟现实技术的可交互远程智能果园浇灌系统尚未见报道。</p><p>针对以上已有研究中出现的问题，本文设计和开发了一种物联网 + Unity3D可交互智能化虚拟现实果园种植远程监控控制系统。该系统具有数字化、网络化、虚拟与现实的深度融合的特点。系统硬件采用STM32系类单片机、2.4 G无线模块，虚拟仿真应用程序的开发选用Unity3D引擎移动开发平台。整个系统包括底层部分和顶层部分。其中，底层部分的功能是：对果树进行实时信息采集和控制，顶层部分的功能是实现虚拟漫游、实时信息显示、远程控制功能。顶层部分和顶层部分通过GPRS模块进行数据交换和传输。</p></sec><sec id="s4"><title>2. 系统总体结构和功能设计</title><sec id="s4_1"><title>2.1. 总体结构设计</title><p>本文提出一种可交互智能化果园种植虚拟现实监控控制系统，该系统由底层部分和顶层部分组成，如图1所示。底层部分包括：核心控制器STM32系类单片机、2.4 G无线模块、土壤湿度传感器、空气温湿度传感器、485通信模块、GPRS模块、继电器模块、水泵、水管、喷头。顶层部分包括：PC端和手机APP。</p><p>土壤和空气环境信息采集部分采集部分：采用主—从机模式，主从机均采用STM32F103系列单片机，主机采集空气环境的温湿度和其所在区域的土壤湿度信息，从机负责采集其他区域的土壤湿度信息，并且通过2.4 G通信模块 [<xref ref-type="bibr" rid="hanspub.20253-ref5">5</xref>] 与主机通信，实现一主机多从机的模式，主机收集到各区域的环境信息后将数据发送给上位机。</p><p>底层控制系统的设计与开发：电磁阀一端通过水管连接水泵，另一端通过水管连接到土壤，将单片机信号线与继电器接口相连，继电器触点和电磁阀连接，通过改变I/O口的高低电平就可完成对浇灌动作的控制。</p><p>下位机与上位机之间通信系统的设计开发：STM32通过串口将数据发送到485模块上，再传输到USR-GPRS-730上，上位机通过TCP/IP协议与GPRS进行通信，使得上位机与下位机可通过物联网相互传送数据。同时，上位机与下位机建立协议，上位机可根据下位机发出的信息进行处理并反馈数据到下位机，下位机根据反馈数据后进行对应的控制处理。</p><p>客户端三纬虚拟人机交互APP设计与开发 [<xref ref-type="bibr" rid="hanspub.20253-ref6">6</xref>] ：采用3D Max进行场景建模、渲染和加工，生成3D模型文件后导入Unity3D，后台c#.net脚本语言进行场景漫游、信息显示和远程控制实现 [<xref ref-type="bibr" rid="hanspub.20253-ref7">7</xref>] 。</p><p>底层部分封装进一个独立设计的包装中，底层部分都是无线进行相互连接，方便安装和使用；顶层部分开发APP，可以让使用者方便操作和远程监测。最终结合成一个完善的3D数字化智慧果园管理系统。</p><p>图1. 系统总体结构图</p></sec><sec id="s4_2"><title>2.2. 系统功能设计</title><p>本系统将传感器采集到的信息通过2.4 G无线网络同意发送至主核心控制器STM32系类单片机，对果树信息进行实时采集，采用Unity3D引擎开发移动平台实现虚拟现实应用程序开发。通过三维虚拟场景漫游，与果树浇灌设备交互实现远程开启停止控制，应用虚拟现实VR技术，实现智能浇灌控制，手自动工作切换模式功能。</p><p>具体包括：</p><p>1) 信息监测：PC端和手机APP信息显示面板自动显示果树品种、当前环境温湿度、土壤温度和浇灌湿度控制系统设定值。</p><p>2) 远程控制：设置了手动浇灌模式和自动浇灌模式。开启自动模式，系统根据实时采集的土壤湿度信息，比较温湿度传感器采样值和控制系统设定值之间的大小，根据差值调整浇水量。手动模式时，可通过PC端或者APP进行对果园的管理，由于对果园进行了三维场景的建立，因此，果农可以直接看到果园的全部场景，利用鼠标点击电脑屏幕或者使用手机APP直接点击手机屏幕对果树进行浇灌。</p><p>3) 场景漫游：通过场景前后左右移动和旋转漫游，查看果园场景漫游。</p></sec></sec><sec id="s5"><title>3. 系统开发关键技术</title><p>3D数字化智慧果园系统开发包括底层控制系统开发和顶层远程站客户端应用程序开发。底层部分核心控制器采用STM32F103系列单片机最小系统板将收集的土壤和环境空气信息的模拟数据转为二进制数据，STM32F103系列单片机成本低、体积小、开发简单、系统开发灵活，并且STM32F103系列单片机中断、定时器等外设多，非常适用于控制。虚拟现实开发选择Unity3D平台 [<xref ref-type="bibr" rid="hanspub.20253-ref8">8</xref>] ，它具有大型场景支持和在线控制功能，模块资源丰富，编程周期短，脚本强大，渲染高速的优点。</p><sec id="s5_1"><title>3.1. 传感器数据采集和单片机的数据处理</title><p>通过湿度传感器采集土壤的湿度信号和通过温度传感器采集空气、土壤、水的温度信号，通过单片机的AD模块采样并转换成单片机能识别的信号后送入核心控制单元，核心控制单元对信号进行判断决策后，实时对喷灌设备进行控制，调整喷灌时间、喷灌水量及温度上下限报警，以达到节水节能的目的。</p><p>根据实时采集土壤水分、温湿度等数据和电磁阀、泵等驱动执行设备参数，远程设置和修改现场的环境参数(温湿度、土壤水分等)以及现场设备的控制模式，实现智能自动、定时自动、手机遥控、手动灌溉等多种灌溉模式。</p></sec><sec id="s5_2"><title>3.2. 客户端与单片机之间无线数据传输</title><p>上位与下位机之间通信系统的设计开发：STM32通过串口将数据发送到485模块上，再传输到USR-GPRS-730上，上位机通过TCP/IP协议与GPRS进行通信，使得客户端与单片机可通过物联网相互传送数据。同时，上位机与下位机建立协议，上位机可根据下位机发出的信息进行处理并反馈数据到下位机，下位机根据反馈数据后进行对应的控制处理。</p></sec><sec id="s5_3"><title>3.3. 三维交互系统APP的开发</title><p>客户端三纬虚拟人机交互APP设计与开发：采用3D Max进行场景建模、渲染和加工，生成3D模型文件后导入Unity3D，后台c#.net脚本语言进行场景漫游、信息显示和远程控制实现，虚拟场景实时与现实交互，使操作者更加直观的感受到果园的现实场景，具有强烈、逼真的感官冲击，给人身临其境的视觉享受。3D数字化智慧果园系统人机交互界面的设计与开发如图2所示。</p><p>图2. 人机交互界面的设计与开发流程图</p><p>具体开发过程包括：</p><p>1) 果园全景取景，建模。使用3D Studio Ｍax软件进行对果园果树等场景的建模，并对模型进行加工和渲染，再利用Photoshop对模型进行精细加工、美化，最后得到逼真的三维模型，将制作好的模型生成Fbx文件导入Unity3D中。</p><p>2) 基于Unity3D实现果园场景漫游、实物可视化和实时三维动画。本系统采用c#.net语言作为开发的脚本语言，利用Unity3D软件对微软Visual Studio开发软件提供API，然后通过控制第三视角前后左右、放大、缩小、旋转开发实现三维场景漫游以及手动灌溉模式。</p><p>3) Unity 3D应用程序多平台导出。根据Unity3D提供的导出功能，添加导出的场景到列表里，根据应用程序运行在PC端还是移动端，选择切换平台，生成应用程序。</p></sec></sec><sec id="s6"><title>4. 系统测试</title><p>3D物联网智能浇灌控制系统的底层部分如图3所示，底层部分包括机械部分和控制部分。机械部分包括电磁阀、储水箱、水泵、水管；控制部分包括土壤湿度传感器、空气温湿度传感器和继电器。实物图如图所示。</p><p>土壤湿度传感器和空气温湿度传感器与核心控制器采用STM32F103系列单片机最小系统板相连，土壤湿度传感器探头插入果树周围土壤中，空气温湿度传感器置于空气中，单片机将收集的土壤和环境空气信息的模拟数据转为二进制数据。果园划分区域进行监控，每块区域放置一个独立的核心控制器，所有区域的信息都将通过2.4 G无线网络传送到一个主核心控制器，主核心控制器与GPRS模块相连，将信息通过物联网发送到上位机，并在APP应用中显示。每个区域各设置一个电池阀，一端通过水管连接</p><p>图3. 底层实物图。(a) 信息采集和控制系统；(b) 主从机STM32系列单片机；(c) GPRS无线通信部分</p><p>水泵，另一端通过水管连接到喷头，每块区域中的核心控制器STM32F103系列单片机信号线与继电器接口相连，继电器触点和电磁阀连接，通过改变I/O口的高低电平就可改变电池阀的开关，对果树浇灌进行控制。</p><p>APP建立的三维虚拟场景下每个区域都有独立的显示土壤和空气环境信息界面，可以结合科学知识设定果树生长所需环境进行智能浇灌，也可以点击喷头进行手动浇灌。通过界面显示与提示对果园进行管理。基于虚拟现实技术的应用程序可以在PC端使用，也可以在手机上使用。</p></sec><sec id="s7"><title>5. 结论</title><p>本文设计开发了一种物联网 + Unity3D的虚拟现实果园种植远程监控控制系统，该系统由底层部分和顶层部分组成，底层部分主核心控制器采用STM32系类单片机，顶层部分应用程序采用Unity3D和3D Studio Max开发。底层部分和顶层部分通过GPRS模块进行数据交换和传输。系统测试表明该系统可以实时监测采集果树的基本信息，监测果树的生长情况，融合采集到的果园信息，实时自动控制浇灌，达到节水、智能、高效的目的。操作者还可以选择手动浇灌，更加精准地控制果园的浇灌。此系统克服了果园现场有线布线的不便，实现了全网络无线传感器信息传输和控制，系统实用性增强，市场应用前景广阔。</p></sec><sec id="s8"><title>文章引用</title><p>冯雨轩,王圣玥,杨丹丹,郭仁春,赵立杰,邢 杰. 物联网智能浇灌控制系统 Intelligent Irrigation Control System Using Internet of Things[J]. 计算机科学与应用, 2017, 07(04): 329-335. http://dx.doi.org/10.12677/CSA.2017.74040</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.20253-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">吴爱萍, 李嘉琪. 智能灌溉控制系统设计[J]. 工业控制计算机, 2015, 28(6): 142-143.</mixed-citation></ref><ref id="hanspub.20253-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">温宗周, 豆朋达, 钱佳佳, 等. 基于ZigBee的智能灌溉系统设计[J]. 单片机与嵌入式系统应用, 2016, 16(11): 38- 42.</mixed-citation></ref><ref id="hanspub.20253-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">杨柏楠. 基于无线传感器网络智能灌溉系统的设计[J]. 农业科技与信息, 2016(10): 95-95.</mixed-citation></ref><ref id="hanspub.20253-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">姜学智, 李忠华. 国内外虚拟现实技术的研究现状[J]. 辽宁工程技术大学学报, 2004, 23(2): 238-240.</mixed-citation></ref><ref id="hanspub.20253-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">邱林, 覃江峰. 智能灌溉系统中无线传感网络2.4GHz无线信道传播特性[J]. 湖北农业科学, 2015(9): 2242-2244.</mixed-citation></ref><ref id="hanspub.20253-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">王圣霖, 朱世范, 胡海辉. 基于移动设备的虚拟实境技术在景观设计中的应用[J]. 中国园林, 2015, 31(11).</mixed-citation></ref><ref id="hanspub.20253-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">王洪源. Unity3D人工智能编程精粹[M]. 北京: 清华大学出版社, 2014.</mixed-citation></ref><ref id="hanspub.20253-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">朱惠娟. 基于Unity3D的虚拟漫游系统[J]. 计算机系统应用, 2012, 21(10): 36-39.</mixed-citation></ref></ref-list></back></article>