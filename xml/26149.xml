<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">DSC</journal-id><journal-title-group><journal-title>Dynamical Systems and Control</journal-title></journal-title-group><issn pub-type="epub">2325-677X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/DSC.2018.73027</article-id><article-id pub-id-type="publisher-id">DSC-26149</article-id><article-categories><subj-group subj-group-type="heading"><subject>DSC20180300000_13744389.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于PX4的双系统复合式垂直起降无人机过渡态控制算法改进研究
  Research on Improvement of Transient Control Algorithm for Dual System Hybrid VTOL UAV Based on PX4
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>姜</surname><given-names>亚中</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>立峰</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>北方工业大学现场总线技术及自动化实验室，北京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>16</day><month>05</month><year>2018</year></pub-date><volume>07</volume><issue>03</issue><fpage>245</fpage><lpage>252</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    双系统复合式垂直起降无人机结合了多旋翼与固定翼，由多旋翼转换至固定翼模式的过渡态过程，将涉及到多旋翼和固定翼同时参与飞行控制的问题。文中提出一种权重的控制算法分配双系统在过渡态相互配合的一体化控制方案，同时使用激活函数方法改进多旋翼姿态与位置控制的PID算法，以避免执行器输出饱和，提高过渡态稳定性。
    The composite dual-system VTOL UAV combines multi-rotor and fixed-wing. The transition process from multi-rotor to fixed-wing mode will involve the simultaneous control of multi-rotor and fixed-wing in flight control. In this paper, a weight control algorithm is used to allocate the two systems in the transition state to coordinate the integrated control. At the same time, in order to avoid actuator saturation and improve the stability of transition state, the PID algorithm of mul-ti-rotor attitude and position control is improved by using activation function. 
  
 
</p></abstract><kwd-group><kwd>垂直起降无人机，飞行控制，过渡状态, VTOL UAV</kwd><kwd> Flight Control</kwd><kwd> Transition State</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于PX4的双系统复合式垂直起降无人机 过渡态控制算法改进研究<sup> </sup></title><p>姜亚中，王立峰</p><p>北方工业大学现场总线技术及自动化实验室，北京</p><p><img src="//html.hanspub.org/file/12-2740181x1_hanspub.png" /></p><p>收稿日期：2018年7月2日；录用日期：2018年7月23日；发布日期：2018年7月30日</p><disp-formula id="hanspub.26149-formula27"><graphic xlink:href="//html.hanspub.org/file/12-2740181x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>双系统复合式垂直起降无人机结合了多旋翼与固定翼，由多旋翼转换至固定翼模式的过渡态过程，将涉及到多旋翼和固定翼同时参与飞行控制的问题。文中提出一种权重的控制算法分配双系统在过渡态相互配合的一体化控制方案，同时使用激活函数方法改进多旋翼姿态与位置控制的PID算法，以避免执行器输出饱和，提高过渡态稳定性。</p><p>关键词 :垂直起降无人机，飞行控制，过渡状态</p><disp-formula id="hanspub.26149-formula28"><graphic xlink:href="//html.hanspub.org/file/12-2740181x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/12-2740181x7_hanspub.png" /> <img src="//html.hanspub.org/file/12-2740181x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>垂直起降无人机是近几年飞速发展的一种新型飞行器。双系统复合式垂直起降无人机 [<xref ref-type="bibr" rid="hanspub.26149-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.26149-ref2">2</xref>] 将四旋翼与固定翼复合在一种系统，此种布局兼具了固定翼高速平飞及四旋翼悬停的能力，较其他几种垂直起降无人机也具有转换过渡稳定平滑，可控性强的特点。其中从多旋翼模式到固定翼模式的过渡态是此类无人机的关键环节。文献 [<xref ref-type="bibr" rid="hanspub.26149-ref3">3</xref>] 针对正在转换过程时可能会受到外部干扰的情况，采用PID与线性自抗干扰控制器结合使用的办法，提高了飞机的鲁棒性。由于此阶段包含多旋翼和固定翼两种飞行控制方式同时发挥作用，所以使两种飞行控制方式完美配合是稳定过渡的重要体现。</p><p>PX4是一种可以实现自动驾驶的软件 [<xref ref-type="bibr" rid="hanspub.26149-ref4">4</xref>] ，本文将在此款软件下针对过渡态控制算法展开改进研究。</p></sec><sec id="s4"><title>2. 一体化控制方案</title><p>针对过渡态的控制算法，主要从以下两方面入手：</p><p>1) 由于过渡态同时存在多旋翼和固定翼两种控制方式，采用权重的方法分配两种控制方式。当无人机的速度越接近转换速度时，多旋翼所参与的控制作用将越小。转换速度被设定为略大于失速速度，譬如1.1倍失速速度。固定翼在过渡态俯仰、横滚和偏航将发挥作用，而油门通道则以恒定设定值参与控制。当速度大于等于转换速度时无人机则进入固定飞行模式，此时多旋翼控制器完全关闭。</p><p>2) 针对多旋翼的姿态和位置控制的PID控制 [<xref ref-type="bibr" rid="hanspub.26149-ref5">5</xref>] 中的误差输入存在过大的情况，引入一个激活函数，将输出控制在一定的范围内。此时无论如何改变PID参数或误差输入多大，输出均不会饱和而导致无人机瞬间姿态和位置变化过大。</p></sec><sec id="s5"><title>3. 软件实现</title><p>1) 在无人机进入过渡状态后，固定翼油门通道将立即提高到设定值(一般设定在75%以上)，同时其他三个通道的执行器打开。而多旋翼的四个通道的权重将按如下公式产生变化：</p><p>W m c = 1 − v i 2 / v t 2 (1)</p><p>W<sub>mc</sub>：多旋翼权重；v<sub>i</sub>：飞行速度；v<sub>t</sub>：转换速度</p><p>由于升力与飞行速度的平方近似成正比，所以公式中采用飞行速度的平方作为参考是最为合适的。由公式可知，当飞行速度的平方越接近转换速度时，多旋翼权重将越接近零。由于多旋翼权重值将会与执行器输出相乘，所以当飞行速度达到转换速度时，多旋翼的执行器输出即为零，四个旋翼电机停止旋转，无人机进入固定翼飞行模式。</p><p>过渡态控制的软件设计流程图如图1所示。</p><p>图1. 程序设计流程图</p><p>2) 多旋翼在过渡态控制过程极为关键，远大于固定翼的控制，因此，针对多旋翼的姿态和位置的PID控制又做出如下改进：</p><p>u = k ⋅ S ( ξ ) (2)</p><p>ξ = k P e = k I ∫ e d t + k D d e d t (3)</p><p>u：控制器输出 S ( ξ ) ：激活函数k<sub>P</sub>，k<sub>I</sub>，k<sub>D</sub>：PID参数e：误差</p><p>有公式可见，在PID控制的基础之上，在外面又套了一个激活函数S(x)，k为激活函数的一个动态因子，可以调整激活函数的输出。这里选用的激活函数为双曲正切函数tanh(x)，其函数公式和曲线如图2所示。</p><p>tanh ( x ) = sinh ( x ) cosh ( x ) = e x − e − x e x + e − x (4)</p><p>由tanh函数曲线图可知其输出区间总是在(−1,1)之间，而且整体函数以0为中心。因此，无论输入误差多大，或PID参数如何调整，在tanh函数作用下，都可以将控制器输出控制在一定范围内。这样即使在较大外部因素的影响下，无人机在姿态和位置的反应变化上将不会有瞬间的巨大改变，保证了飞行时更加平稳。</p></sec><sec id="s6"><title>4. SITL仿真验证</title><p>Gazebo是一个自主机器人3D仿真环境 [<xref ref-type="bibr" rid="hanspub.26149-ref6">6</xref>] 。Gazebo可以使得PX4飞行代码在其仿真世界中通过地面站、遥控器或板外API实现对模拟无人机的控制。</p><p>Gazebo仿真环境与PX4的关系如图3所示。PX4使用其模拟特定的模块创建Gazebo的UDP链接，并使用模拟器MAVLink API与Gazebo交互信息。此API定义了一组MAVLink消息，Gazebo将来自于其模拟环境中的传感器数据提供给PX4，并从应用于模拟无人机的PX4飞行代码中返回电机和执行器的数值。PX4利用MAVLink模块建立UDP连接到地面站和外部API。遥控器则通过串口连接至地面站。</p></sec><sec id="s7"><title>5. 仿真结果</title><p>本次实验在Gazebo环境下进行PX4的软件在环仿真。机型选择为混合式垂直起降无人机，其中固定翼部分为飞翼。如图4所示。</p><p>飞翼机没有传统尾翼，将机翼与机身融合在一起，具有质量轻，阻力小等特点。在固定翼的两个机翼的前后各加一个电机，就完成了四旋翼与固定翼的复合，即混合式垂直起降无人机。</p><p>图2. Tanh函数曲线图</p><p>图3. Gazebo仿真环境关系图</p><p>图4. Gazebo仿真环境</p><p>此次实验包含了起飞，飞行模式转换，盘旋，降落，是一次完整的飞行试验。试验结果如图5至图9所示。</p><p>图5和图6中的粉色区域为过渡态，即1:17.2至1:19.6为转换阶段。图5中Output0至Output3分别</p><p>图5. 多旋翼电机输出曲线图</p><p>图6. 多旋翼通道输出曲线图</p><p>图7. 滚转角速度曲线图</p><p>图8. 俯仰角速度曲线图</p><p>图9. 偏航角速度曲线图</p><p>对应多旋翼四个电机的输出。PWM的输出区间为1000~2000 us，即1000 us对应电机最低转速，2000 us对应电机最高转速，而飞机悬停时对应的PWM则在1500 us左右。图6为多旋翼滚转、俯仰、偏航和油门通道输出图。滚转、俯仰和偏航通道的输出区间为[−1,1]，油门通道的输出区间为[0,1]。由于在过渡态没有滚转、俯仰以及偏航的指令，所以此三通道的输出为零。图5的多旋翼四个电机的输出曲线和图6的油门通道输出曲线均基本符合公式(1)的变化规律。</p><p>图7，图8，图9分别为滚转，俯仰和偏航角速度的曲线图。图中展示了起飞，盘旋和降落三个飞行过程。其中盘旋过程又包括了多旋翼飞行，过渡态和固定翼飞行三种飞行状态。红色曲线为角速度的估计值，绿色曲线为角速度的设定值。图中角速度的估计值曲线与设定值曲线基本吻合，也没有出现曲线饱和的情况，说明在激活函数的限制下，输出被控制在一定范围内。</p></sec><sec id="s8"><title>6. 结束语</title><p>本文针对双系统复合式垂直起降无人机的过渡阶段，根据飞机空速与升力的关系，对过渡态的控制算法经行了改进一体化控制，对多旋翼和固定翼两种飞行模式在过渡态所参与控制的权重完成了合理的分配。尤其针对多旋翼的姿态与位置PID控制又加以可调限幅的处理，保证了飞机的瞬间姿态与位置变化在可控范围内。最终通过仿真实验完成了验证。通过以上两步的改进，进一步提高的混合式垂直起降无人机过渡态的稳定性。</p></sec><sec id="s9"><title>文章引用</title><p>姜亚中,王立峰. 基于PX4的双系统复合式垂直起降无人机过渡态控制算法改进研究 Research on Improvement of Transient Control Algorithm for Dual System Hybrid VTOL UAV Based on PX4[J]. 动力系统与控制, 2018, 07(03): 245-252. https://doi.org/10.12677/DSC.2018.73027</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.26149-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Tyan, M., Nguyen, N.V., Lee, J.-W., et al. (2016) A Hybrid VTOL-Fixed Wing Electric UAV Sizing Methodology Development. KSAS 2016 Fall Conference, Jeju.</mixed-citation></ref><ref id="hanspub.26149-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Yu, S. and Kwon, Y. (2017) Development of VTOL Drone for Stable Transit Flight. Journal of Computer &amp; Communications, 5, 36-43. https://doi.org/10.4236/jcc.2017.57004</mixed-citation></ref><ref id="hanspub.26149-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Guclu, A., Kurtulus, D.F. and Arikan, K.B. (2015) Attitude and Altitude Stabilization of Fixed Wing VTOL Unmanned Air Vehicle. AIAA Modeling and Simulation Tech-nologies Conference, Washington DC, 13-17 June 2016.</mixed-citation></ref><ref id="hanspub.26149-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">陈子杰, 刘永辉, 赵厚宝, 等. 基于PX4构建高可靠多旋翼控制器的实现方法[J]. 软件产业与工程, 2014(6): 38-42.</mixed-citation></ref><ref id="hanspub.26149-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Çakici, F. and Leblebicioğlu, M.K. (2016) Control System Design of a Vertical Take-off and Landing Fixed-Wing UAV. IFAC-PapersOnLine, 49, 267-272. https://doi.org/10.1016/j.ifacol.2016.07.045</mixed-citation></ref><ref id="hanspub.26149-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">刘一鸣, 许辉, 耿长兴, 等. ROS/Gazebo环境下的机械臂运动规划研究[J]. 煤矿机械, 2018(3): 42-44..</mixed-citation></ref></ref-list></back></article>