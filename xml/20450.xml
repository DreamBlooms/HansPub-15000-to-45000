<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SG</journal-id><journal-title-group><journal-title>Smart Grid</journal-title></journal-title-group><issn pub-type="epub">2161-8763</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SG.2017.72016</article-id><article-id pub-id-type="publisher-id">SG-20450</article-id><article-categories><subj-group subj-group-type="heading"><subject>SG20170200000_51336637.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  采用局域信息的孤岛微电网分布式控制方法
  Distributed Control Method with Local Information for Islanded Microgrids
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>康</surname><given-names>文发</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>强</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>彭</surname><given-names>琮波</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>高</surname><given-names>孟凯</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>涛</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>高</surname><given-names>晋</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff3"><addr-line>国网重庆市电力公司电力科学研究院，重庆</addr-line></aff><aff id="aff1"><addr-line>输配电装备及系统安全与新技术国家重点实验室(重庆大学)，重庆</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>18883724521@163.com (康文)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>24</day><month>04</month><year>2017</year></pub-date><volume>07</volume><issue>02</issue><fpage>142</fpage><lpage>151</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   本文提出一种仅利用局域信息的孤岛微电网分布式控制方法。该方法利用agent构造通信网络，并进行局域信息交换。Agent根据收集的信息，计算下一时刻分布式电源的输出设定值，从而调整下一时刻分布式电源的输出。本文系统地给出，从任意通信网络为agent导出分布式控制律的一般方法，并且在理论上证明，该分布式控制律不仅能够保证微电网内功率平衡，而且能够使得可控分布式电源输出与其容量成比例。最后，设计两组实验，验证文中提出的分布式控制律有效性。仿真结果表明，当环境和负载变化时，文中提出的方法能够维持微电网内功率平衡，保证功率在可控分布式电源之间按照容量大小进行分配。 A distributed control method with local information for islanded microgrids is proposed in this paper. First, a communication network composed of agents is established, on which local infor-mation is exchanged among agents, and agents compute setting points and regulate outputs of distributed generation at the next time step. Furthermore, a systematic method is presented to derive a set of control laws from any given communication network. Moreover, it is proved that the control laws not only balance the system, but also make the outputs of controllable distributed generation proportional to their capacities. Finally, two cases are designed to evaluate the performance of the proposed method. The simulation results show that the proposed methods can maintain power supply-demand balance, and also can guarantee power dispatched proportionally, when load demand and environmental conditions fluctuate.
    
  
 
</p></abstract><kwd-group><kwd>孤岛微电网，多Agent系统，分布式控制，第二级控制，网络化控制, Islanded Microgrid</kwd><kwd> Multi-Agent System (MAS)</kwd><kwd> Distributed Control</kwd><kwd> Secondary Control</kwd><kwd> Networked Control</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>采用局域信息的孤岛微电网分布式控制方法<sup> </sup></title><p>康文发<sup>1</sup>，李强<sup>1</sup>，彭琮波<sup>1</sup>，高孟凯<sup>1</sup>，陈涛<sup>2</sup>，高晋<sup>2</sup></p><p><sup>1</sup>输配电装备及系统安全与新技术国家重点实验室(重庆大学)，重庆</p><p><sup>2</sup>国网重庆市电力公司电力科学研究院，重庆</p><p>收稿日期：2017年4月13日；录用日期：2017年4月27日；发布日期：2017年4月30日</p><disp-formula id="hanspub.20450-formula40"><graphic xlink:href="http://html.hanspub.org/file/11-1580389x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文提出一种仅利用局域信息的孤岛微电网分布式控制方法。该方法利用agent构造通信网络，并进行局域信息交换。Agent根据收集的信息，计算下一时刻分布式电源的输出设定值，从而调整下一时刻分布式电源的输出。本文系统地给出，从任意通信网络为agent导出分布式控制律的一般方法，并且在理论上证明，该分布式控制律不仅能够保证微电网内功率平衡，而且能够使得可控分布式电源输出与其容量成比例。最后，设计两组实验，验证文中提出的分布式控制律有效性。仿真结果表明，当环境和负载变化时，文中提出的方法能够维持微电网内功率平衡，保证功率在可控分布式电源之间按照容量大小进行分配。</p><p>关键词 :孤岛微电网，多Agent系统，分布式控制，第二级控制，网络化控制</p><disp-formula id="hanspub.20450-formula41"><graphic xlink:href="http://html.hanspub.org/file/11-1580389x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>可再生能源的开发与利用已经受到各国研究人员的关注。微电网能够更好的接纳可再生能源，成为研究热点 [<xref ref-type="bibr" rid="hanspub.20450-ref1">1</xref>] 。通常，微电网能够融合多种分布式电源为有机整体，如光伏电源、风力发电电源、微型燃气轮机、燃料电池，储能电源等，为用户提供清洁、可靠、灵活的电能。微电网有两种运行方式 [<xref ref-type="bibr" rid="hanspub.20450-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref3">3</xref>] ，第一种运行方式是通过并网开关与大电网连接的并网运行方式；第二种是不与大电网相连接的孤岛运行方式。孤岛运行的微电网，缺乏电压频率的支撑，分布式电源(DG)的逆变器响应速度快，过载能力小，间歇性电源输出不稳定，负载变化随机等导致孤岛微电网控制逐渐成为研究热点 [<xref ref-type="bibr" rid="hanspub.20450-ref4">4</xref>] 。</p><p>随着研究的不断深入，多种控制策略 [<xref ref-type="bibr" rid="hanspub.20450-ref5">5</xref>] - [<xref ref-type="bibr" rid="hanspub.20450-ref23">23</xref>] 用于控制微电网稳定运行，包含集中式控制方法 [<xref ref-type="bibr" rid="hanspub.20450-ref12">12</xref>] ，分层控制方法 [<xref ref-type="bibr" rid="hanspub.20450-ref13">13</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref14">14</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref15">15</xref>] ，基于MAS的分布式控制方法 [<xref ref-type="bibr" rid="hanspub.20450-ref19">19</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref20">20</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref21">21</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref22">22</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref23">23</xref>] ，其中分布式控制方法受到了人们广泛研究。与集中式控制相比，分布式控制的通信网络结构灵活，通信系统投资成本低，不需要中央控制器，不会发生单点故障，控制方式灵活多样，容易实现DG的即插即用，更加适应间歇性可再生电源的输出随机波动特性 [<xref ref-type="bibr" rid="hanspub.20450-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref23">23</xref>] 。</p><p>文献 [<xref ref-type="bibr" rid="hanspub.20450-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref11">11</xref>] 提出了改进的下垂控制方法用于控制微电网中的分布式电源，有效的提高了无功功率在系统中的合理分配，但是都未曾考虑可再生能源接入对微电网运行的影响。文献 [<xref ref-type="bibr" rid="hanspub.20450-ref16">16</xref>] 提出了一种分布式频率电压合作制策略，在保证DG发电成本最小时，能够使得系统频率稳定，节点电压维持在稳定值，系统无功功率均衡分配。作者 [<xref ref-type="bibr" rid="hanspub.20450-ref17">17</xref>] 提出孤岛微电网分布式电压预测控制方案，在不借助通信系统时也能够保证系统电压稳定，并建立小信号模型分析提出方法的稳定性，但当机组加入和退出运行时，需要重新修改预测控制方程。结合分布式控制与分层控制的思想，文献 [<xref ref-type="bibr" rid="hanspub.20450-ref18">18</xref>] 提出针对不确定通信网络结构的微电网控制策略，提供了电压频率恢复的解决办法，但提出的方法中需要一个虚拟节点提供电压和频率参考值。文献 [<xref ref-type="bibr" rid="hanspub.20450-ref19">19</xref>] [<xref ref-type="bibr" rid="hanspub.20450-ref20">20</xref>] 借鉴多Agent系统，提出了微电网运行控制策略，但文献未考虑可控DG成比例输出的功能。基于此问题，文献 [<xref ref-type="bibr" rid="hanspub.20450-ref21">21</xref>] 提出了孤岛微电网分布式控制策略，有效的解决了可再生电源输出波动对系统的影响，随后，在此基础上提出了分布式最优控制方法 [<xref ref-type="bibr" rid="hanspub.20450-ref22">22</xref>] ，使得微电网中功率按照DG的容量分配。</p><p>上述一些文献采用的控制方法较为复杂，不能快速响应环境负载的剧烈变化，针对上述问题，本文提出一种仅利用局域信息的微电网分布式控制策略。文章中提出的分布式控制方法为完全分布式的方法，只需要局部信息就可以实现微电网中功率供需平衡，可控DG成比例输出的功能，实现微电网中功率在可控DG之间按照容量大小分配。</p><p>文章内容安排如下。首先，介绍分布式分层控制策略，控制策略包含通信网络的构建和分布式控制律的设计；其次，证明分布式控制律的功率平衡特性与收敛特性；随后，介绍微电网仿真系统；然后，设计实验验证文中控制方法的有效性，并分析仿真结果；最后，总结文章。</p></sec><sec id="s4"><title>2. 孤岛微电网分布式控制模型</title><p>本文提出的仅利用局域信息的分布式控制模型，首先构造由Agent组成的通信网络。由Agent组成的通信网络中，Agent节点只收集邻居Agent的信息，不需要收集全网的信息。对于任意给定的通信网络，本文系统地给出为Agent导出分布式控制律的方法，从理论上证明分布式控制律的功率平衡特性与收敛性。理论证明，若Agent通过分布式控制律调节可控DG的功率输出设定值，则能够保持系统功率供需平衡，通过迭代的方法，能够逐渐使得可控DG成比例输出，实现微电网系统功率最优分配。</p><sec id="s4_1"><title>2.1. 通信网络结构设计</title><p>如图1所示，微电网中，分布式电源由微型燃气轮机(MT)，光伏电源(PV)、永磁同步风力发电机(WT)，蓄电池(BESS)等组成。而通信网络由Agent组成，用于信息传递、处理和计算。网络G中，所有的Agent都不收集负载的信息，只收集DG的输出功率信息。并且，定义与微型燃气轮机(可控DG)相连的Agent为可控Agent，与蓄电池(半可控DG)相连的为半可控Agent。由于光伏、风机(不可控DG)采用最大功率跟踪(MPPT)控制方式，不对其输出进行调节，所以没有对应的Agent，从而减少了通信投资。图1中，可控Agent与可控Agent之间采用双向通信方式，半可控Agent与可控Agent之间采用单向通信方式，信息由半可控Agent传递给邻居可控Agent。虚线表示通信网络与微电网中DG的局部控制器之间的信息流动，箭头表示信息传递方向。可控Agent既收集对应DG的信息，又控制底层可控DG，半可控Agent</p><p>图1. 微电网控制模型，上层为Agent组成的通信网络，半可控Agent由椭圆表示，可控Agent由棱形表示。此外，两个网络层之间的虚线表示Agent与底层DG的连接，箭头表示信息的传递方向</p><p>只收集半可控DG的信息，不控制半可控DG。</p><p>本文中，蓄电池采用电压频率(V/F)控制，由其控制方式可知，其输出可以大致表明了系统的功率缺额。只要半可控DG输出不为零，半可控Agent就会将此信息传送给相连的可控Agent，通过计算，使得可控DG分担半可控DG的输出，从而使得半可控DG输出归零。进一步，在网络G上，将可控DG的输出进行再分配，通过迭代的方式逐渐实现可控DG的输出与其容量成比例。由于半可控Agent只发送信息，而不参与迭代，因此通信网络G中，不包含半可控Agent。</p><p>假设通信网络G包含n个可控Agent。对角矩阵D = [d<sub>ii</sub>]<sub>n&#215;n</sub>表示节点的出度，出度定义为Agent出边的条数。此外，记半可控Agent v的出度为d<sub>v</sub>，例如，半可控Agent有两条出边，则d<sub>v</sub> = 2。为使得控制律中所有矩阵维数相等，Agent的编号与对应DG的编号相同，并且可控Agent的个数与可控DG的个数相等。</p></sec><sec id="s4_2"><title>2.2. 分布式控制律导出</title><p>上面详细介绍了通信网络G的结构和Agent之间的通信方式，这部分将系统地给出，从任意通信网络，为Agent导出分布式控制律的方法。首先，给出系统功率平衡条件。若以下条件成立时，我们认为系统的功率供需是平衡的，</p><disp-formula id="hanspub.20450-formula42"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x11_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x12_hanspub.png" xlink:type="simple"/></inline-formula>是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x13_hanspub.png" xlink:type="simple"/></inline-formula>时刻可控DG的输出向量，P<sub>v</sub>(t)，Q<sub>v</sub>(t)为半可控电源在t时刻的有功功率和无功功率输出值。根据文献 [<xref ref-type="bibr" rid="hanspub.20450-ref21">21</xref>] 可知，采用V/F控制的DG能够根据电压频率的变化输出功率，维持系统电压频率稳定，补偿系统瞬时功率缺额，从而采用V/F控制DG的输出值能够表示系统的功率缺额。因此，等式(1)表示，当可控DG下一时刻的输出等于可控DG上一时刻的输出与半可控DG输出的加和时，系统的功率是平衡的。</p><p>为使得半可控DG在瞬间补充系统缺额后，其输出由可控DG分担，半可控Agent将半可控DG的输出功率值发送给邻居(可控Agent)。半可控Agent向邻居发送信息后，可控Agent的输出根据以下等式(2)确定，</p><disp-formula id="hanspub.20450-formula43"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x14_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中P'(t)、P(t)和Q'(t)、Q(t)为n &#215; 1的可控DG功率输出列向量。Z为n&#215;1列向量，若Agenti能够接收到半可控Agentv的信息，则Z中对应的元素<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x15_hanspub.png" xlink:type="simple"/></inline-formula>，否则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x16_hanspub.png" xlink:type="simple"/></inline-formula>。由向量Z的定义可知<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x17_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>可控Agent若根据等式(2)调节可控DG的输出，能够保证等式(2)成立，系统功率平衡，但不能保证可控DG按照其容量大小输出。为保证系统功率平衡时，可控DG的输出与容量大小成比例，设计如下分布式控制律，</p><disp-formula id="hanspub.20450-formula44"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x18_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x19_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x20_hanspub.png" xlink:type="simple"/></inline-formula>为可控Agent的有功列向量，F为权值矩阵。权值矩阵F中的元素f<sub>ij</sub>根据以下等式(4)确定，</p><disp-formula id="hanspub.20450-formula45"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x21_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x22_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x23_hanspub.png" xlink:type="simple"/></inline-formula>表示可控DG的有功容量列向量，N<sub>i</sub>表示节点i的邻居集合。将控制律(3)中的P'(t)换成Q'(t)，P(t)换成Q(t)，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x24_hanspub.png" xlink:type="simple"/></inline-formula>替换成<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x25_hanspub.png" xlink:type="simple"/></inline-formula>就可以得到无功功率的分布式控制律。可控Agent根据分布式控制律(3)调节可控DG的输出，就可以使得微电网中的功率平衡，并且经过迭代使得功率按照可控DG的容量大小分配。</p></sec><sec id="s4_3"><title>2.3. 功率平衡特性和收敛性分析</title><p>首先证明分布式控制律(3)的功率平衡特性，随后证明其收敛特性。</p><p>定理1：在网络G上，若可控Agent根据分布式控制律(3)调节可控DG的输出，则等式(1)成立，同时在可控DG分担半可控DG的输出时，能够保证微电网中功率供需平衡。</p><p>证明：首先证明F矩阵的列和为1。将矩阵F中的第j列相加得到，</p><disp-formula id="hanspub.20450-formula46"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x26_hanspub.png"  xlink:type="simple"/></disp-formula><p>然后，证明等式(1)成立。将等式(3)两边相加，并利用F矩阵列和为1，得到</p><disp-formula id="hanspub.20450-formula47"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x27_hanspub.png"  xlink:type="simple"/></disp-formula><p>由于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x28_hanspub.png" xlink:type="simple"/></inline-formula>，并根据等式(2)和等式(6)得到，</p><disp-formula id="hanspub.20450-formula48"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>证毕。</p><p>定理2：在网络G上，若可控Agent根据分布式控制律(3)调节可控DG的输出，通过迭代就能够实现微电网中功率在可控DG之间成比例分配，使得可控DG的输出功率与其容量的比值<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x30_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>证明：将矩阵F的第j行与容量列向量S相乘，得到，</p><disp-formula id="hanspub.20450-formula49"><graphic xlink:href="http://html.hanspub.org/file/11-1580389x31_hanspub.png"  xlink:type="simple"/></disp-formula><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x32_hanspub.png" xlink:type="simple"/></inline-formula>。(8)</p><p>同时，根据文献 [<xref ref-type="bibr" rid="hanspub.20450-ref25">25</xref>] 的推论1和网络G的结构可知，矩阵F只包含单一的幅值为1的特征值，又由于矩阵F的谱半径特性可知，</p><disp-formula id="hanspub.20450-formula50"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x33_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x34_hanspub.png" xlink:type="simple"/></inline-formula>为矩阵的1范数。记<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x35_hanspub.png" xlink:type="simple"/></inline-formula>，写出矩阵F和H的特征值表达式，并对其做相同的行列式变化，得到</p><disp-formula id="hanspub.20450-formula51"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x36_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据F的1特征值的唯一性，结合等式(10)得到，</p><disp-formula id="hanspub.20450-formula52"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/11-1580389x37_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中ρ(F)，ρ<sub>2</sub>(F)分别是矩阵F的谱半径、第二大特征值幅值。结合等式(8)，(9)和(11)，并根据文献 [<xref ref-type="bibr" rid="hanspub.20450-ref26">26</xref>] 的定理2可知，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x38_hanspub.png" xlink:type="simple"/></inline-formula>。所以得到，</p><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x39_hanspub.png" xlink:type="simple"/></inline-formula>。(12)</p><p>证毕。</p><p>定理2说明分布式控制律(3)能够调节可控DG的输出，通过迭代使得可控DG功率输出与容量的比值为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/11-1580389x40_hanspub.png" xlink:type="simple"/></inline-formula>，实现微电网中功率在可控DG之间按比例分配。</p></sec></sec><sec id="s5"><title>3. 微电网系统结构及参数设置</title><p>孤岛微电网仿真系统由MATLAB/Simulink搭建而成，包含14组DG和负载，采用辐射状结构，如图2所示。设置线路阻抗为0.169 + j0.07 Ω/km，系统频率为50 Hz，标准电压为380 V。考虑分布式DG的物理特性，仿真中设置各DG输出不超过容量限制，储能电源DG<sub>7</sub>在瞬时输出功率时也不超越容量限制。微电网仿真系统中，可控分布式DG<sub>i</sub><sub> = 2,4,6,8,11,12,14</sub>采用恒功率(PQ)控制，由理想直流电压源V<sub>dc</sub> [<xref ref-type="bibr" rid="hanspub.20450-ref24">24</xref>] 模拟；光伏电源DG<sub>i</sub><sub> = 1,9</sub>采用最大功率跟踪(MPPT)控制，永磁同步风机DG<sub>i</sub><sub> = 3,5,10,13</sub>也采用MPPT控制；DG<sub>7</sub>采用V/F控制，由储能系统组成，为孤岛微电网提供频率和电压支撑 [<xref ref-type="bibr" rid="hanspub.20450-ref21">21</xref>] 。在仿真中，设定不可控分布式DG不产生无功功率，即Q<sub>i</sub><sub> = 1,3,5,9,10,13</sub> = 0 kVar。DG容量和负载参数见于表1中。在仿真中，可控Agent之间的通信周期为1 ms，半可控Agent每间隔10 ms给可控Agent传递一次信息。设定可再生光伏电源DG<sub>1,9</sub>的有功功率输出在25 kW到35 kW之间变化，永磁同步风机DG<sub>3,5,10,13</sub>的有功功率输出在8 kW到42 kW之间变化，如图3所示。</p><p>图2. 孤岛微电网结构</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Setup and parameters of DGs and load</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >电源</th><th align="center" valign="middle" >容量</th><th align="center" valign="middle" >控制</th><th align="center" valign="middle" >负载</th><th align="center" valign="middle" >最大需求</th></tr></thead><tr><td align="center" valign="middle" >DG<sub>1</sub></td><td align="center" valign="middle" >60 kW,0 kVar</td><td align="center" valign="middle" >MPPT</td><td align="center" valign="middle" >Load<sub>1</sub></td><td align="center" valign="middle" >35 kW,0 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>2</sub></td><td align="center" valign="middle" >60 kW,15 kVar</td><td align="center" valign="middle" >PQ</td><td align="center" valign="middle" >Load<sub>2</sub></td><td align="center" valign="middle" >35 kW,10 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>3</sub></td><td align="center" valign="middle" >45 kW,0 kVar</td><td align="center" valign="middle" >MPPT</td><td align="center" valign="middle" >Load<sub>3</sub></td><td align="center" valign="middle" >15 kW,20 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>4</sub></td><td align="center" valign="middle" >55 kW,22 kVar</td><td align="center" valign="middle" >PQ</td><td align="center" valign="middle" >Load<sub>4</sub></td><td align="center" valign="middle" >20 kW,15 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>5</sub></td><td align="center" valign="middle" >30 kW,0 kVar</td><td align="center" valign="middle" >MPPT</td><td align="center" valign="middle" >Load<sub>5</sub></td><td align="center" valign="middle" >30 kW,15 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>6</sub></td><td align="center" valign="middle" >45 kW,35 kVar</td><td align="center" valign="middle" >PQ</td><td align="center" valign="middle" >Load<sub>6</sub></td><td align="center" valign="middle" >35 kW,15 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>7</sub></td><td align="center" valign="middle" >20 Ah</td><td align="center" valign="middle" >V/F</td><td align="center" valign="middle" >Load<sub>7</sub></td><td align="center" valign="middle" >20 kW,20 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>8</sub></td><td align="center" valign="middle" >65 kW,30 kVar</td><td align="center" valign="middle" >PQ</td><td align="center" valign="middle" >Load<sub>8</sub></td><td align="center" valign="middle" >25 kW,0 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>9</sub></td><td align="center" valign="middle" >50 kW,0 kVar</td><td align="center" valign="middle" >MPPT</td><td align="center" valign="middle" >Load<sub>9</sub></td><td align="center" valign="middle" >20 kW,20 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>10</sub></td><td align="center" valign="middle" >55 kW,0 kVar</td><td align="center" valign="middle" >MPPT</td><td align="center" valign="middle" >Load<sub>10</sub></td><td align="center" valign="middle" >30 kW,0 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>11</sub></td><td align="center" valign="middle" >40 kW,33 kVar</td><td align="center" valign="middle" >PQ</td><td align="center" valign="middle" >Load<sub>11</sub></td><td align="center" valign="middle" >20 kW,0 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>12</sub></td><td align="center" valign="middle" >70 kW,25 kVar</td><td align="center" valign="middle" >PQ</td><td align="center" valign="middle" >Load<sub>12</sub></td><td align="center" valign="middle" >20 kW,15 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>13</sub></td><td align="center" valign="middle" >40 kW,0 kVar</td><td align="center" valign="middle" >MPPT</td><td align="center" valign="middle" >Load<sub>13</sub></td><td align="center" valign="middle" >20 kW,0 kVar</td></tr><tr><td align="center" valign="middle" >DG<sub>14</sub></td><td align="center" valign="middle" >35 kW,20 kVar</td><td align="center" valign="middle" >PQ</td><td align="center" valign="middle" >Load<sub>14</sub></td><td align="center" valign="middle" >35 kW,20 kVar</td></tr></tbody></table></table-wrap><p>表1. DG和负载参设置</p><p>图3. 不可控DG功率输出</p></sec><sec id="s6"><title>4. 仿真结果及分析</title><p>这部分仿真实验部分，设计两组仿真验证提出的分布式控制策略的有效性。首先，验证在环境变化时，在分布式控制律的作用下，验证微电网系统的功率平衡特性、系统电压幅值、频率稳定变化，可控DG成比例输出功能。其次，分析在环境和负载变化时，在分布式控制律的作用下，验证系统功率平衡特性、电压频率稳定，可控DG成比例输出功能。最后，总结分析仿真实验结果。</p><sec id="s6_1"><title>4.1. 环境变化的仿真结果</title><p>当环境变化，负载不变时，可控Agent采用控制律(3)调节可控DG的输出，得到在网络结构G<sub>1</sub>下的仿真结果如图4所示。从图4中可以看出，可控DG能够平稳输出功率，系统电压维持在380V，系统频率保持在50 Hz，DG<sub>7</sub>的输出功率始终保持为0，微电网系统能够稳定运行。此外，从图3的(c,f)两图中看出，可控DG是输出功率与其容量的比例都相等，说明在控制律(3)的调节作用下，即使在环境变化时，系统功率能够在可控DG之间合理分配。仿真结果表明，只要通信网络G连通，不存在孤立节点，Agent采用控制律(3)就可以实现微电网中功率在可控DG之间按照其容量大小分配。</p></sec><sec id="s6_2"><title>4.2. 环境和负载同时变化时的仿真结果</title><p>实际微电网中，系统负载是变化的，因此，这部分仿真验证当负载和环境同时变化时控制律(3)的控制效果。设置系统负载变化情况为：1) t = 2 s时刻，Load<sub>5,13</sub>接入微电网中，2) t = 4s时刻，系统有功率减少50 kW，无功功率减少20 kVar；3) t = 6 s时刻，Load<sub>5,13</sub>从微电网中切除。</p><p>Agent在网络G<sub>1</sub>中，按照控制律(3)调节可控DG的输出，得到的系统的动态仿真结果如图5所示。从图5中可以看出，在负载和环境剧烈变化的情况下，可控DG在控制律(3)的调节作用小，可控DG能够平稳输出功率，微电网系统首尾两端的电压幅值，即Load<sub>2</sub>和Load<sub>14</sub>两端的负载电压，分别维持在380 V附近，系统频率保持在50 Hz。在负载剧烈变化的时刻，系统电压频率也不超过允许范围，微电网系统能稳定正常运行。储能电源DG<sub>7</sub>在瞬时输出或者吸收功率后，经可控DG的调节作用，能够快速变为0。此外，更为重要的是，即使在负载和环境同时变化的情况下，可控DG的输出功率与容量的比例值相等，实现了系统功率在可控DG之间按照可控DG的容量大小分配。</p><p>图4. 环境变化时的仿真结果。(a) 可控DG的有功和无功功率输出。(b) 系统电压频率和BESS输出变化情况。(c) 可控DG的功率输出与其容量的比例值</p><p>图5. 负载和环境同时变化时的仿真结果。(a) 可控DG的有功和无功功率输出。(b) 系统电压频率和BESS输出变化情况。(c) 可控DG的功率输出与其容量的比例值</p></sec></sec><sec id="s7"><title>5. 结论</title><p>本文针对孤岛微电网的分布式控制问题，提出一种只利用局域信息的分布式控制方法。此方法为两层网络结构，其中上层是由Agent组成的通信网络，用于处理、传递信息，而下层网络是由分布式DG和负载组成的微电网。针对任意给定的连通网络，本文系统地为Agent设计了分布式控制律，用于调节可控DG的输出，使得微电网内功率供需平衡，并且通过迭代的方法，逐渐实现可控DG成比例输出的功能。此外，本文从理论上证明了提出的分布式控制律的功率平衡特性与收敛特性。最后，仿真结果表明，即使负载和环境同时变化，文中提出的控制方法都能使得微电网系统中电压频率稳定，实现可控DG的输出与其容量成比例。</p></sec><sec id="s8"><title>基金项目</title><p>国家自然科学基金项目(51177177)。</p></sec><sec id="s9"><title>文章引用</title><p>康文发,李 强,彭琮波,高孟凯,陈 涛,高 晋. 采用局域信息的孤岛微电网分布式控制方法Distributed Control Method with Local Information for Islanded Microgrids[J]. 智能电网, 2017, 07(02): 142-151. http://dx.doi.org/10.12677/SG.2017.72016</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.20450-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Lasseter, R.H. and Paigi, P. (2004) Microgrid: A Conceptual Solution. Power Electronics Specialists Conference, 6, 4285-4290. &lt;br&gt;https://doi.org/10.1109/pesc.2004.1354758</mixed-citation></ref><ref id="hanspub.20450-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Katiraei, F., Iravani, R., Hatziargyriou, N., et al. (2008) Microgrids Management. IEEE Power &amp; Energy Magazine, 6, 54-65. &lt;br&gt;https://doi.org/10.1109/MPE.2008.918702</mixed-citation></ref><ref id="hanspub.20450-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">马添翼, 金新民, 梁建钢. 孤岛模式微电网变流器的复合式虚拟阻抗控制策略[J]. 电工技术学报, 2013, 28(12): 304-312.</mixed-citation></ref><ref id="hanspub.20450-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Olivares, D.E., Mehrizi-Sani, A., Etemadi, A.H., et al. (2014) Trends in Microgridcontrol. IEEE Transactions on Smart Grid, 5 1905-1919. &lt;br&gt;https://doi.org/10.1109/TSG.2013.2295514.</mixed-citation></ref><ref id="hanspub.20450-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">易永辉, 任志航, 马红伟, 等. 分布式电源高渗透率的微电网快速稳定控制技术研究[J]. 电力系统保护与控制, 2016, 44(20): 31-36.</mixed-citation></ref><ref id="hanspub.20450-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">杨欢, 赵荣祥, 辛焕海, 等. 海岛电网发展现状与研究动态[J]. 电工技术学报, 2013, 28(11): 95-105.</mixed-citation></ref><ref id="hanspub.20450-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">张建华, 于雷, 刘念, 等. 含风/光/柴/蓄及海水淡化负荷的微电网容量优化配置[J]. 电工技术学报, 2014(2):  102-112.</mixed-citation></ref><ref id="hanspub.20450-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Pogaku, N., Prodanovic, M. and Green, T.C. (2007) Modeling, Analysis and Testing of Autonomous Operation of an Inverter-Based Microgrid. IEEE Transactions on Power Electronics, 22, 613-625.  
&lt;br&gt;https://doi.org/10.1109/TPEL.2006.890003</mixed-citation></ref><ref id="hanspub.20450-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">徐玉琴, 马焕均. 基于改进下垂控制的逆变器并联运行技术[J]. 电力系统保护与控制, 2015, 43(7): 103-107.</mixed-citation></ref><ref id="hanspub.20450-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">高晓芝, 李林川, 张蕾. 含电压源型逆变器和同步电机接口的微网控制[J]. 电力系统保护与控制, 2012, 40(23): 145-150.</mixed-citation></ref><ref id="hanspub.20450-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">陈丽娟, 王致杰. 基于改进下垂控制的微电网运行控制研究[J]. 电力系统保护与控制, 2016(4): 16-21.</mixed-citation></ref><ref id="hanspub.20450-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Tan, K.T., Peng, X.Y., So, P.L., et al. (2012) Centralized Control for Parallel Operation of Distributed Generation Inverters in Microgrids. IEEE Transactions on Smart Grid, 3, 1977-1987. &lt;br&gt;https://doi.org/10.1109/TSG.2012.2205952</mixed-citation></ref><ref id="hanspub.20450-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Vasquez, J.C., Guerrero, J.M., Miret, J., et al. (2010) Hierarchical Control of Intelligent Microgrids. IEEE Industrial Electronics Magazine, 4, 23-29. &lt;br&gt;https://doi.org/10.1109/MIE.2010.938720.</mixed-citation></ref><ref id="hanspub.20450-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Guerrero, J.M., Vasquez, J.C., Matas, J., et al. (2009) Hierar-chical Control of Droop-Controlled DC and AC Microgrids—A General Approach towards Standardization. IEEE Transactions on Industrial Electronics, 58, 158-172. 
&lt;br&gt;https://doi.org/10.1109/TIE.2010.2066534</mixed-citation></ref><ref id="hanspub.20450-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Guerrero, J.M., Loh, P.C., Lee, T.L., et al. (2013) Advanced Control Architectures for Intelligent Microgrids—Part I: Decentralized and Hierarchical Control. IEEE Transactions on Industrial Electronics, 60, 1254-1262.  
&lt;br&gt;https://doi.org/10.1109/TIE.2012.2194969</mixed-citation></ref><ref id="hanspub.20450-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Wu, X., Shen, C. and Iravani, R. (2016) A Distributed, Cooperative Frequency and Voltage Control for Microgrids. IEEE Transactions on Smart Grid, PP, 1.</mixed-citation></ref><ref id="hanspub.20450-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Wang, Y., Chen, Z., Wang, X., et al. (2015) An Estimator-Based Distributed Voltage-Predictive Control Strategy for AC Islanded Microgrids. IEEE Transactions on Power Electronics, 30, 3934-3951.  
&lt;br&gt;https://doi.org/10.1109/TPEL.2014.2345696</mixed-citation></ref><ref id="hanspub.20450-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Lu, X., Yu, X., Lai, J., et al. (2016) Distributed Secondary Voltage and Frequency Control for Islanded Microgrids with Uncertain Communication Links. Transactions on Industrial Informatics, PP, 1.</mixed-citation></ref><ref id="hanspub.20450-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">贾星蓓, 窦春霞, 岳东, 等. 基于多代理系统的微电网多尺度能量管理[J]. 电工技术学报, 2016, 31(17): 63-73.</mixed-citation></ref><ref id="hanspub.20450-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">李中雷, 宋蕙慧, 曲延滨. 基于母线Agent的微电网孤岛协调控制策略[J]. 电工技术学报, 2015(S1): 370-376.</mixed-citation></ref><ref id="hanspub.20450-ref21"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Li, Q., Chen, F., Chen, M., et al. (2016) Agent-Based Decentralized Control Method for Islanded Microgrids. IEEE Transactions on Smart Grid, 7, 637-649.</mixed-citation></ref><ref id="hanspub.20450-ref22"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">Li, Q., Peng, C., Chen, M., et al. (2017) Networked and Distributed Control Method with Optimal Power Dispatch for Islanded Microgrids. IEEE Transactions on Industrial Electronics, 64, 493-504.  
&lt;br&gt;https://doi.org/10.1109/TIE.2016.2598799</mixed-citation></ref><ref id="hanspub.20450-ref23"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Chen, F., Chen, M., Li, Q., et al. (2016) Multiagent-Based Reactive Power Sharingand Control Model for Islanded Microgrids. IEEE Transactions on Sustainable Energy, 7, 1232-1244. &lt;br&gt;https://doi.org/10.1109/TSTE.2016.2539213</mixed-citation></ref><ref id="hanspub.20450-ref24"><label>24</label><mixed-citation publication-type="other" xlink:type="simple">Majumder, R., Ghosh, A., Ledwich, G., et al. (2010) Power Management and Power Flow Control with Back-to-Back Converters in a Utility Connected Microgrid. IEEE Transactions on Power Systems, 25, 821-834.  
&lt;br&gt;https://doi.org/10.1109/TPWRS.2009.2034666</mixed-citation></ref><ref id="hanspub.20450-ref25"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Ren, W., Beard, R.W. and Mclain, T.W. (2005) Coordination Variables and Consensus Building in Multiple Vehicle Systems. Lecture Notes in Control &amp; Information Sciences, 309, 439-442.</mixed-citation></ref><ref id="hanspub.20450-ref26"><label>26</label><mixed-citation publication-type="other" xlink:type="simple">Liu, J. and Morse, A.S. (2011) Accelerated Linear Iterations for Distributed Averaging. Annual Reviews in Control, 35, 160-165. &lt;br&gt;https://doi.org/10.1016/j.arcontrol.2011.10.005</mixed-citation></ref></ref-list></back></article>