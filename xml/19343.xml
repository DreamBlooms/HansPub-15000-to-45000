<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">JWRR</journal-id><journal-title-group><journal-title>Journal of Water Resources Research</journal-title></journal-title-group><issn pub-type="epub">2166-6024</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/JWRR.2016.56066</article-id><article-id pub-id-type="publisher-id">JWRR-19343</article-id><article-categories><subj-group subj-group-type="heading"><subject>JWRR20160600000_74985283.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>地球与环境</subject><subject> 合作期刊</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于年径流分类的水库优化调度函数研究
  Reservoir Optimal Operation Function Based on Annual Runoff Classification
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>陈</surname><given-names>柯兵</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>郭</surname><given-names>生练</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>杨</surname><given-names>光</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>尹</surname><given-names>家波</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>钟</surname><given-names>逸轩</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>武汉大学水资源与水电工程科学国家重点实验室，湖北 武汉；水资源安全保障湖北省协同创新中心，湖北 武汉</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>chenkb@whu.edu.cn(陈柯)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>02</day><month>12</month><year>2016</year></pub-date><volume>05</volume><issue>06</issue><fpage>572</fpage><lpage>581</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   传统水库调度函数一般以最大化长系列多年平均发电、保证率等指标为目标函数，其内涵是水库多年运行的平均期望效益最大化，并未考虑年径流丰枯的区别。显然水库的优化调度函数与入库径流的丰枯情况有关，丰水年的优化调度函数与枯水年相比势必差异较大。为研究年径流分类对水库优化调度函数的影响，本文建立了考虑发电量及保证率的多目标优化调度模型，采用NSGA-II算法优化安康水库调度函数。结果表明：考虑径流分类，采用丰、平、枯水年的单独优化比长系列优化取得更好的效益。发电量最大非劣解提升发电量0.71%、保证率4.56%，保证率最高非劣解提升发电量1.37%、保证率2.57%。 The traditional reservoir operation function is generally to maximize the long-term average power gen-eration, the guarantee rate and other indicators as the objective function. The connotation is that the av-erage expected benefit of the reservoir is maximized for long time series, but does not consider the vari-ation of annual runoff. It is obvious that the optimal operation function of the reservoir is related to the abundance of runoff that is quite different between the wet and dry years. In order to study the effect of annual runoff classification on reservoir operation function, a multi-objective operation model considering power generation and guarantee rate was established. The NSGA-II algorithm was used to optimize the operation function of Ankang reservoir. The results show that the runoff classification method is better than the long series optimization method. The largest non-inferior power generation solution can increase 0.71% power generation and 4.56% guarantee rate. The largest non-inferior guarantee rate solution can increase 1.37% power generation and 2.57% guarantee rate. 
  
 
</p></abstract><kwd-group><kwd>调度函数，多目标优化，集对分析，安康水库, Reservoir Operation Function</kwd><kwd> Multi-Objective Optimization</kwd><kwd> Set Pair Analysis</kwd><kwd> Ankang Reservoir</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于年径流分类的水库优化调度函数研究<sup> </sup></title><p>陈柯兵<sup>1,2</sup>，郭生练<sup>1,2</sup>，杨光<sup>1,2</sup>，尹家波<sup>1,2</sup>，钟逸轩<sup>1,2</sup></p><p><sup>1</sup>武汉大学水资源与水电工程科学国家重点实验室，湖北 武汉</p><p><sup>2</sup>水资源安全保障湖北省协同创新中心，湖北 武汉</p><disp-formula id="hanspub.19343-formula43"><graphic xlink:href="http://html.hanspub.org/file/6-2410460x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年12月2日；录用日期：2016年12月20日；发布日期：2016年12月23日</p><disp-formula id="hanspub.19343-formula44"><graphic xlink:href="http://html.hanspub.org/file/6-2410460x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>传统水库调度函数一般以最大化长系列多年平均发电、保证率等指标为目标函数，其内涵是水库多年运行的平均期望效益最大化，并未考虑年径流丰枯的区别。显然水库的优化调度函数与入库径流的丰枯情况有关，丰水年的优化调度函数与枯水年相比势必差异较大。为研究年径流分类对水库优化调度函数的影响，本文建立了考虑发电量及保证率的多目标优化调度模型，采用NSGA-II算法优化安康水库调度函数。结果表明：考虑径流分类，采用丰、平、枯水年的单独优化比长系列优化取得更好的效益。发电量最大非劣解提升发电量0.71%、保证率4.56%，保证率最高非劣解提升发电量1.37%、保证率2.57%。</p><p>关键词 :调度函数，多目标优化，集对分析，安康水库</p><disp-formula id="hanspub.19343-formula45"><graphic xlink:href="http://html.hanspub.org/file/6-2410460x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 绪论</title><p>水库调度是指根据水库承担的综合利用任务，运用水库的调蓄能力，重新分配水资源的时空分布，达到兴利、除害的目的 [<xref ref-type="bibr" rid="hanspub.19343-ref1">1</xref>] 。根据水库特征及长系列入库径流规律制定的调度图和调度函数是目前指导水库中长期调度的主要规则 [<xref ref-type="bibr" rid="hanspub.19343-ref2">2</xref>] 。水库调度函数的研究是水库调度理论和应用研究的一个重要分支，其理论意义和实用价值都是重大的。在来水已知的情况下，水库系统每个时段的最优决策与时段初状态、入库来水等状态有关，可以采用线性或者非线性的调度函数描述这种相关关系。</p><p>尹正杰等 [<xref ref-type="bibr" rid="hanspub.19343-ref3">3</xref>] 采用基于模拟的遗传算法优化模型对一种水库多目标供水的调度规则参数进行优化，检验了供水调度规则的合理性。刘攀等 [<xref ref-type="bibr" rid="hanspub.19343-ref4">4</xref>] 构建了“优化–拟合–再优化–随机仿真”框架来优化制定梯级水库群联合优化调度函数。周研来等 [<xref ref-type="bibr" rid="hanspub.19343-ref5">5</xref>] 结合动态规划和回归分析推求大渡河梯级水库调度函数，并采用非线性规划法进行修正，修正后的调度函数能有效增加水库年均发电量。杨光等 [<xref ref-type="bibr" rid="hanspub.19343-ref6">6</xref>] 采用NSGA-II算法，推求丹江口水库多目标调度函数集，得出兼顾丹江口水库供水和发电的多目标调度规则。</p><p>这些文献均采用长系列径流资料作为模型的输入，以多年平均发电、保证率等指标最大化为目标函数，其内涵是优化得到满足水库多年调度运行的平均期望效益最大要求的调度函数。而实际上水库的优化调度函数显然与入库径流的丰枯分类有关，丰水年的优化调度函数与枯水年相比势必差异较大，丰水年若采用长系列优化得到的调度函数进行调度运行其效益相对保守，现有优化研究较少考虑这个问题。本文试图探讨基于年径流分类的水库调度函数优化，比较年径流分类优化与传统优化方式的优劣。</p></sec><sec id="s4"><title>2. 数学模型和优化算法</title><sec id="s4_1"><title>2.1. 目标函数</title><p>水库每个时段的总出库流量与该时段内的可用水量有关，其中的可用水量由水库蓄水量和该时段内的入库水量组成。一般来说，调度函数是非线性的，但对于单个水库可将调度函数简化为易于处理的线性函数 [<xref ref-type="bibr" rid="hanspub.19343-ref7">7</xref>] 。以安康水库为例，水库产生尽可能大的发电效益和保证率为调度准则，建立线性调度函数如下：</p><disp-formula id="hanspub.19343-formula46"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x11_hanspub.png" xlink:type="simple"/></inline-formula>为水库第t时段出库流量(m<sup>3</sup>/s)；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x12_hanspub.png" xlink:type="simple"/></inline-formula>为水库第t时段的库容(m<sup>3</sup>)；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x13_hanspub.png" xlink:type="simple"/></inline-formula>为水库第t时段的入库平均流量(m<sup>3</sup>/s)；w为单位转换系数；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x14_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x15_hanspub.png" xlink:type="simple"/></inline-formula>分别为调度函数系数。</p><p>同时，以发电量最大和保证率最高为目标进行调度，目标函数如下所示：</p><disp-formula id="hanspub.19343-formula47"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x16_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.19343-formula48"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x17_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：E为计划期T内发电量(kW&#183;h)；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x18_hanspub.png" xlink:type="simple"/></inline-formula>为第t时段的平均出力(kW)；K为电站综合出力系数；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x19_hanspub.png" xlink:type="simple"/></inline-formula>为第t时段的平均发电流量(m<sup>3</sup>/s)；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x20_hanspub.png" xlink:type="simple"/></inline-formula>为第t时段的平均发电水头(m)；P为发电保证率；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x21_hanspub.png" xlink:type="simple"/></inline-formula>为保证出力；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x22_hanspub.png" xlink:type="simple"/></inline-formula>表示梯级系统总出力大于保证出力的时段数。</p></sec><sec id="s4_2"><title>2.2. 约束条件</title><p>(1) 水量平衡约束：</p><disp-formula id="hanspub.19343-formula49"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x23_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x24_hanspub.png" xlink:type="simple"/></inline-formula>为水库第t时段的库容(m<sup>3</sup>)；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x25_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x26_hanspub.png" xlink:type="simple"/></inline-formula>分别为水库第t时段的入库和出库平均流量(m<sup>3</sup>/s)；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x27_hanspub.png" xlink:type="simple"/></inline-formula>为计算时间步长；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x28_hanspub.png" xlink:type="simple"/></inline-formula>为水库第t时段的水分损失量(m<sup>3</sup>)，如蒸散发、渗漏等。</p><p>(2) 水库水位约束：</p><disp-formula id="hanspub.19343-formula50"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x29_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x30_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x31_hanspub.png" xlink:type="simple"/></inline-formula>分别为水库第t时段的允许最大和最小水位(m)。</p><p>(3) 水库下泄流量约束：</p><disp-formula id="hanspub.19343-formula51"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x32_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x33_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x34_hanspub.png" xlink:type="simple"/></inline-formula>分别为水库第t时段的允许最大和最小下泄流量(m<sup>3</sup>/s)，一般由下游生态，航运要求和水库下游的防洪任务确定。</p><p>(4) 电站出力约束：</p><disp-formula id="hanspub.19343-formula52"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x35_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x36_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x37_hanspub.png" xlink:type="simple"/></inline-formula>分别为水库第t时段的允许最大和最小出力(kW)。</p><p>(5) 边界约束：</p><disp-formula id="hanspub.19343-formula53"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/6-2410460x38_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中：<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x39_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x40_hanspub.png" xlink:type="simple"/></inline-formula>分别为水库初、末时段的水位(m)。</p></sec><sec id="s4_3"><title>2.3. NSGA-II优化算法</title><p>NSGA-II算法由Deb [<xref ref-type="bibr" rid="hanspub.19343-ref8">8</xref>] 于2000年提出，以其快速的运行效果和良好的收敛性目前被广泛应用于多目标优化计算。近年来该算法已被我国学者广泛应用于水库多目标调度的研究中，并取得了良好的效果 [<xref ref-type="bibr" rid="hanspub.19343-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.19343-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.19343-ref10">10</xref>] 。算法的具体计算流程参阅文献 [<xref ref-type="bibr" rid="hanspub.19343-ref11">11</xref>] ，具体计算步骤包括：</p><p>(1) 随机初始化种群，并按照非劣排序方法排序分组后形成父代。</p><p>(2) 通过选择、交叉、变异产生新种群作为子代，与父代混合后进行排序，得到非劣前端。</p><p>(3) 计算所有非劣前端的拥挤距离，并按照拥挤距离排序。</p><p>(4) 按上一步排列后的顺序选择非劣前端，并通过复制、交叉和变异形成新的种群。</p><p>(5) 重复(2)~(4)直到满足终止条件，将最后得到的种群作为优化后的Pareto前端。</p><p>根据式(1)中的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x41_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x42_hanspub.png" xlink:type="simple"/></inline-formula>可以确定调度函数，传统优化调度函数的方法一般直接优化调度过程，将优化后的出库流量与水库蓄水量、入库流量等决策因子进行线性拟合得到<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x43_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x44_hanspub.png" xlink:type="simple"/></inline-formula>。本研究采用基于“模拟–优化”模式调度函数优化方式，避免了先进行确定性优化再拟合得到调度函数，直接可以得到实现目标最优的水库调度函数，因此更高效，解的质量也更优 [<xref ref-type="bibr" rid="hanspub.19343-ref12">12</xref>] 。利用NSGA-II优化算法将一年36个旬的<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x45_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x46_hanspub.png" xlink:type="simple"/></inline-formula>一共72个参数编码为染色体，以每一组<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x47_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/6-2410460x48_hanspub.png" xlink:type="simple"/></inline-formula>为决策变量进行模拟调度，计算发电量及相应保证率，其中种群个数为30，进化代数为200，交叉和变异概率分别取0.9和0.1。</p></sec></sec><sec id="s5"><title>3. 实例研究和结果分析</title><sec id="s5_1"><title>3.1. 安康水库年径流丰枯分类</title><p>安康水库位于汉江干流上游陕西省安康市境内，坝址位于安康市城西18 km处，上游距石泉水电站170 km，下游距湖北丹江口水库260 km，多年平均径流量192亿m<sup>3</sup>，控制流域集水面积35,700 km<sup>2</sup>。安康水库总库容32亿m<sup>3</sup>，其中，死库容为9.08亿m<sup>3</sup>，兴利库容为14.72亿m<sup>3</sup>，防洪库容为3.6亿m<sup>3</sup>，死水位305.00 m，极限死水位300.00 m，正常蓄水位330.00 m，防洪限制水位325.00 m，设计洪水位333.00 m，校核洪水位337.33 m。</p><p>进行年径流丰枯分类的常规方法是以年径流总量为指标, 采用频率分析、均值标准差等方法确定, 没有考虑径流的年内分配情况。为了弥补常规方法的不足，王文圣等提出了一系列年径流丰枯划分的方法，如基于集对分析的年径流丰枯分类方法，该法不仅考虑了径流的大小, 而且也考虑了其时程分配，研究表明该方法简单实用，分类结果客观 [<xref ref-type="bibr" rid="hanspub.19343-ref13">13</xref>] 。以安康水库1951~2010共60年的月均入库流量，按基于集对分析的年径流丰枯分类方法，进行年径流丰枯的划分，结果见表1。</p><p>为比较不考虑年径流分类的长系列优化方式与考虑年径流分类的丰、平、枯水年单独优化方式效益的差异，以60年长系列旬入库流量和上述集对分析法求得的丰(含特丰)、平、枯(含特枯)水年旬入库流量作为前述模型的输入，优化算法采用NSGA-II，按发电量和保证率最大为目标对优化变量(个体)进行优化。</p></sec><sec id="s5_2"><title>3.2. 优化结果</title><p>将安康水库1951~2010年的旬入库流量作为模型的输入，绘制NSGA-II算法求解模型所得到Pareto前端，并提取Pareto前端中发电量最大、保证率最高两非劣解对应调度函数参数。采用NSGA-II算法优化得到了关于发电和保证率的Pareto前端如图1(a)所示，图中每一个非劣解对应一种安康水库优化调度函数。表2为长系列优化Pareto前端中发电量最大、保证率最高两非劣解对应调度函数部分参数。</p><p>将集对分析法划分出的丰、平、枯水年各自旬入库流量作为模型的输入，绘制NSGA-II算法求解模型所得到Pareto前端。并利用长系列优化得到发电量最大、保证率最高调度函数，结合丰、平、枯水年各自旬入库流量进行模拟调度，将其结果绘入相应Pareto前端中。由图1中可以看出，考虑年径流分类方法得到的非劣解集，均明显优于根据长系列资料优化调度函数得到的结果。表3给出了考虑年径流分类后，丰、平、枯水年各自发电量最大、保证率最高非劣解对应效益，括号中为考虑年径流分类优化方式比按长系列优化，不同年型与60年合计提升效益百分数。</p><p>由表3可以看出，随着径流分类由丰至枯变化，单独优化所能提高效益基本逐渐下降，这是因为丰水年入库来水较枯水年丰富，可供调度函数优化潜力更大，能够比长系列优化方式取得更优的效益。但当径流分类为枯时，选取发电量最大非劣解进行调度，长系列优化方式取得保证率仅为65.66%比单独优化相差6.42%，为表中相差最大数据。造成此结果的原因是，枯水年不适合采用长系列发电量最大调度函数进行调度，显然枯水年由于来水较小，按长系列发电优化调度函数进行操作下泄流量较大，将造成水库水位一直位于低位，不利于水库发电，将大幅降低发电保证率。平均而言考虑年径流分类的优化方式，发电量最大非劣解提升发电量0.71%、</p><p>保证率4.56%，保证率最高非劣解提升发电量1.37%、保证率2.57%。</p><p>通过上述讨论，可得出以下结论：考虑径流分类，采用丰、平、枯水年单独优化的方法比长系列优化方法取得更好的效益，丰水年单独优化所获得效益更加显著。而枯水年采用长系列发电量最大非劣解进行调度，将严重影响其发电保证率。为了进一步揭示考虑径流分类单独优化的方法对水库调度过程的影响，下面选取丰水年1983年、平水年2007年、枯水年1997年为典型年，对安康水库采用不同发电量最大优化方式所得调度过程进行分析。</p></sec><sec id="s5_3"><title>3.3. 调度过程分析</title><p>1983年为安康水库1951~2010共60年入库资料中来水最多的一年，通过调度函数模拟调度计算可得结果见表4。丰水年优化方式与长系列相比，减小了弃水，增加了发电用水，更高效、合理运用了水资源，提高发电量1.14%。调度过程见图2(a)，从水库水位变化及出力过程可以看出，丰水年优化在汛前5月初至6月上旬出力较大，为丰水年汛期较大的来水腾空库容避免弃水，为更加合理的调度方式。两种优化方式在来水较丰的6月下旬至10月下旬相差不大，均以装机容量出力，且均抬高水库运行水位至正常蓄水位330 m，为次年的兴利提供保障。但丰水年优化在12月与1月出力较均衡，水库运行更加平稳。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Runoff classification result</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >年份</th><th align="center" valign="middle" >集对分析法</th><th align="center" valign="middle" >年份</th><th align="center" valign="middle" >集对分析法</th><th align="center" valign="middle" >年份</th><th align="center" valign="middle" >集对分析法</th></tr></thead><tr><td align="center" valign="middle" >1951</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1971</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1991</td><td align="center" valign="middle" >特枯</td></tr><tr><td align="center" valign="middle" >1952</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >1972</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1992</td><td align="center" valign="middle" >平</td></tr><tr><td align="center" valign="middle" >1953</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1973</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1993</td><td align="center" valign="middle" >丰</td></tr><tr><td align="center" valign="middle" >1954</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1974</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >1994</td><td align="center" valign="middle" >枯</td></tr><tr><td align="center" valign="middle" >1955</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1975</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >1995</td><td align="center" valign="middle" >特枯</td></tr><tr><td align="center" valign="middle" >1956</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1976</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1996</td><td align="center" valign="middle" >平</td></tr><tr><td align="center" valign="middle" >1957</td><td align="center" valign="middle" >特枯</td><td align="center" valign="middle" >1977</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1997</td><td align="center" valign="middle" >特枯</td></tr><tr><td align="center" valign="middle" >1958</td><td align="center" valign="middle" >特丰</td><td align="center" valign="middle" >1978</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1998</td><td align="center" valign="middle" >特枯</td></tr><tr><td align="center" valign="middle" >1959</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1979</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1999</td><td align="center" valign="middle" >特枯</td></tr><tr><td align="center" valign="middle" >1960</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1980</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >2000</td><td align="center" valign="middle" >平</td></tr><tr><td align="center" valign="middle" >1961</td><td align="center" valign="middle" >特丰</td><td align="center" valign="middle" >1981</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >2001</td><td align="center" valign="middle" >枯</td></tr><tr><td align="center" valign="middle" >1962</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1982</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >2002</td><td align="center" valign="middle" >特枯</td></tr><tr><td align="center" valign="middle" >1963</td><td align="center" valign="middle" >特丰</td><td align="center" valign="middle" >1983</td><td align="center" valign="middle" >特丰</td><td align="center" valign="middle" >2003</td><td align="center" valign="middle" >平</td></tr><tr><td align="center" valign="middle" >1964</td><td align="center" valign="middle" >特丰</td><td align="center" valign="middle" >1984</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >2004</td><td align="center" valign="middle" >枯</td></tr><tr><td align="center" valign="middle" >1965</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1985</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >2005</td><td align="center" valign="middle" >平</td></tr><tr><td align="center" valign="middle" >1966</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1986</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >2006</td><td align="center" valign="middle" >特枯</td></tr><tr><td align="center" valign="middle" >1967</td><td align="center" valign="middle" >特丰</td><td align="center" valign="middle" >1987</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >2007</td><td align="center" valign="middle" >平</td></tr><tr><td align="center" valign="middle" >1968</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >1988</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >2008</td><td align="center" valign="middle" >枯</td></tr><tr><td align="center" valign="middle" >1969</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >1989</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >2009</td><td align="center" valign="middle" >平</td></tr><tr><td align="center" valign="middle" >1970</td><td align="center" valign="middle" >平</td><td align="center" valign="middle" >1990</td><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >2010</td><td align="center" valign="middle" >枯</td></tr></tbody></table></table-wrap><p>表1. 径流丰枯分类成果表</p><p>图1. NSGA-II算法优化Pareto前端(a)长系列(b)丰水年(c)平水年(d)枯水年</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Non-inferior solution parameter</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >非劣解</th><th align="center" valign="middle"  colspan="2"  >5月上旬</th><th align="center" valign="middle"  colspan="2"  >8月上旬</th><th align="center" valign="middle"  colspan="2"  >12月上旬</th></tr></thead><tr><td align="center" valign="middle" >调度函数参数</td><td align="center" valign="middle" >a<sub>t</sub></td><td align="center" valign="middle" >b<sub>t</sub></td><td align="center" valign="middle" >a<sub>t</sub></td><td align="center" valign="middle" >b<sub>t</sub></td><td align="center" valign="middle" >a<sub>t</sub></td><td align="center" valign="middle" >b<sub>t</sub></td></tr><tr><td align="center" valign="middle" >发电量最大</td><td align="center" valign="middle" >21.49</td><td align="center" valign="middle" >131.76</td><td align="center" valign="middle" >87.18</td><td align="center" valign="middle" >−750.57</td><td align="center" valign="middle" >59.96</td><td align="center" valign="middle" >−761.36</td></tr><tr><td align="center" valign="middle" >保证率最高</td><td align="center" valign="middle" >29.88</td><td align="center" valign="middle" >129.81</td><td align="center" valign="middle" >82.72</td><td align="center" valign="middle" >−1393.93</td><td align="center" valign="middle" >64.63</td><td align="center" valign="middle" >−761.36</td></tr></tbody></table></table-wrap><p>表2. 非劣解参数表</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Effectiveness statistics of Ankang Reservoi</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  rowspan="2"  >优化方式</th><th align="center" valign="middle"  rowspan="2"  >年型</th><th align="center" valign="middle"  colspan="2"  >发电量最大</th><th align="center" valign="middle"  colspan="2"  >保证率最高</th></tr></thead><tr><td align="center" valign="middle" >年均发电(亿kW&#183;h)</td><td align="center" valign="middle" >保证率(%)</td><td align="center" valign="middle" >年均发电(亿kW&#183;h)</td><td align="center" valign="middle" >保证率(%)</td></tr><tr><td align="center" valign="middle"  rowspan="4"  >长系列</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >33.19</td><td align="center" valign="middle" >89.76</td><td align="center" valign="middle" >32.77</td><td align="center" valign="middle" >91.15</td></tr><tr><td align="center" valign="middle" >平</td><td align="center" valign="middle" >27.63</td><td align="center" valign="middle" >79.57</td><td align="center" valign="middle" >27.02</td><td align="center" valign="middle" >84.33</td></tr><tr><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >21.18</td><td align="center" valign="middle" >65.66</td><td align="center" valign="middle" >20.98</td><td align="center" valign="middle" >72.66</td></tr><tr><td align="center" valign="middle" >合计</td><td align="center" valign="middle" >26.24</td><td align="center" valign="middle" >76.15</td><td align="center" valign="middle" >25.84</td><td align="center" valign="middle" >81.06</td></tr><tr><td align="center" valign="middle"  rowspan="4"  >考虑年径流分类</td><td align="center" valign="middle" >丰</td><td align="center" valign="middle" >33.62 (1.30%)</td><td align="center" valign="middle" >93.53 (4.20%)</td><td align="center" valign="middle" >33.22 (1.37%)</td><td align="center" valign="middle" >96.50 (5.87%)</td></tr><tr><td align="center" valign="middle" >平</td><td align="center" valign="middle" >27.83 (0.72%)</td><td align="center" valign="middle" >81.95 (2.99%)</td><td align="center" valign="middle" >27.59 (2.11%)</td><td align="center" valign="middle" >86.45 (2.51%)</td></tr><tr><td align="center" valign="middle" >枯</td><td align="center" valign="middle" >21.22 (0.19%)</td><td align="center" valign="middle" >69.88 (6.42%)</td><td align="center" valign="middle" >21.09 (0.52%)</td><td align="center" valign="middle" >72.88 (0.30%)</td></tr><tr><td align="center" valign="middle" >合计</td><td align="center" valign="middle" >26.43 (0.71%)</td><td align="center" valign="middle" >79.62 (4.56%)</td><td align="center" valign="middle" >26.20 (1.37%)</td><td align="center" valign="middle" >83.14 (2.57%)</td></tr></tbody></table></table-wrap><p>表3. 效益统计表</p><p>2007年为安康水库入库径流资料通过集对分析法划分出的平水年，通过调度函数模拟调度计算可得结果见表4。平水年优化方式与长系列相比，同上述1983年情况类似，减小了弃水，增加了发电用水，更高效、合理运用了水资源，提高发电量0.16%。调度过程见图2(b)，从水库水位变化及出力过程可以看出，平水年优化在汛前5月初至7月出力较大，为7月开始325m的汛限水位限制，提前腾空库容避免弃水。同样在9月初开始，</p><p>图2. 水库丰平枯水年调度结果过程比较。(a) 丰水年；(b) 平水年；(c) 枯水年</p><table-wrap id="table4" ><label><xref ref-type="table" rid="table4">Table 4</xref></label><caption><title> Reservoir operation effectiveness statistic</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >优化方式</th><th align="center" valign="middle" >年份</th><th align="center" valign="middle" >发电用水(亿m<sup>3</sup>)</th><th align="center" valign="middle" >弃水(亿m<sup>3</sup>)</th><th align="center" valign="middle" >发电量(亿kW&#183;h)</th><th align="center" valign="middle" >水库平均水位(m)</th></tr></thead><tr><td align="center" valign="middle"  rowspan="3"  >长系列</td><td align="center" valign="middle" >1983</td><td align="center" valign="middle" >235.78</td><td align="center" valign="middle" >166.79</td><td align="center" valign="middle" >41.01</td><td align="center" valign="middle" >325.09</td></tr><tr><td align="center" valign="middle" >2007</td><td align="center" valign="middle" >143.83</td><td align="center" valign="middle" >27.67</td><td align="center" valign="middle" >24.32</td><td align="center" valign="middle" >320.68</td></tr><tr><td align="center" valign="middle" >1997</td><td align="center" valign="middle" >72.89</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >12.01</td><td align="center" valign="middle" >317.53</td></tr><tr><td align="center" valign="middle"  rowspan="3"  >考虑年径流分类</td><td align="center" valign="middle" >1983</td><td align="center" valign="middle" >241.38</td><td align="center" valign="middle" >163.26</td><td align="center" valign="middle" >41.48</td><td align="center" valign="middle" >324.20</td></tr><tr><td align="center" valign="middle" >2007</td><td align="center" valign="middle" >145.36</td><td align="center" valign="middle" >26.14</td><td align="center" valign="middle" >24.36</td><td align="center" valign="middle" >320.09</td></tr><tr><td align="center" valign="middle" >1997</td><td align="center" valign="middle" >72.89</td><td align="center" valign="middle" >0</td><td align="center" valign="middle" >12.20</td><td align="center" valign="middle" >318.56</td></tr></tbody></table></table-wrap><p>表4. 水库调度效益统计表</p><p>水库逐步蓄水至330 m正常蓄水位时，平水年优化方式加大了出力，与长系列相比同时蓄满，避免了弃水，为效益更佳的调度方式。同样平水年优化在12月与1月出力均衡，水库运行平稳。</p><p>1997年为安康水库1951~2010共60年入库资料中来水最少的一年，通过调度函数模拟调度计算可得结果见表4。枯水年优化方式与长系列相比，在发电用水相同的情况下，由于其平均水位高出近1m，提高发电量1.58%，发电效益增加显著。调度过程见图2(c)，从水库水位变化及出力过程可以看出，长系列优化方式在汛期6月至8月下泄流量较大，增加了出力，降低了水库运行水位，从而影响了8月至次年4年水库的发电水头。这是由于长系列优化的调度函数在汛期下泄流量偏大，以保障丰水年、平水年加大出力，不产生弃水，但对于枯水年调度不利。</p><p>对上述调度过程的分析说明，考虑年径流分类优化比长系列优化得到的调度函数更加适用于水库调度问题。长系列优化能得到满足水库多年调度运行的平均期望效益最大要求的调度函数，而实际上水库的优化调度函数显然与入库径流的丰枯分类有关。而本文选用的集对分析法不仅考虑了年径流的大小，而且也考虑了其年内时程分配，运用效果良好。该结果也可为水库常规调度方案的制定提供参考，制定常规方案如调度函数、调度图、简化运行策略等时，需利用设计枯水年进行调节计算，因径流年内时程分配会对水库调度函数制定造成影响，如何合理进行设计枯水年年径流的分配，就成为了关键问题，在常规调度方案的制定中需得到重视。</p></sec></sec><sec id="s6"><title>4. 结论</title><p>为了讨论年径流分类对水库优化调度函数制定的影响，本文建立了考虑发电量及保证率的多目标优化调度模型，采用NSGA-II算法优化丹江口安康水库调度函数。将利用集对分析法进行年径流分类后的优化结果与传统长系列相互比较，分析了不同优化方式对水库调度过程的影响，主要结论如下：</p><p>(1) 考虑径流分类，采用丰、平、枯水年单独优化的方法比长系列优化方法取得更好的效益。发电量最大非劣解提升发电量0.71%、保证率4.56%，保证率最高非劣解提升发电量1.37%、保证率2.57%。</p><p>(2) 丰、平水年利用各自优化得出的调度函数模拟调度，可避免弃水，汛后出力均衡，水库运行平稳，调度方式更合理。枯水年采用长系列优化的调度函数在汛期下泄流量偏大，降低了水库运行水位和发电效益。</p></sec><sec id="s7"><title>基金项目</title><p>国家自然科学项目(51539009)和十三五国家重点研发项目(2016YFC0402206)。</p></sec><sec id="s8"><title>文章引用</title><p>陈柯兵,郭生练,杨 光,尹家波,钟逸轩. 基于年径流分类的水库优化调度函数研究 Reservoir Optimal Operation Function Based on Annual Runoff Classification[J]. 水资源研究, 2016, 05(06): 572-581. http://dx.doi.org/10.12677/JWRR.2016.56066</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.19343-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">潘理中, 芮孝芳. 水电站水库优化调度研究的若干进展[J]. 水文, 1999, 19(6): 37-40. 
PAN Lizhong, RUI Xiaofang. Advances in study on optimal operation of hydropower station reservoirs. Journal of China Hy-drology, 1999, 19(6): 37-40. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">OLIVEIRA R., LOUCKS, D. P. Operating rules for multireservoir system. Water Resources Research, 1997, 33(4): 839-852.</mixed-citation></ref><ref id="hanspub.19343-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">尹正杰, 胡铁松, 崔远来, 等. 水库多目标供水调度规则研究[J]. 水科学进展, 2005, 16(6): 875-880. 
YIN Zhengjie, HU Tiesong, CUI Yuanlai, et al. Study on multi-objective water supply regulation in reservoir. Advances in Water Science, 2005, 16(6): 875-880. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">刘攀, 郭生练, 张文选, 等. 梯级水库群联合优化调度函数研究[J]. 水科学进展, 2007, 18(6): 816-822. 
LIU Pan, GUO Shenglian, ZHANG Wenxuan, et al. Study on joint optimal operation function of cascade reservoirs. Advances in Water Science, 2007, 18(6): 816-822. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">周研来, 梅亚东, 杨立峰, 等. 大渡河梯级水库群联合优化调度函数研究[J]. 水力发电学报, 2012, 31(4): 78-82. 
ZHOU Yanlai, MEI Yadong, YANG Lifeng, et al. Study on joint optimal dispatch function of cascade reservoirs in Dadu River. Journal of Hydroelectric Engineering, 2012, 31(4): 78-82. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">杨光, 郭生练, 李立平, 等. 考虑未来径流变化的丹江口水库多目标调度规则研究[J]. 水力发电学报, 2015, 34(12): 54- 63.  
YANG Guang, GUO Shenglian, LI Liping, et al. Study on multi-objective scheduling rules of Danjiangkou reservoir considering future runoff variation. Journal of Hydroelectric Engineering, 2015, 34(12): 54-63. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">权先璋, 李承军. 水电站优化线性调度规则研究[J]. 华中理工大学学报, 1999, 27(12): 36-38. 
QUAN Xianzhang, LI Chengjun. Study on optimal linear operation rules for hydropower station. Journal of Huazhong Univer-sity of Science and Technology, 1999, 27(12): 36-38. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">DEB K., AGRAWAL S., PRATAP A., et al. A fast elitist nondominated sorting genetic algorithm for multi-objective optimization: NSGA-II. Lecture Notes in Computer Science, 2000, 1917: 849-858.</mixed-citation></ref><ref id="hanspub.19343-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">贠汝安, 董增川, 王好芳. 基于NSGA2的水库多目标优化[J]. 山东大学学报: 工学版, 2010, 40(6): 124-128. 
YUN Ruan, DONG Zengchuan and WANG Haofang. NASGA2-based reservoir multi-objective optimization. Journal of Shandong University: Engineering Science, 2010, 40(6): 124-128. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">肖刚, 解建仓, 罗军刚. 基于改进NSGAII的水库多目标防洪调度算法研究[J]. 水力发电学报, 2012, 31(5): 77-83. 
XIAO Gang, XIE Jiancang and LUO Jungang. Study on reservoir multi-objective flood control scheduling algorithm based on improved NSGAII. Journal of Hydroelectric Engineering, 2012, 31(5): 77-83. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">DEB K., PRATAP A., AGARWAL S., et al. A fast and elitist multiobjective genetic algorithm: NSGA-II. IEEE Transactions on Evolutionary Com-putation, 2002, 6(2): 182-197.</mixed-citation></ref><ref id="hanspub.19343-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">李雨. 水库防洪和蓄水优化调度方法及应用[D]: [博士学位论文]. 武汉: 武汉大学, 2013. 
LI Yu. Reservoir flood control and storage optimization scheduling method and application. Wuhan: Wuhan University, 2013. (in Chinese)</mixed-citation></ref><ref id="hanspub.19343-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">王文圣, 向红莲, 李跃清, 等. 基于集对分析的年径流丰枯分类新方法[J]. 四川大学学报(工程科学版), 2008, 40(5). 
WANG Wensheng, XIANG Honglian, LI Yueqing, et al. A new method for annual runoff classification based on set pair anal-ysis. Journal of Sichuan University (Engineering Science Edition), 2008, 40(5). (in Chinese).</mixed-citation></ref></ref-list></back></article>