<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">MP</journal-id><journal-title-group><journal-title>Modern  Physics</journal-title></journal-title-group><issn pub-type="epub">2161-0916</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/MP.2016.65016</article-id><article-id pub-id-type="publisher-id">MP-18663</article-id><article-categories><subj-group subj-group-type="heading"><subject>MP20160500000_95929911.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>数学与物理</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于SPH方法的流体细节模拟
  SPH-Based Fluid Simulation for Details
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>宇轩</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>春武</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>永健</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>南京航空航天大学理学院，江苏 南京</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>ylxb12@163.com(王宇)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>23</day><month>09</month><year>2016</year></pub-date><volume>06</volume><issue>05</issue><fpage>167</fpage><lpage>176</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   基于传统的SPH方法，在处理流体粒子飞溅扩散现象，本文采用[1]的固壁边界处理方法，模拟溃坝问题。同时使用一种新[2]的模型。此模型提出，当流体粒子经过扩散，会产生扩散粒子，把这些扩散粒子进行分类，分成喷雾、气泡、泡沫三类颗粒。通过无挡板溃坝问题的模拟，和实验结果进行比较，验证了此固壁边界处理方法的有效性，同时可以明显看出，这三类颗粒很大程度提高了大规模流体细节模拟的视觉效果。最后，通过有挡板的溃坝模拟，进一步观察流体细节模拟在视觉上的逼真效果。 We adopt the solid boundary condition based on the traditional SPH method on the treatment of the fluid particles splashing diffusion phenomenon for the simulation of the dam-break problem, involved in the reference [1]. At the same time, we apply a new model proposed in [2], which shows the diffusion particles are produced when the fluid particles diffuse and are classified into spray, foam and air bubble particles. Through the simulation of dam-break scene without a baffle, the simulation verifies the validity of method with the solid wall boundary processing, comparing with the numerical results. Meanwhile, we could observe obviously that these three kinds of particles greatly improve the visual effect of detail simulation of large-scale fluid. At last, we simulate different dam-break scenes, with the presence of a baffle, for the vivid visual effect of fluid simulation detail further.
    
  
 
</p></abstract><kwd-group><kwd>SPH，扩散粒子，边界处理，视觉效果, Smoothed Particle Hydrodynamics</kwd><kwd> Diffusion Particle</kwd><kwd> Boundary Solvers</kwd><kwd> Visual Effect</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于SPH方法的流体细节模拟<sup> </sup></title><p>王宇轩<sup>*</sup>，王春武，王永健</p><p>南京航空航天大学理学院，江苏 南京</p><disp-formula id="hanspub.18663-formula30"><graphic xlink:href="http://html.hanspub.org/file/2-1260191x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年9月9日；录用日期：2016年9月24日；发布日期：2016年9月30日</p><disp-formula id="hanspub.18663-formula31"><graphic xlink:href="http://html.hanspub.org/file/2-1260191x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>基于传统的SPH方法，在处理流体粒子飞溅扩散现象，本文采用 [<xref ref-type="bibr" rid="hanspub.18663-ref1">1</xref>] 的固壁边界处理方法，模拟溃坝问题。同时使用一种新 [<xref ref-type="bibr" rid="hanspub.18663-ref2">2</xref>] 的模型。此模型提出，当流体粒子经过扩散，会产生扩散粒子，把这些扩散粒子进行分类，分成喷雾、气泡、泡沫三类颗粒。通过无挡板溃坝问题的模拟，和实验结果进行比较，验证了此固壁边界处理方法的有效性，同时可以明显看出，这三类颗粒很大程度提高了大规模流体细节模拟的视觉效果。最后，通过有挡板的溃坝模拟，进一步观察流体细节模拟在视觉上的逼真效果。</p><p>关键词 :SPH，扩散粒子，边界处理，视觉效果</p><disp-formula id="hanspub.18663-formula32"><graphic xlink:href="http://html.hanspub.org/file/2-1260191x9_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>光滑粒子动力学SPH (Smoothed Particle Hydrodynamics)是一种纯Lagrange插值方法，最早用于解决天体物理学问题，和其他方法相比，此方法完全不需要网格，避免了网格扭曲和网格重构等问题，可以用于任何流体的模拟。SPH方法在Monaghan [<xref ref-type="bibr" rid="hanspub.18663-ref3">3</xref>] 和M&#252;nzel [<xref ref-type="bibr" rid="hanspub.18663-ref4">4</xref>] 的文献中有介绍。</p><p>在真实的流体模拟中，泡沫和喷雾效果是很重要的特征 [<xref ref-type="bibr" rid="hanspub.18663-ref5">5</xref>] - [<xref ref-type="bibr" rid="hanspub.18663-ref7">7</xref>] ，比如电影 [<xref ref-type="bibr" rid="hanspub.18663-ref8">8</xref>] - [<xref ref-type="bibr" rid="hanspub.18663-ref10">10</xref>] 和商用软件 [<xref ref-type="bibr" rid="hanspub.18663-ref11">11</xref>] 。流体飞溅过程中会产生喷雾、气泡、泡沫等细节现象，而目前的方法忽略了这些细节现象的建模，致使动画效果的视觉逼真性缺失。所以，本文在传统SPH方法的基础上，采用了一种新的固壁边界处理方法和一种新的模型 [<xref ref-type="bibr" rid="hanspub.18663-ref2">2</xref>] 。模型的主要作用是增加粒子扩散后的处理过程。</p></sec><sec id="s4"><title>2. 基本方程</title><sec id="s4_1"><title>2.1. 流体控制方程</title><p>在二维Lagrange坐标系下，Naiver-Stokes质量守恒方程为：</p><disp-formula id="hanspub.18663-formula33"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>动量守恒方程：</p><disp-formula id="hanspub.18663-formula34"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x11_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x12_hanspub.png" xlink:type="simple"/></inline-formula>为密度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x13_hanspub.png" xlink:type="simple"/></inline-formula>为重力加速度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x14_hanspub.png" xlink:type="simple"/></inline-formula>为速度矢量，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x15_hanspub.png" xlink:type="simple"/></inline-formula>为压强，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x16_hanspub.png" xlink:type="simple"/></inline-formula>为粘性系数。</p></sec><sec id="s4_2"><title>2.2. 状态方程</title><p>在SPH方法中，常将不可压缩流体通过合适的压力状态方程看作微可压流体。本文采用文献 [<xref ref-type="bibr" rid="hanspub.18663-ref12">12</xref>] 中的状态方程：</p><disp-formula id="hanspub.18663-formula35"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x17_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x18_hanspub.png" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x19_hanspub.png" xlink:type="simple"/></inline-formula>为声速，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x20_hanspub.png" xlink:type="simple"/></inline-formula>。关于状态方程的讨论可参考文献 [<xref ref-type="bibr" rid="hanspub.18663-ref13">13</xref>] 。</p></sec></sec><sec id="s5"><title>3. SPH离散</title>控制方程的SPH离散<p>在SPH方法中，对N-S方程有多种离散格式。对溃坝问题，边界处会出现大的伪振荡，所以本文采用文献 [<xref ref-type="bibr" rid="hanspub.18663-ref14">14</xref>] 中比较光滑的离散形式：</p><disp-formula id="hanspub.18663-formula36"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x21_hanspub.png"  xlink:type="simple"/></disp-formula><disp-formula id="hanspub.18663-formula37"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x22_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x23_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x24_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x25_hanspub.png" xlink:type="simple"/></inline-formula>分别表示粒子<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x26_hanspub.png" xlink:type="simple"/></inline-formula>的速度、位置、压强、密度和粘性系数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x27_hanspub.png" xlink:type="simple"/></inline-formula>为核函数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x28_hanspub.png" xlink:type="simple"/></inline-formula>为光滑核函数距离。本文使用五次样条内核插值 [<xref ref-type="bibr" rid="hanspub.18663-ref15">15</xref>] 。</p><p>文 [<xref ref-type="bibr" rid="hanspub.18663-ref16">16</xref>] 介绍另一种内核函数，感兴趣可参考。</p></sec><sec id="s6"><title>4. 固壁边界条件</title><p>为了保证固壁边界满足不可穿透和无滑移条件，本文采用一种新的处理方法。在固壁上，布置一层固壁粒子。对于固壁粒子<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x29_hanspub.png" xlink:type="simple"/></inline-formula>，其压力计算式为</p><disp-formula id="hanspub.18663-formula38"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x30_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x31_hanspub.png" xlink:type="simple"/></inline-formula>为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x32_hanspub.png" xlink:type="simple"/></inline-formula>邻居流体粒子。</p><p>在固壁外再布置一层固定虚粒子，保持位置不变，压力和速度按照下列公式计算，见文献 [<xref ref-type="bibr" rid="hanspub.18663-ref1">1</xref>]</p><disp-formula id="hanspub.18663-formula39"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x33_hanspub.png"  xlink:type="simple"/></disp-formula><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x34_hanspub.png" xlink:type="simple"/></inline-formula>表示向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x35_hanspub.png" xlink:type="simple"/></inline-formula>，为了精确求解<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x36_hanspub.png" xlink:type="simple"/></inline-formula>，再次用到(7)式。</p><p>可以看出，这种固壁处理方法利用周围流体粒子来计算固壁边界的压力，避免固壁边界的粒子出现伪震荡，并且不需要施加任何额外的排斥力就能够有效的防止粒子穿透，提高了边界处的精度。</p></sec><sec id="s7"><title>5. 流体粒子扩散</title><p>流体粒子扩散通常发生在自由表面上，能够产生扩散现象的有三种情况 [<xref ref-type="bibr" rid="hanspub.18663-ref17">17</xref>] 。一是空气滞留。二是在波峰处，流体粒子会飞溅，产生扩散粒子。三是流体颗粒自身有一定的能量，能量越大，产生扩散粒子的可能性越大。</p><sec id="s7_1"><title>5.1. 滞留气体</title><p>空气受到冲击，会滞留在浅水地区，高度紊乱的流体会把空气吸入水中，导致空气很有可能滞留在水中，形成气泡或泡沫粒子。</p><p>用控制函数来表示一个流体颗粒产生扩散粒子的概率：</p><disp-formula id="hanspub.18663-formula40"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x37_hanspub.png"  xlink:type="simple"/></disp-formula><p>流体粒子的相对运动，可以用式子<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x38_hanspub.png" xlink:type="simple"/></inline-formula>表示，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x39_hanspub.png" xlink:type="simple"/></inline-formula>表示两个粒子单位相对速度，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x40_hanspub.png" xlink:type="simple"/></inline-formula>表示单位距离向量。滞留空气的概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x41_hanspub.png" xlink:type="simple"/></inline-formula>，其中速度差分式子：</p><disp-formula id="hanspub.18663-formula41"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x42_hanspub.png"  xlink:type="simple"/></disp-formula><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x43_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x44_hanspub.png" xlink:type="simple"/></inline-formula>表示速度差分的最小最大值，由用户输入。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x45_hanspub.png" xlink:type="simple"/></inline-formula>是对称权函数，定义为：</p><disp-formula id="hanspub.18663-formula42"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x46_hanspub.png"  xlink:type="simple"/></disp-formula><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x47_hanspub.png" xlink:type="simple"/></inline-formula>是粒子搜索的邻居半径。</p></sec><sec id="s7_2"><title>5.2. 波峰</title><p>波峰不稳定，容易产生扩散粒子。在波峰处，表面曲率比较高，局部表面呈凸形。表面曲率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x48_hanspub.png" xlink:type="simple"/></inline-formula>近似为</p><disp-formula id="hanspub.18663-formula43"><label>(13)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x49_hanspub.png"  xlink:type="simple"/></disp-formula><p><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x50_hanspub.png" xlink:type="simple"/></inline-formula>是单位表面法向。为区分凸凹区域，考虑<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x51_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x52_hanspub.png" xlink:type="simple"/></inline-formula>的向量积(如图1)。</p><p>所以波峰可以表示：</p><disp-formula id="hanspub.18663-formula44"><label>(14)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x53_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，</p><disp-formula id="hanspub.18663-formula45"><label>(15)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x54_hanspub.png"  xlink:type="simple"/></disp-formula><p>文 [<xref ref-type="bibr" rid="hanspub.18663-ref17">17</xref>] 提出额外的条件对凸面进一步修正，</p><disp-formula id="hanspub.18663-formula46"><label>(16)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x55_hanspub.png"  xlink:type="simple"/></disp-formula><p>在波峰处，一个流体颗粒产生扩散粒子概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x56_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x57_hanspub.png" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x58_hanspub.png" xlink:type="simple"/></inline-formula>由用户输入。</p></sec><sec id="s7_3"><title>5.3. 能量</title><p>雾沫和液滴的计算需要精确知道表面张力的改变，这对于模型是一大挑战。本文未考虑表面张力的改变，文献 [<xref ref-type="bibr" rid="hanspub.18663-ref18">18</xref>] 和 [<xref ref-type="bibr" rid="hanspub.18663-ref19">19</xref>] 把表面张力设为常量。仅把内能<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x59_hanspub.png" xlink:type="simple"/></inline-formula>作为产生雾沫、液滴的衡量标准。所以内能产生扩散粒子的概率为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x60_hanspub.png" xlink:type="simple"/></inline-formula>。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x61_hanspub.png" xlink:type="simple"/></inline-formula>表示内能的最小最大值，由用户输入。</p><p>所以，一个流体粒子产生扩散粒子数为：</p><disp-formula id="hanspub.18663-formula47"><label>(17)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-1260191x62_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x63_hanspub.png" xlink:type="simple"/></inline-formula>表示每秒取样的波峰数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x64_hanspub.png" xlink:type="simple"/></inline-formula>每秒取样的滞留空气数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x65_hanspub.png" xlink:type="simple"/></inline-formula>为时间步长。</p></sec><sec id="s7_4"><title>5.4. 扩散粒子的产生</title><p>图2.一个流体粒子产生许多扩散粒子，现在流体粒子位置是</p></sec><sec id="s7_5"><title>5.5. 扩散粒子分类</title><p>根据产生出的扩散粒子位置，计算其周围邻居流体粒子的数量，把扩散粒子进行分类。扩散粒子的邻居流体粒子数小于4，记为喷雾粒子；粒子数大于12，记为气泡粒子；其它为泡沫粒子。</p><p>图1. 粒子法向与粒子相对邻居粒子距离向量点积，为正则是凹面，为负是凸面</p><p>图2. 一个流体粒子产生许多扩散粒子，现在流体粒子位置是x<sub>f</sub>(t)</p><p>喷雾粒子仅受到重力和外力的作用，使用欧拉方法更新速度和位置，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x76_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x77_hanspub.png" xlink:type="simple"/></inline-formula>。但是，泡沫和气泡粒子很大程度受到周围流体粒子的影响，泡沫位置的速度是通过局部流体粒子速度平均值体现的。所以扩散粒子的位置更新为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x78_hanspub.png" xlink:type="simple"/></inline-formula>，速度不更新。其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x79_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x80_hanspub.png" xlink:type="simple"/></inline-formula>表示流体粒子，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x81_hanspub.png" xlink:type="simple"/></inline-formula>表示扩散粒子。由于水和空气的密度差较大，气泡的运动还受到浮力的作用，所以气泡速度更新为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x82_hanspub.png" xlink:type="simple"/></inline-formula>，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x83_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x84_hanspub.png" xlink:type="simple"/></inline-formula>控制着浮力和重力的影响，由用户输入。位置更新为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-1260191x85_hanspub.png" xlink:type="simple"/></inline-formula>。</p></sec></sec><sec id="s8"><title>6. 数值算例</title><p>本文以溃坝现象为例，说明此模型模拟流体细节的视觉效果，各参数见文献 [<xref ref-type="bibr" rid="hanspub.18663-ref20">20</xref>] 。</p><sec id="s8_1"><title>6.1. 水柱倒塌模拟</title><p>图3给出了SPH方法得到的波前位置，并与文献 [<xref ref-type="bibr" rid="hanspub.18663-ref21">21</xref>] [<xref ref-type="bibr" rid="hanspub.18663-ref22">22</xref>] 得到的实验测量值进行比较。本文使用的时间步长是固定，容易计算。自适应步长运算比较繁琐，见 [<xref ref-type="bibr" rid="hanspub.18663-ref23">23</xref>] 。可以看出，使用此种边界条件得到的波前位置更接近实验值。因此本文所采用的边界处理方法能够准确和稳定地模拟整个水柱倒塌过程。</p><p>图4给出了不同时刻的流场，并与实验 [<xref ref-type="bibr" rid="hanspub.18663-ref20">20</xref>] 得到的实验现象(详见 [<xref ref-type="bibr" rid="hanspub.18663-ref20">20</xref>] )进行比较，可以看出得到的流场和文献 [<xref ref-type="bibr" rid="hanspub.18663-ref20">20</xref>] 结果一致。把图4(d)放大，可以从图4(g)中看出，增加流体粒子的扩散处理，使水柱倒塌的视觉效果更加逼真。</p></sec><sec id="s8_2"><title>6.2. 有挡板的水柱倒塌模拟</title><p>为了研究SPH方法在实际问题中的应用，图5给出了有挡板的水柱倒塌过程。</p><p>与无挡板模型相比，此模型在水平中点上方，放置了一个挡板。当水柱流过挡板，挡板下方的水流类似实际问题中的泄洪过程；而在挡板上方，当水柱冲击挡板，类似实际问题中的流体碰撞固体，产生飞溅等现象。喷雾和泡沫粒子一般产生在流体表面，气泡粒子产生在流体粒子和墙壁相撞的角落处。数值结果表明，此模型在有挡板的水柱倒塌场景下，比无挡板的水柱倒塌产生的飞溅现象更明显，视觉效果更逼真。</p></sec></sec><sec id="s9"><title>7. 结论</title><p>本文通过使用了流体粒子扩散新模型，增加了流体粒子扩散的后处理过程，模拟了无挡板和有挡板</p><p>图3. 不同时刻对应的波前位置</p><p>图4. 水柱坍塌模拟</p><p>图5. 有挡板的水柱倒塌流场</p><p>的溃坝问题。数值结果表明，此固壁边界能稳定准确的模拟溃坝问题，此模型能使溃坝的视觉效果更加逼真。新产生的喷雾、泡沫、气泡扩散粒子很大程度提高了流体在实际流动过程中的视觉效果，使流体动画更加逼真。</p></sec><sec id="s10"><title>文章引用</title><p>王宇轩,王春武,王永健. 基于SPH方法的流体细节模拟 SPH-Based Fluid Simulation for Details[J]. 现代物理, 2016, 06(05): 167-176. http://dx.doi.org/10.12677/MP.2016.65016</p></sec><sec id="s11"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.18663-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Jiang, T., Ouyang, J., Zhang, L. and Ren, J.-L. (2012) The SPH Approach to the Process of Container Filling Based on Non-Linear Constitutive Models. Acta Mechanica Sinica, 28, 407-418. http://dx.doi.org/10.1007/s10409-012-0041-7</mixed-citation></ref><ref id="hanspub.18663-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Ihmsen, M., Akinci, N., Akinci, G. and Teschner, M. (2012) Unified Spray, Foam and Air Bubbles for Particle-Based Fluids. The Visual Computer, 28, 669-677. http://dx.doi.org/10.1007/s00371-012-0697-9</mixed-citation></ref><ref id="hanspub.18663-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Monaghan, J.J. (1992) Smoothed Particle Hydrodynamics. Annual Review of Astronomy and Astrophysics, 30, 543-574. http://dx.doi.org/10.1146/annurev.aa.30.090192.002551</mixed-citation></ref><ref id="hanspub.18663-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Münzel, S.A. (1996) Smoothed Particle Hydrodynamics und ihreAnwendung auf Akkretionsscheiben. PhD Thesis, Eberhard-Karls Universität, Thübingen.</mixed-citation></ref><ref id="hanspub.18663-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Chentanez, N., Müller, M. (2010) Real-Time Simulation of Large Bodies of Water with Small Scale Details. Proceedings of the 2010 ACM SIGGRAPH/Eurographics Symposium on Computer Animation, Madrid, 2-4 July 2010, 197- 206.</mixed-citation></ref><ref id="hanspub.18663-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Chentanez, N. and Müller, M. (2011) Real-Time Eulerian Water Simulation Using a Restricted Tall Cell Grid. ACM Transactions on Graphics, 30, 82:1-82:10. http://dx.doi.org/10.1145/2010324.1964977</mixed-citation></ref><ref id="hanspub.18663-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Thürey, N., Müller-Fischer, M., Schirm, S. and Gross, M. (2007) Real-Time Breaking Waves for Shallow Water Simulations. Proceedings of the 15th Pacific Conference on Computer Graphics and Applications, Maui, 29 October-2 November 2007, 39-46. http://dx.doi.org/10.1109/PG.2007.33</mixed-citation></ref><ref id="hanspub.18663-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Bredow, R., Schaub, D., Kramer, D., Hausman, M., Dimian, D. and Duguid, R.S. (2007) Surf’s up: The Making of an Animated Documentary. Proceedings of SIGGRAPH 2007 Courses, San Diego, 5-9 August 2007, 1-123.  
http://dx.doi.org/10.1145/1281500.1281600</mixed-citation></ref><ref id="hanspub.18663-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Fangmeier, S., Anderson, J., Zargarpour, H., Smythe, D. and Alexander, T. (2000) Industrial Light + Magic: The Making of the Perfect Storm. SIGGRAPH Panel.</mixed-citation></ref><ref id="hanspub.18663-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Geiger, W., Leo, M., Rasmussen, N., Losasso, F. and Fedkiw, R. (2006) So Real It’ll Make You Wet. SIGGRAPH 2006 Sketches, Article No. 20</mixed-citation></ref><ref id="hanspub.18663-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Next Limit Technologies (2011) Realflow 2012, Hybrido. White Paper.</mixed-citation></ref><ref id="hanspub.18663-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Monaghan, J.J. (1989) On the Problem of Penetration in Particle Methods. Journal of Computational Physics, 82, 1-15.  
http://dx.doi.org/10.1016/0021-9991(89)90032-6</mixed-citation></ref><ref id="hanspub.18663-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Liu, G.R. and Liu, M.B. (2005) 光滑粒子流体动力学——一种无网格粒子法[M]. 韩旭, 杨刚, 强洪夫, 译. 长沙:湖南大学出版社, 1-433.</mixed-citation></ref><ref id="hanspub.18663-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Liu, M.b., Shao, J.R. and Chang, J.Z. (2012) On the Treatment of Solid Boundary in Smoothed Particle Hydrodynamics. Science China Technological Sciences, 55, 244-254. http://dx.doi.org/10.1007/s11431-011-4663-y</mixed-citation></ref><ref id="hanspub.18663-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Morris, J.P., Fox, P.J. and Zhu, Y. (1997) Modeling Low Reynolds Number Incompressible Flows Using SPH. Journal of Computational Physics, 136, 214-226. http://dx.doi.org/10.1006/jcph.1997.5776</mixed-citation></ref><ref id="hanspub.18663-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Yang, X.F., Peng, S.L. and Liu, M.B. (2014) A New Kernel Function for SPH with Applications to Free Surface Flows. Applied Mathematical Modelling, 38, 3822-3833. http://dx.doi.org/10.1016/j.apm.2013.12.001</mixed-citation></ref><ref id="hanspub.18663-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Ihmsen, M., Akinci, N., Akinci, G. and Teschner, M. (2012) Unified Spray, Foam and Air Bubbles for Particle-Based Fluids. Visual Computer, 28, 669-677. http://dx.doi.org/10.1007/s00371-012-0697-9</mixed-citation></ref><ref id="hanspub.18663-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Bagar, F., Scherzer, D. and Wimmer, M. (2010) A Layered Particle-Based Fluid Model for Real-Time Rendering of Water. Computer Graphics Forum, 29, 1383-1389. http://dx.doi.org/10.1111/j.1467-8659.2010.01734.x</mixed-citation></ref><ref id="hanspub.18663-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Mihalef, V., Metaxas, D.N. and Sussman, M. (2009) Simulationof Twophase Flow with Sub-Scale Droplet and Bubble Effects. Computer Graphics Forum, 28, 229-238. http://dx.doi.org/10.1111/j.1467-8659.2009.01362.x</mixed-citation></ref><ref id="hanspub.18663-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Ataie-Ashitiani, B. and Farhadi, L. (2006) A Stable Moving-Particle Semi-Implicit Method for Free Surface Flows. Fluid Dynamics Research, 38, 241-256. http://dx.doi.org/10.1016/j.fluiddyn.2005.12.002</mixed-citation></ref><ref id="hanspub.18663-ref21"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Koshizuka, S., Nobe, A. and Oka, Y. (1998) Numerical Analysis of Breaking Waves Using the Moving Particle Semi-Implicit Method. International Journal for Numerical Methods in Fluids, 26, 751-769.  
http://dx.doi.org/10.1002/(SICI)1097-0363(19980415)26:7&lt;751::AID-FLD671&gt;3.0.CO;2-C</mixed-citation></ref><ref id="hanspub.18663-ref22"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">Martin, J.C. and Moyce, W.J. (1952) An Experimental Study of the Collapse of Liquid Columns on a Rigid Horizontal Plane. Philosophical Transactions of the Royal Society A, 244, 312-324. http://dx.doi.org/10.1098/rsta.1952.0006</mixed-citation></ref><ref id="hanspub.18663-ref23"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Violeau, D. and Leroy, A. (2015) Optimal Time Step For incompressible SPH. Journal of Computational Physics, 288, 119-130. http://dx.doi.org/10.1016/j.jcp.2015.02.015</mixed-citation></ref></ref-list></back></article>