<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">CSA</journal-id><journal-title-group><journal-title>Computer Science and Application</journal-title></journal-title-group><issn pub-type="epub">2161-8801</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/CSA.2018.86094</article-id><article-id pub-id-type="publisher-id">CSA-25444</article-id><article-categories><subj-group subj-group-type="heading"><subject>CSA20180600000_71354510.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于CC3200 LaunchPad的低功耗智能蓝牙锁设计与实现
  Design and Implementation of Low-Power Smart Bluetooth Lock Based on CC3200 LaunchPad
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>乐</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>何</surname><given-names>富贵</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>皖西学院，安徽 六安</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>14</day><month>06</month><year>2018</year></pub-date><volume>08</volume><issue>06</issue><fpage>851</fpage><lpage>859</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   伴随“互联网+”信息化时代和最新BLE蓝牙4.0技术的来临，人们对于锁具的性能要求越来越高，需求越来越广泛，传统的锁具无法满足现代人们生活需求，因此，智能锁具顺势而生，逐渐地改变传统锁具的应用，而本文主要研究智能锁具的经典案例：智能蓝牙锁。本文提出一种基于CC3200 LaunchPad的低功耗智能蓝牙锁，以普通自行车为设计载体，通过自主改装步进电机形成车锁原型，不仅可以区别于OFO和Mobike的智能蓝牙马蹄锁，实现全自动智能解锁与上锁，而且降低了智能蓝牙锁在共享单车应用领域的功耗。另外，本设计采用T型锁设计理念，应用范围广泛且实用。 With the advent of the “Internet+” information era and the latest BLE Bluetooth 4.0 technology, people have higher and higher requirements for the performance of locks; the demand is more and more extensive. The traditional locks cannot satisfy the needs of people in modern times. Therefore, smart locks follow the trend and gradually change the application of traditional locks; this article focuses on the classic case of smart locks: smart bluetooth locks. The article proposes a low-power smart bluetooth lock based on CC3200 LaunchPad. It uses an ordinary bicycle as a design carrier to form an archetype of a bicycle lock by self-reconfiguring a stepping motor. It not only can be distinguished from OFO and Mobike’s smart bluetooth horseshoe lock to realize automatic intelligent un-locking and locking, but also reduces power consumption of smart bluetooth locks in shared bicycle applications. In addition, this design adopts the T-lock design concept and has a wide range of applications and the design is practical.
    
  
 
</p></abstract><kwd-group><kwd>CC3200 LaunchPad，智能蓝牙锁，4G移动通信，移动终端定位技术，BLE技术, CC3200 LaunchPad</kwd><kwd> Smart Bluetoothlock</kwd><kwd> 4G Mobile Communication</kwd><kwd> Mobile Terminal Location Technology</kwd><kwd> BLE Technology</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于CC3200 LaunchPad的低功耗智能蓝牙锁设计与实现<sup> </sup></title><p>张乐，何富贵</p><p>皖西学院，安徽 六安</p><p><img src="//html.hanspub.org/file/2-1541048x1_hanspub.png" /></p><p>收稿日期：2018年5月23日；录用日期：2018年6月8日；发布日期：2018年6月15日</p><disp-formula id="hanspub.25444-formula21"><graphic xlink:href="//html.hanspub.org/file/2-1541048x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>伴随“互联网+”信息化时代和最新BLE蓝牙4.0技术的来临，人们对于锁具的性能要求越来越高，需求越来越广泛，传统的锁具无法满足现代人们生活需求，因此，智能锁具顺势而生，逐渐地改变传统锁具的应用，而本文主要研究智能锁具的经典案例：智能蓝牙锁。本文提出一种基于CC3200 LaunchPad的低功耗智能蓝牙锁，以普通自行车为设计载体，通过自主改装步进电机形成车锁原型，不仅可以区别于OFO和Mobike的智能蓝牙马蹄锁，实现全自动智能解锁与上锁，而且降低了智能蓝牙锁在共享单车应用领域的功耗。另外，本设计采用T型锁设计理念，应用范围广泛且实用。</p><p>关键词 :CC3200 LaunchPad，智能蓝牙锁，4G移动通信，移动终端定位技术，BLE技术</p><disp-formula id="hanspub.25444-formula22"><graphic xlink:href="//html.hanspub.org/file/2-1541048x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/2-1541048x7_hanspub.png" /> <img src="//html.hanspub.org/file/2-1541048x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>众所周知，随着科技的进步与社会的发展，智能锁的应用可谓随处可见。目前，智能锁主要应用于车锁、门锁、保险箱等地方，而且智能锁的种类丰富，主要有密码锁，指纹锁，IC卡锁，电子锁，无线遥控锁，声控锁等 [<xref ref-type="bibr" rid="hanspub.25444-ref1">1</xref>] 。锁的发展过程大致可以分为木制锁，机械锁，智能锁三个过程，木制锁结构简单、体积庞大，机械锁机械结构和操作流程复杂，而智能锁的出现很好地解决了锁的传统问题，极大地推进了锁的应用。智能锁目前主要采用蓝牙技术实现智能锁的实时控制，其中最具代表性的是OFO和Mobike的智能蓝牙马蹄锁，能够通过移动终端实时解锁，但是不能实时上锁并且功耗较高。通过统计分析，大学校园里大量自行车处于闲置或者丢弃状态，不仅占用大量的公共区域而且造成大量资源的浪费，针对以上问题我们决定设计一种基于CC3200 LaunchPad的低功耗智能蓝牙锁解决上述问题，以实现校园闲置资源的最大化利用。</p></sec><sec id="s4"><title>2. 系统设计</title><p>基于CC3200 LaunchPad的低功耗智能蓝牙锁设计主要包括后台终端、智能手机(用户)，以及设置在自行车上的控制模块、无线通信模块、低功耗蓝牙电子锁、二维码，其中二维码包含所在自行车的编码信息，低功耗蓝牙电子锁、无线通信模块分别接入控制模块，由控制模块控制低功耗蓝牙电子锁的锁闭和打开，后台终端通过无线方式分别与控制模块、智能手机通讯连接，智能手机还通过无线方式与控制模块通讯连接 [<xref ref-type="bibr" rid="hanspub.25444-ref2">2</xref>] 。每辆自行车都配有低功耗蓝牙电子锁，并且我们将二维码黏贴在自行车的把横部分上，然后用PE保护膜将二维码全方位无死角覆盖上 [<xref ref-type="bibr" rid="hanspub.25444-ref3">3</xref>] 。通过4G移动通信技术使我们的微信平台与后台终端(云端服务器)进行数据交流，实时地记录租车系统中自行车的位置及其使用情况等,详细的系统组成见图1。</p><sec id="s4_1"><title>2.1. 系统硬件组成</title><p>该系统的硬件模块优选同类型TI公司的硬件，其中控制模块采用TI公司的CC3200 LaunchPad开发</p><p>板，它是业界第一个内置Wi-Fi功能的单芯片处理器，该芯片上集成有ARM Cortex-M4处理器内核，可配合多种外设，快速并行摄像头接口，I2S，SD/MMC，UART，SPI，IIC和四通道模数转换器(ADC) [<xref ref-type="bibr" rid="hanspub.25444-ref4">4</xref>] 。BLE透传模块采用TI公司的超低功耗蓝牙芯片CC2541F256RHAR，该款芯片针对低能耗以及私有2.4 GHz应用的功率优化的真正片载系统(SoC)解决方案，非常适合应用于需要超低能耗的系统 [<xref ref-type="bibr" rid="hanspub.25444-ref5">5</xref>] 。步进电机模块采用TI公司的驱动芯片DRV8833，可通过电位器或者定时器的方式调速，一方面为机电一体化应用提供了一款双桥电机驱动器解决方案，另一方面还提供了一种低功耗休眠模式。电源模块采用TI公司的BUCK BOOST LM5175，LM5175四开关同步降压–升压控制器能够对等于、高于或低于输入电压的输出电压进行调节，用两节AA碱性电池给电源模块供电，然后电源模块通过USB接口给CC3200 LaunchPad开发板供电。系统硬件主要模块的选用如表1所示，系统的硬件原理图和硬件模块分别如图2、图3所示。</p></sec><sec id="s4_2"><title>2.2. 系统软件组成</title><p>该系统的软件开发采用微信公众号平台，微信公众平台是运营者通过公众号为微信用户提供资讯和服务的平台，而公众平台开发接口则是提供服务的基础，开发者在公众平台网站中创建公众号、获取接口权限后，可以通过阅读本接口文档来帮助开发。二次开发微信公众号的优势对于用户来说，如今到哪里都可以通过关注公众号或扫微信二维码的方式进行资讯的获取或者购物，既方便而省事。然而本系统的软件开发基于微信公众号，通过注册认证企业公众号实现微信公众号的二次开发，其中该微信公众号平台主要模块包括验证登录模块，车辆预约模块，扫码取车(还车)模块，行车计时模块和每日分享模块等。详细的系统软件主要模块选用请见表2，解锁与上锁流程如图4所示。</p><p>图1. 系统组成框图</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Hardware main module selectio</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >硬件模块</th><th align="center" valign="middle" >型号</th><th align="center" valign="middle" >功能</th><th align="center" valign="middle" >备注</th></tr></thead><tr><td align="center" valign="middle" >控制模块</td><td align="center" valign="middle" >CC3200 LaunchPad</td><td align="center" valign="middle" >支持多种低功耗模式</td><td align="center" valign="middle" >2节干电池供电，工作时间可以长达1年以上</td></tr><tr><td align="center" valign="middle" >BLE透传模块</td><td align="center" valign="middle" >CC2541F256RHAR</td><td align="center" valign="middle" >超功耗低，应用简单</td><td align="center" valign="middle" >移动终端通过BLE透传模块与控制模块通信</td></tr><tr><td align="center" valign="middle" >步进电机模块</td><td align="center" valign="middle" >DRV8833</td><td align="center" valign="middle" >通过设定步距角实现正、反转</td><td align="center" valign="middle" >步进电机自主改装形成车锁原型</td></tr><tr><td align="center" valign="middle" >电源模块</td><td align="center" valign="middle" >BUCK BOOST LM5175</td><td align="center" valign="middle" >具有3.5 V至42 V的宽输入电压范围</td><td align="center" valign="middle" >LM5175在降压和升压工作模式下 均采用电流模式控制</td></tr></tbody></table></table-wrap><p>表1. 硬件主要模块选用</p><p>图2. 系统组成框图</p><p>图3. 硬件模块组合图</p><p>图4. 系统解锁与上锁流程图</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Software main module selectio</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >软件模块</th><th align="center" valign="middle" >功能</th><th align="center" valign="middle" >备注</th></tr></thead><tr><td align="center" valign="middle" >验证登录模块</td><td align="center" valign="middle" >手机短信验证注册及登录，需要用户提供身份信息， 用于用户信息绑定等</td><td align="center" valign="middle" >绑定为了方便管理用户和微信公众号平台运行</td></tr><tr><td align="center" valign="middle" >车辆预约模块</td><td align="center" valign="middle" >可以查询到每个停车点剩余的自行车数量以及告知用 户停车点的位置和推荐用户去哪个停车点进行取车等</td><td align="center" valign="middle" >用户可以提前预约，但20分钟之内 若没有进行取车，将自动取消用户的预约</td></tr><tr><td align="center" valign="middle" >扫码取车(还车)模块</td><td align="center" valign="middle" >使用公众号中的扫码取车(还车)功能扫描自行 车把横上的二维码，可以实现解锁与上锁等</td><td align="center" valign="middle" >移动终端与控制模块通信，将自行车与该用户 信息绑定并向云端服务器发送取车(还车)情况</td></tr><tr><td align="center" valign="middle" >行车计时模块</td><td align="center" valign="middle" >实时看到本次行车时间和租借时间， 还可以查询到借车的历史记录等</td><td align="center" valign="middle" >用于微信公众号平台产生消费 费用的结算与记录</td></tr><tr><td align="center" valign="middle" >每日分享模块</td><td align="center" valign="middle" >向用户推荐一些周边适合骑行的地方， 普及一些健康知识，安全知识等</td><td align="center" valign="middle" >此功能属于微信公众号附加功能， 用以增加平台人性化设计</td></tr></tbody></table></table-wrap><p>表2. 软件主要模块选用</p></sec><sec id="s4_3"><title>2.3. 现有技术对比</title><p>OFO的马蹄锁在短短的两年时间内完成了从机械锁到第一代智能锁和第二代智能锁的快速超越。第一代智能锁“海王星”是扫码后会获得4位数字，然后手动按键输入数字解锁，第二代智能锁“天王星”支持机械解锁，也支持通过蓝牙扫码解锁，采用了北斗和GPS双模定位技术。目前，OFO与中国电信和华为发布了基于NB-IoT技术的OFO智能单车正式投入市场，进行商用，这是唯一覆盖全国的物联网络，可以避免出现信号覆盖不到而无法开锁的情况 [<xref ref-type="bibr" rid="hanspub.25444-ref6">6</xref>] 。</p><p>Mobike的马蹄锁从开始就采用了智能锁的技术。最初用的短信通讯开锁方式，优点是网络信号兼容性好，低功耗，不足的地方是开锁慢、成本高，数据难以收集。Mobike第二代智能锁采用了GPRS信号开锁，但部分地方网络覆盖不到位，比如存在没有2G信号等尴尬情况，网络兼容性也偏差。为了解决这些问题，摩拜第三代智能锁引入了GPRS + 蓝牙的开锁模式，首先是手机与服务器连接，产生数据通信，然后让手机通过蓝牙跟智能锁连接。好处是解决了信号覆盖的问题，不足点是需要用户打开手机蓝牙连接单车，另外，单车和云端无法实现直接数据通信。</p></sec></sec><sec id="s5"><title>3. 实验应用</title><p>首先用户通过微信公众号扫描自行车把横上的二维码了解该自行车(是否被预约、使用时间段、当前位置等)状态信息，然后用户手机通过BLE模块与CC3200 LaunchPad建立连接，在接收到解锁命令之后 CC3200 LaunchPad控制步进电机反转实现自行车的解锁；接收到上锁命令时则步进电机正转实现自行车的上锁。当用户使用手机扫描自行车把横上的二维码获取自行车信息时，微信公众号将通过手机的GPS功能获取当前位置并与自行车绑定，便于后台能够动态的掌握自行车的停放位置。</p><sec id="s5_1"><title>3.1. 数据分析</title><p>针对引言以及现有城市公共自行车系统的问题，我们做了关于大学生日常出行交通工具选择的问卷调查，具体的调查结果请见图5和图6。</p></sec><sec id="s5_2"><title>3.2. 基于低功耗智能蓝牙锁的共享自行车平台</title><p>设计原型以普通自行车为载体，在自行车后轮的左、右两侧支架分别焊接有部分装置用于实现自行车的上锁与解锁；左侧焊接的是带有锁孔的锁座，右侧焊接的是支撑架，用来安装步进电机。同时步进电机经过自主改进，在步进电机的主轴上套装有固定块，固定块上设有横向通孔并套装有锁杆，并且固定块与用于安装步进电机的支架之间有一定的间隙，防止存在摩擦，有利于步进电机带动锁杆前进与后</p><p>图5. 大学生出行工具扇形图</p><p>图6. 问卷调查地域分布图</p><p>退；自行车在其后轮左侧的支架上固定焊接有锁座，锁座上设有与锁杆相配合的锁孔，从而构成了普通自行车车锁的原型 [<xref ref-type="bibr" rid="hanspub.25444-ref7">7</xref>] 。图7~图9为系统共享自行车平台应用界面。</p></sec><sec id="s5_3"><title>3.3. 性能分析</title><p>该设计主要从低功耗和全自动控制方面区别于OFO和Mobike的智能蓝牙马蹄锁，其中低功耗方面主要从单位时间内解锁与上锁次数，待车状态和骑行状态的功耗大小与现有智能蓝牙马蹄锁对比，对比结果如表3所示。</p><p>另一方面，该系统的智能蓝牙锁设计采用T型锁设计模式区别于市面上U型锁设计模式，能够实现近距离低功耗全自动解锁与上锁。在系统硬件搭建成功的基础上，不断优化硬件的稳定性，多次重复的进行稳定性测试，能够实现移动终端(用户)稳定的连接硬件系统中的低功耗蓝牙；并且可以在微信公众号里面的扫码取车(还车)模块进行多次重复进行自行车的解锁与上锁，进而实现整个自行车管理系统的稳定性测试，最终可以进行具体实物模型的展示，完成该低功耗智能蓝牙锁设计的原型。实物模型展示如图10所示。</p></sec></sec><sec id="s6"><title>4. 结论</title><p>该设计绿色环保并且利用简单的物联网技术和互联网技术，产品的开发容易实现，有广大的目标群体和广阔的市场前景。将校园里闲置的自行车集中到一个管理平台上，可为用户提供基本的交通工具，</p><p>图7. 系统主界面图</p><p>图8. 扫码取车界面图</p><p>图9. 扫码还车界面图</p><p>图10. 实物模型展示图</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Power performance compariso</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ></th><th align="center" valign="middle" >My Way</th><th align="center" valign="middle" >OFO</th><th align="center" valign="middle" >Mobike</th></tr></thead><tr><td align="center" valign="middle" >解锁与上锁次数</td><td align="center" valign="middle" >80次/小时</td><td align="center" valign="middle" >70次/小时</td><td align="center" valign="middle" >75次/小时</td></tr><tr><td align="center" valign="middle" >待车状态</td><td align="center" valign="middle" >0.20 UA</td><td align="center" valign="middle" >0.30 UA</td><td align="center" valign="middle" >0.25 UA</td></tr><tr><td align="center" valign="middle" >骑行状态</td><td align="center" valign="middle" >1.00 UA</td><td align="center" valign="middle" >1.20 UA</td><td align="center" valign="middle" >1.10 UA</td></tr></tbody></table></table-wrap><p>表3. 功耗性能对比</p><p>提供优质便捷的服务，节能环保，能够合理利用资源，操作简单，成本低廉。通过本管理系统的运行，能够系统地解决高校自行车所出现的许多问题；通过微信公众号进行自行车租赁，实现自行车的智能化操作，非常符合现在年轻大学生的生活方式。</p></sec><sec id="s7"><title>基金项目</title><p>2017年国家级大学生创新创业训练计划项目(项目编号：201710376026)。</p></sec><sec id="s8"><title>文章引用</title><p>张 乐,何富贵. 基于CC3200 LaunchPad的低功耗智能蓝牙锁设计与实现 Design and Implementation of Low-Power Smart Bluetooth Lock Based on CC3200 LaunchPad[J]. 计算机科学与应用, 2018, 08(06): 851-859. https://doi.org/10.12677/CSA.2018.86094</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.25444-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">姜斌, 赵祎乾. 基于物联网基础的校园自行车服务系统研究[D]: [硕士或博士学位论文]. 南京: 南京理工大学, 2016.</mixed-citation></ref><ref id="hanspub.25444-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">张乐, 何富贵, 李爽, 王淼, 王鑫. 基于物联网的智慧校园自行车管理系统[P]. 中国实用新型专利, 201621225822.0, 2016.</mixed-citation></ref><ref id="hanspub.25444-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">庞明. 物联网条码技术与射频识别技术[M]. 北京: 中国物资出版社, 2011.</mixed-citation></ref><ref id="hanspub.25444-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Cui, P.F., et al. (2010) An Embedded Control and Monitor System for SAR Using SOPC Technology. IEEE 2010 2nd International Asia Conference on Informatics in Control, Automation and Robotics (CAR), Vol. 1, Wuhan, 6-7 March 2010.</mixed-citation></ref><ref id="hanspub.25444-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">魏权利, 李丽萍, 林粤伟. 嵌入式系统原理与应用[M]. 北京: 机械工业出版社, 2014.</mixed-citation></ref><ref id="hanspub.25444-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Du, Y.J., et al. (2015) SAMU: Design and Implementation of Selectivity-Aware MU-MIMO for Wideband WiFi. IEEE 2015 12th Annual IEEE International Conference on Sensing, Communication, and Networking (SECON), Seat-tle, WA, 22-25 June 2015.</mixed-citation></ref><ref id="hanspub.25444-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">张乐, 何富贵, 李爽, 王鑫, 沈绍文. 基于物联网的智能安防自行车锁[P]. 中国发明专利, 201611003721.3, 2016.</mixed-citation></ref></ref-list></back></article>