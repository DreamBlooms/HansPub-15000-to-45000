<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SG</journal-id><journal-title-group><journal-title>Smart Grid</journal-title></journal-title-group><issn pub-type="epub">2161-8763</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SG.2016.66044</article-id><article-id pub-id-type="publisher-id">SG-19186</article-id><article-categories><subj-group subj-group-type="heading"><subject>SG20160600000_48048489.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  一种具有电气隔离的数据采集与处理系统
  A Data Sampling and Processing System with the Ability of Electrical Insulation
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>原</surname><given-names>晓楠</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>何</surname><given-names>文林</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>乐</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>李</surname><given-names>昊罡</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>西安交通大学，陕西 西安</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>1074887579@qq.com(原晓)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>15</day><month>11</month><year>2016</year></pub-date><volume>06</volume><issue>06</issue><fpage>405</fpage><lpage>411</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   由于高压侧设备的数据采集对高压绝缘和抗电磁干扰性能有很高的要求，本文设计了一种具有电气隔离的数据采集处理系统。在高压侧对采集的信号进行I/F转换，通过光纤通信传输至低压侧进行F/D转换实现高压侧信号的数据采集，最后将数据传输给DSP完成后续处理。实验结果表明高压数据采集系统线性度好，达到0.2%精确度，具有抗强电磁干扰和高压绝缘隔离能力。 The data-sampling system of the equipments on the side of high-voltage has high requirements on high-voltage insulation performance and anti-electromagnetic interference ability. This paper designed a data-sampling and processing system with good performance of electrical insulation. After the I/F conversion of the collected signal on the side of high-voltage, the transformed signal will be transmitted to the side of low-voltage by the optical fiber communication system and then it will finish the data-sampling of the signal on the side of high-voltage after the F/D conversion of the received signal. Finally, the signal will be transmitted to DSP to make a subsequent processing. The test results show that the data-sampling system of the equipments on the side of high-voltage has a good linearity. It can attain the accuracy of 0.2%. Also it has superior anti-electromagnetic interference ability and high-voltage insulation ability.
    
  
 
</p></abstract><kwd-group><kwd>数据采集，高压绝缘，抗电磁干扰，线性度，精确度, Data-Sampling</kwd><kwd> High-Voltage Insulation</kwd><kwd> Anti-Electromagnetic Interference</kwd><kwd> Linearity</kwd><kwd> Accuracy</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>一种具有电气隔离的数据采集与处理系统<sup> </sup></title><p>原晓楠，何文林，张乐，李昊罡</p><p>西安交通大学，陕西 西安</p><disp-formula id="hanspub.19186-formula7"><graphic xlink:href="http://html.hanspub.org/file/6-1580344x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年11月24日；录用日期：2016年12月10日；发布日期：2016年12月13日</p><disp-formula id="hanspub.19186-formula8"><graphic xlink:href="http://html.hanspub.org/file/6-1580344x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>由于高压侧设备的数据采集对高压绝缘和抗电磁干扰性能有很高的要求，本文设计了一种具有电气隔离的数据采集处理系统。在高压侧对采集的信号进行I/F转换，通过光纤通信传输至低压侧进行F/D转换实现高压侧信号的数据采集，最后将数据传输给DSP完成后续处理。实验结果表明高压数据采集系统线性度好，达到0.2%精确度，具有抗强电磁干扰和高压绝缘隔离能力。</p><p>关键词 :数据采集，高压绝缘，抗电磁干扰，线性度，精确度</p><disp-formula id="hanspub.19186-formula9"><graphic xlink:href="http://html.hanspub.org/file/6-1580344x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>在智能电网中，经常需要对高压侧的一些电气设备输出的数据信号进行采集与处理，但是由于强电磁场等因素的存在，对高压侧数据信号的采集和处理比较困难 [<xref ref-type="bibr" rid="hanspub.19186-ref1">1</xref>] 。现有的方法为直接在高压侧对检测信号进行A/D转换处理或者采用电缆将信号直接传输至低压侧再处理。但是存在的问题是处理器的软件程序和存储器数据很容易受到强电磁干扰影响，造成数据采集失效，电缆传输时电磁干扰会直接影响一帧数据的准确性 [<xref ref-type="bibr" rid="hanspub.19186-ref2">2</xref>] ，误差较大。本文设计了具有电气隔离的数据采集处理系统来解决这些问题。在高压侧设计电路对采集的信号进行I/F转换，然后通过光纤通信 [<xref ref-type="bibr" rid="hanspub.19186-ref3">3</xref>] 传输至低压侧，在低压侧设计F/D转换模块并将最终的数字信号传输给DSP进行处理 [<xref ref-type="bibr" rid="hanspub.19186-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.19186-ref5">5</xref>] 。避免了强电磁干扰的同时实现了高低压侧的电气隔离，完成了数据的准确采集与处理。</p></sec><sec id="s4"><title>2. 系统原理与构架</title><p>数据采集系统要求具有很高的高压隔离绝缘能力和抗强电磁脉冲干扰能力，如图1所示，数据采集处理系统包括两大部分：高压侧的I/F转换模块(放大调理电路、V/F转换电路、电光转换发射电路)和低压侧的F/D转换模块(光电转换接收电路、基于CPLD的软件设计电路)。</p><p>图1. 具有高压隔离的数据采集处理系统框图</p><p>高压侧采集到的电流信号通过I/F转换模块转换为频率信号，通过光纤通信将对应的信号传输至低压侧；在低压侧通过F/D转换模块将频率信号转换为数字信号；最后设计串口传输电路 [<xref ref-type="bibr" rid="hanspub.19186-ref6">6</xref>] 将数字信号传输给DSP进行后期处理。将高压侧信号转换后通过光纤通信将高压侧信号传输至低压侧，在低压侧进行数据处理，整个数据采集系统具有强抗干扰能力，实现了高、低压侧电气高压隔离。</p></sec><sec id="s5"><title>3. 数据采集处理系统的设计</title><sec id="s5_1"><title>3.1. 高压侧I/F转换模块</title><p>本模块的主要功能是设计相关电路在高压侧实现电流信号到频率信号的转换，具体可分为信号调理放大电路 [<xref ref-type="bibr" rid="hanspub.19186-ref7">7</xref>] 、V/F转换电路和电光转换发射电路三部分，整体电路原理图如图2所示。</p><p>图2. 高压侧I/F转换模块整体电路原理图</p><p>设计信号调理放大电路对接收到的信号进行处理，利用两级反相比例放大器串联对信号进行放大，并且设计深度负反馈电路和滤波电路对信号进行滤波处理，从而对信号起到抑制漂移、抗干扰、减小失真的作用，本设计中选用AD8574芯片作为放大电路的主芯片，这种零漂移放大器将低成本与高精度特性融于一体，而且无需外部电容。为了提高转换精度，应选择具有较高的满刻度频率响应、较低的最佳温度、较好的稳定性并能达到设计所需的精度要求的器件。本设计选用了AD7740芯片进行V/F转换。其转换函数关系为：</p><disp-formula id="hanspub.19186-formula10"><graphic xlink:href="http://html.hanspub.org/file/6-1580344x11_hanspub.png"  xlink:type="simple"/></disp-formula><p>AD7740芯片是一种采用了电荷平衡转换技术的CMOS 型同步电压频率转换器。它的精度高、抗干扰性更好、转换时不需与外部匹配，只需与基准相同，并且是微功耗元件，采用同步电荷平衡技术。AD7740的模拟输入信号经过一个开关电容调制器进行连续采样，其采样频率可通过设置主时钟频率来调节。AD7740具有更稳定的转换功能，可根据所选外部时钟来测定系统的稳定性和误差。本设计选择精确的外部基准来代替内部电压基准。基准电压由REF5025输出的2.5 V电压经由两倍比例放大电路产生精准的5V基准电压输入给REFIN管脚。</p><p>为了将高压侧输出的频率信号传输至低压侧，本设计选用光纤通信系统，以光纤为传输介质实现信号的远距离传输，从而避免了有线传输的局限性以及其他电气因素对传输信息的干扰。</p></sec><sec id="s5_2"><title>3.2. 低压侧F/D转换模块</title><p>本模块处于低压侧，由光纤通信系统传输至低压侧的光信号经过电光转换电路 [<xref ref-type="bibr" rid="hanspub.19186-ref8">8</xref>] 转换为频率信号作为本模块的输入信号，光电转换发送电路选用的是HFBR-1414TZ发射器，与之匹配的接收器为HFBR-2416TZ，内部由光电探测器和直流放大器组成，检测到光纤传输的光信号并将其转换为电信号经由放大器放大后输出逻辑信号。</p><p>由于被测信号为高频信号，设计中选择了等精度测频法实现F/D转换。以CPLD为核心，通过设计逻辑模块，使用Verilog语言进行编程实现F/D转换 [<xref ref-type="bibr" rid="hanspub.19186-ref9">9</xref>] ，输出结果为16位并行数据。选用UART异步串行通讯方式进行CPLD与DSP的通讯 [<xref ref-type="bibr" rid="hanspub.19186-ref10">10</xref>] ，设定数据传输的波特率为115,200 bps，整体原理图如图3所示。</p><p>图3. 低压侧F/D转换模块整体原理图</p></sec></sec><sec id="s6"><title>4. 实验结果</title><sec id="s6_1"><title>4.1. I/F转换电路实验</title><p>通过以上设计，对所焊接的I/F转换电路板进行了调试实验，由直流稳定电源给电路板供电，输入端的电流信号由电压信号与电阻串联产生，信号的大小由串接在输入端的电流表检测，输出端频率信号由TFG6920A函数任意波形发生器来测量。实验数据如表1所示，利用MATLAB对实验数据进行一次多项式拟合，曲线图如图4所示。</p><p>可求得频率与电流的关系为：</p><disp-formula id="hanspub.19186-formula11"><graphic xlink:href="http://html.hanspub.org/file/6-1580344x13_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中电流的单位为A，频率的单位为kHz。实验数据中的最大误差点为I = 1.702 A，计算可得最大相对误差为0.192%，小于0.2%，满足误差的要求。</p></sec><sec id="s6_2"><title>4.2. F/D转换模块仿真与实验验证</title><p>通过设计和编程实现了一个基于CPLD的F/D转换模块的专用集成电路，制造了一个具有上述CPLD系统的F/D转换电路板。由于I/F转换电路板中已经验证了I-F之间的线性关系，本实验中只选择了具有代表性的几个数据点进行实验，实验结果如表2所示。</p></sec><sec id="s6_3"><title>4.3. 抗干扰性能检验</title><p>通过以上设计，对所焊接的I/F转换电路板进行抗干扰性能验证。在电流信号输入端加入周期为1 s的脉冲干扰信号，观察输出的频率信号，实验结果如表3所示。由实验结果可知，系统的抗干扰性能良好。</p><p>图4. I/F特性拟合曲线及实测散点图</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Data of I/F conversion experimen</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >电流I/A</th><th align="center" valign="middle" >频率f/KHz</th><th align="center" valign="middle" >电流I/A</th><th align="center" valign="middle" >频率f/KHz</th></tr></thead><tr><td align="center" valign="middle" >−2.102</td><td align="center" valign="middle" >97.75</td><td align="center" valign="middle" >0.501</td><td align="center" valign="middle" >597.22</td></tr><tr><td align="center" valign="middle" >−2.041</td><td align="center" valign="middle" >97.75</td><td align="center" valign="middle" >0.701</td><td align="center" valign="middle" >636.49</td></tr><tr><td align="center" valign="middle" >−1.901</td><td align="center" valign="middle" >124.52</td><td align="center" valign="middle" >0.901</td><td align="center" valign="middle" >676.76</td></tr><tr><td align="center" valign="middle" >−1.702</td><td align="center" valign="middle" >164.15</td><td align="center" valign="middle" >1.101</td><td align="center" valign="middle" >716.31</td></tr><tr><td align="center" valign="middle" >−1.501</td><td align="center" valign="middle" >203.36</td><td align="center" valign="middle" >1.301</td><td align="center" valign="middle" >755.23</td></tr><tr><td align="center" valign="middle" >−1.300</td><td align="center" valign="middle" >242.81</td><td align="center" valign="middle" >1.501</td><td align="center" valign="middle" >795.11</td></tr><tr><td align="center" valign="middle" >−1.102</td><td align="center" valign="middle" >282.21</td><td align="center" valign="middle" >1.702</td><td align="center" valign="middle" >834.63</td></tr><tr><td align="center" valign="middle" >−0.900</td><td align="center" valign="middle" >321.57</td><td align="center" valign="middle" >1.902</td><td align="center" valign="middle" >873.91</td></tr><tr><td align="center" valign="middle" >−0.702</td><td align="center" valign="middle" >360.98</td><td align="center" valign="middle" >2.101</td><td align="center" valign="middle" >911.74</td></tr><tr><td align="center" valign="middle" >−0.501</td><td align="center" valign="middle" >400.22</td><td align="center" valign="middle" >2.302</td><td align="center" valign="middle" >951.61</td></tr><tr><td align="center" valign="middle" >−0.102</td><td align="center" valign="middle" >478.72</td><td align="center" valign="middle" >2.341</td><td align="center" valign="middle" >959.68</td></tr><tr><td align="center" valign="middle" >0.000</td><td align="center" valign="middle" >498.71</td><td align="center" valign="middle" >2.400</td><td align="center" valign="middle" >959.68</td></tr></tbody></table></table-wrap><p>表1. I/F转换实验数据</p><table-wrap id="table2" ><label><xref ref-type="table" rid="table2">Table 2</xref></label><caption><title> Data of F/D conversion experimen</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >被测信号/kHz</th><th align="center" valign="middle" >十六进制数</th><th align="center" valign="middle" >PC机结果</th></tr></thead><tr><td align="center" valign="middle" >100</td><td align="center" valign="middle" >0064</td><td align="center" valign="middle" >0064</td></tr><tr><td align="center" valign="middle" >300</td><td align="center" valign="middle" >012C</td><td align="center" valign="middle" >012C</td></tr><tr><td align="center" valign="middle" >500</td><td align="center" valign="middle" >01F4</td><td align="center" valign="middle" >01F4</td></tr><tr><td align="center" valign="middle" >700</td><td align="center" valign="middle" >02BC</td><td align="center" valign="middle" >02BC</td></tr><tr><td align="center" valign="middle" >900</td><td align="center" valign="middle" >0384</td><td align="center" valign="middle" >0384</td></tr><tr><td align="center" valign="middle" >1000</td><td align="center" valign="middle" >03E8</td><td align="center" valign="middle" >03E8</td></tr></tbody></table></table-wrap><p>表2. F/D转换实验数据</p><table-wrap id="table3" ><label><xref ref-type="table" rid="table3">Table 3</xref></label><caption><title> Data of anti-interference experimen</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >电流I/A</th><th align="center" valign="middle" >频率f/KHz</th><th align="center" valign="middle" >电流I/A</th><th align="center" valign="middle" >频率f/KHz</th></tr></thead><tr><td align="center" valign="middle" >−2.101</td><td align="center" valign="middle" >97.74</td><td align="center" valign="middle" >0.501</td><td align="center" valign="middle" >597.24</td></tr><tr><td align="center" valign="middle" >−1.502</td><td align="center" valign="middle" >203.41</td><td align="center" valign="middle" >1.002</td><td align="center" valign="middle" >696.53</td></tr><tr><td align="center" valign="middle" >−1.001</td><td align="center" valign="middle" >301.91</td><td align="center" valign="middle" >1.500</td><td align="center" valign="middle" >795.09</td></tr><tr><td align="center" valign="middle" >−0.503</td><td align="center" valign="middle" >400.29</td><td align="center" valign="middle" >2.002</td><td align="center" valign="middle" >892.66</td></tr><tr><td align="center" valign="middle" >0.000</td><td align="center" valign="middle" >498.74</td><td align="center" valign="middle" >2.399</td><td align="center" valign="middle" >959.63</td></tr></tbody></table></table-wrap><p>表3. 抗干扰实验数据</p></sec></sec><sec id="s7"><title>5. 结语</title><p>设计了一整套完整的具有强抗干扰能力并且电气隔离的高压数据采集与处理系统，整个系统具有非常高的线性度，同时测量最大相对误差在0.2%以内，精确度非常高，最高可在110 kV的高压环境下工作。之所以存在误差是因为在实验过程中实验板收到一些小的外界干扰，同时在读数过程中也存在相对误差。经过实验，低压侧DSP处理器收到的数字信号与高压侧采集的信号一致。可应用于智能电网中的高压设备数据检测系统中。本设计的不足是被测信号频率范围局限在100 kHz~1 MHz，在后期的研究中希望能对此问题进行改善。</p></sec><sec id="s8"><title>文章引用</title><p>原晓楠,何文林,张 乐,李昊罡. 一种具有电气隔离的数据采集与处理系统A Data Sampling and Processing System with the Ability of Electrical Insulation[J]. 智能电网, 2016, 06(06): 405-411. http://dx.doi.org/10.12677/SG.2016.66044</p></sec><sec id="s9"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.19186-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">范兴明, 刘旭东, 潘永成, 贺家敏, 张鑫, 黄知超, 刘华东, 李震. 真空断路器真空度检测方法探讨[J]. 高压电器, 2011, 47(8): 52-56.</mixed-citation></ref><ref id="hanspub.19186-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">刘琨, 周有庆, 王洪涛. 电子式互感器高压侧的数据采集系统[J]. 高电压技术, 2007, 33(1): 111-114.</mixed-citation></ref><ref id="hanspub.19186-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">陈正涛. 光纤HFBR-1414发射器的驱动电路设计[J]. 国外电子测量技术, 2010, 29(5): 79-81.</mixed-citation></ref><ref id="hanspub.19186-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">范红勇, 李红斌, 张艳. 电子式电流互感器的一种高压侧低功耗信号调制方法[J]. 高压电器, 2006, 42(5): 388- 392.</mixed-citation></ref><ref id="hanspub.19186-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">李双, 方志, 赵中原, 邱毓昌. 一种用在Rogowski线圈电流互感器中的V/F转换电路的设计[J]. 继电器, 2002, 30(10): 55-57.</mixed-citation></ref><ref id="hanspub.19186-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">刘浩淼, 卞树檀, 朱守保. 基于CPLD的RS-232串口通信实现[J]. 电子设计工程, 2011, 19(12): 153-159.</mixed-citation></ref><ref id="hanspub.19186-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">童诗白, 华成英. 模拟电子技术基础[M]. 北京: 高等教育出版社, 2006: 5.</mixed-citation></ref><ref id="hanspub.19186-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">于光平, 陈娜. 电流互感器高压侧数据采集系统研究[J]. 中国新技术新产品, 2009(20): 50-51.</mixed-citation></ref><ref id="hanspub.19186-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">刘福奇, 刘波. Verilog HDL应用程序设计实例精讲[M]. 北京: 电子工业出版社, 2009.</mixed-citation></ref><ref id="hanspub.19186-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">胡玥, 刘晓芳. 基于CPLD的异步串行通信电路设计[J]. 平顶山工学院学报, 2009, 18(1): 36-39.</mixed-citation></ref></ref-list></back></article>