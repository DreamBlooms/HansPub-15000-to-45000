<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SEA</journal-id><journal-title-group><journal-title>Software Engineering and Applications</journal-title></journal-title-group><issn pub-type="epub">2325-2286</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SEA.2019.83014</article-id><article-id pub-id-type="publisher-id">SEA-30866</article-id><article-categories><subj-group subj-group-type="heading"><subject>SEA20190300000_84381430.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于VE的多通道衰减片数据采集和分析系统
  Multi-Channel Attenuator Data Acquisition and Analysis System Based on VE
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>周</surname><given-names>超伟</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>坚松</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>中国电子科技集团公司第四十三研究所，安徽 合肥</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>14</day><month>06</month><year>2019</year></pub-date><volume>08</volume><issue>03</issue><fpage>115</fpage><lpage>120</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  基于keysight的数据采集器34970A，采用VE进行程序开发，设计一款多通道的衰减片数据采集和分析系统。该系统具有测试数据的实时采集、数据判断、数据存储与管理、历史数据显示等功能，大幅度提高了测试和数据记录的速度，满足了衰减片测试要求。
   Based on the data collector keysight-34970A and VE program development, we design a mul-ti-channel attenuator data acquisition and analysis system. The system has the functions of re-al-time data acquisition, data judgment, data storage and management, and historical data display, which greatly improves the speed of testing and data recording, and meets the requirements of attenuation test.
 
</p></abstract><kwd-group><kwd>衰减片测试，多通道，数据采集，存储与管理, Attenuator Test</kwd><kwd> Multi-Channel</kwd><kwd> Data Acquisition</kwd><kwd> Storage and Management</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于VE的多通道衰减片数据采集和分析系统<sup> </sup></title><p>周超伟，张坚松</p><p>中国电子科技集团公司第四十三研究所，安徽 合肥</p><p><img src="//html.hanspub.org/file/3-2690368x1_hanspub.png" /></p><p>收稿日期：2019年5月29日；录用日期：2019年6月13日；发布日期：2019年6月20日</p><disp-formula id="hanspub.30866-formula36"><graphic xlink:href="//html.hanspub.org/file/3-2690368x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>基于keysight的数据采集器34970A，采用VE进行程序开发，设计一款多通道的衰减片数据采集和分析系统。该系统具有测试数据的实时采集、数据判断、数据存储与管理、历史数据显示等功能，大幅度提高了测试和数据记录的速度，满足了衰减片测试要求。</p><p>关键词 :衰减片测试，多通道，数据采集，存储与管理</p><disp-formula id="hanspub.30866-formula37"><graphic xlink:href="//html.hanspub.org/file/3-2690368x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/3-2690368x7_hanspub.png" /> <img src="//html.hanspub.org/file/3-2690368x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>测试系统是用以实现信息的获取、传输、变换、存储、处理和分析，并根据处理结果对生产过程进行判断的重要技术工具。其中包括检测仪器、分析仪表、执行与控制仪表、记录仪表等几大类，也有将几部分功能集成在一起的仪表。其中信息获取技术是测试系统搭建的基础，而数据采集是信息获取的主要手段和方法。数据采集(Data Acquisition)是将被测对象的各种参数(可能是物理量、化学量等)通过相应的传感器转换为模拟电信号，再将模拟电信号通过信号调理、采样、量化、编码、传输等步骤，最后送入计算机系统进行数据处理或存储记录的过程 [<xref ref-type="bibr" rid="hanspub.30866-ref1">1</xref>] 。本文即为基于数据采集器，搭建测试平台，采用VE进行程序开发，将获取的电信号通过计算机处理，以达到快速测量的要求。</p></sec><sec id="s4"><title>2. 测试系统结构设计</title><p>随着科技的发展，在国防、通信、航空航天、制造等多个领域中要求测试和处理的数据量越来越大，速度也越来越快。由于测试任务的日益复杂，对测试也提出了需要满足现场化、网络化、远程化等多方面的要求。传统的单台仪器的测试已经远远不能满足大数据、高质量的信息采集和处理的要求了，因此测试系统成为了必然。</p><p>一个完整的数据采集系统由硬件和软件两大部分组成，计算机是将硬件和软件结合的载体。数据采集设备与计算机之间进行的交互方式一般有两种，第一种是插入式，即将数据采集卡插在计算机的PCI/PXI插槽中，通过PCI或者PXI总线将数据传给计算机，第一种是总线式，即通过外部的数据采集器将数据采集后，再通过计算机的串口、并口或者USB等接口将数据传输至计算机。这种方式需要采集卡和软件硬件具有良好的兼容性，且此类采集卡的价格相对比较昂贵，种类也比较少。第二种通过编写驱动程序将数据采集器与计算机交互，且可以兼容信号调理模块的功能，优点是成本低廉、匹配度高，简化了整个系统的复杂性。因此在实际过程测试系统搭建多选用第二种方式 [<xref ref-type="bibr" rid="hanspub.30866-ref2">2</xref>] 。</p><p>由于衰减片的尺寸较小，原始的手动测试固定困难、效率低。如何做到多片同时测试，提高测试的准确性，并对数据快速处理成为了关键。因此需要制作合适的测试夹具，通过数据采集器对衰减片各触点之间的电阻值采集后，通过RS-232或者GPIB接口总线将数据传输至计算机。计算机将获取的数据进行处理、判断并向数据采集器发送指令进行下一步的操作，已完成整个测试过程 [<xref ref-type="bibr" rid="hanspub.30866-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.30866-ref4">4</xref>] 。</p></sec><sec id="s5"><title>3. 测试系统搭建</title><sec id="s5_1"><title>3.1. 夹具结构</title><p>测试夹具要按照零件的夹持特性来选择合适的夹具元件。零件的定位面域和夹紧要素(夹紧力的大小、方向、作用点)决定了零件的夹持特性 [<xref ref-type="bibr" rid="hanspub.30866-ref5">5</xref>] 。同时，组合夹具元件还应考虑在组装上的装配性、拆卸性等的需要。衰减片检验测试最基础的就是需要一套比较合适的测试夹具。衰减片本身尺寸较小，想要多片同时测量要求非常高。本次夹具设计的设计思路是根据衰减片在测量过程制定后按照测量工序的具体要求确定的，设计时主要考虑以下几个方面问题：</p><p>1) 满足使用中衰减片定位的稳定性和可靠性；</p><p>2) 有足够的承载或夹持力度以保证衰减片在夹具上的测量过程；</p><p>3) 满足在装夹过程中简单和快速操作；</p><p>4) 尽可能避免设计结构和制作过程复杂，成本昂贵；</p><p>5) 尽可能选用标准件作为组成零件。</p><p>基于以上设计的基本原则，衰减片的测试夹具以通用测试架为基础，通过改造内部结构以适用实际操作过程。为减少或避免因应力过大或接触不良造成衰减片良品率下降或测量精准度不够，选用上下两组探针进行动态控制，上组选用直径3.0 mm多爪探头探针进行固定，下端选用直径0.48 mm多爪探头探针与衰减片测试点紧密接触。测试夹具整体结构见图1。</p><p>图1. 测试夹具整体结构图</p><p>根据衰减片的尺寸情况，我们设计了相应的3 &#215; 4上下两层板的衰减片载体，具体见图2。上层板根据衰减片尺寸切割出长方形，下层板打孔以使探针通过，通过在载体四个角和中间位置打孔用于准确定位。同时在每个安放衰减片的位置处编号，以便快速确定某个可能有问题的衰减片。</p><p>图2. 衰减片载体图</p></sec><sec id="s5_2"><title>3.2. 数据采集器选取</title><p>测试系统选用的数据采集器为keysight 34970a，34970a具有灵活的数据采集/切换功能，可提供6<sup>1/2</sup>位万用表精度、稳定性和噪声抑制，最多可提供60个通道测量，单通道中读取速率达500读数/秒，扫描速率达250通道/秒，标准配置为GPIB (IEEE-488)接口和RS-232接口，完全可以满足我们的需求 [<xref ref-type="bibr" rid="hanspub.30866-ref6">6</xref>] 。选用的模块为34901A，此模块有22个通道，其中有20个通道可以测量电压量。通过向待测衰减片提供已知直流电流并测量衰减片待测两端电压值，将采集到的电压模拟信号以多路传输形式发送到DMM的信号调节部分中，该部分通过信号调节、放大后，转换成数字信号，通过Keysight82357B的USB/GPIB转接头将信号传输在计算机上显示出来，34901A内部测量端子结构见图3。</p><p>图3. 34901A内部测量端子结构图</p></sec></sec><sec id="s6"><title>4. 测试平台驱动与实现</title><sec id="s6_1"><title>4.1. 测试数据处理</title><p>衰减片共有4个测试点，结构见图4。其中3、4测试点短接，1、2测试点之间为电阻R<sub>1</sub>，1、3测试点之间为电阻R<sub>2</sub>，2、4测试点之间为电阻R<sub>3</sub>。测试系统测得的电阻值比直接测试的电阻值大0.2~0.6 Ω左右，实际要求为&#177;1 Ω，为此统一在计算时将R<sub>1</sub>、R<sub>2</sub>、R<sub>3</sub>减0.4 Ω，实际显示的电阻值与直接测量的电阻值偏差−0.2~0.2 Ω左右，满足实验要求。通过R<sub>1</sub>、R<sub>2</sub>、R<sub>3</sub>三组数据计算得出衰减片的阻抗与衰减值，此过程通过软件编程实现。</p></sec><sec id="s6_2"><title>4.2. 数据测试与处理界面</title><p>一个完整的测试系统需要包含测试数据定义、实时数据、历史数据、报错警告等信息组成，从而才能体现一个数据采集系统的功能和实际应用 [<xref ref-type="bibr" rid="hanspub.30866-ref7">7</xref>] 。首先我们对每次测量数据先行定义了测试人、产品批次号、型号以及存储位置，方便以后准确查找相应的测试数据。具体操作界面见图5。</p><p>图4. 衰减片测试点图</p><p>图5. 测试信息定义界面图</p><p>测试夹具装好衰减片并向下压紧固定后，点击“开始测试”进行数据测试，并通过计算得出各项所需数据，将数据呈现在显示界面上。当进行短路测试时，显示为蓝色，测试数据正常时显示为绿色，测试数据异常时显示为红色，具体显示页面见图6。</p><p>如需查看历史数据，可在退出系统后，找到保存数据的文件，选择用Microsoft Office Excel打开，即可查看所有的测试数据。</p></sec></sec><sec id="s7"><title>5. 结论与展望</title><p>衰减片测试系统是在虚拟仪器技术、数据库技术以及软件开发的基础上，通过计算机控制虚拟仪器实现的多通道数据采集和处理，并通过数据库的存储来实现信息的可追溯性。本设计实现了从物理信号到远程桌面控制、访问等多功能的多通道数据采集系统。实际测量中，为避免出现探针接触不良等问题，我们设计了一组短路衰减片，可进行周期性自检，以保证测试系统的稳定性。</p><p>图6. 测试数据显示界面图</p><p>此系统的设计是先考虑衰减片的尺寸、性能等多方面因素，通过合理的夹具设计为后期全系统的搭建提供依据。实际的操作界面包含数据定义、数据测量、数据判断、采集的数据保存、历史数据的本地访问等，此系统从硬件到软件再到信息输出，完整地展现了一个数据采集系统的功能和实际应用。</p><p>通过本设计，我们深刻地认识到虚拟仪器技术是仪器发展的重要方向，随着计算机技术和信息传输技术的发展，虚拟仪器也将拓展到各个领域，通过快速、精准、高效的性能更好地为科研生产服务。</p></sec><sec id="s8"><title>文章引用</title><p>周超伟,张坚松. 基于VE的多通道衰减片数据采集和分析系统Multi-Channel Attenuator Data Acquisition and Analysis System Based on VE[J]. 软件工程与应用, 2019, 08(03): 115-120. https://doi.org/10.12677/SEA.2019.83014</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.30866-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">陈国顺, 宋新民, 马峻, 等. 网络化测控技术[M]. 北京: 电子工业出版社, 2006.</mixed-citation></ref><ref id="hanspub.30866-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">易牧, 胡延霖, 李保林. 基于LABVIEW和DSP的数据采集系统[J]. 四川兵工学报, 2009, 30(10), 138-140.</mixed-citation></ref><ref id="hanspub.30866-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">秦树人, 等. 虚拟仪器[M]. 北京: 中国计量出版社, 2004.</mixed-citation></ref><ref id="hanspub.30866-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">段晓杰. 基于虚拟仪器技术的远程多路温度检测系统的开发与研究[D]: [硕士学位论文]. 天津: 河北工业大学, 2006.</mixed-citation></ref><ref id="hanspub.30866-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">李虎. 夹具结构设计实例[J]. 机电工程技术, 2018, 47(5): 198-202.</mixed-citation></ref><ref id="hanspub.30866-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">侯长满, 付平. 利用34970A在LabVIEW中实现多路电阻自动测量[J]. 电子测试, 2008(6): 55-57.</mixed-citation></ref><ref id="hanspub.30866-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">姚琴琴. 小型高速采集存储测试系统的研究[D]: [硕士学位论文]. 太原: 中北大学, 2015.</mixed-citation></ref></ref-list></back></article>