<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">DSC</journal-id><journal-title-group><journal-title>Dynamical Systems and Control</journal-title></journal-title-group><issn pub-type="epub">2325-677X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/DSC.2017.62005</article-id><article-id pub-id-type="publisher-id">DSC-20311</article-id><article-categories><subj-group subj-group-type="heading"><subject>DSC20170200000_94819471.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于密度函数的伪谱网格细化算法及应用
  Pseudospectral Mesh Refinement Algorithm Based on Density Function and Its Application
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>王</surname><given-names>丽英</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>黄</surname><given-names>诘</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>刚</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>海军航空工程学院系统科学与数学研究所，山东 烟台</addr-line></aff><aff id="aff3"><addr-line>海军航空工程学院青岛分院，山东 青岛</addr-line></aff><aff id="aff4"><addr-line>海军航空兵学院，辽宁 葫芦岛</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>02</day><month>05</month><year>2017</year></pub-date><volume>06</volume><issue>02</issue><fpage>35</fpage><lpage>42</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    本文针对伪谱方法在求解不连续或非光滑最优控制问题上的缺点，提出了一种基于密度函数的伪谱网格细化算法，即利用Radau伪谱方法将原连续时间最优控制问题转化为非线性规划问题，取相邻配点的中点作为采样点，将动态约束在采样点上的残差作为近似解的误差评估准则；对于不满足求解精度要求的区间，利用轨迹曲率密度函数及其累积分布函数的性质将该区间进行细化。该算法能够捕捉到状态变量和控制变量的任意不连续性和非平滑性，通过有效的计算方式改进解的精度。仿真算例验证了算法的有效性。
    For the defects of pseudospectral method in solving discontinuous and non-smooth optimal control problems, a pesudospectral mesh refinement algorithm based on density function was proposed. The continuous-time optimal control problem was converted into nonlinear programming problems by using Radau pesudospectral method. The midpoints of adjacent collocation points were used as sample points, and the residuals of the dynamics constraints at these points were used as the assessment of approximation solution. The intervals where solution needs to be improved were divided into new subintervals by using the properties of curvature density function and corresponding cumulative distribution function. The algorithm can capture any discontinuities and smoothness in state and control variables, and improve the accuracy of the solution in a computational efficient manner. Simulation examples demonstrated the validity of the algorithm. 
  
 
</p></abstract><kwd-group><kwd>最优控制问题，Radau伪谱方法，网格细化，密度函数, Optimal Control Problems</kwd><kwd> Radau Pseudospectral Method</kwd><kwd> Mesh Refinement</kwd><kwd> Density Function</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于密度函数的伪谱网格细化算法及应用<sup> </sup></title><p>王丽英<sup>1</sup>，黄诘<sup>2</sup>，张刚<sup>3</sup></p><p><sup>1</sup>海军航空工程学院系统科学与数学研究所，山东 烟台</p><p><sup>2</sup>海军航空工程学院青岛分院，山东 青岛</p><p><sup>3</sup>海军航空兵学院，辽宁 葫芦岛</p><p>收稿日期：2017年4月4日；录用日期：2017年4月25日；发布日期：2017年4月28日</p><disp-formula id="hanspub.20311-formula9"><graphic xlink:href="http://html.hanspub.org/file/1-2740105x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>本文针对伪谱方法在求解不连续或非光滑最优控制问题上的缺点，提出了一种基于密度函数的伪谱网格细化算法，即利用Radau伪谱方法将原连续时间最优控制问题转化为非线性规划问题，取相邻配点的中点作为采样点，将动态约束在采样点上的残差作为近似解的误差评估准则；对于不满足求解精度要求的区间，利用轨迹曲率密度函数及其累积分布函数的性质将该区间进行细化。该算法能够捕捉到状态变量和控制变量的任意不连续性和非平滑性，通过有效的计算方式改进解的精度。仿真算例验证了算法的有效性。</p><p>关键词 :最优控制问题，Radau伪谱方法，网格细化，密度函数</p><disp-formula id="hanspub.20311-formula10"><graphic xlink:href="http://html.hanspub.org/file/1-2740105x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2017 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="http://image.hanspub.org:8080\Html/htmlimages\1-2890033x\e70a10f1-7c93-45ea-9603-062237856e4b.png" /><img src="http://image.hanspub.org:8080\Html\htmlimages\1-2890033x\e898c85e-ffc4-45c9-b817-14224a4d6960.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>近年来，伪谱法在求解无穷光滑问题时的指数收敛速度 [<xref ref-type="bibr" rid="hanspub.20311-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.20311-ref2">2</xref>] 吸引了大量学者的关注，尤其是在航空航天领域，如高超声速飞行器再入轨迹快速优化 [<xref ref-type="bibr" rid="hanspub.20311-ref3">3</xref>] 、固体运载火箭上升段轨迹优化 [<xref ref-type="bibr" rid="hanspub.20311-ref4">4</xref>] 、再入预测校正制导 [<xref ref-type="bibr" rid="hanspub.20311-ref5">5</xref>] 等。伪谱方法属于传统优化方法——配点法的一种。随着对配点法的深入研究，学者们逐渐发现，解的精度不仅与节点的个数、分布形状相关，还与其配置方式有关。伪谱法虽然在节点的分布形状上比传统的局部配点法(h法)具有优势——两端密集、中间稀疏的分布特点能够避免龙格现象的发生，但其配置方式是固定的(单区间分布)，不能够有效地捕捉解的不连续性和非平滑特性。这种固定的节点分布方式导致了其在求解不连续或非光滑最优控制问题时，可能会出现得不到最优解或使用高维数的插值多项式也得不到理想近似解的情况发生。针对这种情况，文献 [<xref ref-type="bibr" rid="hanspub.20311-ref6">6</xref>] 提出了一种伪谱法节点法，通过将时间区间在不连续点或奇点处划分为多个小块，在每个区间内采用全局插值多项式近似函数，但对于大多数最优控制问题来说，不连续点和奇点的个数及位置是不可能提前获知的。因此，有必要对伪谱网格细化算法进行研究。</p><p>目前，关于网格细化算法的研究主要集中在h法上，大量的学者对静态网格细化算法和动态网格细化算法进行了深入研究。文献 [<xref ref-type="bibr" rid="hanspub.20311-ref7">7</xref>] 针对多目标优化提出了一种基于代理模型的自适应网格细化算法；文献 [<xref ref-type="bibr" rid="hanspub.20311-ref8">8</xref>] 针对再入飞行器提出了一种基于自适应可变伪谱插值法的在线轨迹优化算法。文献 [<xref ref-type="bibr" rid="hanspub.20311-ref9">9</xref>] [<xref ref-type="bibr" rid="hanspub.20311-ref10">10</xref>] 提出了一种基于节点密度函数的网格细化算法，虽然避免了传统h法的等间距节点分布方式，一定程度上提高了近似解的精度和计算效率，但达不到伪谱方法的收敛速度。</p><p>本文将密度函数引入伪谱方法中，提出了一种基于密度函数的伪谱网格细化算法。利用轨迹曲率在一定程度上反映了解的平滑性的特点，基于轨迹曲率密度函数及其累积分布函数的性质来捕捉解的不连续性和非光滑性，定义新增区间网点的位置，将区间做进一步细化，利用Radau伪谱法将多区间非线性最优控制问题转化为非线性规划问题，采用SNOPT求解。</p></sec><sec id="s4"><title>2. 多区间连续时间最优控制问题的一般性描述</title><p>传统的单区间连续时间最优控制问题是指，定义状态变量和控制变量，使如式(1)所示的Bolza型代价函数在满足各种约束的条件下达到最小化</p><disp-formula id="hanspub.20311-formula11"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x9_hanspub.png"  xlink:type="simple"/></disp-formula><p>约束条件</p><disp-formula id="hanspub.20311-formula12"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x10_hanspub.png"  xlink:type="simple"/></disp-formula><p>式中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x11_hanspub.png" xlink:type="simple"/></inline-formula>分别表示动态约束、路径约束、边界约束；<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x12_hanspub.png" xlink:type="simple"/></inline-formula>表示Mayer型代价函数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x13_hanspub.png" xlink:type="simple"/></inline-formula>表示Lagrange型代价函数。<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x14_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>多区间非线性最优控制问题是指将问题(1)~(2)的时间区间划分为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x15_hanspub.png" xlink:type="simple"/></inline-formula>个网格子区间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x16_hanspub.png" xlink:type="simple"/></inline-formula>。令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x17_hanspub.png" xlink:type="simple"/></inline-formula>表示第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x18_hanspub.png" xlink:type="simple"/></inline-formula>个子区间内的配点，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x19_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x20_hanspub.png" xlink:type="simple"/></inline-formula>个网点。</p><p>首先，通过如式(3)所示的时域转换关系，将每个网格子区间的时域<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x21_hanspub.png" xlink:type="simple"/></inline-formula>转变为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x22_hanspub.png" xlink:type="simple"/></inline-formula></p><disp-formula id="hanspub.20311-formula13"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x23_hanspub.png"  xlink:type="simple"/></disp-formula><p>逆转换形式为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x24_hanspub.png" xlink:type="simple"/></inline-formula>，于是<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x25_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>接着，进一步利用式(4)将网点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x26_hanspub.png" xlink:type="simple"/></inline-formula>表示为初始时间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x27_hanspub.png" xlink:type="simple"/></inline-formula>，末端时间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x28_hanspub.png" xlink:type="simple"/></inline-formula>和常数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x29_hanspub.png" xlink:type="simple"/></inline-formula>的函数</p><disp-formula id="hanspub.20311-formula14"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x30_hanspub.png"  xlink:type="simple"/></disp-formula><p>其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x31_hanspub.png" xlink:type="simple"/></inline-formula>且<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x32_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>注1：通过式(4)的变换后，可将由式(1)~(2)所描述的单区间最优控制问题转化为由式(5)~(6)所描述的多区间最优控制问题。即最小化多区间Bolza型代价函数</p><disp-formula id="hanspub.20311-formula15"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x33_hanspub.png"  xlink:type="simple"/></disp-formula><p>满足约束条件</p><disp-formula id="hanspub.20311-formula16"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x34_hanspub.png"  xlink:type="simple"/></disp-formula><p>注2：对于由式(5)~(6)所描述的多区间最优控制问题，在每个区间内采用Radau伪谱方法将其转化为相应的非线性规划问题。</p></sec><sec id="s5"><title>3. 伪谱网格细化算法</title><p>实施网格细化策略的第一步是要确定解的某种误差评估准则，然后根据这一准则判断需要进一步改进求解精度的区间，并在该区间实施网格细化策略。伪谱方法在离散化过程中是采用Lagrange插值多项式作为基函数来近似状态变量和控制变量的，其优点在于插值点上函数的近似值与实际值相等。因此，在优化求解过程中，若能得到原连续时间最优控制问题的确切解，则动态约束方程应该在配点间的任意点上得到满足。</p><p>本文将动态约束方程在配点间的被满足程度作为解的误差判定准则。下面，以第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x35_hanspub.png" xlink:type="simple"/></inline-formula>个网格子区间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x36_hanspub.png" xlink:type="simple"/></inline-formula>为例，对伪谱法网格细化算法的流程加以说明。</p><sec id="s5_1"><title>3.1. 解的误差判定准则</title><p>令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x37_hanspub.png" xlink:type="simple"/></inline-formula>(Lagrange多项式的维数)表示区间的配点数，取相邻配点的中点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x38_hanspub.png" xlink:type="simple"/></inline-formula>作为采样点。将动态约束方程在采样点上的残差作为解的误差评估准则，如式(7)所示：</p><disp-formula id="hanspub.20311-formula17"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x39_hanspub.png"  xlink:type="simple"/></disp-formula><p>设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x40_hanspub.png" xlink:type="simple"/></inline-formula>为给定的误差门限值。当式(7)中的每个元素都比小时，认为满足求解精度要求；否则，将该区间做进一步的细化，以改进求解精度。</p></sec><sec id="s5_2"><title>3.2. 基于曲率密度函数的细化策略</title><sec id="s5_2_1"><title>3.2.1. 密度函数的定义</title><p>若函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x41_hanspub.png" xlink:type="simple"/></inline-formula>为一个非负Lebesgue可积函数，且满足<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x42_hanspub.png" xlink:type="simple"/></inline-formula>，则称<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x43_hanspub.png" xlink:type="simple"/></inline-formula>为密度函数。与其对应的累积分布函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x44_hanspub.png" xlink:type="simple"/></inline-formula>可表示为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x45_hanspub.png" xlink:type="simple"/></inline-formula>。任意给定的的非负函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x46_hanspub.png" xlink:type="simple"/></inline-formula>都可以通过式(8)转化为密度函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x47_hanspub.png" xlink:type="simple"/></inline-formula></p><disp-formula id="hanspub.20311-formula18"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x48_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据密度函数及其累积分布函数的性质可知: 若在区间<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x49_hanspub.png" xlink:type="simple"/></inline-formula>内插入<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x50_hanspub.png" xlink:type="simple"/></inline-formula>个点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x51_hanspub.png" xlink:type="simple"/></inline-formula>，其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x52_hanspub.png" xlink:type="simple"/></inline-formula>，则如果知道第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x53_hanspub.png" xlink:type="simple"/></inline-formula>个点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x54_hanspub.png" xlink:type="simple"/></inline-formula>的位置，那么第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x55_hanspub.png" xlink:type="simple"/></inline-formula>个点<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x56_hanspub.png" xlink:type="simple"/></inline-formula>的位置可由式(9)确定</p><disp-formula id="hanspub.20311-formula19"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x57_hanspub.png"  xlink:type="simple"/></disp-formula><p>文献 [<xref ref-type="bibr" rid="hanspub.20311-ref9">9</xref>] 指出，基于曲率的密度函数能够生成所求函数曲线的最佳分段线性近似。同时，曲线的曲率在一定程度上还反映了曲线的平滑性。因此，以下选取经过插值后得到的状态轨迹的曲率函数作为进一步细化区间所需的密度函数，通过轨迹曲率密度函数所对应的累积分布函数确定新增加网点的位置。</p></sec><sec id="s5_2_2"><title>3.2.2. 新增区间位置的确定</title><p>设<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x58_hanspub.png" xlink:type="simple"/></inline-formula>表示第<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x59_hanspub.png" xlink:type="simple"/></inline-formula>个子区间内，优化得到的离散状态变量经过lagrange插值后得到的状态轨迹，则轨迹曲率函数定义如下：</p><disp-formula id="hanspub.20311-formula20"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/1-2740105x60_hanspub.png"  xlink:type="simple"/></disp-formula><p>则由式(10)所定义的曲率函数而构成的密度函数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x61_hanspub.png" xlink:type="simple"/></inline-formula>可表示为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x62_hanspub.png" xlink:type="simple"/></inline-formula>，其中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x63_hanspub.png" xlink:type="simple"/></inline-formula>为一选定的常数，满足<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x64_hanspub.png" xlink:type="simple"/></inline-formula>。于是，与其对应的累积分布函数为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x65_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>参考式(9)，通过<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x66_hanspub.png" xlink:type="simple"/></inline-formula>确定新增网点的位置，其中，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x67_hanspub.png" xlink:type="simple"/></inline-formula>可取大于1的任意整数。本章算例中取<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x68_hanspub.png" xlink:type="simple"/></inline-formula>，对于新增加的子区间，同样使用<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x69_hanspub.png" xlink:type="simple"/></inline-formula>维的插值多项式来近似状态变量和控制变量。</p></sec></sec><sec id="s5_3"><title>3.3. 算法流程</title><p>注3：图1中<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x70_hanspub.png" xlink:type="simple"/></inline-formula>表示<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x71_hanspub.png" xlink:type="simple"/></inline-formula>中的最大值，且在算法实施过程中，若<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x72_hanspub.png" xlink:type="simple"/></inline-formula>，则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x73_hanspub.png" xlink:type="simple"/></inline-formula>取值应偏大；若<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x74_hanspub.png" xlink:type="simple"/></inline-formula>，则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x75_hanspub.png" xlink:type="simple"/></inline-formula>取值应偏小。注4。由算法流程可以看出该算法属于一种偏h的伪谱细化过程，为叙述方便用自适应h伪谱法代替伪谱网格细化。</p></sec></sec><sec id="s6"><title>4. 验证算例</title><p>下面，以月球着陆的轨迹优化问题 [<xref ref-type="bibr" rid="hanspub.20311-ref11">11</xref>] 为例，对自适应h伪谱法和自适应p伪谱法的优化性能进行比较分析。</p><p>最小化代价函数</p><disp-formula id="hanspub.20311-formula21"><graphic xlink:href="http://html.hanspub.org/file/1-2740105x76_hanspub.png"  xlink:type="simple"/></disp-formula><p>满足如下的动态约束、边界条件和控制路径约束</p><disp-formula id="hanspub.20311-formula22"><graphic xlink:href="http://html.hanspub.org/file/1-2740105x77_hanspub.png"  xlink:type="simple"/></disp-formula><p>优化结束时自适应h伪谱法和自适应p伪谱法优化策略的节点分布方式如图2所示，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x78_hanspub.png" xlink:type="simple"/></inline-formula>表示程序初始化时对应的子区间个数和每个区间内的配点数。</p><p>图3为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x79_hanspub.png" xlink:type="simple"/></inline-formula>精度要求下，采用两种算法在求解上述最优控制问题优化结束时的控制变量和状态变量随时间的变化曲线。结合三图可知：(1) 自适应p伪谱法的节点分布保持两端密集、中间稀疏的特点；而自适应h-Radau伪谱法的节点分布不具备这一特点，它将时间区间进行了划分，图中靠近的三个点属于同一个子区间；(2) 在控制变量表现出不连续性、控制变量表现出非光滑性的位置附近，自适应h伪谱法节点分布比较密集。</p><p>图1. 算法流程</p><p>图2. 不同伪谱法的节点分布方式</p><p>图3. 不同伪谱法下的控制、状态变量随时间变化曲线</p><p>上述分析过程表明，对于不连续或非光滑的最优控制问题，自适应h伪谱法能够精确的捕捉状态变量和控制变量的非平滑性和不连续性，自适应p伪谱方法不具备这一特点。</p><p>表1 (Ap代表自适应p伪谱法，Ah代表自适应h伪谱法)给出了两种方法在不同精度要求下的仿真结</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Comparision of optimization result of difference accurac</title></caption><table><tbody><thead><tr><th align="center" valign="middle" ><inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/1-2740105x84_hanspub.png" xlink:type="simple"/></inline-formula></th><th align="center" valign="middle" >方法</th><th align="center" valign="middle" >优化时间</th><th align="center" valign="middle" >节点数</th><th align="center" valign="middle" >迭代次数</th><th align="center" valign="middle" >代价函数</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >10<sup>−3</sup></td><td align="center" valign="middle" >Ap(1/20)</td><td align="center" valign="middle" >0.8141 s</td><td align="center" valign="middle" >21</td><td align="center" valign="middle" >1</td><td align="center" valign="middle" >8.2498</td></tr><tr><td align="center" valign="middle" >Ah(10/2)</td><td align="center" valign="middle" >0.3346 s</td><td align="center" valign="middle" >23</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >8.2483</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >10<sup>−4</sup></td><td align="center" valign="middle" >Ap(1/20)</td><td align="center" valign="middle" >0.9576 s</td><td align="center" valign="middle" >31</td><td align="center" valign="middle" >2</td><td align="center" valign="middle" >8.2472</td></tr><tr><td align="center" valign="middle" >Ah(10/2)</td><td align="center" valign="middle" >0.6196 s</td><td align="center" valign="middle" >31</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >8.2462</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >10<sup>−5</sup></td><td align="center" valign="middle" >Ap(1/20)</td><td align="center" valign="middle" >1.1497 s</td><td align="center" valign="middle" >41</td><td align="center" valign="middle" >3</td><td align="center" valign="middle" >8.2463</td></tr><tr><td align="center" valign="middle" >Ah(10/2)</td><td align="center" valign="middle" >0.6846 s</td><td align="center" valign="middle" >41</td><td align="center" valign="middle" >4</td><td align="center" valign="middle" >8.2462</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >10<sup>−6</sup></td><td align="center" valign="middle" >Ap(1/20)</td><td align="center" valign="middle" >2.2034 s</td><td align="center" valign="middle" >61</td><td align="center" valign="middle" >5</td><td align="center" valign="middle" >8.2458</td></tr><tr><td align="center" valign="middle" >Ah(10/2)</td><td align="center" valign="middle" >1.0677 s</td><td align="center" valign="middle" >75</td><td align="center" valign="middle" >6</td><td align="center" valign="middle" >8.2462</td></tr></tbody></table></table-wrap><p>表1. 不同精度下的优化结果比较</p><p>果。从优化时间、节点数、迭代次数和代价函数上对两种方法的进行了比较。分析表1可得到以下结论：(1) 两种方法均能求解相应的最优控制问题，不同精度要求下的代价函数值在8.2458~8.2498之间，相差不大；(2) 随着精度要求的提高，优化所需的节点数、优化时间及迭代次数都在增大，这符合伪谱法求解最优控制问题的特点；(3) 所有精度下，自适应h伪谱法的优化时间均小于自适应p伪谱法；随着求解精度要求的提高，自适应p伪谱方法需要双倍的计算代价才能达到自适应h伪谱法的求解精度。</p><p>整个分析过程表明，对于非光滑最优控制问题的求解，自适应h伪谱法能够较精确的捕捉状态变量和控制变量的不连续性及非平滑性，并以较少的计算代价得到较高精度的解。</p></sec><sec id="s7"><title>5. 结论</title><p>本文针对具有不连续性或非平滑性的最优控制问题，给出了一种新的自适应伪谱离散化解法——伪谱网格细化算法，并通过设定解的误差准则，在不满足精度要求的区间引入轨迹曲率密度函数将区间细化。这一自适应过程避免了对解的不连续点和奇点的先验知识。最后通过实例验证了该算法与自适应p伪谱法相比，能够精确的捕捉解的不连续性和非平滑性，以较少的计算代价得到较高精度的解。</p></sec><sec id="s8"><title>基金项目</title><p>山东省自然科学基金(No.ZR2014AM006)。</p></sec><sec id="s9"><title>文章引用</title><p>王丽英,黄 诘,张 刚. 基于密度函数的伪谱网格细化算法及应用Pseudospectral Mesh Refinement Algorithm Based on Density Function and Its Application[J]. 动力系统与控制, 2017, 06(02): 35-42. http://dx.doi.org/10.12677/DSC.2017.62005</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.20311-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Gong, Q., Kang, W. and Ross, I.M. (2006) A Pseudospectral Method for the Optimal Control of Constrained Feedback Linearizable Systems. IEEE Transactions on Automatic Control, 51, 1115-1129.  
&lt;br&gt;https://doi.org/10.1109/TAC.2006.878570</mixed-citation></ref><ref id="hanspub.20311-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Kang, W. (2010) Rate of Convergence for the Legendre Pseudo-spectral Optimal Control of Feedback Linearizable Systems. Journal of Control Theory and Applications, 8, 391-405. &lt;br&gt;https://doi.org/10.1007/s11768-010-9104-0</mixed-citation></ref><ref id="hanspub.20311-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">雍恩米, 唐国金, 陈磊. 基于Gauss伪谱方法的高超声速飞行器再入轨迹快速优化[J]. 宇航学报, 2008, 29(6): 1766-1772.</mixed-citation></ref><ref id="hanspub.20311-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Guo, X. and Zhu, M. (2013) Direct Trajectory Optimization Based on a Mapped Chebyshev Pseudospectral Method. Chinese Journal of Aeronautics, 26, 401-402. &lt;br&gt;https://doi.org/10.1016/j.cja.2013.02.018</mixed-citation></ref><ref id="hanspub.20311-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">水尊师, 周军, 葛致磊. 基于高斯伪谱方法的再入飞行器预测校正制导方法研究[J]. 宇航学报, 2011, 32(6): 1249-1255.</mixed-citation></ref><ref id="hanspub.20311-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Ross, I.M. and Fahroo, F. (2004) Pseudospectral Knotting Methods for Solving Optimal Control Problems. Journal of Guidance, Control, and Dynamics, 27, 397-405. &lt;br&gt;https://doi.org/10.2514/1.3426</mixed-citation></ref><ref id="hanspub.20311-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Chowdhury, S. and Mehmani, A. (2016) Adaptive Model Refinement in Surrogate-Based Multiobjective Optimization. 57th AIAA/ASCE/AHS/ASC Structures, Structural Dynamics, and Mate-rials Conference, San Diego, 4-8 January 2016, AIAA 2016-0417. &lt;br&gt;https://doi.org/10.2514/6.2016-0417</mixed-citation></ref><ref id="hanspub.20311-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Sa-gliano, M., Mooij, E. and Theil, S. (2016) Onboard Trajectory Generation for Entry Vehicles via Adaptive Multivariate Pseudospectral Interpolation. AIAA Guidance, Navigation, and Control Conference, San Diego, 4 January 2016, AIAA 2016-2115. &lt;br&gt;https://doi.org/10.2514/6.2016-2115</mixed-citation></ref><ref id="hanspub.20311-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Zhao Y. and Tsiotras P. (2009) Mesh Refinement Using Density-Function for Solving Optimal Control Problems. Infotech and Aerospace Conference, Seattle, 6-9 April 2009, AIAA Paper 2009-2019.  
&lt;br&gt;https://doi.org/10.2514/6.2009-2019</mixed-citation></ref><ref id="hanspub.20311-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Zhao Y. and Tsiotras P. (2011) Density Functions for Mesh Refinement in Numerical Optimal Control. Journal of Guidance, Control, and Dynamics, 34, 271-277. &lt;br&gt;https://doi.org/10.2514/1.45852</mixed-citation></ref><ref id="hanspub.20311-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Betts, J.T. (1998) Survey of Numerical Methods for Trajectory Optimization. Journal of Guidance, Control, and Dynamics, 21, 193-207. &lt;br&gt;https://doi.org/10.2514/2.4231</mixed-citation></ref></ref-list></back></article>