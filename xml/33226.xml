<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">SEA</journal-id><journal-title-group><journal-title>Software Engineering and Applications</journal-title></journal-title-group><issn pub-type="epub">2325-2286</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/SEA.2019.86037</article-id><article-id pub-id-type="publisher-id">SEA-33226</article-id><article-categories><subj-group subj-group-type="heading"><subject>SEA20190600000_16934715.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于剪贴板及COM技术设计实现雷达宽带直采回波提取软件
  Software Design and Implementation of Echo Waves Extraction of Direct Acquisition Wideband Radar Based on Clipboard and COM Technologies
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>志民</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>张</surname><given-names>丽</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>刘</surname><given-names>利军</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>中国酒泉卫星发射中心技术部，甘肃 酒泉</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>22</day><month>11</month><year>2019</year></pub-date><volume>08</volume><issue>06</issue><fpage>303</fpage><lpage>310</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   为有效地从雷达宽带直采数据中获取空间目标的信息，为后续的目标识别提供支持，设计雷达宽带直采回波提取软件很有必要。软件实现采用了三种关键技术：一是采用COM技术提高已有组件的重用性及开发效率；二是利用Windows剪贴板作为COM组件和软件主程序间通信媒介实现不同进程间信息交换；三是使用多线程技术提高软件运行效率和交互性。该软件已成功应用于工程实践，提高了雷达宽带直采数据的处理效率，证明了软件设计的正确性。 With the demand for effectively extracting spatial objects’ information from direct acquisition wideband radar data and giving support for subsequent target classification comes the need to design an echo wave extraction software on wideband direct acquisition radar. Three key tech-nologies are utilized in the software implementation. First, the utilization of COM technology facil-itates the component reusage, thus enhances software design efficiency. Second, the Windows clipboard acts as a mechanism to exchange data between the COM and the software main procedure. Finally, the multithreading technology makes it possible to improve efficiency and interactivity of software. This software is successfully put into practice, which increases data processing efficiency of direct acquisition wideband radar data. It is clear that the software design is correct. 
 
</p></abstract><kwd-group><kwd>剪贴板，COM，雷达宽带，回波提取，软件设计，多线程, Clipboard</kwd><kwd> COM</kwd><kwd> Wideband Radar</kwd><kwd> Echo Wave Extraction</kwd><kwd> Software Design</kwd><kwd> Multithread</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于剪贴板及COM技术设计实现雷达宽带直采回波提取软件<sup> </sup></title><p>张志民，张丽，刘利军</p><p>中国酒泉卫星发射中心技术部，甘肃 酒泉</p><p><img src="//html.hanspub.org/file/4-2690384x1_hanspub.png" /></p><p>收稿日期：2019年11月7日；录用日期：2019年11月22日；发布日期：2019年11月29日</p><disp-formula id="hanspub.33226-formula77"><graphic xlink:href="//html.hanspub.org/file/4-2690384x5_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>为有效地从雷达宽带直采数据中获取空间目标的信息，为后续的目标识别提供支持，设计雷达宽带直采回波提取软件很有必要。软件实现采用了三种关键技术：一是采用COM技术提高已有组件的重用性及开发效率；二是利用Windows剪贴板作为COM组件和软件主程序间通信媒介实现不同进程间信息交换；三是使用多线程技术提高软件运行效率和交互性。该软件已成功应用于工程实践，提高了雷达宽带直采数据的处理效率，证明了软件设计的正确性。</p><p>关键词 :剪贴板，COM，雷达宽带，回波提取，软件设计，多线程</p><disp-formula id="hanspub.33226-formula78"><graphic xlink:href="//html.hanspub.org/file/4-2690384x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2019 by author(s) and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/4-2690384x7_hanspub.png" /> <img src="//html.hanspub.org/file/4-2690384x8_hanspub.png" /></p></sec><sec id="s3"><title>1. 绪论</title><p>在精确制导、空间监视、战场感知、防空预警等诸多涉及国家安全和军事实力的应用领域中，目标识别是决定武器系统作战效能的核心技术之一，也是长期制约武器系统信息化发展的瓶颈问题。雷达作为导弹防御系统中重要的传感器之一，以其全天时、全天候、作用距离远等独特的技术优势，成为实现目标识别的主要技术手段之一。随着导弹武器突防技术的发展，人们对雷达测量能力提出了越来越高的要求。从最初只需要测量目标弹道，到后来对目标特性RCS的需求，再到后来需要的目标宽带特性以及极化特性。宽带或超宽带电磁波是雷达技术在频域应用的大幅扩展，可同时激励目标谐振区、光学区甚至瑞利区散射特性，进而获取更加丰富的目标与环境信息 [<xref ref-type="bibr" rid="hanspub.33226-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.33226-ref2">2</xref>] [<xref ref-type="bibr" rid="hanspub.33226-ref3">3</xref>] [<xref ref-type="bibr" rid="hanspub.33226-ref4">4</xref>] [<xref ref-type="bibr" rid="hanspub.33226-ref5">5</xref>]。近年来高速采集和存储技术的突破，催生了雷达数据宽带直接采集系统。该系统使得雷达成为一种数字化的传感器，在雷达波束和威力范围内，以GHz的速率对脉冲周期时间内回波进行采集和储存，实现了“所见即所得”的宽场景、大纵深数据获取。在直采数据中，既包含多目标精确的相对空域分布信息，也包含单个目标的宽窄带、极化特性信息。</p><p>本文设计实现某X波段雷达宽带直采数据回波提取软件，目的是从雷达宽带直采数据中提取雷达回波，为以后目标特征提取、目标识别等工作提供基础。下面首先给出软件设计方案，接下来分别介绍软件设计中的三种关键技术，对软件性能作出评估，最后是结束语。</p></sec><sec id="s4"><title>2. 雷达宽带直采回波提取软件设计</title><p>现代软件开发多采用组件方式，即利用已有的组件“搭建”应用程序，藉以提高软件开发效率。这些组件模块可以运行在同一台机器或同一网络中不同的机器上，甚或运行在不同的操作系统上。使用组件带来的好处是，当应用系统的需求发生变化时只需对受影响的组件模块进行修改，然后重新整合得到新的升级软件，无需对整个系统进行编译修改，从而确保了软件的健壮性和易维护性，降低了系统开发的复杂度。COM (Component Object Model，组件对象模型)是Microsoft提出的一种基于二进制标准、与编程语言无关的软件架构，是OLE (Object Linking and Embedding，对象链接与嵌入)复合文档和ActiveX等技术的基础。语言无关性、进程透明性、可重用性和安全性是COM的主要特性，COM代码以可重用二进制的组件形式存在。在COM的创建上，可以利用Matlab、C++等多种编程语言进行。鉴于Matlab编程语言擅长矩阵型数据处理及数据的图形显示，在Matlab开发平台上开发封装回波提取算法的COM组件是一个比较合理的选择。另一方面，在Visual Studio平台上基于C/C++语言开发的应用程序虽然在数据处理能力上比Matlab稍逊一筹，但其实时性、交互性远超后者。因此将两方面结合起来，发挥不同编程语言优势，是一个较好的软件开发解决方案。</p><p>此外在混合语言编程中，如何实现不同进程间的通信是一个重要的问题。在Windows操作系统平台上，目前常用的进程间通信包括剪贴板、WM_COPYDATA消息、文件映射(File Mapping)、动态数据交换(DDE)、管道(Pipes)、远程过程调用(Remote Procedure Call, RPC)、邮件槽(Mailslots)、Windows套接字(Windows Sockets)等。</p><p>基于上述考虑，雷达宽带直采回波提取软件采取“COM + 剪贴板”的设计方案，如图1所示。COM组件封装直采回波提取算法，在Matlab平台上开发并在主程序所在操作系统注册。主程序在Visual Studio 2010上开发 [<xref ref-type="bibr" rid="hanspub.33226-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.33226-ref7">7</xref>]，通过调用COM组件提供的功能，实现雷达宽带直采回波提取。主程序和COM之间通过剪贴板机制实现通信。</p><p>不难理解，在图1所示回波提取软件设计方案中需要采用两个线程，不妨称之为主线程和回波提取线程，主线程工作流程如图2所示，回波提取线程工程流程见图3。参见图2，雷达宽带直采回波提取软件运行后，主线程启动运行。主线程启动剪贴板监听功能，负责清空Windows剪贴板上既有内容，接下来启动回波提取线程。主线程在执行过程中，一旦发现剪贴板上存有COM组件发来的回波提取消息，就去处理该消息，主要是将COM提取的回波保存到磁盘文件上。主线程消息处理完毕后再次处于剪贴板信息监听状态。最后，回波提取工作结束，主线程关闭剪贴板监听功能后终止运行。在此期间若用户提前终止操作，则主线程通过剪贴板向回波提取线程发出提前终止运行命令。</p><p>图1. 雷达宽带直采回波提取软件设计方案</p><p>图3所示为回波提取线程工作流程。该线程运行后要做的第一件事就是初始化COM组件，为下面的回波提取创造条件。若COM组件初始化失败，回波提取线程直接退出。在初始化成功的情况下，回波提取线程调用COM组件提供的算法实现雷达宽带直采回波提取，并将提取过程中处理进度信息通过Windows剪贴板发给主线程。图3虚线框内的功能由COM提供。回波提取线程完成全部回波提取工作后正常退出。如回波提取线程在工作中发现剪贴板上有用户提前终止运行的命令，则线程以提前结束运行作为响应。</p><p>图2. 主线程工作流程</p><p>图3. 回波提取线程工作流程</p></sec><sec id="s5"><title>3. 关键技术</title><p>下面着重介绍雷达宽带直采回波提取软件设计及实现中用到的三项关键技术：COM组件、剪贴板技术及多线程技术。</p><sec id="s5_1"><title>3.1. COM组件的创建及使用</title><p>&#183; 创建COM组件</p><p>在Matlab平台上创建COM组件界面如图4所示，步骤如下：</p><p>Step1：以Matlab函数形式编写雷达宽带直采回波提取源程序(.m文件形式)。</p><p>Step2：在Matlab命令行输入deploytool，启动Deploytool Project对话框，在对话框中设置好项目名称、项目保存位置，项目类型选择Generic COM Component，设置好后点击“OK”按钮进入下一步。</p><p>Step3：添加.m源程序文件以及用到的所有辅助函数。</p><p>Step4：运行Build命令生成COM组件，组件自动在Windows操作系统中注册。</p><p>&#183; 使用COM组件</p><p>为使用上述Matlab平台上创建的COM组件，需调用Windows API (Appication Programming Interface，应用程序编程接口)函数AfxOleInit来初始化COM运行环境，调用CreateDispatch函数初始化调用接口，并在不需要COM组件时调用ReleaseDispatch函数释放COM所占系统资源，示例C++代码如下：</p><p>图4. 在Matlab开发平台上创建COM组件</p></sec><sec id="s5_2"><title>3.2. 利用剪贴板实现主线程和COM组件间通信</title><p>在Windows操作系统中，剪贴板实质上是一块在各应用程序间共享的公共内存区域。当在应用程序中执行“剪切”或“复制”操作时，应用程序将所选择的数据以一定的格式存放到剪贴板上，其它任何支持这些数据格式的应用程序都可以访问它们。剪贴板上可存放任意格式的数据，这些数据的格式称为剪贴板数据格式，它们既可以是系统预先定义好的，也可以是用户自定义的。</p><p>在雷达宽带直采回波提取软件的实现过程中，COM组件所在的回波提取线程和主线程之间采用Windows剪贴板作为通信媒介。为提高源程序代码的可读性，采用字符串型剪贴板数据格式。当主线程向回波提取线程发起通信时，主线程把字符串信息放在剪贴板上，Windows操作系统负责通知回波提取线程使用该消息，反之亦然。在Visual Studio开发平台上 [<xref ref-type="bibr" rid="hanspub.33226-ref8">8</xref>] [<xref ref-type="bibr" rid="hanspub.33226-ref9">9</xref>] 为了向操作系统定制这样的功能，需要调用数个API函数。其中启用剪贴板监听功能时需调用AddClipboardFormatListener，函数原型为：</p><p>BOOL WINAPI AddClipboardFormatListener(_In_HWND hwnd);</p><p>这里hwnd为实现剪贴板信息监听功能的主线程窗口句柄。</p><p>当关闭剪贴板监听功能时，使用RemoveClipboardFormatListener函数实现：</p><p>BOOL WINAPI RemoveClipboardFormatListener(_In_HWND hwnd);</p><p>参数hwnd的含义与上面AddClipboardFormatListener中的相同。</p><p>作为通信的另一方，在COM组件所在的回波提取线程中，下述Matlab代码负责将字符串strMsg放到剪贴板上：</p><p>try</p><p>clipboard('copy', strMsg);</p><p>catch exception</p><p>end</p><p>另一方面，从剪贴板上获取字符串型信息并赋予变量str的Matlab代码为：</p><p>str=clipboard('paste');</p></sec><sec id="s5_3"><title>3.3. 多线程技术</title><p>多任务是在一个操作系统平台上可以同时运行多个程序或者能在一个程序内部实现多任务的能力。早先的DOS、Windows 3.x操作系统都不是为多任务而设计的，部分原因是内存管理能力不够强。随着计算机技术的发展，从Windows XP开始及在其后续版本操作系统中实现了真正的多任务、多线程，为各种实时应用程序的实现提供了软硬件基础 [<xref ref-type="bibr" rid="hanspub.33226-ref10">10</xref>]。</p><p>为了在主线程中创建并启动回波提取线程，需要使用API函数AfxBeginThread，它所创建的回波提取线程运行时没有窗口界面，因为它通过剪贴板与外界交互。AfxBeginThread函数各参数含义如表1所示。</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> Parameter information of AfxBeginThrea</title></caption><table><tbody><thead><tr><th align="center" valign="middle" >参数名称</th><th align="center" valign="middle" >参数类型</th><th align="center" valign="middle" >参数含义</th><th align="center" valign="middle" >参数默认值</th></tr></thead><tr><td align="center" valign="middle" >pfnThreadProc</td><td align="center" valign="middle" >AFX_THREADPROC</td><td align="center" valign="middle" >线程函数</td><td align="center" valign="middle" >—</td></tr><tr><td align="center" valign="middle" >pParam</td><td align="center" valign="middle" >LPVOID</td><td align="center" valign="middle" >自定义参数</td><td align="center" valign="middle" >—</td></tr><tr><td align="center" valign="middle" >nPriority</td><td align="center" valign="middle" >int</td><td align="center" valign="middle" >线程优先级</td><td align="center" valign="middle" >THREAD_PRIORITY_NORMAL</td></tr><tr><td align="center" valign="middle" >nStackSize</td><td align="center" valign="middle" >UINT</td><td align="center" valign="middle" >堆栈容量</td><td align="center" valign="middle" >0</td></tr><tr><td align="center" valign="middle" >dwCreateFlags</td><td align="center" valign="middle" >DWORD</td><td align="center" valign="middle" >线程选项</td><td align="center" valign="middle" >0</td></tr><tr><td align="center" valign="middle" >lpSecurityAttrs</td><td align="center" valign="middle" >LPSECURITY_ATTRIBUTES</td><td align="center" valign="middle" >安全设置</td><td align="center" valign="middle" >NULL</td></tr></tbody></table></table-wrap><p>表1. AfxBeginThread函数参数信息</p><p>当AfxBeginThread函数成功创建回波提取线程后，会返回一个指向CWinThread对象的指针，后面可以用该指针对线程进行控制。当全部回波提取工作完成，pfnThreadProc指向的线程函数返回时，回波提取线程的运行就结束了。</p></sec></sec><sec id="s6"><title>4. 雷达宽带直采回波提取软件性能评估</title><p>为评估雷达宽带直采回波提取软件性能进行仿真数据试验。图5给出主线程运行截图。试验结果表明，回波提取正常，软件运行效率较高，交互性好，实现了预定功能。</p><p>图6是对一条回波进行傅里叶变换后得到的幅频图，从幅频图中可以得出结论：该回波的频率成分集中在低频即−60~60 Hz内。在此基础上对多个回波分析，可以得到空间目标的一维距离像、二维像，并可提取目标的微动特征，作为空间目标识别的识别信息。</p><p>图5. 雷达宽带直采回波提取软件主线程运行界面</p><p>图6. 一条回波的幅频图</p></sec><sec id="s7"><title>5 结束语</title><p>雷达宽带直采数据蕴含着导弹等空间目标的重要信息，从宽带直采数据提取回波信息是进行后续特征提取、目标识别等数据处理的前提和基础。在某X波段雷达宽带直采回波提取软件的设计和实现中，使用COM组件实现了程序源代码重用，缩短了软件开发周期。采用Windows剪贴板作为COM组件和主线程间通信机制，提高了软件各模块的独立性和软件整体的健壮性。采用多线程技术提高了软件运行的速度和交互性。在仿真数据试验及工程实践中的应用表明，该软件性能达到了设计要求。</p></sec><sec id="s8"><title>文章引用</title><p>张志民,张 丽,刘利军. 基于剪贴板及COM技术设计实现雷达宽带直采回波提取软件Software Design and Implementation of Echo Waves Extraction of Direct Acquisition Wideband Radar Based on Clipboard and COM Technologies[J]. 软件工程与应用, 2019, 08(06): 303-310. https://doi.org/10.12677/SEA.2019.86037</p></sec><sec id="s9"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.33226-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">庄钊文, 王雪松, 黎湘, 等. 雷达目标识别[M]. 北京: 高等教育出版社, 2015: 548.</mixed-citation></ref><ref id="hanspub.33226-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">汪民乐, 李勇. 弹道导弹突防效能分析[M]. 北京: 国防工业出版社, 2010: 235.</mixed-citation></ref><ref id="hanspub.33226-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Skolnik, M.I. (2007) Introduction to Radar Systems. Publishing House of Electronics Industry, Beijing, 772.</mixed-citation></ref><ref id="hanspub.33226-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">周万幸. 弹道导弹雷达目标识别技术[M]. 北京: 电子工业出版社, 2011: 247.</mixed-citation></ref><ref id="hanspub.33226-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">蔡幸福, 张雄美, 高晶. 空间目标特性分析与识别[M]. 西安: 西北工业大学出版社, 2015: 138.</mixed-citation></ref><ref id="hanspub.33226-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Lippman, S.B., Lajoie, J. and Moo, B.E. (2007) C++ Primer. Posts and Telecommunications Press, Beijing, 885.</mixed-citation></ref><ref id="hanspub.33226-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Richter, J. and Nasarre, C. Windows核心编程[M]. 北京: 清华大学出版社, 2008: 770.</mixed-citation></ref><ref id="hanspub.33226-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Gilat, A. (2013) MATLAB—An Introduction with Applications. Wiley, Hoboken, 418.</mixed-citation></ref><ref id="hanspub.33226-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Horton, I. (2012) Beginning Visual C++ 2012. John Wiley &amp; Sons, Inc., Hoboken, 988. &lt;br&gt;https://doi.org/10.1002/9781118983997</mixed-citation></ref><ref id="hanspub.33226-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">张志民, 欧建平, 皇甫堪. 软件无线电台实时数据采集软件设计[J]. 计算机工程, 2010, 36(7): 33-35.</mixed-citation></ref></ref-list></back></article>