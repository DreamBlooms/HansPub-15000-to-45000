<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">AIRR</journal-id><journal-title-group><journal-title>Artificial Intelligence and Robotics Research</journal-title></journal-title-group><issn pub-type="epub">2326-3415</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/AIRR.2016.51002</article-id><article-id pub-id-type="publisher-id">AIRR-17260</article-id><article-categories><subj-group subj-group-type="heading"><subject>AIRR20160100000_20719067.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>信息通讯</subject><subject> 工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于粒子群优化的条件概率神经网络
  Particle Swarm Optimization Based Algorithm for Conditional Probability Neural Network Learning
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>徐</surname><given-names>骏捷</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>江</surname><given-names>敏</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>厦门大学福建省仿脑智能系统重点实验室，福建 厦门</addr-line></aff><aff id="aff2"><addr-line>null</addr-line></aff><author-notes><corresp id="cor1">* E-mail:<email>197795352@qq.com(徐骏)</email>;</corresp></author-notes><pub-date pub-type="epub"><day>30</day><month>03</month><year>2016</year></pub-date><volume>05</volume><issue>01</issue><fpage>13</fpage><lpage>22</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
   
   条件概率神经网络在进行模式分类时具有独特的优势，然而如何对其进行有效的训练，从而找到最优参数却是一个困难的问题。在考虑条件概率神经网络的结构特点之后，本文提出了一种基于粒子群优化的条件概率神经网络的训练方法。我们将这种基于粒子群优化的条件概率神经网络用于人脸年龄估计，实验结果表明这种网络能够显著地提高识别的准确率。 Conditional probability neural network (CPNN) has special advantage in pattern classification problems. However, how to find the optimal parameters of the CPNN to achieve better perfor-mance is an extraordinary challenge. Considering the structure feature of CPNN, we proposed a new training method based on particle swarm optimization (PSO). This method utilizes PSO to optimize the structure of CPNN and label distributions by introducing Hellinger distance between different label distributions. We applied the improved CPNN on facial age estimation. The experimental results showed that this network could increase recognition accuracy significantly.
    
  
 
</p></abstract><kwd-group><kwd>年龄估计，标签分布学习，条件概率神经网络，粒子群优化, Age Estimation</kwd><kwd> Label Distribution Learning</kwd><kwd> Conditional Probability Neural Network</kwd><kwd> Particle Swarm Optimization</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于粒子群优化的条件概率神经网络<sup> </sup></title><p>徐骏捷，江敏</p><p>厦门大学福建省仿脑智能系统重点实验室，福建 厦门</p><disp-formula id="hanspub.17260-formula194"><graphic xlink:href="http://html.hanspub.org/file/2-2610069x6_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2016年3月12日；录用日期：2016年3月25日；发布日期：2016年3月30日</p><disp-formula id="hanspub.17260-formula195"><graphic xlink:href="http://html.hanspub.org/file/2-2610069x7_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>条件概率神经网络在进行模式分类时具有独特的优势，然而如何对其进行有效的训练，从而找到最优参数却是一个困难的问题。在考虑条件概率神经网络的结构特点之后，本文提出了一种基于粒子群优化的条件概率神经网络的训练方法。我们将这种基于粒子群优化的条件概率神经网络用于人脸年龄估计，实验结果表明这种网络能够显著地提高识别的准确率。</p><p>关键词 :年龄估计，标签分布学习，条件概率神经网络，粒子群优化</p><disp-formula id="hanspub.17260-formula196"><graphic xlink:href="http://html.hanspub.org/file/2-2610069x8_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s3"><title>1. 引言</title><p>年龄估计因其在身份认证、人机接口、视频检索以及机器人视觉中存在着潜在的应用，因而倍受关注。年龄估计有着广泛的应用前景，主要包括：1) 更人性化的HCI：通过自动识别用户的年龄，可以为用户提供更合适其年龄的个性化的用户界面和服务。2) 图像及视频检索：限定年龄范围，从数据库中检索到需要的人脸图像或视频。3) 人口信息采集：用自动年龄估计系统在公共场合收集有价值的人口信息。4) 安全门禁控制：通过自动检测年龄，实现安全网络或系统门禁控制。</p><p>自动年龄估计面临的主要难题就是年龄相对于其他面部因素的特殊性：</p><p>1) 老化的过程不可控。导致样本数据收集很费力</p><p>2) 独特的年龄格局。每一个人的基因，健康情况，生活方式都不同，造成年龄格局不同。</p><p>3) 年龄格局是时间的函数。老化的过程必须按照时间顺序，某时刻的脸部状态能够影响到后面的年龄的面部状态，但是不能影响到年轻时刻的。</p><p>国际上，Young和Niels [<xref ref-type="bibr" rid="hanspub.17260-ref1">1</xref>] 是最早提出年龄估计的人。他们早在1994年就提出过通过人脸图像进行年龄估计。但他们的工作相对较为简单。他们把年龄粗略地分成：小孩、年轻人和老年人三种。Hayashi等人 [<xref ref-type="bibr" rid="hanspub.17260-ref2">2</xref>] 研究了基于Hough变换的皱纹纹理和人脸图像肤色分析的年龄和性别识别方法。2003年，Iga等人用支持向量机开发了一个用于估计年龄的分类器。Lanitis等人 [<xref ref-type="bibr" rid="hanspub.17260-ref3">3</xref>] 提出一种基于脸部外观的统计模型。他们比较了不同分类器，例如kNN、MLP、SOM的性能，并且认为机器几乎可以和人一样估计出人的年龄。Nakano等人 [<xref ref-type="bibr" rid="hanspub.17260-ref4">4</xref>] 提出利用脸部和脖子上皱纹纹理的边缘信息来进行年龄估计。Zhou等人 [<xref ref-type="bibr" rid="hanspub.17260-ref5">5</xref>] 提出用Boosing的方法做为回归方法进行年龄的估计，并用实验表明该方法比基于SVMs的方法还要好。Geng等人 [<xref ref-type="bibr" rid="hanspub.17260-ref6">6</xref>] 提出衰老模式子空间的方法，通过学习一些代表性的子空间来建模衰老模式。</p><p>条件概率神经网络(Conditional Probability Neural Network, CPNN) [<xref ref-type="bibr" rid="hanspub.17260-ref7">7</xref>] ，是一种三层的神经网络模型，它接收目标变量和条件特征向量作为输入，输入两者的条件概率，使用KL散度来作为损失函数，并通过误差反向传播来更新网络的权重。CPNN可以利用相邻的年龄信息协助学习，有效地解决年龄估计问题。然而CPNN存在如下问题：首先，反向传播算法容易陷入局部最优。反向传播算法是一种局部寻优算法。它利用误差对于权值系数的一阶导数信息来获取下一步的权值调整方向，以求达到误差最小。实际问题的求解空间往往是极其复杂的多维曲面，存在很多局部极小点，使得陷入局部极小的可能性大大增加。其次，难以决定标签分布的参数。合适的标签分布可以使得网络在学习一个类的时候从周围获得良好的特征帮助学习，而范围过大可能会对学习造成干扰。据此，本文提出了使用粒子群优化算法帮助寻找条件概率神经网络的最优参数，从而有效的解决人脸年龄估计问题。</p><p>文章结构组织如下。第二节先介绍了标签分布的概念，然后将问题模型化，并介绍了以Hellinger distance作为损失函数的CPNN和其参数学习的方法，第三节介绍了运用在CPNN上的PSO算法来优化标签分布的参数和CPNN的权值。第四节是实验部分，我们给出了实验结果，并对其进行了分析。最后，我们总结了文中所提及的研究工作，并对未来将要进行的研究进行了展望。</p></sec><sec id="s4"><title>2. 背景知识</title><sec id="s4_1"><title>2.1. 问题描述</title><p>首先我们给出标签分布的定义。</p><p>定义1. (描述度)给定一个实例x，定义描述度<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x9_hanspub.png" xlink:type="simple"/></inline-formula>，表示y描述x的程度。</p><p>对于一个实例x，实际年龄为a，那么a的领域范围内的描述度对a均有贡献。对于年龄a的标签分布，应该满足如下2条假设：a的描述度在标签分布中是最大的，以确保在类描述中实际年龄起到主导地位；其他年龄的描述度随着离a越远而越小，保证了相邻的年龄对实际年龄的贡献度比其他的更高一些。显然对于这两条假设，高斯分布和三角分布都满足要求。</p><p>令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x10_hanspub.png" xlink:type="simple"/></inline-formula>代表q维输入空间，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x11_hanspub.png" xlink:type="simple"/></inline-formula>代表有限的标签集，标签数量为c，训练集<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x12_hanspub.png" xlink:type="simple"/></inline-formula>，这里<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x13_hanspub.png" xlink:type="simple"/></inline-formula>代表一个实例，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x14_hanspub.png" xlink:type="simple"/></inline-formula>代表实例<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x15_hanspub.png" xlink:type="simple"/></inline-formula>所对应的描述度，标签分布学习的目标为条件概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x16_hanspub.png" xlink:type="simple"/></inline-formula>。假设条件概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x17_hanspub.png" xlink:type="simple"/></inline-formula>为含参模型<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x18_hanspub.png" xlink:type="simple"/></inline-formula>，这里<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x19_hanspub.png" xlink:type="simple"/></inline-formula>为模型的参数，因此标签分布的学习目标为找出参数<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x20_hanspub.png" xlink:type="simple"/></inline-formula>使得给定一个<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x21_hanspub.png" xlink:type="simple"/></inline-formula>，模型可以产生一个尽可能相似于<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x22_hanspub.png" xlink:type="simple"/></inline-formula>的标签分布。用Hellinger distance [<xref ref-type="bibr" rid="hanspub.17260-ref8">8</xref>] 来描述，定义如下。</p><p>定义2. (Hellinger距离)对于两个分布<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x23_hanspub.png" xlink:type="simple"/></inline-formula>和<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x24_hanspub.png" xlink:type="simple"/></inline-formula>，Hellinger距离 <inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x25_hanspub.png" xlink:type="simple"/></inline-formula></p><p>因此模型如下：</p><disp-formula id="hanspub.17260-formula197"><label>(1)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x26_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s4_2"><title>2.2. CPNN算法描述</title><p>条件神经网络由输入层，一层隐层和输出层构成。CPNN与传统BP神经网络存在不同：输入变量中不仅包含实例x，还包含实例的一个标签y，x与y可以来自不同的领域，拥有不同的取值范围。如在年龄估计问题中，x代表面部特征，每个元素取值通常在[0,1]之间，y代表面部所对应的年龄，取值范围通常在[0,100]之间。CPNN的输出为条件概率<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x27_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>隐层输出节点的网络激活函数可以表示为</p><disp-formula id="hanspub.17260-formula198"><label>(2)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x28_hanspub.png"  xlink:type="simple"/></disp-formula><p>这里G为sigmoid函数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x29_hanspub.png" xlink:type="simple"/></inline-formula>是第l层的节点个数，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x30_hanspub.png" xlink:type="simple"/></inline-formula>代表在第l层的第m个节点与第l-1层的第k个节点之间的链接权重。</p><p>当输入同时包含x和y时，神经网络输出变为：</p><disp-formula id="hanspub.17260-formula199"><label>(3)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x31_hanspub.png"  xlink:type="simple"/></disp-formula><p>这里</p><disp-formula id="hanspub.17260-formula200"><label>(4)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x32_hanspub.png"  xlink:type="simple"/></disp-formula><p>代表输出节点的偏重，保证了<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x33_hanspub.png" xlink:type="simple"/></inline-formula>。</p><p>因此条件概率计算如下：</p><disp-formula id="hanspub.17260-formula201"><label>(5)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x34_hanspub.png"  xlink:type="simple"/></disp-formula><p>根据Sarajedini等人 [<xref ref-type="bibr" rid="hanspub.17260-ref9">9</xref>] 的方法，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x35_hanspub.png" xlink:type="simple"/></inline-formula>可以被写作如下所示：</p><disp-formula id="hanspub.17260-formula202"><label>(6)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x36_hanspub.png"  xlink:type="simple"/></disp-formula><p>比较Equation (6)和Equation (5)，归一因子可以重写为：</p><disp-formula id="hanspub.17260-formula203"><label>(7)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x37_hanspub.png"  xlink:type="simple"/></disp-formula><p>回顾Equation (1)，模型的损失函数为：</p><disp-formula id="hanspub.17260-formula204"><label>(8)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x38_hanspub.png"  xlink:type="simple"/></disp-formula><p>种令<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x39_hanspub.png" xlink:type="simple"/></inline-formula>，Equation (8)关于θ的梯度为：</p><disp-formula id="hanspub.17260-formula205"><label>(9)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x40_hanspub.png"  xlink:type="simple"/></disp-formula><p>最后，使用RPROP算法 [<xref ref-type="bibr" rid="hanspub.17260-ref10">10</xref>] 作为权值的更新算法。RPROP算法是一种从改变学习速度的方面着手的对反向传播的改进算法，其中一个特性就是根据符号序列更新步长而不是梯度值。在RPROP算法中有两个值进行了计算：1) 更新值的符号，2) 更新值的大小。更新值的符号计算如式(10)所示。</p><disp-formula id="hanspub.17260-formula206"><label>(10)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x41_hanspub.png"  xlink:type="simple"/></disp-formula><p>这里<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x42_hanspub.png" xlink:type="simple"/></inline-formula>为当前步。更新值得大小如式(11)所示。</p><disp-formula id="hanspub.17260-formula207"><label>(11)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x43_hanspub.png"  xlink:type="simple"/></disp-formula><p>这里<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x44_hanspub.png" xlink:type="simple"/></inline-formula>。最终权值更新公式如式(12)所示。</p><disp-formula id="hanspub.17260-formula208"><label>(12)</label><graphic position="anchor" xlink:href="http://html.hanspub.org/file/2-2610069x45_hanspub.png"  xlink:type="simple"/></disp-formula></sec></sec><sec id="s5"><title>3. 基于PSO的CPNN</title><sec id="s5_1"><title>3.1. PSO概述</title><p>借助于生物觅食运动的启迪，Kennedy和Eberhart提出了PSO算法 [<xref ref-type="bibr" rid="hanspub.17260-ref11">11</xref>] 。PSO算法通过个体间的协作与竞争，实现复杂空间中最优解的搜索。PSO先生成初始种群，即在可行解空间中随机初始化一群粒子，每个粒子都为优化问题的一个可行解，并由目标函数为之确定一个适应值(fitness value)。每个粒子将在解空间中运动，并由一个速度决定其方向和距离。通常粒子将追随当前的最优粒子而动，并经逐代搜索最后得到最优解。在每一代中，粒子将跟踪两个极值，一为粒子本身迄今找到的最优解pbest，另一为全种群迄今找到的最优解gbest。</p><p>虽然进化算法对那些大而复杂、误差梯度信息很难获取或根本不可用的问题特别有吸引力，但与BP算法的局部搜索能力相比，进化算法在接近问题最优解附近的解空间搜索就比较慢，其局部搜索能力较弱。把进化算法与BP算法相结合可以增强算法的整体搜索能力，这种混合算法的学习过程分两步：首先，利用进化算法的全局搜索能力找到一个较好的神经网络初始权值；其次，在进化算法搜索到的初始权值点处利用BP算法训练神经网络，最终搜索到神经网络的最优连接权值。这种混合算法主要是利用了进化算法全局搜索的优点和BP算法局部搜索速度快的特点，而又避免了进化算法局部搜索的弱点和BP算法容易陷入局部极小点的缺点。</p></sec><sec id="s5_2"><title>3.2. PSO-CPNN</title><p>假设CPNN网络结构中含有n个隐层节点，粒子被设计向量<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x46_hanspub.png" xlink:type="simple"/></inline-formula>的形式，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x47_hanspub.png" xlink:type="simple"/></inline-formula>表示CPNN网络的权值，<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x48_hanspub.png" xlink:type="simple"/></inline-formula>为标签分布的参数。</p><p>PSO-CPNN算法流程图如下所示。</p></sec></sec><sec id="s6"><title>4. 实验</title><sec id="s6_1"><title>4.1. 设计与说明</title><p>本文中使用的数据集为FG-Net Aging Database [<xref ref-type="bibr" rid="hanspub.17260-ref12">12</xref>] 。此数据集中含有82个人共1002张面部图片，其中每人有6~18幅标有实际年龄的图像，数据集中的年龄变化范围在0~69岁之间。除了年龄特征之外，图片中的面部还带有姿势，表情等特征。</p><p>在本文的实验阶段，一些现有专门用于面部年龄估计问题的算法用于与本文的算法进行比较，如：OHRank [<xref ref-type="bibr" rid="hanspub.17260-ref13">13</xref>] ，AGES [<xref ref-type="bibr" rid="hanspub.17260-ref14">14</xref>] ，WAS [<xref ref-type="bibr" rid="hanspub.17260-ref15">15</xref>] 和AAS [<xref ref-type="bibr" rid="hanspub.17260-ref16">16</xref>] 。同样的，传统的分类算法也进行了比较，如：kNN，BP，C4.5，SVM，ANFIS [<xref ref-type="bibr" rid="hanspub.17260-ref17">17</xref>] 。</p><p>对比试验的参数设置如下，在OHRank中，使用了绝对值损失函数与RBF核函数。在AGES中，aging pattern subspace的维度设置为20。在AAS中，在appearance cluster training step中的误差阈值设置为3。在kNN中，k设置为30并使用Euclidean distance来寻找邻点。BP神经网络隐层节点数设置为100，并使用sigmoid函数作为激活函数。C4.5.在SVM中使用RBF核函数.ANFIS中隶属函数设置为2个。Cpnn中使用两种分布：高斯分布，标准差设置为1，2，3，4。三角分布，bottom length 设置为2，4，6，8。</p><p>年龄估计的性能指标使用MAE (Mean Absolute Error)，即模型输出值为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x62_hanspub.png" xlink:type="simple"/></inline-formula>，对应真实值为<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x63_hanspub.png" xlink:type="simple"/></inline-formula>，则<inline-formula><inline-graphic xlink:href="http://html.hanspub.org/file/2-2610069x64_hanspub.png" xlink:type="simple"/></inline-formula>。使用此指标可以很好的反映实际年龄和预测年龄之间的差距。</p><p>算法的测试阶段使用十折交叉验证，即将数据集分成十分，轮流将其中9份作为训练数据，1份作为测试数据，进行试验。每次试验都会得出相应的MAE。最后将10次的结果的MAE的平均值作为对算法精度的估计。</p></sec><sec id="s6_2"><title>4.2. 结果与分析</title><p>实验结果如表1所示，PSO-CPNN显示的是最好的结果，可以看出，标签分布算法的性能优于其他算法。原因主要是标签分布学习算法可以学习相邻年龄的信息。</p><p>进一步看，高斯分布优于三角分布，因为高斯分布利用所有相邻的年龄，三角分布只利用了三角形内的年龄。然而，CPNN对参数的选择比较敏感，选择不同的参数对结果影响较大。图1显示了选择不同参数时MAE的变化。通过运用本文中的方法，确定了较优的参数，从而使得MAE降到了一个较低的值。</p><p>为了比较KL距离和Hellinger距离的性能，单纯的CPNN算法也进行了，如图2所示，Hellinger距离在大部分情况下优于KL距离。</p><p>为了验证CPNN适用于训练样本较少的情况，逐渐减少训练样本数量。通过每次减少一半的训练样本，CPNN的MAE曲线如图3所示，并与OHRank和AGES方法比较，即使减少训练样本，CPNN的MAE并不会增加很快。相反的，当训练数据集减少的时候CPNN与PSO-CPNN表现得更加地稳定。但是，当数据减少的比较多的时候，由于模型复杂性更高的原因，PSO-CNPP的性能劣于CPNN。并且，在对标签分布进行优化的时候，当标签分布越接近均匀分布时，两个年龄相异的标签分布的相似度就越近。图4便显示了PSO-CPNN算法中MAE的变化。</p><p>最终，模型对应高斯分布的方差值如图5所示。</p></sec></sec><sec id="s7"><title>5. 总结和展望</title><p>本文中提出了一种新的用于年龄估计的神经网络PSO-CPNN，其特点是利用了粒子群优化算法来寻找条件概率神经网的最优参数。从宽泛的意义上讲，这种模型属于进化神经网络(evolutionary neural network, ENN)的一种，而我们所提出这种算法克服了传统条件概率神经网络不能有效处理缺失数据集的</p><table-wrap id="table1" ><label><xref ref-type="table" rid="table1">Table 1</xref></label><caption><title> MAE in different age estimator</title></caption><table><tbody><thead><tr><th align="center" valign="middle"  colspan="2"  >Method</th><th align="center" valign="middle" >MAE</th></tr></thead><tr><td align="center" valign="middle"  rowspan="2"  >My method</td><td align="center" valign="middle" >Gaussian</td><td align="center" valign="middle" >4.39</td></tr><tr><td align="center" valign="middle" >Triangle</td><td align="center" valign="middle" >4.88</td></tr><tr><td align="center" valign="middle"  rowspan="2"  >CPNN</td><td align="center" valign="middle" >Gaussian</td><td align="center" valign="middle" >4.76</td></tr><tr><td align="center" valign="middle" >Triangle</td><td align="center" valign="middle" >5.07</td></tr><tr><td align="center" valign="middle"  colspan="2"  >OHRank</td><td align="center" valign="middle" >6.27</td></tr><tr><td align="center" valign="middle"  colspan="2"  >AGES</td><td align="center" valign="middle" >6.77</td></tr><tr><td align="center" valign="middle"  colspan="2"  >WAS</td><td align="center" valign="middle" >8.06</td></tr><tr><td align="center" valign="middle"  colspan="2"  >AAS</td><td align="center" valign="middle" >14.83</td></tr><tr><td align="center" valign="middle"  colspan="2"  >kNN</td><td align="center" valign="middle" >8.24</td></tr><tr><td align="center" valign="middle"  colspan="2"  >BP</td><td align="center" valign="middle" >11.85</td></tr><tr><td align="center" valign="middle"  colspan="2"  >C4.5</td><td align="center" valign="middle" >9.34</td></tr><tr><td align="center" valign="middle"  colspan="2"  >SVM</td><td align="center" valign="middle" >7.25</td></tr><tr><td align="center" valign="middle"  colspan="2"  >ANFIS</td><td align="center" valign="middle" >8.86</td></tr></tbody></table></table-wrap><p>表1. 不同模型的MAE</p><p>图1. 分布估计算法流程图</p><p>图2. Hellinger距离与KL距离的性能比较</p><p>图3. 不同模型性能比较</p><p>图4. 算法过程中MAE变化情况</p><p>图5. 不同年龄的标准差</p><p>缺点。实验表明，本文中提出的方法的性能显著地高于其他用于年龄估计的算法。需要指出的是PSO-CPNN算法不仅能够用于优化条件神经网络的结构，同时所有输出为分布形式的网络，都可以使用本文所提出的方法来进行方法优化。</p><p>通过本文研究，我们可以得出结论，CPNN网络可以被粒子群算法优化，由此，我们相信结合不同的启发式算法，来优化条件或深度网络的结构，并将其应用到不同的领域，将是我们未来的研究方向，例如如何在深度网络中自动调参 [<xref ref-type="bibr" rid="hanspub.17260-ref18">18</xref>] ，如何整合符号-神经元方法 [<xref ref-type="bibr" rid="hanspub.17260-ref19">19</xref>] - [<xref ref-type="bibr" rid="hanspub.17260-ref21">21</xref>] ，以及如何在机器人中运用本文的结果 [<xref ref-type="bibr" rid="hanspub.17260-ref22">22</xref>] - [<xref ref-type="bibr" rid="hanspub.17260-ref25">25</xref>] 等。</p></sec><sec id="s8"><title>基金项目</title><p>此研究工作受到国家自然科学基金项目(No. 61003014，No. 61105026和No. 61273338)的资助。</p></sec><sec id="s9"><title>文章引用</title><p>徐骏捷,江 敏. 基于粒子群优化的条件概率神经网络Particle Swarm Optimization Based Algorithm for Conditional Probability Neural Network Learning[J]. 人工智能与机器人研究, 2016, 05(01): 13-22. http://dx.doi.org/10.12677/AIRR.2016.51002</p></sec><sec id="s10"><title>参考文献 (References)</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.17260-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Kwon, Y.H. and da Vitoria Lobo, N. (1994) Age Classification from Facial Images. IEEE Computer Society Confe-rence on Computer Vision and Pattern Recognition, Seattle, 21-23 Jun 1994, 762-767.</mixed-citation></ref><ref id="hanspub.17260-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Hayashi, J., Yasumoto, M., Ito, H. and Koshimizu, H. (2002) Age and Gender Estimation Based on Wrinkle Texture and Color of Facial Images. 16th International Conference on Pattern Recognition, 1, 405-408.</mixed-citation></ref><ref id="hanspub.17260-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Lanitis, A., Draganova, C. and Christodoulou, C. (2004) Comparing Different Classifiers for Automatic Age Estimation. IEEE Transactions on Systems, Man, and Cybernetics, Part B: Cybernetics, 34, 621-628.  
http://dx.doi.org/10.1109/TSMCB.2003.817091</mixed-citation></ref><ref id="hanspub.17260-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">Nakano, M., Yasukata, F. and Fukumi, M. (2004) Age Classification from Face Images Focusing on Edge Information. Knowledge-Based Intelligent Information and Engineering Systems. Springer Berlin Heidelberg.</mixed-citation></ref><ref id="hanspub.17260-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">Zhou, S.K., Georgescu, B., Zhou, X.S. and Comaniciu, D. (2005) Image Based Regression Using Boosting Method. 10th IEEE International Conference on Computer Vision, 1, 541-548.</mixed-citation></ref><ref id="hanspub.17260-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Geng, X., et al. (2006) Learning from Facial Aging Patterns for Automatic Age Estimation. Proceedings of the 14th annual ACM International Conference on Multimedia, ACM. http://dx.doi.org/10.1145/1180639.1180711</mixed-citation></ref><ref id="hanspub.17260-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Yin, C. and Geng, X. (2012) Facial Age Estimation by Conditional Probability Neural Network. Pattern Recognition. Springer Berlin Heidelberg, 243-250. http://dx.doi.org/10.1007/978-3-642-33506-8_31</mixed-citation></ref><ref id="hanspub.17260-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Hellinger, E. (1909) Neue Begründung der Theorie quadra-tischer Formen von unendlichvielen Veränderlichen. Journal für die reine und angewandte Mathematik, 136, 210-271.</mixed-citation></ref><ref id="hanspub.17260-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Sarajedini, A., Hecht-Nielsen, R. and Chau, P.M. (1999) Conditional Probability Density Function Estimation with Sigmoidal Neural Networks. IEEE Transactions on Neural Networks, 10, 231-238.  
http://dx.doi.org/10.1109/72.750544</mixed-citation></ref><ref id="hanspub.17260-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Riedmiller, M. and Braun, H. (1993) A Direct Adaptive Method for Faster Backpropagation Learning: The RPROP Algorithm. IEEE International Conference on Neural Networks, 1, 586-591.  
http://dx.doi.org/10.1109/icnn.1993.298623</mixed-citation></ref><ref id="hanspub.17260-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Eberhart, R.C. and Kennedy, J. (1995) A New Optimizer Using Particle Swarm Theory. Proceedings of the 6th International Symposium on Micro Machine and Human Science, Nagoya, 4-6 October 1995, 39-43.  
http://dx.doi.org/10.1109/MHS.1995.494215</mixed-citation></ref><ref id="hanspub.17260-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Lanitis, A., Taylor, C.J. and Cootes, T.F. (2002) Toward Automatic Simulation of Aging Effects on Face Images. IEEE Transactions on Pattern Analysis and Machine Intelligence, 24, 442-455. http://dx.doi.org/10.1109/34.993553</mixed-citation></ref><ref id="hanspub.17260-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Chang, K.-Y., Chen, C.-S. and Hung, Y.-P. (2011) Ordinal Hyperplanes Ranker with Cost Sensitivities for Age Estimation. IEEE Conference on Computer Vision and Pattern Recognition (CVPR), Providence, 20-25 June 2011, 585- 592.</mixed-citation></ref><ref id="hanspub.17260-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Geng, X., Zhou, Z.H. and Smith-Miles, K. (2007) Automatic Age Estimation Based on Facial Aging Patterns. IEEE Transactions on Pattern Analysis and Machine Intelligence, 29, 2234-2240.  
http://dx.doi.org/10.1109/TPAMI.2007.70733</mixed-citation></ref><ref id="hanspub.17260-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Lanitis, A., Taylor, C.J. and Cootes, T.F. (2002) Toward Automatic Simulation of Aging Effects on Face Images. IEEE Transactions on Pattern Analysis and Machine Intelligence, 24, 442-455. http://dx.doi.org/10.1109/34.993553</mixed-citation></ref><ref id="hanspub.17260-ref16"><label>16</label><mixed-citation publication-type="other" xlink:type="simple">Lanitis, A., Draganova, C. and Christodoulou, C. (2004) Comparing Different Classifiers for Automatic Age Estimation. IEEE Transactions on Systems, Man, and Cybernetics, Part B: Cybernetics, 34, 621-628.  
http://dx.doi.org/10.1109/TSMCB.2003.817091</mixed-citation></ref><ref id="hanspub.17260-ref17"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Jang, J.-S.R. (1993) ANFIS: Adaptive-Network-Based Fuzzy Inference System. IEEE Transactions on Systems, Man, and Cybernetics, 23, 665-685. http://dx.doi.org/10.1109/21.256541</mixed-citation></ref><ref id="hanspub.17260-ref18"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Jiang, M., Ding, Y., Goertzel, B., et al. (2014) Improving Machine Vision via Incorporating Expectation-Maximization into Deep Spatio-Temporal Learning. International Joint Conference on Neural Networks (IJCNN), Beijing, 6-11 July 2014, 1804-1811.</mixed-citation></ref><ref id="hanspub.17260-ref19"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Jiang, M., Zhou, C. and Chen, S. (2010) Embodied Concept Formation and Reasoning via Neural-Symbolic Integration. Neurocomputing, 74, 113-120. http://dx.doi.org/10.1016/j.neucom.2009.11.052</mixed-citation></ref><ref id="hanspub.17260-ref20"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Wu, Y., Jiang, M., Huang, Z., et al. (2015) An NP-Complete Fragment of Fibring Logic. Annals of Mathematics and Artificial Intelligence, 75, 391-417. http://dx.doi.org/10.1007/s10472-015-9468-4</mixed-citation></ref><ref id="hanspub.17260-ref21"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Jiang, M., Yu, Y., Chao, F., et al. (2013) A Connectionist Model for 2-Dimensional Modal Logic. IEEE Symposium on Computational Intelligence for Human-Like Intelligence (CIHLI), Singapore, 16-19 April 2013, 54-59.</mixed-citation></ref><ref id="hanspub.17260-ref22"><label>22</label><mixed-citation publication-type="other" xlink:type="simple">Jiang, M., Yu, Y., Liu, X., et al. (2012) Fuzzy Neural Network Based Dynamic Path Planning. International Conference on Machine Learning and Cybernetics (ICMLC), Xi’an, 15-17 July 2012, 326-330.</mixed-citation></ref><ref id="hanspub.17260-ref23"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Chao, F., Lee, M.H., Jiang, M., et al. (2014) An Infant Development-Inspired Ap-proach to Robot Hand-Eye Coordination. International Journal of Advanced Robotic Systems, 11. http://dx.doi.org/10.5772/57555</mixed-citation></ref><ref id="hanspub.17260-ref24"><label>24</label><mixed-citation publication-type="other" xlink:type="simple">Chao, F., Chen, F., Shen, Y., et al. (2014) Robotic Free Writing of Chinese Characters via Human-Robot Interactions. International Journal of Humanoid Robotics, 11, 1450007. http://dx.doi.org/10.1142/S0219843614500078</mixed-citation></ref><ref id="hanspub.17260-ref25"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Jiang, M., Huang, W., Huang, Z. and Yen, G.G. (2015) Integration of Global and Local Metrics for Domain Adaptation Learning via Dimensionality Reduction. IEEE Transactions on Cybernetics, PP, 1-14.</mixed-citation></ref></ref-list></back></article>