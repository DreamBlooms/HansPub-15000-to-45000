<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd"><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research article"><front><journal-meta><journal-id journal-id-type="publisher-id">DSC</journal-id><journal-title-group><journal-title>Dynamical Systems and Control</journal-title></journal-title-group><issn pub-type="epub">2325-677X</issn><publisher><publisher-name>Scientific Research Publishing</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.12677/DSC.2018.73020</article-id><article-id pub-id-type="publisher-id">DSC-25774</article-id><article-categories><subj-group subj-group-type="heading"><subject>DSC20180300000_91988757.pdf</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>工程技术</subject></subj-group></article-categories><title-group><article-title>
 
 
  基于VICON的无人机编队分布式控制
  Distributed Control of UAVs Formation Based on VICON
 
</article-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>曹</surname><given-names>俊</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>蔡</surname><given-names>晨晓</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib></contrib-group><aff id="aff2"><addr-line>南京理工大学自动化学院，江苏 南京</addr-line></aff><aff id="aff1"><addr-line>null</addr-line></aff><pub-date pub-type="epub"><day>16</day><month>05</month><year>2018</year></pub-date><volume>07</volume><issue>03</issue><fpage>182</fpage><lpage>189</lpage><permissions><copyright-statement>&#169; Copyright  2014 by authors and Scientific Research Publishing Inc. </copyright-statement><copyright-year>2014</copyright-year><license><license-p>This work is licensed under the Creative Commons Attribution International License (CC BY). http://creativecommons.org/licenses/by/4.0/</license-p></license></permissions><abstract><p>
 
 
  
    无人机编队执行任务相比单架无人机有着成功率高和任务量大的优点，编队飞行控制器的设计和编队通信方式是自主编队飞行的关键。本文针对无人机自主编队飞行的控制及通信问题，在室内动作捕捉系统VICON环境下，设计了编队轨迹跟踪以及队形保持控制器实现无人机编队巡航；采用基于代数图论和智能决策的方法，每架无人机都拥有判断自身编队层次的能力，即使有无人机出现故障，也能通过将编队信息流再次连通实现编队重构。同时利用模块化的通信设备，方便了通信程序的修改。编队飞行实验结果验证了本文提出方法的有效性。
    Comparing with single unmanned aerial vehicle (UAV), the UAVs formation has many advantages, such as high success rate and multi-task. The design of controller and the formation communication mode of UAVs are the key techniques to autonomous formation flight. This paper focuses on the control and communication of autonomous formation flying for UAVs. Under the environment of the indoor action capture system, which is made in VICON UK so it is called VICON system, the formation trajectory tracking and formation keeping controller are designed to realize the UAVs formation cruising. By using algebraic graph theory and intelligent decision-making method, each UAV has the ability to judge the self-position and formation information. Moreover, if there is a malfunction of the UAV, it can also reconnect formation information to realize the formation reconfiguration. At the same time, using modular communication module, it is convenient to modify communication program. The results of the formation flight experiment verify the effectiveness of the method in this paper. 
  
 
</p></abstract><kwd-group><kwd>四旋翼飞行器，分布式控制，编队，VICON, Quadrotor</kwd><kwd> Distributed Control</kwd><kwd> Formation</kwd><kwd> VICON</kwd></kwd-group></article-meta></front><body><sec id="s1"><title>基于VICON的无人机编队分布式控制<sup> </sup></title><p>曹俊，蔡晨晓<sup>*</sup></p><p>南京理工大学自动化学院，江苏 南京</p><disp-formula id="hanspub.25774-formula22"><graphic xlink:href="//html.hanspub.org/file/5-2740170x5_hanspub.png"  xlink:type="simple"/></disp-formula><p>收稿日期：2018年6月4日；录用日期：2018年7月2日；发布日期：2018年7月9日</p><disp-formula id="hanspub.25774-formula23"><graphic xlink:href="//html.hanspub.org/file/5-2740170x6_hanspub.png"  xlink:type="simple"/></disp-formula></sec><sec id="s2"><title>摘 要</title><p>无人机编队执行任务相比单架无人机有着成功率高和任务量大的优点，编队飞行控制器的设计和编队通信方式是自主编队飞行的关键。本文针对无人机自主编队飞行的控制及通信问题，在室内动作捕捉系统VICON环境下，设计了编队轨迹跟踪以及队形保持控制器实现无人机编队巡航；采用基于代数图论和智能决策的方法，每架无人机都拥有判断自身编队层次的能力，即使有无人机出现故障，也能通过将编队信息流再次连通实现编队重构。同时利用模块化的通信设备，方便了通信程序的修改。编队飞行实验结果验证了本文提出方法的有效性。</p><p>关键词 :四旋翼飞行器，分布式控制，编队，VICON</p><disp-formula id="hanspub.25774-formula24"><graphic xlink:href="//html.hanspub.org/file/5-2740170x7_hanspub.png"  xlink:type="simple"/></disp-formula><p>Copyright &#169; 2018 by authors and Hans Publishers Inc.</p><p>This work is licensed under the Creative Commons Attribution International License (CC BY).</p><p>http://creativecommons.org/licenses/by/4.0/</p><p><img src="//html.hanspub.org/file/5-2740170x8_hanspub.png" /> <img src="//html.hanspub.org/file/5-2740170x9_hanspub.png" /></p></sec><sec id="s3"><title>1. 引言</title><p>随着科学技术的发展，无人机不管是在军用还是民用领域都发挥着重要的作用 [<xref ref-type="bibr" rid="hanspub.25774-ref1">1</xref>] [<xref ref-type="bibr" rid="hanspub.25774-ref2">2</xref>] ，单架无人机在执行任务时一旦出现故障就意味着任务失败，但是对于无人机群来说，一架无人机出现故障离队后，利用动态网络感知技术获取环境变化和机群内部编队发生的变化，其余的无人机通过保持通信网络信息流为连通图来变换机群的编队队形和通信网络，这样就能继续执行任务 [<xref ref-type="bibr" rid="hanspub.25774-ref3">3</xref>] 。</p><p>无人机编队飞行协同执行任务就是将有自主功能的无人机根据要求按照一定的三维空间结构排列飞行并能根据控制命令动态调整姿态，保持机群飞行过程中的队形相对稳定。编队飞行能够发挥单机的最大作战效能，使无人机更安全、可靠、高效地完成任务 [<xref ref-type="bibr" rid="hanspub.25774-ref4">4</xref>] 。编队控制主要有虚拟领航者法 [<xref ref-type="bibr" rid="hanspub.25774-ref5">5</xref>] 、人工势场法 [<xref ref-type="bibr" rid="hanspub.25774-ref6">6</xref>] [<xref ref-type="bibr" rid="hanspub.25774-ref7">7</xref>] 、领航–跟随者法 [<xref ref-type="bibr" rid="hanspub.25774-ref8">8</xref>] 等。虚拟领航者法用虚拟的无人机担任领航者，无需担心领航者出现故障的问题，但需要很高的计算能力，同时虚拟领航者不是实际的飞行路线，无法保证跟随者能够准确跟随虚拟领航者；人工势场法虽然在数学描述上简单又美观，但是很难保持稳定的队形 [<xref ref-type="bibr" rid="hanspub.25774-ref9">9</xref>] ；领航–跟随者法是目前编队最可靠的方法之一，跟随者保持与领航者相对距离和方位来维持编队队形，领航者的角色十分重要，一旦出现故障可能会导致任务的失败。</p><p>本文采用领航–跟随者法，设计了轨迹跟踪控制器和队形保持控制器，同时针对无人机编队飞行过程中无人机出现故障的问题，设计了一种基于图论的领航者重选的编队重构控制方法，图论能够很清晰直观的描述无人机编队队形与通信信息流，用图中的顶点集表示无人机群，图中的边集表示通信信息流。在通信中考虑了无人机本能的问题，每一架无人机都有判断自身所处编队层次的能力，顶层的为领航者，越上层的无人机越为重要，当有无人机出现故障，可以通过判断该无人机在图中对应的顶点是否为割点，以此决定是否会对机群其它无人机产生影响，若是领航者出现故障，将次顶层的无人机重新选为领航者，解决了初始的领航–跟随者法领航者出现故障导致任务失败的问题。</p></sec><sec id="s4"><title>2. 无人机编队控制器</title><p>本文采用的是基于领航–跟随者方式编队，编队飞行控制系统包括队形保持控制子系统和轨迹跟踪控制子系统。领航者的任务在于能够精确的跟踪期望轨迹，因此需要对领航者设计轨迹跟踪控制器；另外，根据需要保持的队形，利用领航者和跟随者之间的相对运动方程，设计队形保持控制器，在此过程中跟随者可以获得保持队形所需要的期望位置，为了使跟随者能够更快的跟上领航者，在队形保持控制器中加入了误差混合器，既保持了编队队形，又提高了跟随者对领航者的快速跟随，编队控制器结构如图1所示。</p><p>图1. 编队控制器结构</p><p>在编队控制器中，误差混合器是由无人机在导航坐标系的位置误差、领航者与跟随者的速度误差线性合成的，数学表达式为：</p><p>e v x = k x ( x f 0 + x l − x f ) + k v x ( v l x − v f x ) e v y = k y ( y f 0 + y l − y f ) + k v y ( v l y − v f y ) e z = k z ( z f 0 + z l − z f ) (4)</p><p>式中， k x , k v x , k y , k v y , k z 为误差线性混合器的权重参数， x l , y l , z l 为领航者期望位置， x f , y f , z f 为跟随者的实际位置， v l x , v l y 为领航者的实际速度， v f x , v f y 为跟随者的实际速度。</p><p>采用PID控制律，得到的是跟随者的加速度信息，数学表达式为：</p><p>a f x = k p x e v x + k i x ∫ 0 t e v x d t + k d x e ˙ v x a f y = k p y e v y + k i y ∫ 0 t e v y d t + k d y e ˙ v y a f z = k p z e z + k i z ∫ 0 t e z d t + k d z e ˙ v z (5)</p><p>式中， k p x , k i x , k d x 为x方向的比例、微分、积分系数， k p y , k i y , k d y 为y方向的比例、微分、积分系数， k p z , k i z , k d z 为高度的比例、微分、积分系数。</p><p>x , y 方向加速度经过坐标变换到机体坐标，再通过姿态反解得到参考姿态角输入到姿态控制器。</p></sec><sec id="s5"><title>3. 编队策略</title><p>图是由顶点集合和顶点间的二元关系集合组成的数据结构 [<xref ref-type="bibr" rid="hanspub.25774-ref10">10</xref>] [<xref ref-type="bibr" rid="hanspub.25774-ref11">11</xref>] [<xref ref-type="bibr" rid="hanspub.25774-ref12">12</xref>] [<xref ref-type="bibr" rid="hanspub.25774-ref13">13</xref>] ，通常用 G ( V , E ) 来表示。顶点集合用 V ( G ) 来表示，边的集合用 E ( G ) 来表示。编队队形 G 1 ( V , E ) 如图2所示，顶点1为领航者，其余为跟随者，所有的无人机可表示为：</p><p>V ( G 1 ) = { 1 , 2 , 3 , 4 , 5 , 6 , 7 } (6)</p><p>通信信息流为：</p><p>图2. 编队信息流图</p><p>E ( G 1 ) = { 〈 1 , 2 〉 , 〈 1 , 3 〉 , 〈 1 , 4 〉 , 〈 1 , 5 〉 , 〈 2 , 6 〉 , 〈 2 , 7 〉 } (7)</p><p>其中，箭头方向表示上一级的无人机向下一级的无人机发送控制指令信号，回馈信号在图中省略。要保持编队队形，则必须使编队信息流图为连通图，即去除箭头后图中任意一对顶点都是连通的。若领航者出现故障，如图4(a)所示，此时应该重新选择领航者，将最高层次的跟随者改变工作状态在领航者模式，其余领航者则不变。</p><p>本文中无人机只与一架层次高于自身的无人机通信，但可以与一架或多架层次低于自身的无人机通信，因此可以利用图论中的深度优先搜索(Depth First Search, DFS)法找到图中的关节点或割点，割点是图中的一个顶点，当去掉这个点会使图分割成2个或2个以上的连通分量，这就意味着当割点处的无人机出现故障时会破坏编队通信图的连通性，机群其它的无人机会受到影响。当出现故障的不是割点处的无人机，不会破坏编队通信图的连通性，可以忽略该无人机；当出现故障的是割点处的无人机，若不是领航者，则将该点上下等级的无人机连通，若是领航者出现故障就需要重新选定领航者。重新选定的领航者最好是割点处的无人机，这样可以减少通信信息量。当只有一个割点时，则选该顶点对应的无人机重新选定为领航者，当有多个割点时，则应选择剩余连通分量多的顶点为新的领航者，若多个割点处于同一层次，则选择最小ID的无人机为新的领航者。编队重构具体流程如图3所示。</p><p>综上，领航者智能重选策略可归纳为如下过程：</p><p>1) 无人机起飞，跟随者朝着领航者靠近并维持编队队形悬停，根据无人机的队形和通信信息流图构建相应的邻接矩阵，利用DFS法找到图中所有的割点，等待新的飞行命令。</p><p>2)根据每架无人机返回的ID判断是否有无人机出现故障。</p><p>3) 若所有无人机工作正常或是非割点处的无人机出现故障，跳至第5步；若割点处的无人机出现故障，判断是否为领航者。</p><p>4) 若不是领航者出现故障，将故障无人机低层次的无人机与高层次的无人机连接通信，同时更新邻接矩阵；若是领航者出现故障，则按照规则重新选定领航者并更新邻接矩阵。</p><p>5) 领航者根据预先设定的飞行线路进行轨迹跟踪控制飞行，跟随者根据领航者发来的位置与速度信息进行编队控制飞行。返回第2步。</p><p>图2中，顶点1和顶点2为割点，1号领航者出现故障，只剩下2号割点，将2号无人机选定为领航者，将剩下的连通分量与领航者实行通信连通，重新选定领航者后的编队队形如图4(b)所示，且新的编队通信无向图为连通图。</p><p>编队飞行通信程序代码量比较大 [<xref ref-type="bibr" rid="hanspub.25774-ref14">14</xref>] [<xref ref-type="bibr" rid="hanspub.25774-ref15">15</xref>] ，在原有飞行控制器上修改通信程序后还需要重新对整个程序进行编译及下载固件，这会浪费大量的时间，本文开发了模块化的通信设备，只需对通信模块进行修改再连接至飞行控制器即可，极大的方便了通信程序的修改，通信模块如图5所示。</p></sec><sec id="s6"><title>4. 实验验证</title><p>为了验证控制器和通信的有效性，在VICON光学运动捕捉系统(简称VICON)的环境下进行编队飞行实验，VICON可以通过安装在四周的红外摄像头捕捉对象，并在其构建的坐标系下获取对象的位置和速度等信息，具有精度高，采样频率快等优点，VICON及其相关软件如图6所示。</p><p>在室内VICON环境的坐标系下预先设定编队飞行轨迹与编队队形，由于室内环境空间有限，VICON环境下的坐标系为5 m &#215; 5 m的空间，编队飞行轨迹为直线，编队队形为三角形，具体如图7所示。</p><p>三机编队飞行轨迹如图8所示。</p><p>从图8可以看出，在室内VICON环境下，领航者可以较好的跟踪设定轨迹，跟随者也能迅速的跟随领航者，从而保持编队队形。</p><p>图3. 编队重构流程图</p><p>图4. 编队重构前后对比图</p><p>为了验证无人机群在有无人机出现故障后编队队形是否能够保持，实验中将模拟领航者出现故障，程序中设定机群在巡航飞行的过程中领航者突然从自动模式切换至降落模式，此时串口不再向下一级跟</p><p>图5. 通信数据处理模块</p><p>图6. VICON与上位机</p><p>图7. 编队队形图</p><p>图8. 编队飞行轨迹图</p><p>图9. 编队重构轨迹图</p><p>随者发送参考量，领航者降落后自动上锁不再飞行，剩余无人机因为接收不到信号先在当前地点悬停，根据优先级重新选择领航者，VICON上位机继续发送参考轨迹至新的领航者，并将新领航者的ID发送至跟随者，跟随者通过ID连接至跟随者从而保持通信网络的连通继续编队飞行，编队重构实验结果如图9所示。</p><p>从图9可以看出，本文中轨迹跟踪控制器能够使领航者按照预定的路径飞行，编队控制器能够保持机群编队队形，智能通信控制能够有效地维持机群中无人机出现故障时通信图的连通性。</p></sec><sec id="s7"><title>5. 结论</title><p>针对领航–跟随者编队方法的无人机自主编队飞行控制的问题，设计了轨迹跟踪控制器以及队形保持控制器，在编队控制器中加入误差混合器，使跟随者不仅能够快速的跟随领航者的机动变化，还能有效的保持编队队形。同时在机群通信中采用了基于代数图论的智能决策方法，解决了领航者或者其它无人机出现故障导致飞行任务失败的问题。实验结果表明编队控制器能够很好的实现编队巡航飞行，并且在故障情况下也能实现编队重构。</p></sec><sec id="s8"><title>基金项目</title><p>国家自然科学基金面上项目(No. 61573186)资助。</p></sec><sec id="s9"><title>文章引用</title><p>曹 俊,蔡晨晓. 基于VICON的无人机编队分布式控制 Distributed Control of UAVs Formation Based on VICON[J]. 动力系统与控制, 2018, 07(03): 182-189. https://doi.org/10.12677/DSC.2018.73020</p></sec><sec id="s10"><title>参考文献</title></sec></body><back><ref-list><title>References</title><ref id="hanspub.25774-ref1"><label>1</label><mixed-citation publication-type="other" xlink:type="simple">Ru, C.J., Wei, R.X., Wang, Y.Y. and Che, J. (2014) Multimodel Predictive Control Approach for UAV Formation Flight. Mathematical Problems in Engineering, 2014, Article ID: 835301. https://doi.org/10.1155/2014/835301</mixed-citation></ref><ref id="hanspub.25774-ref2"><label>2</label><mixed-citation publication-type="other" xlink:type="simple">Mao, D. and Zhang, X.X. (2017) Consensus-Based Three-Dimensional Multi-UAV Formation Control Strategy with High Precision. Frontiers of Information Technology &amp; Electronic Engineering, 18, 968-977.</mixed-citation></ref><ref id="hanspub.25774-ref3"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Brandao, A.S., Barbosa, J.P.A., Mendoza, V., Sarcinelli-Filho, M. and Carelli, R. (2014) A Multi-Layer Control Scheme for a Centralized UAV Formation. International Conference on Unmanned Aircraft Systems, Orlando, 27-30 May 2014, 1181-1187. https://doi.org/10.1109/ICUAS.2014.6842373</mixed-citation></ref><ref id="hanspub.25774-ref4"><label>4</label><mixed-citation publication-type="other" xlink:type="simple">袁春娟, 郭淑霞. 一种应用于无人机编队通信的防碰撞方法[J]. 国外电子测量技术, 2014, 33(2): 69-73.</mixed-citation></ref><ref id="hanspub.25774-ref5"><label>5</label><mixed-citation publication-type="other" xlink:type="simple">张晋武. 无人机编队飞行技术研究磁[J]. 舰船电子工程, 2015(8): 9-12.</mixed-citation></ref><ref id="hanspub.25774-ref6"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Yang, J., Zhang, K.Y., Wang, X.M., Hao, C.L. and Wei, T. (2014) UAV Formation Control Based on the Improved APF. Advanced Materials Research, 933, 358-364. https://doi.org/10.4028/www.scientific.net/AMR.933.358</mixed-citation></ref><ref id="hanspub.25774-ref7"><label>7</label><mixed-citation publication-type="other" xlink:type="simple">Zhai, H., Ji, Z. and Gao, J. (2013) Formation Control of Multiple Robot Fishes Based on Artificial Potential Field and Leader-Follower Framework. 25th Chinese Control and Decision Conference (CCDC), Guiyang, 25-27 May 2013, 2616-2620.</mixed-citation></ref><ref id="hanspub.25774-ref8"><label>8</label><mixed-citation publication-type="other" xlink:type="simple">Yu, X. and Liu, L. (2016). Distributed Formation Control of Nonholonomic Vehicles Subject to Velocity Constraints. IEEE Transactions on In-dustrial Electronics, 63, 1289-1298. https://doi.org/10.1109/TIE.2015.2504042</mixed-citation></ref><ref id="hanspub.25774-ref9"><label>9</label><mixed-citation publication-type="other" xlink:type="simple">Du, H., Zhu, W., Wen, G., Duan, Z. and Lü, J. (2017) Distributed Formation Control of Multiple Quadrotor Aircraft Based on Nonsmooth Con-sensus Algorithms. IEEE Transactions on Cybernetics, PP, 1-12.  
https://doi.org/10.1109/TCYB.2017.2777463</mixed-citation></ref><ref id="hanspub.25774-ref10"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Han, Z., Guo, K., Xie, L. and Lin, Z. (2018) Integrated Relative Localization &amp; Leader-Follower Formation Control. IEEE Transactions on Automatic Control, 99, 1. https://doi.org/10.1109/TAC.2018.2800790</mixed-citation></ref><ref id="hanspub.25774-ref11"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Kang, S.M. and Ahn, H.S. (2016) Design and Realization of Distributed Adaptive Formation Control Law for Multi-Agent Systems with Moving Leader. IEEE Transactions on Industrial Electronics, 63, 1268-1279.  
https://doi.org/10.1109/TIE.2015.2504041</mixed-citation></ref><ref id="hanspub.25774-ref12"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">王佳, 王艳新. 基于滑动模型与图论的多机器人跟踪控制[J]. 计算机仿真, 2010, 27(10): 156-159.</mixed-citation></ref><ref id="hanspub.25774-ref13"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">王楠, 徐洁琼. 基于图论和行为的深空航天器网络编队控制[J]. 沈阳工业大学学报, 2011(4): 439-444.</mixed-citation></ref><ref id="hanspub.25774-ref14"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Zhu, L., Yin, D., Yang, J. and Shen, L. (2015) Research of Remote Measurement and Control Technology of UAV Based on Mobile Communication Networks. IEEE International Conference on In-formation and Automation, Lijiang, 8-10 August 2015, 2517-2522. https://doi.org/10.1109/ICInfA.2015.7279709</mixed-citation></ref><ref id="hanspub.25774-ref15"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Liu, Z., Gao, X.G. and Fu, X.W. (2016) Coalition Formation for Multiple Heterogeneous UAVs Cooperative Search and Prosecute with Communication Constraints. Chinese Control and Decision Conference (CCDC), Yinchuan, 28-30 May 2016, 1727-1734. https://doi.org/10.1109/CCDC.2016.7531261</mixed-citation></ref></ref-list></back></article>